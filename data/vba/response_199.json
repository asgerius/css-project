[{"tags": ["excel", "vba", "connection", "oledb"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1541271908, "post_id": 53092897, "comment_id": 93162390, "body": "What is the data source?  Is it Microsoft SQL Server?, if so then you could use Windows Authentication to secure access instead of passwords."}, {"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1541422104, "post_id": 53092897, "comment_id": 93199699, "body": "A SSAS cube, but accessed through <a href=\"https://docs.microsoft.com/en-us/sql/analysis-services/instances/configure-http-access-to-analysis-services-on-iis-8-0?view=sql-server-2017\" rel=\"nofollow noreferrer\">msmdpump.dll</a>. My application provides a streamlined way to add cubes, I&#39;m not sure if it&#39;s windows authentication or not, but the credentials are stored in windows AD on the SSAS server."}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 2, "creation_date": 1541432115, "post_id": 53092897, "comment_id": 93205429, "body": "Have you seen this: <a href=\"https://stackoverflow.com/questions/3217014/how-to-securely-store-connection-string-details-in-vba\" title=\"how to securely store connection string details in vba\">stackoverflow.com/questions/3217014/&hellip;</a>? It&#39;s crazy that it needs so much workaround to protect connection strings."}, {"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "reply_to_user": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1541432392, "post_id": 53092897, "comment_id": 93205593, "body": "@TomJohnRiddle No I haven&#39;t, yeah that&#39;s ridiculous you&#39;d have to do that, just a design issue I guess, hard to build a good house on a bad foundation...."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1541437759, "post_id": 53092897, "comment_id": 93208577, "body": "@David Rogers:  It&#39;s a SQL Server cube, it looks permissionable, <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.analysisservices.cubepermission?redirectedfrom=MSDN&amp;view=sqlserver-2016\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/api/&hellip;</a> so who cares if password visible so long as the permissioning is enforced?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1541437894, "post_id": 53092897, "comment_id": 93208639, "body": "@TomJohnRiddle : On that referenced question, I don&#39;t believe the connection string is obscured.  Simply that the details are not in the VBA source.  That is to say, Debug.Print conn.ConnectionString will still reveal password.  So permissions is the way to go."}, {"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1541459711, "post_id": 53092897, "comment_id": 93217737, "body": "@SMeaden Yes it is permissioned, and that&#39;s really the point, each user see&#39;s a slightly different set of data based on their permissions. My little application attempts to clear those credentials on startup and close. Say the file was shared with some one else... They would see their own version of the data, vs what the original user might have seen(on refresh). My real issue here isn&#39;t the permissions, it&#39;s the fact that any file has the potential to contain the last credentials used in plaintext form of any previous users who may have accessed it."}, {"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1541459816, "post_id": 53092897, "comment_id": 93217771, "body": "@SMeaden users have the tendency to share files of this type, they don&#39;t understand the security implications of doing so, and my hope was that by removed any stored passwords I could mitigate this sharing issue."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1541463278, "post_id": 53092897, "comment_id": 93218683, "body": "Ok, well, you&#39;ll probably need to write some SQL Server Data Transformation Services (DTS) code to export for each use case a custom CSV or some other file that each user can run their own separate OLAP cube reports on."}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 1, "creation_date": 1541513167, "post_id": 53092897, "comment_id": 93236800, "body": "@DavidRogers maybe you can try this solution for removing creditentials: <a href=\"https://stackoverflow.com/questions/16695704/microsoft-excel-data-connections-alter-connection-string-through-vba\" title=\"microsoft excel data connections alter connection string through vba\">stackoverflow.com/questions/16695704/&hellip;</a>"}, {"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 2, "creation_date": 1541579204, "post_id": 53092897, "comment_id": 93260966, "body": "Upvoting the question, because most banks have a   <i>&#39;No embedded passwords and <b>absolutely</b> no plaintext  passwords at all&#39;</i>   policy. Also: however helpful it is to be told that we &#39;should&#39; use Windows Authentication - and most databases do offer it now - we still need to strip embedded passwords from existing spreadsheets."}], "answers": [{"comments": [{"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 1, "creation_date": 1541578125, "post_id": 53181778, "comment_id": 93260529, "body": "I wouldn&#39;t use regex: a connection string is a delimited string, which you can split into an array: <code>arrCS = Split(strCS, &quot;;&quot;)</code> and you can then traverse the array, excluding the array members which start with<code>Password=&#39; and </code>Pwd=` when you concatenate the connection string again.  Beware of the &#39;Extended Properties&#39; item of a connection string, as this is a separate coma-delimited list of name=value pairs which starts and ends with a Chr(34) double-quote: if the password is in there, you need to handle the quoted correctly."}, {"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "reply_to_user": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 0, "creation_date": 1541627941, "post_id": 53181778, "comment_id": 93285575, "body": "@NigelHeffernan Huh, I though of doing it that way, each reference in VBA is another potential system specific issues later on. Other than that what would be the advantage of using the string split method? Maybe I can write up another answer attempting that instead..."}, {"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 0, "creation_date": 1541677532, "post_id": 53181778, "comment_id": 93302176, "body": "@ David Rogers   Two advantages: One, you don&#39;t need to import a RegEx library; Two, you don&#39;t need to use RegEx, which is an approximation - a guess at the semantics of the text and its structure - when you <b>know</b> that the connection string is a structured set of name-value pairs with a known name that you need to extract."}], "tags": [], "owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "is_accepted": true, "score": 5, "last_activity_date": 1541548056, "creation_date": 1541548056, "answer_id": 53181778, "question_id": 53092897, "link": "https://stackoverflow.com/questions/53092897/vba-remove-password-from-oledb-connection-string/53181778#53181778", "title": "VBA - Remove Password from OLEDB Connection String", "body": "<p>@TomJohnRiddle points out that I should look at modifying the connection string similar to the <a href=\"https://stackoverflow.com/questions/16695704/microsoft-excel-data-connections-alter-connection-string-through-vba\">following question.</a> Initially I was concerned that taking this approach could prompt the user with a login screen after modifying the connection string. However since I don't have any better ideas I gave it a shot, and it seems to work, here's what I've mocked up:</p>\n\n<pre><code>Public Sub RemovePasswordByNamePrefix()\n    Dim cn As Object\n    Dim oledbCn As OLEDBConnection\n\n    Dim regEx As New RegExp\n    regEx.Pattern = \"Password=[^;]*;\"\n\n    For Each cn In ThisWorkbook.connections            \n        Set oledbCn = cn.OLEDBConnection\n        oledbCn.SavePassword = False\n\n        oledbCn.connection = regEx.Replace(oledbCn.connection, \"\")\n        oledbCn.CommandText = \"\" 'My app repopulates this after open\n    Next\nEnd Sub\n</code></pre>\n\n<p>and it seems to work:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Y52uA.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Y52uA.png\" alt=\"enter image description here\"></a></p>\n\n<p>So I think I'll go with this approach, but I'm still open to other suggestions. Would be nice to clear everything and fully reload it, but so far that doesn't <a href=\"https://stackoverflow.com/questions/53092637/vba-how-to-clear-a-connection-string-from-a-connection\">appear to be possible.</a></p>\n\n<p>I'm also concerned with what versions of VBA support the <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">\"Regex\" references</a>. I would like something that would be Excel 2010+ 32/64 bit compatible. I have yet to test this on any older version(I'm currently running Office 365). I assume it will all work fine, but I've been <a href=\"https://stackoverflow.com/questions/20741650/progressbar-control-cannot-be-load-library-not-registered\">unpleasantly surprised</a> with these things in the past.</p>\n"}, {"tags": [], "owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "is_accepted": false, "score": 0, "last_activity_date": 1541629723, "creation_date": 1541629723, "answer_id": 53198847, "question_id": 53092897, "link": "https://stackoverflow.com/questions/53092897/vba-remove-password-from-oledb-connection-string/53198847#53198847", "title": "VBA - Remove Password from OLEDB Connection String", "body": "<p>@NigelHeffernan suggests a slightly different approach for how to do this, here's a version without regex's:</p>\n\n<pre><code>Public Sub RemovePasswordByNamePrefix()\n    Dim cn As Object\n    Dim oledbCn As OLEDBConnection\n    Dim stringArray\n    Dim stringElement As Variant\n    Dim newStringArray As Variant\n\n    For Each cn In ThisWorkbook.connections\n        Set oledbCn = cn.OLEDBConnection\n        oledbCn.SavePassword = False\n\n        stringArray = Split(oledbCn.connection, \";\")\n\n        For Each stringElement In stringArray\n            If Not InStr(stringElement, \"Password=\") Then\n                If IsEmpty(newStringArray) Then\n                    newStringArray = Array(stringElement)\n                Else\n                    ReDim Preserve newStringArray(UBound(newStringArray) + 1)\n                    newStringArray(UBound(newStringArray)) = stringElement\n                End If\n            End If\n        Next\n\n        oledbCn.connection = Join(newStringArray, \";\")\n        oledbCn.CommandText = \"\" 'My app repopulates this after open\n    Next\nEnd Sub\n</code></pre>\n\n<p>I'm not sure the benefit of this method(other than a lack of another library reference) and I haven't tested outside of one connection string/one machine yet. My connection strings don't contain the \"Extended Properties\" field, maybe this approach wouldn't work for that.</p>\n"}, {"comments": [{"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "edited": false, "score": 0, "creation_date": 1541786628, "post_id": 53230916, "comment_id": 93348960, "body": "It&#39;s a interesting idea, but the issue is that I&#39;m trying to leverage excel&#39;s build it connection and pivot table logic rather than roll my own. I actually have a separate feature that does something similar to this to hide the credentials but its a bit different than this issue."}], "tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 0, "last_activity_date": 1541785793, "creation_date": 1541785793, "answer_id": 53230916, "question_id": 53092897, "link": "https://stackoverflow.com/questions/53092897/vba-remove-password-from-oledb-connection-string/53230916#53230916", "title": "VBA - Remove Password from OLEDB Connection String", "body": "<p>It looks like you are using DSNs, which is something that Excel will create if you use the default connection management tools in the GUI. When working with DSNs, the ODBC driver will sometimes put cleartext passwords in to the Registry, even when you don't select \"Save Password\". </p>\n\n<p>Instead of allowing Excel to manage your connections you would need to manage them yourself. Here is some example code from MS MVP Ben Clothier. You would have to modify the connection string to match your use case. You might be able to copy the details from your existing connections before you remove them.</p>\n\n<pre><code>Public Function InitConnect(UserName As String, Password As String) As Boolean\n\u2018 Description:  Should be called in the application\u2019s startup\n\u2018               to ensure that Access has a cached connection\n\u2018               for all other ODBC objects\u2019 use.\nOn Error GoTo ErrHandler\n\n    Dim dbCurrent As DAO.Database\n    Dim qdf As DAO.QueryDef\n    Dim rst As DAO.Recordset\n\n    \u2018&lt;configuration specific to MySQL ODBC driver&gt;\n\n    strConnection = \u201cODBC;DRIVER={MySQL ODBC 5.1 Driver};\u201d &amp; _\n                     \u201cServer=\u201d &amp; ServerAddress &amp; \u201c;\u201d &amp; _\n                     \u201cPort=\u201d &amp; PortNum &amp; \u201c;\u201d &amp; _\n                     \u201cOption=\u201d &amp; Opt &amp; \u201c;\u201d &amp; _  \u2018MySql-specific configuration\n                     \u201cStmt=;\u201d &amp; _\n                     \u201cDatabase=\u201d &amp; DbName &amp; \u201c;\u201d\n\n    Set dbCurrent = DBEngine(0)(0)\n    Set qdf = dbCurrent.CreateQueryDef(\u201c\u201d)\n\n    With qdf\n        .Connect = strConnection &amp; _\n                     \u201cUid=\u201d &amp; UserName &amp; \u201c;\u201d &amp; _\n                     \u201cPwd=\u201d &amp; Password\n        .SQL = \u201cSELECT CURRENT_USER();\u201d\n        Set rst = .OpenRecordset(dbOpenSnapshot, dbSQLPassThrough)\n    End With\n    InitConnect = True\n\nExitProcedure:\n    On Error Resume Next\n        Set rst = Nothing\n        Set qdf = Nothing\n        Set dbCurrent = Nothing\n    Exit Function\nErrHandler:\n    InitConnect = False\n    MsgBox Err.Description &amp; \u201d (\u201d &amp; Err.Number &amp; \u201c) encountered\u201d, _\n        vbOKOnly + vbCritical, \u201cInitConnect\u201d\n    Resume ExitProcedure\n    Resume\nEnd Function\n</code></pre>\n\n<p><strong>NOTE:</strong>\nThis is written for MS Access, not Excel. The concepts are all the same. You might want to try making your front end in Access and then export your views to Excel from Access. This would allow you better control of the link to your back-end and allow you to use SQL in Access to define what you want to export to Excel.</p>\n\n<p><strong>READ THIS:</strong>\n<a href=\"https://www.microsoft.com/en-us/microsoft-365/blog/2011/04/08/power-tip-improve-the-security-of-database-connections/\" rel=\"nofollow noreferrer\">https://www.microsoft.com/en-us/microsoft-365/blog/2011/04/08/power-tip-improve-the-security-of-database-connections/</a></p>\n"}, {"comments": [{"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "edited": false, "score": 0, "creation_date": 1541978178, "post_id": 53239940, "comment_id": 93392917, "body": "I would love to do that, unfortunately all my users are in different domains/companies/locations outside of my control, we use the &quot;MSDMPump.dll&quot; method of giving them access, all credentials are stored on a AD server in the same domain where the cube is hosted. Connection strings are populated by my VBA macro. Maybe if I had the flexibility to have users connect through a centralized AD that would possible, maybe one day.. but that would be a major change to how the whole application works and pretty far out. It&#39;s a good suggested work around for certain cases though :)"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 2, "last_activity_date": 1541860221, "creation_date": 1541860221, "answer_id": 53239940, "question_id": 53092897, "link": "https://stackoverflow.com/questions/53092897/vba-remove-password-from-oledb-connection-string/53239940#53239940", "title": "VBA - Remove Password from OLEDB Connection String", "body": "<p>See this on SQL Server authentication <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/authentication-in-sql-server\" rel=\"nofollow noreferrer\">Authentication in SQL Server</a>.  There it says you can use 100% Windows Authentication or you can use Mixed-Mode (Windows Authentication and passwords).  If you really want to banish passwords from connection strings do not install with Mixed Mode Authentication just run 100% Windows Authentication.  However, there may be some code already deployed written to use passwords so that may not always be practical.  </p>\n\n<p>So, the other way to discipline no passwords is to use </p>\n\n<pre><code>Integrated Security=true; \n</code></pre>\n\n<p>in your connection strings.  This <a href=\"https://stackoverflow.com/questions/1229691/what-is-the-difference-between-integrated-security-true-and-integrated-securit/23637478#answer-1229745\">Stack Overflow question</a> on the subject is well visited.</p>\n"}], "owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2191, "favorite_count": 2, "accepted_answer_id": 53181778, "answer_count": 4, "score": 8, "last_activity_date": 1586414546, "creation_date": 1541025436, "last_edit_date": 1586414546, "question_id": 53092897, "link": "https://stackoverflow.com/questions/53092897/vba-remove-password-from-oledb-connection-string", "title": "VBA - Remove Password from OLEDB Connection String", "body": "<p>I have an excel file that contains a series of OLEDB connections leveraged by several pivot tables. I would like to create a VBA function that removes all password from that several connection string as the file is closed(so that the users password will not be persisted). First I thought all I need to do was set the \"Save Password\" property to false, something like this:</p>\n\n<pre><code>Public Sub RemovePasswordByNamePrefix()\n    Dim cn As Object\n    Dim oledbCn As OLEDBConnection\n\n    For Each cn In ThisWorkbook.connections\n        Set oledbCn = cn.OLEDBConnection\n        oledbCn.SavePassword = False          \n    Next\nEnd Sub\n</code></pre>\n\n<p>Should work right, on closing the file and reopening it you shouldn't see the password anymore in the connection string. It should not be \"Saved\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ur1YO.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Ur1YO.png\" alt=\"enter image description here\"></a></p>\n\n<p>Wrong, password is still there... It has been \"Saved\". Not sure what that feature is supposed to do. Maybe there referring to a different password? So, I attempted the <a href=\"https://stackoverflow.com/questions/53092637/vba-how-to-clear-a-connection-string-from-a-connection\">big hammer approach</a>, unfortunately it has it's own challenges, and so far I haven't gotten that working.</p>\n\n<p>I'm not quite sure how to do this... Why is this so massively insecure? It persists plaintext passwords every file that contains a connection string of this sort, easily readable by whoever could access that file. </p>\n\n<p>Maybe I could make some sort of Regex to remove just the password from the file? When I do that in the interface my cubes refresh and prompt me for my credentials, (I wonder)would that occur if I did it in VBA, even if the trigger is upon excels closure?</p>\n\n<p><strong>Bottom Line:</strong> What is the best way to prevent these passwords from being persisted in the file upon it's closure?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1541024224, "post_id": 53092694, "comment_id": 93082100, "body": "Explain what you are trying to do. If  <code>Sheet 4</code> cell <code>BN</code> is empty, copy to <code>Sheet 8</code>. What is your second loop trying to do? Loop back through the same range and delete those same rows?"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1541024817, "creation_date": 1541024817, "answer_id": 53092811, "question_id": 53092694, "link": "https://stackoverflow.com/questions/53092694/transfer-rows-with-null-values-to-a-different-sheet/53092811#53092811", "title": "Transfer rows with null values to a different sheet", "body": "<p>I think this is what you are looking for. The reason the code is slow is because you trying to copy, paste, &amp; delete inside your loop which means <strong>every loop</strong> incurs 3 instances of action. This method has the action taken outside of the loop which means you only have 3 instances of action. </p>\n\n<p>Even better would be to simply filter your column by blanks and then copy/paste/delete the cells shown by filter. But you took the loop approach, so this would be a better way to complete the ask with a loop.</p>\n\n<pre><code>Option Explicit\n\nSub Blanks()\n\nDim ws4 As Worksheet: Set ws4 = ThisWorkbook.Sheets(\"Sheet4\")\nDim ws8 As Worksheet: Set ws8 = ThisWorkbook.Sheets(\"Sheet8\")\n\nDim LRow As Long, MyCell As Range, MyRange As Range, MyUnion As Range\n\nLRow = ws4.Range(\"BN\" &amp; ws4.Rows.Count).End(xlUp).Row\nSet MyRange = ws4.Range(\"BN2:BN\" &amp; LRow)\n\nFor Each MyCell In MyRange\n    If MyCell = \"\" Then\n        If Not MyUnion Is Nothing Then\n            Set MyUnion = Union(MyUnion, MyCell)\n        Else\n            Set MyUnion = MyCell\n        End If\n    End If\nNext MyCell\n\nIf Not MyUnion Is Nothing Then\n    MyUnion.EntireRow.Copy\n    ws8.Range(\"A1\").PasteSpecial xlPasteValuesAndNumberFormats\n    MyUnion.EntireRow.Delete\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9270020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5aae36f0b1e48baa88591c00686fa15?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Martinez", "link": "https://stackoverflow.com/users/9270020/dan-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1586755699, "creation_date": 1541024091, "last_edit_date": 1586755699, "question_id": 53092694, "link": "https://stackoverflow.com/questions/53092694/transfer-rows-with-null-values-to-a-different-sheet", "title": "Transfer rows with null values to a different sheet", "body": "<p>Here is my code. The issue is that this is running on a sheet that has over 4,000 rows and takes a while to finish. Looking for a faster way to do this.</p>\n\n<pre><code>'Transfer rows with null Updated_SAT into SAT_errors sheet\n\nSheet4.Range(\"A1:BN1\").Copy Sheet8.Range(\"A1\")\n\nDim j As Integer\nj = 2\nFor i = 2 To max_row\n    If (Len(Sheet4.Range(\"BN\" &amp; i).Value) = 0 Or Sheet4.Range(\"BN\" &amp; i).Value = 0) Then\n    Sheet4.Rows(i).Copy Sheet8.Range(\"A\" &amp; j)\n    j = j + 1\n    End If\nNext i\nDim k As Integer\nk = 2\nFor i = 2 To max_row\n    If (IsEmpty(Sheet4.Range(\"BN\" &amp; i).Value) Or Sheet4.Range(\"BN\" &amp; i).Value = 0) Then\n    Sheet4.Range(\"A\" &amp; i &amp; \":\" &amp; \"BN\" &amp; i).Delete\n    i = i - 1\n    End If\n    k = k + 1\n    If k = max_row Then\n    Exit For\n    End If\n\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba", "connection", "oledb"], "answers": [{"comments": [{"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "edited": false, "score": 0, "creation_date": 1541786512, "post_id": 53231030, "comment_id": 93348904, "body": "Hmm won&#39;t that break my pivot tables? Can you link a broken cube with a newly (re)created connection string?"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "edited": false, "score": 0, "creation_date": 1541787078, "post_id": 53231030, "comment_id": 93349186, "body": "You can assign a new data source to a pivot table at any time. I don&#39;t have a cube to test it with but I assume it would work the same as other data sources. Do some testing."}], "tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 0, "last_activity_date": 1541786256, "creation_date": 1541786256, "answer_id": 53231030, "question_id": 53092637, "link": "https://stackoverflow.com/questions/53092637/vba-how-to-clear-a-connection-string-from-a-connection/53231030#53231030", "title": "VBA - How to Clear a Connection String From a Connection", "body": "<p>Try instead; delete the connection and recreate later when you need it.</p>\n\n<pre><code>Public Sub RemovePasswordByNamePrefix()\n    Dim w As Worksheet\n    Dim qt As QueryTable\n    Dim cn As Object\n    Dim odbcCn As ODBCConnection\n    Dim oledbCn As OLEDBConnection\n\n    For Each cn In ThisWorkbook.Connections\n        If cn.Type = xlConnectionTypeODBC Then\n            cn.Delete\n        ElseIf cn.Type = xlConnectionTypeOLEDB Then\n            cn.Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1586414582, "creation_date": 1541023774, "last_edit_date": 1592644375, "question_id": 53092637, "link": "https://stackoverflow.com/questions/53092637/vba-how-to-clear-a-connection-string-from-a-connection", "title": "VBA - How to Clear a Connection String From a Connection", "body": "<p>I have a function that attempts to clear every connection string from every connection, it works as follows:</p>\n<pre><code>Public Sub RemovePasswordByNamePrefix()\n    Dim w As Worksheet\n    Dim qt As QueryTable\n    Dim cn As Object\n    Dim odbcCn As ODBCConnection\n    Dim oledbCn As OLEDBConnection\n        \n    For Each cn In ThisWorkbook.connections\n        If cn.Type = xlConnectionTypeODBC Then\n            Set odbcCn = cn.ODBCConnection\n            odbcCn.SavePassword = False\n            \n            odbcCn.connection = &quot;&quot;\n            odbcCn.CommandText = &quot;&quot;\n            \n        ElseIf cn.Type = xlConnectionTypeOLEDB Then\n            \n            Set oledbCn = cn.OLEDBConnection\n            oledbCn.SavePassword = False\n\n            oledbCn.connection = &quot;&quot;\n            oledbCn.CommandText = &quot;&quot;\n            \n        End If\n    Next\nEnd Sub\n</code></pre>\n<p>The issue is that this fails, with the following error(at the OLEDB section, connection = &quot;&quot;):</p>\n<blockquote>\n<p>Run time error '1004'</p>\n<p>Application defined or object-defined error</p>\n</blockquote>\n<p>Attempting to do this by the interface doesn't work either, it's a little funky:</p>\n<p><a href=\"https://i.stack.imgur.com/tfPUw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tfPUw.png\" alt=\"enter image description here\" /></a></p>\n<p>When you click the &quot;OK&quot; button, it just doesn't do anything... like the window doesn't close, no change, it's very strange. Actually this same behavior will persist unless you put something(valid or invalid) in the command text and command string sections...</p>\n<p>Why is this the case? Is there a way to get around it? It's almost like MS put this as a &quot;hidden&quot; requirement and didn't document or provide feedback when the user/developer attempts to route around it.</p>\n<p><em>The obvious question I'll receive on this is, why would I want to do this, I'll will open another ticket to address that, and add a <a href=\"https://stackoverflow.com/questions/53092897/vba-remove-password-from-oledb-connection-string\">link here</a></em></p>\n"}, {"tags": ["excel", "vba", "pdf", "outlook", "attachment"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10588267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qV3EueihZ80/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBzvfigrF8LPIVRh91EpyMQGhQa6A/mo/photo.jpg?sz=128", "display_name": "Ray", "link": "https://stackoverflow.com/users/10588267/ray"}, "edited": false, "score": 0, "creation_date": 1541092055, "post_id": 53095947, "comment_id": 93107348, "body": "Thank you Alina, the challenge here is that you are providing a specific directory i.e. &quot;C:\\test.txt&quot; but I need that directory to always look in the current folder, as i&#39;ll always be copy-pasting this document into separate client folders to generate quotes"}], "tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1541052137, "creation_date": 1541052137, "answer_id": 53095947, "question_id": 53092544, "link": "https://stackoverflow.com/questions/53092544/how-to-attach-exported-pdf-file-to-outlook-mail-using-excel-vba/53095947#53095947", "title": "How to attach exported pdf file to Outlook mail using Excel VBA?", "body": "<p>You could refer to the below code:</p>\n\n<pre><code>Sub Mail_Workbook_1()\n' Works in Excel 2000, Excel 2002, Excel 2003, Excel 2007, Excel 2010, Outlook 2000, Outlook 2002, Outlook 2003, Outlook 2007, Outlook 2010.\n' This example sends the last saved version of the Activeworkbook object .\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n   ' Change the mail address and subject in the macro before you run it.\n    With OutMail\n        .To = \"ron@debruin.nl\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"This is the Subject line\"\n        .Body = \"Hello World!\"\n        .Attachments.Add ActiveWorkbook.FullName\n        ' You can add other files by uncommenting the following line.\n        '.Attachments.Add (\"C:\\test.txt\")\n        ' In place of the following statement, you can use \".Display\" to\n        ' display the mail.\n        .Send   \n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>For more information, Please refer to this link:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/officetalk2010/ff458119(v%3Doffice.11)\" rel=\"nofollow noreferrer\">OfficeTalk: Using the Excel Object Model to Send Workbooks and Ranges through E-Mail with Outlook (Part 1 of 2)</a></p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10588267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qV3EueihZ80/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBzvfigrF8LPIVRh91EpyMQGhQa6A/mo/photo.jpg?sz=128", "display_name": "Ray", "link": "https://stackoverflow.com/users/10588267/ray"}, "edited": false, "score": 0, "creation_date": 1541091969, "post_id": 53105722, "comment_id": 93107298, "body": "Hi Niton thank you for this. I tried your code and got the same error as my original code. it says:  Run-time error &#39;-2147024894 (80070002)&#39;: Cannot find this file. Verify the path and file name are correct."}, {"owner": {"reputation": 13, "user_id": 10588267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qV3EueihZ80/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBzvfigrF8LPIVRh91EpyMQGhQa6A/mo/photo.jpg?sz=128", "display_name": "Ray", "link": "https://stackoverflow.com/users/10588267/ray"}, "edited": false, "score": 0, "creation_date": 1541099871, "post_id": 53105722, "comment_id": 93111198, "body": "Hi there i&#39;ve figured it out with your help using the pathfilename as string! thanks for pointing me in the right direction"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 0, "last_activity_date": 1541090846, "creation_date": 1541090846, "answer_id": 53105722, "question_id": 53092544, "link": "https://stackoverflow.com/questions/53092544/how-to-attach-exported-pdf-file-to-outlook-mail-using-excel-vba/53105722#53105722", "title": "How to attach exported pdf file to Outlook mail using Excel VBA?", "body": "<p>I suggest Outlook VBA does not know Excel VBA's Range.</p>\n\n<p>You could pass the info from Range like this:</p>\n\n<pre><code>Sub sendremindermail()\n\nDim fName As String\nDim pathFileName As String\n\nChDir ThisWorkbook.Path &amp; \"\\\"\n\nfName = Range(\"'Costing'!C8\")\n\n'ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=Range(\"'Costing'!C1\"), Openafterpublish:=True\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=fName ', Openafterpublish:=True\n\nDim outlookapp As Object\nDim outlookmailitem As Object\nDim myattachments As Object\n\nSet outlookapp = CreateObject(\"outlook.application\")\nSet outlookmailitem = outlookapp.createitem(0)\nSet myattachments = outlookmailitem.Attachments\n\nWith outlookmailitem\n    .To = fName\n    pathFileName = ThisWorkbook.Path &amp; \"\\\" &amp; fName &amp; \".pdf\"\n    Debug.Print \"With fName not Range: \" &amp; pathFileName\n    myattachments.Add pathFileName\n    '.send\n    .Display\nEnd With\n\nSet outlookmailitem = Nothing\nSet outlookapp = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10588267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qV3EueihZ80/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBzvfigrF8LPIVRh91EpyMQGhQa6A/mo/photo.jpg?sz=128", "display_name": "Ray", "link": "https://stackoverflow.com/users/10588267/ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5186, "favorite_count": 0, "accepted_answer_id": 53105722, "answer_count": 2, "score": 1, "last_activity_date": 1541090846, "creation_date": 1541023217, "last_edit_date": 1541055149, "question_id": 53092544, "link": "https://stackoverflow.com/questions/53092544/how-to-attach-exported-pdf-file-to-outlook-mail-using-excel-vba", "title": "How to attach exported pdf file to Outlook mail using Excel VBA?", "body": "<p>My code is not finding an exported file to attach to an email. </p>\n\n<p>I'm sure I'm doing something wrong in the myattachments.add line.</p>\n\n<p>The file name and file directory will always be different based on each client, that's why I have specified a cell specifically for the filename in each quote.</p>\n\n<p>I'm going to copy this Excel file to each client folder and run the code from there. </p>\n\n<pre><code>Sub sendremindermail()\nChDir ThisWorkbook.Path &amp; \"\\\"\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=Range(\"'Costing'!C1\"), Openafterpublish:=True\n\nDim outlookapp As Object\nDim outlookmailitem As Object\nDim myattachments As Object\n\nSet outlookapp = CreateObject(\"outlook.application\")\nSet outlookmailitem = outlookapp.createitem(0)\nSet myattachments = outlookmailitem.Attachments\n\nWith outlookmailitem\n.To = Range(\"'Costing'!C8\")\nmyattachments.Add ThisWorkbook.Path &amp; Range(\"'Costing'!C1\") &amp; \".pdf\" ' it cant find the pdf in the same directory\n'.send\n.Display\nEnd With\n\nSet outlookmailitem = Nothing\nSet outlookapp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I'm new to VBA for Excel.</p>\n"}, {"tags": ["vba", "outlook", "office365"], "comments": [{"owner": {"reputation": 69, "user_id": 7269923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/405a379bbe19a5768f69a4fe8a3403df?s=128&d=identicon&r=PG&f=1", "display_name": "ptuga", "link": "https://stackoverflow.com/users/7269923/ptuga"}, "edited": false, "score": 0, "creation_date": 1541021188, "post_id": 53092166, "comment_id": 93081126, "body": "and <code>Set wdDoc = Inspector.WordEditor</code>"}, {"owner": {"reputation": 69, "user_id": 7269923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/405a379bbe19a5768f69a4fe8a3403df?s=128&d=identicon&r=PG&f=1", "display_name": "ptuga", "link": "https://stackoverflow.com/users/7269923/ptuga"}, "edited": false, "score": 0, "creation_date": 1541021392, "post_id": 53092166, "comment_id": 93081199, "body": "When you try to open the link, MS Office does not recognize the file and a message &quot;Microsoft Office has identified a potential security concern. This location may be unsafe. cid:NAME&quot;"}, {"owner": {"reputation": 208, "user_id": 10062262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41486435301afe7d1ac37b98a2fb4871?s=128&d=identicon&r=PG&f=1", "display_name": "Yuki", "link": "https://stackoverflow.com/users/10062262/yuki"}, "edited": false, "score": 0, "creation_date": 1541059466, "post_id": 53092166, "comment_id": 93090520, "body": "Have you test it on another PC?"}, {"owner": {"reputation": 69, "user_id": 7269923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/405a379bbe19a5768f69a4fe8a3403df?s=128&d=identicon&r=PG&f=1", "display_name": "ptuga", "link": "https://stackoverflow.com/users/7269923/ptuga"}, "reply_to_user": {"reputation": 208, "user_id": 10062262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41486435301afe7d1ac37b98a2fb4871?s=128&d=identicon&r=PG&f=1", "display_name": "Yuki", "link": "https://stackoverflow.com/users/10062262/yuki"}, "edited": false, "score": 0, "creation_date": 1541076656, "post_id": 53092166, "comment_id": 93098661, "body": "No I haven&#39;t. But what is different in this same PC is the fact that, I know have 365 and had 2013 before. And it was ok before."}, {"owner": {"reputation": 69, "user_id": 7269923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/405a379bbe19a5768f69a4fe8a3403df?s=128&d=identicon&r=PG&f=1", "display_name": "ptuga", "link": "https://stackoverflow.com/users/7269923/ptuga"}, "reply_to_user": {"reputation": 208, "user_id": 10062262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41486435301afe7d1ac37b98a2fb4871?s=128&d=identicon&r=PG&f=1", "display_name": "Yuki", "link": "https://stackoverflow.com/users/10062262/yuki"}, "edited": false, "score": 0, "creation_date": 1541076689, "post_id": 53092166, "comment_id": 93098689, "body": "This piece of code worked fine also:  <code>Private Sub attachementTool() Dim msg,  Dim attach Set msg = Application.CreateItem(0) msg.To = &quot;me@gmail.com&quot; msg.Subject = &quot;test link&quot; msg.HTMLBody = &quot;&lt;html&gt;&lt;body&gt;click &lt;a href=&quot;&quot;cid:attachCid1&quot;&quot;&gt;here&lt;&#47;a&gt; to open attachment &lt;br &#47;&gt;&quot; &amp; _                 &quot;click &lt;a href=&quot;&quot;cid:attachCid2&quot;&quot;&gt;here&lt;&#47;a&gt; to open attachment&lt;&#47;body&gt;&lt;&#47;html&gt;&quot; Set attach = msg.Attachments.Add(&quot;C:\\Users\\Me\\Desktop\\attach1.pdf&quot;) attach.PropertyAccessor.SetProperty &quot;http:&#47;&#47;schemas.microsoft.com&#47;mapi&#47;proptag&#47;0x3712001F&quot;, &quot;attachCid1&quot; msg.Save msg.Send End Sub</code>"}, {"owner": {"reputation": 69, "user_id": 7269923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/405a379bbe19a5768f69a4fe8a3403df?s=128&d=identicon&r=PG&f=1", "display_name": "ptuga", "link": "https://stackoverflow.com/users/7269923/ptuga"}, "reply_to_user": {"reputation": 208, "user_id": 10062262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41486435301afe7d1ac37b98a2fb4871?s=128&d=identicon&r=PG&f=1", "display_name": "Yuki", "link": "https://stackoverflow.com/users/10062262/yuki"}, "edited": false, "score": 0, "creation_date": 1544398082, "post_id": 53092166, "comment_id": 94250801, "body": "Is anyone out there able to help me?"}], "owner": {"reputation": 69, "user_id": 7269923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/405a379bbe19a5768f69a4fe8a3403df?s=128&d=identicon&r=PG&f=1", "display_name": "ptuga", "link": "https://stackoverflow.com/users/7269923/ptuga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 689, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541168142, "creation_date": 1541021071, "last_edit_date": 1541168142, "question_id": 53092166, "link": "https://stackoverflow.com/questions/53092166/insert-link-to-attached-document-in-outlook-365", "title": "Insert link to attached document in Outlook 365", "body": "<p>I have a macro that had been working until I updated to Office 365.</p>\n\n<p>I could attach a file or files and create a link in the body so that when the user clicks the link, it opens the attachment. This is very helpful if you have more than one attachment and need to write your email and keep the user in context of what you need to open. Instead of having to write the name of the attachment you can simply add a link (e.g. [ LINK ]) as a shortcut.</p>\n\n<p><em>This was working in 2013:</em></p>\n\n<pre><code>Set MyAttachment= item.Attachments.item(i) \n\nMyAttachment.PropertyAccessor.SetProperty \"http://schemas.microsoft.com/mapi/proptag/0x3712001E\", CStr(AttachRef)\n</code></pre>\n\n<p>Where AttachRef is the name of the attachment (string).</p>\n\n<p>I then write the link in the email body with the address:</p>\n\n<pre><code>\"cid:\" &amp; CStr(AttachRef)\n</code></pre>\n\n<p>And a description (string) the can be seen simply as:</p>\n\n<pre><code>[LINK]\n</code></pre>\n\n<p>Using:</p>\n\n<pre><code>Set Inspector = Application.ActiveInspector()\nSet wdDoc = Inspector.WordEditor wdDoc.Hyperlinks.Add Selection.Range, Address:=iAddress, TextToDisplay:=iTextToDisplay\n</code></pre>\n\n<p>When you try to open the link, MS Office does not recognize the file and I get:</p>\n\n<blockquote>\n  <p>\"Microsoft Office has identified a potential security concern. This location may be unsafe. cid:NAME\"</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1541020500, "post_id": 53091967, "comment_id": 93080858, "body": "Are you sure you can use an array like that? How do you expect the formulas to fill in? <code>strFormulas(1)</code> for column P, <code>2</code> for Q, etc?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1541020567, "post_id": 53091967, "comment_id": 93080881, "body": "You&#39;re missing a parenthesis on end of the first formula. @BruceWayne seems to write the formulas correctly across that section."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1541021307, "post_id": 53091967, "comment_id": 93081165, "body": "You also don&#39;t need to <code>FillDown</code>, simply <code>.Range(&quot;P7:R&quot; &amp; lastRow).Formula = strFormulas</code>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1541021959, "post_id": 53091967, "comment_id": 93081404, "body": "By the way, a much nicer formula to use would be an array <code>INDEX&#47;MATCH</code> formula, for example, <code>=INDEX({&quot;CCS&quot;,&quot;DSO&quot;,&quot;ALC&quot;,&quot;RCD&quot;,&quot;CMNA&quot;,&quot;CRNA&quot;,&quot;CCSCAN&quot;,&quot;CARL&zwnj;&#8203;YLE&quot;,&quot;CRS&quot;,&quot;ICP&quot;,&quot;MI&zwnj;&#8203;SCELLANEOUS&quot;,&quot;NAO&quot;,&quot;&zwnj;&#8203;NATIONAL&quot;},MATCH(1,C&zwnj;&#8203;OUNTIF(O7,&quot;*&quot;&amp;{&quot;CCS&quot;&zwnj;&#8203;,&quot;DSO&quot;,&quot;ALC&quot;,&quot;RCD&quot;,&quot;&zwnj;&#8203;CMNA&quot;,&quot;CRNA&quot;,&quot;CCSCAN&zwnj;&#8203;&quot;,&quot;CARLYLE&quot;,&quot;CRS&quot;,&quot;I&zwnj;&#8203;CP&quot;,&quot;MISCELLANEOUS&quot;,&zwnj;&#8203;&quot;NAO&quot;,&quot;NATIONAL&quot;}&amp;&quot;*&zwnj;&#8203;&quot;),0))</code>. That would return the criteria found in <code>O7</code>."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1541027247, "post_id": 53091967, "comment_id": 93082973, "body": "@dwirony, that&#39;s indeed more elegant; I tried this and it works nicely, but only if I put double quotes around the strings. Single quotes raise a syntax error. Not sure why..."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1541064904, "post_id": 53091967, "comment_id": 93092800, "body": "@BigBen, the missing parenthesis indeed solves the puzzle. Still trying to learn the culture around here: why wouldn&#39;t you post that as an answer rather than a comment? (I can&#39;t seem to find any discussion on &quot;answers as comments&quot; on Meta, only the other way around...)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "edited": false, "score": 0, "creation_date": 1541073156, "post_id": 53091967, "comment_id": 93096961, "body": "@Egalth because this is just a simple typo, and I voted to close the question."}, {"owner": {"reputation": 1, "user_id": 10588099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18fd3cef6035ba1ac065f7843afad24e?s=128&d=identicon&r=PG&f=1", "display_name": "ahebert82", "link": "https://stackoverflow.com/users/10588099/ahebert82"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1541096585, "post_id": 53091967, "comment_id": 93109641, "body": "@BigBen - DOH! I forgot to add the extra parenthesis after adding the additional search term. It worked. Thank you so much and thank you all for your contributions. I am VERY inexperienced with writing code and definitely don&#39;t know how to write things elegantly!"}], "owner": {"reputation": 1, "user_id": 10588099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18fd3cef6035ba1ac065f7843afad24e?s=128&d=identicon&r=PG&f=1", "display_name": "ahebert82", "link": "https://stackoverflow.com/users/10588099/ahebert82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1579624261, "creation_date": 1541020018, "last_edit_date": 1579624261, "question_id": 53091967, "link": "https://stackoverflow.com/questions/53091967/why-am-i-getting-an-error-when-trying-to-fill-down-using-active-sheet", "title": "Why am I getting an error when trying to Fill Down using Active Sheet?", "body": "<p>I am trying to search for specific terms and count the number of occurrences of that term within that column. I am using this macro by copying and pasting a macro button into my active sheet as the name of the worksheet I'll be applying this to will always be different/changing (each sheet is named for a month of the year so it will be changing every time I have a new month's worth of data). The length of the column is also variable with every given month. </p>\n\n<p>This used to work without issue but recently I began getting a 1004 application defined or object defined error at the line that reads: </p>\n\n<pre><code>.Range(\"P7:R7\").Formula = strFormulas\n</code></pre>\n\n<p>Are my formulas too long? Here's all of the code I am using for this section:</p>\n\n<pre><code>With ActiveSheet.Columns(\"P:T\")\n.ColumnWidth = 10\nEnd With\n\nRange(\"P6\").Value = \"DeptShortName\"\nRange(\"Q6\").Value = \"IfCAN\"\nRange(\"R6\").Value = \"Business Unit Name\"\nRange(\"S6\").Value = \"Business Unit\"\n\nDim lastRow As Long\n\n'Set formulas to appear in columns 1, 2, 3 after column O\nDim strFormulas(1 To 3) As Variant\n\n'Set last row to fill for columns P-R based on variable length of column O\nlastRow = Range(\"O\" &amp; Rows.Count).End(xlUp).Row\n\n'Auto fill formulas defined below to columns 1,2, 3 after column O, so columns P, Q, R\n    With ActiveSheet\n        strFormulas(1) = \"=IF(ISNUMBER(SEARCH(\"\"CCS\"\",O7)),\"\"CCS\"\",IF(ISNUMBER(SEARCH(\"\"DSO\"\",O7)),\"\"DSO\"\",IF(ISNUMBER(SEARCH(\"\"ALC\"\",O7)),\"\"ALC\"\",IF(ISNUMBER(SEARCH(\"\"RCD\"\",O7)),\"\"RCD\"\",IF(ISNUMBER(SEARCH(\"\"CMNA\"\",O7)),\"\"CMNA\"\",IF(ISNUMBER(SEARCH(\"\"CRNA\"\",O7)),\"\"CRNA\"\",IF(ISNUMBER(SEARCH(\"\"CCSCAN\"\",O7)),\"\"CCSCAN\"\",IF(ISNUMBER(SEARCH(\"\"CARLYLE\"\",O7)),\"\"CARLYLE\"\",IF(ISNUMBER(SEARCH(\"\"CRS\"\",O7)),\"\"CRS\"\",IF(ISNUMBER(SEARCH(\"\"ICP\"\",O7)),\"\"ICP\"\",IF(ISNUMBER(SEARCH(\"\"MISCELLANEOUS\"\",O7)),\"\"MISC\"\",IF(ISNUMBER(SEARCH(\"\"NAO\"\",O7)),\"\"NAO DIST\"\",IF(ISNUMBER(SEARCH(\"\"NATIONAL\"\",O7)),\"\"NATIONAL\"\",\"\"\"\"))))))))))))\"\n        strFormulas(2) = \"=IF(ISNUMBER(SEARCH(\"\"CCSCAN\"\",O7)),\"\"CAN\"\",IF(ISNUMBER(SEARCH(\"\"ALC 0211\"\",O7)),\"\"CAN\"\",IF(ISNUMBER(SEARCH(\"\"ALC 0218\"\",O7)),\"\"CAN\"\",IF(ISNUMBER(SEARCH(\"\"ALC 0251\"\",O7)),\"\"CAN\"\",\"\"\"\"))))\"\n        strFormulas(3) = \"=CONCATENATE(P7,Q7)\"\n        .Range(\"P7:R7\").Formula = strFormulas\n        .Range(\"P7:R\" &amp; lastRow).FillDown\n    End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1541021041, "post_id": 53092126, "comment_id": 93081075, "body": "I&#39;m not sure if you can use the <code>Text to Columns</code> the way you want to (multiple delimiters exist in one string). This is using an array so it should be pretty quick"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1541023534, "post_id": 53092126, "comment_id": 93081912, "body": "Just some insight - I would recommend placing these values into an array and writing the array to your sheet just once. This took 6.6 seconds to complete on 100k rows (which isn&#39;t bad) - and I think this could be under a second if you write the array to your sheet."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1541024093, "post_id": 53092126, "comment_id": 93082056, "body": "@K.D\u1d00\u1d20\u026as nice! I&#39;ve actually never done that. Will study your answer and try to re-create"}, {"owner": {"reputation": 35, "user_id": 10588116, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156547434125490/picture?type=large", "display_name": "Gavin Jansen Van Rensburg", "link": "https://stackoverflow.com/users/10588116/gavin-jansen-van-rensburg"}, "edited": false, "score": 0, "creation_date": 1541077168, "post_id": 53092126, "comment_id": 93099019, "body": "I&#39;ll give it ago! Thank you so much folks"}, {"owner": {"reputation": 35, "user_id": 10588116, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156547434125490/picture?type=large", "display_name": "Gavin Jansen Van Rensburg", "link": "https://stackoverflow.com/users/10588116/gavin-jansen-van-rensburg"}, "edited": false, "score": 0, "creation_date": 1541078622, "post_id": 53092126, "comment_id": 93099889, "body": "Hi Urdearboy, I tried your code. I receive an error invalid procedure call or arguement; ws.Range(&quot;B&quot; &amp; i + 1) = Left(Arr(i, 1), InStr(Arr(i, 1), Chr(32)) - 1)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1541080022, "post_id": 53092126, "comment_id": 93100657, "body": "This was tested and working fine. We can trouble shoot if you would like, but @K.D\u1d00\u1d20\u026as solution is better (runs faster per his comment on this post). I would give his a look and accept his solution if it works for ya!"}, {"owner": {"reputation": 35, "user_id": 10588116, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156547434125490/picture?type=large", "display_name": "Gavin Jansen Van Rensburg", "link": "https://stackoverflow.com/users/10588116/gavin-jansen-van-rensburg"}, "edited": false, "score": 0, "creation_date": 1541082464, "post_id": 53092126, "comment_id": 93101919, "body": "Thanks! Just tried K.Davis. It works. However, for some strange reason if it&#39;s the first sheet but not 4th or 5th. Any reason?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1541082519, "post_id": 53092126, "comment_id": 93101942, "body": "My code explicitly looks for the first sheet. You can set the ws variable to active sheet to correct"}, {"owner": {"reputation": 35, "user_id": 10588116, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156547434125490/picture?type=large", "display_name": "Gavin Jansen Van Rensburg", "link": "https://stackoverflow.com/users/10588116/gavin-jansen-van-rensburg"}, "edited": false, "score": 0, "creation_date": 1541173914, "post_id": 53092126, "comment_id": 93138180, "body": "Done. Cheers mate"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1541021564, "last_edit_date": 1541021564, "creation_date": 1541020876, "answer_id": 53092126, "question_id": 53091804, "link": "https://stackoverflow.com/questions/53091804/converting-three-word-string-into-two-strings/53092126#53092126", "title": "Converting Three Word String into Two Strings", "body": "<p>I'm not sure you can use the <code>Text to Columns</code> method the way you want to given your delimiter being present multiple times.  </p>\n\n<p>This code will take the values in <code>Column A</code> and return the <strong>First Name</strong> in <code>Column B</code> and return the <strong>Second <em>and</em> Last Name</strong> in <code>Column C</code></p>\n\n<h2>Explanation</h2>\n\n<ol>\n<li>Load Array (<code>Arr</code>) from row 2 to last row (<code>LRow</code>)</li>\n<li>Extract desired strings using the Excel functions <code>Left</code> and <code>Right</code>. <code>InStr</code> is VBAs version of the Excel function <code>Search</code>. <code>Chr(32)</code> is simply the chr code for <em>space</em></li>\n<li>Output values on corresponding rows. Since arrays default with the first index of 0, you will need to use <code>i + 1</code> when relating the index to the row number, else your values will all be offset by 1. </li>\n</ol>\n\n<p>Adjust the columns as needed and the sheet name on the 3rd line. This also assumes a single-row header exists </p>\n\n<hr>\n\n<pre><code>Sub Custom_Delim()\n\nDim i As Long, LRow As Long, Arr\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\nLRow = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\nArr = ws.Range(\"A2:A\" &amp; LRow).Value\n\nApplication.ScreenUpdating = False\n    For i = LBound(Arr) To UBound(Arr)\n        ws.Range(\"B\" &amp; i + 1) = Left(Arr(i, 1), InStr(Arr(i, 1), Chr(32)) - 1)\n        ws.Range(\"C\" &amp; i + 1) = Right(Arr(i, 1), Len(Arr(i, 1)) - InStr(Arr(i, 1), Chr(32)))\n    Next i\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 3, "last_activity_date": 1541023169, "last_edit_date": 1541023169, "creation_date": 1541021091, "answer_id": 53092169, "question_id": 53091804, "link": "https://stackoverflow.com/questions/53091804/converting-three-word-string-into-two-strings/53092169#53092169", "title": "Converting Three Word String into Two Strings", "body": "<p>Essentially you are placing all your values into an array, splitting them into a 2D array and writing them back to the worksheet all at once.</p>\n\n<blockquote>\n  <h2>Tested with 100k rows:</h2>\n  \n  <p>Test 1 = 0.67 seconds<br>\n  Test 2 = 0.66 seconds<br>\n  Test 3 = 0.67 seconds</p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nSub customText2Col()\n\n    Dim startTime As Double\n\n    startTime = Timer\n\n    Dim startRng As Range, ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(1)\n\n    With ws\n        Set startRng = .Range(.Cells(1, \"A\"), .Cells(lastRow(ws), \"A\"))\n    End With\n\n    ' Place startRng's values into an array\n    Dim rawTxtArr, newTxtArr()\n    rawTxtArr = startRng\n    ReDim newTxtArr(1 To UBound(rawTxtArr), 1 To 2)\n\n    Dim i As Long, x As Long, tmpArr\n    For i = LBound(rawTxtArr) To UBound(rawTxtArr)\n        tmpArr = Split(rawTxtArr(i, 1))\n        newTxtArr(i, 1) = tmpArr(0)\n        For x = 1 To UBound(tmpArr)\n            newTxtArr(i, 2) = Trim(newTxtArr(i, 2) &amp; \" \" &amp; tmpArr(x))\n        Next x\n        Erase tmpArr\n    Next i\n\n    ws.Range(\"A1:B\" &amp; lastRow(ws)).Value = newTxtArr\n\n    MsgBox Timer - startTime\n\nEnd Sub\n\nFunction lastRow(ws As Worksheet, Optional col As Variant = 1) As Long\n    With ws\n        lastRow = .Cells(.Rows.Count, col).End(xlUp).Row\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10588116, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156547434125490/picture?type=large", "display_name": "Gavin Jansen Van Rensburg", "link": "https://stackoverflow.com/users/10588116/gavin-jansen-van-rensburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 53092126, "answer_count": 2, "score": 2, "last_activity_date": 1569850472, "creation_date": 1541019208, "last_edit_date": 1569850472, "question_id": 53091804, "link": "https://stackoverflow.com/questions/53091804/converting-three-word-string-into-two-strings", "title": "Converting Three Word String into Two Strings", "body": "<p>Is there a way to convert three names in a cell to two cells?</p>\n\n<p>For example A1 \"John Dory\" becomes A1 \"John\" B1 \"Dory\". The issue is when there are three words (middle names) it's automatically doing it for three cells. If it could be either the middle name in A1 or B1 that would be fine.</p>\n\n<pre><code>Selection.TextToColumns Destination:=Range(\"F1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _\n    :=Array(1, 1), TrailingMinusNumbers:=True\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1541020192, "post_id": 53091802, "comment_id": 93080757, "body": "Are you trying to do this programmatically? If yes, can you please <a href=\"https://stackoverflow.com/posts/53091802/edit\">edit your question</a> to give us the code you have so far? If no, then this question is better suited to <a href=\"https://superuser.com\">Superuser</a>"}, {"owner": {"reputation": 9, "user_id": 10588049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6c92acb9d4385099be451e6144c8c7?s=128&d=identicon&r=PG&f=1", "display_name": "Dirtyboness", "link": "https://stackoverflow.com/users/10588049/dirtyboness"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1541025228, "post_id": 53091802, "comment_id": 93082415, "body": "Sorry for the late response, I will update the question now."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10588049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6c92acb9d4385099be451e6144c8c7?s=128&d=identicon&r=PG&f=1", "display_name": "Dirtyboness", "link": "https://stackoverflow.com/users/10588049/dirtyboness"}, "edited": false, "score": 0, "creation_date": 1541343460, "post_id": 53103661, "comment_id": 93175749, "body": "It does! Thank you very much."}], "tags": [], "owner": {"reputation": 16, "user_id": 9752052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/63wcI.png?s=128&g=1", "display_name": "Aritra Karak", "link": "https://stackoverflow.com/users/9752052/aritra-karak"}, "is_accepted": true, "score": 0, "last_activity_date": 1541084041, "last_edit_date": 1541084041, "creation_date": 1541083662, "answer_id": 53103661, "question_id": 53091802, "link": "https://stackoverflow.com/questions/53091802/how-do-you-copy-a-worksheet-as-an-image-and-paste-it-into-a-specific-cell/53103661#53103661", "title": "How do you copy a worksheet as an Image and paste it into a specific cell?", "body": "<p>I figured out a way to paste the picture in the worksheet.</p>\n\n<p>The final code I got is :</p>\n\n<pre><code>Sub Save()\nWorksheets(\"Leads\").Range(\"A1:G14\").CopyPicture\nWorksheets(\"Combined\").Activate\nWorksheets(\"Combined\").Paste Destination:=Worksheets(\"Combined\").Range(\"C6:D6\")\n'So the image will be pasted at the destination range given\n'You may also add a cell address instead of cell range\nEnd Sub\n</code></pre>\n\n<p>Source - <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.paste\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.paste</a></p>\n\n<p>Hope this helps !</p>\n"}], "owner": {"reputation": 9, "user_id": 10588049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6c92acb9d4385099be451e6144c8c7?s=128&d=identicon&r=PG&f=1", "display_name": "Dirtyboness", "link": "https://stackoverflow.com/users/10588049/dirtyboness"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 53103661, "answer_count": 1, "score": -2, "last_activity_date": 1541084041, "creation_date": 1541019195, "last_edit_date": 1541025464, "question_id": 53091802, "link": "https://stackoverflow.com/questions/53091802/how-do-you-copy-a-worksheet-as-an-image-and-paste-it-into-a-specific-cell", "title": "How do you copy a worksheet as an Image and paste it into a specific cell?", "body": "<p>The Situation - I'm designing a method to pass down information from shift to shift. It needs to be rigid enough to stay standardized but flexible enough that  people can explain the myriad situations that occur. My idea is that they fill out their own worksheet and hit a save button that gathers this information into a centralized worksheet that shows all areas. </p>\n\n<p>The issue - I can't figure out how to save the worksheet and place it into the combined pass down, without making the combined pass down look atrocious. </p>\n\n<p>Attempted solution - I thought making the worksheet(filled out by employee) save itself as an image and paste to the combined worksheet but I'm having trouble Making it auto size the cell to fit the image.</p>\n\n<p>Ideal Solution - Making the cell size itself to fit the image automatically. </p>\n\n<p>I'm open for ideas on how to handle this differently. I'm fairly new to excel and most likely not aware of all the options available.</p>\n\n<p>CURRENT CODE:</p>\n\n<pre><code>Sub Save()\nWorksheets(\"Leads\").Range(\"A1:G14\").CopyPicture\n    Worksheets(\"Combined\").Activate\n    Worksheets(\"Combined\").Paste\n    CenterMe ActiveSheet.Shapes(1), Range(\"C6:D6\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot", "field", "rows"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1541019235, "post_id": 53091406, "comment_id": 93080404, "body": "Hello! I can&#39;t really understand what you are after. Could you please add the code you have, tell us what goes wrong and what is the desired output."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1541021909, "post_id": 53091406, "comment_id": 93081386, "body": "How to do this is well documented here on stack overflow. Please do some research, try to recreate others solutions to fit your needs, and come back with a specific problem if you need help along the way"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541024802, "post_id": 53091406, "comment_id": 93082303, "body": "Start by recording a macro while switching the fields, then take a look at what that gives you."}], "owner": {"reputation": 11, "user_id": 10576738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e44671cc74c4e37ff2b9ece904c53a?s=128&d=identicon&r=PG&f=1", "display_name": "jdood", "link": "https://stackoverflow.com/users/10576738/jdood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541017400, "creation_date": 1541017400, "question_id": 53091406, "link": "https://stackoverflow.com/questions/53091406/vba-pivottable-field-selection-excel", "title": "VBA PivotTable Field selection Excel", "body": "<p>How do you in VBA change the field selected in rows of your pivot table?  </p>\n\n<p>For example, I have a pivot table that has a rows dates field.  I want to select a different rows field that available via VBA.</p>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 3, "creation_date": 1541015760, "post_id": 53090966, "comment_id": 93079061, "body": "You can start by <a href=\"https://stackoverflow.com/q/10714251/5781745\">avoiding the use of <code>.Select</code></a>. Not only does this considerably slow down your code, but it also creates debugging headaches, as you&#39;ve witnessed."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1541015943, "post_id": 53090966, "comment_id": 93079151, "body": "Either use <code>Range(&quot;B:B&quot;).Insert ...</code> or <code>Sheets(&quot;Sheet1&quot;).columns(&quot;B:B&quot;).Insert ...</code> as the property needs a range or sheet."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1541017333, "post_id": 53090966, "comment_id": 93079711, "body": "FYI your function is called <code>columns</code> and you have (eg) <code>columns(&quot;B:B&quot;).Select</code> so that&#39;s what&#39;s triggering the error"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 2, "last_activity_date": 1541017467, "last_edit_date": 1541017467, "creation_date": 1541016575, "answer_id": 53091219, "question_id": 53090966, "link": "https://stackoverflow.com/questions/53090966/vba-macro-assigned-to-object-when-clicking-to-action-it-steps-into-code-and-tr/53091219#53091219", "title": "VBA: macro assigned to object, when clicking to action it steps into code and triggers -wrong number of arguments or invalid property assignment", "body": "<p>You can take that entire code you provided, and trim it down to this:</p>\n\n<pre><code>Sub insertColumns()\n\n    Dim ws As Worksheet, i As Long\n    Set ws = ThisWorkbook.Worksheets(1)\n\n    For i = 2 To 78 Step 2\n       ws.Columns(i).Insert\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Easy to read <em>- (which makes it easy to debug)</em> and no use of <code>.Select</code>.</p>\n\n<p>Replace the <code>1</code> in <code>Worksheets(1)</code> to either the <em>sheet index number</em> or the <em>sheet name (wrapped around doublequotes, <code>Worksheets(\"Sheet1\")</code></em></p>\n\n<hr>\n\n<p>You can make this dynamic if you'd like:</p>\n\n<pre><code>Sub insertColumns()\n\n    Dim ws As Worksheet, i As Long\n    Set ws = ThisWorkbook.Worksheets(1)\n\n    For i = 2 To LastColumn(ws) * 2 Step 2\n       ws.Columns(i).Insert\n    Next\n\nEnd Sub\n\nFunction LastColumn(ws As Worksheet, Optional rowNum As Long = 1)\n    With ws\n        LastColumn = .Cells(rowNum, .Columns.Count).End(xlToLeft).Column\n    End With\nEnd Function\n</code></pre>\n\n<p>This will determine how many <em>used columns</em> you have and loop through those - just multiply the <code>LastColumn</code> by 2 since you are adding columns.</p>\n"}, {"tags": [], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "is_accepted": false, "score": 0, "last_activity_date": 1541016966, "creation_date": 1541016966, "answer_id": 53091309, "question_id": 53090966, "link": "https://stackoverflow.com/questions/53090966/vba-macro-assigned-to-object-when-clicking-to-action-it-steps-into-code-and-tr/53091309#53091309", "title": "VBA: macro assigned to object, when clicking to action it steps into code and triggers -wrong number of arguments or invalid property assignment", "body": "<p>Good with a try! Modifying your code it could look like this:</p>\n\n<pre><code>Sub insert_column_nt_step()\nDim colinsert As Long\nDim Number_Step As Long\n\nNumber_Step = 2 'Number of step to jump after every insert\n\nFor colinsert = 2 To 78 Step Number_Step 'Start from Column 2 (Column B), to Column 78 (Column BZ)\n    Columns(colinsert).Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    'I actually kept the recording values.. don't know if you want to keep the formatting etc...\nNext colinsert\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10587795, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3BPo_zGnrJQ/AAAAAAAAAAI/AAAAAAAAAKQ/3dpgSz85EXk/photo.jpg?sz=128", "display_name": "David VNZuela", "link": "https://stackoverflow.com/users/10587795/david-vnzuela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1586414618, "creation_date": 1541015448, "last_edit_date": 1586414618, "question_id": 53090966, "link": "https://stackoverflow.com/questions/53090966/vba-macro-assigned-to-object-when-clicking-to-action-it-steps-into-code-and-tr", "title": "VBA: macro assigned to object, when clicking to action it steps into code and triggers -wrong number of arguments or invalid property assignment", "body": "<p>My VBA macro is assigned to an image from internet that i just pasted in my sheet</p>\n\n<p>My macro is suppose to do this:</p>\n\n<p>i have 40 columns with info, i want to add a column between column 1 and 2, 2 and 3.. and so on</p>\n\n<p>when i click on my image, excel steps into the code and once in that window, a small window appears saying: </p>\n\n<p>wrong number of arguments or invalid property assignment</p>\n\n<p>also highlighting the first row where the main body is, i mean this part:</p>\n\n<p>columns(\"B:B\").</p>\n\n<p>Would you please help me solve this?\nSorry for my amateur question</p>\n\n<pre><code>Sub columns()\n'\n' columns Macro\n'\n\n'\n    columns(\"B:B\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"D:D\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"F:F\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"H:H\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"J:J\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"L:L\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"N:N\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"P:P\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"R:R\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"T:T\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"V:V\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"X:X\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"Z:Z\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"AB:AB\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"AD:AD\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"AF:AF\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"AH:AH\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"AJ:AJ\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"AL:AL\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"AN:AN\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"AP:AP\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"AR:AR\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"AT:AT\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"AV:AV\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"AX:AX\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"AZ:AZ\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    ActiveWindow.SmallScroll ToRight:=34\n    columns(\"BB:BB\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"BD:BD\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"BF:BF\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"BH:BH\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"BJ:BJ\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"BL:BL\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"BN:BN\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"BP:BP\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"BR:BR\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"BT:BT\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"BV:BV\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"BX:BX\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    columns(\"BZ:BZ\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 27, "user_id": 4412059, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5d2513ba949193d4e306cec2773d2a96?s=128&d=identicon&r=PG&f=1", "display_name": "Baodbao", "link": "https://stackoverflow.com/users/4412059/baodbao"}, "edited": false, "score": 0, "creation_date": 1541016682, "post_id": 53090898, "comment_id": 93079484, "body": "I have almost 100000 lines to treat so any solution except vba which can help will be good also. I do have the code to duplicate the line by my concern is to add the duplicate condition."}], "answers": [{"comments": [{"owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "edited": false, "score": 0, "creation_date": 1541018425, "post_id": 53091099, "comment_id": 93080086, "body": "Impressive yet so simple."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1541016027, "creation_date": 1541016027, "answer_id": 53091099, "question_id": 53090898, "link": "https://stackoverflow.com/questions/53090898/duplicate-line-and-decrement-an-id/53091099#53091099", "title": "Duplicate line and decrement an ID", "body": "<p>This quick code will do what you want:</p>\n\n<pre><code>Sub myDup()\n    With Worksheets(\"Sheet3\") ' change to your sheet\n        Dim rngArr As Variant\n        rngArr = .Range(.Cells(1, 1), .Cells(.Rows.Count, 3).End(xlUp)).Value\n\n        Dim outarr As Variant\n        ReDim outarr(1 To Application.Sum(Application.Index(rngArr, 0, 3)), 1 To 3)\n\n        Dim k As Long\n        k = 1\n\n        Dim i As Long\n        For i = LBound(rngArr, 1) To UBound(rngArr, 1)\n            Dim j As Long\n            For j = 1 To rngArr(i, 3)\n                outarr(k, 1) = rngArr(i, 1)\n                outarr(k, 2) = rngArr(i, 2) - j + 1\n                outarr(k, 3) = rngArr(i, 3)\n                k = k + 1\n            Next j\n        Next i\n\n        .Range(\"A1\").Resize(UBound(outarr, 1), 3).Value = outarr\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4412059, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5d2513ba949193d4e306cec2773d2a96?s=128&d=identicon&r=PG&f=1", "display_name": "Baodbao", "link": "https://stackoverflow.com/users/4412059/baodbao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 53091099, "answer_count": 1, "score": 0, "last_activity_date": 1556715646, "creation_date": 1541015143, "last_edit_date": 1556715646, "question_id": 53090898, "link": "https://stackoverflow.com/questions/53090898/duplicate-line-and-decrement-an-id", "title": "Duplicate line and decrement an ID", "body": "<p>How can I repeat rows in a spreadsheet by number of times specified in a cell in that row and decrement an ID in the same row?</p>\n\n<p>E.g. from this table: </p>\n\n<pre><code>Column A    Column B   Column C  \nPeter       123         3   \nJames       32          7   \nDavid       90          4 \n</code></pre>\n\n<p>I need to produce this table: </p>\n\n<pre><code>Column A    Column B Column C  \nPeter       123         3   \nPeter       122         3   \nPeter       121         3   \nJames       32          7   \nJames       31          7   \nJames       30          7   \nJames       29          7   \nJames       28          7   \nJames       27          7   \nJames       26          7   \nDavid       90          4   \nDavid       89          4   \nDavid       88          4   \nDavid       87          4   \n</code></pre>\n\n<p>Find below the code I'm using. </p>\n\n<pre><code>Public Sub CopyData()\nDim rngSinglecell As Range\nDim rngQuantityCells As Range\nDim intCount As Integer\n\nSet rngQuantityCells = Range(\"C1\", Range(\"C1\").End(xlDown))\n\nFor Each rngSinglecell In rngQuantityCells\n    If IsNumeric(rngSinglecell.Value) Then\n        If rngSinglecell.Value &gt; 0 Then\n            For intCount = 1 To rngSinglecell.Value\n                Range(rngSinglecell.Address).EntireRow.Copy Destination:=Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n\n            Next\n        End If\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9458107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2515a94aefae8aa6ceaf374fa3ac3ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9458107/nick"}, "edited": false, "score": 0, "creation_date": 1541015034, "post_id": 53090823, "comment_id": 93078708, "body": "two quotes... i&#39;m almost in tears at how much time i&#39;ve spent trying to get this. Thank you SunKinight"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 3, "user_id": 9458107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2515a94aefae8aa6ceaf374fa3ac3ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9458107/nick"}, "edited": false, "score": 0, "creation_date": 1541015545, "post_id": 53090823, "comment_id": 93078972, "body": "@Nick If this solved your problem, please mark it solve by clicking the checkmark on the answer - This let&#39;s others know you no longer need assistance. Thanks!"}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": true, "score": 0, "last_activity_date": 1541014799, "creation_date": 1541014799, "answer_id": 53090823, "question_id": 53090805, "link": "https://stackoverflow.com/questions/53090805/access-vba-dmin-mutliple-criteria-type-mismatch-error/53090823#53090823", "title": "Access VBA DMin mutliple criteria, Type mismatch error", "body": "<pre><code>logid = DMin(\"ID\", \"tbl_QRCLDB_data\", \"[CommLogOwner]&lt;&gt;'\" &amp; UserID &amp; \"' And  \n[IntialReviewDate] is Null\")\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9458107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2515a94aefae8aa6ceaf374fa3ac3ea?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9458107/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 53090823, "answer_count": 1, "score": 0, "last_activity_date": 1541014799, "creation_date": 1541014708, "question_id": 53090805, "link": "https://stackoverflow.com/questions/53090805/access-vba-dmin-mutliple-criteria-type-mismatch-error", "title": "Access VBA DMin mutliple criteria, Type mismatch error", "body": "<p>I want to find the smallest ID value that is not owned by the current user and does not have a date. The first two statements work but when I join them together i get the mismatch error. ID is the key, userid as string, intialreviewdate as date, logid as long.</p>\n\n<pre><code>logid = DMin(\"ID\", \"tbl_QRCLDB_data\", \"[IntialReviewDate] Is Null\")\nlogid = DMin(\"ID\", \"tbl_QRCLDB_data\", \"[CommLogOwner]&lt;&gt; '\" &amp; UserID &amp; \"'\")\nlogid = DMin(\"ID\", \"tbl_QRCLDB_data\", \"[CommLogOwner]&lt;&gt;'\" &amp; UserID &amp; \"'\" And \" \n[IntialReviewDate] is Null\")\n</code></pre>\n\n<p>Any guidance or suggestions appreciated.Thank you.</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 6992, "user_id": 495157, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/UFMPn.png?s=128&g=1", "display_name": "JGFMK", "link": "https://stackoverflow.com/users/495157/jgfmk"}, "edited": false, "score": 0, "creation_date": 1541014816, "post_id": 53090521, "comment_id": 93078606, "body": "You may find pivot tables useful - not sure what data1/data2 represent... But also you may just use data ribbon &gt; List &gt; source drag over a2:a4 in your example - then repeat with another one for a5:a7 - see here <a href=\"https://www.techrepublic.com/blog/microsoft-office/how-to-add-a-drop-down-list-to-an-excel-cell/\" rel=\"nofollow noreferrer\">techrepublic.com/blog/microsoft-office/&hellip;</a>"}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1541017429, "post_id": 53090521, "comment_id": 93079742, "body": "Unfortunately I think you need to give a bigger data sample/set to give us a better view of the output. As far I understand you want to change the categorization from one column to another... (it looks like the Continent is your main category now and you want to re-categorize everything to Country, is this correct interpretation??). If that&#39;s the case, there are no easy way to re-categorize data...."}], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 8160581, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8R5U15A-1oc/AAAAAAAAAAI/AAAAAAAAA9w/q-8ULkBnIAc/photo.jpg?sz=128", "display_name": "Christopher", "link": "https://stackoverflow.com/users/8160581/christopher"}, "edited": false, "score": 0, "creation_date": 1541077106, "post_id": 53101611, "comment_id": 93098972, "body": "Thank you. I&#39;m reaching the same conclusion that a pivot table may have to be the simplest solution unless there is some VBA magic."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 48, "user_id": 8160581, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8R5U15A-1oc/AAAAAAAAAAI/AAAAAAAAA9w/q-8ULkBnIAc/photo.jpg?sz=128", "display_name": "Christopher", "link": "https://stackoverflow.com/users/8160581/christopher"}, "edited": false, "score": 0, "creation_date": 1541077472, "post_id": 53101611, "comment_id": 93099176, "body": "There&#39;s some VBA magic, but if you aren&#39;t comfortable with VBA it would be a beast to maintain."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1541076524, "creation_date": 1541076524, "answer_id": 53101611, "question_id": 53090521, "link": "https://stackoverflow.com/questions/53090521/transform-excel-table-using-column-value-as-category/53101611#53101611", "title": "Transform Excel Table Using Column Value as Category", "body": "<p>I know this isn't exactly what you want, but it might be a compromise that gets you close without forcing you to write VBA to pull this off, which is probably the only real way to get exactly what you are looking for. </p>\n\n<p>You can create a pivot table here and put <code>Role</code> in the Columns, <code>Name</code> in the Rows, and <code>Name</code> again in the <code>Values</code> and you will get a <code>1</code> if a name falls in a particular <code>Role</code>. You can swap <code>Role</code> out easily using the pivot table with <code>Level</code> or <code>Laptop</code> or whatever.</p>\n\n<p>You may be able to build some formulas that feed from this pivot table to get exactly what you need, but again... that will be quite a bit more effort:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tw0BI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tw0BI.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 41696, "user_id": 680068, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/73fd13cfacc3a0a0fc0a8c95f50d8a3f?s=128&d=identicon&r=PG", "display_name": "zx8754", "link": "https://stackoverflow.com/users/680068/zx8754"}, "is_accepted": false, "score": 0, "last_activity_date": 1541082600, "creation_date": 1541082600, "answer_id": 53103349, "question_id": 53090521, "link": "https://stackoverflow.com/questions/53090521/transform-excel-table-using-column-value-as-category/53103349#53103349", "title": "Transform Excel Table Using Column Value as Category", "body": "<p>I think this can be done using formulas. Might be too much work and even harder to maintain, but these two links should be a good start (sorry have no time to provide full answer):</p>\n\n<ul>\n<li><a href=\"https://exceljet.net/formula/extract-unique-items-from-a-list\" rel=\"nofollow noreferrer\">get unique list</a></li>\n<li><a href=\"https://www.get-digital-help.com/2009/09/28/extract-all-rows-from-a-range-that-meet-criteria-in-one-column-in-excel/\" rel=\"nofollow noreferrer\">subset matching rows</a></li>\n</ul>\n"}], "owner": {"reputation": 48, "user_id": 8160581, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8R5U15A-1oc/AAAAAAAAAAI/AAAAAAAAA9w/q-8ULkBnIAc/photo.jpg?sz=128", "display_name": "Christopher", "link": "https://stackoverflow.com/users/8160581/christopher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1541082600, "creation_date": 1541013382, "last_edit_date": 1541076981, "question_id": 53090521, "link": "https://stackoverflow.com/questions/53090521/transform-excel-table-using-column-value-as-category", "title": "Transform Excel Table Using Column Value as Category", "body": "<p>I have an Excel table with data structured similar to:</p>\n\n<pre><code>Name                 Team        Role        Level   Laptop Monitor\nCheryle Parish       Archers     Programmer  Level2  Dell   2\nShandi Kime          Archers     Programmer  Level2  Dell   1\nEdwardo Cookson      Archers     Programmer  Level1  HP     3\nVoncile Deak         Archers     Programmer  Level2  HP     3\nBoyd Cueva           Climbers    Tester      Level2  HP     2\nCaryn Kear           Climbers    Programmer  Level2  Apple  1\nKirsten Hirt         Climbers    Tester      Level2  Apple  3\nAyana Mayfield       Climbers    Programmer  Level2  Dell   2\nVenetta Embree       Archers     Programmer  Level2  Dell   3\nHerb Obryan          Archers     Programmer  Level2  Dell   2\nIsobel Steinmetz     Explorers   Tester      Level2  Apple  3\nValeri Eisen         Explorers   Programmer  Level1  Dell   1\nAnibal Plumlee       Explorers   Programmer  Level1  Dell   3\nFloretta Tunney      Explorers   Tester      Level1  Apple  1\nLilliana Klutts      Explorers   Programmer  Level1  HP     2\nGaston Custodio      Explorers   Programmer  Level1  HP     2\nJared  Phaneuf       Explorers   Manager     Level1  Dell   3\nMelvin Monsivais     Climbers    Manager     Level2  HP     2\n</code></pre>\n\n<p>Is there any simple way to create a new table or tables where one of the columns represents the categories and the values in that column are the values in another column? For example, the above list if I chose \"Role\" the output table(s) are:</p>\n\n<pre><code>Programmer           Manager              Tester\nCheryle Parish       Jared  Phaneuf       Boyd Cueva           \nShandi Kime          Melvin Monsivais     Floretta Tunney      \nEdwardo Cookson                           Isobel Steinmetz     \nVoncile Deak                              Kirsten Hirt         \nCaryn Kear\nAyana Mayfield\nVenetta Embree       \nHerb Obryan          \nValeri Eisen         \nAnibal Plumlee       \nLilliana Klutts      \nGaston Custodio      \n</code></pre>\n\n<p>The other entries in the source table are thrown away in the new tables. Ideally if there are any duplicates, the duplicates are ignored and the new tables only have unique values. A VBA solution would work, trying to avoid an external program.</p>\n\n<p>We could choose any of the columns to be the category for classification in the new tables. For example, we could generate a lists of whoever has a particular laptop brand.</p>\n\n<p>The closest I can come up with is to use pivot tables to generate something that would still need copy-and-paste type editing. </p>\n\n<pre><code>Manager     Jared  Phaneuf\n            Melvin Monsivais\nProgrammer  Anibal Plumlee\n            Ayana Mayfield\n            Caryn Kear\n            Cheryle Parish\n            Edwardo Cookson\n            Gaston Custodio\n            Herb Obryan\n            Lilliana Klutts\n            Shandi Kime\n            Valeri Eisen\n            Venetta Embree\n            Voncile Deak\nTester      Boyd Cueva\n            Floretta Tunney\n            Isobel Steinmetz\n            Kirsten Hirt\n</code></pre>\n\n<p>I found this question which is similar <a href=\"https://stackoverflow.com/questions/49745449/excel-categorize-table-by-column\">Excel Categorized table by column</a>, but the answer doesn't solve the above problem.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1541015300, "post_id": 53090094, "comment_id": 93078850, "body": "<code>Columns(&quot;A:A&quot;).UnMerge</code> you can&#39;t just unmerge A &amp; D"}, {"owner": {"reputation": 59, "user_id": 3741288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74584ec38e22e1da00397ab7cdecb0af?s=128&d=identicon&r=PG&f=1", "display_name": "geoabram", "link": "https://stackoverflow.com/users/3741288/geoabram"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1541047972, "post_id": 53090094, "comment_id": 93087041, "body": "Thanks. That worked!"}], "answers": [{"tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 2, "last_activity_date": 1541012221, "creation_date": 1541012221, "answer_id": 53090257, "question_id": 53090094, "link": "https://stackoverflow.com/questions/53090094/unable-to-unmerge-cells-using-excel-vba/53090257#53090257", "title": "Unable to Unmerge Cells Using Excel VBA", "body": "<p>You want to set the <code>MergeCells</code> property to <code>False</code>:</p>\n\n<pre><code>sheet5.Range(\"A1\", \"A2783\").MergeCells = False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2299, "user_id": 4361999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7BvMf.jpg?s=128&g=1", "display_name": "JMP", "link": "https://stackoverflow.com/users/4361999/jmp"}, "is_accepted": false, "score": 0, "last_activity_date": 1591589933, "last_edit_date": 1591589933, "creation_date": 1591589548, "answer_id": 62254900, "question_id": 53090094, "link": "https://stackoverflow.com/questions/53090094/unable-to-unmerge-cells-using-excel-vba/62254900#62254900", "title": "Unable to Unmerge Cells Using Excel VBA", "body": "<p>The <code>UnMerge</code> method should be called on the <code>Range</code> object returned by the <code>MergeArea</code> property of a <code>Range</code> object.</p>\n\n<p>Also,</p>\n\n<blockquote>\n  <p>The MergeArea property only works on a single-cell range.\n  so write:</p>\n</blockquote>\n\n<pre><code>If sheet5.Range(\"A1\").MergeCells Then \nsheet5.Range(\"A1\").MergeArea.UnMerge\n</code></pre>\n\n<p>instead.</p>\n\n<p>Ref:</p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.mergearea\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.mergearea</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.unmerge\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.unmerge</a></li>\n</ul>\n"}], "owner": {"reputation": 59, "user_id": 3741288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74584ec38e22e1da00397ab7cdecb0af?s=128&d=identicon&r=PG&f=1", "display_name": "geoabram", "link": "https://stackoverflow.com/users/3741288/geoabram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1591589933, "creation_date": 1541011536, "last_edit_date": 1586755729, "question_id": 53090094, "link": "https://stackoverflow.com/questions/53090094/unable-to-unmerge-cells-using-excel-vba", "title": "Unable to Unmerge Cells Using Excel VBA", "body": "<p>I have data in an Excel worksheet. Four of the columns have merged cells. I have to unmerge two columns (\"A\" and \"D\") and put data in the unmerged cells based on certain conditions. My attempt to unmerge specific column using following code did not unmerge the cells or return any error message</p>\n\n<pre><code>If sheet5.Range(\"A1\", \"A2783\").MergeCells Then \nsheet5.Range(\"A1\", \"A2783\").MergeCells.UnMerge\n</code></pre>\n\n<p>Then I tried this</p>\n\n<pre><code>If ActiveSheet.Cells.MergeCells Then \nsht.Cells.UnMerge\n</code></pre>\n\n<p>but that also did not unmerge the cells or return any error message. </p>\n\n<p>Any pointers please?</p>\n"}, {"tags": ["arrays", "vba", "loops"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1541010379, "post_id": 53089799, "comment_id": 93076641, "body": "<code>LBound(myArray)</code> is 0. So <code>Range(&quot;O&quot; &amp; i)</code> becomes <code>Range(&quot;O&quot; &amp; 0)</code>, which is not a valid address."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1541010518, "post_id": 53089799, "comment_id": 93076702, "body": "<code>Range(&quot;O&quot; &amp; myarray(i))</code>"}, {"owner": {"reputation": 1, "user_id": 4174427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71a798b5e47508032e763c846d026c7?s=128&d=identicon&r=PG&f=1", "display_name": "GlenAllan", "link": "https://stackoverflow.com/users/4174427/glenallan"}, "edited": false, "score": 0, "creation_date": 1541010708, "post_id": 53089799, "comment_id": 93076789, "body": "urdearboy, thanks for your comment! it works!"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1541014654, "creation_date": 1541014654, "answer_id": 53090793, "question_id": 53089799, "link": "https://stackoverflow.com/questions/53089799/loop-through-array-number-values/53090793#53090793", "title": "loop through array number values", "body": "<p>Here are a few things to consider:</p>\n\n<ol>\n<li>Make sure the <code>SelectionChange</code> only involves one cell since your code is not set up to handle multiple cells. </li>\n<li>You do not need 3 individual <code>IF</code> statements. This has been reduced from 3 <code>IF</code> statements to 2 (where one makes use of the <code>ElseIf</code>)</li>\n<li>As discussed in comments, <code>i</code> just shows the index of your array. If you want the value of the index, you need to use <code>myarray(i)</code></li>\n<li>Add <code>Option Explicit</code> to top of your code. Your variable <code>answer</code> needs to be declared </li>\n</ol>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nDim i As Long, myarray As Variant, answer As Variant\n\nIf Target.Count &gt; 1 Then Exit Sub\n\nmyarray = Array(122, 123)\n\nFor i = LBound(myarray) To UBound(myarray)\n    If Range(\"O\" &amp; myarray(i)) &lt;&gt; 0 Then\n        answer = MsgBox(\"Price Change. Are you sure?\", vbYesNo)\n\n        If answer = vbNo Then\n            Range(\"F\" &amp; myarray(i)).Formula = \"=IFERROR(VLOOKUP($B\" &amp; myarray(i) &amp; \",eac_equipment_list!$P:$S,2,FALSE),\"\"\"\")\"\n        ElseIf answer = vbYes Then\n            Range(\"O\" &amp; myarray(i)) = 0\n        End If\n\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4174427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71a798b5e47508032e763c846d026c7?s=128&d=identicon&r=PG&f=1", "display_name": "GlenAllan", "link": "https://stackoverflow.com/users/4174427/glenallan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541014654, "creation_date": 1541010131, "last_edit_date": 1541010430, "question_id": 53089799, "link": "https://stackoverflow.com/questions/53089799/loop-through-array-number-values", "title": "loop through array number values", "body": "<p>the code is breaking at the first if statement. worksheet range error. attempting to loop through myarray. myarray is an array of integers. thanks!</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim i As Long, myarray As Variant\n\n    myarray = Array(122, 123)\n\n    For i = LBound(myarray) To UBound(myarray)\n        If Range(\"O\" &amp; i) &lt;&gt; 0 Then\n            answer = MsgBox(\"Price Change. Are you sure?\", vbYesNo)\n        End If\n\n        If answer = vbNo Then\n            Range(\"F\" &amp; i).Formula = \"=IFERROR(VLOOKUP($B\" &amp; i &amp; \",eac_equipment_list!$P:$S,2,FALSE),\"\"\"\")\"\n        End If\n\n        If answer = vbYes Then\n            Range(\"O\" &amp; i) = \"0\"\n\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "adobe-illustrator"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1541172830, "post_id": 53089590, "comment_id": 93137564, "body": "You can try looking at <a href=\"https://github.com/Silly-V/Adobe-Illustrator/blob/master/Variable%20Importer/VariableImporter.jsx\" rel=\"nofollow noreferrer\">this</a> and  <a href=\"https://sttk3.com/blog/tips/illustrator/duplicate-graph-data.html\" rel=\"nofollow noreferrer\">this</a>, but most people seem more interested in Importing data to Illustrator."}], "answers": [{"tags": [], "owner": {"reputation": 771, "user_id": 2864371, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/202303516/picture?type=large", "display_name": "Vasily Hall", "link": "https://stackoverflow.com/users/2864371/vasily-hall"}, "is_accepted": false, "score": 0, "last_activity_date": 1541128816, "creation_date": 1541128816, "answer_id": 53112246, "question_id": 53089590, "link": "https://stackoverflow.com/questions/53089590/converting-importing-illustrator-files-into-excel/53112246#53112246", "title": "Converting/importing Illustrator files into Excel", "body": "<p>This could be a real fun task. So, fortunately with some Illustrator scripting, it's possible to 'extract' this data from the documents and into a text format. Unfortunately this format is Illustrator-variable-data XML syntax type of file which may be possible to use XSLT on or using some code to parse (or edit first and then parse) the Ai-XML structure.</p>\n\n<p>But before you even get there, the scripting task which would lie ahead would be to batch-process all your documents and during this process find all the graphs in a document and create a new graph-data variable for every one of them and create a new data-set. Then you'll have your script export the variables .xml files which you will later need to also work-over in some kind of way to suit your needs.</p>\n\n<p>All this is assuming that you don't already have variable-data-sets in your documents in the first place, and if they do then it may take some additional work to erase the old variables and re-attach them in the fashion you prefer. Or it may be that your documents have a single data-set already in place how you need, in which case it may make it all slightly less work.</p>\n\n<p>I hope this helps!</p>\n"}], "owner": {"reputation": 21, "user_id": 10586903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eff9ec1c170ca094612b4ff0f1a3615f?s=128&d=identicon&r=PG&f=1", "display_name": "djuncos", "link": "https://stackoverflow.com/users/10586903/djuncos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1439, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1550123812, "creation_date": 1541009249, "last_edit_date": 1550123812, "question_id": 53089590, "link": "https://stackoverflow.com/questions/53089590/converting-importing-illustrator-files-into-excel", "title": "Converting/importing Illustrator files into Excel", "body": "<p>I have hundreds of Illustrator .ai files that are picture graphs. The underlying numerical data in the graphs appears in the following format:</p>\n\n<p>Illustrator<br>\n<a href=\"https://i.stack.imgur.com/oGuAG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oGuAG.jpg\" alt=\"Illustrator\"></a></p>\n\n<p>Is there any way to mass convert all the data \"tables\" from Illustrator into Excel?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1541009612, "post_id": 53089536, "comment_id": 93076285, "body": "does the row order matter?"}, {"owner": {"reputation": 835, "user_id": 1301888, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/L7u8U.jpg?s=128&g=1", "display_name": "Cilantro Ditrek", "link": "https://stackoverflow.com/users/1301888/cilantro-ditrek"}, "reply_to_user": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1541009763, "post_id": 53089536, "comment_id": 93076364, "body": "Ideally, I&#39;d like to be able to sort the third worksheet (i.e., sort &#39;Value&#39; from lowest to highest). It&#39;s more important that the information in each row stay together."}, {"owner": {"reputation": 2648, "user_id": 6230407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IgdHF.jpg?s=128&g=1", "display_name": "Marco Vos", "link": "https://stackoverflow.com/users/6230407/marco-vos"}, "edited": false, "score": 0, "creation_date": 1541010171, "post_id": 53089536, "comment_id": 93076552, "body": "This is easy to do with Power Query (Get &amp; Transform). This method will convert the columns in the original two worksheets into tables. Is that a problem for you?"}, {"owner": {"reputation": 835, "user_id": 1301888, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/L7u8U.jpg?s=128&g=1", "display_name": "Cilantro Ditrek", "link": "https://stackoverflow.com/users/1301888/cilantro-ditrek"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1541011242, "post_id": 53089536, "comment_id": 93077048, "body": "Thanks @ScottHoltzman for giving constructive feedback. I have made my question more specific and will go through the resources you provided. (For reference, my original post ended with the question &quot;Is there a way to combine these and have it dynamically update?&quot;)"}, {"owner": {"reputation": 835, "user_id": 1301888, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/L7u8U.jpg?s=128&g=1", "display_name": "Cilantro Ditrek", "link": "https://stackoverflow.com/users/1301888/cilantro-ditrek"}, "reply_to_user": {"reputation": 2648, "user_id": 6230407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IgdHF.jpg?s=128&g=1", "display_name": "Marco Vos", "link": "https://stackoverflow.com/users/6230407/marco-vos"}, "edited": false, "score": 0, "creation_date": 1541011618, "post_id": 53089536, "comment_id": 93077197, "body": "@MarcoVos I would be happy to use tables as long as two criteria were met. 1) I need to be able to add rows to the original two worksheets and have those changes propogate into the tables. 2) I need the combined third table to populate a worksheet. I&#39;m happy to have the tables all live in some fourth worksheet, as long as I can meet those requirements."}], "answers": [{"tags": [], "owner": {"reputation": 2648, "user_id": 6230407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IgdHF.jpg?s=128&g=1", "display_name": "Marco Vos", "link": "https://stackoverflow.com/users/6230407/marco-vos"}, "is_accepted": true, "score": 6, "last_activity_date": 1541015601, "last_edit_date": 1541015601, "creation_date": 1541013332, "answer_id": 53090511, "question_id": 53089536, "link": "https://stackoverflow.com/questions/53089536/dynamically-combine-two-sheets-into-one/53090511#53090511", "title": "Dynamically combine two sheets into one", "body": "<p>Execute the following procedure for both sheets.</p>\n\n<ol>\n<li>Select a value in one of the columns.</li>\n<li>Goto the Data tab and select <code>From Table</code> in the Get and Transform group. Click OK.</li>\n<li>In the Query Editor select <code>Close &amp; Load to</code> from the dropdown menu Close &amp; Load on the Home tab. In the Load To dialogbox select <code>Only Create Connection</code> and click Load.</li>\n</ol>\n\n<p>After doing this for both sheets, you should now see the following two queries in the Workbook Queries pane.</p>\n\n<p><a href=\"https://i.stack.imgur.com/oPd16.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oPd16.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"4\">\n<li>Right-click on the Table1 query and select Append. Select Table2 in the bottom dropdown box. Click OK.</li>\n<li>In the Query Editor click Close &amp; Load (the icon, not the dropdown menu).</li>\n</ol>\n\n<p>You now have the table you wanted. After adding rows to Table1 and/or Table2, the new table Append1 will update when you click the Refresh button on the Data-tab.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ze2Ov.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ze2Ov.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 835, "user_id": 1301888, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/L7u8U.jpg?s=128&g=1", "display_name": "Cilantro Ditrek", "link": "https://stackoverflow.com/users/1301888/cilantro-ditrek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2851, "favorite_count": 1, "accepted_answer_id": 53090511, "answer_count": 1, "score": 1, "last_activity_date": 1594210113, "creation_date": 1541009017, "last_edit_date": 1594210113, "question_id": 53089536, "link": "https://stackoverflow.com/questions/53089536/dynamically-combine-two-sheets-into-one", "title": "Dynamically combine two sheets into one", "body": "<p>I have a similar question to this one: <a href=\"https://stackoverflow.com/questions/9923385/combine-2-excel-tables-into-one-appending-the-data/32680703#32680703\">Combine 2 Excel tables into one appending the data?</a></p>\n<p>If I have the following 2 worksheets:</p>\n<p><a href=\"https://i.stack.imgur.com/85bPQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/85bPQ.png\" alt=\"enter image description here\" /></a></p>\n<p><a href=\"https://i.stack.imgur.com/3Sh0a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3Sh0a.png\" alt=\"enter image description here\" /></a></p>\n<p>I want to have a third sheet that looks like:</p>\n<p><a href=\"https://i.stack.imgur.com/zxW21.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zxW21.png\" alt=\"enter image description here\" /></a></p>\n<p>How do I create the third worksheet from the original two worksheets? If I add a row to one of the first two worksheets, would the third worksheet automatically update?</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "ui-automation"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1541030637, "post_id": 53089386, "comment_id": 93083784, "body": "There&#39;s no <code>While .Busy</code> or <code>With</code> block in your posted code.  Still , just calling <code>Navigate</code> and then waiting ten seconds should be enough to load the page.  If your code still doesn&#39;t work even when the page is loaded, there&#39;s not much we can do without a URL or the source HTML."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541070837, "post_id": 53089386, "comment_id": 93095767, "body": "You may also need to .Focus the element first."}, {"owner": {"reputation": 369, "user_id": 10007958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tnn1Xkvrm7M/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3JqdPFR4yfzZknbJQH3q3B1Dbzpg/mo/photo.jpg?sz=128", "display_name": "swagless_monk", "link": "https://stackoverflow.com/users/10007958/swagless-monk"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541078486, "post_id": 53089386, "comment_id": 93099806, "body": "@QHarr , what will that do?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541078756, "post_id": 53089386, "comment_id": 93099963, "body": "Sometimes you need to Focus an input element in order to add a value."}, {"owner": {"reputation": 369, "user_id": 10007958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tnn1Xkvrm7M/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3JqdPFR4yfzZknbJQH3q3B1Dbzpg/mo/photo.jpg?sz=128", "display_name": "swagless_monk", "link": "https://stackoverflow.com/users/10007958/swagless-monk"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541079122, "post_id": 53089386, "comment_id": 93100169, "body": "@TimWilliams , Here is the field I want to fill      [&lt;INPUT id=accountCode maxLength=32 name=accountCode&gt;]."}, {"owner": {"reputation": 369, "user_id": 10007958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tnn1Xkvrm7M/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3JqdPFR4yfzZknbJQH3q3B1Dbzpg/mo/photo.jpg?sz=128", "display_name": "swagless_monk", "link": "https://stackoverflow.com/users/10007958/swagless-monk"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541079186, "post_id": 53089386, "comment_id": 93100207, "body": "@QHarr , can you show me syntax? I wouldn&#39;t know where to use that function"}], "answers": [{"comments": [{"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1541126519, "post_id": 53107026, "comment_id": 93119023, "body": "In your previous answer, you had mentioned that code is working find on local machine. If you mean that there is no issue with the code posted in the original post then i suggest you to mark your last answer as an answer to close this thread."}], "tags": [], "owner": {"reputation": 369, "user_id": 10007958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tnn1Xkvrm7M/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3JqdPFR4yfzZknbJQH3q3B1Dbzpg/mo/photo.jpg?sz=128", "display_name": "swagless_monk", "link": "https://stackoverflow.com/users/10007958/swagless-monk"}, "is_accepted": true, "score": 0, "last_activity_date": 1541096000, "creation_date": 1541096000, "answer_id": 53107026, "question_id": 53089386, "link": "https://stackoverflow.com/questions/53089386/using-excel-vba-to-automate-form-filling-in-internet-explorer/53107026#53107026", "title": "Using Excel VBA to automate form filling in Internet Explorer", "body": "<p>UPDATE: Turns out the reason this wasn't working is because there are some settings in the HTML of the site that do not allow for the automation to occur, so any code versions I had were correct but they were doomed to fail. So you were correct in that regard @TimWilliams.</p>\n\n<p>I know this because the website I was trying to access is on a secure server/virtual machine. I edited the code to fill in the google search bar and it did not work on the virtual machine however when I ran the same code locally, it worked fine. </p>\n"}], "owner": {"reputation": 369, "user_id": 10007958, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tnn1Xkvrm7M/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3JqdPFR4yfzZknbJQH3q3B1Dbzpg/mo/photo.jpg?sz=128", "display_name": "swagless_monk", "link": "https://stackoverflow.com/users/10007958/swagless-monk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1854, "favorite_count": 0, "accepted_answer_id": 53107026, "answer_count": 1, "score": 0, "last_activity_date": 1586414654, "creation_date": 1541008480, "last_edit_date": 1586414654, "question_id": 53089386, "link": "https://stackoverflow.com/questions/53089386/using-excel-vba-to-automate-form-filling-in-internet-explorer", "title": "Using Excel VBA to automate form filling in Internet Explorer", "body": "<p>I want to take values from an excel sheet and store them in an array. I then want to take the values from the array and use them to fill the web form. </p>\n\n<p>I have managed to store the values in the array and I have managed to get VBA to open Internet Explorer (IE)</p>\n\n<p>The code runs and no errors appear, but the text fields are not being populated, nor is the button being clicked</p>\n\n<p>(The debugger points to <code>[While .Busy]</code> as the error source, located in the <code>WITH</code> block)</p>\n\n<p>How do I go about filling the form (that has a total of 3 text boxes to fill)?</p>\n\n<p>There is also a drop down menu that I need to choose a value from, but I need to fill the text boxes prior to moving on to that part of the task.</p>\n\n<pre><code>Sub CONNECT_TO_IE()\nthe_start:   \nDim ie As Object\nDim objElement As Object\nDim objCollection As Object\n\n\n\n\nacct = GET_CLIENT_NAME()\nname = GET_CODE()\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\n\n\nie.Visible = True\nie.navigate (\"&lt;&lt;my_website&gt;&gt;\")\n   ie.FullScreen = False\n\n    On Error Resume Next\n       Do\n       DoEvents\n       If Err.Number &lt;&gt; 0 Then\n       ie.Quit\n       Set ie = Nothing\n       GoTo the_start:\n       End If\n       Loop Until ie.readystate = 4\n\nApplication.Wait Now + TimeValue(\"00:00:10\")\n\nie.Document.getElementbyid(\"&lt;&lt;field_1&gt;&gt;\").Value = \"PPP\"\nie.Document.getElementbyid(\"&lt;&lt;field_2&gt;&gt;\").Value = \"PPP\"\nie.Document.getElementbyid(\"&lt;&lt;field_3&gt;&gt;\").Click\n\n\nSet ie = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1541008926, "post_id": 53088891, "comment_id": 93075969, "body": "Have you tried using a more modern driver? <code>{SQL Server}</code> is ancient, it&#39;s the default driver that came with Windows 98. While it has been updated a bit, it&#39;s no longer supported for new development.  You can download a new one <a href=\"https://docs.microsoft.com/en-us/sql/connect/odbc/microsoft-odbc-driver-for-sql-server\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1541009243, "post_id": 53088891, "comment_id": 93076119, "body": "We may need to see the full T-SQL script (which by the way, VBA can read directly from a text file into a string to avoid concatenation and line breaks). Also, consider using a stored procedure for complex routines. Finally, cursor loops are not the recommended approach for a set-based, declarative language like SQL. You may not need loops or run them at application layer (i.e., VBA)!"}, {"owner": {"reputation": 53, "user_id": 9798745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a5ed744e80abfd17cfb9a111f4bbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/9798745/gavin"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1541014169, "post_id": 53088891, "comment_id": 93078264, "body": "@ErikvonAsmuth I must admit I know nothing about drivers. I&#39;ll download it and give it a go though."}, {"owner": {"reputation": 53, "user_id": 9798745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a5ed744e80abfd17cfb9a111f4bbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/9798745/gavin"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1541014337, "post_id": 53088891, "comment_id": 93078356, "body": "@Parfait I didnt know that about cursors, I know they are a bit of a pain to set up, but is there a technical reason they aren&#39;t the preferred methodology? Now that I&#39;ve found out about stored procedures I&#39;m going to give that a try. I assume it is run in the same style as my current code, just that the loop this time is in VBA?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1541016217, "post_id": 53088891, "comment_id": 93079271, "body": "Can you post the full T-SQL block outside of VBA? We will help format code."}, {"owner": {"reputation": 53, "user_id": 9798745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a5ed744e80abfd17cfb9a111f4bbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/9798745/gavin"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1541064309, "post_id": 53088891, "comment_id": 93092521, "body": "Thanks @Parfait. The answer below works, which I will use to hit my deadline and keep the client and PM off my back. I&#39;m going to change our process over into a stored procedure over the weekend. Thanks for the offer of help to format the code, I&#39;ll attempt setting it all up myself first, I like to try things myself first before getting too much help."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 9798745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a5ed744e80abfd17cfb9a111f4bbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/9798745/gavin"}, "edited": false, "score": 0, "creation_date": 1541063981, "post_id": 53089186, "comment_id": 93092366, "body": "Thanks that works. Not quite sure I understand why though. Are you able to explain what turning off the &quot;No. of Rows affected&quot; message does, and why that would allow the code to keep running?"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 53, "user_id": 9798745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a5ed744e80abfd17cfb9a111f4bbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/9798745/gavin"}, "edited": false, "score": 1, "creation_date": 1541077885, "post_id": 53089186, "comment_id": 93099432, "body": "@Gavin - I couldn&#39;t fit my comments in a comment, so I added them to the answer. Hope it helps :-)"}], "tags": [], "owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "is_accepted": true, "score": 3, "last_activity_date": 1541077851, "last_edit_date": 1541077851, "creation_date": 1541007568, "answer_id": 53089186, "question_id": 53088891, "link": "https://stackoverflow.com/questions/53088891/sql-query-stops-running-when-sent-from-access-vba/53089186#53089186", "title": "SQL Query stops running when sent from Access VBA", "body": "<p>Start your SQL script with the <code>SET NOCOUNT ON;</code> Statement;</p>\n\n<p>This will supress all server messaging and allow the result set into the recordset you are opening.</p>\n\n<pre><code>....\nSQL_STR1 = \"SET NOCOUNT ON; \" &amp; vbCrLf &amp; _\n           \"DECLARE @STRSQL AS Varchar(max) \" &amp; vbCrLf &amp; _\n           \"DECLARE @TableName VARCHAR(50) \" &amp; vbCrLf &amp; _\n           \"DECLARE LoopVal CURSOR FOR SELECT TableName_ FROM [DBASE_NAME].[dbo].[a_Base_Year_Matrices] \" &amp; vbCrLf &amp; _\n           \"OPEN LoopVal \" &amp; vbCrLf &amp; _\n           \"FETCH NEXT FROM LoopVal INTO @TableName \" &amp; vbCrLf &amp; _\n           \"WHILE @@FETCH_STATUS = 0 \" &amp; vbCrLf &amp; _\n           \"BEGIN \" &amp; vbCrLf &amp; _\n....\n</code></pre>\n\n<p><code>SET NOCOUNT ON</code> suppresses the \"xx rows affected\" message after any DML. This is a resultset and when sent, the client (your ADO Recordset in this case) must process it. Put simply, a recordset object does not handle these server messages - it is expecting a cursor that represents records from a base table, the results of a query, or a previously saved Recordset. When your recordset gets server messages back, it will simply give you an empty recordset. I would guess your VBA is not expecting an empty recordset and you have some block of code that is getting stuck when this condition happens? Hard to say without seeing ALL the VBA. </p>\n\n<p>Setting NoCount ON makes the server skip to the good stuff - in this case the results of a query - which the recordset object IS meant to handle.</p>\n"}], "owner": {"reputation": 53, "user_id": 9798745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a5ed744e80abfd17cfb9a111f4bbd6?s=128&d=identicon&r=PG&f=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/9798745/gavin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 53089186, "answer_count": 1, "score": 0, "last_activity_date": 1594626759, "creation_date": 1541006334, "last_edit_date": 1594626759, "question_id": 53088891, "link": "https://stackoverflow.com/questions/53088891/sql-query-stops-running-when-sent-from-access-vba", "title": "SQL Query stops running when sent from Access VBA", "body": "<p>I have an access vba code which runs a query in SQL Server 14.0. However it gets about 20 minutes through before just stopping the query and moving onto the next line of my vba code.</p>\n\n<p>If I copy the code directly into SQL and run it there it runs properly with no issues. I originally thought this was due to either a connection or command timeout, however usually this should have generated an error message (and even so I have set the timeouts to 0 to force them to run indefinitely).</p>\n\n<p>Please find my code below, it uses a Cursor to loop through a range of tables to complete the same task. This task involves looping through a Do While until the conditions are met. At this point the loop should finish and start on the next table. </p>\n\n<p>It does complete 3 of the cursor loops, but then it starts the next one and then just stops.</p>\n\n<p>Hopefully the code makes sense, it is quite lengthy in access and I have had to split it all up using line breaks to make my SQL string easier to decipher and (attempt) to debug.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>''...Declare all relevant variables above...\n\nOn Error GoTo 0\n\nSQL_STR1 = \"DECLARE @STRSQL AS Varchar(max) \" &amp; vbCrLf &amp; _\n           \"DECLARE @TableName VARCHAR(50) \" &amp; vbCrLf &amp; _\n           \"DECLARE LoopVal CURSOR FOR SELECT TableName_ FROM [DBASE_NAME].[dbo].[a_Base_Year_Matrices] \" &amp; vbCrLf &amp; _\n           \"OPEN LoopVal \" &amp; vbCrLf &amp; _\n           \"FETCH NEXT FROM LoopVal INTO @TableName \" &amp; vbCrLf &amp; _\n           \"WHILE @@FETCH_STATUS = 0 \" &amp; vbCrLf &amp; _\n           \"BEGIN \" &amp; vbCrLf &amp; _\n\n\nSQL_STR2 = \"SET @STRSQL = \" \n\n          '...Create Some Tables...\n\n           \"WHILE (@COUNTT &lt; 1959 AND @COUNTTER &lt; 150)\" &amp; vbCrLf &amp; _\n           \"BEGIN\" &amp; vbCrLf &amp; _\n\n          '...Runs loops to meet conditions, once met drop unneeded tables and create final output...\n\n\nSQL_STR3 = \"EXEC(@STRSQL) \" &amp; vbCrLf &amp; _\n           \"FETCH NEXT FROM LoopVal INTO @TableName \" &amp; vbCrLf &amp; _\n           \"END \" &amp; vbCrLf &amp; _\n           \"CLOSE LoopVal \" &amp; vbCrLf &amp; _\n           \"DEALLOCATE LoopVal \"\n\nSQL_ALL = SQL_STR1 + SQL_STR2 + SQL_STR3\n\nSet cnn = New ADODB.Connection\nSet rs = New ADODB.Recordset\n\n'Set SQL Server Location\ncnn.ConnectionTimeout = 0\ncnn.Open \"Driver={SQL Server};Server=\" &amp; ServerName &amp; \";Trusted_Connection=Yes;\"\nSet rs.ActiveConnection = cnn\n\nDoCmd.SetWarnings False\ncnn.CommandTimeout = 0\n\n''Code to check to paste directly into SQL\n''Debug.Print SQL_ALL\n\nrs.Open SQL_ALL, cnn, adOpenForwardOnly\n\nNext b\n\nNext a\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 5, "creation_date": 1541005400, "post_id": 53088615, "comment_id": 93074170, "body": "Share your code - this is not a code writing service! Thanks"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1541078273, "post_id": 53088615, "comment_id": 93099675, "body": "Add the code to the question please"}, {"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1541078722, "post_id": 53088615, "comment_id": 93099946, "body": "code now added - I had forgotten to do this yesterday when I was writing the post.  I think I will need to set this up using INteger, but cannot remember how to do this, and ultimately this would allow me to loop the instruction which is in words...  Find row with a 1 in cell A, copy bells B to L and open other spreadhseet.  Find the first blank cell and past from cell D the columns copied.  Then from column A in this sheet copy the new number generated and copy this back into row M of the first sheet.  Then repeat down for each row which will have a 1 in cell A until it finds a zero &amp; stop"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1541078906, "post_id": 53088615, "comment_id": 93100051, "body": "<code>AutoFilter</code> and <code>SpecialCells(xlCellTypeVisible)</code> are your good friend here :) You can create the range with only 1 in column A as variable and then loop through, paste into the next sheet and then write the number back to the original sheet"}, {"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "edited": false, "score": 0, "creation_date": 1541082219, "post_id": 53088615, "comment_id": 93101783, "body": "So question I have is how would I approach that, I haven&#39;t used either of these in code before?  Also how would I stop the loop from simply copying the same row over and over again?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541406179, "post_id": 53088615, "comment_id": 93191562, "body": "Note: I recommend to read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> especially if you are new to code VBA."}, {"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "edited": false, "score": 0, "creation_date": 1541428019, "post_id": 53088615, "comment_id": 93202938, "body": "Wizhi - I cannot get the set command to work for my second workbook (I&#39;ve had to use ThisWorkbook for the first workbook unfortunately - but as the code will always sit in this one that if probably OK).  My code for setting the variable for the 2nd workbook is as below, I think the syntax is right, but cannot get it to work and keep getting an &quot;Object required&quot; error!      Set wkb2 = Workbook = (&quot;\\\\srveurfcl03.nov.com\\IS-GBR-GLBISETNRegister$\\Serial No Trial\\Serialisation Log.xlsx&quot;)"}], "owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586414691, "creation_date": 1541005284, "last_edit_date": 1586414691, "question_id": 53088615, "link": "https://stackoverflow.com/questions/53088615/single-row-copy-paste-macro-which-will-repeat-based-on-cell-content-between-shee", "title": "single row Copy paste macro which will repeat based on cell content between sheets", "body": "<p>I have a sheet with a range of A12:n112, and within this range column A will be \"0\" OR \"1\" based on other criteria. (I have code which sorts the data so that all the rows with a 1 are at the top of this range - this works fine)</p>\n\n<p>I have another bit of code which I need code to copy cells B:L in a row which column A has a \"1\" in to the first blank row in another sheet.  This then generates a number in the second sheet and this number is then copied back into the original sheet in the same row in column M.</p>\n\n<p>When I have fixed ranged I can do this without any problems, but I am trying to do this dynamically as the data entered into B through L will differ everytime the sheet is used.</p>\n\n<p>Can anyone help, here is my NEW code</p>\n\n<pre><code>Dim lr As Long\nlr = Sheets(\"Data Entry\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    For r = lr To 2 Step 1\n    If Range(\"AB\" &amp; r).Value = \"1\" Then\n        Rows(r).Copy.Range (\"A\" &amp; lr2 + 1)\n        Windows(\"Serialisation Log.xlsx\").Activate\n        Sheets(\"SNo Log\").Select\n        Range(\"D\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n        Application.CutCopyMode = False\n        Windows(\"Serialisation Log.xlsx\").Activate\n        Sheets(\"SNo Log\").Select\n        Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(-1).Select\n        Selection.Copy\n        Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n        ActiveSheet.Paste\n        Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(0).Select\n        Selection.Copy\n\n        Windows(\"Serialisation Generator rev 1.xlsm\").Activate\n        Worksheets(\"Data Entry\").Select\n        Range(\"N\").Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    End If\n    If Range(\"AB\" &amp; r).Value = \"0\" Then\n       Range(\"I4\").Select\n       ActiveCell.FormulaR1C1 = \"Serial No. Issue complete for this OA\"\n    End If\n    Range(\"F5\").Select\nNext r\n</code></pre>\n\n<p>This seems to run without errors, but doesn't copy or paste anything - any tips or advice.  (please note I have changed this question and code massively so the initial answers below may not longer apply.</p>\n\n<p>Any assistance is greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 1, "creation_date": 1541004633, "post_id": 53088378, "comment_id": 93073779, "body": "are you talking about removing user input, and just hardcoding what used to be the user input?"}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 3, "creation_date": 1541004699, "post_id": 53088378, "comment_id": 93073814, "body": "Change the values of rng,inputrng, outrng to your hard-coded ranges"}, {"owner": {"reputation": 191, "user_id": 10238466, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G3twY1EMVFc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pjXs0FH-siAX3f7jVScQpEiNfJ0Q/mo/photo.jpg?sz=128", "display_name": "Tony Chivers", "link": "https://stackoverflow.com/users/10238466/tony-chivers"}, "reply_to_user": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1541005092, "post_id": 53088378, "comment_id": 93074012, "body": "@ArcherBird if you could make this an answer and spell it out a bit more that would be great!!!"}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 1, "creation_date": 1541005120, "post_id": 53088378, "comment_id": 93074023, "body": "Is that number of rows? <i>&quot; I would like the number of entries based&quot;</i>"}, {"owner": {"reputation": 191, "user_id": 10238466, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G3twY1EMVFc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pjXs0FH-siAX3f7jVScQpEiNfJ0Q/mo/photo.jpg?sz=128", "display_name": "Tony Chivers", "link": "https://stackoverflow.com/users/10238466/tony-chivers"}, "reply_to_user": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1541005383, "post_id": 53088378, "comment_id": 93074162, "body": "@Wizhi say I have a list of numbers in Column A, starting in A1 with a 1 and finishing in A30 with a 30. I would like this code to split this long column into 10 smaller columns all with 3 entries in. When i use the code manually it asks how many rows (i.e. the number of entries in each subcolumn), i simply enter a cell as in cell G4 say is a 3 which signals the number of rows I would like."}, {"owner": {"reputation": 191, "user_id": 10238466, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G3twY1EMVFc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pjXs0FH-siAX3f7jVScQpEiNfJ0Q/mo/photo.jpg?sz=128", "display_name": "Tony Chivers", "link": "https://stackoverflow.com/users/10238466/tony-chivers"}, "edited": false, "score": 0, "creation_date": 1541005416, "post_id": 53088378, "comment_id": 93074178, "body": "It also asks where I would like this new table, I would like this to always be in H22"}, {"owner": {"reputation": 191, "user_id": 10238466, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G3twY1EMVFc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pjXs0FH-siAX3f7jVScQpEiNfJ0Q/mo/photo.jpg?sz=128", "display_name": "Tony Chivers", "link": "https://stackoverflow.com/users/10238466/tony-chivers"}, "edited": false, "score": 0, "creation_date": 1541005435, "post_id": 53088378, "comment_id": 93074191, "body": "The only variable I need is the number of columns it is split into and this is based on the value of a cell"}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1541006043, "post_id": 53088378, "comment_id": 93074488, "body": "You have the modification below with explanations :). Hopefully it do what you wish. I did some modifications if you don&#39;t have any value in G4, so you don&#39;t get error."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1541007711, "post_id": 53088621, "comment_id": 93075364, "body": "Arguably the user inputs would be refactored into parameters instead of hard-coded into the logic itself. But, good enough."}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1541007998, "post_id": 53088621, "comment_id": 93075501, "body": "Thank you!! I can agree with you on that point. I think the most important lesson is to take care of the potential error that occurs when you don&#39;t have any value in the cell and will be a result of modifying the code. I think it&#39;s horrible that people just set <code>On Error</code> and hide the problem instead of deal/try to solve it :)"}], "tags": [], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "is_accepted": true, "score": 5, "last_activity_date": 1541008089, "last_edit_date": 1541008089, "creation_date": 1541005305, "answer_id": 53088621, "question_id": 53088378, "link": "https://stackoverflow.com/questions/53088378/i-have-vba-code-that-requires-pop-up-boxes-to-work-can-i-automate-this/53088621#53088621", "title": "I have VBA code that requires pop up boxes to work, can I automate this", "body": "<p>I think you want something like this...</p>\n\n<p>So what do we need to change?... By press F8 in the VBA window we can step by step see what each line do..</p>\n\n<p>1- This part defines your range to split, so we replace it:</p>\n\n<pre><code>Set InputRng = Application.InputBox(\"Range :\", xTitleId, InputRng.Address, Type: = 8)\n</code></pre>\n\n<p>To a hard coded range:</p>\n\n<pre><code>Set InputRng = Range(\"A1:A30\")\n</code></pre>\n\n<p>2- Next part defines which cell to output the result:</p>\n\n<pre><code>Set OutRng   = Application.InputBox(\"Out put to (single cell):\", xTitleId, Type: = 8)\n</code></pre>\n\n<p>We hardcode this to cell range.</p>\n\n<pre><code>Set OutRng = Range(\"H22\")\n</code></pre>\n\n<p>3- Last part to edit is this:</p>\n\n<pre><code>xRow         = Application.InputBox(\"Rows :\", xTitleId)\n</code></pre>\n\n<p>Will take the value you have in <code>G4</code></p>\n\n<pre><code>xRow = Cells(4, 7).Value\n</code></pre>\n\n<p>The final modifications can be more tricky to spot. The selection is hardcoded, so we don't need it. Therefore we can remove line <code>Set InputRng = Application.Selection</code></p>\n\n<p>If we don't have any value in <code>G4</code> we will get a division by 0 error. We therefore create an IF statement that will show a message box \"No Value in G4\" if cell G4 is 0.</p>\n\n<p><strong>Modified code:</strong></p>\n\n<pre><code>Sub SplitColumn()\n    'Updateby20141106\n    Dim rng As Range\n    Dim InputRng As Range\n    Dim OutRng As Range\n    Dim xRow As Integer\n    Dim xCol As Integer\n    Dim xArr As Variant\n    xTitleId = \"KutoolsforExcel\"\n    Set InputRng = Range(\"A1:A30\")\n    xRow = Cells(4, 7).Value\n    Set OutRng = Range(\"H22\")\n    If xRow = 0 Then\n        MsgBox \"No value in G4\"\n        Exit Sub\n    Else\n        Set InputRng = InputRng.Columns(1)\n        xCol = InputRng.Cells.Count / xRow\n        ReDim xArr(1 To xRow, 1 To xCol + 1)\n            For i = 0 To InputRng.Cells.Count - 1\n                xValue = InputRng.Cells(i + 1)\n                iRow = i Mod xRow\n                iCol = VBA.Int(i / xRow)\n                xArr(iRow + 1, iCol + 1) = xValue\n            Next i\n        OutRng.Resize(UBound(xArr, 1), UBound(xArr, 2)).Value = xArr\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 10238466, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G3twY1EMVFc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pjXs0FH-siAX3f7jVScQpEiNfJ0Q/mo/photo.jpg?sz=128", "display_name": "Tony Chivers", "link": "https://stackoverflow.com/users/10238466/tony-chivers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 53088621, "answer_count": 1, "score": 3, "last_activity_date": 1541008089, "creation_date": 1541004382, "question_id": 53088378, "link": "https://stackoverflow.com/questions/53088378/i-have-vba-code-that-requires-pop-up-boxes-to-work-can-i-automate-this", "title": "I have VBA code that requires pop up boxes to work, can I automate this", "body": "<p>Below is some code that splits a long column in excel into smaller columns.</p>\n\n<p>This works by clicking into the module, pressing F5 and entering ranges, an output starting point and a cell range to signal the number of entries in each column. </p>\n\n<p>Is there anyway I can automate this, for example, if I have a column with 1:30 starting in A1, I always want to use this range, the output cell I would like is H25 and I would like the number of entries based on whatever I input into say cell G6.</p>\n\n<pre><code>Sub SplitColumn()\n    'Updateby20141106\n    Dim rng As Range\n    Dim InputRng As Range\n    Dim OutRng As Range\n    Dim xRow As Integer\n    Dim xCol As Integer\n    Dim xArr As Variant\n    xTitleId     = \"KutoolsforExcel\"\n    Set InputRng = Application.Selection\n    Set InputRng = Application.InputBox(\"Range :\", xTitleId, InputRng.Address, Type: = 8)\n    xRow         = Application.InputBox(\"Rows :\", xTitleId)\n    Set OutRng   = Application.InputBox(\"Out put to (single cell):\", xTitleId, Type: = 8)\n    Set InputRng = InputRng.Columns(1)\n    xCol         = InputRng.Cells.Count / xRow\n    ReDim xArr(1 To xRow, 1 To xCol + 1)\n    For i = 0 To InputRng.Cells.Count - 1\n        xValue = InputRng.Cells(i + 1)\n        iRow = i Mod xRow\n        iCol = VBA.Int(i / xRow)\n        xArr(iRow + 1, iCol + 1) = xValue\n    Next\n    OutRng.Resize(UBound(xArr, 1), UBound(xArr, 2)).Value = xArr\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1541004495, "post_id": 53088364, "comment_id": 93073705, "body": "Non-numeric values is the range to be averaged maybe?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1541004564, "post_id": 53088364, "comment_id": 93073744, "body": "Not an answer to your question, but do you really need to calculate the average for all 16k columns? @BigBen - I always thought average excluded non-numeric values, but not sure about error values."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1541004608, "post_id": 53088364, "comment_id": 93073764, "body": "@SJR <code>Application.Average</code> seems to throw a type-mismatch error."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1541004726, "post_id": 53088364, "comment_id": 93073835, "body": "You also get RTE 13 if all values are blank so I reckon column 14320 or something probably has nothing in it!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1541007157, "post_id": 53088364, "comment_id": 93075113, "body": "<code>ColCount = newBook.Worksheets(2).Columns.Count</code> and <code>ColCount2 = ws.Columns.Count</code> will always return <code>16384</code> (or however many columns are in your version of Excel)."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1541007439, "creation_date": 1541007439, "answer_id": 53089156, "question_id": 53088364, "link": "https://stackoverflow.com/questions/53088364/why-do-i-get-at-run-time-error-when-looping-into-the-next-worksheet-even-though/53089156#53089156", "title": "Why do I get at run time error when looping into the next worksheet even though the code executed correctly for the first worksheet?", "body": "<ul>\n<li><p>runtime error 13 if I use Application.Average</p>\n\n<p><code>Application.Average</code> is <em>late-bound</em> and behaves like the worksheet function <code>AVERAGE</code>, i.e. by <em>returning</em> an error value when the result can't be evaluated. Because an error value can't be coerced into a <code>Double</code>, the assignment fails with a <em>type mismatch</em> error.</p>\n\n<p>You could capture the result into a <code>Variant</code>, check to see if it's an error value, <em>then</em> assign to a <code>Double</code>; use the <code>IsError</code> function to do this:</p>\n\n<pre><code>Dim avgResult As Variant\navgResult = Application.Average(...)\n\nIf Not IsError(avgResult) Then\n    rngAverage = avgResult\n    'rngAverage is safe to use as a Double\nElse\n    ' avgResult is a #VALUE! error. what now?\nEnd If\n</code></pre></li>\n<li><p>runtime error 1004 if I use Application.WorksheetFunction.Average</p>\n\n<p>That's because <code>WorksheetFunction.Average</code> is <em>early-bound</em>, and handles errors in a way that is idiomatic to VBA: instead of <em>returning</em> an <code>Error</code> value, it <em>throws</em> a run-time error, which can then be handled with a normal <code>On Error</code> statement and error-handling subroutine.</p></li>\n</ul>\n\n<p>The <code>Average</code> function is returning/throwing an error because the input it's given is invalid or contains errors - i.e. if you used the <code>AVERAGE</code> worksheet function on that data, you wouldn't be getting a <code>Double</code> result either. Fix the data.</p>\n"}], "owner": {"reputation": 1, "user_id": 10586975, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fbzKW0Pt-oY/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBxl4pfb7ZGlqml0jOl3OmH45lm0w/mo/photo.jpg?sz=128", "display_name": "Marlin ", "link": "https://stackoverflow.com/users/10586975/marlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586414727, "creation_date": 1541004327, "last_edit_date": 1586414727, "question_id": 53088364, "link": "https://stackoverflow.com/questions/53088364/why-do-i-get-at-run-time-error-when-looping-into-the-next-worksheet-even-though", "title": "Why do I get at run time error when looping into the next worksheet even though the code executed correctly for the first worksheet?", "body": "<p>I have come to a point in my coding where well asked google questions are just not helping me anymore. I have two For loops in my code. They execute correctly for the first Worksheet I set in the loop in my Workbook. However changing to the next Worksheet gives a runtime error:</p>\n\n<ul>\n<li>runtime error 13 if I use Application.Average</li>\n<li>runtime error 1004 if I use Application.WorksheetFunction.Average</li>\n</ul>\n\n<p>What I am trying to do:<br>\nI have data from measurements. These are organized in the different Worksheets for different temperature ranges. I want to loop through the relevant columns in the relevant worksheets in my data to find the average values of these columns. In the end I would like to save the averages to my first Worksheet for the corresponding headers. (I haven't written any code for this last part yet.)</p>\n\n<p>Any help is very much appreciated. </p>\n\n<pre><code>Option Explicit\n\nSub TestAv()\n\n    Dim ColCount As Long\n    Dim ws As Worksheet\n    Dim LastRow As Long\n    Dim j, k, ColCount2, wsCount As Long\n    Dim rngAv As Range\n    Dim rngAverage As Double\n    Dim Lr As Long\n\n    Dim newBook As Workbook\n    Dim firstSheet As Worksheet\n\n    Set newBook = ActiveWorkbook\n    Set firstSheet = newBook.Sheets(1)\n\n    Application.ScreenUpdating = False\n    ' making firstSheet representable\n    ColCount = newBook.Worksheets(2).Columns.Count ' all TCs should have been measured for the first temperature\n    newBook.Worksheets(2).Activate\n    Range(Cells(1, 2), Cells(1, ColCount)).Copy\n    firstSheet.Activate\n    firstSheet.Range(\"B1\").Select\n    firstSheet.Paste\n    Application.CutCopyMode = False\n    Application.CutCopyMode = True\n    firstSheet.Range(\"A1\").Value = \"Temperaturen\"\n    firstSheet.Name = \"Mittelwerte\"\n    ' calculating mean values in columns of Worksheets\n    wsCount = newBook.Worksheets.Count\n    For j = 2 To wsCount\n        LastRow = firstSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n        Set ws = newBook.Worksheets(j)\n        firstSheet.Range(\"A\" &amp; LastRow).Value = ws.Name\n        ColCount2 = ws.Columns.Count\n        ws.Activate\n        Lr = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row - 1\n        For k = 2 To ColCount2\n            Set rngAv = ws.Range(ws.Cells(2, k), ws.Cells(Lr, k))\n            rngAverage = Application.Average(rngAv)\n            Cells(Lr + 2, k).Value = rngAverage\n        Next k\n        Set rngAv = Nothing\n        Set ws = Nothing\n    Next j\n    Application.ScreenUpdating = True\n    ' Mean Values of TCs for different Temperatures in firstSheet\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541003894, "post_id": 53088178, "comment_id": 93073404, "body": "The caveats at <a href=\"https://www.connectionstrings.com/ace-oledb-12-0/with-database-password/\" rel=\"nofollow noreferrer\">this link</a> are worth a read. Is <code>XXX#1</code> the actual password you&#39;re using? Is <code>&quot;C:\\.accdb&quot;</code> what you&#39;re passing it?"}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541004983, "post_id": 53088178, "comment_id": 93073969, "body": "@Comintern I have updated the name and the PASS is very similar with # in it. Thanks for the link but I have already been to this website. I&#39;ve tried multiple solutions and still facing the same issue. Perplexing to say the least."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541005074, "post_id": 53088178, "comment_id": 93074003, "body": "It&#39;s possible that the <code>#</code> is a problem character for that driver - have you tried changing it to a simpler test password, like say, <code>test</code>? That would at least narrow the issue."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1541006813, "post_id": 53088178, "comment_id": 93074889, "body": "In what version of MS Access did you create the password? Note: this may not be the version you are currently using (i.e., 2013). I ask because starting in 2010, encryption method changed for database passwords. You may have to delete current password and use the legacy version: Access-&gt;File-&gt;Options-&gt;Client Settings-&gt;Advanced (check &quot;use legacy encryption&quot;)."}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541688780, "post_id": 53088178, "comment_id": 93308402, "body": "@Comintern Yes I have changed the password to &quot;cat&quot; and it&#39;s the same - no improvement. I went through 10&#39;s if not 100&#39;s of online sources and still can&#39;t fix it."}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1541688826, "post_id": 53088178, "comment_id": 93308429, "body": "@Parfait in ACCESS 2013. Basically, I have created database from scratch (only for testing) and still having the same issue."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1541725479, "post_id": 53088178, "comment_id": 93324350, "body": "Correct because Access 2013 uses by default the new encryption. Please change with instructions above to &quot;legacy encryption&quot;."}], "owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586414763, "creation_date": 1541003666, "last_edit_date": 1586414763, "question_id": 53088178, "link": "https://stackoverflow.com/questions/53088178/open-access-2013-with-excel-vba-invalid-password", "title": "Open ACCESS 2013 with Excel VBA &quot;Invalid Password&quot;", "body": "<p>Can someone advise why do I constantly get \"Invalid Password\" notification? The password is correct and if done manually works perfectly. I use ACCESS 2013 and Excel 2013.</p>\n\n<pre><code>Sub OpenACCESS()\n    Dim cn As Object, rs As Object\n    Dim intColIndex As Integer\n    Dim DBFullName As String\n    Dim TargetRange As Range\n\n    DBFullName = \"C:\\MYDATA.accdb\"\n\n    Application.ScreenUpdating = False\n\n    Set TargetRange = Workbooks(\"IMD_Calculator.xlsm\").Sheets(\"Operate\").Range(\"A1\")\n\n    Set cn = CreateObject(\"ADODB.Connection\")\n\n    cn.Open \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" &amp; DBFullName &amp; \";\" &amp; \"Jet OLEDB:Database Password=XXX#1;\"\n\n    Set rs = CreateObject(\"ADODB.Recordset\")\n    rs.Open \"SELECT * FROM 2017, cn, , , adCmdText\"\n\n    For intColIndex = 0 To rs.Fields.Count - 1\n    TargetRange.Offset(1, intColIndex).Value = rs.Fields(intColIndex).Name\n    Next\n\n    TargetRange.Offset(1, 0).CopyFromRecordset rs\n\n    Application.ScreenUpdating = True\n    On Error Resume Next\n    rs.Close\n    Set rs = Nothing\n    cn.Close\n    Set cn = Nothing\n    On Error GoTo 0\n    Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1541003841, "post_id": 53088170, "comment_id": 93073378, "body": "You probably want to be setting <code>iRow</code> and <code>iCol</code> to 1 within each iteration of the loop, otherwise it&#39;ll just keep getting larger and larger."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "edited": false, "score": 1, "creation_date": 1541004239, "post_id": 53088170, "comment_id": 93073589, "body": "If you avoid <code>activate</code>-ing the sheets you should see performance improvements. @BruceWayne&#39;s answer does exactly that."}], "answers": [{"comments": [{"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "edited": false, "score": 1, "creation_date": 1541004110, "post_id": 53088201, "comment_id": 93073517, "body": "I guess getting rid of <code>.Activate</code> should also address the speed issue that the OP was concerned about."}, {"owner": {"reputation": 35, "user_id": 9902279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf8b24ceb3b51a627e390ed0db0f404?s=128&d=identicon&r=PG&f=1", "display_name": "Princey", "link": "https://stackoverflow.com/users/9902279/princey"}, "edited": false, "score": 0, "creation_date": 1541062188, "post_id": 53088201, "comment_id": 93091618, "body": "Thank you for your response, much appreciated. However, this code does the same as mine and doesn&#39;t actually loop through all the sheets."}, {"owner": {"reputation": 35, "user_id": 9902279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf8b24ceb3b51a627e390ed0db0f404?s=128&d=identicon&r=PG&f=1", "display_name": "Princey", "link": "https://stackoverflow.com/users/9902279/princey"}, "edited": false, "score": 0, "creation_date": 1541066245, "post_id": 53088201, "comment_id": 93093469, "body": "I&#39;ve managed to fix this. I have placed the following into after the ClearFormats line:                     Set oRng = Range(&quot;b1&quot;)                     iRow = oRng.Row                     iCol = oRng.Column"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 35, "user_id": 9902279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf8b24ceb3b51a627e390ed0db0f404?s=128&d=identicon&r=PG&f=1", "display_name": "Princey", "link": "https://stackoverflow.com/users/9902279/princey"}, "edited": false, "score": 0, "creation_date": 1541079840, "post_id": 53088201, "comment_id": 93100547, "body": "@Princey - Be careful, make sure to qualify that first <code>Range(&quot;b1&quot;)</code> with the worksheet."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 3, "last_activity_date": 1541003951, "last_edit_date": 1541003951, "creation_date": 1541003766, "answer_id": 53088201, "question_id": 53088170, "link": "https://stackoverflow.com/questions/53088170/looping-through-all-worksheets-issue/53088201#53088201", "title": "Looping through all worksheets issue", "body": "<p>When looping through sheets, you must make <strong><em>positive</em></strong> you are adding the worksheet reference when referencing ranges.  Otherwise, any range reference will refer to whatever the <code>ActiveSheet</code> happens to be.</p>\n\n<pre><code>On Error Resume Next\n\nFor Each ws In ThisWorkbook.Worksheets\n    With ws\n        Do\n            If .Cells(iRow + 1, iCol) &lt;&gt; .Cells(iRow, iCol) Then\n                .Cells(iRow + 1, iCol).EntireRow.Insert Shift:=xlDown\n                iRow = iRow + 2\n            Else\n                iRow = iRow + 1\n            End If\n        Loop While Not .Cells(iRow, iCol).Text = \"\"\n        .UsedRange.SpecialCells(xlCellTypeBlanks).ClearFormats\n    End With\nNext ws\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 9902279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf8b24ceb3b51a627e390ed0db0f404?s=128&d=identicon&r=PG&f=1", "display_name": "Princey", "link": "https://stackoverflow.com/users/9902279/princey"}, "edited": false, "score": 0, "creation_date": 1541062268, "post_id": 53093896, "comment_id": 93091645, "body": "Thank you for your response. I receive the following error: &quot;Application Defined or Object Defined&quot; error &#39;1004&quot; on this part: If .Cells(iRow - 1, iCol) &lt;&gt; Cells(iRow, iCol) (line 4)"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1541066066, "last_edit_date": 1541066066, "creation_date": 1541034156, "answer_id": 53093896, "question_id": 53088170, "link": "https://stackoverflow.com/questions/53088170/looping-through-all-worksheets-issue/53093896#53093896", "title": "Looping through all worksheets issue", "body": "<p>As jsheeran commented, you have to initialize iRow at each new sheet you are looping</p>\n\n<p>One way to do it is looping backwards from last not empty cell row in column iCol to its second one, which also simplifies the code:</p>\n\n<pre><code>For Each ws In ActiveWorkbook.Worksheets\n    With ws\n        For iRow = .Cells(.Rows.Count, iCol).End(xlUp) To 2 Step - 1\n            If .Cells(iRow - 1, iCol) &lt;&gt; .Cells(iRow, iCol) Then .Cells(iRow, iCol).EntireRow.Insert Shift:=xlDown\n        Next\n        On Error Resume Next\n        .UsedRange.SpecialCells(xlCellTypeBlanks).ClearFormats\n        On Error GoTo 0\n    End With\nNext\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9902279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf8b24ceb3b51a627e390ed0db0f404?s=128&d=identicon&r=PG&f=1", "display_name": "Princey", "link": "https://stackoverflow.com/users/9902279/princey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 53088201, "answer_count": 2, "score": 0, "last_activity_date": 1586414799, "creation_date": 1541003638, "last_edit_date": 1586414799, "question_id": 53088170, "link": "https://stackoverflow.com/questions/53088170/looping-through-all-worksheets-issue", "title": "Looping through all worksheets issue", "body": "<p>I have a long macro which has the following at the end of it:</p>\n\n<pre><code>        On Error Resume Next\n\n    For Each ws In ActiveWorkbook.Worksheets\n        ws.Activate\n        Do\n        If Cells(iRow + 1, iCol) &lt;&gt; Cells(iRow, iCol) Then\n            Cells(iRow + 1, iCol).EntireRow.Insert Shift:=xlDown\n            iRow = iRow + 2\n        Else\n            iRow = iRow + 1\n        End If\n        Loop While Not Cells(iRow, iCol).Text = \"\"\n\n        ActiveSheet.UsedRange.SpecialCells(xlCellTypeBlanks).ClearFormats\n\n    Next ws\n</code></pre>\n\n<p>This SHOULD add a blank row when there is a change in column B (to seperate groups of data) and then remove the formatting on the blank row. </p>\n\n<p>This does not seem to loop through all the worksheets correctly as only the first sheet is changed to include a blank row after a change in column B. It is also very slow.</p>\n\n<p>I was hoping I could get some assistance with this, and perhaps a better resolution that is faster?</p>\n\n<p>Thank you in advance for your assistance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1541003322, "post_id": 53087942, "comment_id": 93073095, "body": "You shouldn&#39;t use a function for this. Use a Sub Procedure (there is a reason you didn&#39;t find a way to do it with a function in your research)"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 0, "creation_date": 1541003338, "post_id": 53087942, "comment_id": 93073105, "body": "You&#39;re comparing a range to an integer on your code. Besides, I think you can&#39;t turn a cell to a <code>droplist</code> with a function. You have to do it with a macro."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 1, "creation_date": 1541003609, "post_id": 53087942, "comment_id": 93073272, "body": "to elaborate on what @Pspl said, if <code>val</code> is a range larger than 1 cell, this will produce an error. If <code>val</code> is just one cell and contains an error (from formula) or is non-numeric (text) this will also produce an error"}, {"owner": {"reputation": 385, "user_id": 7391720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b440d679e53ff782566a13e8c660303a?s=128&d=identicon&r=PG&f=1", "display_name": "efoc", "link": "https://stackoverflow.com/users/7391720/efoc"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1541006288, "post_id": 53087942, "comment_id": 93074610, "body": "@urdearboy Ah, I need to do it in a Sub Procedure and then add it to my function. That makes sense. I don&#39;t know why I didn&#39;t think of that.  So I store the Procedure in my Function and I just use ActiveCell and it will know the cell it is currently in?"}], "answers": [{"comments": [{"owner": {"reputation": 385, "user_id": 7391720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b440d679e53ff782566a13e8c660303a?s=128&d=identicon&r=PG&f=1", "display_name": "efoc", "link": "https://stackoverflow.com/users/7391720/efoc"}, "edited": false, "score": 0, "creation_date": 1541006497, "post_id": 53088636, "comment_id": 93074718, "body": "Would I be able to use this Sub and add it into my Function to use in every cell?"}, {"owner": {"reputation": 892, "user_id": 10503508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1Afy.jpg?s=128&g=1", "display_name": "Ferdinando", "link": "https://stackoverflow.com/users/10503508/ferdinando"}, "reply_to_user": {"reputation": 385, "user_id": 7391720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b440d679e53ff782566a13e8c660303a?s=128&d=identicon&r=PG&f=1", "display_name": "efoc", "link": "https://stackoverflow.com/users/7391720/efoc"}, "edited": false, "score": 0, "creation_date": 1541006577, "post_id": 53088636, "comment_id": 93074759, "body": "yes try the first...copy and paste in your vba module and keep me update...i tried and works. Try only my code to understand if works well for you. After we try to put in oyur function..."}, {"owner": {"reputation": 385, "user_id": 7391720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b440d679e53ff782566a13e8c660303a?s=128&d=identicon&r=PG&f=1", "display_name": "efoc", "link": "https://stackoverflow.com/users/7391720/efoc"}, "edited": false, "score": 0, "creation_date": 1541007020, "post_id": 53088636, "comment_id": 93075026, "body": "I added the Procedure into my function so I could add it like this in the cell: <code>=testFunc()</code> and in the Procedure I did <code>ActiveCell.Validation.....</code> but it doesn&#39;t work. Does the Procedure need to be on it&#39;s own?"}, {"owner": {"reputation": 892, "user_id": 10503508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1Afy.jpg?s=128&g=1", "display_name": "Ferdinando", "link": "https://stackoverflow.com/users/10503508/ferdinando"}, "reply_to_user": {"reputation": 385, "user_id": 7391720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b440d679e53ff782566a13e8c660303a?s=128&d=identicon&r=PG&f=1", "display_name": "efoc", "link": "https://stackoverflow.com/users/7391720/efoc"}, "edited": false, "score": 0, "creation_date": 1541007169, "post_id": 53088636, "comment_id": 93075121, "body": "Sorry, try in this way first. Use only my code and use f8 to execute the code step by step and after click on C2 cell(if your are using the first block of  code)."}, {"owner": {"reputation": 385, "user_id": 7391720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b440d679e53ff782566a13e8c660303a?s=128&d=identicon&r=PG&f=1", "display_name": "efoc", "link": "https://stackoverflow.com/users/7391720/efoc"}, "edited": false, "score": 0, "creation_date": 1541008257, "post_id": 53088636, "comment_id": 93075637, "body": "Yeah, the Procedure works fine by itself when executed but I was wondering more on it executing automatically when someone fills in a value in a cell"}, {"owner": {"reputation": 892, "user_id": 10503508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1Afy.jpg?s=128&g=1", "display_name": "Ferdinando", "link": "https://stackoverflow.com/users/10503508/ferdinando"}, "reply_to_user": {"reputation": 385, "user_id": 7391720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b440d679e53ff782566a13e8c660303a?s=128&d=identicon&r=PG&f=1", "display_name": "efoc", "link": "https://stackoverflow.com/users/7391720/efoc"}, "edited": false, "score": 0, "creation_date": 1541008778, "post_id": 53088636, "comment_id": 93075909, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/182891/discussion-between-ferdinando-and-efoc\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 892, "user_id": 10503508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1Afy.jpg?s=128&g=1", "display_name": "Ferdinando", "link": "https://stackoverflow.com/users/10503508/ferdinando"}, "is_accepted": false, "score": 0, "last_activity_date": 1541005361, "creation_date": 1541005361, "answer_id": 53088636, "question_id": 53087942, "link": "https://stackoverflow.com/questions/53087942/excel-function-macro-creating-a-drop-down-list/53088636#53088636", "title": "Excel Function Macro: Creating a drop down list", "body": "<p>Answer your first row question: I want to create a function that turns the cell into a dropdown list with values in it.</p>\n\n<p>if you want this one then you can try this code:</p>\n\n<pre><code>Sub test()\n'drop down list\nDim MyList(5) As String ' create array with definite size and value\nMyList(0) = 1 ' assign value\nMyList(1) = 2\nMyList(2) = 3\nMyList(3) = 4\nMyList(4) = 5\nMyList(5) = 6\n\n'put in C2 array MyList\n    With Range(\"C2\").Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n             Operator:=xlBetween, Formula1:=Join(MyList, \",\")\n    End With\n    End Sub\n</code></pre>\n\n<p>or you can use un array with size dinamically and get items from cells</p>\n\n<pre><code>Sub test()\n'drop down list example with 5 items into list\nDim MyList() As String\nDim i, myDim As Integer\n\nmyDim = 5 ' number of items that you can get from a cell\nReDim MyList(myDim)\n\n'get items from cells. example A1-B1-C1-D1-E1\nFor i = 0 To myDim\n    MyList(i) = Cells(1, i + 1) ' assign value into MyList\nNext i\n\n'cell A10 is mi drop down list\nWith Range(\"A10\").Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n         Operator:=xlBetween, Formula1:=Join(MyList, \",\")\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Hope this help you</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1541012641, "creation_date": 1541012641, "answer_id": 53090345, "question_id": 53087942, "link": "https://stackoverflow.com/questions/53087942/excel-function-macro-creating-a-drop-down-list/53090345#53090345", "title": "Excel Function Macro: Creating a drop down list", "body": "<p>There is a way to work around this type of requirement, but it might not meet your needs...</p>\n\n<p><strong>Step 1</strong>.  Create a function to be called when a user clicks on the in-cell validation list drop down. This example checks the value to the left of the cell and only if it's \"Yes\" does it return a range to be used for the list.</p>\n\n<pre><code>Function Lister()\n    Dim rv As Range\n    If TypeName(Application.Caller) = \"Range\" Then\n        If Application.Caller.Offset(0, -1).Value = \"Yes\" Then\n            Set rv = Sheet1.Range(\"A1:A5\")\n        End If\n    End If\n    Set Lister = rv\nEnd Function\n</code></pre>\n\n<p><strong>Step 2</strong>.  You can't reference this function directly from the validation list setup, so you need to use a workbook name to \"route\" the validation call to the function:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JW59G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JW59G.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Step 3</strong>.  Create your in-cell drop-down, referencing the name you just created (which in turn links to the VBA function).  Now you'll get a list when the cell to the left has \"Yes\", but no list otherwise.  Or you could instead use the same approach to return two different lists, depending on the content in other cells.</p>\n\n<p><a href=\"https://i.stack.imgur.com/odp02.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/odp02.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 385, "user_id": 7391720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b440d679e53ff782566a13e8c660303a?s=128&d=identicon&r=PG&f=1", "display_name": "efoc", "link": "https://stackoverflow.com/users/7391720/efoc"}, "is_accepted": false, "score": 0, "last_activity_date": 1542648604, "creation_date": 1542648604, "answer_id": 53379833, "question_id": 53087942, "link": "https://stackoverflow.com/questions/53087942/excel-function-macro-creating-a-drop-down-list/53379833#53379833", "title": "Excel Function Macro: Creating a drop down list", "body": "<p>Okay, so after researching from all the answers I was provided, I found this link,\n<a href=\"https://www.excel-easy.com/vba/events.html\" rel=\"nofollow noreferrer\">https://www.excel-easy.com/vba/events.html</a></p>\n\n<p>I was able to write a Change event Sub so that when the user adds a value to a cell and switches out of the cell, the sub runs and creates the dropdown list.</p>\n"}], "owner": {"reputation": 385, "user_id": 7391720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b440d679e53ff782566a13e8c660303a?s=128&d=identicon&r=PG&f=1", "display_name": "efoc", "link": "https://stackoverflow.com/users/7391720/efoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3787, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1542648604, "creation_date": 1541002910, "question_id": 53087942, "link": "https://stackoverflow.com/questions/53087942/excel-function-macro-creating-a-drop-down-list", "title": "Excel Function Macro: Creating a drop down list", "body": "<p>I want to create a function that turns the cell into a dropdown list with values in it.</p>\n\n<p>So far from what I read online, it only shows how to do it in <code>sub</code> form but I want to try to use it in the cell so it automatically populates it. So far I got this.</p>\n\n<pre><code>function test(val as Range)\n    if val = 1 then\n        set test = Range(name_of_defined_list)\n    elseif val = 2 then\n        test = \"no list\"\n    end if\nend function\n</code></pre>\n\n<p>And in the cell it would be written and dragged down to the cells below</p>\n\n<pre><code>=test(C2)\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "criteria"], "comments": [{"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1541003213, "post_id": 53087873, "comment_id": 93073028, "body": "You&#39;re not resetting your RowNo between do loops so it&#39;s picking from where you left off which would be when it&#39;s empty and since you check criteria at the top, the loop won&#39;t execute. On that note you should reset <code>irow</code> as well. Instead of calling to the worksheet to find the row of a range you specify, you could just set them equal to the row number. i.e <code>irow = 7</code> and <code>RowNo = 2</code>"}, {"owner": {"reputation": 11, "user_id": 10586930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6e575fe4708d46d656e2ddd598107e?s=128&d=identicon&r=PG&f=1", "display_name": "Emma F", "link": "https://stackoverflow.com/users/10586930/emma-f"}, "reply_to_user": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1541003459, "post_id": 53087873, "comment_id": 93073173, "body": "Thank you, it now works perfectly!"}], "answers": [{"tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 1, "last_activity_date": 1541003764, "creation_date": 1541003764, "answer_id": 53088199, "question_id": 53087873, "link": "https://stackoverflow.com/questions/53087873/vba-to-create-several-lists-based-on-multiple-columns-and-criteria/53088199#53088199", "title": "VBA to create several lists based on multiple columns and criteria", "body": "<p>A more efficient way to loop would be:</p>\n\n<pre><code>irowE = 7\nirowG = 7\nRowNo = 2\n\nDo Until iws.Cells(RowNo, 2) = \"\"\n    If iws.Cells(RowNo, \"H\") = \"\" Then\n        ws.Cells(irowE, \"E\") = iws.Cells(RowNo, 2)\n        irowE = irowE + 1\n    End if\n    If iws.Cells(RowNo, \"O\") = 0 Then\n        ws.Cells(irowG, \"G\") = iws.Cells(RowNo, 2)\n        irowG = irowG + 1\n    End If\n    RowNo = RowNo + 1\nLoop\n</code></pre>\n\n<p>Having 10 different variables for 10 lists may seem like a pain, but it will greatly speed things up since you will only loop through your input sheet once.</p>\n"}], "owner": {"reputation": 11, "user_id": 10586930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6e575fe4708d46d656e2ddd598107e?s=128&d=identicon&r=PG&f=1", "display_name": "Emma F", "link": "https://stackoverflow.com/users/10586930/emma-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1541003764, "creation_date": 1541002680, "last_edit_date": 1541003123, "question_id": 53087873, "link": "https://stackoverflow.com/questions/53087873/vba-to-create-several-lists-based-on-multiple-columns-and-criteria", "title": "VBA to create several lists based on multiple columns and criteria", "body": "<p>I have two sheets, one input sheet with a large data set (Input SAP) and one sheet where I would like to list instances based on different criteria, but also in different categories (Output). I would want to push a button in the \"Output\" and get the different lists. In the below code, there are two lists, but there will be more.</p>\n\n<p>The output sheet would be something like this: Column E would list all SAP numbers where column H in the input sheet is blank. Column G would list all SAP numbers where column O is equal to zero.</p>\n\n<p>Column E gets populated correctly with the below code, but nothing happens to column G.I do not know how to fill several columns within the same sub.. I would also prefer not to make seperate row definitions since there will be approx. 10 different lists in the end.</p>\n\n<p>Any help is greatly appreciated!</p>\n\n<pre><code>   Private Sub CommandButton1_Click()\n     ReadIncomplete\n   End Sub\n\n\n   Private Sub ReadIncomplete()\n   Dim wb As Workbook: Set wb = ThisWorkbook\n   Dim ws As Worksheet: Set ws = wb.Worksheets(\"Output\")\n   Dim iws As Worksheet: Set iws = wb.Worksheets(\"Input SAP\")\n\n   irow = ws.Range(\"E7\").Row\n   RowNo = iws.Range(\"A2\").Row\n\n\n  Do Until iws.Cells(RowNo, 2) = \"\"\n     If iws.Cells(RowNo, \"H\") = \"\" Then\n     ws.Cells(irow, \"E\") = iws.Cells(RowNo, 2)\n     irow = irow + 1\n  End If\n  RowNo = RowNo + 1\n  Loop\n\n  Do Until iws.Cells(RowNo, 2) = \"\"\n     If iws.Cells(RowNo, \"O\") = 0 Then\n     ws.Cells(irow, \"G\") = iws.Cells(RowNo, 2)\n     irow = irow + 1\n  End If\n  RowNo = RowNo + 1\n  Loop\n\n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1541003138, "post_id": 53087835, "comment_id": 93072982, "body": "if you think the formula is too long and needs to be abbreviate, you could used defined names to define each of your ranges.  Choose a short name and it will save you some characters"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1541003418, "post_id": 53087835, "comment_id": 93073148, "body": "instead of converting criteria with -- and using , to separate your ranges, you can save 2 characters bu replacing the , with * and drop the --.  Any boolean result or number as a string will be converted to a number when sent through a math operation."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10563751"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1541004138, "post_id": 53087835, "comment_id": 93073528, "body": "thank you for your prompt response. how can i put the named ranges instead of the ranges?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10563751"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1541004571, "post_id": 53087835, "comment_id": 93073749, "body": "thank you for your prompt response. how can i put the named ranges instead of the cell ranges? For example the named range &quot;MarketStatus&quot; = INDIRECT(Sheet2!$A$1) where A1 =  $CG$7:$CG$19500. How can i put marketstatus instead of $CG$7:$CG$19500?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1541005090, "post_id": 53087835, "comment_id": 93074011, "body": "I get no errors adding another criteria, can you post what you tried?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1541006756, "post_id": 53087835, "comment_id": 93074858, "body": "A defined name can be created in several ways.  The simple method is to select/highlight your desired range and then in the top left corner where it usually lists the active cell, type in a name.  Alternatively you can go to the Formula ribbon, and use the &quot;Defined Names&quot; section and click on define name and manually enter the range or add a formula if it suits your purposes."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1541006855, "post_id": 53087835, "comment_id": 93074919, "body": "<code>SUMPRODUCT(Defined_Name_1*Defined_Name_2*Defined_Name_3)</code> is a way you could go.  Just need to make sure the length of each defined name range is equal."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10563751"}, "edited": false, "score": 0, "creation_date": 1541065941, "post_id": 53087835, "comment_id": 93093328, "body": "i get an error when i add more than 5 criterias."}], "owner": {"user_type": "does_not_exist", "display_name": "user10563751"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1586755768, "creation_date": 1541002528, "last_edit_date": 1586755768, "question_id": 53087835, "link": "https://stackoverflow.com/questions/53087835/sumproduct-as-string", "title": "sumproduct as string", "body": "<p>i want to evaluate the below formula:</p>\n\n<pre><code>SUMPRODUCT(--(etf_data!$CG$7:$CG$19500=\"Listed\"),\n           --(etf_data!$C$7:$C$19500=Template_region_listed),\n           --(etf_data!$CM$7:$CM$19500=\"Equity\"),\n           --(etf_data!$BW$7:$BW$19500=\"fiat\"),\n           etf_data!$BP$7:$BP$19500,\n           etf_data!$OH$7:$OH$19500)\n</code></pre>\n\n<p>but everytime i try to add a criteria it gives me #Value! error. probably it is because of the 255 limit. is there any way to split the formula in 2 and evaluate them separately? any other solution?</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1541002614, "post_id": 53087679, "comment_id": 93072669, "body": "The <code>ActiveWorkbook</code> (implicitly referenced) apparently does not have a <code>&quot;Top Ten&quot;</code> worksheet. Qualify the <code>Worksheets</code> member call with an explicit <code>Workbook</code> object instance (solid), or make sure the correct/intended workbook is active (frail)."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1541002706, "post_id": 53087679, "comment_id": 93072727, "body": "I strongly recommend reworking this piece of code to stop using <code>.Select</code> and <code>.PasteSpecial</code>. Instead, directly provide the destination range when using <code>.Copy</code>. If you do that, you can get rid of all the <code>.Activate</code> calls as well."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541002862, "post_id": 53087679, "comment_id": 93072821, "body": "&quot;and manually triggering the &quot;run report&quot; macro everything works just fine&quot; - that&#39;s only because the correct workbook happens to be active when you do that. Avoid <code>.Select</code> and <code>.Activate</code>."}, {"owner": {"reputation": 5, "user_id": 6934178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b62f008b19bc6912586dc72dc8180659?s=128&d=identicon&r=PG&f=1", "display_name": "ASpur", "link": "https://stackoverflow.com/users/6934178/aspur"}, "edited": false, "score": 0, "creation_date": 1541005452, "post_id": 53087679, "comment_id": 93074201, "body": "How do I rework this to get rid of the .Select and .PasteSpecial as you describe?    I&quot;m not sure I understand this part."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6934178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b62f008b19bc6912586dc72dc8180659?s=128&d=identicon&r=PG&f=1", "display_name": "ASpur", "link": "https://stackoverflow.com/users/6934178/aspur"}, "edited": false, "score": 0, "creation_date": 1541010026, "post_id": 53089548, "comment_id": 93076495, "body": "The Condensed down code worked perfectly. Thanks for the information.  I&#39;ll hang on to this as I&#39;m sure I will need to use it as a foundation for other reports I&#39;m converting to automated processes.  Thanks for your talents and everyone&#39;s input."}], "tags": [], "owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "is_accepted": true, "score": 0, "last_activity_date": 1541009419, "last_edit_date": 1541009419, "creation_date": 1541009052, "answer_id": 53089548, "question_id": 53087679, "link": "https://stackoverflow.com/questions/53087679/vba-to-copy-data-from-one-workbook-to-another-workbook-worksheet-not-working/53089548#53089548", "title": "VBA to Copy data from one workbook to another workbook/worksheet not working", "body": "<p>I've tried condensing it down for you. To avoid special paste you just assign the values of one range to the other. To avoid select you just apply whatever you would use on a selection on a fully defined range. Since you know your bounds it's easy enough to figure out what the necessary range on the new sheet would be to house all of the values.</p>\n\n<p>If you feel like writing out the workbook and sheet every time is a bit of a hassle you could try using with blocks, or you could create a new variable that's either a worksheet or workbook and set it to be the object you want. An example of this would be </p>\n\n<pre><code>Dim TopTen As Worksheet\nDim NegTrend As Workbook\n\nSet TopTen = Workbooks(\"Negative Trend 2017.xls\").Worksheets(\"Top Ten\")\nSet NegTrend = Workbooks(\"Negative Trend 2017.xls\")\n\nLastRow = TopTen.Cells(Rows.Count, \"B\").End(xlUp).Row + 1\n</code></pre>\n\n<p>The variable is now the worksheet and you can call the same properties you would normally call with a sheet like <code>Range, Cells</code> etc but with less typing and still keeping it fully defined.</p>\n\n<p>Here's your code, condensed down and implementing the with blocks that I had mentioned above.</p>\n\n<pre><code>Sub test()\n    Dim LastRow As Long\n    With Workbooks(\"Negative Trend 2017.xls\").Worksheets(\"Top Ten\")\n        LastRow = .Cells(Rows.Count, \"B\").End(xlUp).Row + 1\n        .Range(\"B\" &amp; LastRow &amp; \":M\" &amp; LastRow + 9).Value = _\n        Workbooks(\"Negative Report Macro Template\").Worksheets(\"Qry_Total\").Range(\"A2:L11\").Value\n    End With\n\n    With Workbooks(\"Negative Report Macro Template\")\n        .Sheets(\"Qry_Summary\").Name = \"Summary\"\n        .Sheets(\"Qry_Total\").Name = \"Detail\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6934178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b62f008b19bc6912586dc72dc8180659?s=128&d=identicon&r=PG&f=1", "display_name": "ASpur", "link": "https://stackoverflow.com/users/6934178/aspur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4581, "favorite_count": 0, "accepted_answer_id": 53089548, "answer_count": 1, "score": 0, "last_activity_date": 1541009419, "creation_date": 1541002030, "last_edit_date": 1541002175, "question_id": 53087679, "link": "https://stackoverflow.com/questions/53087679/vba-to-copy-data-from-one-workbook-to-another-workbook-worksheet-not-working", "title": "VBA to Copy data from one workbook to another workbook/worksheet not working", "body": "<p>I'm having a lot of trouble with some code in an Excel template.  The template code was not done by me but I'm using it to automate a report for my team.  </p>\n\n<p>let me preface my issue with how I'm getting the data to the Template:  The first steps that happen is Access runs a couple of queries and transfers the data to sheets in the Excel template and the opens the template.  Opening the triggers the macro to runs some formatting, calculations and Vlookups.  All works well until I get to the part where I copy data from one Workbook to the worksheet in another workbook.  I've researched here to see if I could find an answer but I'm pretty lost (I'm new to vba coding).  </p>\n\n<p>Here is the code (the Negative trend WB is opened before I get here) </p>\n\n<pre><code>'Copy top ten Data to paste into Negative Trend 2017\n    Worksheets(\"Qry_Total\").Range(\"A2:L11\").Copy\n'PasteSpecial Values Only\n  'Worksheets(\"Sheet2\").Range(\"A2\").PasteSpecial Paste:=xlPasteValues\n\n    Workbooks(\"Negative Trend 2017.xls\").Activate\n    Worksheets(\"Top Ten\").Activate\n\n\n'Finds the last non-blank cell (in Negative Trend column B)and paste top ten data\n    Dim LastRow As String\n\n    LastRow = ActiveSheet.Cells(Rows.Count, \"B\").End(xlUp).Row + 1\n    Range(\"B\" &amp; LastRow).Select\n    Selection.PasteSpecial\n\n'Deselect coppied cells\n    Application.CutCopyMode = False\n\n    Workbooks(\"Negative Report Macro Template\").Activate\n'Disable marching ants around copied range\n    Application.CutCopyMode = False\n\n'Rename Tabs\n    Sheets(\"Qry_Summary\").Name = \"Summary\"\n    Sheets(\"Qry_Total\").Name = \"Detail\"\n</code></pre>\n\n<p>The code breaks here <code>Worksheets(\"Top Ten\").Activate</code> with a </p>\n\n<blockquote>\n  <p>Run_time Error '9'.  </p>\n</blockquote>\n\n<p>the copied data from this line <code>Worksheets(\"Qry_Total\").Range(\"A2:L11\").Copy</code> is not getting pasted here <code>Range(\"B\" &amp; LastRow).Select</code></p>\n\n<p>I\"m missing something.   </p>\n\n<p>Just FYI, if I manually do everything from transferring the access data to the excel WB and manually triggering the \"run report\" macro everything works just fine.    I'm lost.  </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1541002513, "post_id": 53087502, "comment_id": 93072615, "body": "One more nested loop like <code>For Each w2 In Split(w, &quot;_&quot;)</code> will do the job. <code>Split()</code> will return an array formed by the string <code>w</code> split by the delimiter <code>_</code>. In there you can just do your <code>if</code> and <code>arr(Counter)=</code> business on <code>w2</code>."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1541005980, "post_id": 53087502, "comment_id": 93074450, "body": "What&#39;s your actual question? How is the code you have not working, exactly? I think those who&#39;ve responded in comments are interpreting incorrectly... FWIW you can&#39;t change how Word recognizes what a &quot;word&quot; is. You need to explain the logic required for your requirement. For example, is every occurrence of a <code>_</code> to be appended to the &quot;word&quot; before and after it? If not, when not?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1541006115, "post_id": 53087502, "comment_id": 93074519, "body": "Yeah, now that I&#39;m playing around with it @CindyMeister I see that I had the problem backwards. Perhaps the solution is just to join values ending in <code>_</code> with the following value?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1541006223, "post_id": 53087502, "comment_id": 93074569, "body": "@Marcucciboy2 Probably, but let&#39;s wait until the OP provides more precise information..."}], "answers": [{"tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 0, "last_activity_date": 1541007602, "creation_date": 1541007602, "answer_id": 53089194, "question_id": 53087502, "link": "https://stackoverflow.com/questions/53087502/vba-word-change-the-concept-of-worda-b-is-one-word-or-two/53089194#53089194", "title": "VBA - Word change the concept of word(a.b is one word or two)", "body": "<p>This may help.  There is a bit of a wrinkle as you will see below.</p>\n\n<pre><code>Option explicit\n\nSub test()\n\n' Use a collection rather than an array as we don't need\n' to know the size in advance\nDim word_array              As Collection\n' Word doesn't actually have a  'word' object. Probably because\n' that clashes with Word the application.  So instead of Word.Word\n' we are using word.range which gives us all the utility we will\n' need\nDim my_word_range           As Word.Range\nDim my_range                As Word.Range\n\n    For Each my_range In ActiveDocument.StoryRanges\n        For Each my_word_range In my_range.Words\n            With my_word_range\n                Do While .Next(unit:=wdCharacter) = \"_\"\n                    ' '_' is considered to be a word  by Word so we need to\n                    ' count two Word words to get to the end of the next\n                    ' text word IYSWIM\n                    .MoveEnd unit:=wdWord, Count:=2\n\n                Loop\n\n                If .Characters.Count &gt; 28 And .Characters.Count &lt; 40 Then\n                    word_array.Add Item:=.Text\n\n                End If\n\n            End With\n\n        Next\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>If you are new to VBA then </p>\n\n<ol>\n<li><p>Include Option explicit at the top of every module</p></li>\n<li><p>In the VBA IDE go Tools.Option.Editor.Code Settings and make sure every box is ticked.</p></li>\n<li><p>Learn how to use F1.  In the VBA IDE, putting the cursor on a keyword and pressing F1 will bring up the MS help page for that keyword</p></li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 9720205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71490249c1064fa2b8cc01bcec16af71?s=128&d=identicon&r=PG&f=1", "display_name": "LinkiLinki", "link": "https://stackoverflow.com/users/9720205/linkilinki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1541007602, "creation_date": 1541001432, "last_edit_date": 1541005743, "question_id": 53087502, "link": "https://stackoverflow.com/questions/53087502/vba-word-change-the-concept-of-worda-b-is-one-word-or-two", "title": "VBA - Word change the concept of word(a.b is one word or two)", "body": "<p>I have a question: i want to have an array of words of a WORD document, which are larger than 29 and Shorter than 40 characters. I implemented it in VBA this way: </p>\n\n<pre><code>Sub function()\n\n    Dim arr(1000) As String\n    counter = 0\n\n    For Each sentence In ActiveDocument.StoryRanges\n        For Each w In sentence.Words\n            If Len(w) &gt; 28 And Len(w) &lt; 40 Then\n                arr(counter) = w\n                counter = counter + 1\n            End If\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>The Problem is that I want all words with char '_' cosidered as one word; for example: 'Adrian_link_mart' is one word and not 3: 'Adrian' and 'link' and 'mart' like it will be considered</p>\n\n<p>thanks for your help, adrian</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 2, "last_activity_date": 1541002008, "last_edit_date": 1541002008, "creation_date": 1541001803, "answer_id": 53087618, "question_id": 53087491, "link": "https://stackoverflow.com/questions/53087491/looping-through-sheets-in-a-workbook-for-a-specific-cell-to-be-blank/53087618#53087618", "title": "Looping Through Sheets in a Workbook for a Specific Cell to be Blank", "body": "<pre><code>sub FindBlank()\n\nDim ws as worksheet\n\nFor Each ws in ThisworkBook.Worksheets\n    If ws.Range(\"D1\") = \"\" Then\n        ws.Activate\n        Exit For\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>will leave the first worksheet with d1 blank as the active sheet</p>\n"}, {"tags": [], "owner": {"reputation": 175, "user_id": 6847397, "user_type": "registered", "profile_image": "https://graph.facebook.com/865166940350454/picture?type=large", "display_name": "Nelman Jay Louie Vasquez", "link": "https://stackoverflow.com/users/6847397/nelman-jay-louie-vasquez"}, "is_accepted": false, "score": 0, "last_activity_date": 1541005238, "last_edit_date": 1541005238, "creation_date": 1541003103, "answer_id": 53087998, "question_id": 53087491, "link": "https://stackoverflow.com/questions/53087491/looping-through-sheets-in-a-workbook-for-a-specific-cell-to-be-blank/53087998#53087998", "title": "Looping Through Sheets in a Workbook for a Specific Cell to be Blank", "body": "<pre><code>Private Sub SearchSheet()\n\n    Dim Sheet As Worksheet\n    Dim Output As String\n\n    For Each Sheet In Worksheets\n        Output = Sheet.Cells(1, 4) ' Cell D1\n\n        If Output = vbNullString Then\n            MsgBox \"Sheet: \" &amp; Sheet.Name\n            Sheet.Activate\n            Exit Sub\n        End If\n    Next\n\n    ' Clean\n    Set Sheet = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4499869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa215fdd94e96e8d17ad9159a902abf?s=128&d=identicon&r=PG&f=1", "display_name": "William Phelps", "link": "https://stackoverflow.com/users/4499869/william-phelps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1541032881, "answer_count": 2, "score": 0, "last_activity_date": 1586414835, "creation_date": 1541001397, "last_edit_date": 1586414835, "question_id": 53087491, "link": "https://stackoverflow.com/questions/53087491/looping-through-sheets-in-a-workbook-for-a-specific-cell-to-be-blank", "closed_reason": "Needs more focus", "title": "Looping Through Sheets in a Workbook for a Specific Cell to be Blank", "body": "<p>I have looked on this site and many others but not finding the exact piece of code in Excel VBA that I am looking for. Probably not asking in the correct way. I have a workbook that has a worksheet for each day of the year each label like \"mmddyy\". What I am attempting to find is a piece of code that will loop through each worksheet specifically looking at Cell location D1 until it finds the first Worksheet where that cell is blank. then run the remainder of the code which would consist of several copy/paste commands ending with pasting a date in the cell D1 so when the script is ran the next day it now passes over the sheet that was just pasted to.</p>\n"}, {"tags": ["vba", "loops", "for-loop", "do-loops"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1541001151, "post_id": 53087278, "comment_id": 93071741, "body": "Turn it around: put the <code>For</code> inside the <code>Do</code> loop."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1541001165, "post_id": 53087278, "comment_id": 93071755, "body": "So this <code>MsgBox()</code> really comes only once? - <code>MsgBox xMa</code>?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 2, "creation_date": 1541001204, "post_id": 53087278, "comment_id": 93071776, "body": "Use <code>Option Explicit</code> and declare your variables. And avoid <code>GoTo</code>, which looks terrible."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1541001242, "post_id": 53087278, "comment_id": 93071806, "body": "but how do you prorperly error handle in vba without GoTo? o_O"}, {"owner": {"reputation": 11, "user_id": 9219603, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462451123804688/picture?type=large", "display_name": "Ionu\u0163 Sanda", "link": "https://stackoverflow.com/users/9219603/ionu%c5%a3-sanda"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1541001660, "post_id": 53087278, "comment_id": 93072070, "body": "@CindyMeister i tried turning them around, doesn&#39;t work. I receive the error if the <code>myPath</code> was changed, renamed or deleted... @Vityata the <code>MsgBox()</code> appears 3 times, yet the values only populate for one of the 3 cells..."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1541001748, "post_id": 53087278, "comment_id": 93072125, "body": "@Ionu\u0163Sanda - have you tried pressing F8, going step-by-step and seeing what happens?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 2, "creation_date": 1541001797, "post_id": 53087278, "comment_id": 93072150, "body": "@DougCoats <code>On Error GoTo</code> isn&#39;t a <code>GoTo</code> statement, it&#39;s an <code>On Error</code> statement"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1541001843, "post_id": 53087278, "comment_id": 93072182, "body": "@Ionu\u0163Sanda - consider writing <code>myFile = Dir(myPath &amp; myExtension)</code> outside the Do-While loop."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541005865, "post_id": 53087278, "comment_id": 93074393, "body": "@MathieuGuinDon  I was being facetious"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 2, "creation_date": 1541005919, "post_id": 53087278, "comment_id": 93074414, "body": "@DougCoats I was being... a pedantic pain in the neck ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9219603, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462451123804688/picture?type=large", "display_name": "Ionu\u0163 Sanda", "link": "https://stackoverflow.com/users/9219603/ionu%c5%a3-sanda"}, "edited": false, "score": 0, "creation_date": 1541411056, "post_id": 53087710, "comment_id": 93193907, "body": "Hi @Mathieu Guidon. I&#39;ve moved the <code>myFile = Dir(myPath &amp; myExtension)</code> into the For loop and it worked perfectly. Unfortunately, I need to re-process every file multiple times because the purpose of the macro is to gather information for a list of employees."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1541002118, "creation_date": 1541002118, "answer_id": 53087710, "question_id": 53087278, "link": "https://stackoverflow.com/questions/53087278/vba-do-while-loop-in-for-loop-executes-only-once/53087710#53087710", "title": "VBA Do while Loop in For Loop executes only once", "body": "<p><code>Do While...Loop</code> exits when <code>myFile</code> is empty. So at the next <code>For...Next</code> loop iteration, <code>myFile</code> is <em>still</em> empty and thus the second <code>For</code> loop iteration doesn't enter the <code>Do While</code> loop, because its exit condition is met right away.</p>\n\n<p>Consider moving this line:</p>\n\n<pre><code>myFile = Dir(myPath &amp; myExtension)\n</code></pre>\n\n<p>First thing inside the <code>For...Next</code> loop.</p>\n\n<p>...then fix the looping logic so that you don't need to re-process each file 3 times.</p>\n"}], "owner": {"reputation": 11, "user_id": 9219603, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462451123804688/picture?type=large", "display_name": "Ionu\u0163 Sanda", "link": "https://stackoverflow.com/users/9219603/ionu%c5%a3-sanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 53087710, "answer_count": 1, "score": 0, "last_activity_date": 1541002118, "creation_date": 1541000732, "last_edit_date": 1541000972, "question_id": 53087278, "link": "https://stackoverflow.com/questions/53087278/vba-do-while-loop-in-for-loop-executes-only-once", "title": "VBA Do while Loop in For Loop executes only once", "body": "<p>I have an issue where my Do While Loop in a For Loop only executes once. I try to achieve the following:</p>\n\n<p>I have a bunch of excel files (*.xlsm), located in the same folder which contains data for some employees and I want to loop through each of them and get a certain number. So far so good. The issue becomes when I want to \"change\" the employee name. </p>\n\n<p>Given the following code:</p>\n\n<pre><code>Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\nWith FldrPicker\n    .Title = \"Select A Target Folder\"\n    .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    myPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\nNextCode:\nmyPath = myPath\nIf myPath = \"\" Then GoTo ResetSettings\n\nmyExtension = \"*.xlsm\"\nmyFile = Dir(myPath &amp; myExtension)        \n\nFor i = 1 To 3\n    xCallsEin = 0\n    xMa = wb.Sheets(2).Cells(i, 1)\n    MsgBox xMa\n    Do While myFile &lt;&gt; \"\"\n        Set wb2 = Workbooks.Open(Filename:=myPath &amp; myFile)\n        DoEvents\n\n        xCallsEinTemp = Application.WorksheetFunction.VLookup(xMa, wb2.Sheets(1).Range(Columns(2), Columns(6)), 4, 0)\n\n        xCallsEin = xCallsEin + xCallsEinTemp\n\n        wb2.Close SaveChanges:=False\n        DoEvents\n        myFile = Dir\n        wb1.Sheets(1).Cells(i + 6, 2) = xCallsEin        \n    Loop        \nNext i\n</code></pre>\n\n<p>The Do while code executes only once, for the first <code>i</code> in the For Loop.\nI figured out because the <code>myFile</code> variable is empty by the time the first do while loop is done.\nI need help on how to set the <code>myFile</code> variable to something again in order for the do while loop to execute as many times as the for loop.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1541001220, "post_id": 53087170, "comment_id": 93071788, "body": "<code>Call ...</code> is an executable statement, not a declaration. <i>That&#39;s</i> what&#39;s illegal outside a procedure scope. <code>End Function</code> also seems out of place."}, {"owner": {"reputation": 365, "user_id": 2632595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d899d2c6940f18256da3c240922a3bcb?s=128&d=identicon&r=PG", "display_name": "Inception", "link": "https://stackoverflow.com/users/2632595/inception"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541002070, "post_id": 53087170, "comment_id": 93072321, "body": "@MathieuGuindon Thanks, I fixed that portion according to the answer below, but I&#39;m still not sure how to use the Application.Run portion of the code as specified in the API documentation."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541002207, "post_id": 53087170, "comment_id": 93072407, "body": "You don&#39;t need <code>Application.Run</code> (which itself doesn&#39;t need a <code>Call</code> keyword) - below answer demonstrates that the only thing you need to invoke the imported function, is its name... like you have it."}, {"owner": {"reputation": 365, "user_id": 2632595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d899d2c6940f18256da3c240922a3bcb?s=128&d=identicon&r=PG", "display_name": "Inception", "link": "https://stackoverflow.com/users/2632595/inception"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541005312, "post_id": 53087170, "comment_id": 93074136, "body": "Ohk, thanks for clearing the doubt. I&#39;ll keep digging why I&#39;m getting the &#39;can&#39;t find entry point error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541005396, "post_id": 53087170, "comment_id": 93074168, "body": "Is the library correctly registered? If it&#39;s written in .NET, it needs to be registered for COM interop. If there&#39;s a .tlb file with the same name as the .dll, try referencing that instead."}, {"owner": {"reputation": 365, "user_id": 2632595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d899d2c6940f18256da3c240922a3bcb?s=128&d=identicon&r=PG", "display_name": "Inception", "link": "https://stackoverflow.com/users/2632595/inception"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541051651, "post_id": 53087170, "comment_id": 93087854, "body": "I don&#39;t see any .tlb files. I tried regasm, didn&#39;t work"}], "answers": [{"comments": [{"owner": {"reputation": 365, "user_id": 2632595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d899d2c6940f18256da3c240922a3bcb?s=128&d=identicon&r=PG", "display_name": "Inception", "link": "https://stackoverflow.com/users/2632595/inception"}, "edited": false, "score": 0, "creation_date": 1541001638, "post_id": 53087379, "comment_id": 93072053, "body": "When I try this, it says &#39;Can&#39;t find the entry point to EecOne.GenerateActiveTypicalWorksheet&#39; in the .dll file. So I don&#39;t have to use the <code>Call Application.Run</code> portion of the code as specified in the documentation anywhere?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 365, "user_id": 2632595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d899d2c6940f18256da3c240922a3bcb?s=128&d=identicon&r=PG", "display_name": "Inception", "link": "https://stackoverflow.com/users/2632595/inception"}, "edited": false, "score": 0, "creation_date": 1541002021, "post_id": 53087379, "comment_id": 93072287, "body": "That error means that it cannot find a function named <code>EecOne.GenerateActiveTypicalWorksheet</code> in the .dll. Are you sure your <code>Declare</code> statement is correct? Hard to tell whats wrong here since I don&#39;t know anything about that dll."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 365, "user_id": 2632595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d899d2c6940f18256da3c240922a3bcb?s=128&d=identicon&r=PG", "display_name": "Inception", "link": "https://stackoverflow.com/users/2632595/inception"}, "edited": false, "score": 2, "creation_date": 1541002317, "post_id": 53087379, "comment_id": 93072480, "body": "@Inception could it be that you don&#39;t need that <code>Declare</code> statement at all, only add the <code>EecOne</code> type library as a reference to your project, and then you can invoke the function as you would any VBA or Excel function?"}, {"owner": {"reputation": 365, "user_id": 2632595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d899d2c6940f18256da3c240922a3bcb?s=128&d=identicon&r=PG", "display_name": "Inception", "link": "https://stackoverflow.com/users/2632595/inception"}, "edited": false, "score": 0, "creation_date": 1541003825, "post_id": 53087379, "comment_id": 93073368, "body": "@P\u1d07\u029c I tried referencing all 4 dll files available and I get the same error for all. So I think it&#39;s something else."}, {"owner": {"reputation": 365, "user_id": 2632595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d899d2c6940f18256da3c240922a3bcb?s=128&d=identicon&r=PG", "display_name": "Inception", "link": "https://stackoverflow.com/users/2632595/inception"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541003882, "post_id": 53087379, "comment_id": 93073395, "body": "@MathieuGuindon That is a possibility, but I tried adding the dll file as reference but it said &#39;Can&#39;t add reference to the specified file&#39; which is why I tried declaring them"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541405055, "post_id": 53087379, "comment_id": 93191109, "body": "Since your documentation tells you to use <code>Call Application.Run(&quot;EecOne.GenerateActiveTypicalWorksheet&quot;)</code> I assume that there is something like a Excel AddIn that provides the access to your dll? Are there any AddIn files provided? So you don&#39;t need to declare the dll but load an AddIn or something? We can only guess here because we don&#39;t have the documentation. Probably they provide information there how to use it?"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1541001454, "last_edit_date": 1541001454, "creation_date": 1541001058, "answer_id": 53087379, "question_id": 53087170, "link": "https://stackoverflow.com/questions/53087170/invalid-outside-procedure-when-defining-dll-function-in-vba/53087379#53087379", "title": "Invalid Outside Procedure when defining DLL function in VBA", "body": "<p>Syntax should be like this:</p>\n\n<pre><code>Private Declare PtrSafe Function GenerateActiveTypicalWorksheet Lib \"C:\\Program Files\\EPLAN\\EEC One\\2.7.3\\Platform64\\W3ApiBase.dll\" Alias \"EecOne.GenerateActiveTypicalWorksheet\" () As Integer\n\nPrivate Sub Workbook_Open()\n    GenerateActiveTypicalWorksheet\nEnd Sub\n</code></pre>\n\n<p>Note that <code>Private Declare PtrSafe Function</code> is just like a reference to a function in a library. It's just to make it available and has no source code and no <code>End Function</code>. It's more like a link to a function.</p>\n\n<hr>\n\n<p>Issue here was that these two lines \u2026</p>\n\n<pre><code>Call Application.Run(\"EecOne.GenerateActiveTypicalWorksheet\")\nEnd Function\n</code></pre>\n\n<p>were not within a function or procedure therefore you got the error \u2026</p>\n\n<blockquote>\n  <p>Invalid outside procedure</p>\n</blockquote>\n"}], "owner": {"reputation": 365, "user_id": 2632595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d899d2c6940f18256da3c240922a3bcb?s=128&d=identicon&r=PG", "display_name": "Inception", "link": "https://stackoverflow.com/users/2632595/inception"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541001454, "creation_date": 1541000331, "last_edit_date": 1541000869, "question_id": 53087170, "link": "https://stackoverflow.com/questions/53087170/invalid-outside-procedure-when-defining-dll-function-in-vba", "title": "Invalid Outside Procedure when defining DLL function in VBA", "body": "<pre><code>Private Declare PtrSafe Function GenerateActiveTypicalWorksheet Lib \"C:\\Program Files\\EPLAN\\EEC One\\2.7.3\\Platform64\\W3ApiBase.dll\" Alias \"EecOne.GenerateActiveTypicalWorksheet\" () As Integer\n\nCall Application.Run(\"EecOne.GenerateActiveTypicalWorksheet\")\n\nEnd Function\n\nPrivate Sub Workbook_Open()\n\n    GenerateActiveTypicalWorksheet\n\nEnd Sub\n</code></pre>\n\n<p>I'm trying to call a function within the .dll file and I get the error 'Invalid outside procedure'. </p>\n\n<p>This is the only piece of documentation available for the dll/API I'm trying to use: </p>\n\n<p><a href=\"https://i.imgur.com/bjaO4Z2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/bjaO4Z2.png\" alt=\"Attached image\"></a></p>\n\n<p>and this: </p>\n\n<p><a href=\"https://i.imgur.com/RBRwzrp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/RBRwzrp.png\" alt=\"Attached image\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1541000031, "post_id": 53086947, "comment_id": 93070978, "body": "Seems like overkill, unless you wanted absolute references in each row. <code>Range(&quot;A2:A10000&quot;).Formula = &quot;=A1&quot;</code>"}, {"owner": {"reputation": 334, "user_id": 2874210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wefCB.gif?s=128&g=1", "display_name": "Jonas Glesaaen", "link": "https://stackoverflow.com/users/2874210/jonas-glesaaen"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1541000183, "post_id": 53086947, "comment_id": 93071075, "body": "@BigBen Interesting, I didn&#39;t know it would handle relative references like that. Anyway, for my use case I have some very complicated formulas I need to fill out for a large number of cells and sheets and therefore plan to abstract out the range in the end and save the actual saving for last to minimise run time."}, {"owner": {"reputation": 334, "user_id": 2874210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wefCB.gif?s=128&g=1", "display_name": "Jonas Glesaaen", "link": "https://stackoverflow.com/users/2874210/jonas-glesaaen"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541000326, "post_id": 53086947, "comment_id": 93071173, "body": "@Comintern Well, I guess, however I also assumed that .Formula and .Value had slightly different logic as a .Formula naturally is a string, at least on some level. For <code>.Value</code> I totally agree, but what would you say a formula is if not a string?  Edit: Also, as I noted in my answer, VBA will gladly accept a String variable as a formula as long as you only set the formula for a single cell. E.g. <code>[A2].Formula = formulae(1)</code> in the example code of the question works &quot;as expected&quot;."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1541000633, "post_id": 53086947, "comment_id": 93071395, "body": "Instead of using fixed number in loop and in last line, you can use <code>UBound(formulae)</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541000682, "post_id": 53086947, "comment_id": 93071436, "body": "It has to handle this: <code>Sheet1.[A1].Formula = &quot;Foo&quot;</code>.  Note that it adds the explicit <code>&#39;</code> string &quot;tick&quot; to the start of it. It is definitely type aware - <code>Sheet1.[A1].Formula = 42</code> is treated as a number. I&#39;m guessing it performs the type check <i>first</i> (because, well, it kind of has to), and then just passes it to <code>Value</code> internally if it didn&#39;t get a <code>Variant()</code>."}, {"owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "edited": false, "score": 0, "creation_date": 1541018974, "post_id": 53086947, "comment_id": 93080285, "body": "For i = LBound(formulae) to UBound(formulae) is always preferable."}], "tags": [], "owner": {"reputation": 334, "user_id": 2874210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wefCB.gif?s=128&g=1", "display_name": "Jonas Glesaaen", "link": "https://stackoverflow.com/users/2874210/jonas-glesaaen"}, "is_accepted": true, "score": 3, "last_activity_date": 1541001017, "last_edit_date": 1541001017, "creation_date": 1540999703, "answer_id": 53086947, "question_id": 53086946, "link": "https://stackoverflow.com/questions/53086946/passing-an-array-of-strings-to-range-formula-in-excel-vba/53086947#53086947", "title": "Passing an array of strings to Range().Formula in Excel VBA", "body": "<p>While writing this question I found the solution:</p>\n\n<p>The issue was the string array. I generally stay away from <code>Variant</code> due to the slight overhead. As someone coming from C++ declaring everything as variant feels very dirty, but anyway, in this case it is apparently necessary as passing a <code>String</code> will make it paste the value as a literal string.</p>\n\n<p>This is somewhat counter-intuitive to me as passing a single string (not an array) to the <code>.Formula</code> property works. If anyone knows why I would be grateful for that information.</p>\n\n<p>Anyway, working code would be:</p>\n\n<pre><code>Sub Fill_Using_Arrays()\n  Dim i As Long\n  Dim formulae(1 To 10000) As Variant ' Only change here\n\n  For i = 1 To 10000\n    formulae(i) = \"=$A$\" &amp; i\n  Next i\n\n  [A2].Resize(10000).Formula = formulae\nEnd Sub\n</code></pre>\n\n<p>Edit: To be clear, as a follow up I am curious why this works:</p>\n\n<pre><code>  [A2].Formula = formulae(1)\n</code></pre>\n\n<p>And fills this as an actual formula, not as a string.</p>\n"}], "owner": {"reputation": 334, "user_id": 2874210, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wefCB.gif?s=128&g=1", "display_name": "Jonas Glesaaen", "link": "https://stackoverflow.com/users/2874210/jonas-glesaaen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "accepted_answer_id": 53086947, "answer_count": 1, "score": 3, "last_activity_date": 1586414872, "creation_date": 1540999703, "last_edit_date": 1586414872, "question_id": 53086946, "link": "https://stackoverflow.com/questions/53086946/passing-an-array-of-strings-to-range-formula-in-excel-vba", "title": "Passing an array of strings to Range().Formula in Excel VBA", "body": "<p>As everyone knows filling cells with values one by one in VBA is much less efficient than bulk-filling them with an array of values. For the same optimisation reasons I would like to do that with an array of formulas. A very simple example would be something like:</p>\n\n<pre><code>Sub Fill_Using_Arrays()\n  Dim i As Long\n  Dim formulae(1 To 10000) As String\n\n  For i = 1 To 10000\n    formulae(i) = \"=$A$\" &amp; i\n  Next i\n\n  [A2].Resize(10000).Formula = formulae\nEnd Sub\n</code></pre>\n\n<p>However, If I do that it will fill the 10k cells with \"=$A$1\" and so on without actually evaluating the expressions. I tried running a <code>.Calculate</code> on the range as well, but that did nothing. Is it possible to achieve this behaviour?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1540999611, "post_id": 53086879, "comment_id": 93070669, "body": "Can you specify what problem(s) you are having?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6302747"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1540999848, "post_id": 53086879, "comment_id": 93070840, "body": "I am unable to highlight column (it only highlights cell). Not sure how to go about highlighting column"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 4, "creation_date": 1540999953, "post_id": 53086879, "comment_id": 93070920, "body": "<code>mycell.entireColumn.Interior.Color = vbRed</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6302747"}, "edited": false, "score": 0, "creation_date": 1541022683, "post_id": 53086879, "comment_id": 93081644, "body": "Instead of entire column can this just highlight column header? Highlighting all is causing the program to crash"}], "answers": [{"tags": [], "owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "is_accepted": false, "score": 0, "last_activity_date": 1541002455, "creation_date": 1541002455, "answer_id": 53087806, "question_id": 53086879, "link": "https://stackoverflow.com/questions/53086879/highlight-columns-with-differences-between-two-excel-sheets-using-vba/53087806#53087806", "title": "Highlight columns with differences between two excel sheets using VBA", "body": "<p>If the header is in row 1, you can call out the column value of mycell and specify row 1:\n<code>cells(1,mycell.Column).Interior.Color = vbRed</code></p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1541035190, "creation_date": 1541035190, "answer_id": 53093996, "question_id": 53086879, "link": "https://stackoverflow.com/questions/53086879/highlight-columns-with-differences-between-two-excel-sheets-using-vba/53093996#53093996", "title": "Highlight columns with differences between two excel sheets using VBA", "body": "<pre><code>Sub checked()\n    Dim mycell As Range\n    Dim shtSheet1 As Worksheet\n    Set shtSheet1 = Worksheets(\"Sheet1\")\n    With Worksheets(\"Sheet2\")\n        For Each mycell In .UsedRange\n            If Not mycell.Value = shtSheet1.Range(mycell.Address).Value Then .Cells(1, mycell.Column).Interior.Color = vbYellow\n        Next\n    End with\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6302747"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 53093996, "answer_count": 2, "score": -1, "last_activity_date": 1586414908, "creation_date": 1540999511, "last_edit_date": 1586414908, "question_id": 53086879, "link": "https://stackoverflow.com/questions/53086879/highlight-columns-with-differences-between-two-excel-sheets-using-vba", "title": "Highlight columns with differences between two excel sheets using VBA", "body": "<p>Thus far, I have written a VBA script to compare two sheets and highlight the particular cells with the differences. I am trying to highlight the headers or columns of the cells where these differences lie. Here's what I have so far:</p>\n\n<pre><code>Sub checked()\n    Dim mycol As Range\n    Dim mycell As Range\n    Dim shtSheet1 As Worksheet\n    Dim shtSheet2 As Worksheet\n    Set shtSheet1 = Worksheets(\"Sheet1\")\n    Set shtSheet2 = Worksheets(\"Sheet2\")\n    For Each mycell In shtSheet2.UsedRange\n      If Not mycell.Value = shtSheet1.Cells(mycell.Row, mycell.Column).Value Then\n        mycell.Interior.Color = vbRed\n        'mycell.EntireColumn.Interior.Color = vbYellow\n      End If\n\n    Next\nEnd Sub\n</code></pre>\n\n<p>Any help is much appreciated. Thank you!</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1540998044, "post_id": 53086295, "comment_id": 93069568, "body": "Have you tried switching to late binding?   Not sure it would make a difference, but maybe worth a shot."}, {"owner": {"reputation": 1, "user_id": 5235563, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wCVgE2lQTpw/AAAAAAAAAAI/AAAAAAAAAPk/XF0MqXK8_hU/photo.jpg?sz=128", "display_name": "Bryan Podor", "link": "https://stackoverflow.com/users/5235563/bryan-podor"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1540998952, "post_id": 53086295, "comment_id": 93070206, "body": "Thank you for the suggestion. I have tried late binding as well with the same result."}], "owner": {"reputation": 1, "user_id": 5235563, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wCVgE2lQTpw/AAAAAAAAAAI/AAAAAAAAAPk/XF0MqXK8_hU/photo.jpg?sz=128", "display_name": "Bryan Podor", "link": "https://stackoverflow.com/users/5235563/bryan-podor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541000388, "creation_date": 1540997788, "question_id": 53086295, "link": "https://stackoverflow.com/questions/53086295/excel-vba-getobject-returns-type-mismatch-for-outlook-application-due-to-script", "title": "Excel VBA GetObject returns type mismatch for Outlook.Application due to script security", "body": "<p>I am trying to re-purpose a basic worksheet to send out email updates when the sheet is modified. No big deal right? Originally I was simply doing the following:</p>\n\n<pre><code>Dim oApp As Outlook.Application\nDim oMail As Outlook.MailItem\n\nSet oApp = CreateObject(\"Outlook.Application\")\nSet oMail = oApp.CreateItem(0)\n</code></pre>\n\n<p>However we recently switched to Cylance for network security and it will not allow ActiveX to create new objects. My solution was to just use an existing instance of outlook and let users know their Outlook had to already be open, so I modified the code as such:</p>\n\n<pre><code>Dim oApp As Outlook.Application\nDim oMail As Outlook.MailItem\n\nSet oApp = GetObject(, \"Outlook.Application\")\nSet oMail = oApp.CreateItem(0)\n</code></pre>\n\n<p>This fails at run-time with an error 13 type mismatch on the GetObject line, and I am very confused. I'm positive this has to do with Cylance because I tested the code outside of the network environment and it works fine.</p>\n\n<p>Any help would be greatly appreciated, TIA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 6, "creation_date": 1540997545, "post_id": 53086153, "comment_id": 93069214, "body": "When you record a macro it only records what is happening on the front end. If you record a macro, run some code, and then inspect the recorded it won&#39;t show the code that was executed as that&#39;s already written... which is how you executed it. What are you trying to do here? Also to clear some potential confusion, a Recorded Macro is VBA. It records your actions on the front end and writes that as VBA. You already have the VBA that is doing the action here though so it&#39;s not clear why you would want to record it."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1540997763, "post_id": 53086153, "comment_id": 93069375, "body": "Perhaps you are just wanting to assign this <code>Sub SplitColumn()</code> to a hotkey? Or perhaps you want to edit this <code>Sub SplitColumn()</code> code to work against a specific column when it&#39;s run? Please help us understand what you are trying to do."}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 1, "creation_date": 1540999713, "post_id": 53086153, "comment_id": 93070744, "body": "Looks like the code is from the below site. What&#39;s wrong with their existing guide?  <a href=\"https://www.extendoffice.com/documents/excel/2244-excel-split-long-column-into-multiple-columns.html\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 191, "user_id": 10238466, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G3twY1EMVFc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pjXs0FH-siAX3f7jVScQpEiNfJ0Q/mo/photo.jpg?sz=128", "display_name": "Tony Chivers", "link": "https://stackoverflow.com/users/10238466/tony-chivers"}, "edited": false, "score": 0, "creation_date": 1541000003, "post_id": 53086153, "comment_id": 93070959, "body": "There code is fine. My problem is that I am recording a macro I do a bunch of data sorting/filtering tasks, then I want to use their code during the macro."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 10238466, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G3twY1EMVFc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pjXs0FH-siAX3f7jVScQpEiNfJ0Q/mo/photo.jpg?sz=128", "display_name": "Tony Chivers", "link": "https://stackoverflow.com/users/10238466/tony-chivers"}, "edited": false, "score": 0, "creation_date": 1541000767, "post_id": 53087004, "comment_id": 93071486, "body": "Thanks so much, but how does the SplitColumn code know which cell to place the values and how many columns to split it into. Say I needed them in H22 and split into 4"}, {"owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "reply_to_user": {"reputation": 191, "user_id": 10238466, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G3twY1EMVFc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pjXs0FH-siAX3f7jVScQpEiNfJ0Q/mo/photo.jpg?sz=128", "display_name": "Tony Chivers", "link": "https://stackoverflow.com/users/10238466/tony-chivers"}, "edited": false, "score": 1, "creation_date": 1541000880, "post_id": 53087004, "comment_id": 93071572, "body": "@TonyChivers I can&#39;t speak for the KuTools code&#39;s function as I didn&#39;t program that. I was only hoping to illustrate that you can run a sub from another sub."}, {"owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "reply_to_user": {"reputation": 191, "user_id": 10238466, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G3twY1EMVFc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pjXs0FH-siAX3f7jVScQpEiNfJ0Q/mo/photo.jpg?sz=128", "display_name": "Tony Chivers", "link": "https://stackoverflow.com/users/10238466/tony-chivers"}, "edited": false, "score": 1, "creation_date": 1541001557, "post_id": 53087004, "comment_id": 93072004, "body": "@TonyChivers There is absolutely a way to fix the rows and columns, probably several ways depending on your needs. I&#39;d recommend researching creating a range object that refers to the cells you&#39;re interested in. If you need help with that, it&#39;s probably best for you and the rest of the community to ask another question. Good luck!"}], "tags": [], "owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "is_accepted": true, "score": 1, "last_activity_date": 1540999843, "creation_date": 1540999843, "answer_id": 53087004, "question_id": 53086153, "link": "https://stackoverflow.com/questions/53086153/excel-using-visual-basic-whilst-running-a-macro/53087004#53087004", "title": "Excel, using Visual Basic Whilst Running a Macro", "body": "<p>I inserted a module and pasted the above code into it.</p>\n\n<p>I then input two cells, <code>A1 = \"1,1\"</code> and <code>A2 = \"1,2\"</code>.\nNext I recorded a macro that did a flash fill of that series to A30. In the macro, I also set the typeface to bold and then stopped recording.</p>\n\n<p>I opened the module the macro was recorded in and added the line <code>SplitColumn</code>. Running the recorded macro resulted in executing the first couple steps, then running the SplitColumn subroutine, then finishing the macro. Bottom line being that you can call a sub or function from another sub.</p>\n\n<pre><code>Sub flashfill()\n'\n' flashfill Macro\n'\n\n'\n    Selection.AutoFill Destination:=Range(\"A1:A30\"), Type:=xlFillDefault\n    Range(\"A1:A30\").Select\n    SplitColumn\n    Selection.Font.Bold = True\nEnd Sub\n</code></pre>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 191, "user_id": 10238466, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G3twY1EMVFc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pjXs0FH-siAX3f7jVScQpEiNfJ0Q/mo/photo.jpg?sz=128", "display_name": "Tony Chivers", "link": "https://stackoverflow.com/users/10238466/tony-chivers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 53087004, "answer_count": 1, "score": 1, "last_activity_date": 1586414944, "creation_date": 1540997398, "last_edit_date": 1586414944, "question_id": 53086153, "link": "https://stackoverflow.com/questions/53086153/excel-using-visual-basic-whilst-running-a-macro", "title": "Excel, using Visual Basic Whilst Running a Macro", "body": "<p>I am trying to use VBA code whilst running a macro in Microsoft Excel. </p>\n\n<p>I am running a macro by \"RecordMacro\" in excel. </p>\n\n<p>During the macro, I need to use some VBA code. To do this I click Visual Basic and then use some VBA code. </p>\n\n<p>During the macro, the VBA code works as specified, but then when I click stop recording and try and run the macro it misses out completely the VBA part. </p>\n\n<p>The VBA code is already stored in my workbook before I start the macro so I don't see this as a copying and pasting problem. </p>\n\n<p>To try for yourself write a list of numbers in a column, Record and macro and try and execute the below code. </p>\n\n<pre><code>Sub SplitColumn()\n    'Updateby20141106\n    Dim rng As Range\n    Dim InputRng As Range\n    Dim OutRng As Range\n    Dim xRow As Integer\n    Dim xCol As Integer\n    Dim xArr As Variant\n    xTitleId     = \"KutoolsforExcel\"\n    Set InputRng = Application.Selection\n    Set InputRng = Application.InputBox(\"Range :\", xTitleId, InputRng.Address, Type: = 8)\n    xRow         = Application.InputBox(\"Rows :\", xTitleId)\n    Set OutRng   = Application.InputBox(\"Out put to (single cell):\", xTitleId, Type: = 8)\n    Set InputRng = InputRng.Columns(1)\n    xCol         = InputRng.Cells.Count / xRow\n    ReDim xArr(1 To xRow, 1 To xCol + 1)\n    For i = 0 To InputRng.Cells.Count - 1\n        xValue = InputRng.Cells(i + 1)\n        iRow = i Mod xRow\n        iCol = VBA.Int(i / xRow)\n        xArr(iRow + 1, iCol + 1) = xValue\n    Next\n    OutRng.Resize(UBound(xArr, 1), UBound(xArr, 2)).Value = xArr\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word", "clipboard"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1540997420, "post_id": 53086058, "comment_id": 93069118, "body": "What is <code>Selection</code> there? You&#39;re missing a range reference I believe..."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1540997896, "post_id": 53086058, "comment_id": 93069468, "body": "Word&#39;s <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.selection.pastespecial\" rel=\"nofollow noreferrer\"><code>Selection.PasteSpecial</code></a> is not the same as Excel&#39;s <code>Range.PasteSpecial</code>. Not sure why you have <code>xlPasteValues</code>"}, {"owner": {"reputation": 23, "user_id": 10586443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a10351d80b2983dc7aba748d0510b60?s=128&d=identicon&r=PG&f=1", "display_name": "LouisVBA", "link": "https://stackoverflow.com/users/10586443/louisvba"}, "edited": false, "score": 0, "creation_date": 1540998276, "post_id": 53086058, "comment_id": 93069713, "body": "My Selection is the cell that I have copied. I used pastespecial otherwise it would copy it as a table in my word document..."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1540998713, "post_id": 53086058, "comment_id": 93070031, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.selection\" rel=\"nofollow noreferrer\"><code>Selection</code></a> is a <i>Word</i> object. It references <code>objWord</code> in the <code>With...End With</code> block. <code>Selection.PasteSpecial</code> is <i>Word&#39;s</i> <code>PasteSpecial</code> method, which has a different syntax than Excel&#39;s. You&#39;re mixing Word and Excel syntax together."}, {"owner": {"reputation": 23, "user_id": 10586443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a10351d80b2983dc7aba748d0510b60?s=128&d=identicon&r=PG&f=1", "display_name": "LouisVBA", "link": "https://stackoverflow.com/users/10586443/louisvba"}, "edited": false, "score": 0, "creation_date": 1541001118, "post_id": 53086058, "comment_id": 93071719, "body": "Oh well, It that case, is there a &quot;simplier way&quot; to do it? What would be the correct copy/paste option to copy from excel and past it as text in word? My vba code is run when the user press a button in excel"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1541001507, "post_id": 53086058, "comment_id": 93071967, "body": "What you&#39;ve written <i>could</i> work, but it could also give unexpected results. The application-internal enumerations (like <code>xlPasteValues</code>) have a numerical equivalent. The question is, what&#39;s the equivalent of the numerical value of <code>xlPasteValues</code> in Word? Look in the VBA Editor in Word, in the Object Browser (F2). Search for PasteSpecial, then look up the enumeration values for the parameters. OR record a macro in Word when doing PasteSpecial the way you need it and incorporate that in your code."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10586443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a10351d80b2983dc7aba748d0510b60?s=128&d=identicon&r=PG&f=1", "display_name": "LouisVBA", "link": "https://stackoverflow.com/users/10586443/louisvba"}, "edited": false, "score": 0, "creation_date": 1541008869, "post_id": 53088094, "comment_id": 93075943, "body": "Hi BigBen, thanks a lot, this works great! Your first code seems to work 100% of the time. I have some cells that have bold text (not always in the same cell), would you have a tric to past it as bold (i.e. keep the text formatting? Thank you."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 23, "user_id": 10586443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a10351d80b2983dc7aba748d0510b60?s=128&d=identicon&r=PG&f=1", "display_name": "LouisVBA", "link": "https://stackoverflow.com/users/10586443/louisvba"}, "edited": false, "score": 0, "creation_date": 1541011052, "post_id": 53088094, "comment_id": 93076954, "body": "You might have to rethink your approach. I&#39;m not sure you can paste as text and still keep the bold without pasting as a table."}, {"owner": {"reputation": 23, "user_id": 10586443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a10351d80b2983dc7aba748d0510b60?s=128&d=identicon&r=PG&f=1", "display_name": "LouisVBA", "link": "https://stackoverflow.com/users/10586443/louisvba"}, "edited": false, "score": 0, "creation_date": 1541011310, "post_id": 53088094, "comment_id": 93077068, "body": "After the  <code>.Selection.PasteSpecial DataType:=wdPasteText</code>, would it be possible to add lines like: [IF .Selection = &quot;specification&quot;, then bold], in the sense that I know which words I want in bold, but I just can&#39;t predict in which cell they will be"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 23, "user_id": 10586443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a10351d80b2983dc7aba748d0510b60?s=128&d=identicon&r=PG&f=1", "display_name": "LouisVBA", "link": "https://stackoverflow.com/users/10586443/louisvba"}, "edited": false, "score": 0, "creation_date": 1541012767, "post_id": 53088094, "comment_id": 93077645, "body": "You should be able to do a find and replace all, replacing with bold-formatted text."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1541010835, "last_edit_date": 1541010835, "creation_date": 1541003398, "answer_id": 53088094, "question_id": 53086058, "link": "https://stackoverflow.com/questions/53086058/clipboard-error-copying-from-excel-to-word-document/53088094#53088094", "title": "Clipboard error copying from Excel to Word document", "body": "<p>If you want to paste as text, perhaps:</p>\n\n<pre><code>Sub CopyAsTextToWord()\n    Dim wordApp As New Word.Application\n\n    With wordApp\n        .Visible = True\n        .Documents.Add\n\n        Worksheets(\"Description2\").Range(\"A1:A66\").Copy\n        .Selection.PasteSpecial DataType:=wdPasteText\n    End With\nEnd Sub\n</code></pre>\n\n<p>If on the other hand you want to paste each cell <em>one at a time</em> (this is what it seems like from your original code, not sure), perhaps a slightly different approach, avoiding the clipboard. Read the range into an array, iterate through it and then use <code>Selection.TypeText</code> to \"paste\" each element sequentially. Probably can be made more robust.</p>\n\n<pre><code>Sub TransferAsText()\n    Dim wordApp As New Word.Application\n\n    With wordApp\n        .Visible = True\n        .Documents.Add\n\n        Dim arr()\n        arr = Worksheets(\"Description2\").Range(\"A1:A66\").Value\n\n        Dim i As Long\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            .Selection.TypeText Text:=CStr(arr(i, 1))\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10586443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a10351d80b2983dc7aba748d0510b60?s=128&d=identicon&r=PG&f=1", "display_name": "LouisVBA", "link": "https://stackoverflow.com/users/10586443/louisvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 828, "favorite_count": 0, "accepted_answer_id": 53088094, "answer_count": 1, "score": 2, "last_activity_date": 1616679869, "creation_date": 1540997100, "last_edit_date": 1616679869, "question_id": 53086058, "link": "https://stackoverflow.com/questions/53086058/clipboard-error-copying-from-excel-to-word-document", "title": "Clipboard error copying from Excel to Word document", "body": "<p>I am trying to copy text in Excel cells (cell A1 to A66) into a Word document. The goal of this operation is to copy it and paste it as TEXT. If copied directly from Excel, it will paste as a TABLE.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Bouton1_Click()\n    \n    Dim objWord As New Word.Application\n    With objWord\n        .Documents.Add\n        Application.Wait (Now + TimeValue(&quot;0:00:01&quot;) / 2)\n        Worksheets(&quot;Description2&quot;).Cells(1, 1).Copy\n        Application.Wait (Now + TimeValue(&quot;0:00:01&quot;) / 2)\n        .Selection.PasteSpecial xlPasteValues\n        .Visible = True\n    End With\n    \n    Dim i As Integer\n    For i = 2 To 66\n        If Worksheets(&quot;Description2&quot;).Cells(i, 1) = Worksheets(&quot;Description2&quot;).Cells(i + 1, 1) Then Exit For\n        With objWord\n            Application.Wait (Now + TimeValue(&quot;0:00:01&quot;) / 2)\n            Worksheets(&quot;Description2&quot;).Cells(i, 1).Copy\n            Application.Wait (Now + TimeValue(&quot;0:00:01&quot;) / 2)\n            .Selection.PasteSpecial xlPasteValues\n            .Visible = True\n        End With\n    Next i\n    \n    objWord.Application.Activate\n    objWord.Application.WindowState = wdWindowStateMaximize\n    \nEnd Sub\n</code></pre>\n<p>This code works about 70% of the time. When it doesn't work, I get this error (or a variation, but always concerning the clipboard):</p>\n<blockquote>\n<p>Run-Time error &quot;4605&quot;: This method or property is not available<br />\nbecause the clipboard is empty or not valid.</p>\n</blockquote>\n<p>Also, sometimes a random OneDrive window opens.</p>\n<p>I've added the <code>Application.Wait</code> lines to try to slow down the copy/paste, but it doesn't do that much.</p>\n<p>How can I make my code more reliable?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 1, "creation_date": 1541022522, "post_id": 53085967, "comment_id": 93081596, "body": "A letter merge outputs a Section break after every record; hence the final, empty, Section. Instead of re-inventing the wheel, you might care to look at the topics <i>Send Mailmerge Output to Individual Files</i> and <i>Split Merged Output to Separate Documents</i> in the <b>Mailmerge Tips and Tricks</b> thread at <a href=\"http://www.msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.html\" rel=\"nofollow noreferrer\">msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.ht&zwnj;&#8203;ml</a> or <a href=\"http://windowssecrets.com/forums/showthread.php/163017-Word-Mailmerge-Tips-amp-Tricks\" rel=\"nofollow noreferrer\">windowssecrets.com/forums/showthread.php/&hellip;</a>"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1541058052, "post_id": 53085967, "comment_id": 93090054, "body": "@macropod great page indeed. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 0, "last_activity_date": 1541000953, "last_edit_date": 1541000953, "creation_date": 1540999430, "answer_id": 53086854, "question_id": 53085967, "link": "https://stackoverflow.com/questions/53085967/splitting-mailmerge-doc-why-is-the-last-doc-empty/53086854#53086854", "title": "Splitting MailMerge doc: why is the last doc empty?", "body": "<p>The code to remove the section break at end of output doc was emptying the document when no section break was present.</p>\n\n<pre><code>        With doc.Sections.Last.Range\n            .MoveStart wdCharacter, -1\n            .Delete\n        End With  \n</code></pre>\n\n<p>replaced by</p>\n\n<pre><code>        With Selection.Find\n            .Text = \"^b\"\n            .Replacement.Text = \"\"\n            .Execute Replace:=wdReplaceAll\n        End With\n</code></pre>\n"}], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 53086854, "answer_count": 1, "score": 0, "last_activity_date": 1541000953, "creation_date": 1540996823, "last_edit_date": 1541000948, "question_id": 53085967, "link": "https://stackoverflow.com/questions/53085967/splitting-mailmerge-doc-why-is-the-last-doc-empty", "title": "Splitting MailMerge doc: why is the last doc empty?", "body": "<p>Title says it all - mostly. This is my first Word macro.<br>\nI try to split the result of a MailMerge into separate files. Logic seems good to me, but the very last doc is always empty. Any idea why ?</p>\n\n<p>I noticed that there is no section mark at the end the the Merged doc.\nThe macro is called when the MailMerge doc is activated.</p>\n\n<pre><code>Sub SplitDoc()\n    Dim sec As Section, doc As Document, fn As String\n    Dim targetfolder As String\n\n    targetfolder = \"Y:\\\\\"   'ignore this :-)\n\n     For Each sec In ActiveDocument.Sections\n        sec.Range.Copy\n        Set doc = Documents.Add\n        doc.Range.Paste\n        fn = Mid(Split(doc.Paragraphs(3).Range.Text, \", \")(0), 5)\n        Debug.Print Now, fn\n\n       'Removes the break that is copied at the end of the section, if any.\n        With doc.Sections.Last.Range\n            .MoveStart wdCharacter, -1\n                       '============= here is the issue: \n                       'for the last section (without ending section mark)\n            .Delete    'it deletes the empties the whole doc\n        End With\n        'restore page setup that was stored in the section break\n        With doc.PageSetup\n            .TopMargin = CentimetersToPoints(2)\n            .BottomMargin = CentimetersToPoints(2)\n            .LeftMargin = CentimetersToPoints(2)\n            .RightMargin = CentimetersToPoints(2)\n        End With\n\n        doc.SaveAs FileName:=fn &amp; \".docx\"\n        doc.Close\n        Set doc = Nothing\n     Next sec\n     Debug.Print Now, \"Done\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "range", "bubble-chart"], "comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 3, "creation_date": 1540996136, "post_id": 53085660, "comment_id": 93068256, "body": "Maybe include some screen shots. Doesn&#39;t seem clear what you&#39;re asking for."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 1, "creation_date": 1540996415, "post_id": 53085660, "comment_id": 93068440, "body": "Also, which line are you receiving the error? Error 91 means you are trying to use an object set to Nothing"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1540996901, "post_id": 53085660, "comment_id": 93068749, "body": "See <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">The VBA Guide To ListObject Excel Tables</a> for how to properly access a <i>table</i> in Excel VBA. You must probably use something like <code>ActiveSheet.ListObjects(&quot;Table&quot;).DataBodyRange(i, 1)</code>"}, {"owner": {"reputation": 1, "user_id": 10586422, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214499884785877/picture?type=large", "display_name": "Rasmus Holt Hansen", "link": "https://stackoverflow.com/users/10586422/rasmus-holt-hansen"}, "edited": false, "score": 0, "creation_date": 1541071147, "post_id": 53085660, "comment_id": 93095905, "body": "Am I allowed to upload my project file somewhere and post the link here? I&#39;m not sure a screenshot is enough, and I&#39;m really searching for a solution, which should be included in my Master&#39;s thesis."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1541427465, "post_id": 53085660, "comment_id": 93202623, "body": "You could manually link your labels to cells.  Use a formula to pull the correct project name into a specific cell and then click your label twice before selecting the formula bar and then your cell.  John Peltier explains it on his <a href=\"https://peltiertech.com/apply-custom-data-labels-to-charted-points/\" rel=\"nofollow noreferrer\">site</a> - third heading."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10586422, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214499884785877/picture?type=large", "display_name": "Rasmus Holt Hansen", "link": "https://stackoverflow.com/users/10586422/rasmus-holt-hansen"}, "edited": false, "score": 0, "creation_date": 1541061116, "post_id": 53086760, "comment_id": 93091190, "body": "I&#39;m not sure whether I&#39;m doing it wrong or not, but I keep receiving the error: &quot;Object variable or With block variable not set&quot;.. I have you copied your code into the worksheet macro, changed the chart name and the range to match, and placed a button to trigger the macro. What does this mean?"}, {"owner": {"reputation": 21, "user_id": 8255897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c95ecbe0b1b974eae0340804b4dd7bf?s=128&d=identicon&r=PG&f=1", "display_name": "Bojan Goldy", "link": "https://stackoverflow.com/users/8255897/bojan-goldy"}, "reply_to_user": {"reputation": 1, "user_id": 10586422, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214499884785877/picture?type=large", "display_name": "Rasmus Holt Hansen", "link": "https://stackoverflow.com/users/10586422/rasmus-holt-hansen"}, "edited": false, "score": 0, "creation_date": 1541512506, "post_id": 53086760, "comment_id": 93236395, "body": "This should work. Please let m know if you still have issues. Thank you."}, {"owner": {"reputation": 1, "user_id": 10586422, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214499884785877/picture?type=large", "display_name": "Rasmus Holt Hansen", "link": "https://stackoverflow.com/users/10586422/rasmus-holt-hansen"}, "edited": false, "score": 0, "creation_date": 1541584899, "post_id": 53086760, "comment_id": 93263682, "body": "So now my vba looks like this, where I&#39;m receiving an error ( ) in the marked line.    Set ChtObj = .ChartObjects(&quot;Chart 1&quot;)   Set rngLabels = .Range(&quot;Table1[Project &#39;#]&quot;)           Set DataLR = ChtObj.Chart.SeriesCollection(1)           DataLR.HasDataLabels = True        For Each pt In pts  &#39; &lt;--- Run-time error 424: Object required        IDi = IDi + 1            pt.DataLabel.Text = rngLabels.Cells(IDi).Text            pt.DataLabel.Font.Bold = True        Next pt   End With End Sub  Also my range should not include the header (Set rngLabels) so how to achieve this as well?"}, {"owner": {"reputation": 21, "user_id": 8255897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c95ecbe0b1b974eae0340804b4dd7bf?s=128&d=identicon&r=PG&f=1", "display_name": "Bojan Goldy", "link": "https://stackoverflow.com/users/8255897/bojan-goldy"}, "reply_to_user": {"reputation": 1, "user_id": 10586422, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214499884785877/picture?type=large", "display_name": "Rasmus Holt Hansen", "link": "https://stackoverflow.com/users/10586422/rasmus-holt-hansen"}, "edited": false, "score": 0, "creation_date": 1541601780, "post_id": 53086760, "comment_id": 93272128, "body": ".Range(&quot;A5:A39&quot;)  - you need to update the range and specify the fist one you would like to take"}, {"owner": {"reputation": 1, "user_id": 10586422, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214499884785877/picture?type=large", "display_name": "Rasmus Holt Hansen", "link": "https://stackoverflow.com/users/10586422/rasmus-holt-hansen"}, "edited": false, "score": 0, "creation_date": 1542012877, "post_id": 53086760, "comment_id": 93401772, "body": "I&#39;ve tried that but I&#39;m still receiving an error in the &quot;For Each pt in pts&quot;: 424: Object required."}, {"owner": {"reputation": 1, "user_id": 10586422, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214499884785877/picture?type=large", "display_name": "Rasmus Holt Hansen", "link": "https://stackoverflow.com/users/10586422/rasmus-holt-hansen"}, "edited": false, "score": 0, "creation_date": 1542821703, "post_id": 53086760, "comment_id": 93709576, "body": "It looks like the code is missing the value for pt and pts. How do I implement this in the code? It is only mentioned in the dim as Points?"}, {"owner": {"reputation": 21, "user_id": 8255897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c95ecbe0b1b974eae0340804b4dd7bf?s=128&d=identicon&r=PG&f=1", "display_name": "Bojan Goldy", "link": "https://stackoverflow.com/users/8255897/bojan-goldy"}, "reply_to_user": {"reputation": 1, "user_id": 10586422, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214499884785877/picture?type=large", "display_name": "Rasmus Holt Hansen", "link": "https://stackoverflow.com/users/10586422/rasmus-holt-hansen"}, "edited": false, "score": 0, "creation_date": 1544109433, "post_id": 53086760, "comment_id": 94167417, "body": "You need to define the range where it will find the values for the points."}], "tags": [], "owner": {"reputation": 21, "user_id": 8255897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c95ecbe0b1b974eae0340804b4dd7bf?s=128&d=identicon&r=PG&f=1", "display_name": "Bojan Goldy", "link": "https://stackoverflow.com/users/8255897/bojan-goldy"}, "is_accepted": false, "score": 0, "last_activity_date": 1541605081, "last_edit_date": 1541605081, "creation_date": 1540999132, "answer_id": 53086760, "question_id": 53085660, "link": "https://stackoverflow.com/questions/53085660/excel-vba-add-data-labels-from-table-body-range/53086760#53086760", "title": "Excel VBA - Add Data Labels from Table body range", "body": "<p>This is code that I use for data labels from a range. Have found this on stackoverflow a while back:</p>\n\n<pre><code>Sub DataLables \n    Dim ws as worksheet, DataLR As Series, pts As Points, pt As Point, rngLabels As Range, IDi As Integer, ChtObj As ChartObject\n    Set ws = ActiveWorkbook.ActiveSheet \n\n    With ws\n    Set ChtObj = .ChartObjects(\"ChatName\")\n    Set rngLabels = .Range(\"A5:A39\")\n            Set DataLR = ChtObj.Chart.SeriesCollection(2)\n            DataLR.HasDataLabels = True  \n         For Each pt In pts\n         IDi = IDi + 1\n             pt.DataLabel.Text = rngLabels.Cells(IDi).Text\n             pt.DataLabel.Font.Bold = True\n         Next pt    \n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Let me know if this helps. It will update the data labels with the values in the range.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10586422, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214499884785877/picture?type=large", "display_name": "Rasmus Holt Hansen", "link": "https://stackoverflow.com/users/10586422/rasmus-holt-hansen"}, "is_accepted": true, "score": 0, "last_activity_date": 1542876992, "creation_date": 1542876992, "answer_id": 53427115, "question_id": 53085660, "link": "https://stackoverflow.com/questions/53085660/excel-vba-add-data-labels-from-table-body-range/53427115#53427115", "title": "Excel VBA - Add Data Labels from Table body range", "body": "<p>So I did find the solution myself. Here's my final code inserting labels from the Table into the Bubble Chart:</p>\n\n<pre><code>Sub DataLables()\n\n  ActiveSheet.ChartObjects(\"Chart 1\").Activate\n  ActiveChart.FullSeriesCollection(1).DataLabels.Select\n\n  For i = 1 To Range(\"Table1[Project '#]\").Count\n\n    ActiveChart.FullSeriesCollection(1).Points(i).DataLabel.Select\n\n    Selection.Formula = Range(\"Table1[Project '#]\").Cells(i, 1)\n\n  Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10586422, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214499884785877/picture?type=large", "display_name": "Rasmus Holt Hansen", "link": "https://stackoverflow.com/users/10586422/rasmus-holt-hansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2154, "favorite_count": 0, "accepted_answer_id": 53427115, "answer_count": 2, "score": 0, "last_activity_date": 1586416476, "creation_date": 1540995887, "last_edit_date": 1586416476, "question_id": 53085660, "link": "https://stackoverflow.com/questions/53085660/excel-vba-add-data-labels-from-table-body-range", "title": "Excel VBA - Add Data Labels from Table body range", "body": "<p>I have an Excel worksheet with a table that contains columns for project name, x, y, size in order to create a bubble graph.</p>\n\n<p>I would like it to change the Data labels to be equal to the respective project name but how do I do that? I've searched on the web for solutions but neither of them with succes.</p>\n\n<p>Here's my data:</p>\n\n<ul>\n<li>Chart name: Chart 1 </li>\n<li>Table name: Table (This one have headers and I'm\nonly searching for the range within the table (data body range).</li>\n</ul>\n\n<p>Here's my code which gives me the error 91:</p>\n\n<pre><code>Sub InsertLabelnameBubble()\n    ActiveChart.FullSeriesCollection(1).DataLabels.Select\n\n    For i = 1 To Range(\"Table\").Rows.Count\n        ActiveChart.FullSeriesCollection(1).Points(i).DataLabel.Select\n        Selection.Formula = Range(\"Table\").Cells(i, 1)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Here's a screenshot of my project.</p>\n\n<p><a href=\"https://i.stack.imgur.com/fqAIi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fqAIi.jpg\" alt=\"Screenshot 1\"></a></p>\n\n<p>Where you can see that it uses the Y column (Expected project potential) as the data label text. What I would like it to do is that it should take it from the first column in my table (Project #).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1540995900, "post_id": 53085435, "comment_id": 93068109, "body": "Try calling the <code>Worksheet_Change</code> event from the own Listbox <code>change</code> event with <code>Call Worksheet_Change</code>"}, {"owner": {"reputation": 13, "user_id": 9587113, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Miroslav", "link": "https://stackoverflow.com/users/9587113/miroslav"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1540998300, "post_id": 53085435, "comment_id": 93069736, "body": "Thank you for the advice @PEH. I did inserted the code below, but nothing seems to happen?       Private Sub ComboBox1_Change()                                     Worksheet_Change Range(&quot;A1&quot;)                                     End Sub"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1541001663, "post_id": 53085435, "comment_id": 93072073, "body": "If you assign a cell to hold the value of the listbox selection then that cell&#39;s change will fire the worksheet change event."}, {"owner": {"reputation": 13, "user_id": 9587113, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Miroslav", "link": "https://stackoverflow.com/users/9587113/miroslav"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1541008046, "post_id": 53085435, "comment_id": 93075522, "body": "Hi @Harassed, the cell changes when selection is made at the listbox, but it doesnt trigger the change event. Only if I make the change manually directly in the cell. Then the macro works."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9587113, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Miroslav", "link": "https://stackoverflow.com/users/9587113/miroslav"}, "edited": false, "score": 0, "creation_date": 1541004520, "post_id": 53087783, "comment_id": 93073717, "body": "Hi @Foxfire And Burns And Burns, Thank you for the help. I have added you macro above. But I am not sure what to use in replacement of the (ActiveCell) in first macro? Currently both of the macro runs (I added a message box after the Call in MyMacro), but nothing happens then?!"}, {"owner": {"reputation": 13, "user_id": 9587113, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Miroslav", "link": "https://stackoverflow.com/users/9587113/miroslav"}, "edited": false, "score": 0, "creation_date": 1541016824, "post_id": 53087783, "comment_id": 93079547, "body": "I have played with the macro further and there seems to be some problem in the main macro. I can actually trigger it from the Listbox and it runs as it displays the two Msg boxes, but it does not change the Checkboxes. If I however change the range in the spreadsheet directly the change_even runs and updates the Checkboxes correctly:"}, {"owner": {"reputation": 13, "user_id": 9587113, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Miroslav", "link": "https://stackoverflow.com/users/9587113/miroslav"}, "edited": false, "score": 0, "creation_date": 1541016935, "post_id": 53087783, "comment_id": 93079589, "body": "Macro:Public Sub Worksheet_Change(ByVal Target As Range)  Dim R As Range, c As Range, cb As OLEObject  MsgBox &quot;hello&quot;, vbOKOnly   Set R = Me.Range(&quot;C115:C135&quot;) If Not Intersect(Target, R) Is Nothing Then      For Each c In Intersect(Target, R)         For Each cb In Me.OLEObjects             If cb.Name Like &quot;CheckBox&quot; &amp; Val(Split(c.Address, &quot;$&quot;)(2)) - 14 Then                 cb.Enabled = c.Value &gt; 0             End If         Next cb     Next c     End If      MsgBox &quot;hello number 2&quot;, vbOKOnly      End Sub"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1541002373, "creation_date": 1541002373, "answer_id": 53087783, "question_id": 53085435, "link": "https://stackoverflow.com/questions/53085435/how-to-disable-checkbox-based-on-user-selection-in-excel/53087783#53087783", "title": "How to disable checkbox based on user selection in excel", "body": "<p>You need to be kind of tricky here.</p>\n\n<p>First of all, <strong>in the desired worksheet where you have the code you have posted</strong>, write a new sub like this:</p>\n\n<pre><code>Sub MyMacro()\nCall Worksheet_Change(ActiveCell) 'change ActiveCell for the range you want to be the target\nEnd Sub\n</code></pre>\n\n<p>Then, from the event <code>Change</code> of the Listbox, try:</p>\n\n<pre><code>Private Sub ComboBox1_Change()\nCall Hoja1.MyMacro 'Replace Hoja1 with the name of your worksheet in VBA.\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1541063582, "post_id": 53097675, "comment_id": 93092224, "body": "It sounds like you&#39;re using a <code>Form</code> or <code>ActiveX</code> listbox.  You could use the <i>Data Validation</i> list which would fire on a <code>Worksheet_Change</code> event."}, {"owner": {"reputation": 13, "user_id": 9587113, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Miroslav", "link": "https://stackoverflow.com/users/9587113/miroslav"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1541096228, "post_id": 53097675, "comment_id": 93109479, "body": "Hi @Darren Bartrup-Cook, the problem with data validation I had was that it didn&#39;t show the scroll button. Although I guess there is a way to change the display."}], "tags": [], "owner": {"reputation": 13, "user_id": 9587113, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Miroslav", "link": "https://stackoverflow.com/users/9587113/miroslav"}, "is_accepted": false, "score": 0, "last_activity_date": 1541063305, "last_edit_date": 1541063305, "creation_date": 1541061468, "answer_id": 53097675, "question_id": 53085435, "link": "https://stackoverflow.com/questions/53085435/how-to-disable-checkbox-based-on-user-selection-in-excel/53097675#53097675", "title": "How to disable checkbox based on user selection in excel", "body": "<p>I was actually able to modify the macro so it can be used directly in the modul and called directly from the list box. See below. Thank you all for your advise.\nSorry I struggle to indent the full code.</p>\n\n<pre><code>Public Sub Checkboxupdate()\n\nDim R As Range, c As Range, cb As OLEObject, hb As CheckBox\n\nSet R = Range(\"C115:C135\")\nIf Not R Is Nothing Then\n\n    For Each c In R\n    On Error Resume Next\n        For Each cb In ActiveSheet.OLEObjects\n            If cb.Name Like \"CheckBox\" &amp; Val(Split(c.Address, \"$\")(2)) - 14 Then\n\n                cb.Enabled = c.Value &gt; 0\n\n            End If\n        Next cb\n    Next c\n    End If\n\n    MsgBox \"Currency availability updated.\", vbOKOnly\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9587113, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Miroslav", "link": "https://stackoverflow.com/users/9587113/miroslav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1586416512, "creation_date": 1540995254, "last_edit_date": 1586416512, "question_id": 53085435, "link": "https://stackoverflow.com/questions/53085435/how-to-disable-checkbox-based-on-user-selection-in-excel", "title": "How to disable checkbox based on user selection in excel", "body": "<p>I need to disable checkboxes depending on list of variables. For example if user selects \"Spain\" in a Listbox only some checkbox currencies should be allowed. </p>\n\n<ol>\n<li>I have a table of currencies with value one or zero based on the user selection and this get update. Zero means currency is not available.</li>\n<li>I have a macro which reads the list and will disable or enable the individual list boxes. However this as a Worksheet_Change even\" and it doesn't get called via the Listbox selection change. Although my range gets updated after user makes the selection.\nSo I think I need a Module based macro which would be called when user makes a Listbox selection, but struggle to modify my current macro.</li>\n</ol>\n\n<p>My current code is:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim R As Range, c As Range, cb As OLEObject\n\n' set a range where the cell will be either 1 or 0 depending on country selection\n\nSet R = Me.Range(\"C115:C135\")\nIf Not Intersect(Target, R) Is Nothing Then\n\n' sets the checbox to zero if related cell value in range is zero\n\n    For Each c In Intersect(Target, R)\n        For Each cb In Me.OLEObjects\n        ' Identifies the relevant Checkbox name based on related cell address\n            If cb.Name Like \"CheckBox\" &amp; Val(Split(c.Address, \"$\")(2)) - 14 Then\n                cb.Enabled = c.Value &gt; 0\n            End If\n        Next cb\n    Next c\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 6, "creation_date": 1540995259, "post_id": 53085396, "comment_id": 93067663, "body": "You can just record a macro and enter your formula then stop the macro. Then you will have your answer"}, {"owner": {"reputation": 850, "user_id": 6775799, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4Aj4ZxZOYro/AAAAAAAAAAI/AAAAAAAAAs4/Wh1aQqkHkrc/photo.jpg?sz=128", "display_name": "Rahul Chawla", "link": "https://stackoverflow.com/users/6775799/rahul-chawla"}, "edited": false, "score": 2, "creation_date": 1540995465, "post_id": 53085396, "comment_id": 93067802, "body": "<code>ThisWorkbook.Sheets(&quot;Sheet2&quot;).Range(&quot;B2&quot;).Formula = &quot;=LOOKUP(Sheet1!F2,{&quot; &amp; &quot;&quot;&quot;&quot; &amp; &quot;FL01&quot; &amp; &quot;&quot;&quot;&quot; &amp; &quot;,FL12&quot; &amp; &quot;&quot;&quot; &quot;,FL21&quot; &amp; &quot;&quot;&quot;&quot; &amp; &quot;,FL31&quot; &amp; &quot;&quot;&quot;&quot; &amp; &quot;,FL34&quot; &amp; &quot;&quot;&quot;&quot; &amp; &quot;},{&quot; &amp; &quot;&quot;&quot;&quot; &amp; &quot;ORLANDO PICKLIST&quot; &amp; &quot;&quot;&quot;&quot; &amp; &quot;,TAMPA PICKLIST&quot; &amp; &quot;&quot;&quot;&quot; &amp; &quot;,JAX PICKLIST&quot; &amp; &quot;&quot;&quot;&quot; &amp; &quot;,NAPLES PICKLIST&quot; &amp; &quot;&quot;&quot;&quot; &amp; &quot;,MIAMI PICKLIST&quot; &amp; &quot;&quot;&quot;&quot; &amp; &quot;})&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 3, "creation_date": 1540996826, "post_id": 53085684, "comment_id": 93068698, "body": "The macro recorder <i>is</i> a great way to figure out to start writing VBA code. Extra +1 for making note of the fact that it writes <i>terrible</i> (but functional) code that then needs to be massaged into something decent."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1540997014, "post_id": 53085684, "comment_id": 93068834, "body": "And <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">here&#39;s a good SO thread</a> on how to avoid using <code>.Select&#47;.Activate</code>."}], "tags": [], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "is_accepted": true, "score": 5, "last_activity_date": 1540995935, "creation_date": 1540995935, "answer_id": 53085684, "question_id": 53085396, "link": "https://stackoverflow.com/questions/53085396/excel-vba-lookup-in-macro/53085684#53085684", "title": "Excel VBA - =lookup in macro", "body": "<p>By <a href=\"https://www.excel-easy.com/vba/examples/macro-recorder.html\" rel=\"noreferrer\">recording</a> it </p>\n\n<p><a href=\"https://i.stack.imgur.com/lS0KK.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/lS0KK.png\" alt=\"enter image description here\"></a></p>\n\n<p>you will get something like this:</p>\n\n<pre><code>Option Explicit\n\nSub Macro3()\n'\n' Macro3 Macro\n'\n\n'\n    Selection.FormulaArray = _\n        \"=LOOKUP(Sheet1!RC[4],{\"\"FL01\"\";\"\"FL12\"\";\"\"FL21\"\";\"\"FL31\"\";\"\"FL34\"\"},{\"\"ORLANDO PICKLIST\"\";\"\"TAMPA PICKLIST\"\";\"\"JAX PICKLIST\"\";\"\"NAPLES PICKLIST\"\";\"\"MIAMI PICKLIST\"\"})\"\n    With Selection.Font\n        .Name = \"Calibri\"\n        .Size = 24\n    End With\n    With Selection\n        .HorizontalAlignment = xlGeneral\n    End With\nEnd Sub\n</code></pre>\n\n<p>Where selection is which cell I selected when I started recording (\"<code>B2</code>\"). From here you can play around with the code. You will get a feeling for how Excel \"Translate\" your formulas and your format options into code.</p>\n\n<p>By edit the selection part (<code>Selection.</code>) we can be more explicit which worksheet and which range we want to apply the new code into... </p>\n\n<pre><code>Sub Macro3_Changes()\n'\n' Macro3 Macro\n'\n\n'\n    Worksheets(\"Sheet2\").Range(\"B2\").FormulaArray = _\n        \"=LOOKUP(Sheet1!RC[4],{\"\"FL01\"\";\"\"FL12\"\";\"\"FL21\"\";\"\"FL31\"\";\"\"FL34\"\"},{\"\"ORLANDO PICKLIST\"\";\"\"TAMPA PICKLIST\"\";\"\"JAX PICKLIST\"\";\"\"NAPLES PICKLIST\"\";\"\"MIAMI PICKLIST\"\"})\"\n    With Selection.Font\n        .Name = \"Calibri\"\n        .Size = 24\n    End With\n    With Selection\n        .HorizontalAlignment = xlGeneral\n    End With\nEnd Sub\n</code></pre>\n\n<p>Here is some interesting note, I assume that you had an Array formula. I enter your formula with Ctrl + Shift + Enter. The macro records that too and translate it as  <code>FormulaArray</code>. If I have just enter the formula it would have been <code>FormulaR1C1</code> which is a relative formula from the section you selected. </p>\n"}], "owner": {"reputation": 45, "user_id": 10576027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec4316d546322b7ddfcc20906003364e?s=128&d=identicon&r=PG&f=1", "display_name": "Andres", "link": "https://stackoverflow.com/users/10576027/andres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 53085684, "answer_count": 1, "score": 4, "last_activity_date": 1540995935, "creation_date": 1540995129, "question_id": 53085396, "link": "https://stackoverflow.com/questions/53085396/excel-vba-lookup-in-macro", "title": "Excel VBA - =lookup in macro", "body": "<p>I'm using this formula to get info from another sheet. I would like to make it in a macro.</p>\n\n<pre><code>=LOOKUP(Sheet1!F2,{\"FL01\",\"FL12\",\"FL21\",\"FL31\",\"FL34\"},{\"ORLANDO PICKLIST\",\"TAMPA PICKLIST\",\"JAX PICKLIST\",\"NAPLES PICKLIST\",\"MIAMI PICKLIST\"})\n</code></pre>\n\n<p>Also the answer to be in sheet2 B2 center font size 24 .</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba", "listbox", "userform"], "comments": [{"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1540993962, "post_id": 53084992, "comment_id": 93066786, "body": "Simply write Range(&quot;A1&quot;).Value = ListBox1.Text or Range(&quot;A1&quot;).Value = ListBox1.Value"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10558415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb7299f15d9b6c5381051cbcba7ce17?s=128&d=identicon&r=PG&f=1", "display_name": "Skye", "link": "https://stackoverflow.com/users/10558415/skye"}, "edited": false, "score": 0, "creation_date": 1541007517, "post_id": 53085071, "comment_id": 93075278, "body": "Would writing values in cells this way overwrite the cell or continue down with each submission?"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 13, "user_id": 10558415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb7299f15d9b6c5381051cbcba7ce17?s=128&d=identicon&r=PG&f=1", "display_name": "Skye", "link": "https://stackoverflow.com/users/10558415/skye"}, "edited": false, "score": 0, "creation_date": 1541007750, "post_id": 53085071, "comment_id": 93075386, "body": "it would overwrite unless you have some loop that iterates over the range you want to write to"}, {"owner": {"reputation": 13, "user_id": 10558415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb7299f15d9b6c5381051cbcba7ce17?s=128&d=identicon&r=PG&f=1", "display_name": "Skye", "link": "https://stackoverflow.com/users/10558415/skye"}, "edited": false, "score": 0, "creation_date": 1541008464, "post_id": 53085071, "comment_id": 93075727, "body": "Do you have a link to a loop written for this reason or a similar loop? I&#39;m familiar with loops in other languages but I don&#39;t know how to format/structure them in VBA. If not that&#39;s fine, I&#39;ll just do some more googling."}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 13, "user_id": 10558415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb7299f15d9b6c5381051cbcba7ce17?s=128&d=identicon&r=PG&f=1", "display_name": "Skye", "link": "https://stackoverflow.com/users/10558415/skye"}, "edited": false, "score": 0, "creation_date": 1541008751, "post_id": 53085071, "comment_id": 93075890, "body": "@Skye I added a little example code block in my answer. Is that similar to what you are after?"}], "tags": [], "owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "is_accepted": true, "score": 0, "last_activity_date": 1541008021, "last_edit_date": 1541008021, "creation_date": 1540994059, "answer_id": 53085071, "question_id": 53084992, "link": "https://stackoverflow.com/questions/53084992/excel-vba-userforms-how-do-i-transfer-data-from-a-list-box-to-a-worksheet-cell/53085071#53085071", "title": "Excel VBA Userforms: How do I transfer data from a List Box to a worksheet cell?", "body": "<p>The ListBox Control object will have some name. So if your form is called <code>frm</code> and the listbox object is named <code>lstBox</code>, you would move its selected value to a range, <code>myRange</code> like this:</p>\n\n<p><code>myRange.value = frm.lstBox.text</code></p>\n\n<p>If you wanted to loop through cells in a range if would look something like:</p>\n\n<pre><code>Dim cell as range\n\nFor each cell in myRange\n    cell.value = frm.lstBox.text\nnext cell\n</code></pre>\n\n<p>The above would write the value in the ListBox to each cell in the range.</p>\n"}], "owner": {"reputation": 13, "user_id": 10558415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb7299f15d9b6c5381051cbcba7ce17?s=128&d=identicon&r=PG&f=1", "display_name": "Skye", "link": "https://stackoverflow.com/users/10558415/skye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 0, "accepted_answer_id": 53085071, "answer_count": 1, "score": -1, "last_activity_date": 1541008021, "creation_date": 1540993814, "question_id": 53084992, "link": "https://stackoverflow.com/questions/53084992/excel-vba-userforms-how-do-i-transfer-data-from-a-list-box-to-a-worksheet-cell", "title": "Excel VBA Userforms: How do I transfer data from a List Box to a worksheet cell?", "body": "<p>I have a ListBox with three options: Cylinder, Ellipsoid, and Frustum. The User chooses one of these and hits the submit button. What I would like to do is write their choice in a cell on my worksheet when the submit button is clicked. How do I do this?</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1540995281, "post_id": 53084969, "comment_id": 93067676, "body": "Huh? <code>INSERT INTO .... VALUES ...</code> doesn&#39;t come with a <code>WHERE</code> clause. I don&#39;t really understand what you&#39;re asking."}, {"owner": {"reputation": 29, "user_id": 10358185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3eb65823ac7ea0075f2164ace3f012?s=128&d=identicon&r=PG&f=1", "display_name": "TAS1987", "link": "https://stackoverflow.com/users/10358185/tas1987"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1540995733, "post_id": 53084969, "comment_id": 93067994, "body": "@ErikvonAsmuth Well it works - I&#39;m thinking the problem I&#39;m actually having is getting the record saved to the database in a way that can be queried. Why wouldn&#39;t you use a Where clause when inserting (you have to delete the contents of the &#39;cell&#39; holding the values and then insert not update with them - took a lot of googling to find that out)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3728595"}, "edited": false, "score": 0, "creation_date": 1541001288, "post_id": 53084969, "comment_id": 93071837, "body": "What data type is your ID column? You say &#39;Autonumber&#39; above but you can set the value yourself, right?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1541002076, "post_id": 53084969, "comment_id": 93072326, "body": "What&#39;s a <code>WHERE</code> clause when inserting even supposed to do? <code>insert into [Outcome Testing] ( [Key Findings].Value ) Values (15)</code> just inserts a single new row, right? Anyway, if you run that with a <code>WHERE</code> clause, Access is supposed to return the error <i>Query input input must contain at least one table or query</i>, if it works something odd is happening. The <code>WHERE</code> clause does work with <code>UPDATE</code> or <code>INSERT INTO .. SELECT ...</code>"}, {"owner": {"reputation": 29, "user_id": 10358185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3eb65823ac7ea0075f2164ace3f012?s=128&d=identicon&r=PG&f=1", "display_name": "TAS1987", "link": "https://stackoverflow.com/users/10358185/tas1987"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1541003764, "post_id": 53084969, "comment_id": 93073347, "body": "@ErikvonAsmuth as I said it does work - because it is using a MultiValue field (not my idea) you have to use Insert and not update but it does actually work the same as an Update query when using the MultiValue field. There are several posts on Stackoverflow about it although I agree (and so did most people on the post) that it makes no sense. See <a href=\"https://stackoverflow.com/questions/6018172/update-a-multi-valued-field-in-access\" title=\"update a multi valued field in access\">stackoverflow.com/questions/6018172/&hellip;</a>"}, {"owner": {"reputation": 29, "user_id": 10358185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3eb65823ac7ea0075f2164ace3f012?s=128&d=identicon&r=PG&f=1", "display_name": "TAS1987", "link": "https://stackoverflow.com/users/10358185/tas1987"}, "edited": false, "score": 0, "creation_date": 1541003883, "post_id": 53084969, "comment_id": 93073396, "body": "@user3728595 The ID is an auto incrementing number so I will assume it is a number value within the database. It really seems to be hit and miss that the queries work and no consistent pattern in it. I can see the record in the table but it just wont let me select it using the ID, then in other instances it does. Is there something that happens in the database that I&#39;m not aware of that causes the file to be indexed to be found or something like that?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1541004263, "post_id": 53084969, "comment_id": 93073598, "body": "Please specify you&#39;re using a multi valued field in the question. That&#39;s very relevant!"}, {"owner": {"reputation": 29, "user_id": 10358185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3eb65823ac7ea0075f2164ace3f012?s=128&d=identicon&r=PG&f=1", "display_name": "TAS1987", "link": "https://stackoverflow.com/users/10358185/tas1987"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1541004324, "post_id": 53084969, "comment_id": 93073632, "body": "@ErikvonAsmuth OK."}, {"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 0, "creation_date": 1541084130, "post_id": 53084969, "comment_id": 93102842, "body": "If your ID is an autonumber it will never have a negative value, if you actually have negative numbers, then you are not using autonumbering, something else is generating this value and we need to know what the datatype of the ID is. From your explanation above it looks like you are using text since WHERE ID = -8 isn&#39;t returning a record that has -8 as a value, try WHERE ID = &#39;-8&#39;"}, {"owner": {"reputation": 29, "user_id": 10358185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3eb65823ac7ea0075f2164ace3f012?s=128&d=identicon&r=PG&f=1", "display_name": "TAS1987", "link": "https://stackoverflow.com/users/10358185/tas1987"}, "reply_to_user": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 0, "creation_date": 1541415923, "post_id": 53084969, "comment_id": 93196629, "body": "@Jeffrey I believe the ID autonumber is negative because it uses linked SharePoint lists for the tables. Once synced with the SharePoint lists the ID becomes a positive number (the next in the sequence) but because it doesn&#39;t know what this positive number will be until it is synced Access gives it a temporary negative number on the local table."}, {"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 0, "creation_date": 1541431144, "post_id": 53084969, "comment_id": 93204868, "body": "Wow, I didn&#39;t know that, please disregard the egg on my face. However, are you sure that your query isn&#39;t trying to access the sharepoint tables instead of the local tables? That would be an easy explanation to why nothing shows up when you search for a negative value (because once it syncs to sharepoint it is no longer negative)."}, {"owner": {"reputation": 29, "user_id": 10358185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3eb65823ac7ea0075f2164ace3f012?s=128&d=identicon&r=PG&f=1", "display_name": "TAS1987", "link": "https://stackoverflow.com/users/10358185/tas1987"}, "reply_to_user": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 0, "creation_date": 1541586761, "post_id": 53084969, "comment_id": 93264658, "body": "@Jeffrey Not to worry, took me many days of searching to find that out! I think it&#39;s looking at the local table, sometimes the query works and some times it doesn&#39;t. I&#39;m thinking its something to do with saving the record to the able (although I can see the record in the table just not query it). If I add another record after it then suddenly the original record becomes available in a query. Very frustrating."}], "owner": {"reputation": 29, "user_id": 10358185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3eb65823ac7ea0075f2164ace3f012?s=128&d=identicon&r=PG&f=1", "display_name": "TAS1987", "link": "https://stackoverflow.com/users/10358185/tas1987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541004373, "creation_date": 1540993730, "last_edit_date": 1541004373, "question_id": 53084969, "link": "https://stackoverflow.com/questions/53084969/access-sql-cant-select-on-id-pk", "title": "Access SQL Cant select on ID/PK", "body": "<p>UPDATED at bottom of Question:</p>\n\n<p>I have a database in Access 2010. Tables are lined SharePoint lists.\nThe user adds data to a user form and submits this. The data is stored on the local table on their desktop - the ID (Autonumber) column is automatically given a negative value which is updated when the user has a network connection and Syncs with SharePoint.</p>\n\n<p>I am trying to work with this data which requires selecting the data using this unique ID before it is synced with SharePoint. The same query will work sometimes but not others.</p>\n\n<p>Ultimately my questions is:\nWhy does the SQL query work after the record has been synced to SharePoint and the ID is a positive number but doesn't work when the ID is a negative number before syncing to SharePoint?</p>\n\n<p>The SQL query is being created on the fly using VBA. An example query is:</p>\n\n<pre><code>insert into [Outcome Testing] ( [Key Findings].Value ) Values (15) Where [Outcome Testing].[Reference] = 'Reference1' and [Outcome Testing].[File Reference] = 'FileRef1' and ID = '-6'\n</code></pre>\n\n<p>If I run this as below it works fine</p>\n\n<pre><code>    insert into [Outcome Testing] ( [Key Findings].Value ) Values (15) Where [Outcome Testing].[Reference] = 'Reference1' and [Outcome Testing].[File Reference] = 'FileRef1'\n</code></pre>\n\n<p>I have been playing around with this - I also cant run a select query on the ID after submitting the data from a form to the table. The form can (using buttons set using the wizard) move back and forth between records and I can see the record in the table. I can see (for example) that the ID has a value of -8.</p>\n\n<p>However a query like the one below returns nothing.</p>\n\n<pre><code>Select * from [Outcome Table] where ID = -8\n</code></pre>\n\n<p>If I have given the same record a FileReference of File1 I can run the query below and it does return the record I am looking for and it does show the ID of -8</p>\n\n<pre><code>Select * from [Outcome Table] where [File Reference] = 'File1'\n</code></pre>\n\n<p>If I save and close the database then reopen it and run the query on the ID number (-8) then it returns the record. I for the life of me can not work out why this is happening.\nAny advice and tips are welcome.</p>\n\n<p>NOTE - The Insert Query is to insert into a multi valued field. The Insert is not the issue at the moment it is being able to select by the ID value.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1540993827, "post_id": 53084870, "comment_id": 93066675, "body": "While I don&#39;t see it, it <i>might</i> be causing an endless loop where Range(&quot;B2&quot;) gets changed by VBA (perhaps indirectly by way of a formula) which calls the Worksheet_Change() event again, which triggers the same change, which triggers the same Worksheet_Change(). To insure this isn&#39;t happening in your Worksheet_Change() event toggle off <code>EnableEvents</code> like: <code>Application.EnableEvents = False</code> and then at the end toggle it back on."}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1540993870, "post_id": 53084870, "comment_id": 93066710, "body": "when the workbook is freezing, does it look like it is running vba (with &quot;running...&quot; in the vba editor window caption? If so, can you try to interrupt execution with Ctrl + Pause/Break?"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1540993898, "post_id": 53084870, "comment_id": 93066737, "body": "@JNevill - this is exactly what I was thinking too"}, {"owner": {"reputation": 13, "user_id": 8230452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a298895243d8e538171e28006e346d18?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8230452/jeff"}, "edited": false, "score": 0, "creation_date": 1540993933, "post_id": 53084870, "comment_id": 93066768, "body": "Thanks for your comments. I forgot to include those. Please see my updated code. I Have one version with those and one without, both causing the error"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1540994282, "post_id": 53084870, "comment_id": 93067016, "body": "Nothing in the code would trigger a <code>Worksheet_Change</code> event it seems since this event is not triggered by a cells value changing due to a formula. Your code does not physically change a cells value anywhere so I don&#39;t think that is the problem"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1540994623, "post_id": 53084870, "comment_id": 93067236, "body": "<code>Set pt</code> is not correct, you may not see it because you have an error trap"}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 2, "creation_date": 1540995021, "post_id": 53084870, "comment_id": 93067510, "body": "in your worksheet_change, if the intersect condition is false, then you don&#39;t restore the application.screenupdating calculation and enable events. I would actually only set them to false,manual,false inside the if statement."}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 1, "creation_date": 1540995321, "post_id": 53084870, "comment_id": 93067708, "body": "plus, do you really need to catch the error in &#39;worksheet_change&#39; ? you are catching it inside conditionalFormatting.conditionalFormatting . If an error occured you probably want to be informed about it and you are suppresing it"}, {"owner": {"reputation": 13, "user_id": 8230452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a298895243d8e538171e28006e346d18?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8230452/jeff"}, "edited": false, "score": 0, "creation_date": 1540995640, "post_id": 53084870, "comment_id": 93067926, "body": "Thank your for your replies. I have tested a bit. The code doesn&#39;t seem to run when the error occur. I tried to remove the ExportToPDF module, but error still persist. I have tried to put the application-changes inside the if-statement as well as removing them in the worksheet_change, but error still occurs. The strange part is that the code works 100% as it should (or at least as I would expect) when only the xlsm-file is open. I haven&#39;t been able to see a pattern either because sometime it actually works with another xlsx-file open, but the error appear after awhile."}, {"owner": {"reputation": 13, "user_id": 8230452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a298895243d8e538171e28006e346d18?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8230452/jeff"}, "edited": false, "score": 0, "creation_date": 1540995904, "post_id": 53084870, "comment_id": 93068113, "body": "The actionbar of the second worksheet is all greyed-out when it opens (if that gives any clues). Good question SNicolaou - I have done it for in some other parts of the worksheet but was unable to change the character-size with Excels conditional formatting"}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1540996391, "post_id": 53084870, "comment_id": 93068421, "body": "ok, yes it seems you need vba to change the size and font family..."}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1540996923, "post_id": 53084870, "comment_id": 93068761, "body": "does your xlsm file that causes the problem have any macro inside of it?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540997248, "post_id": 53084870, "comment_id": 93068989, "body": "I&#39;m voting to close this question as off-topic because if this issue occurs after &quot;removing all modules and clearing all macros&quot; per the comment below, an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> has not been provided."}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1540997446, "post_id": 53084870, "comment_id": 93069143, "body": "apologies for the many comments, but do you need to have both workbooks open in the same excel instance? (as a temporary workaround) can you run a new excel instance: &quot;Windows Button + Key R&quot; and then in the textbox enter &quot;excel /x&quot; and click ok. That is assuming that excel.exe is in the path environment variable. If not (you will get an error) you have to include the full path to excel.exe i.e. &quot;C:\\Somewhere\\depends\\onXL\\version\\excel.exe /x&quot;"}, {"owner": {"reputation": 13, "user_id": 8230452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a298895243d8e538171e28006e346d18?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8230452/jeff"}, "edited": false, "score": 0, "creation_date": 1540997585, "post_id": 53084870, "comment_id": 93069246, "body": "Just give me one sec, I&#39;m currently testing. But what keeps this difficult is that it does not occur with other xlsm-files (with different macros obviously), it does occur with or without the application-statements, it occurs without some of the macros present."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1540997682, "post_id": 53084870, "comment_id": 93069316, "body": "I repeat, your <code>set pt</code> is incorrect"}, {"owner": {"reputation": 13, "user_id": 8230452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a298895243d8e538171e28006e346d18?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8230452/jeff"}, "edited": false, "score": 0, "creation_date": 1541000699, "post_id": 53084870, "comment_id": 93071448, "body": "I have tested a bit further, see my findings in the original question/text. I suppose the loop is causing this (?). Is there a way to rewrite Workbook_change to not cause looping? I will also take the other comments into consideration! Thanks for being helpful and patient by the way!"}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1541001237, "post_id": 53084870, "comment_id": 93071802, "body": "can you add a msgbox in your error catch to see if an error occured? Place exit sub (and application.xyx = w) before &quot;ApplicationOn:&quot; and put &quot;msgbox err.description&quot; after the &quot;ApplicationOn:&quot; this is to check if errors are happening."}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1541002052, "post_id": 53084870, "comment_id": 93072310, "body": "long shot  but you are referencing Sheets(&quot;Dashboard&quot;) when you got two workbooks open. You need to be sure that the Sheets(&quot;Dashboard&quot;) is referenced on the correct workbook. perhaps check if the worksheet exists before making the Set DASHBOARD = Sheets(&quot;Dashboard&quot;)"}, {"owner": {"reputation": 13, "user_id": 8230452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a298895243d8e538171e28006e346d18?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8230452/jeff"}, "edited": false, "score": 0, "creation_date": 1541002433, "post_id": 53084870, "comment_id": 93072554, "body": "I will try, but I now tried to remove all macros (local in sheets and modules) from the wb (no macros are visible from &quot;Macros&quot;-button under Developer), and the error still occurs when opening another wb in addition to having a value in the dropdown-list... Setting the dropdown-list to blank and the error disappears.The same xlsx-file opens without problems using a different wb and a wb with other macros...This doesn&#39;t make sense to me... Either the error is caused by the formulas in the wb or the wb itself is broken/corrupt. I have never experienced this before."}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1541002539, "post_id": 53084870, "comment_id": 93072632, "body": "ok, so next thing is what typical helpdesk person will tell you (apologies for any offence). Have you tried to close your excel and restart your pc? (not joking)"}, {"owner": {"reputation": 13, "user_id": 8230452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a298895243d8e538171e28006e346d18?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8230452/jeff"}, "edited": false, "score": 0, "creation_date": 1541003458, "post_id": 53084870, "comment_id": 93073172, "body": "None taken, because its a good suggestion and usuallly it works, but I&#39;ve tried it. I think I just have to create a new wb and test frequently as I rebuild it."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8230452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a298895243d8e538171e28006e346d18?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8230452/jeff"}, "edited": false, "score": 0, "creation_date": 1540996659, "post_id": 53085619, "comment_id": 93068585, "body": "Thanks for your reply. Clearly I haven&#39;t understood the use of application-changes, and I will redo my code. But what bugs me is that even with these changes (or in fact removing all modules and clearing all macros) the error still occurs... I know its difficult to troubleshoot without having the spreadsheet, but can a Excel-file just be &quot;broken&quot; without giving any errors and behaving the way I&#39;m describing? I&#39;m using win7 (yes...) if that matters."}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1540996764, "post_id": 53085619, "comment_id": 93068653, "body": "&quot;can a Excel-file just be &quot;broken&quot; without giving any errors&quot;....i want to say No but my experience doesn&#39;t let me :-)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 13, "user_id": 8230452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a298895243d8e538171e28006e346d18?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8230452/jeff"}, "edited": false, "score": 0, "creation_date": 1540996779, "post_id": 53085619, "comment_id": 93068665, "body": "@Jeff If the error occurs with no code at all, I&#39;m not sure I understand the question."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1540995782, "creation_date": 1540995782, "answer_id": 53085619, "question_id": 53084870, "link": "https://stackoverflow.com/questions/53084870/both-workbook-freezes-when-updating-the-first-xlsm-while-the-second-xlsx-i/53085619#53085619", "title": "Both workbook &quot;freezes&quot; when updating the first (xlsm) while the second (xlsx) is open", "body": "<p>If you cause an error in <strong><em>any</em></strong> of these functions, you set <code>Application.EnableEvents = True</code>. So... If those are triggered from a call originating from inside an event handler, you lose your re-entry protection. You also unconditionally do this at the top of everything:</p>\n\n<blockquote>\n<pre><code>Application.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n</code></pre>\n</blockquote>\n\n<p>That smacks of <a href=\"https://codereview.stackexchange.com/a/158080/36565\">cargo-cult behavior</a>. You should only be performing this work where it is necessary, and close to the <strong><em>place</em></strong> where it is necessary. Whatever performance gains you think you're getting by doing this are probably just illusory. In fact, repeatedly messing with the <code>Application</code> state is probably doing more <em>harm</em> than good from a performance standpoint.</p>\n\n<p>The solution is to not rely on Excel to guard re-entry into your event handler - do it manually:</p>\n\n<pre><code>Private reentryFlag As Boolean    'Module level\n\nSub Worksheet_Change(ByVal Target As Range)\n    If reentryFlag Then Exit Sub\n    reentryFlag = True\n\n    On Error GoTo Handler\n    If Intersect(Target, Range(\"B4\")) Is Nothing Then Exit Sub\n\n    conditionalFormatting.conditionalFormatting\nHandler:\n    reentryFlag = False\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 8230452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a298895243d8e538171e28006e346d18?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8230452/jeff"}, "is_accepted": true, "score": 0, "last_activity_date": 1541424743, "creation_date": 1541424743, "answer_id": 53155425, "question_id": 53084870, "link": "https://stackoverflow.com/questions/53084870/both-workbook-freezes-when-updating-the-first-xlsm-while-the-second-xlsx-i/53155425#53155425", "title": "Both workbook &quot;freezes&quot; when updating the first (xlsm) while the second (xlsx) is open", "body": "<p>Seems like there was a mysterious error with the Excel-file. I rebuilt the dashboard and it worked as expected. To be on the safe-side I skipped the \"Workbook_change\"-code linked to a  filter and just used a simple button to execute the code instead. Thanks for everyone's input.  </p>\n"}], "owner": {"reputation": 13, "user_id": 8230452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a298895243d8e538171e28006e346d18?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/8230452/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 53155425, "answer_count": 2, "score": 0, "last_activity_date": 1586416549, "creation_date": 1540993488, "last_edit_date": 1586416549, "question_id": 53084870, "link": "https://stackoverflow.com/questions/53084870/both-workbook-freezes-when-updating-the-first-xlsm-while-the-second-xlsx-i", "title": "Both workbook &quot;freezes&quot; when updating the first (xlsm) while the second (xlsx) is open", "body": "<p><strong>The problem</strong></p>\n\n<p>I have a workbook (A) which includes some macros as well as being linked to another Excel-file (data source). The workbook works perfectly and without problems if I only have this individual workbook open. If I open another random xlsx-file everything looks OK at first. But as soon as I make any updates whatsoever (e.g. pressing F2 in an empty cell and then enter) in workbook A, both workbooks seems to freeze. I can still close the workbooks in a normal procedure and the macro-button in workbook A works fine (and will trigger the macro), but I'm unable to change tabs in wb A and the tabs in the second workbook disappears. I can see the cursor, but the green Excel-border/box around target-cells are gone in both workbooks. I am also unable to update any of the cells in the workbooks...</p>\n\n<p><strong>What I've tried</strong></p>\n\n<p>I have tried to;</p>\n\n<ul>\n<li><p>remove all data source connections</p></li>\n<li><p>remove all macros (one by one, but problem still exist without any macros in wb A...)</p></li>\n<li><p>go through the macros to see if they causes any errors (which they don't as far as I can see)</p></li>\n<li><p>two other xlsm-files (unrelated to wb A) does not cause this type of error</p></li>\n<li><p>i've tried to use application.ScreenUpdating = False, .EnableEvents = False, .Calculation = xlCalculationManual, and setting them back to original values at the end.</p></li>\n</ul>\n\n<p><strong>Code</strong></p>\n\n<p>-Range(\"B4\") is a dropdown-list without blanks. The following macro lies in Sheet1:</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n\n    On Error GoTo ApplicationON:\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n\n    If Intersect(Target, Range(\"B4\")) Is Nothing Then Exit Sub\n       Call conditionalFormatting.conditionalFormatting\n\nApplicationON:\n    On Error Resume Next\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>-The following macro lies in a module called \"conditionalFormatting\":</p>\n\n<pre><code>Sub conditionalFormatting()\n\n    On Error GoTo ApplicationON:\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n\n    Dim DASHBOARD   As Worksheet\n    Dim rng1        As Range\n    Dim rng2        As Range\n    Dim cel         As Range\n    Dim col1        As Integer\n    Dim col2        As Integer\n\n    Set DASHBOARD = Sheets(\"DASHBOARD\")\n    Set rng1 = Range(\"R15:R45\")\n    Set rng2 = Range(\"R15:Z45\")\n    col1 = 18\n    col2 = 26\n\n    With rng2\n        .Cells.Font.Bold = False\n        .Cells.Font.Italic = False\n        .Cells.Font.Size = 11\n    End With\n\n    For Each cel In rng1\n        Select Case cel.Value\n\n        Case _\n        \"Case1\", _\n        \"Case2\"\n            Range(Cells(cel.Row, col1), Cells(cel.Row, col2)).Font.Bold = True\n\n        Case _\n        \"Case3\", _\n        \"Case4\"\n           Range(Cells(cel.Row, col1), Cells(cel.Row, col2)).Font.Size = 8\n\n        Case _\n        \"Case5\", _\n        \"Case6\"\n           Range(Cells(cel.Row, col1), Cells(cel.Row, col2)).Font.Italic = True\n\n       End Select\n    Next  \n\nApplicationON:\n    On Error Resume Next\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True \n\nEnd Sub\n</code></pre>\n\n<p>-The following macro lies in a module called \"ExportToPDF\" and has a button in worksheet \"DASHBOARD\" (sheet1):</p>\n\n<pre><code>Sub ExportToPDF()\n\n    On Error GoTo ApplicationON:\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n\n    Dim pt As Range\n\n    dateStamp = Format(Now(), \"yyyymmdd\\_hhmm\")\n    workbookPath = ActiveWorkbook.Path &amp; \"\\\"\n    workbookName = ActiveWorkbook.Name\n    file_Name = dateStamp &amp; \"_\" &amp; Sheets(\"DASHBOARD\").Range(\"A1\") &amp; \".pdf\"\n    filePath = workbookPath &amp; file_Name\n\n    With Worksheets(\"DASHBOARD\").PageSetup\n    .PrintArea = \"A6:O42\"\n    .Orientation = xlLandscape\n    End With\n\n    Set pt = \n  Worksheets(\"DASHBOARD\").Range(Worksheets(\"DASHBOARD\").PageSetup.PrintArea)\n\n    pt.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=filePath, _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=True\n\n    MsgBox \"PDF file has been created: \" _\n          &amp; filePath\n\nApplicationON:\n    On Error Resume Next\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True \n\nEnd Sub\n</code></pre>\n\n<p><strong>After some additional testing</strong></p>\n\n<p>It seems it has to do with looping and module Workbook_change + my dropdown-list which does not include any blank values. But still strange that it works perfectly without any other wb open, but only becomes a problem when opening an additional wb. Can't see that the code is running either when both wbs freezes...</p>\n\n<p>1) made a copy and removed the data connections (so it doesn't interfere), and saving and closing the workbook</p>\n\n<p>2) Opening the workbook (without any of the errorHandling and application-statement) without make any changes/updates in the spreadsheets, and opening a second file (slsx) - error occur</p>\n\n<p>3) Opening the workbook (without any of the errorHandling and application-statement) and writing \"=1+1\" in an random empty cell, and opening a second file (slsx) - error occur</p>\n\n<p>4) Opening the workbook (without any of the errorHandling and application-statement) and changing the dropdown-list once (calling the worksheet_change macro), and opening a second file (slsx) - error occur</p>\n\n<p>5) Opening the workbook (in original state as posted) without making any changes/updates in the spreadsheets, and opening a second file (slsx) - error occur</p>\n\n<p>6) Opening the workbook (in original state as posted) and writing \"=1+1\" in an random empty cell, and opening a second file (slsx) - error does not occur</p>\n\n<p>7) Opening the workbook (in original state as posted) and changing the dropdown-list once (calling the worksheet_change macro), and opening a second file (slsx) - error occur</p>\n\n<p>8) If I insert a blank value in the drop-downlist (workbook in original state as posted) and selecting the blank value, and opening a second file (slsx) - error does not occur</p>\n\n<p>9) Selecting a value in dropdown-list - error occur</p>\n\n<p>8) Removing the ExportToPDF- and conditionalFormatting-modules, and including proposed adjustment to Worksheet_change module (i.e. removing code from sheet1 and inserting it into module).</p>\n\n<ul>\n<li>8.1 just opening second file without making changes to xlsm, and having value in dropdown-list - error occur</li>\n<li>8.2 typing 1+1 in random empty cell - error occur</li>\n<li>8.3 changing dropdown-list once (to another value) - error occur</li>\n<li>8.4 changing dropdown-list to blank - error does not occur</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "edited": false, "score": 0, "creation_date": 1540995137, "post_id": 53084906, "comment_id": 93067581, "body": "Id forgotten about the COUNT and COUNTA functions,  that will make things a lot easier Thank you.  I replaced Private Sub Worksheet_Calculate()  With your submission but after saving, I dont get the email prompt. Did I do something wrong"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "edited": false, "score": 0, "creation_date": 1540997381, "post_id": 53084906, "comment_id": 93069088, "body": "What is the e-mail prompt please?"}, {"owner": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "edited": false, "score": 0, "creation_date": 1540998238, "post_id": 53084906, "comment_id": 93069694, "body": "I meant that the mail_with_outlook function doesnt call. I dont get any errors, but nothing happens."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "edited": false, "score": 1, "creation_date": 1540998325, "post_id": 53084906, "comment_id": 93069748, "body": "Do you need to allow time for it to complete? I can try later today to mock up something."}, {"owner": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "edited": false, "score": 0, "creation_date": 1540998671, "post_id": 53084906, "comment_id": 93069999, "body": "Id appreciate the assistance when you have the free time. I&#39;ll keep plugging away at it on my end."}, {"owner": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "edited": false, "score": 0, "creation_date": 1541014200, "post_id": 53084906, "comment_id": 93078279, "body": "Ok it works now. I think they problem was i was inputing the code into the worksheet, but it needed to be input into the workbook. Hope you see this before you spend too much time on it."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "edited": false, "score": 1, "creation_date": 1541014245, "post_id": 53084906, "comment_id": 93078304, "body": "It has to go in ThisWorkbook"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 5, "last_activity_date": 1540993932, "last_edit_date": 1592644375, "creation_date": 1540993606, "answer_id": 53084906, "question_id": 53084839, "link": "https://stackoverflow.com/questions/53084839/send-an-email-based-on-value-in-a-cell-only-when-workbook-is-saved/53084906#53084906", "title": "Send an email based on value in a cell only when workbook is saved", "body": "<p>I would put your logic in a <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.beforesave\" rel=\"noreferrer\">BeforeSave</a> event.</p>\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n   'your logic goes here\nEnd Sub\n</code></pre>\n<p>If you are only checking if there is now something in the range, whereas before it was completely empty, consider using the <code>COUNTA/COUNT</code> functions.</p>\n<p>Notes:</p>\n<blockquote>\n<p>Occurs before the workbook is saved.</p>\n<p>Syntax expression. BeforeSave( <em>SaveAsUI</em> , <em>Cancel</em> )</p>\n<p>expression A variable that represents a Workbook object.</p>\n<p>Parameters</p>\n<p>SaveAsUI: Required,           Boolean,    Description: True if the Save As dialog box will be\ndisplayed due to changes made that need to be saved in the workbook.</p>\n<p>Cancel:   Required,   Boolean,    Description: False when the event occurs. If the event\nprocedure sets this argument to True , the workbook isn't saved when\nthe procedure is finished.</p>\n</blockquote>\n"}], "owner": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 53084906, "answer_count": 1, "score": 3, "last_activity_date": 1586416585, "creation_date": 1540993370, "last_edit_date": 1586416585, "question_id": 53084839, "link": "https://stackoverflow.com/questions/53084839/send-an-email-based-on-value-in-a-cell-only-when-workbook-is-saved", "title": "Send an email based on value in a cell only when workbook is saved", "body": "<p>I have a cell B8 that checks to see if data has been entered in a range of cells for the day and outputs a number depending on the count. It checks for blank entries and obviously at the start of filling out the sheet all the cells for the day will be blank, I want it to only perform the check once the worksheet has been saved.</p>\n\n<p>The code I've managed to Frankenstein together prepares an email the instant the condition is met and I'm not sure how to change it to suit my needs.</p>\n\n<pre><code>Sub Mail_with_outlook()\nDim OutApp As Object\nDim OutMail As Object\nDim emlto As String, emlcc As String, emlbcc As String\nDim emlsub As String, emlbody As String\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nemlto = \"email@abc.def\"\nemlcc = \"\"\nemlbcc = \"\"\nemlsub = \"Raw Material Projection\"\nemlbody = \"Good Day\" &amp; vbNewLine &amp; vbNewLine &amp; _\n          \"There might be an issue with the data inputed in today's sheet\"\n\n\nWith OutMail\n    .To = emlto\n    .CC = emlcc\n    .BCC = emlbcc\n    .Subject = emlsub\n    .Body = emlbody\n    .Display    '  use .Send once tested\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\nEnd Sub\n\n\n\n\n\nPrivate Sub Worksheet_Calculate()\nDim FormulaRange As Range\nDim NotSentMsg As String\nDim MyMsg As String\nDim SentMsg As String\nDim MyLimit As Double\n\nNotSentMsg = \"Not Sent\"\nSentMsg = \"Sent\"\n\n'Above the MyLimit value it will run the macro\nMyLimit = 10\n\n'range with the Formula that I want to check\nSet FormulaRange = Me.Range(\"B8\")\n\nOn Error GoTo EndMacro:\nFor Each FormulaCell In FormulaRange.Cells\n    With FormulaCell\n        If IsNumeric(.Value) = False Then\n            MyMsg = \"Not numeric\"\n        Else\n            If .Value &gt; MyLimit Then\n                MyMsg = SentMsg\n                If .Offset(0, 1).Value = NotSentMsg Then\n                    Call Mail_with_outlook\n                End If\n            Else\n                MyMsg = NotSentMsg\n            End If\n        End If\n        Application.EnableEvents = False\n        .Offset(0, 1).Value = MyMsg\n        Application.EnableEvents = True\n    End With\nNext FormulaCell\n\nExitMacro:\nExit Sub\n\nEndMacro:\nApplication.EnableEvents = True\n\nMsgBox \"Some Error occurred.\" _\n     &amp; vbLf &amp; Err.Number _\n     &amp; vbLf &amp; Err.Description\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "excel", "vba", "macos", "listobject"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10781293, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217711829128816/picture?type=large", "display_name": "Jim Gordon", "link": "https://stackoverflow.com/users/10781293/jim-gordon"}, "is_accepted": false, "score": 0, "last_activity_date": 1544634844, "last_edit_date": 1544634844, "creation_date": 1544626586, "answer_id": 53745734, "question_id": 53084611, "link": "https://stackoverflow.com/questions/53084611/excel-mac-2016-listobject-not-working-when-called-inside-a-vba-function/53745734#53745734", "title": "Excel Mac 2016, ListObject not working when called inside a VBA Function", "body": "<p>When I bring records into an Excel table I use <em><code>Connections</code></em></p>\n\n<p>Here's an example:</p>\n\n<pre><code>    'Query the database\n\n    Sheets(\"FullRecordFromSS\").Select\n   ActiveSheet.Unprotect\n    DoEvents\n    Range(\"Table_ExternalData_1[ID]\").Select\n    Let stSQL1 = \"SELECT * FROM libInfo.dbo.tblMain where LibUserID = \" &amp; \"'\" &amp; SelectedLibUserID &amp; \"'\" &amp; \";\"\n    Range(\"A2\").Select\n\n   With ActiveWorkbook.Connections(\"GetRecordToUpdate\").ODBCConnection\n       .BackgroundQuery = True\n       .CommandText = stSQL1\n       .CommandType = xlCmdSql\n        .Connection = _\n        \"ODBC;DRIVER=SQL Server;SERVER=db1d.acsu.buffalo.edu,14360;UID=libinfo;PWD=inf014lib;APP=Microsoft Office 2016;WSID=LIBJBG6281\"\n        .RefreshOnFileOpen = False\n       .SavePassword = True\n       .SourceConnectionFile = \"\"\n        .SourceDataFile = \"\"\n        .ServerCredentialsMethod = xlCredentialsMethodIntegrated\n        .AlwaysUseConnectionFile = False\n\n    End With\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 10529173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b98ea6c41fc69698428033e6ef7e163?s=128&d=identicon&r=PG&f=1", "display_name": "M Garcia", "link": "https://stackoverflow.com/users/10529173/m-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544634844, "creation_date": 1540992757, "last_edit_date": 1540993637, "question_id": 53084611, "link": "https://stackoverflow.com/questions/53084611/excel-mac-2016-listobject-not-working-when-called-inside-a-vba-function", "title": "Excel Mac 2016, ListObject not working when called inside a VBA Function", "body": "<p>I am calling data from an external database into a ListObject table. The script creates the ListObject table without problems when run inside a Sub(), but the script just stops in the ListObject line when called inside a Function, it reports <code>Application-defined or object-defined error</code>. Script below:</p>\n\n<pre><code>Function get_value(input_id As String, input_date As String)\n\nOn Error GoTo xerr\n\nDim sqlstring As String\nDim connstring As String\nDim sLogin As String\n\nsLogin = \"DATABASE=DB;UID=UID;PWD=PWD\"\nsqlstring = \"SELECT data_date, data_value FROM tb_data_values WHERE series_id='\" &amp; input_id &amp; \"' AND data_date&lt;='\" &amp; input_date &amp; _\n                \"' ORDER BY data_date DESC\"\nconnstring = \"ODBC;DSN=myodbc;\" &amp; sLogin\n\nDim qtTable As QueryTable\n\nSet qtTable = Worksheets(\"hs\").ListObjects.Add(SourceType:=xlSrcExternal, Source:=connstring, Destination:=Worksheets(\"hs\").Range(\"A1\")).QueryTable\n\nWith qtTable\n\n    .ListObject.ShowHeaders = False\n    .ListObject.ShowTableStyleRowStripes = False\n    .ListObject.ShowTableStyleColumnStripes = False\n    .ListObject.ShowTableStyleFirstColumn = False\n    .CommandText = sqlstring\n    .CommandType = xlCmdSql\n    .RefreshStyle = xlOverwriteCells\n    .BackgroundQuery = False\n    .Refresh\n\nEnd With\n\nget_value=Worksheets(\"hs\").ListObjects(1).Cells(1,2)\n\nExit Function\n\nxerr:\n\nDebug.Print err.Description\n\nEnd Function\n</code></pre>\n"}, {"tags": ["regex", "vba"], "answers": [{"tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1540992662, "creation_date": 1540992662, "answer_id": 53084576, "question_id": 53084524, "link": "https://stackoverflow.com/questions/53084524/regex-split-filename-vba/53084576#53084576", "title": "regex split filename vba", "body": "<p>You may use</p>\n\n<pre><code>^(.*\\\\)(.*?)(?:\\s*(\\[.*\\]))?\\.([a-zA-Z]*)$\n            ^^^           ^^ \n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/haHFug/2\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>^</code> - start of string</li>\n<li><code>(.*\\\\)</code> - Group 1: any 0+ chars other than linebreak chars, as many as possible</li>\n<li><code>(.*?)</code> - Group 2: any 0+ chars other than linebreak chars, as few as possible</li>\n<li><code>(?:\\s*(\\[.*\\]))?</code> - an optional group that matches\n\n<ul>\n<li><code>\\s*</code> - 0+ whitespaces</li>\n<li><code>(\\[.*\\])</code> - Group 3: a <code>[</code>, any 0+ chars other than linebreak chars, as many as possible and a <code>]</code></li>\n</ul></li>\n<li><code>\\.</code> - a <code>.</code></li>\n<li><code>([a-zA-Z]*)</code> - Group 4: 0+ letters (or, just use <code>[^.]*</code> to match any chars other than <code>.</code>)</li>\n<li><code>$</code> - end of string.</li>\n</ul>\n"}], "owner": {"reputation": 57, "user_id": 3378377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4742f2dd662f88d3642b67a6e6890880?s=128&d=identicon&r=PG&f=1", "display_name": "eugene251", "link": "https://stackoverflow.com/users/3378377/eugene251"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 53084576, "answer_count": 1, "score": 1, "last_activity_date": 1540992662, "creation_date": 1540992509, "question_id": 53084524, "link": "https://stackoverflow.com/questions/53084524/regex-split-filename-vba", "title": "regex split filename vba", "body": "<p>i have several files which have two types of filenames</p>\n\n<ol>\n<li>\"c:\\path\\filename [some text].pdf\" or</li>\n<li>\"c:\\path\\filename.pdf\"</li>\n</ol>\n\n<p>i want to split the files as follows:</p>\n\n<ul>\n<li>Group 1: c:\\path\\ </li>\n<li>Group 2: filename </li>\n<li>Group 3: [123] (or empty) </li>\n<li>Group 4: pdf</li>\n</ul>\n\n<p>this regex-pattern works for file-type 2 (without brackets) but not for filetype 1.:</p>\n\n<pre><code>^(.*\\\\)(.*)s*?(\\[.*\\]).*?([a-z]*)$\n</code></pre>\n\n<p>why doesnt it work for filetype 2? what pattern can i use, that matches both filename-types?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 5, "creation_date": 1540992618, "post_id": 53084247, "comment_id": 93065827, "body": "Macro recorder should give you a good start :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540992919, "post_id": 53084247, "comment_id": 93066047, "body": "Sounds like a possible job for powerquery. Set it up to load from a folder. Put your source files in that folder."}], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1540993035, "creation_date": 1540993035, "answer_id": 53084729, "question_id": 53084247, "link": "https://stackoverflow.com/questions/53084247/importing-data-from-csv-to-excel/53084729#53084729", "title": "Importing data from csv to excel", "body": "<p>You can use Application.getopenfilename to select the desired file to open.\nAs mentioned in one of the comments, using the macro recorder to get the code to manipulate the data is a good start and you can add it to this code.</p>\n\n<pre><code>Sub Button1_Click()\n    Dim s, wb As Workbook\n    s = Application.GetOpenFilename(\"CSV Files (*.csv),*.csv\", , \"Please select CSV file...\")\n    If s &lt;&gt; False Then\n        Set wb = Workbooks.Open(s)\n        MsgBox \"Code to Do something here\"\n        wb.Close False\n    Else: MsgBox \"Nothing Selected\"\n    End If\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 10514507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6af159ceddbd528c95d22ff39a0b013?s=128&d=identicon&r=PG&f=1", "display_name": "David R", "link": "https://stackoverflow.com/users/10514507/david-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1540993515, "creation_date": 1540993515, "answer_id": 53084880, "question_id": 53084247, "link": "https://stackoverflow.com/questions/53084247/importing-data-from-csv-to-excel/53084880#53084880", "title": "Importing data from csv to excel", "body": "<p>This is some code I used some time ago.</p>\n\n<p><code>Dirlocal</code> is the path of the <code>.csv</code> file</p>\n\n<p>I would have the data imported in a Worksheet named \"ODK\"</p>\n\n<pre><code>Dim ws As Worksheet\nDim strText As String\n\n ' read utf-8 file to strText variable\n With CreateObject(\"ADODB.Stream\")\n    .Open\n    .Type = 1  ' Private Const adTypeBinary = 1\n    .LoadFromFile DirLocal\n    .Type = 2  ' Private Const adTypeText = 2\n    .Charset = \"utf-8\"\n    strText = .ReadText(-1)  ' Private Const adReadAll = -1\nEnd With\n' parse strText data to a sheet\nSet ws = Worksheets(\"ODK\")\nintRow = 1\nApplication.DisplayAlerts = False\nFor Each strLine In Split(strText, Chr(10))\n    If strLine &lt;&gt; \"\" Then\n        With ws\n            .Cells(intRow, 1) = strLine\n            .Cells(intRow, 1).TextToColumns Destination:=Cells(intRow, 1), DataType:=xlDelimited, _\n                TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n                Semicolon:=False, Comma:=True, Space:=False, Other:=False\n        End With\n\n        intRow = intRow + 1\n    End If\nNext strLine\nApplication.DisplayAlerts = True\nReadUTF8CSVToSheet = ws.Name\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10586027, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NZIT1DjX95w/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCGDrMZLVefNE4zTzKvE5hZUBc-GA/mo/photo.jpg?sz=128", "display_name": "Nilesh Desle", "link": "https://stackoverflow.com/users/10586027/nilesh-desle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1586416621, "creation_date": 1540991686, "last_edit_date": 1586416621, "question_id": 53084247, "link": "https://stackoverflow.com/questions/53084247/importing-data-from-csv-to-excel", "title": "Importing data from csv to excel", "body": "<p>I have a repetitive process which includes importing data from different csv files to excel</p>\n\n<p>Current process\nImport data manually from data > from text > select the required file > select delimited and my data has headers > select delimiter comma > next > finish > New worksheet</p>\n\n<p>Is there a way to make a vba script/macro which will prompt the user what file they want to import and slect the options which I have selected</p>\n\n<p>Thanks and regards</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2013"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1540993091, "post_id": 53083776, "comment_id": 93066177, "body": "<code>.visible</code> maybe?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540993445, "post_id": 53083776, "comment_id": 93066423, "body": "Since you got the bubble to appear with <code>Me.recentalert.visible = True</code>, have you tried <code>Me.recentalert.visible = False</code> to hide it?"}, {"owner": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "edited": false, "score": 0, "creation_date": 1540996856, "post_id": 53083776, "comment_id": 93068722, "body": "My OnClick event above should make the picture invisible if visible = true but it is not working for some reason."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3728595"}, "edited": false, "score": 0, "creation_date": 1541001649, "post_id": 53083776, "comment_id": 93072060, "body": "Are you sure that your <code>Recent_Click()</code> code is firing? You could add a notification like <code>MsgBox &quot;Firing&quot;</code> into the sub to check this."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1541001797, "post_id": 53083776, "comment_id": 93072151, "body": "You have no handling for <code>.visible=false</code> once it&#39;s dissapeared.  Try just <code>Me.recentalert.Visible = not Me.recentalert.Visible</code>"}, {"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 0, "creation_date": 1541005268, "post_id": 53083776, "comment_id": 93074114, "body": ".visible=false doesn&#39;t unload the control, you don&#39;t need a special handler for it. Plus this code will make the picture visible again after clicking on the tab, which is not what he is asking for."}, {"owner": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "edited": false, "score": 0, "creation_date": 1541006359, "post_id": 53083776, "comment_id": 93074646, "body": "Nathan, Jeffery is correct the <code>= not.me</code> control just toggles visibility. Once I click the button I want the image to disappear unless the form is reloaded and a new event meets the 24 hour criteria. @user3728595 you might be on to something, after checking to see if the <code>Recent_Click()</code> event worked with an error message nothing happened. Any idea why my <code>OnClick</code> is not firing?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "edited": false, "score": 0, "creation_date": 1540996647, "post_id": 53085567, "comment_id": 93068577, "body": "I&#39;m sorry this was a retype error on my part. My code is recentalert.visible. I also noticed I typed a curly bracket in the code above on accident. It is a square bracket in my code."}, {"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "reply_to_user": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "edited": false, "score": 0, "creation_date": 1540997300, "post_id": 53085567, "comment_id": 93069025, "body": "In your form design screen, on the Event tab of the Recent control, make sure your On Click event says [Event Procedure]"}, {"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "reply_to_user": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "edited": false, "score": 0, "creation_date": 1540997694, "post_id": 53085567, "comment_id": 93069330, "body": "Is the Picture and the tab on the same form or is one in a subform and the other on the main form or another subform?"}, {"owner": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "edited": false, "score": 0, "creation_date": 1540999160, "post_id": 53085567, "comment_id": 93070349, "body": "The On Click event says [Event Procedure]. The &quot;Activity Feed&quot; is a tabbed subform embedded on the main &quot;Navigation Form&quot; homepage. The &quot;recentalert&quot; picture is on the &quot;Recent&quot; tab of the &quot;Activity Feed&quot; subform. On the &quot;Recent&quot; tab there is another continous subform &quot;RAevents_frm&quot; where the &quot;today_date&quot; field is located. If any of that makes sense."}, {"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "reply_to_user": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "edited": false, "score": 0, "creation_date": 1541005036, "post_id": 53085567, "comment_id": 93073991, "body": "Yeah, that makes sense. Are you using Option Explicit? If not add it to the top of every form module you have and run Debug &gt; Compile. I&#39;m not seeing why this won&#39;t work, so short of you having something spelled incorrectly, I&#39;m at a loss."}, {"owner": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "edited": false, "score": 0, "creation_date": 1541007640, "post_id": 53085567, "comment_id": 93075337, "body": "I was not, however, I just added it and complied with no errors. After what a user said above it seems my problem is that the OnClick Event is not firing for some reason."}, {"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "reply_to_user": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "edited": false, "score": 0, "creation_date": 1541008532, "post_id": 53085567, "comment_id": 93075762, "body": "I changed my answer above, see if that helps."}, {"owner": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "edited": false, "score": 0, "creation_date": 1541010174, "post_id": 53085567, "comment_id": 93076553, "body": "That is what I did originally to build the event which leads me to believe that &quot;Recent&quot; is the appropriate control. I don&#39;t know if there is something in access where a tab on tabbed form can&#39;t also by a cmd button, but I tried an OnClick with a different button with no luck."}, {"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "reply_to_user": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "edited": false, "score": 0, "creation_date": 1541030810, "post_id": 53085567, "comment_id": 93083819, "body": "I don&#39;t know why this isn&#39;t working, I just created a tab control on a form, inserted that form into another form, opened the main form and clicked on the tab and it ran the code just fine."}, {"owner": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "edited": false, "score": 0, "creation_date": 1541098441, "post_id": 53085567, "comment_id": 93110515, "body": "I&#39;m not sure either. I&#39;ll try a few new things and post back if I figure it out. Thanks for the help."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3728595"}, "edited": false, "score": 0, "creation_date": 1541136582, "post_id": 53085567, "comment_id": 93121004, "body": "I think (based on my tests in Access 2013) that the <code>Recent</code> control refers to the page which is revealed, not the tab itself. If the tab control which contains this page is called <code>TabControl1</code> try putting your code into the procedure <code>TabControl1_Change()</code>."}, {"owner": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "edited": false, "score": 0, "creation_date": 1541248159, "post_id": 53085567, "comment_id": 93156186, "body": "I just figured out the tabindex numbers myself so I do believe you are correct. I need to do an OnChange and reference the tabindex=0 instead of &quot;Recent&quot;. I am dealing with some database corruption issues now so I have to put this on hold but that should be promising."}], "tags": [], "owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "is_accepted": false, "score": 0, "last_activity_date": 1541008286, "last_edit_date": 1541008286, "creation_date": 1540995625, "answer_id": 53085567, "question_id": 53083776, "link": "https://stackoverflow.com/questions/53083776/creating-a-notification-bubble-in-ms-access/53085567#53085567", "title": "Creating a &quot;Notification Bubble&quot; in MS Access", "body": "<p>Try right clicking the control where you want the On Click event to fire and click on Build Event. This should take you to the Recent_Click sub in your module, if not, your control isn't properly linked and I would suggest deleting the sub in your module, using the right click method above, click on Code Builder, then retyping in your code.</p>\n"}], "owner": {"reputation": 1, "user_id": 10585878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee91970bda14ccf230a28492fa1182f?s=128&d=identicon&r=PG&f=1", "display_name": "Adam M", "link": "https://stackoverflow.com/users/10585878/adam-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541008286, "creation_date": 1540990252, "last_edit_date": 1540996687, "question_id": 53083776, "link": "https://stackoverflow.com/questions/53083776/creating-a-notification-bubble-in-ms-access", "title": "Creating a &quot;Notification Bubble&quot; in MS Access", "body": "<p>I have been working on this for a while now and cannot seem to figure it out. I have a home page in Microsoft Access with numerous embed subforms. One of these subforms is a recent activity feed similar to what you might see on most social media platforms. It is a tabbed subfrom with a \"Recent Events\" and a \"Notes\" section. I am trying to have a \"Notification Bubble\" appear when an item in that subform has been added in the last 24 hours, and THEN disappear when the user clicks on the corresponding tab.</p>\n\n<p>The \"Notification Bubble\" is a picture called \"recentalert\". Currently, the bubble only appears when the 24 hour criteria is met but I cannot get it to disappear once the corresponding tab is clicked. I have tried numerous formats and different events with no luck. My code is below. Please help!</p>\n\n<pre><code>    Private Sub Recent_Click()\n        If Me.recentalert.Visible = True Then\n            Me.recentalert.Visible = False\n        End If\n    End Sub\n\n    Private Sub Form_Load\n        If [Forms]![Navigation Form]![NavigationSub]![Activity Feed]![RAevents_frm].[Form].[today_date] &gt;= Date -1 Then\n            Me.recentalert.visible = True\n        End If\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1540991895, "post_id": 53083723, "comment_id": 93065291, "body": "Note that you used these smart quotes <code>\u201c \u201d</code> but VBA only accepts the simple quotes <code>&quot; &quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540991017, "post_id": 53083982, "comment_id": 93064614, "body": "<code>Left</code> or <code>Right</code> will not error if you pass them <code>Empty</code>. It gets implicitly cast to <code>vbNullString</code>. You can verify this in the immediate window:  <code>?Left(Empty, 42)</code>"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540991373, "post_id": 53083982, "comment_id": 93064894, "body": "@Comintern for some reason sometimes i receive an error on this.could you please more info to investigate?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540991637, "post_id": 53083982, "comment_id": 93065094, "body": "Are you sure the cell is empty when you get your errors? It can fail if a cell contains an <i>error</i>, but <code>IsEmpty</code> isn&#39;t the appropriate test for that. As demonstrated above, an empty cell will always get coerced."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540991909, "post_id": 53083982, "comment_id": 93065299, "body": "You are absolutely right!I check cell value and it was not empty but was look like empty (no visible characters but a special character was in).The data was scraped from website!i fix my code when scrap value to trim and clean!that was very helpful!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1540992522, "post_id": 53083982, "comment_id": 93065753, "body": "Are you sure that this: <i>&quot;You may need to use Left or Right function and you dont check cell value.If cell is empty you will receive an error.&quot;</i> is correct? Because <code>Debug.Print Left(&quot;&quot;, 100)</code> doesn&#39;t throw an error at all."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1540992628, "post_id": 53083982, "comment_id": 93065837, "body": "@P\u1d07\u029c i was doing and mistake with my own coding and Comintern help me to find and understand where was my error.You can see our discussion above!"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 2, "last_activity_date": 1540992973, "last_edit_date": 1540992973, "creation_date": 1540990861, "answer_id": 53083982, "question_id": 53083723, "link": "https://stackoverflow.com/questions/53083723/questions-triggered-by-a-macro-that-trims-spaces/53083982#53083982", "title": "Questions triggered by a macro that trims spaces", "body": "<p>In my opinion i think is better to declare a range to avoid repetition and to be more clear especial if you have a long code.In your occasion you use a loop to test every \"MyCell\" (address to one part (range)) of the whole \"MyRange\" (which is also a range).</p>\n\n<p>Second, by checking cell value will help to save time by prevent executing the code after if condition does not meet. </p>\n\n<p>Lastly, Trim &amp; Clean function will help you to \"Clean\" cell value from invisible character, unnecessary spaces etc.</p>\n"}, {"comments": [{"owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "edited": false, "score": 0, "creation_date": 1540993137, "post_id": 53084475, "comment_id": 93066211, "body": "Thanks for this answer! To really crystallize this in my mind, can you show me what the loop code would be if I didn&#39;t declare the range variables?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "edited": false, "score": 1, "creation_date": 1540993445, "post_id": 53084475, "comment_id": 93066424, "body": "You would have to use <code>Selection</code> directly in <code>For Each MyCell in Selection</code> that&#39;s all. This code is no good example to illustrate the good practice of declaring variables. But anyway all you need to remember is: Avoid using <code>.Select</code> and use <code>Option Explicit</code> to force variable declaration. \u2022 Not declaring variables to the correct type <i>can</i> cause errors and make your code inefficient (because VBA automatically assumes <code>Variant</code> which is the most inefficient type)."}, {"owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "edited": false, "score": 0, "creation_date": 1540995353, "post_id": 53084475, "comment_id": 93067735, "body": "What about MyCell? What can that be replaced with if it wasn&#39;t declared as a range variable? I&#39;m just trying to figure out what is absolutely necessary to declare vs what isn&#39;t. Thanks so much!!!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "edited": false, "score": 0, "creation_date": 1540995803, "post_id": 53084475, "comment_id": 93068044, "body": "@GeekyFreaky if you remove <code>Dim MyCell As Range</code> and write nothing instead, Excel will automatically assume it as <code>Variant</code>. Means it is the same as it was declared <code>Dim MyCell As Variant</code>. \u2022 An additional advantage of declaring it as <code>Range</code> is that you can use IntelliSense in the VB Editor (if you start writing <code>MyCell.</code> Excel pops up a list of available properties and methods of a range object) which is not available for <code>Variant</code>."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 3, "last_activity_date": 1540992340, "creation_date": 1540992340, "answer_id": 53084475, "question_id": 53083723, "link": "https://stackoverflow.com/questions/53083723/questions-triggered-by-a-macro-that-trims-spaces/53084475#53084475", "title": "Questions triggered by a macro that trims spaces", "body": "<p>First:<br>\nIt is a very good practice to use <code>Option Explicit</code> and declare all variables. Also declaring ranges and worksheets etc. is a good technique to avoid using <code>.Select</code> or <code>.Activate</code>. <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n\n<p>Second:<br>\n<code>MyCell = Trim(MyCell)</code> will cause a write action (takes time) to that cell even if it was empty. Checking if it was empty could avoid an unnecessary write action, and therefore could make it a little bit more efficient.</p>\n"}], "owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 53084475, "answer_count": 2, "score": 0, "last_activity_date": 1586416657, "creation_date": 1540990115, "last_edit_date": 1586416657, "question_id": 53083723, "link": "https://stackoverflow.com/questions/53083723/questions-triggered-by-a-macro-that-trims-spaces", "title": "Questions triggered by a macro that trims spaces", "body": "<p>Found this macro online and while studying it, I came up with two questions that I haven't been able to find an answer for:</p>\n\n<p>First, is it necessary to declare the object variables MyRange and MyCell?\nWhat advantage(s) does this provide by doing it? </p>\n\n<p>Second, based on a previous question I posted, is it redundant to check whether the cell is empty or not before its value is trimmed. What is the advantage of this check? Is it merely to save compiling effort/time? Or are there other technical reasons?</p>\n\n<pre><code>Sub TrimSpaces()\nDim MyRange As Range\nDim MyCell As Range\nSelect Case MsgBox(\u201cWorkbook First?\u201d, vbYesNoCancel)\n    Case Is = vbYes\n    ThisWorkbook.Save\n    Case Is = vbCancel\n    Exit Sub\nEnd Select\nSet MyRange = Selection\nFor Each MyCell in MyRange\n    If Not IsEmpty(MyCell) Then\n        MyCell = Trim(MyCell)\n    End If\nNext MyCell\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel-2010"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 4, "creation_date": 1540989715, "post_id": 53083478, "comment_id": 93063782, "body": "That&#39;s a bit hard to follow without any punctuation, but a <code>Date</code> in VBA is simply a &quot;decorated&quot; <code>Double</code>. I&#39;m guessing? you&#39;re just looking for <code>CDate(t)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": true, "score": 1, "last_activity_date": 1540990073, "creation_date": 1540990073, "answer_id": 53083709, "question_id": 53083478, "link": "https://stackoverflow.com/questions/53083478/vba-double-to-time/53083709#53083709", "title": "VBA Double to Time", "body": "<p>The following will convert the <code>Double</code> into the <code>Date</code> Format. In order to only show the time portion of the date format, use the <code>Format</code> function:</p>\n\n<pre><code>Sub trythis()\nDim t As Double\nt = Now()\nDebug.Print CDate(t)\nDebug.Print Format(t, \"hh:mm:ss\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3325, "favorite_count": 0, "accepted_answer_id": 53083709, "answer_count": 1, "score": 1, "last_activity_date": 1540990073, "creation_date": 1540989371, "question_id": 53083478, "link": "https://stackoverflow.com/questions/53083478/vba-double-to-time", "title": "VBA Double to Time", "body": "<p>I have a VBA user form which when I press save after input data it writes to a spread sheet and set my time and date to Now() that is being written to a spread sheet where I  split the now() value into time and date, when I read it back I get the date but my time in decimal format I would like to convert that decimal number back to  time what is the formula for that thank you in advance my decimal number is something like '0.12425576899' so far I found this but it converts that to '00:the minutes on the double:00' here is the code </p>\n\n<pre><code>Public Function FromDecimalTime(ByVal t As Double) As Date\nFromDecimalTime = TimeSerial(0, Fix(t), (t - Fix(t)) * 60)\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "xml", "vba", "ribbon"], "comments": [{"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1540993577, "post_id": 53083428, "comment_id": 93066518, "body": "If you are okay with hard-coding the choices in the ribbon dropdown control, you can always used the passed index argument of the callback to get the index of the selection. So in your case - index=0 means they have selected navy, ect."}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1541421064, "post_id": 53083428, "comment_id": 93199219, "body": "You need to save the selected value in a callback similar to the <code>sectionsmacro</code> callback in @jkpieterse s example and then use the saved value in <code>tablecolour</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 0, "last_activity_date": 1540992167, "creation_date": 1540992167, "answer_id": 53084418, "question_id": 53083428, "link": "https://stackoverflow.com/questions/53083428/set-variable-based-on-ribbon-drop-down/53084418#53084418", "title": "Set variable based on ribbon drop-down", "body": "<p>Simple. Add this to a module in your Excel file:</p>\n\n<pre><code>'Callback for sections onAction\nSub sectionsmacro(control As IRibbonControl, id As String, index As Integer)\n    MsgBox index\nEnd Sub\n</code></pre>\n\n<p>As you'll notice you'll get the index of the item which was selected (starting at zero)</p>\n"}], "owner": {"reputation": 1, "user_id": 10585835, "user_type": "registered", "profile_image": "https://graph.facebook.com/2140902222628948/picture?type=large", "display_name": "Kama", "link": "https://stackoverflow.com/users/10585835/kama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1541415600, "creation_date": 1540989199, "last_edit_date": 1541415600, "question_id": 53083428, "link": "https://stackoverflow.com/questions/53083428/set-variable-based-on-ribbon-drop-down", "title": "Set variable based on ribbon drop-down", "body": "<p>I created customized ribbon, with a drop down, XML:</p>\n\n<pre><code>&lt;dropDown id=\"sections\" onAction=\"sectionsmacro\" &gt;\n&lt;item id=\"section1\" image=\"section1\" label=\"navy\" /&gt;\n&lt;item id=\"section2\" image=\"section2\" label=\"sapphire\" /&gt;\n&lt;item id=\"section3\" image=\"section3\" label=\"purple\" /&gt;\n&lt;item id=\"section4\" image=\"section4\" label=\"emerald\" /&gt; \n&lt;item id=\"section5\" image=\"section5\" label=\"cyan\" /&gt;\n&lt;/dropDown&gt;\n</code></pre>\n\n<p>I would like to set a macro, which will be working on \"if then\" cases, dependently what is selected on a drop-down. </p>\n\n<p>So, I have a macro which color everything in black, but if purple is chosen, my macro makes everything in purple. How can I make a reference to the ribbon drop-down on a macro level? thanks for your help!</p>\n\n<hr>\n\n<p>Thanks, although it is not exactly what I meant... Let's say I have chosen 'navy' on my drop-down and that is all. It has index 0. The next step is to use that variable in the other macro. So I would have something like this:</p>\n\n<pre><code>Sub tablecolour()\n\n'if value on drop down = 0 ('navy') then \nelse end if\n\nend sub\n</code></pre>\n\n<p>So based on the value chosen on the drop-down I would like to run another macro in a certain way. I don't know how to use to value from drop-down to be read as variable in a separate macro.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1540990129, "post_id": 53082995, "comment_id": 93064016, "body": "Change it at design time or run time?"}, {"owner": {"reputation": 501, "user_id": 1433835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YWgaT.jpg?s=128&g=1", "display_name": "wlfbck", "link": "https://stackoverflow.com/users/1433835/wlfbck"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1540991438, "post_id": 53082995, "comment_id": 93064948, "body": "At design time."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 1, "creation_date": 1540998987, "post_id": 53082995, "comment_id": 93070230, "body": "As you&#39;ve discovered, there is no Change To right click menu item like there is in Access. They use different forms engines. Not that that&#39;s an excuse to be missing useful features."}], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1540989521, "post_id": 53083287, "comment_id": 93063673, "body": "Yeah, you can&#39;t <i>change</i> the component type. You can only delete the original and replace it with a new one."}, {"owner": {"reputation": 501, "user_id": 1433835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YWgaT.jpg?s=128&g=1", "display_name": "wlfbck", "link": "https://stackoverflow.com/users/1433835/wlfbck"}, "edited": false, "score": 0, "creation_date": 1540991345, "post_id": 53083287, "comment_id": 93064873, "body": "The reason i want to do it because it just no longer used as ComboBox, but what is in it is still being used in the table itself. (The users just entered something freeform). So i just wanted to change it to accomodate.  There is also some code which uses its name to read it out and put in the right place. Thats why i wanted to change and not delete and replace, but i guess there is no other way."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 501, "user_id": 1433835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YWgaT.jpg?s=128&g=1", "display_name": "wlfbck", "link": "https://stackoverflow.com/users/1433835/wlfbck"}, "edited": false, "score": 1, "creation_date": 1540992532, "post_id": 53083287, "comment_id": 93065763, "body": "You can delete it, @wlfbck, replace it with a new component and give the new component the old component&#39;s name. Then your existing code will still work, though there are properties and methods of a combo box that aren&#39;t applicable to a text box &amp; vice versa. Of course if it&#39;s named <code>cboBox1</code>, that&#39;ll be weird when referencing a text box, but that&#39;s just a reason to give good names to things... <a href=\"http://www.rubberduckvba.com/\" rel=\"nofollow noreferrer\">Rubberduck</a> will help with the renaming. *<i>User and minor contributor to the OSS project.</i>"}, {"owner": {"reputation": 501, "user_id": 1433835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YWgaT.jpg?s=128&g=1", "display_name": "wlfbck", "link": "https://stackoverflow.com/users/1433835/wlfbck"}, "edited": false, "score": 0, "creation_date": 1540993907, "post_id": 53083287, "comment_id": 93066745, "body": "Thanks for the link to Rubberduck and the suggestion, just seems weird to me this doesn&#39;t exist since Access apparently has a &quot;change to&quot; option when in design mode for forms."}], "tags": [], "owner": {"reputation": 39, "user_id": 5512430, "user_type": "registered", "profile_image": "https://graph.facebook.com/963707623691012/picture?type=large", "display_name": "wstark", "link": "https://stackoverflow.com/users/5512430/wstark"}, "is_accepted": false, "score": 1, "last_activity_date": 1540988699, "creation_date": 1540988699, "answer_id": 53083287, "question_id": 53082995, "link": "https://stackoverflow.com/questions/53082995/changing-a-combobox-to-a-textbox-inside-a-userform/53083287#53083287", "title": "Changing A ComboBox to a TextBox inside a UserForm", "body": "<p>Why would you do it?</p>\n\n<p>I don't think you can change type of components. You could place textbox in the same place as combobox and hide/unhide them (change Visible property to true or false) separately.</p>\n"}], "owner": {"reputation": 501, "user_id": 1433835, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YWgaT.jpg?s=128&g=1", "display_name": "wlfbck", "link": "https://stackoverflow.com/users/1433835/wlfbck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1540988699, "creation_date": 1540987699, "last_edit_date": 1540988085, "question_id": 53082995, "link": "https://stackoverflow.com/questions/53082995/changing-a-combobox-to-a-textbox-inside-a-userform", "title": "Changing A ComboBox to a TextBox inside a UserForm", "body": "<p>Question in title. Seems like something which should be really simple, but i just cannot find it. I am in Design Mode. See picture below, but it's nothing out of the ordinary, really. Really grateful for any suggestions.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0lnYs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0lnYs.png\" alt=\"enter image description here\"></a></p>\n\n<p>In case it matters: This is Excel 2010.</p>\n"}, {"tags": ["vba", "ms-word", "word-style"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10574770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Itsql--OmbU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbC8Ngs0dS51nESyFFqOoS0eAaH0MA/mo/photo.jpg?sz=128", "display_name": "Luca", "link": "https://stackoverflow.com/users/10574770/luca"}, "edited": false, "score": 0, "creation_date": 1540990081, "post_id": 53083119, "comment_id": 93063990, "body": "Thank you, i tried writing it like this :  .Text = &quot;^13ID*ASD_PC_AWP_([0-9]@)([0-9]@)([0-9]@)^13&quot;   .Replacement.Text = &quot;[AWP_\\1\\2\\3]&quot;   .Style = &quot;Heading 2&quot; But nothing happens, maybe i got it wrong. And i set Wildcards = True and also Format..."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 39, "user_id": 10574770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Itsql--OmbU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbC8Ngs0dS51nESyFFqOoS0eAaH0MA/mo/photo.jpg?sz=128", "display_name": "Luca", "link": "https://stackoverflow.com/users/10574770/luca"}, "edited": false, "score": 0, "creation_date": 1540990869, "post_id": 53083119, "comment_id": 93064518, "body": "That&#39;s because your question doesn&#39;t reflect what you are actually trying to do. Just like the previous question I helped you with.  Please update your question to reflect the actual text to search for and the desired result you want.  Please don&#39;t add any spurious []."}, {"owner": {"reputation": 39, "user_id": 10574770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Itsql--OmbU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbC8Ngs0dS51nESyFFqOoS0eAaH0MA/mo/photo.jpg?sz=128", "display_name": "Luca", "link": "https://stackoverflow.com/users/10574770/luca"}, "edited": false, "score": 0, "creation_date": 1540991867, "post_id": 53083119, "comment_id": 93065259, "body": "I edited the main question, hope it&#39;s better now :)."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 39, "user_id": 10574770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Itsql--OmbU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbC8Ngs0dS51nESyFFqOoS0eAaH0MA/mo/photo.jpg?sz=128", "display_name": "Luca", "link": "https://stackoverflow.com/users/10574770/luca"}, "edited": false, "score": 0, "creation_date": 1540998298, "post_id": 53083119, "comment_id": 93069733, "body": "A very poor update as folks don&#39;t know what is changing unless they follow the links to the images.  Your search text should be &#39; (^13)(ID:)(*)(AWP_)([0-9]{1,})&#39; and your replace text should be &#39; \\4\\5&#39;.  Note that the \\ n in the replace field will not work if you don&#39;t specify fields in the search string.  The fields are enclosed in ().  You might also need to include a .font.bold=false in your replacement logic."}, {"owner": {"reputation": 39, "user_id": 10574770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Itsql--OmbU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbC8Ngs0dS51nESyFFqOoS0eAaH0MA/mo/photo.jpg?sz=128", "display_name": "Luca", "link": "https://stackoverflow.com/users/10574770/luca"}, "edited": false, "score": 0, "creation_date": 1541000472, "post_id": 53083119, "comment_id": 93071280, "body": "Well maybe because i don&#39;t know very well how to write in down, that&#39;s why put the images there, sorry about that. I am just trying to understand vba and the logic behind all of this, in just 2-3 days and tried to explain how i could. Thanks, i will try to attach ur code and see what i receive."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1541023426, "post_id": 53083119, "comment_id": 93081881, "body": "@Freeflow The question before the edits is clear enough. What the &#39;actual text&#39; might be is irrelevant."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1541026557, "post_id": 53083119, "comment_id": 93082794, "body": "We might be out of sync with the OPs edits as I don&#39;t recall the question looking like it does now when I made my comments.  Apologies to all if I came across a bit blunt.  I worked out that the OP wants to change e.g. &#39;1.1 Heading Level 2 &lt;crlf&gt;ID:&lt;?&gt;ASD_PC_AWP_XXXX&lt;crlf&gt;&#39;  to &#39;1.1 Heading Level 2 [AWP_XXXX]&lt;crlf&gt;&#39; wqhile retaining the style applied to 1.1 Heading Level 2."}, {"owner": {"reputation": 39, "user_id": 10574770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Itsql--OmbU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbC8Ngs0dS51nESyFFqOoS0eAaH0MA/mo/photo.jpg?sz=128", "display_name": "Luca", "link": "https://stackoverflow.com/users/10574770/luca"}, "edited": false, "score": 0, "creation_date": 1541054885, "post_id": 53083119, "comment_id": 93088874, "body": "Freeflow thanks, i tried your code but it doesn&#39;t retain the styles applied."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1541066722, "post_id": 53083119, "comment_id": 93093695, "body": "I looked at it again and at Macropod&#39;s ingenious code and came up with a solution that worked on the test document I created.  I posted the code as an update to my answer above."}, {"owner": {"reputation": 39, "user_id": 10574770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Itsql--OmbU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbC8Ngs0dS51nESyFFqOoS0eAaH0MA/mo/photo.jpg?sz=128", "display_name": "Luca", "link": "https://stackoverflow.com/users/10574770/luca"}, "edited": false, "score": 0, "creation_date": 1541072538, "post_id": 53083119, "comment_id": 93096631, "body": "yup that&#39;s the answer thanks a loooot. Just a fast question:could you tell me if is it easily to adapt your code in order to use for other Styles as well? If this isn&#39;t too much already, because you did a lot, thanks again :) (ps: asking because i dunno what will the nearest future will bring on and i don&#39;t work with VBA:(.  )"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1541156983, "post_id": 53083119, "comment_id": 93129190, "body": "My previous comment got lost, but in case you didn&#39;t notice I updated the code to use a list of user defined styles."}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 0, "last_activity_date": 1541076638, "last_edit_date": 1541076638, "creation_date": 1540988110, "answer_id": 53083119, "question_id": 53082664, "link": "https://stackoverflow.com/questions/53082664/vba-word-macro-to-put-a-string-to-an-existing-heading/53083119#53083119", "title": "vba word macro to put a string to an existing Heading", "body": "<p>Do a wildcard find for any paragraph marker which is followed by ID:.  </p>\n\n<p>.Text = \"^13ID:\"<br>\n.Replacement.Text = \"\"</p>\n\n<p>You will need to specify the style of the replacement text to the heading style because when you delete the paragraph marker at the end of the Heading paragraph you will also delete the style information for the heading paragraph.</p>\n\n<p>You will need to do this with every style heading followed by the ID: text.</p>\n\n<p>Updated 2018-11-01 </p>\n\n<p>The following code should work.  I got some hints from Macropods ingeneous code.</p>\n\n<p>Update 2 2018-11-01 </p>\n\n<p>Revised to work with a list of styles defined by user at OPs request</p>\n\n<pre><code>Sub ConsolidateHeadingWithID()\n\nConst HEADINGS                                   As String = \"Heading 1,Heading 2,Heading 3,Heading 4,Heading 5,Other style,another style\"\n\nDim my_headings                                 As Variant\nDim my_heading                                  As Variant\nmy_headings = Split(HEADINGS, \",\")\n\nFor Each my_heading In my_headings\n\n        With ActiveDocument.StoryRanges(wdMainTextStory)\n\n            With .Find\n\n                .ClearFormatting\n                .format = True\n                .Text = \"\"\n                .Style = my_heading\n                .MatchWildcards = True\n                .Wrap = wdFindStop\n                .Execute\n\n            End With\n\n            Do While .Find.Found\n\n                If .Duplicate.Next(unit:=wdWord).Text = \"ID\" Then\n\n                    .Duplicate.Next(unit:=wdParagraph).Style = my_heading\n\n                End If\n\n                .Collapse wdCollapseEnd\n                .MoveStart unit:=wdCharacter, Count:=2\n                .Find.Execute\n\n            Loop\n\n        End With\n\n        With ActiveDocument.Range.Find\n\n            .ClearFormatting\n            .format = True\n            .Text = \"(^13)(ID:)(*)(AWP_)([0-9]{1,})\"\n            .Style = my_heading\n            .Replacement.Text = \" [\\4\\5]\"\n            .MatchWildcards = True\n            .Wrap = wdFindContinue\n            .Execute Replace:=wdReplaceAll\n\n        End With\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 10574770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Itsql--OmbU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbC8Ngs0dS51nESyFFqOoS0eAaH0MA/mo/photo.jpg?sz=128", "display_name": "Luca", "link": "https://stackoverflow.com/users/10574770/luca"}, "edited": false, "score": 0, "creation_date": 1541053063, "post_id": 53092593, "comment_id": 93088282, "body": "Thank you, it worked but with some problems, the ID is the same level as the heading but so are all ID&#39;s from the document. Is it possible to adjust you code to work only at a specific Style? eg Heading 1, Heading 2, Normal?"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 39, "user_id": 10574770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Itsql--OmbU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbC8Ngs0dS51nESyFFqOoS0eAaH0MA/mo/photo.jpg?sz=128", "display_name": "Luca", "link": "https://stackoverflow.com/users/10574770/luca"}, "edited": false, "score": 0, "creation_date": 1541109309, "post_id": 53092593, "comment_id": 93115035, "body": "@Luca You need to be clearer about your requirements. Your initial thread says nothing about a Heading Style being applied to the IDs. Moreover, it depicts the ID text being re-assigned to headings with different numbering schemes, which implies the use of different Heading Styles. The question in your comment above is ambiguous; to what does the &#39;specific Style&#39; apply?"}, {"owner": {"reputation": 39, "user_id": 10574770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Itsql--OmbU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbC8Ngs0dS51nESyFFqOoS0eAaH0MA/mo/photo.jpg?sz=128", "display_name": "Luca", "link": "https://stackoverflow.com/users/10574770/luca"}, "edited": false, "score": 0, "creation_date": 1541143692, "post_id": 53092593, "comment_id": 93123067, "body": "thanks, much appreciation for you kind help while i was vague.Freeflows code helped me with the task i had and man, vba is hard i have to say. Much appreciation once again macro and free for ur help, time and nerves with me :P. Have a nice day"}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1541023507, "creation_date": 1541023507, "answer_id": 53092593, "question_id": 53082664, "link": "https://stackoverflow.com/questions/53082664/vba-word-macro-to-put-a-string-to-an-existing-heading/53092593#53092593", "title": "vba word macro to put a string to an existing Heading", "body": "<p>Try:</p>\n\n<pre><code>Sub Demo()\nApplication.ScreenUpdating = False\nDim Rng As Range\nWith ActiveDocument.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"ID:*^13\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchWildcards = True\n    .Execute\n  End With\n  Do While .Find.Found\n    Set Rng = .Duplicate.GoTo(What:=wdGoToBookmark, Name:=\"\\HeadingLevel\")\n    Rng.End = Rng.Paragraphs.First.Range.End - 1\n    Rng.InsertAfter Split(Split(.Duplicate.Text, \":\")(1), vbCr)(0)\n    .Text = vbNullString\n    .Collapse wdCollapseEnd\n    .Find.Execute\n  Loop\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10574770, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Itsql--OmbU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbC8Ngs0dS51nESyFFqOoS0eAaH0MA/mo/photo.jpg?sz=128", "display_name": "Luca", "link": "https://stackoverflow.com/users/10574770/luca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 53092593, "answer_count": 2, "score": 0, "last_activity_date": 1583092794, "creation_date": 1540986581, "last_edit_date": 1583092794, "question_id": 53082664, "link": "https://stackoverflow.com/questions/53082664/vba-word-macro-to-put-a-string-to-an-existing-heading", "title": "vba word macro to put a string to an existing Heading", "body": "<p>i am attempting to write a macro that with find/replace a string and than move it to an existing heading. The original text is like this:</p>\n\n<p><strong>1. Heading 1</strong></p>\n\n<p><strong>ID</strong>: abcd</p>\n\n<p><strong>1.1 Heading 2</strong></p>\n\n<p><strong>ID</strong>: abcd</p>\n\n<p>And it should look like:</p>\n\n<p><strong>1.Heading 1 abcd</strong></p>\n\n<p><strong>1.1 Heading 2 abcd</strong></p>\n\n<p>I am having some problems with the code i tried to write, mostly because i am kinda new, but this is what i created so far:</p>\n\n<pre><code>Selection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nSelection.Style = \"Heading 2\"\nWith Selection.Find\n    .Text = \"abcd\"\n    .Replacement.Text = \"abcd^p\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = True\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\n</code></pre>\n\n<p>The text is not so important because i managed to replace with what i want but i don't know how to align it with the Heading style.. Thanks</p>\n\n<p>EDIT: I hope i don't screw up again, sorry big :). So i have <a href=\"https://i.stack.imgur.com/te75F.png\" rel=\"nofollow noreferrer\">raw</a> which is the raw text and i want to process it to look like this <a href=\"https://i.stack.imgur.com/XOUzD.png\" rel=\"nofollow noreferrer\">final</a>. I already found out, thanks to you how to replace the text, it's just that i stuck in the raw version. Thanks, I kinda own you a beer, or two</p>\n\n<p>LATER EDIT: So i have 5 types of Heading formats, <strong>1. Heading 1, 1.1 Heading 2</strong> etc till 5, and all of them have below them an ID, each with a specific number, but the name is the same, <strong>ID</strong> ASD_PC_AWP_[XXXX]. I just have to get rid of <strong>ID</strong> ASD_PC_ and put AWP_[xxxx] at same level of the Heading eg: <strong>1.Heading 1 AWP_[xxxx1] ** , **2. Heading 2 AWP_[xxx2]</strong>...</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 2, "creation_date": 1540988766, "post_id": 53082604, "comment_id": 93063286, "body": "The worksheet_change event would only kick in if you manually change D5, if you manually change anywhere on the sheet, the code will check if it was D5, if it was not, then it will exit the sub. Calculations are not worksheet_change events."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1540993122, "post_id": 53082604, "comment_id": 93066196, "body": "Can you indent your code correctly and make sure the line breaks are correct please? It is not clear if your <code>If</code> statements are single line statements or not. The code as it is would not compile. Best is to copy/past the code here and use Ctrl + K to format it as code block."}, {"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "edited": false, "score": 0, "creation_date": 1540995398, "post_id": 53082604, "comment_id": 93067766, "body": "D5 is manually being entered."}], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "edited": false, "score": 0, "creation_date": 1540988312, "post_id": 53082854, "comment_id": 93063031, "body": "Didn&#39;t work, I placed &quot;Application.EnableEvents = False&quot; it right after the &quot;If Target.Address = &quot;$D$5&quot; Then&quot; line and place &quot;Application.EnableEvents = True&quot; after the &quot;End If&quot;"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1540989148, "post_id": 53082854, "comment_id": 93063476, "body": "You can enableEvents with <code>Application.EnableEvents = True</code> Assigned to a button, or you can enter it in the &quot;immediate window&quot; in the vba editor, great help when testing code."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1540989247, "post_id": 53082854, "comment_id": 93063521, "body": "You have a quote after If&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1540992886, "post_id": 53082854, "comment_id": 93066025, "body": "just a note but your <code>If</code> has no <code>Then</code> ;)"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1540989372, "last_edit_date": 1540989372, "creation_date": 1540987154, "answer_id": 53082854, "question_id": 53082604, "link": "https://stackoverflow.com/questions/53082604/if-statement-not-executing-properly-in-byval-target-as-range/53082854#53082854", "title": "If statement not executing properly in ByVal Target As Range", "body": "<p>Import:</p>\n\n<pre><code>Application.EnableEvents = False\n    If Target.Address = \"$D$5\"\n    End If\nApplication.EnableEvents = True\n</code></pre>\n\n<p>save the file close it and reopen it in order to reset Application.EnableEvents.</p>\n"}], "owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586416693, "creation_date": 1540986377, "last_edit_date": 1586416693, "question_id": 53082604, "link": "https://stackoverflow.com/questions/53082604/if-statement-not-executing-properly-in-byval-target-as-range", "title": "If statement not executing properly in ByVal Target As Range", "body": "<p>This code checks cell ranges based on the criteria provided in the Worksheet_Change(ByVal Target As Range). It works for the most part except for this one anomaly. When range SalesPrice changes it checks the loanamount value, \"If my loan amount is under 271,050 and checkbox1.value is true\" it goes to the next routine (this is correct behavior).  But if I change the SalesPrice which re-calculates LoanAmount to a number that causes the LoanAmount to go over 271050 the MsgBox code does not execute. But if I retype the same SalesPrice again it does execute. So in order for it to work properly I have to type in the SalesPrice twice if chkbox1.value was initially checked for the code to detect that the LoanAmount is too high.</p>\n\n<pre><code>If Target.Address = \"$D$5\" Then 'Sales Price\nIf Range(\"LoanProgram\").Value Like \"*HFA Bond Miami*\" And _\nRange(\"SalesPrice\").Value &gt; 317646 Then MsgBox \"Miami-Dade Bond Max Sales \nPrice is $317,646\"\nIf Range(\"LoanAmount\").Value &gt; 271050 And Sheets(\"Main\").CheckBox1.Value = \nTrue Then\nMsgBox \"MDEAT Max Loan Amount is $271,050\"\nSheets(\"Main\").CheckBox1.Value = False\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 9534456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/518d95ecc6ddc3a203e0b2cf9e60e698?s=128&d=identicon&r=PG&f=1", "display_name": "kit99", "link": "https://stackoverflow.com/users/9534456/kit99"}, "edited": false, "score": 0, "creation_date": 1540985711, "post_id": 53082272, "comment_id": 93061629, "body": "All those hours I&#39;ve pondered... and the solution was that simple... :-)) Thanks a lot for helping out."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1540985169, "creation_date": 1540985169, "answer_id": 53082272, "question_id": 53082197, "link": "https://stackoverflow.com/questions/53082197/how-to-update-a-pivot-table-automatically-every-time-data-source-is-changed/53082272#53082272", "title": "How to update a pivot table automatically every time data source is changed", "body": "<p>Try:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n   Application.EnableEvents = False\n   ThisWorkbook.RefreshAll\n   Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 9534456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/518d95ecc6ddc3a203e0b2cf9e60e698?s=128&d=identicon&r=PG&f=1", "display_name": "kit99", "link": "https://stackoverflow.com/users/9534456/kit99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1074, "favorite_count": 0, "accepted_answer_id": 53082272, "answer_count": 1, "score": 1, "last_activity_date": 1586416730, "creation_date": 1540984915, "last_edit_date": 1586416730, "question_id": 53082197, "link": "https://stackoverflow.com/questions/53082197/how-to-update-a-pivot-table-automatically-every-time-data-source-is-changed", "title": "How to update a pivot table automatically every time data source is changed", "body": "<p>Here's my setup:</p>\n\n<p>Sheet \"data\" is (formatted) table.</p>\n\n<p>Sheet \"dash\" is pivot table based on sheet \"data\" and a lot of slicers.</p>\n\n<p>Sheet \"nr\" is a) pivot table based on \"data\" displaying only a single nr (number of workers).</p>\n\n<p>Sheet \"nr\" is b) formatted table where I use the \"single nr\" to calculate shifts per week for 52 weeks.</p>\n\n<p>Sheet \"nr\" is c) pivot table of the \"shifts per week\"-table (\"PIVnyKIT\").</p>\n\n<p>I want to be able to choose data from slicers in sheet \"dash\" and see data in table \"shifts per week\" in sheet \"nr\" change (I'm pulling a graph from this table that I'm displaying in sheet \"dash\").\nBecause a pivot table does not update on auto when background data is changed, I've opened my vba-editor. \nIn this I've chosen \"Microsoft Excel Objects\" and sheet \"nr\" and entered the following vba-code:</p>\n\n<p><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nPivotTables(\"PIVnyKIT\").RefreshTable\nEnd Sub</code></p>\n\n<p>But for some odd reason it doesn't work...\nAll values update as they should, but the pivot table \"PIVnyKIT\" stay unchanged. That is until I choose (click) into a random cell in sheet \"nr\". \nThen \"PIVnyKIT\" suddenly update.</p>\n\n<p>I've done som testing, and it seems that this way of updating a pivot table works just fine when I make my changes directly into the data table (and hit Enter).\nBut not when the data table is updating itself based on formulas and slicer selections made in another worksheet...</p>\n\n<p>Someone who knows how to make this work? Possibly another way to do this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1540984928, "post_id": 53081984, "comment_id": 93061229, "body": "What is the reason that you have to use that specific delimiter?"}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1540985063, "post_id": 53081984, "comment_id": 93061309, "body": "Can&#39;t you use &quot;Fixed width&quot; while using the text import wizard? Once the text is imported in Excel, you can replace the <code>|</code> character by an empty character."}, {"owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1540985301, "post_id": 53081984, "comment_id": 93061424, "body": "@Rory - I can&#39;t think of the other characters that impossible to used in the data. But, didn&#39;t expect when I tried to generate a report and was messed up. So, when I checked the customer&#39;s data there is a &#166;. I am doing a form, so I need to use VBA."}, {"owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "reply_to_user": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1540985567, "post_id": 53081984, "comment_id": 93061559, "body": "@Dominique - I am doing a form, so I need to use VBA."}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "edited": false, "score": 0, "creation_date": 1540985446, "post_id": 53082294, "comment_id": 93061505, "body": "I am doing a form, so I need to used a VBA."}], "tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 1, "last_activity_date": 1540985496, "last_edit_date": 1540985496, "creation_date": 1540985278, "answer_id": 53082294, "question_id": 53081984, "link": "https://stackoverflow.com/questions/53081984/escape-character-in-vba/53082294#53082294", "title": "Escape character in VBA", "body": "<p>To be blunt, your data is not well formed, but that's life :) !  You need to employ what are called \"text qualifiers\" that will allow the character you're using as a delimiter to appear within the text items you're looking to delimit and not be treated as a delimiter.</p>\n\n<p>An example of what you're after:</p>\n\n<p><code>\"111\"|\"AAA\"|\"1A1\"\n\"222\"|\"BBB\"|\"2B2\"\n\"333\"|\"CC|C\"|\"3C3\"</code></p>\n\n<p>Copy/paste the third data row into a new worksheet and then run the Text to Columns wizard (TtCW) on it for delimited text.  In the second step you'll see the \"Text qualifier\" dropdown on the right hand side.</p>\n\n<p>You may well need to employ VBA to concatenate the data with text qualifiers and then split it again via the TtCW.  Record a macro to see how you can automate it and you'll be able to incorporate it into your code.</p>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "edited": false, "score": 0, "creation_date": 1540985422, "post_id": 53082306, "comment_id": 93061491, "body": "I am doing a form so I need to used a VBA."}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "reply_to_user": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "edited": false, "score": 0, "creation_date": 1540986134, "post_id": 53082306, "comment_id": 93061833, "body": "Text-to-columns with VBA is your best bet then, the other answer looks good."}], "tags": [], "owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "is_accepted": false, "score": 0, "last_activity_date": 1540985309, "creation_date": 1540985309, "answer_id": 53082306, "question_id": 53081984, "link": "https://stackoverflow.com/questions/53081984/escape-character-in-vba/53082306#53082306", "title": "Escape character in VBA", "body": "<p>My solution uses Get &amp; Transform without vba (requires recent Excel or Power Query addon). Worked fine for me on your data, leaving CC\u00a6C in column B.</p>\n\n<p>Get data from range</p>\n\n<p>Split all using | delimiter</p>\n\n<p>Right click last column -> Split by \u00a6 delimiter</p>\n\n<p>Rename Column headers</p>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1540990334, "post_id": 53082675, "comment_id": 93064162, "body": "Agreed. I like to use something in the unprintable range like <code>Chr$(30)</code> (record separator) or <code>Chr$(7)</code> (bell) for stuff like this."}, {"owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "edited": false, "score": 1, "creation_date": 1540992701, "post_id": 53082675, "comment_id": 93065887, "body": "@Vasily - thank you :). I am currently using your idea."}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 3, "last_activity_date": 1540987032, "last_edit_date": 1540987032, "creation_date": 1540986630, "answer_id": 53082675, "question_id": 53081984, "link": "https://stackoverflow.com/questions/53081984/escape-character-in-vba/53082675#53082675", "title": "Escape character in VBA", "body": "<p>you can replace <code>|</code> by the character that you don't use, e.g by <code>^</code> (or with some pattern, e.g. <code>[ThisIsPipe]</code>), and during <code>split()</code>(or after) replace back <code>^</code> (or injected pattern) by <code>|</code> for instance. </p>\n\n<p>IMHO, for [concatenation ~~> split] will be better to use those characters that are not reflected in sheet</p>\n"}], "owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 53082675, "answer_count": 3, "score": -2, "last_activity_date": 1586416766, "creation_date": 1540984197, "last_edit_date": 1586416766, "question_id": 53081984, "link": "https://stackoverflow.com/questions/53081984/escape-character-in-vba", "title": "Escape character in VBA", "body": "<p>I've seen similar topics in the internet but I can't find the appropriate one that will suit to my problem. I will shorten my discussion since it is too long to discuss. So I need to concatenate Column A, Column B, and Column C separated by \"\u00a6\". I need to split using \"\u00a6\" (no need to ask why I need to concatenate \u00a6 and then split it using \u00a6 - it is a long process. This is only a gist), but there is a possibility that the data contains \"\u00a6\". Is it possible to disregard or escape first the \"\u00a6\" in the data, so that it will not be consider as a delimiter? Changing of delimiter can also appear in the data. I am doing a form so I need to use VBA.</p>\n\n<p>For example, </p>\n\n<pre><code>Column A     | Column B     | Column C     | Column D\n111          | AAA          | 1A1          | 111\u00a6AAA\u00a61A1\n222          | BBB          | 2B2          | 222\u00a6BBB\u00a62B2\n333          | CC\u00a6C         | 3C3          | 333\u00a6CC\u00a6C\u00a63C3 \n</code></pre>\n\n<p>If I split the above example, it will look like this and which is wrong.</p>\n\n<pre><code>Column A     | Column B     | Column C     | Column D\n111          | AAA          | 1A1          | \n222          | BBB          | 2B2          | \n333          | CC           | C            | 3C3\n</code></pre>\n"}, {"tags": ["vba", "copy", "paste"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10585417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1501607e517a0a31684e5ccbc2042a5?s=128&d=identicon&r=PG&f=1", "display_name": "jdwh", "link": "https://stackoverflow.com/users/10585417/jdwh"}, "edited": false, "score": 0, "creation_date": 1540989389, "post_id": 53082827, "comment_id": 93063608, "body": "Thanks McMookerson.  Yes the criteria and data layout is the same I just need it to run across multiple sheets and paste all of the data that meets the criteria from sheet a-z into the master sheet.  As I said I&#39;m very new to VBA.  I&#39;ve change my code to put that in the first line and deleted out the WS lines but it now won&#39;t let me run it."}, {"owner": {"reputation": 1, "user_id": 9184691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TzPNO.png?s=128&g=1", "display_name": "McMookerson", "link": "https://stackoverflow.com/users/9184691/mcmookerson"}, "reply_to_user": {"reputation": 1, "user_id": 10585417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1501607e517a0a31684e5ccbc2042a5?s=128&d=identicon&r=PG&f=1", "display_name": "jdwh", "link": "https://stackoverflow.com/users/10585417/jdwh"}, "edited": false, "score": 0, "creation_date": 1541157805, "post_id": 53082827, "comment_id": 93129611, "body": "Are you receiving any specific errors after that change? Can you post what your code looks like now so that we can dig deeper?"}, {"owner": {"reputation": 1, "user_id": 10585417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1501607e517a0a31684e5ccbc2042a5?s=128&d=identicon&r=PG&f=1", "display_name": "jdwh", "link": "https://stackoverflow.com/users/10585417/jdwh"}, "edited": false, "score": 0, "creation_date": 1541492646, "post_id": 53082827, "comment_id": 93226105, "body": "Sub Copy_Filtered_WkShts()             Sheets(&quot;master&quot;).Unprotect Password:=&quot;password&quot;     Sheets(&quot;A_G&quot;).Unprotect Password:=&quot;password&quot;     Sheets(&quot;F_P&quot;).Unprotect Password:=&quot;password&quot;     Sheets(&quot;CC&quot;).Unprotect Password:=&quot;password&quot;          Dim ws As Worksheet     Dim writeRow As Long      Sheets(&quot;master&quot;).UsedRange.Offset(1).ClearContents Application.ScreenUpdating = False For Each ws In ThisWorkbook.Worksheets     If (ws.Name &lt;&gt; &quot;master&quot;) Then               writeRow = Sheets(&quot;master&quot;).Cells(Rows.count, &quot;y&quot;).End(xlUp).Row + 1"}, {"owner": {"reputation": 1, "user_id": 10585417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1501607e517a0a31684e5ccbc2042a5?s=128&d=identicon&r=PG&f=1", "display_name": "jdwh", "link": "https://stackoverflow.com/users/10585417/jdwh"}, "edited": false, "score": 0, "creation_date": 1541492655, "post_id": 53082827, "comment_id": 93226112, "body": "With ws                .AutoFilterMode = False            With .UsedRange        .AutoFilter Field:=78, Criteria1:=&quot;&gt;14&quot;, _        Operator:=xlAnd         .Offset(1).Copy Destination:=Sheets(&quot;master&quot;).Range(&quot;A&quot; &amp; writeRow)             End With             .AutoFilterMode = False         End With    End If Next ws Application.ScreenUpdating = True Sheets(&quot;master&quot;).Protect Password:=&quot;password&quot; Sheets(&quot;A_G&quot;).Protect Password:=&quot;password&quot; Sheets(&quot;F_P&quot;).Protect Password:=&quot;password&quot; Sheets(&quot;CC&quot;).Protect Password:=&quot;password&quot; End Sub"}, {"owner": {"reputation": 1, "user_id": 10585417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1501607e517a0a31684e5ccbc2042a5?s=128&d=identicon&r=PG&f=1", "display_name": "jdwh", "link": "https://stackoverflow.com/users/10585417/jdwh"}, "edited": false, "score": 0, "creation_date": 1541492693, "post_id": 53082827, "comment_id": 93226134, "body": "Sorry had to split across 2 comments and it keeps losing the formatting.  Sorry for the delay in getting back to you McMookerson."}], "tags": [], "owner": {"reputation": 1, "user_id": 9184691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TzPNO.png?s=128&g=1", "display_name": "McMookerson", "link": "https://stackoverflow.com/users/9184691/mcmookerson"}, "is_accepted": false, "score": 0, "last_activity_date": 1540987064, "creation_date": 1540987064, "answer_id": 53082827, "question_id": 53081742, "link": "https://stackoverflow.com/questions/53081742/copy-and-paste-vba-code-i-want-to-use-across-multiple-sheets/53082827#53082827", "title": "Copy and paste VBA code - I want to use across multiple sheets", "body": "<p>Without diving too far into the specifics of your code itself - will the criteria be the same for all worksheets you're wanting to run it on? And is the layout of the data in all of those worksheets?</p>\n\n<p>If so, and if your current code is doing what you need it to do for Worksheet A and we just need to expand that to also handle Worksheets B through X, then you could get rid of your dim/set ws lines, and instead change your first line to </p>\n\n<pre><code>sub copyPaste(ws as worksheet)\n</code></pre>\n\n<p>This would allow you to then use a separate procedure to call this procedure for each of your worksheets that it needs to be run on. Below is an example using the worksheet from your original code:</p>\n\n<pre><code>call copyPaste(ThisWorkbook.Sheets(\"S_Q\"))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541157285, "post_id": 53086999, "comment_id": 93129323, "body": "Did you try this please?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1540999837, "creation_date": 1540999837, "answer_id": 53086999, "question_id": 53081742, "link": "https://stackoverflow.com/questions/53081742/copy-and-paste-vba-code-i-want-to-use-across-multiple-sheets/53086999#53086999", "title": "Copy and paste VBA code - I want to use across multiple sheets", "body": "<p>I would put the sheets of interest to loop over in an array and loop that. I would also use Union to gather the qualifying ranges and paste in one go to be more efficient.</p>\n\n<p>I would also use a helper function to retrieve the last row and add one to that to get next row.</p>\n\n<p>Also, use <code>Long</code> rather than <code>Integer</code> to avoid potential overflow as there are more rows in a sheet than Integer can handle.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub copyPaste()\n    Dim ws As Worksheet, wt As Worksheet, sheetsOfInterest(), unionRng As Range\n    Dim i As Long, lastRow As Long, lastRowMaster As Long\n    Application.ScreenUpdating = False\n    sheetsOfInterest = Array(\"Sheet1\", \"Sheet2\", \"S_Q\")\n\n    Set wt = ThisWorkbook.Worksheets(\"master\")\n\n    For Each ws In ThisWorkbook.Worksheets(sheetsOfInterest)\n\n        lastRow = GetLastRow(ws, 25)\n\n        For i = 1 To lastRow\n\n            If ws.Range(\"BZ\" &amp; i) &gt; 14 Then\n                If Not unionRng Is Nothing Then\n                    Set unionRng = Union(unionRng, ws.Range(\"bz\" &amp; i))\n                Else\n                    Set unionRng = ws.Range(\"BZ\" &amp; i)\n                End If\n            End If\n        Next i\n        If Not unionRng Is Nothing Then\n            With wt\n                unionRng.EntireRow.Copy .Range(\"A\" &amp; GetLastRow(wt, 1) + 1)\n            End With\n        End If\n        Set unionRng = Nothing\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n\nPublic Function GetLastRow(ByVal ws As Worksheet, Optional ByVal columnNumber As Long = 1) As Long\n    With ws\n        GetLastRow = .Cells(.Rows.Count, columnNumber).End(xlUp).Row\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10585417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1501607e517a0a31684e5ccbc2042a5?s=128&d=identicon&r=PG&f=1", "display_name": "jdwh", "link": "https://stackoverflow.com/users/10585417/jdwh"}, "is_accepted": true, "score": 0, "last_activity_date": 1541670557, "creation_date": 1541670557, "answer_id": 53205165, "question_id": 53081742, "link": "https://stackoverflow.com/questions/53081742/copy-and-paste-vba-code-i-want-to-use-across-multiple-sheets/53205165#53205165", "title": "Copy and paste VBA code - I want to use across multiple sheets", "body": "<p>After trying the filter on various columns and it working on some and not others; with no apparent reasoning.  I decided to rejig the spreadsheets and put the column to be filtered in the first column.  This seems to be working so far.</p>\n"}], "owner": {"reputation": 1, "user_id": 10585417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1501607e517a0a31684e5ccbc2042a5?s=128&d=identicon&r=PG&f=1", "display_name": "jdwh", "link": "https://stackoverflow.com/users/10585417/jdwh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 53205165, "answer_count": 3, "score": 0, "last_activity_date": 1541670557, "creation_date": 1540983436, "last_edit_date": 1540986348, "question_id": 53081742, "link": "https://stackoverflow.com/questions/53081742/copy-and-paste-vba-code-i-want-to-use-across-multiple-sheets", "title": "Copy and paste VBA code - I want to use across multiple sheets", "body": "<p>I'm very new to VBA.  I have some code that will copy data that meets a certain criteria in one sheet to another master sheet.  I have multiple other worksheets that I want to copy from into the master.  How do I amend my code to do that please?</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>Sub copyPaste()\n    Dim ws As Worksheet\n    Dim wt As Worksheet\n    Set ws = Sheets(\"S_Q\")\n    Set wt = Sheets(\"master\")\n    Dim i As Integer\n    Dim lr As Integer\n    lr = ws.Range(\"y\" &amp; Rows.Count).End(xlUp).Row\n    Dim lt As Long\n\n    For i = 1 To lr\n    lt = wt.Range(\"y\" &amp; Rows.Count).End(xlUp).Row\n        If ws.Range(\"bz\" &amp; i) &gt; 14 Then\n        ws.Range(\"y\" &amp; i).EntireRow.Copy wt.Range(\"a\" &amp; lt + 1)\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "string", "quotes"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 3821213, "user_type": "registered", "profile_image": "https://graph.facebook.com/1730602023/picture?type=large", "display_name": "CarlaFaria", "link": "https://stackoverflow.com/users/3821213/carlafaria"}, "edited": false, "score": 0, "creation_date": 1540985479, "post_id": 53082150, "comment_id": 93061519, "body": "Thank you for you answer. but that part is just fine. my problem is in Aplicacao.BSO.DSO.BDAPL.Execute (Comando.CommandText) I Need it to be Aplicacao.BSO.DSO.BDAPL.Execute (StringView_View1.Value) in order to work and I just get Aplicacao.BSO.DSO.BDAPL.Execute (&quot;StringView_View1.Value&quot;). How do I take out the quotes?!  thak you a lot any away."}, {"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "reply_to_user": {"reputation": 23, "user_id": 3821213, "user_type": "registered", "profile_image": "https://graph.facebook.com/1730602023/picture?type=large", "display_name": "CarlaFaria", "link": "https://stackoverflow.com/users/3821213/carlafaria"}, "edited": false, "score": 0, "creation_date": 1540985754, "post_id": 53082150, "comment_id": 93061651, "body": "Yes, because your CommandText is referencing the name of a control (<code>&quot;StringView_123.Value&quot;</code>), not SQL that it can execute (<code>Replace(StringView_123.Value, &quot;123&quot;, NomeView)</code>).  Note the quotes (or lack of them) when I&#39;m referring to the control <code>StringView_123</code>)"}, {"owner": {"reputation": 23, "user_id": 3821213, "user_type": "registered", "profile_image": "https://graph.facebook.com/1730602023/picture?type=large", "display_name": "CarlaFaria", "link": "https://stackoverflow.com/users/3821213/carlafaria"}, "edited": false, "score": 0, "creation_date": 1541070694, "post_id": 53082150, "comment_id": 93095692, "body": "Hello again. Thank you for your time and pacience. I understand what you mean and agree with it. But my control &quot;string...&quot; is a funcion which return a  text. If I take out the quotes, I have two problems: first the funcion name must be real, which I don&#39;t care at that time; then it makes my  Com value equals with that first function return value, which I don&#39;t want either. Because what I want with this is have a dynamic function name, and consequent execution. I tried CALLBYNAME, CALL or RUN but neither seems to work. I turned around with a case where. but I hate that solution.Thank you again"}], "tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 0, "last_activity_date": 1540984691, "creation_date": 1540984691, "answer_id": 53082150, "question_id": 53081667, "link": "https://stackoverflow.com/questions/53081667/vba-string-as-commandtext-string-with-no-quotes/53082150#53082150", "title": "VBA String as commandtext (string with no Quotes)", "body": "<p>These are string variables (NomeView, Com):</p>\n\n<p><code>NomeView =\"View1\"\nCom = \"StringView_123.Value\"</code></p>\n\n<p>This is a string property (CommandText is a text property of the Comando object):</p>\n\n<p><code>Comando.CommandText = Com</code></p>\n\n<p><code>StringView_123</code> looks like the name of a control (possibly a textbox?) and it has a <code>Value</code> property.</p>\n\n<p>It looks like these lines need to change:</p>\n\n<p><code>Com = \"StringView_123.Value\"\nCom = Replace(Com, \"123\", NomeView)</code></p>\n\n<p>to:</p>\n\n<p><code>Com = StringView_123.Value\nCom = Replace(Com, \"123\", NomeView)</code></p>\n\n<p>The quotes you have around the control name &amp; property mean that you're working with a string value (\"StringView_123.Value\"), not the name of the control (StringView_123)</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 3821213, "user_type": "registered", "profile_image": "https://graph.facebook.com/1730602023/picture?type=large", "display_name": "CarlaFaria", "link": "https://stackoverflow.com/users/3821213/carlafaria"}, "is_accepted": true, "score": 0, "last_activity_date": 1541439695, "creation_date": 1541439695, "answer_id": 53159493, "question_id": 53081667, "link": "https://stackoverflow.com/questions/53081667/vba-string-as-commandtext-string-with-no-quotes/53159493#53159493", "title": "VBA String as commandtext (string with no Quotes)", "body": "<p>I replaced \"commandtext\" with a CallByName, my fight was in \"value\" (it was poorly positioned).</p>\n\n<pre><code>Public Sub CreatView(ByVal NomeView As String)\nNomeView =\"View1\" 'example\n\nDim Com As String\nCom = \"StringView_123\"\nCom = Replace(Com, \"123\", NomeView)\nAplicacao.BSO.DSO.BDAPL.Execute (CallByName(Me, Com, VbMethod).Value)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3821213, "user_type": "registered", "profile_image": "https://graph.facebook.com/1730602023/picture?type=large", "display_name": "CarlaFaria", "link": "https://stackoverflow.com/users/3821213/carlafaria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 53159493, "answer_count": 2, "score": 0, "last_activity_date": 1541439695, "creation_date": 1540983220, "question_id": 53081667, "link": "https://stackoverflow.com/questions/53081667/vba-string-as-commandtext-string-with-no-quotes", "title": "VBA String as commandtext (string with no Quotes)", "body": "<p>I have a Sub which has a parameter string and will include it in a commandtext. My problem is that the execution does not accept a string (because of the quotes) in the command line. Is it possible to equals a commandtext to a string and make the system don't considerate the quotes? Thank you</p>\n\n<pre><code>Public Sub CreatView(ByVal NomeView As String)\nNomeView =\"View1\" 'example\n\nDim Com As String\nDim Comando As Command\nSet Comando = New Command\nCom = \"StringView_123.Value\"\nCom = Replace(Com, \"123\", NomeView)\nComando.CommandText = Com 'Don't work\nComando.CommandText = StringView_View1.Value 'Work fine\n\nAplicacao.BSO.DSO.BDAPL.Execute (Comando.CommandText)\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1540982354, "post_id": 53081306, "comment_id": 93059844, "body": "I get a <code>Can&#39;t run macro &quot;Sheet1.Wokrsheet_change&quot;. Perhaps this macro is absent or all macros are turned off&quot;</code> error (translation from my excel version)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1540982402, "post_id": 53081306, "comment_id": 93059875, "body": "Note that <code>Sheet1</code> is the VBA name of the sheet (added that info to the answer)."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1540982483, "post_id": 53081306, "comment_id": 93059923, "body": "Thanks, I changed the VBA name of the sheet and now it works!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1540982848, "last_edit_date": 1540982848, "creation_date": 1540982007, "answer_id": 53081306, "question_id": 53081165, "link": "https://stackoverflow.com/questions/53081165/excel-vba-call-worksheet-change-from-another-worksheet/53081306#53081306", "title": "Excel vba: call Worksheet_change from another worksheet", "body": "<p>You can use <code>Application.Run</code> like that \u2026</p>\n\n<pre><code>Application.Run \"Sheet1.Worksheet_Change\", Range(\"A1\")\n</code></pre>\n\n<p>Note that <code>Sheet1</code> here is the VBA name of the sheet not the name on the tab. The VBA name can be changed in the property window of the sheet (in the VB Editor).</p>\n\n<hr>\n\n<p>Alternatively move the code in your <code>Worksheet_Change</code> into a module like:</p>\n\n<pre><code>Public Sub MySpecificWorksheet_Change(ByVal Target As Range)\n    ...\nEnd Sub\n</code></pre>\n\n<p>And call that from both <code>Worksheet_Change</code> and <code>Worksheet_Calculate</code></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    MySpecificWorksheet_Change(ByVal Target As Range)\nEnd Sub\n\nPrivate Sub Worksheet_Calculate()\n    MySpecificWorksheet_Change(ByVal Target As Range)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 2, "last_activity_date": 1540982506, "creation_date": 1540982506, "answer_id": 53081448, "question_id": 53081165, "link": "https://stackoverflow.com/questions/53081165/excel-vba-call-worksheet-change-from-another-worksheet/53081448#53081448", "title": "Excel vba: call Worksheet_change from another worksheet", "body": "<p>Either:</p>\n\n<ul>\n<li>Change <code>Private Sub Worksheet_Change</code> to <code>Friend Sub Worksheet_Change</code>.</li>\n<li>Move the functionality of <code>Private Sub Worksheet_Change</code> into a friend/public sub and call it from both <code>Worksheet_Change</code> and <code>Worksheet_Calculate</code>. [Recommended]</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1540987186, "last_edit_date": 1540987186, "creation_date": 1540986284, "answer_id": 53082572, "question_id": 53081165, "link": "https://stackoverflow.com/questions/53081165/excel-vba-call-worksheet-change-from-another-worksheet/53082572#53082572", "title": "Excel vba: call Worksheet_change from another worksheet", "body": "<p>Calling the events in a worksheet is not different than calling any non-explicitly \"Private\" <code>Sub</code> or <code>Function</code> in any module or object. If they are not <code>Public</code> or <code>Friend</code>, they do not give their Functions, Subs and Properties being accessed without mentioning the place where they stay.</p>\n\n<p>If the events are non-modified with the key word <code>Private</code> before them, they could be called with this code:</p>\n\n<pre><code>Sub TestMe\n    Sheet1.Worksheet_Change Range(\"A1\")\nEnd Sub\n</code></pre>\n\n<p>If someone has explicitly added the word <code>Private</code> to start of the event, so it looks like this:</p>\n\n<p><code>Private Sub Worksheet_Change(ByVal Target As Range)</code>, then we should really consider not accessing the event. If still, we want to access it, it can be done with <code>Application.Run</code>.</p>\n\n<pre><code>Application.Run \"Sheet1.Worksheet_Change\", Sheet1.Range(\"A1\")\nApplication.Run CStr(Worksheets(1).CodeName &amp; \".Worksheet_Change\"), Range(\"A1\")\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4687, "favorite_count": 0, "accepted_answer_id": 53081306, "answer_count": 3, "score": 5, "last_activity_date": 1586416802, "creation_date": 1540981506, "last_edit_date": 1586416802, "question_id": 53081165, "link": "https://stackoverflow.com/questions/53081165/excel-vba-call-worksheet-change-from-another-worksheet", "title": "Excel vba: call Worksheet_change from another worksheet", "body": "<p>Suppose I have a workbook with two worksheets:</p>\n\n<p><code>Sheet1</code> and <code>Sheet2</code>.</p>\n\n<p>There is a <code>Worksheet_change</code> sub in <code>Sheet1</code>:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    ...\nEnd Sub\n</code></pre>\n\n<p>There is a <code>Worksheet_Calculate</code> in <code>Sheet2</code>:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    'Call Sheets(\"Sheet1\").Worksheet_Change(Range(\"A1\"))  'doesn't work\nEnd Sub\n</code></pre>\n\n<p>How do I call the <code>Sheet1</code>'a <code>Worksheet_Change</code> subroutine from <code>Worksheet_Calcalculate</code> in <code>Sheet2</code>?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1540978378, "post_id": 53080006, "comment_id": 93057660, "body": "What&#39;s the calculation in <code>W151</code>?  And this is done until all values in <code>Q149:Q182</code> are 2 and each calculated value has been pasted into <code>W99:W132</code>?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1540978829, "post_id": 53080006, "comment_id": 93057901, "body": "Your code is needlessly verbose and inefficient. For example, the first 4 lines of code could be replaced simply by <code>Range(&quot;S149:S182&quot;).Value = Range(&quot;Q149:Q182&quot;).Value</code>. You might benefit from reading <a href=\"https://stackoverflow.com/q/10714251/4996248\">How to avoid using Select in Excel VBA</a>"}, {"owner": {"reputation": 111, "user_id": 10584845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699641cdc53cfa2b2428dd4d5460212a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/10584845/thomas"}, "edited": false, "score": 0, "creation_date": 1540978989, "post_id": 53080006, "comment_id": 93057976, "body": "The calculation into W151 is massively complicated so I don&#39;t think I&#39;d be able to explain it properly but yes that&#39;s exactly it, I&#39;m changing the values in Q149:Q182 one by one to 2 and copying and pasting the output for every step in cells W99;W132"}, {"owner": {"reputation": 111, "user_id": 10584845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699641cdc53cfa2b2428dd4d5460212a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/10584845/thomas"}, "edited": false, "score": 0, "creation_date": 1540979064, "post_id": 53080006, "comment_id": 93058024, "body": "Hi John, thanks for the tip, will change it now"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1540979382, "post_id": 53080006, "comment_id": 93058187, "body": "Could you give us the formula you&#39;re using?  It might be massively complicated, but can read out of the formula what it&#39;s doing - someone on here might be able to speed it up or think of a better way of doing it."}, {"owner": {"reputation": 111, "user_id": 10584845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699641cdc53cfa2b2428dd4d5460212a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/10584845/thomas"}, "edited": false, "score": 0, "creation_date": 1540979738, "post_id": 53080006, "comment_id": 93058395, "body": "The actual formula itself is just a simple average of two cells =AVERAGE(C183:D183) but C183 and D183 a linked up to an entire model that can&#39;t be explained without sending you the excel (which I can&#39;t do)"}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1540979210, "post_id": 53080312, "comment_id": 93058110, "body": "That would copy the formula from <code>W151</code> as well.  The OP just needs the value - I&#39;m thinking either extend the formula down so it can be done in one hit, or pull all the values into a VBA array and perform the calculation there before putting it back on the sheet - mutliple copy/paste will be slowing the code down.  Depends on the calculation though."}, {"owner": {"reputation": 111, "user_id": 10584845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699641cdc53cfa2b2428dd4d5460212a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/10584845/thomas"}, "edited": false, "score": 0, "creation_date": 1540979655, "post_id": 53080312, "comment_id": 93058346, "body": "Ideally the array version would be best, I just don&#39;t know how to do it"}, {"owner": {"reputation": 111, "user_id": 10584845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699641cdc53cfa2b2428dd4d5460212a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/10584845/thomas"}, "edited": false, "score": 0, "creation_date": 1540980171, "post_id": 53080312, "comment_id": 93058638, "body": "If i could define Q149:Q182 as an array and then just cycle through each value in the array changing it to 2 and output the value of W151 into another array defined as W99:W132 that would be ideal"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1540979747, "last_edit_date": 1540979747, "creation_date": 1540978615, "answer_id": 53080312, "question_id": 53080006, "link": "https://stackoverflow.com/questions/53080006/vba-code-for-copying-and-pasting-a-value-from-a-specific-cell-that-is-changing-a/53080312#53080312", "title": "VBA code for copying and pasting a value from a specific cell that is changing as the macro runs", "body": "<p>@Thomas first of all welcome!</p>\n\n<p>Make the necessary changes (Sheet name or ranges) and try:</p>\n\n<pre><code>Sub Example()\n\n    With (Sheet1) '&lt;= Change Sheet Name if needed\n        .Range(\"S149:S182\").Copy .Range(\"Q149\")\n        .Range(\"W151\").Copy .Range(\"W99\")\n        .Range(\"W151\").Copy .Range(\"W100\")\n        .Range(\"W151\").Copy .Range(\"W101\")\n        .Range(\"Q149\").value=\"2\"\n        .Range(\"Q150\").value = \"2\"\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 10584845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699641cdc53cfa2b2428dd4d5460212a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/10584845/thomas"}, "edited": false, "score": 0, "creation_date": 1540979628, "post_id": 53080524, "comment_id": 93058332, "body": "Hi Imran, I tried that but the value being pasted in to W99 to W101 is the same (i.e. i think it&#39;s being overwritten and outputting the same W151 value into all three cells)"}], "tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": 0, "last_activity_date": 1540979325, "creation_date": 1540979325, "answer_id": 53080524, "question_id": 53080006, "link": "https://stackoverflow.com/questions/53080006/vba-code-for-copying-and-pasting-a-value-from-a-specific-cell-that-is-changing-a/53080524#53080524", "title": "VBA code for copying and pasting a value from a specific cell that is changing as the macro runs", "body": "<p>You have lot of unnecessary things in your code simply use inputbox to get the range and use it as required.</p>\n\n<pre><code>Sub Example()\n\nDim rng1 As Range\nDim rng2 As Range\nSet rng1 = Application.InputBox(\"Select range1\", Type:=8)\nSet rng2 = Application.InputBox(\"Select range2\", Type:=8)\n\nWith Sheets(\"Sheet1\")\n.Range(\"Q149:Q182\").Value = rng1.Value\n.Range(\"W99\").Value = rng2.Value\n.Range(\"Q149\").FormulaR1C1 = \"2\"\n.Range(\"W100\").Value = rng2.Value\n.Range(\"Q150\").FormulaR1C1 = \"2\"\n.Range(\"W101\").Value = rng2.Value\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1540982011, "post_id": 53081028, "comment_id": 93059657, "body": "Had a re-read of your question and updated the code to reflect what I didn&#39;t understand.  First average is pasted to W99, then the updated ones to W100 onwards."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1540982471, "post_id": 53081028, "comment_id": 93059918, "body": "You&#39;ve ticked this as accepted, but I&#39;ve noticed it doesn&#39;t actually answer the question you asked:  <i>My question is, is there a way of setting the cells that i&#39;m changing as an array (picked by the user through a prompt)</i>."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1540985338, "last_edit_date": 1540985338, "creation_date": 1540981017, "answer_id": 53081028, "question_id": 53080006, "link": "https://stackoverflow.com/questions/53080006/vba-code-for-copying-and-pasting-a-value-from-a-specific-cell-that-is-changing-a/53081028#53081028", "title": "VBA code for copying and pasting a value from a specific cell that is changing as the macro runs", "body": "<p>Not quite the way I was hoping to do it as this still relies on putting values on the worksheet.   </p>\n\n<p><del>There's one step missing that I didn't understand:  </del></p>\n\n<blockquote>\n  <p>Based on the base values for the formula, I copy and paste the value\n  outputted to W151 into W99  </p>\n</blockquote>\n\n<p>This is done before you turn the first value to 2.  So is it a case of the base average goes into <code>W99</code>, then you change the first value to 2 and that goes into <code>W100</code>.  i.e. If you start with 34 values in column Q you'll end with 35 values copied to column W?</p>\n\n<pre><code>Sub Test()\n\n    Dim CopyRng As Range\n    Dim rCell As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        Set CopyRng = .Range(\"Q149:Q182\")\n        CopyRng.Value = .Range(\"S149:S182\").Value\n\n        .Range(\"W99\").Value = .Range(\"W151\").Value\n        For Each rCell In CopyRng\n            rCell.Value = 2\n            'Q149 Offset by -49 rows and +6 columns = cell W100.\n            rCell.Offset(-49, 6).Value = .Range(\"W151\").Value\n        Next rCell\n\n    End With\n\nEnd Sub  \n</code></pre>\n\n<p><strong>Edit:</strong><br>\nTo ask the user to make the selections you could use the following method.<br>\nOne problem that hasn't been addressed in this code is if the user presses <a href=\"https://stackoverflow.com/questions/19609479/handle-cancellation-of-inputbox-to-select-range\">Cancel</a>, but hopefully the link will point you in the right direction - I liked the answer given by @DirkReichel.</p>\n\n<pre><code>Sub Test()\n\n    Dim CopyRng As Range\n    Dim rCalculation As Range\n    Dim rDestination As Range\n    Dim rCell As Range\n\n    'Creating the base values is a manual operation now.\n    'CopyRng.Value = Sheet1.Range(\"S149:S182\").Value\n\n    Set CopyRng = Application.InputBox(\"Select range to be evaluated.\", Type:=8) 'Q149:Q182\n\n    'Calculation must be a single cell.\n    Do\n        Set rCalculation = Application.InputBox(\"Select cell containing calculation.\", Type:=8) 'W151\n    Loop While rCalculation.Cells.Count &lt;&gt; 1\n\n    'First cell in destination must be a single cell.\n    Do\n        Set rDestination = Application.InputBox(\"Select first cell to be pasted to.\", Type:=8) 'W99\n    Loop While rDestination.Cells.Count &lt;&gt; 1\n\n    rDestination.Value = rCalculation.Value\n    For Each rCell In CopyRng\n        rCell.Value = 2\n\n        rDestination.Offset(rCell.Row - CopyRng.Row + 1).Value = rCalculation.Value\n    Next rCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 10584845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/699641cdc53cfa2b2428dd4d5460212a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/10584845/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 53081028, "answer_count": 3, "score": 0, "last_activity_date": 1586416838, "creation_date": 1540977619, "last_edit_date": 1586416838, "question_id": 53080006, "link": "https://stackoverflow.com/questions/53080006/vba-code-for-copying-and-pasting-a-value-from-a-specific-cell-that-is-changing-a", "title": "VBA code for copying and pasting a value from a specific cell that is changing as the macro runs", "body": "<p>I'll try (as best I can) to explain the code I'm using</p>\n\n<p>Essentially I have an excel which outputs a value to cell W151 based on a calculation that depends on cells in the range Q149:Q182. </p>\n\n<p>The first step is to reset all the values in the range Q149:Q182 to their base values by copying and pasting from cells S149:S182.</p>\n\n<p>Based on the base values for the formula, I copy and paste the value outputted to W151 into W99</p>\n\n<p>Next, I change the value in Q149 to \"2\". This updates the calculation and hence the value in cell W151 which I then copy and paste into W100</p>\n\n<p>Then I change Q150 to \"2\" and again copy the value from W151, this time into W101 and so on and so forth</p>\n\n<p>My question is, is there a way of setting the cells that i'm changing as an array (picked by the user through a prompt), the output cell W151 as a variable (picked by the user through a prompt) and the destination for the copied values (i.e. currently cells W99:W101) as an array also picked by the user via a prompt. If not is there any way you can think of that might automated this process?</p>\n\n<p>I appreciate that I might have done a poor job explaining what I'm trying to do so please feel free to ask for clarifications (although I warn you my VBA knowledge is very limited)</p>\n\n<p>Many Thanks,</p>\n\n<p>Thomas</p>\n\n<pre><code>Sub Example()\n\nRange(\"S149:S182\").Select\nSelection.Copy\nRange(\"Q149\").Select\nSelection.PasteSpecial Paste:=xlPasteValues\nRange(\"W151\").Select\nSelection.Copy\nRange(\"W99\").Select\nSelection.PasteSpecial Paste:=xlPasteValues\nRange(\"Q149\").Select\nActiveCell.FormulaR1C1 = \"2\"\nRange(\"W151\").Select\nSelection.Copy\nRange(\"W100\").Select\nSelection.PasteSpecial Paste:=xlPasteValues\nRange(\"Q150\").Select\nApplication.CutCopyMode = False\nActiveCell.FormulaR1C1 = \"2\"\nRange(\"W151\").Select\nSelection.Copy\nRange(\"W101\").Select\nSelection.PasteSpecial Paste:=xlPasteValues\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1540979736, "post_id": 53079935, "comment_id": 93058392, "body": "Look at the concept of Custom XML Parts (CustomXMLParts in the object model). Excel and PowerPoint have this, as well as Word BTW."}, {"owner": {"reputation": 3, "user_id": 10584928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/641c28c8ad62da205238786a8ebe1a7e?s=128&d=identicon&r=PG&f=1", "display_name": "Joey D", "link": "https://stackoverflow.com/users/10584928/joey-d"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1540980434, "post_id": 53079935, "comment_id": 93058778, "body": "Awesome! This&#39;ll probably solve my problem. Thanks"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1540986034, "post_id": 53079935, "comment_id": 93061794, "body": "OK, I&#39;ll write it up as an Answer..."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1540986263, "creation_date": 1540986263, "answer_id": 53082564, "question_id": 53079935, "link": "https://stackoverflow.com/questions/53079935/storing-data-in-a-word-file/53082564#53082564", "title": "Storing data in a word file", "body": "<p>Word has limited capability for storing data. Before the introduction of the Open XML file format with Word 2007 the only possibility was to use \"Document Variables\" - a way to save string information. While it is possible to store data in character-delimited format, this is not advisable for such large amounts of data.</p>\n\n<p>The Open XML file format introduced the concept of \"Custom XML Parts\" - XML files that can be stored within the ZIP file structure of an Office document. (Besides Word, Excel and PowerPoint also support Custom XML Parts). </p>\n\n<p>A Custom XML Part can be accessed via the object model (<code>CustomXMLPart</code>) using standard XML tools (<code>MSXML</code> parser, for example) of any programming language that can interact on the COM level. It's also possible to access a Custom XML Part through the <em>closed</em> Office document's Open XML using any programming language that can work with ZIP packages.</p>\n\n<p>A Custom XML Part is not visible to the user. In Word, only, the contents of a Custom XML Part can be linked (mapped) to content controls on the document surface. The content of a node will be displayed in the document; user edits will be written back to the XML and such mappings provide additional events on actions taken in content controls (validation, for example).</p>\n\n<p>Currently, this is the recommended method to \"embed\" data in an Office document.</p>\n"}], "owner": {"reputation": 3, "user_id": 10584928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/641c28c8ad62da205238786a8ebe1a7e?s=128&d=identicon&r=PG&f=1", "display_name": "Joey D", "link": "https://stackoverflow.com/users/10584928/joey-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 53082564, "answer_count": 1, "score": 0, "last_activity_date": 1540986263, "creation_date": 1540977385, "question_id": 53079935, "link": "https://stackoverflow.com/questions/53079935/storing-data-in-a-word-file", "title": "Storing data in a word file", "body": "<p>I have an Excel file, that has around 800 rows and a couple of columns of data.\nThe word file has three drop-downs. The first dropdown has the data of one column. The content of the second dropdown depends on the selected data in dropdown 1, and dropdown 3 depends on dropdown 2.</p>\n\n<p>I've already made a VBA script, that does this by reading from the excel file. My problem is, that I need to get rid of the excel file since I need to have the word file by itself.</p>\n\n<p>How can I store 800 rows of excel data into a word file without the user being able to see it, and so that I can use it in VBA code.</p>\n\n<p>I already looked into this:\n<a href=\"https://www.techwalla.com/articles/how-do-i-create-a-microsoft-word-database\" rel=\"nofollow noreferrer\">https://www.techwalla.com/articles/how-do-i-create-a-microsoft-word-database</a>\nBut this just generates another file, which isn't much different from just having an excel file.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31, "user_id": 10544010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f90d9cb09b1232efc211e06bc15d54c?s=128&d=identicon&r=PG&f=1", "display_name": "Kal", "link": "https://stackoverflow.com/users/10544010/kal"}, "edited": false, "score": 0, "creation_date": 1540977286, "post_id": 53079848, "comment_id": 93057070, "body": "rg and fd refers to defined ranges in sheet &quot;Marcopolo&quot;"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1540977306, "post_id": 53079848, "comment_id": 93057081, "body": "Does your range <b>rg</b> contain value that is in your cell d3 ?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1540977390, "post_id": 53079848, "comment_id": 93057120, "body": "I&#39;d guess your code is not in the Marcopolo sheet module. Use <code>Application.Range(&quot;rg&quot;)</code> and not just <code>Range(&quot;rg&quot;)</code>"}, {"owner": {"reputation": 31, "user_id": 10544010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f90d9cb09b1232efc211e06bc15d54c?s=128&d=identicon&r=PG&f=1", "display_name": "Kal", "link": "https://stackoverflow.com/users/10544010/kal"}, "edited": false, "score": 0, "creation_date": 1540977549, "post_id": 53079848, "comment_id": 93057204, "body": "rg and fd refers to defined ranges in sheet &quot;Marcopolo&quot;... rg has been assigned with ranges mentioned in worksheet &quot;Arrays&quot;"}, {"owner": {"reputation": 31, "user_id": 10544010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f90d9cb09b1232efc211e06bc15d54c?s=128&d=identicon&r=PG&f=1", "display_name": "Kal", "link": "https://stackoverflow.com/users/10544010/kal"}, "edited": false, "score": 0, "creation_date": 1540977732, "post_id": 53079848, "comment_id": 93057288, "body": "This code runs from the userform.combobox"}, {"owner": {"reputation": 31, "user_id": 10544010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f90d9cb09b1232efc211e06bc15d54c?s=128&d=identicon&r=PG&f=1", "display_name": "Kal", "link": "https://stackoverflow.com/users/10544010/kal"}, "edited": false, "score": 0, "creation_date": 1540977833, "post_id": 53079848, "comment_id": 93057338, "body": "D3 is a cell in Marcopolo holding name of the month to match with."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1540980356, "post_id": 53079848, "comment_id": 93058733, "body": "Clearly you do <i>not</i> have ranges actually named &quot;rg&quot; and &quot;fd&quot; or your code would work. I suggest you clarify your question."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1540980590, "post_id": 53079848, "comment_id": 93058861, "body": "Actually the question is clear enough - the error is because the &quot;rg&quot; is not a named range in Excel. If there is a need to refer to range from <code>Array()</code> in Excel, then this would better be a new question."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10544010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f90d9cb09b1232efc211e06bc15d54c?s=128&d=identicon&r=PG&f=1", "display_name": "Kal", "link": "https://stackoverflow.com/users/10544010/kal"}, "edited": false, "score": 0, "creation_date": 1540978043, "post_id": 53080025, "comment_id": 93057450, "body": "rg is an array holding 5 ranges mentioned in worksheet &quot;Arrays&quot; but these ranges exist in sheet Marcopolo. If you may notice Marcopolo is the active sheet therefore Range(d3) should not be the problem"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 31, "user_id": 10544010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f90d9cb09b1232efc211e06bc15d54c?s=128&d=identicon&r=PG&f=1", "display_name": "Kal", "link": "https://stackoverflow.com/users/10544010/kal"}, "edited": false, "score": 0, "creation_date": 1540978595, "post_id": 53080025, "comment_id": 93057781, "body": "@Kal - So, <code>rg</code> is an array, defined in VBA with the loop in your code? This is why it throws an error, the <code>.Range(&quot;Something&quot;)</code> expects a named range or Excel range. Not arrays."}, {"owner": {"reputation": 31, "user_id": 10544010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f90d9cb09b1232efc211e06bc15d54c?s=128&d=identicon&r=PG&f=1", "display_name": "Kal", "link": "https://stackoverflow.com/users/10544010/kal"}, "edited": false, "score": 0, "creation_date": 1540980156, "post_id": 53080025, "comment_id": 93058630, "body": "What i mean is that rg is the first dimension in the array arch_iv                            and rg holds 5 ranges"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 31, "user_id": 10544010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f90d9cb09b1232efc211e06bc15d54c?s=128&d=identicon&r=PG&f=1", "display_name": "Kal", "link": "https://stackoverflow.com/users/10544010/kal"}, "edited": false, "score": 0, "creation_date": 1540980460, "post_id": 53080025, "comment_id": 93058796, "body": "@Kal - This means exactly, that you cannot use it like this. You have to pass a string to <code>Range()</code> and this string should mean something to Excel. The first dimension of an array does not mean anything to Excel. Thus, <code>Range(&quot;rg&quot;)</code> is an error."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1540977698, "creation_date": 1540977698, "answer_id": 53080025, "question_id": 53079848, "link": "https://stackoverflow.com/questions/53079848/run-time-error-1004-method-range-of-object-global-failed-on-a-search-in-excel-wi/53080025#53080025", "title": "Run time error 1004 method range of object_global failed on a search in Excel with a named range", "body": "<p>The error comes, because the named range is not found.\nIf the named range <code>rg</code> should be on the \"Marcopolo\" worksheet, then it should be referred like this:</p>\n\n<pre><code>With Worksheets(\"Marcopolo\")\n    Set br = .Range(\"rg\").Find(Range(\"D3\"))\n    If br Is Nothing Then\n        MsgBox \"D3 NOT FOUND!\"\n        Exit Sub\n    End If\nend with\n</code></pre>\n\n<p>The above has another problem, because the parent of the <code>Range(\"D3\")</code> is not explicitly defined. Thus, it is either the <code>ActiveSheet</code> or the Worksheet, in which the code is residing. To avoid this problem, consider defining it like this <code>Worksheets(\"SomeName\").Range(\"D3\")</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 10544010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f90d9cb09b1232efc211e06bc15d54c?s=128&d=identicon&r=PG&f=1", "display_name": "Kal", "link": "https://stackoverflow.com/users/10544010/kal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1540977880, "creation_date": 1540977090, "last_edit_date": 1540977880, "question_id": 53079848, "link": "https://stackoverflow.com/questions/53079848/run-time-error-1004-method-range-of-object-global-failed-on-a-search-in-excel-wi", "title": "Run time error 1004 method range of object_global failed on a search in Excel with a named range", "body": "<p>I am getting error:</p>\n\n<blockquote>\n  <p>Run time error 1004 method range of object_global failed</p>\n</blockquote>\n\n<p>in the following code line:</p>\n\n<p><code>Set br = Range(\"rg\").Find(Range(\"$d$3\").Value)</code></p>\n\n<p>Following is the complete code:</p>\n\n<pre><code>Private Sub ComboBox1_Change()\nDim y As String\nDim q As Variant\nDim j As Double\nDim i As Variant\nDim k As Variant\nDim l As Double\nDim qst As Variant\nDim br As Range\nDim bra As Variant\n\nqst = MsgBox(\"Entire data will be removed &amp; archived\" &amp; vbNewLine &amp; \"Are you sure you want to proceed?\", vbYesNo, fnb)\nIf qst = vbYes Then\nWorksheets(\"Marcopolo\").Unprotect myp\nWorksheets(\"Marcopolo\").Activate\n\nDim arch_iv(1 To 5, 1 To 2) As Variant\n\nDim rg As Variant\nDim fd As Variant\n\nFor rg = 1 To 5\n    For fd = 1 To 2\n        arch_iv(rg, fd) = Worksheets(\"arrays\").Cells(rg, fd).Value\n    Next fd\nNext rg\n\n\nFor rg = 1 To 5\n    For fd = 1 To 2\n        Set br = Range(\"rg\").Find(Range(\"$d$3\").Value)\n            br.Select\n                br.Offset(0, 2).Select\n                  bra = ActiveCell.Address\n                MsgBox bra\n            Range(\"fd\").Copy\n        Worksheets(\"marcopolo\").Range(bra).PasteSpecial Paste:=xlPasteValues\n    Next fd\nNext rg\n\nElse\nGoTo Gtout\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop", "search"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540977308, "post_id": 53079733, "comment_id": 93057082, "body": "Why are you doing this: Set Range1 = Sheets(&quot;X&quot;).Range(&quot;A2:BT72&quot;).Columns(SetColumn).Cells  ? Does SetColumn vary? Also, use Long not Integer to avoid potential overflow."}, {"owner": {"reputation": 37, "user_id": 10451617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7285fe17456b3be2ac20711c813c17d2?s=128&d=identicon&r=PG&f=1", "display_name": "user10451617", "link": "https://stackoverflow.com/users/10451617/user10451617"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540977983, "post_id": 53079733, "comment_id": 93057415, "body": "Thanks for the advice, yes the setcolumn does vary based on the problem"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1540977068, "creation_date": 1540977068, "answer_id": 53079838, "question_id": 53079733, "link": "https://stackoverflow.com/questions/53079733/find-all-values-in-a-range-that-fit-a-certain-criteria-and-return-each-row-vba/53079838#53079838", "title": "Find all values in a range that fit a certain criteria and return each row VBA", "body": "<p>This is a minimal example, returning the rows of the Range <code>A1:A30</code>, which are with <code>X</code> in them:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim rowValues As String\n    Dim myCell As Range\n\n    For Each myCell In Worksheets(1).Range(\"A1:A30\")\n        If myCell = \"X\" Then\n            rowValues = Trim(rowValues &amp; \" \" &amp; myCell.Row)\n        End If\n    Next myCell\n\n    Debug.Print rowValues\n\nEnd Sub\n</code></pre>\n\n<p>The return is dones through concatenation here: <code>rowValues = Trim(rowValues &amp; \" \" &amp; myCell.Row)</code>, the <code>Trim()</code> is needed to reduce the first <code>\" \"</code> on the first concatenation.</p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 10451617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7285fe17456b3be2ac20711c813c17d2?s=128&d=identicon&r=PG&f=1", "display_name": "user10451617", "link": "https://stackoverflow.com/users/10451617/user10451617"}, "edited": false, "score": 0, "creation_date": 1540983656, "post_id": 53080976, "comment_id": 93060551, "body": "Thanks QHarr that&#39;s worked great! My next step is to search those rows and find 2 values on 2 known columns. Have you any advice on that?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 37, "user_id": 10451617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7285fe17456b3be2ac20711c813c17d2?s=128&d=identicon&r=PG&f=1", "display_name": "user10451617", "link": "https://stackoverflow.com/users/10451617/user10451617"}, "edited": false, "score": 0, "creation_date": 1540983708, "post_id": 53080976, "comment_id": 93060571, "body": "Use Find method of range."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1540980856, "creation_date": 1540980856, "answer_id": 53080976, "question_id": 53079733, "link": "https://stackoverflow.com/questions/53079733/find-all-values-in-a-range-that-fit-a-certain-criteria-and-return-each-row-vba/53080976#53080976", "title": "Find all values in a range that fit a certain criteria and return each row VBA", "body": "<p>You could read the range into an array, loop the array and concatenate qualifying rows into a string. I use the fact you start from row 2, and that I am using a 1 based array to determine the row i.e. I add 1 to the value of i which is the index in the array where the qualifying value is.</p>\n\n<p>You could also use</p>\n\n<pre><code>required = required &amp; \",\" &amp; i + ws.Range(\"A2:BT72\").Row - LBound(arr)\n</code></pre>\n\n<p>VBA:</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim criteria1 As Single, criteria2 As Single, required As String\n    Dim arr(), ws As Worksheet, setColumn As Long, i As Long\n\n    Set ws = ThisWorkbook.Worksheets(\"X\")\n    setColumn = 24\n    arr = Application.Transpose(ws.Range(\"A2:BT72\").Columns(setColumn).Value)\n\n    criteria1 = ws.Range(\"P111\").Value\n    criteria2 = ws.Range(\"Q111\").Value\n\n    For i = LBound(arr) To UBound(arr)\n        If arr(i) &lt; criteria1 And arr(i) &gt; criteria2 Then\n            required = required &amp; \",\" &amp; i + 1\n        End If\n    Next\n\n    required = Replace$(required, \",\", vbNullString, 1, 1)\n\n    Debug.Print required\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 10451617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7285fe17456b3be2ac20711c813c17d2?s=128&d=identicon&r=PG&f=1", "display_name": "user10451617", "link": "https://stackoverflow.com/users/10451617/user10451617"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 1, "accepted_answer_id": 53080976, "answer_count": 2, "score": 3, "last_activity_date": 1540980856, "creation_date": 1540976717, "last_edit_date": 1540977175, "question_id": 53079733, "link": "https://stackoverflow.com/questions/53079733/find-all-values-in-a-range-that-fit-a-certain-criteria-and-return-each-row-vba", "title": "Find all values in a range that fit a certain criteria and return each row VBA", "body": "<p>I'm looking for some code to search through a range and return the row number of each cell in that range that fits a certain criteria and list those rows.</p>\n\n<p>Previously I have only been requiring the first value so have been using the code:</p>\n\n<pre><code>Dim Criteria1 As Single\nDim Criteria2 As Single\nDim Required As Integer\nDim Range1 As Range\nDim GearNeg1 As Integer\n\nSetColumn = 24\nSet Range1 = Sheets(\"X\").Range(\"A2:BT72\").Columns(SetColumn).Cells\nCriteria1 = Sheets(\"X\").Range(\"P111\").Value\nCriteria2 = Sheets(\"X\").Range(\"Q111\").Value\n\nFor Each Cell In Range1\n\n    If Cell.Value &lt; Criteria1 And Cell.Value &gt; Criteria2 Then\n\n        Required = Cell.row\n\n        Exit For\n\n    End If\nNext\n</code></pre>\n\n<p>I've been playing around with adding a for loop to return all the row values for the values that meet the criteria to a list. However am struggling and can only seem to hit the first value found every time.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1540994247, "post_id": 53081580, "comment_id": 93066987, "body": "Hi Error 1004, the macro doesn&#39;t exactly do what I want it to do. At first when the value is found, the values get pasted but when I select one of them I see a link to the other file. It just needs to be pasted as values in stead of keeping a link.  The other thing I see is that if the value isn&#39;t found, the line is pasted beneath the last row but I want it to past it in row 2 in stead of the last. I&#39;ll see if I can change it myself. Thanks for your quick help!!"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1540996095, "post_id": 53081580, "comment_id": 93068224, "body": "@MischaUrlings i fix the part to add new lines in row 2 but i dont find any issues with link!"}, {"owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1540996983, "post_id": 53081580, "comment_id": 93068809, "body": "The data that is copied contains a link to another sheet of the same file. Example: A2 = &#39;Sheet!$C$6. I don&#39;t want this link to be copied but only the value. The insert row you added works perfectly!"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1540997912, "post_id": 53081580, "comment_id": 93069477, "body": "@MischaUrlings glad to hear that the addition works perfectly.i review the code, check my testing documents but i dont find any links on then.Try to clean you sheets (by selectin whole sheets and delete, remove links and clear contents) Please try to investigate with debugging and if you need farther assistant let me know."}, {"owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1540998169, "post_id": 53081580, "comment_id": 93069649, "body": "It isn&#39;t your fault or something but the problem is in my document. I think the type of copy you use in the macro copy&#39;s the value + formula behind the cells. Maybe it&#39;s possible to write entirerow.copy.value or something like that?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1541002047, "post_id": 53081580, "comment_id": 93072302, "body": "I m out of office now i ll check it tomorrow"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1541058538, "post_id": 53081580, "comment_id": 93090236, "body": "@MischaUrlings also copy paste only values solved!see reviewed code!"}, {"owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1541060234, "post_id": 53081580, "comment_id": 93090833, "body": "works perfect, thank you very much! Could you have a look at my other post yesterday? Maybe you know a solution to it."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1541060394, "post_id": 53081580, "comment_id": 93090882, "body": "@MischaUrlings mention (write &quot;@Error 1004&quot; without &quot; &quot; as a comment) me at the post so i can look at it."}, {"owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1541078592, "post_id": 53081580, "comment_id": 93099866, "body": "did you see my other question?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1541078775, "post_id": 53081580, "comment_id": 93099970, "body": "@Mischa Urlings tag me or send the link"}, {"owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1541081678, "post_id": 53081580, "comment_id": 93101490, "body": "<a href=\"https://stackoverflow.com/questions/53084488/excel-vba-pastespecial-xladd-loop/53085248?noredirect=1#comment93094052_53085248\" title=\"excel vba pastespecial xladd loop\">stackoverflow.com/questions/53084488/&hellip;</a>"}, {"owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1541154404, "post_id": 53081580, "comment_id": 93127904, "body": "Did you have a look at it?"}, {"owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1541671941, "post_id": 53081580, "comment_id": 93299227, "body": "Could you have a look at my new post? <a href=\"https://stackoverflow.com/questions/53205534/excel-vba-if-2-criteria-then-else-function\" title=\"excel vba if 2 criteria then else function\">stackoverflow.com/questions/53205534/&hellip;</a>"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1541058502, "last_edit_date": 1541058502, "creation_date": 1540982925, "answer_id": 53081580, "question_id": 53079621, "link": "https://stackoverflow.com/questions/53079621/excel-vba-if-value-is-in-column-then/53081580#53081580", "title": "Excel vba if value is in column then", "body": "<p>@Mischa Urlings for this example i have save both workbooks (\"orderregistratie\" + \"werkorder template\") on my desktop so you must change their path on the code.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim WbO As Workbook\n    Dim WbW As Workbook\n\n    Dim i As Long\n    Dim LRA As Long\n    Dim RowToCopy As Long\n    Dim Rowstr As Long\n\n    Dim Searchstr As String\n    Dim Address As Range\n    Dim Searchrng As Range\n\n    Workbooks.Open Filename:=\"C:\\Users\\xxxx\\Desktop\\\" &amp; \"orderregistratie.xlsx\" '&lt;= Open Workbooks (for this example files are stored on desktop\n    Workbooks.Open Filename:=\"C:\\Users\\xxxx\\Desktop\\\" &amp; \"werkorder template.xlsx\"\n\n    Set WbO = Workbooks(\"orderregistratie.xlsx\") '&lt;= Set workbook to variables\n    Set WbW = Workbooks(\"werkorder template.xlsx\")\n\n    LRA = WbW.Worksheets(\"export datablad\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row '&lt;= Find Lastrow\n\n    For i = 2 To LRA '&lt;= Loop column A (Workbook:werkorder template)\n        Searchstr = WbW.Worksheets(\"export datablad\").Range(\"A\" &amp; i).Value '&lt;= Set what to search for\n        Rowstr = i '&lt;= Searchstr row\n        Set Searchrng = WbO.Worksheets(\"datablad\").Columns(\"A\") '&lt;= Set where to search for\n\n        Set Address = Searchrng.Find(What:=Searchstr, LookAt:=xlWhole) '&lt;= Result of the search\n\n    If Address Is Nothing Then\n        'If what we search for not found\n        WbO.Worksheets(\"datablad\").Rows(\"2\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        WbW.Worksheets(\"export datablad\").Rows(Rowstr).EntireRow.Copy\n        WbO.Worksheets(\"datablad\").Rows(2).PasteSpecial Paste:=xlPasteValues\n    Else\n        'If what we search for found\n        RowToCopy = Address.Row '&lt;= Where we find the Searchstr\n        WbW.Worksheets(\"export datablad\").Rows(i).EntireRow.Copy\n        WbO.Worksheets(\"datablad\").Rows(RowToCopy).PasteSpecial Paste:=xlPasteValues\n    End If\n\n\n\n    Next i\n\n    With WbO\n       .Save\n       .Close '&lt;= Close open workbooks\n    End with\n    With WbW  \n       .Save\n       .Close '&lt;= Close open workbooks\n    End with \n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10369033, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jKKORKV74hM/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOj3Nj99gtiV8a5Zi_Yhi5pg7lakw/mo/photo.jpg?sz=128", "display_name": "Greg Esparsen", "link": "https://stackoverflow.com/users/10369033/greg-esparsen"}, "is_accepted": false, "score": 2, "last_activity_date": 1541050288, "creation_date": 1541050288, "answer_id": 53095657, "question_id": 53079621, "link": "https://stackoverflow.com/questions/53079621/excel-vba-if-value-is-in-column-then/53095657#53095657", "title": "Excel vba if value is in column then", "body": "<p>Give this a try. I'll adjust as needed. Just be double check if both workbooks are saved to your desktop.</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Option Explicit\n\nPrivate wkbOrderReg     As Workbook, _\n        wkbOrderWork    As Workbook, _\n        wkb             As Workbook\n\nPrivate wsOBJ           As Worksheet, _\n        ws              As Worksheet\n\nPrivate rngSearch       As Range, _\n        rngRow          As Range, _\n        rng             As Range, _\n        r               As Range\n\nPrivate strSearch       As String\n\nPublic Sub DarudeSandStorm()\n    Dim LastRow     As Long, _\n        LastColumn  As Long\n    Dim arr         As Variant\n    With Application.Workbooks\n        Set wkbOrderReg = .Open(Filename:=strVar(\"orderregistratie.xlsx\"))\n        Set wkbOrderWork = .Open(Filename:=strVar(\"werkorder template.xlsx\"))\n    End With\n    With wkbOrderWork\n        For Each ws In .Worksheets\n            Set wsOBJ = ws\n            If UCase$(wsOBJ.Name) = UCase$(\"export datablad\") Then\n                    With wsOBJ\n                    Set rng = .Range(.Cells(2, 1), .Cells(2, 1))\n                        strSearch = rng.Value\n                        LastColumn = getLAST_COLUMN(wsOBJ)\n                    Set rngRow = .Range(.Cells(2, 1), .Cells(2, LastColumn))\n                    End With\n                        arr = rngRow\n                Exit For\n            End If\n        Next ws\n    End With\n    With wkbOrderReg\n        For Each ws In .Worksheets\n            Set wsOBJ = ws\n            If UCase$(wsOBJ.Name) = UCase$(\"export datablad\") Then\n                With wsOBJ\n                    LastRow = getLAST_ROW(wsOBJ)\n                Set rngSearch = .Range(.Cells(1, 1), .Cells(LastRow, 1))\n                End With\n                For Each r In rngSearch\n                    If UCase$(r.Value) = UCase$(strSearch) Then\n                        r = arr\n                    End If\n                Next r\n            End If\n        Next ws\n    End With\n    With Application\n        For Each wkb In .Workbooks\n            If Not wkb = .ThisWorkbook Then\n                With .Workbooks(wkb.Name)\n                    .Save\n                    .Close\n                End With\n            End If\n        Next wkb\n    End With\nEnd Sub\n\nPrivate Function getLAST_COLUMN(objWS As Worksheet) As Long\n    Dim wsDES               As Worksheet, _\n        wkbSUB              As Workbook, _\n        rngCHECK            As Range\n    Set rngCHECK = objWS.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookIn:=xlFormulas, _\n                    LookAt:=xlPart, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=False, _\n                    SearchFormat:=False)\n    If Not rngCHECK Is Nothing Then\n        getLAST_COLUMN = objWS.Cells.Find(\"*\", _\n                    Range(\"A1\"), _\n                    xlFormulas, _\n                    , _\n                    xlByColumns, _\n                    xlPrevious).Column\n    Else\n        getLAST_COLUMN = 1\n    End If\nEnd Function\n\nPrivate Function getLAST_ROW(objWS As Worksheet) As Long\n    Dim wsDES               As Worksheet, _\n        wkbSUB              As Workbook, _\n        rngCHECK            As Range\n    Set rngCHECK = objWS.Cells.Find(What:=\"*\", _\n                    After:=Range(\"A1\"), _\n                    LookIn:=xlFormulas, _\n                    LookAt:=xlPart, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=False, _\n                    SearchFormat:=False)\n    If Not rngCHECK Is Nothing Then\n        getLAST_ROW = objWS.Cells.Find(\"*\", _\n                    Range(\"A1\"), _\n                    xlFormulas, _\n                    , _\n                    xlByRows, _\n                    xlPrevious).Row\n    Else\n        getLAST_ROW = 1\n    End If\nEnd Function\n\nPrivate Function strVar(ByRef str As String) As String\n    strVar = Environ(\"Userprofile\") &amp; \"\\Desktop\\\" &amp; str\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1077, "favorite_count": 0, "closed_date": 1542074973, "accepted_answer_id": 53081580, "answer_count": 2, "score": 0, "last_activity_date": 1586416874, "creation_date": 1540976243, "last_edit_date": 1586416874, "question_id": 53079621, "link": "https://stackoverflow.com/questions/53079621/excel-vba-if-value-is-in-column-then", "closed_reason": "Needs more focus", "title": "Excel vba if value is in column then", "body": "<p>I want to make a macro via an if then else function (maybe make use of a loop).</p>\n\n<p>I have two separate files, named \"orderregistratie\" + \"werkorder template\".\nI want to search in column A of sheets(\"datablad\") in orderregistratie for the value sheets(\"export datablad\").Range(\"A2\") that is in werkorder template.</p>\n\n<p>If this value exists in column A then copy the row of A2 from export datablad and paste it in the row where the value is found.\nIf it doesn't already exist I want to insert a new row at A2 in orderregistratie and copy the row of A2 from export datablad in the new row.</p>\n\n<p>My VBA knowledge is not really good and I can't write the macro by myself. Is there anyone who can help me write it?</p>\n"}, {"tags": ["vba", "ms-word", "office365", "ms-office"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1540976831, "post_id": 53079603, "comment_id": 93056824, "body": "If Section A is Pages 1 to 3 you want section C to start with Page 4 irrespective of how many pages there are in Section B.  Is that correct."}, {"owner": {"reputation": 788, "user_id": 6292000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-XtntRT-4Cak/AAAAAAAAAAI/AAAAAAAAAIo/RWKdBeTTi1Q/photo.jpg?sz=128", "display_name": "Lucubrator", "link": "https://stackoverflow.com/users/6292000/lucubrator"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1540980583, "post_id": 53079603, "comment_id": 93058859, "body": "Yes, @Freeflow, that is correct. I will edit the question to make that explicit."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1540988149, "post_id": 53079603, "comment_id": 93062944, "body": "Will you ever need the page numbers to appear in a TOC or other cross reference."}, {"owner": {"reputation": 788, "user_id": 6292000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-XtntRT-4Cak/AAAAAAAAAAI/AAAAAAAAAIo/RWKdBeTTi1Q/photo.jpg?sz=128", "display_name": "Lucubrator", "link": "https://stackoverflow.com/users/6292000/lucubrator"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1540988664, "post_id": 53079603, "comment_id": 93063224, "body": "I am going to say <i>yes</i>, but feel free to share a cross reference-free-Word-doc solution if you have one."}, {"owner": {"reputation": 788, "user_id": 6292000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-XtntRT-4Cak/AAAAAAAAAAI/AAAAAAAAAIo/RWKdBeTTi1Q/photo.jpg?sz=128", "display_name": "Lucubrator", "link": "https://stackoverflow.com/users/6292000/lucubrator"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1540988685, "post_id": 53079603, "comment_id": 93063239, "body": "Note: This question came up when I was writing a thesis, a thesis which is now already submitted. I don&#39;t <i>need</i> anything, I am simply curious about all of this. It also feels like something people may have a use for in the future (including myself)."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1540990585, "post_id": 53079603, "comment_id": 93064328, "body": "Its likely that you would need to implement a VBA solution.  The only non VBA solution I can come up with produces a mismatch between the number on the page and that in the toc or cross reference.    The non VBA partial solution involves putting a bookmark on the last page of a section and then using a formula to add the page reference of the bookmark to the current page number which is restarted at 1.  You end up with a formula field   {={pageref EnOfSectionBookmark} + {Page}}"}], "answers": [{"comments": [{"owner": {"reputation": 788, "user_id": 6292000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-XtntRT-4Cak/AAAAAAAAAAI/AAAAAAAAAIo/RWKdBeTTi1Q/photo.jpg?sz=128", "display_name": "Lucubrator", "link": "https://stackoverflow.com/users/6292000/lucubrator"}, "edited": false, "score": 0, "creation_date": 1541075906, "post_id": 53098093, "comment_id": 93098250, "body": "Bruce, this is not really an answer to my question. Please explain why you are giving these instructions on <i>page number cross-references</i>. I.e. how are those instructions relevant to my question? I think user @freeflow did a good job at doing that. If you want, maybe give him credit, and make your contribution into a proper answer. I think a VBA solution is what I am looking for, however. Nevertheless, for those with no need for a TOC, instructions on page number cross-references and Field Codes may be helpful."}], "tags": [], "owner": {"reputation": 164, "user_id": 10184585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c63a1c236c7ce5e1e261b113e05fe7a?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/10184585/bruce"}, "is_accepted": false, "score": 0, "last_activity_date": 1541063258, "creation_date": 1541063258, "answer_id": 53098093, "question_id": 53079603, "link": "https://stackoverflow.com/questions/53079603/continue-page-numbering-from-a-specific-section-in-ms-word/53098093#53098093", "title": "Continue page numbering from a specific section in MS Word?", "body": "<p>To insert a page number cross-reference, follow these steps:</p>\n\n<ol>\n<li>Insert a bookmark on the page containing the information you want to cross-reference.</li>\n<li>Position the insertion point where you want the cross-reference to occur.</li>\n<li>Press Ctrl+F9 to insert field brackets. Make sure the insertion point stays between the brackets.</li>\n<li>Type pageref followed by the bookmark name used in step 1.</li>\n<li>Press F9 to update the field information.</li>\n</ol>\n\n<p>Please refer to the following link:</p>\n\n<p><a href=\"https://word.tips.net/T000957_Inserting_Page_Number_Cross-References.html\" rel=\"nofollow noreferrer\">Inserting Page Number Cross-References</a></p>\n\n<p><a href=\"https://word.tips.net/T000141_Controlling_the_Format_of_Cross-References.html\" rel=\"nofollow noreferrer\">Controlling the Format of Cross-References</a></p>\n"}], "owner": {"reputation": 788, "user_id": 6292000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-XtntRT-4Cak/AAAAAAAAAAI/AAAAAAAAAIo/RWKdBeTTi1Q/photo.jpg?sz=128", "display_name": "Lucubrator", "link": "https://stackoverflow.com/users/6292000/lucubrator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 713, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1584486264, "creation_date": 1540976176, "last_edit_date": 1584486264, "question_id": 53079603, "link": "https://stackoverflow.com/questions/53079603/continue-page-numbering-from-a-specific-section-in-ms-word", "title": "Continue page numbering from a specific section in MS Word?", "body": "<p>How does one continue the page numbering from a <em>specific section</em> in MS Word?</p>\n\n<p>Consider the following scenario:</p>\n\n<blockquote>\n  <ul>\n  <li><p>MS Word document with 3 sections A, B, and C.</p></li>\n  <li><p>Page numbering starts at <code>1</code> on the first page of section A (ends at, let's say, <code>3</code>, on page 3).</p></li>\n  <li><p>No page numbering (or alternate page numbering) in section B.</p></li>\n  <li><p>In section C, page numbering continues from that of section A (first page-number of section C is <code>&lt;last_page_A&gt; + 1 = 4</code>). </p></li>\n  </ul>\n  \n  <p>Now let the number pages in section A, B, and C vary and the page numbering\n  to automatically adapt. The document has a Table of Contents whi</p>\n</blockquote>\n\n<p>Is this possible using the MS Word GUI through some trickery I am not aware of? If not, how could one do this with MS Office Field Codes or VBA?</p>\n\n<p>To my knowledge, the MS Word GUI only lets you continue page numbering from the previous section, or alternatively, lets you manually handle the page numberings:</p>\n\n<p><a href=\"https://i.stack.imgur.com/00EKT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/00EKT.png\" alt=\"The figure above shows the &quot;Format Page Numbers&quot; child window in MS Word (quickly accessible by right-clicking a &lt;code&gt;PAGE&lt;/code&gt; Field).\"></a></p>\n"}, {"tags": ["excel", "vba", "ribbon", "ribbon-control"], "comments": [{"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1540976801, "post_id": 53079520, "comment_id": 93056812, "body": "Try adding this  line <b>Application.CommandBars(&quot;Standard&quot;).Visible = True</b> in your close module."}, {"owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "reply_to_user": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1540976962, "post_id": 53079520, "comment_id": 93056895, "body": "@ImranMalek do i remove the Application.CommandBars.ExecuteMso &quot;hideRibbon&quot; lines?"}, {"owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "reply_to_user": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1540977120, "post_id": 53079520, "comment_id": 93056988, "body": "@ImranMalek this doesn&#39;t work still get the white bar :&#39;( when opening a new file"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "edited": false, "score": 0, "creation_date": 1540977301, "post_id": 53079861, "comment_id": 93057079, "body": "Doesn&#39;t work for me i&#39;ve added a picture to main question showing what my ribbion looks like in a new file and I cannot get vba to revert this back :("}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "reply_to_user": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "edited": false, "score": 0, "creation_date": 1540977434, "post_id": 53079861, "comment_id": 93057148, "body": "Remove Application.CommandBars.ExecuteMso &quot;hideRibbon&quot; this line from open as well !"}, {"owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "edited": false, "score": 0, "creation_date": 1540977979, "post_id": 53079861, "comment_id": 93057411, "body": "Yeah done that still don&#39;t work, but open opening the file i want it to be hidden to stop the users from editing the file (most don&#39;t know how to turn it off manually so I need a macro to turn it off when i close the file"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "reply_to_user": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "edited": false, "score": 0, "creation_date": 1540978175, "post_id": 53079861, "comment_id": 93057545, "body": "See the code in my answer if you have it like that then save the file and manually unhide the menubar and close and reopen your excel, now if you run the code again it will work."}, {"owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "edited": false, "score": 0, "creation_date": 1540978336, "post_id": 53079861, "comment_id": 93057634, "body": "Im trying to avoid the manual aspect, as I will be giving this forms to others to use and they do not know how to manual do this. This will keep the latest view if I do what you&#39;ve written but I would like the default view to return when closing."}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "reply_to_user": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "edited": false, "score": 0, "creation_date": 1540978519, "post_id": 53079861, "comment_id": 93057740, "body": "You only have to do this once manually as you had hidden the ribbon with Application.CommandBars.ExecuteMso &quot;hideRibbon&quot; . Once you do it manually and execute the code in the answer again it shall work."}, {"owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "edited": false, "score": 0, "creation_date": 1540978603, "post_id": 53079861, "comment_id": 93057789, "body": "i&#39;ve tried to open this, then open another file after closing it and it goes back to the hidden view, only works if i manual do it each time i&#39;ve copied the code exactly as you&#39;ve got it"}], "tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": 1, "last_activity_date": 1540978045, "last_edit_date": 1540978045, "creation_date": 1540977140, "answer_id": 53079861, "question_id": 53079520, "link": "https://stackoverflow.com/questions/53079520/how-to-display-tabs-and-ribbons-when-closing-excel/53079861#53079861", "title": "How to display tabs and ribbons when closing Excel?", "body": "<p>Try this </p>\n\n<pre><code>Private Sub Workbook_Open()\nActiveWindow.DisplayGridlines = False\nActiveWindow.DisplayHeadings = False\nApplication.DisplayFormulaBar = False\nApplication.DisplayFullScreen = True\nEnd Sub\n\nSub test()\nApplication.DisplayFullScreen = False\nActiveWindow.DisplayGridlines = True\nActiveWindow.DisplayHeadings = True\nApplication.DisplayFormulaBar = True\nApplication.CommandBars(\"Standard\").Visible = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 4, "last_activity_date": 1540980193, "creation_date": 1540980193, "answer_id": 53080774, "question_id": 53079520, "link": "https://stackoverflow.com/questions/53079520/how-to-display-tabs-and-ribbons-when-closing-excel/53080774#53080774", "title": "How to display tabs and ribbons when closing Excel?", "body": "<p>This displays the ribbon:</p>\n\n<p><code>Application.ExecuteExcel4Macro \"show.toolbar(\"\"Ribbon\"\", True)\"</code></p>\n\n<p>This hides the ribbon:</p>\n\n<p><code>Application.ExecuteExcel4Macro \"show.toolbar(\"\"Ribbon\"\", False)\"</code></p>\n"}], "owner": {"reputation": 173, "user_id": 10154265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009d1d405247320178d45bbc2fd0ac7e?s=128&d=identicon&r=PG&f=1", "display_name": "PGD15", "link": "https://stackoverflow.com/users/10154265/pgd15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 947, "favorite_count": 0, "accepted_answer_id": 53080774, "answer_count": 2, "score": 3, "last_activity_date": 1586416910, "creation_date": 1540975934, "last_edit_date": 1586416910, "question_id": 53079520, "link": "https://stackoverflow.com/questions/53079520/how-to-display-tabs-and-ribbons-when-closing-excel", "title": "How to display tabs and ribbons when closing Excel?", "body": "<p>I've got a macro which auto hides ribbons when this excel file opens however, when I close the file I would like these to reappear so when using other files this means I won't have to format them each time. </p>\n\n<p><a href=\"https://i.stack.imgur.com/f7iEA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f7iEA.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I've written the below code for when excel opens/closes. But cannot get the ribbons to reappear without manually clicking.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nApplication.CommandBars.ExecuteMso \"HideRibbon\"\nActiveWindow.DisplayGridlines = False\n\nActiveWindow.DisplayHeadings = False\n\nApplication.DisplayFormulaBar = False\n\nApplication.DisplayFullScreen = True\nEnd Sub\n\n\nSub Auto_close()\nApplication.CommandBars.ExecuteMso \"hideRibbon\"\nApplication.CommandBars.ExecuteMso \"hideRibbon\"\n\nActiveWindow.DisplayGridlines = True\n\nActiveWindow.DisplayHeadings = True\n\nApplication.DisplayFormulaBar = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1540974815, "post_id": 53079052, "comment_id": 93055716, "body": "Can you make sure the body format property is set to <code>olFormatHTML</code>? If it&#39;s set to <code>olFormatRichText</code>, <code>MailOutLook.HTMLBody = MailOutLook.HTMLBody</code> takes the mail HTML, converts it to RTF, and then converts it back to HTML because Outlook always uses HTML internally. That could explain your issue."}, {"owner": {"reputation": 2097, "user_id": 878700, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Hse3C.png?s=128&g=1", "display_name": "tbeernot", "link": "https://stackoverflow.com/users/878700/tbeernot"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1540975138, "post_id": 53079052, "comment_id": 93055867, "body": "It is, printed it out: MailOutLook.BodyFormat=2"}, {"owner": {"reputation": 2097, "user_id": 878700, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Hse3C.png?s=128&g=1", "display_name": "tbeernot", "link": "https://stackoverflow.com/users/878700/tbeernot"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1540975192, "post_id": 53079052, "comment_id": 93055898, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.olbodyformat\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/outlook.olbodyformat</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2097, "user_id": 878700, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Hse3C.png?s=128&g=1", "display_name": "tbeernot", "link": "https://stackoverflow.com/users/878700/tbeernot"}, "is_accepted": true, "score": 0, "last_activity_date": 1541588848, "creation_date": 1541588848, "answer_id": 53188271, "question_id": 53079052, "link": "https://stackoverflow.com/questions/53079052/assigning-mailitem-htmlbody-make-images-of-lesser-quality/53188271#53188271", "title": "Assigning MailItem.HTMLBody make images of lesser quality", "body": "<p>It turned out that the image-problem was caused by a poorly defined signature HTML (a.o. the img had no height and width attributes). That may explain why Outlook feels the need to modify the HTML, but IMHO it should not touch what I tell it to render.</p>\n"}], "owner": {"reputation": 2097, "user_id": 878700, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Hse3C.png?s=128&g=1", "display_name": "tbeernot", "link": "https://stackoverflow.com/users/878700/tbeernot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 53188271, "answer_count": 1, "score": 1, "last_activity_date": 1541588848, "creation_date": 1540974127, "last_edit_date": 1540988116, "question_id": 53079052, "link": "https://stackoverflow.com/questions/53079052/assigning-mailitem-htmlbody-make-images-of-lesser-quality", "title": "Assigning MailItem.HTMLBody make images of lesser quality", "body": "<p>I use VBA to create a MailItem in Outlook. A signature is configured, so the Display makes sure that it is visible. All ok. But anything I do to the body after that, causes images in the signature to be rasterized to a lower color depth, or sized wrong. Even with this simple code, changing nothing, the signature gets garbled:</p>\n\n<pre><code>    Set MailOutLook = appOutLook.CreateItem(olMailItem)\n    MailOutLook.Display\n    MailOutLook.HTMLBody = MailOutLook.HTMLBody\n</code></pre>\n\n<p>Interestingly enough after assigning the HTMLBody to itself the contents differs from before. New styles were added, existing ones changed (e.g span.EmailStyle17 was changed and the original became span.EmailStyle18), the img block appears the same, but the image itself is now rendered with dithering.</p>\n\n<p>In the end my question is: how do I insert some text in the HTMLBody without ruining it?</p>\n"}, {"tags": ["vba", "csv"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540975019, "post_id": 53079050, "comment_id": 93055805, "body": "<a href=\"https://www.mrexcel.com/forum/excel-questions/973578-export-worksheet-csv-using-vba-without-renaming-original-xlsm-file.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 10471562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3e1ff804eebf2b6b719446d192a823?s=128&d=identicon&r=PG&f=1", "display_name": "Turtle", "link": "https://stackoverflow.com/users/10471562/turtle"}, "is_accepted": true, "score": 1, "last_activity_date": 1540975663, "creation_date": 1540975663, "answer_id": 53079457, "question_id": 53079050, "link": "https://stackoverflow.com/questions/53079050/export-sheets-as-csvs-overwrites-the-original-filename-vba/53079457#53079457", "title": "Export Sheets as CSVs overwrites the original filename VBA", "body": "<p>It helps to copy the worksheet before saving it.\n<code>ActiveSheet.Copy\nActiveSheet.SaveAs Filename:=\"\\\\Lakesh\\ExportToCSVs\\\" &amp; nm &amp; \".csv\", _\n                 FileFormat:=xlCSV, CreateBackup:=False</code></p>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 53079457, "answer_count": 1, "score": 0, "last_activity_date": 1540975663, "creation_date": 1540974126, "last_edit_date": 1540974577, "question_id": 53079050, "link": "https://stackoverflow.com/questions/53079050/export-sheets-as-csvs-overwrites-the-original-filename-vba", "title": "Export Sheets as CSVs overwrites the original filename VBA", "body": "<p>I am saving each sheet as csv and when i save each sheet as csv, it overwrites the the original template filename to the new csv name. It changes from \".xlsm\" to \".csv\"</p>\n\n<p>How do i avoid that?</p>\n\n<p>My code looks like this:</p>\n\n<pre><code>Sub ExportToCSVs()\n    Dim ws As Worksheet\n    Dim nm As String\n    Application.ScreenUpdating = False\n    For Each ws In Worksheets\n        If ws.Name &lt;&gt; \"Control\" Then\n            ws.Select\n            nm = ws.Name\n            filenameconvention = \"\\\\Lakesh\\ExportToCSVs\\\" &amp; nm\n            ActiveSheet.SaveAs Filename:=\"\\\\Lakesh\\ExportToCSVs\\\" &amp; nm &amp; \".csv\", _\n                 FileFormat:=xlCSV, CreateBackup:=False\n        End If\n    Next ws\n    Sheets(\"Control\").Activate\n    Application.ScreenUpdating = True\n    MsgBox \"Csvs Created!\"\nEnd Sub\n</code></pre>\n\n<p>Need some guidance on this.</p>\n"}, {"tags": ["excel", "vba", "powershell"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1540973450, "post_id": 53078861, "comment_id": 93055088, "body": "Probably this helps: <a href=\"https://social.msdn.microsoft.com/Forums/en-US/c40e3e33-e552-426c-a0f6-add7f484479c/programmatically-sign-a-macro-macro-signing-automation?forum=isvvba\" rel=\"nofollow noreferrer\">Programmatically sign a macro - Macro signing automation</a>"}, {"owner": {"reputation": 151, "user_id": 4792930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2402a21dc8629541be5e761d15db729c?s=128&d=identicon&r=PG&f=1", "display_name": "Yam", "link": "https://stackoverflow.com/users/4792930/yam"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1540974933, "post_id": 53078861, "comment_id": 93055762, "body": "Thanks for your reply, but unfortunately there is no answer."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1540976778, "post_id": 53078861, "comment_id": 93056800, "body": "Yes, that&#39;s because you only can automatically add a signature for the document. But you cannot automatically sign code. That would actually kinda defeat the whole point of the digital certificate. So only Excel can sign Excel&#39;s VBA code (the file needs to be opened)."}, {"owner": {"reputation": 151, "user_id": 4792930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2402a21dc8629541be5e761d15db729c?s=128&d=identicon&r=PG&f=1", "display_name": "Yam", "link": "https://stackoverflow.com/users/4792930/yam"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1540982495, "post_id": 53078861, "comment_id": 93059935, "body": "I thought there is a solution like : create an object Excel.Application, load the excel file, extract the macro, sign it, affect it back and save the file."}], "owner": {"reputation": 151, "user_id": 4792930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2402a21dc8629541be5e761d15db729c?s=128&d=identicon&r=PG&f=1", "display_name": "Yam", "link": "https://stackoverflow.com/users/4792930/yam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 500, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540973333, "creation_date": 1540973225, "last_edit_date": 1540973333, "question_id": 53078861, "link": "https://stackoverflow.com/questions/53078861/is-there-a-way-to-digitally-sign-only-macros-in-excel-word-etc-files-with-pow", "title": "Is there a way to digitally sign only macros (in Excel, Word etc files) with PowerShell?", "body": "<p>I want to digitally sign the macros that are in Office document without sign all the file with PowerShell, is there a way to do that?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 1, "creation_date": 1540971718, "post_id": 53078262, "comment_id": 93054341, "body": "Have a look at <b>CurrentRegion</b> property on the Range object"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1540971741, "post_id": 53078262, "comment_id": 93054347, "body": "Is A1:C6 a table (Ribbon &gt; Insert &gt; Table)?"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1540982846, "post_id": 53078262, "comment_id": 93060121, "body": "My code should be working, now. I&#39;ve edited it too many times. Sorry."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1540996880, "post_id": 53078262, "comment_id": 93068732, "body": "I added a P.S. to my answer. Very interesting."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1540972242, "post_id": 53078509, "comment_id": 93054570, "body": "Additionally I recommend <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">The VBA Guide To ListObject Excel Tables</a> which is a nice resource to learn about how to handle tables."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1540972456, "post_id": 53078509, "comment_id": 93054668, "body": "@ QHarr <code>.DataBodyRange</code> should be <code>.Range</code> otherwise it will not recognize a possible result row. <code>.Range</code> represents the whole table, while <code>.DataBodyRange</code> only represents the data part without header/result rows."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 2, "creation_date": 1540975039, "post_id": 53078509, "comment_id": 93055816, "body": "Because <code>Range.Cells</code> allows you to specify Cells <i>outside</i> the range, you can just use <code>Debug.Print .Cells(.Rows.Count + 1, .Columns.Count + 1).Address</code> within the <code>With</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1540975109, "post_id": 53078509, "comment_id": 93055857, "body": "@Chronocidal Very nice!"}, {"owner": {"reputation": 23, "user_id": 10584437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0badf4ed5fb85de51788c803ed55d8e?s=128&d=identicon&r=PG&f=1", "display_name": "JoeS", "link": "https://stackoverflow.com/users/10584437/joes"}, "edited": false, "score": 0, "creation_date": 1540979887, "post_id": 53078509, "comment_id": 93058475, "body": "thanks for responding here. Going to try above, but it wont be in table format"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540979940, "post_id": 53078509, "comment_id": 93058505, "body": "No worries. You should edit your question to make that clear. Any reason why you can&#39;t make it table format? It might make life a lot easier."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 3, "last_activity_date": 1540975149, "last_edit_date": 1540975149, "creation_date": 1540971761, "answer_id": 53078509, "question_id": 53078262, "link": "https://stackoverflow.com/questions/53078262/how-to-select-a-cell-after-a-block-of-non-contiguous-data/53078509#53078509", "title": "how to select a cell after a block of non-contiguous data?", "body": "<p>It is an Excel table so you can offset using the dimensions of the table Range, and resize to the one cell.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AddressOfCell()\n    With ThisWorkbook.Worksheets(\"Sheet1\").ListObjects(\"table1\").Range\n        Debug.Print .Offset(.Rows.Count, .Columns.Count).Resize(1, 1).Address\n    End With\nEnd Sub\n</code></pre>\n\n<p>Credit to @Chronocidal for a much nicer:</p>\n\n<pre><code>Debug.Print .Cells(.Rows.Count + 1, .Columns.Count + 1).Address\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1540998781, "post_id": 53078589, "comment_id": 93070090, "body": "It will fail if the last cell is an empty cell."}], "tags": [], "owner": {"reputation": 46, "user_id": 10578948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lxsMv.png?s=128&g=1", "display_name": "Rit Shrestha", "link": "https://stackoverflow.com/users/10578948/rit-shrestha"}, "is_accepted": false, "score": 1, "last_activity_date": 1540972554, "last_edit_date": 1540972554, "creation_date": 1540972092, "answer_id": 53078589, "question_id": 53078262, "link": "https://stackoverflow.com/questions/53078262/how-to-select-a-cell-after-a-block-of-non-contiguous-data/53078589#53078589", "title": "how to select a cell after a block of non-contiguous data?", "body": "<p>Try this line of code:</p>\n\n<pre><code>ActiveSheet.Cells(Rows.Count, 3).End(xlUp).Offset(1, 1).Select\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 1, "creation_date": 1540994265, "post_id": 53078606, "comment_id": 93067001, "body": "Since you stated that UsedRange isn&#39;t reliable, wouldn&#39;t you think that SpecialCells would be unreliable, too? I&#39;ll add a P.S. to my answer."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1540995812, "post_id": 53078606, "comment_id": 93068052, "body": "You are correct. It does suffer from the same limitation! The underlying code goes back to the .UsedRange. Let&#39;s see if I can improve on the answer."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1540996609, "post_id": 53078606, "comment_id": 93068564, "body": "Found a new method that will get the last cell in the CurrentRegion. Thanks for the keen eye @VBasic2008!"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1540997694, "post_id": 53078606, "comment_id": 93069329, "body": "Nice, but you still have &quot;C1&quot; in it, but if there would be data to the right or to the bottom, this might be the best way to go."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1540997916, "post_id": 53078606, "comment_id": 93069479, "body": "True. The answer is meant as an example, but you need to provide some starting point for the range under any circumstances if there is other data on the sheet."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1540998082, "post_id": 53078606, "comment_id": 93069591, "body": "If there is a line with no data (empty cells), it will fail. I know that it&#39;s not contiguous then, but my code still prevails. But don&#39;t delete it, it is valid."}], "tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": false, "score": 2, "last_activity_date": 1540996531, "last_edit_date": 1540996531, "creation_date": 1540972187, "answer_id": 53078606, "question_id": 53078262, "link": "https://stackoverflow.com/questions/53078262/how-to-select-a-cell-after-a-block-of-non-contiguous-data/53078606#53078606", "title": "how to select a cell after a block of non-contiguous data?", "body": "<p>UPDATED:\nThis method will work regardless of whether the range is a table object or not. </p>\n\n<pre><code>Sub FindLastCell()\nDim rng As Range\nSet rng = ActiveSheet.Range(\"C1\").CurrentRegion\nDebug.Print rng.Offset(rng.Rows.Count, rng.Columns.Count).Resize(1, 1).Address\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10584437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0badf4ed5fb85de51788c803ed55d8e?s=128&d=identicon&r=PG&f=1", "display_name": "JoeS", "link": "https://stackoverflow.com/users/10584437/joes"}, "edited": false, "score": 0, "creation_date": 1540979934, "post_id": 53079722, "comment_id": 93058501, "body": "this one is interesting as above is not a table. going to try in my workbook now"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1540980295, "post_id": 53079722, "comment_id": 93058708, "body": "Though it is true that the .UsedRange object isn&#39;t 100% error free, this method won&#39;t actually return the cell you highlighted. It will simply provide a Range of the current region and offset it."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1540981758, "post_id": 53079722, "comment_id": 93059505, "body": "@ rohrl77: You&#39;re absolutely right, therefore I corrected the code. Sorry for the inconvenience."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1540996787, "last_edit_date": 1540996787, "creation_date": 1540976667, "answer_id": 53079722, "question_id": 53078262, "link": "https://stackoverflow.com/questions/53078262/how-to-select-a-cell-after-a-block-of-non-contiguous-data/53079722#53079722", "title": "how to select a cell after a block of non-contiguous data?", "body": "<h1>After Used Range</h1>\n\n<p><strong>Just use this in your code:</strong></p>\n\n<pre><code>With ActiveSheet.Cells\n  ActiveSheet.Cells(.Find(What:=\"*\", SearchDirection:=xlPrevious, _\n      SearchOrder:=xlByRows).Row + 1, _\n      .Find(What:=\"*\", SearchDirection:=xlPrevious, _\n      SearchOrder:=xlByColumns).Column + 1).Select\nEnd With\n</code></pre>\n\n<p><strong>To explain:</strong></p>\n\n<pre><code>Sub AfterUsedRange()\n  Dim LastRow As Long\n  Dim LastCol As Integer\n  With ActiveSheet.Cells\n    'Find the LAST real row\n    LastRow = .Find(What:=\"*\", SearchDirection:=xlPrevious, _\n        SearchOrder:=xlByRows).Row\n    ' Find the LAST real column\n    LastCol = .Find(What:=\"*\", SearchDirection:=xlPrevious, _\n        SearchOrder:=xlByColumns).Column\n  End With\n  ActiveSheet.Cells(LastRow + 1, LastCol + 1).Select\nEnd Sub\n</code></pre>\n\n<p><strong>To use it in a macro:</strong></p>\n\n<pre><code>Sub AfterUsedRange()\n  Cells(.Find(What:=\"*\", SearchDirection:=xlPrevious, _\n      SearchOrder:=xlByRows).Row + 1, _\n      .Find(What:=\"*\", SearchDirection:=xlPrevious, _\n      SearchOrder:=xlByColumns).Column + 1).Select\nEnd Sub\n</code></pre>\n\n<p>or you can redecorate:</p>\n\n<pre><code>Sub AfterUsedRange()\n  Cells(.Find(What:=\"*\", SearchDirection:=xlPrevious, _\n      SearchOrder:=xlByRows).Row, _\n      .Find(What:=\"*\", SearchDirection:=xlPrevious, _\n      SearchOrder:=xlByColumns).Column).Offset(1, 1).Select\nEnd Sub\n</code></pre>\n\n<h1>P.S.</h1>\n\n<p><strong>To prove the rumors that the 'UsedRange' and 'SpecialCells' functions at least are NOT reliable if not unusable</strong> are actually a <strong>fact</strong></p>\n\n<p>Referring to the line of code:</p>\n\n<pre><code>ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Offset(1, 1).Select\n</code></pre>\n\n<p>opposed to my redecorated line of code (the first in the Answer)</p>\n\n<pre><code>ActiveSheet.Cells(.Find(What:=\"*\", SearchDirection:=xlPrevious, _\n    SearchOrder:=xlByRows).Row, _\n    .Find(What:=\"*\", SearchDirection:=xlPrevious, _\n    SearchOrder:=xlByColumns).Column).Offset(1, 1).Select\n</code></pre>\n\n<p>Let us call the first line: <strong>SpecialCellsCode</strong>.<br>\nLet us call the second line: <strong>MyCode</strong>.</p>\n\n<p>The following table shows a simple self-explaining scenario.</p>\n\n<pre><code>  A  B  C  D\n1 1  1  1\n2    2  2\n3       3  y\n4          x\n</code></pre>\n\n<p>Let us call the 'intersection' of the first line and the first column <strong>after</strong> the 'UsedRange': <strong>AfterUsedRangeAddress</strong>.</p>\n\n<p>Now, when opening the worksheet. <strong>MyCode</strong> <strong>correctly</strong> calculates that the <strong>AfterUsedRangeAddress</strong> is <code>D4</code> and selects it (x) and so does the <strong>SpecialCellsCode</strong>. When we delete the value 3 in Column '<code>C</code>', <strong>MyCode</strong> <strong>correctly</strong> calculates that the <strong>AfterUsedRangeAddress</strong> is <code>D3</code> and selects it (y), <strong>but</strong> the <strong>SpecialCellsCode</strong> <strong>incorrectly</strong> still calculates <code>D4</code> and selects that one (x).</p>\n\n<p>To conclude, the SpecialCellsCode is <strong>at least unreliable, if not unusable</strong>.</p>\n\n<p>The idea to even think about such a test and to further investigate was taken from the question <a href=\"https://stackoverflow.com/questions/30524093/vba-usedrange-does-not-update-correctly\">VBA: UsedRange Does not update correctly</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 10584437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0badf4ed5fb85de51788c803ed55d8e?s=128&d=identicon&r=PG&f=1", "display_name": "JoeS", "link": "https://stackoverflow.com/users/10584437/joes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1586416946, "creation_date": 1540970717, "last_edit_date": 1586416946, "question_id": 53078262, "link": "https://stackoverflow.com/questions/53078262/how-to-select-a-cell-after-a-block-of-non-contiguous-data", "title": "how to select a cell after a block of non-contiguous data?", "body": "<p>I have below table </p>\n\n<p><a href=\"https://i.stack.imgur.com/62x0X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/62x0X.png\" alt=\"tablexample\"></a></p>\n\n<p>I'm trying to paste data into cell D7 so the edge of the current box.</p>\n\n<p>I tried using </p>\n\n<pre><code>ActiveSheet.Range(\"C1\").End(xlDown).End(xlToRight).Offset(1, 1).Select\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1540966458, "post_id": 53077271, "comment_id": 93052258, "body": "What did you try that did not succeed? Please add your code to your post. (See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> as well as the <a href=\"https://stackoverflow.com/help/on-topic\">help center</a>.)"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 10578948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lxsMv.png?s=128&g=1", "display_name": "Rit Shrestha", "link": "https://stackoverflow.com/users/10578948/rit-shrestha"}, "is_accepted": false, "score": 0, "last_activity_date": 1540968660, "creation_date": 1540968660, "answer_id": 53077810, "question_id": 53077271, "link": "https://stackoverflow.com/questions/53077271/add-an-exact-amount-of-number-to-the-column-j-based-on-column-a/53077810#53077810", "title": "Add an exact amount of number to the column J based on column A", "body": "<p>Try this formula in J1 and drag it or copy it to the end of your data row:</p>\n\n<p>Formula in J1: =if(A1=\"\",\"\",7)</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "is_accepted": false, "score": -1, "last_activity_date": 1540968942, "creation_date": 1540968942, "answer_id": 53077868, "question_id": 53077271, "link": "https://stackoverflow.com/questions/53077271/add-an-exact-amount-of-number-to-the-column-j-based-on-column-a/53077868#53077868", "title": "Add an exact amount of number to the column J based on column A", "body": "<p>I have solved the issue with this code block: </p>\n\n<pre><code>Dim LastRow As Long\n    LastRow = y.Sheets(\"csv\").Cells(Rows.Count, \"A\").End(xlUp).Row\n    y.Sheets(\"csv\").Range(\"J1:J\" &amp; LastRow).Value = \"7\"\n</code></pre>\n\n<p>Thank you All.</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 2, "last_activity_date": 1540993841, "creation_date": 1540993841, "answer_id": 53085001, "question_id": 53077271, "link": "https://stackoverflow.com/questions/53077271/add-an-exact-amount-of-number-to-the-column-j-based-on-column-a/53085001#53085001", "title": "Add an exact amount of number to the column J based on column A", "body": "<p>Let us assume that we are using Sheet1. You may change from sheet1 to:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2SS1L.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2SS1L.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then try:</p>\n\n<pre><code>Sub test()\n\n    Dim LR As Long\n    Dim i As Long\n\n    With Worksheets(\"Sheet1\")\n        LR = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        .Range(\"J1:J\" &amp; LR).Value = \"7\"\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 53085001, "answer_count": 3, "score": 0, "last_activity_date": 1586416982, "creation_date": 1540966171, "last_edit_date": 1586416982, "question_id": 53077271, "link": "https://stackoverflow.com/questions/53077271/add-an-exact-amount-of-number-to-the-column-j-based-on-column-a", "title": "Add an exact amount of number to the column J based on column A", "body": "<p>I have a table from A to E. I don't know the row count of A column so it might be 15 or 450 or any number. What I need is when I run the macros I  want it to add fixed number \"7\" to the column J1 till the last row of column A. I don't know how to make this. I tried many things but did not succeed. <a href=\"https://i.stack.imgur.com/uCelD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uCelD.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1540967105, "post_id": 53077142, "comment_id": 93052506, "body": "where is the code to click Generate button? what I understand that you have to wait after clicking Generate in a time bound loop for <code>ctl00_ContentPlaceHolder1_lnkDownload</code> to appear and then only click it"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540967166, "post_id": 53077142, "comment_id": 93052542, "body": "What does no luck mean? You don&#39;t need a loop as you have an id for each element."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540978738, "post_id": 53077142, "comment_id": 93057848, "body": "Hi, I am unsure how you can have that error on that line. Can you split into two lines  If ele Is Nothing Then Exit Sub : If testValue  &lt;&gt; &quot;Report Spooled Successfully&quot;   Then Exit Sub ...... and tell me if the error occurs on the first of those lines?"}, {"owner": {"reputation": 35, "user_id": 7552259, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FNWdwYf-t4g/AAAAAAAAAAI/AAAAAAAAA4o/CK-FvmTYOuI/photo.jpg?sz=128", "display_name": "devendra", "link": "https://stackoverflow.com/users/7552259/devendra"}, "edited": false, "score": 0, "creation_date": 1540985813, "post_id": 53077142, "comment_id": 93061682, "body": "Hi  QHarr, i have edited as you mentioned in earlier comment and didn&#39;t got any error but clicking on download button is not happening..  <b>Browser.document.getElementById(&quot;ctl00_ContentPlaceHolder1_l&zwnj;&#8203;nkDownload&quot;).Click</b>"}, {"owner": {"reputation": 35, "user_id": 7552259, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FNWdwYf-t4g/AAAAAAAAAAI/AAAAAAAAA4o/CK-FvmTYOuI/photo.jpg?sz=128", "display_name": "devendra", "link": "https://stackoverflow.com/users/7552259/devendra"}, "edited": false, "score": 0, "creation_date": 1540987296, "post_id": 53077142, "comment_id": 93062491, "body": "<b>testValue = ele.innerText</b> is coming empty"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541056445, "post_id": 53077142, "comment_id": 93089464, "body": "Try stepping through with F8 going line by line using side by side screen view."}, {"owner": {"reputation": 35, "user_id": 7552259, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FNWdwYf-t4g/AAAAAAAAAAI/AAAAAAAAA4o/CK-FvmTYOuI/photo.jpg?sz=128", "display_name": "devendra", "link": "https://stackoverflow.com/users/7552259/devendra"}, "edited": false, "score": 0, "creation_date": 1541418182, "post_id": 53077142, "comment_id": 93197756, "body": "Hi QHarr, Sorry for late reply...i was gone out of station with limited internet access.  Thanks for the response.  i have tried step by step and didn&#39;t got any error but at the same time  <b>testValue = ele.innerText</b>  is showing nothing so <b>Browser.document.getElementById(&quot;ctl00_ContentPlaceHolder1_l&zwnj;&#8203;nkDownload&quot;).Click</b> code is not executing.."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541494627, "post_id": 53077142, "comment_id": 93226972, "body": "Browser.document.getElementById(&quot;ctl00_ContentPlaceHolder1_l&zwnj;&#8203;nkDownload&quot;).FireEve&zwnj;&#8203;nt &quot;onclick&quot;"}, {"owner": {"reputation": 35, "user_id": 7552259, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FNWdwYf-t4g/AAAAAAAAAAI/AAAAAAAAA4o/CK-FvmTYOuI/photo.jpg?sz=128", "display_name": "devendra", "link": "https://stackoverflow.com/users/7552259/devendra"}, "edited": false, "score": 0, "creation_date": 1541996805, "post_id": 53077142, "comment_id": 93396465, "body": "Hi QHarr, this code is working but clicking the button before the ** Report Spooled Successfully**  message appears <code>Browser.document.getElementById(&quot;ctl00_ContentPlaceHolder1_l&zwnj;&#8203;nkDownload&quot;).Click</code>"}], "answers": [{"comments": [{"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1541042491, "post_id": 53077576, "comment_id": 93086090, "body": "@ Devendra, I can see that you had deleted your previous comment. I made a test with the code suggested by QHarr and it is working fine. I suggest you to again make a test and comment about your testing result. It can help us to get the idea about current status of your issue."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1540970136, "last_edit_date": 1540970136, "creation_date": 1540967597, "answer_id": 53077576, "question_id": 53077142, "link": "https://stackoverflow.com/questions/53077142/click-on-image-button-in-ie/53077576#53077576", "title": "Click on Image button in IE", "body": "<p>So, this may not solve your problems but at least it introduces proper waits for page loading, including after each click event, and a timed loop for the text you are after to appear. I also add a commented out FireEvent in case that is needed to trigger the <code>onclick</code>. You don't need to set <code>Browser</code> to nothing. It will be disposed of when the sub completes. When the Object variable releases its reference by going out of scope  the runtime calls the target object\u2019s <a href=\"https://bytecomb.com/vba-internals-whats-in-a-variable/\" rel=\"nofollow noreferrer\">Release</a> method to decrement the object\u2019s reference count.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub KbossBrokerageProcessStatus()\n    Dim browser As Object, t As Date, ele As Object, testValue As String\n    Const MAX_WAIT_SEC As Long = 5\n\n    Set browser = CreateObject(\"InternetExplorer.Application\")\n    With browser\n        .Visible = True\n        .navigate2 \"myUrl\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n\n            .getElementById(\"ctl00_ContentPlaceHolder1_btnGenerate\").Click '.FireEvent(\"onclick\")\n\n            While browser.Busy Or browser.readyState &lt; 4: DoEvents: Wend\n\n            Do\n                DoEvents\n                On Error Resume Next\n                Set ele = .getElementById(\"ctl00_ContentPlaceHolder1_lblMsg\")\n                testValue = ele.innerText\n                On Error GoTo 0\n                If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n            Loop While testValue  &lt;&gt; \"Report Spooled Successfully\"\n\n            If ele Is Nothing Or testValue  &lt;&gt; \"Report Spooled Successfully\"   Then Exit Sub\n\n            .document.getElementById(\"ctl00_ContentPlaceHolder1_lnkDownload\").Click\n\n            While browser.Busy Or browser.readyState &lt; 4: DoEvents: Wend\n\n        End With\n\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7552259, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FNWdwYf-t4g/AAAAAAAAAAI/AAAAAAAAA4o/CK-FvmTYOuI/photo.jpg?sz=128", "display_name": "devendra", "link": "https://stackoverflow.com/users/7552259/devendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 53077576, "answer_count": 1, "score": -1, "last_activity_date": 1540977561, "creation_date": 1540965393, "last_edit_date": 1540966302, "question_id": 53077142, "link": "https://stackoverflow.com/questions/53077142/click-on-image-button-in-ie", "title": "Click on Image button in IE", "body": "<p>I am working on a project ''Automation IE'' but got stucked at clicking on Image button ... </p>\n\n<p>I am trying to spool one excel report from website and for the same i need to click on Generate button <code>(type=\"submit\")`` then one message will appear</code>(Report Spooled Successfully)<code>then only I can click on download button</code>(type=\"image\")` </p>\n\n<p><strong>Screenshot</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/N3JuL.jpg\" alt=\"Below is the Screenshot\"></p>\n\n<p><strong>Below is generate button HTML source code</strong></p>\n\n<pre><code>&lt;td align=\"right\"&gt;\n&lt;input type=\"submit\" name=\"ctl00$ContentPlaceHolder1$btnGenerate\" value=\" Generate \"\nonclick=\"javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&amp;quot;ctl00$ContentPlaceHolder1$btnGenerate&amp;quot;, &amp;quot;&amp;quot;, true, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, false, false))\" \nid=\"ctl00_ContentPlaceHolder1_btnGenerate\" tabindex=\"4\" title=\"Click Here\" class=\"dxbButton_Glass\"&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p><strong>Below is the HTML source code for message</strong></p>\n\n<pre><code>&lt;td colspan=\"2\"&gt;\n&lt;span id=\"ctl00_ContentPlaceHolder1_lblMsg\" style=\"color:Blue;font-weight:bold;\"&gt;Report Spooled Successfully&lt;/span&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p><strong>Below is The HTML source code for download button (<code>type=\"image\"</code>)</strong></p>\n\n<pre><code>&lt;td align=\"right\" visible=\"false\"&gt;\nclick here to Download&amp;nbsp;\n&lt;input type=\"image\" name=\"ctl00$ContentPlaceHolder1$lnkDownload\" id=\"ctl00_ContentPlaceHolder1_lnkDownload\" tabindex=\"7\" title=\"Download\" src=\"../../Images/save.gif\" alt=\"Download\" style=\"border-width:0px;\"&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p>With my code i am able to click on <code>Generate</code> button but facing difficulty clicking on <code>Download</code> button after message appeared, have tried to looping until condition is met and tried if <code>Element.innertext = message</code> but no luck.</p>\n\n<p><strong>Below is the My VBA code</strong></p>\n\n<pre><code>Sub KBOSS_Brokerage_Process_Status()\n    Set Browser = CreateObject(\"internetexplorer.application\")\n    Browser.Visible = false\n    Browser.navigate (\"my url\")\n    Set mymsg = Browser.document.getElementById(\"ctl00_ContentPlaceHolder1_lblMsg\")\n    For Each elem In mymsg.getElementsByTagName(\"span\")\n        If elem.innerText = \" Report Spooled Successfully \" Then Exit For\n    Next elem\n    Browser.document.getElementById(\"ctl00_ContentPlaceHolder1_lnkDownload\").Click\n    Browser.Quit\n    Set Browser = Nothing\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n\n<p>Cross Post: \n<a href=\"https://chandoo.org/forum/threads/vba-code-to-select-an-option-from-html-drop-down-using-value-rather-than-index.37707/#post-228291\" rel=\"nofollow noreferrer\">https://chandoo.org/forum/threads/vba-code-to-select-an-option-from-html-drop-down-using-value-rather-than-index.37707/#post-228291</a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 5795301, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/87d3b3d3b076a99cf5f02879d8191842?s=128&d=identicon&r=PG&f=1", "display_name": "Majora", "link": "https://stackoverflow.com/users/5795301/majora"}, "edited": false, "score": 0, "creation_date": 1540998878, "post_id": 53077959, "comment_id": 93070158, "body": "For this purpose, the search values are predetermined and the value to insert will change based on the search value. Is it possible to base the searchValue on the contents of a worksheet rather than inputbox? ie): For each value in column A of Worksheet1, search for each value on Worksheet2 and if found, insert InsertValue from column B adjacent to value in Column A Worksheet1 in offset cell location on Worksheet2?"}, {"owner": {"reputation": 105, "user_id": 5795301, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/87d3b3d3b076a99cf5f02879d8191842?s=128&d=identicon&r=PG&f=1", "display_name": "Majora", "link": "https://stackoverflow.com/users/5795301/majora"}, "edited": false, "score": 0, "creation_date": 1541000795, "post_id": 53077959, "comment_id": 93071501, "body": "Thank you for the update, but the solution must be VB, a VLOOKUP does not quite achieve this result. The procedure must be able to find values in sheet1 column B from a list in column A sheet2 and when a match is found insert the value from column A sheet2 adjacent to that match in column B sheet2 into column A sheet1."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 105, "user_id": 5795301, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/87d3b3d3b076a99cf5f02879d8191842?s=128&d=identicon&r=PG&f=1", "display_name": "Majora", "link": "https://stackoverflow.com/users/5795301/majora"}, "edited": false, "score": 0, "creation_date": 1541001056, "post_id": 53077959, "comment_id": 93071677, "body": "See vba version. You stated that you were searching column B so I have stuck with that."}, {"owner": {"reputation": 105, "user_id": 5795301, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/87d3b3d3b076a99cf5f02879d8191842?s=128&d=identicon&r=PG&f=1", "display_name": "Majora", "link": "https://stackoverflow.com/users/5795301/majora"}, "edited": false, "score": 0, "creation_date": 1541190929, "post_id": 53077959, "comment_id": 93145732, "body": "Not quite, the values are not something the user will enter search terms for or use the scripting dictionary to find. The values to search for and the values to be inserted are both pre-determined. The most ideal setup I can think of using your code example would be to host a list of values in Sheet2 Column A, and for the procedure to search for each of those values in Sheet1 Column B and if a match is found for a value, the contents of the cell next to that value in Sheet 2 Column B are inserted into the cell adjacent to the match on Sheet1 Column A."}, {"owner": {"reputation": 105, "user_id": 5795301, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/87d3b3d3b076a99cf5f02879d8191842?s=128&d=identicon&r=PG&f=1", "display_name": "Majora", "link": "https://stackoverflow.com/users/5795301/majora"}, "edited": false, "score": 0, "creation_date": 1541198689, "post_id": 53077959, "comment_id": 93148028, "body": "It&#39;s certainly close! The issue is that neither example uses the contents of Sheet2 Column A to provide the values to search for on Sheet1 Column B. The first example asks the user for input via a MsgBox and the second example uses the scripting dictionary. The procedure should ideally loop through Sheet1 Column B, search for the values provided in Sheet2 Column A procedurally, and if a match is found, insert the contents of the cell adjacent to the match in Sheet2 Column B next to the Match in Sheet1 Column A."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 105, "user_id": 5795301, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/87d3b3d3b076a99cf5f02879d8191842?s=128&d=identicon&r=PG&f=1", "display_name": "Majora", "link": "https://stackoverflow.com/users/5795301/majora"}, "edited": false, "score": 0, "creation_date": 1541201288, "post_id": 53077959, "comment_id": 93148626, "body": "But the dictionary picks the values up from the sheet. It should do exactly the same thing. Perhaps it just the sheet/columns confused. I will add an image and then maybe you can help me understand how it is missing the mark."}, {"owner": {"reputation": 105, "user_id": 5795301, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/87d3b3d3b076a99cf5f02879d8191842?s=128&d=identicon&r=PG&f=1", "display_name": "Majora", "link": "https://stackoverflow.com/users/5795301/majora"}, "edited": false, "score": 0, "creation_date": 1541627171, "post_id": 53077959, "comment_id": 93285244, "body": "Were you able to update the post with an image? Totally no rush. A separate issue with the code provided in the second dictionary example is that it appears to throw an error when run."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1541001033, "last_edit_date": 1541001033, "creation_date": 1540969419, "answer_id": 53077959, "question_id": 53077002, "link": "https://stackoverflow.com/questions/53077002/excel-vba-compact-method-to-insert-text-in-offset-column-based-on-find-result/53077959#53077959", "title": "Excel VBA Compact method to insert text in offset column based on FIND result", "body": "<p>Depends on how you are planning on running this. You could have it as a sub that prompts a user to enter the search value and the text to input at offset. I show that below. It is easy enough instead to adapt to a loop if you have the search and offset strings in the sheet. I use only the populated area of column B for the search. The search values and insert/offset values are held in variables.</p>\n\n<pre><code>Option Explicit\nPublic Sub AddText()\n    Dim searchValue As String, insertValue As String, C1 As Range, ws As Worksheet\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    searchValue = Application.InputBox(\"Please supply search value\", Type:=2)\n    insertValue = Application.InputBox(\"Please supply insert value\", Type:=2)\n\n    If searchValue = vbNullString Or insertValue = vbNullString Then Exit Sub 'or loop prompting for entry\n\n    With ws\n        Set C1 = .Range(\"B1:B\" &amp; .Cells(.Rows.Count, \"B\").End(xlUp).Row).Find(searchValue)\n    End With\n    If Not C1 Is Nothing Then C1.Offset(0, -1).Value = insertValue\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>From your comment you are actually just doing a VLOOKUP.</p>\n\n<p>In sheet 2 A1 put the following and autofill down for as many rows as are filled in column B.</p>\n\n<pre><code>=IFERROR(VLOOKUP(B1,Sheet1!A:B,2,FALSE),\"\")\n</code></pre>\n\n<hr>\n\n<p>Same thing using arrays and a dictionary</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AddText()\n    Dim wsSource As Worksheet, wsSearch As Worksheet\n    Dim lookupArray(), updateArray(), lookupDict As Object, i As Long\n    Set lookupDict = CreateObject(\"Scripting.Dictionary\")\n    Set wsSource = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set wsSearch = ThisWorkbook.Worksheets(\"Sheet2\")\n\n    With wsSource\n        lookupArray = .Range(\"A1:B\" &amp; GetLastRow(wsSource, 1)).Value\n    End With\n    For i = LBound(lookupArray, 1) To UBound(lookupArray, 1)\n        lookupDict(lookupArray(i, 1)) = lookupArray(i, 2)\n    Next\n    With wsSearch\n        updateArray = .Range(\"A1:B\" &amp; GetLastRow(wsSearch, 2)).Value\n        For i = LBound(updateArray, 1) To UBound(updateArray, 1)\n            If lookupDict.Exists(updateArray(i, 2)) Then\n                updateArray(i, 1) = lookupDict(updateArray(i, 2))\n            End If\n        Next\n        .Cells(1, 1).Resize(UBound(updateArray, 1), UBound(updateArray, 2)) = updateArray\n    End With\nEnd Sub\n\nPublic Function GetLastRow(ByVal ws As Worksheet, Optional ByVal columnNumber As Long = 1) As Long\n    With ws\n        GetLastRow = .Cells(.Rows.Count, columnNumber).End(xlUp).Row\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 5795301, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/87d3b3d3b076a99cf5f02879d8191842?s=128&d=identicon&r=PG&f=1", "display_name": "Majora", "link": "https://stackoverflow.com/users/5795301/majora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541626905, "creation_date": 1540964621, "last_edit_date": 1541626905, "question_id": 53077002, "link": "https://stackoverflow.com/questions/53077002/excel-vba-compact-method-to-insert-text-in-offset-column-based-on-find-result", "title": "Excel VBA Compact method to insert text in offset column based on FIND result", "body": "<p>I am writing a small timesaver tool that inserts various text values in a column based on a cell offset of the location of a list-based text search in column C.</p>\n\n<p><code>Dim C1 As Range \nSet C1 = Range(\"B:B\").Find(\"Value to search\") \nIf C1 Is Nothing Then \nElse \nC1.Offset(0, -1).Value = \"Text value to insert\" \nEnd If</code></p>\n\n<p>I am certain there is a better way to write this relatively simple proc in a more scalable way rather than hard code each value to search in the code, but am not sure how this could be simplified further. I've been looking at the first two lines, and I may be wrong, but I believe a cell range needs to be defined as written in the first two lines in order for the Offset to know the cell location to offset from.</p>\n"}, {"tags": ["vba", "ms-access", "dao", "adodb"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1540964304, "post_id": 53076740, "comment_id": 93051574, "body": "Not sure what you mean by &#39;swap and change&#39; nor why this is an issue. I have used both in the same db, even the same procedure."}, {"owner": {"reputation": 41, "user_id": 5978178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886a94f743bc2989bc55e5c955a8ce71?s=128&d=identicon&r=PG&f=1", "display_name": "MCTas", "link": "https://stackoverflow.com/users/5978178/mctas"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1540966416, "post_id": 53076740, "comment_id": 93052245, "body": "Hi June7, I would prefer to use ADODB over DAO. I simply want to get the ADODB function working."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1540969200, "post_id": 53076740, "comment_id": 93053318, "body": "Why would you prefer adodb? Also, a <code>Text</code> parameter corresponds to <code>adVarWChar</code>, Access supports Unicode characters. While internally VBA does store strings as BSTR, you really never pass them to a database engine in that format."}, {"owner": {"reputation": 41, "user_id": 5978178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886a94f743bc2989bc55e5c955a8ce71?s=128&d=identicon&r=PG&f=1", "display_name": "MCTas", "link": "https://stackoverflow.com/users/5978178/mctas"}, "edited": false, "score": 0, "creation_date": 1540969639, "post_id": 53076740, "comment_id": 93053501, "body": "Hi Erik. adVarWChar returns same error as stated above. The reason that I prefer ADO is that it is supported on other platforms whereas DAO is not - might I add that the issue of ADO over DAO is insignificant here. My question is how do I get the ADO code working?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1540973646, "post_id": 53076740, "comment_id": 93055182, "body": "The question is: how to get ADO working with a <code>PARAMETERS</code> declaration. That&#39;s a DAO concept, ADO has significant differences in how it handles parameters. If you remove the parameter declaration, and use questionmarks as parameters, as ADO expects, you can easily get this to work"}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1540988504, "post_id": 53076740, "comment_id": 93063138, "body": "Try <code>adCmdText</code> instead. There are no &quot;stored procs&quot; in an MS Access database."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1541007927, "post_id": 53076740, "comment_id": 93075473, "body": "ADO expects different <code>Like</code> wild card characters.  Change <code>Like &quot;*&quot; &amp; [Local] &amp; &quot;*&quot;</code> to <code>Like &quot;%&quot; &amp; [Local] &amp; &quot;%&quot;</code>"}, {"owner": {"reputation": 41, "user_id": 5978178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886a94f743bc2989bc55e5c955a8ce71?s=128&d=identicon&r=PG&f=1", "display_name": "MCTas", "link": "https://stackoverflow.com/users/5978178/mctas"}, "edited": false, "score": 0, "creation_date": 1541021106, "post_id": 53076740, "comment_id": 93081093, "body": "Hi All. Thanks for your input. Here is the solution:"}, {"owner": {"reputation": 41, "user_id": 5978178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886a94f743bc2989bc55e5c955a8ce71?s=128&d=identicon&r=PG&f=1", "display_name": "MCTas", "link": "https://stackoverflow.com/users/5978178/mctas"}, "edited": false, "score": 0, "creation_date": 1541021524, "post_id": 53076740, "comment_id": 93081256, "body": "Hi All. Thanks for your input. Here is the solution: 1. Modify the SQL statement as HansUp suggested 2. Cast the ADO parameters as adBSTR Erik - Thanks for your contribution - I have read some of your posts and think that your work is commendable. However, I take issue with the advice that you cannot use named parameters"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 5978178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886a94f743bc2989bc55e5c955a8ce71?s=128&d=identicon&r=PG&f=1", "display_name": "MCTas", "link": "https://stackoverflow.com/users/5978178/mctas"}, "is_accepted": false, "score": 1, "last_activity_date": 1541024171, "creation_date": 1541024171, "answer_id": 53092709, "question_id": 53076740, "link": "https://stackoverflow.com/questions/53076740/vba-adodb-parameter-query-fails/53092709#53092709", "title": "vba adodb parameter query fails", "body": "<p>Thanks for your input. Here is the solution:\n1. Modify the SQL statement as HansUp suggested.</p>\n\n<pre><code>PARAMETERS [Local] Text ( 255 ), FState Text ( 255 );\nSELECT PCodes.postcode, PCodes.locality, PCodes.state, PCodes.long, PCodes.lat\nFROM PCodes  WHERE (((PCodes.locality) Like \"%\" &amp; [Local] &amp; \"%\") AND ((PCodes.state)= \n[FState])) OR (((PCodes.locality) Like \"%\" &amp; [Local] &amp; \"%\") AND ((([PCodes].[state]) \nLike [FState]) Is Null)) ORDER BY PCodes.locality;\n</code></pre>\n\n<p>Interestingly, this query does not return any values if used within the Access UI</p>\n\n<ol start=\"2\">\n<li>Cast the ADO parameters as adBSTR - adVarChar and adVarWChar both returned Error 3708 Parameter object is improperly defined. Inconsistent or incomplete information was provided.</li>\n</ol>\n"}], "owner": {"reputation": 41, "user_id": 5978178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886a94f743bc2989bc55e5c955a8ce71?s=128&d=identicon&r=PG&f=1", "display_name": "MCTas", "link": "https://stackoverflow.com/users/5978178/mctas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1541024171, "creation_date": 1540962997, "last_edit_date": 1540963934, "question_id": 53076740, "link": "https://stackoverflow.com/questions/53076740/vba-adodb-parameter-query-fails", "title": "vba adodb parameter query fails", "body": "<p>I have the following issue with an adodb parameter query that fails with an error or returns an empty recordset. However a similar DAO query succeeds.</p>\n\n<p>This is all in MS Access</p>\n\n<p>First the SQL - Find_Post_Code - This is designed to take either or both parameters:  </p>\n\n<pre><code>PARAMETERS [Local] Text ( 255 ), FState Text ( 255 );\nSELECT PCodes.postcode, PCodes.locality, PCodes.state, PCodes.long, PCodes.lat\nFROM PCodes\nWHERE (((PCodes.locality) Like \"*\" &amp; [Local] &amp; \"*\") AND ((PCodes.state)=[FState])) OR (((PCodes.locality) Like \"*\" &amp; [Local] &amp; \"*\") AND ((([PCodes].[state]) Like [FState]) Is Null))\nORDER BY PCodes.locality;\n</code></pre>\n\n<p>Now the ADODB Function:</p>\n\n<pre><code>Public Function GetPostCode(varLocality As Variant, varState As Variant) As String\n'//Purpose: Return Post Code for a varLocality and/or varState\n\n  Dim cmd As New ADODB.Command\n  Dim rst As New ADODB.Recordset\n\nOn Error GoTo Handle_err\n\n  With cmd\n    .CommandText = \"Find_Post_Code\"\n    .CommandType = adCmdStoredProc\n    Set .ActiveConnection = CurrentProject.Connection\n    .Parameters.Append .CreateParameter(\"Local\", adVarChar, adParamInput, , CStr(Nz(varLocality, \"\")))\n    .Parameters.Append .CreateParameter(\"FState\", adVarChar, adParamInput, , CStr(Nz(varState, \"\")))\n    rst.CursorType = adOpenStatic\n    Set rst = .Execute\n  End With\n\n  If Not rst.EOF Then\n    GetPostCode = rst!postcode\n  End If\n  rst.Close\n\nHandle_err:\n  If Err Then\n    MsgBox \"Error \" &amp; Format(Err.Number) &amp; \" \" &amp; Err.Description, vbCritical, AppTitle\n    Err.Clear\n  End If\n\n  Set rst = Nothing\n  Set cmd = Nothing\n\nEnd Function\n</code></pre>\n\n<p>This fails with the error message:\nError 3708 Parameter object is improperly defined. Inconsistent or incomplete information was provided.</p>\n\n<p>If I cast the parameter as adBSTR there is no error, but the resultant recordset has no data</p>\n\n<p>However, If I use the following DAO function all is well</p>\n\n<pre><code>Public Function GetPostCode2(Locality As String, State As String) As String\n'//Purpose: Return Post Code for a varLocality and/or varState\n\n  Dim db As Database\n  Dim qd As DAO.QueryDef\n  Dim prmLocality As DAO.Parameter\n  Dim prmFSTate As DAO.Parameter\n  Dim rst As DAO.Recordset\n\nOn Error GoTo Handle_err\n\n  Set db = CurrentDb\n  Set qd = db.QueryDefs(\"Find_Post_Code\")\n  Set prmLocality = qd.Parameters!Local\n  prmLocality.Value = Locality\n\n  Set prmFSTate = qd.Parameters!FState\n  prmFSTate.Value = State\n\n  Set rst = qd.OpenRecordset\n\n  If Not rst.EOF Then\n    GetPostCode2 = rst!postcode\n  End If\n\n  rst.Close\n\nHandle_err:\n  If Err Then\n    MsgBox \"Error \" &amp; Format(Err.Number) &amp; \" \" &amp; Err.Description, vbCritical, AppTitle\n    Err.Clear\n  End If\n  Set rst = Nothing\n  Set prmLocality = Nothing\n  Set prmFSTate = Nothing\n  Set qd = Nothing\n  Set db = Nothing\n\nEnd Function\n</code></pre>\n\n<p>I would prefer not to swap and change between ADODB and DAO to accomplish my aims. Your help would be greatly appreciated</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 3, "creation_date": 1540964033, "post_id": 53076673, "comment_id": 93051484, "body": "When you run the code from the Personal Workbook, how does the code know which workbook to work with? \u201cThis Workbook\u201d could be any that is open including the persobal workbook..."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1540965824, "post_id": 53076673, "comment_id": 93052040, "body": "To answer your last question, you could <a href=\"http://www.howtoexcelatexcel.com/vba/macro-mondays-how-to-assign-or-change-a-macro-shortcut-key/\" rel=\"nofollow noreferrer\">assign a shortcut key to macro</a>. As for why you can&#39;t get the Quick Access, perhaps you don&#39;t have the code saved in the correct module. It&#39;s hard to say without seeing what you have."}, {"owner": {"reputation": 449, "user_id": 9129978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0980148de15b82d82d39abbe6434c9?s=128&d=identicon&r=PG&f=1", "display_name": "tera_789", "link": "https://stackoverflow.com/users/9129978/tera-789"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1540968879, "post_id": 53076673, "comment_id": 93053203, "body": "@SolarMike I thought it will automatically get the WorkBook that is currently open. But I think I see your point... You are saying what if 2 workbooks are open, correct? If so, do you know any solutions?"}, {"owner": {"reputation": 449, "user_id": 9129978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0980148de15b82d82d39abbe6434c9?s=128&d=identicon&r=PG&f=1", "display_name": "tera_789", "link": "https://stackoverflow.com/users/9129978/tera-789"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1540968928, "post_id": 53076673, "comment_id": 93053223, "body": "@ashleedawg I have macro saved in personal workbook"}, {"owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "edited": false, "score": 1, "creation_date": 1540970653, "post_id": 53076673, "comment_id": 93053882, "body": "First you should use following code:  Dim MyBook as workbook    set MyBook=ActiveWorkbook     and use MyBook instead of thisworkbook.  Also your excel file which is the code is saved, should be open when you want to use your macro."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1540970657, "post_id": 53076673, "comment_id": 93053886, "body": "@tera_789 address the target workbook by name"}, {"owner": {"reputation": 449, "user_id": 9129978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0980148de15b82d82d39abbe6434c9?s=128&d=identicon&r=PG&f=1", "display_name": "tera_789", "link": "https://stackoverflow.com/users/9129978/tera-789"}, "reply_to_user": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "edited": false, "score": 0, "creation_date": 1541012863, "post_id": 53076673, "comment_id": 93077690, "body": "@Hamed Thank you so much! It solved my issue. If you want, write it as an answer and I will accept it. It may also help future users."}], "owner": {"reputation": 449, "user_id": 9129978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0980148de15b82d82d39abbe6434c9?s=128&d=identicon&r=PG&f=1", "display_name": "tera_789", "link": "https://stackoverflow.com/users/9129978/tera-789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586417019, "creation_date": 1540962584, "last_edit_date": 1586417019, "question_id": 53076673, "link": "https://stackoverflow.com/questions/53076673/personal-workbook-macro-is-not-running", "title": "Personal Workbook macro is not running", "body": "<p>I recorded a macro and saved it to my Personal Workbook by following <a href=\"https://support.office.com/en-us/article/copy-your-macros-to-a-personal-macro-workbook-aa439b90-f836-4381-97f0-6e4c3f5ee566#OfficeVersion=Windows\" rel=\"nofollow noreferrer\">Microsoft's instructions</a>. Then, I added this macro to my Quick Access Toolbar. However, when I click it, nothing happens. The strange part is that if I assign the exact same code to a Button Click, everything runs well.</p>\n\n<p><em>Code is probably irrelevant now, but I just included it in case it may become relevant.</em></p>\n\n<p><strong>Here is the code:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub test(metric, greenNum, orangeNum, ws)\nDim metricName As Range                                                                             \nDim rowsCounter As Long                                                                             ' Rows loop counter\nDim numOfRows As Long                                                                               ' Number of rows\nDim numOfColumns As Long                                                                            ' Number of columns\nDim baseline As Double                                                                              ' Baseline to compute against\nDim newCellValue As Double                                                                          ' Each cell after baseline to make computations on\nDim columnsCounter As Long                                                                          ' Columns loop counter\n\nDim greenCell As Double\nDim orangeCell As Double\n\nDim regEx As New RegExp\nDim strPattern As String: strPattern = \"[^0-9.]\"                                                    \nDim strReplace As String: strReplace = \"\"\nWith regEx\n        .Global = True\n        .Pattern = strPattern\nEnd With\n\nnumOfRows = Range(\"A\" &amp; Rows.Count).End(xlUp).Row                                                   \nnumOfColumns = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column                                  \n\nFor rowsCounter = 1 To numOfRows\n    Set metricName = Range(\"A\" &amp; rowsCounter)                                                       \n\n    If metricName.Value = metric Then\n\n        For columnsCounter = 3 To numOfColumns\n\n             If IsNumeric(ws.Cells(rowsCounter, 2)) Then                                            \n                baseline = Math.Abs(ws.Cells(rowsCounter, 2))                                       \n             Else\n                If ws.Cells(rowsCounter, 2) &lt;&gt; \"NA\" And Not IsEmpty(ws.Cells(rowsCounter, 2)) Then\n                    baseline = Math.Abs(regEx.Replace(ws.Cells(rowsCounter, 2), strReplace))\n                End If\n             End If\n\n             If IsNumeric(ws.Cells(rowsCounter, columnsCounter)) Then                                ' Check if cell value is number\n                 newCellValue = Math.Abs(ws.Cells(rowsCounter, columnsCounter))                     \n             Else\n                 If ws.Cells(rowsCounter, columnsCounter) &lt;&gt; \"NA\" And Not IsEmpty(ws.Cells(rowsCounter, columnsCounter)) Then\n                     newCellValue = Math.Abs(regEx.Replace(ws.Cells(rowsCounter, columnsCounter), strReplace))\n                 End If\n             End If\n\n             greenCell = baseline * greenNum\n             orangeCell = baseline * orangeNum\n\n             If newCellValue &gt;= 0 And newCellValue &lt; greenCell And Not IsEmpty(ws.Cells(rowsCounter, columnsCounter)) Then\n                 ws.Cells(rowsCounter, columnsCounter).Interior.Color = RGB(0, 255, 0)\n             ElseIf newCellValue &gt;= greenCell And newCellValue &lt;= orangeCell Then\n                 ws.Cells(rowsCounter, columnsCounter).Interior.Color = RGB(255, 165, 0)\n             ElseIf IsEmpty(ws.Cells(rowsCounter, columnsCounter)) Then\n                 ws.Cells(rowsCounter, columnsCounter).Interior.Color = RGB(255, 255, 255)\n             Else\n                 ws.Cells(rowsCounter, columnsCounter).Interior.Color = RGB(255, 0, 0)\n             End If\n        Next columnsCounter\n    End If\nNext rowsCounter\nEnd Sub\n</code></pre>\n\n<p><strong>Then, I call this code in another sub:</strong></p>\n\n<pre><code>Public Sub runAll()\nApplication.EnableEvents = False\nDim ws As Worksheet\n\nFor Each ws In ThisWorkbook.Worksheets\n    Const a = \"test\"\n    Const b = 1.05\n    Const c = 1.2\n    Call test(a, b, c, ws)\nNext ws\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>When I try to run this macro nothing happens - no errors, no output.</p>\n\n<p>However, when I copy this code to a given Workbook's module and call <code>test()</code> on a button click - everything works perfect.</p>\n\n<p><strong>How can I run macro saved in Personal Workbook without a button?</strong></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1540960401, "post_id": 53076326, "comment_id": 93050517, "body": "Why are you using <code>Activate</code> in a <code>Worksheet_Change</code> event? That would annoy me to no end as a user."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 4484151, "user_type": "registered", "profile_image": "https://graph.facebook.com/1523478967/picture?type=large", "display_name": "Jeff Jensen", "link": "https://stackoverflow.com/users/4484151/jeff-jensen"}, "edited": false, "score": 0, "creation_date": 1540963839, "post_id": 53076397, "comment_id": 93051414, "body": "Thank you Michal! O.PAL&#39;s works great too and that&#39;s what I&#39;m probably going to use, but you kept most of my code intact, which is what I originally asked, so technically you answered the most correctly. I wish I could checkmark both. I really do appreciate your help!"}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": true, "score": 1, "last_activity_date": 1540960674, "creation_date": 1540960674, "answer_id": 53076397, "question_id": 53076326, "link": "https://stackoverflow.com/questions/53076326/vba-modify-insert-date-macro/53076397#53076397", "title": "VBA Modify Insert Date Macro", "body": "<p>I think you just need to an IF checking if the cell to the right is empty or not:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\nWith Target\n    If .Count &gt; 1 Then Exit Sub\n    If Not Intersect(Range(\"A1:A100\"), .Cells) Is Nothing Then\n        Application.EnableEvents = False\n            If IsEmpty(.Value) Then\n                .Offset(0, 1).Activate\n            Else\n                If .Offset(0, 1).Value2 = \"\" Then\n                    With .Offset(0, 1)\n                        .Value = Date\n                    End With\n                End If\n            End If\n            Application.EnableEvents = True\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 4484151, "user_type": "registered", "profile_image": "https://graph.facebook.com/1523478967/picture?type=large", "display_name": "Jeff Jensen", "link": "https://stackoverflow.com/users/4484151/jeff-jensen"}, "edited": false, "score": 0, "creation_date": 1540964498, "post_id": 53076406, "comment_id": 93051637, "body": "Thank you O.PAL! I&#39;m torn on who&#39;s answer to checkmark. I am using your code because I love that it is way simpler than what I started out with, however, Michal actually answered more correctly to how I asked the question by keeping the original code intact - which after seeing your code, I realize that wasn&#39;t necessary. I feel terrible that I can&#39;t checkmark both answers. But what I learned is that I need to ask questions in a manner that&#39;s more open to answers. I appreciate your help very much!"}], "tags": [], "owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "is_accepted": false, "score": 1, "last_activity_date": 1540960737, "creation_date": 1540960737, "answer_id": 53076406, "question_id": 53076326, "link": "https://stackoverflow.com/questions/53076326/vba-modify-insert-date-macro/53076406#53076406", "title": "VBA Modify Insert Date Macro", "body": "<p>This should do</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n    With Target\n        If .Count &gt; 1 Then Exit Sub\n        If Not Intersect(Range(\"T3:T5003\"), .Cells) Is Nothing Then\n            If IsEmpty(.Offset(0, 1)) Then .Offset(0, 1).Value = Date\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 4484151, "user_type": "registered", "profile_image": "https://graph.facebook.com/1523478967/picture?type=large", "display_name": "Jeff Jensen", "link": "https://stackoverflow.com/users/4484151/jeff-jensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 53076397, "answer_count": 2, "score": 2, "last_activity_date": 1540970431, "creation_date": 1540960236, "last_edit_date": 1540970431, "question_id": 53076326, "link": "https://stackoverflow.com/questions/53076326/vba-modify-insert-date-macro", "title": "VBA Modify Insert Date Macro", "body": "<p>There's a lot I like about this script I use to auto-insert the date into next cell over from where I input a value, but I would like if it didn't change a date that already existed.</p>\n\n<p>When I input the initials of whoever finished a job into a cell in range T3:T5003, the date is automatically inserted in the adjacent cell in range U3:U5003. The problem is that I might have to change or modify the entries in T3:T5003 at a later date, but I don't want the original date to change. So I just want this auto-inserting to work only when there is nothing in the adjacent cell.</p>\n\n<p>Here's the code I am using:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\nWith Target\n    If .Count &gt; 1 Then Exit Sub\n    If Not Intersect(Range(\"T3:T5003\"), .Cells) Is Nothing Then\n        Application.EnableEvents = False\n            If IsEmpty(.Value) Then\n                .Offset(0, 1).Activate\n            Else\n                With .Offset(0, 1)\n                    .Value = Date\n                End With\n            End If\n            Application.EnableEvents = True\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>I've tried other scripts that didn't write over an existing date, but they had other problems, and they were difficult for me to understand how they work, so I'm hoping that we can just modify the one I'm using. But I will take anything that works and I really appreciate your help.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 9139573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49628b16c5a4dfa7e26868a23cec863?s=128&d=identicon&r=PG&f=1", "display_name": "MelBee", "link": "https://stackoverflow.com/users/9139573/melbee"}, "edited": false, "score": 0, "creation_date": 1540968588, "post_id": 53077627, "comment_id": 93053094, "body": "I see. Didn&#39;t realize that, as I saw a prepared pivot table which uses the same field name for both values. This was prepared manually though and not by a macro. Thank you for your answer."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 67, "user_id": 9139573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49628b16c5a4dfa7e26868a23cec863?s=128&d=identicon&r=PG&f=1", "display_name": "MelBee", "link": "https://stackoverflow.com/users/9139573/melbee"}, "edited": false, "score": 0, "creation_date": 1540969130, "post_id": 53077627, "comment_id": 93053292, "body": "@MelBee: &quot;uses the same field name for both&quot;: No definitely not. But &quot;AH-values&quot; and &quot;AH-values &quot; are not the same. Note the space behind the second. But this is not good practice at all."}, {"owner": {"reputation": 67, "user_id": 9139573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49628b16c5a4dfa7e26868a23cec863?s=128&d=identicon&r=PG&f=1", "display_name": "MelBee", "link": "https://stackoverflow.com/users/9139573/melbee"}, "edited": false, "score": 0, "creation_date": 1540969454, "post_id": 53077627, "comment_id": 93053416, "body": "Right. That could be the case."}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 1, "last_activity_date": 1540967800, "creation_date": 1540967800, "answer_id": 53077627, "question_id": 53076279, "link": "https://stackoverflow.com/questions/53076279/special-characters-giving-an-error-when-adding-data-fields-for-pivot-table/53077627#53077627", "title": "Special characters giving an error when adding data fields for pivot table?", "body": "<p>The dash is not the problem.</p>\n\n<p>Using </p>\n\n<pre><code>PvtTable.AddDataField PvtTable.PivotFields(\"AH-values\"), \"AH-values\", xlSum\n</code></pre>\n\n<p>you tries creating a new field named \"AH-values\" which is a sum filed for values of the already existing field named \"AH-values\". This is not possible because each field must have it's own unambiguously name.</p>\n\n<p>Thats why </p>\n\n<pre><code>PvtTable.AddDataField PvtTable.PivotFields(\"AHvalues\"), \"AH-values\", xlSum\n</code></pre>\n\n<p>will work because now the new field named \"AH-values\" is a sum filed for values of the already existing field named \"AHvalues\". So field names are not equal.</p>\n\n<p>But </p>\n\n<pre><code>PvtTable.AddDataField PvtTable.PivotFields(\"AH-values\"), \"Sum of AH-values\", xlSum\n</code></pre>\n\n<p>will also work. </p>\n"}], "owner": {"reputation": 67, "user_id": 9139573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49628b16c5a4dfa7e26868a23cec863?s=128&d=identicon&r=PG&f=1", "display_name": "MelBee", "link": "https://stackoverflow.com/users/9139573/melbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 53077627, "answer_count": 1, "score": 0, "last_activity_date": 1586417055, "creation_date": 1540959867, "last_edit_date": 1586417055, "question_id": 53076279, "link": "https://stackoverflow.com/questions/53076279/special-characters-giving-an-error-when-adding-data-fields-for-pivot-table", "title": "Special characters giving an error when adding data fields for pivot table?", "body": "<p>A pivot table that I created adds a data field with a name that contains a dash in it. The error I get is:</p>\n\n<p>Run-time error '1004'. Application-defined or object-defined error.</p>\n\n<p>The line of code is:</p>\n\n<pre><code>PvtTable.AddDataField PvtTable.PivotFields(\"AH-values\"), \"AH-values\", xlSum\n</code></pre>\n\n<p>If I were to remove the \"-\" in the line of code above and in the header of the source data, the code runs as supposed to. How do I keep the \"-\" in the code?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1540960853, "post_id": 53076248, "comment_id": 93050643, "body": "What&#39;s happening? Your code on the surface seems okay. Are you getting any data to your Sheet1 workbook?"}, {"owner": {"reputation": 25, "user_id": 10583858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e706db42615c20a35738bedd1445be?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stokes-Hughes", "link": "https://stackoverflow.com/users/10583858/matt-stokes-hughes"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1540961064, "post_id": 53076248, "comment_id": 93050698, "body": "I&#39;m getting data from every sheet in the source workbooks, whereas i only want to get it from one of the sheets (Data). I&#39;m not sure how to specify to only pull from that one sheet."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1540962483, "post_id": 53076248, "comment_id": 93051005, "body": "I posted an answer. You just need to run the code when the name matches. Please be sure to accept the answer. Welcome to SO."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1540962814, "post_id": 53076248, "comment_id": 93051090, "body": "I see you changed the name of the sheet you need from &quot;DATA&quot; to &quot;Sheet 1&quot;. That shouldn&#39;t matter in the answer, just adjust my code for the line that says <code>if WS.Name = &quot;Sheet 1&quot; Then </code>. Good luck."}, {"owner": {"reputation": 25, "user_id": 10583858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e706db42615c20a35738bedd1445be?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stokes-Hughes", "link": "https://stackoverflow.com/users/10583858/matt-stokes-hughes"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 2, "creation_date": 1540963024, "post_id": 53076248, "comment_id": 93051144, "body": "Thanks heaps for the help, one last thing, is there anyway to shorten the                  ThisWorkbook.Sheets(&quot;sheet1&quot;).Cells(y, 1) = ws.Cells(x, 1) &#39;col 1 lines as i just realised i need to pull 69 different data points"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1540963177, "post_id": 53076248, "comment_id": 93051194, "body": "you could use a loop, but it will only save you 1 line of code. I&#39;ll include in the answer. Thanks for the accept."}], "answers": [{"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 1, "last_activity_date": 1609058941, "last_edit_date": 1609058941, "creation_date": 1540962372, "answer_id": 53076634, "question_id": 53076248, "link": "https://stackoverflow.com/questions/53076248/importing-data-from-specific-excel-sheets-from-multiple-workbooks-in-a-folder/53076634#53076634", "title": "Importing Data from specific excel sheets from multiple workbooks in a folder", "body": "<p>You just need to an if-statement to check the name:</p>\n<pre><code>Sub getDataFromWbs()\n\n  Dim wb As Workbook, ws As Worksheet\n  Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)\n\n  'This is where you put YOUR folder name\n  Set fldr = fso.GetFolder(&quot;C:\\Users\\Matthew.Stokes.Hughe\\Desktop\\test 2\\Temp\\&quot;)\n\n  'Next available Row on Master Workbook\n  y = ThisWorkbook.Sheets(&quot;sheet1&quot;).Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n  'Loop through each file in that folder\n  For Each wbFile In fldr.Files\n\n      'Make sure looping only through files ending in .xlsx (Excel files)\n      If fso.GetExtensionName(wbFile.Name) = &quot;xlsx&quot; Then\n\n        'Open current book\n        Set wb = Workbooks.Open(wbFile.Path)\n\n        'Loop through each sheet (ws)\n        For Each ws In wb.Sheets\n  \n          'check WS name\n          If UCase(ws.Name) = &quot;DATA&quot; Then\n  \n        'Last row in that sheet (ws)\n            wsLR = ws.Cells(Rows.Count, 1).End(xlUp).Row\n\n            'Loop through each record (row 2 through last row)\n            For x = 2 To wsLR\n            \n              Dim c As Long\n              For c = 1 To 4\n              'Put column 1,2,3 and 4 of current sheet (ws) into row y of master sheet, then increase row y to next row\n                  ThisWorkbook.Sheets(&quot;sheet1&quot;).Cells(y, c) = ws.Cells(x, c) 'col 1\n              Next c\n              \n              y = y + 1\n            Next x\n          \n          End If\n          Next ws\n\n        'Close current book\n        wb.Close\n      End If\n\n  Next wbFile\n\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10583858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e706db42615c20a35738bedd1445be?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stokes-Hughes", "link": "https://stackoverflow.com/users/10583858/matt-stokes-hughes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "accepted_answer_id": 53076634, "answer_count": 1, "score": 0, "last_activity_date": 1609058941, "creation_date": 1540959619, "last_edit_date": 1540962609, "question_id": 53076248, "link": "https://stackoverflow.com/questions/53076248/importing-data-from-specific-excel-sheets-from-multiple-workbooks-in-a-folder", "title": "Importing Data from specific excel sheets from multiple workbooks in a folder", "body": "<p>I need to pull the data from specific sheets in multiple excel workbooks into a master copy. I've managed to make one which pulls from every sheet in the workbooks but cant figure out how to make it pull the data from a specified sheet. My code is below:</p>\n\n<pre><code>    Sub getDataFromWbs()\n\n    Dim wb As Workbook, ws As Worksheet\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    'This is where you put YOUR folder name\n    Set fldr = fso.GetFolder(\"C:\\Users\\Matthew.Stokes.Hughe\\Desktop\\test 2\\Temp\\\")\n\n    'Next available Row on Master Workbook\n    y = ThisWorkbook.Sheets(\"sheet1\").Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n    'Loop through each file in that folder\n    For Each wbFile In fldr.Files\n\n        'Make sure looping only through files ending in .xlsx (Excel files)\n        If fso.GetExtensionName(wbFile.Name) = \"xlsx\" Then\n\n          'Open current book\n          Set wb = Workbooks.Open(wbFile.Path)\n\n          'Loop through each sheet (ws)\n          For Each ws In wb.Sheets\n\n          'Last row in that sheet (ws)\n              wsLR = ws.Cells(Rows.Count, 1).End(xlUp).Row\n\n              'Loop through each record (row 2 through last row)\n              For x = 2 To wsLR\n                'Put column 1,2,3 and 4 of current sheet (ws) into row y of master sheet, then increase row y to next row\n                ThisWorkbook.Sheets(\"sheet1\").Cells(y, 1) = ws.Cells(x, 1) 'col 1\n                ThisWorkbook.Sheets(\"sheet1\").Cells(y, 2) = ws.Cells(x, 2) 'col 1\n                ThisWorkbook.Sheets(\"sheet1\").Cells(y, 3) = ws.Cells(x, 3) 'col 1\n                ThisWorkbook.Sheets(\"sheet1\").Cells(y, 4) = ws.Cells(x, 4) 'col 1\n                y = y + 1\n              Next x\n\n            Next ws\n\n          'Close current book\n          wb.Close\n        End If\n\n    Next wbFile\n\n    End Sub\n</code></pre>\n\n<p>The Name of the Specified sheets to draw the information from is Sheet 1.\nAny help would be great!</p>\n"}, {"tags": ["excel", "vba", "error-handling"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1540957591, "post_id": 53075943, "comment_id": 93049881, "body": "<code>i</code> is 0 when you make this call: <code>cell = array1.Cells(i, 1).Value</code>. <code>nRows</code> should also be declared as <code>Long</code> - it can overflow if you have too many rows in the worksheet. You also need to cast <code>cell</code> to a string before you use <code>Len(cell)</code> - otherwise you&#39;ll get the length in bytes of the underlying data type."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1540957837, "post_id": 53075943, "comment_id": 93049925, "body": "<code>cell</code> is also never updated inside the loop. You should also add a check to see if <code>array1</code> actually contains more than one cell."}, {"owner": {"reputation": 3, "user_id": 10583705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IZEgF.jpg?s=128&g=1", "display_name": "Grace L", "link": "https://stackoverflow.com/users/10583705/grace-l"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541006957, "post_id": 53075943, "comment_id": 93074981, "body": "This worked, thanks so much!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10583705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IZEgF.jpg?s=128&g=1", "display_name": "Grace L", "link": "https://stackoverflow.com/users/10583705/grace-l"}, "edited": false, "score": 0, "creation_date": 1541007305, "post_id": 53076211, "comment_id": 93075185, "body": "Hi, how would I convert this to use an array :)"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1541008213, "last_edit_date": 1541008213, "creation_date": 1540959424, "answer_id": 53076211, "question_id": 53075943, "link": "https://stackoverflow.com/questions/53075943/excel-vba-getting-a-value-error-when-trying-to-write-a-function-for-an-array/53076211#53076211", "title": "Excel VBA Getting a #Value error when trying to write a function for an array", "body": "<p>Several issues in your code. </p>\n\n<ul>\n<li>First, you never assign <code>i</code> before you call <code>cell = array1.Cells(i, 1).Value</code>. That's going to be a run-time error 1004.</li>\n<li>Second, you should test the input <code>Range</code> to make sure it's an \"array\" before you do anything else. If it's a single cell, you can skip everything else and just return the text of that cell.</li>\n<li>Third, you never update the value of <code>cell</code> anywhere in your function - it will always be the uninitialized value of <code>vbNullString</code>.</li>\n<li>Fourth, the maximum cell text length is 32767 characters, not 100. You should use that as your initial value.</li>\n</ul>\n\n<p>My guess is that you're looking for something more like this:</p>\n\n<pre><code>Option Explicit\n\nPublic Function ShortestString(ByVal target As Range) As String\n    Dim rowCount As Long, columnCount As Long\n    rowCount = target.Rows.Count\n    columnCount = target.Columns.Count\n\n    If rowCount = 1 And columnCount = 1 Then\n        ShortestString = target.Text\n        Exit Function\n    End If\n\n    Dim rowIdx As Long, colIdx As Long\n    Dim shortest As String, current As String\n    shortest = String(32767, \" \")\n\n    For rowIdx = 1 To rowCount\n        For colIdx = 1 To columnCount\n            current = target.Cells(rowIdx, colIdx).Text\n            If Len(current) &lt;= Len(shortest) Then\n                shortest = current\n            End If\n        Next\n    Next\n\n    ShortestString = shortest\nEnd Function\n</code></pre>\n\n<p>Note that you can probably actually <em>use</em> an array instead of testing individual cells, but that's an optimization you can make if the performance isn't up to snuff.</p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>You can convert the function to use an array of cell values by reading the entire range into a <code>Variant()</code>:</p>\n\n<pre><code>Dim cellValues() As Variant\ncellValues = target.Value\n\nFor rowIdx = 1 To rowCount\n    For colIdx = 1 To columnCount\n        current = CStr(cellValues(rowIdx, colIdx))\n        If Len(current) &lt;= Len(shortest) Then\n            shortest = current\n        End If\n    Next\nNext\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10583705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IZEgF.jpg?s=128&g=1", "display_name": "Grace L", "link": "https://stackoverflow.com/users/10583705/grace-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 53076211, "answer_count": 1, "score": 0, "last_activity_date": 1586417091, "creation_date": 1540957289, "last_edit_date": 1586417091, "question_id": 53075943, "link": "https://stackoverflow.com/questions/53075943/excel-vba-getting-a-value-error-when-trying-to-write-a-function-for-an-array", "title": "Excel VBA Getting a #Value error when trying to write a function for an array", "body": "<p>I am trying to find the shortest string in an array from a worksheet. However, when I try to execute the function I get a #Value error. What am I doing wrong? Thanks! </p>\n\n<pre><code>Function ShortestString(ByVal array1 As Range)\n\nDim nRows As Integer\nDim i As Integer\nDim cell As String\nDim cellLength As Integer\nDim string1 As String\n\nnRows = array1.Rows.Count\ncellLength = 100\ncell = array1.Cells(i, 1).Value\n\nFor i = 1 To nRows\n    If cellLength &gt; Len(cell) Then\n    cellLength = Len(cell)\n    string1 = cell\n    End If\nNext i\n\nShortestString = string1\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 9752052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/63wcI.png?s=128&g=1", "display_name": "Aritra Karak", "link": "https://stackoverflow.com/users/9752052/aritra-karak"}, "is_accepted": false, "score": 0, "last_activity_date": 1541086457, "creation_date": 1541086457, "answer_id": 53104469, "question_id": 53075782, "link": "https://stackoverflow.com/questions/53075782/refresh-excel-to-see-other-user-changes-on-shared-file-using-vba/53104469#53104469", "title": "Refresh Excel to see Other User Changes on Shared File using VBA", "body": "<p>Your can take a look at these links</p>\n\n<p>StackExchange Superuser - <a href=\"https://superuser.com/questions/440187/is-there-a-way-to-get-a-shared-spreadsheet-to-update-without-closing-and-reopeni\">https://superuser.com/questions/440187/is-there-a-way-to-get-a-shared-spreadsheet-to-update-without-closing-and-reopeni</a></p>\n\n<p>Microsoft Official documentation - <a href=\"https://support.office.com/en-us/article/about-the-shared-workbook-feature-49b833c0-873b-48d8-8bf2-c1c59a628534?ocmsassetID=HP010342985&amp;CTT=1&amp;CorrelationId=5c14f8f1-c6b5-443c-82d2-c05abfc4b950&amp;ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/about-the-shared-workbook-feature-49b833c0-873b-48d8-8bf2-c1c59a628534?ocmsassetID=HP010342985&amp;CTT=1&amp;CorrelationId=5c14f8f1-c6b5-443c-82d2-c05abfc4b950&amp;ui=en-US&amp;rs=en-US&amp;ad=US</a></p>\n\n<p>Hope those will solve your problem !</p>\n"}], "owner": {"reputation": 1, "user_id": 10583686, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ABc6SVETWwQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCP2aYxnEmhbj2KQd0Ctok0MOlMkw/mo/photo.jpg?sz=128", "display_name": "Yoel Misrachi", "link": "https://stackoverflow.com/users/10583686/yoel-misrachi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 821, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1541086457, "creation_date": 1540955887, "last_edit_date": 1540956017, "question_id": 53075782, "link": "https://stackoverflow.com/questions/53075782/refresh-excel-to-see-other-user-changes-on-shared-file-using-vba", "title": "Refresh Excel to see Other User Changes on Shared File using VBA", "body": "<p>I know this been asked before but it seems no one was able to provide a real solution. As of right now Excel allows you to set a setting for Shared Workbooks to automatically Update Changes and see Other User changes every 5 minutes. I'm looking for a way to lower this to 1 minute or less. So, I was wondering if there is any VBA function/command to force through this Refresh from perhaps the click of a button? Please Help!</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541038280, "post_id": 53092753, "comment_id": 93085306, "body": "Hi @dmitry, Thank you for replying. I don&#39;t really get what do you mean by listen for it. Any codes that I need to change. Sorry that I kind of new with Class Module."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541038687, "post_id": 53092753, "comment_id": 93085390, "body": "Declare a global Items &quot;with events&quot; (like you do with obj_OL) variable and provide the ItemAdd event handler. Items collection comes from MAPIFolder.Items, and MAPIFolder is retrieved from  Namespace.GetDEfaultFolder(olFolderSentMail)"}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541053554, "post_id": 53092753, "comment_id": 93088447, "body": "I am really sorry I don&#39;t get what you mean. This is my attempt. I am really sorry because I dont have any background with this.  Public WithEvents obj_OL As Outlook.Application Private Sub obj_OL_ItemAdd(ByVal Item As Object, Cancel As Boolean)     Item.ItemAdd Namespace.GetDefaultFolder(olFolderSentMail)     Set obj_OL = Nothing     Set outMail = Nothing End Sub"}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541056058, "post_id": 53092753, "comment_id": 93089294, "body": "thank you dmitry. I tried and there is error with the set objItems =Application.Session.GetDefaultFolder(olFolderSentMail).Item&zwnj;&#8203;s said that it is invalid outside procedure. Where should I put it? should be inside my subprocedure in the module?"}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541129420, "post_id": 53092753, "comment_id": 93119540, "body": "I dont know where to put the set objItems = Application.Session.GetDefaultFolder(olFolderSentMail).Items because I put it outside the subprocedure. And it said invalid outside procedure. Where should I put this line?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541179759, "post_id": 53092753, "comment_id": 93141250, "body": "You can add it to your SendEmail sub."}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541383363, "post_id": 53092753, "comment_id": 93185924, "body": "However, there is an error on line 7, please see the edit above. Set OutMail = cls_OL.objItems.CreateItem(0) &#39; ERROR HERE"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541476040, "post_id": 53092753, "comment_id": 93221116, "body": "That line must be Set OutMail = objItems.Add"}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541584539, "post_id": 53092753, "comment_id": 93263487, "body": "Hi @Dmitry. I change it to OutMail=objItems.Add, however, it selected objItems and mentioned variable not defined."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541629153, "post_id": 53092753, "comment_id": 93286034, "body": "Did you miss the &quot;Set&quot; keyword? You also need to declare the OutMail variable."}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541638935, "post_id": 53092753, "comment_id": 93288801, "body": "No I didn&#39;t miss the set keyword and I declare outmail like the edited part above."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541655295, "post_id": 53092753, "comment_id": 93292415, "body": "The previous line needs to be &quot;Set objItems =Application.Session.GetDefaultFolder(olFolderSentMail).Item&zwnj;&#8203;s&quot;"}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541658641, "post_id": 53092753, "comment_id": 93293273, "body": "It highlighted objItems for this line Set objItems = Application.Session.GetDefaultFolder(olFolderSentMail).Items and mentioned it is not defined."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541686494, "post_id": 53092753, "comment_id": 93306959, "body": "Yes, you need to declare (dim) objItems variable.either as Outlook.Items or as a generic Object."}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541727366, "post_id": 53092753, "comment_id": 93324733, "body": "Hi @Dmitry The code is after i declared Dim objItems as Outlook.Items running, however, nothing happened. I did a debugging and when my cursor go to Set objItems = Application.Session.GetDefaultFolder(olFolderSentMail).Items , the objItems shows =&#39;Nothing&#39;. Is there anything I should do?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541728098, "post_id": 53092753, "comment_id": 93324870, "body": "I assumed you added Outlook to your project references? Try to replace olFolderSentMail with 5."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541728156, "post_id": 53092753, "comment_id": 93324887, "body": "Also, is Outlook running at the time your code is executed? Do you have &quot;on error resume next&quot; anywhere in your code? Get rid of that."}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541736718, "post_id": 53092753, "comment_id": 93326729, "body": "Yes, for the tools--&gt;reference I checked the Microsoft Outlook 15.0 Object Library. I replace the olFolderSentMail to 5, deleted all the on error resume next but now highlighted the set objItems and mentioned &#39;object doesnt support this propert or method&#39;. Outlook is always running when I use my laptop."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1541738446, "post_id": 53092753, "comment_id": 93327083, "body": "If you are running in Excel VBA, the Application intrinsic variable points to Excel.Application, not Outlook.Application. Introduce new variable (objApp?), initialize it using set objApp = CreateObject(&quot;Outlook.Application&quot;), and use objApp instead of Application."}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1542165891, "post_id": 53092753, "comment_id": 93466832, "body": "I have added dim objApp as object and set set objApp = CreateObject(&quot;Outlook.Application&quot;). In addition change the dim objItems as items and Set objItems = objApp.Session.GetDefaultFolder(olFolderSentMail).Items. It runs successfully but there is no email .msg in the local folder. Have edited above code as well."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1542172933, "post_id": 53092753, "comment_id": 93468390, "body": "Get rid of the &quot;On Error Resume Next&quot; line to see which line produces an error."}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1542178202, "post_id": 53092753, "comment_id": 93470059, "body": "The think is there is no &#39;on error....&#39; line inside my code. The code is running fine. however when out a pointer(use for debugging) at the classmodule, the codes didnt stop there. I am assuming the classmodule code is not running at all."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1542214408, "post_id": 53092753, "comment_id": 93491140, "body": "That line is just below the &quot;With OutMail&quot; line."}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1542619048, "post_id": 53092753, "comment_id": 93618789, "body": "Hi Dmitry, forget to remove it here. But I removed it from the original file. It is still running fine but classmodule did not run at all."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1542643095, "post_id": 53092753, "comment_id": 93632317, "body": "Why are you adding the (draft) message to the Sent Items folder?"}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1542789594, "post_id": 53092753, "comment_id": 93690947, "body": "I dont get what you mean. I dont want to add the draft message to sent items folder. I want to save the sent message to our local drive folder."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1542811611, "post_id": 53092753, "comment_id": 93703554, "body": "But that it what your code does: Set objItems = objApp.Session.GetDefaultFolder(olFolderSentMail).Items Set OutMail = objItems.Add"}, {"owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "edited": false, "score": 0, "creation_date": 1542856473, "post_id": 53092753, "comment_id": 93721118, "body": "I follow your instruction for that part. So it is not to do what I wanted to do? I really need your enlightenment."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1541054110, "last_edit_date": 1541054110, "creation_date": 1541024458, "answer_id": 53092753, "question_id": 53075690, "link": "https://stackoverflow.com/questions/53075690/save-email-as-msg-in-local-windows-folder-using-excel-vba/53092753#53092753", "title": "Save email as .msg in local windows folder using Excel VBA", "body": "<p>You can listen for the <code>Items.ItemAdd</code> event on the Sent Items folder (you can retrieve it using <code>Namespace.GetDEfaultFolder(olFolderSentMail)</code>).</p>\n\n<p><strong>EDIT</strong>: off the top of my head:</p>\n\n<pre><code>public WithEvents objItems As Outlook.Items\nset objItems = Application.Session.GetDefaultFolder(olFolderSentMail).Items\n...\nPrivate objItems_ItemAdd(ByVal Item As Object)\n  Item.SaveAs Emailpath\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10521839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e607b1725dfedbf7ecdc6c3d413b9b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Chew", "link": "https://stackoverflow.com/users/10521839/brian-chew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3613, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542618978, "creation_date": 1540955130, "last_edit_date": 1542618978, "question_id": 53075690, "link": "https://stackoverflow.com/questions/53075690/save-email-as-msg-in-local-windows-folder-using-excel-vba", "title": "Save email as .msg in local windows folder using Excel VBA", "body": "<p>I want to save email in my local folder using Excel VBA.</p>\n\n<p>I saw this link <a href=\"https://www.mrexcel.com/forum/excel-questions/361751-vba-saving-email-only-after-send-pushed.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/excel-questions/361751-vba-saving-email-only-after-send-pushed.html</a> which uses a class module to save the email. It stores the email at the same time it opens it for display. The email saved is the draft email. You can still edit the saved .msg file.</p>\n\n<p>How would I wait until the email is sent? Presumably once it detects the email in the Outlook 'Sent Items' folder?</p>\n\n<pre><code>Dim cls_OL As New clsOutlook\nPublic outMail As Outlook.MailItem\nPublic Emailpath As String\n\nSub SendEmail()\nDim objItems As Items\nDim objApp As Object\nSet objApp = CreateObject(\"Outlook.Application\")\nSet cls_OL.obj_OL = GetObject(Class:=\"Outlook.Application\")\nSet OutMail = objItems.Add\nEmailpath = \"V:\\test\\emailname.msg\"\nWith OutMail\nOn Error Resume Next\n    .HTMLBody = \"Hi All, This is test email\" \n    .to = \"test@test.com\"\n    .CC = vbnullstring\n    .BCC = vbnullstring\n    .Subject = \"A Subject\"\n    .Display\nEnd With\nSet OutMail = Nothing\nEnd Sub\n</code></pre>\n\n<p>.</p>\n\n<pre><code>Option Explicit\nPublic WithEvents obj_OL As Outlook.Application\n\nPrivate Sub obj_OL_ItemSend(ByVal Item As Object, Cancel As Boolean)\n  Item.SaveAs Emailpath\n  Set obj_OL = Nothing\n  Set outMail = Nothing\nEnd Sub\n</code></pre>\n\n<p>This is the email that is being saved:\n<a href=\"https://i.stack.imgur.com/WaY0u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WaY0u.png\" alt=\"Draft Email\"></a></p>\n\n<p>This is what I want to save:\n<a href=\"https://i.stack.imgur.com/hua5i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hua5i.png\" alt=\"Sent Email\"></a></p>\n\n<p>Edit with the suggestion from Dmitry</p>\n\n<pre><code>Dim cls_OL As New clsOutlook\nPublic outMail As Outlook.MailItem\nPublic Emailpath As String\n\nSub SendEmail()\nDim objItems As Items\nDim Emailpath as string\nDim objApp as object\nSet objApp = CreateObject(\"Outlook.Application\")\nSet objItems = objApp.Session.GetDefaultFolder(olFolderSentMail).Items\nSet OutMail = objItems.Add \nEmailpath = \"V:\\test\\emailname.msg\"\nWith OutMail\n\n    .HTMLBody = \"Hi All, This is test email\" \n    .to = \"test@test.com\"\n    .CC = vbnullstring\n    .BCC = vbnullstring\n    .Subject = \"A Subject\"\n    .Display\nEnd With\nSet OutMail = Nothing\nEnd Sub\n</code></pre>\n\n<p>.</p>\n\n<pre><code>Option Explicit\nPublic WithEvents objItems As Outlook.Application\n\nPrivate Sub objItems_ItemAdd(ByVal Item As Object)\n  Item.SaveAs Emailpath\n  Set obj_OL = Nothing\n  Set outMail = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1540951781, "post_id": 53075242, "comment_id": 93048737, "body": "The time portion has been trimmed off, though. Instead of using <code>Format</code>, change the cell&#39;s <code>NumberFormat</code>. That said, <code>lastRow</code> and <code>rw</code> should be <code>Long</code> instead of <code>Integer</code>, and there are more robust ways to find the last row."}, {"owner": {"reputation": 5, "user_id": 10575678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47983d1aa59ac85070bd82b2afd4a27?s=128&d=identicon&r=PG&f=1", "display_name": "TepidSecretHack", "link": "https://stackoverflow.com/users/10575678/tepidsecrethack"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1540954504, "post_id": 53075242, "comment_id": 93049323, "body": "@BigBen how would you suggest fixing up how to define the lastRow variable?"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1540954442, "post_id": 53075609, "comment_id": 93049314, "body": "If that&#39;s all you&#39;re doing, you don&#39;t need a loop. <code>Range(&quot;A2:A&quot; &amp; lastRow).NumberFormat = &quot;yyyy-mm-dd&quot;</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540955656, "post_id": 53075609, "comment_id": 93049530, "body": "@Comintern even better."}, {"owner": {"reputation": 5, "user_id": 10575678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47983d1aa59ac85070bd82b2afd4a27?s=128&d=identicon&r=PG&f=1", "display_name": "TepidSecretHack", "link": "https://stackoverflow.com/users/10575678/tepidsecrethack"}, "edited": false, "score": 0, "creation_date": 1540956349, "post_id": 53075609, "comment_id": 93049642, "body": "Ok definitely overthinking things then. This helps a ton, thanks!"}], "tags": [], "owner": {"reputation": 5, "user_id": 10575678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47983d1aa59ac85070bd82b2afd4a27?s=128&d=identicon&r=PG&f=1", "display_name": "TepidSecretHack", "link": "https://stackoverflow.com/users/10575678/tepidsecrethack"}, "is_accepted": false, "score": 0, "last_activity_date": 1540954396, "creation_date": 1540954396, "answer_id": 53075609, "question_id": 53075242, "link": "https://stackoverflow.com/questions/53075242/vba-why-wont-my-datevalue-function-trim-off-the-time-for-some-rows/53075609#53075609", "title": "(VBA) Why won&#39;t my DateValue function trim off the time for some rows?", "body": "<p>Using the NumberFormat function suggested by @BigBen instead, I was able to cut out quite a bit more code and not have to bother with creating a new column </p>\n\n<pre><code>Sub test()\n    Dim lastRow As Long\n    lastRow = ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Row\n\n    For Each cell In Range(\"A2:A\" &amp; lastRow)\n        cell.NumberFormat = \"yyyy-mm-dd\"\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1540956478, "last_edit_date": 1540956478, "creation_date": 1540954758, "answer_id": 53075640, "question_id": 53075242, "link": "https://stackoverflow.com/questions/53075242/vba-why-wont-my-datevalue-function-trim-off-the-time-for-some-rows/53075640#53075640", "title": "(VBA) Why won&#39;t my DateValue function trim off the time for some rows?", "body": "<p>If all you're doing is changing number formatting (<em>which doesn't at all discard the time portion of the date</em>), perhaps something like the following:</p>\n\n<pre><code>Sub Test()\n    With ActiveSheet\n        .Range(.Range(\"A2\"), .Cells(.Rows.Count, 1).End(xlUp)).NumberFormat = \"yyyy-mm-dd\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>Or format the whole column in one go, as suggested by @Comintern:</p>\n\n<pre><code>Sub Test\n    ActiveSheet.Range(\"A:A\").NumberFormat = \"yyyy-mm-dd\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10575678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47983d1aa59ac85070bd82b2afd4a27?s=128&d=identicon&r=PG&f=1", "display_name": "TepidSecretHack", "link": "https://stackoverflow.com/users/10575678/tepidsecrethack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 53075640, "answer_count": 2, "score": 0, "last_activity_date": 1540956478, "creation_date": 1540951186, "last_edit_date": 1540951368, "question_id": 53075242, "link": "https://stackoverflow.com/questions/53075242/vba-why-wont-my-datevalue-function-trim-off-the-time-for-some-rows", "title": "(VBA) Why won&#39;t my DateValue function trim off the time for some rows?", "body": "<p>I'm just manipulating some of my step data throughout the year, but I'm seriously wondering where I've gone wrong with the date function. Why does the DateValue function work the way I want up until row 2804? After that point, it just keeps the \"0:00\" along with the date. </p>\n\n<p>The data in column A looks the same throughout the entire spreadsheet, so I'm not sure where else to dig around, and if anyone has encountered this before.</p>\n\n<p><img src=\"https://i.stack.imgur.com/iw2k1.png\" alt=\"Sample step counter export data\"></p>\n\n<pre><code>Sub test()\n    Dim x As Range, lastRow As Integer, rw As Integer\n    lastRow = ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Row\n    Set x = Range(\"B2:B\" &amp; lastRow)\n\n    For Each cell In x\n        rw = cell.Row\n        cell.Value = Format(DateValue(Range(\"A\" &amp; rw).Value), \"yyyy-mm-dd\")\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "normal-distribution"], "comments": [{"owner": {"reputation": 224, "user_id": 1174045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04b4512536cd6effdcaee62480db1522?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/1174045/jon"}, "edited": false, "score": 1, "creation_date": 1540966624, "post_id": 53074786, "comment_id": 93052321, "body": "you might want to check JackBean&#39;s response on <a href=\"https://www.mrexcel.com/forum/excel-questions/477702-generating-skewed-normal-distribution-random-numbers.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a> - it doesn&#39;t quite match your desired shapes but you can easily get a front loaded and back loaded distribution by editing the STDIN, AVGIN, START and END fields (in your example you&#39;d want 10 bins)"}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 4, "creation_date": 1541004194, "post_id": 53074786, "comment_id": 93073557, "body": "Really good <i>presentation</i> of your question!!! :)"}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "reply_to_user": {"reputation": 224, "user_id": 1174045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04b4512536cd6effdcaee62480db1522?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/1174045/jon"}, "edited": false, "score": 1, "creation_date": 1541022759, "post_id": 53074786, "comment_id": 93081662, "body": "@Jon - The difference between Jackbean&#39;s response and desired solution is that there are numerous ways to generate random numbers but those random numbers sums to desired value is what I am after. So Input should be 3 variables: (Bins, Total Cost, Front/Back) and Total Cost needs to be distributed in Bins in Front or Back manner. Jackbean&#39;s response has no control over the Total Sum."}, {"owner": {"reputation": 224, "user_id": 1174045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04b4512536cd6effdcaee62480db1522?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/1174045/jon"}, "edited": false, "score": 1, "creation_date": 1541042594, "post_id": 53074786, "comment_id": 93086121, "body": "@jainashish  You enter the total count in cell B3 (the &quot;Select&quot; variable). Then the count column will give you a distribution totalling that value. It&#39;s perhaps not very clear that this is what will happen though as the formulae are a bit abstract"}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "reply_to_user": {"reputation": 224, "user_id": 1174045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04b4512536cd6effdcaee62480db1522?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/1174045/jon"}, "edited": false, "score": 0, "creation_date": 1541049400, "post_id": 53074786, "comment_id": 93087349, "body": "You are right @Jon, it does but it creates a zig-zag patterns in the chart (See the updated question). The culprit is usage of RAND() in Column F. Any workaround for it?"}, {"owner": {"reputation": 224, "user_id": 1174045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04b4512536cd6effdcaee62480db1522?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/1174045/jon"}, "edited": false, "score": 0, "creation_date": 1541052298, "post_id": 53074786, "comment_id": 93088039, "body": "@jainashish yeah increasing the select seems to smooth the curve. Try with 10000 as the select, 5 with the skew, and everything else as you&#39;ve defined with your screenshot"}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "reply_to_user": {"reputation": 224, "user_id": 1174045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04b4512536cd6effdcaee62480db1522?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/1174045/jon"}, "edited": false, "score": 0, "creation_date": 1541052900, "post_id": 53074786, "comment_id": 93088235, "body": "@Jon - Yes but it created another problem, a large number of bins towards the skewness goes empty (that fills with 0). Each bin must have some value."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1541178503, "post_id": 53074786, "comment_id": 93140662, "body": "Possible solution is to choose the bin with 0 Z-score value and adjust step value on left and right side of it (<code>=B5-IF(A6&lt;=$B$3;$B$5&#47;$B$3;$B$5&#47;($B$2-$B$3))</code>). Then you have to use non-cummulative <code>=NORM.S.DIST(B6;FALSE)</code> in <code>C</code> and <code>=$B$1*C6&#47;SUM($C$6:$C$35)</code> in <code>D</code>. <a href=\"https://i.imgur.com/toi7V0h.png\" rel=\"nofollow noreferrer\">Effect</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1331, "user_id": 10498111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd0523c4e1cb82448b30957581803a6?s=128&d=identicon&r=PG&f=1", "display_name": "usmanhaq", "link": "https://stackoverflow.com/users/10498111/usmanhaq"}, "is_accepted": true, "score": 8, "last_activity_date": 1541159270, "creation_date": 1541159270, "answer_id": 53118036, "question_id": 53074786, "link": "https://stackoverflow.com/questions/53074786/front-loaded-and-back-loaded-normal-distribution-column-chart-and-s-curves-in/53118036#53118036", "title": "Front Loaded and Back Loaded | Normal Distribution Column Chart and S Curves in Excel", "body": "<p>You can generate the curve using below methods and can use the numbers generated by them for your requirement.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZFyVA.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/ZFyVA.png\" alt=\"enter image description here\"></a></p>\n\n<p>With formulae</p>\n\n<p><a href=\"https://i.stack.imgur.com/D8MW7.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/D8MW7.png\" alt=\"enter image description here\"></a></p>\n\n<p>The curve</p>\n\n<p><a href=\"https://i.stack.imgur.com/bMXJs.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/bMXJs.png\" alt=\"enter image description here\"></a></p>\n\n<p>Notes:</p>\n\n<ol>\n<li>If you want to change the bins you have to drag the cells down or up\nin order to complete the series</li>\n<li>If you want to change the total cost, you can change the multiplier</li>\n<li>If you want to change the tilting of the curve you can change the\ndivider in column C which is currently set to 2, if it is -2 the tilt\nwill change direction, you can experiment with different numbers,\nthe direction depends upon either it is less than zero or greater\nthan zero</li>\n</ol>\n\n<p>For copy past</p>\n\n<pre><code>=A2+180/($G$3-1)\n=RADIANS(A2)\n=$G$4*SIN(B2 + SIN(B2)/2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 246, "user_id": 9361443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adec54ed9e27194eaa721d4f8079d40?s=128&d=identicon&r=PG&f=1", "display_name": "shash", "link": "https://stackoverflow.com/users/9361443/shash"}, "is_accepted": false, "score": 2, "last_activity_date": 1541193472, "creation_date": 1541193472, "answer_id": 53125909, "question_id": 53074786, "link": "https://stackoverflow.com/questions/53074786/front-loaded-and-back-loaded-normal-distribution-column-chart-and-s-curves-in/53125909#53125909", "title": "Front Loaded and Back Loaded | Normal Distribution Column Chart and S Curves in Excel", "body": "<p>I used the actual mathematical formulas to arrive at the result. It looks like to me what you wanted to achieve. The orange cells in 'Skewed' section are the ones which can be changed to vary the degree and direction of skew. Some pictures for demonstration are below, followed by the formulas used.</p>\n\n<p><a href=\"https://i.stack.imgur.com/onwFP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/onwFP.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/oBztS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oBztS.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Tjhze.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Tjhze.png\" alt=\"enter image description here\"></a></p>\n\n<p>Formulas in row 5, column</p>\n\n<p>B:<code>=(A5*$A$2)+0</code>  (0 is the mean, you can change as you like)</p>\n\n<p>C:<code>=(1/($A$2* SQRT(2*PI())))*EXP(-(B5^2)/2)</code></p>\n\n<p>D:<code>=0.5*(1+ERF(B5/SQRT(2)))</code></p>\n\n<p>E:<code>=$A$1*C5</code></p>\n\n<p>F: <code>=(A5*$A$2*(1+$F$2*SIN((F4*PI())/(2*$F$4))))+0</code>  (0 is the mean, you can change as you like)</p>\n\n<p>G:<code>=(1/($A$2* SQRT(2*PI())))*EXP(-((F5+$G$2)^2)/2)</code></p>\n\n<p>H:<code>=0.5*(1+ERF((B5+$G$2)/SQRT(2)))</code></p>\n\n<p>I:<code>=$A$1*G5</code></p>\n"}, {"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1541288891, "last_edit_date": 1541288891, "creation_date": 1541287053, "answer_id": 53136365, "question_id": 53074786, "link": "https://stackoverflow.com/questions/53074786/front-loaded-and-back-loaded-normal-distribution-column-chart-and-s-curves-in/53136365#53136365", "title": "Front Loaded and Back Loaded | Normal Distribution Column Chart and S Curves in Excel", "body": "<p>If you are open to a Python answer the I can give you the code to get Python Pandas libary to generate the random observations from a skewed Normal and then bin (bucket) them for you.  The following in a Python script which captures the use case but also can be created using COM and so creatable from VBA.</p>\n\n<pre><code>import numpy as np\nimport pandas as pd\nfrom scipy.stats import skewnorm\n\nclass PythonSkewedNormal(object):\n    _reg_clsid_ = \"{1583241D-27EA-4A01-ACFB-4905810F6B98}\"\n    _reg_progid_= 'SciPyInVBA.PythonSkewedNormal'\n    _public_methods_ = ['GeneratePopulation','BinnedSkewedNormal']\n\n    def GeneratePopulation(self,a, sz):\n        # https://docs.scipy.org/doc/numpy-1.15.1/reference/generated/numpy.random.seed.html\n        np.random.seed(10);\n        #https://docs.scipy.org/doc/scipy-0.19.1/reference/generated/scipy.stats.skewnorm.html\n        return skewnorm.rvs(a, size=sz).tolist();\n\n    def BinnedSkewedNormal(self,a, sz, bins):\n        # https://docs.scipy.org/doc/numpy-1.15.1/reference/generated/numpy.random.seed.html\n        np.random.seed(10);\n        #https://docs.scipy.org/doc/scipy-0.19.1/reference/generated/scipy.stats.skewnorm.html\n        pop = skewnorm.rvs(a, size=sz); #.tolist();\n        bins2 = np.array(bins)\n        bins3 = pd.cut(pop,bins2)\n\n        table = pd.value_counts(bins3, sort=False)\n\n        table.index = table.index.astype(str)\n\n        return table.reset_index().values.tolist();\n\nif __name__=='__main__':\n    print (\"Registering COM server...\")\n    import win32com.server.register\n    win32com.server.register.UseCommandLine(PythonSkewedNormal)\n</code></pre>\n\n<p>And the VBA client code </p>\n\n<pre><code>Option Explicit\n\nSub TestPythonSkewedNormal()\n\n    Dim skewedNormal As Object\n    Set skewedNormal = CreateObject(\"SciPyInVBA.PythonSkewedNormal\")\n\n    Dim lSize As Long\n    lSize = 100\n\n    Dim shtData As Excel.Worksheet\n    Set shtData = ThisWorkbook.Worksheets.Item(\"Sheet3\") '&lt;--- change sheet to your circumstances\n    shtData.Cells.Clear\n\n    Dim vBins\n    vBins = Array(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)\n\n    'Stop\n    Dim vBinnedData\n    vBinnedData = skewedNormal.BinnedSkewedNormal(-5, lSize, vBins)\n\n    Dim rngData As Excel.Range\n    Set rngData = shtData.Cells(2, 1).Resize(UBound(vBins) - LBound(vBins), 2)\n\n    rngData.Value2 = vBinnedData\n\n    'Stop\n\nEnd Sub\n</code></pre>\n\n<p>Sample output</p>\n\n<pre><code>(-5, -4]        0\n(-4, -3]        0\n(-3, -2]        4\n(-2, -1]       32\n(-1, 0]        57\n(0, 1]          7\n(1, 2]          0\n(2, 3]          0\n(3, 4]          0\n(4, 5]          0\n</code></pre>\n\n<p>Original code deposited on <a href=\"https://exceldevelopmentplatform.blogspot.com/2018/11/python-revisited-grouping-data-from.html\" rel=\"nofollow noreferrer\">my blog</a></p>\n"}, {"tags": [], "owner": {"reputation": 224, "user_id": 1174045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04b4512536cd6effdcaee62480db1522?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/1174045/jon"}, "is_accepted": false, "score": 2, "last_activity_date": 1541374325, "creation_date": 1541374325, "answer_id": 53146535, "question_id": 53074786, "link": "https://stackoverflow.com/questions/53074786/front-loaded-and-back-loaded-normal-distribution-column-chart-and-s-curves-in/53146535#53146535", "title": "Front Loaded and Back Loaded | Normal Distribution Column Chart and S Curves in Excel", "body": "<p>If you want to make sure the bins always have a value in them, you can use the following approach, which uses normal distributions and simply changes the mean and the standard deviation to get a curve that you want.</p>\n\n<p>Changing the mean moves the peak to the left or right. Changing the standard deviation makes the quantities more uniform or more variable. I've used 0-1000 as my default range in the example below, but it should be easy to modify the formula to bring any value you want. NOTE in order to fulfill your requirement that all bins must be non-zero, you need to manually adjust the numbers till you get a curve that suits.</p>\n\n<p>Yellow cells are for data entry, green cells are a count (so if you add bins, they would need to be numbered according to the sequence).</p>\n\n<p><a href=\"https://i.stack.imgur.com/mEIlE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mEIlE.png\" alt=\"normal and skewed distribution examples\"></a></p>\n\n<p>Formula in cell B7 (copied down to cell B16):\n<code>=NORMDIST($A7*1000/MAX($A$6:$A$17),$B$3,$B$4,TRUE)-NORMDIST($A6*1000/MAX($A$6:$A$17),$B$3,$B$4,TRUE)</code></p>\n\n<p>Formula in cell C7 (copied down to cell C16):\n<code>=IF(A7=MAX($A$6:$A$17),$C$5-SUM(C$6:C6),ROUND(B7/SUM($B$7:$B$17)*$C$5,0))</code></p>\n\n<p>Adding new bins is simple enough and is still based on a 0-1000 range, so you don't need to change any numbers other than adding rows and copying down the formulae:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JFNNb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JFNNb.png\" alt=\"skewed distribution with more bins\"></a></p>\n\n<p>The above example is also showing how a narrow standard deviation and a high mean combine to make the starting bins have very little quantity. But there is still a value (as long as count is big enough).</p>\n\n<p>You may want to pre-define the different skewness selections if this is going to be used by other people (make column B dependent on a lookup, for example) but hopefully this is extensible enough for your needs.</p>\n"}, {"tags": [], "owner": {"reputation": 462, "user_id": 9199778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ow6QaNEy6pU/AAAAAAAAAAI/AAAAAAAAALI/lRmYPhJ9yRo/photo.jpg?sz=128", "display_name": "Amit Panasara", "link": "https://stackoverflow.com/users/9199778/amit-panasara"}, "is_accepted": false, "score": 0, "last_activity_date": 1576234882, "creation_date": 1576234882, "answer_id": 59321224, "question_id": 53074786, "link": "https://stackoverflow.com/questions/53074786/front-loaded-and-back-loaded-normal-distribution-column-chart-and-s-curves-in/59321224#59321224", "title": "Front Loaded and Back Loaded | Normal Distribution Column Chart and S Curves in Excel", "body": "<p>Based on @usmanhaq 's ans, vba macro made for distribution curve simulation. Corrected for 100% scaling of front &amp; backloading curve. \n<a href=\"https://github.com/apanasara/Distribution_Curve_Sergemntation_with_sum_100percnt\" rel=\"nofollow noreferrer\">click here to go Github Lib</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/vxiQw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vxiQw.jpg\" alt=\"Excel Snapshot\"></a></p>\n"}], "owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4165, "favorite_count": 1, "accepted_answer_id": 53118036, "answer_count": 5, "score": 12, "last_activity_date": 1586417127, "creation_date": 1540947040, "last_edit_date": 1586417127, "question_id": 53074786, "link": "https://stackoverflow.com/questions/53074786/front-loaded-and-back-loaded-normal-distribution-column-chart-and-s-curves-in", "title": "Front Loaded and Back Loaded | Normal Distribution Column Chart and S Curves in Excel", "body": "<p>Most of us may be aware of normal distribution curves however those who are new to front-loaded and back-loaded normal distribution, I would like to provide the background and then would proceed on stating my problem.</p>\n\n<hr>\n\n<p><strong>Front-Loaded Distribution</strong>: As demonstrated below, it have a rapid start. For e.g. in a project when more resources assumed to be consumed early in the project, cost/hours is distributed aggressively at the start of project.\n<a href=\"https://i.stack.imgur.com/2yAEU.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/2yAEU.png\" alt=\"Front-Loaded Distribution / S Curve\"></a></p>\n\n<hr>\n\n<p><strong>Back-Loaded Distribution</strong>: Contrary to Front-Loaded distribution, it start out with a lower slope and increasingly steep towards the end of the project. For e.g. when most resources assumed to be consumed late in the project.\n<a href=\"https://i.stack.imgur.com/0PkLr.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/0PkLr.png\" alt=\"Rear Load Distribution S Curve\"></a></p>\n\n<p>In the above charts, <strong>green line is S-Curve</strong> which represents cumulative distribution (utilization of resources over the proposed time) and the blue Columns represents the isolated distribution of resources (Cost/Hours) in that period.</p>\n\n<hr>\n\n<p>For reference, I am providing the Bell Curve / standard normal distribution (when Mean=Median) chart (below) and the associated formula to begin with.\n<a href=\"https://i.stack.imgur.com/UaP3J.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/UaP3J.png\" alt=\"Normal Distribution S Curve\"></a></p>\n\n<hr>\n\n<p><strong>Problem Statement</strong>: I was able to generate the normal distribution curve (See below with formulae) however I am unable to find a solution for Front loaded or Back Loaded curves. </p>\n\n<p><em>How to bring the skewness to the right (front-loaded / positively skewed distribution which means mean is greater than median) and left skewed (back-loaded / negatively skewed distribution which means mean is less than median) in a normal distribution?</em> </p>\n\n<p><a href=\"https://i.stack.imgur.com/fesb9.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/fesb9.png\" alt=\"Gaussian Bell Curve with Excel Formula\"></a></p>\n\n<p><strong>Formula Explaned</strong>:</p>\n\n<p><em>Cell B8</em> denotes arbitrarily chosen standard deviation. It affects the kurtosis of normal distribution. In the above screenshot, I am choosing the range of the normal distribution to be from -3SD to 3SD.</p>\n\n<p><em>Cell B9 to B18</em> denotes the even distribution of Z-Score using the formula:</p>\n\n<pre><code>=B8-((2*$B$8)/Period)\n</code></pre>\n\n<p><em>Cell C9 to C18</em> denotes the normal distribution on the basis of Z Score and the Amount using the formula:</p>\n\n<pre><code>=(NORMSDIST(B9)-NORMSDIST(B8))*Amount/(1-2*NORMSDIST($B$8))\n</code></pre>\n\n<hr>\n\n<p><strong>Update:</strong> Following one of the link in comment, I closest got to the below situation. The issue is highlighted in Yellow pattern as due to the usage of volatile Rand() function the charts are not smooth as they should be. As my given formula above do not create ZigZag pattern, I am sure we can have skewed normal distribution and smooth too !\n<a href=\"https://i.stack.imgur.com/WV2XM.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/WV2XM.png\" alt=\"ZigZag Columns Issue in Normal Distribution\"></a></p>\n\n<p>Note: </p>\n\n<ol>\n<li><p>I am using Excel 2016, so I welcome if any newly introduced formula can solve my problem. Also, I am not hesitant to use UDFs.</p></li>\n<li><p>The numbers of front-load and back-load distribution are notional. They could vary. I am only interested in shape of resulting chart.</p></li>\n</ol>\n\n<p>Kindly help !</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1540948161, "post_id": 53074877, "comment_id": 93048054, "body": "Noting also that this should be in the sheet code module and not the <code>ThisWorkbook</code> module."}, {"owner": {"reputation": 3, "user_id": 10416528, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o5Rh_zYZkjM/AAAAAAAAAAI/AAAAAAAABkk/TJf0AjqmvAM/photo.jpg?sz=128", "display_name": "Aden Wessels", "link": "https://stackoverflow.com/users/10416528/aden-wessels"}, "edited": false, "score": 0, "creation_date": 1540955502, "post_id": 53074877, "comment_id": 93049497, "body": "Okay, so I moved this to the Sheet code and still no joy. I have the Microsoft Forms 2.0 Object Library reference in place. This is now returning a Run-time Error indicating &quot;DataObject:PutInClipboard could not complete the operation dur to error 80004001&quot;"}], "tags": [], "owner": {"reputation": 191, "user_id": 5149107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf2d7652f551f5c58c3005cb880f39f?s=128&d=identicon&r=PG&f=1", "display_name": "hughg", "link": "https://stackoverflow.com/users/5149107/hughg"}, "is_accepted": false, "score": 0, "last_activity_date": 1540947902, "creation_date": 1540947902, "answer_id": 53074877, "question_id": 53074692, "link": "https://stackoverflow.com/questions/53074692/issue-copying-cell-value-to-clipboard-dataobject-on-doubleclick-in-vba/53074877#53074877", "title": "Issue copying cell value to clipboard (DataObject) on DoubleClick in VBA", "body": "<p>It looks like it should work fine (assuming you have a reference to the Microsoft Forms 2.0 Object Library). But when I tried it all I got was a couple of square characters. If I removed the <code>Cancel = True</code> line, then it worked fine, but probably not what you want.</p>\n\n<p>No idea why it isn't working with the <code>Cancel = True</code>, but with a bit of playing around this seemed to work:</p>\n\n<pre><code>Option Explicit\n\nDim MyData As DataObject\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Cancel = False\n    Set MyData = New DataObject\n    Target.Copy\n    MyData.GetFromClipboard\n    Application.CutCopyMode = False\n    MyData.PutInClipboard\n    Cancel = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10416528, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o5Rh_zYZkjM/AAAAAAAAAAI/AAAAAAAABkk/TJf0AjqmvAM/photo.jpg?sz=128", "display_name": "Aden Wessels", "link": "https://stackoverflow.com/users/10416528/aden-wessels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540947902, "creation_date": 1540946071, "question_id": 53074692, "link": "https://stackoverflow.com/questions/53074692/issue-copying-cell-value-to-clipboard-dataobject-on-doubleclick-in-vba", "title": "Issue copying cell value to clipboard (DataObject) on DoubleClick in VBA", "body": "<p>Very new to VBA. I am having issues trying to automatically copy the text from a cell which has been double-clicked. I have tried every which way, but something is obviously wrong. Any help would be greatly appreciated.</p>\n\n<p>My code in ThisWorkbook:</p>\n\n<pre><code>Option Explicit\n\nDim MyData As DataObject\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Cancel = False\n    Set MyData = New DataObject\n    MyData.SetText Target.Text\n    MyData.PutInClipboard\n    Cancel = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1540945664, "post_id": 53074433, "comment_id": 93047631, "body": "I am not positive on the VBA side of things but thought I would double check a couple of things with you.  1)  Are you using a line chart or and XY scatter plot?  2)   Are your dates numbers formatted to look like strings, or are they actual strings?  You can test using something like =isnumber(A2)."}, {"owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1540946069, "post_id": 53074433, "comment_id": 93047716, "body": "Line chart and It is number as =isnumber(A2) resulted in TRUE"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1540946423, "post_id": 53074433, "comment_id": 93047794, "body": "Drop the word Series in the top left corner.  after the graph is created you can add it back."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1540947402, "post_id": 53074767, "comment_id": 93047943, "body": "You may still need to specify the <code>PlotBy</code>."}], "tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": false, "score": 0, "last_activity_date": 1540947416, "last_edit_date": 1540947416, "creation_date": 1540946836, "answer_id": 53074767, "question_id": 53074433, "link": "https://stackoverflow.com/questions/53074433/excel-vba-chart-having-problems-in-spliting-the-series-to-create-multiple-serie/53074767#53074767", "title": "Excel vba chart- having problems in spliting the series to create multiple series", "body": "<ol>\n<li>Make sure the cell in the upper left corner is blank</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/xGDxF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xGDxF.png\" alt=\"Blank\"></a></p>\n\n<ol start=\"2\">\n<li>Start Recording your macro</li>\n<li>Select you data range</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/IoLgF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IoLgF.png\" alt=\"Select\"></a></p>\n\n<ol start=\"4\">\n<li>Insert the graph style of your choosing</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/ehdOZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ehdOZ.png\" alt=\"Pick\"></a></p>\n\n<ol start=\"5\">\n<li>Right click on your graph and select \"Select Data..\"</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/VeWun.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VeWun.png\" alt=\"Select Data\"></a></p>\n\n<ol start=\"6\">\n<li>Left click on the Switch Row/Column Button</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/kRXBo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kRXBo.png\" alt=\"Switch\"></a></p>\n\n<ol start=\"7\">\n<li>Format your graph to your liking</li>\n<li>Add the text to the top left corner</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/F4bWr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F4bWr.png\" alt=\"Add\"></a></p>\n\n<ol start=\"9\">\n<li>Stop your recording</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "edited": false, "score": 0, "creation_date": 1540949978, "post_id": 53074894, "comment_id": 93048397, "body": "The above works but I am trying to achieve- As the user  points/highlight the range and it should generate a chart by the macro. Is there a way to offset the range value to b1 so that the &quot;Series&quot; does not appear in the chart"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "edited": false, "score": 0, "creation_date": 1540950288, "post_id": 53074894, "comment_id": 93048448, "body": "@viji, What mean  Is &quot;there a way to offset the range value to b1 so that the &quot;Series&quot; does not appear in the chart &quot;"}, {"owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "edited": false, "score": 0, "creation_date": 1540951150, "post_id": 53074894, "comment_id": 93048622, "body": "I mean instead of choosing b1. If the user select the range say A1:G14. I am changing the code to <code>Dim myString As String     myString = Selection.Address           ActiveChart.SetSourceData Source:=Range(myString) , PlotBy:=xlRows </code>  Could the rngHead value change to start from b1. So that from my last but one picture where series appears on x-axis could be removed. As I want to automate as much possible just by selecting the range and running the macro should generate the chart"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "edited": false, "score": 0, "creation_date": 1541033711, "post_id": 53074894, "comment_id": 93084394, "body": "@viji, Added content to create flexible charts based on ranges."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 1, "last_activity_date": 1541033913, "last_edit_date": 1541033913, "creation_date": 1540948038, "answer_id": 53074894, "question_id": 53074433, "link": "https://stackoverflow.com/questions/53074433/excel-vba-chart-having-problems-in-spliting-the-series-to-create-multiple-serie/53074894#53074894", "title": "Excel vba chart- having problems in spliting the series to create multiple series", "body": "<p>Try this.</p>\n\n<pre><code>Sub test()\n    Dim obj As ChartObject, Cht As Chart\n    Dim Ws As Worksheet\n    Dim Srs As Series\n    Dim rngDB As Range, rngHead As Range\n    Dim rng As Range\n\n    Set Ws = ActiveSheet\n    With Ws\n        Set rngHead = .Range(\"b1\", \"g1\")\n        Set rngDB = .Range(\"a2\", \"a14\")\n    End With\n    Set obj = Ws.ChartObjects.Add(400, 200, 600, 400)\n    Set Cht = obj.Chart\n    With Cht\n        .HasLegend = False\n        .HasTitle = True\n        .ChartType = xlLineMarkers\n        With .ChartTitle\n            .Characters.Text = \"Chart Title\"\n            .Characters.Font.Size = 12\n        End With\n        For Each rng In rngDB\n            Set Srs = .SeriesCollection.NewSeries\n            With Srs\n                .Name = rng\n                .XValues = rngHead\n                .Values = rng.Offset(, 1).Resize(1, 6)\n            End With\n        Next rng\n    End With\nEnd Sub\n</code></pre>\n\n<p>It is about the chart which is formed according to the dynamic range.</p>\n\n<pre><code>Sub setChart()\n    Dim obj As ChartObject, Cht As Chart\n    Dim Ws As Worksheet\n    Dim Srs As Series\n    Dim rngDB As Range, rngHead As Range\n    Dim rng As Range\n    Dim rngChart As Range\n    Dim r As Integer, c As Integer\n\n    Set Ws = ActiveSheet\n    Set rngChart = Selection\n    r = rngChart.Rows.Count - 1\n    c = rngChart.Columns.Count - 1\n    If r &lt; 1 Or c &lt; 1 Then\n        MsgBox \"set the range correctly!\"\n        Exit Sub\n    End If\n\n\n    With rngChart\n        Set rngHead = .Range(\"b1\").Resize(1, c)\n        Set rngDB = .Range(\"a2\").Resize(r)\n    End With\n    Set obj = Ws.ChartObjects.Add(400, 200, 600, 400)\n    Set Cht = obj.Chart\n    With Cht\n        .HasLegend = False\n        .HasTitle = True\n        .ChartType = xlLine\n        With .ChartTitle\n            .Characters.Text = \"Chart Title\"\n            .Characters.Font.Size = 12\n        End With\n        For Each rng In rngDB\n            Set Srs = .SeriesCollection.NewSeries\n            With Srs\n                .Name = rng\n                .XValues = rngHead\n                .Values = rng.Offset(, 1).Resize(1, c)\n            End With\n        Next rng\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 5165649, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fdb6cff5b8df87ce947970505dc220e9?s=128&d=identicon&r=PG&f=1", "display_name": "viji", "link": "https://stackoverflow.com/users/5165649/viji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 53074894, "answer_count": 2, "score": 0, "last_activity_date": 1586417164, "creation_date": 1540943550, "last_edit_date": 1586417164, "question_id": 53074433, "link": "https://stackoverflow.com/questions/53074433/excel-vba-chart-having-problems-in-spliting-the-series-to-create-multiple-serie", "title": "Excel vba chart- having problems in spliting the series to create multiple series", "body": "<p>I recorded the macro to run a chart where the series is not what I am expecting\nit is changing series and category in the chart</p>\n\n<pre><code>    Sub Macro13()\n\n ' Macro13 Macro\n '\n ' Keyboard Shortcut: Ctrl+b\n Dim myString As String\nmyString = Selection.Address\nActiveSheet.Shapes.AddChart2(227, xlLineMarkers).Select\nActiveChart.SetSourceData Source:=Range(myString),PlotBy:=xlRows\nActiveChart.Legend.Select\nSelection.Delete\nEnd Sub\n</code></pre>\n\n<p>when I deleted the chart and ran the macro. Got the following chart</p>\n\n<p><a href=\"https://i.stack.imgur.com/m2Hml.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m2Hml.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>But wanted the following chart\n<a href=\"https://i.stack.imgur.com/izb4Q.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/izb4Q.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The month-year should be on x-axis(category) and series should be 0,1,2,3 etc.\nThe following data is </p>\n\n<pre><code>series  Sep-10  Oct-10  Nov-10  Dec-10  Jan-11  Feb-11\n0   7   8   90  80  110 1\n1   5   1   18  36  97  1\n2   5   1   18  36  97  1\n3   5   1   18  36  97  1\n4   5   1   18  36  97  1\n5   5   1   18  36  97  1\n6   5   1   18  36  97  1\n7   5   1   18  36  100 1\n8   5   1   18  40  97  1\n9   5   7   18  36  97  1\n10  5   1   89  36  97  1\n11  5   1   18  36  97  1\n12  5   1   18  36  97  1\n ActiveChart.SetSourceData Source:=Range(\"Sheet1!$A$1:$G$14\") 'was changed to \nActiveChart.SetSourceData Source:=Range(\"Sheet1!$A$1:$G$14\"), PlotBy:=xlRows then it added the series name to it but got like this with series included in x-axis\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/VhyOz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VhyOz.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>When I was recording macro this was the chart that I selected and removed the legend.\n<a href=\"https://i.stack.imgur.com/5B8ca.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5B8ca.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1540941376, "post_id": 53074152, "comment_id": 93046647, "body": "That&#39;s a good UDF candidate - it&#39;s basically just a <code>Select Case</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1540943404, "post_id": 53074152, "comment_id": 93047127, "body": "<code>&quot;&quot;5&quot;&quot;</code> are these quotes around the numeric return values required ? The original formula had none in those locations..."}], "answers": [{"comments": [{"owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "edited": false, "score": 0, "creation_date": 1540996612, "post_id": 53074238, "comment_id": 93068566, "body": "Scenography Thanks for the link, I had actually looked through there and tried a few things to clean up syntax on single lines vs line breaks.  Unfortunately the code in your answer also errors <code>Run-time 1004</code>"}], "tags": [], "owner": {"reputation": 290, "user_id": 6387947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68bd3078f0f802c7e8769ecfd63878d8?s=128&d=identicon&r=PG&f=1", "display_name": "scenography", "link": "https://stackoverflow.com/users/6387947/scenography"}, "is_accepted": false, "score": 1, "last_activity_date": 1540942628, "last_edit_date": 1540942628, "creation_date": 1540941879, "answer_id": 53074238, "question_id": 53074152, "link": "https://stackoverflow.com/questions/53074152/complex-nested-if-and-formula-being-written-to-sheet-by-vba/53074238#53074238", "title": "Complex Nested IF AND Formula Being Written to Sheet by VBA", "body": "<p>Try the code this way, where each line is a separate string in quotation marks.</p>\n\n<pre><code>Worksheets(\"MyWorksheet\").Range(\"BP\" &amp; LastRowExisting + 1 &amp; \":\" &amp; \"BP\" &amp; _\n    LastRowNew).FormulaR1C1 = \"=IF(RC[-44]=\"\"No Bonus\"\",\"\"1\"\", \" &amp; _\n    \"IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=50,RC[-38]=\"\"N\"\",\"\"5\"\", \" &amp; _\n    \"IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=40,RC[-38]=\"\"N\"\",\"\"4\"\", \" &amp; _\n    \"IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=30,RC[-38]=\"\"N\"\",\"\"2\"\", \" &amp; _\n    \"IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=20,RC[-18]=\"\"N\"\",\"\"1\"\", \" &amp; _\n    \"IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=0,RC[-38]=\"\"N\"\",\"\"0.5\"\", \" &amp; _\n    \"IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=20,RC[-38]=\"\"Y\"\",\"\"1\"\", \" &amp; _\n    \"IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=15,RC[-38]=\"\"Y\"\",\"\"2\"\", \" &amp; _\n    \"IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=0,RC[-38]=\"\"Y\"\",\"\"0.3\"\",\"\"0\"\")))))))))\"\n</code></pre>\n\n<p>The line-continuation character (an underscore) can be used between strings, as in the example at <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/program-structure/how-to-break-and-combine-statements-in-code\" rel=\"nofollow noreferrer\">How to Break and Combine Statements in Code</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1540997535, "last_edit_date": 1540997535, "creation_date": 1540957598, "answer_id": 53075984, "question_id": 53074152, "link": "https://stackoverflow.com/questions/53074152/complex-nested-if-and-formula-being-written-to-sheet-by-vba/53075984#53075984", "title": "Complex Nested IF AND Formula Being Written to Sheet by VBA", "body": "<p>Writing as Select Case is probably a good idea but remember the macro recorder can be your friend here. Simply record entering the formula in cell BP2 and copy the output after the ActiveCell.FormulaR1C1:</p>\n\n<pre><code> ActiveCell.FormulaR1C1 = _\n        \"=IF(RC[-44]=\"\"No Bonus\"\",1,IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=50,RC[-38]=\"\"N\"\"),5,IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=40,RC[-38]=\"\"N\"\"),4,IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=30,RC[-38]=\"\"N\"\"),2,IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=20,RC[-38]=\"\"N\"\"),1,IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;0,RC[-38]=\"\"N\"\"),0.5,IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=2\" &amp; _\n        \"0,RC[-38]=\"\"Y\"\"),1,IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=15,RC[-38]=\"\"Y\"\"),2,IF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=0,RC[-38]=\"\"Y\"\"),0.3,0)))))))))\" &amp; _\n        \"\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "edited": false, "score": 0, "creation_date": 1540997501, "post_id": 53078154, "comment_id": 93069187, "body": "VBasic2008 I appreciate the alternative method here.  I am not testing and implementing because the &quot;formula put in cells via vba&quot; is part of a long hands off automated process.  I&#39;ll try out your method the next time I&#39;m doing something similar!"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "edited": false, "score": 0, "creation_date": 1540998512, "post_id": 53078154, "comment_id": 93069877, "body": "Thanks for the credit although I don&#39;t deserve it since I only now have realized that I have miss understood the question. Sorry."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1540970998, "last_edit_date": 1540970998, "creation_date": 1540970269, "answer_id": 53078154, "question_id": 53074152, "link": "https://stackoverflow.com/questions/53074152/complex-nested-if-and-formula-being-written-to-sheet-by-vba/53078154#53078154", "title": "Complex Nested IF AND Formula Being Written to Sheet by VBA", "body": "<h1>Typing &amp; Typing &amp; Typing</h1>\n\n<p>Open your workbook, open VBE, insert a new module (or use an existing one) and paste the following code into the module:</p>\n\n<pre><code>Option Explicit\n\nFunction Nested(Range1 As Range, Range2 As Range, _\n    Range3 As Range, Range4 As Range) As Single\n\n'**** Customize BEGIN ******************\n  'NOCase\n  Const cStrSearch As String = \"No Bonus\"\n  Const cSglYes As Single = 1\n  'Period\n  Const cDays As Integer = 365\n  Const cMonths As Integer = 12\n  'YesNo\n  Const cStrYes As String = \"Y\"\n  Const cStrNo As String = \"N\"\n  'Title1 Source\n  Const cSglN1 As Single = 50\n  Const cSglN2 As Single = 40\n  Const cSglN3 As Single = 30\n  Const cSglN4 As Single = 20\n  Const cSglN5 As Single = 0\n  'Title1 Target\n  Const cSglNA1 As Single = 5\n  Const cSglNA2 As Single = 4\n  Const cSglNA3 As Single = 2\n  Const cSglNA4 As Single = 1\n  Const cSglNA5 As Single = 0.5\n  'Title2 Source\n  Const cSglY1 As Single = 20\n  Const cSglY2 As Single = 15\n  Const cSglY3 As Single = 0\n  'Title2 Target\n  Const cSglYA1 As Single = 1\n  Const cSglYA2 As Single = 2\n  Const cSglYA3 As Single = 0.3\n'**** Customize END ********************\n\n  If Range1.Value2 = cStrSearch Then\n    Nested = cSglYes\n    Exit Function\n  End If\n\n  Nested = (Range4.Value2 - Range3.Value2) / cDays / cMonths\n\n  Select Case UCase(Range2.Text) 'Remove 'Ucase' function for case-sensitive\n    Case cStrNo\n      Select Case Nested\n        Case Is &gt;= cSglN1: Nested = cSglNA1\n        Case Is &gt;= cSglN2: Nested = cSglNA2\n        Case Is &gt;= cSglN3: Nested = cSglNA3\n        Case Is &gt;= cSglN4: Nested = cSglNA4\n        Case Is &gt; cSglN5: Nested = cSglNA5\n        Case Else\n          Nested = 0 'Change if necessary\n      End Select\n    Case cStrYes\n      Select Case Nested\n        Case Is &gt;= cSglY1: Nested = cSglYA1\n        Case Is &gt;= cSglY2: Nested = cSglYA2\n        Case Is &gt;= cSglY3: Nested = cSglYA3\n        Case Else\n          Nested = 0 'Change if necessary\n      End Select\n    Case Else\n      Nested = 0 'Change if necessary\n  End Select\n\n'=IF(X2=\"No Bonus\",1,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=50,AD2=\"N\"),5,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=40,AD2=\"N\"),4,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=30,AD2=\"N\"),2,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=20,AD2=\"N\"),1,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;0,AD2=\"N\"),0.5,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=20,AD2=\"Y\"),1,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=15,AD2=\"Y\"),2,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=0,AD2=\"Y\"),0.3,0)))))))))\nEnd Function\n</code></pre>\n\n<p>Close VBE and in the worksheet (Excel) in <strong>any</strong> cell in the second row (except <code>X2</code>, <code>AD2</code>, <code>AF2</code>, <code>AG2</code>) (e.g. <code>BP2</code> as you mentioned) use the following formula:</p>\n\n<pre><code>=NESTED($X2,$AD2,$AF2,$AG2)\n</code></pre>\n\n<p>Copy/Paste the formula down as far as you need it.</p>\n"}], "owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 53075984, "answer_count": 3, "score": 1, "last_activity_date": 1540997535, "creation_date": 1540941133, "question_id": 53074152, "link": "https://stackoverflow.com/questions/53074152/complex-nested-if-and-formula-being-written-to-sheet-by-vba", "title": "Complex Nested IF AND Formula Being Written to Sheet by VBA", "body": "<p>I currently have a complex formula that I am trying to place into a cell via VBA.  The current working formula (in cell BP2) is as follows:</p>\n\n<pre><code>'=IF(X2=\"No Bonus\",1,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=50,AD2=\"N\"),5,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=40,AD2=\"N\"),4,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=30,AD2=\"N\"),2,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=20,AD2=\"N\"),1,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;0,AD2=\"N\"),0.5,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=20,AD2=\"Y\"),1,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=15,AD2=\"Y\"),2,\n'IF(AND(((AG2-AF2+1)/(365/12))&gt;=0,AD2=\"Y\"),0.3,0)))))))))\n</code></pre>\n\n<p>I am placing the code in a variable range below existing data in Column BP.  My code is currently as follows:</p>\n\n<pre><code>Dim LastRowExisting As Long\nDim LastRowNew As Long\n\nLastRowExisting = Worksheets(\"MyWorksheet\").Range(\"CE1\").Value 'LastRow of Existing data stored here by macro earlier\nLastRowNew = Worksheets(\"MyWorksheet\").Range(\"A\" &amp; rows.Count).End(xlUp).Row 'requires Column A \"Source\" is always populated on all lines    \n\nWorksheets(\"MyWorksheet\").Range(\"BP\" &amp; LastRowExisting + 1 &amp; \":\" &amp; \"BP\" &amp; LastRowNew).FormulaR1C1 = \"=IF(RC[-44]=\"\"No Bonus\"\",\"\"1\"\", _\nIF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=50,RC[-38]=\"\"N\"\",\"\"5\"\", _\nIF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=40,RC[-38]=\"\"N\"\",\"\"4\"\", _\nIF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=30,RC[-38]=\"\"N\"\",\"\"2\"\", _\nIF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=20,RC[-18]=\"\"N\"\",\"\"1\"\", _\nIF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=0,RC[-38]=\"\"N\"\",\"\"0.5\"\", _\nIF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=20,RC[-38]=\"\"Y\"\",\"\"1\"\", _\nIF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=15,RC[-38]=\"\"Y\"\",\"\"2\"\", _\nIF(AND(((RC[-35]-RC[-36]+1)/(365/12))&gt;=0,RC[-38]=\"\"Y\"\",\"\"0.3\"\",\"\"0\"\")))))))))\"\n</code></pre>\n\n<p>I am getting a run time error '1004' \"Application-defined or object defined error\" on the formula line.  I have tried to see if my line breaks are the issue by putting this in one long line but I am still getting the same error.</p>\n\n<p>I realize this is likely a syntax issue but I'm struggling to see what is off.  I know this is a less than ideal (ie. ugly) solution, but given where this takes place in a larger macro, I'm hoping to make this formula method work.</p>\n\n<p>If it helps; the general idea is to end up with a value (5,4,2,1,.5, etc) based on two criteria.  The first is if <code>(AG-AF+1)/(365/12)</code> is in a certain range and the second is a simple <code>Y</code> or <code>N</code> flag in <code>Column AD</code>. Ex. <code>(AG2-AF2+1)/(365/12) = 45</code> and <code>AD2 = N</code> then I'd expect <code>BP2 = 4</code>.</p>\n\n<p>Cheers!</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1540944674, "post_id": 53074104, "comment_id": 93047423, "body": "How do you restart the macro?"}, {"owner": {"reputation": 81, "user_id": 8983609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdaeff27f0834ca28ecdc8aaa00072d?s=128&d=identicon&r=PG&f=1", "display_name": "jc2525", "link": "https://stackoverflow.com/users/8983609/jc2525"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1540944893, "post_id": 53074104, "comment_id": 93047470, "body": "I added the macro to the access bar. I just close the error and press the macro button on the access bar"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1540945769, "post_id": 53074104, "comment_id": 93047653, "body": "Try working with <a href=\"https://stackoverflow.com/a/41483071/4539709\">Application_Startup() &amp; Items_ItemAdd Event</a>"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1540986938, "post_id": 53074104, "comment_id": 93062261, "body": "Edit the question to include the error number and text description. If there is a line highlighted indicate which one."}, {"owner": {"reputation": 81, "user_id": 8983609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdaeff27f0834ca28ecdc8aaa00072d?s=128&d=identicon&r=PG&f=1", "display_name": "jc2525", "link": "https://stackoverflow.com/users/8983609/jc2525"}, "edited": false, "score": 0, "creation_date": 1547568914, "post_id": 53074104, "comment_id": 95232479, "body": "The macro seems to run fine. But after a few days or so of running I get an error. This is the error...            Run-time error &#39; 13&#39;: Type mismatch  If I click debug, I directs me to this line in the script...            Set myMailToFW = myemails(x)"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1547740151, "post_id": 53074104, "comment_id": 95303724, "body": "To handle the situation where myemails(x) is not a mailitem <code>If myemails(x).class = olmail then</code>"}], "owner": {"reputation": 81, "user_id": 8983609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdaeff27f0834ca28ecdc8aaa00072d?s=128&d=identicon&r=PG&f=1", "display_name": "jc2525", "link": "https://stackoverflow.com/users/8983609/jc2525"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1592748865, "creation_date": 1540940703, "last_edit_date": 1592748865, "question_id": 53074104, "link": "https://stackoverflow.com/questions/53074104/how-can-i-fix-an-error-that-happens-when-the-computer-is-locked", "title": "How can I fix an error that happens when the computer is locked?", "body": "<p>I am trying to auto-forward my Outlook email to another email address using VBA code.</p>\n\n<p>I get an error if the macro runs for a while when my computer is locked.</p>\n\n<p>Once the error happens, the macro stops and I don't get email forwarded anymore until I restart the macro. I added the macro to the quick access toolbar. I just close the error and press the macro button.</p>\n\n<p>The macro works fine otherwise.</p>\n\n<p>Here is my code (email@email.com is the email I am forwarding to)</p>\n\n<pre><code>Sub Application_NewMail()\n\nSet myNamespace = Application.GetNamespace(\"MAPI\")\nSet myInbox = myNamespace.GetDefaultFolder(olFolderInbox)\nSet myemails = myInbox.Items\nSet mynewemails = myemails.Restrict(\"[unread]=true\")\n\nDim x As Integer\nFor x = 1 To myemails.Count Step 1\nIf myemails(x).UnRead(True) Then\nDim myMailToFW As Outlook.MailItem\nSet myMailToFW = myemails(x)\nSet myMailToFW = myMailToFW.forward\nmyMailToFW.Recipients.Add (\"email@email.com\")\nmyMailToFW.Send\nmyemails(x).UnRead = False\nEnd If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Edit: The macro seems to run fine. But after a few days or so of running I get an error. This is the error...</p>\n\n<p>Run-time error ' 13':\nType mismatch</p>\n\n<p>If I click debug, I directs me to this line in the script...</p>\n\n<p>Set myMailToFW = myemails(x)</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1540939564, "post_id": 53073895, "comment_id": 93046177, "body": "You could just fill it down past the data.. <code>=IF(ISBLANK($A1), &quot;&quot;, $A1*0.05)</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1540970890, "post_id": 53073895, "comment_id": 93053983, "body": "Or <a href=\"https://support.office.com/en-us/article/format-an-excel-table-6789619f-c889-495c-99c2-2f971c0e2370\" rel=\"nofollow noreferrer\">format it as table</a>. If you add a row to a table it automatically pulls down the formulas."}], "answers": [{"comments": [{"owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 0, "creation_date": 1541820075, "post_id": 53075277, "comment_id": 93357981, "body": "This is exactly what OP is already doing, but doesn&#39;t want to have do do manually for every row in his sheet."}], "tags": [], "owner": {"reputation": 1, "user_id": 10583428, "user_type": "registered", "profile_image": "https://graph.facebook.com/2039591886122809/picture?type=large", "display_name": "CittyProg", "link": "https://stackoverflow.com/users/10583428/cittyprog"}, "is_accepted": false, "score": 0, "last_activity_date": 1540951469, "creation_date": 1540951469, "answer_id": 53075277, "question_id": 53073895, "link": "https://stackoverflow.com/questions/53073895/vba-for-automatic-formula-calculation-in-the-range-of-cells-after-cell-value-inp/53075277#53075277", "title": "VBA for automatic formula calculation in the range of cells after cell value input", "body": "<p>Try to put this Formulas \"Col B =A1*0.05 and Col C =A1+B1\" (dont forget to capture the row used on column A) in a event of selection change</p>\n"}, {"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1541020852, "creation_date": 1541020852, "answer_id": 53092121, "question_id": 53073895, "link": "https://stackoverflow.com/questions/53073895/vba-for-automatic-formula-calculation-in-the-range-of-cells-after-cell-value-inp/53092121#53092121", "title": "VBA for automatic formula calculation in the range of cells after cell value input", "body": "<p>Automating such a simple task seems like an overkill but it's easy enough to do:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n    With Target\n        If .Count &gt; 1 Then Exit Sub\n        If (Not Intersect(Columns(\"A:A\"), .Cells) Is Nothing) And IsNumeric(.Value2) Then\n            .Offset(0, 1).Value2 = .Value2 * 1.05\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1586417200, "creation_date": 1540939276, "last_edit_date": 1586417200, "question_id": 53073895, "link": "https://stackoverflow.com/questions/53073895/vba-for-automatic-formula-calculation-in-the-range-of-cells-after-cell-value-inp", "title": "VBA for automatic formula calculation in the range of cells after cell value input", "body": "<p>I am looking for the code working on change of value basis, which does the following: \nafter I type number in col A, column B would show 5% tax calculation and column C total with tax,</p>\n\n<p>I know that I can use formula in Col B <code>=A1*0.05</code>  and <code>=A1+B1</code> in Col C but I have to copy the formulas and drag it down every time new row is added, I would like to automate that process.</p>\n"}, {"tags": ["excel", "vba", "dynamic", "named-ranges"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1540937114, "post_id": 53073507, "comment_id": 93045295, "body": "You need to move <code>ShtName</code> <i>outside</i> the quotation marks in the <code>RefersTo</code> and concatenate with <code>&amp;</code>."}, {"owner": {"reputation": 319, "user_id": 8920274, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/485Ds.jpg?s=128&g=1", "display_name": "I. \u042f. Newb", "link": "https://stackoverflow.com/users/8920274/i-%d0%af-newb"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1540938226, "post_id": 53073507, "comment_id": 93045735, "body": "@BigBen, works like a charm, but why did you delete your answer?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1540938312, "post_id": 53073507, "comment_id": 93045765, "body": "Was testing it further. Will undelete"}, {"owner": {"reputation": 319, "user_id": 8920274, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/485Ds.jpg?s=128&g=1", "display_name": "I. \u042f. Newb", "link": "https://stackoverflow.com/users/8920274/i-%d0%af-newb"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1540938531, "post_id": 53073507, "comment_id": 93045828, "body": "@BigBen, Here you go. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1540937789, "creation_date": 1540937789, "answer_id": 53073670, "question_id": 53073507, "link": "https://stackoverflow.com/questions/53073507/excel-vba-loop-for-setting-dynamic-named-ranges-in-worksheets/53073670#53073670", "title": "Excel VBA: Loop for setting dynamic named ranges in worksheets", "body": "<p>If <code>ShtName</code> is <em>within</em> the quotation marks, it's no longer a variable, but the text <code>\"ShtName\"</code>, as evidenced by your screen shot.</p>\n\n<p>Move all instances of <code>ShtName</code> <em>outside</em> the quotation marks and concatenate with <code>&amp;</code>. You should probably add single quotes as well around the sheet name.</p>\n\n<p>Change </p>\n\n<pre><code>\"=OFFSET(ShtName!$A$2,0,0,COUNTA(ShtName!$A$2:$A$1048576),COUNTA(ShtName!$2:$2))\"\n</code></pre>\n\n<p>to </p>\n\n<pre><code>\"=OFFSET('\" &amp; ShtName &amp; \"'!$A$2,0,0,COUNTA('\" &amp; ShtName &amp; \"'!$A$2:$A$1048576),COUNTA('\" &amp; ShtName &amp; \"'!$2:$2))\"\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 8920274, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/485Ds.jpg?s=128&g=1", "display_name": "I. \u042f. Newb", "link": "https://stackoverflow.com/users/8920274/i-%d0%af-newb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 53073670, "answer_count": 1, "score": 0, "last_activity_date": 1586417236, "creation_date": 1540936948, "last_edit_date": 1586417236, "question_id": 53073507, "link": "https://stackoverflow.com/questions/53073507/excel-vba-loop-for-setting-dynamic-named-ranges-in-worksheets", "title": "Excel VBA: Loop for setting dynamic named ranges in worksheets", "body": "<p>I need to loop trough each worksheet in my workbook and set dynamic named ranges in each one of them, except worksheet Summary Report.\nI need to name the ranges with the worksheet name and \"Close\".</p>\n\n<p>I currently have this:</p>\n\n<pre><code>Option Explicit\nPublic Sub DefineNamedRanges()\n\n    Dim WSheet As Worksheet\n\n    Dim ShtName As Variant\n\n    For Each WSheet In Worksheets\n\n        ShtName = WSheet.Name\n\n        If ShtName &lt;&gt; \"Summary Report\" Then\n\n            WSheet.Names.Add Name:=ShtName &amp; \"Close\", _\n                RefersTo:=\"=OFFSET(ShtName!$A$2,0,0,COUNTA(ShtName!$A$2:$A$1048576),COUNTA(ShtName!$2:$2))\"\n\n        End If\n\n    Next WSheet\n\nEnd Sub\n</code></pre>\n\n<p>This code creates the ranges and names them as I want.\nWhen I open the Name Manager, it seems that the ranges are not referring to anything. \nIt is like solely the names are created, but not the ranges themselves.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZMzdg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZMzdg.png\" alt=\"Names Manager\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1540935930, "post_id": 53073228, "comment_id": 93044867, "body": "Can you try adding <code>oWord_Doc.Activate</code> below the <code>wb_open</code> line"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1540939519, "post_id": 53073228, "comment_id": 93046160, "body": "Try <code>AppActivate &quot;Microsoft Word&quot;</code> or <code>AppActivate Application.Caption</code>"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1540973220, "post_id": 53073228, "comment_id": 93055010, "body": "As <a href=\"https://stackoverflow.com/users/478884/tim-williams\">Tim Williams</a> suggested: between the lines &#39;wb_open ...&#39; and &#39;MsgBox ... &#39; insert the line &#39;AppActivate &quot;Microsoft Word&quot;&#39; and the MsgBox will display and when hitting OK, Word will be active (visible) and Excel in the background."}, {"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541084489, "post_id": 53073228, "comment_id": 93103060, "body": "I tried all three options above.  The results are <code>oWord_Doc.Activate</code> compiles just fine but doesn&#39;t switch the active application to Word (but it does if you put a stop on the line in the VBA editor).  <code>AppActivate &quot;Microsoft Word&quot;</code> and <code>AppActivate Application.Caption</code> both results in an execution error of Invalid procedure call or argument.  Thanks Brotato and  @tim-williams for your suggestions."}], "answers": [{"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1540973300, "post_id": 53073366, "comment_id": 93055037, "body": "Even after you change &#39;activeworksheet&#39; to &#39;ActiveSheet&#39; it doesn&#39;t work. You have to use what Tim Williams suggested."}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1540974234, "post_id": 53073366, "comment_id": 93055456, "body": "@Freeflow I would leave the <code>Auto Syntax Check</code> unchecked, it interferes more than it helps, and wrong syntax is (usually) highlighted anyway."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1540974963, "post_id": 53073366, "comment_id": 93055780, "body": "Once you have an understanding of how intellisense works and how to use it I would agree.  For complete novices I&#39;d leave it on."}, {"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1541085213, "post_id": 53073366, "comment_id": 93103468, "body": "Thanks @Freeflow for your suggested code.  I implemented your code with the change of <code>activeworksheet</code> to <code>ActiveSheet</code> and Word still does not come up after the <code>my_wb.activeworksheet.Range(&quot;a6&quot;).Select</code> code line. Any other suggestions?"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1541088022, "post_id": 53073366, "comment_id": 93105109, "body": "Would you believe Application.Activate &lt;sigh&gt;"}, {"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1541092738, "post_id": 53073366, "comment_id": 93107709, "body": "Hurrah, <code>Application.Activate</code> solved my problem.  I have updated the code above.  Thanks @freeflow"}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": true, "score": 2, "last_activity_date": 1540939428, "last_edit_date": 1540939428, "creation_date": 1540936196, "answer_id": 53073366, "question_id": 53073228, "link": "https://stackoverflow.com/questions/53073228/how-to-make-microsoft-word-visible-after-opening-an-excel-file-in-word-vba/53073366#53073366", "title": "How to make Microsoft Word visible after opening an Excel file in Word VBA", "body": "<p>Visible is at the Application level.  Your oExcel variable gives you the clue. You don't have a variable called oWord.</p>\n\n<p>Edited to add the following code</p>\n\n<pre><code>Option Explicit\n\nSub Module_Test()\n\nConst MY_WB_PATH                As String = \"C:\\Test\\Excel_Template.xlsx\"\nConst MY_DOC_PATH               As String = \"C:\\Test\\Doc_to_process.docx\"\n\nDim my_xl_app                   As Excel.Application\nDim my_doc                      As Word.Document\nDim my_wb                       As Excel.Workbook\n\n    Set my_xl_app = New Excel.Application\n\n    With my_xl_app\n        .Visible = True\n        .ScreenUpdating = True\n        Set my_wb = .Workbooks.Open(MY_WB_PATH)\n\n    End With\n\n    my_wb.Activate\n    my_wb.activeworksheet.Range(\"a6\").Select\n\n    ' At this point Excel is visible.  But the Msgbox statement\n    ' below is not visible except when one switches to Word using\n    ' the task bar.  What statement do I put here to make Word visible?\n    Set my_doc = Documents.Open(MY_DOC_PATH)\n    my_doc.Activate\n    ' If required\n    my_doc.Application.Visible = True\n\n    MsgBox \"Here is a message that should be visible when viewing the window containing the Doc_to_process.docx\"\nEnd Sub\n</code></pre>\n\n<p>If you are new to VBA then the following should always be used.</p>\n\n<ol>\n<li><p>In the VBA IDE ensure each module starts with 'Option explicit'</p></li>\n<li><p>In the VBA IDE ensure that all checkboxes in Tools.Option.Code Settings are ticked</p></li>\n</ol>\n"}], "owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1918, "favorite_count": 0, "accepted_answer_id": 53073366, "answer_count": 1, "score": 1, "last_activity_date": 1540963149, "creation_date": 1540935242, "last_edit_date": 1540963149, "question_id": 53073228, "link": "https://stackoverflow.com/questions/53073228/how-to-make-microsoft-word-visible-after-opening-an-excel-file-in-word-vba", "title": "How to make Microsoft Word visible after opening an Excel file in Word VBA", "body": "<p>I have a VBA Word macro that opens a Word doc, then opens an Excel file, selects a cell reference and finally displays a message using Msgbox.  After the Excel file has been opened I am having trouble finding the code to make Word visible so that the user can view the Msgbox message without having to using the task bar to switch from Excel to Word.  I tried <code>oWord.Visible = True</code> but VBA gives me an error. \nAny hints are appreciated.</p>\n\n<p>See the code below:</p>\n\n<pre><code>Sub Module_Test()\nDim oExcel As Object\nDim oWord_Doc as object\nDim wb_open as workbook\nSet oExcel = New Excel.Application\nstr_Excel_Filename = \"C:\\Test\\Excel_Template.xlsx\"\nDocuments.Open (\"C:\\Test\\Doc_to_process.docx\")\nSet oWord_Doc = activedocument\noExcel.Visible = True\noExcel.ScreenUpdating = True\noExcel.Workbooks.Open str_Excel_Filename\nSet wb_open = activeworkbook\nwb_open.ActiveSheet.range(\"a6\").Select\n' At this point Excel is visible.  But the Msgbox statement below is not visible except when one switches to Word using the task bar.  What statement do I put here to make Word visible?\nMsgbox \"Here is a message that should be visible when viewing the window containing the Doc_to_process.docx\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10582383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f83d9f5c2011c6558c14733f43c12fc?s=128&d=identicon&r=PG&f=1", "display_name": "Dion", "link": "https://stackoverflow.com/users/10582383/dion"}, "edited": false, "score": 0, "creation_date": 1541077704, "post_id": 53073848, "comment_id": 93099311, "body": "PERFECT! That worked beautifully! Thank you! That shaved HOURS off this task."}], "tags": [], "owner": {"reputation": 290, "user_id": 6387947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68bd3078f0f802c7e8769ecfd63878d8?s=128&d=identicon&r=PG&f=1", "display_name": "scenography", "link": "https://stackoverflow.com/users/6387947/scenography"}, "is_accepted": true, "score": 0, "last_activity_date": 1540939306, "last_edit_date": 1540939306, "creation_date": 1540938933, "answer_id": 53073848, "question_id": 53073192, "link": "https://stackoverflow.com/questions/53073192/porting-data-value-to-another-worksheet-based-on-a-value/53073848#53073848", "title": "Porting data value to another worksheet based on a value", "body": "<p>Maybe you can use use the <a href=\"https://support.office.com/en-us/article/sumifs-function-c9e748f5-7ea7-455d-9406-611cebce642b\" rel=\"nofollow noreferrer\">SUMSIF</a> function instead of a macro: <br>\n=SUMIFS(<em>sum_range, criteria_range1, criteria1</em>) <br>\n=SUMIFS(<em>Weekly Sales Units, Weekly Sales ASIN, FBA Sold ASIN</em>) <br>\n=SUMIFS('Weekly Sales'!D:D, 'Weekly Sales'!C:C, 'FBA Sold'!C3) <br>\nType the formula in cell S3 on sheet FBA Sold and copy down.</p>\n"}], "owner": {"reputation": 3, "user_id": 10582383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f83d9f5c2011c6558c14733f43c12fc?s=128&d=identicon&r=PG&f=1", "display_name": "Dion", "link": "https://stackoverflow.com/users/10582383/dion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "closed_date": 1540972910, "accepted_answer_id": 53073848, "answer_count": 1, "score": -3, "last_activity_date": 1541079888, "creation_date": 1540935033, "last_edit_date": 1541079888, "question_id": 53073192, "link": "https://stackoverflow.com/questions/53073192/porting-data-value-to-another-worksheet-based-on-a-value", "closed_reason": "Needs more focus", "title": "Porting data value to another worksheet based on a value", "body": "<p>I have researched formulas and lookups and index/match combos, but nothing. I am working with a large inventory database and recording weekly sales quantities items to track what is selling. Currently, I'm spending a lot of time adding the file to the workbook, toggling between the sheets, copying and pasting, using the find/select tool and entering the data. This takes forever. I have tried creating a search box, but still have to scroll down to find the highlighted result because it doesn't FIND the result the way the tool does. </p>\n\n<p>What I need is to have the quantity brought to the database and entered next to the corresponding item. I am using the criteria from Column C on Sheet 1 to find the matching item in Column C on Sheet 2. I would like to be able to click a button and have a VBA import the sold quantity from Column D on Sheet 1 to the next empty column on Sheet 2. It sounds simple enough, but macros have failed me thus far. I have also tried a few VBA codes online, but having trouble changing the syntax to meet my needs.</p>\n"}, {"tags": ["excel", "vba", "design-patterns", "strategy-pattern"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1540933484, "post_id": 53072697, "comment_id": 93044187, "body": "I can conceive an <code>IStorageStrategy</code> with <code>DatabaseStorageStrategy</code> and <code>FlatFileStorageStrategy</code> implementations... but if all that changes between the two is the connection string used, then the setup seems overkill. Now if I understand the purpose of a <code>Record</code>, I don&#39;t think a <code>Record</code> should implement <code>IDatabaseStrategy</code> here - how about having a <code>Record</code> parameter on the <code>Save</code> method?"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540934156, "post_id": 53072697, "comment_id": 93044422, "body": "@MathieuGuindon I was thinking of having multiple classes (say <code>Record</code> and an entirely different <code>Contact</code>) have the same method <code>Save</code> so that I can pass them to a <code>Sub</code> that will invoke that method. But that means each of those have to implement <code>IDatabaseStrategy</code> and it indeed seems misplaced. Currently I use it as a wrapper: <code>RecordStrategy.Create(Record)</code> or <code>ContactStrategy.Create(Contact)</code> and then pass it to a <code>Sub</code> that invokes <code>Save</code>. I guess I am wondering if there is a better established way for it?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1540934374, "post_id": 53072697, "comment_id": 93044496, "body": "It&#39;s very hard to understand what you have in mind. Can you <a href=\"https://stackoverflow.com/posts/53072697/edit\">edit</a> to clarify? Using placeholder names (&quot;ThingA&quot;, &quot;ThingB&quot;) isn&#39;t helping. Also, read up on repository &amp; unit of work OOP patterns, commonly used for abstracting database/storage operations from the rest of the code in an OOP paradigm."}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540934411, "post_id": 53072697, "comment_id": 93044505, "body": "@MathieuGuindon Thank you for the suggestions, will do!"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1554469395, "post_id": 53072697, "comment_id": 97775374, "body": "If you want a lightweight implementation then you could always pass in a string containing the name of the method to call back on for the implementation and then use <code>Application.Run</code> to call it  (will need to match parameter count for each implementation)"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1554469421, "post_id": 53072697, "comment_id": 97775388, "body": "Might help to incorporate this link into text of the question <a href=\"https://en.wikipedia.org/wiki/Strategy_pattern\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Strategy_pattern</a>"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 1, "creation_date": 1554480186, "post_id": 53072697, "comment_id": 97782124, "body": "If your intention is to save the data out to different locations then all you need is a <code>destination</code> parameter on your <code>.Save</code> function. Pass it whatever you want, database a,b, or z. This keeps you from having to update the strategy when destinations change. It should be modular and totally independent."}, {"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "edited": false, "score": 0, "creation_date": 1554575775, "post_id": 53072697, "comment_id": 97805736, "body": "@Victor K I think what you need is to use <code>Factory-Pattern</code> alongside the strategy one. In that case you would solve most of your requests. Take a look at my answer to check if that is what you&#39;re looking for."}, {"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "edited": false, "score": 0, "creation_date": 1554800204, "post_id": 53072697, "comment_id": 97874614, "body": "@Victor K Hi Victor, if you found this answer helpful, please consider accepting it, so that other users can benefit from it. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 1, "creation_date": 1555601680, "post_id": 55548892, "comment_id": 98175522, "body": "Hey Louis, that&#39;s an extensive answer, thank you! I completely forgot I asked the question, so it took me a while to get back to it. In the meantime I went with a different solution: <code>UnitOfWork</code> class that knows about the database connection and takes <code>ADO Commands</code>, and multiple <code>Crud</code> classes (same interface) for each type of record that create commands for <code>UnitOfWork</code> to transact. I will study your solution as I am certain I can learn a lot from it and use it in the future. Thank you for your answer once again!"}, {"owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1555602070, "post_id": 55548892, "comment_id": 98175752, "body": "@VictorK You&#39;re very welcome, I&#39;m happy that you come up with another solution in the mean time, I wish I could answer this question before. Thank you for accepting the answer nonetheless! :)"}], "tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": true, "score": 2, "last_activity_date": 1554617128, "last_edit_date": 1554617128, "creation_date": 1554552291, "answer_id": 55548892, "question_id": 53072697, "link": "https://stackoverflow.com/questions/53072697/application-specific-implementation-of-a-class-method/55548892#55548892", "title": "Application specific implementation of a class method", "body": "<p>This is a very good question on <code>design-patterns</code> with <code>VBA</code>. </p>\n\n<p>A full description of <code>strategy pattern</code> can be seen <a href=\"https://en.wikipedia.org/wiki/Strategy_pattern\" rel=\"nofollow noreferrer\">here</a>, but to summarize, this is a UML class and sequence diagram describing it:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4u5JT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4u5JT.png\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li><h1> Summary </h1></li>\n</ul>\n\n<p>Basically, this strategy lets the algorithm vary independently from clients that use it. </p>\n\n<blockquote>\n  <p>Deferring the decision about which algorithm to use until runtime allows the calling code to be more flexible and reusable.</p>\n</blockquote>\n\n<p>You proposed this two solutions and I want to explain why I didn't used them:</p>\n\n<ul>\n<li>Wrapping <code>DatabaseStrategy</code> around Record specific to the Record and the application (<code>DatabaseStrategy.Create(Record).Save</code>)\n\n<blockquote>\n  <p>Using this solution would decrease <a href=\"https://en.wikipedia.org/wiki/Cohesion_(computer_science)\" rel=\"nofollow noreferrer\">cohesion</a>, beacuse the <code>class</code> DatabaseStrategy would have to take care of instantiating <code>Record</code> <code>objects</code> (which as I show later, this can be done applying <code>Factory-Pattern</code>) </p>\n</blockquote></li>\n<li>Exposing <code>DatabaseStrategy</code> as a member of the Record but then it seems that application has to know that <code>DatabaseStrategy</code> is a member of the record (<code>Record.DatabaseStrategy.Save</code>)\n\n<blockquote>\n  <p>This design pattern MUST know the strategy, but the innovation is that it can be changed at runtime, passing the desidered strategy object that implements the action methods. In this case I would move <code>DatabaseStrategy</code> away from <code>Record</code>, because the last-mentioned is the <code>object</code> that needs to be saved, but it's not the agent who performs the action (which could be a <code>Database</code> <code>class</code> as I'll show later).</p>\n</blockquote></li>\n</ul>\n\n<p>To solve the problem of how to instantiate this <code>objects</code> with VBA <code>class</code> constructors that don't accept arguments, I used another pattern: the <a href=\"https://en.wikipedia.org/wiki/Factory_method_pattern\" rel=\"nofollow noreferrer\">Factory Pattern</a>. <br></p>\n\n<p><a href=\"https://i.stack.imgur.com/EkZPs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EkZPs.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code below is written just to illustrate how to use these two patterns, so many functions are omitted and there's no real implementation of the database methods. Now here's the rest of the code:</p>\n\n<ul>\n<li><h1> Code </h1></li>\n</ul>\n\n<blockquote>\n  <p><strong>IRecord</strong> <code>class</code> (<strong>Interface</strong>):</p>\n</blockquote>\n\n<pre><code>Public Function getValue() As String: End Function\nPublic Function setValue(stringValue As String): End Function\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><strong>Record</strong> <code>class</code>: <br>\n  This class basically represent a database record. To keep it simple, we only have a <code>value</code> property, but a real implementation would be different of course. </p>\n</blockquote>\n\n<pre><code>Implements IRecord\nPrivate value As String\n\nPrivate Function IRecord_getValue() As String\n    IRecord_getValue = value\nEnd Function\n\nPrivate Function IRecord_setValue(stringValue As String)\n    value = stringValue\nEnd Function\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><strong>IConnectionStrategy</strong> <code>class</code> (<strong>Interface</strong>)<br>\n  This is the Interface of Connection strategy. Little is changed from your code here.</p>\n</blockquote>\n\n<pre><code>Public Function Save(ByVal record As IRecord): End Function\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><strong>ConnectionStrategyA</strong> <code>class</code> <br>\n  Class for Strategy A. Little is changed from your code here.</p>\n</blockquote>\n\n<pre><code>Implements IConnectionStrategy\nPrivate connectionString As String\n\nPrivate Sub Class_Initialize()\n    connectionString = \"DRIVER=Oracle Server;SERVER=myA.server.com\\DatabaseA;\"\nEnd Sub\n\n'Implements Strayegy A\nPrivate Function IConnectionStrategy_Save(ByVal record As IRecord)\n    Debug.Print \"Saving to \", connectionString, \"Record with value:\", record.getValue\nEnd Function\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><strong>ConnectionStrategyB</strong> <code>class</code> <br>\n  Class for Strategy A. Little is changed from your code here.</p>\n</blockquote>\n\n<pre><code>Implements IConnectionStrategy\nPrivate connectionString As String\n\nPrivate Sub Class_Initialize()\n    connectionString = \"DRIVER=SQL Server;SERVER=myB.server.com\\DatabaseB;\"\nEnd Sub\n\n'Implements Strategy B\nPrivate Function IConnectionStrategy_Save(ByVal record As IRecord)\n    Debug.Print \"Saving to \", connectionString, \"Record with value:\", record.getValue\nEnd Function\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><strong>Database</strong> <code>class</code> <br>\n  This is the class that handles the connection with a database. A connection strategy defines how to connect to the database. <br>\n  Note that you can change the strategy without having to recast the object, just invoke <code>setConnectionStrategy(...)</code></p>\n</blockquote>\n\n<pre><code>Private connection As IConnectionStrategy\n\nPrivate Sub Class_Initialize()\n    'Initialize everything but strategy.\nEnd Sub\n\n'Funzione che verr\u00e0 richiamata per inizializzare le propiet\u00e0 della classe\nPublic Sub InitiateProperties(ByVal connectionStrategy As IConnectionStrategy)\n    Set connection = connectionStrategy\nEnd Sub\n\nPublic Sub saveRecord(ByVal record As IRecord)\n    connection.Save record\nEnd Sub\n\nPublic Sub setConnectionStrategy(ByVal strategy As IConnectionStrategy)\n    connection = strategy\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    'close connections\nEnd Sub\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><strong>DatabaseFactory</strong> <code>Module</code> (VBA doesn't have static class, so use a Module instead) <br>\n  This class is responsible for the instantiation of your <code>Database Objects</code></p>\n</blockquote>\n\n<pre><code>'Instantiate a Database with given Strategy\nPublic Function createDatabaseWithStrategy(strategy As IConnectionStrategy) As Database\n    Set createDatabaseWithStrategy = New Database\n    CreateFoglioIdro.InitiateProperties connectionStrategy:=strategy\nEnd Function\n\n'Instantiate a Database with Strategy A\nPublic Function createDatabaseWithStrategyA() As Database\n    Set createDatabaseWithStrategyA = New Database\n    createDatabaseWithStrategyA.InitiateProperties connectionStrategy:=New ConnectionStrategyA\nEnd Function\n\n'Instantiate a Database with Strategy B\nPublic Function createDatabaseWithStrategyB() As Database\n    Set createDatabaseWithStrategyB = New Database\n    createDatabaseWithStrategyB.InitiateProperties connectionStrategy:=New ConnectionStrategyB\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>And finally an example of application (<code>App Module</code>):</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ApplicationA()\n    Dim record As IRecord\n    Set record = New record\n    record.setValue (\"This is a value\")\n\n    Dim db As Database\n    Set db = DatabaseFactory.createDatabaseWithStrategyA\n    db.saveRecord record\n    'Prints-&gt; Saving to     DRIVER=Oracle Server;SERVER=myA.server.com\\DatabaseA;   Record with value:          This is a value\nEnd Sub\n\nPublic Sub ApplicationB()\n    Dim record As IRecord\n    Set record = New record\n    record.setValue (\"This is a value\")\n\n    Dim db As Database\n    Set db = DatabaseFactory.createDatabaseWithStrategyB\n    db.saveRecord record\n    'Prints-&gt; Saving to     DRIVER=SQL Server;SERVER=myB.server.com\\DatabaseB;      Record with value:          This is a value\nEnd Sub\n</code></pre>\n\n<p>As you can see, <code>strategy-pattern</code> combined with <code>Factory-Pattern</code>, helps you eliminating most of the repetitive code to initialize and set a strategy for your Database <code>class</code>.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 1, "accepted_answer_id": 55548892, "answer_count": 1, "score": 7, "last_activity_date": 1554617128, "creation_date": 1540932551, "last_edit_date": 1554613540, "question_id": 53072697, "link": "https://stackoverflow.com/questions/53072697/application-specific-implementation-of-a-class-method", "title": "Application specific implementation of a class method", "body": "<p>I have a library (add-in) with a class that is used in a few small applications. I want to provide a <code>Save</code> method to that class, which \nwill depend on the application that is running.<br>\nTo solve it I am trying to use a strategy pattern(I might be misunderstanding the pattern), but my understanding of the subject is lacking. At runtime I am providing a strategy class that will handle the saving. Common class exposes a <code>Save</code> method that relays it to the provided strategy class. But to keep consistency it appears to me that common class have to implement the strategy interface as well.</p>\n\n<p>IRecord (Common Class) Interface:</p>\n\n<pre><code>Public Function DoSomething(): End Function\nPublic Function SetStrategy(ByVal Strategy As IDatabaseStrategy): End Function\n</code></pre>\n\n<p>Record (Common Class) implementation:</p>\n\n<pre><code>Private RecordStrategy As IDatabaseStrategy\nImplements IRecord\nImplements IDatabaseStrategy 'Implements this interface to have Save method\nPrivate Function IRecord_DoSomething():\n    'does whatever the class is supposed to do\nEnd Function\nPrivate Function IRecord_SetStrategy(ByVal Strategy As IDatabaseStrategy)\n    Set RecordStrategy = Strategy\nEnd Function\nPrivate Function IDataBaseStrategy_Save()\n    RecordStrategy.Save\nEnd Function\n</code></pre>\n\n<p>Strategy Interface and Implementation:</p>\n\n<ul>\n<li><p>IDatabaseStrategy: <code>Public Function Save():End Function</code>  </p></li>\n<li><p>DataBaseStrategyA:   </p>\n\n<pre><code>Implements IDatabaseStrategy\nPrivate Function IDataBaseStrategy_Save()\nDebug.Print \"Saving to database A\"\nEnd Function\n</code></pre></li>\n<li><p>DataBaseStrategyB:   </p>\n\n<pre><code>Implements IDatabaseStrategy\nPrivate Function IDataBaseStrategy_Save()\nDebug.Print \"Saving to database B\"\nEnd Function\n</code></pre></li>\n</ul>\n\n<p>Application Module:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ApplicationA()\n    Dim Item As IRecord\n    Set Item = New Record\n    Dim Strategy As IDatabaseStrategy\n    Set Strategy = New DatabaseStrategyA\n    Item.SetStrategy Strategy 'this would normally be done with constructor\n    Dim ItemToSave As IDatabaseStrategy\n    Set ItemToSave = Item\n    ItemToSave.Save\nEnd Sub\n\nPublic Sub ApplicationB()\n    Dim Item As IRecord\n    Set Item = New Record\n    Dim Strategy As IDatabaseStrategy\n    Set Strategy = New DatabaseStrategyB\n    Item.SetStrategy Strategy 'this would normally be done with constructor\n    Dim ItemToSave As IDatabaseStrategy\n    Set ItemToSave = Item\n    ItemToSave.Save\nEnd Sub\n</code></pre>\n\n<p>With this approach I have to have <code>Record</code> implement <code>Database strategy</code> to have <code>Save</code> method and then recast <code>Item</code> from <code>IRecord</code> to <code>IDatabaseStrategy</code>to use it. I think I am using the pattern incorrectly, so my question is - how do I provide a <code>DatabaseStrategy</code> to a <code>Record</code> so that I do not have to recast the object and possibly without implementing <code>IDatabaseStrategy</code>  in <code>Record</code>?\nAlternatives that I have considered: </p>\n\n<ul>\n<li>Wrapping <code>DatabaseStrategy</code> around <code>Record</code> specific to the <code>Record</code> and the application (<code>DatabaseStrategy.Create(Record).Save</code>)</li>\n<li>Exposing <code>DatabaseStrategy</code> as a member of the <code>Record</code> but then it seems that application has to know that <code>DatabaseStrategy</code> is a member of the record (<code>Record.DatabaseStrategy.Save</code>).</li>\n</ul>\n"}, {"tags": ["excel", "vba", "sorting", "autocad"], "comments": [{"owner": {"reputation": 11, "user_id": 10581961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7670e2d12d2b37d4429eff85e52b000d?s=128&d=identicon&r=PG&f=1", "display_name": "PotatoBrado", "link": "https://stackoverflow.com/users/10581961/potatobrado"}, "edited": false, "score": 0, "creation_date": 1540931996, "post_id": 53072550, "comment_id": 93043540, "body": "<a href=\"https://i.stack.imgur.com/R3XCU.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/R3XCU.png</a>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 4, "creation_date": 1540932564, "post_id": 53072550, "comment_id": 93043760, "body": "Can you please show your existing code or what you&#39;ve tried thus far? Also, are BLU 18 and BLK 16 going to be the only wires that share a workbook? Will all these wire numbers always be in the same order (I understand the number of rows will change). If not the same order, will the text in their description boxes change? Are these the only wire labels you&#39;ll ever have to do this for, or could there be others? Is it possible that there might be no rows at all for a specific wire label? Lots of questions that need to be answered before you can write this out."}, {"owner": {"reputation": 11, "user_id": 10581961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7670e2d12d2b37d4429eff85e52b000d?s=128&d=identicon&r=PG&f=1", "display_name": "PotatoBrado", "link": "https://stackoverflow.com/users/10581961/potatobrado"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1540992770, "post_id": 53072550, "comment_id": 93065932, "body": "I&#39;ve answered your questions as specifically as possible in the post. The code I&#39;ve tried so far is minimal and fairly basic."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1540997211, "post_id": 53072550, "comment_id": 93068960, "body": "Great responses - and thank you for providing your code. Give me a bit and I&#39;ll provide you a solution :)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10581961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7670e2d12d2b37d4429eff85e52b000d?s=128&d=identicon&r=PG&f=1", "display_name": "PotatoBrado", "link": "https://stackoverflow.com/users/10581961/potatobrado"}, "edited": false, "score": 0, "creation_date": 1541021249, "post_id": 53087460, "comment_id": 93081143, "body": "Thanks! That&#39;s given me a good start. Walking through it it weirdly loops through just fine with the 12awg, but then everything else gets put on the 14 awg sheet. For some reason it doesn&#39;t see the blank cell after the 2nd loop through the data. It&#39;s so close! Thank you for your help! I will look back at it again in the morning. Thanks!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 11, "user_id": 10581961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7670e2d12d2b37d4429eff85e52b000d?s=128&d=identicon&r=PG&f=1", "display_name": "PotatoBrado", "link": "https://stackoverflow.com/users/10581961/potatobrado"}, "edited": false, "score": 0, "creation_date": 1541021347, "post_id": 53087460, "comment_id": 93081183, "body": "@PotatoBrado So there mustn&#39;t be a blank cell separating them, I guess instead you could have it look for &quot;Section&quot; and have that be in the end point instead, but it might bring over whatever this empty character is in the cell above it."}, {"owner": {"reputation": 11, "user_id": 10581961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7670e2d12d2b37d4429eff85e52b000d?s=128&d=identicon&r=PG&f=1", "display_name": "PotatoBrado", "link": "https://stackoverflow.com/users/10581961/potatobrado"}, "edited": false, "score": 0, "creation_date": 1541076208, "post_id": 53087460, "comment_id": 93098411, "body": "You were right! The blanks had a space in them for some reason. I was told that anytime when checking for blanks I need to TRIM the cell that&#39;s being checked beforehand because there might be spaces. Not sure why, could be just the way AutoCAD formats the report&#39;s &quot;Empty&quot; cells."}, {"owner": {"reputation": 11, "user_id": 10581961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7670e2d12d2b37d4429eff85e52b000d?s=128&d=identicon&r=PG&f=1", "display_name": "PotatoBrado", "link": "https://stackoverflow.com/users/10581961/potatobrado"}, "edited": false, "score": 0, "creation_date": 1544044128, "post_id": 53087460, "comment_id": 94141031, "body": "Thanks again! I was able to get it all to work with your help! Updated code has been provided in the original text."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1541001306, "creation_date": 1541001306, "answer_id": 53087460, "question_id": 53072550, "link": "https://stackoverflow.com/questions/53072550/excel-macro-for-sorting-wire-sizes-from-autocad/53087460#53087460", "title": "Excel Macro for Sorting Wire sizes from AutoCAD", "body": "<p>Okay, so my understanding is that you're creating 6 new workbooks - 14, 12, 10, 8, 6, and everything else that doesn't fall into those categories. Fortunately the worksheet you're working with is easily setup for one loop through column A - all you have to do is figure out which worksheet to place the data on.</p>\n\n<p>At the end, every worksheet that isn't the original (Sheet1) has a new workbook made for it. <strong>Please note, I did not test the saving new workbooks portion</strong>.</p>\n\n<pre><code>Option Explicit\nSub DivideWireLabels()\n\nDim i As Long, j As Long, k As Long\nDim sht As Worksheet, ws As Worksheet\nDim wb As Workbook\n\n'Add a worksheet for each category\nWith ThisWorkbook\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"WireLabels - All Others\"\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"WireLabels - 14 AWG - 3.6mm\"\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"WireLabels - 12 AWG - 4.2mm\"\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"WireLabels - 10 AWG - 5.0mm\"\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"WireLabels - 8 AWG - 6.0mm\"\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"WireLabels - 6 AWG - 8.0mm\"\nEnd With\n\nSheets(\"Sheet1\").Activate\n\nFor i = 2 To Cells(Rows.Count, 1).End(xlUp).Row\n    If InStr(Cells(i, 1).Value, \"Wire Layer\") &gt; 0 Then\n\n        If InStr(Cells(i, 1).Value, \"_14_\") &gt; 0 Then\n            Set sht = Worksheets(\"WireLabels - 14 AWG - 3.6mm\")\n        ElseIf InStr(Cells(i, 1).Value, \"_12_\") &gt; 0 Then\n            Set sht = Worksheets(\"WireLabels - 12 AWG - 4.2mm\")\n        ElseIf InStr(Cells(i, 1).Value, \"_10_\") &gt; 0 Then\n            Set sht = Worksheets(\"WireLabels - 10 AWG - 5.0mm\")\n        ElseIf InStr(Cells(i, 1).Value, \"_8_\") &gt; 0 Then\n            Set sht = Worksheets(\"WireLabels - 8 AWG - 6.0mm\")\n        ElseIf InStr(Cells(i, 1).Value, \"_6_\") &gt; 0 Then\n            Set sht = Worksheets(\"WireLabels - 6 AWG - 8.0mm\")\n        Else\n            Set sht = Worksheets(\"WireLabels - All Others\")\n        End If\n\n        For j = i + 1 To Cells(Rows.Count, 1).End(xlUp).Row\n            If Cells(j, 1).Value &lt;&gt; \"\" Then\n                k = sht.Cells(sht.Rows.Count, 1).End(xlUp).Row\n\n                If sht.Cells(k, 1).Value = \"\" Then\n                    Cells(j, 1).Copy\n                    sht.Cells(k, 1).PasteSpecial\n                Else\n                    Cells(j, 1).Copy\n                    sht.Cells(k + 1, 1).PasteSpecial\n                End If\n            Else\n                i = j\n                Exit For\n            End If\n        Next j\n\n    End If\nNext i\n\n'Clear clipboard\nApplication.CutCopyMode = False\n\n'Create a workbook for each new worksheet\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Sheet1\" Then\n        Set wb = ws.Application.Workbooks.Add\n        ws.Copy Before:=wb.Sheets(1)\n        wb.SaveAs \"C:\\Users\\MyName\\Desktop\\\" &amp; ws.Name, FileFormat:=FileFormatNum\n        Set wb = Nothing\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10581961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7670e2d12d2b37d4429eff85e52b000d?s=128&d=identicon&r=PG&f=1", "display_name": "PotatoBrado", "link": "https://stackoverflow.com/users/10581961/potatobrado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 53087460, "answer_count": 1, "score": -2, "last_activity_date": 1544043996, "creation_date": 1540931915, "last_edit_date": 1544043996, "question_id": 53072550, "link": "https://stackoverflow.com/questions/53072550/excel-macro-for-sorting-wire-sizes-from-autocad", "title": "Excel Macro for Sorting Wire sizes from AutoCAD", "body": "<p>So what I'm trying to do is I have a wire number report from AutoCAD and I'm taking the wire numbers from the report and transferring them into the wire label printer software for our shop to print. </p>\n\n<p>Making the report is easy; Using the printer software and printing the labels is easy.</p>\n\n<p>It's the difficulty of sorting the wire labels in the excel file that's giving me problems. I can manually sort the wire numbers into their own files just fine but I'm ultimately trying to automate this part of the process. </p>\n\n<p>So I've uploaded an image of raw data next to the 6 sorted and finished excel files.</p>\n\n<p><a href=\"https://i.stack.imgur.com/kYFEO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kYFEO.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see the report separates by wire the wire tag from AutoCAD which is just by wire color and wire gauge. The wire color doesn't matter. Each Wire size has it's own mark tube wire label except for the 16 and 18 gauge; they both can fit in the 3.2mm tube but for simplicity sake I've just kept them separate anyway.</p>\n\n<p>So each set of wire labels will need to go to their separate file for further processing by the printer. They will eventually be changed to .csv files but those are a pain to work with so I'm doing that part last and it's simple to do anyway.</p>\n\n<pre><code>WireLabels - 18AWG - 3.2mm .xlsm\nWireLabels - 16AWG - 3.2mm .xlsm \nWireLabels - 14AWG - 3.6mm .xlsm \nWireLabels - 12AWG - 4.2mm .xlsm \nWireLabels - 10AWG - 5.0mm .xlsm \nWireLabels - 8AWG - 6.0mm .xlsm \nWireLabels - 6AWG - 8.0mm .xlsm \n</code></pre>\n\n<p>I'm basically trying to figure out how to loop down through the column and sort each set of wire numbers to their own file. </p>\n\n<p>It's pretty simple to do with a set range of numbers but with differing reports from AutoCAD from project to project I can't set specific ranges like a range from A5 to A8 and that's where I'm stuck... I've been trying to select a range down to the blank cell past each bit of numbers but can't past that point.</p>\n\n<p>ANY insight would be amazing. Thanks!</p>\n\n<p><strong>Can you please show your existing code or what you've tried thus far?</strong></p>\n\n<pre><code>Sub NewSheets()\n'\n' Macro1 Macro\n'This is is just to have a place to send the groups of numbers for now.\n'They will eventually go to their own new workbooks\n\n'\n    Sheets.Add After:=ActiveSheet\n    Sheets.Add After:=ActiveSheet\n    Sheets.Add After:=ActiveSheet\n    Sheets.Add After:=ActiveSheet\n     Sheets(\"Sheet1\").Select\nEnd Sub\n\nSub wires14()\n  Range(\"A64:A69\").Select\n    Selection.Cut\n    Sheets(\"Sheet3\").Select\n    ActiveSheet.Paste\n\n     Dim wb As Workbook\n\n    '// Set as reference to a new, one-sheet workbook.                              //\n    Set wb = Workbooks.Add(xlWBATWorksheet)\n    With wb\n        '// Skip selecting the sheet, just reference it explicitly and copy it after//\n        '// the blank sheet in the new wb.                                          //\n        ThisWorkbook.Worksheets(\"sheet3\").Copy After:=.Worksheets(.Worksheets.Count)\n        '// Kill alerts, delete the blank sheet in the new wb and turn alerts back on//\n        Application.DisplayAlerts = False\n        .Worksheets(1).Delete\n        Application.DisplayAlerts = True\n        '// SaveAs the new workbook to whatever path and close.                     //\n        .SaveAs Filename:=\"C:\\Users\\Public\\Desktop\\\" &amp; \"14AWG - 4.6mm\"\n        .Close False\n    End With\n\n    ActiveCell.Offset(rowOffset:=3, columnOffset:=3).Activate\n    Sheets(\"Sheet1\").Select\nEnd Sub\n</code></pre>\n\n<p>SO I have a button that can sort the selection and save it as file but automatically going through, finding, and selecting\nwithout specifically calling out a set range of cells is where I got stuck.</p>\n\n<p>This bit I tried can select the specific wire number and copy the following numbers to a new sheet but, again, it only will grab the specified range\nand wouldn't be able to deal with a changing range.</p>\n\n<pre><code>Sub NewSheets()\n'\n' Macro1 Macro\n'This is is just to have a place to send the groups of numbers for now.\n'They will eventually go to their own new workbooks\n\n'\n    Sheets.Add After:=ActiveSheet\n    Sheets.Add After:=ActiveSheet\n    Sheets.Add After:=ActiveSheet\n    Sheets.Add After:=ActiveSheet\n     Sheets(\"Sheet1\").Select\nEnd Sub\n\nSub LoopThruA()\n\n  Columns(\"A:A\").Select\n    Selection.Find(What:=\"_18\", After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False).Activate\n    ActiveCell.Offset(1, 0).Select\nRange(Selection, \"A32\").Select\n     Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Range(\"A1\").Select\n    ActiveSheet.Paste\n\n  End Sub\n</code></pre>\n\n<p><strong>Also, are BLU 18 and BLK 16 going to be the only wires that share a workbook?</strong> </p>\n\n<p>6 gauge, 8, gauge, 10 gauge, 12 gauge, and 14 gauge will all have their own workbook.\n16 gauge, 18 gauge, and ALL other tags that aren't mentioned above will be on the same workbook.\nThis is the case because 'cable' labels and much larger gauge wires will use the 3.2mm tubes strung through a zip tie and simply wrapped around.</p>\n\n<p><strong>Will all these wire numbers always be in the same order (I understand the number of rows will change).</strong> </p>\n\n<p>The order will always be alphabetical/numerical based on the \"(Wire Label)Wire Layer:BLK_12_MTW\" section header\nSo an example order would be</p>\n\n<pre><code>                (Wire Label)Wire Layer:BLK_12_MTW \n                (Wire Label)Wire Layer:BLK_16_MTW\n                (Wire Label)Wire Layer:BLK_16_THHN_FW\n                (Wire Label)Wire Layer:BLK_18_MTW\n                (Wire Label)Wire Layer:BLK_2_MTW   (2 gauge wire)\n                (Wire Label)Wire Layer:BLK_2-0_MTW (2 ought wire)\n                (Wire Label)Wire Layer:BLK_4_MTW\n                (Wire Label)Wire Layer:BLK_6_MTW\n                (Wire Label)Wire Layer:BLU_18_MTW\n                (Wire Label)Wire Layer:BLU_18_THHN_FW\n                (Wire Label)Wire Layer:CABLE\n                (Wire Label)Wire Layer:FIELDWIRE\n                (Wire Label)Wire Layer:RED_18_MTW\n                (Wire Label)Wire Layer:WHT_18_MTW\n</code></pre>\n\n<p><strong>If not the same order, will the text in their description boxes change?</strong></p>\n\n<p>The first part(LEFT) of the text will NOT change \"(Wire Label)Wire Layer:\".</p>\n\n<p><strong>Are these the only wire labels you'll ever have to do this for, or could there be others?</strong></p>\n\n<p>With different colors there can be the same size wire but they will all go to the same new workbook together.\nThere are 25 different wire gauge designations we use and a small assortment of other wire label markers\n such as \"Cable\" \"Cable Trunk\" \"FieldWires\" \"_Multi_WIRE\" and \"Multiconductor\"</p>\n\n<p>The wire sizes we use are as follows.</p>\n\n<pre><code>18\n16\n14\n12\n10\n8\n6\n4   (4 gauge)\n4-0 (4 ought)\n3   (3 gauge)\n3-0 (3 ought, etc...)\n2\n2-0\n1\n1-0\n250\n300\n350\n400\n500\n600\n700\n750\n800\n900\n1000\n</code></pre>\n\n<p>Each number will have a trailing designation such as _MTW or _THHN_FW.</p>\n\n<p>And the possible colors if it matters are...</p>\n\n<pre><code>BLK\nBLU\nBRN\nGRN\nORG\nRED\nWHT-BLU\nWHT\nYEL\n</code></pre>\n\n<p><strong>Is it possible that there might be no rows at all for a specific wire label?</strong></p>\n\n<p>Nope, if there aren't any wires on a wire layer it wont be on the report.</p>\n\n<p><strong>CODE EDIT/UPDATE</strong>\nSo this is what we have working for now. It works. It's not perfect but it does the job.</p>\n\n<pre><code> Option Explicit\n\nSub DivideWireLabels()\n\n\n\n\nDim i As Long, j As Long, K As Long\nDim sht As Worksheet, ws As Worksheet\nDim wb As Workbook\n\n\nWorkbooks(\"OpenAndRunWireLabel SortTool.xls\").Activate\n\n'Add a worksheet for each category\nWith ActiveWorkbook\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"WireLabels - 16-18 &amp; All Others\"\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"WireLabels - 14 AWG - 3_6mm\"\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"WireLabels - 12 AWG - 4_2mm\"\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"WireLabels - 10 AWG - 5_0mm\"\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"WireLabels - 8 AWG - 6_0mm\"\n    .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"WireLabels - 6 AWG - 8_0mm\"\nEnd With\n\nSheets(\"Sheet1\").Activate\n\n'Loop thru the column\n\n\n\n\nFor i = 2 To Cells(Rows.Count, 1).End(xlUp).Row\n\n'Find the wire layer cell\n\n    If InStr(Cells(i, 1).Value, \"Wire Layer\") &gt; 0 Then\n\n'if the wire layer is there, make a new sheet for it\n\n        If InStr(Cells(i, 1).Value, \"_14_\") &gt; 0 Then\n            Set sht = Worksheets(\"WireLabels - 14 AWG - 3_6mm\")\n        ElseIf InStr(Cells(i, 1).Value, \"_12_\") &gt; 0 Then\n            Set sht = Worksheets(\"WireLabels - 12 AWG - 4_2mm\")\n        ElseIf InStr(Cells(i, 1).Value, \"_10_\") &gt; 0 Then\n            Set sht = Worksheets(\"WireLabels - 10 AWG - 5_0mm\")\n        ElseIf InStr(Cells(i, 1).Value, \"_8_\") &gt; 0 Then\n            Set sht = Worksheets(\"WireLabels - 8 AWG - 6_0mm\")\n        ElseIf InStr(Cells(i, 1).Value, \"_6_\") &gt; 0 Then\n            Set sht = Worksheets(\"WireLabels - 6 AWG - 8_0mm\")\n        Else\n            Set sht = Worksheets(\"WireLabels - 16-18 &amp; All Others\")\n        End If\n\n'Take the data and put it in one of the new sheets\n\n        For j = i + 1 To Cells(Rows.Count, 1).End(xlUp).Row\n            If Trim(Cells(j, 1).Value) &lt;&gt; \"\" Then\n                K = sht.Cells(sht.Rows.Count, 1).End(xlUp).Row\n\n                If Trim(sht.Cells(K, 1).Value) = \"\" Then\n                    Cells(j, 1).Copy\n                    sht.Cells(K, 1).PasteSpecial\n                Else\n                    Cells(j, 1).Copy\n                    sht.Cells(K + 1, 1).PasteSpecial\n                End If\n            Else\n                i = j\n                Exit For\n            End If\nNext j\n\nEnd If\n\nNext i\n\n'Clear clipboard\nApplication.CutCopyMode = False\n\n\n'delete sheets 2 and 3\nDim s As Worksheet, t As String\n    Dim L As Long, M As Long\n    M = Sheets.Count\n\n    For L = M To 1 Step -1\n        t = Sheets(L).Name\n        If t = \"Sheet2\" Or t = \"Sheet3\" Then\n            Application.DisplayAlerts = False\n                Sheets(L).Delete\n            Application.DisplayAlerts = True\n        End If\n    Next L\n\n\n\n\n\n\n'Create a workbook for each new worksheet\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Sheet1\" Then\n        Set wb = ws.Application.Workbooks.Add\n        ws.Copy Before:=wb.Sheets(1)\n        wb.SaveAs \"C:\\Users\\Public\\Desktop\\\" &amp; ws.Name, FileFormat:=xlCSV\n        Set wb = Nothing\n    End If\nNext ws\n\nActiveWorkbook.Close SaveChanges:=True\nActiveWorkbook.Close SaveChanges:=True\nActiveWorkbook.Close SaveChanges:=True\nActiveWorkbook.Close SaveChanges:=True\nActiveWorkbook.Close SaveChanges:=True\nActiveWorkbook.Close SaveChanges:=True\nActiveWorkbook.Close SaveChanges:=True\n\n\n   Dim x As Variant\n    Dim Path As String\n\n    ' Set the Path variable equal to the path of your program's installation\n    Path = \"C:\\Program Files\\Nisca Corporation\\M-1ProVPC\\MKP5PC.exe\"\n\n    x = Shell(Path, vbNormalFocus)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "data-structures", "outlook"], "comments": [{"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 1, "creation_date": 1540931220, "post_id": 53072353, "comment_id": 93043185, "body": "My first thought would be to look into dictionaries. I believe you can house dictionaries within other dictionaries. Please see <a href=\"https://stackoverflow.com/q/27180646/10361731\">this question</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 4, "creation_date": 1540931224, "post_id": 53072353, "comment_id": 93043187, "body": "So a <code>Collection</code> of arrays? A jagged array? A <code>Dictionary</code> of arrays? A <code>Dictionary</code> of <code>Collection</code>? Some mix of those?  Lots of ways you can take this...  What are you trying to do?"}, {"owner": {"reputation": 45, "user_id": 1914414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb969db2df43383d84cfdfe6aa88df?s=128&d=identicon&r=PG", "display_name": "MrPlow254", "link": "https://stackoverflow.com/users/1914414/mrplow254"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541689580, "post_id": 53072353, "comment_id": 93308878, "body": "@Comintern It needs to be dynamic. It seems like with collections everything has to be re dimmed every time I want to add a new value. I want to be able to add an unknown amount of contacts that are arrays. This is the exact structure I am showing in my initial comment."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1541689978, "post_id": 53072353, "comment_id": 93309144, "body": "Huh? That&#39;s the point of using a container <i>object</i>. You only have to resize <i>arrays</i>. Tony&#39;s answer demonstrates that fairly effectively."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1541690180, "post_id": 53072353, "comment_id": 93309263, "body": "@MrPlow254 seems you are conflating <code>Collection</code> and <i>array</i>, which are two wildly different data structures. You don&#39;t &quot;re-dim&quot; a collection."}, {"owner": {"reputation": 45, "user_id": 1914414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb969db2df43383d84cfdfe6aa88df?s=128&d=identicon&r=PG", "display_name": "MrPlow254", "link": "https://stackoverflow.com/users/1914414/mrplow254"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541691050, "post_id": 53072353, "comment_id": 93309787, "body": "@MathieuGuindon Thank you for clearing that up. Is it possible to set a key from a variable, and then add a collection to that key? Example an object company.name assigned as a collection key value. Then later call that key and add another item to it. It seems like that is not possible with Set somename = New Collection. How do you define a dynamic key and that will create a new array within. Example in php to do this is just $array[$dynamickey][] = array(&#39;someotherkey&#39; =&gt; 2); and it will add a new array within it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541691255, "post_id": 53072353, "comment_id": 93309896, "body": "PHP also merrily lets you stringify identifiers, I wouldn&#39;t use it as a reference for anything whatsoever. Read Tony&#39;s answer. Carefully."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1541691526, "post_id": 53072353, "comment_id": 93310068, "body": "TBH, it looks like what you <i>really</i> need is an OOP solution with <code>Company</code> and <code>Contact</code> classes."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 1914414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb969db2df43383d84cfdfe6aa88df?s=128&d=identicon&r=PG", "display_name": "MrPlow254", "link": "https://stackoverflow.com/users/1914414/mrplow254"}, "edited": false, "score": 0, "creation_date": 1541689956, "post_id": 53107047, "comment_id": 93309131, "body": "I&#39;m pulling all the information from the mycontacts database in outlook. I have two custom columns &quot;POMain&quot;, and &quot;POcc&quot; with true/false as their values. The VBA code will search all contacts and add them to the correct array designation if the contact is a POMain=true, or POcc=true. It will be created dynamically with an unknown dim value. That is issue one I have had with collections, needing to know the size of the array before I make the array.  Issue two is that the value types are not supported it seems like. The code you just provided might work with some tweaking."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1541690544, "post_id": 53107047, "comment_id": 93309475, "body": "This is the most thorough answer to a vague question I&#39;ve seen in quite a while. Kudos!"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 45, "user_id": 1914414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb969db2df43383d84cfdfe6aa88df?s=128&d=identicon&r=PG", "display_name": "MrPlow254", "link": "https://stackoverflow.com/users/1914414/mrplow254"}, "edited": false, "score": 1, "creation_date": 1541690578, "post_id": 53107047, "comment_id": 93309493, "body": "@MrPlow254 then <i>don&#39;t use arrays</i>! You&#39;ll note that there isn&#39;t a single array in this example, and it&#39;s that way for a reason."}, {"owner": {"reputation": 45, "user_id": 1914414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb969db2df43383d84cfdfe6aa88df?s=128&d=identicon&r=PG", "display_name": "MrPlow254", "link": "https://stackoverflow.com/users/1914414/mrplow254"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1541691443, "post_id": 53107047, "comment_id": 93310016, "body": "@FreeMan sorry there is a computer language barrier. When I refer to an array I am speaking from a PHP perspective. An array in PHP is a map with key and value with multidimensional abilities. Don&#39;t get hung up on the word array. I made it clear in my initial comment that I have an array structure that I want to create dynamically. I am not familiar with VBA and its not straight forward like lua, php, java etc."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 45, "user_id": 1914414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb969db2df43383d84cfdfe6aa88df?s=128&d=identicon&r=PG", "display_name": "MrPlow254", "link": "https://stackoverflow.com/users/1914414/mrplow254"}, "edited": false, "score": 2, "creation_date": 1541691929, "post_id": 53107047, "comment_id": 93310336, "body": "@MrPlow254 You aren&#39;t really referring to an array in PHP <i>either</i> then. What you&#39;re talking about is an <a href=\"https://www.oreilly.com/library/view/programming-php-3rd/9781449361068/ch05s01.html\" rel=\"nofollow noreferrer\"><i>associative array</i></a>. The reason the linked article makes a distinction between the 2 is that the generally accepted definition of a vanilla &quot;array&quot; is indexed. Which everyone here is referring to. In VBA, an associative array is a <code>Collection</code> or a <code>Dictionary</code> or something else that you provide a custom implementation for."}, {"owner": {"reputation": 45, "user_id": 1914414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb969db2df43383d84cfdfe6aa88df?s=128&d=identicon&r=PG", "display_name": "MrPlow254", "link": "https://stackoverflow.com/users/1914414/mrplow254"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541692487, "post_id": 53107047, "comment_id": 93310712, "body": "@Comintern you are correct. I am in the process of implementing a dictionary. Collections have not worked so far which is why I even created this question."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 45, "user_id": 1914414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb969db2df43383d84cfdfe6aa88df?s=128&d=identicon&r=PG", "display_name": "MrPlow254", "link": "https://stackoverflow.com/users/1914414/mrplow254"}, "edited": false, "score": 1, "creation_date": 1541692910, "post_id": 53107047, "comment_id": 93310980, "body": "@MrPlow254 Why don&#39;t you dump the data to a text file and then process it in a language you already know?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 45, "user_id": 1914414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb969db2df43383d84cfdfe6aa88df?s=128&d=identicon&r=PG", "display_name": "MrPlow254", "link": "https://stackoverflow.com/users/1914414/mrplow254"}, "edited": false, "score": 0, "creation_date": 1541692939, "post_id": 53107047, "comment_id": 93311002, "body": "@MrPlow254 If you need to create and process the structure in VBA, please give more information about the processing."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 45, "user_id": 1914414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb969db2df43383d84cfdfe6aa88df?s=128&d=identicon&r=PG", "display_name": "MrPlow254", "link": "https://stackoverflow.com/users/1914414/mrplow254"}, "edited": false, "score": 0, "creation_date": 1541692958, "post_id": 53107047, "comment_id": 93311014, "body": "@MrPlow254 Let&#39;s try and get past the language barrier by explaining some VBA terms.  Arrays can be fixed size or dynamic.  Dynamic arrays can be resized at anytime with existing content preserved although only the last dimension can be changed.   Arrays are typed: String, Integer, Long, Double, Boolean and so on. One available type is Variant which effectly means untyped since a Variant can hold values of any type including an array."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 45, "user_id": 1914414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb969db2df43383d84cfdfe6aa88df?s=128&d=identicon&r=PG", "display_name": "MrPlow254", "link": "https://stackoverflow.com/users/1914414/mrplow254"}, "edited": false, "score": 1, "creation_date": 1541693093, "post_id": 53107047, "comment_id": 93311102, "body": "@MrPlow254 An element of a collection can, optionally, have a key. An element of a collection can be accessed by its position and, if it has one, its key. New elements can be added at the end or before or after any existing element. Any existing element can be deleted. A collection grows or shrinks as necessary with available memory being the only limit. Collection elements are untyped."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 45, "user_id": 1914414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb969db2df43383d84cfdfe6aa88df?s=128&d=identicon&r=PG", "display_name": "MrPlow254", "link": "https://stackoverflow.com/users/1914414/mrplow254"}, "edited": false, "score": 0, "creation_date": 1541693316, "post_id": 53107047, "comment_id": 93311237, "body": "@MrPlow254 In one of your comments you say the required value types are not supported.  What type do you need that is not supported?"}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 3, "last_activity_date": 1541096114, "creation_date": 1541096114, "answer_id": 53107047, "question_id": 53072353, "link": "https://stackoverflow.com/questions/53072353/vba-multi-dimension-array-with-keys/53107047#53107047", "title": "VBA Multi-dimension array with keys?", "body": "<p>I agree with Comintern, there are many different approaches to creating a VBA data structure that would meet your stated requirement.  Without more information, it is difficult or impossible to know which is the best approach for you.</p>\n\n<p>You appear to think that you cannot have a collection within a collection.  This is incorrect.  Below I demonstrate an approach which holds collections within a collection.  However, this is not an approach I would use except for a one-off exercise.  I would not like to be the maintenance programmer asked to update this approach unless it was fully documented.</p>\n\n<p>I needed some test data to demonstrate my code.  I decided to use Excel but this approach would work with any Office product that could hold data of this nature.  My data was:</p>\n\n<p><a href=\"https://i.stack.imgur.com/C98FT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C98FT.png\" alt=\"enter image description here\"></a></p>\n\n<p>I found loading the data structure quite easy with this data.  I believe the documentation within the macro is adequate.</p>\n\n<p>Extracting values from the data structure was much harder because there are so many levels.  I have used constants to make the code a little less difficult to read.  The components of the data structure are:</p>\n\n<ul>\n<li><code>Contacts</code>: A collection</li>\n<li><code>Contacts.Count</code>: The number of elements in <code>Contacts</code></li>\n<li><code>Contacts(InxCntctCrnt)</code>: One element from <code>Contacts</code></li>\n<li><code>Contacts(InxCntctCrnt)(InxCntctCompN)</code>: The company name for <code>Contacts(InxCntctCrnt)</code></li>\n<li><code>Contacts(InxCntctCrnt)(InxCntctPrsnMain)</code>: The collection of main persons for      <code>Contacts(InxCntctCrnt)</code></li>\n<li><code>Contacts(InxCntctCrnt)(InxCntctPrsnCC)</code>: The collection of CC persons for    <code>Contacts(InxCntctCrnt)</code></li>\n<li><code>Contacts(InxCntctCrnt)(InxCntctPrsnMain).Count</code>: The number of elements in the collection of Main persons for <code>Contacts(InxCntctCrnt)</code></li>\n<li><code>Contacts(InxCntctCrnt)(InxCntctPrsnCC).Count</code>: The number of elements in the collection of CC persons for <code>Contacts(InxCntctCrnt)</code></li>\n<li><code>Contacts(InxCntctCrnt)(InxCntctPrsnMain)(InxPrsnMainCrnt)</code>: One element from the collection of Main persons for <code>Contacts(InxCntctCrnt)</code></li>\n<li><code>Contacts(InxCntctCrnt)(InxCntctPrsnCC)(InxPrsnCCCrnt)</code>: One element from the collection of CC persons for <code>Contacts(InxCntctCrnt)</code></li>\n<li><code>Contacts(InxCntctCrnt)(InxCntctPrsnMain)(InxPrsnMainCrnt)(InxPrsnN)</code>: The person name from one element from the collection of Main persons for <code>Contacts(InxCntctCrnt)</code></li>\n<li><code>Contacts(InxCntctCrnt)(InxCntctPrsnMain)(InxPrsnMainCrnt)(InxPrsnA)</code>: The email address from one element from the collection of Main persons for <code>Contacts(InxCntctCrnt)</code></li>\n<li><code>Contacts(InxCntctCrnt)(InxCntctPrsnCC)(InxPrsnCCCrnt)(InxPrsnN)</code>: The person name from one element from the collection of CC persons for <code>Contacts(InxCntctCrnt)</code></li>\n<li><code>Contacts(InxCntctCrnt)(InxCntctPrsnCC)(InxPrsnCCCrnt)(InxPrsnA)</code>: The email address from one element from the collection of CC persons for <code>Contacts(InxCntctCrnt)</code></li>\n</ul>\n\n<p>My code is:</p>\n\n<pre><code>Option Explicit\n\n  ' Columns within worksheet\n  Const ColNameC As Long = 1\n  Const ColTypeP As Long = 2\n  Const ColNameP As Long = 3\n  Const ColAddrP As Long = 4\n  ' First data within worksheet\n  Const RowDataFirst As Long = 3\n\nSub Demo()\n\n  Dim CompanyNameCrnt As String\n  Dim Contacts As New Collection\n  ' Each entry in Contacts is a zero-based array containing\n  '  * String company name\n  '  * Collection of main persons. Each entry in this collection\n  '    is a zero-based array containing a person name and a person email\n  '    address.\n  '  * Collection of cc persons. Format same as collection of main persons\n  Dim PersonsMainCrnt As Collection\n  Dim PersonsCCCrnt As Collection\n  Dim RowCrnt As Long\n  Dim TypeCrnt As String\n\n  CompanyNameCrnt = \"\"   ' No pending company\n\n  With Worksheets(\"Contacts\")\n\n    RowCrnt = RowDataFirst\n\n    Do While .Cells(RowCrnt, ColNameP).Value &lt;&gt; \"\"\n\n      If .Cells(RowCrnt, ColNameC).Value &lt;&gt; \"\" Then\n        ' Start of new company\n        If CompanyNameCrnt &lt;&gt; \"\" Then\n          ' Output company just finished\n          Contacts.Add VBA.Array(CompanyNameCrnt, _\n                                 PersonsMainCrnt, _\n                                 PersonsCCCrnt)\n        End If\n        ' Prepare for new company\n        CompanyNameCrnt = .Cells(RowCrnt, ColNameC).Value\n        Set PersonsMainCrnt = New Collection\n        Set PersonsCCCrnt = New Collection\n      End If\n      If .Cells(RowCrnt, ColTypeP).Value &lt;&gt; \"\" Then\n        ' New type of person\n        TypeCrnt = .Cells(RowCrnt, ColTypeP).Value\n      End If\n      If TypeCrnt = \"Main\" Then\n        PersonsMainCrnt.Add VBA.Array(.Cells(RowCrnt, ColNameP).Value, _\n                                      .Cells(RowCrnt, ColAddrP).Value)\n      ElseIf TypeCrnt = \"CC\" Then\n        PersonsCCCrnt.Add VBA.Array(.Cells(RowCrnt, ColNameP).Value, _\n                                    .Cells(RowCrnt, ColAddrP).Value)\n      Else\n        Debug.Assert False    ' Unknown type\n      End If\n\n      RowCrnt = RowCrnt + 1\n\n    Loop\n\n    If CompanyNameCrnt &lt;&gt; \"\" Then\n      ' Output final company\n      Contacts.Add VBA.Array(CompanyNameCrnt, _\n                             PersonsMainCrnt, _\n                             PersonsCCCrnt)\n    End If\n\n  End With\n\n  ' Indices into element of Contacts\n  Const InxCntctCompN As Long = 0\n  Const InxCntctPrsnMain As Long = 1\n  Const InxCntctPrsnCC As Long = 2\n  ' Indices into element of PersonsMain and PersonsCC\n  Const InxPrsnN As Long = 0\n  Const InxPrsnA As Long = 1\n\n  Dim InxCntctCrnt As Long        ' Loop variable for Contacts\n  Dim InxPrsnMainCrnt As Long     ' Loop variable for main persons\n  Dim InxPrsnCCCrnt As Long       ' Loop variable for CC persons\n\n  For InxCntctCrnt = 1 To Contacts.Count\n    For InxPrsnMainCrnt = 1 To Contacts(InxCntctCrnt)(InxCntctPrsnMain).Count\n      Debug.Print Contacts(InxCntctCrnt)(InxCntctCompN) &amp; \"|Main|\" &amp; _\n                  Contacts(InxCntctCrnt)(InxCntctPrsnMain)(InxPrsnMainCrnt)(InxPrsnN) &amp; \"|\" &amp; _\n                  Contacts(InxCntctCrnt)(InxCntctPrsnMain)(InxPrsnMainCrnt)(InxPrsnA)\n    Next\n    For InxPrsnCCCrnt = 1 To Contacts(InxCntctCrnt)(InxCntctPrsnCC).Count\n      Debug.Print Contacts(InxCntctCrnt)(InxCntctCompN) &amp; \"| CC |\" &amp; _\n                  Contacts(InxCntctCrnt)(InxCntctPrsnCC)(InxPrsnCCCrnt)(InxPrsnN) &amp; \"|\" &amp; _\n                  Contacts(InxCntctCrnt)(InxCntctPrsnCC)(InxPrsnCCCrnt)(InxPrsnA)\n    Next\n  Next\n\nEnd Sub\n</code></pre>\n\n<p>The output from this code:</p>\n\n<pre><code>Company1|Main|John Doe|DoeJohn@One.com\nCompany1|Main|Jane Doe|DoeJane@One.com\nCompany1| CC |John Brown|BrownJohn@One.com\nCompany1| CC |Jane Brown|BrownJane@One.com\nCompany1| CC |Chris Green|GreenChris@One.com\nCompany2|Main|Donald Black|DonaldBlack@Two.com\nCompany2|Main|Esther Clark|EstherClark@Two.com\nCompany2|Main|Francis Davis|FrancisDavis@Two.com\nCompany2| CC |George Eton|GeorgeEton@Two.com\nCompany2| CC |Harry Fox|HarryFox@Two.com\nCompany3|Main|Iris Grant|GrantIris@Three.com\nCompany3|Main|John Hammond|HammondJohn@Three.com\nCompany3|Main|Keith Island|IslandKeith@Three.com\n</code></pre>\n\n<p>Without knowing more about your objectives, I cannot be sure of the approach I would recommend.  My preferred approach would be user types within a collection. Unfortunately, user types are not allowed within collections.  You can have classes within a collection but classes have different restrictions which limits their usefulness.  I suspect user types within an array would be the most self-documenting approach.  I can provide a demonstration of that approach if you think it might be helpful.</p>\n"}], "owner": {"reputation": 45, "user_id": 1914414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/accb969db2df43383d84cfdfe6aa88df?s=128&d=identicon&r=PG", "display_name": "MrPlow254", "link": "https://stackoverflow.com/users/1914414/mrplow254"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "closed_date": 1542070276, "answer_count": 1, "score": -3, "last_activity_date": 1592695142, "creation_date": 1540931062, "last_edit_date": 1592695142, "question_id": 53072353, "link": "https://stackoverflow.com/questions/53072353/vba-multi-dimension-array-with-keys", "closed_reason": "Needs details or clarity", "title": "VBA Multi-dimension array with keys?", "body": "<p>How do I make arrays like as show below in VBA? Every other language it is fairly straight forward. I cannot figure out the best way to design the code. I have looked into collections and it might work, except that I need to create a new collection on another collection dynamically. Which is not possible.</p>\n\n<pre><code> contacts =&gt; array(\n    'company1' =&gt; array(\n        'POMain' =&gt; array(\n        [0] = array(\n            'Email' =&gt; 'demo@demo.com',\n            'Name' =&gt; 'John Doe'\n        ),\n        [1] = array(\n            'Email' =&gt; 'demo@demo.com',\n            'Name' =&gt; 'John Doe'\n        )\n        ),\n        'POCC' =&gt; array(\n            'Email' =&gt; 'demo@demo.com',\n            'Name' =&gt; 'John Doe'\n        )\n    ),\n    'company2' =&gt; array(\n        etcetera...\n    )\n)\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540931937, "post_id": 53072273, "comment_id": 93043519, "body": "You need to map it to window coordinates with <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-screentoclient\" rel=\"nofollow noreferrer\">ScreenToClient</a>."}, {"owner": {"reputation": 1, "user_id": 10575846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e0a94f588212ffe52a21819b1c6522e?s=128&d=identicon&r=PG&f=1", "display_name": "Tanquen", "link": "https://stackoverflow.com/users/10575846/tanquen"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541177067, "post_id": 53072273, "comment_id": 93139910, "body": "ScreenToClient don&#39;t seem to be in VBA."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541177187, "post_id": 53072273, "comment_id": 93139969, "body": "No, it&#39;s not - It&#39;s a library function like <code>GetCursorPos</code>. You&#39;ll need to declare it."}, {"owner": {"reputation": 1, "user_id": 10575846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e0a94f588212ffe52a21819b1c6522e?s=128&d=identicon&r=PG&f=1", "display_name": "Tanquen", "link": "https://stackoverflow.com/users/10575846/tanquen"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541179633, "post_id": 53072273, "comment_id": 93141182, "body": "Added what I found to the OP but not sure of the syntax to get it working."}], "owner": {"reputation": 1, "user_id": 10575846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e0a94f588212ffe52a21819b1c6522e?s=128&d=identicon&r=PG&f=1", "display_name": "Tanquen", "link": "https://stackoverflow.com/users/10575846/tanquen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 576, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541184668, "creation_date": 1540930699, "last_edit_date": 1541184668, "question_id": 53072273, "link": "https://stackoverflow.com/questions/53072273/vba-getcursorpos-x-y-location-on-active-window-not-desktop", "title": "VBA GetCursorPos X/Y location on active window not desktop", "body": "<p>I'm using GetCursorPos in some VBA code and it works well but not when the application is not opened full screen. The X/Y location is based on the mouse desktop location not the location in the application window. Is there a way have it base the X/Y location on the active window or app that the VBA is running in?</p>\n\n<p>I don't know lots about VBA and this in a SCADA application not MS Office.</p>\n\n<p>I found this code but it's not working:</p>\n\n<pre><code>Private Declare Function GetCursorPos Lib \"user32\" (lpPoint As POINTAPI) As Long\n    Private Type POINTAPI\n        X As Long\n        Y As Long\n    End Type\n    Dim Mouse As POINTAPI\n    Dim Cmd As String\n    Dim PNum As String\n\nPrivate Declare Function ClientToScreen Lib \"user32\" (ByVal hwnd As Long, lpPoint As POINTAPI) As Long\n\n\nPrivate Sub Button3_Released()\n    GetCursorPos Mouse\n    ScreenToClient Me.Application.WindowHandle, Mouse\n    MsgBox Mouse.X\nEnd Sub\n</code></pre>\n\n<p>Now it works!</p>\n\n<p>Thanks for the help.</p>\n"}, {"tags": ["excel", "vba", "excel-charts"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 5, "creation_date": 1540930010, "post_id": 53072021, "comment_id": 93042630, "body": "What\u2019s your question exactly?"}], "answers": [{"tags": [], "owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "is_accepted": false, "score": 2, "last_activity_date": 1540932919, "creation_date": 1540932919, "answer_id": 53072795, "question_id": 53072021, "link": "https://stackoverflow.com/questions/53072021/excel-chart-like-battleship-for-space-filling-demonstration/53072795#53072795", "title": "Excel chart like Battleship for space filling demonstration", "body": "<p>You could use a conditional formatting rule like:</p>\n\n<pre><code>=SUMPRODUCT(--EXACT($A2&amp;B$1,Lookup!$A$2:$A$10))\n</code></pre>\n\n<p>with a fill colour of green, and another one</p>\n\n<pre><code>=SUMPRODUCT(--EXACT($A2&amp;B$1,Lookup!$B$2:$B$10))\n</code></pre>\n\n<p>with a fill colour of orange.</p>\n\n<p><a href=\"https://i.stack.imgur.com/BfYxs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BfYxs.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 5325638, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204801206696534/picture?type=large", "display_name": "n4rs", "link": "https://stackoverflow.com/users/5325638/n4rs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1540979089, "answer_count": 1, "score": -1, "last_activity_date": 1586417272, "creation_date": 1540929509, "last_edit_date": 1586417272, "question_id": 53072021, "link": "https://stackoverflow.com/questions/53072021/excel-chart-like-battleship-for-space-filling-demonstration", "closed_reason": "Needs details or clarity", "title": "Excel chart like Battleship for space filling demonstration", "body": "<p>I tried almost everything that I could remember. I have some data like this in an Excel file:</p>\n\n<pre><code>Item 1  Item 2\nA1       B1\nA2       a2\nA3       a3\nB2  \n</code></pre>\n\n<p>I want to create a chart that updates constantly with spaces from A1 to G7 that will get this kind of result (kind of like in Battleship):</p>\n\n<p><a href=\"https://i.stack.imgur.com/6aO9r.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6aO9r.png\" alt=\"Spacing chart\"></a></p>\n\n<p>Any idea how to do this?</p>\n"}, {"tags": ["vba", "ms-access", "powerpoint"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540934095, "post_id": 53071900, "comment_id": 93044404, "body": "What are you intending to display in that label? <code>Recordset1</code> is an <code>ADODB.Recordset</code>, so since you&#39;re not making any member calls, you&#39;re getting the object&#39;s <i>default property</i>, which IIRC would be its <code>Fields</code> collection, which can&#39;t be coerced into a <code>String</code> (you&#39;re getting a <i>type mismatch</i> error?) - assuming you mean to put <code>[xxx]</code> into that label, you need to get that field&#39;s content - <code>Label1.Value = Recordset1.Fields(&quot;xxx&quot;).Value</code>."}, {"owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "edited": false, "score": 0, "creation_date": 1540973149, "post_id": 53071900, "comment_id": 93054979, "body": "Also you can refer to query field by field number for example: Label1.value=Recordset1(0)    dont forget to use Recordset1.movenext after that."}], "answers": [{"tags": [], "owner": {"reputation": 175, "user_id": 6847397, "user_type": "registered", "profile_image": "https://graph.facebook.com/865166940350454/picture?type=large", "display_name": "Nelman Jay Louie Vasquez", "link": "https://stackoverflow.com/users/6847397/nelman-jay-louie-vasquez"}, "is_accepted": true, "score": 1, "last_activity_date": 1541062897, "creation_date": 1541062897, "answer_id": 53098003, "question_id": 53071900, "link": "https://stackoverflow.com/questions/53071900/powerpoint-ms-access-vba-assistance/53098003#53098003", "title": "PowerPoint/MS Access VBA assistance", "body": "<pre><code>Do\n    Label1.Value = Label1.Value &amp; vbCrLf &amp; Recordset1.Fields(\"[YOUR FIELD]\").Value\n    Recordset1.MoveNext\nLoop Until Recordset1.EOF\n</code></pre>\n\n<p>This code will display all records ([YOUR FIELD] Field) in your query.</p>\n\n<blockquote>\n  <p>But you need to add Recordset1.RecordCount to avoid the error.</p>\n</blockquote>\n\n<pre><code>If Recordset1.RecordCount &gt; 0 Then\n    Do\n        Label1.Value = Label1.Value &amp; vbCrLf &amp; Recordset1.Fields(\"[YOUR FIELD]\").Value\n        Recordset1.MoveNext\n    Loop Until Recordset1.EOF\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 9910501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63e6ca9be2532a1a01f1ca6f08f84a51?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/9910501/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 53098003, "answer_count": 1, "score": 0, "last_activity_date": 1541062897, "creation_date": 1540929027, "last_edit_date": 1540974875, "question_id": 53071900, "link": "https://stackoverflow.com/questions/53071900/powerpoint-ms-access-vba-assistance", "title": "PowerPoint/MS Access VBA assistance", "body": "<p>I am trying to automate a report writing process by linking an MS Access database to PowerPoint. I do not know how to make the code output the query into a textbox. The code is running fine until the line with \"******\". Does anyone know how to make the label1.value equal to the query output? Thanks!  </p>\n\n<pre><code>Dim Connect As String, Source As String\nDim Connection As ADODB.Connection\nDim Recordset1 As ADODB.Recordset\n\n'Database path info\n Dim FD As FileDialog\n Dim vrtSelectedItem As Variant\n Dim fileName As String\n\n Set FD = Application.FileDialog(msoFileDialogFilePicker)\n\nWith FD\nIf .Show = -1 Then\nFor Each vrtSelectedItem In .SelectedItems\nMsgBox \"The path is: \" &amp; vrtSelectedItem\n\n 'Open the connection\nSet Connection = New ADODB.Connection\nConnect = \"Provider=Microsoft.ACE.OLEDB.12.0;\"\nConnect = Connect &amp; \"Data Source=\" &amp; vrtSelectedItem &amp; \";\"\nConnection.Open ConnectionString:=Connect\n\n'Set RecordSet\nSet Recordset1 = New ADODB.Recordset\n\nWith Recordset1\n    Source = \"SELECT [xxx] FROM [yyy] WHERE [zzz] = '12345'\"\n.Open Source:=Source, ActiveConnection:=Connection\n********\n***Label1.Value = Recordset1***\n********\nEnd With\n\nNext vrtSelectedItem\n\nEnd If\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "formula"], "answers": [{"comments": [{"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "reply_to_user": {"reputation": 75, "user_id": 8748731, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-tk0373JNZsY/AAAAAAAAAAI/AAAAAAAAATg/0OUCv-yTawg/photo.jpg?sz=128", "display_name": "Kris", "link": "https://stackoverflow.com/users/8748731/kris"}, "edited": false, "score": 0, "creation_date": 1540931084, "post_id": 53072072, "comment_id": 93043119, "body": "Thanks for the feedback. Glad the solution worked for you"}], "tags": [], "owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "is_accepted": true, "score": 4, "last_activity_date": 1540929732, "creation_date": 1540929732, "answer_id": 53072072, "question_id": 53071897, "link": "https://stackoverflow.com/questions/53071897/excel-vba-formula-inserted-by-code-is-not-calculating/53072072#53072072", "title": "Excel VBA - formula inserted by code is not calculating", "body": "<p>Try changing</p>\n\n<pre><code>Range(\"N\" &amp; i).Select\nFormula = \"=left(M\" &amp; i &amp; \";1)\"\nRange(\"N\" &amp; i).Formula = Formula \n</code></pre>\n\n<p>To</p>\n\n<pre><code>Range(\"N\" &amp; i).Formula = \"=left(M\" &amp; i &amp; \",1)\"\n</code></pre>\n\n<p>I suspect that the problem is that you've used <code>;</code> instead of <code>,</code> in separating the parameters of the <code>left</code> function.</p>\n\n<p>It's worth noting that you're going in a round about way of setting the formula by setting it to a variant variable and then setting it to the formula, that isn't declared by the way. Adding <code>Option Explicit</code> to the top helps catch a lot of errors like misspelled variable names and never really hurts.</p>\n\n<p>On another note, it's never a bad idea to learn how to avoid select as it poses its own problems. Please see <a href=\"https://stackoverflow.com/q/10714251/10361731\">How to avoid using Select in VBA</a></p>\n"}], "owner": {"reputation": 75, "user_id": 8748731, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-tk0373JNZsY/AAAAAAAAAAI/AAAAAAAAATg/0OUCv-yTawg/photo.jpg?sz=128", "display_name": "Kris", "link": "https://stackoverflow.com/users/8748731/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 53072072, "answer_count": 1, "score": 2, "last_activity_date": 1540929732, "creation_date": 1540929026, "question_id": 53071897, "link": "https://stackoverflow.com/questions/53071897/excel-vba-formula-inserted-by-code-is-not-calculating", "title": "Excel VBA - formula inserted by code is not calculating", "body": "<p>Good evening,</p>\n\n<p>I'm struggling with my code. Main problem is <strong>not calculating formula automatically</strong>.\nFormula is inserted by VBA (Left function)\nI've tried multiple solutions, but nothing works:</p>\n\n<ul>\n<li>automatically calculated formulas are switched on</li>\n<li>I've tried ActiveCell.NumberFormat = \"General\" - doesnt work</li>\n<li>I've tried Application.Volatile - doesnt work</li>\n<li>Recording text to columns and assign cells to \"general\" (works, but not when Im putting code into my script)</li>\n</ul>\n\n<p>Could you please help me where lies the problem?</p>\n\n<pre><code>Sub QualityCheck()\n\n\n'za\u0142\u00f3\u017c filtry, wyszukaj nag\u0142owka \"vendor\" i posortuj\n\n    Rows(\"1:1\").Select\n    Range(\"F1\").Activate\n    Selection.AutoFilter\n    Selection.Find(What:=\"Vendor\", After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False).Activate\n    Worksheets(1).AutoFilter.Sort.SortFields.Clear\n    Worksheets(1).AutoFilter.Sort.SortFields.Add Key:=Range _\n        (\"K1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortNormal\n    With Worksheets(1).AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n'statystyki\n\n    'znajdz wszystkie te same numery vendora i ostatni aktywny ROW\n    i = 2\n    r = 2\n    koniec = Range(\"K\" &amp; Rows.Count).End(xlUp).Row\n\n    Columns(\"N:N\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\n    Do Until Range(\"K\" &amp; r) &lt; koniec\n\n            Do Until Range(\"K\" &amp; i) &lt;&gt; Range(\"K\" &amp; i + 1)\n\n                    Range(\"N\" &amp; i).Select\n                    Formula = \"=left(M\" &amp; i &amp; \";1)\"\n                    Range(\"N\" &amp; i).Formula = Formula  'OFFSET DODAC ALBO COS\n\n                    ActiveCell.NumberFormat = \"General\"\n\n                i = i + 1 'i to bedzie nasz ostatni row\n            Loop\n\n        r = r + 1\n    Loop\n\n    Selection.TextToColumns Destination:=Range(\"N1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n        :=Array(1, 1), TrailingMinusNumbers:=True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "ms-access", "xml-parsing", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1540928357, "post_id": 53071673, "comment_id": 93041873, "body": "If every XML file is just a single row in a table, and you just want to import 3 fields, I recommend doing it manually: write  up XPATH queries to select the relevant nodes, store their data in a variable, and either open up a recordset and insert the data or use an insert query. That also avoids writing it to disk, reading it back from disk, then cleaning up after."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10526498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dCd4e6w3mu0/AAAAAAAAAAI/AAAAAAAAG-c/gdiTu-Hd8H8/photo.jpg?sz=128", "display_name": "justin munson", "link": "https://stackoverflow.com/users/10526498/justin-munson"}, "edited": false, "score": 0, "creation_date": 1540936741, "post_id": 53073126, "comment_id": 93045144, "body": "You my friend out this is a way where it all made sense. this is working perfect. Thank you so much."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 3, "user_id": 10526498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dCd4e6w3mu0/AAAAAAAAAAI/AAAAAAAAG-c/gdiTu-Hd8H8/photo.jpg?sz=128", "display_name": "justin munson", "link": "https://stackoverflow.com/users/10526498/justin-munson"}, "edited": false, "score": 0, "creation_date": 1540994255, "post_id": 53073126, "comment_id": 93066994, "body": "Great to hear and glad to help. Don&#39;t forget the Stackoverflow way of saying <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work/5235#5235\">thanks</a>!"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1540934648, "creation_date": 1540934648, "answer_id": 53073126, "question_id": 53071673, "link": "https://stackoverflow.com/questions/53071673/importing-xml-from-ws-and-parsing-in-access-table-in-vba/53073126#53073126", "title": "Importing XML from WS and parsing in access table in VBA", "body": "<p>Consider running <a href=\"https://www.w3.org/Style/XSL/\" rel=\"nofollow noreferrer\">XSLT</a>, the special purpose language designed to transform XML files such as your extraction needs. Run the XSLT script just after you retrieve the web XML object and before calling <code>ImportXML</code>. </p>\n\n<p>Specifically the XSLT below runs the Identity Transform (to copy document as is) and then extracts from all <em>Vehicle</em> nodes, the three needed child elements. Here, XSLT maps default namespace to <em>doc</em> prefix.</p>\n\n<p><strong>XSLT</strong> <em>(save as an .xsl file, a special .xml file)</em></p>\n\n<pre><code>&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n                              xmlns:doc=\"http://schemas.datacontract.org/2004/07/Xata.Ignition.WebServiceAPI.Contracts.DataContract.Entities\"\n                              xmlns:a=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\"&gt;                            \n  &lt;xsl:output indent=\"yes\"/&gt;\n  &lt;xsl:strip-space elements=\"*\"/&gt;\n\n  &lt;!-- IDENTITY TRANSFORM --&gt;\n  &lt;xsl:template match=\"@*|node()\"&gt;\n    &lt;xsl:copy&gt;\n      &lt;xsl:apply-templates select=\"@*|node()\"/&gt;\n    &lt;/xsl:copy&gt;\n  &lt;/xsl:template&gt;\n\n  &lt;xsl:template match=\"doc:Vehicle\"&gt;\n    &lt;xsl:copy&gt;\n      &lt;xsl:copy-of select=\"doc:VehicleName|doc:TGTNumber|doc:ResourceGroupIdList/a:string\"/&gt;\n    &lt;/xsl:copy&gt;\n  &lt;/xsl:template&gt;\n\n&lt;/xsl:stylesheet&gt;\n</code></pre>\n\n<p><strong>VBA</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' ADD MSXML, v6.0 REFERENCE UNDER TOOLS\nDim xmlDoc As New MSXML2.DOMDocument60, xslDoc As New MSXML2.DOMDocument60, newDoc As New MSXML2.DOMDocument60\n\n... same code ...\n\n' WEB XML DOC\nSet doc = reader.responseXML\n\n' LOAD XML AND XSL FILES\nxmlDoc.async = False\nxmlDoc.LoadXML doc.XML\n\nxslDoc.async = False\nxslDoc.Load \"C:\\Data\\XSLT_Script.xsl\"\n\n' TRANSFORM XML\nxmlDoc.transformNodeToObject xslDoc, newDoc\n\n' OUTPUT TRANSFORMED XML\nnewDoc.Save \"C:\\Data\\Table.xml\"\n\n' IMPORT TRNASFORMED XML\nApplication.ImportXML \"C:\\Data\\Table.xml\", acStructureAndData\n\n... same code ...\n</code></pre>\n\n<p><strong>XML</strong> <em>(transformed)</em></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-16\"?&gt;\n&lt;ArrayOfVehicle xmlns=\"http://schemas.datacontract.org/2004/07/Xata.Ignition.WebServiceAPI.Contracts.DataContract.Entities\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n    &lt;Vehicle&gt;\n        &lt;a:string xmlns:a=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\"&gt;NOR DISPATCH&lt;/a:string&gt;\n        &lt;TGTNumber&gt;123456&lt;/TGTNumber&gt;\n        &lt;VehicleName&gt;001234SCAC&lt;/VehicleName&gt;\n    &lt;/Vehicle&gt;\n&lt;/ArrayOfVehicle&gt;\n</code></pre>\n\n<p><strong>MS Access Table</strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>string       TGTNumber  VehicleName\nNOR DISPATCH    123456   001234SCAC\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10526498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dCd4e6w3mu0/AAAAAAAAAAI/AAAAAAAAG-c/gdiTu-Hd8H8/photo.jpg?sz=128", "display_name": "justin munson", "link": "https://stackoverflow.com/users/10526498/justin-munson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 2, "accepted_answer_id": 53073126, "answer_count": 1, "score": 0, "last_activity_date": 1594626819, "creation_date": 1540928072, "last_edit_date": 1594626819, "question_id": 53071673, "link": "https://stackoverflow.com/questions/53071673/importing-xml-from-ws-and-parsing-in-access-table-in-vba", "title": "Importing XML from WS and parsing in access table in VBA", "body": "<p>I am working to import data from a web service. I am successful with that but the data imports in 3 tables. I have found various options that i think will work but confused as to which option would be best and make most sense.</p>\n\n<p>Options i've found are</p>\n\n<p>Transforming XML using XSLT\nMultiple ways of parsing including XPATH</p>\n\n<p>Really i've read so much im getting to the point of confusion of what i should be doing.</p>\n\n<p>Here is the XML</p>\n\n<pre><code>&lt;ArrayOfVehicle xmlns=\"http://schemas.datacontract.org/2004/07/Xata.Ignition.WebServiceAPI.Contracts.DataContract.Entities\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n    &lt;Vehicle&gt;\n        &lt;AllowTrailerInspection&gt;true&lt;/AllowTrailerInspection&gt;\n        &lt;Auxiliary&gt;None&lt;/Auxiliary&gt;\n        &lt;CompanyName&gt;Company&lt;/CompanyName&gt;\n        &lt;CompanySID&gt;1234&lt;/CompanySID&gt;\n        &lt;Country&gt;USA&lt;/Country&gt;\n        &lt;EldVehicle&gt;true&lt;/EldVehicle&gt;\n        &lt;FuelDrawCapacity&gt;0&lt;/FuelDrawCapacity&gt;\n        &lt;GrossVehicleWeight&gt;0&lt;/GrossVehicleWeight&gt;\n        &lt;HP&gt;0&lt;/HP&gt;\n        &lt;HUT&gt;false&lt;/HUT&gt;\n        &lt;HasBerth&gt;false&lt;/HasBerth&gt;\n        &lt;HasElectronicEngine&gt;true&lt;/HasElectronicEngine&gt;\n        &lt;HosExempt&gt;false&lt;/HosExempt&gt;\n        &lt;IFTA&gt;true&lt;/IFTA&gt;\n        &lt;InstallDate&gt;2018-10-01T13:01:00&lt;/InstallDate&gt;\n        &lt;LicensePlate&gt;&lt;/LicensePlate&gt;\n        &lt;ManualVIN&gt;false&lt;/ManualVIN&gt;\n        &lt;Manufacture&gt;&lt;/Manufacture&gt;\n        &lt;ManufactureDate&gt;1900-01-01T00:00:00&lt;/ManufactureDate&gt;\n        &lt;Model&gt;&lt;/Model&gt;\n        &lt;ModifiedBy&gt;331&lt;/ModifiedBy&gt;\n        &lt;ModifiedDate&gt;2018-10-19T20:26:03.648543&lt;/ModifiedDate&gt;\n        &lt;OBCType&gt;ABCRelay&lt;/OBCType&gt;\n        &lt;Odometer&gt;0&lt;/Odometer&gt;\n        &lt;OdometerDate&gt;2018-10-01T04:00:00&lt;/OdometerDate&gt;\n        &lt;OrganizationID&gt;ABCLTL&lt;/OrganizationID&gt;\n        &lt;OrganizationName&gt;ABCLTL&lt;/OrganizationName&gt;\n        &lt;OrganizationSID&gt;32&lt;/OrganizationSID&gt;\n        &lt;OwnerOperator&gt;false&lt;/OwnerOperator&gt;\n        &lt;PowerAxles&gt;1&lt;/PowerAxles&gt;\n        &lt;ResourceGroupIdList xmlns:a=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\"&gt;\n            &lt;a:string&gt;NOR DISPATCH&lt;/a:string&gt;\n        &lt;/ResourceGroupIdList&gt;\n        &lt;SID&gt;34163&lt;/SID&gt;\n        &lt;StateProvince&gt;Texas&lt;/StateProvince&gt;\n        &lt;Status&gt;Active&lt;/Status&gt;\n        &lt;StraightTruck&gt;false&lt;/StraightTruck&gt;\n        &lt;TGTNumber&gt;123456&lt;/TGTNumber&gt;\n        &lt;TransmissionMfg&gt;&lt;/TransmissionMfg&gt;\n        &lt;TransmissionType&gt;&lt;/TransmissionType&gt;\n        &lt;Type&gt;Tractor&lt;/Type&gt;\n        &lt;UserDefinedField1&gt;&lt;/UserDefinedField1&gt;\n        &lt;UserDefinedField2&gt;&lt;/UserDefinedField2&gt;\n        &lt;UserDefinedField3&gt;&lt;/UserDefinedField3&gt;\n        &lt;UserDefinedField4&gt;&lt;/UserDefinedField4&gt;\n        &lt;UserDefinedField5&gt;&lt;/UserDefinedField5&gt;\n        &lt;VIN&gt;1FVAHGFCXAJJR8537&lt;/VIN&gt;\n        &lt;VehicleName&gt;001234SCAC&lt;/VehicleName&gt;\n        &lt;Year&gt;&lt;/Year&gt;\n    &lt;/Vehicle&gt;\n    &lt;Vehicle&gt;\n</code></pre>\n\n<p>I am only wanting to import</p>\n\n<pre><code>&lt;VehicleName&gt;\n&lt;TGTNumber&gt; and\n&lt;a:string&gt; inside of &lt;ResourceGroupIDList....\n</code></pre>\n\n<p>This is what I have thus far in VBA</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub UpdateTrucks(strUID As String, strPassword As String)\n    'Debug.Print strDate\n    Dim reader As New XMLHTTP60\n    Dim strUserID As String\n    Dim strRequest As String\n    Dim strSQL As String\n    Dim rs As DAO.Recordset\n\n\n\n    strSQL = \"tblResourceGroups1\"   'defines the Table result that you want to loop\n    Set rs = CurrentDb.OpenRecordset(strSQL)\n    strUserID = \"1234567|\" &amp; strUID\n    strPassword = strPassword\n\n    If Not rs.BOF And Not rs.EOF Then\n    rs.MoveFirst\n    While (Not rs.EOF)\n\n            strRequest = \"http://ws.Website.com/VehicleWebService.svc/vehicles/?ResourceGroupID=\" &amp; rs.Fields(\"ResourceGroupName\")\n            'Debug.Print strRequest\n            reader.Open \"GET\", strRequest, rs.Fields(\"ResourceGroupName\"), strUserID, strPassword\n            reader.send\n\n                Do Until reader.ReadyState = 4\n                    DoEvents\n            Loop\n\n            If reader.status = 200 Then\n            'importXML\n\n            'current\n            Set doc = reader.responseXML\n            doc.Save \"C:\\Data\\Table.xml\"\n            Application.ImportXML \"C:\\Data\\Table.xml\", acStructureAndData\n\n                ElseIf reader.status = 401 Then\n                   MsgBox \"Unable to authenticate. The username and password do not match with the system.\"\n                ElseIf reader.status = 500 Then\n                   MsgBox \"Due to an internal issue the system is unable to take the desired request. Please try again later.\"\n            End If\n\n        rs.MoveNext\n      Wend\n    Else\n        MsgBox \"Unable to import data.\"\n\n    End If\n\n    rs.Close\n    Set rs = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>Any help on the direction i should go would be much appreciated. </p>\n"}]