[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542237026, "post_id": 53309936, "comment_id": 93501025, "body": "Is this a handler in a worksheet, or in the ThisWorkbook module?"}, {"owner": {"reputation": 15, "user_id": 10448044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de54d1929fd192e761c0412d68ad8a1a?s=128&d=identicon&r=PG&f=1", "display_name": "T. Francois", "link": "https://stackoverflow.com/users/10448044/t-francois"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542237499, "post_id": 53309936, "comment_id": 93501185, "body": "It&#39;s a handler within a worksheet."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1542238933, "post_id": 53309936, "comment_id": 93501616, "body": "Are you saying that you want a 1 in the Frequency column the first time a vendor is used on the Wednesday sheet? And then you don&#39;t want that 1 to ever increase no matter how many times that vendor is used? If so, then <code>ThisWorkbook.Sheets(&quot;Vendor List&quot;).Range(cPos).Offset(0, 8).Value = 1</code> will do it."}, {"owner": {"reputation": 15, "user_id": 10448044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de54d1929fd192e761c0412d68ad8a1a?s=128&d=identicon&r=PG&f=1", "display_name": "T. Francois", "link": "https://stackoverflow.com/users/10448044/t-francois"}, "edited": false, "score": 0, "creation_date": 1542239233, "post_id": 53309936, "comment_id": 93501698, "body": "Basically, I have a log for everyday of the week. And the purpose of having a column to record frequency, is to track delivery frequency per day and not necessarily how many times an entry is recorded by the same vendor per day. So if a vendor delivers 5 times in a week, it will show 5. There&#39;s more in the backend of my log, but am ultimately attempting to create a pivottable with the info in the end."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10448044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de54d1929fd192e761c0412d68ad8a1a?s=128&d=identicon&r=PG&f=1", "display_name": "T. Francois", "link": "https://stackoverflow.com/users/10448044/t-francois"}, "edited": false, "score": 0, "creation_date": 1542238845, "post_id": 53310269, "comment_id": 93501588, "body": "Works flawlessly! Thank you for your assistance. However, when recording an additional entry with the same name, it still increases the value by 1 regardless if there&#39;s multiple instances of a name."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 15, "user_id": 10448044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de54d1929fd192e761c0412d68ad8a1a?s=128&d=identicon&r=PG&f=1", "display_name": "T. Francois", "link": "https://stackoverflow.com/users/10448044/t-francois"}, "edited": false, "score": 0, "creation_date": 1542239849, "post_id": 53310269, "comment_id": 93501865, "body": "If you use <code>MsgBox vendorCount</code> in that situation what value pops up?"}, {"owner": {"reputation": 15, "user_id": 10448044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de54d1929fd192e761c0412d68ad8a1a?s=128&d=identicon&r=PG&f=1", "display_name": "T. Francois", "link": "https://stackoverflow.com/users/10448044/t-francois"}, "edited": false, "score": 0, "creation_date": 1542240693, "post_id": 53310269, "comment_id": 93502083, "body": "Nothing happens. No message box comes up."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 15, "user_id": 10448044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de54d1929fd192e761c0412d68ad8a1a?s=128&d=identicon&r=PG&f=1", "display_name": "T. Francois", "link": "https://stackoverflow.com/users/10448044/t-francois"}, "edited": false, "score": 0, "creation_date": 1542241257, "post_id": 53310269, "comment_id": 93502236, "body": "Well <i>something</i> should pop up if you put that Msgbox right after <code>vendorCount = ...</code>"}, {"owner": {"reputation": 15, "user_id": 10448044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de54d1929fd192e761c0412d68ad8a1a?s=128&d=identicon&r=PG&f=1", "display_name": "T. Francois", "link": "https://stackoverflow.com/users/10448044/t-francois"}, "edited": false, "score": 0, "creation_date": 1542242226, "post_id": 53310269, "comment_id": 93502479, "body": "Nothing does unfortunately.  I&#39;ll have to take a stab at it tomorrow, as my brain is fried from messing around with everything earlier."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 15, "user_id": 10448044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de54d1929fd192e761c0412d68ad8a1a?s=128&d=identicon&r=PG&f=1", "display_name": "T. Francois", "link": "https://stackoverflow.com/users/10448044/t-francois"}, "edited": false, "score": 0, "creation_date": 1542245448, "post_id": 53310269, "comment_id": 93503225, "body": "See my edit on the <code>Application.Countif</code> line - I forgot you need to give that a single-area range to look at.  Should be OK now."}, {"owner": {"reputation": 15, "user_id": 10448044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de54d1929fd192e761c0412d68ad8a1a?s=128&d=identicon&r=PG&f=1", "display_name": "T. Francois", "link": "https://stackoverflow.com/users/10448044/t-francois"}, "edited": false, "score": 0, "creation_date": 1542311680, "post_id": 53310269, "comment_id": 93534374, "body": "That indeed did the trick. Learned something as well from this. Thanks a million, Tim!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1542313508, "last_edit_date": 1542313508, "creation_date": 1542237845, "answer_id": 53310269, "question_id": 53309936, "link": "https://stackoverflow.com/questions/53309936/compare-value-in-cell-to-array-and-then-add-value-if-true/53310269#53310269", "title": "Compare Value in Cell to Array and then Add Value if True", "body": "<p>Untested:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Const RNG_VENDOR As String = \"B6:B37,B46:B77\"\n\n    Dim v, f As Range, vendor, vendorCount\n\n    If Target.Count &gt; 1 Then Exit Sub\n    If Intersect(Target, Me.Range(RNG_VENDOR)) Is Nothing Then Exit Sub\n\n    v = Target.Value\n    If IsNumeric(v) And Len(v) &gt; 0 Then\n\n       'see if there's a numeric match\n       Set f = Sheet8.Range(\"A:A\").Find(v, lookat:=xlWhole, LookIn:=xlValues)\n       If Not f Is Nothing Then\n            vendor = f.EntireRow.Cells(1, \"B\").Value 'get the vendor name\n            '#### edit below to fix lookup range\n            vendorCount = Application.CountIf(Me.Range(\"B6:B77\"), vendor) 'count any existing\n            'update the vendors sheet?\n            With f.EntireRow.Cells(1, \"J\")\n                If vendorCount = 0 Then .Value = .Value + 1\n            End With\n            Application.EnableEvents = False\n            Target.Value = vendor 'switch from vendor number to vendor name\n            Application.EnableEvents = True\n\n       Else\n            Application.EnableEvents = False\n            Target.Value = \"\"   'clear the value\n            Application.EnableEvents = True\n            MsgBox \"The Vendor number '\" &amp; v &amp; \"' entered is not listed....\", vbExclamation\n       End If   'was found\n    End If      'is a number\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10448044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de54d1929fd192e761c0412d68ad8a1a?s=128&d=identicon&r=PG&f=1", "display_name": "T. Francois", "link": "https://stackoverflow.com/users/10448044/t-francois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53310269, "answer_count": 1, "score": 1, "last_activity_date": 1542313508, "creation_date": 1542236013, "last_edit_date": 1542236744, "question_id": 53309936, "link": "https://stackoverflow.com/questions/53309936/compare-value-in-cell-to-array-and-then-add-value-if-true", "title": "Compare Value in Cell to Array and then Add Value if True", "body": "<p>I'm still a bit new to VBA and have been working on making my own macros and all on &amp; off. But I have a bit of an issue with a bit of code. </p>\n\n<p>I have a log that I record vendor information in to, and on the worksheet, I have this code below that searches for value entered on it via number entry and it then checks to see if a name is affiliated to it from another worksheet containing the table of names.</p>\n\n<p>The code below works fine for the most part, however, I have had a difficult time trying to get it to also search if the value entered has already been entered either above or below it. As it stands, when a number is entered, it pulls the name and then adds a value of 1 to a corresponding cell by the found result on the worksheet containing the list of names.</p>\n\n<p>The end result I am trying to achieve, is to have it check if the name exists on the current worksheet (Not the sheet with the list of names), and if it does, will not add a value of 1 to the sheet containing all of my names and numbers. </p>\n\n<p>I've tried using a loop but have had no success in getting it to work. Any help would be greatly appreciated!  </p>\n\n<pre><code>If Target.Count &gt; 1 Then Exit Sub\n\nIf Not Intersect(Target, Range(\"B6:B37\", \"B46:B77\")) Is Nothing Then\n\nIf WorksheetFunction.IsNumber(Target.Value) Then\n\n   Application.EnableEvents = False\n\n   Vendor = Sheet8.Range(\"A2:B500\")\n   Target.Value = Application.VLookup(Target.Value, Vendor, 2, False)\n\n   Application.EnableEvents = True\n\n   Set StartValue = ThisWorkbook.Sheets(\"Vendor List\").Range(\"A:B\").Find(What:=Target.Value, LookIn:=xlValues)\n   cPos = StartValue.Address\n\n   Set ThisValue = ThisWorkbook.Sheets(\"Wednesday\").Range(\"B6:B77\").Find(What:=Target.Value, _\n            After:=Target.Value, _\n            LookIn:=xlValues, _\n            LookAt:=xlPart, _\n            SearchDirection:=xlNext, _\n            MatchCase:=True, _\n            SearchFormat:=False)\n\n   ThisWorkbook.Sheets(\"Vendor List\").Range(cPos).Offset(0, 8).Value = ThisWorkbook.Sheets(\"Vendor List\").Range(cPos).Offset(0, 8).Value + 1\n\nEnd If\n\nIf IsError(Target.Value) Then\n\n    Target.Value = \"\"\n    MsgBox \"The Vendor number entered is not listed. Either you have entered an invalid number, or you have not yet added this vendor to the Vendor List sheet.\", vbCritical\n    ThisWorkbook.Sheets(\"Vendor List\").Range(cPos).Offset(0, 8).Value = ThisWorkbook.Sheets(\"Vendor List\").Range(cPos).Offset(0, 8).Value - 1\n\nEnd If\n\nEnd If\n</code></pre>\n\n<p>I've attached an image of how it works. Hopefully, it clears a bit up...</p>\n\n<p><a href=\"https://i.stack.imgur.com/hNrVq.jpg\" rel=\"nofollow noreferrer\">Example</a></p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1542238563, "post_id": 53309935, "comment_id": 93501515, "body": "Use <code>Split(textHere. vbCrLf)</code> to get an array of variable names, then loop over the array and build up the final string, adding to each line until you hit the 70char limit. Add a new line and continue when that happens."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1542270022, "post_id": 53309935, "comment_id": 93510287, "body": "Do note that IBM offers an SPSS ODBC driver, so Access can directly interface with .sav files. Using pasted content and parsing that is both more difficult and more error-prone than just working with the file."}, {"owner": {"reputation": 303, "user_id": 8092789, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d34b37903b1a4764d3d86aeed1387cd0?s=128&d=identicon&r=PG&f=1", "display_name": "DrL", "link": "https://stackoverflow.com/users/8092789/drl"}, "edited": false, "score": 0, "creation_date": 1542303677, "post_id": 53309935, "comment_id": 93530645, "body": "Erik, I&#39;ve had mixed luck with the ODBC driver. For one thing, I think SPSS v. 25 is 64 bit and if the user has a 32 bit version of MS Access, it doesn&#39;t work. Also I&#39;m looking to grab variable names, not their values, for repurposing into syntax. I tried using OMS to push those variable names into Access but it was still just faster to cut/paste!"}], "answers": [{"tags": [], "owner": {"reputation": 303, "user_id": 8092789, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d34b37903b1a4764d3d86aeed1387cd0?s=128&d=identicon&r=PG&f=1", "display_name": "DrL", "link": "https://stackoverflow.com/users/8092789/drl"}, "is_accepted": false, "score": 0, "last_activity_date": 1542303283, "creation_date": 1542303283, "answer_id": 53325023, "question_id": 53309935, "link": "https://stackoverflow.com/questions/53309935/ms-access-vba-split-string-into-pre-defined-width/53325023#53325023", "title": "MS Access VBA: Split string into pre-defined width", "body": "<p>Okay, for posterity, here is a solution:</p>\n\n<p>The field name on the form that captures the user input is VarList. The call to the SPSS_Syntax function below returns the list of variable names (in \"Vars\") that can then be used elsewhere:</p>\n\n<pre><code>Vars = SPSS_Syntax(me.VarList)\n</code></pre>\n\n<p>Recall that user input into Varlist comes in as each variable (word) with a line break in between each. The problem is that we want the list to be on one line (horizontal, not vertical) AND a line can be no more than 256 characters in length (I'm setting it to 70 characters below). Here's the function:</p>\n\n<pre><code>Public Function SPSS_Syntax(InputString As String)\n\nInputString = Replace(InputString, vbNewLine, \" \")  'Puts the string into one line, separated by a space.\n\nMyLength = Len(InputString) 'Computes length of the string\n\nIf MyLength &lt; 70 Then  'if the string is already short enough, just returns it as is.\n    SPSS_Syntax = InputString\n    Exit Function\nEnd If\n\nMyArray = Split(InputString, \" \") 'Creates the array\nDim i As Long\n\nFor i = LBound(MyArray) To UBound(MyArray) 'for each element in the array\n    MyString = MyString &amp; \" \" &amp; MyArray(i) 'combines the string with a blank space in between\n    If Len(MyString) &gt; 70 Then 'when the string gets to be more than 70 characters\n        Syntax = Syntax &amp; \" \" &amp; vbNewLine &amp; MyString 'saves the string as a new line\n        MyString = \"\" 'erases string value for next iteration\n    End If\nNext\n\nSPSS_Syntax = Syntax\n\nEnd Function\n</code></pre>\n\n<p>There's probably a better way to do it but this works. Cheers.</p>\n"}], "owner": {"reputation": 303, "user_id": 8092789, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d34b37903b1a4764d3d86aeed1387cd0?s=128&d=identicon&r=PG&f=1", "display_name": "DrL", "link": "https://stackoverflow.com/users/8092789/drl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542303283, "creation_date": 1542236002, "question_id": 53309935, "link": "https://stackoverflow.com/questions/53309935/ms-access-vba-split-string-into-pre-defined-width", "title": "MS Access VBA: Split string into pre-defined width", "body": "<p>I have MS Access form where the user pastes a string into a field {Vars}, and I want to reformat that string into a new field so that (a) it retains whole words, and (b) \"fits\" within 70 columns. </p>\n\n<p>Specifically, the user will be cutting/pasting variable names from SPSS. So the string will go into the field as whole names---no spaces allowed---with line breaks between each variable. So the first bit of VBA code looks like this:</p>\n\n<pre><code>Vars = Replace(Vars, vbCrLf, \" \")\n</code></pre>\n\n<p>which removes the line breaks. But from there, I'm stumped---ultimately I want the long string that is pasted in the Vars field to be put on consecutive multiple lines that each are no longer than 70 columns.</p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1542235489, "post_id": 53309830, "comment_id": 93500522, "body": "You could turn your sub into a function"}, {"owner": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 0, "creation_date": 1542235596, "post_id": 53309830, "comment_id": 93500565, "body": "I&#39;ve always referred to Pearson&#39;s descriptions for arrays: <a href=\"http://www.cpearson.com/excel/passingandreturningarrays.htm\" rel=\"nofollow noreferrer\">cpearson.com/excel/passingandreturningarrays.htm</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1542236491, "post_id": 53309830, "comment_id": 93500849, "body": "Can you edit the question to include more of your code? It isn&#39;t exactly clear what you&#39;re asking."}], "answers": [{"comments": [{"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1542237878, "post_id": 53309925, "comment_id": 93501295, "body": "In Excel 2010 this won&#39;t compile."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1542238248, "post_id": 53309925, "comment_id": 93501408, "body": "@ArnovanBoven Strange that you&#39;re having issues... <a href=\"https://i.stack.imgur.com/jigax.gif\" rel=\"nofollow noreferrer\">I&#39;m not</a> (No clue what the green screen is about in the last frame though - I think it&#39;s the color used to detect unchanged pixels to make the file smaller)."}, {"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1542238419, "post_id": 53309925, "comment_id": 93501455, "body": "Says &#39;Can&#39;t assign to array&#39; on <code>useArray = varArr(2)</code> in Excel 2010"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1542238463, "post_id": 53309925, "comment_id": 93501476, "body": "That&#39;s because it&#39;s <code>useArray = varArr</code> @ArnovanBoven - <code>useArray</code> hasn&#39;t been dimensionalized until you assign the array to it"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1542238523, "post_id": 53309925, "comment_id": 93501496, "body": "Hahaha oh my - I see it now. Thanks!! @ArnovanBoven"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1542238540, "last_edit_date": 1542238540, "creation_date": 1542235939, "answer_id": 53309925, "question_id": 53309830, "link": "https://stackoverflow.com/questions/53309830/how-to-access-populated-array-in-another-sub-in-vba-w-o-arguments/53309925#53309925", "title": "How to access populated array in another sub in VBA, w/o arguments?", "body": "<p>The preferred method is going to be turning your Sub into a Function:</p>\n\n<pre><code>Function useArray(ByRef varArr() As String) As string()\n\n    varArr(2) = \"changed it\"\n    useArray = varArr\n\nEnd Function\n</code></pre>\n\n<p>Which you would call by:</p>\n\n<pre><code>Sub test()\n\n    Dim a(2) As String\n\n    a(0) = \"a0\"\n    a(1) = \"a1\"\n    a(2) = \"a2\"\n\n    MsgBox useArray(a)(2)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "is_accepted": false, "score": 0, "last_activity_date": 1542237372, "creation_date": 1542237372, "answer_id": 53310188, "question_id": 53309830, "link": "https://stackoverflow.com/questions/53309830/how-to-access-populated-array-in-another-sub-in-vba-w-o-arguments/53310188#53310188", "title": "How to access populated array in another sub in VBA, w/o arguments?", "body": "<pre><code>Sub Main()\n    Call DoSomethingWithArray(PopulateArray)\nEnd Sub\n\nFunction PopulateArray() As Variant\n    PopulateArray = Array(\"foo\", \"bar\") ' return some array\nEnd Function\n\nSub DoSomethingWithArray(ByVal someArray As Variant) ' process array\n    Dim i As Integer\n    For i = LBound(someArray) To UBound(someArray)\n        Debug.Print someArray(i)\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10641447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/enOou.jpg?s=128&g=1", "display_name": "LBJ", "link": "https://stackoverflow.com/users/10641447/lbj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1586383910, "creation_date": 1542235325, "last_edit_date": 1586383910, "question_id": 53309830, "link": "https://stackoverflow.com/questions/53309830/how-to-access-populated-array-in-another-sub-in-vba-w-o-arguments", "title": "How to access populated array in another sub in VBA, w/o arguments?", "body": "<p>I am so confused, and endless googling is so far defying me. \nI have a sub that collected unique values in Column C into an array. Now that the array is created, I need to use it in a different sub so I can loop through the values. </p>\n\n<p>I have tried passing it as an argument but then I can't figure out how to run the new sub that has arguments, i.e.: </p>\n\n<pre><code>Sub useArray(ByRef varArr() As String) \n</code></pre>\n\n<ul>\n<li>how in the world do I run useArray? And useArray should be the main sub, anyways, so I am just confused about how I could then run the main sub and use this array variable that has already been defined/populated. </li>\n</ul>\n\n<p>I tried using my sub that gets the unique values as a function, but it doesn't pass the values in the array back to the main sub. At the end of the function AND in the main sub I have: </p>\n\n<pre><code>MsgBox varArr(1)\n</code></pre>\n\n<p>In the function, it returns the first value. Back in the sub it returns an error.</p>\n\n<p>An assistance would save my sanity!</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4271447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbd4d03688c4454d3028dcf62b7b7bb?s=128&d=identicon&r=PG", "display_name": "arl16", "link": "https://stackoverflow.com/users/4271447/arl16"}, "edited": false, "score": 0, "creation_date": 1542748578, "post_id": 53309054, "comment_id": 93678544, "body": "OK - that&#39;s working - Thanks!  But I actually wanted the next table down on that page. So I changed &quot;.r_table3.print97&quot; to &quot;.r_table3.width955px.print97&quot;  and I start getting a Run-time error &#39;424&#39;: Object required.  Forgive my newbie question, but I thought we already declared that object, so I&#39;m not understanding why switching tables is causing this error. Thanks again for your help!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 37, "user_id": 4271447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbd4d03688c4454d3028dcf62b7b7bb?s=128&d=identicon&r=PG", "display_name": "arl16", "link": "https://stackoverflow.com/users/4271447/arl16"}, "edited": false, "score": 0, "creation_date": 1542748732, "post_id": 53309054, "comment_id": 93678615, "body": "Use clipboard.SetText ele.item(2).outerHTML"}, {"owner": {"reputation": 37, "user_id": 4271447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbd4d03688c4454d3028dcf62b7b7bb?s=128&d=identicon&r=PG", "display_name": "arl16", "link": "https://stackoverflow.com/users/4271447/arl16"}, "edited": false, "score": 0, "creation_date": 1542748975, "post_id": 53309054, "comment_id": 93678730, "body": "Instead of  clipboard.SetText ele.Item(1).outerHTML?   (If so, that&#39;s not working for me)  Still getting the same 424 error"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 37, "user_id": 4271447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbd4d03688c4454d3028dcf62b7b7bb?s=128&d=identicon&r=PG", "display_name": "arl16", "link": "https://stackoverflow.com/users/4271447/arl16"}, "edited": false, "score": 0, "creation_date": 1542749180, "post_id": 53309054, "comment_id": 93678832, "body": "It you can get table 1 fine then you should be able to get the next. Insert debug.print ele.length before the failing line. Then Ctrl + G to check what value is printed. Also, check your code is as in my link above. You can also increase Const MAX_WAIT_SEC As Long = 10"}, {"owner": {"reputation": 37, "user_id": 4271447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbd4d03688c4454d3028dcf62b7b7bb?s=128&d=identicon&r=PG", "display_name": "arl16", "link": "https://stackoverflow.com/users/4271447/arl16"}, "edited": false, "score": 0, "creation_date": 1542749819, "post_id": 53309054, "comment_id": 93679125, "body": "The only difference in my code is I&#39;m using .r_table3.width955px.print97 instead of .r_table3.print97.  The debug produces just the number 1... not sure where that is coming from!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 37, "user_id": 4271447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbd4d03688c4454d3028dcf62b7b7bb?s=128&d=identicon&r=PG", "display_name": "arl16", "link": "https://stackoverflow.com/users/4271447/arl16"}, "edited": false, "score": 0, "creation_date": 1542750040, "post_id": 53309054, "comment_id": 93679215, "body": "With that change in selector your table is now at index 0 This means you can just use querySelector as shown in following: <a href=\"https://pastebin.com/8EjacfnA\" rel=\"nofollow noreferrer\">pastebin.com/8EjacfnA</a>"}, {"owner": {"reputation": 37, "user_id": 4271447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbd4d03688c4454d3028dcf62b7b7bb?s=128&d=identicon&r=PG", "display_name": "arl16", "link": "https://stackoverflow.com/users/4271447/arl16"}, "edited": false, "score": 1, "creation_date": 1542750403, "post_id": 53309054, "comment_id": 93679385, "body": "That did it!  Thank you very much!!  Only other question - any way to do it without a window opening?  i.e. just work in the background... I plan on adding this to other code to pull that table on many funds, and don&#39;t want a new window opening each time.  Thanks again!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 37, "user_id": 4271447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbd4d03688c4454d3028dcf62b7b7bb?s=128&d=identicon&r=PG", "display_name": "arl16", "link": "https://stackoverflow.com/users/4271447/arl16"}, "edited": false, "score": 0, "creation_date": 1542750622, "post_id": 53309054, "comment_id": 93679466, "body": "ie.visible = False You can&#39;t see it. If you don&#39;t want any browser opening then consider whether API is offered and use XMLHTTP."}, {"owner": {"reputation": 37, "user_id": 4271447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbd4d03688c4454d3028dcf62b7b7bb?s=128&d=identicon&r=PG", "display_name": "arl16", "link": "https://stackoverflow.com/users/4271447/arl16"}, "edited": false, "score": 0, "creation_date": 1542751290, "post_id": 53309054, "comment_id": 93679785, "body": "Not sure how to get the API, but I thought that wouldn&#39;t work due to Javascript"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 37, "user_id": 4271447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbd4d03688c4454d3028dcf62b7b7bb?s=128&d=identicon&r=PG", "display_name": "arl16", "link": "https://stackoverflow.com/users/4271447/arl16"}, "edited": false, "score": 0, "creation_date": 1542751342, "post_id": 53309054, "comment_id": 93679812, "body": "API if available won\u2019t have that problem. It serves up everything in the response."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 37, "user_id": 4271447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbd4d03688c4454d3028dcf62b7b7bb?s=128&d=identicon&r=PG", "display_name": "arl16", "link": "https://stackoverflow.com/users/4271447/arl16"}, "edited": false, "score": 0, "creation_date": 1542751398, "post_id": 53309054, "comment_id": 93679835, "body": "You would need to research if an API is made available"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1542748784, "last_edit_date": 1542748784, "creation_date": 1542231192, "answer_id": 53309054, "question_id": 53308825, "link": "https://stackoverflow.com/questions/53308825/need-help-getting-table-from-html/53309054#53309054", "title": "Need help getting table from HTML", "body": "<p>The data is loaded by javascript and won't be available via XMLHTTP request as scripts won't have run to load content.</p>\n\n<p>You can use that second link, for example, with IE and introduce a wait to ensure info is loaded. I show getting the table with that class name at index 1. You can change the index here:</p>\n\n<pre><code>ele.item(1).outerHTML\n</code></pre>\n\n<p>So, for the next table use <code>clipboard.SetText ele.item(2).outerHTML</code> .</p>\n\n<p>You can also loop the <code>.Length</code> of <code>ele</code> to get each table but ensure you write out to a different cell when you paste:</p>\n\n<pre><code>Dim i As Long\nFor i = 0 To ele.Length-1\n    clipboard.SetText  ele.item(i).outerHTML\n   'Etc   \nNext\n</code></pre>\n\n<hr>\n\n<p>VBA:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetInfo()\n    Dim IE As New InternetExplorer, clipboard As Object\n    Dim ele As Object, ws As Worksheet, t As Date, tableCount As Long\n    Const MAX_WAIT_SEC As Long = 5\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n\n    With IE\n        .Visible = True\n        .navigate \"http://performance.morningstar.com/fund/performance-return.action?t=VFINX&amp;region=usa&amp;culture=en_US\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n            t = Timer\n            Do\n                DoEvents\n                On Error Resume Next\n                Set ele = .querySelectorAll(\".r_table3.print97\")\n                tableCount = ele.Length\n                On Error GoTo 0\n                If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n            Loop While tableCount &lt; 3\n\n            If Not ele Is Nothing Then\n                clipboard.SetText ele.item(1).outerHTML\n                clipboard.PutInClipboard\n                ws.Cells(1, 1).PasteSpecial\n            End If\n        End With\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><img src=\"https://i.stack.imgur.com/K1wNg.png\" width=\"350\"></p>\n"}], "owner": {"reputation": 37, "user_id": 4271447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbd4d03688c4454d3028dcf62b7b7bb?s=128&d=identicon&r=PG", "display_name": "arl16", "link": "https://stackoverflow.com/users/4271447/arl16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 53309054, "answer_count": 1, "score": 2, "last_activity_date": 1586386236, "creation_date": 1542230133, "last_edit_date": 1586386236, "question_id": 53308825, "link": "https://stackoverflow.com/questions/53308825/need-help-getting-table-from-html", "title": "Need help getting table from HTML", "body": "<p>I had been successfully pulling mutual fund performance data from Marketwatch.com using the following code:</p>\n\n<pre><code>Dim A As Long\nDim B As Long\nDim C As Long\nDim Z As Long\n\n\nFor Z = 1 To 35\n\n    Range(\"A1\").Select\n    ActiveCell.Offset((37 + (Z * 10)), 0).Select\n    If ActiveCell.Value = \"\" Then\n    Exit For\n    Else\n    End If\nDim oHTML       As Object\nDim oTable      As Object\nDim x           As Long\nDim Y           As Long\nDim vData       As Variant\n\nSet oHTML = CreateObject(\"HTMLFile\")\n\nWith CreateObject(\"WinHTTP.WinHTTPRequest.5.1\")\n.Open \"GET\", \"http://www.marketwatch.com/investing/fund/vfinx\", False\n.send\noHTML.body.innerhtml = .responsetext\nEnd With\n\nFor Each oTable In oHTML.Getelementsbytagname(\"table\")\nIf oTable.classname = \"fundstable\" Then\n    ReDim vData(1 To oTable.Rows.Length, 1 To oTable.Rows(1).Cells.Length)\n\n        For x = 1 To UBound(vData)\n        For Y = 1 To UBound(vData, 2)\n            vData(x, Y) = oTable.Rows(x - 1).Cells(Y - 1).innertext\n        Next Y\n        Next x\n\n    With ActiveCell.Offset(1, 0)\n    .Resize(UBound(vData), UBound(vData, 2)).Value = vData\n    End With\nExit For\nEnd If\nNext oTable\n\nNext Z\n</code></pre>\n\n<p>Unfortunately, Marketwatch has added a Captcha to stop bots (i.e. me) from scraping their data. I don't know of anyway around this, so I figured I'd try another site.</p>\n\n<p>I looked at Morningstar:  <a href=\"http://performance.morningstar.com/fund/performance-return.action?t=VFINX&amp;region=usa&amp;culture=en_US\" rel=\"nofollow noreferrer\">http://performance.morningstar.com/fund/performance-return.action?t=VFINX&amp;region=usa&amp;culture=en_US</a></p>\n\n<p>It appears that the table I want on that page would be:  \"table.r_table3 width955px  print97\" or just \"r_table3 width955px  print97\", but neither one seems to work for me.  </p>\n\n<p>Any ideas? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel-2013"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1542230074, "post_id": 53308668, "comment_id": 93498371, "body": "Your <code>If</code> condition is completely tortured. Based on the <code>MsgBox</code>, it should be more like <code>If ctrl.Value &lt;&gt; &quot;X&quot; And ctrl.Value &lt;&gt; &quot;NA&quot; Then</code>."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542232557, "post_id": 53308668, "comment_id": 93499429, "body": "Yeah I noticed that and changed it completely.  See answer below.  Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": true, "score": 0, "last_activity_date": 1542232839, "last_edit_date": 1542232839, "creation_date": 1542232495, "answer_id": 53309303, "question_id": 53308668, "link": "https://stackoverflow.com/questions/53308668/setting-tag-property-of-userform-textbox/53309303#53309303", "title": "Setting Tag Property of UserForm TextBox", "body": "<p>I figured it out; the issue wasn't in the <code>UserForm Activate</code>.  It was in the Save and Cont Code.  I dont think I was looking at enough of the <code>If</code> conditions, so I set up a <code>Select Case</code> and it works now.  It's probably not the most elegant solution.</p>\n\n<pre><code>For Each ctrl In UWchecklist.Controls\n    If ctrl.Tag = \"Check\" Then\n        Select Case ctrl.Value\n            Case Is = \"\"\n                ctrl.BackColor = vbWhite\n            Case Is = \"X\"\n                ctrl.BackColor = vbWhite\n                ctrl.Text = \"X\"\n            Case Is = \"NA\"\n                ctrl.BackColor = vbWhite\n                ctrl.Text = \"NA\"\n            Case Is &lt;&gt; \"X\"\n                ctrl.Value = vbNullString\n                ctrl.BackColor = vbRed\n            Case Is &lt;&gt; \"NA\"\n                ctrl.Value = vbNullString\n                ctrl.BackColor = vbRed\n        End Select\n    End If\nNext ctrl\n\nMsgBox \"Only a value of \" &amp; \"X \" &amp; \"or \" &amp; \"NA \" &amp; \"is allowed.\", 0, \"DATA ENTRY ERROR\"\n</code></pre>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 982, "favorite_count": 0, "accepted_answer_id": 53309303, "answer_count": 1, "score": 0, "last_activity_date": 1542232839, "creation_date": 1542229394, "question_id": 53308668, "link": "https://stackoverflow.com/questions/53308668/setting-tag-property-of-userform-textbox", "title": "Setting Tag Property of UserForm TextBox", "body": "<p>I need some help with setting the Tag Property of a TextBox in a UserForm when the form activates and then checking to make sure that the Text Boxes with that <code>Tag</code> match the conditions when the Save Button is clicked.  I believe the issue to be with how I am setting the tag property when the UserForm activates, but I wouldnt be surprised if there is something wrong in the logic of the code when the UserForm Activates.  Thank you in advance for your assistance.</p>\n\n<p>Code for when the UserForm Activates:</p>\n\n<pre><code>Private Sub UserForm_Activate()\n    Dim i As Long\n\n        For Each ctrl In UWchecklist.Controls\n            Select Case TypeName(ctrl)\n                Case Is = \"ComboBox\"\n                    If ctrl.Tag = \"yesno\" Then\n                        ctrl.RowSource = \"YesNo\"\n                    End If\n                    ctrl.Font.Size = 10\n                Case Is = \"TextBox\"\n                    ctrl.Font.Size = 10\n                        For i = 1 To 30\n                            If ctrl.Name = (\"uwtxTB\" &amp; i) Then\n                                ctrl.Tag = \"Check\"\n                            End If\n                        Next i\n            End Select\n        Next ctrl\nEnd Sub\n</code></pre>\n\n<p>Code for when the Save Button is Clicked:</p>\n\n<pre><code>Private Sub SandCont_Click()\n\n    For Each ctrl In UWchecklist.Controls\n        If TypeName(ctrl) = \"TextBox\" Then\n            If ctrl.Tag = \"Check\" Then\n                If Not ctrl.Value = vbNullString And Not ctrl.Value = \"X\" Or Not ctrl.Value = \"NA\" Then\n                    ctrl.Value = vbNullString\n                    ctrl.BackColor = vbRed\n                    MsgBox \"Only a value of \" &amp; \"X \" &amp; \"or \" &amp; \"NA \" &amp; \"is allowed.\", 0, \"DATA ENTRY ERROR\"\n                End If\n            End If\n        End If\n    Next ctrl\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1542226820, "creation_date": 1542226820, "answer_id": 53308160, "question_id": 53307758, "link": "https://stackoverflow.com/questions/53307758/change-record-on-a-single-form-in-access-2016/53308160#53308160", "title": "Change Record on a Single form In Access 2016", "body": "<p>If I get your question correctly, you want to navigate to a certain record in the current form based on a condition</p>\n\n<p>To navigate the form, the easiest way is to open up a recordset clone, use <code>.FindFirst</code>, and then change the current record on the form to the found record:</p>\n\n<pre><code>Dim rs As Recordset\nSet rs = Me.RecordsetClone 'Load form records into recordset clone\nrs.FindFirst \"ShiftDate = \" &amp; Format(DateOfRecord, \"\\#yyyy-mm-dd\\#\") 'Navigate to date\nIf Not rs.NoMatch 'If there's a matching record\n    Me.Bookmark = rs.Bookmark 'Navigate to it\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 801, "user_id": 4462995, "user_type": "registered", "accept_rate": 41, "profile_image": "https://graph.facebook.com/509813639/picture?type=large", "display_name": "djblois", "link": "https://stackoverflow.com/users/4462995/djblois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542226820, "creation_date": 1542224932, "question_id": 53307758, "link": "https://stackoverflow.com/questions/53307758/change-record-on-a-single-form-in-access-2016", "title": "Change Record on a Single form In Access 2016", "body": "<p>I have a form that allows the user to select the date at the top. As the user changes the date, it should change the record to reflect. If there is a record for that date already then switch to that record, but if no record for that date create a new one. The table is set to not allow duplicates on the date column. Here is the code I have on the Form_Load event and the respective subs that I call:</p>\n\n<pre><code>Private Sub Form_Load()\n\n    Me.cobYear.Value = Year(Date)\n    Me.cobMonth.Value = Month(Date)\n    DaysChange Me\n    Me.cobDate.Value = Day(Date)\n    UpdateDate Me\n    DoCmd.Maximize\n\nEnd Sub\n\nSub DaysChange(objForm As Form)\n\n    Dim i As Integer\n    Dim DaysInMonth As Integer\n    Dim LeapDay As Integer\n\n    LeapDay = 0\n    If (Int(objForm.cobYear / 400) = (objForm.cobYear / 400)) Or ((Int(objForm.cobYear / 4) = (objForm.cobYear / 4)) And Not (Int(objForm.cobYear / 100) = (objForm.cobYear / 100))) Then\n        LeapDay = IIf(objForm.cobMonth = 2, 1, 0)\n    End If\n\n    DaysInMonth = DLookup(\"DaysInMonth\", \"tblMonths\", \"MonthNumber =\" &amp; objForm.cobMonth) + LeapDay\n    For i = 1 To DaysInMonth\n        objForm.cobDate.AddItem Item:=i\n    Next i\n\nEnd Sub\n\nSub UpdateDate(objForm As Form)\n\n    If Not objForm.cobDate = \"\" And Not objForm.cobMonth = \"\" And Not objForm.cobYear = \"\" Then\n        objForm.tbDate.Value = DateSerial(objForm.cobYear, objForm.cobMonth, objForm.cobDate)\n        DayOfWeek = Weekday(objForm.tbDate.Value, 2)\n        'Me!subfrmDispatchSheet.Form.cobRouteID.Requery\n        objForm.lblDayOfWeek.Caption = WeekdayName(Weekday(objForm.tbDate.Value))\n        DateOfRecord = objForm.tbDate.Value\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>And this is the code for when a user changes the date:</p>\n\n<pre><code>Private Sub cobDate_Change()\n\n    UpdateDate Me\n    ChangeRecord\n\nEnd Sub\n\nPrivate Sub cobMonth_Change()\n\n    DaysChange Me\n    UpdateDate Me\n    ChangeRecord\n\nEnd Sub\n\nPrivate Sub cobYear_Change()\n\n    DaysChange Me\n    UpdateDate Me\n    ChangeRecord\n\nEnd Sub\n</code></pre>\n\n<p>I have tried a few ways to do this.</p>\n\n<p>1) I tried completely in code:</p>\n\n<pre><code>Private Sub ChangeRecord()\n\n    If DCount(\"ShiftDate\", \"tblShiftRecap\", \"ShiftDate =\" &amp; Me.tbDate.Value) = 0 Then\n\n    Else\n        Me.tbShiftID.Value = DLookup(\"ShiftID\", \"tblShiftRecap\", \"ShiftDate =\" &amp; Me.tbDate.Value)\n    End If\n    Me.Requery\n\nEnd Sub\n</code></pre>\n\n<p>How can I do this on a single form? I know how to do it if I add a subform but not if all the fields are in my single form.</p>\n\n<p>Unfortunately, this tries to add a new record when I load up the form.</p>\n\n<p>2) I tried doing it in the query also</p>\n\n<pre><code>SELECT tblShiftRecap.ShiftID, tblShiftRecap.MQFStartTime\nFROM tblShiftRecap\nWHERE (((tblShiftRecap.ShiftDate)=GetDateOfRecord()));\n</code></pre>\n\n<p>and the functiont that the SQL calls:</p>\n\n<pre><code>Public Function GetDateOfRecord()\n\n    GetDateOfRecord = DateOfRecord\n\nEnd Function\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1542225702, "post_id": 53307731, "comment_id": 93496474, "body": "We will be able to help you more if you can tell us exactly what is not working and some sample of the html you are working with. For more see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1542228320, "post_id": 53307731, "comment_id": 93497654, "body": "There is also Bloomberg Excel Add In for retrieving stock prices <a href=\"https://www.youtube.com/watch?v=w6YfBCZ9TiM\" rel=\"nofollow noreferrer\">youtube.com/watch?v=w6YfBCZ9TiM</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6888782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b81a398eb3841cc707526799b0d2fc4d?s=128&d=identicon&r=PG&f=1", "display_name": "The.NetDeveloper", "link": "https://stackoverflow.com/users/6888782/the-netdeveloper"}, "is_accepted": false, "score": 0, "last_activity_date": 1542225992, "creation_date": 1542225992, "answer_id": 53307997, "question_id": 53307731, "link": "https://stackoverflow.com/questions/53307731/using-ms-excel-vba-to-extracting-data-from-complex-html-js/53307997#53307997", "title": "using MS Excel VBA to extracting data from complex HTML/JS", "body": "<p>If you right-click the webpage element you want in chrome and select inspect, it'll bring up the details of that element. You can also press f12 to bring up the HTML of any page. This also works in other browsers.</p>\n\n<p>Is this the element you're looking for? \n<a href=\"https://i.stack.imgur.com/hT3Av.png\" rel=\"nofollow noreferrer\">screen shot of mentioned webpage</a></p>\n\n<p>Based on your code above, you could reference this element with IE.document.getElementsByclass(\"priceText__1853e8a5\"). Elements in HTML can share classes but can't share ID's, so if there is another element with the class priceText__1853e8a5 it won't work since it won't select a single element. Then, of course, you have to select the text within the element since at this point you'd just have the  and would need the text inside of it. \nHope this helps. </p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1542228105, "last_edit_date": 1542228105, "creation_date": 1542226333, "answer_id": 53308061, "question_id": 53307731, "link": "https://stackoverflow.com/questions/53307731/using-ms-excel-vba-to-extracting-data-from-complex-html-js/53308061#53308061", "title": "using MS Excel VBA to extracting data from complex HTML/JS", "body": "<p>To address your questions generally, see below. </p>\n\n<blockquote>\n  <p>(1)the current rate (span class=\"priceText__1853e8a5\")</p>\n</blockquote>\n\n<p>That can be written as a CSS query selector of:</p>\n\n<pre><code>span.priceText__1853e8a5\n</code></pre>\n\n<blockquote>\n  <p>(2) previous closing (section class=\"dataBox\n  opreviousclosingpriceonetradingdayago numeric\") </p>\n</blockquote>\n\n<p>That can be written as a CSS query selector of:</p>\n\n<pre><code>.dataBox.opreviousclosingpriceonetradingdayago.numeric\n</code></pre>\n\n<blockquote>\n  <p>(3) opening rate (section class=\"dataBox openprice numeric\")</p>\n</blockquote>\n\n<p>That can be written as a CSS query selector of:</p>\n\n<pre><code>.dataBox.openprice.numeric\n</code></pre>\n\n<hr>\n\n<p>They are applied with <code>querySelector</code> or <code>querySelectorAll</code> (if more than one match and a later match than the first is required) of <code>HTMLDocument</code>.</p>\n\n<p>E.g. </p>\n\n<pre><code>Debug.Print IE.document.querySelector(\"span.priceText__1853e8a5\").innerText\n</code></pre>\n\n<p>If more using querySelectorAll</p>\n\n<pre><code>IE.document.querySelectorAll(\"span.priceText__1853e8a5\")(0).innerText\n</code></pre>\n\n<p>In the above you replace 0 with the appropriate index where your target element is found.</p>\n\n<hr>\n\n<p>Observing the page the actual selectors appear to be as follows but I think this website is probably using ecmascript syntax that is not supported on legacy browsers i.e. Internet Explorer or is attempting blocked cross domain requests.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetInfo()\n    Dim IE As New InternetExplorer\n    With IE\n        .Visible = True\n        .navigate \"https://www.bloomberg.com/quote/EURHKD:CUR\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        With .document\n            Debug.Print \"Current: \" &amp; .querySelector(\".priceText__1853e8a5\").innerText\n            Debug.Print \"Prev close: \" &amp; .querySelector(\".value__b93f12ea\").innerText\n            Debug.Print \"Open: \" &amp; .querySelector(\".value__b93f12ea\").innerText\n        End With\n\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Using Selenium Basic and Chrome the page renders fine:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim d As WebDriver\n    Set d = New ChromeDriver\n    Const URL = \"https://www.bloomberg.com/quote/EURHKD:CUR\"\n    With d\n        .Start \"Chrome\"\n        .get URL\n        Debug.Print \"Current: \" &amp; .FindElementByCss(\".priceText__1853e8a5\").Text\n        Debug.Print \"Prev close: \" &amp; .FindElementByCss(\".value__b93f12ea\").Text\n        Debug.Print \"Open: \" &amp; .FindElementByCss(\".value__b93f12ea\").Text\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 8863613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee7adf0d52f242d2462f6d114ad8394?s=128&d=identicon&r=PG&f=1", "display_name": "Dmegaffi", "link": "https://stackoverflow.com/users/8863613/dmegaffi"}, "is_accepted": false, "score": 1, "last_activity_date": 1542227832, "creation_date": 1542227832, "answer_id": 53308365, "question_id": 53307731, "link": "https://stackoverflow.com/questions/53307731/using-ms-excel-vba-to-extracting-data-from-complex-html-js/53308365#53308365", "title": "using MS Excel VBA to extracting data from complex HTML/JS", "body": "<p>Instead of digging through html why not use Bloomberg API to request the specific rate?</p>\n\n<p>Likely would be faster and would save you a lot of time in the future doing the same kind of thing.</p>\n\n<p>Please see my similiar project where I create a macro to pull historical FX rates from the European central bank.\n<a href=\"https://github.com/dmegaffi/VBA-GET-Requests/blob/master/FX%20-%20GET.xlsm\" rel=\"nofollow noreferrer\">https://github.com/dmegaffi/VBA-GET-Requests/blob/master/FX%20-%20GET.xlsm</a></p>\n"}], "owner": {"reputation": 1, "user_id": 10653854, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9kTkhKHe-f0/AAAAAAAAAAI/AAAAAAAAAJQ/7ysaYejklUs/photo.jpg?sz=128", "display_name": "G&#233;za Lengyel", "link": "https://stackoverflow.com/users/10653854/g%c3%a9za-lengyel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1586386422, "creation_date": 1542224787, "last_edit_date": 1586386422, "question_id": 53307731, "link": "https://stackoverflow.com/questions/53307731/using-ms-excel-vba-to-extracting-data-from-complex-html-js", "title": "using MS Excel VBA to extracting data from complex HTML/JS", "body": "<p>Short introduction, i consider myself as a intermediate VBA coder without any significant HTML experience. I would like to extract data from a HTML/JS webpage using MS Excel VBA. I have spent couple of hours testing my code on various pages as well as looking for training materials and various forums and Q&amp;A pages. </p>\n\n<p>I am desperately asking for you help. (Office 2013, IE 11.0.96)</p>\n\n<p>The goal is to get the FX rate of a certain bloomberg webpage. The long term goal is to run a macro on various exchange rates and get the daily rate out of the system to an excel table per working day, but i will be handle that part.</p>\n\n<p>I would be happy either with </p>\n\n<p>(1)the current rate (span class=\"priceText__1853e8a5\") or</p>\n\n<p>(2) previous closing (section class=\"dataBox opreviousclosingpriceonetradingdayago numeric\") or</p>\n\n<p>(3) opening rate (section class=\"dataBox openprice numeric\").</p>\n\n<p>My issue is that I cannot fetch the part of the html code where the rate is. </p>\n\n<pre><code>Dim IE As Object\nDim div As Object, holdingsClass As Object, botoes As Object\nDim html As HTMLDocument\nSet IE = CreateObject(\"InternetExplorer.Application\")\n    With IE\n        .Visible = False\n        .Navigate \"https://www.bloomberg.com/quote/EURHKD:CUR\"\n        Do Until .ReadyState = 4: DoEvents: Loop\n    End With\n\nSet html = IE.document\nSet div = IE.document.getElementById(\"leaderboard\") 'works just fine, populates the objects\nSet holdingsClass = IE.document.getElementsByclass(\"dataBox opreviousclosingpriceonetradingdayago numeric\") 'i am not sure is it a class element at all\nSet botoes = IE.document.getElementsByTagName(\"dataBox openprice numeric\") 'i am not sure is it a tag name at all\n\n    Range(\"a1\").Value = div.textContent 'example how i would place it by using .textContent \n    Range(\"A2\").Value = holdingsClass.textContent\n    Range(\"A3\").Value = botoes.textContent\n</code></pre>\n\n<p>Much appreciate your help!</p>\n"}, {"tags": ["regex", "excel", "vba", "string"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 1, "creation_date": 1542223669, "post_id": 53307330, "comment_id": 93495568, "body": "This is a perfect example where you&#39;d use Regular Expressions aka regex. I&#39;m sure there are millions of regex experts here providing you a solution"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 1, "creation_date": 1542223713, "post_id": 53307330, "comment_id": 93495593, "body": "Have a search on here for regex q&amp;a..."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1542226556, "post_id": 53307330, "comment_id": 93496856, "body": "So for each entry, you want four results?  What have you tried so far?"}], "answers": [{"comments": [{"owner": {"reputation": 473, "user_id": 889298, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4243a9eb4014ff64fe244417eac6f27c?s=128&d=identicon&r=PG", "display_name": "Manuel Fern&#225;ndez", "link": "https://stackoverflow.com/users/889298/manuel-fern%c3%a1ndez"}, "edited": false, "score": 0, "creation_date": 1543339834, "post_id": 53309999, "comment_id": 93879648, "body": "Just what I needed!! Thank you"}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": true, "score": 1, "last_activity_date": 1542236388, "creation_date": 1542236388, "answer_id": 53309999, "question_id": 53307330, "link": "https://stackoverflow.com/questions/53307330/retrieve-very-specific-values-from-string-in-vba-excel/53309999#53309999", "title": "Retrieve very specific values from string in VBA Excel", "body": "<p>Regex is the simplest option I think.  Please have a look at the code below, it can be adapted as a custom function:</p>\n\n<pre><code>Sub SimpleRegex()\n\n    Dim RegEx As Object, str As String\n    Dim objMatch As Object\n    Dim i As Integer\n    Dim result As String\n    Set RegEx = CreateObject(\"VBScript.RegExp\")\n\n    str = \"WEEK 3 CL ACTUAL BUILD 12 MLB BBLS VS FORECAST DRAW 4 MLN BBLS\"\n\n    With RegEx\n      .Global = True\n      .Pattern = \"\\b(BUILD|DRAW) ([0-9]*)\\b\"\n    End With\n\n    Set objMatch = RegEx.Execute(str)\n\n    Debug.Print objMatch.Item(0)\n    Debug.Print objMatch.Item(1)\n\nEnd Sub\n</code></pre>\n\n<p>It can also be done with in-cell formulas but they would get a little convoluted.</p>\n"}], "owner": {"reputation": 473, "user_id": 889298, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4243a9eb4014ff64fe244417eac6f27c?s=128&d=identicon&r=PG", "display_name": "Manuel Fern&#225;ndez", "link": "https://stackoverflow.com/users/889298/manuel-fern%c3%a1ndez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 53309999, "answer_count": 1, "score": -2, "last_activity_date": 1542236388, "creation_date": 1542223033, "question_id": 53307330, "link": "https://stackoverflow.com/questions/53307330/retrieve-very-specific-values-from-string-in-vba-excel", "title": "Retrieve very specific values from string in VBA Excel", "body": "<p>A trading software called Rotman Interactive Trader is pushing into Excel some crude oil supply 'news' aka the strings, which follow more or less this format:</p>\n\n<blockquote>\n  <p>WEEK 3 CL ACTUAL BUILD 12 MLB BBLS VS FORECAST BUILD 4 MLN BBLS</p>\n</blockquote>\n\n<p>I basically would like to grab the 12 and the 4, and subtract them (12-4=8). However, it is also possible for the news to be:</p>\n\n<blockquote>\n  <p>WEEK 3 CL ACTUAL BUILD 12 MLB BBLS VS FORECAST <strong>DRAW</strong> 4 MLN BBLS</p>\n</blockquote>\n\n<p>In this example my calculation would be (12+4=16). It is also possible for the first 'BUILD' to be a 'DRAW'</p>\n\n<p>Ideally, I would like to code a function which returns this array or similar, per the first example.</p>\n\n<pre><code>[0][0] = BUILD\n[0][1] = 14\n[1][0] = BUILD\n[1][1] = 4\n</code></pre>\n\n<p>Sadly I am not fluent in VBA Excel and would like some help or ideas on how to achieve this. All help is appreciated. Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542223833, "post_id": 53307106, "comment_id": 93495650, "body": "Put <code>Debug.Print CurDir</code> right above <code>Open sFile</code>. Are you in the correct directory?  You really should be using a full path with <code>Open</code> (and also using <code>FreeFile</code> instead of hard coded file numbers)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1542223867, "post_id": 53307106, "comment_id": 93495664, "body": "I&#39;d vote for a timing issue. The file was created some (milli)seconds after your code was run"}, {"owner": {"reputation": 13, "user_id": 10653826, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HRHzwF0k9II/AAAAAAAAAAI/AAAAAAAACbI/EEQZpCmEAOk/photo.jpg?sz=128", "display_name": "Jonathon Loch", "link": "https://stackoverflow.com/users/10653826/jonathon-loch"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542226033, "post_id": 53307106, "comment_id": 93496633, "body": "@Comintern I could be misunderstanding you, but aren&#39;t I using a full path with Open? sFile = Dir(&quot;H:\\My Documents\\Loma CW3 Reports\\Product Statistics\\PR20180912T153019.txt.&quot;) followed by the &quot;open sFile&quot; line. I did the Debug.Print CurDir, it reads &quot;H:\\My Documents&quot;"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542226324, "post_id": 53307106, "comment_id": 93496748, "body": "Ummm... No. <code>Dir</code> doesn&#39;t return the full path. You said yourself that <code>sFile</code> had a value of <code>&quot;PR20180912T153019.txt&quot;</code>."}, {"owner": {"reputation": 13, "user_id": 10653826, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HRHzwF0k9II/AAAAAAAAAAI/AAAAAAAACbI/EEQZpCmEAOk/photo.jpg?sz=128", "display_name": "Jonathon Loch", "link": "https://stackoverflow.com/users/10653826/jonathon-loch"}, "edited": false, "score": 0, "creation_date": 1542226459, "post_id": 53307106, "comment_id": 93496813, "body": "Oh, I guess you&#39;re right. duh. haha I tried copying that &quot;PR20180912T153019.txt&quot; file to H:\\My Documents, and then it worked for that single document.  So something is messing up my directories then? I did a Save As for the Excel doc, into the same folder it currently was. Now I&#39;m getting CurDir = &quot;H:\\My Documents\\Loma CW3 Reports&quot;"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542226676, "post_id": 53307106, "comment_id": 93496913, "body": "Nothing is &quot;messing your directories up&quot;. You just need to open <code>&quot;H:\\My Documents\\Loma CW3 Reports\\Product Statistics\\&quot; &amp; sFile </code>"}, {"owner": {"reputation": 13, "user_id": 10653826, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HRHzwF0k9II/AAAAAAAAAAI/AAAAAAAACbI/EEQZpCmEAOk/photo.jpg?sz=128", "display_name": "Jonathon Loch", "link": "https://stackoverflow.com/users/10653826/jonathon-loch"}, "edited": false, "score": 0, "creation_date": 1542226993, "post_id": 53307106, "comment_id": 93497061, "body": "That was it :) Weird that it worked last week and not this week though. Thank you very much :)"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 10653826, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HRHzwF0k9II/AAAAAAAAAAI/AAAAAAAACbI/EEQZpCmEAOk/photo.jpg?sz=128", "display_name": "Jonathon Loch", "link": "https://stackoverflow.com/users/10653826/jonathon-loch"}, "is_accepted": true, "score": 1, "last_activity_date": 1542226961, "creation_date": 1542226961, "answer_id": 53308193, "question_id": 53307106, "link": "https://stackoverflow.com/questions/53307106/excel-vba-run-time-error-53-file-not-found-but-file-was-found/53308193#53308193", "title": "Excel VBA - Run-time error &#39;53&#39;: File not found. But file was found", "body": "<p>I ended up specifying directory as a separate variable and appended the sFile name to it when opening the file.</p>\n\n<pre><code>Dim directory As String\n\ndirectory = \"H:\\My Documents\\Loma CW3 Reports\\Product Statistics\\\"\nsFile = Dir(directory &amp; \"*.txt*\")\n\nDo Until sFile = \"\"\n    Open (directory &amp; sFile) For Input As #1\n    blah blah blah\n</code></pre>\n\n<p>Thanks @comintern</p>\n"}], "owner": {"reputation": 13, "user_id": 10653826, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HRHzwF0k9II/AAAAAAAAAAI/AAAAAAAACbI/EEQZpCmEAOk/photo.jpg?sz=128", "display_name": "Jonathon Loch", "link": "https://stackoverflow.com/users/10653826/jonathon-loch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3905, "favorite_count": 0, "accepted_answer_id": 53308193, "answer_count": 1, "score": 0, "last_activity_date": 1542226961, "creation_date": 1542222192, "question_id": 53307106, "link": "https://stackoverflow.com/questions/53307106/excel-vba-run-time-error-53-file-not-found-but-file-was-found", "title": "Excel VBA - Run-time error &#39;53&#39;: File not found. But file was found", "body": "<p>I have an Excel sheet that pulls data from a folder full of .txt documents.\nLast week Friday, it worked. Nothing changed. This week Monday, I get a Run-time error '53': File not found.</p>\n\n<p>What's interesting, is that when I click \"Debug\" it highlights a line in my code, and when I mouse over the 'sFile' variable, it tells me the name of the file that it apparently can't find... but it could only know the name of it if it found it... And yes, I've verified, that file does exist.</p>\n\n<p>The Excel sheet is in H:\\My Documents\\Loma CW3 Reports\\</p>\n\n<p>The data .txt files are in H:\\My Documents\\Loma CW3 Reports\\Product Statistics\\</p>\n\n<p>The first 3 files that it should be pulling are:</p>\n\n<pre><code>- PR20180912T153019.txt\n- PR20180913T070005.txt\n- PR20180913T153002.txt\n</code></pre>\n\n<p>Like mentioned above, when I'm debugging the code and mouse-over \"sFile\" in the line \"Open sFile For Input As #1\", it tells me:</p>\n\n<pre><code>sFile = \"PR20180912T153019.txt\"\n</code></pre>\n\n<p>Which it could only know if it was successfully scanning the folder since I don't hardcode any of those file names in.</p>\n\n<p>I have tried removing that file, renaming the file to a word like 'apple', checked to see if it became read-only (nope). I'm thrown for a loop here, because it worked as is last week, and nothing changed from when I opened it up this week and tried it.</p>\n\n<p>Code below:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n' Dim myFile As String\nDim text As String, textLine As String\nDim sFile As String, rowTarget As Long\n\nrowTarget = 2\n\n' myFile = Application.GetOpenFilename()\n\nsFile = Dir(\"H:\\My Documents\\Loma CW3 Reports\\Product Statistics\\\" &amp; \"*.txt*\")\nDo Until sFile = \"\"\n    Open sFile For Input As #1\n    Do Until EOF(1)\n        Line Input #1, textLine\n        text = text &amp; textLine\n    Loop\n    Close #1\n\n    Do stuff here\n\n    rowTarget = rowTarget + 1\n    sFile = Dir()\n    text = \"\"\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1542288162, "post_id": 53306851, "comment_id": 93520872, "body": "You can&#39;t modify the new data. You should probably use keyDown event and replace while typed."}, {"owner": {"reputation": 11, "user_id": 9253224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6364212c7200b5037fcd547b2e0003dd?s=128&d=identicon&r=PG&f=1", "display_name": "DyannaM", "link": "https://stackoverflow.com/users/9253224/dyannam"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1542291526, "post_id": 53306851, "comment_id": 93522979, "body": "@krish KM: I have a KeyDown event that will expand the dropdown menu if the down arrow is used. Would I be better off adding in an ElseIf or maybe a KeyPress Event? What would use less resources?"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1542291659, "post_id": 53306851, "comment_id": 93523059, "body": "use select case in keydown event and do the replacements."}, {"owner": {"reputation": 11, "user_id": 9253224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6364212c7200b5037fcd547b2e0003dd?s=128&d=identicon&r=PG&f=1", "display_name": "DyannaM", "link": "https://stackoverflow.com/users/9253224/dyannam"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1542291870, "post_id": 53306851, "comment_id": 93523204, "body": "@krish KM: I&#39;m sorry, I&#39;m completely self taught and have never used that before. Could you give me an example please?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9253224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6364212c7200b5037fcd547b2e0003dd?s=128&d=identicon&r=PG&f=1", "display_name": "DyannaM", "link": "https://stackoverflow.com/users/9253224/dyannam"}, "edited": false, "score": 0, "creation_date": 1542222789, "post_id": 53307055, "comment_id": 93495183, "body": "Unfortunately same result. Error if a character is replaced, no error when there are no characters replaced. Both are still added correctly though."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 11, "user_id": 9253224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6364212c7200b5037fcd547b2e0003dd?s=128&d=identicon&r=PG&f=1", "display_name": "DyannaM", "link": "https://stackoverflow.com/users/9253224/dyannam"}, "edited": false, "score": 0, "creation_date": 1542223719, "post_id": 53307055, "comment_id": 93495599, "body": "Does the error give any indication of the VBA expression which is causing it?"}, {"owner": {"reputation": 11, "user_id": 9253224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6364212c7200b5037fcd547b2e0003dd?s=128&d=identicon&r=PG&f=1", "display_name": "DyannaM", "link": "https://stackoverflow.com/users/9253224/dyannam"}, "edited": false, "score": 0, "creation_date": 1542224666, "post_id": 53307055, "comment_id": 93496019, "body": "No. It&#39;s just a generic Access message. How can I add a screen shot here?"}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "reply_to_user": {"reputation": 11, "user_id": 9253224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6364212c7200b5037fcd547b2e0003dd?s=128&d=identicon&r=PG&f=1", "display_name": "DyannaM", "link": "https://stackoverflow.com/users/9253224/dyannam"}, "edited": false, "score": 0, "creation_date": 1542225161, "post_id": 53307055, "comment_id": 93496204, "body": "@DyannaM: You can copy the content (the text) of an Access error message to the clipboard by pressing <code>Ctrl-c</code> when it&#39;s shown and then past the relevant part here. That applies for simple <code>MsgBox</code>s too."}, {"owner": {"reputation": 11, "user_id": 9253224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6364212c7200b5037fcd547b2e0003dd?s=128&d=identicon&r=PG&f=1", "display_name": "DyannaM", "link": "https://stackoverflow.com/users/9253224/dyannam"}, "edited": false, "score": 0, "creation_date": 1542225253, "post_id": 53307055, "comment_id": 93496238, "body": "I add in the ByVal and get an error when loading the form.  The expression On Load you entered as the event property setting produced the following error: Procedure declaration does not match description of event or procedure having the same name."}, {"owner": {"reputation": 11, "user_id": 9253224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6364212c7200b5037fcd547b2e0003dd?s=128&d=identicon&r=PG&f=1", "display_name": "DyannaM", "link": "https://stackoverflow.com/users/9253224/dyannam"}, "reply_to_user": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1542225737, "post_id": 53307055, "comment_id": 93496486, "body": "@Unhandled Exception: I&#39;m unable to get it with a simple Crt+C I have it on the clipboard from the Snipping Tool but it won&#39;t let me attach it here."}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "reply_to_user": {"reputation": 11, "user_id": 9253224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6364212c7200b5037fcd547b2e0003dd?s=128&d=identicon&r=PG&f=1", "display_name": "DyannaM", "link": "https://stackoverflow.com/users/9253224/dyannam"}, "edited": false, "score": 0, "creation_date": 1542226069, "post_id": 53307055, "comment_id": 93496650, "body": "@DyannaM: Oh, you are right. I should have checked this before. I was quite sure, that this works with Access error messages too and not only with <code>MsgBox</code>s. Sorry."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1542224835, "last_edit_date": 1542224835, "creation_date": 1542221954, "answer_id": 53307055, "question_id": 53306851, "link": "https://stackoverflow.com/questions/53306851/not-in-list-error-after-replacing-chr-yet-added-to-list-correctly/53307055#53307055", "title": "Not in List Error after replacing Chr(), yet added to list correctly", "body": "<p>Try using a different variable name (other than <code>NewData</code>) to store the modified version of the value passed to the <code>NewData</code> argument, i.e.:</p>\n\n<pre><code>Dim NewString as String\nNewString = NewData\nNewString = Replace(NewString, Chr(47), Chr(45))\nNewString = Replace(NewString, Chr(92), Chr(45))\nDoCmd.OpenForm \"AddManual\", windowmode:=acDialog, OpenArgs:=NewString\n</code></pre>\n\n<p>Since VBA arguments are passed <code>ByRef</code> unless otherwise stated, any modification to the argument value will be modifying the original value passed to your <code>cboManual_NotInList</code> event handler.</p>\n\n<hr>\n\n<p>Given the above, you could alternatively try changing the <code>NewData</code> argument to be passed by value (<code>ByVal</code>):</p>\n\n<pre><code>Private Sub cboManual_NotInList(ByVal NewData As String, Response As Integer)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": true, "score": 0, "last_activity_date": 1542292807, "creation_date": 1542292807, "answer_id": 53321855, "question_id": 53306851, "link": "https://stackoverflow.com/questions/53306851/not-in-list-error-after-replacing-chr-yet-added-to-list-correctly/53321855#53321855", "title": "Not in List Error after replacing Chr(), yet added to list correctly", "body": "<p><strong>Option one</strong>\nReplace while typing</p>\n\n<pre><code>Select Case KeyCode\n        Case vbKeyDown\n            Me![cboNewPart].Dropdown\n        Case 220, 191 ' / and \\\n            KeyCode = 189 ' with -\n        Case Else\n    End Select\n</code></pre>\n\n<p><strong>Option two</strong>\nafter adding the new value to the table. do </p>\n\n<pre><code>me.combo.undo, me.combo.requery. me.combo.value = newValue\n</code></pre>\n\n<p>followed by acDataErrContinue\nthis way you won't get error message but the list will flicker a and it's purely a hack.</p>\n"}], "owner": {"reputation": 11, "user_id": 9253224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6364212c7200b5037fcd547b2e0003dd?s=128&d=identicon&r=PG&f=1", "display_name": "DyannaM", "link": "https://stackoverflow.com/users/9253224/dyannam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 53321855, "answer_count": 2, "score": 0, "last_activity_date": 1542292807, "creation_date": 1542221083, "last_edit_date": 1542226667, "question_id": 53306851, "link": "https://stackoverflow.com/questions/53306851/not-in-list-error-after-replacing-chr-yet-added-to-list-correctly", "title": "Not in List Error after replacing Chr(), yet added to list correctly", "body": "<p>I have some combo boxes with code for adding new items to the source table with a form when it doesn't exist.</p>\n\n<p>The code will replace Chr(47) / and Chr(92) \\ with Chr(45) - if present. This is done because a file name is created using concatenation later.</p>\n\n<p>The problem is if a character is replaced, I get an Access error that the item is not in the list. This does not happen if a character is not replaced. In both instances the correct items are added to the corresponding tables.</p>\n\n<p>I have tried replacing the character before passing it to OpenArgs, AfterUpdate, on the form after it opens, etc. The error does not break so the program is working, I just want to eliminate a unnecessary pop-up message.</p>\n\n<p>Any help is greatly appreciated.</p>\n\n<pre><code>Private Sub cboManual_NotInList(NewData As String, Response As Integer)\n    Dim MyMessage As String\n    Dim myButtons As Integer\n    Dim myTitle As String\n    Dim strSQL As String\n\nOn Error GoTo ErrHandler\n\nMyMessage = \"This Manual does not exist. Create it?\"\nmyButtons = vbYesNo + vbDefaultButton1 + vbQuestion + vbApplicationModal\nmyTitle = \"Add Manual?\"\nMyChoice = MsgBox(MyMessage, myButtons, myTitle)\n\nIf MyChoice = 6 Then\n    If Not DBAuthority = \"Admin\" And Not DBAuthority = \"Data Entry\" Then\n        Response = acDataErrContinue\n        MsgBox \"Sorry, authorized access only\", _\n               vbOKOnly, \"Important Information\"\n        Exit Sub\n    Else\n        Response = acDataErrAdded\n        CallerField = \"Manual\"\n        CallerForm = \"NewDocument\"\n        NewData = Replace(NewData, Chr(47), Chr(45))\n        NewData = Replace(NewData, Chr(92), Chr(45))\n        DoCmd.OpenForm \"AddManual\", windowmode:=acDialog, OpenArgs:=NewData\n        Me.cboManual.RowSource = Me.cboManual.RowSource\n        Me.cboManual.value = strAddManual\n        strManual = Me.cboManual.value\n        strAddManual = vbNullString\n        Me.cboSection.value = strAddSection\n        strSection = Me.cboSection.value\n        strAddSection = vbNullString\n        Me.cboEngine.value = strAddEngine\n        strEngine = Me.cboEngine.value\n        strAddEngine = vbNullString\n    End If\nElseIf MyChoice = 7 Then\n    Response = acDataErrContinue\n    MsgBox \"Select Manual from list.\", vbOKOnly, \"Select Manual\"\n    Me.cboManual.Undo\n    Me.cboManual.SetFocus\n    Exit Sub\nEnd If\nExit Sub\n\nErrHandler:\n    If Err = 20 Then\n        Response = acDataErrContinue\n    ElseIf Err = 94 Then\n        Response = acDataErrContinue\n        Resume Next\n    ElseIf Err = 2237 Then\n        Response = acDataErrContinue\n        Resume Next\n    ElseIf Err = 0 Then\n        Response = acDataErrContinue\n    Else\n        MsgBox \"cboManual.NotInList Err = \" &amp; Err.Number &amp; \" :\" &amp;     Err.Description\n        Exit Sub\n    End If\n    Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "nested-loops"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1542222779, "post_id": 53306839, "comment_id": 93495176, "body": "Last thing you want to have is any worksheet interaction whatsoever, anywhere in that nested loop. Then you&#39;ll want a <code>Select Case True</code> block for your 6 conditions, so that you don&#39;t need to evaluate all 6 conditions every single time when the first one is satisfied."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1542222866, "post_id": 53306839, "comment_id": 93495215, "body": "I&#39;ve no idea what <code>if i &lt; array(j,k,g,c,w)</code> could possibly mean."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1542222995, "post_id": 53306839, "comment_id": 93495282, "body": "<i>What the variables are doing is changing values on a different sheet</i> - but variables don&#39;t do that. Variables <i>hold values</i>. Please <a href=\"https://stackoverflow.com/posts/53306839/edit\">edit</a> your question to clarify. Or better, put up your <i>actual</i>, working code for peer review on <a href=\"https://codereview.stackexchange.com\">Code Review</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 1, "creation_date": 1542224175, "post_id": 53306839, "comment_id": 93495795, "body": "Try your code on a small amount of data and then repeat with a larger amount. When you hit the wall (too long execution time), recode your solution. Repeat as needed."}, {"owner": {"reputation": 11, "user_id": 10653731, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Crqv-JR3rN0/AAAAAAAAAAI/AAAAAAAAJkw/_G_SMXGgBtI/photo.jpg?sz=128", "display_name": "SFGiants21256", "link": "https://stackoverflow.com/users/10653731/sfgiants21256"}, "edited": false, "score": 0, "creation_date": 1542227538, "post_id": 53306839, "comment_id": 93497307, "body": "Sorry all, here is the code."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1542230738, "post_id": 53306839, "comment_id": 93498659, "body": "Wow. That has to be about the most bizarre way to &quot;Clear values&quot; that I&#39;ve ever seen. You realize that <code>.Cells((k * 9) + (3 + a), j - 18 + c * 52 + g * 26 + b * 104 + w * 208)</code> will give you a deterministic set of addresses in that the loop iterations are hard coded, right? This is convoluted enough that I can&#39;t visualize the sheet you&#39;re working with, but wouldn&#39;t a named range be more appropriate?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1542230979, "post_id": 53306839, "comment_id": 93498746, "body": "An empty cell value will not be <code>Null</code>, it will be <code>Variant&#47;Empty</code> ...pretty sure swapping <code>Null</code> for <code>Empty</code> slashes execution time by quite a lot, since unless I&#39;m mistaken, <code>&lt;&gt; Null</code> will be <code>True</code> for <i>every single cell</i>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1542231394, "post_id": 53306839, "comment_id": 93498923, "body": "With this many iterations, limiting the round trips to the spreadsheet is going to be key. Given that you have so many &quot;state&quot; variables that you&#39;re working with (officer v. enlisted), (continuation, non-continuation), (withdrawal rate, none), this seems like a good candidate for a class.  Also, the line <code>Set Found(0) = wsSummary.Range(&quot;F38&quot;)</code> makes me think you&#39;re using the worksheet to calculate your results.  What&#39;s in that cell? Do you <i>need</i> to calculate on the worksheet?"}, {"owner": {"reputation": 11, "user_id": 10653731, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Crqv-JR3rN0/AAAAAAAAAAI/AAAAAAAAJkw/_G_SMXGgBtI/photo.jpg?sz=128", "display_name": "SFGiants21256", "link": "https://stackoverflow.com/users/10653731/sfgiants21256"}, "edited": false, "score": 0, "creation_date": 1542233895, "post_id": 53306839, "comment_id": 93499956, "body": "The worksheet is calculating the investment values for every year of service (0 to 40) then calculates the expected value at age 60.  The Found(0) and Found(1) are referencing cells in the worksheet which account for inflation (0 is unadjusted and 1 is adjusted). I could probably take the worksheet and make it code within memory but I&#39;m not familiar with how to do it. Most of the formulas in the worksheet are FV formulas."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542246569, "post_id": 53306839, "comment_id": 93503456, "body": "OK, that&#39;s why this is taking on the order of months to complete. You can use the built in VBA <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/fv-function\" rel=\"nofollow noreferrer\">FV function</a> instead of relying on functions in the cells on the worksheet. If you&#39;re using the worksheet simply to store the data for your calculation, I&#39;d suggest defining a class or <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/type-statement\" rel=\"nofollow noreferrer\">Type</a> to store related data, then just make an array of that."}], "owner": {"reputation": 11, "user_id": 10653731, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Crqv-JR3rN0/AAAAAAAAAAI/AAAAAAAAJkw/_G_SMXGgBtI/photo.jpg?sz=128", "display_name": "SFGiants21256", "link": "https://stackoverflow.com/users/10653731/sfgiants21256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542227600, "creation_date": 1542221038, "last_edit_date": 1542227600, "question_id": 53306839, "link": "https://stackoverflow.com/questions/53306839/best-method-for-2m-calculations", "title": "Best method for 2M calculations", "body": "<p>I'm a entry level programmer, mostly all self taught.  I have some code which is trying to run through about 2,000,000 scenarios to find the lowest value based on about six various scenarios (age, years at job, investment strategy, etc). </p>\n\n<p>Currently my code is setup :</p>\n\n<pre><code>Sub DetermineAllReturnRequired()\n\nDim wsSummary As Worksheet: Set wsSummary = Worksheets(\"Summary\")\nDim wsLowestReturn As Worksheet: Set wsLowestReturn = Worksheets(\"LowestReturn\")\n\n'Loop variables\nDim i As Double, j As Long, k As Long, c As Long, g As Long, w As Integer, a As Integer, y As Integer, b As Integer\n\n'Variables same for both grades\nDim Interest As Double\nDim Years As Integer\nDim Age As Integer\nDim Found(0 To 1) As Range\nDim Arr_HighestSavings(0 To 1, 0 To 12, 20 To 40, 1 To 7, 0 To 1, 0 To 1, 0 To 1) As Double ' (c - continuation, k - years served, j - year retired, a - intersect options (60, 65, 70, 75, 80, 85, 90), g = grade, w - withdraw 4%, b - adjusted for inflation)\n\nApplication.ScreenUpdating = False\n\n'Clears values\nIf wsLowestReturn.Cells(4, 2).Value &lt;&gt; Null Then\n    For j = 20 To 40\n        For k = 0 To 12\n            For g = 0 To 1\n                For c = 0 To 1\n                    For w = 0 To 1\n                        For b = 0 To 1\n                            For a = 1 To 7\n                                wsLowestReturn.Cells((k * 9) + (3 + a), j - 18 + c * 52 + g * 26 + b * 104 + w * 208).Value = Null\n                            Next a\n                        Next b\n                    Next w\n                Next c\n            Next g\n        Next k\n    Next j\nEnd If\n\n\n'interest\nFor i = 0.05 To 0.15 Step 0.0001\n\n    wsSummary.Range(\"G7\") = i\n    Interest = i\n\n    ' years served when retire\n    For j = 20 To 30\n\n        wsSummary.Range(\"G4\") = j\n        Years = j\n\n        'current years served\n        For k = 0 To 12\n\n            wsSummary.Range(\"G5\") = k\n            wsSummary.Range(\"G15\") = k\n\n            'grade (officer,0, enlisted, 1)\n            For g = 0 To 1\n                    If g = 0 Then\n                        wsSummary.Range(\"G10\") = \"Officer\"\n                        wsSummary.Range(\"G6\") = \"22\"\n                    Else\n                        wsSummary.Range(\"G10\") = \"Enlisted\"\n                        wsSummary.Range(\"G6\") = \"18\"\n                    End If\n\n                'continuation pay (yes, 0, no, 1)\n                For c = 0 To 1\n                        If c = 0 Then\n                            wsSummary.Range(\"G17\") = \"Yes\"\n                        Else\n                            wsSummary.Range(\"G17\") = \"No\"\n                        End If\n                    'withdrawal rate (0 = yes, no, 1)\n                    For w = 0 To 1\n                        If w = 0 Then\n                            wsSummary.Range(\"G21\") = \"Yes\"\n                        Else\n                            wsSummary.Range(\"G21\") = \"No\"\n                        End If\n\n\n\n                Set Found(0) = wsSummary.Range(\"F38\")\n\n                If Found(0) = 60 Or Found(0) = 65 Or Found(0) = 70 Or Found(0) = 75 Or Found(0) = 80 Or Found(0) = 85 Or Found(0) = 90 Then\n                    a = Found(0) / 5 - 11\n                    b = 0\n                    If Interest &lt; Arr_HighestSavings(c, k, j, a, g, w, b) Or Arr_HighestSavings(c, k, j, a, g, w, b) = 0 Then\n                        Arr_HighestSavings(c, k, j, a, g, w, b) = Interest\n                        wsLowestReturn.Cells((k * 9) + 3, 1) = k\n                        wsLowestReturn.Cells((k * 9) + (3 + a), j - 18 + c * 52 + g * 26 + b * 104 + w * 208) = Round(Arr_HighestSavings(c, k, j, a, g, w, b), 4)\n                    End If\n                End If\n\n                Set Found(1) = wsSummary.Range(\"I38\")\n\n                If Found(1) = 60 Or Found(1) = 65 Or Found(1) = 70 Or Found(1) = 75 Or Found(1) = 80 Or Found(1) = 85 Or Found(1) = 90 Then\n                    a = Found(1) / 5 - 11\n                    b = 1\n                    If Interest &lt; Arr_HighestSavings(c, k, j, a, g, w, b) Or Arr_HighestSavings(c, k, j, a, g, w, b) = 0 Then\n                        Arr_HighestSavings(c, k, j, a, g, w, b) = Interest\n                        wsLowestReturn.Cells((k * 9) + 3, 1) = k\n                        wsLowestReturn.Cells((k * 9) + (3 + a), j - 18 + c * 52 + g * 26 + b * 104 + w * 208) = Round(Arr_HighestSavings(c, k, j, a, g, w, b), 4)\n                    End If\n                End If\n        'MsgBox (\"Current years served \" &amp; k &amp; \" completed!\")\n                    Next w\n                Next c\n            Next g\n        Next k\n    Next j\n'    If i = 0.07 Then\n'        MsgBox (\"at 7\")\n'    End If\nNext i\n'MsgBox (\"Officer Calculations Are Complete\")\n\nApplication.ScreenUpdating = True\n\nMsgBox (\"Calculations Are Complete at \" &amp; Now())\nEnd Sub\n</code></pre>\n\n<p>What I can't figure out is how to speed it up.  Currently the code is taking a long time to execute (a day per percent). I'm sure if I can take all the true/false items then it would be faster. Or how to recognize the array value at that j, k, g, c, w, is already determined and skip it.  </p>\n\n<p>What the variables are doing is changing values on a different sheet to determine the age at which investments will equal a certain amount. </p>\n\n<p>Thanks for any help you can provide.  </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 10368408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb88aebbbf6d00c48099de0048bb01d?s=128&d=identicon&r=PG&f=1", "display_name": "MrRarri", "link": "https://stackoverflow.com/users/10368408/mrrarri"}, "edited": false, "score": 0, "creation_date": 1542223163, "post_id": 53306859, "comment_id": 93495356, "body": "Exactly what I was looking for. Thank you sir!"}], "tags": [], "owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "is_accepted": true, "score": 0, "last_activity_date": 1542221114, "creation_date": 1542221114, "answer_id": 53306859, "question_id": 53306673, "link": "https://stackoverflow.com/questions/53306673/copy-data-from-worksheets-with-partial-name-relation/53306859#53306859", "title": "Copy data from worksheets with partial name relation", "body": "<p>You can use \"like\".  </p>\n\n<p>For example, </p>\n\n<pre><code>If Sheets(1).name like \"Analisis*\"\nthen \n--Your code here\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 10368408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb88aebbbf6d00c48099de0048bb01d?s=128&d=identicon&r=PG&f=1", "display_name": "MrRarri", "link": "https://stackoverflow.com/users/10368408/mrrarri"}, "edited": false, "score": 0, "creation_date": 1542223119, "post_id": 53307240, "comment_id": 93495338, "body": "I did something like this but without the part with the inputbox as there is no user in my situation. I made an IF statement for each string I want to compare and then looped in it so I can copy all data from worksheets to my main one."}], "tags": [], "owner": {"reputation": 89, "user_id": 8750114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHxrl.png?s=128&g=1", "display_name": "Juan Joya", "link": "https://stackoverflow.com/users/8750114/juan-joya"}, "is_accepted": false, "score": 0, "last_activity_date": 1542222731, "creation_date": 1542222731, "answer_id": 53307240, "question_id": 53306673, "link": "https://stackoverflow.com/questions/53306673/copy-data-from-worksheets-with-partial-name-relation/53307240#53307240", "title": "Copy data from worksheets with partial name relation", "body": "<p>Ok, as I see, you don\u00b4t need to paste all information in a sheet, you can use an input box for asking the user the name of the string he/she wants to look for, and then look for the sheets called that way, and then look for the range that has the word you are looking for. Here\u00b4s an example:</p>\n\n<pre><code>Sub example()\n\nDim res As String\nDim no As Integer\n\nres = InputBox(\"Write the name you want to look for\")\nno = Len(res)  'gets the amount of characters in the string\n\n\nFor i = 2 To Worksheets.Count\n\nIf Left(Worksheets(i).Name, no) = res Then 'reads the name of the worksheet form left \nto right\n                                       'gets the number of characters in the variable \n                                        no and compares the substring with the string \n                                        res\n\n\n      'if you are here it means the worksheets is called as you out in your input box\n      'from here you can do what you want, use the same structure to look inside the \n       cells\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10368408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb88aebbbf6d00c48099de0048bb01d?s=128&d=identicon&r=PG&f=1", "display_name": "MrRarri", "link": "https://stackoverflow.com/users/10368408/mrrarri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 53306859, "answer_count": 2, "score": 0, "last_activity_date": 1542222731, "creation_date": 1542220334, "last_edit_date": 1542221124, "question_id": 53306673, "link": "https://stackoverflow.com/questions/53306673/copy-data-from-worksheets-with-partial-name-relation", "title": "Copy data from worksheets with partial name relation", "body": "<p>I am trying to copy data from every sheet in my workbook that has \"ANALYSIS E 000002\" and then \"ANALYSIS E 000002\" in its name, up to \"ANALYSIS E 000012\". Some have a copy number after this string, i.e. \"ANALYSIS E 000002 (3)\".</p>\n\n<p>So I started by doing a vba code that will take every sheet in the workbook and add their content in a combined one. It works perfectly but now I need to adapt it to select only the string I specify. I will need to do it for different names.</p>\n\n<p>Started with this code :</p>\n\n<pre><code>Sub Combine_ea()\nDim J As Integer\nOn Error Resume Next\n\nSheets(1).Select\nWorksheets.Add\nSheets(1).Name = \"Combined\"\nSheets(2).Activate\nRange(\"A1:A2\").EntireRow.Select\nSelection.Copy Destination:=Sheets(1).Range(\"A1:A2\")\nFor J = 2 To Sheets.Count\nSheets(J).Activate\nRange(\"A3\").Select\nSelection.CurrentRegion.Select\nSelection.Offset(2, 0).Resize(Selection.Rows.Count - 1).Select\nSelection.Copy Destination:=Sheets(1).Range(\"A99999\").End(xlUp)(2)\nNext\n\nEnd Sub\n</code></pre>\n\n<p>The approach I think would be the best is to make a For loop to reach every string that finishes by my Iterator and then do my algorithm. I am not sure how to do adapt my code at this point. Would need help from you guys.</p>\n"}, {"tags": ["excel", "vba", "office365"], "comments": [{"owner": {"reputation": 164, "user_id": 10184585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c63a1c236c7ce5e1e261b113e05fe7a?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/10184585/bruce"}, "edited": false, "score": 0, "creation_date": 1542275181, "post_id": 53306636, "comment_id": 93513245, "body": "Unfortunately, I didn&#39;t search for articles that use Excel 365 VBA to save PDF file. Wsoutputone is Worksheet object?"}, {"owner": {"reputation": 401, "user_id": 8344100, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/08c7bf5d7069e2924eede938c896cccc?s=128&d=identicon&r=PG", "display_name": "m1well", "link": "https://stackoverflow.com/users/8344100/m1well"}, "reply_to_user": {"reputation": 164, "user_id": 10184585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c63a1c236c7ce5e1e261b113e05fe7a?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/10184585/bruce"}, "edited": false, "score": 0, "creation_date": 1542276760, "post_id": 53306636, "comment_id": 93514175, "body": "yes of course this is a worksheet."}, {"owner": {"reputation": 401, "user_id": 8344100, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/08c7bf5d7069e2924eede938c896cccc?s=128&d=identicon&r=PG", "display_name": "m1well", "link": "https://stackoverflow.com/users/8344100/m1well"}, "reply_to_user": {"reputation": 164, "user_id": 10184585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c63a1c236c7ce5e1e261b113e05fe7a?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/10184585/bruce"}, "edited": false, "score": 0, "creation_date": 1543321994, "post_id": 53306636, "comment_id": 93868697, "body": "any one any idea that could help?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1586281338, "post_id": 53306636, "comment_id": 108069652, "body": "Why do you need to do this? Why not just use the workbook path?"}], "answers": [{"comments": [{"owner": {"reputation": 401, "user_id": 8344100, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/08c7bf5d7069e2924eede938c896cccc?s=128&d=identicon&r=PG", "display_name": "m1well", "link": "https://stackoverflow.com/users/8344100/m1well"}, "edited": false, "score": 0, "creation_date": 1543412019, "post_id": 53514976, "comment_id": 93909872, "body": "thanks! but unfortunately your code changes are only in the &quot;!ecxel2016&quot; part. using this with an old excel version works. but using it with (some) excel 365 doesn&#39;t work."}], "tags": [], "owner": {"reputation": 164, "user_id": 10184585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c63a1c236c7ce5e1e261b113e05fe7a?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/10184585/bruce"}, "is_accepted": false, "score": 1, "last_activity_date": 1543393261, "creation_date": 1543393261, "answer_id": 53514976, "question_id": 53306636, "link": "https://stackoverflow.com/questions/53306636/why-cant-excel-365-vba-save-my-pdf-file/53514976#53514976", "title": "Why can&#39;t Excel 365 vba save my pdf file?", "body": "<p>Please try the following code:</p>\n\n<pre><code>Dim pdfFile As String\n\nIf excel2016 Then\n  pdfFile = Application.DefaultFilePath &amp; \"/Report_\" &amp; year &amp; month &amp; \"_\" &amp; Replace(name, \" \", \"_\") &amp; \".pdf\"\nElse\n  pdfFile = Application.ActiveWorkbook.Path &amp; Application.PathSeparator &amp; \"Report_\" &amp; year &amp; month &amp; \"_\" &amp; Replace(name, \" \", \"_\") &amp; \".pdf\"\nEnd If\n\nwsOutputOne.ExportAsFixedFormat Type:=xlTypePDF, fileName:=pdfFile\n</code></pre>\n"}], "owner": {"reputation": 401, "user_id": 8344100, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/08c7bf5d7069e2924eede938c896cccc?s=128&d=identicon&r=PG", "display_name": "m1well", "link": "https://stackoverflow.com/users/8344100/m1well"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1586389021, "creation_date": 1542220164, "last_edit_date": 1586389021, "question_id": 53306636, "link": "https://stackoverflow.com/questions/53306636/why-cant-excel-365-vba-save-my-pdf-file", "title": "Why can&#39;t Excel 365 vba save my pdf file?", "body": "<p><br>\nI think now I tried nearly everything to save a pdf file with Excel vba.<br>\n<br>\nThis is my actual code:</p>\n\n<pre><code>Dim pdfFile As String\n\nIf excel2016 Then\n    pdfFile = Application.DefaultFilePath &amp; \"/Report_\" &amp; year &amp; month &amp; \"_\" &amp; Replace(name, \" \", \"_\") &amp; \".pdf\"\nElse\n    pdfFile = ActiveWorkbook.Path &amp; Application.PathSeparator &amp; \"Report_\" &amp; year &amp; month &amp; \"_\" &amp; Replace(name, \" \", \"_\") &amp; \".pdf\"\nEnd If\n\nwsOutputOne.ExportAsFixedFormat Type:=xlTypePDF, fileName:=pdfFile\n</code></pre>\n\n<p>I know that Excel 2016 is creating a \"container\" and saving the files under <code>~/Library/Containers/com.microsoft.Excel/Data/Documents/</code> but why does that code not work with Excel 365?  </p>\n\n<p>Or what has a friend with Excel 365 to do to save this generated pdf file?<br>\nBecause the call of <code>Application.DefaultFilePath</code> returns nothing on his machine...  </p>\n\n<p>Can somebody help me?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 1, "last_activity_date": 1542221260, "creation_date": 1542221260, "answer_id": 53306896, "question_id": 53306425, "link": "https://stackoverflow.com/questions/53306425/access-vba-issue-on-update-statement-3144/53306896#53306896", "title": "Access VBA: issue on UPDATE statement (3144)", "body": "<p><code>Note</code> is a <a href=\"https://support.office.com/en-us/article/learn-about-access-reserved-words-and-symbols-ae9d9ada-3255-4b12-91a9-f855bdd9c5a2#__toc262648753\" rel=\"nofollow noreferrer\">reserved word</a> in MS Access.</p>\n\n<p>Therefore, change your SQL to:</p>\n\n<pre><code>CurrentDb.Execute \"UPDATE [Table Name] SET [Note] = 'aaaa' WHERE [Codice Progetto] = 'XX';\"\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 9410048, "user_type": "registered", "profile_image": "https://graph.facebook.com/990260100984145/picture?type=large", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9410048/stefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 53306896, "answer_count": 1, "score": 0, "last_activity_date": 1542221474, "creation_date": 1542219152, "last_edit_date": 1542221474, "question_id": 53306425, "link": "https://stackoverflow.com/questions/53306425/access-vba-issue-on-update-statement-3144", "title": "Access VBA: issue on UPDATE statement (3144)", "body": "<p>In my Access VBA, I have this code:</p>\n\n<pre><code>CurrentDb.Execute \"UPDATE [Table Name] SET Note = 'aaaa' WHERE [Codice Progetto] = 'XX';\"\n</code></pre>\n\n<p>But I get:</p>\n\n<blockquote>\n  <p>Run-time error '3144': Syntax error in UPDATE statement</p>\n</blockquote>\n\n<p>Doing some tests, I figured out the issue is related to the field <strong><em>Note</em></strong>. I have checked that all the other part of the code are ok. I don't know why this issue because field Note exists and its characteristics are correct.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qsQ7P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qsQ7P.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1542218984, "post_id": 53306362, "comment_id": 93493379, "body": "I think this would be considered a circular reference so formulas may not work, but you can use VBA and <code>Worksheet_Change</code>"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1542219158, "post_id": 53306362, "comment_id": 93493454, "body": "You could write a macro triggered by a change in either cell that will insert the value in the other cell. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Worksheet.Change\" rel=\"nofollow noreferrer\">this</a> could get you started."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10653594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a926a4e0089467842a7d82b37cb0a7c?s=128&d=identicon&r=PG&f=1", "display_name": "xissa11", "link": "https://stackoverflow.com/users/10653594/xissa11"}, "edited": false, "score": 0, "creation_date": 1542220643, "post_id": 53306550, "comment_id": 93494161, "body": "I get a compile error  while trying to run. it highlights: Else If Target.Column = 3 Then"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 1, "user_id": 10653594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a926a4e0089467842a7d82b37cb0a7c?s=128&d=identicon&r=PG&f=1", "display_name": "xissa11", "link": "https://stackoverflow.com/users/10653594/xissa11"}, "edited": false, "score": 0, "creation_date": 1542220781, "post_id": 53306550, "comment_id": 93494235, "body": "@xissa11 oops remove the space between Else and If"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 1, "user_id": 10653594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a926a4e0089467842a7d82b37cb0a7c?s=128&d=identicon&r=PG&f=1", "display_name": "xissa11", "link": "https://stackoverflow.com/users/10653594/xissa11"}, "edited": false, "score": 0, "creation_date": 1542221193, "post_id": 53306550, "comment_id": 93494438, "body": "@xissa11 just please keep in mind this can break if you copy &amp; paste a bunch of values"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 1, "user_id": 10653594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a926a4e0089467842a7d82b37cb0a7c?s=128&d=identicon&r=PG&f=1", "display_name": "xissa11", "link": "https://stackoverflow.com/users/10653594/xissa11"}, "edited": false, "score": 0, "creation_date": 1542221813, "post_id": 53306550, "comment_id": 93494730, "body": "@xissa11 I added a line of code for it to exit if it detects a copy-paste"}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": true, "score": 1, "last_activity_date": 1542221797, "last_edit_date": 1542221797, "creation_date": 1542219787, "answer_id": 53306550, "question_id": 53306362, "link": "https://stackoverflow.com/questions/53306362/excel-macro-reciprocal-conversion-between-two-columns-lbs-kg/53306550#53306550", "title": "Excel Macro Reciprocal Conversion between two columns (lbs/kg)", "body": "<p>If you go to the VBE Editor and double-click on the sheet you want to monitor, you can place this Sub there:</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim cel As Variant\n\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n    If IsNumeric(Target.Value) = False Then Exit Sub\n\n    If Target.Column = 2 Then\n\n        ' data entered in column B, so change C\n        Target.Offset(0,1).Value = Target.Value * 2.2\n\n    ElseIf Target.Column = 3 Then\n\n        ' data entered in column C, so change B\n        Target.Offset(0,-1).Value = Target.Value / 2.2  \n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10653594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a926a4e0089467842a7d82b37cb0a7c?s=128&d=identicon&r=PG&f=1", "display_name": "xissa11", "link": "https://stackoverflow.com/users/10653594/xissa11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 53306550, "answer_count": 1, "score": -1, "last_activity_date": 1586389312, "creation_date": 1542218880, "last_edit_date": 1586389312, "question_id": 53306362, "link": "https://stackoverflow.com/questions/53306362/excel-macro-reciprocal-conversion-between-two-columns-lbs-kg", "title": "Excel Macro Reciprocal Conversion between two columns (lbs/kg)", "body": "<p>This is my first question here.\nI am very new to excel macro/vba.\nCan someone please guide me on how to create a macro which does the following:</p>\n\n<p>when someone enters value into either column B (in kgs)/ or column C (in lbs), the other column gets automatically updated to reflect the appropriate value. For example, if someone entered the kgs value in column B then column c would show the lbs value and if someone entered the lbs value in column c then column b would would show the appropriate lbs value.</p>\n\n<p>Thanks for your help. </p>\n"}, {"tags": ["mysql", "sql", "excel", "vba"], "comments": [{"owner": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 0, "creation_date": 1542223085, "post_id": 53305543, "comment_id": 93495330, "body": "well, what value is in <code>Out_of_Dock_Time</code> when the error occurs? Or maybe the problem is with <code>FILEDATETIME1</code>.One of these variables, or possibly even both, is likely to be the issue"}, {"owner": {"reputation": 1, "user_id": 10653303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f53c5f2c0a4da9486b7a8023bf21fc4?s=128&d=identicon&r=PG&f=1", "display_name": "iti", "link": "https://stackoverflow.com/users/10653303/iti"}, "reply_to_user": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 0, "creation_date": 1542226297, "post_id": 53305543, "comment_id": 93496734, "body": "The value for Out_of_Dock_Time is 04/10/18 17:26. and will be in this format itself.  The format for Fieldatetime1 is 04/10/18 17:26: PM"}, {"owner": {"reputation": 1, "user_id": 10653303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f53c5f2c0a4da9486b7a8023bf21fc4?s=128&d=identicon&r=PG&f=1", "display_name": "iti", "link": "https://stackoverflow.com/users/10653303/iti"}, "reply_to_user": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 0, "creation_date": 1542227186, "post_id": 53305543, "comment_id": 93497154, "body": "Hi @ADyson This is how I have defined my Out_of_dock time, could this be the reason? Out_of_Dock_Time = Format(XLsheet.Cells(i, CommodityCOl + 10).Value, &quot;MM/dd/yy HH:mm:ss&quot;)"}], "answers": [{"tags": [], "owner": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "is_accepted": false, "score": 1, "last_activity_date": 1542229429, "creation_date": 1542229429, "answer_id": 53308679, "question_id": 53305543, "link": "https://stackoverflow.com/questions/53305543/i-have-a-vba-in-excel-to-transfer-data-to-mysql-however-i-have-issues-with-the/53308679#53308679", "title": "I have a VBA in excel to transfer data to MySQL, however I have issues with the date", "body": "<p>Your format string</p>\n\n<pre><code>'%m/%d/%Y %h:%i:%s'\n</code></pre>\n\n<p>is incorrect. As per the <a href=\"https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format\" rel=\"nofollow noreferrer\">documentation</a> on date format specifiers, <code>%h</code> represents hours in 12hr format (i.e. 01-12). Instead you need to use <code>%H</code> to read 24hr times. The correct format string is</p>\n\n<pre><code>'%m/%d/%Y %H:%i:%s'\n</code></pre>\n\n<p><a href=\"http://sqlfiddle.com/#!9/9eecb/68953\" rel=\"nofollow noreferrer\">Click here for a demo using SQLFiddle</a></p>\n"}], "owner": {"reputation": 1, "user_id": 10653303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f53c5f2c0a4da9486b7a8023bf21fc4?s=128&d=identicon&r=PG&f=1", "display_name": "iti", "link": "https://stackoverflow.com/users/10653303/iti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542229429, "creation_date": 1542215715, "last_edit_date": 1542229279, "question_id": 53305543, "link": "https://stackoverflow.com/questions/53305543/i-have-a-vba-in-excel-to-transfer-data-to-mysql-however-i-have-issues-with-the", "title": "I have a VBA in excel to transfer data to MySQL, however I have issues with the date", "body": "<p>I have a VBA in excel to transfer data to MySQL, however I have issues with the date. The error I get is </p>\n\n<blockquote>\n  <p>Runtime Error: 2147467259 (8004005): Incorrect datetime value: for\n  function str_to_date.</p>\n</blockquote>\n\n<p>This is my code: </p>\n\n<pre><code>sql = \"Insert Into LeadBoard(Commodity,Last_Broadcast_Job,Material_to_Work, \" _         &amp; \" Last_Picked_Job,Picked_Lead_Time,Last_Loaded_Job,\" _         &amp; \"Loaded_Lead_Time,Dispatch_Lead_Time,Last_Dispatched_Job,\" _         &amp; \"Out_of_Dock_Time,Last_Dispatched_Rack,\" _         &amp; \"Last_Dispatched_Trailer,Customer_Point_of_Install,Excel_date_time, calc_Material_to_work,\" _         &amp; \"calc_Load_Lead_Time, calc_Picked_Lead_Time,calc_Dispatch_Lead_Time) \" _         &amp; \" VALUES (\" &amp; Commodity &amp; \",\" &amp; Last_Broadcast_Job &amp; \",'\" _         &amp; Material_to_Work &amp; \"',\" &amp; Last_Picked_Job &amp; \",'\" _         &amp; Picked_Lead_Time &amp; \"',\" &amp; Last_Loaded_Job &amp; \",'\" _         &amp; Loaded_Lead_Time &amp; \"','\" &amp; Dispatch_Lead_Time &amp; \"',\" _         &amp; Last_Dispatched_Job &amp; \",\" &amp; \"STR_TO_DATE('\" &amp; Out_of_Dock_Time &amp; \"', '%m/%d/%Y %h:%i:%s'  ) ,\" _         &amp; Last_Dispatched_Rack &amp; \",\" &amp; Last_Dispatched_Trailer &amp; \",\" _         &amp; Customer_Point_of_Install &amp; \",\" &amp; \"STR_TO_DATE('\" &amp; FILEDATETIME1 &amp; \"', '%m/%d/%Y %h:%i:%s' ) ,\" _         &amp; calc_Material_to_work &amp; \",\" &amp; calc_Loaded_Lead_Time &amp; \",\" &amp; calc_Picked_Lead_Time &amp; \",\" &amp; calc_Dispatch_Lead_Time &amp; \");\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542215940, "post_id": 53305472, "comment_id": 93491981, "body": "Does this need to be a UDF? Looks like it could be a simple pair of <code>VLOOKUP</code>s."}, {"owner": {"reputation": 103, "user_id": 3818281, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/83ad9e0d98a4dcbacc5205c713d32f59?s=128&d=identicon&r=PG&f=1", "display_name": "GingerDom", "link": "https://stackoverflow.com/users/3818281/gingerdom"}, "edited": false, "score": 0, "creation_date": 1542216199, "post_id": 53305472, "comment_id": 93492112, "body": "Hi, yeah I would prefer a <code>VLOOKUP</code> but the return has to be in the same column, and I didn&#39;t think you could get it to return the &quot;Y&quot; or &quot;TBD&quot; depending on the sheet it came from. All the data in Sheets 2 and 3 are in column A"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 5, "creation_date": 1542216220, "post_id": 53305472, "comment_id": 93492118, "body": "Even if your value IS found, you&#39;re always going to return &quot;&quot; because of the last line in your function."}, {"owner": {"reputation": 103, "user_id": 3818281, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/83ad9e0d98a4dcbacc5205c713d32f59?s=128&d=identicon&r=PG&f=1", "display_name": "GingerDom", "link": "https://stackoverflow.com/users/3818281/gingerdom"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1542216266, "post_id": 53305472, "comment_id": 93492143, "body": "Ooooh, I thought the <code>Check = &quot;Y&quot;</code> would kill the function @dwirony how do you think I could end it on the correct value? cheers"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 2, "creation_date": 1542216337, "post_id": 53305472, "comment_id": 93492175, "body": "@GingerDom on the next line after that you can include <code>Exit Function</code>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1542216351, "post_id": 53305472, "comment_id": 93492185, "body": "I would just use the <code>Range.Find</code> method here"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1542216497, "post_id": 53305472, "comment_id": 93492262, "body": "@GingerDom Putting <code>Exit Function</code> like Kubie suggested after each of the <code>Check = &quot;Yes&quot;</code> and <code>Check = &quot;TBD&quot;</code> would do the trick. But I would think your <code>#VALUE</code> error is because you&#39;re not wrapping your string in quotation marks in your formula."}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "edited": false, "score": 1, "creation_date": 1542218639, "post_id": 53305788, "comment_id": 93493238, "body": "@Egalth - if the Find method doesn&#39;t find the search term, the range variable will return Nothing, not zero."}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": false, "score": 3, "last_activity_date": 1542217675, "last_edit_date": 1542217675, "creation_date": 1542216642, "answer_id": 53305788, "question_id": 53305472, "link": "https://stackoverflow.com/questions/53305472/check-if-value-appears-in-a-different-worksheet/53305788#53305788", "title": "Check if value appears in a different worksheet", "body": "<p>Here's a version of the function using <code>find</code> like @urdearboy mentioned...</p>\n\n<pre><code>Public Function Check(product As String) As String\n\n    Dim BLRange As Range\n    Dim TBDRange As Range\n    Dim fndRng As Range\n\n    With ActiveWorkbook\n        Set BLRange = .Worksheets(\"Sheet2\").Columns(\"A\")\n        Set TBDRange = .Worksheets(\"Sheet3\").Columns(\"A\")\n    End With\n\n    Set fndRng = BLRange.Find(product)\n    If Not fndRng is Nothing Then Check = \"Yes\": Exit Function\n\n    Set fndRng = TBDRange.Find(product)\n    If Not fndRng is Nothing Then Check = \"TBD\": Exit Function\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 8750114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHxrl.png?s=128&g=1", "display_name": "Juan Joya", "link": "https://stackoverflow.com/users/8750114/juan-joya"}, "is_accepted": false, "score": 1, "last_activity_date": 1542220791, "creation_date": 1542220791, "answer_id": 53306791, "question_id": 53305472, "link": "https://stackoverflow.com/questions/53305472/check-if-value-appears-in-a-different-worksheet/53306791#53306791", "title": "Check if value appears in a different worksheet", "body": "<p>Try this code (already tested and works)</p>\n\n<pre><code>Public Function Check(product As String) As String\n\nDim BLRange As Range\nDim BL As Worksheet\nDim TBDRange As Range\nDim TBD As Worksheet\nDim result As String\n\nSet BL = ActiveWorkbook.Worksheets(\"Sheet2\")\nSet BLRange = BL.Range(\"A1:A1000\")\nSet TBD = ActiveWorkbook.Worksheets(\"Sheet3\")\nSet TBDRange = TBD.Range(\"A1:A1000\")\n\nCheck = \"none\"\n\nFor Each xlCell In BLRange\n If xlCell.Text = product Then\n    Check = \"Yes\"\n    GoTo a\n End If\nNext xlCell\n\nFor Each xlCell In TBDRange\n If xlCell.Text = product Then\n    Check = \"TBD\"\n    GoTo a\n End If\nNext xlCell\n\nExit Function\n\na:\n\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 3818281, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/83ad9e0d98a4dcbacc5205c713d32f59?s=128&d=identicon&r=PG&f=1", "display_name": "GingerDom", "link": "https://stackoverflow.com/users/3818281/gingerdom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1590379812, "creation_date": 1542215472, "last_edit_date": 1590379812, "question_id": 53305472, "link": "https://stackoverflow.com/questions/53305472/check-if-value-appears-in-a-different-worksheet", "title": "Check if value appears in a different worksheet", "body": "<p>I have a list. I want to see if it appears in one of the other sheets and return a string dependent on the sheet it is in.</p>\n\n<p>E.g pseudocode:</p>\n\n<pre><code>value = \"Hi\"\nIf value in sheet 2 Then\n  return \"Yes\"\nIf value in sheet 3 Then\n  return \"TDB\"\nElse\n  return \" \"\n</code></pre>\n\n<p>The code I have so far</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function Check(product As String) As String\n\n    Dim BLRange As Range\n    Dim xlCell As Range\n    Dim BL As Worksheet\n    Dim TBDRange As Range\n    Dim TBD As Worksheet\n    Dim result As String\n\n    Set BL = ActiveWorkbook.Worksheets(\"Sheet2\")\n    Set BLRange = BL.Range(\"A1:A1000\")\n    Set TBD = ActiveWorkbook.Worksheets(\"Sheet3\")\n    Set TBDRange = TBD.Range(\"A1:A1000\")\n\n    For Each xlCell In BLRange\n        If xlCell.Value = product Then\n            Check = \"Yes\"\n        End If\n    Next xlCell\n\n    For Each xlCell In TBDRange\n        If xlCell.Value = product Then\n            Check = \"TBD\"\n        End If\n    Next xlCell\n\n    Check = \"\"\nEnd Function\n</code></pre>\n\n<p>When I call <code>Check(\"Hi\")</code> I get <code>#VALUE!</code></p>\n"}, {"tags": ["excel", "vba", "loops", "inputbox"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 2, "creation_date": 1542214028, "post_id": 53305006, "comment_id": 93490947, "body": "Excel will not know what <code>WorkRng2.Value</code> is [as part of a formula]. You might be able to replace it with <code>&quot; &amp; WorkRng.Address &amp; &quot;</code> ?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1542214038, "post_id": 53305006, "comment_id": 93490954, "body": "<code>&quot;=If(&quot; &amp; WorkRng2.Value &amp; &quot; &gt;0, &quot;&quot;D&quot;&quot;,&quot;&quot;C&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 197, "user_id": 10186814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70a16739b4f390d68b13008f18c6108?s=128&d=identicon&r=PG&f=1", "display_name": "Xavi", "link": "https://stackoverflow.com/users/10186814/xavi"}, "edited": false, "score": 0, "creation_date": 1542216726, "post_id": 53305006, "comment_id": 93492385, "body": "Thank you CLR, thank you Comintern, I tried to insert your formula Comintern in the VBA code but when I run the macro, I get an error message : run time error 13, type mismatch."}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 10186814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70a16739b4f390d68b13008f18c6108?s=128&d=identicon&r=PG&f=1", "display_name": "Xavi", "link": "https://stackoverflow.com/users/10186814/xavi"}, "edited": false, "score": 0, "creation_date": 1542272279, "post_id": 53307685, "comment_id": 93511427, "body": "Thanks a lot SJR for your explanation and your modification, it is solved my problem!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1542227144, "last_edit_date": 1542227144, "creation_date": 1542224583, "answer_id": 53307685, "question_id": 53305006, "link": "https://stackoverflow.com/questions/53305006/formula-returning-name-inside-loop-via-selection-from-input-box/53307685#53307685", "title": "formula returning #NAME inside loop via selection from input box", "body": "<p>You can't compare the value of multiple cells in one go so it will only work if <code>WorkRng2</code> is a single cell. Try the below, which is my best guess at what you are trying to do.</p>\n\n<pre><code>Sub ReturncorrectCreditdebitcolumnbasedonselectioninputbox()\n\nDim c As Long\nDim WorkRng2 As Range\nDim WorkRng As Range\n\nSet WorkRng = Application.InputBox(\"Please select the range where you want your Dedit/Credit\", , , Type:=8)\nSet WorkRng2 = Application.InputBox(\"Please select the range of amounts\", , , Type:=8)\n\nIf WorkRng.Count &lt;&gt; WorkRng2.Count Then\n    MsgBox \"Ranges must be same size\"\nElse\n    For c = 1 To WorkRng.Count\n        WorkRng.Cells(c).Formula = \"=If(\" &amp; WorkRng2.Cells(c).Value &amp; \"&gt;0, \"\"D\"\",\"\"C\"\")\"\n    Next c\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 10186814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70a16739b4f390d68b13008f18c6108?s=128&d=identicon&r=PG&f=1", "display_name": "Xavi", "link": "https://stackoverflow.com/users/10186814/xavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53307685, "answer_count": 1, "score": 0, "last_activity_date": 1586390965, "creation_date": 1542213786, "last_edit_date": 1586390965, "question_id": 53305006, "link": "https://stackoverflow.com/questions/53305006/formula-returning-name-inside-loop-via-selection-from-input-box", "title": "formula returning #NAME inside loop via selection from input box", "body": "<p>I have a small macro and I would like that it does the following: the first input box ask the user to select a empty range where he wants to have in each cell of this range the debit/Credit\u2026 The 2nd input box ask the user to select a range of amounts (each amount in each cell of this range can be either negative or positive) . Then from these 2 selections, I would like that it returns \u201cD\u201d (debit) or \u201cC\u201d (credit) on each cell where it was selected the range of first input box. Unfortunately my macro does not work properly, indeed when I try to execute it, it returns me #NAME? (instead of \u201cC\u201d or \u201cD\u201d ) In each cell of the range selected via my first input box. For example on the picture below, I selected via my 1st input box the range K2:K5 (as an empty range)  and via my second input box the range C2:C5, after executing the macro, it returns me #NAME in each cell of range K2:K5.\nMany Thanks in advance for your help.\nXavi\nPlease find my VBA code below:</p>\n\n<pre><code>Sub ReturncorrectCreditdebitcolumnbasedonselectioninputbox()\nDim c As Range\nDim WorkRng2 As Range\nDim WorkRng As Range\nSet WorkRng = Application.Selection\nSet WorkRng = Application.InputBox(\"Please select the range where you want your Dedit/Credit\", xTitleId, WorkRng.Address, Type:=8)\nSet WorkRng2 = Application.Selection\nSet WorkRng2 = Application.InputBox(\"Please select the range of amounts\", xTitleId, WorkRng.Address, Type:=8)\nFor Each c In WorkRng\nc.FormulaR1C1 = _\n \"=If(WorkRng2.Value&gt;0, \"\"D\"\",\"\"C\"\")\"\n Next c\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/WPs5A.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WPs5A.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "fonts", "powerpoint"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1542213194, "post_id": 53304657, "comment_id": 93490458, "body": "<code>.TextFrame2.TextRange.Font.Spacing = .TextFrame2.TextRange.Font.Spacing - 0.2</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4474024"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1542213550, "post_id": 53304657, "comment_id": 93490684, "body": "You are a vba wizard! Thank you!"}], "owner": {"user_type": "does_not_exist", "display_name": "user4474024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542212804, "creation_date": 1542212635, "last_edit_date": 1542212804, "question_id": 53304657, "link": "https://stackoverflow.com/questions/53304657/vba-incremental-character-spacing", "title": "VBA Incremental character spacing", "body": "<p>I have this code to condense text to 0.2 but would like to have it incremental. So each time I run the code the text condense by 0.2.\nDoes anyone know what I need to add to my code?</p>\n\n<pre><code>Sub CondenseText()\n\n    On Error GoTo Catch\n\n    Dim o As Shape, b As Boolean\n    Set o = ActiveWindow.Selection.ShapeRange(1)\n    If Not o Is Nothing Then\n        With o\n            .TextFrame2.TextRange.Font.Spacing = -0.2\n        End With\n    End If\n    Exit Sub\nCatch:\n    If Err.Number = -2147188160 Then MsgBox CG_NOTHING_SELECTED\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542211845, "post_id": 53304354, "comment_id": 93489591, "body": "You can pass in an array of patterns along with the string to be modified, or define an array within your function and then loop over it and perform the replacements."}, {"owner": {"reputation": 157, "user_id": 5494810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d8fa61b78e6fc69a8dcba6eaae4bea2?s=128&d=identicon&r=PG&f=1", "display_name": "rew", "link": "https://stackoverflow.com/users/5494810/rew"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542212258, "post_id": 53304354, "comment_id": 93489863, "body": "Hi Tim, I saw your post:  <a href=\"https://stackoverflow.com/questions/9672436/multipoint-regular-expressions-match-with-less-for-loops-and-less-class-re-initi\" title=\"multipoint regular expressions match with less for loops and less class re initi\">stackoverflow.com/questions/9672436/&hellip;</a>, but was unsure how to adapt it to my particular needs based on the fact that I am deleting and keeping remainders. May I have an example?"}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 5494810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d8fa61b78e6fc69a8dcba6eaae4bea2?s=128&d=identicon&r=PG&f=1", "display_name": "rew", "link": "https://stackoverflow.com/users/5494810/rew"}, "edited": false, "score": 0, "creation_date": 1542217456, "post_id": 53305643, "comment_id": 93492751, "body": "Boom! Thank you very kindly Tim."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1542216137, "creation_date": 1542216137, "answer_id": 53305643, "question_id": 53304354, "link": "https://stackoverflow.com/questions/53304354/excel-vba-multiple-regex-pattern-deletion/53305643#53305643", "title": "Excel VBA - Multiple regex pattern deletion", "body": "<p>Like this:</p>\n\n<pre><code>Function test(Txt As String) As String\n    Static regEx As Object '&lt;&lt; need Static here\n    Dim rv As String, p, n\n\n    n = \"CustomerABC\"\n\n    If regEx Is Nothing Then\n        Set regEx = CreateObject(\"VBScript.RegExp\")\n        regEx.Global = True\n        regEx.IgnoreCase = True\n    End If\n    If Len(Txt) &gt; 0 Then\n        rv = Txt\n        'looping over an array of patterns\n        For Each p In Array(\"^\\(?[0-9.]+\\)?\", n &amp; \"(\\S*)?(\\s+)?\")\n            With regEx\n                .Pattern = p\n                rv = .Replace(rv, \"\")\n            End With\n        Next p\n    End If\n    test = Application.Trim(rv)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 5494810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d8fa61b78e6fc69a8dcba6eaae4bea2?s=128&d=identicon&r=PG&f=1", "display_name": "rew", "link": "https://stackoverflow.com/users/5494810/rew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 1, "accepted_answer_id": 53305643, "answer_count": 1, "score": 1, "last_activity_date": 1586391152, "creation_date": 1542211600, "last_edit_date": 1586391152, "question_id": 53304354, "link": "https://stackoverflow.com/questions/53304354/excel-vba-multiple-regex-pattern-deletion", "title": "Excel VBA - Multiple regex pattern deletion", "body": "<p>In Excel VBA I need to perform multiple regular expression matches which then deletes the match from the string while preserving the remainder of the string. I have it working by daisy-chaining two variables, and by not testing the pattern match first since the second match is the remainder of the first. </p>\n\n<p>Consider the follow data:</p>\n\n<p>(2.5.3) A. 100% of product will be delivered in 3 days</p>\n\n<p>(2.5.3) B. Capability to deliver product by air.</p>\n\n<p>(2.5.3) C. Support for xyz feature</p>\n\n<p>(2.5.3) D. Vendor is to provide an overview of the network as proposed.</p>\n\n<p>(2.5.3) E. The network should allow CustomerABC to discover their devices.</p>\n\n<p>(2.5.3) F. The use of CustomerABC existing infrastructure should be optimized. CustomerABC's capability will vary.</p>\n\n<p>(2.5.3) G. Describe the number of network devices requiring to run CustomerABC's center.</p>\n\n<p>With this data, I am deleting the outline numbers in the beginning of the string, as well as any references to CustomerABC and any hyphenation that could possibly appear multiple times in the string at any location, with potentially upper and lower case. I have the regex's working. Here is the code I'm trying:</p>\n\n<pre><code>Function test(Txt As String) As String\nDim regEx As Object\nDim v1 As String\nDim v2 As String\nDim n As String\nn = \"CustomerABC\"\n\nIf regEx Is Nothing Then\n    Set regEx = CreateObject(\"VBScript.RegExp\")\n    regEx.Global = True\n    regEx.IgnoreCase = True\nEnd If\nIf Len(Txt) &gt; 0 Then\n    With regEx\n    ' The 1st pattern\n    .Pattern = \"^\\(?[0-9.]+\\)?\"\n    'If Not .Test(Txt) Then Exit Function\n    v1 = .Replace(Txt, \"\")\n    ' The 2nd pattern\n    .Pattern = n + \"(\\S*)?(\\s+)?\"\n    'If Not .Test(Txt) Then Exit Function\n    v2 = .Replace(v1, \"\")\n ' The result\n   test = Application.Trim(v2)\n   End With\n  End If\nEnd Function\n</code></pre>\n\n<p>Is there a way to make this better, speed things up, and have a variable number of match/deletions?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 5, "creation_date": 1542210369, "post_id": 53303904, "comment_id": 93488656, "body": "<code>Selection.Formula = &quot;=CONCATENATE(&quot;&quot;For the Year Ended &quot;&quot;,TEXT(CYEDATE(),&quot;&quot;mmmm dd, yyyy&quot;&quot;),&quot;&quot; &quot;&quot;)&quot;</code> should do the trick. If you get stuck, just record a macro of you pasting this formula in a cell and it will pretty much write it for you."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1542210764, "post_id": 53303904, "comment_id": 93488920, "body": "Don&#39;t know if it helps, but if you hit <code>CTRL+;</code> it will insert the date for you. (I know you also want text, but just thought to mention that)"}, {"owner": {"reputation": 1, "user_id": 10652878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a151b610dc5ef1c2560e1388a4888e?s=128&d=identicon&r=PG&f=1", "display_name": "benj2017", "link": "https://stackoverflow.com/users/10652878/benj2017"}, "edited": false, "score": 1, "creation_date": 1542210839, "post_id": 53303904, "comment_id": 93488969, "body": "That did it. I tried the recorder, but I&#39;ve been trying to get better with VBA and wanted to see how it worked. Thanks for helping a newbie...."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1542216320, "post_id": 53303904, "comment_id": 93492162, "body": "You could also give the cell a custom number format of <code>&quot;For the Year Ended &quot; mmmm dd, yyyy</code> and just add the date to the cell.  Upside is that you can then perform calculations on the date in the cell."}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 2686470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894bb7ccc882bd4a1562feb617890e78?s=128&d=identicon&r=PG&f=1", "display_name": "adelzel", "link": "https://stackoverflow.com/users/2686470/adelzel"}, "is_accepted": false, "score": 0, "last_activity_date": 1542215583, "creation_date": 1542215583, "answer_id": 53305503, "question_id": 53303904, "link": "https://stackoverflow.com/questions/53303904/how-do-i-create-an-excel-macro-using-vba-to-paste-a-specific-formula/53305503#53305503", "title": "How do I create an Excel Macro using VBA to paste a specific formula?", "body": "<p>Try recording a macro if you're new to VBA. Then click on the Visual Basic editor to see how the code is written. Then you can replace the specific range you're pasting into to be the more generic reference to the Active cell.</p>\n\n<p>One example of code you can use is this:\n1. Store your formula as a String variable\n2. Set the formula of the ActiveCell to be</p>\n\n<pre><code>Dim formula As String\nformula = \"=CONCATENATE(\"\"For the Year Ended \"\",TEXT(CYEDATE(),\"\"mmmm dd, yyyy\"\"),\"\" \"\")\"\n\nActiveCell.formula = formula\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10652878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a151b610dc5ef1c2560e1388a4888e?s=128&d=identicon&r=PG&f=1", "display_name": "benj2017", "link": "https://stackoverflow.com/users/10652878/benj2017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1586391355, "creation_date": 1542210263, "last_edit_date": 1586391355, "question_id": 53303904, "link": "https://stackoverflow.com/questions/53303904/how-do-i-create-an-excel-macro-using-vba-to-paste-a-specific-formula", "title": "How do I create an Excel Macro using VBA to paste a specific formula?", "body": "<p>I'd like to set up a macro using VBA that will paste the following formula into whatever cell is currently active.</p>\n\n<pre><code>=CONCATENATE(\"For the Year Ended \",TEXT(CYEDATE(),\"mmmm dd, yyyy\"),\" \")\n</code></pre>\n\n<p>This formula will insert the current date and text into financial statements in a ProFX excel workpaper. Once i create the Macro, I'll ad a keyboard shortcut.  It's easily done with copy and paste, but I'd like to understand how to make it work. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1542210451, "creation_date": 1542210451, "answer_id": 53303971, "question_id": 53303738, "link": "https://stackoverflow.com/questions/53303738/how-do-i-unzip-a-password-protected-zip-file-using-access-vba-and-an-encrypted-p/53303971#53303971", "title": "How do I unzip a password protected zip file using Access VBA and an encrypted password", "body": "<p>I have covered zipping and unzipping \"the Windows Explorer way\" in my articles:</p>\n\n<p><a href=\"https://www.experts-exchange.com/articles/31130/Zip-and-unzip-files-and-folders-with-VBA-the-Windows-Explorer-way.html?headerLink=workspace_article\" rel=\"nofollow noreferrer\">Zip and unzip files and folders with VBA the Windows Explorer way</a></p>\n\n<p>but those have nothing to do with encrypted zip files as you can't do that natively.</p>\n\n<p>However, you may be able to use the <a href=\"https://www.winzip.com/win/en/downcl.html\" rel=\"nofollow noreferrer\">WinZip Command Line</a> by shelling out to this, passing it a proper command line.</p>\n"}], "owner": {"reputation": 107, "user_id": 4620432, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/13b20e7a4e8080dd0454890e734329a5?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4620432/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1399, "favorite_count": 0, "accepted_answer_id": 53303971, "answer_count": 1, "score": 1, "last_activity_date": 1594626364, "creation_date": 1542209744, "last_edit_date": 1594626364, "question_id": 53303738, "link": "https://stackoverflow.com/questions/53303738/how-do-i-unzip-a-password-protected-zip-file-using-access-vba-and-an-encrypted-p", "title": "How do I unzip a password protected zip file using Access VBA and an encrypted password", "body": "<p>This needs to work with both Windows 7 and Windows 10.  I'm converting a clients very manual Excel VBA based process to something linking MS Access via ODBC to his Pervasive database backend of his MRP program.</p>\n\n<p>I found another thread where they were using Access VBA to unzip a file, but I can't post to that site, even though I have a login account, so I'm posting here:</p>\n\n<p><a href=\"https://answers.microsoft.com/en-us/office/forum/office_2007-access/how-do-i-extract-zip-files-through-ms-access/e3720f53-2413-409b-ad0b-bbfb67e823e4\" rel=\"nofollow noreferrer\">https://answers.microsoft.com/en-us/office/forum/office_2007-access/how-do-i-extract-zip-files-through-ms-access/e3720f53-2413-409b-ad0b-bbfb67e823e4</a></p>\n\n<p>The code used in that link is as follows.  I haven't run it yet.  Was just wondering how to incorporate an encrypted password value to get the desired result:</p>\n\n<pre><code>Sub ImportZippedFile(ByVal sZipFileName As Variant) \n\n  Dim oApp As Object\n  Dim fileNameInZip As Variant\n\n  Dim sFileNameFolder As Variant\n\n  Dim vLocalZipName as Variant \n\n vLocalZipName =sZipFileName\n\n  'use system temp folder to extract zipped file to.\n  sFileNameFolder = Environ(\"Temp\") &amp; \"\\Excel_Tmp\\\"\n\n  'Extract the file into the newly created folder\n  Set oApp = CreateObject(\"Shell.Application\")\n\n  'list all the file names within the zip file\n  For Each fileNameInZip In oApp.Namespace(vLocalZipName ).items\n    msgbox filenameinzip\n\n\n    oApp.Namespace(sFileNameFolder).CopyHere _\n      oApp.Namespace(vLocalZipName ).items.item(CStr(fileNameInZip))\n\n  Next fileNameInZip\n\n  Set oApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>However, the zip file in that example was evidently not password protected.  My client has a directory full of password protected zip files.  He uses Excel VBA and a database table that has the file names, and the encrypted password needed to unzip the file.  His code calls WinZip from an Excel VBA shell out, and supplies the encrypted password as a parameter to WinZip so it can unzip the  file.</p>\n\n<p>His current code uses Winzip under Windows 7.  I'm on Windows 10, and when I installed Winzip on my machine, it froze up File Explorer, and I could not view my subdirectories or directories.  When I uninstalled WInzip, all was good again.</p>\n\n<p>what code would allow me to unzip a file, using only Access VBA, if I had an encrypted password?</p>\n\n<p>The encrypted password was generated by his Sage MRP program.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 2, "creation_date": 1542209916, "post_id": 53303595, "comment_id": 93488344, "body": "if these are text files, why not use a command line with Vi or grep for example - depending on the system..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1542211583, "post_id": 53303595, "comment_id": 93489448, "body": "Would help to show the &quot;after&quot; for the lines you want to alter.  Might want to set up a separate folder to write out the &quot;fixed&quot; files, leaving the originals untouched, otherwise it&#39;s tricky to track what changes were made, and if you make a mistake you can just fix your code and re-run it."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1542212573, "post_id": 53303595, "comment_id": 93490061, "body": "I just edited my original post.  I added some screen shots, and a little more explanation.  I think, if there is an easy way to account for line breaks, this shouldn&#39;t be too complex.  It just seems like the line breaks are throwing things off."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1542215019, "post_id": 53303595, "comment_id": 93491484, "body": "Here&#39;s an ugly way you could do this but it&#39;d require you to loop each file twice - on the first run you get the line number for each start <code>steps:</code> and the line number for each end <code>fields:</code>, then the second pass you replace/cut/(something, idk all the features <code>fso</code> has for text files) the lines between those line numbers with your intended replacement. It&#39;s real ugly but should work assuming all start keywords have an end keyword"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1542215386, "post_id": 53303595, "comment_id": 93491692, "body": "Yeah, all starts have ends.  Did you post some sample code?  I didn&#39;t see anything &#39;ugly&#39;.  I don&#39;t care if it&#39;s ugly or beautiful, I just want to get something working here.  Thanks."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1542225772, "post_id": 53303595, "comment_id": 93496505, "body": "I posted code right when this was posted but I didnt understand the question correctly at that point. Instead of using <code>Text.ReadAll</code> I&#39;d use <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/textstream-object\" rel=\"nofollow noreferrer\"><code>Text.ReadLine</code></a> for my approach"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1542227130, "post_id": 53303595, "comment_id": 93497119, "body": "OP tries to use wild cards with no success: suppose wrong use of range related <code>.Replace</code> - there are no cell values, only string values; VBA function replace on the other hand doesn&#39;t support wild cards as in OP. I&#39;d recommend to use regular expressions instead (many examples at SO :-). Take into account, too that different operating systems  (UNIX, mac) could define other new line characters, e.g. only a chr(10) line feed instead of chr(13) + chr(10)."}], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1542281145, "post_id": 53311563, "comment_id": 93516717, "body": "Just a side note to your declarations: &quot;If you don&#39;t specify a data type or object type [..]&quot; as e.g. in <code>Dim I, I2 As Long</code>, the <i>[first]</i> variable <code>I</code> &quot;is Variant by default &quot; - c.f. <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dim-statement\" rel=\"nofollow noreferrer\">MS Help</a>"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 1, "creation_date": 1542285380, "post_id": 53311563, "comment_id": 93519249, "body": "Awesome!  Thanks a bunch!!"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1542289309, "post_id": 53311563, "comment_id": 93521504, "body": "Thanks if it is useful it made my day.. And  @T.M. appreciate  for reminding..I will keep a watch on it."}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 5, "last_activity_date": 1542250664, "last_edit_date": 1542250664, "creation_date": 1542248877, "answer_id": 53311563, "question_id": 53303595, "link": "https://stackoverflow.com/questions/53303595/trying-to-do-a-find-replace-with-wildcard/53311563#53311563", "title": "Trying to do a find/replace with wildcard", "body": "<p>Certainly It is not the answer of \u201cTrying to do a find/replace with wildcard\u201d and may look like crude and childish to experts of your stature. But it is tried and working with the sample data so may kindly not flag or down vote.  </p>\n\n<pre><code>Sub FindAndReplaceText2()\n Dim FileName, FileName2 As String\n Dim FolderPath, FolderPath2 As String\n Dim FileSpec, FileSpec2 As String\n Dim FSO As Object\n Dim SearchForWords As String\n Dim SubstituteWords As String\n Dim Text As String\n Dim TextFile As Object\n\n  'Change these arrays to word you want to find and replace\n  SearchForWords = \"  steps:\" &amp; \"*\" &amp; \"        fields:\"\n  SubstituteWords = \"  global\" &amp; vbCrLf &amp; \"    global:\" &amp; vbCrLf &amp; \"      schema_def:\" &amp; vbCrLf &amp; \"        fields:\"\n\n\n  'Change the folder path to where your text files are.\n  ' look for all lines with: '      - .*Pricing_RealEstate' &amp; '*'\n   FolderPath = \"C:\\users\\user\\Desktop\\New Folder\\\"\n   FolderPath2 = \"C:\\users\\user\\Desktop\\New Folder2\\\"\n   Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n   FileName = Dir(FolderPath &amp; \"\\*.txt\")\n\n     Do While FileName &lt;&gt; \"\"\n       FileSpec = FolderPath &amp; FileName\n       FileSpec2 = FolderPath2 &amp; FileName\n\n        'Read all the file's text into a string variable.\n         Set TextFile = FSO.OpenTextFile(FileSpec, 1, False)\n         Text = TextFile.ReadAll\n         TextFile.Close\n         'SrchReplText Now  work for single wildcard only\n         Text = SrchReplText(Text, SearchForWords, SubstituteWords)\n        'Scan the string for words to replace and write the string back to the file.\n         Set TextFile = FSO.CreateTextFile(FileSpec2, 2, False)\n         TextFile.Write Text\n         TextFile.Close\n     FileName = Dir()\n     Loop\nEnd Sub\n\nPrivate Function SrchReplText(Txt As String, SrcTxt As String, RplTxt As String) As Variant\n'Now for single wildcard only using single loop\nDim Wordx, Word3 As Variant\nDim I, I2 As Long\nSrchReplText = Txt\nWordx = Split(SrcTxt, \"*\")\nIf UBound(Wordx) &gt; 1 Then Exit Function\nIf UBound(Wordx) = 1 Then\nDo\n  Found = False\n  I = InStr(1, SrchReplText, Wordx(0))\n  If I &gt; 0 Then I2 = InStr(I, SrchReplText, Wordx(1))\n     If I &gt; 0 And I2 &gt; 0 Then\n     Found = True\n     Word3 = Mid(SrchReplText, I, I2 - I + Len(Wordx(1)))\n     SrchReplText = Replace(SrchReplText, Word3, RplTxt, 1, 1)\n     End If\nLoop While Found\nElse\nSrchReplText = Replace(SrchReplText, SrcTxt, RplTxt, 1, 1)\nEnd If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 2, "accepted_answer_id": 53311563, "answer_count": 1, "score": 2, "last_activity_date": 1586391593, "creation_date": 1542209326, "last_edit_date": 1586391593, "question_id": 53303595, "link": "https://stackoverflow.com/questions/53303595/trying-to-do-a-find-replace-with-wildcard", "title": "Trying to do a find/replace with wildcard", "body": "<p>I am trying to loop through all text files in a folder, open each, do a find/replace, save each, and close each.  My code looks like this.</p>\n\n<pre><code>Sub FindAndReplaceText()\n\n Dim FileName As String\n Dim FolderPath As String\n Dim FSO As Object\n Dim I As Integer\n Dim SearchForWords As Variant\n Dim SubstituteWords As Variant\n Dim Text As String\n Dim TextFile As Object\n\n  'Change these arrays to word you want to find and replace\n  SearchForWords = Array(\"  steps:\" &amp; \"*\" &amp; \"        fields:\")\n  SubstituteWords = Array(\"  global\" &amp; vbCrLf &amp; \"    global:\" &amp; vbCrLf &amp; \"      schema_def:\" &amp; vbCrLf &amp; \"        fields:\")\n\n  'Change the folder path to where your text files are.\n  ' look for all lines with: '      - .*Pricing_RealEstate' &amp; '*'\n   FolderPath = \"C:\\path_here\\\"\n\n     Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n\n     FolderPath = IIf(Right(FolderPath, 1) &lt;&gt; \"\\\", FolderPath &amp; \"\\\", FolderPath)\n     FileName = Dir(FolderPath &amp; \"\\*.txt\")\n\n     Do While FileName &lt;&gt; \"\"\n       FileSpec = FolderPath &amp; FileName\n        'Read all the file's text into a string variable.\n         Set TextFile = FSO.OpenTextFile(FileSpec, 1, False)\n           Text = TextFile.ReadAll\n         TextFile.Close\n\n        'Scan the string for words to replace and write the string back to the file.\n         Set TextFile = FSO.OpenTextFile(FileSpec, 2, False)\n           For I = 0 To UBound(SearchForWords)\n           Debug.Print Text\n             Replace Text, SearchForWords(I), SubstituteWords(I)\n           Debug.Print Text\n           Next I\n         TextFile.Write Text\n         TextFile.Close\n       FileName = Dir()\n     Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "ms-word"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1542209579, "post_id": 53303568, "comment_id": 93488125, "body": "What exactly is your question? For an out of process caller, like Excel, it will always return False. There is no way to change that."}, {"owner": {"reputation": 21, "user_id": 10652725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae78497ce98d7eea658e8b93481cbe3?s=128&d=identicon&r=PG&f=1", "display_name": "Yoan_Geneva", "link": "https://stackoverflow.com/users/10652725/yoan-geneva"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1542210258, "post_id": 53303568, "comment_id": 93488575, "body": "Yes sorry I amended my post. I have a bug with the Set editor=.GetInspector.WordEditor --&gt; Application-defined or object-defined error"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10652725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae78497ce98d7eea658e8b93481cbe3?s=128&d=identicon&r=PG&f=1", "display_name": "Yoan_Geneva", "link": "https://stackoverflow.com/users/10652725/yoan-geneva"}, "edited": false, "score": 0, "creation_date": 1542213600, "post_id": 53304036, "comment_id": 93490710, "body": "Thanks for your reply Dmitry, But how can I copy the word&#39;s content in the email body ?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 21, "user_id": 10652725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae78497ce98d7eea658e8b93481cbe3?s=128&d=identicon&r=PG&f=1", "display_name": "Yoan_Geneva", "link": "https://stackoverflow.com/users/10652725/yoan-geneva"}, "edited": false, "score": 0, "creation_date": 1542214782, "post_id": 53304036, "comment_id": 93491360, "body": "What you have above should be fine. Just try to call Display <i>before</i> accessing the WordEditor property."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1542214811, "last_edit_date": 1542214811, "creation_date": 1542210660, "answer_id": 53304036, "question_id": 53303568, "link": "https://stackoverflow.com/questions/53303568/application-istrusted-returns-false/53304036#53304036", "title": "application.IsTrusted returns false", "body": "<p>Of course - you are accessing <code>Outlook.Application</code> object from outside of the outlook.exe address space, hence your instance of the <code>Outlook.Application</code> object is not trusted and will raise security prompts when you access sensitive information. Only COM addins and Outlook VBA get a trusted version of that object.</p>\n\n<p>As for the <code>GetInspector.WordEditor</code> error, try to access that object after calling <code>Display</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 10652725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae78497ce98d7eea658e8b93481cbe3?s=128&d=identicon&r=PG&f=1", "display_name": "Yoan_Geneva", "link": "https://stackoverflow.com/users/10652725/yoan-geneva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542268816, "creation_date": 1542209232, "last_edit_date": 1542213529, "question_id": 53303568, "link": "https://stackoverflow.com/questions/53303568/application-istrusted-returns-false", "title": "application.IsTrusted returns false", "body": "<p>The following code (found on internet) doesn't work as <code>OutApp.IsTrusted</code> returns false. </p>\n\n<p>When I try to run the code I have a bug with the following line `Set editor = .GetInspector.WordEditor\" --> Application-defined or object-defined error</p>\n\n<p>I use the code in excel vba as I don't have vba macro available in Outlook. \nMy outlook version is 2013. </p>\n\n<pre><code>Sub emailFromDoc()\nDim wd As Object, editor As Object\nDim doc As Object\nDim oMail As MailItem\nDim OutApp As Object\n\nSet wd = GetObject(, \"Word.Application\")\nSet doc = wd.Documents.Open(\"\\\\Chdcvnas0351.ch.hibm.hsbc\\user.hbeu$\\43987788\\Documents\\Market Update.docx\")\ndoc.content.Copy\ndoc.Close\n\nSet wd = Nothing\nSet OutApp = GetObject(, \"Outlook.Application\")\nSet oMail = OutApp.CreateItem(olMailItem)\n\nWith oMail\n    .BodyFormat = olFormatRichText\n    Set editor = .GetInspector.WordEditor\n    editor.content.Paste\n    .Display\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n\n<p>If someone can help me, it would be much appreciated.\nBest regards\nYoan</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1542209430, "post_id": 53303527, "comment_id": 93488042, "body": "Your ranges appear to be invalid. Your arrays contain either &quot;&quot; or the value of a cell, and I suspect the cells don&#39;t contain the names or addresses of ranges."}, {"owner": {"reputation": 1, "user_id": 10652604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29249947dade7139c255551ee2671aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/10652604/rama"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1542209915, "post_id": 53303527, "comment_id": 93488343, "body": "Thank you, @Rory, for prompt response. My original arrays- Names() contained either &quot;&quot; or a string value and ParameterB() contained either &quot;&quot; or a double, indeed. However, what I am trying with the TaskArray is to create an auxiliary array with only the unique name list and the sums of their parameterB&#39;s. I am getting the first column, that is, the unique names. There are no more blanks in it, and its range is far smaller than the original array&#39;s. It is the sumif column which is giving me trouble."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1542210484, "post_id": 53303527, "comment_id": 93488743, "body": "Those are not ranges, they are arrays. You can&#39;t just put <code>Range()</code> round them to turn them into ranges. I think you need to rethink your entire approach since SUMIF will only work with ranges on a worksheet."}, {"owner": {"reputation": 1, "user_id": 10652604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29249947dade7139c255551ee2671aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/10652604/rama"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1542210733, "post_id": 53303527, "comment_id": 93488899, "body": "I see...Thank you!"}], "owner": {"reputation": 1, "user_id": 10652604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b29249947dade7139c255551ee2671aa?s=128&d=identicon&r=PG&f=1", "display_name": "Rama", "link": "https://stackoverflow.com/users/10652604/rama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542210426, "creation_date": 1542209068, "last_edit_date": 1542210426, "question_id": 53303527, "link": "https://stackoverflow.com/questions/53303527/application-worksheetfunction-sumif-with-internal-arrays-as-argument", "title": "Application.worksheetfunction.sumif with internal arrays as argument", "body": "<p>I am trying to build a subroutine which checks a certain condition in a client list, separates out the entries which meets the condition, and then average the remaining entries for each name. It is like a doing a pivot table with VBA. I did not want to use the pivot table, since writing the data into a new sheet, refresh it and do something with it adds an unnecessary burden on the speed of the tool. Furthermore, all the arrays are to be kept within the code, rather than written on the sheets. I am almost done with the code, but it is giving me an error in the very end, where I am using the sumif condition. \n<strong>A point of clarification: The argument 'Number' is a global variable declared in the main tool, which comes from the count of names from the main list, which is in sheet5. I hope that the code is self explanatory beyond that.</strong>\nWhat I am getting while running the code is the Error- <em>Run-time error '1004':\nMethod 'Range' of object '_Global' failed</em> on the line <code>TaskArray(k, 1) = Application.WorksheetFunction.SumIf(Range(Names), NewList(k), Range(ParameterB))</code></p>\n\n<p>The Code-</p>\n\n<pre><code>Sub Task()\n\nDim Names() As Variant                                                 'Declare Names \nReDim Names(0 To Number) As Variant                               'Declare Names as a vector\nDim ParameterA() As Variant                                           'Declare Parameter A\nReDim ParameterA(0 To Number) As Variant                         'Declare Parameter A as a vector\nDim ParameterB() As Variant                                           'Declare Parameter B\nReDim ParameterB(0 To Number) As Variant                         'Declare Parameter B as a vector\n\n\nDim i As Integer\n\nFor i = 1 To Number\n\nSelect Case Sheet5.Range(\"BO\" &amp; i + 1) - Sheet5.Range(\"BN\" &amp; i + 1)\nCase 0\nNames(i) = \"\"\nParameterA(i) = Sheet5.Range(\"BN\" &amp; i + 1) - Sheet5.Range(\"BL\" &amp; i + 1)\nParameterB(i) = \"\"\nCase Else\nNames(i) = Sheet5.Range(\"F\" &amp; i + 1)\nParameterA(i) = Sheet5.Range(\"BN\" &amp; i + 1) - Sheet5.Range(\"BL\" &amp; i + 1)\nParameterB(i) = Sheet5.Range(\"BO\" &amp; i + 1) - Sheet5.Range(\"BN\" &amp; i + 1)\nEnd Select\n\nNext i\n\n\nSheet3.Range(\"T159\") = Application.WorksheetFunction.Sum(ParameterA())        'Write the total of Parameter A\nSheet3.Range(\"T160\") = Application.WorksheetFunction.Sum(ParameterB())        'Write the total of Parameter B\n'________________________ To isolate the list of Names (Unique) with existent Parameter B \nDim NewList() As Variant\n\nDim j As Long\nDim d As Scripting.Dictionary\nSet d = New Scripting.Dictionary\nWith d\n    For j = LBound(Names) To UBound(Names)\n        If IsMissing(Names(j)) = False Then\n            .item(Names(j)) = 1\n        End If\n    Next\n    NewList = .Keys\nEnd With\n'________________________To create an array of sums of Parameter B\nFor k = 1 To Application.WorksheetFunction.CountA(NewList) - 1\nDim TaskArray() As Variant\nReDim TaskArray(1 To k, 0 To 1) As Variant\nReDim Names(0 To Number) As Variant\nReDim ParameterB(0 To Number) As Variant\nTaskArray(k, 0) = NewList(k)\nTaskArray(k, 1) = Application.WorksheetFunction.SumIf(Range(Names), NewList(k), Range(ParameterB))\nSheet19.Range(\"H\" &amp; k + 1) = TaskArray(k, 0)\nSheet19.Range(\"I\" &amp; k + 1) = TaskArray(k, 1)\nNext k\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 10645669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0835999bc1f9616fc3ff8b3ca7b0e3a0?s=128&d=identicon&r=PG&f=1", "display_name": "GTPV", "link": "https://stackoverflow.com/users/10645669/gtpv"}, "edited": false, "score": 2, "creation_date": 1542210548, "post_id": 53303387, "comment_id": 93488782, "body": "The formatted table is a good choice. An alternative that you did not mention is to add a line &quot;inside&quot; the &quot;old&quot; range to extend it and then move the values around."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 3, "last_activity_date": 1542208594, "creation_date": 1542208594, "answer_id": 53303387, "question_id": 53302971, "link": "https://stackoverflow.com/questions/53302971/vba-named-range-that-contains-offsets-is-fixed-in-chart/53303387#53303387", "title": "VBA Named Range that contains offsets is fixed in chart", "body": "<h3>Add an update procedure</h3>\n\n<p>Place an update procedure into a module</p>\n\n<pre><code>Sub UpdateChartSourceData()\n    With Worksheets(\"SheetWithChart\")\n        cht.Chart.SetSourceData Source:=.Range(\"series1\")\n    End With\nEnd Sub\n</code></pre>\n\n<p>And put this in your sheet with the chart data</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Me.Range(\"series1\")) Is Nothing Then\n        cht.Chart.SetSourceData Source:=Me.Range(\"series1\")\n    End If\nEnd Sub\n</code></pre>\n\n<p>to update the chart everytime the data changes.</p>\n\n<p>You might need to define/adjust <code>cht</code> in the code above.</p>\n\n<hr>\n\n<h3>Or use formatted tables</h3>\n\n<p>An easier way would be to use a formatted table for source data. And make the chart using that complete table as source. This way the chart automatically updates if the table gets added rows or columns.</p>\n"}], "owner": {"reputation": 127, "user_id": 5097646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfb293db34079a4c3bd38580a6c10cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadi w", "link": "https://stackoverflow.com/users/5097646/arkadi-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 53303387, "answer_count": 1, "score": 1, "last_activity_date": 1586391953, "creation_date": 1542207153, "last_edit_date": 1586391953, "question_id": 53302971, "link": "https://stackoverflow.com/questions/53302971/vba-named-range-that-contains-offsets-is-fixed-in-chart", "title": "VBA Named Range that contains offsets is fixed in chart", "body": "<p>I have a dynamic table with values in column Y:</p>\n\n<p>I create <code>series1</code> in name manager with the formula\n<code>=OFFSET('Sheet1'!$Y$16,0,0,COUNTA('Sheet1'!$Y$16:$Y$5012),1)</code></p>\n\n<p>I want to plot this via a chart in VBA, so I do </p>\n\n<p><code>cht.Chart.SetSourceData Source:=\"=series1\"</code></p>\n\n<p>but what I get in my graph is <code>\"='Sheet1'!$Y$16:$Y$43\"</code> because data stops in line 43</p>\n\n<p>instead of </p>\n\n<p><code>='static bbg data'!series1</code></p>\n\n<p>So later if I add lines to my table in column Y, these won't be updated on the graph vs is I were to create my chart and add <code>='static bbg data'!series1</code> manually.</p>\n\n<p>Could you help me to solve this?</p>\n\n<p>Thank you for the help</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1542201970, "post_id": 53301224, "comment_id": 93483112, "body": "What line do you get an error on?"}, {"owner": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1542202117, "post_id": 53301224, "comment_id": 93483203, "body": "Hi, there, I get an error in this Line, <code>Sheets(&quot;Int_Result&quot;).Shapes(ro, col).ControlFormat.Value = False</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1542202636, "post_id": 53301224, "comment_id": 93483541, "body": "<code>Shapes(ro, col)</code>  Shapes only takes one argument"}, {"owner": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "edited": false, "score": 0, "creation_date": 1542202898, "post_id": 53301224, "comment_id": 93483728, "body": "Ok I get it Thank you. So, How can I reference a shape (OptionButton) present in a specific cell, so that I can set them to true or  False?"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 4, "creation_date": 1542202956, "post_id": 53301224, "comment_id": 93483767, "body": "May try using  <code>Sheets(&quot;Int_Result&quot;).OLEObjects(&quot;OB&quot; &amp; ro &amp; &quot;_&quot; &amp; Col)</code> instead of <code>Sheets(&quot;Int_Result&quot;).Shapes(ro, col)</code>"}, {"owner": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1542203928, "post_id": 53301224, "comment_id": 93484429, "body": "Hallo @AhmedAU , I have tried your solution. A new error Stating, &quot;Subscript Out of Range &quot;occurs. I have read the Online help, It states the answer related to arrays, of no array being used in my code.       <a href=\"https://docs.microsoft.com/en-us/office/vba/Language/Reference/User-Interface-Help/subscript-out-of-range-error-9\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/Language/Reference/&hellip;</a>"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1542204629, "post_id": 53301224, "comment_id": 93484909, "body": "If you try to specify an <code>OLEObject</code> that doesn&#39;t exist you&#39;d get that error. (eg if you only had 4 objects and you tried to tell excel to adjust the object 5, it would give you this error)"}, {"owner": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1542205662, "post_id": 53301224, "comment_id": 93485591, "body": "@Marcucciboy2 Thank you for the explanation.I again tried to solve this error by defining another variable as OLEobjects and using Set function. But this gives the same old error as  &quot;Object does not support this property or method&quot;     <code>Set Obvariant = Sheets(&quot;In_Result&quot;).OLEObjects(&quot;OB&quot; &amp; ro &amp; &quot;_&quot; &amp; col).Activate</code>"}, {"owner": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1542206492, "post_id": 53301224, "comment_id": 93486127, "body": "@AhmedAU It leads to an error straight away for using Quotes dude."}, {"owner": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "edited": false, "score": 0, "creation_date": 1542208892, "post_id": 53301224, "comment_id": 93487720, "body": "Thank you again for your interest dude, There comes an Automation Error in turn, stating &quot;items with specified name cannot be found&quot;. I will try to figure it out."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "edited": false, "score": 0, "creation_date": 1542206833, "post_id": 53302410, "comment_id": 93486361, "body": "Hallo @Gadziu, Thank for your answer. I have tried your codes, An error stating &quot;Object Variable or With block variable not Set&quot;. I actually planned to reference each cell in &#39;Int_Result&#39; sheet and access the shape present in the cell. which makes the solution simple. But I have problems with the Syntax with which I can refer each Shape in the sheet."}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "reply_to_user": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "edited": false, "score": 2, "creation_date": 1542206938, "post_id": 53302410, "comment_id": 93486433, "body": "My solution works. You have this error, because you pass as oCell empty object. After you escape from each for loop your oCell is null. You need to remeber it in other object. Solutions above."}, {"owner": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "edited": false, "score": 0, "creation_date": 1542209681, "post_id": 53302410, "comment_id": 93488179, "body": "Hi @Gadziu, It worked really great. I thank you very much for the efforts you have put forth to help me. I still have a small question. In the call statement <code>Call OB2_Click(LastCell)</code> the arguement is <code>LastCell</code>, but when you are opening the subroutine <code>OB2_Click</code> you use oCell. Can you please explain me, how that exactly works? #New to programming dude."}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "reply_to_user": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "edited": false, "score": 1, "creation_date": 1542209844, "post_id": 53302410, "comment_id": 93488279, "body": "I passes <code>LastCell</code> from <code>AddOptionButtons</code>, but in <code>OB2_Click</code> I have <code>oCell as Range</code>, so I need to use <code>oCell</code>"}, {"owner": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "edited": false, "score": 0, "creation_date": 1542209999, "post_id": 53302410, "comment_id": 93488403, "body": "I was thinking that the arguement which we pass in the Call statement and the argument we get in the Subroutine should be same. Learned that, It could also be different. Thank you once again."}], "tags": [], "owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "is_accepted": true, "score": 3, "last_activity_date": 1542210025, "last_edit_date": 1542210025, "creation_date": 1542205381, "answer_id": 53302410, "question_id": 53301224, "link": "https://stackoverflow.com/questions/53301224/how-to-set-an-automatically-generated-option-button-to-true-based-on-the-value/53302410#53302410", "title": "How to set an automatically generated Option Button to &#39;True&#39; based on the value in another range in VBA?", "body": "<p>You need to use  </p>\n\n<pre><code> Sheets(\"Int_Result\").OLEObjects(\"OB2_2\").Object.Value = True\n</code></pre>\n\n<p>Set loop not for shapes, but normal to last row and last column.</p>\n\n<p>So for example:</p>\n\n<pre><code>Dim oCell As Range\nDim LastCell As Range\nFor Each oCell In TargetRange\n    oCell.RowHeight = 20\n    oCell.ColumnWidth = 6\n    Dim oOptionButton As OLEObject\n    Set oOptionButton = TargetRange.Worksheet.OLEObjects.Add(ClassType:=\"Forms.OptionButton.1\", Left:=oCell.Left + 1, Top:=oCell.Top + 1, Width:=15, Height:=18)\n    oOptionButton.Name = \"OB\" &amp; oCell.Row &amp; \"_\" &amp; oCell.Column\n    oOptionButton.Object.GroupName = \"grp\" &amp; oCell.Top\n    Set LastCell = oCell\n\nNext\nCall OB2_Click(LastCell)\n</code></pre>\n\n<hr>\n\n<pre><code>Sub OB2_Click(oCell as Range)\n\nDim col As Long, ro As Long\ndim m as long, k as long\n\ncol = oCell.Column\nro = oCell.Row\n\nFor m = 2 to ro\n    For k = 2 to col\n         If Sheets(\"Final\").Cells(m, k).Value = \"\" Then\n             Sheets(\"Int_Result\").OLEObjects(\"OB\" &amp; m &amp; \"_\" &amp; k).Object.Value = False\n         Else\n             Sheets(\"Int_Result\").OLEObjects(\"OB\" &amp; m &amp; \"_\" &amp; k).Object.Value = True\n         End If\n    Next k\nNext m\nEnd sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 1, "accepted_answer_id": 53302410, "answer_count": 1, "score": 5, "last_activity_date": 1572203901, "creation_date": 1542201675, "last_edit_date": 1572203901, "question_id": 53301224, "link": "https://stackoverflow.com/questions/53301224/how-to-set-an-automatically-generated-option-button-to-true-based-on-the-value", "title": "How to set an automatically generated Option Button to &#39;True&#39; based on the value in another range in VBA?", "body": "<p>I generated radio buttons with the help of the answer to <a href=\"https://stackoverflow.com/questions/53171109/how-to-set-an-automatically-generated-radio-button-to-true-in-vba\">How to set an automatically generated radio button to true in VBA?</a>. </p>\n\n<p>My requirement is to set the automatically generated Option button to 'True' when there is a value <strong>x</strong> in another sheet. </p>\n\n<p>Figure 1: The source to check the value.<br>\n<a href=\"https://i.stack.imgur.com/Sjq2Z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Sjq2Z.jpg\" alt=\"enter image description here\"></a> </p>\n\n<p>Figure 2: The sheet to which the Mark <strong>x</strong> should be reflected as True.<br>\n<a href=\"https://i.stack.imgur.com/bjTWD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bjTWD.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The radio buttons that are generated are as Indexed as OB2_2 for the option button in 2 row and 2 column. </p>\n\n<p>Here is the code </p>\n\n<pre><code>Private Sub AddOptionButtons(ByRef TargetRange As Range)\n\nDim m As Variant\nm = Sheets(\"ALLO\").Range(\"D23\").Value + 1\n\nSheets(\"Final\").Range(\"A2:A\" &amp; m).Copy Destination:=Sheets(\"Int_Result\").Range(\"A2:A\" &amp; m)\n\nDim oCell As Range\nFor Each oCell In TargetRange\n    oCell.RowHeight = 20\n    oCell.ColumnWidth = 6\n    Dim oOptionButton As OLEObject\n    Set oOptionButton = TargetRange.Worksheet.OLEObjects.Add(ClassType:=\"Forms.OptionButton.1\", Left:=oCell.Left + 1, Top:=oCell.Top + 1, Width:=15, Height:=18)\n    oOptionButton.Name = \"OB\" &amp; oCell.row &amp; \"_\" &amp; oCell.Column\n    oOptionButton.Object.GroupName = \"grp\" &amp; oCell.Top\n\nNext\nCall OB2_Click(oCell)\n\nEnd Sub\n\nSub OB2_Click(oCell)\n\nDim col, ro, m As Variant\nDim Shap As Shape\nm = Sheets(\"ALLO\").Range(\"D23\").Value + 1\n\nFor Each Shap In Sheets(\"Int_Result\").Shapes\n    For ro = 2 To m Step 1\n        For col = 1 To 13 Step 1\n            If Sheets(\"Final\").Cells(ro, col).Value = \"\" Then\n               Sheets(\"Int_Result\").Shapes(ro, col).ControlFormat.Value = False\n            Else\n               Sheets(\"Int_Result\").Shapes(ro, col).ControlFormat.Value = True\n            End If\n        Next col\n    Next ro\nNext Shap\n\nEnd Sub\n</code></pre>\n\n<p>I get</p>\n\n<blockquote>\n  <p>\"Object variable or With block variable not set\" or \"Wrong number of arguments or Invalid Property assignment\". </p>\n</blockquote>\n\n<p>on this line</p>\n\n<pre><code>Sheets(\"Int_Result\").Shapes(ro, col).ControlFormat.Value = False \n</code></pre>\n\n<p>How do I access the automatically generated radio buttons?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1542202553, "post_id": 53301221, "comment_id": 93483489, "body": "There is no event that is triggered by the changing of a cell colour, unless that colour is triggered by conditional formatting in which case the Change/Calculate events may come into play."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3495114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b499383d5ff47865d687e4481cecbd3?s=128&d=identicon&r=PG&f=1", "display_name": "Jim77", "link": "https://stackoverflow.com/users/3495114/jim77"}, "edited": false, "score": 0, "creation_date": 1542205913, "post_id": 53301348, "comment_id": 93485748, "body": "Thanks Peh I have modified your code to the below and seems to work well:"}, {"owner": {"reputation": 37, "user_id": 3495114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b499383d5ff47865d687e4481cecbd3?s=128&d=identicon&r=PG&f=1", "display_name": "Jim77", "link": "https://stackoverflow.com/users/3495114/jim77"}, "edited": false, "score": 0, "creation_date": 1542205956, "post_id": 53301348, "comment_id": 93485780, "body": "Private Sub Worksheet_SelectionChange(ByVal     Target As Range)         If Target.Rows.Count + Target.Columns.Count     &gt; 2 Then Exit Sub &#39;exit if     more than one cell is selected         If Target.Column = 1 Then Exit Sub         If Target.Offset(0, -1).Interior.ColorIndex = 44     And Not Left$(Target.Offset(ColumnOffset:=3).Value, 4) = &quot;Done&quot; Then                  y = MsgBox(&quot;Override?&quot;, vbYesNo)                  If y = vbYes Then                      Target.Offset(ColumnOffset:=3).Value = &quot;Done &quot; &amp; Date                  End If     End If End Sub"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 4, "last_activity_date": 1542203532, "last_edit_date": 1542203532, "creation_date": 1542202063, "answer_id": 53301348, "question_id": 53301221, "link": "https://stackoverflow.com/questions/53301221/if-activecell-interior-color-changes-then/53301348#53301348", "title": "If activecell interior color changes then", "body": "<p>You must use <code>Target</code> instead of <code>ActiveCell</code></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Interior.ColorIndex = 44 Then\n        Target.Offset(ColumnOffset:=4).Value = \"Done \" &amp; Date\n    End If\nEnd Sub\n</code></pre>\n\n<p>Note that this cannot check if the color was changed or not as there is no event for that. You can only test if the actual color index is 44. But to prevent overwriting the \"change\" date you can just test if the date already exists.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Rows.Count + Target.Columns.Count &gt; 2 Then Exit Sub 'exit if more than one cell is selected\n\n    If Target.Interior.ColorIndex = 44 And Not Left$(Target.Offset(ColumnOffset:=4).Value, 4) = \"Done\" Then\n        Target.Offset(ColumnOffset:=4).Value = \"Done \" &amp; Date\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3495114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b499383d5ff47865d687e4481cecbd3?s=128&d=identicon&r=PG&f=1", "display_name": "Jim77", "link": "https://stackoverflow.com/users/3495114/jim77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 53301348, "answer_count": 1, "score": 1, "last_activity_date": 1586392569, "creation_date": 1542201669, "last_edit_date": 1586392569, "question_id": 53301221, "link": "https://stackoverflow.com/questions/53301221/if-activecell-interior-color-changes-then", "title": "If activecell interior color changes then", "body": "<p>I want the following VBA code:</p>\n\n<p>If the activecell interior color changes to colorindex 44 then I want the cell five columns to the right to have the text \"Done\" and today's date.</p>\n\n<p>I have tried the below but only works when I move the selected cell to the right. It also does not stop working when a cell color is NOT changed.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange  (ByVal Target As Range)\n\n   If ActiveCell.Offset(0, -1).Interior.ColorIndex = 44 Then\n        ActiveCell.Offset(0, 4) = \"Done\" &amp; Date\n   End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "object", "vbscript"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1542202994, "post_id": 53301122, "comment_id": 93483792, "body": "To merge the lists you will need to loop."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1542204582, "post_id": 53301122, "comment_id": 93484882, "body": "@xLokos VBA or VBScript which is it?"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "reply_to_user": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1542234924, "post_id": 53301122, "comment_id": 93500349, "body": "@Lankymart In this particular case I don&#39;t think it makes a difference."}], "answers": [{"tags": [], "owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "is_accepted": true, "score": 3, "last_activity_date": 1542203330, "creation_date": 1542203330, "answer_id": 53301768, "question_id": 53301122, "link": "https://stackoverflow.com/questions/53301122/grouping-objects-in-vba/53301768#53301768", "title": "Grouping objects in VBA", "body": "<p>What you're asking is not possible with <code>FileSystemObject</code> methods alone. Even if you created a single array or ArrayList from the elements of <code>oFolder.Files</code> and <code>oFolder.SubFolders</code> you'd need two individual loops to do so.</p>\n\n<p>You could use the <code>Shell.Application</code> object for enumerating folder content, but the resulting objects don't have a delete method, so you'd still need <code>FileSystemObject</code> objects and methods for deleting the files/folders:</p>\n\n<pre><code>path = \"C:\\some\\folder\"\n\nSet app = CreateObject(\"Shell.Application\")\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nFor Each it In app.NameSpace(path).Items\n    If it.IsFolder Then\n        fso.GetFolder(it.Path).Delete\n    Else\n        fso.GetFile(it.Path).Delete\n    End If\nNext\n</code></pre>\n\n<p>However, I fail to see a significant advantage of this approach over using just <code>FileSystemObject</code> methods and looping twice. If you're concerned about duplicating code just wrap the loop in a procedure and call that procedure for both subfolders and files.</p>\n\n<pre><code>path = \"C:\\some\\folder\"\n\nSub DeleteItems(list)\n    For Each it In list\n        it.Delete\n    Next\nEnd Sub\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet oFolder = fso.GetFolder(path)\n\nDeleteItems oFolder.Files\nDeleteItems oFolder.SubFolders\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 3235546, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000935886222/picture?type=large", "display_name": "xLokos", "link": "https://stackoverflow.com/users/3235546/xlokos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 53301768, "answer_count": 1, "score": 0, "last_activity_date": 1586392589, "creation_date": 1542201314, "last_edit_date": 1586392589, "question_id": 53301122, "link": "https://stackoverflow.com/questions/53301122/grouping-objects-in-vba", "title": "Grouping objects in VBA", "body": "<p>I am trying to group two object into one list to be iterated in one 'for each' loop. Is it even possible in VBA/VBscript?</p>\n\n<p>For example I would like to delete all files <strong>and</strong> folders from a specific location basing on last mod. date and I don't want to create two loops. </p>\n\n<pre><code>Set oFolder = fso.GetFolder(FolderPath)\nSet oFileList = oFolder.Files\nSet oFolderList = oFolder.SubFolders\nSet oFullList = oFileList + oFolderList (???)\n\nFor Each oFile In oFullList \n    lastModDate = oFile.DateLastModified\n    If (lastModDate &lt; PurgeDate) Then\n        oFile.Delete True\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1542202432, "post_id": 53301071, "comment_id": 93483411, "body": "You may want to take a look at the different answers <a href=\"https://stackoverflow.com/questions/6688131/test-or-check-if-sheet-exists#6688482\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 4490825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSBA4.jpg?s=128&g=1", "display_name": "UnknownError", "link": "https://stackoverflow.com/users/4490825/unknownerror"}, "edited": false, "score": 0, "creation_date": 1542225099, "post_id": 53303458, "comment_id": 93496175, "body": "Thank you for all the feedback, I will certainly take on board all those comments. I will be working back through the code based on the above and will confirm back the results."}, {"owner": {"reputation": 83, "user_id": 4490825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSBA4.jpg?s=128&g=1", "display_name": "UnknownError", "link": "https://stackoverflow.com/users/4490825/unknownerror"}, "edited": false, "score": 0, "creation_date": 1542270459, "post_id": 53303458, "comment_id": 93510494, "body": "Hello. I have found another issue whilst looking at your changes. Before I finish them I need to make an additional correction. The sheet number I am referencing was coming from the number and not the name as I wanted to ensure even if it renamed it didnt start falling over. But it is treating it an an index number and not codename which also means if tabs re-ordered permissions would change. Are there any suggestions as to how I use codename in those cells but still show the tab name (for reference) so that users know which sheet is what when setting permissions?"}], "tags": [], "owner": {"reputation": 381, "user_id": 10645669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0835999bc1f9616fc3ff8b3ca7b0e3a0?s=128&d=identicon&r=PG&f=1", "display_name": "GTPV", "link": "https://stackoverflow.com/users/10645669/gtpv"}, "is_accepted": true, "score": 0, "last_activity_date": 1542209224, "last_edit_date": 1542209224, "creation_date": 1542208813, "answer_id": 53303458, "question_id": 53301071, "link": "https://stackoverflow.com/questions/53301071/checking-existence-of-sheets-and-hiding-un-hiding-based-on-cell-values/53303458#53303458", "title": "Checking existence of sheets and hiding / un-hiding based on cell values", "body": "<p>There are a few errors in your code. One things that I would do to avoid confusion would be to use a different iterator within your for loop. Instead of</p>\n\n<pre><code>For Each Cell In Range(\"B\" &amp; lRow &amp; \":GS\" &amp; lRow)\n</code></pre>\n\n<p>I would use</p>\n\n<pre><code>For Each currentCell In Range(\"B\" &amp; lRow &amp; \":GS\" &amp; lRow)\n</code></pre>\n\n<p>This would avoid the first error that I noted:</p>\n\n<pre><code>shtloc = Cell(2, ActiveCell.Column).Value\n</code></pre>\n\n<p>This line will not return what you want. First, you need an \"s\" at the end of \"Cell\". Second, your sheets names are on row 1, third, your code is not clear on which cell is currently activated, this could return strange behaviours. Try instead to replace it by:</p>\n\n<pre><code>shtloc = Cells(1, currentCell.Column).Value\n</code></pre>\n\n<p>Now your main error is that you try to check if the sheet exists by triggering an error. This generates your out of range error.</p>\n\n<p>Instead you should use a different function to check if the read sheet name exists or not. This answer provides exactly what you want</p>\n\n<p><a href=\"https://stackoverflow.com/a/6040454/10645669\">https://stackoverflow.com/a/6040454/10645669</a></p>\n\n<blockquote>\n  <p><code>Function sheetExists(sheetToFind As String) As Boolean\n      sheetExists = False\n      For Each sheet In Worksheets\n          If sheetToFind = sheet.name Then\n              sheetExists = True\n              Exit Function\n          End If\n      Next sheet\n  End Function</code></p>\n</blockquote>\n\n<hr>\n\n<p>On a different note, it seems to me that you are using global variables because you are not properly returning values out of your functions. For instance</p>\n\n<pre><code>Function wsExists(wsSheet As Worksheet)\nOn Error Resume Next\nOn Error GoTo 0\nIf Not wsSheet Is Nothing Then\nwsStatus = \"True\"\nElse\nwsStatus = \"False\"\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Can be written:</p>\n\n<pre><code>Function wsExists(wsSheet As Worksheet) as boolean\nOn Error Resume Next\nOn Error GoTo 0\nIf Not wsSheet Is Nothing Then\nwsExists = \"True\"\nElse\nwsExists = \"False\"\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>This allows you to use the function directly in your code like so:</p>\n\n<pre><code>If wsExists(Sheets(shtloc)) = False Then\n</code></pre>\n\n<p>No more global variable, and no more use of the keyword call. </p>\n\n<p>Also, as a rule of thumb, if the written code does not return anything, then it should be a \"sub\". These can be called without the keyword call by just stating the arguments without brackets. Example:</p>\n\n<pre><code>subCalled argument1, argument2, argumentN\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 4490825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSBA4.jpg?s=128&g=1", "display_name": "UnknownError", "link": "https://stackoverflow.com/users/4490825/unknownerror"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 53303458, "answer_count": 1, "score": 1, "last_activity_date": 1542808076, "creation_date": 1542201163, "last_edit_date": 1542808076, "question_id": 53301071, "link": "https://stackoverflow.com/questions/53301071/checking-existence-of-sheets-and-hiding-un-hiding-based-on-cell-values", "title": "Checking existence of sheets and hiding / un-hiding based on cell values", "body": "<p>I am very much an amateur at this!! Currently I have a worksheet which will have a list of users going down and then a list of sheet names / numbers going across</p>\n\n<p>The overall expectation is that if the user has a 1 in the cell under the sheet then the sheet is visible, otherwise the sheet should be very hidden</p>\n\n<p>This code is in module 1 although not sure if it should be at workbook level instead. </p>\n\n<p>I declare the following outside of the functions so they can be called within each;</p>\n\n<pre><code>Dim lRow As Long, wsStatus As Boolean, shtloc As Integer\n</code></pre>\n\n<p>Then this is my main function (which maybe should be a sub at workbook level, not sure)</p>\n\n<pre><code>    Function CheckSheetPermission()\n\nSheet9.Visible = xlSheetVisible\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Welcome\" Then ws.Visible = xlSheetVeryHidden\nNext ws\nSheet12.Visible = xlSheetVisible\nSheet12.Activate\nWith ActiveSheet\nDim sht As Worksheet\nCall GetRowNum(Range(\"A3:A200\"), LCase(Environ(\"UserName\")))\n    For Each Cell In Range(\"B\" &amp; lRow &amp; \":GS\" &amp; lRow)\n    If Abs(Cell.Value) = \"1\" Then\n        shtloc = Cell(2, ActiveCell.Column).Value\n        Call wsExists(Sheets(shtloc))\n        If wsStatus = False Then\n            Sheets(shtloc).Visible = xlSheetVisible\n        End If\n    Else\n        shtloc = Cell(2, ActiveCell.Column).Value\n         Call wsExists(Sheets(shtloc))\n        If wsStatus = False Then\n            Sheets(shtloc).Visible = xlSheetVeryHidden\n        End If\n    End If\n    Next\nEnd With\nEnd Function\n</code></pre>\n\n<p>This looks at the sheet below, it is initially meant to make sure both welcome and sheet 1 are temp visible until the code has executed which then sets the correct visibility for all sheets (I assume the sheet has to be visible for the code to read the cells)</p>\n\n<p><strong>image of worksheet</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/SMDGo.png\" alt=\"\"></p>\n\n<p>Get row number simply looks up the user and gets the row number</p>\n\n<pre><code>Call GetRowNum(Range(\"A3:A200\"), LCase(Environ(\"UserName\")))\n</code></pre>\n\n<p>And that function code is </p>\n\n<pre><code>Function GetRowNum(rng As Range, user As String)\n\n\n    On Error Resume Next\n    lRow = Application.WorksheetFunction.Match(user, rng, 0) + 2\n    On Error GoTo 0\n\n\nEnd Function\n</code></pre>\n\n<p>Where it seems to be going wrong currently is when I call the next function;</p>\n\n<pre><code>Call wsExists(Sheets(shtloc))\n</code></pre>\n\n<p>I get the subscript out of range error. Which might be because of the variable before not being set properly or the function itself I am calling but I am not sure where best to start amending code and checking results to further isolate the issue</p>\n\n<p>Limited error handling at this stage as trying to trap errors. if I add error handling to the main function it just passes through and no sheets are hidden or visible other than those set at the start (sheet control and welcome)</p>\n\n<pre><code>Function wsExists(wsSheet As Worksheet)\nOn Error Resume Next\nOn Error GoTo 0\nIf Not wsSheet Is Nothing Then\nwsStatus = \"True\"\nElse\nwsStatus = \"False\"\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Please let me know if you need more information. </p>\n\n<p>Simply what I am trying to achieve is the following steps;</p>\n\n<ol>\n<li>Check which sheets should be visible to the user opening the file through a loop</li>\n<li>Loop through each of the sheet numbers if they exist using the sheet number variable in conjunction with the 0/1 value under the row next to the user name and set sheet visibility(1 = allowed.0 = not allowed)</li>\n</ol>\n\n<p>I will admit that perhaps this may be a lot better scripted for those who have better understanding</p>\n\n###EDIT\n\n<p>Final code after suggested improvements and some additional changes after I found some extra bugs</p>\n\n<p>Thisworkbook</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim ws As Worksheet\nDim shtloc As String\nDim c As Long\nDim lRow2 As Long\nSheet9.Visible = xlSheetVisible\n\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Welcome\" Then ws.Visible = xlSheetVeryHidden\nNext ws\nSheet12.Visible = xlSheetVisible\nSheet12.Activate\nWith Sheet12\n    lRow2 = Module2.lRow2(Range(\"A3:A5\"), LCase(Environ(\"UserName\")))\n\n\n        For c = 2 To ActiveWorkbook.Worksheets.Count + 1\n        shtloc = Cells(1, c).Value2\n             With Cells(lRow2, c)\n             perm = Cells(lRow2, c).Value2\n                Select Case perm\n                    Case (\"V\")\n                    'Visible\n                        Sheets(shtloc).Visible = xlSheetVisible\n                    Case (\"P\")\n                    'visible protected\n                        Sheets(shtloc).Visible = xlSheetVeryHidden\n                        Sheets(shtloc).Protect Password:=\"*********\"\n                    Case (\"D\")\n                    'Access denied\n                        Sheets(shtloc).Visible = xlSheetVeryHidden\n                    End Select\n             End With\n        Next c\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Module</p>\n\n<pre><code>Function lRow2(rng As Range, user As String)\n\n    On Error Resume Next\n    With ActiveSheet\n    lRow2 = Application.WorksheetFunction.Match(user, rng, 0)\n\n    lRow2 = lRow2 + 2\n\n    End With\nEnd Function\n</code></pre>\n\n<p>I no longer check if the sheets exist either as I do a count of sheets and don't carry on the next loop to the blank cells which await new sheet creations to be populated...speeding up the code as well</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 49, "user_id": 3477744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b597598acf2e79b73f5228776f62335?s=128&d=identicon&r=PG&f=1", "display_name": "mcNogard", "link": "https://stackoverflow.com/users/3477744/mcnogard"}, "reply_to_user": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1542201032, "post_id": 53300942, "comment_id": 93482478, "body": "Yes, I have Module1 and Module2. This code is in module2."}, {"owner": {"reputation": 49, "user_id": 3477744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b597598acf2e79b73f5228776f62335?s=128&d=identicon&r=PG&f=1", "display_name": "mcNogard", "link": "https://stackoverflow.com/users/3477744/mcnogard"}, "edited": false, "score": 0, "creation_date": 1542202569, "post_id": 53300942, "comment_id": 93483497, "body": "When I come to think about it, it is not a message, but rather the assignment Cells(2,1)=&quot;updated?&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1542201578, "post_id": 53301088, "comment_id": 93482845, "body": "Write Application.EnableEvents =False at the beginning of your code and then turn it back on before End sub.You might have some other code at worksheet level which might be causing this message to show up."}, {"owner": {"reputation": 49, "user_id": 3477744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b597598acf2e79b73f5228776f62335?s=128&d=identicon&r=PG&f=1", "display_name": "mcNogard", "link": "https://stackoverflow.com/users/3477744/mcnogard"}, "edited": false, "score": 0, "creation_date": 1542202224, "post_id": 53301088, "comment_id": 93483268, "body": "So your answer made the &quot;With from End With&quot; part work. But it stops at towards.Cells(7,1), initially I got the message Cells(7,1)=&quot;updated?&quot; when hovering over this. Now it only sais lastRowIndex =56 independent on where I click and hover my mouse."}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 1, "creation_date": 1542202921, "post_id": 53301088, "comment_id": 93483740, "body": "what is the content of  from.cells(2,1) ?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1542202947, "post_id": 53301088, "comment_id": 93483758, "body": "&quot;Updated&quot; is the value held in cell <code>A2</code> of the currently <code>Activesheet</code>.   @h2so4 said correctly to put the <code>.</code> before <code>Cells(2,1)</code> as without it Cells references the activesheet and not the sheet used in the <code>From</code> keyword."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 3, "creation_date": 1542203042, "post_id": 53301088, "comment_id": 93483821, "body": "The reason for the runtime error is that <code>.Range</code> is looking at the <code>From</code> worksheet and <code>Cells</code> is looking at the <code>ActiveSheet</code>.  If these are the same, then no problem but if they&#39;re different you&#39;re trying to make a range on one sheet using cells from a different sheet."}, {"owner": {"reputation": 49, "user_id": 3477744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b597598acf2e79b73f5228776f62335?s=128&d=identicon&r=PG&f=1", "display_name": "mcNogard", "link": "https://stackoverflow.com/users/3477744/mcnogard"}, "edited": false, "score": 0, "creation_date": 1542203203, "post_id": 53301088, "comment_id": 93483932, "body": "Yes, the debugger stops at that line, marking it yellow. I get <i>Run time errror 438. Object doesn&#39;t support this property or method.</i> I guess this message comes because vba can not paste a selection given a single cell as output."}, {"owner": {"reputation": 49, "user_id": 3477744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b597598acf2e79b73f5228776f62335?s=128&d=identicon&r=PG&f=1", "display_name": "mcNogard", "link": "https://stackoverflow.com/users/3477744/mcnogard"}, "edited": false, "score": 0, "creation_date": 1542203595, "post_id": 53301088, "comment_id": 93484213, "body": "Value of Cells(2,1) is updated? Okay, now I understand."}], "tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": true, "score": 1, "last_activity_date": 1542201214, "creation_date": 1542201214, "answer_id": 53301088, "question_id": 53300942, "link": "https://stackoverflow.com/questions/53300942/meaning-of-updated-message-in-debug-mode/53301088#53301088", "title": "Meaning of &quot;Updated?&quot; message in debug mode", "body": "<p>replace your instruction</p>\n\n<pre><code>.Range(Cells(2, 1), Cells(lastRowIndex, 4)).Copy\n</code></pre>\n\n<p>with</p>\n\n<pre><code>Range(.Cells(2, 1), .Cells(lastRowIndex, 4)).Copy\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 3477744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b597598acf2e79b73f5228776f62335?s=128&d=identicon&r=PG&f=1", "display_name": "mcNogard", "link": "https://stackoverflow.com/users/3477744/mcnogard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 53301088, "answer_count": 1, "score": 0, "last_activity_date": 1586394264, "creation_date": 1542200760, "last_edit_date": 1586394264, "question_id": 53300942, "link": "https://stackoverflow.com/questions/53300942/meaning-of-updated-message-in-debug-mode", "title": "Meaning of &quot;Updated?&quot; message in debug mode", "body": "<pre><code>Sub update_button()\n'\n' update_button Makro\n'\n\n'\n\nSet from = Sheet1\nSet towards = Sheet5\n\nWith from\n    lastRowIndex = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    .Range(Cells(2, 1), Cells(lastRowIndex, 4)).Copy\nEnd With\ntowards.Cells(7, 1).Paste\n\nEnd Sub\n</code></pre>\n\n<p>This code is supposed to copy cells between A2 and the last row in the first sheet. Then paste it into a specific cell in another sheet. Running this code gives me Runtime error 1004. Application defined or object defined error. </p>\n\n<p>By going into debug mode, and hovering over Cells(2,1), A message comes up saying Cells(2,1)=\"Updated?\". From what I can see, Cells(2,1) is well defined and there should be no issue with it. I am unable to search anything about it given how generic the name is. </p>\n\n<p>Note that I have a non-english version of excel and I have translated a few words to make the code slightly less confusing. </p>\n"}, {"tags": ["excel", "vba", "pivot", "excel-pivot"], "comments": [{"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1542201213, "post_id": 53300916, "comment_id": 93482593, "body": "What is C77 ? why do you want to use it ? Remove if not required and you will not get this error."}, {"owner": {"reputation": 43, "user_id": 7895648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe4f4366f256cad6df305715ebdde42?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh", "link": "https://stackoverflow.com/users/7895648/leigh"}, "reply_to_user": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1542201305, "post_id": 53300916, "comment_id": 93482655, "body": "Column 77 will always be the last column within the data range as the number of columns will always remain the same."}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1542201439, "post_id": 53300916, "comment_id": 93482742, "body": "So ideally what should be the range ? can you give one example let say if the lastrow is 5 then what should be your srcdata ?"}, {"owner": {"reputation": 43, "user_id": 7895648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe4f4366f256cad6df305715ebdde42?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh", "link": "https://stackoverflow.com/users/7895648/leigh"}, "reply_to_user": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1542201545, "post_id": 53300916, "comment_id": 93482822, "body": "Then I think it should be SrcData = Sheet1!R1C1:R5C77"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 2, "creation_date": 1542201893, "post_id": 53300916, "comment_id": 93483066, "body": "You are getting confused between R1C1 and A1 styles , you just need this part in your code Range(&quot;A1:R&quot; &amp; lastRow) , e.g. if lastrow =5 then this will be A1:R5 which is R1C1:R5C18."}, {"owner": {"reputation": 43, "user_id": 7895648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe4f4366f256cad6df305715ebdde42?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh", "link": "https://stackoverflow.com/users/7895648/leigh"}, "reply_to_user": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1542202313, "post_id": 53300916, "comment_id": 93483311, "body": "Thank you, I have amended the code as suggested. That part works but it is now throwing up an error with the StartPvt range. I am assuming it is a similar issue with the style and that something needs to be added to &quot;A3&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1586313928, "creation_date": 1586313928, "answer_id": 61092542, "question_id": 53300916, "link": "https://stackoverflow.com/questions/53300916/excel-vba-macro-create-pivot-table-with-dynamic-data-range-source-data-range-er/61092542#61092542", "title": "Excel VBA Macro Create Pivot Table with Dynamic Data Range: Source Data Range Error", "body": "<p>You can turn on the Macro Recorder, then click anywhere in your dataset and Excel will automatically select the last used column and last used row in that dataset, just before creating a Pivot Table.  Try it and you will see.  If you want to use VBA to dynamically select the last row and dynamically select the last column, and check out the code below. </p>\n\n<p>Ways To Find The Last Row</p>\n\n<pre><code>Sub FindingLastRow()\n'PURPOSE: Different ways to find the last row number of a range\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim sht As Worksheet\nDim LastRow As Long\n\nSet sht = ActiveSheet\n\n'Using Find Function (Provided by Bob Ulmas)\n  LastRow = sht.Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\n\n'Using SpecialCells Function\n  LastRow = sht.Cells.SpecialCells(xlCellTypeLastCell).Row\n\n'Ctrl + Shift + End\n  LastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\n'Using UsedRange\n  sht.UsedRange 'Refresh UsedRange\n  LastRow = sht.UsedRange.Rows(sht.UsedRange.Rows.Count).Row\n\n'Using Table Range\n  LastRow = sht.ListObjects(\"Table1\").Range.Rows.Count\n\n'Using Named Range\n  LastRow = sht.Range(\"MyNamedRange\").Rows.Count\n\n'Ctrl + Shift + Down (Range should be first cell in data set)\n  LastRow = sht.Range(\"A1\").CurrentRegion.Rows.Count\n\nEnd Sub\n</code></pre>\n\n<p>Ways To Find The Last Column:</p>\n\n<pre><code>Sub FindingLastColumn()\n\n'PURPOSE: Different ways to find the last column number of a range\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim sht As Worksheet\nDim LastColumn As Long\n\nSet sht = ThisWorkbook.Worksheets(\"Sheet1\")\n\n'Ctrl + Shift + End\n  LastColumn = sht.Cells(7, sht.Columns.Count).End(xlToLeft).Column\n\n'Using UsedRange\n  sht.UsedRange 'Refresh UsedRange\n  LastColumn = sht.UsedRange.Columns(sht.UsedRange.Columns.Count).Column\n\n'Using Table Range\n  LastColumn = sht.ListObjects(\"Table1\").Range.Columns.Count\n\n'Using Named Range\n  LastColumn = sht.Range(\"MyNamedRange\").Columns.Count\n\n'Ctrl + Shift + Right (Range should be first cell in data set)\n  LastColumn = sht.Range(\"A1\").CurrentRegion.Columns.Count\n\nEnd Sub\n</code></pre>\n\n<p>You can easily incorporate this into the code you already have. </p>\n"}], "owner": {"reputation": 43, "user_id": 7895648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe4f4366f256cad6df305715ebdde42?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh", "link": "https://stackoverflow.com/users/7895648/leigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 941, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586394300, "creation_date": 1542200651, "last_edit_date": 1592644375, "question_id": 53300916, "link": "https://stackoverflow.com/questions/53300916/excel-vba-macro-create-pivot-table-with-dynamic-data-range-source-data-range-er", "title": "Excel VBA Macro Create Pivot Table with Dynamic Data Range: Source Data Range Error", "body": "<p>I am new to VBA coding and trying to create an Excel macro which will create a pivot table based on a dynamic data range. I am using Excel 2016.</p>\n<p>The number of columns in the data will remain the same but the number of rows is dynamic.</p>\n<p>In my data worksheet, column BZ contains a count of how many records are in the dataset. E.g. If there are 30 records in the dataset, every value in column BZ will be 30. (This data is imported from SAS using DDE which is why I have chosen this method). I have therefore added 1 onto the lastRow variable below to include column names.</p>\n<p>My VBA Macro code is currently as follows:</p>\n<pre><code>Sub Macro1()\n   Dim xlsPath As String\n   Dim xlsFile As String\n   Dim lastRow As Integer\n   Dim SrcData As String\n   Dim StartPvt As String\n   Dim pvtCache As PivotCache\n   Dim pvt As PivotTable\n\n   xlsxPath = &quot;N:\\Analytics\\Test\\DDE\\&quot;\n   xlsxFile = &quot;Test.xlsx&quot;\n\n   lastRow = Sheets(1).Range(&quot;BZ2&quot;) + 1\n\n   SrcData = ActiveSheet.Name &amp; &quot;!&quot; &amp; Range(&quot;A1:R&quot; &amp; lastRow &amp; &quot;C77&quot;).Address(ReferenceStyle:=xlR1C1)\n\n   StartPvt = sht.Name &amp; &quot;!&quot; &amp; sht.Range(&quot;A3&quot;).Address(ReferenceStyle:=xlR1C1)\n\n   Workbooks.Open Filename:=xlsxPath &amp; xlsxFile\n\n   Range(&quot;A1:BY&quot; &amp; lastRow).Select\n\n   Sheets.Add\n\n   Set pvtCache = ActiveWorkbook.PivotCaches.Create( _\n   SourceType:=xlDatabase, _\n   SourceData:=SrcData, Version:=6)\n\n   Set pvt = pvtCache.CreatePivotTable( _\n   TableDestination:=StartPvt, _\n   TableName:=&quot;PivotTable1&quot;, DefaultVersion:=6)\n\n   Columns(&quot;BZ:BZ&quot;).Select\n   Selection.Delete Shift:=xlToLeft\n   ActiveWorkbook.Save\n   ActiveWorkbook.Close\nEnd Sub\n</code></pre>\n<p>This produces an error which says:</p>\n<blockquote>\n<p>Run-time error '1004':</p>\n<p>Method 'Range' of 'object'_Global' failed</p>\n</blockquote>\n<p>The debugger points to the line where the SrcData range is determined. I think the issue may be syntax, where I have specified the lastRow within Range.</p>\n<p>A solution for this line of code, or any other helpful comments would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1542199848, "post_id": 53300628, "comment_id": 93481802, "body": "I bet you could have a shape anchored at the corner of the cell with today\u2019s date. Wish I could take a crack at this one"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1542200012, "post_id": 53300628, "comment_id": 93481902, "body": "Does it have to be a circle, or could you use <i>.Borders.LineStyle = xlContinuous</i>?"}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1542202380, "post_id": 53300972, "comment_id": 93483363, "body": "Just a thought (not looked at improving the maths on it) - change the Top, Left, Height and Width to: <code>.Top = cell.Top - (cell.Offset(-1).Height &#47; 2)</code>, <code>.Left = cell.Left - (cell.Offset(, -1).Width &#47; 4)</code>, <code>.Height = cell.Height + (cell.Offset(-1).Height &#47; 2) + (cell.Offset(1).Height &#47; 2)</code>, <code>.Width = cell.Width + (cell.Offset(, -1).Width &#47; 4) + (cell.Offset(, 1).Width &#47; 4)</code> so the circle extends into the neighbouring cells."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1542206974, "post_id": 53300972, "comment_id": 93486454, "body": "I believe you can avoid the <code>select</code> part of your code by just trimming down to <code>With circ  .ShapeRange. ...</code>"}], "tags": [], "owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "is_accepted": false, "score": 3, "last_activity_date": 1542207056, "last_edit_date": 1542207056, "creation_date": 1542200859, "answer_id": 53300972, "question_id": 53300628, "link": "https://stackoverflow.com/questions/53300628/is-it-possible-to-have-excel-circle-the-cell-that-contains-todays-date/53300972#53300972", "title": "Is it possible to have excel circle the cell that contains today&#39;s date?", "body": "<p>This will draw an oval round today's date. If today's date is not found, an error message will be shown:</p>\n\n<pre><code>Sub DrawOval()\n    Dim cell As Range, circ As Shape\n\n    Set cell = Sheet1.Cells.Find(Date, Sheet1.Range(\"A1\"))\n\n    If Not cell Is Nothing Then\n        Set circ = Sheet1.Shapes.AddShape(msoShapeOval, 187.8, 37.2, 63.6, 24)\n        With circ\n            .Select\n            Selection.ShapeRange.Fill.Visible = msoFalse\n            .Top = cell.Top\n            .Left = cell.Left\n        End With\n\n    Else\n        MsgBox \"Cell with today's date not found!\", vbCritical + vbOKOnly, \"Error\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This assumes your worksheet name is <code>Sheet1</code>, so amend that accordingly. You can run this by adding a shape to your worksheet, and assigning this macro to it.</p>\n"}], "owner": {"reputation": 9, "user_id": 10652020, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tqTVxjTV_P4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDUgNbx52-5Hluy4uRGvQVLwGgB_g/mo/photo.jpg?sz=128", "display_name": "Sam Collins", "link": "https://stackoverflow.com/users/10652020/sam-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586394336, "creation_date": 1542199710, "last_edit_date": 1586394336, "question_id": 53300628, "link": "https://stackoverflow.com/questions/53300628/is-it-possible-to-have-excel-circle-the-cell-that-contains-todays-date", "title": "Is it possible to have excel circle the cell that contains today&#39;s date?", "body": "<p>I have a big calendar spreadsheet that currently just highlights today's date with conditional formatting. However, I do not like any of the formats I could possibly apply and so I would love to be able to have something whereby a circle is drawn over the top of the cell with today's date in. </p>\n\n<p>The way each day is laid out is so that (for example) A1 is the date itself in \"dd\" format and then A2 has the information in. The information is pulled through from an event data list so it has a formula in. </p>\n\n<p>I have seen some stuff on this being possible with a VBA code but I am just not sure how to write that.</p>\n\n<p>Thank you\nSam</p>\n"}, {"tags": ["excel", "vba", "parsing"], "answers": [{"comments": [{"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1542209880, "post_id": 53300523, "comment_id": 93488303, "body": "so you find a solution for your problem or is there some remaining issues ? if yes which ones ?"}, {"owner": {"reputation": 238, "user_id": 6822528, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9qdwoKJelAI/AAAAAAAAAAI/AAAAAAAAADY/n0BjP2CuCZQ/photo.jpg?sz=128", "display_name": "Malan Kriel", "link": "https://stackoverflow.com/users/6822528/malan-kriel"}, "reply_to_user": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 1, "creation_date": 1542268037, "post_id": 53300523, "comment_id": 93509320, "body": "@h2so4 I am happy with my solution and wanted to share that to the community (given I couldn&#39;t find another solution online). If other can improve on this it would also be great (for example, it might be cleaner if you don&#39;t need to use a <code>class module</code>?"}], "tags": [], "owner": {"reputation": 238, "user_id": 6822528, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9qdwoKJelAI/AAAAAAAAAAI/AAAAAAAAADY/n0BjP2CuCZQ/photo.jpg?sz=128", "display_name": "Malan Kriel", "link": "https://stackoverflow.com/users/6822528/malan-kriel"}, "is_accepted": true, "score": 1, "last_activity_date": 1542199404, "creation_date": 1542199404, "answer_id": 53300523, "question_id": 53300522, "link": "https://stackoverflow.com/questions/53300522/parse-excel-formula-string-into-preceding-string-the-function-arguments-and-p/53300523#53300523", "title": "Parse Excel formula string into preceding string, the function, arguments, and post function string in VBA", "body": "<p>In my solution, I create a <code>Class module</code> with the properties I require a formula string to be split into called <code>ExcelFormulaParser</code>:</p>\n\n<pre><code>Option Explicit\n\nPublic ExcelFn As String\nPublic Arguments As New Collection\nPublic preFunctionStr As String\nPublic postFunctionStr As String\n\nSub SetMeUp(formulaStr As String, FormulaToParse As String)\n\n    Dim FormulaStartPos As Integer\n    Dim OpenBracketCounter As Integer\n    Dim OpenBracketCount As Integer\n    Dim ClosedBracketCount As Integer\n    Dim WithinQuote As Boolean\n        ' whether we are within quotation marks\n    Dim i As Integer\n\n    Dim strChr As String\n    Dim Arg_i As String\n    Dim Arg As String\n\n    Me.ExcelFn = FormulaToParse\n\n    FormulaStartPos = InStr(1, formulaStr, FormulaToParse)\n\n    Me.preFunctionStr = Mid(formulaStr, 1, FormulaStartPos - 1)\n    formulaStr = Mid(formulaStr, FormulaStartPos + Len(FormulaToParse), Len(formulaStr) - Len(FormulaToParse))\n\n    If Left(formulaStr, 1) = \"(\" Then\n        OpenBracketCounter = 1\n        formulaStr = Mid(formulaStr, 2, Len(formulaStr) - 1)\n    Else\n        MsgBox (\"Not the full FormulaToParse\")\n        End\n    End If\n\n    i = 0\n    Arg_i = \"\"\n    Do While OpenBracketCounter &gt; 0\n        i = i + 1\n        strChr = Left(formulaStr, 1)\n        If Len(formulaStr) &gt; 0 Then\n            formulaStr = Right(formulaStr, Len(formulaStr) - 1)\n        End If\n\n        If strChr = Chr(34) Then\n            WithinQuote = Not (WithinQuote) ' toggle WithinQuote on or off\n            ' don't count brackets within quotation marks\n        ElseIf strChr = \"(\" And WithinQuote = False Then\n            OpenBracketCounter = OpenBracketCounter + 1\n        ElseIf strChr = \")\" And WithinQuote = False Then\n            OpenBracketCounter = OpenBracketCounter - 1\n        End If\n\n        If OpenBracketCounter = 1 And strChr = \",\" Then\n            Arg = Arg_i\n            Me.Arguments.Add Arg\n            Arg_i = \"\"\n        ElseIf OpenBracketCounter = 0 Then\n            Arg = Arg_i\n            Me.Arguments.Add Arg\n            Arg_i = \"\"\n            Me.postFunctionStr = formulaStr\n        Else\n            Arg_i = Arg_i &amp; strChr\n        End If\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>To provide an example of how to call and use the <code>Class module</code>, I created the following Module within the same VBA Project:</p>\n\n<pre><code>Sub TestFormulaParser()\n\n    Dim ParsedForm As ExcelFormulaParser\n    Set ParsedForm = New ExcelFormulaParser\n    Dim StrToParse As String\n    StrToParse = ActiveCell.Formula\n        ' formula contains:\n        '' =A4+VLOOKUP(2,$E$4:$F$8,MATCH(\"Value(1)\",$E$4:$F$4,0),0) + 2000\n    Call ParsedForm.SetMeUp(StrToParse, \"VLOOKUP\")\n\n    preFunctionStr = ParsedForm.preFunctionStr\n        ' returns the prefunction string i.e. =A4+\n    ExcelFn = ParsedForm.ExcelFn\n        ' returns the excel function we parsed i.e. VLOOKUP\n    Arg1 = ParsedForm.Arguments(1)\n        ' returns the first argument of the VLOOKUP function i.e. 2\n    Arg2 = ParsedForm.Arguments(2)\n        ' returns the second argument of the VLOOKUP function i.e. $E$4:$F$8\n    Arg3 = ParsedForm.Arguments(3)\n        ' returns the third argument of the VLOOKUP function i.e. MATCH(\"Value(1)\",$E$4:$F$4,0)\n    Arg4 = ParsedForm.Arguments(4)\n        ' returns the fourth argument of the VLOOKUP function i.e. 0\n    postFunctionStr = ParsedForm.postFunctionStr\n        ' returns the post function string i.e.  + 2000\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 238, "user_id": 6822528, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9qdwoKJelAI/AAAAAAAAAAI/AAAAAAAAADY/n0BjP2CuCZQ/photo.jpg?sz=128", "display_name": "Malan Kriel", "link": "https://stackoverflow.com/users/6822528/malan-kriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 53300523, "answer_count": 1, "score": -1, "last_activity_date": 1542199404, "creation_date": 1542199404, "question_id": 53300522, "link": "https://stackoverflow.com/questions/53300522/parse-excel-formula-string-into-preceding-string-the-function-arguments-and-p", "title": "Parse Excel formula string into preceding string, the function, arguments, and post function string in VBA", "body": "<p>For a given Excel function (e.g. <code>VLOOKUP</code>), I need to parse a cell's formula string into:</p>\n\n<ul>\n<li><code>preFunctionStr</code> = The string preceding the VLOOKUP function</li>\n<li><code>ExcelFn</code> = \"VLOOKUP\"</li>\n<li><code>Arguments</code> = Collection of all the arguments within the VLOOKUP function (which themselves could contain functions)</li>\n<li><code>postFunctionStr</code> = The string following the last \")\" in the formula string</li>\n</ul>\n\n<p>My main reason for wanting this is to be able to convert Excel formulae without changing their answer. For example, convert <code>SUMIF</code> into <code>SUMIFS</code> and convert <code>VLOOKUP</code> into a combination of <code>INDEX</code> and <code>MATCH</code>.</p>\n\n<p>In my example, I am in a cell that contains the formula <code>=A4+VLOOKUP(2,$E$4:$F$8,MATCH(\"Value(1)\",$E$4:$F$4,0),0) + 2000</code> which I need to parse into the components described above.</p>\n\n<p>Although I could find plenty of material on parsing Excel formulae, I couldn't find one that breaks it into these components.</p>\n"}, {"tags": ["vba", "csv", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1542199600, "post_id": 53300418, "comment_id": 93481659, "body": "Look at using <code>ADO</code> to do this."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1542200558, "post_id": 53300418, "comment_id": 93482209, "body": "Use <i>automation</i>. Open the Worksheet using Excel and pick the values you need, and add them to the table(s) that should hold them in Access."}, {"owner": {"reputation": 129, "user_id": 9208443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3e5f14e35b5b5972bd95431b0737fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Besarion", "link": "https://stackoverflow.com/users/9208443/besarion"}, "edited": false, "score": 0, "creation_date": 1542202760, "post_id": 53300418, "comment_id": 93483630, "body": "Gustav were you meaning something like this: DoCmd.TransferSpreadsheet acLink, acSpreadsheetTypeExcel9,  YourTableName, YourFileName, False, &quot;A13:C17&quot;"}, {"owner": {"reputation": 129, "user_id": 9208443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3e5f14e35b5b5972bd95431b0737fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Besarion", "link": "https://stackoverflow.com/users/9208443/besarion"}, "edited": false, "score": 0, "creation_date": 1542203138, "post_id": 53300418, "comment_id": 93483892, "body": "that wont work because thats for spreadsheets only and this is a CSV file."}], "answers": [{"comments": [{"owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "edited": false, "score": 0, "creation_date": 1542210135, "post_id": 53303815, "comment_id": 93488485, "body": "the CSV fields are number indexed so you start at 0 for the first record set"}, {"owner": {"reputation": 129, "user_id": 9208443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3e5f14e35b5b5972bd95431b0737fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Besarion", "link": "https://stackoverflow.com/users/9208443/besarion"}, "edited": false, "score": 0, "creation_date": 1542274242, "post_id": 53303815, "comment_id": 93512641, "body": "Hi Tim thanks for the layout there ill test it out and change it to meet my csv. Ill back to you later"}], "tags": [], "owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1542209984, "creation_date": 1542209984, "answer_id": 53303815, "question_id": 53300418, "link": "https://stackoverflow.com/questions/53300418/insert-specific-cells-of-a-csv-into-ms-access-table-vba/53303815#53303815", "title": "Insert Specific Cells of a CSV into MS Access table vba", "body": "<pre><code>        Sub CSVData()\n        Dim con As ADODB.Connection\n        Dim rs As ADODB.Recordset\n\n        Set con = New ADODB.Connection\n        Set rs = New ADODB.Recordset\n\n        Dim currentDataFilePath As String\n        Dim currentDataFileName As String\n        Dim nextRow As Integer\n        Dim emptystr As String\n         '\"H:\\projectfiles\\csv\\\", \"Book.csv\"\n        currentDataFilePath = (\"H:\\projectfiles\\csv\\\")\n        currentDataFileName = (\"Book.csv\")\n         emptystr = \"NULL\"\n\n\n        con.Provider = \"Microsoft.Ace.OLEDB.12.0\"\n        con.ConnectionString = \"Data Source=\" &amp; currentDataFilePath &amp; \";\" &amp; \"Extended Properties=\"\"text;HDR=Yes;FMT=Delimited;\"\"\"\n        'MsgBox currentDataFilePath\n\n        con.Open\n\n        rs.Open \"SELECT * FROM [\" &amp; currentDataFileName &amp; \"] \", con\n        rs.MoveFirst\n        'nextRow = Worksheets(\"Sheet3\").UsedRange.Rows.Count + 1\n        'Worksheets(\"Sheet3\").Cells(nextRow, 1).CopyFromRecordset rs\n\n        'MsgBox rs.RecordCount\n        With rs\n        Do Until .EOF\n\n        'check the field is not null before process\n\n         If Not IsNull(rs(0)) Then\n         custordernum = rs(0)\n         End If\n\n         If Not IsNull(rs(1)) Then\n        ContactNAme = \"\" &amp; Replace(rs(1), \"'\", \" \")\n\n        Else\n        ContactNAme = emptystr\n        End If\n\n        If Not IsNull(rs(2)) Then\n        colladd1 = \"\" &amp; Replace(rs(2), \"'\", \" \")\n        Else\n        colladd1 = emptystr\n        End If\n        MsgBox colladd1\n        .MoveNext\n        Loop\n         End With\n\n\n        rs.Close\n        con.Close\n        End Sub\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 9208443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3e5f14e35b5b5972bd95431b0737fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Besarion", "link": "https://stackoverflow.com/users/9208443/besarion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542209984, "creation_date": 1542199066, "last_edit_date": 1542202650, "question_id": 53300418, "link": "https://stackoverflow.com/questions/53300418/insert-specific-cells-of-a-csv-into-ms-access-table-vba", "title": "Insert Specific Cells of a CSV into MS Access table vba", "body": "<p>Hi there so ive been trying to update the style of the csvs we're working with. Currently the style is unreadable for the importer so id have to write some vba to get specific cells to go into columns. </p>\n\n<p>E.g Name of Company is A1</p>\n\n<p>Yr1 is F25, YR2 is E25, YR3 is D25, YR4 is C25 and YR5 is B25 *These are all dates</p>\n\n<p>Total Sales YR1 is F28, YR2 E28, etc. hopefully that was enough of an example.</p>\n\n<p>So the vba would have to open the CSV and pick the cells based on range i imagine and then get the value and then put it into the correct column. </p>\n\n<p>Hopefully that was enough to make sense of what i would like to do.\nIn the CSV itself there arent any column headers.</p>\n\n<p>I imagined something like this</p>\n\n<pre><code>Dim CombLoop As Integer\nDim CSVCn As Object\nDim rsCSV As Object\nDim strSql, CombFileName, GotoRange As String\nDim rs As DAO.Recordset\n\nSet CSVCn = CreateObject(\"ADODB.Connection\")\nSet rsCVS = CreateObject(\"ADODB.Recordset\")\n\n'CSVCn.Open \"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=Q:\\DATA\\0091823.csv; Extended Properties = CSV;\"\n\nCSVCn.Open \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; _\n\"Data Source=Q:\\UPDACOS\\04369248.csv;\" &amp; _\n\"Extended Properties= Comma delimited;\"\n\nstrSql = \"SELECT * FROM [a1..f75];\"\nrsCSV.Open strSql, CSVCn, adOpenStatic\n\nSet rs = CurrentDb.OpenRecordset(\"Select * From dbo_UpdatedRegtemp;\")\n\nIf Not (rsCSV.EOF And rsCSV.BOF) Then\n    FindRecordCount = rsCSV.RecordCount\n    rsCSV.MoveFirst\n    Do Until rsCSV.EOF = True\n        Field1 = rsCSV![A1]\n        Field3 = rsCSV![A2]\n        Field2 = rsCSV![A3]\n        rs.AddNew\n        rs![Reg# Number] = Field1\n        rs![Company Name] = Field2\n        rs.Update\n    rsCSV.MoveNext\n    Loop\nEnd If\n\ncSVCn.Close\nSet rsCSV = Nothing\nSet CSVCn = Nothing\nrs.Close\n</code></pre>\n\n<p>Cheers,</p>\n"}, {"tags": ["regex", "vba", "ms-word", "find", "acronym"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 2, "creation_date": 1542198843, "post_id": 53300311, "comment_id": 93481243, "body": "You won&#39;t be able to do that with a single wildcard pattern. MS &quot;regex&quot; (which is not &quot;regular&quot;, in fact) does not support optional patterns. You may use a couple of patterns to find exact patterns you are looking for though."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1542202423, "post_id": 53300311, "comment_id": 93483405, "body": "<code>\\b(?:[A-Z0-9]+[a-z\\-]?){2,}\\b</code>"}, {"owner": {"reputation": 65, "user_id": 3153746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175efa0ab5f5aece30fab51c579aab7c?s=128&d=identicon&r=PG&f=1", "display_name": "Kagekiba", "link": "https://stackoverflow.com/users/3153746/kagekiba"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1542211898, "post_id": 53300311, "comment_id": 93489633, "body": "@WiktorStribi\u017cew thanks, this seems to be the case. Easiest way I can see is find all entries starting with a capital letter ( <code>&lt;[A-Z]*&gt;</code> ), then test each word found against <code>.+[A-Z]</code>. This works fine (assuming all acronyms start with a capital letter), but requires additional references which make it more difficult to share."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 3153746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175efa0ab5f5aece30fab51c579aab7c?s=128&d=identicon&r=PG&f=1", "display_name": "Kagekiba", "link": "https://stackoverflow.com/users/3153746/kagekiba"}, "edited": false, "score": 0, "creation_date": 1542209881, "post_id": 53302039, "comment_id": 93488304, "body": "Thanks, this worked great and doesn&#39;t require additional references (which apparently using comparing to regular expressions in VBA does). The only thing I would change is the initial find expression can be <code>&quot;&lt;[A-Z]*&gt;&quot;</code>, which is a little neater and doesn&#39;t have a character limit."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 65, "user_id": 3153746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175efa0ab5f5aece30fab51c579aab7c?s=128&d=identicon&r=PG&f=1", "display_name": "Kagekiba", "link": "https://stackoverflow.com/users/3153746/kagekiba"}, "edited": false, "score": 0, "creation_date": 1542211218, "post_id": 53302039, "comment_id": 93489227, "body": "Glad the approach works for you :-) The problem with trying to use Regular Expressions in Word is that you lose the formatting. If, of course, you use it to compare the &quot;found&quot; term, then it would work, yes..."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 2, "last_activity_date": 1542204200, "creation_date": 1542204200, "answer_id": 53302039, "question_id": 53300311, "link": "https://stackoverflow.com/questions/53300311/find-words-with-more-than-one-capital-letter-in-word-vba/53302039#53302039", "title": "Find words with more than one capital letter in word/VBA", "body": "<p>I don't think it's possible to 'search for words with two or more capital letters in any location and find the whole word' except in combination with macro code. Since you're using a macro, anyway, here's an approach that worked for me using the following sample text</p>\n\n<pre><code>CoP, this That and AnoTher thing W3C, DVDs and CD-ROM\n</code></pre>\n\n<p>and this wildcard combination (note that the list separator in my Windows configuration is <code>;</code>, for other regions a <code>,</code> may be required).</p>\n\n<pre><code>&lt;[A-Z][0-9A-Z\\-a-z]{1;10}&gt;\n</code></pre>\n\n<p>The following function checks whether the second or any later letter in the \"found\" range is capitalized and returns a boolean to the calling procedure. It loops through the characters in the given <code>Range</code>, checking the ASCII value. As soon as one is found, the loop exits.</p>\n\n<pre><code>Function ContainsMoreThanOneUpperCase(rng As Word.Range) As Boolean\n    Dim nrChars As Long, i As Long\n    Dim char As String\n    Dim HasUpperCase\n\n    HasUpperCase = False\n    nrChars = rng.Characters.Count\n    For i = 2 To nrChars\n        char = rng.Characters(i).text\n        If Asc(char) &gt;= 65 And Asc(char) &lt;= 90 Then\n            'It's an uppercase letter\n            HasUpperCase = True\n            Exit For\n        End If\n    Next\n    ContainsMoreThanOneUpperCase = HasUpperCase\nEnd Function\n</code></pre>\n\n<p>An example for using it:</p>\n\n<pre><code>Sub FindAcronyms()\n    Dim rngFind As Word.Range\n    Dim bFound As Boolean\n\n    Set rngFind = ActiveDocument.content\n    With rngFind.Find\n        .text = \"&lt;[A-Z][0-9A-Z\\-a-z]{1;10}&gt;\"\n        .MatchWildcards = True\n        .Forward = True\n        .wrap = wdFindStop\n        bFound = .Execute\n        Do While bFound\n            If bFound And ContainsMoreThanOneUpperCase(rngFind) Then\n                Debug.Print rngFind.text\n                rngFind.HighlightColorIndex = wdBrightGreen\n            End If\n            rngFind.Collapse wdCollapseEnd\n            bFound = .Execute\n        Loop\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 3153746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175efa0ab5f5aece30fab51c579aab7c?s=128&d=identicon&r=PG&f=1", "display_name": "Kagekiba", "link": "https://stackoverflow.com/users/3153746/kagekiba"}, "edited": false, "score": 0, "creation_date": 1542212263, "post_id": 53303602, "comment_id": 93489864, "body": "Thanks, it does seem to be that unfortunatly it can&#39;t be done in one operation. This code doesn&#39;t seem to pick out words that include lower case letters (although it did highlight punctuation after them) and also seems to pickup punctuation after words it finds."}], "tags": [], "owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "is_accepted": false, "score": 0, "last_activity_date": 1542209357, "creation_date": 1542209357, "answer_id": 53303602, "question_id": 53300311, "link": "https://stackoverflow.com/questions/53300311/find-words-with-more-than-one-capital-letter-in-word-vba/53303602#53303602", "title": "Find words with more than one capital letter in word/VBA", "body": "<p>You can't do this in one pass of Find/Replace. You also have to make some allowances for what the Word application considers a Word and then where the acronym is located in the sentence or paragraph.</p>\n\n<p>The following code should provide an idea for how you might do it with a combination of Wildcard searching and then additional VBA string manipulation. </p>\n\n<p>It is setup to deal with words that start with capital letters, you will need to carry it further and add code and wildcard search criteria for words that start with lowercase letters if you expect to have any of those.</p>\n\n<pre><code>Sub FindAcronynms()\n    Dim rng As word.Range\n    Set rng = ActiveDocument.Content\n    With rng.Find\n        .ClearFormatting\n        .Format = False\n        .Forward = True\n        .MatchWildcards = True\n        .Text = \"&lt;[A-Z]{1,}[a-z][A-Z]&gt;\"\n        .Wrap = wdFindStop\n        .Execute\n        Do While .found\n            MoveEndOfString rng\n            rng.HighlightColorIndex = wdTeal\n            rng.Collapse wdCollapseEnd\n            .Execute\n        Loop\n    End With\n    Set rng = ActiveDocument.Content\n    With rng.Find\n        .ClearFormatting\n        .Format = False\n        .Forward = True\n        .MatchWildcards = True\n        .Text = \"[A-Z]{1,5}[0-9][A-Z]{1,5}\"\n        .Wrap = wdFindStop\n        .Execute\n        Do While .found\n            MoveEndOfString rng\n            rng.HighlightColorIndex = wdTeal\n            rng.Collapse wdCollapseEnd\n            .Execute\n        Loop\n    End With\n    Set rng = ActiveDocument.Content\n    With rng.Find\n        .ClearFormatting\n        .Format = False\n        .Forward = True\n        .MatchWildcards = True\n        .Text = \"&lt;[A-Z]{2,}&gt;\"\n        .Wrap = wdFindStop\n        .Execute\n        Do While .found\n            MoveEndOfString rng\n            rng.HighlightColorIndex = wdTeal\n            rng.Collapse wdCollapseEnd\n            .Execute\n        Loop\n    End With\n    MsgBox \"Action Complete\", vbExclamation, \"Custom Find\"\nEnd Sub\nPrivate Function MoveEndOfString(ByRef rng As word.Range)\n    rng.MoveEnd wdCharacter, 1\n    Select Case Asc(rng.Characters.Last)\n        Case Is &lt;= 32\n            rng.MoveEnd wdCharacter, -1\n        Case 45\n            rng.MoveEnd wdCharacter, 1\n            rng.MoveEnd wdWord, 1\n            If Asc(rng.Characters.Last) = 32 Then\n                'required because move above includes\n                'trailing space\n                rng.MoveEnd wdCharacter, -1\n            End If\n    End Select\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1542287073, "post_id": 53309684, "comment_id": 93520204, "body": "I think you need to include some explanation with this... It&#39;s not obvious at all how this solves the problem."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": -1, "last_activity_date": 1542234508, "creation_date": 1542234508, "answer_id": 53309684, "question_id": 53300311, "link": "https://stackoverflow.com/questions/53300311/find-words-with-more-than-one-capital-letter-in-word-vba/53309684#53309684", "title": "Find words with more than one capital letter in word/VBA", "body": "<p>You might use something like:</p>\n\n<pre><code>Sub Demo()\nApplication.ScreenUpdating = False\nOptions.DefaultHighlightColorIndex = wdPink\nWith ActiveDocument.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Replacement.Highlight = True\n    .Forward = True\n    .Format = True\n    .Wrap = wdFindContinue\n    .MatchWildcards = True\n    .Text = \"&lt;[A-Z][A-Z0-9/-]{1,}\"\n    .Replacement.Text = \"^&amp;\"\n    .Execute Replace:=wdReplaceAll\n    .Text = \"&lt;[A-Z][A-Za-z0-9/-]@[A-Z]\"\n    .Replacement.Text = \"^&amp;\"\n    .Execute Replace:=wdReplaceAll\n  End With\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 3153746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175efa0ab5f5aece30fab51c579aab7c?s=128&d=identicon&r=PG&f=1", "display_name": "Kagekiba", "link": "https://stackoverflow.com/users/3153746/kagekiba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1313, "favorite_count": 0, "accepted_answer_id": 53302039, "answer_count": 3, "score": 4, "last_activity_date": 1580648551, "creation_date": 1542198649, "last_edit_date": 1542199127, "question_id": 53300311, "link": "https://stackoverflow.com/questions/53300311/find-words-with-more-than-one-capital-letter-in-word-vba", "title": "Find words with more than one capital letter in word/VBA", "body": "<p>I have a piece of VBA code that uses <a href=\"https://docs.microsoft.com/en-gb/office/vba/api/Word.Find\" rel=\"nofollow noreferrer\">Find</a> to find all the acronyms in a document. It does this by searching for all words consisting of capital letters that are 2 or more characters long using...</p>\n\n<pre><code>&lt;[A-Z]{2,}&gt;\n</code></pre>\n\n<p>The problem with this is it doesn't pick up all the acronyms, such as CoP, W3C, DVDs and CD-ROM. It picks up hyphenated acronyms in two parts which are not ideal but allowable as the list is checked by a user. I can also pick up words that end with an \"s\" or other characters by not searching to the end of the word using...    </p>\n\n<pre><code>&lt;[A-Z]{2,}\n</code></pre>\n\n<p>But this doesn't count any non-upper case character as part of the word it finds.</p>\n\n<p>Is there an expression that would allow me to search for words with two or more capital letters in any location and find the whole word?</p>\n"}, {"tags": ["excel", "vba", "formatting"], "comments": [{"owner": {"reputation": 367, "user_id": 6593399, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rxxWQpdZDZg/AAAAAAAAAAI/AAAAAAAAMco/dBE3ou3GapQ/photo.jpg?sz=128", "display_name": "Grzesiek Danowski", "link": "https://stackoverflow.com/users/6593399/grzesiek-danowski"}, "edited": false, "score": 0, "creation_date": 1542198847, "post_id": 53300290, "comment_id": 93481245, "body": "I suppose that you should use &quot;#,##0&quot; where comma marks thousand seperator that in your operating system settings can be defined as apostrophe. I don&#39;t know how format if you want different than in system settings."}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "reply_to_user": {"reputation": 367, "user_id": 6593399, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rxxWQpdZDZg/AAAAAAAAAAI/AAAAAAAAMco/dBE3ou3GapQ/photo.jpg?sz=128", "display_name": "Grzesiek Danowski", "link": "https://stackoverflow.com/users/6593399/grzesiek-danowski"}, "edited": false, "score": 0, "creation_date": 1542199126, "post_id": 53300290, "comment_id": 93481398, "body": "@GrzesiekDanowski Perfect! Works! Put it as an answer. The macro recorder is useful but not without flaws unfortunately."}], "answers": [{"tags": [], "owner": {"reputation": 367, "user_id": 6593399, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rxxWQpdZDZg/AAAAAAAAAAI/AAAAAAAAMco/dBE3ou3GapQ/photo.jpg?sz=128", "display_name": "Grzesiek Danowski", "link": "https://stackoverflow.com/users/6593399/grzesiek-danowski"}, "is_accepted": true, "score": 3, "last_activity_date": 1542199323, "creation_date": 1542199323, "answer_id": 53300504, "question_id": 53300290, "link": "https://stackoverflow.com/questions/53300290/proper-numberformat-in-vba-excel/53300504#53300504", "title": "Proper NumberFormat in VBA-excel", "body": "<p>I suppose that you should use \"#,##0\" where comma marks thousand seperator that in your operating system settings can be defined as apostrophe.\nI don't know how format if you want different than in system settings.\nReference: <a href=\"https://www.ablebits.com/office-addins-blog/2016/07/07/custom-excel-number-format/\" rel=\"nofollow noreferrer\">https://www.ablebits.com/office-addins-blog/2016/07/07/custom-excel-number-format/</a></p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 4, "last_activity_date": 1542199536, "creation_date": 1542199536, "answer_id": 53300564, "question_id": 53300290, "link": "https://stackoverflow.com/questions/53300290/proper-numberformat-in-vba-excel/53300564#53300564", "title": "Proper NumberFormat in VBA-excel", "body": "<p>If you want to change the thousands separator in Excel from default <code>,</code> to <code>'</code> use </p>\n\n<pre><code>Application.ThousandsSeparator = \"'\" \nApplication.UseSystemSeparators = False\n</code></pre>\n\n<p>Then </p>\n\n<pre><code>.NumberFormat = \"#,##0\"\n</code></pre>\n\n<p>will produce </p>\n\n<p><a href=\"https://i.stack.imgur.com/T8Rxv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T8Rxv.png\" alt=\"enter image description here\"></a></p>\n\n<p>Note that this will change the thousands separator in your complete Excel (not only that workbook).</p>\n\n<hr>\n\n<p>Alternatively you can change it system wide in your system settings.</p>\n"}], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 53300504, "answer_count": 2, "score": 1, "last_activity_date": 1586394372, "creation_date": 1542198584, "last_edit_date": 1586394372, "question_id": 53300290, "link": "https://stackoverflow.com/questions/53300290/proper-numberformat-in-vba-excel", "title": "Proper NumberFormat in VBA-excel", "body": "<p>I know at first this question sound easy.</p>\n\n<p>I want to have a high comma after the third digit. For example: 10'000 or 1'000 and 100 and 10. I am able to do this manually in excel using \"Format\">\"Number\"> 0 \"decimals\". That gives me the right formatting. But now comes the twist! If I record the a macro of that action the code is something like this:</p>\n\n<pre><code>MyChart.Axes(xlValue).TickLabels.NumberFormat = \"#'##0\"\n</code></pre>\n\n<p>But this yields something else when a applied, namely : 100'000 10'000 1'000 <strong>'100 '10</strong> </p>\n\n<p><a href=\"https://i.stack.imgur.com/NWO71.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NWO71.png\" alt=\"Here is what I get with &quot;#&#39;##0&quot;\"></a></p>\n\n<p><strong>Any suggestions on what format code to use ?</strong> I could always go through all ticklables check the value and format it indivdually but that's a pain. If I do not have to I'd rather not do it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1542196603, "post_id": 53299425, "comment_id": 93479944, "body": "You can use offset, so in a loop <code>for x=1 to 10 if range(&quot;a1&quot;).offset(0,x).value&lt;&gt;&quot;&quot; then Range(&quot;A:A&quot;).offset(0,x).texttocolumns....else skip</code>  Or simply <code>columns(x).</code>"}, {"owner": {"reputation": 41, "user_id": 9202163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1775d0b82797582bbec494e6f8a8258f?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Razzleflamm", "link": "https://stackoverflow.com/users/9202163/nick-razzleflamm"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1542280400, "post_id": 53299425, "comment_id": 93516294, "body": "So\t  <code>for x=1 to 10  \tif range(&quot;a1&quot;).offset(0,x).value&lt;&gt;&quot;&quot;  \tthen Range(&quot;A:A&quot;).offset(0,x).texttocolumns Destination:=Range(&quot;A1&quot;), DataType:=xlDelimited, _ \tTextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _ \tSemicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _ \t:=Array(1, 1), TrailingMinusNumbers:=True</code>  ?  Also can you explain what each line does?"}], "answers": [{"tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 0, "last_activity_date": 1542197487, "creation_date": 1542197487, "answer_id": 53299949, "question_id": 53299425, "link": "https://stackoverflow.com/questions/53299425/how-do-i-convert-a-text-to-column-code-block-into-a-loop/53299949#53299949", "title": "How do i convert a text to column code block into a loop?", "body": "<p>To check if a column has any non-blank cells (formula or value) you could employ this condition:</p>\n\n<pre><code>If Range(\"A:A\").SpecialCells(xlCellTypeBlanks).CountLarge &lt; Range(\"A:A\").CountLarge Then\n</code></pre>\n\n<p>which will allow you to determine if a column is populated in any way and only execute your code if it is.</p>\n\n<p>Be warned that the call to SpecialCells will fail if the <em>entire</em> column is non-blank.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 9202163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1775d0b82797582bbec494e6f8a8258f?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Razzleflamm", "link": "https://stackoverflow.com/users/9202163/nick-razzleflamm"}, "is_accepted": true, "score": 0, "last_activity_date": 1542610676, "last_edit_date": 1542610676, "creation_date": 1542610306, "answer_id": 53369636, "question_id": 53299425, "link": "https://stackoverflow.com/questions/53299425/how-do-i-convert-a-text-to-column-code-block-into-a-loop/53369636#53369636", "title": "How do i convert a text to column code block into a loop?", "body": "<p>I played around with the code a bit and came up with this solution. I don't know if there is any better way to do this but this gets the job done.</p>\n\n<p>If anyone is interested: </p>\n\n<pre><code>On Error Resume Next\nFor x = 1 To 200\nIf Not Range(\"a1\").Offset(0, x).IsEmpty(ActiveCell.Value) Then \nRange(\"A:A\").Offset(0, x).TextToColumns Destination:=Range(\"A1\").Offset(0, x), DataType:=xlDelimited, _\nTextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, \nSemicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n:=Array(1, 1), TrailingMinusNumbers:=True\n\nNext x\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9202163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1775d0b82797582bbec494e6f8a8258f?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Razzleflamm", "link": "https://stackoverflow.com/users/9202163/nick-razzleflamm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 53369636, "answer_count": 2, "score": 0, "last_activity_date": 1586394408, "creation_date": 1542195694, "last_edit_date": 1586394408, "question_id": 53299425, "link": "https://stackoverflow.com/questions/53299425/how-do-i-convert-a-text-to-column-code-block-into-a-loop", "title": "How do i convert a text to column code block into a loop?", "body": "<p>I'm using the following codes repeatedly to text to column some data. I'm repeating these lines from (\"A:A\") to (\"DM:DM\"). Sometimes the file i want to run this on will have less that that amount of columns. Even if that's the case i made the code to text to column the maximum possible amount of columns. But this makes the execution slow. I want to convert this to a loop where if the next column is blank, the execution will jump to the next block. </p>\n\n<p>Can you good people suggest me a way to do that?</p>\n\n<pre><code>Range(\"A:A\").TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n        :=Array(1, 1), TrailingMinusNumbers:=True\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1542197316, "post_id": 53299170, "comment_id": 93480346, "body": "Not quite clear on what you mean.  You have a <code>UserForm</code> named <code>Sheet1</code> - <i>not</i> a <code>Worksheet</code>, but a form inserted within the VBE?  And the loop you mean is the <code>For Elevation = MinElevation To MaxElevation Step ElevationStep</code> loop?"}, {"owner": {"reputation": 1, "user_id": 7632392, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4m0khUExowE/AAAAAAAAAAI/AAAAAAAAAAA/CIHtTMKBLC0/photo.jpg?sz=128", "display_name": "Sundeep Srivastava", "link": "https://stackoverflow.com/users/7632392/sundeep-srivastava"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1542197413, "post_id": 53299170, "comment_id": 93480398, "body": "I don&#39;t have a user form separately, my user form is on sheet.1 and the loop I want to run is elevation and rotation. for both the loop to increment or decrement I want my button to work. This macro is for controlling another piece of software which support macro control"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1542197499, "post_id": 53299170, "comment_id": 93480446, "body": "Ah ok, so it&#39;s a <code>Worksheet</code> made to look like a form."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 2, "creation_date": 1542202478, "post_id": 53299170, "comment_id": 93483440, "body": "it is not clear what you mean by loop to progress by command button, if i am thinking of what you trying to achieve then may please think of simple possibility of using a spinner (may be linked to a cell) for and using spinner value as elevation.. The vba could be (with some modification) could be attached to cell change detected via <code>Worksheet_Change</code> event."}, {"owner": {"reputation": 1, "user_id": 7632392, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4m0khUExowE/AAAAAAAAAAI/AAAAAAAAAAA/CIHtTMKBLC0/photo.jpg?sz=128", "display_name": "Sundeep Srivastava", "link": "https://stackoverflow.com/users/7632392/sundeep-srivastava"}, "edited": false, "score": 0, "creation_date": 1542203606, "post_id": 53299170, "comment_id": 93484219, "body": "Hi Ahmed, Please see the attached images, maybe that helps clarify what I mean. if I run my code, it progresses with 10degree step, gives me the value of the elevation rotation and its layer ID. Since I am controlling the layer id of another software, I need a click function which makes the loop execute only once so that the layer id of other software can be controlled."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542204094, "post_id": 53299170, "comment_id": 93484531, "body": "So what is supposed to happen when <code>MinElevation</code>, <code>MaxElevation</code>, or <code>ElevationStep</code> change between button clicks?"}, {"owner": {"reputation": 1, "user_id": 7632392, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4m0khUExowE/AAAAAAAAAAI/AAAAAAAAAAA/CIHtTMKBLC0/photo.jpg?sz=128", "display_name": "Sundeep Srivastava", "link": "https://stackoverflow.com/users/7632392/sundeep-srivastava"}, "edited": false, "score": 0, "creation_date": 1542206036, "post_id": 53299170, "comment_id": 93485838, "body": "after the button click works and the loop goes to next layer ID, I will call another function (source function) which will update the layer function of my VR file (Switch on/off corresponding sun position in the VR file)... in the code where I am debugging  the line will be replaced to call my source function."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1542249282, "post_id": 53299170, "comment_id": 93504016, "body": "Would you kindly help us understand the followings 1. Do you want to halt the code execution, so that it will run again on button click?  2. What  variable/s you want to increase or decrease with button click? _(both elevation and rotation are only increased in the code) _ 3. Why the code is to run as function and not as sub? (It returns no values. though it may used to call some other software)"}, {"owner": {"reputation": 1, "user_id": 7632392, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4m0khUExowE/AAAAAAAAAAI/AAAAAAAAAAA/CIHtTMKBLC0/photo.jpg?sz=128", "display_name": "Sundeep Srivastava", "link": "https://stackoverflow.com/users/7632392/sundeep-srivastava"}, "edited": false, "score": 0, "creation_date": 1542272522, "post_id": 53299170, "comment_id": 93511553, "body": "Hi Ahmad, Thanks for looking into this... 1. Yes, that is correct, however, the code should check the button click minus/plus and then proceed to decrease/increase the elevation with same the elevation step. same goes for the rotation as well. 2. Elevation and Rotation both need to increase/decrease.  3.unfortunately, I am not familiar with the basics of coding hence all the codes I have written are as the function. This function name is LayerID and in the code, I have a variable called LayerNumber, with each click the value of LayerNumber will be used to execute the functionality of my softw"}, {"owner": {"reputation": 1, "user_id": 7632392, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4m0khUExowE/AAAAAAAAAAI/AAAAAAAAAAA/CIHtTMKBLC0/photo.jpg?sz=128", "display_name": "Sundeep Srivastava", "link": "https://stackoverflow.com/users/7632392/sundeep-srivastava"}, "edited": false, "score": 0, "creation_date": 1542282801, "post_id": 53299170, "comment_id": 93517714, "body": "Hi Ahmed, Please see the attached Image (To Explain What I need). Hopefully, it will be more clear."}], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1542367055, "post_id": 53331554, "comment_id": 93552279, "body": "Please note that without explicitly specifying a data type (or object type) as e.g. in <code>Dim ElevationStep, MinElevation, MaxElevation, Elevation As Integer</code>, only the <i>last</i> variable <code>Elevation</code> is declared as <code>Integer</code>; all other variables will be treated as <b>Variant by default</b>!  A consistent declaration is as follows: <code>Dim ElevationStep As Integer, MinElevation As Integer,  MaxElevation As Integer, Elevation As Integer</code> :-)"}, {"owner": {"reputation": 1, "user_id": 7632392, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4m0khUExowE/AAAAAAAAAAI/AAAAAAAAAAA/CIHtTMKBLC0/photo.jpg?sz=128", "display_name": "Sundeep Srivastava", "link": "https://stackoverflow.com/users/7632392/sundeep-srivastava"}, "edited": false, "score": 0, "creation_date": 1544465032, "post_id": 53331554, "comment_id": 94276876, "body": "Thank very much Ahmed AU, this is very good, I just tried your code and with some minor tweaks,  it is doing what it should do. Thanks a ton for your help."}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1542343338, "creation_date": 1542343338, "answer_id": 53331554, "question_id": 53299170, "link": "https://stackoverflow.com/questions/53299170/click-button-to-increment-decrement-a-loop/53331554#53331554", "title": "Click button to increment/decrement a loop", "body": "<p>What I could understand from the details</p>\n\n<ol>\n<li><p>There is no need to loop for manual operation and the <code>layerNumber</code> could be simply derived from the <code>TextBox</code> values (or directly from Cells) with the formula \n<code>LayerNumber = ((Elevation - MinElevation) / ElevationStep) * NumberOfRotations + (Rotation - MinRotation) / RotationStep</code> </p></li>\n<li><p>Rotation &amp; Elevation Plus &amp; Minus buttons (or spinners) could be used for increase or decrease Rotation &amp; Elevation with the steps,Max, Min defined.</p></li>\n<li><p>Finally VR software could be called from any button click with the help of <code>LayerID</code>\nI tried it like this to generate <code>LayerID</code> according to already made buttons etc.</p></li>\n</ol>\n\n<p>Buttons names, Sheet names etc may be changed according to your need. if my assumptions are not correct feel free to further describe your need. </p>\n\n<pre><code>Option Explicit\nPrivate Sub ElvMinus_Click()\nDim ElevationStep, MinElevation, MaxElevation, Elevation As Integer\nElevationStep = Val(Sheet2.ElevationStepBox.Text)\nMinElevation = Val(Sheet2.MinElevationAngleBox.Text)\nMaxElevation = Val(Sheet2.MaxElevationAngleBox.Text)\nElevation = Val(Sheet2.AngleOfElevationBox.Text)\nElevation = Elevation - ElevationStep\nElevation = IIf(Elevation &lt; MinElevation, MinElevation, Elevation)\nSheet2.AngleOfElevationBox.Text = Elevation\nGetLayerID\nEnd Sub\nPrivate Sub ElvPlus_Click()\nDim ElevationStep, MinElevation, MaxElevation, Elevation As Integer\nElevationStep = Val(Sheet2.ElevationStepBox.Text)\nMinElevation = Val(Sheet2.MinElevationAngleBox.Text)\nMaxElevation = Val(Sheet2.MaxElevationAngleBox.Text)\nElevation = Val(Sheet2.AngleOfElevationBox.Text)\nElevation = Elevation + ElevationStep\nElevation = IIf(Elevation &gt; MaxElevation, MaxElevation, Elevation)\nSheet2.AngleOfElevationBox.Text = Elevation\nGetLayerID\nEnd Sub\nPrivate Sub RotMinus_Click()\nDim RotationStep, MinRotation, MaxRotation, Rotation As Integer\nRotationStep = Val(Sheet2.RotationStepBox.Text)\nMinRotation = Val(Sheet2.MinRotationAngleBox.Text)\nMaxRotation = Val(Sheet2.MaxRotationAngleBox.Text)\nRotation = Val(Sheet2.AngleOfRotationBox.Text)\nRotation = Rotation - RotationStep\nRotation = IIf(Rotation &lt; MinRotation, MinRotation, Rotation)\nSheet2.AngleOfRotationBox.Text = Rotation\nGetLayerID\nEnd Sub\nPrivate Sub RotPlus_Click()\nDim RotationStep, MinRotation, MaxRotation, Rotation As Integer\nRotationStep = Val(Sheet2.RotationStepBox.Text)\nMinRotation = Val(Sheet2.MinRotationAngleBox.Text)\nMaxRotation = Val(Sheet2.MaxRotationAngleBox.Text)\nRotation = Val(Sheet2.AngleOfRotationBox.Text)\nRotation = Rotation + RotationStep\nRotation = IIf(Rotation &gt; MaxRotation, MaxRotation, Rotation)\nSheet2.AngleOfRotationBox.Text = Rotation\nGetLayerID\nEnd Sub\nPrivate Sub GetLayerID()\nDim RotationStep, ElevationStep, MinRotation, MaxRotation, ElevatioStep, MinElevation, MaxElevation As Integer\nDim NumberOfRotations, NumberOfElevations, NumberOfSunPositions As Integer\nDim Elevation, Rotation, layerNumber As Integer\nRotationStep = Val(Sheet2.RotationStepBox.Text)\nMinRotation = Val(Sheet2.MinRotationAngleBox.Text)\nMaxRotation = Val(Sheet2.MaxRotationAngleBox.Text)\nElevationStep = Val(Sheet2.ElevationStepBox.Text)\nMinElevation = Val(Sheet2.MinElevationAngleBox.Text)\nMaxElevation = Val(Sheet2.MaxElevationAngleBox.Text)\n\nNumberOfRotations = (MaxRotation - MinRotation) / RotationStep + 1\nNumberOfElevations = (MaxElevation - MinElevation) / ElevationStep + 1\nNumberOfSunPositions = NumberOfRotations * NumberOfElevations\nSheet2.NumberOfSunPositionsBox.Text = NumberOfSunPositions\n\nElevation = Val(Sheet2.AngleOfElevationBox.Text)\nRotation = Val(Sheet2.AngleOfRotationBox.Text)\nlayerNumber = ((Elevation - MinElevation) / ElevationStep) * NumberOfRotations + (Rotation - MinRotation) / RotationStep\nSheet2.layerNumber.Text = layerNumber\n' Here call to VR  Software\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7632392, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4m0khUExowE/AAAAAAAAAAI/AAAAAAAAAAA/CIHtTMKBLC0/photo.jpg?sz=128", "display_name": "Sundeep Srivastava", "link": "https://stackoverflow.com/users/7632392/sundeep-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586394443, "creation_date": 1542194895, "last_edit_date": 1586394443, "question_id": 53299170, "link": "https://stackoverflow.com/questions/53299170/click-button-to-increment-decrement-a-loop", "title": "Click button to increment/decrement a loop", "body": "<p><a href=\"https://i.stack.imgur.com/nHCe8.jpg\" rel=\"nofollow noreferrer\">To Explain What I need</a>   <a href=\"https://i.stack.imgur.com/8CPQc.jpg\" rel=\"nofollow noreferrer\">Input Parameters</a>    <a href=\"https://i.stack.imgur.com/056Qi.jpg\" rel=\"nofollow noreferrer\">User form</a></p>\n\n<p>I have defined the variables on my sheet.2 within text boxes, and on my VBA form (Sheet.1) I have a Plus command button and a Minus command Button, I want the loop to progress only when any of these buttons are clicked. </p>\n\n<p>'**** Function to determine Layer ID of the Sources and define their Elevation and Rotation Angle</p>\n\n<pre><code>Function LayerID()\nSheet2.NumberOfSunPositionsBox.Enabled = False\nSheet2.NumberOfSunPositionsBox.Enabled = False\nSheet1.AngleOfRotationBox.Enabled = False\nSheet1.AngleOfElevationBox.Enabled = False\n\nDim RotationStep, MinRotation, MaxRotation, ElevatioStep, MinElevation, MaxElevation As Integer\n\nRotationStep = Sheet2.RotationStepBox\nMinRotation = Sheet2.MinRotationlAngleBox\nMaxRotation = Sheet2.MaxRotationAngleBox\nElevationStep = Sheet2.ElevationStepBox\nMinElevation = Sheet2.MinElevationAngleBox\nMaxElevation = Sheet2.MaxElevationAngleBox\n\nNumberOfRotations = (MaxRotation - MinRotation) / RotationStep + 1\nNumberOfElevations = (MaxElevation - MinElevation) / ElevationStep + 1\nNumberOfSunPositions = NumberOfRotations * NumberOfElevations\n    If MaxElevation = 90 Then\n    NumberOfSunPositions = NumberOfSunPositions + 1\n    End If\n\nSheet2.NumberOfSunPositionsBox = NumberOfSunPositions\nSheet1.AngleOfElevationBox = MinElevation\nSheet1.AngleOfRotationBox = MinRotation\n'Power1 = 0\n'Power2 = 100\n\n    For Elevation = MinElevation To MaxElevation Step ElevationStep\n'        If Sheet1.ElevationPlusButton Then\n           If LayerNumber &lt;= NumberOfSunPositions Then\n           Sheet1.ElevationPlusButton.Enabled = True\n                    If Elevation = 90 Then\n                    Rotation = 0\n                    LayerNumber = LayerNumber + 1\n                    Debug.Print (\"Layer ID:\" &amp; LayerNumber &amp; \" E:\" &amp; Elevation &amp; \" R:\" &amp; Rotation)\n                    Sheet1.AngleOfElevationBox = Elevation\n                    Else\n                        For Rotation = MinRotation To MaxRotation Step RotationStep\n'                        If Sheet1.RotationPlusButton Then\n'                            Sheet1.RotationPlusButton.enable = True\n                            LayerNumber = LayerNumber + 1\n                            Debug.Print (\"Layer ID:\" &amp; LayerNumber &amp; \" E:\" &amp; Elevation &amp; \" R:\" &amp; Rotation)\n                            Sheet1.AngleOfRotationBox = Rotation\n'                        End If\n                        Next Rotation\n                    End If\n            End If\n'        End If\n    Next Elevation\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1542199734, "post_id": 53299166, "comment_id": 93481727, "body": "You save every attachment with the same name and without checking their type. Only the last attachment will be remain since the others will have been overwritten.  The last attachment is likely to be a signature or a logo."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1542200132, "post_id": 53299166, "comment_id": 93481972, "body": "I believe the easiest correction is to replace <code>&quot;\\Order_History_Report.xlsx&quot;</code> with <code>&quot;\\&quot; &amp; objAtt.DisplayName</code>. This will save each file with the sender&#39;s name and with the correct extension.  If this is not an acceptable solution, please expand your question and I will endeavour to provide an answer that  meets your requirement."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1542215580, "post_id": 53299166, "comment_id": 93491795, "body": "@Tony Dallimorec - objAtt.FileName.  DisplayName will not necessarily be the same as the file name."}, {"owner": {"reputation": 1, "user_id": 7501123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef07082279298a0e9110aed937e3e66?s=128&d=identicon&r=PG&f=1", "display_name": "felipe gomes", "link": "https://stackoverflow.com/users/7501123/felipe-gomes"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1542218279, "post_id": 53299166, "comment_id": 93493115, "body": "@Tony Dallimorec - The unique requeriments is save the file with static name. When I use the code (objAtt.SaveAsFile saveFolder) only, the file doesn&#39;t corrupted, but it not work for me because every day the file have a distinct name. Other point about file is that file have the same format always. Thank u in advanced and help me."}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1542288344, "creation_date": 1542288344, "answer_id": 53320516, "question_id": 53299166, "link": "https://stackoverflow.com/questions/53299166/saving-and-renaming-an-outlook-attachment-with-static-name-on-format-xlsx/53320516#53320516", "title": "Saving and renaming an Outlook attachment with static name on format xlsx", "body": "<p>I do not understand: \u201cWhen I use the code <code>objAtt.SaveAsFile saveFolder</code> only, the file isn't corrupted.\u201d</p>\n\n<p>Unless I include a filename in the path, <code>SaveAsFile</code> always stops with an error for me.  I have tried every variation that I can think of but none will save the file.</p>\n\n<p>I have never had <code>SaveAsFile</code> corrupt a file.  My theory is your emails have more than one attachment and you are saving the wrong one.  Your code it:</p>\n\n<pre><code>saveFolder = \"C:\\Users\\acheng\\Desktop\"\nFor Each objAtt In itm.Attachments\n   objAtt.SaveAsFile saveFolder &amp; \"\\Order_History_Report.xlsx\"\n   Set objAtt = Nothing\nNext\n</code></pre>\n\n<p>If the email has two attachments, this code will:</p>\n\n<ul>\n<li>Save the first attachment as \u201cC:\\Users\\acheng\\Desktop\\Order_History_Report.xlsx\u201d overwriting any file of this name retained from yesterday.</li>\n<li>Save the second attachment as \u201cC:\\Users\\acheng\\Desktop\\Order_History_Report.xlsx\u201d overwriting the first attachment.</li>\n</ul>\n\n<p>Most emails today use Html images for logos and pictures but a few still use embedded images which are carried as attachments but not reported to the user as attachments.</p>\n\n<p>The code below will test my theory.  Copy this code to a new module:</p>\n\n<pre><code>Option Explicit\nPublic Sub InvestigateEmails()\n\n  Dim Exp As Explorer\n  Dim InxA As Long\n  Dim ItemCrnt As MailItem\n\n  Set Exp = Outlook.Application.ActiveExplorer\n\n  If Exp.Selection.Count = 0 Then\n    Call MsgBox(\"Pleaase select one or more emails then try again\", vbOKOnly)\n    Exit Sub\n  Else\n    For Each ItemCrnt In Exp.Selection\n      With ItemCrnt\n        Debug.Print \"From (Sender email address): \" &amp; .SenderEmailAddress\n        Debug.Print \"Subject: \" &amp; .Subject\n        Debug.Print \"Sent on: \" &amp; .SentOn\n        Debug.Print \"Received: \" &amp; .ReceivedTime\n        If .Attachments.Count = 0 Then\n          Debug.Print \"No attachments\"\n        Else\n          Debug.Print \"Attachments:\"\n          Debug.Print \"No.|Type|Path|Filename|DisplayName|\"\n          For InxA = 1 To .Attachments.Count\n            With .Attachments(InxA)\n              Debug.Print InxA &amp; \"|\";\n              Select Case .Type\n                Case olByValue\n                  Debug.Print \"Val\";\n                Case olEmbeddeditem\n                  Debug.Print \"Ebd\";\n                Case olByReference\n                  Debug.Print \"Ref\";\n                Case olOLE\n                  Debug.Print \"OLE\";\n                Case Else\n                  Debug.Print \"Unk;\"\n              End Select\n              ' Not all types have all properties.  This code handles\n              ' those missing properties of which I am aware.  However,\n              ' I have never found an attachment of type Reference or OLE.\n              ' Additional code may be required for them.\n              Select Case .Type\n                Case olEmbeddeditem\n                  Debug.Print \"|\";\n                Case Else\n                  Debug.Print \"|\" &amp; .PathName;\n              End Select\n              Debug.Print \"|\" &amp; .Filename;\n              Debug.Print \"|\" &amp; .DisplayName &amp; \"|\"\n            End With\n          Next\n        End If\n        Debug.Print \"--------------------------\"\n      End With\n    Next\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>To use this code, select one or more of the emails you wish to process and then run <code>InvestigateEmails</code>.  It will output a selection of properties for each selected email.  Your Immediate window will look something like:</p>\n\n<pre><code>From (Sender email address): a.j.dallimore@MyIsp.com\nSubject: Test\nSent on: 15/11/2018 11:22:41\nReceived: 15/11/2018 11:22:49\nAttachments:\nNo.|Type|Path|Filename|DisplayName|\n1|Val||002 View from back of Neville Tower.jpg|002 View from back of Neville Tower.jpg|\n2|Val||image001.jpg|image001.jpg|\n--------------------------\n</code></pre>\n\n<p>I sent the above email to myself.  Attachment 1 was a regular attachment that was listed in the header and could be dragged to a folder or clicked to open it.  Attachment 2 was embedded and appeared as a picture in the body of the email but was not listed in the header.    </p>\n\n<p>My theory is that given one of your emails, <code>InvestigateEmails</code> will list more than one attachment per email and the last attachment will not be an Excel workbook.  You save that attachment with an extension of \u201cxlsx\u201d so Excel tries and fails to open it. </p>\n\n<p>By the way, I use this routine whenever I am developed new code to process emails.  I might plan for my new code to run off an event or a rule but this routine makes testing so much easier.  I amend this code to call my new code and select a simple email.  When I have debugged my code to work with a simple email, I try a more complicated one.  There is no easier way of controlling which emails are passed to a macro for processing.  I suggest you keep this macro for future use.  Alternatively, I can tell you where to find a larger version which outputs to a desktop text file.</p>\n\n<p>The rest of this answer assumes my theory is correct.  If my theory is wrong, we may need to investigate further.</p>\n\n<p>Before showing you how to save the correct attachment with a static file name, I will say that I doubt this is a good idea.  If I understand correctly, each day you receive a workbook which overwrites the previous day\u2019s workbook.  You extract data from the workbook and save it in your database.  This may seem like a good idea but this can go disastrously wrong.  Years\u2019 ago, I knew of a similar situation although, thankfully, I was not personally involved.  Like you, they were receiving files, extracting data and then discarding the files.  This all seemed to work for some months but they then discovered that the data was not being extracted correctly.  If they had kept the original source files, fixing their database would have been difficult but possible.  But without the original data, there was nothing they could do.</p>\n\n<p>I recommend you save your files with a name like: \u201cOrder_History_Report 181115.xlsx\u201d. This will allow you to archive all the original files against any future need to reprocess them. Processing a file with a name like this is a little more difficult but I can explain how to do this.   </p>\n\n<p>Returning to your code, the easiest correction is:</p>\n\n<pre><code>For Each objAtt In itm.Attachments\n   If LCase(Right$(objAtt.DisplayName, 4)) = \".xlsx\" Then\n     objAtt.SaveAsFile saveFolder &amp; \"\\Order_History_Report.xlsx\"\n     Set objAtt = Nothing\n     Exit For\n   End If\nNext\n</code></pre>\n\n<p>This code ignores any attachments that are not regular workbooks and, once it has found a regular workbook, it does not look for more.</p>\n"}], "owner": {"reputation": 1, "user_id": 7501123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef07082279298a0e9110aed937e3e66?s=128&d=identicon&r=PG&f=1", "display_name": "felipe gomes", "link": "https://stackoverflow.com/users/7501123/felipe-gomes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592725050, "creation_date": 1542194889, "last_edit_date": 1592725050, "question_id": 53299166, "link": "https://stackoverflow.com/questions/53299166/saving-and-renaming-an-outlook-attachment-with-static-name-on-format-xlsx", "title": "Saving and renaming an Outlook attachment with static name on format xlsx", "body": "<p>I'm trying to save the daily system generated report attached to the e-mail to a folder. \nMy script saves and renames the file, but when I try to open the file it says: \nThe workbook cannot be opened or repaired by Microsoft Excel because it is corrupt.\nBelow the script:</p>\n\n<pre><code>Public Sub UnzipFileInOutlook(itm As Outlook.MailItem)\n Dim objAtt As Outlook.Attachment\n Dim saveFolder As String\n saveFolder = \"C:\\Users\\acheng\\Desktop\"\n For Each objAtt In itm.Attachments\n objAtt.SaveAsFile saveFolder &amp; \"\\Order_History_Report.xlsx\"\n Set objAtt = Nothing\n Next\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["python", "excel", "vba", "xlwings"], "comments": [{"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "edited": false, "score": 1, "creation_date": 1542203417, "post_id": 53298977, "comment_id": 93484091, "body": "Look more closely at the docs: <a href=\"http://docs.xlwings.org/en/stable/addin.html#global-settings\" rel=\"nofollow noreferrer\">docs.xlwings.org/en/stable/addin.html#global-settings</a>: Interpreter is the full path and PYTHONPATH is where your modules are."}, {"owner": {"reputation": 31, "user_id": 5111005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55a491f6db2023d4ebff6b4f3eb6370?s=128&d=identicon&r=PG&f=1", "display_name": "17DOWN", "link": "https://stackoverflow.com/users/5111005/17down"}, "reply_to_user": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "edited": false, "score": 0, "creation_date": 1542620998, "post_id": 53298977, "comment_id": 93619866, "body": "Thanks for the reply Felix. I made the required changes and now I get an error which reads: &quot;Python process exited before it was possible to create the interface object ... the command .. Working Dir: &lt;unspecified&gt; 1000&quot;"}, {"owner": {"reputation": 31, "user_id": 5111005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55a491f6db2023d4ebff6b4f3eb6370?s=128&d=identicon&r=PG&f=1", "display_name": "17DOWN", "link": "https://stackoverflow.com/users/5111005/17down"}, "reply_to_user": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "edited": false, "score": 1, "creation_date": 1542628640, "post_id": 53298977, "comment_id": 93623968, "body": "I found the answer to my problem in another one of your answers. I had my PYTHON path set to Z:\\ instead of Z:\\\\  <a href=\"https://stackoverflow.com/questions/38983144/xlwings-udfs-how-to-set-pythonpath-udf-modules-correctly\" title=\"xlwings udfs how to set pythonpath udf modules correctly\">stackoverflow.com/questions/38983144/&hellip;</a>"}], "owner": {"reputation": 31, "user_id": 5111005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55a491f6db2023d4ebff6b4f3eb6370?s=128&d=identicon&r=PG&f=1", "display_name": "17DOWN", "link": "https://stackoverflow.com/users/5111005/17down"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 517, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542194283, "creation_date": 1542194283, "question_id": 53298977, "link": "https://stackoverflow.com/questions/53298977/xlwings-addin-errors-invalid-procedure-call-or-argument-file-not-found", "title": "xlwings Addin Errors - &quot;Invalid procedure call or argument&quot; / &quot;File not found&quot;", "body": "<p>I'm trying to run a python sub using the <a href=\"https://docs.xlwings.org/en/stable/index.html\" rel=\"nofollow noreferrer\">xlwings addin (v0.14.0)</a>. I have set the following parameters in the ribbon of the addin:</p>\n\n<pre><code>Interpreter: pythonw.exe\nPYTHONPATH: C:\\Program Files\\Anaconda3\\envs\\VirtualEnv\\\nUDF Modules: mdlGetHistoricalData\n</code></pre>\n\n<p>When I press Import Functions I receive the \"<strong>Invalid procedure call or argument 5</strong>\" error.</p>\n\n<p>If I change the <code>Interpreter</code> parameter to be blank (it should default to pythonw.exe) I receive the error \"<strong>File not found: xlwings32-0.14.0.dll 53</strong>\", this file is currently located inside the virtual environment package specified in <code>PYTHONPATH</code>. I have tried placing it in my Python project location as well, but I still recieve this error.</p>\n\n<p>Is there something wrong with my parameters in the addin? Or is there something else wrong here?</p>\n\n<p><strong>Facts</strong>:</p>\n\n<ul>\n<li>I'm using xlwings 0.14.0 in my virtual environment and the ribbons\nversion is identical. </li>\n<li>I'm using Python 3.6 in my virtual environment</li>\n<li>I've used the \"@xw.sub\" identifier in my Python script</li>\n<li>I have also tried stepping through Py.CallUDF and RunPython in VBA and receive identical errors</li>\n</ul>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1542195279, "post_id": 53298879, "comment_id": 93479169, "body": "Access doesn&#39;t offer a built-in way to scroll list boxes. I can write up a WinAPI answer if you&#39;re interested, but it will be rather complicated since Access doesn&#39;t offer a built-in way to get the hWnd for a form control."}], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1542197271, "post_id": 53299757, "comment_id": 93480320, "body": "Selecting and unselecting an item in a listbox does just that, nothing else. It doesn&#39;t scroll to the item being selected (for me on Access 2016 using a multi-select list box, at least)"}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1542197669, "post_id": 53299757, "comment_id": 93480515, "body": "I&#39;ve tested that before, of course. It scrolled correctly to the position. Works with listbox controls <code>Multi Select</code> set to <code>Simple</code> and <code>Extended</code>. Microsoft Access 2013."}, {"owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "edited": false, "score": 0, "creation_date": 1542197669, "post_id": 53299757, "comment_id": 93480516, "body": "On the listbox I&#39;m using (Access 2016 (Office 365), when a row is selected, it&#39;s position is being scrolled to."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1542198135, "post_id": 53299757, "comment_id": 93480802, "body": "Well, the only thing I can say is that this is undocumented behavior and just doesn&#39;t work for me (Build 9126). Your mileage may vary, apparently. If you&#39;re going to deploy it, I&#39;d do extensive testing beforehand."}], "tags": [], "owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "is_accepted": true, "score": 1, "last_activity_date": 1542196777, "creation_date": 1542196777, "answer_id": 53299757, "question_id": 53298879, "link": "https://stackoverflow.com/questions/53298879/moving-to-position-of-multi-select-listbox/53299757#53299757", "title": "Moving to position of multi select listbox", "body": "<p>This should work fine:</p>\n\n<pre><code>Dim index As Long\nWith lstComm\n    Dim match As Boolean\n    For index = 0 To .ListCount - 1\n        If .Column(1, index) = txtSearch.Value Then\n            match = True\n            Exit For\n        End If\n    Next\n\n    If Not match Then Exit Sub\n\n    Dim isSelected As Boolean\n    isSelected = .Selected(index)\n\n    .Selected(index) = True\n    .Selected(index) = isSelected\nEnd With\n</code></pre>\n\n<p>It retrieves the searched item of the listbox.</p>\n\n<p>If no item has been found it exists.</p>\n\n<p>Otherwise it stores the current selection state of that item, selects it to position the listbox, and restores the stored state of the item.</p>\n"}], "owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 53299757, "answer_count": 1, "score": 0, "last_activity_date": 1542196777, "creation_date": 1542193942, "last_edit_date": 1542194626, "question_id": 53298879, "link": "https://stackoverflow.com/questions/53298879/moving-to-position-of-multi-select-listbox", "title": "Moving to position of multi select listbox", "body": "<p>I have a multi select listbox, which I would like to make searchable. If the searched for value is found in the listbox, I'd like to scroll to that position, but not select it. Is this possible? The code I have so far for searching is :-</p>\n\n<pre><code>With lstComm\n    For i = 0 To .ListCount - 1\n        If .Column(6, i) = txtSearch.Value Then\n\n        End If\n    Next i\nEnd With\n</code></pre>\n\n<p>...but I'm not sure how to complete the scroll.</p>\n"}, {"tags": ["excel", "vba", "row-number", "autofilter"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542193197, "post_id": 53298598, "comment_id": 93477974, "body": "Did you try <code>NumberOfRows = xlsRangeAutoFilter.Rows.Count</code>?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1542193523, "post_id": 53298598, "comment_id": 93478168, "body": "Are you asking for the number of Rows?  Or, what the first Row is?  Or an Array of <i>all</i> the Row Numbers?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1542195330, "post_id": 53298598, "comment_id": 93479203, "body": "(Also, the option that P\u1d07\u029c provided will only work if the filtered rows are contiguous - otherwise you will need run a loop <code>For Each</code> Area <code>In xlsRangeAutoFilter.Areas</code> and add up the rows in each block)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1542201357, "post_id": 53298598, "comment_id": 93482699, "body": "@Chronocidal You are right. I posted an answer using Subtotal."}, {"owner": {"reputation": 33, "user_id": 5749045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd34b4bf44ed30cbc1c65f2bff91b0f?s=128&d=identicon&r=PG&f=1", "display_name": "informer", "link": "https://stackoverflow.com/users/5749045/informer"}, "edited": false, "score": 0, "creation_date": 1542204402, "post_id": 53298598, "comment_id": 93484754, "body": "I don&#39;t want Number of rows but row number for each filtered line"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1542204988, "last_edit_date": 1542204988, "creation_date": 1542201297, "answer_id": 53301115, "question_id": 53298598, "link": "https://stackoverflow.com/questions/53298598/get-row-number-of-autofiletred-lines-in-excel-with-vba/53301115#53301115", "title": "Get row number of autofiletred lines in Excel with VBA", "body": "<p>You can use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.subtotal\" rel=\"nofollow noreferrer\">WorksheetFunction.Subtotal method</a> to count the rows that are visible and have data in it (note visible blanks will not be counted):</p>\n\n<pre><code>NumberOfRows = Application.WorksheetFunction.Subtotal(3, xlsWkSheet.Range(\"A1:A\" &amp; xlsWkSheet.Range(\"A1\").CurrentRegion.Rows.Count))\n</code></pre>\n\n<p>or alternatively a more reliable method:</p>\n\n<pre><code>xlsWkSheet.AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n</code></pre>\n\n<hr>\n\n<p><em>Edit according to comment:</em></p>\n\n<p>To output all filtered row numbers you must loop through the areas.</p>\n\n<pre><code>    With .Range(\"A1\").CurrentRegion\n        Dim Area As Range\n        For Each Area In .Columns(1).SpecialCells(xlCellTypeVisible).Cells.Rows.Areas\n            Dim AreaRow As Range\n            For Each AreaRow In Area.Rows\n\n                Debug.Print AreaRow.Row 'output each row number in intermediate window\n\n            Next AreaRow\n        Next Area\n    End With\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5749045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd34b4bf44ed30cbc1c65f2bff91b0f?s=128&d=identicon&r=PG&f=1", "display_name": "informer", "link": "https://stackoverflow.com/users/5749045/informer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 53301115, "answer_count": 1, "score": 0, "last_activity_date": 1586394479, "creation_date": 1542193074, "last_edit_date": 1586394479, "question_id": 53298598, "link": "https://stackoverflow.com/questions/53298598/get-row-number-of-autofiletred-lines-in-excel-with-vba", "title": "Get row number of autofiletred lines in Excel with VBA", "body": "<p>I want to get the row number of autofiltered lines.</p>\n\n<p>I used  this code </p>\n\n<pre><code>With xlsWkSheet      \n    With .Range(\"A1\").CurrentRegion\n        .AutoFilter Field:=4, Criteria1:=\"88684240\"\n        .AutoFilter Field:=19, Criteria1:=\"88684239\"            \n        Set xlsRangeAutoFilter = .SpecialCells(xlCellTypeVisible)\n    End With\nEnd With\n</code></pre>\n\n<p>But I have no idea how to use xlsRangeAutoFilter  to get row number of autofiltered (Visible) lines</p>\n\n<p>Thanks a lot for your help</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542194106, "post_id": 53298900, "comment_id": 93478539, "body": "Additionally I recommend to activate <code>Option Explicit</code>: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i> and declare all your variables properly."}, {"owner": {"reputation": 61, "user_id": 10579716, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owG9LJGVpUM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCPeXKzQKOefl_k96fsXIvEHUR1lA/mo/photo.jpg?sz=128", "display_name": "fallco shkoder", "link": "https://stackoverflow.com/users/10579716/fallco-shkoder"}, "edited": false, "score": 0, "creation_date": 1542195369, "post_id": 53298900, "comment_id": 93479231, "body": "I am getting an error in the range definition <code>col_search = ws1.Range(&quot;A3&quot;, Range(&quot;A&quot; &amp; Rows.Count).End(xlUp))</code> I guess that this is the wrong code of range definition. Can you help me out to define this range from the <code>&quot;A3&quot;</code> to the last cell in the column <code>A</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 61, "user_id": 10579716, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owG9LJGVpUM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCPeXKzQKOefl_k96fsXIvEHUR1lA/mo/photo.jpg?sz=128", "display_name": "fallco shkoder", "link": "https://stackoverflow.com/users/10579716/fallco-shkoder"}, "edited": false, "score": 0, "creation_date": 1542198608, "post_id": 53298900, "comment_id": 93481105, "body": "@fallcoshkoder Without seeing the declaration and initialization of your variables it&#39;s hard to tell what&#39;s wrong. Therefore please edit your original question and add the complete code part in the end of your question that you use right now. Also include the error message you get."}, {"owner": {"reputation": 61, "user_id": 10579716, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owG9LJGVpUM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCPeXKzQKOefl_k96fsXIvEHUR1lA/mo/photo.jpg?sz=128", "display_name": "fallco shkoder", "link": "https://stackoverflow.com/users/10579716/fallco-shkoder"}, "edited": false, "score": 0, "creation_date": 1542203023, "post_id": 53298900, "comment_id": 93483808, "body": "@ P\u1d07\u029c is something in this code, I have the columns <code>A</code> and <code>G</code> filled the <code>A</code> with Dates and the <code>G</code> with values I want to select all the <code>A</code> from <code>A3</code> and below until it reach the last row. <code>ws1.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row</code> and this is the <code>range</code> of <code>SUMIF</code> criteria is <code>last_day = ws1.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Value</code> as you helped me with the  <code>Value</code> and the <code>sum_range</code> will be inserted in the last row of <code>G</code>  <code>ws1.Cells(lastRow, 7).Value=SUMIF...</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 61, "user_id": 10579716, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owG9LJGVpUM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCPeXKzQKOefl_k96fsXIvEHUR1lA/mo/photo.jpg?sz=128", "display_name": "fallco shkoder", "link": "https://stackoverflow.com/users/10579716/fallco-shkoder"}, "edited": false, "score": 0, "creation_date": 1542203358, "post_id": 53298900, "comment_id": 93484051, "body": "No the code is correct, so the issue must be somewhere else. Please provide exactly all the information I asked for in my last comment, or I cannot help you. I need the complete relevant code part (including all variable definitions) and the error message (in your original question above)."}, {"owner": {"reputation": 61, "user_id": 10579716, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owG9LJGVpUM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCPeXKzQKOefl_k96fsXIvEHUR1lA/mo/photo.jpg?sz=128", "display_name": "fallco shkoder", "link": "https://stackoverflow.com/users/10579716/fallco-shkoder"}, "edited": false, "score": 0, "creation_date": 1542205460, "post_id": 53298900, "comment_id": 93485458, "body": "Code Updated as requested"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 61, "user_id": 10579716, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owG9LJGVpUM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCPeXKzQKOefl_k96fsXIvEHUR1lA/mo/photo.jpg?sz=128", "display_name": "fallco shkoder", "link": "https://stackoverflow.com/users/10579716/fallco-shkoder"}, "edited": false, "score": 0, "creation_date": 1542206178, "post_id": 53298900, "comment_id": 93485942, "body": "2 things: \u2022 <code>Dim ws1, ws2 As Worksheet</code> only declares <code>ws2 As Worksheet</code> but <code>ws1</code> as <code>Variant</code>. You must declare a type for <b>every</b> variable <code>Dim ws1 As Worksheet, ws2 As Worksheet</code>. \u2022 You need to specify the worksheet for <b>every</b> <code>Range</code>, <code>Rows</code> etc so add <code>ws1.</code> before the second range object <code>ws1.Range(&quot;A3&quot;, ws1.Range(&quot;A&quot; &amp; ws1.Rows.Count).End(xlUp))</code>"}, {"owner": {"reputation": 61, "user_id": 10579716, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owG9LJGVpUM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCPeXKzQKOefl_k96fsXIvEHUR1lA/mo/photo.jpg?sz=128", "display_name": "fallco shkoder", "link": "https://stackoverflow.com/users/10579716/fallco-shkoder"}, "edited": false, "score": 0, "creation_date": 1542208734, "post_id": 53298900, "comment_id": 93487643, "body": "Now is working but I am getting a <code>#VALUE</code> instead of the <code>SUM</code> of that column! Weird. Anyway thank you for the help maybe is something else wrong"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1542207523, "last_edit_date": 1542207523, "creation_date": 1542193999, "answer_id": 53298900, "question_id": 53298534, "link": "https://stackoverflow.com/questions/53298534/excel-vba-make-sumif-with-dynamic-range-criteria/53298900#53298900", "title": "Excel vba, make SUMIF with dynamic range criteria", "body": "<p>Change it to </p>\n\n<pre><code>last_day = ws1.Range(\"A\" &amp; ws1.Rows.Count).End(xlUp).Value\n</code></pre>\n\n<p>otherwise you get the row number of the last used row and not its value. </p>\n\n<p><strong>Additionally you mixed up <code>SumIf</code> and <code>SumIfs</code> which have different syntax order.</strong></p>\n\n<hr>\n\n<h3>SumIfs (multiple criteria)</h3>\n\n<p>And according to <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.sumifs\" rel=\"nofollow noreferrer\">WorksheetFunction.SumIfs method</a> the syntax is</p>\n\n<pre><code>SumIfs(RangeToSum, Criteria_range1, Criteria1, Criteria_range2, Criteria2, \u2026)\n</code></pre>\n\n<p>so I believe you need to switch the parameters and add a <code>\"=\" &amp;</code> in the criteria</p>\n\n<pre><code>SumIfs(col_contain, col_search, \"=\" &amp; last_day)\n</code></pre>\n\n<ul>\n<li><code>col_contain</code> = column to sum</li>\n<li><code>col_search</code> = column to test against criteria</li>\n</ul>\n\n<hr>\n\n<h3>SumIf (single criteria)</h3>\n\n<p>Or you use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.WorksheetFunction.SumIf\" rel=\"nofollow noreferrer\">WorksheetFunction.SumIf method</a>, where the syntax is</p>\n\n<pre><code>SumIf(Criteria_range, Criteria, RangeToSum)\n</code></pre>\n\n<p>Any you can use</p>\n\n<pre><code>SumIf( col_search, \"=\" &amp; last_day, col_contain)\n</code></pre>\n\n<hr>\n\n<p>Note that I recommend to reduce the code a bit and remove the unnecessary variables. Also use meaningful variable names like <code>wsDB</code> and <code>wsEmails</code> which are much easier to read and understand than meaningless numbered variables or single letter variables like <code>a</code>, <code>b</code>, <code>c</code> \u2026</p>\n\n<p>Also it is a good practice to activate <code>Option Explicit</code>: In the VBA editor go to <em>Tools</em> \u203a <em>Options</em> \u203a <em><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></em> and declare all variables properly.</p>\n\n<pre><code>Option Explicit\n\nSub YourProcedureName()\n    Dim wsDB As Worksheet\n    Set wsDB = ThisWorkbook.Sheets(\"DataBase\")\n\n    Dim wsEmails As Worksheet\n    Set wsEmails = ThisWorkbook.Sheets(\"Emails\")\n\n    'm = wsEmails.Range(\"C7\") 'was not used at all\n\n    With wsDB\n        Dim NextFreeRow As Long\n        NextFreeRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row + 1\n\n        Dim Last_Day As String\n        Last_Day = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Value\n\n        Dim Col_Search As Range\n        Col_Search = .Range(\"A3\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n\n        Dim Col_Contain As Range\n        Col_Contain = .Range(\"G3\", .Range(\"G\" &amp; .Rows.Count).End(xlUp))\n    End With\n\n    With wsEmails\n        wsDB.Cells(NextFreeRow, 7).Value = Application.WorksheetFunction.SumIf(Col_Search, \"=\" &amp; Last_Day, Col_Contain)\n        wsDB.Cells(NextFreeRow, 1).Value = Date\n        wsDB.Cells(NextFreeRow, 2) = .Range(\"C1\")\n        wsDB.Cells(NextFreeRow, 3) = .Range(\"C2\")\n        wsDB.Cells(NextFreeRow, 4) = .Range(\"C3\")\n        wsDB.Cells(NextFreeRow, 5) = .Range(\"C5\")\n        wsDB.Cells(NextFreeRow, 6) = .Range(\"C6\")\n        wsDB.Cells(NextFreeRow, 8) = .Range(\"C8\")\n        wsDB.Cells(NextFreeRow, 9) = \"=RC[-1]-RC[-2]\"\n        wsDB.Cells(NextFreeRow, 9).Font.Bold = True\n        wsDB.Cells(NextFreeRow, 10) = .Range(\"C11\")\n        wsDB.Cells(NextFreeRow, 11) = .Range(\"C12\")\n        wsDB.Cells(NextFreeRow, 12) = .Range(\"C13\")\n        wsDB.Cells(NextFreeRow, 13) = .Range(\"C15\")\n        wsDB.Cells(NextFreeRow, 15) = \"=SUM(RC[-5]:RC[-1])\"\n        wsDB.Cells(NextFreeRow, 15).Font.Bold = True\n        wsDB.Cells(NextFreeRow, 16) = Application.WorksheetFunction.VLookup(.Range(\"C17\"), .Range(\"E18:F19\").Value, 2, False)\n        wsDB.Cells(NextFreeRow, 17) = Application.WorksheetFunction.VLookup(.Range(\"C18\"), .Range(\"E18:F19\").Value, 2, False)\n        wsDB.Cells(NextFreeRow, 18) = Application.WorksheetFunction.VLookup(.Range(\"C19\"), .Range(\"E18:F19\").Value, 2, False)\n        wsDB.Cells(NextFreeRow, 19) = Application.WorksheetFunction.VLookup(.Range(\"C20\"), .Range(\"E18:F19\").Value, 2, False)\n        wsDB.Cells(NextFreeRow, 20) = Application.WorksheetFunction.VLookup(.Range(\"C21\"), .Range(\"E18:F19\").Value, 2, False)\n        wsDB.Cells(NextFreeRow, 21) = \"=SUM(RC[-5]:RC[-1])\"\n        wsDB.Cells(NextFreeRow, 21).Font.Bold = True\n        wsDB.Cells(NextFreeRow, 22) = Application.WorksheetFunction.VLookup(.Range(\"C24\"), .Range(\"E25:F26\").Value, 2, False)\n        wsDB.Cells(NextFreeRow, 23) = Application.WorksheetFunction.VLookup(.Range(\"C25\"), .Range(\"E25:F26\").Value, 2, False)\n        wsDB.Cells(NextFreeRow, 24) = \"=SUM(RC[-2]:RC[-1])\"\n        wsDB.Cells(NextFreeRow, 24).Font.Bold = True\n        wsDB.Cells(NextFreeRow, 25) = \"=SUM(RC[-16]+RC[-10]+RC[-4]+RC[-1])\"\n        wsDB.Cells(NextFreeRow, 25).Font.Bold = True\n    End With\n\n\n    Dim TargetColumns As Variant\n    TargetColumns = Array(20, 23) 'Column numbers to place into.\n\n    Dim SourceCells As Range\n    Set SourceCells = ThisWorkbook.Worksheets(\"Emails\").Range(\"C22,C26\")\n\n    Dim x As Long\n\n    'Look at each cell in turn.\n    Dim rCell As Range\n    For Each rCell In SourceCells\n\n        'Find the last cell in the correct column.\n        Dim rAddToCell As Range\n        Set rAddToCell = LastCell(ThisWorkbook.Worksheets(\"DataBase\"), CLng(TargetColumns(x)))\n\n        'If there's already a comment then delete it first\n        'Then add value from SourceCell into comment in Target column.\n        With rAddToCell\n            If HasComment(rAddToCell) Then\n                .ClearComments\n            End If\n            .AddComment\n            .Comment.Text Text:=rCell.Value\n        End With\n\n        x = x + 1\n    Next rCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 10579716, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-owG9LJGVpUM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCPeXKzQKOefl_k96fsXIvEHUR1lA/mo/photo.jpg?sz=128", "display_name": "fallco shkoder", "link": "https://stackoverflow.com/users/10579716/fallco-shkoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1502, "favorite_count": 0, "accepted_answer_id": 53298900, "answer_count": 1, "score": 1, "last_activity_date": 1542207523, "creation_date": 1542192881, "last_edit_date": 1542205410, "question_id": 53298534, "link": "https://stackoverflow.com/questions/53298534/excel-vba-make-sumif-with-dynamic-range-criteria", "title": "Excel vba, make SUMIF with dynamic range criteria", "body": "<p>I have written a code in VBA do some automated tasks. Sheet1 is a form and the Sheet2 is a database where this data are stored. \nI would like to have also a <code>Button</code> when pressed to do a SUMIF in the last row.</p>\n\n<pre><code>SUMIF(Column containing search values, value to search for, column conaintining items to add)\n</code></pre>\n\n<p>My Code is as below</p>\n\n<pre><code>Dim ws1, ws2 As Worksheet\n\n\nSet ws1 = ThisWorkbook.Sheets(\"DataBase\")\nSet ws2 = ThisWorkbook.Sheets(\"Emails\")\nSet rngr = ws2.Range(\"C17\")\nSet rngs = ws2.Range(\"C18\")\nSet rngt = ws2.Range(\"C19\")\nSet rngu = ws2.Range(\"C20\")\nSet rngy = ws2.Range(\"C21\")\nSet rngw = ws2.Range(\"C24\")\nSet rngz = ws2.Range(\"C25\")\n\n\nh = ws2.Range(\"C1\")\ni = ws2.Range(\"C2\")\nj = ws2.Range(\"C3\")\ntot1 = \"=RC[-1]-RC[-2]\"\ntot2 = \"=SUM(RC[-5]:RC[-1])\"\ntot3 = \"=SUM(RC[-5]:RC[-1])\"\ntot4 = \"=SUM(RC[-2]:RC[-1])\"\ntot = \"=SUM(RC[-16]+RC[-10]+RC[-4]+RC[-1])\"\nk = ws2.Range(\"C5\")\nl = ws2.Range(\"C6\")\nm = ws2.Range(\"C7\")\nN = ws2.Range(\"C8\")\nf = ws2.Range(\"C11\")\no = ws2.Range(\"C12\")\np = ws2.Range(\"C13\")\nG = ws2.Range(\"C15\")\nr = Application.WorksheetFunction.VLookup(rngr, ws2.Range(\"E18:F19\").Value, 2, False)\ns = Application.WorksheetFunction.VLookup(rngs, ws2.Range(\"E18:F19\").Value, 2, False)\nt = Application.WorksheetFunction.VLookup(rngt, ws2.Range(\"E18:F19\").Value, 2, False)\nu = Application.WorksheetFunction.VLookup(rngu, ws2.Range(\"E18:F19\").Value, 2, False)\ny = Application.WorksheetFunction.VLookup(rngy, ws2.Range(\"E18:F19\").Value, 2, False)\nw = Application.WorksheetFunction.VLookup(rngw, ws2.Range(\"E25:F26\").Value, 2, False)\nZ = Application.WorksheetFunction.VLookup(rngz, ws2.Range(\"E25:F26\").Value, 2, False)\n\n\nlastRow = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\nlast_day = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Value\ncol_search = ws1.Range(\"A3\", Range(\"A\" &amp; Rows.Count).End(xlUp))\ncol_contain = ws1.Range(\"G3\", Range(\"G\" &amp; Rows.Count).End(xlUp))\n\nws1.Cells(lastRow, 7).Value = Application.WorksheetFunction.SumIf( col_search, \"=\" &amp; last_day, col_contain)\nws1.Cells(lastRow, 1).Value = Date\nws1.Cells(lastRow, 2) = h\nws1.Cells(lastRow, 3) = i\nws1.Cells(lastRow, 4) = j\nws1.Cells(lastRow, 5) = k\nws1.Cells(lastRow, 6) = l\nws1.Cells(lastRow, 8) = N\nws1.Cells(lastRow, 9) = tot1\nws1.Cells(lastRow, 9).Font.Bold = True\nws1.Cells(lastRow, 10) = f\nws1.Cells(lastRow, 11) = o\nws1.Cells(lastRow, 12) = p\nws1.Cells(lastRow, 13) = G\nws1.Cells(lastRow, 15) = tot2\nws1.Cells(lastRow, 15).Font.Bold = True\nws1.Cells(lastRow, 16) = r\nws1.Cells(lastRow, 17) = s\nws1.Cells(lastRow, 18) = t\nws1.Cells(lastRow, 19) = u\nws1.Cells(lastRow, 20) = y\nws1.Cells(lastRow, 21) = tot3\nws1.Cells(lastRow, 21).Font.Bold = True\nws1.Cells(lastRow, 22) = w\nws1.Cells(lastRow, 23) = Z\nws1.Cells(lastRow, 24) = tot4\nws1.Cells(lastRow, 24).Font.Bold = True\nws1.Cells(lastRow, 25) = tot\nws1.Cells(lastRow, 25).Font.Bold = True\n\n\nDim TargetColumns As Variant\nDim SourceCells As Range\nDim rCell As Range\nDim rAddToCell As Range\nDim x As Long\n\nTargetColumns = Array(20, 23) 'Column numbers to place into.\nSet SourceCells = ThisWorkbook.Worksheets(\"Emails\").Range(\"C22,C26\")\n\n'Look at each cell in turn.\nFor Each rCell In SourceCells\n\n    'Find the last cell in the correct column.\n    Set rAddToCell = LastCell(ThisWorkbook.Worksheets(\"DataBase\"), CLng(TargetColumns(x)))\n\n    'If there's already a comment then delete it first\n    'Then add value from SourceCell into comment in Target column.\n    With rAddToCell\n        If HasComment(rAddToCell) Then\n            .ClearComments\n        End If\n        .AddComment\n        .Comment.Text Text:=rCell.Value\n    End With\n\n    x = x + 1\nNext rCell\n\nEnd Sub\n</code></pre>\n\n<p>The value to search for will be the last date so practically from what I have is   </p>\n\n<pre><code>last_day = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p>My actual format of SUMIF is wrong as I am not getting the result wanted. Maybe my logic is wrong or the code itself is wrong</p>\n\n<pre><code>ws1.Cells(lastRow, 7).Value = Application.WorksheetFunction.SumIfs(col_search, last_day, col_contain)\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>Run-time error 1004\nApplication-defined or object-defined error\n</code></pre>\n\n<p>Any suggestion is welcome and thank you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1542192291, "post_id": 53298038, "comment_id": 93477444, "body": "What have you tried?  It would seem simple to enclose your existing loop within a <code>For Search_Config = x to y \u2026 Next Search_Config</code> loop."}, {"owner": {"reputation": 33, "user_id": 10493783, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jnziq3Ds0bQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXgQ_YPMlRgHcCstz-mQVmGnO_U8Q/mo/photo.jpg?sz=128", "display_name": "Mattijn Stegeman", "link": "https://stackoverflow.com/users/10493783/mattijn-stegeman"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1542192439, "post_id": 53298038, "comment_id": 93477551, "body": "@RonRosenfeld That&#39;s what I thought... But Excel seems to crash (no responce). Excel gives me an &quot;Offset failure&quot;."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1542192856, "post_id": 53298038, "comment_id": 93477778, "body": "I&#39;ve never seen that Excel error. and a Google search is unrevealing.  So the error must be coming from something else in your system."}, {"owner": {"reputation": 33, "user_id": 10493783, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jnziq3Ds0bQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXgQ_YPMlRgHcCstz-mQVmGnO_U8Q/mo/photo.jpg?sz=128", "display_name": "Mattijn Stegeman", "link": "https://stackoverflow.com/users/10493783/mattijn-stegeman"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1542193033, "post_id": 53298038, "comment_id": 93477884, "body": "@RonRosenfeld Method Of Range Class Failed"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1542193586, "post_id": 53298038, "comment_id": 93478211, "body": "That is a VBA error message. Is that the Exact message?  Usually that type of message refers to a specific method. What line causes the error?  What are the values of the different parameters in that line when the error occurs? That&#39;s some of what you need to troubleshoot the problem."}, {"owner": {"reputation": 33, "user_id": 10493783, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jnziq3Ds0bQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXgQ_YPMlRgHcCstz-mQVmGnO_U8Q/mo/photo.jpg?sz=128", "display_name": "Mattijn Stegeman", "link": "https://stackoverflow.com/users/10493783/mattijn-stegeman"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1542203077, "post_id": 53298038, "comment_id": 93483848, "body": "@RonRosenfeld Nothing at all. Just a crash. Kinda anoying grrrr... method range object _worksheet failed"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1542221282, "post_id": 53298038, "comment_id": 93494485, "body": "I don&#39;t understand your response.  I understand a crash to mean the program shuts down or freezes, so you would not get an error message.  If there is an error message, and you select the <code>Debug</code> option from the dialog, that should take you to a particular line in the code."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 10493783, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jnziq3Ds0bQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXgQ_YPMlRgHcCstz-mQVmGnO_U8Q/mo/photo.jpg?sz=128", "display_name": "Mattijn Stegeman", "link": "https://stackoverflow.com/users/10493783/mattijn-stegeman"}, "is_accepted": true, "score": 0, "last_activity_date": 1542358258, "creation_date": 1542358258, "answer_id": 53334336, "question_id": 53298038, "link": "https://stackoverflow.com/questions/53298038/excel-vba-facing-some-issues/53334336#53334336", "title": "Excel VBA, Facing some issues", "body": "<pre><code>For Search_Config = 0 To 200\nFor Search_Library = 0 To 200\n    j = Search_Library * 20\n    If (Worksheets(\"Config Algemeen\").Range(\"H2\").offset(Search_Config, 0).Value = Worksheets(\"Library\").Range(\"A2\").offset(j, 0).Value) And Not (Worksheets(\"Config Algemeen\").Range(\"H2\").offset(Search_Config, 0).Value = \"\") Then\n        For k = 1 To 200\n            l = k * 2\n            n = l - 1\n            For m = 0 To 19\n                MyChoices(m) = Worksheets(\"Library\").Range(\"A2\").offset(j + m, l).Value\n            Next m\n                With Worksheets(\"Config Algemeen\").Range(\"H2\").offset(Search_Config, k)\n                    If Not Worksheets(\"Library\").Cells(2 + j, 1 + n).Value = \"\" Then\n                        .AddComment Worksheets(\"Library\").Cells(2 + j, 1 + n).Value\n                    Else\n                        'Nothing\n                    End If\n                    If Worksheets(\"Library\").Range(\"A2\").offset(j, l).Value = \"*VALUE*\" Or Worksheets(\"Library\").Range(\"A2\").offset(j, l).Value = \"\" Then\n                        'Nothing\n                    Else\n                        .Validation.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n                        Operator:=xlBetween, Formula1:=Join(MyChoices, \",\")\n                    End If\n                End With\n        Next k\n    Else\n        'Nothing\n    End If\nNext Search_Library\nNext Search_Config\n</code></pre>\n\n<p>It's working like this now. And everything seems fine. It's quick and solit as rock. Thank you for helping me! It brought me on the right track.</p>\n"}], "owner": {"reputation": 33, "user_id": 10493783, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jnziq3Ds0bQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXgQ_YPMlRgHcCstz-mQVmGnO_U8Q/mo/photo.jpg?sz=128", "display_name": "Mattijn Stegeman", "link": "https://stackoverflow.com/users/10493783/mattijn-stegeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 53334336, "answer_count": 1, "score": 0, "last_activity_date": 1542358258, "creation_date": 1542191409, "last_edit_date": 1542191781, "question_id": 53298038, "link": "https://stackoverflow.com/questions/53298038/excel-vba-facing-some-issues", "title": "Excel VBA, Facing some issues", "body": "<p>I have this code:</p>\n\n<pre><code>For Search_Library = 0 To 200\n    j = Search_Library * 20\n    If Worksheets(\"Config Algemeen\").Range(\"H2\").offset(Search_Config, 0).Value = Worksheets(\"Library\").Range(\"A2\").offset(j, 0).Value Then\n        For k = 1 To 200\n            l = k * 2\n            For m = 0 To 19\n                MyChoices(m) = Worksheets(\"Library\").Range(\"A2\").offset(j + m, l).Value\n            Next m\n                With Worksheets(\"Config Algemeen\").Range(\"H2\").offset(Search_Config, k).Validation\n                    .Delete\n                    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n                    Operator:=xlBetween, Formula1:=Join(MyChoices, \",\")\n                End With\n        Next k\n    Else\n        'Nothing\n    End If\nNext Search_Library\n</code></pre>\n\n<p>Now I'm facing a problem: I want to loop through \"Search_Config\" each time when \"Search_Library\" reach a value of 200 (max value). What  is the best way to loop through \"Search_Config\" as well? Basically I want to do add 1 (+1) to \"Search_Config\" and start from zero (0) with \"Search_Library\".</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10191387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbaaabff0c4ef40f2acbe6dd3fecdc72?s=128&d=identicon&r=PG&f=1", "display_name": "Susanne Lysgaard", "link": "https://stackoverflow.com/users/10191387/susanne-lysgaard"}, "edited": false, "score": 0, "creation_date": 1543230713, "post_id": 53297894, "comment_id": 93829445, "body": "When deleting a row in the sheet, it gives an 1004 error pointing at the [set foundval]area.. Can you explain why?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 25, "user_id": 10191387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbaaabff0c4ef40f2acbe6dd3fecdc72?s=128&d=identicon&r=PG&f=1", "display_name": "Susanne Lysgaard", "link": "https://stackoverflow.com/users/10191387/susanne-lysgaard"}, "edited": false, "score": 0, "creation_date": 1543232041, "post_id": 53297894, "comment_id": 93830151, "body": "The only error that jumps out at me would be that by deleting an entire row, or column would mean you&#39;re working on more than one cell - the <code>FIND</code> command excepts a single value.  I&#39;ve updated the code to make sure the <code>Change</code> event only fires when a single cell is changed."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1543232115, "last_edit_date": 1543232115, "creation_date": 1542190965, "answer_id": 53297894, "question_id": 53297559, "link": "https://stackoverflow.com/questions/53297559/worksheet-change-trouble-working-on-multiple-columns/53297894#53297894", "title": "Worksheet_Change trouble working on multiple columns", "body": "<p>There's only one <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\">Worksheet_Change</a> event that fires whenever a cell is changed.  </p>\n\n<p><code>Private Sub Worksheet_ChangeS(ByVal Target As Range)</code> would have to be \"manually\" called from the <code>Worksheet_Change</code> event to work as it's a user defined procedure.  </p>\n\n<p>You should delete those three procedures and using something along the lines of:  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim lCol As Long\n    Dim foundVal As Range\n\n    Application.EnableEvents = False\n\n    If Not Intersect(Target, Range(\"S:U\")) Is Nothing Then\n\n        If Target.Cells.Count = 1 Then 'Check a single cell is changing.\n            Select Case Target.Column\n                Case 19 'col S\n                    lCol = 1\n                Case 20 'col T\n                    lCol = 4\n                Case 21 'col U\n                    lCol = 9\n            End Select\n\n            Set foundVal = Worksheets(\"DropDown\").Columns(lCol).Find( _\n                Target.Value, LookIn:=xlValues, LookAt:=xlWhole)\n\n            If Not foundVal Is Nothing Then\n                Target = foundVal.Offset(, 1)\n            End If\n        End If\n    End If\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Although looking at the range you then try and use <code>FIND</code> on you should be able to offset from the Target column and do the find in a single statement rather than three.  </p>\n\n<p><strong>Edit:</strong><br>\nI've updated the code to include <code>EnableEvents</code>.  At the end of your code you change the value of <code>Target</code> which would cause the <code>Worksheet_Change</code> event to fire again.  <code>EnableEvents</code> stops that from happening.  </p>\n\n<p><strong>Edit 2:</strong><br>\nI've updated the code to use a single <code>FIND</code>.  The <code>Select Case</code> gives the column to search in the <code>FIND</code> command.  </p>\n\n<p><strong>Note:</strong><br>\nIf your code crashes for any reason you may need to open the immediate window (<code>Ctrl+G</code>) and type in <code>Application.EnableEvents = True</code> as this does not reset when the code stops - you'll just notice that all your event code stops firing.</p>\n"}], "owner": {"reputation": 25, "user_id": 10191387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbaaabff0c4ef40f2acbe6dd3fecdc72?s=128&d=identicon&r=PG&f=1", "display_name": "Susanne Lysgaard", "link": "https://stackoverflow.com/users/10191387/susanne-lysgaard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 53297894, "answer_count": 1, "score": -1, "last_activity_date": 1543232115, "creation_date": 1542189882, "question_id": 53297559, "link": "https://stackoverflow.com/questions/53297559/worksheet-change-trouble-working-on-multiple-columns", "title": "Worksheet_Change trouble working on multiple columns", "body": "<p>i have trouble getting this code to work on the last to columns (T and U) \nwhat can i do to change tis? </p>\n\n<p>code: </p>\n\n<pre><code>   Private Sub Worksheet_ChangeS(ByVal Target As Range) 'column s, structure\n    If Intersect(Target, Range(\"S:S\")) Is Nothing Then Exit Sub\n    Dim foundVal As Range\n    Set foundVal = Sheets(\"Dropdown\").Range(\"A:A\").Find(Target, LookIn:=xlValues, lookat:=xlWhole)\n    If Not foundVal Is Nothing Then\n        Target = foundVal.Offset(0, 1)\n    End If\nEnd Sub\n\nPrivate Sub Worksheet_ChangeT(ByVal Target As Range) 'column t, component\n    If Intersect(Target, Range(\"T:T\")) Is Nothing Then Exit Sub\n    Dim foundVal As Range\n    Set foundVal = Sheets(\"Dropdown\").Range(\"D:D\").Find(Target, LookIn:=xlValues, lookat:=xlWhole)\n    If Not foundVal Is Nothing Then\n        Target = foundVal.Offset(0, 1)\n    End If\nEnd Sub\n\nPrivate Sub Worksheet_ChangeU(ByVal Target As Range) 'column U, parameter\n    If Intersect(Target, Range(\"U:U\")) Is Nothing Then Exit Sub\n    Dim foundVal As Range\n    Set foundVal = Sheets(\"Dropdown\").Range(\"I:I\").Find(Target, LookIn:=xlValues, lookat:=xlWhole)\n    If Not foundVal Is Nothing Then\n        Target = foundVal.Offset(0, 1)\n    End If\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1542192383, "post_id": 53297535, "comment_id": 93477504, "body": "You are incrementing the outer for loop iterator <code>rowinres</code> also in the inner loops. Is that what you intend? Wouldn&#39;t <code>rowinres</code> become out of range too quickly?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1542192641, "post_id": 53297535, "comment_id": 93477652, "body": "Even if the <code>rowinres</code> loop loops more than once, you are overwriting your results as in each iteration of the outer loop the copy destinations in the inner loops (e.g. <code>Range(&quot;A&quot; &amp; i)</code>) will be re-used/overwritten."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1542192705, "post_id": 53297535, "comment_id": 93477683, "body": "I suggest you use the debugger to step through your code to see if it does what your intend it to do."}, {"owner": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1542193446, "post_id": 53297535, "comment_id": 93478116, "body": "Hi @Paul, The control variable &#39;rowinres&#39; can increment only till m, i.e 9, which is my requirement. My problem is to copy the entire range from source sheet &quot;A &amp; rowinres : M &amp; rowinres&quot;. The code I tried is <code>Sheets(&quot;Results&quot;).Range(&quot;A&quot; &amp; rowinres &amp; &quot;, M&quot; &amp; rowinres).Copy Destination:=Sheets(&quot;Final&quot;).Range(&quot;A&quot; &amp; i) </code> . This code copies only the A column of each row, but i wanted to copy the entire range from A:M. Please suggest me an update."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "edited": false, "score": 0, "creation_date": 1542194476, "post_id": 53298969, "comment_id": 93478750, "body": "This is exactly what i came here to update. Thank you very much for your support though!"}], "tags": [], "owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "is_accepted": true, "score": 1, "last_activity_date": 1542194262, "creation_date": 1542194262, "answer_id": 53298969, "question_id": 53297535, "link": "https://stackoverflow.com/questions/53297535/how-to-copy-the-values-in-a-range-from-one-sheet-to-and-paste-it-another-sheet-o/53298969#53298969", "title": "How to copy the values in a range from one sheet to and paste it another sheet on a predefied order using VBA?", "body": "<p>Try <strong>colon</strong> instead of <strong>comma</strong> in your copy range:</p>\n\n<pre><code>Sheets(\"Results\").Range(\"A\" &amp; rowinres &amp; \":M\" &amp; rowinres).Copy Destination:=Sheets(\"Final\").Range(\"A\" &amp; i)\n</code></pre>\n\n<p>A comma is used in functions such as <em>SUM()</em> but a colon is used to specify a range.</p>\n"}], "owner": {"reputation": 85, "user_id": 10651112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sgI7eXZPlB8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDnJqxI4yDOtAhKuqjLbaB9AB6eFg/mo/photo.jpg?sz=128", "display_name": "Moghen", "link": "https://stackoverflow.com/users/10651112/moghen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 1, "accepted_answer_id": 53298969, "answer_count": 1, "score": 3, "last_activity_date": 1586394515, "creation_date": 1542189803, "last_edit_date": 1586394515, "question_id": 53297535, "link": "https://stackoverflow.com/questions/53297535/how-to-copy-the-values-in-a-range-from-one-sheet-to-and-paste-it-another-sheet-o", "title": "How to copy the values in a range from one sheet to and paste it another sheet on a predefied order using VBA?", "body": "<p>I am trying to copy the values in a specific range from one sheet to another. While pasting the values to the new sheet, there should be a predefined order in which the values are pasted. </p>\n\n<p><img src=\"https://i.stack.imgur.com/GVbrK.png\" alt=\"\"></p>\n\n<hr>\n\n<p><img src=\"https://i.stack.imgur.com/bhROF.jpg\"></p>\n\n<p>I have created the program, but there comes an error in definition of For loop. Please note that in this example Num_Tacksta = 2, m = 9 (These two are variables). </p>\n\n<pre><code>Sub New_Try(m)\n\nDim n, i, j, x, k, a, rowinres, Num_Tacksta, Num_TackMul As Variant\nNum_Tacksta = Sheets(\"ALLO\").Range(\"E4\").Value\nNum_TackMul = (Sheets(\"ALLO\").Range(\"E4\").Value) * 2\nx = Sheets(\"ALLO\").Range(\"E4\").Value\n\n\nFor rowinres = 2 To Num_Tacksta Step 1\n    For i = 2 To Num_TackMul Step 2\n        Sheets(\"Final\").Range(\"A\" &amp; rowinres &amp;, \",M\" &amp; rowinres).Copy Destination:=Sheets(\"Results\").Range(\"A\" &amp; i)\n        rowinres = rowinres + 1\n    Next i\n\n    For j = 3 To Num_TackMul Step 2\n        Sheets(\"Dummy_Result\").Range(\"A\" &amp; rowinres &amp;, \",M\" &amp; rowinres).Copy Destination:=Sheets(\"Results\").Range(\"A\" &amp; j)\n        rowinres = rowinres + 1\n    Next j\n\n    For k = Num_TackMul + 1 To m Step 1\n        Sheets(\"Dummy_Result\").Range(\"A\" &amp; rowinres &amp;, \",M\" &amp; rowinres).Copy Destination:=Sheets(\"Results\").Range(\"A\" &amp; k)\n        rowinres = rowinres + 1\n    Next k\n\nNext rowinres\n\n\nEnd Sub\n</code></pre>\n\n<p>To my basic Knowledge in VBA, I think the problem is in this <code>Sheets(\"Dummy_Result\").Range(\"A:M\" &amp; rowinres).Copy Destination:=Sheets(\"Results\").Range(\"A\" &amp; j)</code> line. I would like to also ask if there is any simple method available. </p>\n\n<p>I am new to programming and also to Stack Overflow. Helping me in this would be really helpful! \nI thank you guys in advance. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1542190280, "post_id": 53297528, "comment_id": 93476164, "body": "<a href=\"https://stackoverflow.com/a/52467171/5448626\">stackoverflow.com/a/52467171/5448626</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10442526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb558cd6dc215ce0ace3fec781186ecd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Koen", "link": "https://stackoverflow.com/users/10442526/g-koen"}, "edited": false, "score": 0, "creation_date": 1542191149, "post_id": 53297651, "comment_id": 93476728, "body": "What do you mean with &quot; &#39;&lt;== should be full filepath of file&quot;? Do I simply copy the filepath to this line? If I don&#39;t add anything I get the error &quot;sorry we could&#39;nt find filename. Is it possible it was moved, renamed or deleted?&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 33, "user_id": 10442526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb558cd6dc215ce0ace3fec781186ecd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Koen", "link": "https://stackoverflow.com/users/10442526/g-koen"}, "edited": false, "score": 0, "creation_date": 1542191671, "post_id": 53297651, "comment_id": 93477034, "body": "The cells you are reading in from should contain the full file path to the file I believe  C:\\Users\\path.....\\workbookX.xlsx."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 33, "user_id": 10442526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb558cd6dc215ce0ace3fec781186ecd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Koen", "link": "https://stackoverflow.com/users/10442526/g-koen"}, "edited": false, "score": 0, "creation_date": 1542195568, "post_id": 53297651, "comment_id": 93479329, "body": "Did you try that?"}, {"owner": {"reputation": 33, "user_id": 10442526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb558cd6dc215ce0ace3fec781186ecd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Koen", "link": "https://stackoverflow.com/users/10442526/g-koen"}, "edited": false, "score": 0, "creation_date": 1542261179, "post_id": 53297651, "comment_id": 93506762, "body": "I&#39;m not sure I understand. The files that have to be read are all in the same directory, C:\\Users\\path...\\workbookX.xlsx. Each one of these workbooks is defined in sheet 4 range B3:B231 with just the filename itself. workbook1.xlsx, workbook2.xlsx, etc. ."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 33, "user_id": 10442526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb558cd6dc215ce0ace3fec781186ecd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Koen", "link": "https://stackoverflow.com/users/10442526/g-koen"}, "edited": false, "score": 0, "creation_date": 1542263000, "post_id": 53297651, "comment_id": 93507394, "body": "You need concatenate the path on the name before passing to workbooks.open"}, {"owner": {"reputation": 33, "user_id": 10442526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb558cd6dc215ce0ace3fec781186ecd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Koen", "link": "https://stackoverflow.com/users/10442526/g-koen"}, "edited": false, "score": 0, "creation_date": 1542286235, "post_id": 53297651, "comment_id": 93519722, "body": "I&#39;ve slightly altered the code, based on yours. And got it to work. Thank you."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1542190510, "last_edit_date": 1542190510, "creation_date": 1542190200, "answer_id": 53297651, "question_id": 53297528, "link": "https://stackoverflow.com/questions/53297528/for-each-open-specified-workbooks-in-array/53297651#53297651", "title": "For Each - Open specified workbooks in array", "body": "<p>Try something like the following. A For Loop is faster than a For Each for arrays and using Transpose turns it into a one dimensional array to loop over.</p>\n\n<pre><code>Dim dirArray()\ndirArray = Application.Transpose(ThisWorkbook.Worksheets(\"Sheet4\").Range(\"B3:B231\").Value)\n\nFor i = LBound(dirArray) To Ubound(dirArray)\n    If instr(dirArray(i),\"xls\") &gt; 0 Then '&lt;== very basic check\n        Workbooks.Open(dirArray(i))  '&lt;== should be full filepath of file\n        ' Do stuff\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10442526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb558cd6dc215ce0ace3fec781186ecd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Koen", "link": "https://stackoverflow.com/users/10442526/g-koen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 53297651, "answer_count": 1, "score": -1, "last_activity_date": 1542190510, "creation_date": 1542189791, "question_id": 53297528, "link": "https://stackoverflow.com/questions/53297528/for-each-open-specified-workbooks-in-array", "title": "For Each - Open specified workbooks in array", "body": "<p>I have about 200ish workbooks That I need opened in a dir containing thousands of files. The name of these 200 files have been placed in <code>Sheet 4 B3:B231</code>.</p>\n\n<p><strong>Whenever I run the macro however, I only get the code to work on 4 of these files, 1 of the 4 isn't even mentioned in the specified range.</strong>  </p>\n\n<pre><code>Dim wb As Workbook, shtDest As Worksheet\nDim MyFile As String\nDim Filepath As String\nDim WoBo As Variant\nDim DirArray As Variant\nDirArray = Sheets(\"Sheet4\").Range(\"B3:B231\").Value\n\nFilepath = \"C:\\\"\nMyFile = Dir(Filepath)\n\nSet shtDest = ThisWorkbook.Sheets(\"Sheet1\")\n\nFor Each WoBo In DirArray\n      'code  \nNext WoBo\nEnd Sub\n</code></pre>\n\n<p>I'm quite new to arrays and I don't really understand the For Each line, so I suspect the error to be there.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1542193022, "post_id": 53298191, "comment_id": 93477872, "body": "I wouldn&#39;t return the <code>Row</code> on the same line as the <code>FIND</code> as it will throw an error if nothing is found.  Perform the find to return range object, check that it&#39;s not nothing and then get the row number from it."}, {"owner": {"reputation": 67, "user_id": 10590571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69578eac97dfe20f563bae4ca297998?s=128&d=identicon&r=PG&f=1", "display_name": "RVH", "link": "https://stackoverflow.com/users/10590571/rvh"}, "edited": false, "score": 0, "creation_date": 1542198573, "post_id": 53298191, "comment_id": 93481082, "body": "thank you so much! After the line: Cells(ABRow, LastCol).Activate, do you know the code for copying that selected cell and pasting it as a value and not with the formula? I am aware of the paste special feature but i am not sure how to copy it correctly after selecting it."}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1542201668, "post_id": 53298191, "comment_id": 93482905, "body": "You re welcome, you don t need to copy paste you can write: <code>Cells(x,y) = cells(ABRow,LastCol).Value</code>"}, {"owner": {"reputation": 67, "user_id": 10590571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69578eac97dfe20f563bae4ca297998?s=128&d=identicon&r=PG&f=1", "display_name": "RVH", "link": "https://stackoverflow.com/users/10590571/rvh"}, "edited": false, "score": 0, "creation_date": 1542205956, "post_id": 53298191, "comment_id": 93485778, "body": "Thank you. I edited the code above to include the additions, but I am not sure across multiple sheets how to avoid the clipboard, and also to copy and  paste as values and not formulas. Dw if not but appreciate it"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1542206144, "post_id": 53298191, "comment_id": 93485913, "body": "I would guess that the answer remains something like:  <code>Sheets(&quot;xxx&quot;).Cells(x,y) = Sheets(&quot;Vegetables&quot;).cells(ABRow,LastCol).Value</code>"}, {"owner": {"reputation": 67, "user_id": 10590571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69578eac97dfe20f563bae4ca297998?s=128&d=identicon&r=PG&f=1", "display_name": "RVH", "link": "https://stackoverflow.com/users/10590571/rvh"}, "edited": false, "score": 0, "creation_date": 1542206696, "post_id": 53298191, "comment_id": 93486270, "body": "thank you!! and where would I place this line of code so it copies from sheet xxx to sheet vegetables?"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1542207143, "post_id": 53298191, "comment_id": 93486575, "body": "From sheet xxx to sheet vegetables it s the other way around:  <code>Sheets(&quot;Vegetables&quot;).Cells(ABRow,LastCol) = Sheets(&quot;xxx&quot;).cells(x,y).Value</code> And you place the line where you want, it just depends when you want to copy paste :)"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1542207193, "post_id": 53298191, "comment_id": 93486605, "body": "More points about the copy paste here at the well known Ozgrid: <a href=\"https://www.ozgrid.com/VBA/SpeedingUpVBACode.htm\" rel=\"nofollow noreferrer\">ozgrid.com/VBA/SpeedingUpVBACode.htm</a>"}], "tags": [], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "is_accepted": true, "score": 2, "last_activity_date": 1542193734, "last_edit_date": 1542193734, "creation_date": 1542191806, "answer_id": 53298191, "question_id": 53297482, "link": "https://stackoverflow.com/questions/53297482/active-cell-find-last-column-in-a-row-vba/53298191#53298191", "title": "active cell find last column in a row vba", "body": "<p>You can do it by finding the row of the cell with the help of <code>find</code> and <code>.row</code> and then checking the last column before activating the cell. </p>\n\n<pre><code>Option Explicit\n\n    Sub test()\n\n    Dim LastCol As Long\n    Dim ABRow As Long\n    Dim ABrange As Range\n\n      Set ABrange = Cells.Find(What:=\"Apples and Banana\", After:=ActiveCell, LookIn:= _\n        xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n        xlNext, MatchCase:=False, SearchFormat:=False)\n\n    If Not ABrange Is Nothing Then\n        ABRow = ABrange.Row\n    End If\n\n    LastCol = Cells(ABRow, Columns.Count).End(xlToLeft).Column\n\n    Cells(ABRow, LastCol).Activate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10590571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69578eac97dfe20f563bae4ca297998?s=128&d=identicon&r=PG&f=1", "display_name": "RVH", "link": "https://stackoverflow.com/users/10590571/rvh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 53298191, "answer_count": 1, "score": 1, "last_activity_date": 1586394551, "creation_date": 1542189670, "last_edit_date": 1586394551, "question_id": 53297482, "link": "https://stackoverflow.com/questions/53297482/active-cell-find-last-column-in-a-row-vba", "title": "active cell find last column in a row vba", "body": "<p>I've got this code that finds a specific cell, and then then makes the active cell one to the right of this. </p>\n\n<p>However, I want to make it so that it finds the cell with apples and bananas in it, and instead makes the active cell the cell in the last used column of the same row as the original found apples and bananas cell is in. </p>\n\n<p>I hope this makes sense and I appreciate any help. </p>\n\n<p>Thanks. </p>\n\n<pre><code>Cells.Find(What:=\"Apples and Banana\", After:=ActiveCell, LookIn:= _\n    xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n    xlNext, MatchCase:=False, SearchFormat:=False).Activate\n    ActiveCell.Offset(0, 1).Select\n</code></pre>\n"}, {"tags": ["vba", "language-lawyer"], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1542190937, "post_id": 53297644, "comment_id": 93476589, "body": "A good one, I expected it to raise a compile time byref mismatch which it does not. But this kind of problems are usually <a href=\"https://stackoverflow.com/a/10262247/11683\">worked around</a> with <code>Call testSub((myInt))</code>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1542191746, "post_id": 53297644, "comment_id": 93477082, "body": "In your example <code>myInt</code> is also passed as <code>Variant</code>, but <a href=\"https://stackoverflow.com/a/31637346/11683\">with <code>VT_BYREF</code></a>. The <code>()</code> remove that flag. It&#39;s an interesting subject with interesting results, e.g. see <a href=\"https://stackoverflow.com/q/52686198/11683\">stackoverflow.com/q/52686198/11683</a>."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1542192435, "post_id": 53297644, "comment_id": 93477549, "body": "@GSerg: Just for curiosity: Do you know any way to read the VT-Flags within VBA?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1542192549, "post_id": 53297644, "comment_id": 93477602, "body": "Yes, read the first two bytes starting at <code>VarPtr(that_variable)</code>. An example: <a href=\"https://stackoverflow.com/a/43554246/11683\">stackoverflow.com/a/43554246/11683</a>"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 2, "last_activity_date": 1542190183, "creation_date": 1542190183, "answer_id": 53297644, "question_id": 53297450, "link": "https://stackoverflow.com/questions/53297450/when-is-the-vba-cvar-function-actually-useful/53297644#53297644", "title": "When is the VBA CVar function actually useful?", "body": "<p>I cannot think about a real life usage for the following, but at least it shows that you <em>could</em> need the function:</p>\n\n<pre><code>Sub test()\n    Dim myInt As Integer\n    myInt = 2\n    ' The following call will throw a runtime error in testSub\n    Call testSub(myInt)   \n    ' That's okay\n    Call testSub(CVar(myInt))\nEnd Sub\n\nSub testSub(ByRef p As Variant)\n    Debug.Print \"P: \" &amp; VarType(p)\n    p = \"ABC\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "edited": false, "score": 0, "creation_date": 1542200844, "post_id": 53298588, "comment_id": 93482368, "body": "Nice one! I thought about overloading, but rejected the idea, since VBA itself does not support it, and completely forgot about overload <i>consuming</i> with <code>As Any</code>."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 2, "last_activity_date": 1542193033, "creation_date": 1542193033, "answer_id": 53298588, "question_id": 53297450, "link": "https://stackoverflow.com/questions/53297450/when-is-the-vba-cvar-function-actually-useful/53298588#53298588", "title": "When is the VBA CVar function actually useful?", "body": "<p>Not sure if that qualifies, but the only thing I can think of is the interaction with <code>As Any</code> in <code>Declare</code>.</p>\n\n<pre><code>Private Declare PtrSafe Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" _\n  (Destination As Any, source As Any, ByVal Length As Long)\n\nSub Test()\n  Dim source As Long, dest As Long\n\n  source = 42\n\n  CopyMemory dest, CVar(source), 4\n  MsgBox dest\n\n  CopyMemory dest, source, 4\n  MsgBox dest\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1542202143, "creation_date": 1542189569, "question_id": 53297450, "link": "https://stackoverflow.com/questions/53297450/when-is-the-vba-cvar-function-actually-useful", "title": "When is the VBA CVar function actually useful?", "body": "<p>VBA implicitly converts values to <code>Variant</code> as needed, so what would be a use case of the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/type-conversion-functions\" rel=\"nofollow noreferrer\"><code>CVar</code> function</a>? In the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/type-conversion-functions#cvar-function-example\" rel=\"nofollow noreferrer\">example given in the documentation</a>, the call to <code>CVar</code> is obviously redundant.</p>\n\n<p>To be precise, I am looking for a <strong>concrete, minimal VBA code example</strong>, which</p>\n\n<ul>\n<li>compiles, but</li>\n<li>won't compile (or produce a different output) when (only!) <code>CVar(...some expression...)</code> is replaced by <code>...some expression...</code>.</li>\n</ul>\n\n<p>I haven't been able to find such an example, but maybe the someone else can.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1542189313, "post_id": 53297297, "comment_id": 93475572, "body": "This line needs to be in the procedure <code>Set Queue = New Collection</code> and just <code>Private Queue as collection</code> for define queue type"}, {"owner": {"reputation": 479, "user_id": 6892466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47e1040da114ac4f2336475ac969bc9a?s=128&d=identicon&r=PG&f=1", "display_name": "mneumann", "link": "https://stackoverflow.com/users/6892466/mneumann"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1542189453, "post_id": 53297297, "comment_id": 93475659, "body": "Where exactly do I have to put this and why?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1542189550, "post_id": 53297297, "comment_id": 93475718, "body": "In your procedure <code>Generate_Queue</code> just before you use <code>Queue</code> for the first time.  Google the <code>New</code> keyword in VBA."}, {"owner": {"reputation": 479, "user_id": 6892466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47e1040da114ac4f2336475ac969bc9a?s=128&d=identicon&r=PG&f=1", "display_name": "mneumann", "link": "https://stackoverflow.com/users/6892466/mneumann"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1542193025, "post_id": 53297297, "comment_id": 93477878, "body": "Thanks, this is what solved the problem."}], "answers": [{"tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": true, "score": 1, "last_activity_date": 1542192579, "creation_date": 1542192579, "answer_id": 53298425, "question_id": 53297297, "link": "https://stackoverflow.com/questions/53297297/reset-collections-after-running-a-vba-script/53298425#53298425", "title": "&quot;Reset&quot; collections after running a VBA script", "body": "<p>The answer is to not use the New keyword when you Dim the variable, especially when you define it outside of a procedure, since you don't directly control when it will be instantiated.</p>\n\n<p>If you need Queue and JobList to be available more widely then they're defined in the correct place, but when you execute Generate_Queue, that's probably when you should actually create the variables.</p>\n\n<p>So, at the top of your module:</p>\n\n<pre><code>Dim Queue As Collection\nDim JobList As Collection\n</code></pre>\n\n<p>And within Generate_Queue:</p>\n\n<pre><code>Set Queue = New Collection\nSet JobList = New Collection\n</code></pre>\n\n<p>So every time Generate_Queue is called, those two variables are created fresh (if that's what you want to happen).</p>\n"}], "owner": {"reputation": 479, "user_id": 6892466, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/47e1040da114ac4f2336475ac969bc9a?s=128&d=identicon&r=PG&f=1", "display_name": "mneumann", "link": "https://stackoverflow.com/users/6892466/mneumann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "accepted_answer_id": 53298425, "answer_count": 1, "score": -1, "last_activity_date": 1586394587, "creation_date": 1542189131, "last_edit_date": 1586394587, "question_id": 53297297, "link": "https://stackoverflow.com/questions/53297297/reset-collections-after-running-a-vba-script", "title": "&quot;Reset&quot; collections after running a VBA script", "body": "<p>I am not sure why VB is doing this since I don't have a lot of experience. Basically, the first time I run my script the output is what I expect, but the second time it looks completely wrong.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>'define queue type\nDim Queue As New Collection\n\n\n'define job list\nDim JobList As New Collection\n\n'loop parameters\nDim rng As Range, rng2 As Range\nDim rng_w As Range, rng_w2 As Range\n\nDim TimeRange As Double\n\n\n\n\n'loop over list and get jobs at frequency\nDim i As Double\nDim j As Integer\n\n\n\nSub Generate_Queue()\nThisWorkbook.Sheets(\"AGV capacity\").Activate\nSet rng = Range(\"L6:L7\")\nSet rng2 = Range(\"M6:M7\")\n\n'fill JobList\n\nDim Frequencies As Range\nSet Frequencies = rng\nDim Jobs As Range\nSet Jobs = rng2\nDim dividend\n\nTimeRange = ThisWorkbook.Sheets(\"AGV capacity\").Range(\"O6\") * 3600\n\n\n\nFor i = 1 To rng.Count\n    Set tmp = New Transport\n    tmp.Frequency = (TimeRange / Frequencies(i))\n    tmp.SourceDest = Jobs(i)\n    JobList.Add tmp\nNext i\n\ni = 1\n\n'while loop over time range (e.g. 24 hours)\nWhile i &lt; TimeRange\n    'for loop over number of entries in job list\n    For j = 1 To JobList.Count\n        'check if i is mod Frequency, meaning it should be added to the queue\n        If ((i Mod JobList(j).Frequency) = 0) Then\n            Set tmp = New Transport\n            dividend = (i / JobList(j).Frequency)\n\n            tmp.Frequency = ((dividend * JobList(j).Frequency) / 3600)\n            tmp.SourceDest = JobList(j).SourceDest\n            Queue.Add tmp\n        End If\n    Next j\ni = i + 1\nWend\n\nThisWorkbook.Sheets(\"order queue\").Activate\nSet rng_w = Range(\"A2\", \"A\" &amp; Queue.Count)\nSet rng_w2 = Range(\"B2\", \"B\" &amp; Queue.Count)\n\ni = 1\n\nFor i = 1 To 1000\n    rng_w(i).Value = \"\"\n    rng_w2(i).Value = \"\"\n\nNext i\n\nFor i = 1 To Queue.Count\n    rng_w(i).Value = Queue(i).Frequency\n    rng_w2(i).Value = Queue(i).SourceDest\n\nNext i  \nEnd Sub\n</code></pre>\n\n<p>I am working on two different Excel sheets, but the data that's read stays the same over the two runs. When I watch the different collections, they change with the same data set and sometimes are even created twice! Coming from other languages, I expected them to be deleted each run, but that does not seem to be the case. How can I \"reset\" these object?</p>\n"}, {"tags": ["vba", "string", "loops", "split", "hp-uft"], "comments": [{"owner": {"reputation": 1619, "user_id": 4661875, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/KeUsL.png?s=128&g=1", "display_name": "Bussller", "link": "https://stackoverflow.com/users/4661875/bussller"}, "edited": false, "score": 0, "creation_date": 1542192247, "post_id": 53297293, "comment_id": 93477419, "body": "Please post your efforts (in terms of code) so as to help you."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10647677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38eb98084af0dc127ca9cbf6e79cb092?s=128&d=identicon&r=PG&f=1", "display_name": "McRat", "link": "https://stackoverflow.com/users/10647677/mcrat"}, "edited": false, "score": 0, "creation_date": 1542211662, "post_id": 53298981, "comment_id": 93489501, "body": "Thank you very much @NeepNeepNeep. I will have to use the second part of your tip. I will let u know if its useful."}], "tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": true, "score": 0, "last_activity_date": 1542194301, "creation_date": 1542194301, "answer_id": 53298981, "question_id": 53297293, "link": "https://stackoverflow.com/questions/53297293/split-a-cell-in-uft/53298981#53298981", "title": "Split a cell in UFT", "body": "<p>Steps you need to take:</p>\n\n<ol>\n<li>Open the file</li>\n<li>Read a line</li>\n<li>Confirm the line is 360 characters</li>\n<li>Assign chunks of the line to different variables</li>\n<li>Do things with the variables</li>\n<li>Read another line and repeat until EOF</li>\n</ol>\n\n<p>1 &amp; 2:\nYour workbook needs a reference to the Microsoft Scripting Runtime in order to give you access to the FileSystemObject.  I'll let you research that.</p>\n\n<p>Create a FileSystemObject and use that to create a TextStream with the path to your file.</p>\n\n<pre><code>currentLine = textStream.ReadLine()\nDo Until textStream.EOF\n    If Len(currentLine) = 360 Then\n        firstChunk = Mid$(currentLine, 25, 10)\n        secondChunk = Mid$(currentLine, 36, 11)\n        thirdChunk = Mid$(currentLine, 48, 30)\n        fourthChunk = Mid$(currentLine, 78, 30)\n\n        ' Do stuff with chunks\n    End If\n    currentLine = textStream.ReadLine()\nLoop\n</code></pre>\n\n<p>In due course you could get fancy and have an array populated with paired items detailing  the starting point of a chunk and how many chars it is, something like:</p>\n\n<pre><code>Dim arrChunkPoints As Variant\nDim arrChunks As Variant\narrChunkPoints = Array(25,10, _\n                       36,11, _\n                       48,30, _\n                       78,30)\nReDim arrChunks(UBound(arrChunkPoints)\\2)   ' Integer returned\n</code></pre>\n\n<p>This would allow you to step over the items in arrChunkPoints and populate each element of arrChunks with a section of currentLine using Mid$(), but populated with the values from arrChunkPoints.  But this is probably for another day.</p>\n"}], "owner": {"reputation": 3, "user_id": 10647677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38eb98084af0dc127ca9cbf6e79cb092?s=128&d=identicon&r=PG&f=1", "display_name": "McRat", "link": "https://stackoverflow.com/users/10647677/mcrat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 53298981, "answer_count": 1, "score": 0, "last_activity_date": 1542197859, "creation_date": 1542189120, "last_edit_date": 1542197859, "question_id": 53297293, "link": "https://stackoverflow.com/questions/53297293/split-a-cell-in-uft", "title": "Split a cell in UFT", "body": "<p>I have a text document (.txt), there I have <code>n</code> lines that have to be split up, but the point is I don't have delimiter. I know the length of each variable that doesn't change.</p>\n\n<p>For example, the first variable is the from the 25 character to 35; the second one, from 36 to 47; then from 48 to 78, then from 79 to 119, and this until the 360th character of the line.</p>\n\n<p>I guess that the solution is by double loop, one for each line and the other one for each variable, but I cannot get it.</p>\n\n<p>If you need more information just ask, I am completely lost.</p>\n\n<p>Thankfully,</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1542191199, "post_id": 53297026, "comment_id": 93476753, "body": "Welcome to SO. The macro code should be in a module. Have you checked with VBA editor?"}, {"owner": {"reputation": 75, "user_id": 9617844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d4896e64f3d49ef6c9784da803b9c29?s=128&d=identicon&r=PG&f=1", "display_name": "Wittgenstein", "link": "https://stackoverflow.com/users/9617844/wittgenstein"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1542191451, "post_id": 53297026, "comment_id": 93476900, "body": "Yes, I cheked, but I found only function, which catch data with SQL command, but I can`t find this table."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1542193219, "post_id": 53297026, "comment_id": 93477982, "body": "If you have the table, then you got the source. Maybe is it hidden?"}, {"owner": {"reputation": 75, "user_id": 9617844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d4896e64f3d49ef6c9784da803b9c29?s=128&d=identicon&r=PG&f=1", "display_name": "Wittgenstein", "link": "https://stackoverflow.com/users/9617844/wittgenstein"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1542193824, "post_id": 53297026, "comment_id": 93478357, "body": "Yes, it was hidden! Thanks a lot!"}], "answers": [{"tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1542201962, "creation_date": 1542201962, "answer_id": 53301323, "question_id": 53297026, "link": "https://stackoverflow.com/questions/53297026/check-macro-in-access-2010/53301323#53301323", "title": "Check macro in Access 2010", "body": "<p>OP discovered the name of the table in the SQL sentence, but was not able to locate it. This was because it was hidden.</p>\n\n<p>To hide/unhide elements in the Nav Pane, you can read:</p>\n\n<blockquote>\n  <p><strong><a href=\"https://support.office.com/en-us/article/view-and-manage-objects-by-using-the-navigation-pane-274dfc5a-281b-472b-94e2-ef931c5cc590#__toc309049965\" rel=\"nofollow noreferrer\">View and manage objects by using the Navigation Pane</a></strong></p>\n</blockquote>\n"}], "owner": {"reputation": 75, "user_id": 9617844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d4896e64f3d49ef6c9784da803b9c29?s=128&d=identicon&r=PG&f=1", "display_name": "Wittgenstein", "link": "https://stackoverflow.com/users/9617844/wittgenstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542201962, "creation_date": 1542188294, "last_edit_date": 1542189267, "question_id": 53297026, "link": "https://stackoverflow.com/questions/53297026/check-macro-in-access-2010", "title": "Check macro in Access 2010", "body": "<p>Im trying to fix old MS Access file and i have to change popup menu, called by right click. Ive try to find some code in VBA, but i found there only the name of Macro which insert text from popup to form.\nWhen I go to Macro menu i only found name of this macro, but cant change it.</p>\n\n<p>What I should do to see where macro catch text data?</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 21, "user_id": 10651022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa5220a001a83df23b25e5f847c9f243?s=128&d=identicon&r=PG&f=1", "display_name": "Jinxster", "link": "https://stackoverflow.com/users/10651022/jinxster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1542187617, "creation_date": 1542187617, "question_id": 53296826, "link": "https://stackoverflow.com/questions/53296826/excel-vba-save-userform-controls-as-picture", "title": "EXCEL-VBA: Save userform controls as picture", "body": "<p>I'm trying to develop a macro that updates/generates the footer/header of excel files for my company. \nThe first version of this macro uses a sheet to store the required info (pics, text) and it works. \nI want to go one step further and eliminate the sheet where the macro info is stored by moving all required info in userforms.</p>\n\n<p>So, I have UserForm1 which has the company logo picture. This is saved using <code>SavePicture UserForm1.Logo.Picture, \"D:\\Logo.png\"</code> where Logo is an Image control.</p>\n\n<p>In UserForm2, I have a Frame control (named FooterText), populated with labels which need to be updated prior to saving the entire frame as png (or whatever picture format). Needless to say that <code>SavePicture UserForm2.FooterText.Picture, \"D:\\Footer.png\"</code> does not work. The text for the footer exceeds the limit set by office and as such, can only be added as a picture.</p>\n\n<p>Are there any options for me at this point? Is there a simple solution for exporting userform controls as picture? I don't want to complicate things by adding new references since it will be required by all company users.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1542185487, "post_id": 53295794, "comment_id": 93473210, "body": "What do you mean by autofill? Should it start with the same row as the one you want to fill? Should it always loop over next 7 rows? Maybe it fills cells but with incorrect values? Describe what is your goal"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1542185613, "post_id": 53295794, "comment_id": 93473284, "body": "An UDF only returns something to the cell it is called from. Use a sub if impacting on more than calling cell."}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1542185740, "post_id": 53295794, "comment_id": 93473344, "body": "Hard-coding input cells is a bad idea if you want the reference to change as you drag it down.  Can you tell us what you would like this function to do and why does it return a string if it tries to add a few numbers?  Cheers"}, {"owner": {"reputation": 23, "user_id": 10639522, "user_type": "registered", "profile_image": "https://graph.facebook.com/1986176611490470/picture?type=large", "display_name": "Osama Malik", "link": "https://stackoverflow.com/users/10639522/osama-malik"}, "edited": false, "score": 0, "creation_date": 1542185860, "post_id": 53295794, "comment_id": 93473418, "body": "barbsan Yes it should start with the same row as I want to fill. Yes the loop is fixed. I have edited the question to be more exact."}, {"owner": {"reputation": 23, "user_id": 10639522, "user_type": "registered", "profile_image": "https://graph.facebook.com/1986176611490470/picture?type=large", "display_name": "Osama Malik", "link": "https://stackoverflow.com/users/10639522/osama-malik"}, "edited": false, "score": 0, "creation_date": 1542186093, "post_id": 53295794, "comment_id": 93473543, "body": "QHarr cant use a sub as in that case I cant drag it down. then I have to manually make a macro for every row in the column."}, {"owner": {"reputation": 23, "user_id": 10639522, "user_type": "registered", "profile_image": "https://graph.facebook.com/1986176611490470/picture?type=large", "display_name": "Osama Malik", "link": "https://stackoverflow.com/users/10639522/osama-malik"}, "edited": false, "score": 0, "creation_date": 1542186177, "post_id": 53295794, "comment_id": 93473596, "body": "michal yes i agree. i just hard coded them to make the function to begin with as I am new to vba. now that i have made the function and validated it, I want it to be flexible."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1542187950, "post_id": 53295794, "comment_id": 93474698, "body": "Can&#39;t you set up your final table as an actual Excel table with  Ctrl + T so the column with the UDF is autopopulated?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10639522, "user_type": "registered", "profile_image": "https://graph.facebook.com/1986176611490470/picture?type=large", "display_name": "Osama Malik", "link": "https://stackoverflow.com/users/10639522/osama-malik"}, "edited": false, "score": 0, "creation_date": 1542188746, "post_id": 53297027, "comment_id": 93475218, "body": "That can not be used as in that case we have to write 8 different criterias for Sumif in J3 for every entry in the dashboard table. And this will not be possible if I go for more entries."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 23, "user_id": 10639522, "user_type": "registered", "profile_image": "https://graph.facebook.com/1986176611490470/picture?type=large", "display_name": "Osama Malik", "link": "https://stackoverflow.com/users/10639522/osama-malik"}, "edited": false, "score": 0, "creation_date": 1542189717, "post_id": 53297027, "comment_id": 93475828, "body": "@OsamaMalik Well it does exactly what your code does now. I don&#39;t see a difference. And I don&#39;t see why you would need 8 different criteria. Just pull the formula down it worked in my testing."}, {"owner": {"reputation": 23, "user_id": 10639522, "user_type": "registered", "profile_image": "https://graph.facebook.com/1986176611490470/picture?type=large", "display_name": "Osama Malik", "link": "https://stackoverflow.com/users/10639522/osama-malik"}, "edited": false, "score": 0, "creation_date": 1542189732, "post_id": 53297027, "comment_id": 93475836, "body": "It seems to be working yes. Let me apply it to original data. If it works you just saved my day ^_^. Ill mark tick in a minute"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1542188612, "last_edit_date": 1542188612, "creation_date": 1542188295, "answer_id": 53297027, "question_id": 53295794, "link": "https://stackoverflow.com/questions/53295794/drag-down-auto-fill-for-a-user-defined-function-vba/53297027#53297027", "title": "Drag down auto fill for a user defined function VBA", "body": "<p>Why to use a UDF? Don't re-invent the wheel. You can just do that with <code>SUMIFS</code></p>\n\n<pre><code>=SUMIFS($E$3:$E$10,$B$3:$B$10,\"=\" &amp; H3,$C$3:$C$10,\"&lt;=\" &amp; I3,$D$3:$D$10,\"&gt;\" &amp; I3)\n</code></pre>\n\n<p>Put the formula in J3 and pull it down.</p>\n"}], "owner": {"reputation": 23, "user_id": 10639522, "user_type": "registered", "profile_image": "https://graph.facebook.com/1986176611490470/picture?type=large", "display_name": "Osama Malik", "link": "https://stackoverflow.com/users/10639522/osama-malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 53297027, "answer_count": 1, "score": -1, "last_activity_date": 1542192194, "creation_date": 1542183894, "last_edit_date": 1542192194, "question_id": 53295794, "link": "https://stackoverflow.com/questions/53295794/drag-down-auto-fill-for-a-user-defined-function-vba", "title": "Drag down auto fill for a user defined function VBA", "body": "<p>I have the following function:</p>\n\n<pre><code>Function myFunc() As String\n\nApplication.Volatile\n\nDim i As Long, lTotal As Long\nFor i = 3 To 10\n\n    If Range(\"H3\").Value = Cells(i, 2).Value And Range(\"I3\").Value &lt; _\n    Cells(i, 4).Value And _\n    Range(\"I3\").Value &gt;= Cells(i, 3).Value Then\n\n    lTotal = Cells(i, 5).Value + lTotal\n\n    End If\n\n    myFunc = lTotal\n\nNext i\n\nEnd Function\n</code></pre>\n\n<p>I want this function to be autofill when I drag it down the column. How can I do that?</p>\n\n<p>[Edit]\nAttached is the image.\nConsider the Dasboard table as a discrete table where manually entries are posted. Consider log table as a continues table where record of every hour for each date is kept. The entries from Dashboard table get posted to the log table.\nI am using this function in the output column in the log table. I want to be able to drag it down to fill the log table. </p>\n\n<p><a href=\"https://i.stack.imgur.com/ZPqC7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZPqC7.png\" alt=\"Image\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1542184681, "post_id": 53295720, "comment_id": 93472781, "body": "You are talking about confidential data sent with an unencrypted email <i>&quot;Using office 2000&quot;</i> Are you serious? This Office version is out of security updates since almost 10 years. You should consider an upgrade for security reasons. \u2022 And you should consider not transferring confidential data through unsecured channels."}, {"owner": {"reputation": 11, "user_id": 10650672, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fmOIUrxcm08/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAgKusicQXSjgIPkVTrlmVBqncq0g/mo/photo.jpg?sz=128", "display_name": "qop", "link": "https://stackoverflow.com/users/10650672/qop"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542184847, "post_id": 53295720, "comment_id": 93472864, "body": "Yes I am talking about that. Unfortunately got no option to update version at the moment. As company will change software just in 2020. Sent data is not a big secret. So, I believe just delete from email would be enough, I hope so :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542186940, "post_id": 53295720, "comment_id": 93474094, "body": "Actually your biggest security issue is the person who decided to <i>&quot;change software just in 2020&quot;</i> \u2022 Nevertheless the email is not sent with your code but just displayed see <code>.Display</code>. If you change it to <code>.Send</code> you can <code>.Delete</code> it after it was sent."}, {"owner": {"reputation": 11, "user_id": 10650672, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fmOIUrxcm08/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAgKusicQXSjgIPkVTrlmVBqncq0g/mo/photo.jpg?sz=128", "display_name": "qop", "link": "https://stackoverflow.com/users/10650672/qop"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542187737, "post_id": 53295720, "comment_id": 93474586, "body": "Yes, firstly Outlook show email and Send button is clicked manually. It is done in purpose to avoid not sent email (had experience with that)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542188366, "post_id": 53295720, "comment_id": 93474960, "body": "The email can only automatically be deleted if it is sent automatically. If the user sends it manually he is responsible of his confidential data and must delete it himself."}, {"owner": {"reputation": 11, "user_id": 10650672, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fmOIUrxcm08/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAgKusicQXSjgIPkVTrlmVBqncq0g/mo/photo.jpg?sz=128", "display_name": "qop", "link": "https://stackoverflow.com/users/10650672/qop"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542190552, "post_id": 53295720, "comment_id": 93476331, "body": "Thank you for feedback. Could you please advise how to do it automatically?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542191395, "post_id": 53295720, "comment_id": 93476869, "body": "As I said in my comment before. Instead of <code>.Display</code> use <code>.Send</code> and <code>.Delete</code>."}, {"owner": {"reputation": 11, "user_id": 10650672, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fmOIUrxcm08/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAgKusicQXSjgIPkVTrlmVBqncq0g/mo/photo.jpg?sz=128", "display_name": "qop", "link": "https://stackoverflow.com/users/10650672/qop"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542193337, "post_id": 53295720, "comment_id": 93478052, "body": "With .send understood. But with .delete does&#180;t work.. Just .delete after .display?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542193601, "post_id": 53295720, "comment_id": 93478221, "body": "<i>&quot;does not work&quot;</i> is a useless error description (what error do you get? What happens?). And <i>Instead of</i> <code>.Display</code> means that you have to remove <code>.Display</code> and replace it with <code>.Send</code> and <code>.Delete</code> (each in one single code line)."}, {"owner": {"reputation": 11, "user_id": 10650672, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fmOIUrxcm08/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAgKusicQXSjgIPkVTrlmVBqncq0g/mo/photo.jpg?sz=128", "display_name": "qop", "link": "https://stackoverflow.com/users/10650672/qop"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542203927, "post_id": 53295720, "comment_id": 93484427, "body": "done like you advised. Email is sent, but code return an error Run-time error, The item has been moved or deleted. And in after debug .Delete is painted in yellow. In the same time email is sent, but remain in sent items"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1542204369, "creation_date": 1542204369, "answer_id": 53302089, "question_id": 53295720, "link": "https://stackoverflow.com/questions/53295720/excel-vba-delete-email-after-sending/53302089#53302089", "title": "Excel VBA delete email after sending", "body": "<p>Instead of <code>.Display</code> use</p>\n\n<pre><code>.DeleteAfterSubmit = True\n.Send\n</code></pre>\n\n<p>to not save a copy in sent items.</p>\n\n<p>See <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Outlook.MailItem.DeleteAfterSubmit\" rel=\"nofollow noreferrer\">MailItem.DeleteAfterSubmit Property (Outlook)</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 10650672, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fmOIUrxcm08/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAgKusicQXSjgIPkVTrlmVBqncq0g/mo/photo.jpg?sz=128", "display_name": "qop", "link": "https://stackoverflow.com/users/10650672/qop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1542204369, "creation_date": 1542183618, "last_edit_date": 1542184178, "question_id": 53295720, "link": "https://stackoverflow.com/questions/53295720/excel-vba-delete-email-after-sending", "title": "Excel VBA delete email after sending", "body": "<p>might be you are able to help me with VBA code.</p>\n\n<p>I got a code that send as PDF part of excel sheet. \nProblem is that email is used by many people and sometimes text is confidential. Is there an option to delete email (sent items and deleted items) after email is sent?</p>\n\n<p>Using office 2000</p>\n\n<p>Here is my existing code.</p>\n\n<pre><code>Sub SendDDocs()\n  Dim IsCreated As Boolean\n  Dim PdfFile As String, Title As String\n  Dim OutlApp As Object\n  Dim rng As Range\n  Set rng = Range(\"A1:J103\")\n\n  Title = Range(\"o1\")\n\n\n  Title = Range(\"o1\").Value &amp; \" Confidetial\"\n  PdfFile = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\") &amp; \"\\\" &amp; Title &amp; \".pdf\"\n\n  With ActiveSheet\n    .ExportAsFixedFormat Type:=xlTypePDF, Filename:=PdfFile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n  End With\n\n  On Error Resume Next\n  Set OutlApp = GetObject(, \"Outlook.Application\")\n  If Err Then\n    Set OutlApp = CreateObject(\"Outlook.Application\")\n    IsCreated = True\n  End If\n  OutlApp.Visible = True\n  On Error GoTo 0\n\n  With OutlApp.CreateItem(0)\n\n    .Subject = Title\n    .To = \"email@email.com\"\n    .CC = \"email@email.com\"\n    .Body = \"\" &amp; vbLf &amp; vbLf _\n          &amp; \"a\" &amp; vbLf &amp; vbLf _\n          &amp; \"\" &amp; vbLf _\n          &amp; Application.UserName &amp; vbLf &amp; vbLf\n    .Attachments.Add PdfFile\n\n    Application.Visible = True\n    .Display\n  End With\n\nKill PdfFile\n\n  If IsCreated Then OutlApp.Quit\n\n  Set OutlApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 520, "user_id": 6425980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b524dab02b94a074d78b988cf62e1405?s=128&d=identicon&r=PG&f=1", "display_name": "Lambik", "link": "https://stackoverflow.com/users/6425980/lambik"}, "edited": false, "score": 1, "creation_date": 1542184892, "post_id": 53295450, "comment_id": 93472885, "body": "Please add the code you already have and explain in a detailed way where you are stuck. This will allow us to provide a decent answer. Regards,"}, {"owner": {"reputation": 23, "user_id": 10622560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a183d12acbd8fb1a7672646138077a45?s=128&d=identicon&r=PG&f=1", "display_name": "nagileica", "link": "https://stackoverflow.com/users/10622560/nagileica"}, "reply_to_user": {"reputation": 520, "user_id": 6425980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b524dab02b94a074d78b988cf62e1405?s=128&d=identicon&r=PG&f=1", "display_name": "Lambik", "link": "https://stackoverflow.com/users/6425980/lambik"}, "edited": false, "score": 0, "creation_date": 1542186233, "post_id": 53295450, "comment_id": 93473638, "body": "I have only the code to open the other excel file , after that i&#39;m missing all the code that i need to do what i want"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1542186997, "post_id": 53295450, "comment_id": 93474129, "body": "People will be willing to help if you could show that you have researched and tried yourself. Look up &quot;last row&quot; to begin with.. look up &quot;delete rows&quot;.. do some research,  post your code and we can go from there."}, {"owner": {"reputation": 23, "user_id": 10622560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a183d12acbd8fb1a7672646138077a45?s=128&d=identicon&r=PG&f=1", "display_name": "nagileica", "link": "https://stackoverflow.com/users/10622560/nagileica"}, "edited": false, "score": 0, "creation_date": 1542190395, "post_id": 53295450, "comment_id": 93476226, "body": "Ok , i&#39;ve edited the post and pasted the code that i have in right now, hope it helps."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12052249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762b98ec72bbfc73faf9fe884ad4d1e4?s=128&d=identicon&r=PG&f=1", "display_name": "Nagarjuna", "link": "https://stackoverflow.com/users/12052249/nagarjuna"}, "is_accepted": false, "score": 0, "last_activity_date": 1568323904, "creation_date": 1568323904, "answer_id": 57914765, "question_id": 53295450, "link": "https://stackoverflow.com/questions/53295450/count-rows-and-export-based-on-criteria/57914765#57914765", "title": "Count rows and export based on criteria", "body": "<p>Answering this 10 months old question as it might help someone who is still searching for similar kind of results.</p>\n\n<p>I have put a count if formula in AI column to count the number of occurrences of value in AH and if the the AI value is greater than 1 the same will be pasted in different sheet.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>    Sub CopyDups()\n       With Application\n         .ScreenUpdating = False\n         .EnableEvents = False\n       End With\n\n    Dim cnt As Range\n    Dim nu As Integer\n    Dim Source As Worksheet\n    Dim Target As Worksheet\n\n    Set Source = ActiveWorkbook.Worksheets(\"SourceData\")\n    Set Target = ActiveWorkbook.Worksheets(\"Criteria 1\")\n\n    nu = 1     \n    For Each cnt In Source.Range(\"AI1:AI1000\")   \n      If cnt &gt; 1 Then\n        Source.Rows(cnt.Row).Copy Target.Rows(nu)\n        nu = nu + 1\n      End If\n    Next cnt\n       With Application\n         .ScreenUpdating = True\n         .EnableEvents = True\n       End With\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10622560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a183d12acbd8fb1a7672646138077a45?s=128&d=identicon&r=PG&f=1", "display_name": "nagileica", "link": "https://stackoverflow.com/users/10622560/nagileica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568323904, "creation_date": 1542182448, "last_edit_date": 1542190359, "question_id": 53295450, "link": "https://stackoverflow.com/questions/53295450/count-rows-and-export-based-on-criteria", "title": "Count rows and export based on criteria", "body": "<p>So I have an Excel file, that I want to export some of the rows to another Excel file, my problem is that I have a row that is like:</p>\n\n<pre><code>1    \n1    \n1    \n2    \n2    \n2    \n3    \n3    \n3    \n1   \n1    \n1\n</code></pre>\n\n<p>And I want to export from the first row with number one to the last row with number 3, and after exportation delete that same lines.</p>\n\n<p>So far i have this.</p>\n\n<pre><code>Private Sub export2()\nfolha = exportform.Label14.Caption\nOn Error GoTo ErrHandler\nApplication.ScreenUpdating = False\n\n\nDim src As Workbook\n\n' ABRIR EXCEL\nSet src = Workbooks.Open(\"U:\\Mec\u00e2nica\\Produ\u00e7\u00e3o\\OEE\\OEE ( FULL LOG )\\FRS\\FRS_DADOS.xlsx\", True, False)\nWS_Count = src.Worksheets.Count\n For o = 1 To WS_Count\n src.Worksheets(o).Unprotect password:=\"registoOEE\"\n Next o\n\nlastsrc = src.Worksheets(\"DADOS\").Range(\"A65536\").End(xlUp).Row\nlast = Application.ThisWorkbook.Worksheets(folha).Range(\"A65536\").End(xlUp).Row\n\n\n\n\nDim last, I As Integer\nDim turno As String\n\nSheets(folha).Select\n\nFor I = 2 To last\n'If application.ThisWorkbook.Worksheets(folha).Cells(last, 61)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNext I\n\n\n\n\nErrHandler:\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\n\n\n\n\n\n\n  For o = 1 To WS_Count\n src.Worksheets(o).Protect password:=\"registoOEE\"\n Next o\n\n\n  Application.DisplayAlerts = False 'IT WORKS TO DISABLE ALERT PROMPT\n\n  'SAVES FILE USING THE VARIABLE BOOKNAME AS FILENAME\n src.Save\n\n Application.DisplayAlerts = True 'RESETS DISPLAY ALERTS\n\n' CLOSE THE SOURCE FILE.\nsrc.Close True             ' FALSE - DON'T SAVE THE SOURCE FILE.\nSet src = Nothing\n\n\nfim:\nEnd Sub\n</code></pre>\n\n<p>I've edited so you can see what code i have already, hope it helps.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1542182421, "post_id": 53295019, "comment_id": 93471739, "body": "Is this literally your code, or is this extracted from a larger set?  I&#39;ve never seen the workbook returned from Open() be anything other than the filename passed in."}, {"owner": {"reputation": 49, "user_id": 3243344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc0ad42fc482ad1e5b07e4e2949f61b?s=128&d=identicon&r=PG&f=1", "display_name": "user3243344", "link": "https://stackoverflow.com/users/3243344/user3243344"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542185514, "post_id": 53295019, "comment_id": 93473222, "body": "Yes. It was part of the existing code block, but I had pasted the exact lines causing the problem. I am not sure what is causing it."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1542187796, "post_id": 53295019, "comment_id": 93474619, "body": "This is a known bug. You must first test whether or not your workbook is already open in Excel."}], "owner": {"reputation": 49, "user_id": 3243344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc0ad42fc482ad1e5b07e4e2949f61b?s=128&d=identicon&r=PG&f=1", "display_name": "user3243344", "link": "https://stackoverflow.com/users/3243344/user3243344"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 373, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586394623, "creation_date": 1542180315, "last_edit_date": 1586394623, "question_id": 53295019, "link": "https://stackoverflow.com/questions/53295019/vba-application-workbooks-openfile-name-xls-opens-already-opened-workbook-inst", "title": "VBA Application.Workbooks.Open(file_name.xls) opens already opened workbook instead of file_name passed", "body": "<p>I am trying to open a workbook using Application.Workbooks.Open by passing the file name along with path as an argument. \nIf any other excel is opened it is activating opened excel instead of opening excel with the given file name </p>\n\n<p>My Code :</p>\n\n<pre><code>Dim rsWB As Workbook\nDim fname As String\n\nfname = \"C:\\Users\\test\\my development\\ouput\\new_output.xlsx\"\nSet rsWB = Application.Workbooks.Open(fname)\n\nrsWB.Activate\nMsgBox (rsWB.Name)  \n</code></pre>\n\n<p>Case 1. If no other excel file is open. rsWB.Name = new_output.xlsx </p>\n\n<p>Case 2. If output.xlsx is already open. rsWB.Name = output.xlsx</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10579300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a325f697771abaf44a7582a8f39b760?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/10579300/sam"}, "edited": false, "score": 0, "creation_date": 1542180610, "post_id": 53294964, "comment_id": 93471036, "body": "Thanks that really worked. Is there any way to reference the range if we do not have a fixed last element(D1 here) instead starting from B1 to row end?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 53, "user_id": 10579300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a325f697771abaf44a7582a8f39b760?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/10579300/sam"}, "edited": false, "score": 0, "creation_date": 1542180784, "post_id": 53294964, "comment_id": 93471119, "body": "The last version above dynamically finds the last column by coming from the right of the sheet and finding the last used column in the specified row."}, {"owner": {"reputation": 53, "user_id": 10579300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a325f697771abaf44a7582a8f39b760?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/10579300/sam"}, "edited": false, "score": 0, "creation_date": 1542184741, "post_id": 53294964, "comment_id": 93472803, "body": "That was really great. This one will serve the purpose for now. Thanks @Qharr"}, {"owner": {"reputation": 53, "user_id": 10579300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a325f697771abaf44a7582a8f39b760?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/10579300/sam"}, "edited": false, "score": 0, "creation_date": 1542189798, "post_id": 53294964, "comment_id": 93475888, "body": "I cant upvote due to some reasons. Accepted the answer :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 53, "user_id": 10579300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a325f697771abaf44a7582a8f39b760?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/10579300/sam"}, "edited": false, "score": 0, "creation_date": 1542189846, "post_id": 53294964, "comment_id": 93475908, "body": "I think you can upvote at like 15 points? <a href=\"https://meta.stackexchange.com/questions/41347/why-are-15-reputation-points-required-to-upvote\" title=\"why are 15 reputation points required to upvote\">meta.stackexchange.com/questions/41347/&hellip;</a>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1542180715, "last_edit_date": 1542180715, "creation_date": 1542180042, "answer_id": 53294964, "question_id": 53294767, "link": "https://stackoverflow.com/questions/53294767/deleting-row-elements-except-column1-and-then-shift-cells-up-for-the-rest/53294964#53294964", "title": "Deleting row elements except column1 and then shift cells up for the rest", "body": "<p>You will need to specify the range excluding that column e.g.</p>\n\n<pre><code>Worksheets(\"sheet1\").Range(\"B1:D1\").Delete Shift:=xlUp\n</code></pre>\n\n<p>You could also specify starting from B2, for example, and dynamically finding last column in same row:</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n   .Range(.Cells(2, 2), .Cells(2, .Cells(2, .Columns.Count).End(xlToLeft).Column)).Delete Shift:=xlUp\nEnd With\n</code></pre>\n\n<p>To make that a little more easily amendable you can use Constants and you should have a test that lastColumn is > than START_COLUMN or you may delete the keep column.</p>\n\n<pre><code>Const ROW_OF_INTEREST As Long = 2\nConst START_COLUMN As Long = 2\nDim lastColumn As Long\n\nWith Worksheets(\"Sheet1\")\n    lastColumn = .Cells(ROW_OF_INTEREST, .Columns.Count).End(xlToLeft).Column\n    If lastColumn &gt; START_COLUMN Then\n        .Range(.Cells(ROW_OF_INTEREST, START_COLUMN), .Cells(ROW_OF_INTEREST, .Cells(ROW_OF_INTEREST, .Columns.Count).End(xlToLeft).Column)).Delete Shift:=xlUp\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10579300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a325f697771abaf44a7582a8f39b760?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/10579300/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 53294964, "answer_count": 1, "score": 2, "last_activity_date": 1586394658, "creation_date": 1542179201, "last_edit_date": 1586394658, "question_id": 53294767, "link": "https://stackoverflow.com/questions/53294767/deleting-row-elements-except-column1-and-then-shift-cells-up-for-the-rest", "title": "Deleting row elements except column1 and then shift cells up for the rest", "body": "<p>Is there any way to delete all the row elements except the row element in column A and then shift cells up only for the deleted row using VBA coding. Right now I manually select a single row except the row element in column A and then delete using <kbd>ctrl</kbd>+<kbd>-</kbd> and select shift cells up.</p>\n\n<p>I have also tried this</p>\n\n<pre><code>Worksheets(\"sheet1\").Rows(i).Delete Shift:=xlShiftUp\n</code></pre>\n\n<p>but it deletes the whole row.</p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1542177215, "post_id": 53294214, "comment_id": 93469697, "body": "Please understand that this site is not a free programming service. We can help you if you get stuck with your code, but you have to be able to write code yourself. Post the code you have so far and explain what you need help with. Please edit your question to provide these details. Do not do that in a comment. Post a comment when you have updated your question to alert your followers."}, {"owner": {"reputation": 21, "user_id": 9062080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafe722fb9f76796b7a9d14ee9793252?s=128&d=identicon&r=PG&f=1", "display_name": "user824565", "link": "https://stackoverflow.com/users/9062080/user824565"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1542177832, "post_id": 53294214, "comment_id": 93469915, "body": "Thanks for your reply. I have now posted my code in question. Can you please now help me."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1542178286, "post_id": 53294214, "comment_id": 93470092, "body": "What is your data structure? You have several references to different rows in column E. What is the &quot;second last row of the table&quot;? How do you determine that you need rows 12, 34, 46 and 57 in that sheet? Do you have several tables in the sheet? Are these Excel Table Objects or are these just ranges with some empty rows followed by another range? Your code does not make sense unless we can see the data. Use an ad-free file sharing service to post a REDUCED data sample that illustrates the problem. Ad-free can be DropBox, Box, OneDrive."}, {"owner": {"reputation": 21, "user_id": 9062080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafe722fb9f76796b7a9d14ee9793252?s=128&d=identicon&r=PG&f=1", "display_name": "user824565", "link": "https://stackoverflow.com/users/9062080/user824565"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1542181975, "post_id": 53294214, "comment_id": 93471551, "body": "we have tables in different sheets , we are copying todays value for that table to compare with tomorrows data. last row will have yesterday data and second last row will have todays. this table we have in different sheets and total we are taking in consideration like E2:H2. The range of table is not fixed for each table."}, {"owner": {"reputation": 21, "user_id": 9062080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafe722fb9f76796b7a9d14ee9793252?s=128&d=identicon&r=PG&f=1", "display_name": "user824565", "link": "https://stackoverflow.com/users/9062080/user824565"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1542182049, "post_id": 53294214, "comment_id": 93471577, "body": "Can you please suggest how this can be done dynamically"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1542184550, "post_id": 53294214, "comment_id": 93472719, "body": "Did you read my last comment about needing to know your data structure? If you don&#39;t provide a sample file with your data structure, nobody will be able to help you with your code. When will it be row 3? When will it be row 77? What are the markers to define the logic? If the range is <code>not fixed for each table</code>  -- pardon me, but how on earth is Excel going to know what to copy? YOU need to define the logic for that in words, relating to your sample data file that you post in an ad-free file sharing service. I think I&#39;m done here."}], "owner": {"reputation": 21, "user_id": 9062080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafe722fb9f76796b7a9d14ee9793252?s=128&d=identicon&r=PG&f=1", "display_name": "user824565", "link": "https://stackoverflow.com/users/9062080/user824565"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586394694, "creation_date": 1542176496, "last_edit_date": 1586394694, "question_id": 53294214, "link": "https://stackoverflow.com/questions/53294214/automate-copy-paste-excel-ranges-dynamically-from-different-sheets", "title": "Automate copy paste Excel ranges dynamically from different sheets", "body": "<p>I have tables in different sheets of excel and requirement is to copy second last row of table  to last row. Can someone pls help me how can we dynamically find table size so that code wont be required to change evrytime when table size changes? There are many tables and we want to automate this task using vba code and macro button.</p>\n\n<p>I have written a code but that is range specific and everytime I need to update the range and process become cumbersome.</p>\n\n<pre><code>Sub history_copy()\n\nSet obj = ActiveWorkbook.Sheets(\"sheet A\")\nobj.Range(\"E12:N12\").Value = obj.Range(\"E11:N11\").Value\nobj.Range(\"E34:N34\").Value = obj.Range(\"E33:N33\").Value\nobj.Range(\"E46:N46\").Value = obj.Range(\"E45:N45\").Value\nobj.Range(\"E57:N57\").Value = obj.Range(\"E56:N56\").Value\n\nSet obj1 = ActiveWorkbook.Sheets(\"sheet b \")\nobj1.Range(\"G21:O21\").Value = obj1.Range(\"G20:O20\").Value\n\nSet obj2 = ActiveWorkbook.Sheets(\"sheet c\")\nobj2.Range(\"D4:M4\").Value = obj2.Range(\"D3:M3\").Value\nobj2.Range(\"D14:M14\").Value = obj2.Range(\"D13:M13\").Value\nobj2.Range(\"D23:M23\").Value = obj2.Range(\"D22:M22\").Value\nobj2.Range(\"D33:M33\").Value = obj2.Range(\"D32:M32\").Value\nobj2.Range(\"D43:M43\").Value = obj2.Range(\"D42:M42\").Value\nobj2.Range(\"D52:M52\").Value = obj2.Range(\"D51:M51\").Value\nobj2.Range(\"D61:M61\").Value = obj2.Range(\"D60:M60\").Value\nobj2.Range(\"D70:M70\").Value = obj2.Range(\"D69:M69\").Value\nobj2.Range(\"D79:M79\").Value = obj2.Range(\"D78:M78\").Value\nobj2.Range(\"D88:M88\").Value = obj2.Range(\"D87:M87\").Value\nobj2.Range(\"D97:M97\").Value = obj2.Range(\"D96:M96\").Value\nobj2.Range(\"D106:M106\").Value = obj2.Range(\"D105:M105\").Value\nobj2.Range(\"D114:M114\").Value = obj2.Range(\"D113:M113\").Value\n\nSet obj3 = ActiveWorkbook.Sheets(\"sheet d\")\nobj3.Range(\"D4:L4\").Value = obj3.Range(\"D3:L3\").Value\n\n\n\nSet obj5 = ActiveWorkbook.Sheets(\"sheet f\")\nobj5.Range(\"D4:L4\").Value = obj5.Range(\"D3:L3\").Value\n\nSet obj6 = ActiveWorkbook.Sheets(\"sheet e\")\nobj6.Range(\"C4:C12\").Value = obj6.Range(\"B4:B12\").Value\nobj6.Range(\"H4:H8\").Value = obj6.Range(\"G4:G8\").Value\nobj6.Range(\"N4:N11\").Value = obj6.Range(\"M4:M11\").Value\nobj6.Range(\"S4:S10\").Value = obj6.Range(\"R4:R10\").Value\nobj6.Range(\"X4:X18\").Value = obj6.Range(\"W4:W18\").Value\nobj6.Range(\"AD4:AD9\").Value = obj6.Range(\"AC4:AC9\").Value\nobj6.Range(\"AI4:AI13\").Value = obj6.Range(\"AH4:AH13\").Value\nobj6.Range(\"AO4:AO6\").Value = obj6.Range(\"AN4:AN6\").Value\nobj6.Range(\"AT4:AT11\").Value = obj6.Range(\"AS4:AS11\").Value\nobj6.Range(\"AY4:AY20\").Value = obj6.Range(\"AX4:AX20\").Value\nobj6.Range(\"BD4:BD10\").Value = obj6.Range(\"BC4:BC10\").Value\nobj6.Range(\"BI4:BI21\").Value = obj6.Range(\"BH4:BH21\").Value\n\nSet obj7 = ActiveWorkbook.Sheets(\"sheet i\")\nobj7.Range(\"C4:C12\").Value = obj7.Range(\"B4:B12\").Value\nobj7.Range(\"H4:H8\").Value = obj7.Range(\"G4:G8\").Value\nobj7.Range(\"N4:N11\").Value = obj7.Range(\"M4:M11\").Value\nobj7.Range(\"S4:S10\").Value = obj7.Range(\"R4:R10\").Value\nobj7.Range(\"X4:X18\").Value = obj7.Range(\"W4:W18\").Value\nobj7.Range(\"AD4:AD9\").Value = obj7.Range(\"AC4:AC9\").Value\nobj7.Range(\"AI4:AI13\").Value = obj7.Range(\"AH4:AH13\").Value\nobj7.Range(\"AO4:AO6\").Value = obj7.Range(\"AN4:AN6\").Value\nobj7.Range(\"AT4:AT11\").Value = obj7.Range(\"AS4:AS11\").Value\nobj7.Range(\"AY4:AY20\").Value = obj7.Range(\"AX4:AX20\").Value\nobj7.Range(\"BD4:BD10\").Value = obj7.Range(\"BC4:BC10\").Value\nobj7.Range(\"BI4:BI21\").Value = obj7.Range(\"BH4:BH21\").Value\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1542173533, "creation_date": 1542173533, "answer_id": 53293744, "question_id": 53293608, "link": "https://stackoverflow.com/questions/53293608/sum-of-all-the-iterations-of-a-variable-in-vba/53293744#53293744", "title": "Sum of all the iterations of a variable in VBA", "body": "<p>Change this line</p>\n\n<pre><code>Range(\"J3\").Value = Cells(i, 5).Value\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>Range(\"J3\").Value = Range(\"J3\").Value + Cells(i, 5).Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10639522, "user_type": "registered", "profile_image": "https://graph.facebook.com/1986176611490470/picture?type=large", "display_name": "Osama Malik", "link": "https://stackoverflow.com/users/10639522/osama-malik"}, "edited": false, "score": 0, "creation_date": 1542180089, "post_id": 53293762, "comment_id": 93470831, "body": "Hi thanks it worked. Can you help me to convert this into a function?"}, {"owner": {"reputation": 23, "user_id": 10639522, "user_type": "registered", "profile_image": "https://graph.facebook.com/1986176611490470/picture?type=large", "display_name": "Osama Malik", "link": "https://stackoverflow.com/users/10639522/osama-malik"}, "edited": false, "score": 0, "creation_date": 1542183951, "post_id": 53293762, "comment_id": 93472432, "body": "<a href=\"https://stackoverflow.com/questions/53295794/drag-down-auto-fill-for-a-custom-made-function\" title=\"drag down auto fill for a custom made function\">stackoverflow.com/questions/53295794/&hellip;</a>"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 0, "last_activity_date": 1542181342, "last_edit_date": 1542181342, "creation_date": 1542173643, "answer_id": 53293762, "question_id": 53293608, "link": "https://stackoverflow.com/questions/53293608/sum-of-all-the-iterations-of-a-variable-in-vba/53293762#53293762", "title": "Sum of all the iterations of a variable in VBA", "body": "<p>While there are certainly better methods of adding up cells, for your particular method this should work.</p>\n\n<pre><code>Dim i As long, lTotal as long    \nFor i = 3 To 10\n\n    If Range(\"H3\").Value = Cells(i, 2).Value And Range(\"I3\").Value &lt; Cells(i, 4).Value And _\n            Range(\"I3\").Value &gt;= Cells(i, 3).Value Then\n\n        lTotal = Cells(i, 5).Value + lTotal\n\n    End If\n\nNext i\n\nRange(\"J3\").Value = lTotal\n</code></pre>\n\n<p>Keep a running total of of your loop, then use the running total as your cell's value after you've finished the loop</p>\n"}], "owner": {"reputation": 23, "user_id": 10639522, "user_type": "registered", "profile_image": "https://graph.facebook.com/1986176611490470/picture?type=large", "display_name": "Osama Malik", "link": "https://stackoverflow.com/users/10639522/osama-malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 53293762, "answer_count": 2, "score": 2, "last_activity_date": 1542181342, "creation_date": 1542172661, "last_edit_date": 1542173467, "question_id": 53293608, "link": "https://stackoverflow.com/questions/53293608/sum-of-all-the-iterations-of-a-variable-in-vba", "title": "Sum of all the iterations of a variable in VBA", "body": "<p>I have the following code</p>\n\n<pre><code>Dim i As Integer\nFor i = 3 To 10\n\n    If Range(\"H3\").Value = Cells(i, 2).Value And Range(\"I3\").Value &lt; Cells(i, 4).Value And _\n            Range(\"I3\").Value &gt;= Cells(i, 3).Value Then\n\n        Range(\"J3\").Value = Cells(i, 5).Value\n\n    End If\n\nNext i\n</code></pre>\n\n<p>I want the value of <code>J3</code> to represent the sum of all the iterations and not just the last iteration if <code>i</code>. Can it be done?</p>\n"}, {"tags": ["python", "vba", "saprfc", "pyrfc"], "answers": [{"tags": [], "owner": {"reputation": 26891, "user_id": 633961, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/0c29q.jpg?s=128&g=1", "display_name": "guettli", "link": "https://stackoverflow.com/users/633961/guettli"}, "is_accepted": false, "score": 0, "last_activity_date": 1542626490, "creation_date": 1542626490, "answer_id": 53373555, "question_id": 53293504, "link": "https://stackoverflow.com/questions/53293504/wsaeconnrefused-connection-refused-while-establishing-connection-via-pyrfc/53373555#53373555", "title": "WSAECONNREFUSED: Connection refused while establishing connection via PyRFC", "body": "<p>This message looks like it is a networking issue:</p>\n\n<blockquote>\n  <p>Connection refused</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 13802, "user_id": 7381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69906b2a2405a4d5bad648ea05ae9405?s=128&d=identicon&r=PG", "display_name": "Lanzelot", "link": "https://stackoverflow.com/users/7381/lanzelot"}, "is_accepted": false, "score": 1, "last_activity_date": 1568731462, "creation_date": 1568731462, "answer_id": 57976776, "question_id": 53293504, "link": "https://stackoverflow.com/questions/53293504/wsaeconnrefused-connection-refused-while-establishing-connection-via-pyrfc/57976776#57976776", "title": "WSAECONNREFUSED: Connection refused while establishing connection via PyRFC", "body": "<p>\"Connection refused\" is a standard TCP/IP error message which means that the port number is incorrect. Double check, whether the SystemNumber of your backend system is really \"00\".</p>\n"}], "owner": {"reputation": 11, "user_id": 10645215, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JqDO-GBsHu8/AAAAAAAAAAI/AAAAAAAAAFk/Yub1nRlh6gE/photo.jpg?sz=128", "display_name": "Chris LIU", "link": "https://stackoverflow.com/users/10645215/chris-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1716, "favorite_count": 2, "answer_count": 2, "score": 0, "last_activity_date": 1603972361, "creation_date": 1542171968, "last_edit_date": 1603972361, "question_id": 53293504, "link": "https://stackoverflow.com/questions/53293504/wsaeconnrefused-connection-refused-while-establishing-connection-via-pyrfc", "title": "WSAECONNREFUSED: Connection refused while establishing connection via PyRFC", "body": "<p>I chosen PyRFC library to fulfill the task of connecting to SAP from Python. Everything is normal except the connection. The code stops and displays error message when it connects to SAP.</p>\n<pre><code>import pyrfc\ndef get_connection(connmeta):\nprint('Connecting ...', connmeta['ashost'])\nreturn Connection(**connmeta)\n\nTEST = { 'user' : 'XX',\n'passwd' : 'XX',\n'ashost' : 'XXX.XXX.XXX.XXX',\n'sysnr' : '00',\n'client' : '400',\n'lang' : 'EN' }\n\nconn = get_connection(TEST)\n</code></pre>\n<p>It throws:</p>\n<blockquote>\n<p>ERROR Message<br></p>\n<p>pyrfc._exception.CommunicationError: RFC_COMMUNICATION_FAILURE (rc=1): key=RFC_COMMUNICATION_FAILURE, message=</p>\n<p>LOCATION CPIC (TCP/IP) on local host XXX-XXXXXXX with Unicode</p>\n<p>ERROR partner 'XXX.XXX.XXX.XXX:3300' not reached</p>\n<p>TIME Tue Nov 13 16:33:59 2018</p>\n<p>RELEASE 721</p>\n<p>COMPONENT NI (network interface)</p>\n<p>VERSION 40</p>\n<p>RC -10</p>\n<p>MODULE nixxi.cpp</p>\n<p>LINE 3283</p>\n<p>DETAIL NiPConnect2: XXX.XXX.XXX.XXX:3300</p>\n<p>SYSTEM CALL connect</p>\n<p>ERRNO 10061</p>\n<p>ERRNO TEXT WSAECONNREFUSED: Connection refused</p>\n<p>COUNTER 2</p>\n<p>[MSG: class=, type=, number=, v1-4:=;;;]</p>\n</blockquote>\n<p>It seems issue lies in the server's firewall. And I googled most answers like this on internet including SAP's community.</p>\n<p>Then I telnet port of SAP' s IP and got timeout. It seems closed port causes connection failure.</p>\n<p>But before using Python, I used VBA to fetch data from SAP. the configure in VBA is almost same as that in Python</p>\n<pre><code>Set R3 = CreateObject(&quot;SAP.Functions&quot;)  \n    R3.Connection.System = &quot;PRT&quot;  \n    R3.Connection.ApplicationServer = &quot;XXX.XX.XX.XX&quot; \n    R3.Connection.Client = &quot;400&quot; \n    R3.Connection.SystemNumber = &quot;00&quot; \n    R3.Connection.User = &quot;XX&quot;\n    R3.Connection.Password = &quot;XX&quot; \n    R3.Connection.Language = &quot;EN&quot; \n    R3.Connection.Codepage = &quot;1100&quot;\n\nretcd = R3.Connection.Logon(1, True) \nIf retcd &lt;&gt; True Then  \n   MsgBox &quot;Logon failure&quot; \nElse \n   MsgBox &quot;Logon success&quot; \nEnd If\n</code></pre>\n<p>It works fine but with slow efficiency, that's why I choose Python as a workaround. Anybody knows why VBA successes but Python fails?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1542175470, "last_edit_date": 1542175470, "creation_date": 1542175004, "answer_id": 53293970, "question_id": 53293439, "link": "https://stackoverflow.com/questions/53293439/how-to-add-2-labels-in-a-chart-using-vba-excel/53293970#53293970", "title": "How to add 2 labels in a chart using vba excel", "body": "<p>Welcome To SO. If Your Objective is that axis label contain Count along with Operator then simply try</p>\n\n<pre><code>With sEmailSeries\n        '\n      .XValues = Range(\"A2:B\" &amp; Range(\"B2\").End(xlDown).Row)\n</code></pre>\n\n<p>if you want team name also then</p>\n\n<pre><code>.XValues = Range(\"A2:C\" &amp; Range(\"C2\").End(xlDown).Row)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10213983, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HJ1KU.jpg?s=128&g=1", "display_name": "yLannAh", "link": "https://stackoverflow.com/users/10213983/ylannah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542175470, "creation_date": 1542171606, "last_edit_date": 1542172973, "question_id": 53293439, "link": "https://stackoverflow.com/questions/53293439/how-to-add-2-labels-in-a-chart-using-vba-excel", "title": "How to add 2 labels in a chart using vba excel", "body": "<p>I have created a chart using vba excel, then accidentally populate a graph that show the user and the counts which I prefer. But stupid of me I forgot to save, due to testing. Now I cant get the logic how to set it again. please  help, thanks</p>\n\n<p>Sample Data</p>\n\n<pre><code>Operator  Counts    Team\nOPSHAF     123      A\nOPSAJC     1245     B\nOPSZAL     23       A\nOPSJGY     162      C\nOPSOSM     54       D\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/PGHL7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PGHL7.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub CreateChart()\n\nDim rEmailRng As Range\nDim oEmailCht As Object\nDim cEmailCht As Chart\n\nDim coEmailCht As ChartObject\nDim iEmailRow As Integer\nDim sEmailSeries As Series\nDim scEmailSerCol As SeriesCollection\n\nOn Error Resume Next\n\n    Set wb = ThisWorkbook\n    Set wbsh2 = wb.Worksheets(\"Email\")\n\n    Set coEmailCht = wbsh2.ChartObjects.Add(Range(\"E5\").Left, Range(\"E5\").Top, 500, 300)\n    coEmailCht = \"Email Requests Processed\" '&amp; year\n\n    Set cEmailCht = coEmailCht.Chart\n\n    With cEmailCht\n        .HasLegend = False\n        .HasTitle = True\n        .Axes(xlValue).MinimumScale = 50\n        .Axes(xlValue).MaximumScale = 1500\n        .ChartTitle.Text = \"Email Processed by Operator\"\n\n        Set scEmailSerCol = .SeriesCollection\n        Set sEmailSeries = scEmailSerCol.NewSeries\n\n        With sEmailSeries\n            .Name = Range(\"A1\").Offset(0, 1).Value\n            .XValues = Range(Range(\"A1\").Offset(1, 0), Range(\"A1\").End(xlDown))\n            .Values = Range(Range(\"A1\").Offset(1, 1), Range(\"A1\").Offset(1, 1).End(xlDown))\n            .ChartType = xl3DColumnClustered\n        End With\n\n    End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 41, "user_id": 6549497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c8inX.jpg?s=128&g=1", "display_name": "Cameron Davis", "link": "https://stackoverflow.com/users/6549497/cameron-davis"}, "edited": false, "score": 0, "creation_date": 1542169836, "post_id": 53293198, "comment_id": 93467596, "body": "dont know how to edit after a post, but sorry for the broken code format, and &quot;LOTNUMBERS&quot; should be replaced by ListName"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1542170260, "post_id": 53293198, "comment_id": 93467681, "body": "At the bottom there should be an edit post button. Also consider posting up the entire code (where relevant) as this would generate more viewers to possibly answer."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1542172048, "post_id": 53293198, "comment_id": 93468147, "body": "<code>Range.Name</code> returns a <code>Name</code> object, not a string. The string you&#39;re getting is the <code>Name</code> object&#39;s default property (<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.name\" rel=\"nofollow noreferrer\">docs</a>), which has an oddly side-effecting <code>Property Let</code> implementation that makes <code>NamedRng.Name = &quot;LOTNUMBERS&quot;</code> be legal, but that code doesn&#39;t do what it looks like it&#39;s doing - there&#39;s a lot of implicit stuff going on under the hood there. Now I&#39;d post an answer, but I&#39;ve no idea what the &quot;what used to happen&quot;/&quot;what happens now&quot; sequences mean. Feel free to <a href=\"https://stackoverflow.com/posts/53293198/edit\">edit</a> to clarify."}], "owner": {"reputation": 41, "user_id": 6549497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c8inX.jpg?s=128&g=1", "display_name": "Cameron Davis", "link": "https://stackoverflow.com/users/6549497/cameron-davis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586394730, "creation_date": 1542169676, "last_edit_date": 1586394730, "question_id": 53293198, "link": "https://stackoverflow.com/questions/53293198/vba-range-name-broken", "title": "VBA Range.Name broken?", "body": "<p>So I am running a VBA application that finds associated cells to a value, creates a range out of them, then fills a data validation drop down list by associating that range with a name.</p>\n\n<p>This was allowing me to create a dynamically populated dropdown list population by doing the following:</p>\n\n<ol>\n<li><p>Change event causes code to fire</p></li>\n<li><p>This then scans another sheet for a value entered by user</p></li>\n<li><p>When this value is found, a cell on that row is added to a range object</p></li>\n<li><p>This range object gets its Range.Name property assigned using info from the cell the drop down list is in.</p></li>\n<li><p>This worked in an older version of excel</p></li>\n</ol>\n\n<p>What used to happen-> Name: LotnumbersF3 == created name Validation list Source = nothing -run code -build range -assign range.name = LotnumbersF3 -Drop Down list populates with range info</p>\n\n<p>What happens now-> range.Name = Nothing run code range.Name = \"LotnumbersF3\" //my code does this //Check value of name range.Name = \"=sheet!$D$7,sheet!$D$21......</p>\n\n<p>I need the name to equal a specific value, why has this changed?</p>\n\n<p>Edit:</p>\n\n<p>So here is the code that associates to a name already created on the sheet:</p>\n\n<pre><code>ListNamePostFix = Replace(Target.Offset(0, 1).AddressLocal, \"$\", \"\")\n</code></pre>\n\n<p>So now I run a matching alg that utilizes up to three potential unique keys to describe different drop down list associations. Some of the lists depend on the value selected in other dropdown lists:</p>\n\n<pre><code>For Each RngCell In WorkingRng\n    If ThreeArgs Then\n        If Target.Offset(0, -7).Value = RngCell.Value _\n        And Target.Offset(0, -2).Value = RngCell.Offset(0, 2).Value _\n        And Target.Value = RngCell.Offset(0, 1).Value Then\n            If Not NamedRng Is Nothing Then\n                Set NamedRng = Union(NamedRng, ASP.Cells(Index, Column))\n            Else\n                Set NamedRng = ASP.Cells(Index, Column)\n            End If\n        End If\n        Index = Index + 1\n    ElseIf TwoArgs Then\n        If Target.Offset(0, -5).Value = RngCell.Value And Target.Value = RngCell.Offset(0, 2).Value Then\n            If Not NamedRng Is Nothing Then\n                Set NamedRng = Union(NamedRng, ASP.Cells(Index, Column))\n            Else\n                Set NamedRng = ASP.Cells(Index, Column)\n            End If\n        End If\n        Index = Index + 1\n    Else\n        If RngCell.Value = Target.Value Then\n            If Not NamedRng Is Nothing Then\n                Set NamedRng = Union(NamedRng, ASP.Cells(Index, Column))\n            Else\n            'innitializes the range object with first match.\n                Set NamedRng = ASP.Cells(Index, Column)\n            End If\n        End If\n        Index = Index + 1\n    End If\nNext\n</code></pre>\n\n<p>This function is called before this:</p>\n\n<pre><code> If Not NamedRng Is Nothing Then\n        ListName = ListName &amp; ListNamePostFix\n        NamedRng.Name = \"LOTNUMBERS\"\n    Else\n        Set NamedRng = Cells(1, 1)\n        ListName = \"LOTNUMBERS\" &amp; ListNamePostFix\n        NamedRng.Name = ListName\n    End If\n</code></pre>\n\n<p>And in an older version, not sure which one, of excel this works fine. But now according to the wonderful answer provided we see that the Name object no longer associates with a string, but some unholy amalgamation of the range elements thhat have been added to the working range. WHY!!!!!????</p>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1542167894, "post_id": 53292961, "comment_id": 93467196, "body": "You can name the PDF whatever you want to. What name do you want to give to the PDF? Will it vary each time? Is it a derivative of the generated name?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 1, "creation_date": 1542168401, "post_id": 53292961, "comment_id": 93467311, "body": "This is a duplicate. See this <a href=\"https://stackoverflow.com/questions/38847014/save-pdf-file-automatically-in-new-folder\">SO question</a>"}, {"owner": {"reputation": 57, "user_id": 10411989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13415a5c5def176fc6656a5b73dfd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Nilusha M.", "link": "https://stackoverflow.com/users/10411989/nilusha-m"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1542173028, "post_id": 53292961, "comment_id": 93468417, "body": "@alowflyingpig ,I would really appreciate answering my question where I got stuck.Yes,my system generated excel file name will vary everyday such as &quot;Quality Report 141256522356&quot; like this some digits included in its name.so those digits will vary everyday when this file is generated by the system.I need to print the pdf with the same name of excel file."}], "answers": [{"comments": [{"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 1, "creation_date": 1542173344, "post_id": 53293137, "comment_id": 93468505, "body": "Sorry, there was an extra <code>.</code> in my answer, causing invalid syntax. Try again if you need to."}, {"owner": {"reputation": 57, "user_id": 10411989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13415a5c5def176fc6656a5b73dfd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Nilusha M.", "link": "https://stackoverflow.com/users/10411989/nilusha-m"}, "edited": false, "score": 0, "creation_date": 1542173529, "post_id": 53293137, "comment_id": 93468554, "body": "In your code this part is displayed me in red color and saying Syntax Error Filename = left$(Thisworkbook.name, instrrev(Thisworkbook.name, &quot;.&quot;, -1,      vbbinarycompare) -1). &amp; &quot;.pdf&quot;   How do I solve this?"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 57, "user_id": 10411989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13415a5c5def176fc6656a5b73dfd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Nilusha M.", "link": "https://stackoverflow.com/users/10411989/nilusha-m"}, "edited": false, "score": 1, "creation_date": 1542173726, "post_id": 53293137, "comment_id": 93468601, "body": "Get rid of the <code>.</code> before the <code>&amp;</code> -- or just copy-paste the code in my answer (I have fixed it there) and try again."}], "tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": true, "score": 2, "last_activity_date": 1542173273, "last_edit_date": 1542173273, "creation_date": 1542169137, "answer_id": 53293137, "question_id": 53292961, "link": "https://stackoverflow.com/questions/53292961/how-to-print-excel-file-to-pdf-with-the-option-exportasfixedformat-via-excel/53293137#53293137", "title": "How to print excel file to pdf with the option &quot;.ExportAsFixedFormat&quot; via excel macro", "body": "<p>Untested, but assuming you want to name the PDF the same as the Excel file (ignoring file extension), but in a different folder (say some folder/directory called <code>\"C\\:Desktop\\Reports\\\"</code> for example):</p>\n\n<pre><code>Option explicit\n\nSub SaveAsPDF()\n\nDim folderPath as string\nfolderPath = \"C\\:Desktop\\Reports\\\" ' Change to whatever folder, but make sure it ends with a \\\n\nIf len(dir$(folderPath, vbDirectory)) = 0 then\nMsgbox(\"'\" &amp; folderPath &amp; \"' is not a valid/existing directory. Abandoning export. Code will stop running now.\")\nExit sub\nEnd if\n\nDim Filename as string\nFilename = left$(Thisworkbook.name, instrrev(Thisworkbook.name, \".\", -1, vbbinarycompare) -1) &amp; \".pdf\"\n\nWith ActiveSheet.PageSetup\n     .Orientation=xlLandscape\n     .Zoom=16\nEnd With\nActiveSheet.ExportAsFixedFormat _\n Type:=xlTypePDF, _\n FileName:=folderPath &amp; filename, _\n Quality:=xlQualityStandard, _\n IncludeDocProperties:=False, _\n IgnorePrintAreas:=False, _\n OpenAfterPublish:=True\n\nExit Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10411989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13415a5c5def176fc6656a5b73dfd1f?s=128&d=identicon&r=PG&f=1", "display_name": "Nilusha M.", "link": "https://stackoverflow.com/users/10411989/nilusha-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "accepted_answer_id": 53293137, "answer_count": 1, "score": 0, "last_activity_date": 1586394766, "creation_date": 1542167593, "last_edit_date": 1586394766, "question_id": 53292961, "link": "https://stackoverflow.com/questions/53292961/how-to-print-excel-file-to-pdf-with-the-option-exportasfixedformat-via-excel", "title": "How to print excel file to pdf with the option &quot;.ExportAsFixedFormat&quot; via excel macro", "body": "<p>I have wrote a code to print excel file to .PDF file with the page setups parameters.And also it eliminates the need of having a prompt dialog box also.</p>\n\n<p>But I need to know if I need to name the .PDF file as same as the excel file name with below code <strong>but not the same destination path</strong>.As an example:= if excel file name is \"<strong>Quality Report 1411185623689</strong>\" This file is generated by a system therefore its name is changed everyday.\nHow do I solve this?</p>\n\n<pre><code> Sub Save_As_PDF()\nWith ActiveSheet.PageSetup\n     .Orientation=xlLandscape\n     .Zoom=16\n\nEnd With\nActiveSheet.ExportAsFixedFormat _\n Type:=xlTypePDF, _\n FileName:=\"C\\:Desktop\\Reports\\Same as excel file name\", _\n Quality:=xlQualityStandard, _\n IncludeDocProperties:=False, _\n IgnorePrintAreas:=False, _\n OpenAfterPublish:=True\n\nExit Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "plot"], "comments": [{"owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "edited": false, "score": 0, "creation_date": 1542169507, "post_id": 53292624, "comment_id": 93467524, "body": "Can you extend your code to the part where you define <code>a</code>,<code>b</code>,<code>c</code>,<code>x</code> arrays ?"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1542169794, "post_id": 53292624, "comment_id": 93467582, "body": "Sounds like there may be no data in the array.  If you hard code the array does it plot?  i.e.  <code>.Values = Array(1, 2, 3, 4, 5, 6)</code>"}, {"owner": {"reputation": 101, "user_id": 9215176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3facf6330bd7eb38ad890d530b578371?s=128&d=identicon&r=PG&f=1", "display_name": "K.Yan", "link": "https://stackoverflow.com/users/9215176/k-yan"}, "edited": false, "score": 0, "creation_date": 1542176328, "post_id": 53292624, "comment_id": 93469379, "body": "The part of the code where I get a,b,c is quite long and a little bit complex. However, I use Debug.Print to print the data in a,b,c so I am sure I get the right numbers (I also check TypeName of elements in the arrays is double)."}, {"owner": {"reputation": 101, "user_id": 9215176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3facf6330bd7eb38ad890d530b578371?s=128&d=identicon&r=PG&f=1", "display_name": "K.Yan", "link": "https://stackoverflow.com/users/9215176/k-yan"}, "edited": false, "score": 0, "creation_date": 1542176376, "post_id": 53292624, "comment_id": 93469398, "body": "If I hard code the array to be 1,2,3..., there is still no data on the graph."}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 9215176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3facf6330bd7eb38ad890d530b578371?s=128&d=identicon&r=PG&f=1", "display_name": "K.Yan", "link": "https://stackoverflow.com/users/9215176/k-yan"}, "is_accepted": true, "score": 0, "last_activity_date": 1542855985, "creation_date": 1542855985, "answer_id": 53423299, "question_id": 53292624, "link": "https://stackoverflow.com/questions/53292624/plot-multiple-series-using-array-data/53423299#53423299", "title": "Plot multiple series using array data", "body": "<p>NewSeries empties the existing data in SeriesCollection every time.  It works after I put those three NewSeries together before filling in    the data.</p>\n\n<pre><code>With ct.SeriesCollection\n    .NewSeries\n    .NewSeries\n    .NewSeries\n\n    .Item(1).Name = \"A\"\n    .Item(1).Values = a\n    .Item(1).XValues = x\n\n    .Item(2).Name = \"B\"\n    .Item(2).Values = b\n    .Item(2).XValues = x\n\n    .Item(3).Name = \"C\"\n    .Item(3).Values = c\n    .Item(3).XValues = x\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 9215176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3facf6330bd7eb38ad890d530b578371?s=128&d=identicon&r=PG&f=1", "display_name": "K.Yan", "link": "https://stackoverflow.com/users/9215176/k-yan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 541, "favorite_count": 0, "accepted_answer_id": 53423299, "answer_count": 1, "score": 0, "last_activity_date": 1608230450, "creation_date": 1542164821, "last_edit_date": 1608230450, "question_id": 53292624, "link": "https://stackoverflow.com/questions/53292624/plot-multiple-series-using-array-data", "title": "Plot multiple series using array data", "body": "<p>I'm trying to plot three series on a chart table from arrays.</p>\n<p>ct is a chart table that is already created. The one-dimensional arrays A, B, C, x have the same length, as well as the same LBound and UBound.</p>\n<pre><code>Dim sr As Series\nFor Each sr In ct.SeriesCollection\n    sr.Delete\nNext\n\nWith ct.SeriesCollection.NewSeries\n    .Name = &quot;A&quot;\n    .Values = a\n    .XValues = x\nEnd With\n\nWith ct.SeriesCollection.NewSeries\n    .Name = &quot;B&quot;\n    .Values = b\n    .XValues = x\nEnd With\n\nWith ct.SeriesCollection.NewSeries\n    .Name = &quot;C&quot;\n    .Values = c\n    .XValues = x\nEnd With\n</code></pre>\n<p>However, there are no bars or lines on the graph after I run the macro. I see only the tags &quot;A&quot;, &quot;B&quot;, &quot;C&quot; on the right side on the graph.</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1542162987, "post_id": 53292204, "comment_id": 93466197, "body": "Can you explain it a little bit better please - perhaps with screenshots?  I find it rather confusing.  You are populating range E2:AX and taking value from A2? Also, your formula <code>=IF(ISERROR(VLOOKUP(B2,Lookup_Table!B:I,4,FALSE)),0,VLOOKUP(&zwnj;&#8203;B2,Lookup_Table!B:I,&zwnj;&#8203;4,FALSE))</code> is redundant, you should be using something like <code>=IFERROR(VLOOKUP(A2,Lookup_Table!A:H,4,FALSE),0)</code>"}, {"owner": {"reputation": 95, "user_id": 3596788, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/10d0113f5b9968820f346dbbdd3263a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3596788", "link": "https://stackoverflow.com/users/3596788/user3596788"}, "reply_to_user": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1542199616, "post_id": 53292204, "comment_id": 93481665, "body": "I appreciate your response I added a screenshot, hopefully it&#39;s less confusing"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 3596788, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/10d0113f5b9968820f346dbbdd3263a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3596788", "link": "https://stackoverflow.com/users/3596788/user3596788"}, "edited": false, "score": 0, "creation_date": 1542220834, "post_id": 53292758, "comment_id": 93494253, "body": "Sorry I was unable to get your example working. I modified my question and included a screen shot to simplify the question, does this make more sense now?"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 95, "user_id": 3596788, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/10d0113f5b9968820f346dbbdd3263a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3596788", "link": "https://stackoverflow.com/users/3596788/user3596788"}, "edited": false, "score": 0, "creation_date": 1542225834, "post_id": 53292758, "comment_id": 93496538, "body": "@user3596788 Okay, did it give you an error message? Did the code run okay but the formula/results were wrong? Based on the screenshot, the formula needs to match values in columns <code>A:M</code> (on the sheet in screenshot) to columns <code>A:H</code> of the worksheet <code>Lookup_Table</code> (a different sheet to the one shown in the screenshot), but the formula itself needs to go in columns <code>O:AA</code> on the worksheet shown -- is that correct? Also, do you really want to fill every row in the columns with the formula (it will likely make the spreadsheet quite slow, if there are 1 million rows to update/recalculate)."}, {"owner": {"reputation": 95, "user_id": 3596788, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/10d0113f5b9968820f346dbbdd3263a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3596788", "link": "https://stackoverflow.com/users/3596788/user3596788"}, "edited": false, "score": 0, "creation_date": 1542285289, "post_id": 53292758, "comment_id": 93519186, "body": "It works I put the wrong column range in initially. Regarding the performance I would expect 2-3k rows at most is there a better approach? Also, how do I return blank instead of 0 when no match is found?"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 95, "user_id": 3596788, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/10d0113f5b9968820f346dbbdd3263a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3596788", "link": "https://stackoverflow.com/users/3596788/user3596788"}, "edited": false, "score": 1, "creation_date": 1542286396, "post_id": 53292758, "comment_id": 93519839, "body": "In my opinion, if the code works fine for you, then there&#39;s no need to optimise it further. Also, if you want to return <code>blank</code> instead of <code>0</code>, try changing this line <code>&quot;=Iferror(VLOOKUP(A2,&#39;Lookup_Table&#39;!$A:$H,4,FALSE),0)&quot;</code> in the code to <code>&quot;=Iferror(VLOOKUP(A2,&#39;Lookup_Table&#39;!$A:$H,4,FALSE),&quot;&quot;&quot;&quot;)&quot;</code>. Technically, this doesn&#39;t make the cell blank, it puts a zero-length string into it -- but try it and see if it&#39;s okay for you."}], "tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": true, "score": 3, "last_activity_date": 1542166920, "last_edit_date": 1542166920, "creation_date": 1542166026, "answer_id": 53292758, "question_id": 53292204, "link": "https://stackoverflow.com/questions/53292204/excel-vba-vlookup-with-ranges/53292758#53292758", "title": "Excel VBA Vlookup with Ranges", "body": "<p>Assuming <code>Lookup_Table</code> = <code>'Lookup_Table'!A:H</code>, you could try something like:</p>\n\n<pre><code>With worksheets(\"Cross_Walk\") ' Assumes Activeworkbook\n    .Range(\"E2:H\" &amp; .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row).Formula = _\n        \"=Iferror(VLOOKUP(A2,'Lookup_Table'!$A:$H,4,FALSE),0)\"\n    End With\n</code></pre>\n\n<ul>\n<li><p>We assign the formula to range <code>E2:H?</code> where <code>?</code> is whatever the last row is determined to be.</p></li>\n<li><p>Excel observes relative and absolute references when assigning the same formula to a range of cells.</p></li>\n<li><p>So since <code>A2</code> in the VLOOKUP has a relative row and column reference (no $ signs), it will change to <code>B2</code> when the formula is entered in <code>F2</code> -- and so forth for the remaining columns and rows.</p></li>\n<li><p>Also, if you're going to test whether the result of the VLOOKUP is an error, and then conditionally assign either zero or the matching value, you may as well just use IFERROR in your formula -- rather than performing the VLOOKUP twice.</p></li>\n</ul>\n"}], "owner": {"reputation": 95, "user_id": 3596788, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/10d0113f5b9968820f346dbbdd3263a4?s=128&d=identicon&r=PG&f=1", "display_name": "user3596788", "link": "https://stackoverflow.com/users/3596788/user3596788"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 0, "accepted_answer_id": 53292758, "answer_count": 1, "score": 0, "last_activity_date": 1586394837, "creation_date": 1542161451, "last_edit_date": 1586394837, "question_id": 53292204, "link": "https://stackoverflow.com/questions/53292204/excel-vba-vlookup-with-ranges", "title": "Excel VBA Vlookup with Ranges", "body": "<p>I have vlookup formula that takes the value of A2 and returns the corresponding match found in my Lookup_Table in cell O2, this lookup continues for the rows underneath.</p>\n\n<p>How would I modify this code to lookup a range of values in A:M, with the results placed in O:AA? Or do I have to manually code each column separately?</p>\n\n<pre><code>  With Sheets(\"Example\")\n    .Range(\"O2:O\" &amp; .Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Formula = _\n        \"=IF(ISERROR(VLOOKUP(A2,'Lookup_Table'!A:H,4,FALSE)),0,VLOOKUP(A2,'Lookup_Table'!A:H,4,FALSE))\"\n           .Range(\"O2:O\" &amp; .Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Value = _\n        .Range(\"O2:O\" &amp; .Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Value 'Comment out if you'd like to leave the above formula in place\nEnd With\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/4qOJT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4qOJT.jpg\" alt=\"screenshot\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1542160529, "post_id": 53291998, "comment_id": 93465643, "body": "Woops, didn&#39;t notice the date part. Below will do the formatting and alignment. With the date, what are you doing with it? Is it just for a year? Why not hard codee if it is?"}, {"owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1542161458, "post_id": 53291998, "comment_id": 93465843, "body": "I have 750 worksheets that contain around 15,000 rows for a budgeting system. Last years Budgets go from July-2018 across to June-2020 (27 cells) I need to change these 27 cells in all relevant lines to July-2019 to June-2021.  What I am trying to do is format only the cells I have modified to make sure they are in the &quot;mmm-yy&quot; format and right aligned. It stuffs up the readability of the sheet if everything is right aligned.   In terms of your code wont that format the entire sheet in that format? (which is what I am trying to avoid)."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1542162829, "post_id": 53291998, "comment_id": 93466165, "body": "no, it only formats row 1 in worksheet Sheet1. As I understand you want to loop through ALL worksheets within the workbook and make sure the format of row1 is &quot;mmm-yy&quot;?"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1542164461, "post_id": 53291998, "comment_id": 93466540, "body": "If the below answer does what you want it to can you please ensure you mark as correct."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542170473, "post_id": 53292088, "comment_id": 93467729, "body": "Thanks but I want to limit the formatting to the cells I have modified using the offset function. The rest of the sheet needs to stay as is. See my pic below."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542171390, "post_id": 53292088, "comment_id": 93467960, "body": "@Scottyp There is no difference if you format the style of the dates. Since you are changing each date, the code ensure the same format is used throughout"}, {"owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542171783, "post_id": 53292088, "comment_id": 93468075, "body": "This is for a budgeting worksheet so under each date is a dollar value for a respective cost line (or general ledger code for the accountants). At the moment the above is formatting the dollars as days."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542172812, "post_id": 53292088, "comment_id": 93468357, "body": "What cell is the first date in?"}, {"owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542230460, "post_id": 53292088, "comment_id": 93498541, "body": "Dates usually start in column 3, but in some cases 4 or 5 also."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542237706, "post_id": 53292088, "comment_id": 93501243, "body": "That info would have been helpful in the original question. Please ensure you post up all relevant info. Yes this can be done. Please review my revised answer above."}, {"owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542251027, "post_id": 53292088, "comment_id": 93504375, "body": "yeah sorry, I should have put that in. Thanks"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542251483, "post_id": 53292088, "comment_id": 93504465, "body": "@Scottyp Can you please mark as answered. I hate to go to the trouble and effort and not be rewarded. Cheers!"}, {"owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542321349, "post_id": 53292088, "comment_id": 93538144, "body": "I got error 91 when I tried to run it. So what is the code actually doing searching for July-17, then adding a year to the dates and searching for then looping?"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542323136, "post_id": 53292088, "comment_id": 93538671, "body": "It&#39;s searching for the first &quot;Jul-17&quot; in the file. Then going right for each month in the FY and adding 1 year. Then goes down 4 lines and does it again till the bottom, then goes to next sheet and continues the process. I noticed the pic is actually &quot;18&quot; update the code and it&#39;ll work. Still debug if it doesnt"}, {"owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542324010, "post_id": 53292088, "comment_id": 93538899, "body": "The date entries are not consist, i.e. some are four lines down some are 2, some are 5 depending on how many stores, but if I use this code to find the cells then I could probably adapt it <a href=\"https://stackoverflow.com/questions/53291272/find-and-select-dates\" title=\"find and select dates\">stackoverflow.com/questions/53291272/find-and-select-dates</a>"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542325545, "post_id": 53292088, "comment_id": 93539336, "body": "Yes you can do that.. I think I&#39;ve given you some good tools to use and you have some research and understanding. Seeing as the original question was answered lets mark as answered. And if you can&#39;t get this new code to work with the search, post up  another question and we can review"}], "tags": [], "owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "is_accepted": false, "score": 0, "last_activity_date": 1542238172, "last_edit_date": 1542238172, "creation_date": 1542160431, "answer_id": 53292088, "question_id": 53291998, "link": "https://stackoverflow.com/questions/53291998/formatting-cells-within-a-selection-loop/53292088#53292088", "title": "Formatting Cells within a Selection Loop", "body": "<pre><code>Sub test()\n\n\n    Dim LastRow As Long\n    Dim irow As Long\n    Dim jrow As Long\n    Dim StartCol As Long\n    Dim StartRow As Long\n\n\n\n    For Each ws In ActiveWorkbook.Worksheets\n        With ws.Select\n            LastRow = ws.Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n\n            Set StartDate = Cells.Find(What:=\"Jul-17\", After:=ws.Range(\"A1\"), LookIn:=xlValues _\n                        , LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n            StartCol = StartDate.Column\n            StartRow = StartDate.Row\n\n                For irow = StartRow To LastRow\n                    Set Rng = ws.Range(Cells(irow, StartCol), Cells(irow, StartCol + 11))\n                        For Each Cell In Rng\n                            Cell.Value = DateAdd(\"yyyy\", 1, Cell)\n                        Next Cell\n\n                    Rng.HorizontalAlignment = xlRight\n                    Rng.NumberFormat = \"mmm-yy\"\n\n                    irow = irow + 2\n                Next irow\n\n                For jrow = StartRow To LastRow\n                    Set Rng = ws.Range(Cells(jrow, StartCol + 12), Cells(jrow, StartCol + 12))\n                        For Each Cell In Rng\n                            Cell.Value = \"FY19 Total\"\n                        Next Cell\n                    jrow = jrow + 2\n                Next jrow\n        End With\n    Next ws\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "edited": false, "score": 0, "creation_date": 1542171218, "post_id": 53293116, "comment_id": 93467915, "body": "Ok.... sad that you boss thinks less lines = more simple... anyway, if you are happy with your code, just put <code>:</code> like the following <code>cell.Offset(0, 0).HorizontalAlignment = xlRight : cell.Offset(0, 0).NumberFormat = &quot;mmm-yy&quot; :  cell.Offset(0, 0) = &quot;1-Jul-19&quot;</code> Should work fine in one line"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1542171283, "post_id": 53293116, "comment_id": 93467926, "body": "Less lines is more simple... You just need to understand how to write the less lines ;)"}, {"owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542172033, "post_id": 53293116, "comment_id": 93468141, "body": "That&#39;s pretty close thanks O.Pal, I was trying avoid having to write the cell.Offset(0, 0) x3 but at least its on one line  is there likely to be a way to do that with the cell.Offset(0, 0) only once or am I dreaming / boss dreaming?"}], "tags": [], "owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "is_accepted": true, "score": 0, "last_activity_date": 1592811840, "last_edit_date": 1592811840, "creation_date": 1542168953, "answer_id": 53293116, "question_id": 53291998, "link": "https://stackoverflow.com/questions/53291998/formatting-cells-within-a-selection-loop/53293116#53293116", "title": "Formatting Cells within a Selection Loop", "body": "<p>ANSWER FROM ANONYMOUS BELOW</p>\n<pre><code>cell.Offset(0, 0).HorizontalAlignment = xlRight : cell.Offset(0,1).NumberFormat = &quot;mm-yy&quot; :  cell.Offset(0, 0) = &quot;1-Jul-19&quot;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "is_accepted": false, "score": 0, "last_activity_date": 1542237208, "last_edit_date": 1542237208, "creation_date": 1542236540, "answer_id": 53310027, "question_id": 53291998, "link": "https://stackoverflow.com/questions/53291998/formatting-cells-within-a-selection-loop/53310027#53310027", "title": "Formatting Cells within a Selection Loop", "body": "<p>Back again, so if in @alowflyingpig and your boss' world less lines necessarily means more simple please see below a code that does exactly what your \"full code\" does... but in less lines...</p>\n\n<pre><code>Sub DATE_MONTHLY_LOOP()\nDim cell As Range, i As Integer\nFor Each cell In Selection.Cells: For i = 0 To 11: With cell.Offset(0, i): .Value = DateAdd(\"m\", 1 + i, 43617): .HorizontalAlignment = xlRight: .NumberFormat = \"mmm-yy\": End With: Next i:    With cell.Offset(0, 12): .Value = \"FY20 TOTAL\": .ColumnWidth = 11.3: .HorizontalAlignment = xlRight: .NumberFormat = \"mmm-yy\": End With: Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 53293116, "answer_count": 3, "score": 2, "last_activity_date": 1592811840, "creation_date": 1542159825, "question_id": 53291998, "link": "https://stackoverflow.com/questions/53291998/formatting-cells-within-a-selection-loop", "title": "Formatting Cells within a Selection Loop", "body": "<p>I have a loop macro that changes a row of dates based on cells I have selected. Is there an easy way to format these cells without complicating the code. My company has policies around keeping Macros as simple as possible. </p>\n\n<p>I have tried the below at the top of the code but this formats the whole sheet, not the relevant cells.</p>\n\n<pre><code>cells.HorizontalAlignment = xlRight\ncells.NumberFormat = \"mmm-yy\"\n</code></pre>\n\n<p>I can do it via the below but it adds 100 lines to the code</p>\n\n<pre><code>cell.Offset(0, 0) = \"1-Jul-19\"\ncell.Offset(0, 0).HorizontalAlignment = xlRight\ncell.Offset(0, 0).NumberFormat = \"mmm-yy\"\n</code></pre>\n\n<p>Is there a way to do this on one line i.e. </p>\n\n<pre><code>cell.Offset(0, 0) = \"1-Jul-19\".HorizontalAlignment = xlRight.NumberFormat = \"mmm-yy\"\n</code></pre>\n\n<p>Help would be much appreciated.</p>\n\n<p>Scott</p>\n\n<hr>\n\n<pre><code>**Sub CHANGE_MONTH_LOOP()\nDim rngMyRange As range\nDim cell As range\nSet rngMyRange = Selection\nFor Each cell In rngMyRange.Cells\ncell.Offset(0, 0) = \"1-Jul-19\"\n\ncell.Offset(0, 1) = \"1-Aug-19\"\n\ncell.Offset(0, 2) = \"1-Sep-19\"\n\nNext cell\n\nEnd Sub**\n</code></pre>\n"}, {"tags": ["vba", "events", "outlook", "onerror"], "comments": [{"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1542164385, "post_id": 53291978, "comment_id": 93466519, "body": "Put a breakpoint on both Cancel = True lines, and run your code. Does the code reach either?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1542207377, "post_id": 53291978, "comment_id": 93486734, "body": "If all this code is in ThisOutlookSession would you edit the question to remove unneeded complications, by removing the first four lines and changing to <code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)</code>. Would you put in an <code>Err.Raise</code> so potential respondents do not introduce mistakes trying to create an error."}, {"owner": {"reputation": 151, "user_id": 9622165, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Barok", "link": "https://stackoverflow.com/users/9622165/barok"}, "edited": false, "score": 0, "creation_date": 1543123565, "post_id": 53291978, "comment_id": 93800785, "body": "nitro@ thanks for the tip."}], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": -1, "last_activity_date": 1542183712, "creation_date": 1542183712, "answer_id": 53295741, "question_id": 53291978, "link": "https://stackoverflow.com/questions/53291978/stop-outlook-vba-from-sending-mail-within-itemsend-when-an-error-event-has-occ/53295741#53295741", "title": "Stop Outlook VBA from sending mail within ItemSend() when an error event has occurred", "body": "<p>You couldn\u2019t use On Error GoTo to get error event, you could try to use If statement. For example:</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\nOn Error Resume Next\n\nIf Not Left(LCase(Item.Subject), 3) = \"re:\" And Not Left(LCase(Item.Subject), 3) = \"fw:\" Then\n      prompt$ = \"You sending this from \" &amp; Item.SendUsingAccount &amp; \". Are you sure you want to send it?\"\n       If MsgBox(prompt$, vbYesNo + vbQuestion + vbMsgBoxSetForeground, \"Check Sending Account\") = vbNo Then\n         Cancel = True\n       End If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>For more information, please refer to this link:</p>\n\n<p><a href=\"https://www.slipstick.com/how-to-outlook/prevent-sending-messages-to-wrong-email-address/\" rel=\"nofollow noreferrer\">Warn Before Sending Messages to the Wrong Email Address</a></p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.application.itemsend\" rel=\"nofollow noreferrer\">Application.ItemSend Event (Outlook)</a></p>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 9622165, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Barok", "link": "https://stackoverflow.com/users/9622165/barok"}, "edited": false, "score": 0, "creation_date": 1543123424, "post_id": 53383644, "comment_id": 93800762, "body": "Thanks for providing code. It is mind boggling, because suddenly the code seems to work fine again. I can&#39;t be sure but it may perhaps have nothing to do with the problem asked. I will have to wait and see if the problem re-surfaces."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 1, "last_activity_date": 1542667012, "creation_date": 1542667012, "answer_id": 53383644, "question_id": 53291978, "link": "https://stackoverflow.com/questions/53291978/stop-outlook-vba-from-sending-mail-within-itemsend-when-an-error-event-has-occ/53383644#53383644", "title": "Stop Outlook VBA from sending mail within ItemSend() when an error event has occurred", "body": "<p>I have no explanation why the mail is not sent when closing the inspector.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\n    Dim objInsp As Inspector\n\n    On Error GoTo ErrorHandler_Application_ItemSend\n\n    ' Do something erroneous\n    Err.Raise 1\n\n    Exit Sub\n\nErrorHandler_Application_ItemSend:\n\n    Cancel = True\n    MsgBox \"Error: \" &amp; Err.Description\n\n    Set objInsp = Item.GetInspector\n\n    ' Look for the mail in the drafts folder\n    objInsp.Close olSave\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 9622165, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Barok", "link": "https://stackoverflow.com/users/9622165/barok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 850, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542667012, "creation_date": 1542159712, "last_edit_date": 1542161138, "question_id": 53291978, "link": "https://stackoverflow.com/questions/53291978/stop-outlook-vba-from-sending-mail-within-itemsend-when-an-error-event-has-occ", "title": "Stop Outlook VBA from sending mail within ItemSend() when an error event has occurred", "body": "<p>Outlook mailitem gets sent when an error occurs during run-time within an ItemSend() event. Placing <code>Cancel = True</code> in the code does not even stop this from happening. Is it an inherent VBA flaw?</p>\n\n<p>How would I get around this problem? Any ideas are welcome.</p>\n\n<pre><code>Public WithEvents myApp As Outlook.Application\n\nSub Initialize_handler()\n    Set myApp = Application\nEnd Sub\n\nPrivate Sub myApp_ItemSend(ByVal Item As Object, Cancel As Boolean)\nOn Error GoTo ErrorHandler_myApp_ItemSend\n    Cancel = True\n\n    ' Do something erroneous\n\n    Exit Sub\n\nErrorHandler_myApp_ItemSend:\n    Cancel = True\n    MsgBox \"Error: \" Err.Description\n    Err.Clear\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542160747, "post_id": 53291480, "comment_id": 93465683, "body": "Thanks, but im not really sure what to do with that, if I run it the whole sheet gets highlighted rather then the 20 odd cells that contain July-18"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "reply_to_user": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542162165, "post_id": 53291480, "comment_id": 93465993, "body": "Not sure what you mean, it seems to be working fine - see the screenshot."}, {"owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542231955, "post_id": 53291480, "comment_id": 93499167, "body": "I just ran it again and it is working for me now as well thanks.      How hard would it be for me to add a message box into the code to prompt for a search item rather then hard coding in &quot;jul-18&quot;  I can see that being useful in the future?"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "reply_to_user": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542232676, "post_id": 53291480, "comment_id": 93499490, "body": "Use something like `str = InputBox(&quot;Enter search value&quot;)&#39; and substitute &#39;str&#39; for the hard coded value.  Cheers,"}, {"owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542322131, "post_id": 53291480, "comment_id": 93538366, "body": "I added str = InputBox(&quot;SEARCH FOR&quot;), but doesn&#39;t this conflict with str = c.Address?"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "reply_to_user": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "edited": false, "score": 0, "creation_date": 1542322490, "post_id": 53291480, "comment_id": 93538476, "body": "That was just a quick example.. please see above, it&#39;s tested and works with an input box.  Cheers,"}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": true, "score": 1, "last_activity_date": 1542322465, "last_edit_date": 1542322465, "creation_date": 1542155560, "answer_id": 53291480, "question_id": 53291272, "link": "https://stackoverflow.com/questions/53291272/find-and-select-dates/53291480#53291480", "title": "Find and Select Dates", "body": "<p>You should be able to adapt it to your needs easily. </p>\n\n<p>[![enter image description here][1]][1]</p>\n\n<pre><code>Sub FindAndSelectAll()\n    Dim str As String, c As Range, r As Range\n    Dim strFind As String\n    Dim rSearch As Range\n\n    Set rSearch = ActiveSheet.Cells\n\n    strFind = InputBox(\"Please enter search string\")\n\n    With rSearch\n        Set c = .Find(strFind, LookIn:=xlValues)\n        If Not c Is Nothing Then\n            Set r = c\n            str = c.Address\n            Do\n                Set r = Union(r, c)\n                ActiveSheet.Range(c.Address).Activate\n                Set c = .FindNext(c)\n\n            Loop While Not c Is Nothing And c.Address &lt;&gt; str\n        End If\n        .Activate\n        If Not r Is Nothing Then r.Select\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10644084, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161218016605525/picture?type=large", "display_name": "Scottyp", "link": "https://stackoverflow.com/users/10644084/scottyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 53291480, "answer_count": 1, "score": 0, "last_activity_date": 1542322465, "creation_date": 1542153961, "last_edit_date": 1542156805, "question_id": 53291272, "link": "https://stackoverflow.com/questions/53291272/find-and-select-dates", "title": "Find and Select Dates", "body": "<p>I am looking to build a simple macro to find a date and select all the cells that contain this date (I then have another working macro that modifies the selected cells). However I cant get the find and select to work. </p>\n\n<p>At the moment the code is picking up the first \"Jul-18\" and then it is spitting out  the no match message.</p>\n\n<p>Any help would be much appreciated;</p>\n\n<pre><code>Sub FIND()\n\nOn Error GoTo nomatch\n\nCells.FIND(What:=Jul - 18, LookIn:=xlValues).Select\n\nnomatch:\nMsgBox (\"Not Found\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1542167683, "post_id": 53291737, "comment_id": 93467152, "body": "Thanks @K.Davis.  Great solution!  Great tips.  One small point: rndHead.Text gives me the chapter/sub-chapter number (i.e. &quot;2&quot; for chapter 2.  My goal is capture the title text, e.g. &quot;Chapter Two&quot;."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1542169737, "post_id": 53291737, "comment_id": 93467571, "body": "@KaiserOtto Please don&#39;t accept until your answer is fulfilled. I would like to assist in fully answering your question"}, {"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1542169826, "post_id": 53291737, "comment_id": 93467594, "body": "Yes.  It&#39;s a numbered list.  So Heading 1 is level 1, i.e. &quot;2&quot; and Heading 2 is level 2, e.g. &quot;2.1&quot; Sub-chapter"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1542169973, "post_id": 53291737, "comment_id": 93467627, "body": "I just want to reconfirm, because you are saying &quot;Title Text&quot; in your first comment - there&#39;s a separate format called Title - which is not Heading 1. Can you please confirm which format exactly you are after? <code>Heading 1</code> or <code>Title</code>? Thanks!"}, {"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1542176613, "post_id": 53291737, "comment_id": 93469488, "body": "I&#39;m after <code>Title</code>. <code>rngHead.Sentences(1)</code> give me the <code>Title</code>. Are you suggesting to use <code>rngHead.Title</code>?"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1542158161, "last_edit_date": 1542158161, "creation_date": 1542157530, "answer_id": 53291737, "question_id": 53291161, "link": "https://stackoverflow.com/questions/53291161/finding-a-heading-style-in-a-word-document/53291737#53291737", "title": "Finding a &quot;Heading&quot; Style in a Word Document", "body": "<p>You can use the <code>range.GoTo()</code> method.</p>\n\n<pre><code>Dim rngHead As Range, str_heading_txt As String, hdgn_STYLE As String\nSet rngHead = Selection.GoTo(wdGoToHeading, wdGoToPrevious)\n\n'Grab the entire text - headers are considered a paragraph\nrngHead.Expand wdParagraph\n\n' Read the text of your heading\nstr_heading_txt = rngHead.Text\n\n' Read the style (name) of your heading\nhdgn_STYLE = rngHead.Style\n</code></pre>\n\n<p>I noticed that you used <code>Selection.Sentences(1)</code> to grab the text, but headings are already essentially a paragraph by itself - so you can just use the <code>range.Expand()</code> method and expand using <code>wdParagraph</code></p>\n\n<hr>\n\n<p>Also, a bit of advice:</p>\n\n<p>When declaring variables such as:</p>\n\n<pre><code>Dim str_heading_txt, hdgn_STYLE As String\n</code></pre>\n\n<p>Your intent was good, but <code>str_heading_txt</code> was actually declared as type <code>Variant</code>. Unfortunately with VBA, if you want your variables to have a specific data type, you much declare so individually:</p>\n\n<pre><code>Dim str_heading_txt As String, hdgn_STYLE As String\n</code></pre>\n\n<p>Or some data types even have \"Shorthand\" methods known as Type Characters:</p>\n\n<pre><code>Dim str_heading_txt$, hdgn_STYLE$\n</code></pre>\n\n<p>Notice how the <code>$</code> was appended to the end of your variable? This just declared it as a <strong>String</strong> without requiring the <code>As String</code>.</p>\n\n<p>Some Common Type-Characters:</p>\n\n<ul>\n<li><code>$</code> String</li>\n<li><code>&amp;</code> Long</li>\n<li><code>%</code> Integer</li>\n<li><code>!</code> Single</li>\n<li><code>#</code> Double</li>\n</ul>\n\n<p>You can even append these to the actual value:</p>\n\n<pre><code>Dim a\n\na = 5\n\nDebug.Print TypeName(a) 'Prints Integer (default)\n\na = 5!\n\nDebug.Print TypeName(a) 'Prints Single\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1542188069, "creation_date": 1542188069, "answer_id": 53296951, "question_id": 53291161, "link": "https://stackoverflow.com/questions/53291161/finding-a-heading-style-in-a-word-document/53296951#53296951", "title": "Finding a &quot;Heading&quot; Style in a Word Document", "body": "<p>Try something based on:</p>\n\n<pre><code>Sub Demo()\nDim Rng As Range, StrHd As String, s As Long\ns = 10\nWith Selection\n  Set Rng = .Range\n  Set Rng = Rng.GoTo(What:=wdGoToBookmark, Name:=\"\\HeadingLevel\")\n  StrHd = Rng.Paragraphs.First.Range.Text\n  Do While Right(Rng.Paragraphs.First.Style, 1) &gt; 1\n    Rng.End = Rng.Start - 1\n    Set Rng = Rng.GoTo(What:=wdGoToBookmark, Name:=\"\\HeadingLevel\")\n    With Rng.Paragraphs.First\n      If Right(.Style, 1) &lt; s Then\n        s = Right(.Style, 1)\n        StrHd = .Range.Text &amp; StrHd\n      End If\n    End With\n  Loop\n  MsgBox StrHd\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 53291737, "answer_count": 2, "score": 1, "last_activity_date": 1542188069, "creation_date": 1542153097, "last_edit_date": 1542176868, "question_id": 53291161, "link": "https://stackoverflow.com/questions/53291161/finding-a-heading-style-in-a-word-document", "title": "Finding a &quot;Heading&quot; Style in a Word Document", "body": "<p>I have a Word macro that allows to put his/her cursor anywhere in a Word document and it finds and saves the Heading 1, Heading 2 and Heading 3 text that is <strong>above</strong> the text selected by the user in order capture the chapter, section and sub-section that is associated with any sentence in the document.  </p>\n\n<p>I am currently using the code below which moves up the document line-by-line until it finds a style that contains \"Heading x\".  When I have completed this task I move down the number of lines that I moved up to get to Heading 1, which may be many pages.  </p>\n\n<p>As you can imagine this is awkward, takes a long time (sometimes 60+ seconds)  and is visually disturbing.  </p>\n\n<p>The code below is that subroutine that identifies the heading.</p>\n\n<pre><code> Dim str_heading_txt, hdgn_STYLE As String \n Dim SELECTION_PG_NO as  Integer \n     hdng_STYLE = Selection.Style\n     Do Until Left(hdng_STYLE, 7) = \"Heading\"\n             LINESUP = LINESUP + 1\n             Selection.MoveUp Unit:=wdLine, COUNT:=1\n             Selection.HomeKey Unit:=wdLine\n             Selection.EndKey Unit:=wdLine, Extend:=wdExtend\n             hdng_STYLE = Selection.Style\n             'reached first page without finding heading\n             SELECTION_PG_NO = Selection.Information(wdActiveEndPageNumber)\n             If SELECTION_PG_NO = 1 Then     'exit if on first page\n        a_stop = True\n                 Exit Sub\n             End If\n     Loop \n     str_heading_txt = Selection.Sentences(1)\n</code></pre>\n\n<p>I tried another approach below in order to eliminate the scrolling and performance issues using the Range.Find command below.  </p>\n\n<p>I am having trouble getting the selection range to move to the text with the \"Heading 1\" style. The code selects the sentence at the initial selection, not the text with the \"Heading 1\" style. </p>\n\n<p>Ideally the Find command would take me to any style that contained \"Heading\" but, if required, I can code separately for \"Heading 1\", \"Heading 2\" and \"Heading 3\".  </p>\n\n<p>What changes to the code are required so that \"Heading 1\" is selected or, alternatively, that \"Heading\" is selected?</p>\n\n<pre><code>Dim str_heading_txt, hdgn_STYLE As String\nDim Rng As Range\nDim Fnd As Boolean\n\nSet Rng = Selection.Range\nWith Rng.Find\n    .ClearFormatting\n    .Style = \"Heading 1\"\n    .Forward = False\n    .Execute\n\n    Fnd = .Found\nEnd With\n\nIf Fnd = True Then\n    With Rng\n        hdng_STYLE = Selection.Style\n        str_heading_txt = Selection.Sentences(1)\n    End With\nEnd If\n</code></pre>\n\n<p>Any assistance is sincerely appreciated.</p>\n"}, {"tags": ["excel", "vba", "vsto", "clickonce", "office-interop"], "comments": [{"owner": {"reputation": 3171, "user_id": 196852, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/33fdb4f51213d3eccb426cf4a4427d85?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/196852/chris"}, "edited": false, "score": 0, "creation_date": 1542226157, "post_id": 53290352, "comment_id": 93496686, "body": "Did you re-sign the deployment after changing <code>loadBehavior</code> to 0?"}, {"owner": {"reputation": 11, "user_id": 4490796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb282626102c8f5f62b164aca364fb81?s=128&d=identicon&r=PG&f=1", "display_name": "goast", "link": "https://stackoverflow.com/users/4490796/goast"}, "reply_to_user": {"reputation": 3171, "user_id": 196852, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/33fdb4f51213d3eccb426cf4a4427d85?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/196852/chris"}, "edited": false, "score": 0, "creation_date": 1543345355, "post_id": 53290352, "comment_id": 93882585, "body": "I did not. This is the solution to my particular issue, thank you Chris!"}], "answers": [{"tags": [], "owner": {"reputation": 3171, "user_id": 196852, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/33fdb4f51213d3eccb426cf4a4427d85?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/196852/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1543347605, "creation_date": 1543347605, "answer_id": 53506948, "question_id": 53290352, "link": "https://stackoverflow.com/questions/53290352/is-there-a-way-to-force-a-clickonce-installation-to-set-loadbehavoir-to-0-for/53506948#53506948", "title": "Is there a way to force a ClickOnce installation to set LoadBehavoir to &quot;0&quot; for a VSTO Add-In", "body": "<p>You need to re-sign the deployment any time you change the manifest directly after you publish it.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/visualstudio/deployment/how-to-re-sign-application-and-deployment-manifests?view=vs-2017\" rel=\"nofollow noreferrer\">MSDN documentation</a></p>\n\n<p><a href=\"https://stackoverflow.com/a/44328309/196852\">One of my answers that has a powershell script that automates this</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4490796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb282626102c8f5f62b164aca364fb81?s=128&d=identicon&r=PG&f=1", "display_name": "goast", "link": "https://stackoverflow.com/users/4490796/goast"}, "is_accepted": false, "score": 0, "last_activity_date": 1543347852, "creation_date": 1543347852, "answer_id": 53507018, "question_id": 53290352, "link": "https://stackoverflow.com/questions/53290352/is-there-a-way-to-force-a-clickonce-installation-to-set-loadbehavoir-to-0-for/53507018#53507018", "title": "Is there a way to force a ClickOnce installation to set LoadBehavoir to &quot;0&quot; for a VSTO Add-In", "body": "<p>The question posed by Chris in the comments section in the initial post identifies the core issue (i.e. Did you re-sign the deployment after changing loadBehavior to 0?)</p>\n\n<p>Once the manifest file is modified for the Add-In, one must re-sign the manifest and assembly. </p>\n\n<p>Instructions for modifying the VSTO deployment properties are addressed <a href=\"https://docs.microsoft.com/en-us/previous-versions/cc442869(v=vs.110)\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Instructions for re-signing assemblies and deployment manifests are addressed <a href=\"https://docs.microsoft.com/en-us/visualstudio/deployment/how-to-re-sign-application-and-deployment-manifests?view=vs-2017\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Generating self-signed certificates can be accomplished with PowerShell, this is the <a href=\"https://gallery.technet.microsoft.com/scriptcenter/Self-signed-certificate-5920a7c6\" rel=\"nofollow noreferrer\">link</a> that I used to create a code signing certificate for a test environment.</p>\n\n<p>My steps were as follows:</p>\n\n<ul>\n<li>Generate a new code signing certificate using PowerShell. komsky provides a great command line <a href=\"https://stackoverflow.com/questions/31772109/makecert-missing-from-windows-10-and-visual-studio-2015-install/31774294#31774294\">example</a>. </li>\n<li>After publishing the VSTO Add-In make modifications to the Add-In assembly manifest by LoadBehavior to 0</li>\n<li>Use MAGE.EXE to sign the manifest <code>mage.exe -sign \"PITA Ribbon.dll.manifest -CertFile \"C:\\Certificates\\cert.pfx -Password ******** -a sha256RSA</code></li>\n<li>Use MAGE.EXE to update the VSTO deployment manifest <code>mage.exe -update \"C:\\PitaDeploy\\Pita Ribbon.vsto\" -appmanifiest \"Pita Ribbon.dll.manifest\" -CertFile \"C:\\Certificates\\cert.pfx -Password ******* -a sha256RSA</code></li>\n</ul>\n\n<p>After performing these steps the VSTO installed with no issues.</p>\n"}], "owner": {"reputation": 11, "user_id": 4490796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb282626102c8f5f62b164aca364fb81?s=128&d=identicon&r=PG&f=1", "display_name": "goast", "link": "https://stackoverflow.com/users/4490796/goast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1543347852, "creation_date": 1542147423, "question_id": 53290352, "link": "https://stackoverflow.com/questions/53290352/is-there-a-way-to-force-a-clickonce-installation-to-set-loadbehavoir-to-0-for", "title": "Is there a way to force a ClickOnce installation to set LoadBehavoir to &quot;0&quot; for a VSTO Add-In", "body": "<p>I am having difficulty with the load behavior of an Excel Ribbon Add-In developed as a VSTO solution. \nThe Add-In serves as an Excel VSTO Ribbon control that has several tabs, each tab's visibility is set to false by default and made visible by the workbook's Add-In instantiation.</p>\n\n<p>For reasons that are unclear to me allowing the ClickOnce install to set the LoadBehavior to 16 (then a subsequent 9) is problematic. The initial value of 16 will load the workbook ribbon tab properly but after closing and reopening the same workbook the ribbon tab is not displayed. </p>\n\n<p>However if another workbook is opened with the same Add-In, both tabs appear in each of the workbooks.</p>\n\n<p>The LoadBehavior of \"0\" works as intended in any case and is the reason for the posted question. </p>\n\n<p>Here is the VBA code for the Add-In instantiation</p>\n\n<pre><code>'This loads the Ribbon Addin\nPrivate Function LoadAddIn() As Boolean\n    On Error GoTo Err_LoadAddIn\n    Dim msg As String\n    Dim m_addIn As COMAddIn\n    Dim m_automationObject As Object\n    Dim m_sWorkbookKey As String    \n\n    msg = \"Unable to load the PITA AddIn, please contact PITA support\"\n\n    'Load the Excel Addin\n    Set m_addIn = Application.COMAddIns(\"PITA Ribbon\")\n    'Connect the COM Add-In to the current workbook\n    m_addIn.Connect = True\n\n    'Set a reference to the utility class that the COM Add-In references\n    m_automationObject = m_addIn.Object\n    'If it is nothing then the Add-In is in a bad state\n    If m_automationObject Is Nothing Then\n        msg = \"Error loading the PITA AddIn, please contact PITA support\"\n        GoTo Err_LoadAddIn\n    Else\n        'Set the service type of the Add-In (currently only SQLServer)\n        m_automationObject.SetDataConnection \"SQLServer\"\n        'Set the workbook key - this is the name of the analyzer\n        m_sWorkbookKey = Worksheets(\"SheetX\").Range(\"A10\")\n\n        'Set the ribbon tab's visibility relative to the current workbook\n        m_automationObject.SetTabVisibility m_sWorkbookKey, True\n\n        'If the connection to the datasource is successful\n        'Populate the Tab's List Controls with the values from SQL Server\n        If m_automationObject.Connected = True Then\n            m_automationObject.SetTabDefaults m_sWorkbookKey\n        End If\n    End If\n\n    LoadAddIn = True\n    Exit Function\n\nErr_LoadAddIn:\n    MsgBox msg, vbCritical, \"AddIn load error\"\n    LoadAddIn = False\nEnd Function\n</code></pre>\n\n<p>I have tried altering the VSTO manifest file in the customization section below to \"0\" but the ClickOnce installer errors out when attempting an installation with this modification.</p>\n\n<pre><code>    &lt;vstov4:customization&gt;\n      &lt;vstov4:appAddIn application=\"Excel\" loadBehavior=\"0\" keyName=\"PITA Ribbon\"&gt;\n        &lt;vstov4:friendlyName&gt;PITA Ribbon&lt;/vstov4:friendlyName&gt;\n        &lt;vstov4:description&gt;PITA Ribbon&lt;/vstov4:description&gt;\n        &lt;vstov4.1:ribbonTypes xmlns:vstov4.1=\"urn:schemas-microsoft-com:vsto.v4.1\"&gt;\n          &lt;vstov4.1:ribbonType name=\"PITAAddIn.PITARibbon, PITA Ribbon, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\" /&gt;\n        &lt;/vstov4.1:ribbonTypes&gt;\n      &lt;/vstov4:appAddIn&gt;\n    &lt;/vstov4:customization&gt;\n</code></pre>\n\n<p>Is there a way to have a ClickOnce installation set the default load behavior to \"0\"?</p>\n\n<p>Any guidance on how to do this is greatly appreciated!</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2016"], "answers": [{"comments": [{"owner": {"reputation": 72, "user_id": 10033450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f15ba7943382cea429f7c19312b91a1?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/10033450/allan"}, "edited": false, "score": 0, "creation_date": 1542237240, "post_id": 53290794, "comment_id": 93501095, "body": "For some reason it still dosen&#39;t say the session name, in the session column"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 72, "user_id": 10033450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f15ba7943382cea429f7c19312b91a1?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/10033450/allan"}, "edited": false, "score": 0, "creation_date": 1542237441, "post_id": 53290794, "comment_id": 93501162, "body": "@Allan Are you saying that the <code>SessionName</code> field of my first SQL statement is empty?"}, {"owner": {"reputation": 72, "user_id": 10033450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f15ba7943382cea429f7c19312b91a1?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/10033450/allan"}, "edited": false, "score": 0, "creation_date": 1542238712, "post_id": 53290794, "comment_id": 93501553, "body": "Yes. Really not sure why, I double and triple checked to make sure i dident make a mistake"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 72, "user_id": 10033450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f15ba7943382cea429f7c19312b91a1?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/10033450/allan"}, "edited": false, "score": 0, "creation_date": 1542238896, "post_id": 53290794, "comment_id": 93501606, "body": "@Allan Did you change <code>MyDate</code> in my code to the name of your date field in <code>Records Query</code> as instructed?"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 0, "last_activity_date": 1542239118, "last_edit_date": 1592644375, "creation_date": 1542150084, "answer_id": 53290794, "question_id": 53290242, "link": "https://stackoverflow.com/questions/53290242/ms-access-automatically-fill-query-column-based-on-start-and-end-date/53290794#53290794", "title": "MS Access automatically fill Query column based on start and end date", "body": "<p>Assuming that your dates are stored using <code>DateTime</code> fields and that your date ranges are contiguous (no gaps), you can determine the appropriate session name for your date using the following correlated subquery:</p>\n\n<pre><code>SELECT q.*,\n(\n    SELECT TOP 1 r.Name \n    FROM Ranges r \n    WHERE q.MyDate &lt;= r.[End date] ORDER BY r.[End date]\n) AS SessionName\nFROM [Records Query] q\n</code></pre>\n<p>Here, I assume that your date ranges are stored in a table called <code>Ranges</code> and that the date field in your <code>Records Query</code> query is called <code>MyDate</code> (change this to suit your data).</p>\n<p>In the above example, I'm assuming you have the following setup:</p>\n<h3>Ranges</h3>\n<p><a href=\"https://i.stack.imgur.com/5Pcgg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5Pcgg.png\" alt=\"Ranges\" /></a></p>\n<h3>Records Query</h3>\n<p><a href=\"https://i.stack.imgur.com/mdoIG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mdoIG.png\" alt=\"Records Query\" /></a></p>\n<h3>SQL</h3>\n<p><a href=\"https://i.stack.imgur.com/xJHYZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xJHYZ.png\" alt=\"SQL\" /></a></p>\n<h3>Result</h3>\n<p><a href=\"https://i.stack.imgur.com/coTpr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/coTpr.png\" alt=\"Result\" /></a></p>\n<p>Unfortunately, you cannot simply inject this subquery into an <code>UPDATE</code> query -</p>\n\n<pre><code>UPDATE [Records Query] q\nSET q.Session = \n(\n    SELECT TOP 1 r.Name \n    FROM Ranges r \n    WHERE q.MyDate &lt;= r.[End date] ORDER BY r.[End date]\n)\n</code></pre>\n<p>...as the resulting query will not be updateable (as the new value references the table being updated).</p>\n<p>As such, you will likely need to output the session names to and primary key from your <code>Records Query</code> query to a local table which can then be used to update your query - others may hopefully know a more elegant way to avoid this.</p>\n"}, {"comments": [{"owner": {"reputation": 72, "user_id": 10033450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f15ba7943382cea429f7c19312b91a1?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/10033450/allan"}, "edited": false, "score": 0, "creation_date": 1542215578, "post_id": 53296480, "comment_id": 93491794, "body": "Sorry i&#39;m a bit new. Where do i type this"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 72, "user_id": 10033450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f15ba7943382cea429f7c19312b91a1?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/10033450/allan"}, "edited": false, "score": 0, "creation_date": 1542230581, "post_id": 53296480, "comment_id": 93498593, "body": "Open a new query, switch to SQL view, paste code. Of course, change names of table/query and fields to those of yours."}, {"owner": {"reputation": 72, "user_id": 10033450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f15ba7943382cea429f7c19312b91a1?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/10033450/allan"}, "edited": false, "score": 0, "creation_date": 1542236745, "post_id": 53296480, "comment_id": 93500916, "body": "I tried this, but the value in the Session Name column does not say the session name. The only thing it does is filters the records based on the last session"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 72, "user_id": 10033450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f15ba7943382cea429f7c19312b91a1?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/10033450/allan"}, "edited": false, "score": 0, "creation_date": 1542268551, "post_id": 53296480, "comment_id": 93509557, "body": "Then you probably have mistyped something and/or the dates fits that session only. We have neither your data nor your query, so it is not easy to be more specific."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1542186509, "creation_date": 1542186509, "answer_id": 53296480, "question_id": 53290242, "link": "https://stackoverflow.com/questions/53290242/ms-access-automatically-fill-query-column-based-on-start-and-end-date/53296480#53296480", "title": "MS Access automatically fill Query column based on start and end date", "body": "<p>You can join by a simple Where clause:</p>\n\n<pre><code>Select\n     [Records Query].*,\n     [Date Ranges].[Name] As [Session Name]\nFrom\n     [Records Query],\n     [Date Ranges]\nWhere\n     [Records Query].[Date] Between [Date Ranges].[Start date] And [Date Ranges].[End date]\n</code></pre>\n"}], "owner": {"reputation": 72, "user_id": 10033450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f15ba7943382cea429f7c19312b91a1?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/10033450/allan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 958, "favorite_count": 0, "accepted_answer_id": 53290794, "answer_count": 2, "score": 0, "last_activity_date": 1542239118, "creation_date": 1542146927, "last_edit_date": 1542150293, "question_id": 53290242, "link": "https://stackoverflow.com/questions/53290242/ms-access-automatically-fill-query-column-based-on-start-and-end-date", "title": "MS Access automatically fill Query column based on start and end date", "body": "<p>I have a Query called <code>Records Query</code> which I'm entering the information with a form. </p>\n\n<p>Every record has a date.</p>\n\n<p>In another table I have a list of date ranges with the name of the range. That means the first column is the <code>Range name</code>, the second <code>Start date</code> and the third, <code>End date</code>.</p>\n\n<p>I want the last column on the <code>Records Query</code> to show the name of the date range that that specific range is in.</p>\n\n<p>For example, if I have the following date ranges:</p>\n\n\n\n<pre><code>+------------+----------+----------+\n| Start date | End date |   Name   |\n+------------+----------+----------+\n| Jan 1      | Jan 10   | session1 |\n| Jan 11     | Jan 20   | session2 |\n+------------+----------+----------+\n</code></pre>\n\n<p>If the date of that record in <code>Records Query</code> is Jan 2, the value of column <code>Session</code> should automatically be <code>session1</code></p>\n\n<p>If anyone can help it would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542145349, "post_id": 53289869, "comment_id": 93461623, "body": "<code>ContactTable</code> should be in quotes: <code>&quot;ContactTable&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1542147078, "creation_date": 1542147078, "answer_id": 53290270, "question_id": 53289869, "link": "https://stackoverflow.com/questions/53289869/excel-vba-double-clicking-a-cell-in-a-sheet-to-generate-filtered-data-on-a-not/53290270#53290270", "title": "Excel VBA - Double-clicking a cell in a sheet to generate filtered data on a nother sheet within the workbook", "body": "<p><code>Sheet2.ListObjects(\"ContactTable\")</code> - that should do the trick.</p>\n"}], "owner": {"reputation": 11, "user_id": 10648616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e7e36d66cdad4c0db30ea774e9a1c0f?s=128&d=identicon&r=PG&f=1", "display_name": "Clinton.Coe", "link": "https://stackoverflow.com/users/10648616/clinton-coe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 766, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542147078, "creation_date": 1542145014, "last_edit_date": 1542145258, "question_id": 53289869, "link": "https://stackoverflow.com/questions/53289869/excel-vba-double-clicking-a-cell-in-a-sheet-to-generate-filtered-data-on-a-not", "title": "Excel VBA - Double-clicking a cell in a sheet to generate filtered data on a nother sheet within the workbook", "body": "<p>I have a workbook that I'm creating that will serve a temporary CRM database for bank clients.</p>\n\n<p>Sheet1 is named Company</p>\n\n<p>Each row on Sheet1 has fields for details like phone, email, and address but also fields that require another sheet to include the necessary info such as Contacts, Accounts, and History (a log of phone and email contacts with the client).</p>\n\n<p>What I am trying to do is create the VBA code on the Company sheet that will take me to the data on the respective specific sheets filtered by that company name.</p>\n\n<p>For example; if I double click on a contact's name on the Company sheet, it would take me the Contacts sheet and filter that sheet for only companies that match the company of the contact I double clicked.</p>\n\n<p>I'm new to VBA and got the code from this website <a href=\"https://stackoverflow.com/questions/35231790/clicking-a-hyperlink-in-excel-to-set-autofilter-on-a-different-sheet\">Clicking a hyperlink in Excel to set autofilter on a different sheet</a>\nThe thread was pretty old so I thought it would be better to create a new one.</p>\n\n<p>I keep getting \"Run-time error '9': Subscript out of range' and the debugger highlights the row that starts with 'Sheet2.ListObjects(ContactTable)</p>\n\n<p>Here is the code I have so far:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    If ActiveCell.Column = 9 Then\n    Sheet2.ListObjects(ContactTable).Range.AutoFilter Field:=1, Criteria1:=ActiveCell.Offset(0, -8).Value\n    Sheet2.Activate\n    End If\nEnd Sub\n</code></pre>\n\n<p>Column1 on all pages is 'Company\" header name</p>\n\n<p>Sheet1 is named Company, Sheet2 is named Contacts</p>\n\n<p>The table on Sheet1 is named CompanyTable, the table on Sheet2 is named ContactTable</p>\n\n<p>I have autofilters on all sheets</p>\n\n<p>Any help with my code would be much appreciated.  Please let me know if you need any other data on my workbook.</p>\n"}, {"tags": ["vba", "loops"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 3, "creation_date": 1542143890, "post_id": 53289568, "comment_id": 93460996, "body": "You are copying cell by cell when you could be copying an entire range at once"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 3, "creation_date": 1542143932, "post_id": 53289568, "comment_id": 93461009, "body": "You could use <code>Range.Value = Range.Value</code> to avoid continuously copy/pasting (slower in comparison to a value transfer)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1542144035, "post_id": 53289568, "comment_id": 93461048, "body": "You could nest your entire range transfer inside the error test. The test already returns a <code>Boolean</code> response, no need to create a variable here. You are essentially going out of your way to say <code>TRUE</code> = <code>TRUE</code>"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 2, "last_activity_date": 1542147940, "creation_date": 1542147940, "answer_id": 53290444, "question_id": 53289568, "link": "https://stackoverflow.com/questions/53289568/how-do-i-speed-up-this-process/53290444#53290444", "title": "How do I speed up this process?", "body": "<p>One of the largest issues in your code is the use of <code>.Activate</code>, <code>.Copy</code>, and <code>.Paste</code>. Also, you are copying each cell in a row one at a time as opposed to the entire row and flipping back and forth between worksheets in the process</p>\n\n<p><strong><em>Untested</strong>: Back up workbook</em></p>\n\n<pre><code>Sub Refresh_Numbers()\n\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n    Dim wsFinish As Worksheet, wsWork As Worksheet\n    With ThisWorkbook\n        Set wsFinish = .Worksheets(\"Finish Schedule\")\n        Set wsWork = .Worksheets(\"Work Page\")\n    End With\n\n    Dim iRow As Long\n    With wsFinish\n        For iRow = 3 To lastRow(wsFinish, \"B\")\n            If Not wsWork.Range(\"B:B\").Find(.Cells(iRow, \"B\"), LookIn:=xlValues, _\n                        LookAt:=xlWhole) Is Nothing And Not IsEmpty(.Cells(iRow, \"B\")) Then\n\n                .Range(.Cells(iRow - 2, 4), .Cells(iRow - 2, 10)).Value = wsWork.Range( _\n                        wsWork.Cells(iRow, 4), wsWork.Cells(iRow, 10)).Value\n\n            End If\n        Next iRow\n    End With\n\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n    End With\n\nEnd Sub\n\nFunction lastRow(ws As Worksheet, Optional col As Variant = 1) As Long\n    With ws\n        lastRow = .Cells(.Rows.Count, col).End(xlUp).Row\n    End With\nEnd Function\n</code></pre>\n\n<p>This could be even more efficient by writing your worksheet into an array first, perform the data value transfers to another array, and rewriting the new array to your second worksheet. </p>\n"}], "owner": {"reputation": 1, "user_id": 10558618, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RFCS9enTayE/AAAAAAAAAAI/AAAAAAAAAF0/BThnx6ny5UE/photo.jpg?sz=128", "display_name": "Shawn Phillips", "link": "https://stackoverflow.com/users/10558618/shawn-phillips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1542147940, "creation_date": 1542143600, "last_edit_date": 1542143725, "question_id": 53289568, "link": "https://stackoverflow.com/questions/53289568/how-do-i-speed-up-this-process", "title": "How do I speed up this process?", "body": "<p>There are two pages with room numbers.</p>\n\n<p>After updating the numbers on \"Finish Schedule\" column 2 (aka B) and sorting them into order, I want the routine to go to sheet \"Work Page\", find the matching room number and copy the finish data from columns 4-10 (aka D-J) into columns 4-10 of \"Finish Schedule\".</p>\n\n<p>This works ok but not efficiently, its pretty slow. I know there's a better way to run that loop but its eluding me. Suggestions please?</p>\n\n<pre><code>Sub Refresh_Numbers()\n    Application.ScreenUpdating = False\n    Dim var As Variant, iRow As Long, iRowL As Long, bln As Boolean\n\n   'Routine to copy finishes back from Work Page to main Finish Schedule\n    Worksheets(\"Finish Schedule\").Activate\n    'Set up the count as the number of filled rows in the first column of Finish Schedule\n    iRowL = Cells(Rows.Count, \"B\").End(xlUp).Row\n\n    'Cycle through all the cells in that column:\n    For iRow = 3 To iRowL\n        'For every cell in Finish Schedule, Room Number column that is not empty, search through the\n        'second column in sheet Work Page for a value that matches that cell value.\n        If Not IsEmpty(Cells(iRow, \"B\")) Then\n            bln = False\n            var = Application.Match(Cells(iRow, \"B\").Value, Sheets(\"Work Page\").Columns(2), 0)\n\n        'If you find a matching value, indicate success by setting bln to true and exit the loop;\n        'otherwise, continue searching until you reach the end of the Sheet.\n        If Not IsError(var) Then\n            bln = True\n        End If\n\n        'If you do find a matching value, copy the finishes to Finish Schedule\n        'If you do not find a matching value copy a blank line of cells to Finish Schedule\n        If bln = False Then\n            Sheets(\"Work Page\").Range(\"D205:J205\").Copy\n            Sheets(\"Finish Schedule\").Cells(iRow, 4).PasteSpecial Paste:=xlPasteValues\n            Else\n            Sheets(\"Work Page\").Cells((iRow) - 2, 4).Copy\n            Sheets(\"Finish Schedule\").Cells(iRow, 4).PasteSpecial Paste:=xlPasteValues\n            Sheets(\"Work Page\").Cells((iRow) - 2, 5).Copy\n            Sheets(\"Finish Schedule\").Cells(iRow, 5).PasteSpecial Paste:=xlPasteValues\n            Sheets(\"Work Page\").Cells((iRow) - 2, 6).Copy\n            Sheets(\"Finish Schedule\").Cells(iRow, 6).PasteSpecial Paste:=xlPasteValues\n            Sheets(\"Work Page\").Cells((iRow) - 2, 7).Copy\n            Sheets(\"Finish Schedule\").Cells(iRow, 7).PasteSpecial Paste:=xlPasteValues\n            Sheets(\"Work Page\").Cells((iRow) - 2, 8).Copy\n            Sheets(\"Finish Schedule\").Cells(iRow, 8).PasteSpecial Paste:=xlPasteValues\n            Sheets(\"Work Page\").Cells((iRow) - 2, 9).Copy\n            Sheets(\"Finish Schedule\").Cells(iRow, 9).PasteSpecial Paste:=xlPasteValues\n            Sheets(\"Work Page\").Cells((iRow) - 2, 10).Copy\n            Sheets(\"Finish Schedule\").Cells(iRow, 10).PasteSpecial Paste:=xlPasteValues\n        End If\n        End If\n    Next iRow\n    Application.CutCopyMode = False\n    Worksheets(\"Finish Schedule\").Range(\"D3\").Select\n    Application.ScreenUpdating = True\n    MsgBox \"Process Completed\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1542143501, "post_id": 53289436, "comment_id": 93460854, "body": "<code>Rows(row + 1).Insert</code>"}, {"owner": {"reputation": 1, "user_id": 10648422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9d4f2d4622792fbca9ad95587af7ba?s=128&d=identicon&r=PG&f=1", "display_name": "TOMBN", "link": "https://stackoverflow.com/users/10648422/tombn"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1542148812, "post_id": 53289436, "comment_id": 93462907, "body": "Thank you very much Davis.  It works.  Here is my complete macro.         Sub Macro1()     Dim row As Long          &#39;Insert new row below button row     row = ActiveSheet.Buttons(Application.Caller).TopLeftCell.row     Rows(row + 1).Insert          &#39;AutoFill new row down     Rows(row).AutoFill Destination:=Rows(row + 1 &amp; &quot;:&quot; &amp; row), Type:=xlFillDefault          &#39;Clear cells A:F and H:M on new row     Range(&quot;A&quot; &amp; row + 1 &amp; &quot;:F&quot; &amp; row + 1).ClearContents     Range(&quot;H&quot; &amp; row + 1 &amp; &quot;:M&quot; &amp; row + 1).ClearContents      End Sub"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10648422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9d4f2d4622792fbca9ad95587af7ba?s=128&d=identicon&r=PG&f=1", "display_name": "TOMBN", "link": "https://stackoverflow.com/users/10648422/tombn"}, "is_accepted": false, "score": 0, "last_activity_date": 1542149519, "last_edit_date": 1542149519, "creation_date": 1542149269, "answer_id": 53290673, "question_id": 53289436, "link": "https://stackoverflow.com/questions/53289436/macro-command-button-to-add-a-row-below-a-clicked-row-and-copy-its-only-formula/53290673#53290673", "title": "Macro command button to add a row below a clicked row and copy its only formula to a new row", "body": "<p>Thank you very much Davis. It works. Here is my complete macro. </p>\n\n<pre><code>Sub Macro1()\n\n    Dim row As Long\n\n    'Insert new row on button row\n    row = ActiveSheet.Buttons(Application.Caller).TopLeftCell.row\n    Rows(row + 1).Insert\n\n    'AutoFill new row\n    Rows(row).AutoFill Destination:=Rows(row + 1 &amp; \":\" &amp; row), Type:=xlFillDefault\n\n    'Clear cells A:F and H:M on new row\n    Range(\"A\" &amp; row + 1 &amp; \":F\" &amp; row + 1).ClearContents\n    Range(\"H\" &amp; row + 1 &amp; \":M\" &amp; row + 1).ClearContents\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10648422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9d4f2d4622792fbca9ad95587af7ba?s=128&d=identicon&r=PG&f=1", "display_name": "TOMBN", "link": "https://stackoverflow.com/users/10648422/tombn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542149519, "creation_date": 1542142896, "last_edit_date": 1542143075, "question_id": 53289436, "link": "https://stackoverflow.com/questions/53289436/macro-command-button-to-add-a-row-below-a-clicked-row-and-copy-its-only-formula", "title": "Macro command button to add a row below a clicked row and copy its only formula to a new row", "body": "<p>I am working on a time sheet where user can click on the + command button, it will add a new row below the clicked command button row and copy the formula to the new row. Users need to enter their hour worked for different funding sources on the same day on several rows.</p>\n\n<p>The macro below works fine however, it adds a row <strong>ABOVE</strong> the clicked row instead of <strong>BELOW</strong> the clicked row. I am posting this question with hope that some experts from this forum can help me.  Thank you very much in advance.  </p>\n\n<pre><code>Sub Macro1()\n\n    Dim row As Long\n\n    'Insert new row on button row\n    row = ActiveSheet.Buttons(Application.Caller).TopLeftCell.row\n    Rows(row).Insert\n\n    'AutoFill from 1 row above new row for 1 row down\n    Rows(row - 1).AutoFill Destination:=Rows(row - 1 &amp; \":\" &amp; row), Type:=xlFillDefault\n\n    'Clear cells A-S on new row\n    Range(\"A\" &amp; row &amp; \":F\" &amp; row).ClearContents\n    Range(\"H\" &amp; row &amp; \":P\" &amp; row).ClearContents\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1542184372, "post_id": 53289342, "comment_id": 93472645, "body": "Please specify how you&#39;re doing the insert. By default, when inserting a record, Access doesn&#39;t move the selected record at all."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1542222718, "post_id": 53289342, "comment_id": 93495152, "body": "It&#39;s a form for a user to type data in to fields. When you press ENTER to complete the record it moves to a new blank record. This makes sense if you are entering multiple records at once but not if you want to stay on that new record."}], "answers": [{"comments": [{"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1542222749, "post_id": 53296742, "comment_id": 93495165, "body": "No, sorry. I am talking about a data entry form."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1542230282, "post_id": 53296742, "comment_id": 93498462, "body": "So enter manually, press Enter saving the record, current record moves to the next (new) record, but you wish to stay on the record just inserted?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1542268617, "post_id": 53296742, "comment_id": 93509582, "body": "Then my edited answer should work. I can&#39;t think of other options."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1542230488, "last_edit_date": 1542230488, "creation_date": 1542187402, "answer_id": 53296742, "question_id": 53289342, "link": "https://stackoverflow.com/questions/53289342/keep-the-record-current-after-inserting-a-new-record-in-form/53296742#53296742", "title": "Keep the record current after inserting a new record in form", "body": "<p>You are probably using some DoCmd commands to insert the records.</p>\n\n<p>Use the <em>RecordsetClone</em> and nothing will move - and the form will display the new record if a new record can be seen:</p>\n\n<pre><code>Dim rs As DAO.Recordset\n\nSet rs = Me.RecordsetClone\nrs.AddNew\n    rs.Fields(\"First Fieldname\").Value = some value\n    rs.Fields(\"Second Fieldname\").Value = some other value\n    ' etc.\nrs.Update\nrs.Close\n</code></pre>\n\n<p><strong>Edit</strong>:</p>\n\n<p>To stay on the current record:</p>\n\n<p>Go to the form's <em>Properties</em>, tab <em>Other</em>, set <em>Cycle Property</em>: Current record</p>\n"}, {"comments": [{"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1542236604, "post_id": 53308065, "comment_id": 93500882, "body": "This is the correct answer but I had a button with the default property set intercepting the ENTER key."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1542226365, "creation_date": 1542226365, "answer_id": 53308065, "question_id": 53289342, "link": "https://stackoverflow.com/questions/53289342/keep-the-record-current-after-inserting-a-new-record-in-form/53308065#53308065", "title": "Keep the record current after inserting a new record in form", "body": "<p>The property that controls this is the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.form.cycle\" rel=\"nofollow noreferrer\"><code>Form.Cycle</code></a> property.</p>\n\n<p>Set that to <em>Current Record (1)</em> and pressing enter or tab on the last field will move you back to the first field again.</p>\n\n<p>Do note that enter doesn't save the current record, it's just an alternative for tab. If you want to save the record when leaving the last field, you can use VBA for that.</p>\n"}], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 53308065, "answer_count": 2, "score": 0, "last_activity_date": 1542230488, "creation_date": 1542142418, "question_id": 53289342, "link": "https://stackoverflow.com/questions/53289342/keep-the-record-current-after-inserting-a-new-record-in-form", "title": "Keep the record current after inserting a new record in form", "body": "<p>I have a form based on a table but I also have some extra options on the same form. I want to keep the record selected after insert so I can set some other options in another table. I tried doing this with VBA After Insert but the form blanks out after that subroutine has ended.</p>\n\n<pre><code>Private Sub Form_AfterInsert()\n    DoCmd.GoToRecord , , acLast\nEnd Sub\n</code></pre>\n\n<p>I know my gotorecord works because I can run it manually and it does select the last record. The problem is that there is a form clear that runs after the \"AfterInsert\". How do I stop it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1542142690, "post_id": 53289310, "comment_id": 93460541, "body": "For the last part <code>cel.Range(&quot;A&quot; &amp; cel.row:&quot;Q&quot; &amp; cel.row).Copy</code> your syntax is wrong here. Does this work? <code>cel.Range(&quot;A&quot; &amp; cel.row &amp;&quot;:Q&quot; &amp; cel.row).Copy</code>"}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1542143116, "post_id": 53289310, "comment_id": 93460713, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42902156/vba-copy-cells-from-another-sheet-based-on-multiple-criteria#42906770\" title=\"vba copy cells from another sheet based on multiple criteria%2342906770\">stackoverflow.com/questions/42902156/&hellip;</a>"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1542161133, "post_id": 53289310, "comment_id": 93465765, "body": "to loop thru worksheets try <code>Dim ws As Worksheet</code> <code>For Each ws In ActiveWorkbook.Worksheets</code> do code <code>Next ws</code>"}, {"owner": {"reputation": 1, "user_id": 10648431, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "R-R", "link": "https://stackoverflow.com/users/10648431/r-r"}, "reply_to_user": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1542203699, "post_id": 53289310, "comment_id": 93484294, "body": "@Brotato - thanks. I tried this:     cel.Range(&quot;A&quot; &amp; cel.row &amp; &quot;:Q&quot; &amp; cel.row).Copy ws.Cells(row, 1), and added text to row 6 on ACtiveSheet. But instead of copying from the beginning of the row and adding it to the correct row on the next tab, it copied from Q5 and pasted in A5."}, {"owner": {"reputation": 1, "user_id": 10648431, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "R-R", "link": "https://stackoverflow.com/users/10648431/r-r"}, "reply_to_user": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1542203835, "post_id": 53289310, "comment_id": 93484380, "body": "@StoneGiant, it is similar, but I don&#39;t know if I can use the match logic since theirs is numeric? I also have multiple sheets to compare to the first one, I&#39;m not sure how to loop through correctly."}, {"owner": {"reputation": 1, "user_id": 10648431, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "R-R", "link": "https://stackoverflow.com/users/10648431/r-r"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1542204006, "post_id": 53289310, "comment_id": 93484479, "body": "@alowflyingpig, I added this into the copyResult sub; it loops through all sheets, but copies and pastes based on the comparison between the master sheet and tab 2, so then on tab 3 it is overriding the question list order and making it an exact copy of tab 2. I&#39;ll try adding it somewhere in the main sub..."}], "owner": {"reputation": 1, "user_id": 10648431, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "R-R", "link": "https://stackoverflow.com/users/10648431/r-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542142268, "creation_date": 1542142268, "question_id": 53289310, "link": "https://stackoverflow.com/questions/53289310/copy-paste-cells-based-on-match-criteria-to-different-rows-on-multiple-sheets", "title": "Copy/paste cells based on match criteria to different rows on multiple sheets", "body": "<p>hoping to get extra eyes on this - I've only dabbled with VBA on personal projects before, but have been successful in the past! This one is a doozy though, never done anything so complex. I'm working with a spreadsheet - first tab is the master list, with multiple questions on it - the following tabs are different questionnaires that use the questions in different sequences.</p>\n\n<p>I'm trying to make a macro that will search through the other tabs and compare the \"Q\" column, which holds the question #. If a tab has a Q cell that matches to the master list, I'd like to copy A#:Q# from the master list row and paste it on that sheet.\nWith a lot of searching on this site, here's how far I got:</p>\n\n<pre><code>Sub Refresh()\n\nRefresh Macro\n\nKeyboard Shortcut: Ctrl+r\n  Dim wM As Worksheet, wR As Worksheet\n  Dim r1 As Range, R2 As Range\n  Dim cel1 As Range, cel2 As Range\n  Dim LastRow As Long\n  Application.ScreenUpdating = False\n\nSet wR = ActiveSheet\nSet wM = ActiveSheet.Next\n\nWith wR\n  Set R2 = .Range(\"Q1\", .Cells(.Rows.Count, .Columns(\"Q:Q\").Column).End(xlUp))\nEnd With\n\nWith wM\n  Set r1 = .Range(\"Q1\", .Cells(.Rows.Count, .Columns(\"Q:Q\").Column).End(xlUp))\nEnd With\n\nLastRow = 1\n\n\nOn Error Resume Next\nFor Each cel1 In r1\n  With Application\n    Set cel2 = .Index(R2, .Match(cel1.Value, R2, 0)) 'find match in active page\n    If Err = 0 Then\n        copyResult cel2, LastRow 'copy result to next page\n    End If\n    Err.Clear\n    LastRow = LastRow + 1\nEnd With\nNext cel1\n\nEnd Sub\n\nSub copyResult(cel As Range, row As Long)\n  Dim ws As Worksheet\n  Set ws = ActiveSheet.Next\n\n  cel.EntireRow.Copy ws.Cells(row, 1)\n\nEnd Sub\n</code></pre>\n\n<p>I'm stuck in two places: \n  1. trying to find a way to trigger the next sheet for \"wM\" to get updated\n  2. getting the copyResult section to copy just part of the row - there's a note section on each tab that shouldn't get overwritten. I tried doing cel.Range(\"A\" &amp; cel.row:\"Q\" &amp; cel.row).Copy, but it didn't work.</p>\n\n<p>Open to all and any thoughts - thanks in advance!</p>\n"}, {"tags": ["r", "excel", "vba", "command-prompt"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542152112, "post_id": 53288856, "comment_id": 93463745, "body": "You&#39;re only using filenames in your calls, which means you&#39;re making assumptions about what the current working directory is - it would maybe be better to either set that explicitly, or use full paths in your scripts."}, {"owner": {"reputation": 63, "user_id": 7316411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6990d37e5e9aec69cf95c6b07a740325?s=128&d=identicon&r=PG&f=1", "display_name": "actuary_meets_data", "link": "https://stackoverflow.com/users/7316411/actuary-meets-data"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542209871, "post_id": 53288856, "comment_id": 93488298, "body": "The issue is not the filepath, I merely replaced actual wd with a simplified version, the R script is definitely getting opened up and running and fails at that specific line of code. I have already identified that it works with the ggarrange call commented out, but doesn&#39;t work with it not commented out."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542216395, "post_id": 53288856, "comment_id": 93492203, "body": "You can keep the cmd window open - <a href=\"https://www.itechtics.com/3-ways-to-prevent-command-prompt-from-closing-after-running-commands/\" rel=\"nofollow noreferrer\">itechtics.com/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7316411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6990d37e5e9aec69cf95c6b07a740325?s=128&d=identicon&r=PG&f=1", "display_name": "actuary_meets_data", "link": "https://stackoverflow.com/users/7316411/actuary-meets-data"}, "edited": false, "score": 0, "creation_date": 1542142890, "post_id": 53289294, "comment_id": 93460616, "body": "Are you implying that the code wouldn&#39;t run in the first place? I pasted a simplified version of my code to hide filepaths, but the script definitely runs when running it from the batch file. In fact that is the method I have been using for awhile (something I pulled off of stack a little while ago actually). It just isn&#39;t able to get past any step that involves ggarrange or arrangeGrob in R for some reason."}], "tags": [], "owner": {"reputation": 547, "user_id": 10489562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CSQYx.jpg?s=128&g=1", "display_name": "phili_b", "link": "https://stackoverflow.com/users/10489562/phili-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1542142218, "creation_date": 1542142218, "answer_id": 53289294, "question_id": 53288856, "link": "https://stackoverflow.com/questions/53288856/confused-by-difference-between-running-r-from-batch-file-versus-running-it-direc/53289294#53289294", "title": "Confused by difference between running R from batch file versus running it directly from shell", "body": "<p>I think you have a problem with PATH of the RScript in case one : it is lost in the double batch call.</p>\n"}], "owner": {"reputation": 63, "user_id": 7316411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6990d37e5e9aec69cf95c6b07a740325?s=128&d=identicon&r=PG&f=1", "display_name": "actuary_meets_data", "link": "https://stackoverflow.com/users/7316411/actuary-meets-data"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1586394873, "creation_date": 1542140264, "last_edit_date": 1586394873, "question_id": 53288856, "link": "https://stackoverflow.com/questions/53288856/confused-by-difference-between-running-r-from-batch-file-versus-running-it-direc", "title": "Confused by difference between running R from batch file versus running it directly from shell", "body": "<p>I recently came across a strange error, and while I managed to fix it, I cannot for the life of me figure out what was going wrong behind the scenes and I would like to understand what was going on. I am currently writing a program that takes Excel inputs and uses them to direct a program written in R, that ultimately spits out results to be fed back into Excel for user review.</p>\n\n<p>My original solution utilized a batch file that consisted of a single line, calling:</p>\n\n<pre><code>Rscript \"Rfilepath.R\" \n</code></pre>\n\n<p>that was called from VBA using the below:</p>\n\n<pre><code>Dim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\nDim waitOnReturn As Boolean: waitOnReturn = True\nDim windowstyle As Integer: windowstyle = 1\nwsh.Run Chr(34) &amp; BatchFilePath &amp; Chr(34), windowstyle, waitOnReturn\n</code></pre>\n\n<p>However, this proved unable to run the below R code (extremely simplified):</p>\n\n<pre><code>    library(ggplot2)\n    library(gridExtra)\n    library(ggpubr)\n\n    x &lt;- seq(1,10)\n    y &lt;- seq(11,20)\n    z &lt;- seq(6,15)\n    a &lt;- ggplot(data.frame(cbind(x,y)),aes(x=x,y=y))+geom_point()\n    b &lt;- ggplot(data.frame(cbind(y,z)),aes(x=y,y=z))+geom_point()\n    c &lt;- ggplot(data.frame(cbind(x,z)),aes(x=x,y=z))+geom_point()\n\n\n    test &lt;- ggarrange(ggarrange(a,b,nrow=2),c,ncol=2)\n    ggsave(file=\"filepath.png\",plot=test)\n</code></pre>\n\n<p>The problem resulted when the ggarrange function was called. However, I was able to get this situation working by doing the following in VBA (essentially cutting out the batch file step):</p>\n\n<pre><code>Set wsh = VBA.CreateObject(\"WScript.Shell\")\nDim waitTillComplete As Boolean: waitTillComplete = True\nDim style As Integer: style = 1\nDim errorCode As Integer\nerrorCode = wsh.Run(\"Rscript \" &amp; Chr(34) &amp; RPath &amp; Chr(34), style, waitTillComplete)\n</code></pre>\n\n<p>What is the difference between these two approaches and why did one work while the other one did not? It was difficult to debug due to the batch terminal immediately closing on error (probably due to running it from VBA). Any tips or recommendations for debugging these types of issues would also be greatly appreciated. Thanks!</p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1542140280, "post_id": 53288833, "comment_id": 93459667, "body": "Would it be possible to edit your post to narrow down those 292 lines of code to the area where you&#39;re having problems?"}, {"owner": {"reputation": 23, "user_id": 10647090, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "ETB", "link": "https://stackoverflow.com/users/10647090/etb"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542141392, "post_id": 53288833, "comment_id": 93460066, "body": "Yes definitely, I added the code in order to give some background on what im trying to do.  Consider this , I have a custom collection set up of Various products - V1 , V2 all the way to V8.. And i have the above code that generates a ppt presentation using the named ranges of the pertaining product within the worksheet.  Im having trouble enclosing the code above within a loop, to iterate over the collections and produce the ppt. Currently it does it for V1, id like it to do it for all 8"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542181701, "post_id": 53288833, "comment_id": 93471437, "body": "You can try to provide an easier <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that just illustrates your actual issue using an example so people don&#39;t have to work through 292 lines? This will make it more likely to get an answer here."}], "answers": [{"tags": [], "owner": {"reputation": 502, "user_id": 7277322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0VwwD.png?s=128&g=1", "display_name": "Jens.Huehn_at_SlideFab.com", "link": "https://stackoverflow.com/users/7277322/jens-huehn-at-slidefab-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1542145040, "creation_date": 1542145040, "answer_id": 53289872, "question_id": 53288833, "link": "https://stackoverflow.com/questions/53288833/vba-macro-to-create-ppt-presentation/53289872#53289872", "title": "VBA Macro To create PPT Presentation", "body": "<p>just looked at your code. If I get your issue right, then you want to create a loop creating all these 8 slides or so and you ask where to get the parameters like height or width from. \nIf this understanding is correct, you could create a table in Excel to manage your automation. The benefit is that if something changes, no code has to be changed: You just need to update the control table. This table could have the following columns: </p>\n\n<ul>\n<li>Source sheet</li>\n<li>Source range</li>\n<li>Target slide no</li>\n<li>Target shape width</li>\n<li>Target shape height</li>\n<li>Target shape top</li>\n<li>Target shape left</li>\n<li>Target shape font name</li>\n<li>Target shape font size</li>\n</ul>\n\n<p>Then your macro needs to iterate over each row and read out the values in order to position and format your Powerpoint correctly. In order to keep your code clean and reusable you should try to wrap things up in functions, e.g. a function for copying, pasting and setting up a shape based with the parameters as mentioned in the table above.</p>\n\n<p>In case you just need something which is working, you can also try (my software) <a href=\"https://slidefab.com\" rel=\"nofollow noreferrer\">SlideFab.com</a> which is free as long as not more than two elements (e.g. shape, chart, table, etc.) per slide is copied from Excel to Powerpoint (so it should work for you, I guess). Then you don't need to code at all.</p>\n\n<p>Cheers</p>\n\n<p>Jens</p>\n"}], "owner": {"reputation": 23, "user_id": 10647090, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "ETB", "link": "https://stackoverflow.com/users/10647090/etb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 923, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542181562, "creation_date": 1542140159, "last_edit_date": 1542181562, "question_id": 53288833, "link": "https://stackoverflow.com/questions/53288833/vba-macro-to-create-ppt-presentation", "title": "VBA Macro To create PPT Presentation", "body": "<p>I have a macro set up to automate the creation of a ppt. As well ive set up a custom collections object to store the different \"products\" and their respective charts. With this in mind, i wanted to create a For Each loop within the custom collection to iterate over each product, and create the PPT presentation, with a (3*i+1) interval on the ppt slides. such as </p>\n\n<pre><code>For I = 0 to slides.count\n\n            \u2018slides(3*i) to write to the first page\n            \u2018slides(3*I + 1) to write to the second page\n            \u2018slides(3*I + 2) to write to the third page\n\nNext i\n</code></pre>\n\n<p>The code i have so far can produce the first item in the collection no problem, unfortunately ive been unsucceful in setting up the loop to iterate over the collection. </p>\n\n<p>here is where i am now: </p>\n\n<p>Ideally, i'd like to store also the width/height and formatting details within the collection as well, but one issue at a time !</p>\n\n<p>Any help would be greatly appreciated!! </p>\n\n<pre><code>Sub test2()\n\nDim Mypath As String\nDim Myname As String\nDim myTitle As String\nDim shapeCount As Integer\n\nDim PPT As Object\nSet PPT = CreateObject(\"PowerPoint.Application\")\n\n\nMyname = ThisWorkbook.Name\nMypath = ThisWorkbook.Path\n\n\nPPT.Visible = True\nPPT.Presentations.Open Filename:=Mypath &amp; \"\\XXXX - \nTemplate.pptx\"\n\nDim shP As Object\nDim myShape As Object\nDim mySlide As Object\nDim tempSize As Integer, tempFont As String\n\n\nDim Funds As Collection\nDim V As Fund\n\nSet V = New Fund\nSet Funds = New Collection\n\nDim FundID As String\nDim Title As Range\nDim Fund_MER As String\nDim Fund_Yield As String\nDim Asset_Alloc As String\nDim Asset_Alloc2 As String\nDim Asset_Alloc3 As String\nDim Asset_Alloc4 As String\nDim Title_2 As String\nDim Trailing As String\nDim Calendar As String\n\n\nV.FundID = \"V1\"\nV.Title = \"Profile_FactSheet_Title_En\"\nV.Fund_MER = \"V1_MER\"\nV.Fund_Yield = \"V1_Yield\"\nV.Asset_Alloc = \"V1_assetAlloc_En_SourceData\"\nV.Asset_Alloc2 = \"AAV1EN\"\nV.Asset_Alloc3 = \"FIV1EN\"\nV.Asset_Alloc4 = \"FIMAV1EN\"\nV.Title_2 = \"Profile_FactSheet_Title_En\"\nV.Trailing = \"RetV1TrailingEN\"\nV.Calendar = \"RetV1CalendarEN\"\n\n\nFunds.Add V, V.FundID\n\nV.FundID = \"V2\"\nV.Title = \"Profile_FactSheet_Title_En\"\nV.Fund_MER = \"V2_MER\"\nV.Fund_Yield = \"V2_YIELD\"\nV.Asset_Alloc = \"V2_assetAlloc_En_SourceData\"\nV.Asset_Alloc2 = \"AAV2EN\"\nV.Asset_Alloc3 = \"FIV2EN\"\nV.Asset_Alloc4 = \"EQSECV2EN\"\nV.Title_2 = \"Profile_FactSheet_Title_En\"\nV.Trailing = \"RetV2TrailingEN\"\nV.Calendar = \"RetV2CalendarEN\"\n\n\nFunds.Add V, V.FundID\n\nWorksheets(\"Profile Fact Sheet Tables EN\").Activate\n\n'select the name of report\nSet shP = Range(V.Title)\n\n'select the ppt sheet you wish to copy the object to\nSet mySlide = PPT.ActivePresentation.slides(1)\n\n'count the number of shapes currently on the PPT\nshapeCount = mySlide.Shapes.Count\n'copy the previously selected shape\nshP.Copy\n'paste it on the PPT\nmySlide.Shapes.Paste\n\n'wait until the count of shapes on the PPT increases, which signals that the past operation is finished.\nDo '&lt;~~ wait completion of paste operation\n    DoEvents\nLoop Until mySlide.Shapes.Count &gt; shapeCount\n\n'adjust formatting of the newly copied shape: position on the sheet, font &amp; size\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\n    myShape.Left = 254.016\n    myShape.Top = 42.8085\n    myShape.Width = 286.0515\n    myShape.Height = 46.7775\n    myShape.TextEffect.FontSize = 15\n    myShape.TextEffect.FontName = \"Century Schoolbook\"\n\n\n'activate the sheet containing the charts.\nWorksheets(\"Profile Fact Sheet Tables EN\").Activate\n\n\n'copy mer data object\nSet shP = Range(V.Fund_MER)\n\n'switch to slide\nSet mySlide = PPT.ActivePresentation.slides(1)\n\n'count the current number of shapes\nshapeCount = mySlide.Shapes.Count\n\n'copy and paste previously selected shape\nshP.Copy\nmySlide.Shapes.Paste\n\n'wait until the number of shapes on the ppt changes.\nDo '&lt;~~ wait completion of paste operation\n    DoEvents\nLoop Until mySlide.Shapes.Count &gt; shapeCount\n\n'adjust the formatting of the shape.\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\n    myShape.Left = 210.357\n    myShape.Top = 149.121\n    myShape.TextEffect.FontSize = 10\n    myShape.TextEffect.FontName = \"Calibri (Corps)\"\n\nSet shP = Range(V.Fund_Yield)\n\nshapeCount = mySlide.Shapes.Count\nshP.Copy\nmySlide.Shapes.Paste\n\nDo '&lt;~~ wait completion of paste operation\n    DoEvents\nLoop Until mySlide.Shapes.Count &gt; shapeCount\n\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\n    myShape.Left = 210.357\n    myShape.Top = 164.43\n    myShape.TextEffect.FontSize = 10\n    myShape.TextEffect.FontName = \"Calibri (Corps)\"\n\nmySlide.ActiveWindow.Selection.Unselect\n\n\nSet shP = Range(V.Asset_Alloc) 'Range(\"V1_assetAlloc_En_SourceData\")\n\nSet mySlide = PPT.ActivePresentation.slides(1) '1\n\nshapeCount = mySlide.Shapes.Count\nshP.Copy\nmySlide.Shapes.Paste\n\nDo '&lt;~~ wait completion of paste operation\n    DoEvents\nLoop Until mySlide.Shapes.Count &gt; shapeCount\n\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\n    myShape.Left = 265.923\n    myShape.Top = 124.74\n    myShape.Width = 259.4025\n\n\nWorksheets(\"Profile Fact Sheet Tables EN\").Activate\n\nSet shP = ActiveSheet.Shapes(V.Asset_Alloc2)\nSet mySlide = PPT.ActivePresentation.slides(1)\n\nshapeCount = mySlide.Shapes.Count\nshP.Copy\nmySlide.Shapes.Paste\n\nDo '&lt;~~ wait completion of paste operation\n    DoEvents\nLoop Until mySlide.Shapes.Count &gt; shapeCount\n\n\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\n    myShape.Left = 62.937\n    myShape.Top = 246.3615\n\n\nWorksheets(\"Profile Fact Sheet Tables EN\").Activate\n\nSet shP = ActiveSheet.Shapes(V.Asset_Alloc3)\nSet mySlide = PPT.ActivePresentation.slides(1)\n\nshapeCount = mySlide.Shapes.Count\nshP.Copy\nmySlide.Shapes.Paste\n\nDo '&lt;~~ wait completion of paste operation\n    DoEvents\nLoop Until mySlide.Shapes.Count &gt; shapeCount\n\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\n    myShape.Left = 28.0665\n    myShape.Top = 450.765\n\nWorksheets(\"Profile Fact Sheet Tables EN\").Activate\n\nSet shP = ActiveSheet.Shapes(V.Asset_Alloc4)\nSet mySlide = PPT.ActivePresentation.slides(1)\n\nshapeCount = mySlide.Shapes.Count\nshP.Copy\nmySlide.Shapes.Paste\n\nDo '&lt;~~ wait completion of paste operation\n    DoEvents\nLoop Until mySlide.Shapes.Count &gt; shapeCount\n\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\n    myShape.Left = 265.6395\n    myShape.Top = 481.0995\n\nWorksheets(\"Profile Fact Sheet Tables EN\").Activate\n\nSet shP = Range(V.Title_2) 'Cells(1, 2)\n\nSet mySlide = PPT.ActivePresentation.slides(1)\n\nshapeCount = mySlide.Shapes.Count\nshP.Copy\nmySlide.Shapes.Paste\n\nDo '&lt;~~ wait completion of paste operation\n    DoEvents\nLoop Until mySlide.Shapes.Count &gt; shapeCount\n\n\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\n    myShape.Left = 254.016\n    myShape.Top = 42.8085\n    myShape.Width = 286.0515\n    myShape.Height = 46.7775\n    myShape.TextEffect.FontSize = 15\n    myShape.TextEffect.FontName = \"Century Schoolbook\"\n\nWorksheets(\"Perf Tables 1859\").Activate\n\n\nSet shP = ActiveSheet.Shapes(V.Trailing)\nSet mySlide = PPT.ActivePresentation.slides(2)\n\nshapeCount = mySlide.Shapes.Count\nshP.Copy\nmySlide.Shapes.Paste\n\nDo '&lt;~~ wait completion of paste operation\n    DoEvents\nLoop Until mySlide.Shapes.Count &gt; shapeCount\n\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\n    myShape.Left = 33.453\n    myShape.Top = 155.925\n\nWorksheets(\"Perf Tables 1859\").Activate\n\nSet shP = ActiveSheet.Shapes(V.Calendar)\nSet mySlide = PPT.ActivePresentation.slides(2)\n\nshapeCount = mySlide.Shapes.Count\nshP.Copy\nmySlide.Shapes.Paste\n\nDo '&lt;~~ wait completion of paste operation\n    DoEvents\nLoop Until mySlide.Shapes.Count &gt; shapeCount\n\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\n    myShape.Left = 33.453\n    myShape.Top = 372.519\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 1515, "user_id": 4114782, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/a7a894ffea3afedf3f70c7cc54fa7518?s=128&d=identicon&r=PG&f=1", "display_name": "Duston", "link": "https://stackoverflow.com/users/4114782/duston"}, "edited": false, "score": 0, "creation_date": 1542140450, "post_id": 53288812, "comment_id": 93459716, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19395813/excel-search-if-a-specific-text-exists-in-a-column\">Excel: search if a specific text exists in a column</a>"}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1542143472, "post_id": 53288812, "comment_id": 93460847, "body": "Since you have &quot;tried everything&quot; you should probably post the code that comes closest to what you want it to do and ask a specific question instead of asking for someone to write the code from scratch. Consider also reading the Stack Overflow <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a> section and taking the <a href=\"https://stackoverflow.com/tour\">Stack Overflow Tour</a>. Then you can edit your question and make it better."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 4, "last_activity_date": 1542140802, "creation_date": 1542140802, "answer_id": 53288976, "question_id": 53288812, "link": "https://stackoverflow.com/questions/53288812/search-for-duplicate-text-string-in-two-columns-and-highlight-excel/53288976#53288976", "title": "Search for duplicate text string in two columns and highlight, excel", "body": "<p>Multiple ways to do this but here's one option with conditional formatting.</p>\n\n<ol>\n<li><p>Rule applied to data in column A, using <code>COUNTIF</code> and wildcards.</p>\n\n<pre><code>=COUNTIF($B$2:$B$5,\"*\"&amp;A2&amp;\"*\")&gt;0\n</code></pre></li>\n<li><p>Rule applied to data in column B, using <code>ISNUMBER</code>, <code>SEARCH</code> and <code>SUMPRODUCT</code>.</p>\n\n<pre><code>=SUMPRODUCT(--ISNUMBER(SEARCH($A$2:$A$5,B2)))&gt;0\n</code></pre></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/pMGX0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pMGX0.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 10648316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be7eb8cff6f92ae259a56af7aac9149f?s=128&d=identicon&r=PG&f=1", "display_name": "juanjoalv205", "link": "https://stackoverflow.com/users/10648316/juanjoalv205"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1586394909, "creation_date": 1542140081, "last_edit_date": 1586394909, "question_id": 53288812, "link": "https://stackoverflow.com/questions/53288812/search-for-duplicate-text-string-in-two-columns-and-highlight-excel", "title": "Search for duplicate text string in two columns and highlight, excel", "body": "<p>I'm looking for a way to search and highlight duplicate text strings in two different columns in Excel; this means that the cell content doesn't have to be identical, instead of that is what I need is that if the content of column A is somehow contained in any cell of column B, both cells get highlighted.</p>\n\n<p>For example, let's say that I have two columns, one named \"Patient\" and another one called \"Couples\". So, what I would need is to make a comparison between both columns, and if one of the patient's names is within a couple, both cells get highlighted:</p>\n\n<pre><code>Column A. Patient name  |  Column B. Couple name\nJohn Smith              |  Adriana Lewis - Mark Rutte\nPeter Brown             |  Giaccomo Down - Rosy Lawn\nJerry Goldsmith         |  Bob Loewe - Gigi Pink\nEwan Thompson           |  Sonia Farrel - John Smith\n</code></pre>\n\n<p>In this example, the content of A2 (\"John Smith\") is also contained in B5 (\"Sonia Farrel - John Smith\"), so that I would need that both A2 and B5 get highlighted. Also, both columns don`t have the same range, one is shorter than the other, since there are more names than couples; and it can happen that two names in different cell are contained in a single couple, so that all three cells should get highlighted.</p>\n\n<p>I have tried everything, with no success... please help!</p>\n"}, {"tags": ["excel", "vba", "selenium", "selenium-webdriver", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 29, "user_id": 10648280, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sKhan", "link": "https://stackoverflow.com/users/10648280/skhan"}, "edited": false, "score": 0, "creation_date": 1542223163, "post_id": 53288748, "comment_id": 93495355, "body": "I have reviewed the posts you have linked here and tried to adjust my code but couldn&#39;t resolve it.  It is because I can&#39;t find the same commands in those posts such as .wait.until   elementobeclickable  etc. as I&#39;m using selenium basic type library in VBA.    Any help in putting together the right command for selenium basic vba is greatly appreciated."}, {"owner": {"reputation": 29, "user_id": 10648280, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sKhan", "link": "https://stackoverflow.com/users/10648280/skhan"}, "edited": false, "score": 0, "creation_date": 1542230632, "post_id": 53288748, "comment_id": 93498619, "body": "My code is working now.  I inserted a .wait (5000) after the upload code and before clicking the button code and now it&#39;s running good.  Thanks!"}], "owner": {"reputation": 29, "user_id": 10648280, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sKhan", "link": "https://stackoverflow.com/users/10648280/skhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "closed_date": 1542180060, "answer_count": 0, "score": 1, "last_activity_date": 1542182386, "creation_date": 1542139813, "last_edit_date": 1542182386, "question_id": 53288748, "link": "https://stackoverflow.com/questions/53288748/selenium-vba-runs-fine-with-step-f8-but-skips-a-line-when-running-in-full-f5", "closed_reason": "Duplicate", "title": "Selenium VBA runs fine with step F8 but skips a line when running in full F5", "body": "<p>I searched all over the internet and in this forum and can't find the answer.  Below code is used to upload file to a wordpress website.  When I use F8 to step through it, it works fine.  However, when run the full code, after the upload using <code>XPath (\"//input[starts-with(id, 'htm15_')]\").SendKeys (ws.Cells(1.4))</code>, the macro seems to skip the next line which is to click on a button (Insert file URL) and the browser stucks on this uploading page and will not load the next page where the Publish button appears.  At this point, an error came out and stated couldn't find the element Publish.</p>\n\n<p>I try different things, adding global ImplicitWait, adding timeouts for the above mentioned lines of code and to no avail.  It seems that after uploading the file, the macro just doesn't click the button (skips that line of code) and therefore couldn't find the Publish button in the next line.  The problem lines of code have been indicated by 2 asterisks.  Appreciate any help.</p>\n\n<p><img src=\"https://i.stack.imgur.com/MMkUW.png\" alt=\"The Error Message\"></p>\n\n<pre><code>Public Sub UploadPost()\n\n Dim ws As Worksheet\n Dim filename As String\n Dim wb As Workbook\n Dim D As WebDriver\n Dim Path As String\n Dim i As Integer\n\n    Set ws = ThisWorkbook.Worksheets(\"Data\")\n    Set D = New ChromeDriver\n    Const URL = \"https://www.myweb.com/login/\"\n\n'To login to website\n\n    With D\n        .Timeouts.ImplicitWait = 10000    'global implicit wait 5 seconds than default 3 seconds\n        .Start \"Chrome\"\n        .Window.Maximize\n        .Get URL\n        .FindElementById(\"user_login\").SendKeys(\"id\").Click\n        .FindElementById(\"user_pass\").SendKeys(\"pw\").Click\n        .FindElementByName(\"submit\").Click\n\n    End With\n\n'Upload daily file to Download Monitor and get file ID\n\n        ws.Range(\"H2:H9\").Clear\n        D.FindElementById(\"menu-posts-dlm_download\").Click          'Click Download on left menu\n\n  For i = 2 To 9\n\n    With D\n\n        .FindElementByClass(\"page-title-action\").Click                                          'Click Add New\n        .FindElementById(\"title\").SendKeys(ws.Cells(i, 2)).Click                                'Type title copy from spreadsheet\n        .FindElementById(\"_members_only\").Click                                                 'Click members only category\n        .FindElementById(ws.Cells(i, 3)).Click                                                  '17-china, 21-HK, 25-NAS, 10-NYSE\n        .FindElementByLinkText(\"Add file\").Click                                                'Add File\n        .FindElementByXPath(\"//input[starts-with(@id,'dp')]\").Clear                             'Select the correct date\n        .FindElementByXPath(\"//input[starts-with(@id,'dp')]\").SendKeys (ws.Cells(i, 9))\n        .FindElementByLinkText(\"Upload file\").Click\n        .FindElementByLinkText(\"Upload Files\").Click\n        .FindElementByXPath(\"//input[starts-with(@id,'html5_')]\").SendKeys (ws.Cells(i, 4))      'upload file using path from spreadsheet\n        **.FindElementByXPath(\"//*[@id='__wp-uploader-id-0']/div[5]/div/div[2]/button\").Click      'Click save Insert file URL\n        .FindElementById(\"publish\").Click**\n        ws.Cells(i, 8) = D.FindElementByXPath(\"//*[@id='dlm-info-url']\").Value\n\n\n    End With\n\n   Next i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1542136257, "post_id": 53287951, "comment_id": 93457912, "body": "You&#39;ll probably need a <code>Worksheet_Change</code> event."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1542136459, "post_id": 53287951, "comment_id": 93458007, "body": "You can do this via a cell reference on your checkbox without vba. In the cell reference type a formula like <code>=IF(A1=&quot;NY&quot;,TRUE,FALSE)</code> where A1 = the 50 state drop down list."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 10647926, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-61Wl-cONzAo/AAAAAAAAAAI/AAAAAAACGy8/fMIZ9BfezIk/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/10647926/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1542144344, "last_edit_date": 1542144344, "creation_date": 1542137499, "answer_id": 53288264, "question_id": 53287951, "link": "https://stackoverflow.com/questions/53287951/drop-down-list-enables-select-checkboxes/53288264#53288264", "title": "Drop down list enables select checkboxes", "body": "<p>When you say \"drop down list\" I assume you mean a cell with data validation and that your \"checkboxes\" are checkbox form controls.</p>\n\n<p>If the cell with data validation is A1 and the Check Boxes are linked to cells B1, C1, and D1 you would simply place the following in each cell:</p>\n\n<p>B1 (all states) <code>=IF($A$1&lt;&gt;\"\",TRUE,FALSE)</code>\nC1 and D1 (only NY) <code>=IF($A$1=\"NY\",TRUE,FALSE)</code></p>\n\n<p><img src=\"https://i.stack.imgur.com/GY3l5.png\" alt=\"Image showing proposed solution.\"></p>\n"}], "owner": {"reputation": 41, "user_id": 10161636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9157c7d3f10c6dacf7e7d7995050609d?s=128&d=identicon&r=PG&f=1", "display_name": "BetO", "link": "https://stackoverflow.com/users/10161636/beto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1542239241, "answer_count": 1, "score": -3, "last_activity_date": 1586394945, "creation_date": 1542136163, "last_edit_date": 1586394945, "question_id": 53287951, "link": "https://stackoverflow.com/questions/53287951/drop-down-list-enables-select-checkboxes", "closed_reason": "Needs more focus", "title": "Drop down list enables select checkboxes", "body": "<p>I have a drop down list of the 50 US states in my excel sheet. When I select New York, I want three checkboxes be enabled to select. When I select any of the other 49 states, I only want one of those three check boxes selected. How can I get my checkboxes to be conditional of a drop down list value? </p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542136188, "post_id": 53287765, "comment_id": 93457877, "body": "Have you stepped through? Is this right <code>If accumulator.Offset(-1, 0) =    </code> as the offset is row 13 which is full of letters?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1542136428, "post_id": 53287765, "comment_id": 93457987, "body": "On closer examination, your description doesn&#39;t seem to tally with your code."}, {"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542136962, "post_id": 53287765, "comment_id": 93458224, "body": "The macro works except for the end where it&#39;s suppose to move the contents form cells B30, F30 and J30. Which part of my description is not correct?"}, {"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542140566, "post_id": 53287765, "comment_id": 93459759, "body": "Hi, I just did the step through and it finds the cell where the contents of either cells B30, F30 and J30 are to be moved to and then it does nothing. Thanks o much for your help."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542141815, "post_id": 53287765, "comment_id": 93460216, "body": "Which line is it that you don&#39;t think is working? I can&#39;t see where you are adding 1 to the last digits. Sorry but I&#39;m confused."}, {"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542142822, "post_id": 53287765, "comment_id": 93460592, "body": "I think the problem line is: Range(&quot;E&quot; &amp; found).Value = pair.  Using my Excel example cell B30 has the 7-15 in it. It has to be moved to cell F1 and be increased by 1 so it becomes 7-16."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1542204581, "post_id": 53289576, "comment_id": 93484881, "body": "I tested your code and it works but I need the rest of the code to make it all work. The great news is I think you may have helped me to solve the problem on my own. If you can bear with me and if I can ask for, I hope, a small amount of help we might be done here. In my original code the line \u201cRange(&quot;E&quot; &amp; found).Value = pair\u201d  can we change that E (I assume that\u2019s the search criteria) to search specific cells E1 to E12 or use the range E1:E12.  I\u2019ve tried to make the change but it will not work. Also, after each copy and paste of cell B30 etc.  delete all contents in cell B30, C30, D30 etc."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1542210533, "post_id": 53289576, "comment_id": 93488766, "body": "Yes, but where in column E should it go?"}, {"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1542212868, "post_id": 53289576, "comment_id": 93490249, "body": "I&#39;m getting there using VBA but I have a ways to go so please bear with me. So if I&#39;m correct in saying that it searches column E for the correct cell i would say the range is E1:E12 or am I misunderstanding your question?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1542213315, "post_id": 53289576, "comment_id": 93490533, "body": "In the code above, when <code>found=1</code> the value in B30 is put in E1, and then F30 goes in E2 etc. What I&#39;m asking is what determines the output cell? What are you searching E1:E12 for?"}, {"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1542213539, "post_id": 53289576, "comment_id": 93490677, "body": "Sorry now I know what you&#39;re referring to. As per my Excel image, my macro is suppose to find specified cells that contain a 15 as the last number. Cell B30 has the number 7-15 in it. I need the macro to go to the cell below (B31 and use the number 1 in this example) and then search the following cell range: E1:E12 to find a 1 (cell E1). Once found place the 7-15 and increase the last digit by 1 (so it becomes 7-16) in the adjacent cell to the right (F1)."}, {"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1542215977, "post_id": 53289576, "comment_id": 93491996, "body": "Huge favor, could you amend the original code above. I&#39;ve tried with your changes it says no way."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1542223838, "post_id": 53289576, "comment_id": 93495652, "body": "Don&#39;t think I can because (1) I don&#39;t understand all of your code and (2) if my code above doesn&#39;t work, it stlll won&#39;t work. What does &quot;it says no way&quot; actually mean?"}, {"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1542232511, "post_id": 53289576, "comment_id": 93499401, "body": "I just tried your new code with the change and it doesn&#39;t work. No errors or anything it just doesn&#39;t copy and paste or delete the cells after pasting. It runs with no problems. No debug problems or anything. Not sure why it&#39;s not working."}, {"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1542236173, "post_id": 53289576, "comment_id": 93500728, "body": "Hi, it works with one minor adjustment. the copy and and paste is occurring in the cell range E1:E12 (this is just a reference column, see Excel sample sheet if not clear), I need it in the column to the right of that one F1:F12. Also, it&#39;s not deleted the 3 cells when finished. Thank-you again."}, {"owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "edited": false, "score": 0, "creation_date": 1542379940, "post_id": 53289576, "comment_id": 93559276, "body": "To the moderator: could you close this post. Reason: SJR in his own words &quot;Don&#39;t think I can because I don&#39;t understand all of your code.&quot;"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1542232664, "last_edit_date": 1542232664, "creation_date": 1542143650, "answer_id": 53289576, "question_id": 53287765, "link": "https://stackoverflow.com/questions/53287765/macro-does-not-do-all-the-functions-it-s-suppose-to-do/53289576#53289576", "title": "Macro does not do all the functions it\u2019s suppose to do", "body": "<p>As I said, I can't follow what you're doing, but this will give you \"7-16\" in E1 if B30 contains 7-15 (and similarly for the other cells). I've stripped out most of your code so I don't know if this is a full answer</p>\n\n<pre><code>Sub master2()\n\nDim pair As Range, found As Variant, v As Variant\n\nFor Each pair In Range(\"B30, F30, J30\")\n    If Right(pair, 2) = \"15\" Then\n        v = Split(pair, \"-\")\n        found = Application.Match(pair.Offset(1),Range(\"E1:E12\"), 0)\n        If IsNumeric(found) Then\n            Range(\"F1:F12\").Cells(found).Value = v(0) &amp; \"-\" &amp; v(1) + 1\n        End If\n    End If\nNext pair\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10648013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/508aa80de5cc7b29a9d2bc39c02f0e36?s=128&d=identicon&r=PG&f=1", "display_name": "NANCY SKYES", "link": "https://stackoverflow.com/users/10648013/nancy-skyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586394981, "creation_date": 1542135312, "last_edit_date": 1586394981, "question_id": 53287765, "link": "https://stackoverflow.com/questions/53287765/macro-does-not-do-all-the-functions-it-s-suppose-to-do", "title": "Macro does not do all the functions it\u2019s suppose to do", "body": "<p>Apologies if this is a simple question but I have a macro that divides as it should but it will not copy and paste the contents from one cell to another cell as it\u2019s suppose to do.  See below for examples with expected result.</p>\n\n<pre><code>Sub master2()\n    Application.ScreenUpdating = False\n\n    Dim pair As Variant, accumulator As Variant\n    Dim findFifteen As Double\n    Dim remainder As Long, found As Long\n\n    found = 1\n\n    For Each pair In Range(\"B30, F30, J30\")\n        If Right(pair, 2) = 15 Then\n            If pair.Offset(0, 2) &lt;= 12 Then\n                findFifteen = pair.Offset(0, 2)     / 12\n                remainder = 0\n            Else\n                findFifteen = 1\n                remainder = pair.Offset(0, 2)    Mod 12\n            End If\n\n            For Each accumulator In Range(\"A14,     B14, C14, D14, E14, F14, G14, H14, I14, J14, K14, L14\")\n                If accumulator.Offset(-1, 0) =     Val(Left(pair, InStr(pair, \"-\") - 1)) Then \n                    accumulator.Value =     accumulator.Value + remainder\n                End If\n                accumulator.Value =    accumulator.Value + findFifteen\n            Next accumulator\n\n            Range(\"E\" &amp; found).Value = pair\n            found = found + 1\n        End If\n    Next pair\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Example with expected result.</p>\n\n<p>As per my Excel image, my macro is suppose to find specified cells that contain a 15 as the last number. Cell B30 has the number 7-15 in it. I need the macro to go to the cell below (B31 and use the number 1 in this example) and then search the following cell range: E1:E12 to find a 1 (cell E1). Once found place the 7-15 and increase the last digit by 1 (so it becomes 7-16) in the adjacent cell to the right (F1). Do the same with all cells: B30, F30 and J30 but only if they contain a 15 (1-15 or 7-15 etc.) as the last number.  After this delete all contents in cell B30, C30, D30. There are are two examples in my Excel sheet where the same thing needs to happen.</p>\n\n<p><a href=\"https://i.stack.imgur.com/fG0je.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fG0je.jpg\" alt=\"excel image\"></a></p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 2, "creation_date": 1542135645, "post_id": 53287762, "comment_id": 93457607, "body": "Can you tell us where you get the first error message when you run the code and what is says?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1542138786, "post_id": 53287762, "comment_id": 93459015, "body": "Please describe in the issues in detail. We can&#39;t possibly reproduce your situation and problems based on the minimal information you provide."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542139877, "post_id": 53287762, "comment_id": 93459489, "body": "Unless you&#39;ve added a reference to the Word object library, Excel isn&#39;t going to know what the value of <code>wdFindContinue</code> is.  You&#39;ll need to either add the reference, or define that constant.  And use <code>Option Explicit</code> so you always know about this type of problem."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1542140987, "post_id": 53287762, "comment_id": 93459939, "body": "I think you have your column and row indexes transposed.  It should be N(j,1) and N(j,2)."}, {"owner": {"reputation": 51, "user_id": 10647946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ab2317938eb82f228deb1263ecfd03?s=128&d=identicon&r=PG&f=1", "display_name": "JHEngr", "link": "https://stackoverflow.com/users/10647946/jhengr"}, "edited": false, "score": 0, "creation_date": 1542144740, "post_id": 53287762, "comment_id": 93461355, "body": "Once I included Option Explicit I received an error on  .Wrap=wdFindContinue.  I do not understand how to define this in excel, would you please explain."}, {"owner": {"reputation": 51, "user_id": 10647946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ab2317938eb82f228deb1263ecfd03?s=128&d=identicon&r=PG&f=1", "display_name": "JHEngr", "link": "https://stackoverflow.com/users/10647946/jhengr"}, "edited": false, "score": 0, "creation_date": 1542144826, "post_id": 53287762, "comment_id": 93461400, "body": "Yes N(j,1) and N(j,2) were transposed, thank you but the error for wdFindContinue is still receiving an error.  Compile error:  Variable not defined."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1542150101, "post_id": 53287762, "comment_id": 93463244, "body": "Word.WdFind.WdFindContinue"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1542150655, "post_id": 53287762, "comment_id": 93463392, "body": "Ooops, a slip of the mouse.  Your simplest option is to add the reference to the word object model by using Tools.References and ticking the box against the Microsoft Word XX.X Object library. If you still get errors then you will have to qualify your constants e.g. Word.WdFind.wdFindContinue."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 10647946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ab2317938eb82f228deb1263ecfd03?s=128&d=identicon&r=PG&f=1", "display_name": "JHEngr", "link": "https://stackoverflow.com/users/10647946/jhengr"}, "edited": false, "score": 0, "creation_date": 1542203561, "post_id": 53290190, "comment_id": 93484187, "body": "I made the adjustment and it runs without any errors.  However it does not seem to find and replace any text.  I tried adjusted the code to test it by simply entering in what to find and what to replace it with &quot;Text&quot; and &quot;Changed&quot; and added these words to the word document.  It can&#39;t seem to find them and change them.    I changed .Wrap=1 and .Execute 2"}, {"owner": {"reputation": 51, "user_id": 10647946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ab2317938eb82f228deb1263ecfd03?s=128&d=identicon&r=PG&f=1", "display_name": "JHEngr", "link": "https://stackoverflow.com/users/10647946/jhengr"}, "edited": false, "score": 0, "creation_date": 1542203636, "post_id": 53290190, "comment_id": 93484243, "body": "(comment removed)"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 51, "user_id": 10647946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ab2317938eb82f228deb1263ecfd03?s=128&d=identicon&r=PG&f=1", "display_name": "JHEngr", "link": "https://stackoverflow.com/users/10647946/jhengr"}, "edited": false, "score": 0, "creation_date": 1542230587, "post_id": 53290190, "comment_id": 93498596, "body": "How about posting your modified code so we can see what you&#39;re actually using?"}, {"owner": {"reputation": 51, "user_id": 10647946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ab2317938eb82f228deb1263ecfd03?s=128&d=identicon&r=PG&f=1", "display_name": "JHEngr", "link": "https://stackoverflow.com/users/10647946/jhengr"}, "edited": false, "score": 0, "creation_date": 1542636942, "post_id": 53290190, "comment_id": 93628639, "body": "Updated in the original post."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 51, "user_id": 10647946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ab2317938eb82f228deb1263ecfd03?s=128&d=identicon&r=PG&f=1", "display_name": "JHEngr", "link": "https://stackoverflow.com/users/10647946/jhengr"}, "edited": false, "score": 0, "creation_date": 1542660026, "post_id": 53290190, "comment_id": 93640482, "body": "Since you don&#39;t save the changes before quitting, you&#39;re unlikely to ever see what the find/replace did."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1542146617, "creation_date": 1542146617, "answer_id": 53290190, "question_id": 53287762, "link": "https://stackoverflow.com/questions/53287762/vba-search-replace-text-in-word-document-from-excel/53290190#53290190", "title": "VBA search replace text in word document from excel", "body": "<p>The \"Compile error: Variable not defined\" problem is due to your use of late binding with a named Word constant. Either change</p>\n\n<pre><code>.Wrap = wdFindContinue\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>.Wrap =  1\n</code></pre>\n\n<p>or insert:</p>\n\n<pre><code>Const wdFindContinue as Long = 1\n</code></pre>\n\n<p>at the top of your code.</p>\n\n<p>In any event, as it stands, your existing code won't replace anything. Instead of:</p>\n\n<pre><code>.Execute\n</code></pre>\n\n<p>you need either:</p>\n\n<pre><code>.Execute 2\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>.Execute wdReplaceAll\n</code></pre>\n\n<p>(to replace all instances) or:</p>\n\n<pre><code>.Execute 1\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>.Execute wdReplaceOne\n</code></pre>\n\n<p>(to replace only the first instance)</p>\n\n<p>As with wdFindContinue, you'd need to supplement wdReplaceAll or wdReplaceOne with:</p>\n\n<pre><code>Const wdReplaceAll as Long = 2\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>Const wdReplaceOne as Long = 1\n</code></pre>\n\n<p>as appropriate.</p>\n"}, {"comments": [{"owner": {"reputation": 4630, "user_id": 2994412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gnXJp.jpg?s=128&g=1", "display_name": "Horaciux", "link": "https://stackoverflow.com/users/2994412/horaciux"}, "edited": false, "score": 1, "creation_date": 1569502744, "post_id": 53483499, "comment_id": 102623686, "body": "this saved me, thanks! I couldn&#39;t find why isn&#39;t replacing anything. Adding the reference worked just as expected at first place."}], "tags": [], "owner": {"reputation": 51, "user_id": 10647946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ab2317938eb82f228deb1263ecfd03?s=128&d=identicon&r=PG&f=1", "display_name": "JHEngr", "link": "https://stackoverflow.com/users/10647946/jhengr"}, "is_accepted": false, "score": 3, "last_activity_date": 1543243326, "creation_date": 1543243326, "answer_id": 53483499, "question_id": 53287762, "link": "https://stackoverflow.com/questions/53287762/vba-search-replace-text-in-word-document-from-excel/53483499#53483499", "title": "VBA search replace text in word document from excel", "body": "<p>I was able to get the code to function.  The code searches a specified Microsoft Word Document from Excel using a list of find replace strings from the excel sheet (B4:B5004 (find), C4:C5005 (replace)) stored in an array in the code. </p>\n\n<p>To get the code to function I had to include the Microsoft Word 16 Object Library.</p>\n\n<p>From the excel VBA editor window. \nTools > References  then ensure Microsoft Word 16.0 Object Library is checked.</p>\n\n<pre><code>Option Explicit\n\nSub SearchReplace()\n\n   Dim WordApp As Object, WordDoc As Object, N As Variant, i As Integer, j As Integer\n   i = Range(\"C2\").Value  'pulls length of list from an excel function located in cell C2 =COUNTIF(B4:B5005,\"*\")\n   N = Range(\"B4:C\" &amp; CStr(i + 3)).Value\n   Set WordApp = CreateObject(Class:=\"Word.Application\")\n   Set WordDoc = WordApp.Documents.Open(\"C:\\WordTest.docm\")    \n   WordDoc.Visible = True\n   For j = 1 To i\n        With WordApp\n           With WordDoc.Content.Find\n                .Text = N(j, 1)\n                .Replacement.Text = N(j, 2)\n                .Wrap = wdFindContinue\n                .MatchWholeWord = True\n                .Execute Replace:=wdReplaceAll\n          End With\n        End With\n    Next j\n    WordApp.ActiveDocument.Save\n    WordApp.ActiveDocument.Close\n    WordApp.Quit\n\n    Set WordApp = Nothing\n    Set WordDoc = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10647946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ab2317938eb82f228deb1263ecfd03?s=128&d=identicon&r=PG&f=1", "display_name": "JHEngr", "link": "https://stackoverflow.com/users/10647946/jhengr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6448, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1543243326, "creation_date": 1542135292, "last_edit_date": 1542246354, "question_id": 53287762, "link": "https://stackoverflow.com/questions/53287762/vba-search-replace-text-in-word-document-from-excel", "title": "VBA search replace text in word document from excel", "body": "<p>I am trying to make an excel document that I can paste a list of words to search and replace into.  I want to use the excel document to search and replace these words in a word document.</p>\n\n<p>I am having issues getting the code to function.</p>\n\n<pre><code>Sub SearchReplace()\n\nDim WordDoc As Object, N As Variant, i As Integer, j As Integer\ni = Range(\"C2\").Value  'pulls length of list from an excel function located in cell C2\nN = Range(\"B4:C\" &amp; CStr(i + 3)).Value\nSet WordDoc = CreateObject(Class:=\"Word.Application\")\n    WordDoc.Visible = True\nWordDoc.Documents.Open Filename:=\"C:\\WordTest.docm\"\nWordDoc.Activate\nWith WordDoc.ActiveDocument\n    For j = 1 To i\n    With .Range\n        With .Find\n            .ClearFormatting\n            .Replacement.ClearFormatting\n            .MatchWildcards = False\n            .Wrap = wdFindContinue\n            .Text = N(1, j)\n            .Replacement.Text = N(2, j)\n            .Execute\n         End With\n    End With\n    Next j\nEnd With\nWordDoc.Quit\nSet WordDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p>I corrected the code based on the recommendations, and I no longer get any errors.  However the code does not appear to find and replace anything in the specified word document.  I tried to simplify the code to check the find &amp; replace portion by typing in a specific word \"text\" and a specific word \"replace\" to find and replace in a word document, which contains the word \"text\".  This still result in no change. I removed the line that closed the document in case the issue was the document was not being saved after being updated, but that also was not successful, so I added WordDoc.Quit back into the code. </p>\n\n<pre><code>Sub SearchReplace()\n\nDim WordDoc As Object, N As Variant, i As Integer, j As Integer\n\ni = Range(\"C2\").Value  'pulls length of list from an excel function \nlocated in cell C2\nN = Range(\"B4:C\" &amp; CStr(i + 3)).Value\nSet WordDoc = CreateObject(Class:=\"Word.Application\")\nWordDoc.Visible = True\nWordDoc.Documents.Open Filename:=\"C:\\WordTest.docm\"\nWordDoc.Documents(\"WordTest.docm\").Activate\nWith WordDoc.ActiveDocument\nFor j = 1 To i\nWith .Range\n    With .Find\n        .ClearFormatting\n        .Replacement.ClearFormatting\n        .MatchWildcards = False\n        .Wrap = 1\n        .Text = \"text\" 'N(j, 1)\n        .Replacement.Text = \"replace\" 'N(j, 2)\n        .Execute 2\n     End With\nEnd With\nNext j\nEnd With\nWordDoc.Quit\nSet WordDoc = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "selenium", "innertext"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10647861, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Marcus Arnhold", "link": "https://stackoverflow.com/users/10647861/marcus-arnhold"}, "edited": false, "score": 0, "creation_date": 1542136110, "post_id": 53287832, "comment_id": 93457842, "body": "Well, that did it. The second one worked just fine, and the first returned nothing every time. Thanks a lot."}, {"owner": {"reputation": 61, "user_id": 12450313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W7FGE.png?s=128&g=1", "display_name": "TCritical", "link": "https://stackoverflow.com/users/12450313/tcritical"}, "edited": false, "score": 1, "creation_date": 1597410579, "post_id": 53287832, "comment_id": 112131199, "body": "Thank you Navarasu for your valuable answer, literally i gone mad on searching to get href values to excel, but the second code which you have mention &quot;label.Attribute(&quot;innerHTML&quot;) helped me a lot. Thank you. Also, thank you Marcus Arnhold for the Question."}], "tags": [], "owner": {"reputation": 5091, "user_id": 10474999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9379ef6b63d5d67645354b797d3caa82?s=128&d=identicon&r=PG&f=1", "display_name": "Navarasu", "link": "https://stackoverflow.com/users/10474999/navarasu"}, "is_accepted": true, "score": 2, "last_activity_date": 1542135610, "creation_date": 1542135610, "answer_id": 53287832, "question_id": 53287630, "link": "https://stackoverflow.com/questions/53287630/vba-automation-cant-get-innertext-innerhtml-value/53287832#53287832", "title": "VBA automation can&#39;t get innerText (innerHTML, value)", "body": "<p>To get InnerText of the element, You need to call Text method</p>\n\n<pre><code>Set label = .FindElementsByClass(\"ng-binding\")(91)\n\nname = label.Text\n</code></pre>\n\n<p>To get inner Html,</p>\n\n<pre><code>name = label.Attribute(\"innerHTML\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10647861, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Marcus Arnhold", "link": "https://stackoverflow.com/users/10647861/marcus-arnhold"}, "edited": false, "score": 0, "creation_date": 1542203115, "post_id": 53287929, "comment_id": 93483880, "body": "I might try that as well. This .document thing that keep returning error for me. And almost every help i find goes with driver.document.Somethingsomething."}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": false, "score": 0, "last_activity_date": 1542136080, "creation_date": 1542136080, "answer_id": 53287929, "question_id": 53287630, "link": "https://stackoverflow.com/questions/53287630/vba-automation-cant-get-innertext-innerhtml-value/53287929#53287929", "title": "VBA automation can&#39;t get innerText (innerHTML, value)", "body": "<p>Sometimes I have found that I have to execute javascript to get what I'm after. You can try</p>\n\n<pre><code>name=driver.ExecuteScript(\"document.getElementsByClassName('ng-binding')[91].innerText;\")\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10647861, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Marcus Arnhold", "link": "https://stackoverflow.com/users/10647861/marcus-arnhold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1797, "favorite_count": 0, "accepted_answer_id": 53287832, "answer_count": 2, "score": 2, "last_activity_date": 1542136080, "creation_date": 1542134755, "question_id": 53287630, "link": "https://stackoverflow.com/questions/53287630/vba-automation-cant-get-innertext-innerhtml-value", "title": "VBA automation can&#39;t get innerText (innerHTML, value)", "body": "<p>So, i've gotten innertext many times. This time, it's simply not working. Tried many alternatives.</p>\n\n<p>First of All\nI'm using Selenium on VBA to use chromedriver.\nThe source website is \"[<a href=\"http://www.fazenda.df.gov.br/area.cfm?id_area=1536]\" rel=\"nofollow noreferrer\">http://www.fazenda.df.gov.br/area.cfm?id_area=1536]</a>\" This website operates on a Iframe. After half an hour trying to get the inner text from it, i figured that the link in its code works just as fine: \"[<a href=\"http://publica.agnet.fazenda.df.gov.br/FichaImovel/#/FichaCadastral]\" rel=\"nofollow noreferrer\">http://publica.agnet.fazenda.df.gov.br/FichaImovel/#/FichaCadastral]</a>\". This last one seems to operate on someting call \"Angular\".</p>\n\n<p>The menu with the innertext i required is a dropdown one. As a dummy value, you can use 50868748. The dropdown text that it generates is composed by 15 lines and one table. The info that i need is on the 15th line, \"Nome do Respons\u00e1vel\", or in the column 2 line 2 on the table.</p>\n\n<p>I managed to place the code and generate the dropdown list, but i can't manage to get the inner text.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim iptu As String\n</code></pre>\n\n<p><code>Dim driver As New ChromeDriver</code></p>\n\n<pre><code>With driver\n\n\n.Start \niptu = 50868748 'dummy\n.Get \"http://publica.agnet.fazenda.df.gov.br/FichaImovel/#/FichaCadastral\"\n\n.FindElementById(\"inscricaoImovel\").Clear\n.FindElementById(\"inscricaoImovel\").SendKeys iptu\n.FindElementsById(\"btnCadastro\")(2).Click\n\n.Wait (300)\n</code></pre>\n\n<p>'until here, everything works fine</p>\n\n<pre><code>Dim label As Object\nDim name As String\n\n\nSet label = .FindElementsByClass(\"ng-binding\")(91)\n'as you can see, i end up using this class(91) to get the value on the table, but i can get from the 15th line too\n\n\nname = label.getAttribute(\"innerText\") 'Error is here\n</code></pre>\n\n<p>'i've tried .innerText, .innerHTML and others. The error is always \"object does not accept property or method\" Error 438.   </p>\n\n<pre><code>end with\n</code></pre>\n\n<p>The chrome driver is up to date. Also, the page source does not cointain the info i need.</p>\n\n<p>Anyone can help me out?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1542135325, "post_id": 53287618, "comment_id": 93457470, "body": "If this code works and you are just looking to improve it, it may be a better candidate for <a href=\"https://codereview.stackexchange.com/\">Code Review</a> That said you can repeat <code>Range(&quot;Z1:Z70&quot;).Replace(&quot;First search item&quot;,&quot;&quot;)</code> 7 times. With only 70 cells, replace should work fast enough"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1542135786, "post_id": 53287618, "comment_id": 93457670, "body": "1. loop backwards through the range.  2.  After finding a positive match exit the inner loop. 3.  Use <code>Range(&quot;Z&quot; &amp; i).Value</code> and get rid of all the <code>.Select</code> and <code>ActiveCell</code> lines."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1542136060, "post_id": 53287618, "comment_id": 93457814, "body": "If you want it really fast use variant arrays and stop looping the range itself."}, {"owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "edited": false, "score": 0, "creation_date": 1542388047, "post_id": 53287618, "comment_id": 93563715, "body": "I decided to go with the Autofilter method, much faster."}], "owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586395016, "creation_date": 1542134675, "last_edit_date": 1586395016, "question_id": 53287618, "link": "https://stackoverflow.com/questions/53287618/delete-cell-in-column-if-value-matches-value-in-array", "title": "Delete cell in column if value matches value in array", "body": "<p>I am trying to have VBA delete cells in column Z.  I found a code snippet that I have been playing with (below), however, it is very slow.  There must be a quicker way to perform this task.  I know using <code>.Select</code> slows this down, but for now, it works.  Any speed enhancement ideas will be much appreciated.  Also, adding a dynamic row count to set the range would be great, too. </p>\n\n<pre><code>Sub DeleteValues()          'This works but is really slow\nDim x As Integer\nDim i As Integer\nDim Arr(1 To 7) As String\n\nArr(1) = \"First search item\"\nArr(2) = \"Second search item\"\nArr(3) = \"Third search item\"\nArr(4) = \"Fourth search item\"\nArr(5) = \"Fifth search item\"\nArr(6) = \"Sixth search item\"\nArr(7) = \"Seventh search item\"\n\nRange(\"Z1\").Select\n\n    With Application\n            .Calculation = xlCalculationManual\n            .ScreenUpdating = False\n\nFor x = 1 To 70          'for 70 rows\n    For i = 1 To 7       'number of items in the Array\n        If ActiveCell.Value = Arr(i) Then\n            ActiveCell.Delete\n        End If\n    Next i\n    ActiveCell.Offset(1, 0).Select\nNext x\n\n            .Calculation = xlCalculationAutomatic\n            .ScreenUpdating = True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1542139045, "post_id": 53287567, "comment_id": 93459122, "body": "You &quot;Dim&quot; a variable, including <code>ws</code>,  but you don&#39;t  it - why not? Nor do you specify where <code>Cells(...</code> is lcoated (on which worksheet). Start by specifying in which worksheet <code>Cells</code> are located."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542140036, "post_id": 53287567, "comment_id": 93459566, "body": "<code>ThisWorkbook.Sheet2.Activate</code>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1542149676, "creation_date": 1542149676, "answer_id": 53290735, "question_id": 53287567, "link": "https://stackoverflow.com/questions/53287567/why-does-my-userform-data-enter-in-to-a-new-file-i-e-i-open-filename-and-data/53290735#53290735", "title": "Why does my UserForm Data enter in to a new file? (i.e I open Filename, and data is compiled in Filename1)", "body": "<p>Something like this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim rw As Range \n\n    Set rw = Sheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1,0).EntireRow\n\n    With rw\n        .Cells(1).Value = Me.TextBox1.Value\n        .Cells(2).Value = Me.TextBox2.Value\n        .Cells(3).Value = Me.TextBox3.Value\n        .Cells(4).Value = Me.TextBox4.Value\n        .Cells(5).Value = Me.TextBox5.Value\n        .Cells(6).Value = Me.TextBox6.Value\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10647964, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156854318042238/picture?type=large", "display_name": "Hannah Forsythe", "link": "https://stackoverflow.com/users/10647964/hannah-forsythe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1542149676, "creation_date": 1542134494, "last_edit_date": 1542138480, "question_id": 53287567, "link": "https://stackoverflow.com/questions/53287567/why-does-my-userform-data-enter-in-to-a-new-file-i-e-i-open-filename-and-data", "title": "Why does my UserForm Data enter in to a new file? (i.e I open Filename, and data is compiled in Filename1)", "body": "<p>I'm trying to keep all data within the same file, as it's on a shared network at work. For some reason once data is entered through the UserForm and is compiled in the worksheet, it doesn't all compile in to my original worksheet, but in to a new one that is in .xlsx</p>\n\n<p>Is there somewhere I can add in that it remain in the same file?</p>\n\n<p>The code I have connected to the command button is as follows:</p>\n\n<pre><code>    Private Sub CommandButton1_Click()\nDim rw As Integer\nDim ws As Worksheet\nDim emptyRow As Long\n\n'Make Sheet2 active\nSheet2.Activate\n\n'Determine emptyRow\nemptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\n'Transfer information\nCells(emptyRow, 1).Value = Me.TextBox1.Value\nCells(emptyRow, 2).Value = Me.TextBox2.Value\nCells(emptyRow, 3).Value = Me.TextBox3.Value\nCells(emptyRow, 4).Value = Me.TextBox4.Value\nCells(emptyRow, 5).Value = Me.TextBox5.Value\nCells(emptyRow, 6).Value = Me.TextBox6.Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "vba7"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1542133854, "post_id": 53287374, "comment_id": 93456778, "body": "change <code>Dim strDate As Variant</code> to <code>Public strDate as Variant</code> That will make it global and stick after the routine executes."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1542134571, "post_id": 53287374, "comment_id": 93457129, "body": "I remember Mathieu Guindon had a really good answer a month or two ago about scope which would be worth posting here. looking for it..."}, {"owner": {"reputation": 1, "user_id": 10331156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FncbEq-7O64/AAAAAAAAAAI/AAAAAAAAADw/fY8cX7FF0oo/photo.jpg?sz=128", "display_name": "BBA Hunter", "link": "https://stackoverflow.com/users/10331156/bba-hunter"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1542134596, "post_id": 53287374, "comment_id": 93457143, "body": "@Scott Holtzman : Nope, already tried that. I tried using global, public, and anything else I could try.   I wonder is the issue is 64bit vba? It&#39;s the whole reason I am rewriting the spreadsheet, doesn&#39;t work correctly in 64 bit office."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1542134939, "post_id": 53287374, "comment_id": 93457294, "body": "Usually class-level variables only lose their values when you surprise Excel more than you should (<a href=\"https://stackoverflow.com/q/6089178/11683\">a nasty example</a>). Can you reproduce the problem in a blank file?"}, {"owner": {"reputation": 1, "user_id": 10331156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FncbEq-7O64/AAAAAAAAAAI/AAAAAAAAADw/fY8cX7FF0oo/photo.jpg?sz=128", "display_name": "BBA Hunter", "link": "https://stackoverflow.com/users/10331156/bba-hunter"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1542135349, "post_id": 53287374, "comment_id": 93457477, "body": "@GSerg : Yes, if you have excel 64 bit, add a button, copy the code above into it and watch the strDate variable.  Use Public, Dim, Etc...for declaring the variable, doesn&#39;t matter. Assign it to &quot;This.Workbook&quot; or to a new module, doesn&#39;t matter. As soon as you F8 through the steps, the variable resets at the &#39;End Sub&#39;"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1542135412, "post_id": 53287374, "comment_id": 93457506, "body": "Hmm it doesn&#39;t apply as well as I remembered, but it might help? <a href=\"https://stackoverflow.com/questions/51898947/create-and-assign-variables-on-workbook-open-pass-it-to-worksheet-change/51899356#51899356\" title=\"create and assign variables on workbook open pass it to worksheet change\">stackoverflow.com/questions/51898947/&hellip;</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1542135742, "post_id": 53287374, "comment_id": 93457655, "body": "It&#39;s tricky because according to <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/declaring-variables\" rel=\"nofollow noreferrer\">declaring variables in VBA7</a> it should work the same."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542135877, "post_id": 53287374, "comment_id": 93457710, "body": "<i>Is this</i> in a class module (Worksheet or Workbook)?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1542135881, "post_id": 53287374, "comment_id": 93457711, "body": "@BBAHunter It goes to &quot;Out of context&quot; in the Watch window, but it actually retains its value - it&#39;s just that the Watch window cannot show it anymore because the sub has ended. If you <code>? strDate</code> from the Immediate window, it&#39;s still there."}, {"owner": {"reputation": 1, "user_id": 10331156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FncbEq-7O64/AAAAAAAAAAI/AAAAAAAAADw/fY8cX7FF0oo/photo.jpg?sz=128", "display_name": "BBA Hunter", "link": "https://stackoverflow.com/users/10331156/bba-hunter"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1542136201, "post_id": 53287374, "comment_id": 93457885, "body": "@GSerg : If I understand you correctly, the variable is retaining it&#39;s value but in a different sub, the watch window won&#39;t show it.   If that is the case, is there a particular method to call the value into a different sub?   Thanks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542139120, "post_id": 53287374, "comment_id": 93459160, "body": "A <code>Dim</code> statement <i>can&#39;t</i> possibly declare anything <i>global</i>, by definition. Also whether a public field is a global variable or a public instance field (i.e. instance state) depends on the type of module it&#39;s declared in: please <a href=\"https://stackoverflow.com/posts/53287374/edit\">edit</a> your post with your answer to @Comintern&#39;s question - is that code written in a <i>standard module</i> (.bas) or not?"}, {"owner": {"reputation": 1, "user_id": 10331156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FncbEq-7O64/AAAAAAAAAAI/AAAAAAAAADw/fY8cX7FF0oo/photo.jpg?sz=128", "display_name": "BBA Hunter", "link": "https://stackoverflow.com/users/10331156/bba-hunter"}, "edited": false, "score": 0, "creation_date": 1542140496, "post_id": 53287374, "comment_id": 93459731, "body": "@ Mathieu Guindon : Edited to show I did in fact try &quot;Public&quot; instead of &quot;Dim&quot;. The code is stored in the workbook itself.   At this point I am thinking I need to figure out how to call the global sub&#39;s variable data in each other sub I need to use the data in.  If this is the case, I will know how to be more helpful to anyone else that may have the same questions."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1542141791, "post_id": 53287374, "comment_id": 93460201, "body": "@BBAHunter The variable&#39;s value is available for all subs. You just can&#39;t see that in the Watch window because there is no code currently executing, and the Watch window displays &quot;&lt;Out of context&gt;&quot; in that case. The variable is fine, you don&#39;t need to do anything."}], "owner": {"reputation": 1, "user_id": 10331156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FncbEq-7O64/AAAAAAAAAAI/AAAAAAAAADw/fY8cX7FF0oo/photo.jpg?sz=128", "display_name": "BBA Hunter", "link": "https://stackoverflow.com/users/10331156/bba-hunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1586395052, "creation_date": 1542133719, "last_edit_date": 1586395052, "question_id": 53287374, "link": "https://stackoverflow.com/questions/53287374/excel-2016-64bit-vba-why-does-my-global-variable-reset-at-end-of-sub", "title": "Excel 2016 64bit VBA: Why does my global variable reset at end of sub?", "body": "<p>I need to store a date as a global variable. I thought I was doing this but the watch shows it resetting after the sub ends. I've looked at countless global variable articles and responses to questions, nothing seemed to work.</p>\n\n<p>So, just how do I stop this from happening in my VBA code as I need to call the variable in later subs?  </p>\n\n<pre><code>Option Explicit\n\nPublic strDate As Variant\n\nSub SelectDate()\n    strDate = InputBox(\"Select Report Date (mm/dd/yy)\", \"Report Date\", Format(Now() - 1, \"mm/dd/yy\"))\n\n    If IsDate(strDate) Then\n        strDate = Format(CDate(strDate), \"mm/dd/yy\")\n    Else\n        MsgBox \"Valid Date Format Required\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2016"], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1542170069, "creation_date": 1542170069, "answer_id": 53293247, "question_id": 53287286, "link": "https://stackoverflow.com/questions/53287286/vba-search-and-select-last-found-string-in-a-column-containing-duplicate-entrie/53293247#53293247", "title": "VBA: Search and select last found string in a column containing duplicate entries", "body": "<pre><code>Sub FindAndSelectAll()\n    Dim str As String, cll As Range, c As Range\n    Dim rSearch As Range\n\n    Set rSearch = Range(\"A1\").CurrentRegion\n\n    With rSearch\n        For Each cll In rSearch\n            Set c = .Find(cll.Value2, _\n                        LookIn:=xlValues, _\n                        searchdirection:=xlPrevious)\n\n            If Not c Is Nothing And cll.Row &lt; c.Row Then\n                Range(c.Address).Interior.Color = 65535\n            End If\n\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TPBfE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TPBfE.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 355, "user_id": 7723726, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c7bfb192a59608c9847b55053a6d6e66?s=128&d=identicon&r=PG&f=1", "display_name": "ElectroMotiveHorse", "link": "https://stackoverflow.com/users/7723726/electromotivehorse"}, "is_accepted": true, "score": 0, "last_activity_date": 1542429651, "creation_date": 1542429651, "answer_id": 53348277, "question_id": 53287286, "link": "https://stackoverflow.com/questions/53287286/vba-search-and-select-last-found-string-in-a-column-containing-duplicate-entrie/53348277#53348277", "title": "VBA: Search and select last found string in a column containing duplicate entries", "body": "<p>I found the answer I was looking for. By setting the SearchDirection property to xlPrevious, it will find the last value in the range. Then the cell can be focused on by using the .Select method. However, if the value that is being searched is a substring of other values within the column, it may select the wrong cell. This is solved by using a while loop that checks the value of the cell it finds, and keeps searching the previous value if it is not the string we are looking for. </p>\n\n<pre><code>Sub FindLast()\nDim fc As Range\nDim my_var As String\nDim cell_check As Variant\nmy_var = \"String 1\"\n\nSet fc = Worksheets(\"Sheet1\").Columns(\"A\").Find(what:=my_var, _\n            SearchDirection:=xlPrevious)\nfc.Select\ncell_check = ActiveCell.Value\n\nWhile cell_check &lt;&gt; my_var\n    Set fc = Worksheets(\"Sheet1\").Columns(\"A\").FindPrevious(after:=fc)\n    fc.Select\n    cell_check = ActiveCell.Value\nWend\n\nEnd Sub\n</code></pre>\n\n<p>I found the solution by reading the documentation on Microsofts website.\n<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.findprevious\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.findprevious</a></p>\n"}], "owner": {"reputation": 355, "user_id": 7723726, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c7bfb192a59608c9847b55053a6d6e66?s=128&d=identicon&r=PG&f=1", "display_name": "ElectroMotiveHorse", "link": "https://stackoverflow.com/users/7723726/electromotivehorse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 53348277, "answer_count": 2, "score": 0, "last_activity_date": 1586395088, "creation_date": 1542133294, "last_edit_date": 1586395088, "question_id": 53287286, "link": "https://stackoverflow.com/questions/53287286/vba-search-and-select-last-found-string-in-a-column-containing-duplicate-entrie", "title": "VBA: Search and select last found string in a column containing duplicate entries", "body": "<p>I am trying to search a column that has duplicate entries of information. I want to select the last found occurence of the string in the column. How can I do this?</p>\n\n<p>If possible, please show me how this can be done with the Selection.Find method.</p>\n\n<pre><code>Columns(\"A:A\").Select\n\nSelection.Find(What:=\"foobar\", After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Activate\n</code></pre>\n"}, {"tags": ["excel", "vba", "search"], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "edited": false, "score": 0, "creation_date": 1542135390, "post_id": 53287397, "comment_id": 93457494, "body": "That makes a lot of sense, thanks. I thought the LIKE operator logic is to check if they are similar, not a contains b. Love this community, been learning a lot. I&#39;ve added an OR statement that just switches the two terms, and it looks like it&#39;s working."}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 1, "last_activity_date": 1542133816, "creation_date": 1542133816, "answer_id": 53287397, "question_id": 53287051, "link": "https://stackoverflow.com/questions/53287051/excel-vba-like-statement-with-singular-plural-words/53287397#53287397", "title": "Excel VBA Like statement with singular/plural words", "body": "<p>In your example code, the 'keyword' needs to be singular and then it will match both singular and plural (as you have seen).  Also, you don't need wildcards on the 'search' term.</p>\n\n<pre><code>\"TEMPLATE\" Like \"*\" &amp; \"TEMPLATE\" &amp; \"*\"   'returns True\n\"TEMPLATES\" Like \"*\" &amp; \"TEMPLATE\" &amp; \"*\"  'returns True\n</code></pre>\n\n<p>Think of it this way.  In both the above cases, we are in essence saying \"does the first term CONTAIN the second term.</p>\n"}], "owner": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 53287397, "answer_count": 1, "score": 0, "last_activity_date": 1542140173, "creation_date": 1542132378, "last_edit_date": 1542140173, "question_id": 53287051, "link": "https://stackoverflow.com/questions/53287051/excel-vba-like-statement-with-singular-plural-words", "title": "Excel VBA Like statement with singular/plural words", "body": "<p>I'm trying to make a Document Search Engine that uses keywords and the document name when searching for a file.. in an excel spreadsheet. </p>\n\n<p>It works by breaking down the search term and the name of the file via spaces, as well as the keywords via commas. \nThen it matches each search term for every keyword, and adds a counter for each match. More keyword matches = higher counter, then I sort the table via this counter, so I could get the best-matching result at the top.</p>\n\n<p>The search functionality is already working fine, however when it comes to singular and plural terms, it's not finding it.</p>\n\n<p>Let's say that the keyword for doc1 is <strong>Templates</strong>. When searching for the word <em><strong>Template</strong></em> in the search field, it fails to match. I'm using a LIKE statement, and I tried adding a wildcard at the front and the end, but it still does not work.</p>\n\n<p>Strangely enough, the opposite works. If I search for a plural term, and the keyword is singular, it gets a match. I have no idea why, it just works which is a good thing.</p>\n\n<pre><code>Sub Searchresult()\nDim x As Long, y As Long, count As Long\nDim search() As String, keyword() As String, names() As String\nDim result As String\nDim tbl As ListObject, sortcol As Range, lrow As Long\n\n    With Worksheets(\"Sheet3\") 'Prep for placing results in table.\n        Set tbl = .ListObjects(\"tblSearch\")\n        Set sortcol = .Range(\"tblSearch[sort]\")\n        tbl.DataBodyRange.ClearContents\n    End With\n\n    With Worksheets(\"Sheet2\")\n        search = Split(.Range(\"F1\").Value, \" \") 'split search terms via spaces\n        For x = 2 To 1000 Step 1\n            count = 0\n            lrow = Worksheets(\"Sheet3\").Cells(Rows.count, 1).End(xlUp).Row + 1\n            keyword() = Split(.Range(\"d\" &amp; x), \",\") ' split keywords via comma\n            names() = Split(Replace(Replace(Replace(Replace(.Range(\"c\" &amp; x), \"-\", \"\"), \"(\", \"\"), \")\", \"\"), \"'\", \"\"), \" \") 'splits names via spaces, deleting any unwanted characters\n\n                For i = LBound(keyword) To UBound(keyword)\n                     For j = LBound(search) To UBound(search)\n\n                        If \"*\" &amp; UCase(search(j)) &amp; \"*\" Like \"*\" &amp; UCase(keyword(i)) &amp; \"*\" Then 'compare search term and keyword\n                            Worksheets(\"Sheet3\").Range(\"A\" &amp; lrow, \"B\" &amp; lrow).Value = .Range(\"A\" &amp; x, \"B\" &amp; x).Value\n                            count = count + 1\n                            Worksheets(\"Sheet3\").Range(\"C\" &amp; lrow).Value = count\n                        End If\n\n                    Next\n                Next\n\n                For k = LBound(names) To UBound(names)\n                    For l = LBound(search) To UBound(search)\n                        If \"*\" &amp; UCase(search(l)) &amp; \"*\" Like \"*\" &amp; UCase(names(k)) &amp; \"*\" And Len(names(k)) &gt; 2 Then 'compare search term and document name\n                            Worksheets(\"Sheet3\").Range(\"A\" &amp; lrow, \"B\" &amp; lrow).Value = .Range(\"A\" &amp; x, \"B\" &amp; x).Value\n                            count = count + 1\n                            Worksheets(\"Sheet3\").Range(\"C\" &amp; lrow).Value = count\n                        End If\n                    Next\n                Next\n        Next\n\n\n    End With\n\n    With tbl.Sort 'sort everything based on count to get best result\n        .SortFields.Clear\n        .SortFields.Add Key:=sortcol, SortOn:=xlSortOnValues, Order:=xlDescending\n        .Header = xlYes\n        .Apply\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<p>How do I make sure that the LIKE statement can match both singular/plural terms of a word? It doesn't have to be too complex that it can find words that change when it's singular/plural (Ex:\"copy/copies\"), however having it match something that just adds an 's' would do.</p>\n\n<p>EDIT: Thanks to Brian's explanation, the code is fixed by adding an OR statement that flips the Like statement so that it compares the terms again. It's now able to match even though it's singular/plural.</p>\n\n<pre><code> If UCase(search(j)) Like \"*\" &amp; UCase(keyword(i)) &amp; \"*\" Or UCase(keyword(i)) Like UCase(search(j)) &amp; \"*\" Then 'compare search term and keyword\n\n If (UCase(search(l)) &amp; \"*\" Like UCase(names(k)) &amp; \"*\" Or UCase(names(k)) Like UCase(search(l)) &amp; \"*\") And Len(names(k)) &gt; 2 Then  \n</code></pre>\n"}, {"tags": ["excel", "vba", "search"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1542131849, "post_id": 53286864, "comment_id": 93455864, "body": "Can you please <a href=\"https://stackoverflow.com/posts/53286864/edit\">edit your question</a> adding what code you have so far and how it fails to accomplish your desired goal?"}, {"owner": {"reputation": 1, "user_id": 10647740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bd1a4cc9f1536cf565d0dfba3d2e16?s=128&d=identicon&r=PG&f=1", "display_name": "Breaker1crazy", "link": "https://stackoverflow.com/users/10647740/breaker1crazy"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1542134743, "post_id": 53286864, "comment_id": 93457207, "body": "Added the code, sorry about that."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10647740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bd1a4cc9f1536cf565d0dfba3d2e16?s=128&d=identicon&r=PG&f=1", "display_name": "Breaker1crazy", "link": "https://stackoverflow.com/users/10647740/breaker1crazy"}, "edited": false, "score": 0, "creation_date": 1542293803, "post_id": 53291861, "comment_id": 93524458, "body": "I changed the range and the strings that the code is looking for but it can&#39;t find them despite them being in the column. From searching on here it looks like cell format can cause this problem but I can&#39;t find how to change it.  Do you have any suggestions?"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "reply_to_user": {"reputation": 1, "user_id": 10647740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bd1a4cc9f1536cf565d0dfba3d2e16?s=128&d=identicon&r=PG&f=1", "display_name": "Breaker1crazy", "link": "https://stackoverflow.com/users/10647740/breaker1crazy"}, "edited": false, "score": 0, "creation_date": 1542312262, "post_id": 53291861, "comment_id": 93534630, "body": "Try now, you have to make sure you correctly define both strings and the column containing them.  Cheers,"}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1542312226, "last_edit_date": 1542312226, "creation_date": 1542158618, "answer_id": 53291861, "question_id": 53286864, "link": "https://stackoverflow.com/questions/53286864/search-excel-file-for-2-strings-copy-and-paste-to-new-sheet/53291861#53291861", "title": "Search Excel file for 2 strings, copy, and paste to new sheet", "body": "<p>You can use the code below as a template for your macro, some ranges might need to be adjusted to suit your needs.</p>\n\n<pre><code>Sub test()\n\n    Dim iRowStart As Integer, iRowEnd As Integer, iCol As Integer\n\n    iCol = 7\n\n    iRowEnd = FindString(\"To\", iCol)\n    iRowStart = FindString(\"From\", iCol)\n\n\n    ActiveSheet.Range(Cells(iRowStart, iCol), Cells(iRowEnd, iCol)).Copy Destination:=Sheet2.Range(\"A2\")\n    ActiveSheet.Cells(iRowStart, 1).Select\n\nEnd Sub\n\n\nFunction FindString(str As String, iCol As Integer) As Integer\n    Dim c As Range\n    Dim rSearch As Range\n\n    Set rSearch = ActiveSheet.Columns(iCol)\n\n    With rSearch\n        Set c = .Find(str, LookIn:=xlValues)\n        If Not c Is Nothing Then\n            FindString = c.Row\n        End If\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10647740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bd1a4cc9f1536cf565d0dfba3d2e16?s=128&d=identicon&r=PG&f=1", "display_name": "Breaker1crazy", "link": "https://stackoverflow.com/users/10647740/breaker1crazy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1542312226, "creation_date": 1542131546, "last_edit_date": 1542136059, "question_id": 53286864, "link": "https://stackoverflow.com/questions/53286864/search-excel-file-for-2-strings-copy-and-paste-to-new-sheet", "title": "Search Excel file for 2 strings, copy, and paste to new sheet", "body": "<p>I'm new to VBA and trying to write a code where it searches an Excel sheet for a string. When it finds it (start position), searches for another string and finds it (end position) copy all the rows in-between those two and copy them to a new sheet.</p>\n\n<p>Each row being copied has 3 columns as well that need to be copy/pasted with it.</p>\n\n<p>I've tried modifying some codes on here and some from YouTube but haven't had any luck. This is the code I have so far. Thanks for any help you can offer</p>\n\n<pre><code>Employee = Sheet1.Cells(5, 1)\nTTI = Sheet1.Cells(3, 1)\nDim rng As Range\nDim Employee As String\nDim rownumber As Long\n\nSet rng = Sheet1.Columns(\"A:A\").Find(What:=Employee, _\n    LookIn:=x1Formulas, LookAt:=x1Whole, SearchOrder:=x1byRows, _\n    SearchDirection:=x1Next, MatchCase:=False, SearchFormat:=False)\n    rownumber = rng.Row\n    rng = Sheet1.Columns(\"rownumber,A:A\").Find(What:=TTI, _\n    LookIn:=x1Formulas, LookAt:=x1Whole, SearchOrder:=x1byRows, _\n    SearchDirection:=x1Next, MatchCase:=False, SearchFormat:=False)\n    rownumber2 = rng.Row\n\nSheet2.Cells(2, 1).String = Sheet.Cells(\"rownumber, 1:rownumber2, 1\").String\n</code></pre>\n\n<p>When I try to run the code all I get is a runtime error</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 10453206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f93f9907fa853336e3b5872dd578eb41?s=128&d=identicon&r=PG&f=1", "display_name": "JRob23123", "link": "https://stackoverflow.com/users/10453206/jrob23123"}, "edited": false, "score": 0, "creation_date": 1542135890, "post_id": 53287290, "comment_id": 93457715, "body": "Thank you, I just added Me in front of everything and it worked. I guess it like &quot;Self&quot; in C#."}], "tags": [], "owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "is_accepted": true, "score": 0, "last_activity_date": 1542134019, "last_edit_date": 1542134019, "creation_date": 1542133311, "answer_id": 53287290, "question_id": 53286718, "link": "https://stackoverflow.com/questions/53286718/ms-access-get-value-from-string/53287290#53287290", "title": "MS Access: Get value from string", "body": "<p>Regardless of the fact that you are using undimensioned variables, I would say that the problem is that you are not referring to the controls in <code>CalCharge</code>.</p>\n\n<p>Try to use this:</p>\n\n<pre><code>Private Sub before_1_AfterUpdate()\n    Call CalCharge(1)\nEnd Sub\n\nPrivate Sub before_2_AfterUpdate()\n    Call CalCharge(2)\nEnd Sub\n\nPrivate Sub CalCharge(ByVal index As Long)\n    Me(\"charge_\" &amp; index).Value = Me(\"before_\" &amp; index).Value - Me(\"after_\" &amp; index).Value\nEnd Sub\n</code></pre>\n\n<p>I restructured it a bit:\n<code>CalCharge</code> awaits a numeric parameter now, defining the 'set' of controls to be used by an index.</p>\n\n<p>Your event procedures <code>before_1_AfterUpdate()</code> and <code>before_2_AfterUpdate()</code> now just call this new <code>CalCharge</code> procedure by providing the index.</p>\n\n<p><code>CalCharge</code> now references the controls by building the control names first.</p>\n\n<p><code>Me</code> is a reference to current object instance, your form, where the current code is in.</p>\n"}], "owner": {"reputation": 37, "user_id": 10453206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f93f9907fa853336e3b5872dd578eb41?s=128&d=identicon&r=PG&f=1", "display_name": "JRob23123", "link": "https://stackoverflow.com/users/10453206/jrob23123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 53287290, "answer_count": 1, "score": 0, "last_activity_date": 1542134019, "creation_date": 1542130926, "question_id": 53286718, "link": "https://stackoverflow.com/questions/53286718/ms-access-get-value-from-string", "title": "MS Access: Get value from string", "body": "<p>I am trying to get this VBA code to run after a user inputs data into a form. The script will calculate the charge which equals before-after</p>\n\n<p>I am defining the name of the textbox who values i want to use (Ex:\"before_1,after_1,charge_1) as a string and then use those values in the CalCharge Sub.</p>\n\n<p>Any ideas why this code does not work? I believe this method works in C#, but not in VBA.</p>\n\n<pre><code>Private Sub before_1_AfterUpdate()\n    before = \"before_1\"\n    after = \"after_1\"\n    charge = \"charge_1\"\n    Call CalCharge(before, after, charge)\nEnd Sub\n\nPrivate Sub before_2_AfterUpdate()\n    before = \"before_2\"\n    after = \"after_2\"\n    charge = \"charge_2\"\n    Call CalCharge(before, after, charge)\nEnd Sub\n\n\n\nSub CalCharge(before, after, charge)\n    charge.Value = before.Value - after.Value\n    Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 1, "creation_date": 1542130826, "post_id": 53286591, "comment_id": 93455406, "body": "So rngData.replace means you want to replace the data in the same row as lookup? It&#39;s a bit unclear. Maybe you can add an example?"}, {"owner": {"reputation": 13, "user_id": 10608952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e20d4ff64de238e516bdf3ad889032f?s=128&d=identicon&r=PG&f=1", "display_name": "mkpersonal", "link": "https://stackoverflow.com/users/10608952/mkpersonal"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1542198953, "post_id": 53286591, "comment_id": 93481316, "body": "Yes that&#39;s right. Let&#39;s say in Sheet1, F2 I have &quot;First Prize is for the winner&quot; and in the sheetClassification, B2 I have &quot;First Prize&quot; I want my macro to grab the content of C2 (still from Classification) and insert it in B2 (of Sheet1). Hence, if there is a match between my two sheets, I the cell content of my original sheet to be replaced by my offset value. Is this more clear now?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10608952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e20d4ff64de238e516bdf3ad889032f?s=128&d=identicon&r=PG&f=1", "display_name": "mkpersonal", "link": "https://stackoverflow.com/users/10608952/mkpersonal"}, "edited": false, "score": 0, "creation_date": 1542212528, "post_id": 53288634, "comment_id": 93490030, "body": "I have tried this and it now replaces all cell content but not with teh right value. Any idea why?"}], "tags": [], "owner": {"reputation": 31, "user_id": 10647926, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-61Wl-cONzAo/AAAAAAAAAAI/AAAAAAACGy8/fMIZ9BfezIk/photo.jpg?sz=128", "display_name": "Matt", "link": "https://stackoverflow.com/users/10647926/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1542139310, "creation_date": 1542139310, "answer_id": 53288634, "question_id": 53286591, "link": "https://stackoverflow.com/questions/53286591/vba-findreplace-cell-content-based-on-a-lookup-table-using-offset/53288634#53288634", "title": "VBA Find&amp;Replace cell content based on a lookup table using offset", "body": "<p>I think you need to modify the IF statement:</p>\n\n<pre><code>If Lookup.Value = \"\" Then\n    rngData.Value =Lookup.Offset(0, 4).Value\nEnd If\n</code></pre>\n\n<p>Using the .Replace method is like the REPLACE() function, it will swap out parts of a string and not the whole contents.  See: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.replace\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.replace</a></p>\n"}], "owner": {"reputation": 13, "user_id": 10608952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e20d4ff64de238e516bdf3ad889032f?s=128&d=identicon&r=PG&f=1", "display_name": "mkpersonal", "link": "https://stackoverflow.com/users/10608952/mkpersonal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542143792, "creation_date": 1542130374, "last_edit_date": 1542143792, "question_id": 53286591, "link": "https://stackoverflow.com/questions/53286591/vba-findreplace-cell-content-based-on-a-lookup-table-using-offset", "title": "VBA Find&amp;Replace cell content based on a lookup table using offset", "body": "<p>Scratching my head over this simple issue: I have a sub to find and replace a value in my <code>Sheet.Sheet1</code> column <code>F</code> based on a table in <code>Sheet.Classification</code> column <code>B</code>. The value is replaced by the content of <code>Classification Column F</code>, hence the <code>Offset(0, 4)</code>. </p>\n\n<p>The sub works fine excepts that I want it to replace the entire content of my cell in column <code>F</code> in <code>Sheet 1</code> (rather than just the <code>Lookup.Value</code> found).  </p>\n\n<pre><code>Sub ABC()\n\n\nDim rngData     As Range\nDim rngLookup   As Range\nDim Lookup      As Range\n\nWith Sheets(\"Sheet1\")\n Set rngData = .Range(\"F2\", .Range(\"F\" &amp; Rows.Count).End(xlUp))\nEnd With\n\nWith Sheets(\"Classification\")\n Set rngLookup = .Range(\"B2\", .Range(\"B\" &amp; Rows.Count).End(xlUp))\nEnd With\n\nFor Each Lookup In rngLookup\nIf Lookup.Value = \"\" Then\n    rngData.Replace what:=Lookup.Value, _\n                    Replacement:=Lookup.Offset(0, 4).Value, _\n                    LookAt:=xlPart, _\n                    SearchOrder:=xlByRows, _\n                    MatchCase:=False\nEnd If\nNext Lookup\nEnd Sub\n</code></pre>\n\n<p>Any help?</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1542131233, "post_id": 53286322, "comment_id": 93455591, "body": "Which version of Mac Excel are you using?"}, {"owner": {"reputation": 329, "user_id": 10647085, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EVYlxvdUf2w/AAAAAAAAAAI/AAAAAAAAQts/EVK5XQqHFr4/photo.jpg?sz=128", "display_name": "Ramon", "link": "https://stackoverflow.com/users/10647085/ramon"}, "edited": false, "score": 0, "creation_date": 1542131854, "post_id": 53286322, "comment_id": 93455868, "body": "Excel 2016, Cindy."}], "owner": {"reputation": 329, "user_id": 10647085, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EVYlxvdUf2w/AAAAAAAAAAI/AAAAAAAAQts/EVK5XQqHFr4/photo.jpg?sz=128", "display_name": "Ramon", "link": "https://stackoverflow.com/users/10647085/ramon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593562989, "creation_date": 1542129250, "last_edit_date": 1593562989, "question_id": 53286322, "link": "https://stackoverflow.com/questions/53286322/vba-excel-macro-based-on-chart-activate-event-does-not-run-on-mac", "title": "VBA Excel macro based on _Chart Activate_ event does not run on Mac", "body": "<p>I made a macro that prepares data to build a graph of a personality test. It works as follows:</p>\n\n<ul>\n<li><strong>1)</strong> The user fills a form where he or she answers questions using numbers ranging from -10 to 10. The form is in a worksheet called\n<em>Minha Hist\u00f3ria</em>.</li>\n<li><strong>2)</strong> The graph is on the worksheet <em>Meu Grafico</em>. When the correspondent tab of <em>Meu Grafico</em> is select, the Macro is loaded\nthrough the <em>Chart Activate</em> event.</li>\n<li><strong>3)</strong> Additionally, the macro adjusts the X-axis of the graph to the data origin, since the quantity of data on the graph varies with the\nage of the user.</li>\n</ul>\n\n<p><strong>The problem</strong>: This macro runs perfectly on Windows, but when I tried to run it on a Mac computer it failed to run, even when macros are habilitated to the Mac computer.</p>\n\n<p><strong>What is strange</strong>: In the VBE Project window of the Windows computer I can see that the code is correctly put in the Chart object module called <code>_Planilha2(Meu Grafico)_</code>. But on the Mac, the system: </p>\n\n<p>a) ignores that assignment and renames the chart object module to <code>_Planilha21(Meu Grafico)_</code>;</p>\n\n<p>b) erases the code in this module and put it in a new module called <code>_Gr.fico2_</code> (Why?).  </p>\n\n<p><em>Obs</em>: This Macro does not construct the graph. It only made some calculations with the answers in order that they be reflected on the graph. It has to work at any moment the user changes the answer of any question in the form. And, if fact, it do it on the Windows PC, only.</p>\n\n<p>Can anyone can help me with this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/9gfhe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9gfhe.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Code</strong>:</p>\n\n<pre><code>Private Sub Chart_Activate()\n'Macro criada por Ramon Barbosa Rosa em 29/10/2018\n'SANT\u00c9 COACHING\nDim Dados As Worksheet\nDim Base As Worksheet\nDim j As Integer\nDim Idade As Integer\nDim Coluna As Integer\nSet Dados = Worksheets(\"Minha Hist\u00f3ria\")\nSet Base = Worksheets(\"Base\")\nIdade = -1\n\n'Calcula idade do coachee\nFor j = 2 To 95\n    If Base.Cells(2, j) &lt;&gt; \"\" Then\n    Idade = Idade + 1\n    End If\nNext j\n\nColuna = Idade + 2 'Indica o n\u00famero da coluna do ano corrente\n\n'Apaga valores remanescentes de anos anteriores\nBase.Range(Base.Cells(5, Coluna + 1), Base.Cells(5, 100)).ClearContents\nBase.Range(Base.Cells(8, Coluna + 1), Base.Cells(8, 100)).ClearContents\nBase.Range(Base.Cells(11, Coluna + 1), Base.Cells(11, 100)).ClearContents\n\n'S\u00e9rie PESSOAL: Preenche valor referente ao ano de nascimento\nIf Base.[b4] = 0 Then\n    Base.[b5] = Base.[b3]\nElse\n    Base.[b5] = Base.[b4]\nEnd If\n\n'S\u00e9rie PESSOAL: preenche demais anos (Planilha Ref, oculta)\nFor i = 3 To Idade + 2\n    If Base.Cells(4, i - 1) &gt; 0 And Base.Cells(4, i) &gt; 0 Then 'Laranja\n        Base.Cells(5, i) = Base.Cells(5, i - 1) + Base.Cells(4, i)\n    ElseIf Base.Cells(4, i - 1) &gt; 0 And Base.Cells(4, i) &lt; 0 Then 'verde \u00e1gua\n        Base.Cells(5, i) = Base.Cells(3, i) + Base.Cells(4, i)\n    ElseIf Base.Cells(4, i - 1) &lt;= 0 And Base.Cells(4, i) &gt; 0 Then 'Roxo\n        Base.Cells(5, i) = Base.Cells(4, i) + Application.WorksheetFunction.Max(Base.Range(Base.Cells(5, 2), Base.Cells(5, i - 1)))\n    ElseIf Base.Cells(4, i - 1) &lt;= 0 And Base.Cells(4, i) &lt; 0 Then 'Azul\n        Base.Cells(5, i) = Base.Cells(5, i - 1) + Base.Cells(4, i)\n    ElseIf Base.Cells(4, i) = 0 Then 'Rosa\n        Base.Cells(5, i) = Base.Cells(3, i)\n    End If\nNext i\n\n'S\u00e9rie PROFISSIONAL: Preenche valor referente ao ano de nascimento\nIf Base.[b10] = 0 Then\n    Base.[b11] = 0\nElse\n    Base.[b11] = Base.[10]\nEnd If\n\n'S\u00e9rie PROFISSIONAL: preenche demais anos (Planilha Ref, oculta)\n'Considera resultado como igual a zero at\u00e9 a primeira experi\u00eancia profissional\nFor i = 3 To Idade + 2\n    If Application.WorksheetFunction.Sum(Base.Range(Base.Cells(10, 2), Base.Cells(10, i))) = 0 Then\n        Base.Cells(11, i) = 0\n    ElseIf Base.Cells(10, i - 1) &gt; 0 And Base.Cells(10, i) &gt; 0 Then 'Laranja\n        Base.Cells(11, i) = Base.Cells(11, i - 1) + Base.Cells(10, i)\n    ElseIf Base.Cells(10, i - 1) &gt; 0 And Base.Cells(10, i) &lt; 0 Then 'verde \u00e1gua\n        Base.Cells(11, i) = Base.Cells(3, i) + Base.Cells(10, i)\n    ElseIf Base.Cells(10, i - 1) &lt;= 0 And Base.Cells(10, i) &gt; 0 Then 'Roxo\n        Base.Cells(11, i) = Base.Cells(10, i) + Application.WorksheetFunction.Max(Base.Range(Base.Cells(11, 2), Base.Cells(11, i - 1)), Base.Cells(3, i)) 'O m\u00e1ximo \u00e9 um valor hist\u00f3rico ou o baseline do ano\n    ElseIf Base.Cells(10, i - 1) &lt;= 0 And Base.Cells(10, i) &lt; 0 Then 'Azul\n        Base.Cells(11, i) = Base.Cells(11, i - 1) + Base.Cells(10, i)\n    ElseIf Base.Cells(10, i) = 0 And Application.WorksheetFunction.Sum(Base.Range(Base.Cells(10, 2), Base.Cells(10, i - 1))) &lt;&gt; 0 Then 'Rosa\n        Base.Cells(11, i) = Base.Cells(3, i)\n    ElseIf Base.Cells(10, i) &gt; 0 And Application.WorksheetFunction.Sum(Base.Range(Base.Cells(10, 2), Base.Cells(10, i - 1))) = 0 Then 'Vermelho\n        Base.Cells(11, i) = Base.Cells(3, i) + Base.Cells(10, i)\n    ElseIf Base.Cells(10, i) &lt; 0 And Application.WorksheetFunction.Sum(Base.Range(Base.Cells(10, 2), Base.Cells(10, i - 1))) = 0 Then 'Verde Claro\n        Base.Cells(11, i) = Base.Cells(10, i)\n    End If\nNext i\n\n'S\u00e9rie SOCIAL: Preenche valor referente ao ano de nascimento\nIf Base.[b7] = 0 Then\n    Base.[b8] = 0\nElse\n    Base.[b8] = Base.[7]\nEnd If\n\n'S\u00e9rie SOCIAL: preenche demais anos (Planilha Ref, oculta)\nFor i = 3 To Idade + 2\n    If Base.Cells(7, i - 1) &gt;= 0 And Base.Cells(7, i) &gt; 0 Then 'Laranja\n        Base.Cells(8, i) = Base.Cells(8, i - 1) + Base.Cells(7, i)\n    ElseIf Base.Cells(7, i - 1) &gt;= 0 And Base.Cells(7, i) &lt; 0 Then 'verde \u00e1gua\n        Base.Cells(8, i) = Base.Cells(7, i)\n    ElseIf Base.Cells(7, i - 1) &lt; 0 And Base.Cells(7, i) &gt; 0 Then 'Roxo\n        Base.Cells(8, i) = Base.Cells(7, i)\n    ElseIf Base.Cells(7, i - 1) &lt; 0 And Base.Cells(7, i) &lt; 0 Then 'Azul\n        Base.Cells(8, i) = Base.Cells(7, i)\n    ElseIf Base.Cells(7, i) = 0 Then 'Rosa\n        Base.Cells(8, i) = 0\n    End If\nNext i\n\n'Ajusta a fonte de dados do gr\u00e1fico\nWith Charts(\"Meu Grafico\")\n.SeriesCollection(1).FormulaR1C1 = \"=SERIES(BASE!R5C1,BASE!R2C2:R2C\" &amp; Coluna &amp; \",BASE!R5C2:R5C\" &amp; Coluna &amp; \",1)\"  'Pessoal\n.SeriesCollection(2).FormulaR1C1 = \"=SERIES(BASE!R8C1,BASE!R2C2:R2C\" &amp; Coluna &amp; \",BASE!R8C2:R8C\" &amp; Coluna &amp; \",2)\" 'Social\n.SeriesCollection(3).FormulaR1C1 = \"=SERIES(BASE!R11C1,BASE!R2C2:R2C\" &amp; Coluna &amp; \",BASE!R11C2:R11C\" &amp; Coluna &amp; \",3)\" 'Profissional\n.SeriesCollection(4).FormulaR1C1 = \"=SERIES(BASE!R3C1,BASE!R2C2:R2C\" &amp; Coluna &amp; \",BASE!R3C2:R3C\" &amp; Coluna &amp; \",4)\" 'S\u00e9rie 4 (Baseline)\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1542128981, "post_id": 53286167, "comment_id": 93454422, "body": "Is your PC set to the correct locality?"}, {"owner": {"reputation": 435, "user_id": 2209327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/af16da6bcf691ad3d2a86dc87fb301b1?s=128&d=identicon&r=PG", "display_name": "ChrisBull", "link": "https://stackoverflow.com/users/2209327/chrisbull"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1542129093, "post_id": 53286167, "comment_id": 93454497, "body": "Yes all UK settings in control panel Region and Language"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1542129195, "post_id": 53286167, "comment_id": 93454548, "body": "Dumb question - if you do <code>mm&#47;dd&#47;yyyy</code> does the date/month switch like it &quot;should&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 2209327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/af16da6bcf691ad3d2a86dc87fb301b1?s=128&d=identicon&r=PG", "display_name": "ChrisBull", "link": "https://stackoverflow.com/users/2209327/chrisbull"}, "edited": false, "score": 0, "creation_date": 1542185913, "post_id": 53286434, "comment_id": 93473444, "body": "This seems to have solved it - seems unnecessarily long winded just to get a date in the format it is typed but it is at least working - thanks!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 435, "user_id": 2209327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/af16da6bcf691ad3d2a86dc87fb301b1?s=128&d=identicon&r=PG", "display_name": "ChrisBull", "link": "https://stackoverflow.com/users/2209327/chrisbull"}, "edited": false, "score": 0, "creation_date": 1542186638, "post_id": 53286434, "comment_id": 93473910, "body": "It is a bit, but it tests that an actual date is entered to the control and changes the colour if it isn&#39;t.  Without the tests you could just use <code>cell = CDATE(ctrl.Value)</code> I guess.  I also make use of the controls <code>Tag</code> property to hold the column number to save to &amp; dictate what kind of data can be entered to the control."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 435, "user_id": 2209327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/af16da6bcf691ad3d2a86dc87fb301b1?s=128&d=identicon&r=PG", "display_name": "ChrisBull", "link": "https://stackoverflow.com/users/2209327/chrisbull"}, "edited": false, "score": 0, "creation_date": 1542186942, "post_id": 53286434, "comment_id": 93474097, "body": "The answer given by @chilliin would be worth a look.  Haven&#39;t tried it on a form, but it should work."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1542129716, "creation_date": 1542129716, "answer_id": 53286434, "question_id": 53286167, "link": "https://stackoverflow.com/questions/53286167/stop-changing-date-value-in-vba/53286434#53286434", "title": "Stop changing date value in VBA", "body": "<p>This is the date code I use on control containing UK dates: </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Me.txtDate = Format(Date, \"dd-mmm-yyyy\")\nEnd Sub  \n</code></pre>\n\n<p>On the <code>AfterUpdate</code> event for the date control:  </p>\n\n<pre><code>Private Sub txtDate_AfterUpdate()\n    With Me\n        FormatDate .txtDate\n    End With\nEnd Sub  \n</code></pre>\n\n<p>In a normal module:  </p>\n\n<pre><code>Public Sub FormatDate(ctrl As Control)\n\n    Dim dDate As Date\n    Dim IsDate As Boolean\n\n    If Replace(ctrl.Value, \" \", \"\") &lt;&gt; \"\" Then\n        On Error Resume Next\n            dDate = CDate(ctrl.Value)\n            IsDate = (Err.Number = 0)\n            Err.Clear\n        On Error GoTo 0\n\n        If IsDate Then\n            ctrl.Value = Format(ctrl.Value, \"dd-mmm-yyyy\")\n            ctrl.BackColor = RGB(255, 255, 255)\n        Else\n            ctrl.BackColor = RGB(255, 0, 0)\n        End If\n    End If\n\nEnd Sub  \n</code></pre>\n\n<p>Then I transfer it to the worksheet (on a Save button) using the below code:  </p>\n\n<pre><code>shtRawData.Cells(rLastCell.Row, CLng(lCol)) = CDate(ctrl.Value)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1542139836, "creation_date": 1542139836, "answer_id": 53288751, "question_id": 53286167, "link": "https://stackoverflow.com/questions/53286167/stop-changing-date-value-in-vba/53288751#53288751", "title": "Stop changing date value in VBA", "body": "<p>When you're about to write your date to the sheet:</p>\n\n<ol>\n<li>Verify that it's being stored as a date (or date equivalent) with <code>isdate()</code></li>\n<li>Assign it via <code>Range.FormulaLocal</code> instead of <code>value</code> or <code>value2</code>.</li>\n</ol>\n\n<p>Untested, but i.e.</p>\n\n<pre><code>Range(\"A1\").FormulaLocal = #10/31/2018#\n</code></pre>\n"}], "owner": {"reputation": 435, "user_id": 2209327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/af16da6bcf691ad3d2a86dc87fb301b1?s=128&d=identicon&r=PG", "display_name": "ChrisBull", "link": "https://stackoverflow.com/users/2209327/chrisbull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 53286434, "answer_count": 2, "score": 0, "last_activity_date": 1542139836, "creation_date": 1542128747, "question_id": 53286167, "link": "https://stackoverflow.com/questions/53286167/stop-changing-date-value-in-vba", "title": "Stop changing date value in VBA", "body": "<p>Excel keeps changing my date to US format. I have a user form where the user inputs a date. As an example, I enter <code>01/11/2018</code> (1st November 2018). I then put this value into a cell however it changes automatically to <code>11/01/2018</code> or 11th January 2018.</p>\n\n<p>I've so far tried using the following code to force it to use UK format;</p>\n\n<pre><code>SHT_data_TASKS.Cells(1 + tableRows, 8).NumberFormat = \"dd/mm/yyyy;@\"\nSHT_data_TASKS.Cells(1 + tableRows, 8) = form_addTask_Date.Value\n</code></pre>\n\n<p>But it does not help. I've also tried using CDate function but still no luck. I've checked my computer regional settings and they are all correct for the UK. </p>\n\n<p>If I right click on the cell where the date is placed and chose format it shows as already being formatted to UK date! I'm not sure what is causing it to change.</p>\n"}, {"tags": ["excel", "vba", "compatibility"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1542132015, "post_id": 53285998, "comment_id": 93455951, "body": "Your code ran successfully for me when applied to a cell with a very simple conditional format (<code>Formula1=&quot;=G8&gt;16&quot;</code>). Can you add examples of the conditional format your working with?"}, {"owner": {"reputation": 103, "user_id": 10453139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e9bacdb2ced1f1e1ada6aadf9b48e1?s=128&d=identicon&r=PG&f=1", "display_name": "Alan T.", "link": "https://stackoverflow.com/users/10453139/alan-t"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1542135177, "post_id": 53285998, "comment_id": 93457404, "body": "@xidgel Oh dear. It&#39;s comparing values in the active sheet with values in another - full formula is <code>=C5&lt;&gt;INDEX(INDIRECT(&quot;Table234&quot;),$B5,C$4)</code> and I had a hell of a time getting that into a form Conditional Formatting would accept... I&#39;m going to be pretty disappointed if that&#39;s what&#39;s breaking the check."}], "owner": {"reputation": 103, "user_id": 10453139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e9bacdb2ced1f1e1ada6aadf9b48e1?s=128&d=identicon&r=PG&f=1", "display_name": "Alan T.", "link": "https://stackoverflow.com/users/10453139/alan-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542128277, "creation_date": 1542128277, "question_id": 53285998, "link": "https://stackoverflow.com/questions/53285998/pre-built-code-for-checking-conditional-formatting-not-working-type-error", "title": "Pre-built code for checking conditional formatting not working - Type error", "body": "<p>I'm attempting to use a VBA function created by <a href=\"http://www.xldynamic.com/source/xld.CFConditions.html\" rel=\"nofollow noreferrer\">Bob Phillips</a> to check if conditional formatting has been met in a particular cell. This seems to be a respectable solution, as Google turns up a number of different references to it, but it's throwing a Type error for me. I'm using Excel 2007, and the last update made to the code was in 2005, so I assume there are some compatibility issues involved. I have already fixed one syntax error (<code>Set rng = rng(1, 1)</code> wasn't working until I inserted <code>.Cells</code>) but I'm unable to fix this one because I can't parse what the code is doing.</p>\n\n<p>The function is designed specifically to evaluate conditionals based on a formula, which mine is. Here is the full code:</p>\n\n<pre><code>Public Function IsCFMet2(rng As Range) As Boolean\n\nDim oFC As FormatCondition\nDim sF1 As String\nDim iRow As Long\nDim iColumn As Long\n\n   Set rng = rng.Cells(1, 1)\n   If rng.FormatConditions.Count &gt; 0 Then\n      For Each oFC In rng.FormatConditions\n         If oFC.Type = xlExpression Then\n             're-adjust the formula back to the formula that applies\n             'to the cell as relative formulae adjust to the activecell\n            With Application\n               iRow = rng.Row\n               iColumn = rng.Column\n               sF1 = .Substitute(oFC.Formula1, \"ROW()\", iRow)\n               sF1 = .Substitute(sF1, \"COLUMN()\", iColumn)\n               sF1 = .ConvertFormula(sF1, xlA1, xlR1C1)\n               sF1 = .ConvertFormula(sF1, xlR1C1, xlA1, , rng)\n            End With\n       **** IsCFMet2 = rng.Parent.Evaluate(sF1)\n         End If\n         If IsCFMet2 Then Exit Function\n     Next oFC\n   End If\n\nEnd Function\n</code></pre>\n\n<p>The Type Error is thrown by the starred line. I don't fully grasp the With Application block or how it's contributing to the detection of a fulfilled conditional formatting rule, so I don't know what the problem is or how to fix it without breaking the code.</p>\n\n<p>Here is the test macro I'm using to check the function:</p>\n\n<pre><code>Sub Test():\n\nDim Tester As Range\n\nSet Tester = ActiveCell\n\n    If IsCFMet2(Tester) Then MsgBox \"CF is met!\"\n\nEnd Sub\n</code></pre>\n\n<p>However I've gotten the same error with various range inputs, so I'm pretty confident the input itself is not the problem - I'm including it just as a precaution.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1542127959, "post_id": 53285768, "comment_id": 93453784, "body": "You can use the same code to add the validation lists, but you will probably want to put it in a change event so it&#39;s triggered when col P is changed. Or see eg <a href=\"https://www.contextures.com/xlDataVal02.html\" rel=\"nofollow noreferrer\">contextures.com/xlDataVal02.html</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542128837, "post_id": 53285768, "comment_id": 93454324, "body": "dependent drop down lists are way to go (see link from @SJR). why use code when you don&#39;t have to?"}], "answers": [{"comments": [{"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1542133003, "post_id": 53286291, "comment_id": 93456389, "body": "this ran through just fine, but doesn&#39;t create a data validation list once I open the file. Is this because there is no current value in column P until the user selects an item off the list? The current value stays blank until inputted"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1542151548, "post_id": 53286291, "comment_id": 93463593, "body": "@nicklanta the first Sub will create the Data Validation List for Column P, and the Worksheet_Change Sub will make it so that when the user selects something from the list in Column P, the Data Validation List on Column Q will be generated so the user can select from it accordingly. Hope this helps! :)"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1542229968, "post_id": 53286291, "comment_id": 93498314, "body": "I understand the process, but it&#39;s not populating a data validation list in column Q, rows 2 &amp; lastrow"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1542230087, "post_id": 53286291, "comment_id": 93498379, "body": "it completely skips through he Private sub in the module"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1542235112, "post_id": 53286291, "comment_id": 93500412, "body": "@nicklanta The values don&#39;t populate Column Q, but they are available to be selected by the user. Would you be able to share your workbook? Maybe upload to something like Google Drive/Dropbox and comment a link to it here, so I can have a look at it? As the answer I provided does work when I&#39;m testing..."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1542129148, "creation_date": 1542129148, "answer_id": 53286291, "question_id": 53285768, "link": "https://stackoverflow.com/questions/53285768/is-there-a-way-to-have-an-if-statement-based-on-a-data-validation-list-value-in/53286291#53286291", "title": "Is there a way to have an IF statement based on a data validation list value in a worksheet?", "body": "<p>How about the following, this will add validation lists to Column Q depending on values selected on Column P:</p>\n\n<pre><code>Sub foo()\nlastrow = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nWith Range(\"P2:P\" &amp; lastrow).Validation\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n    Operator:=xlBetween, Formula1:=\"Yes,No,N/A\"\n    .IgnoreBlank = True\n    .InCellDropdown = True\nEnd With\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Column = 16 And Target.Value = \"No\" Then\n    With Range(\"Q\" &amp; Target.Row).Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n        Operator:=xlBetween, Formula1:=\"value 1, value 2\"\n        .IgnoreBlank = True\n        .InCellDropdown = True\n    End With\nElseIf Target.Column = 16 And Target.Value = \"Yes\" Then\n    With Range(\"Q\" &amp; Target.Row).Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n        Operator:=xlBetween, Formula1:=\"value 3, value 4\"\n        .IgnoreBlank = True\n        .InCellDropdown = True\n    End With\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586395124, "creation_date": 1542127573, "last_edit_date": 1586395124, "question_id": 53285768, "link": "https://stackoverflow.com/questions/53285768/is-there-a-way-to-have-an-if-statement-based-on-a-data-validation-list-value-in", "title": "Is there a way to have an IF statement based on a data validation list value in a worksheet?", "body": "<p>In column P, I have a drop down list, the code to add that looks like this for every new worksheet I create. </p>\n\n<pre><code>lastrow = ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).row\n\nWith Range(\"P2:P\" &amp; lastrow).Validation\n .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n Operator:=xlBetween, Formula1:=\"Yes,No,N/A\"\n .IgnoreBlank = True\n .InCellDropdown = True\nEnd With\n</code></pre>\n\n<p>In column Q I want another drop down list to populate based on specific values the user inputs from column P. </p>\n\n<p>For example, if the user chooses <code>No</code> in column P, I want only values <code>value 1</code> or <code>value 2</code> to populate in that row of column Q. If the user chooses <code>Yes</code> in column P, I want only values <code>value 3</code> or <code>value 4</code> to populate in column Q. </p>\n\n<p>I know I'd need to declare something like this above:</p>\n\n<pre><code>Dim ActionRow As Long\n\nDim colAction As Long\ncolAction = 16\n\nFor ActionRow = 2 To 500 ' Wb.Worksheet(\"Sheet1\").UsedRange.Rows.Count\n    If .Cells(ActionRow, 16).Value = \"No\" Then\n    ADD DROP DOWN LIST VALUES 1 &amp; 2\nNext ActionRow\n</code></pre>\n\n<p>can anyone help me revise this, or is this not possible without data already being in the column?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 1, "creation_date": 1542141165, "post_id": 53285761, "comment_id": 93459998, "body": "You&#39;ll have to clarify your design...maybe share some screenshots and your table models if you can. Is there a reason you&#39;re not using a multi-valued list box in <code>form1</code> for your permit numbers?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1542189773, "post_id": 53285761, "comment_id": 93475870, "body": "Also, please, post what have you tried, and what is exactly failing. Now your question looks like <i>yay! free coding service!</i>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1542486795, "post_id": 53285761, "comment_id": 93588195, "body": "Is checkbox bound to a field? Is this a multi-user db? Simultaneous users will conflict. Does sound like really need a multi-select listbox. Code would loop through listbox selections and build criteria string."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1542488393, "post_id": 53285761, "comment_id": 93588636, "body": "Read up on global variables"}], "owner": {"reputation": 21, "user_id": 1202017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62f9eeca35fa9d61b1cc6c136ade1f78?s=128&d=identicon&r=PG", "display_name": "user1202017", "link": "https://stackoverflow.com/users/1202017/user1202017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 327, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594022564, "creation_date": 1542127557, "last_edit_date": 1594022564, "question_id": 53285761, "link": "https://stackoverflow.com/questions/53285761/how-can-i-pass-a-value-from-one-form-to-another-form-in-ms-access", "title": "How can I pass a value from one form to another form in ms access", "body": "<p>I am just revising my request with detail code.\nI have a main data entry form.  Lets call it form1.  In form1 I have a text field name permit_number and a button get_permit_no.   To get permit numbers I have compare two tables and retrieve all possible numbers in the query.\nWhen I click get_permit_no, form2 will pop up with all possible permit numbers. Form2 is using query as record source.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xQ1RA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xQ1RA.jpg\" alt=\"this is form2\"></a></p>\n\n<p>Then user can select any number by clicking in the check box. Then when user click select permit number button i want to pass that value to form1.permit_number.  For example if user select 79959901,77994803 then i want to pass the whole string to form1.permit_number.</p>\n\n<p>Here is my code.</p>\n\n<pre><code>Public Sub CmdInsertPermitno_Click()\n    DoCmd.RunCommand acCmdSaveRecord\n\n    Dim rs As DAO.Recordset\n    Dim strSQL\n    strSQL = \"Select permitno from query3 where check =\" &amp; -1\n\n    Set rs = CurrentDb.OpenRecordset(strSQL)\n    Dim pno As String\n    Dim getpno As String\n\n    getpno = \"\"\n\n    With rs\n        If Not .BOF And Not .EOF Then\n            .MoveLast\n            .MoveFirst\n\n            While (Not .EOF)\n                pno = rs.Fields(\"[permitno]\")\n                 .MoveNext\n                getpno = getpno &amp; \",\" &amp; pno\n\n            Wend\n        End If\n    End With\n\n    Set rs = Nothing\n            getpermitno = Right(getpno, Len(getpno) - 1)\n\n    DoCmd.OpenForm \"Data Entry\", acNormal, , , , acWindowNormal, OpenArgs:=\"getpermitno\"\n\nEnd Sub\n</code></pre>\n\n<p>First I need to go back to form1 as last opening record place.  Then I want to pass the value.  </p>\n\n<p>Thanks,\nHtet</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1542126597, "post_id": 53285387, "comment_id": 93452883, "body": "You are not disabling events so your macro is calling itself over and over until your system crashes. This is a duplicate - please see link below"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1542126624, "post_id": 53285387, "comment_id": 93452907, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/50868939/bug-on-worksheet-change-event-in-excel\">Bug on Worksheet Change event in Excel?</a>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1542126919, "post_id": 53285387, "comment_id": 93453092, "body": "Seems like you are over complicating the task. Why not just delete the corresponding row when A is switched to blank?"}, {"owner": {"reputation": 11, "user_id": 7833129, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158468526670305/picture?type=large", "display_name": "MelissaR", "link": "https://stackoverflow.com/users/7833129/melissar"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1542129201, "post_id": 53285387, "comment_id": 93454554, "body": "Hi urdearboy, Good to know, thanks. That part of the post may be a duplicate, but i hadn&#39;t really looked into that part yet. I&#39;m really trying to see if I can get the clear and shift part to work, and maybe be a little less complicated."}, {"owner": {"reputation": 11, "user_id": 7833129, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158468526670305/picture?type=large", "display_name": "MelissaR", "link": "https://stackoverflow.com/users/7833129/melissar"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1542129245, "post_id": 53285387, "comment_id": 93454573, "body": "The spreadsheet has a lot of formatting, and if I delete the rows, I lose all of the formatting too."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1542131530, "post_id": 53285387, "comment_id": 93455712, "body": "Your shift is crashing the macro - even if it\u2019s working perfect, your macro will crash. Follow the instructions on that post, then you will actually get to see what the final result looks like"}], "owner": {"reputation": 11, "user_id": 7833129, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158468526670305/picture?type=large", "display_name": "MelissaR", "link": "https://stackoverflow.com/users/7833129/melissar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542126433, "creation_date": 1542126433, "question_id": 53285387, "link": "https://stackoverflow.com/questions/53285387/vba-when-cell-is-cleared-not-deleted-clear-whole-row-and-move-rows-cells-belo", "title": "VBA When cell is cleared (not deleted), clear whole row and move rows cells below it up", "body": "<p>I'm really new to programming and I have a spreadsheet I'm working on that I could use some help with. My Columns A and B are two dropdown menus, where B is dependent on A. There are some other columns that use VLookUp to bring up information based on the dropdown, and one other column where I have a simple formula. If I clear out a value from Column \"A\", I would like the entire row to clear (without losing my formulas), and i would all the cells with values under it to shift up. I've looked up a lot of ways to do this with deleting cells, but I haven't been able to find much with clearing them. My code almost works, but seems pretty inelegant since I'm using the clipboard. I also need to clear out the last row at the end using this code, but when I try it, Excel crashes. Any advice would be most appreciated. Here is my code so far:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim wks As Worksheet\nDim FirstRow As Long\nDim FirstColumn As Long\nDim LastRow As Long\nDim QtyColumn As Long\nDim FormulaRange1 As Range\nDim FormulaRange2 As Range\n\nFirstColumn = 1\nQtyColumn = 4\nSet wks = ActiveSheet\n\nIf Not Application.Intersect(Target, Range(\"A11:A26\")) Is Nothing Then\n   If IsEmpty(Target.Value) Then\n   wks.Range(\"B\" &amp; Target.Row).ClearContents\n   wks.Range(\"D\" &amp; Target.Row).ClearContents\n   FirstRow = Cells(Target.Row, Target.Column).Row\n   LastRow = Cells(Rows.count, 1).End(xlUp).Row\n   Set FormulaRange1 = wks.Range(Cells(Target.Row, Target.Column).Offset(1, 0), wks.Cells(LastRow, \"B\"))\n   Set FormulaRange2 = wks.Range(Cells(Target.Row, \"D\").Offset(1, 0), wks.Cells(LastRow, \"D\"))\n   FormulaRange1.Copy\n   wks.Range(Cells(FirstRow, FirstColumn).Address).PasteSpecial xlPasteValues\n   FormulaRange2.Copy\n   wks.Range(Cells(FirstRow, QtyColumn).Address).PasteSpecial xlPasteValues\n   Application.CutCopyMode = False\n  End If\nEnd If\nEnd Sub\n</code></pre>\n"}]