[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1443661098, "post_id": 32877007, "comment_id": 53586760, "body": "Please check Ron De Bruin&#39;s site. He has already given an example there"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1443687447, "post_id": 32877007, "comment_id": 53595673, "body": "What&#39;s the problem you are having?"}, {"owner": {"reputation": 11, "user_id": 5395243, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bpAhPtN2shY/AAAAAAAAAAI/AAAAAAAABL0/9Wk1LBa1jT0/photo.jpg?sz=128", "display_name": "Justin ", "link": "https://stackoverflow.com/users/5395243/justin"}, "edited": false, "score": 0, "creation_date": 1443750612, "post_id": 32877007, "comment_id": 53627530, "body": "Sorry accidentally added vbsscript tag. So here&#39;s the story. I created a button to add a row at the top of my spreadsheet. It works great but if the user goes to save to workbook it pops up with a message saying &quot;other versions of Excel may not be compatible...etc... Would you like to save in another format?&quot; It gives the option of Yes, No or Cancel. I googled all night trying to figure out if there was a way to get rid of this message and the only solution I found was to add a save script that suppresses alerts during save process but I can&#39;t get the above script/button to work."}], "owner": {"reputation": 11, "user_id": 5395243, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bpAhPtN2shY/AAAAAAAAAAI/AAAAAAAABL0/9Wk1LBa1jT0/photo.jpg?sz=128", "display_name": "Justin ", "link": "https://stackoverflow.com/users/5395243/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1443749731, "creation_date": 1443654824, "last_edit_date": 1531161705, "question_id": 32877007, "link": "https://stackoverflow.com/questions/32877007/excel-vba-script-to-save-using-a-button", "title": "Excel VBA Script to save using a button", "body": "<p>I am attempting to create a button that will save an excel spreadsheet as a non-macro xlsx file. I'm new to VBS and was pretty proud that I got a button to add a row at the top and maintain formatting but this save button is driving me bonkers. Also will this script allow the user to choose where they want to save the file? I need that functionality as well. Here's what I've hobbled together scouring the web so far:</p>\n\n<pre><code>Sub SaveButton(tempFilePath As String, tempFileName As String)\n    Dim Builders_Risk As Workbook\n    Dim SaveFormat As Long\n\n    'Remember the users setting\n    SaveFormat = Application.DefaultSaveFormat\n    'Set it to the 2010 file format\n    Application.DefaultSaveFormat = 51\n\n    ActiveSheet.Copy\n    Set Builders_Risk = ActiveWorkbook\n    BR_Reporting.CheckCompatibility = False\n\n    'Stops error display at time of file save\n    Application.DisplayAlerts = False\n\n    With BR_Reporting\n        .SaveAs tempFilePath &amp; tempFileName &amp; \".xlsx\", FileFormat:=51\n        .Close SaveChanges:=False\n    End With\n\n    'Reinstates error displays after save\n    Application.DisplayAlerts = True\n\n    'Set DefaultSaveFormat back to the users setting\n    Application.DefaultSaveFormat = SaveFormat\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1443661996, "post_id": 32876680, "comment_id": 53586930, "body": "Use dynamic named range and regular VLOOKUP formula in cell. Or use VBA to mass fill in a <code>.FormulaR1C1</code>."}, {"owner": {"reputation": 2090, "user_id": 3230456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b86b80866ac0d8165eabbf5679353633?s=128&d=identicon&r=PG&f=1", "display_name": "codersl", "link": "https://stackoverflow.com/users/3230456/codersl"}, "edited": false, "score": 0, "creation_date": 1443686033, "post_id": 32876680, "comment_id": 53594924, "body": "What sort of flexibility are you trying to achieve?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1443686277, "post_id": 32876680, "comment_id": 53595068, "body": "It seems to me that you&#39;re over-complicating things: (1) Type into any cell the VLookup formula you want. (2) Go into the VBE direct window and type <code>? Selection.FormulaR1C1</code>. (3) Finally, put in your code <code>Sheets(&quot;Data&quot;).Range(&quot;F1:F30000&quot;).FormulaR1C1 = &quot;enter here the formula you got from step 2&quot;</code>. Or am I completely off?"}], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1443689160, "last_edit_date": 1443689160, "creation_date": 1443688482, "answer_id": 32882973, "question_id": 32876680, "link": "https://stackoverflow.com/questions/32876680/trying-to-add-a-vlookup-piece-to-my-excel-macro/32882973#32882973", "title": "Trying to Add a Vlookup Piece to my Excel Macro", "body": "<p>Give this a go</p>\n\n<pre><code>Sub Sheet2_Button1_Click()\n    Dim Rws As Long, rng As Range, Mrng As Range, x\n\n    Rws = Cells(Rows.Count, \"D\").End(xlUp).Row\n    Set rng = Range(Cells(1, \"G\"), Cells(Rws, \"G\"))\n    Set Mrng = Range(\"M1:M\" &amp; Rws)\n\n    rng = \"=IFERROR(VLOOKUP(D1, \" &amp; Mrng.Address &amp; \",1,0),\"\"Nope\"\")\"\n\n    '----------If you want it to be just values uncomment the below line--------------\n    ' rng.Value=rng.Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 0, "last_activity_date": 1443693358, "creation_date": 1443693358, "answer_id": 32884623, "question_id": 32876680, "link": "https://stackoverflow.com/questions/32876680/trying-to-add-a-vlookup-piece-to-my-excel-macro/32884623#32884623", "title": "Trying to Add a Vlookup Piece to my Excel Macro", "body": "<p>You have some backwards range references. I can't speak to the vlookup call, but you can start by looking at this part:</p>\n\n<pre><code>If Cells(i, \"F5\").Value &lt;&gt; \"\" Then\nRange(i, \"G\").Value = WorksheetFunction.VLookup(Cells(i, \"D\"), Range(\"N\").End(xlDown), 1, False)\nEnd If\n</code></pre>\n\n<p>Try changing it to this to fix the range declarations:</p>\n\n<pre><code>If Range(\"F\" &amp; i).Value &lt;&gt; \"\" Then\n    Range(\"G\" &amp; i).Value = WorksheetFunction.VLookup(Range(\"D\" &amp; i), Range(\"N\").End(xlDown), 1, False)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5318496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7fb67eee94e8df1b1074a0f3642b052?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5318496/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 526, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1443693358, "creation_date": 1443652741, "last_edit_date": 1443653058, "question_id": 32876680, "link": "https://stackoverflow.com/questions/32876680/trying-to-add-a-vlookup-piece-to-my-excel-macro", "title": "Trying to Add a Vlookup Piece to my Excel Macro", "body": "<p>I'm trying to add a Vlookup piece to a long macro that I'm working on to eliminate some daily data manipulation work. </p>\n\n<p>Essentially everyday I have four new columns of data that I compare to the day befores, using vlookup. The four new columns sit in columns C-F and the old data in columns M-P. I vlookup column D against column M, with the formula in column G.</p>\n\n<p>I'm running into a problem of how to be flexible with the range I give the macro to use each day as I don't want to constantly change it. The amount of rows will fluctuate between 10,000-30,000.</p>\n\n<p>Here is my code- I'm probably thinking about this all wrong.</p>\n\n<pre><code>Sub Lookup()\n\nDim i, LastRow\nSet i = Sheets(\"data\").Range(\"F5\").End(xlUp)\n\n\nIf Cells(i, \"F5\").Value &lt;&gt; \"\" Then\nRange(i, \"G\").Value = WorksheetFunction.VLookup(Cells(i, \"D\"), Range(\"N\").End(xlDown), 1, False)\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1443663510, "last_edit_date": 1443663510, "creation_date": 1443661597, "answer_id": 32877946, "question_id": 32876614, "link": "https://stackoverflow.com/questions/32876614/copy-dynamic-excel-range-to-word-as-figure/32877946#32877946", "title": "Copy dynamic Excel range to Word as figure", "body": "<p>To determine the last row with data in column A (not tested):</p>\n\n<pre><code>Sub copyword()\n   Dim objWord As Object, objDoc As Object, Rng As Object\n   Dim wb As Workbook, n As Integer, lr As Long\n\n   Set wb = ActiveWorkbook\n   On Error Resume Next 'see if Word is already open\n   Set objWord = GetObject(, \"Word.Application\")\n   On Error GoTo 0\n\n   If objWord Is Nothing Then   'not open - create a new instance and add a document\n       Set objWord = CreateObject(\"Word.Application\")\n       objWord.Visible = True\n       objWord.documents.Add\n   End If\n   Set objDoc = objWord.activedocument\n   Set Rng = objWord.Selection\n   With wb.Worksheets(2)\n\n      'determine last row *****************************************\n      lr = .Cells(\"A\" &amp; .UsedRange.Row + .UsedRange.Rows.Count).End(xlUp)\n\n      .Activate\n         ActiveWindow.View = xlNormalView\n         'use last row *********************************************************\n         .Range(\"A1:O\" &amp; lr).CopyPicture Appearance:=xlScreen, Format:=xlPicture\n         Rng.Paste\n         Rng.typeparagraph\n         ActiveWindow.View = xlPageBreakPreview\n      .Activate\n         ActiveWindow.View = xlNormalView\n         'use last row **********************************************************\n         .Range(\"U1:AI\" &amp; lr).CopyPicture Appearance:=xlScreen, Format:=xlPicture\n         Rng.Paste\n         Rng.typeparagraph\n         ActiveWindow.View = xlPageBreakPreview\n   End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 2292821, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f03e25bcdf0d1390d685190b276545c?s=128&d=identicon&r=PG", "display_name": "user2292821", "link": "https://stackoverflow.com/users/2292821/user2292821"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443667782, "creation_date": 1443652263, "last_edit_date": 1443667782, "question_id": 32876614, "link": "https://stackoverflow.com/questions/32876614/copy-dynamic-excel-range-to-word-as-figure", "title": "Copy dynamic Excel range to Word as figure", "body": "<p>I\u00b4m trying to copy as figures to a Word document an Excel dynamic range that changes from case to case. </p>\n\n<p>The first worksheet will be where the user will place the inputs. Than on the fourth worksheet some calculations for each row of the inputs will be performed. What i would like to do is to copy to an word document the content of the fourth worksheet until the last input row. The problem is that the last input row number will change form case to case.  </p>\n\n<p>Another difficulty is the fact that each Word page only has space for 45 lines so if the input goes beyond that number it would need to be splitt in multiples pages.</p>\n\n<p>I have code that works for a static range and I would like to change to also work with a dynamic range. </p>\n\n<pre><code>Sub copyword()\n   Dim objWord As Object, objDoc As Object, Rng As Object\n   Dim wb As Workbook\n   Dim n As Integer\n\n   Set wb = ActiveWorkbook\n\n   'see if Word is already open\n   On Error Resume Next\n   Set objWord = GetObject(, \"Word.Application\")\n   On Error GoTo 0\n\n   'not open - create a new instance and add a document\n   If objWord Is Nothing Then\n       Set objWord = CreateObject(\"Word.Application\")\n       objWord.Visible = True\n       objWord.documents.Add\n   End If\n\n   Set objDoc = objWord.activedocument\n   Set Rng = objWord.Selection\n\n   Worksheets(2).Activate\n   ActiveWindow.View = xlNormalView\n   wb.Worksheets(2).Range(\"A1:O47\").CopyPicture Appearance:=xlScreen, Format:=xlPicture\n   Rng.Paste\n   Rng.typeparagraph\n   ActiveWindow.View = xlPageBreakPreview\n\n   Worksheets(2).Activate\n   ActiveWindow.View = xlNormalView\n   wb.Worksheets(2).Range(\"U1:AI47\").CopyPicture Appearance:=xlScreen, Format:=xlPicture\n   Rng.Paste\n   Rng.typeparagraph\n   ActiveWindow.View = xlPageBreakPreview\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "userform", "groupname"], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 1, "last_activity_date": 1443652628, "creation_date": 1443652628, "answer_id": 32876664, "question_id": 32876396, "link": "https://stackoverflow.com/questions/32876396/vba-userform-checking-the-groupname-instead-of-an-individual-button/32876664#32876664", "title": "vba userform checking the GroupName instead of an individual button", "body": "<p>If I understood well, <code>GRonly</code> is the GroupBox that contains (let's say) the <code>radio_button_1</code> and <code>radio_button_2</code>. </p>\n\n<p>The reason why the code doesn't trigger is that when he/she changes the value of one radio-button is not clicking on the GroupBox, but rather changing the value of that single radio-button. </p>\n\n<p>You will have to add the code to the <code>_Change</code> event of the radio button objects. This is an example: </p>\n\n<pre><code>Sub myFunctionalCode()\n    'your code here\nEnd Sub\n\nPrivate Sub radio_button_1_Change()\n    myFunctionalCode\nEnd Sub\nPrivate Sub radio_button_2_Change()\n    myFunctionalCode\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 691, "user_id": 3138025, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TSLrq.jpg?s=128&g=1", "display_name": "user3138025", "link": "https://stackoverflow.com/users/3138025/user3138025"}, "is_accepted": false, "score": 0, "last_activity_date": 1443653411, "creation_date": 1443653411, "answer_id": 32876797, "question_id": 32876396, "link": "https://stackoverflow.com/questions/32876396/vba-userform-checking-the-groupname-instead-of-an-individual-button/32876797#32876797", "title": "vba userform checking the GroupName instead of an individual button", "body": "<p>Thanks for the reply.  That would work.</p>\n\n<p>In the meantime, I came up with another alternative as well.  I removed the code from:</p>\n\n<pre><code>Private Sub GROnly_yes_Click()\n</code></pre>\n\n<p>And I moved it to the button that the user clicks to submit the form:</p>\n\n<pre><code>Private Sub ContinueButton_Click()\n</code></pre>\n\n<p>In my original code I had to change <code>UserForm_Initialize</code> to <code>Exit Sub</code> to make the code work in the \"submit\" button.</p>\n\n<p>Thanks again for your help.\nPhil</p>\n"}], "owner": {"reputation": 691, "user_id": 3138025, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TSLrq.jpg?s=128&g=1", "display_name": "user3138025", "link": "https://stackoverflow.com/users/3138025/user3138025"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 677, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1443653411, "creation_date": 1443650909, "question_id": 32876396, "link": "https://stackoverflow.com/questions/32876396/vba-userform-checking-the-groupname-instead-of-an-individual-button", "title": "vba userform checking the GroupName instead of an individual button", "body": "<p>I'm using a VBA Userform.  The MassPrompt userform has a set of six GroupNames and some text boxes.  Each GroupName contains two or more radio buttons.<br>\nI'd like the following code to be triggered anytime any element within the GroupName \"GROnly\" changes.  If the user made an inappropriate button choice in \"GROnly\" based on the choice in another group, I'd like to display a warning message and present the MassPrompt userform again.<br>\nRight now, I've assigned the code to the one button \"GROnly_yes\".  It works, but only when that one button is clicked.  How do I position this within the UserForm code to trigger anytime a button with the GroupName \"GROnly\" is clicked?  Thanks for looking at this.</p>\n\n<pre><code>Private Sub GROnly_yes_Click()\n'Prompt if the GROnly is true and it's inappropriate for the GSetting choice\n  If GROnly_yes = True And GSetting_renewal = True _\n  Then\n    GROnly_yes = False\n    GROnly_no = True\n    MsgBox (\"The GROnly can't be chosen with a Renewal.\" &amp; vbNewLine &amp; _\n            \"The GROnly button has been changed to 'NO'.\")\n    UserForm_Initialize\n  End If\n  'Other IF statements here.\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1280, "user_id": 1716131, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d64185406d74353f4349a0855b608834?s=128&d=identicon&r=PG", "display_name": "Avishay Cohen", "link": "https://stackoverflow.com/users/1716131/avishay-cohen"}, "edited": false, "score": 0, "creation_date": 1443678993, "post_id": 32876134, "comment_id": 53591255, "body": "Hi, can&#39;t seem to replicate the error, how about instead of using <code>selection</code> try selecting an explicit range. It might happen because your expending the sheet but not updating your selection range"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5390010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Sto8XLrEp50/AAAAAAAAAAI/AAAAAAAAAVA/7RKe3dQDpb0/photo.jpg?sz=128", "display_name": "OcYriZ jImEneZ", "link": "https://stackoverflow.com/users/5390010/ocyriz-jimenez"}, "edited": false, "score": 0, "creation_date": 1443713603, "post_id": 32881794, "comment_id": 53612546, "body": "Rory Very good, U are the one... Great job thnks but I&#180;m starting up in this... and I change this excelWB.Saved = True for this one excelWB.Save and now I can safe the file, I finished my syste to safe information Very Help full..."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1443684541, "creation_date": 1443684541, "answer_id": 32881794, "question_id": 32876134, "link": "https://stackoverflow.com/questions/32876134/why-does-code-fail-on-second-run-but-not-first/32881794#32881794", "title": "Why does code fail on second run but not first?", "body": "<p>You have a lot of unqualified object references there which are likely causing your problem. I think you want:</p>\n\n<pre><code>Private Sub cmdingresar_Click()\n    Dim excelApp              As Excel.Application\n    Dim excelWB               As Excel.Workbook\n    Dim excelWS               As Excel.Worksheet\n\n    Set excelApp = CreateObject(\"Excel.Application\")\n    Set excelWB = excelApp.Workbooks.Open(\"C:\\Users\\vere\\Desktop\\carrera desarrollo\\visual 6\\sistema mascara mahe\\Cheques.xlsx\")\n\n    excelApp.Visible = False\n\n    A = txtcheque.Text\n    B = txtfechadeelaboracion.Text\n    C = txtfechadecobro.Text\n    E = txtfactura.Text\n    F = txtproveedor.Text\n    H = txtnumerodecuenta.Text\n    I = txtrfc.Text\n    L = txtdescripcion.Text\n    N = txtneto.Text\n    O = txtprecio.Text\n\n    Set excelWS = excelWB.ActiveSheet\n    With excelWS\n\n        .Cells(3, 1).EntireRow.Insert\n        .Cells(1 + 3, 1).Value = A\n        .Cells(1 + 3, 2).Value = B\n        .Cells(1 + 3, 3).Value = C\n        .Cells(1 + 3, 4).Value = D\n        .Cells(1 + 3, 5).Value = E\n        .Cells(1 + 3, 7).Value = F\n        .Cells(1 + 3, 8).Value = G\n        .Cells(1 + 3, 9).Value = H\n        .Cells(1 + 3, 10).Value = I\n        .Cells(1 + 3, 11).Value = J\n        .Cells(1 + 3, 12).Value = K\n        .Cells(1 + 3, 13).Value = L\n        .Cells(1 + 3, 14).Value = M\n        .Cells(1 + 3, 15).Value = N\n        .Cells(1 + 3, 16).Value = O\n    End With\n    ' if you want to save the file, this won't work!\n    excelWB.Saved = True\n    ' you need to use this\n    excelWB.Close savechanges:=True\n    Set excelWS = Nothing\n    Set excelWB = Nothing\n    excelApp.Quit\n    Set excelApp = Nothing\n    MsgBox \"Listo\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5390010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Sto8XLrEp50/AAAAAAAAAAI/AAAAAAAAAVA/7RKe3dQDpb0/photo.jpg?sz=128", "display_name": "OcYriZ jImEneZ", "link": "https://stackoverflow.com/users/5390010/ocyriz-jimenez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 32881794, "answer_count": 1, "score": 0, "last_activity_date": 1443684541, "creation_date": 1443649502, "last_edit_date": 1531164843, "question_id": 32876134, "link": "https://stackoverflow.com/questions/32876134/why-does-code-fail-on-second-run-but-not-first", "title": "Why does code fail on second run but not first?", "body": "<p>This code is working on first run, but when I try to run it again I get the following error:</p>\n\n<blockquote>\n  <p>Run-Time Error '91': Object variable or with block variable not set... </p>\n</blockquote>\n\n<pre><code>Private Sub cmdingresar_Click()\n  Dim excelApp As excel.Application\n  Dim excelWB As excel.Workbook\n  Dim excelWS As excel.Worksheet\n\n  Set excelApp = CreateObject(\"Excel.Application\")\n  Set excelWB = excelApp.Workbooks.Open(\"C:\\Users\\vere\\Desktop\\carrera desarrollo\\visual 6\\sistema mascara mahe\\Cheques.xlsx\")\n\n  excelApp.Visible = False\n\n  A = txtcheque.Text\n  B = txtfechadeelaboracion.Text\n  C = txtfechadecobro.Text\n  E = txtfactura.Text\n  F = txtproveedor.Text\n  H = txtnumerodecuenta.Text\n  I = txtrfc.Text\n  L = txtdescripcion.Text\n  N = txtneto.Text\n  O = txtprecio.Text\n\n  Selection.EntireRow.Insert ' Here is where appers the error when I try to do the second run\n  ActiveSheet.Cells(3, 1).Select\n  ActiveSheet.Cells(1 + 3, 1) = A\n  ActiveSheet.Cells(1 + 3, 2) = B\n  ActiveSheet.Cells(1 + 3, 3) = C\n  ActiveSheet.Cells(1 + 3, 4) = D\n  ActiveSheet.Cells(1 + 3, 5) = E\n  ActiveSheet.Cells(1 + 3, 7) = F\n  ActiveSheet.Cells(1 + 3, 8) = G\n  ActiveSheet.Cells(1 + 3, 9) = H\n  ActiveSheet.Cells(1 + 3, 10) = I\n  ActiveSheet.Cells(1 + 3, 11) = J\n  ActiveSheet.Cells(1 + 3, 12) = K\n  ActiveSheet.Cells(1 + 3, 13) = L\n  ActiveSheet.Cells(1 + 3, 14) = M\n  ActiveSheet.Cells(1 + 3, 15) = N\n  ActiveSheet.Cells(1 + 3, 16) = O\n  excelWB.Saved = True\n  Set excelWS = Nothing\n  Set excelWB = Nothing\n  excelApp.Quit\n  Set excelApp = Nothing\n  MsgBox \"Listo\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "overflow", "average"], "comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1443650306, "post_id": 32876108, "comment_id": 53583936, "body": "What types of numbers do you have - all whole numbers, some real numbers (1.051...) and do you only want a whole number as your answer?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1443650368, "post_id": 32876108, "comment_id": 53583960, "body": "Are you really only summing whole numbers between   \u221232,768 and 32,767? What are the values of <code>sum</code> and <code>count</code> when you hover over them in debug mode?"}, {"owner": {"reputation": 337, "user_id": 3068177, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/eac437f92e28d9896250a3d7b9b76d42?s=128&d=identicon&r=PG&f=1", "display_name": "user3068177", "link": "https://stackoverflow.com/users/3068177/user3068177"}, "edited": false, "score": 0, "creation_date": 1443650891, "post_id": 32876108, "comment_id": 53584138, "body": "Chips - I have both whole numbers and real numbers and I would like to keep them a real numbers"}, {"owner": {"reputation": 337, "user_id": 3068177, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/eac437f92e28d9896250a3d7b9b76d42?s=128&d=identicon&r=PG&f=1", "display_name": "user3068177", "link": "https://stackoverflow.com/users/3068177/user3068177"}, "edited": false, "score": 0, "creation_date": 1443650932, "post_id": 32876108, "comment_id": 53584161, "body": "Jeeped - When I enter debug mode, the sum and count inside the loop are both 0&#39;s"}, {"owner": {"reputation": 337, "user_id": 3068177, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/eac437f92e28d9896250a3d7b9b76d42?s=128&d=identicon&r=PG&f=1", "display_name": "user3068177", "link": "https://stackoverflow.com/users/3068177/user3068177"}, "edited": false, "score": 0, "creation_date": 1443651387, "post_id": 32876108, "comment_id": 53584310, "body": "I did try changing the count variable to a double, but received the same overflow error."}, {"owner": {"reputation": 337, "user_id": 3068177, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/eac437f92e28d9896250a3d7b9b76d42?s=128&d=identicon&r=PG&f=1", "display_name": "user3068177", "link": "https://stackoverflow.com/users/3068177/user3068177"}, "edited": false, "score": 0, "creation_date": 1443653098, "post_id": 32876108, "comment_id": 53584784, "body": "It is possible that it does, therefore it would be outside the range of an int, but I don&#39;t know how else to go about it. Converting the variables to a long and a double did not solve the problem"}, {"owner": {"reputation": 337, "user_id": 3068177, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/eac437f92e28d9896250a3d7b9b76d42?s=128&d=identicon&r=PG&f=1", "display_name": "user3068177", "link": "https://stackoverflow.com/users/3068177/user3068177"}, "edited": false, "score": 0, "creation_date": 1443654355, "post_id": 32876108, "comment_id": 53585186, "body": "So setting sum and count to 0 outside the for loop?"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1443654880, "creation_date": 1443654880, "answer_id": 32877014, "question_id": 32876108, "link": "https://stackoverflow.com/questions/32876108/finding-the-average-of-a-column-in-vba/32877014#32877014", "title": "Finding the Average of a Column in VBA", "body": "<p>Here is an alternate way to get the average of all the cells in the last column of a worksheet, excluding the first row:</p>\n\n<pre><code>Sub Luxation()\n   Dim lastCol As Long, rng As Range\n   lastCol = ActiveSheet.UsedRange.Columns(ActiveSheet.UsedRange.Columns.Count).Column\n   Set rng = Range(Cells(2, lastCol), Cells(Rows.Count, lastCol))\n   MsgBox Application.WorksheetFunction.Average(rng)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 337, "user_id": 3068177, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/eac437f92e28d9896250a3d7b9b76d42?s=128&d=identicon&r=PG&f=1", "display_name": "user3068177", "link": "https://stackoverflow.com/users/3068177/user3068177"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1925, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443654880, "creation_date": 1443649422, "question_id": 32876108, "link": "https://stackoverflow.com/questions/32876108/finding-the-average-of-a-column-in-vba", "title": "Finding the Average of a Column in VBA", "body": "<p>I am attempting to find the average for all of the numbers in a given column. </p>\n\n<pre><code>'Find the Average\n\nDim count As Integer\nDim sum As Integer\nDim lastCol As Integer\nDim c As Integer\nDim num As Long\nlastCol = ActiveSheet.UsedRange.Columns(ActiveSheet.UsedRange.Columns.count).Column\nFor c = 2 To lastCol\n   sum = 0\n   count = 0\nActiveSheet.Cells(2, c).Select\n    Do While ActiveCell.Value &lt;&gt; \"\"\n        sum = sum + ActiveCell.Value\n        count = count + 1\n        ActiveCell.Offset(1, 0).Activate\n    Loop\n    'num = sum / count\n    ActiveCell.Value = sum / count\n    'ActiveCell.Value = num\n</code></pre>\n\n<p>When I try and run this, I receive an overflow error for the line</p>\n\n<pre><code> ActiveCell.Value = sum / count\n</code></pre>\n\n<p>I have tried many different ways to get around this problem. One solution I tried was using an intermediate long variable \"num\" in this case to pass the value. That attempt at a solution is commented out above. Another solution I tried was using CLng() to typecast the variables into a long. Both of these solutions still produced the same overflow error. Does anyone have any idea as to how to fix this problem?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1443647756, "post_id": 32875724, "comment_id": 53582855, "body": "What is <code>Source</code>?  Should it be <code>src</code>?"}, {"owner": {"reputation": 2805, "user_id": 864414, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2188a4ca54a65d0f77ed573329fd5dd1?s=128&d=identicon&r=PG", "display_name": "transistor1", "link": "https://stackoverflow.com/users/864414/transistor1"}, "edited": false, "score": 0, "creation_date": 1443648336, "post_id": 32875724, "comment_id": 53583104, "body": "What line is the error happening on?"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "edited": false, "score": 0, "creation_date": 1443648046, "post_id": 32875791, "comment_id": 53582993, "body": "thanks i tried it works but it doesn&#39;t respect the condition it copies all the lines , i need only for those who has  (&quot;Completed - Appointment made / Compl&#233;t&#233; - Nomination faite&quot;)"}], "tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": false, "score": 0, "last_activity_date": 1443647829, "creation_date": 1443647829, "answer_id": 32875791, "question_id": 32875724, "link": "https://stackoverflow.com/questions/32875724/how-can-i-resolve-an-object-required-error/32875791#32875791", "title": "how can i resolve an object required error", "body": "<p>You use <code>Source</code> instead of <code>src</code></p>\n\n<pre><code> If Source.Cells(i, 31).Value = \"Completed - Appointment made / Compl\u00e9t\u00e9...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 377, "user_id": 564588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a2b42b1ecc453876137905791fcff3?s=128&d=identicon&r=PG", "display_name": "Jason K.", "link": "https://stackoverflow.com/users/564588/jason-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1443649420, "creation_date": 1443649420, "answer_id": 32876107, "question_id": 32875724, "link": "https://stackoverflow.com/questions/32875724/how-can-i-resolve-an-object-required-error/32876107#32876107", "title": "how can i resolve an object required error", "body": "<p>Salut, veuyer verifier que \"Source\", should not be the sheet \"src\".</p>\n\n<p>I'm also guessing you're trying to copy just one row at a time,</p>\n\n<ul>\n<li><code>Range(\"A\" &amp; i &amp; \":AL\" &amp; i) which is \"A2:AL2\" rather than</code></li>\n<li><code>Range(\"A\" &amp; i &amp; \":AL\" &amp; i + 50)  is \"A2:AL52\"</code></li>\n</ul>\n\n<p>Also check that cells(y,31) is intended to be \"AE\", which is before AL (column 38).</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1443649879, "creation_date": 1443649879, "answer_id": 32876208, "question_id": 32875724, "link": "https://stackoverflow.com/questions/32875724/how-can-i-resolve-an-object-required-error/32876208#32876208", "title": "how can i resolve an object required error", "body": "<p>There are a few problems, <code>Source</code> should not be <code>src</code> it should be <code>ws1</code>.  <code>src.cells(i ...)</code> will go to the i row after the row src is already referencing.  If i is 50 then it will get the result from row 100.</p>\n\n<p>Also I belive you only want one row copied at a time instead of 50 rows.</p>\n\n<pre><code> Sub copier()\n    Dim ws1 As Worksheet, ws2 As Worksheet, src As Range, dest As Range, i As Integer\n\n    Set ws1 = Worksheets(\"Workload - Charge de travail\")\n    Set ws2 = Worksheets(\"Sheet1\")\n\n    For i = 2 To ws1.Range(\"A1\").SpecialCells(xlLastCell).Row\n\n        Set src = ws1.Range(\"A\" &amp; i &amp; \":AL\" &amp; i)\n        Set dest = ws2.Range(\"A\" &amp; i &amp; \":AL\" &amp; i)\n\n         If ws1.Cells(i, 31).value = \"Completed - Appointment made / Compl\u00e9t\u00e9 - Nomination faite\" Then\n\n           '(i,31) this is  for my drop down list's condition\n\n\n           src.Copy Destination:=dest\n           'dest.value = dest.value\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1443649879, "creation_date": 1443647555, "last_edit_date": 1531164843, "question_id": 32875724, "link": "https://stackoverflow.com/questions/32875724/how-can-i-resolve-an-object-required-error", "title": "how can i resolve an object required error", "body": "<p>i'm working on a macro that helps me to copy data from one worksheet to another in Excel with on  conditions. I tried the following code but i got an object required error </p>\n\n<p>Any help is appreciated </p>\n\n<pre><code>Sub copier()\n   Dim ws1 As Worksheet, ws2 As Worksheet, src As Range, dest As Range, i As Integer\n\n   Set ws1 = Worksheets(\"Workload - Charge de travail\")\n   Set ws2 = Worksheets(\"Sheet1\")\n\n   For i = 2 To ws1.Range(\"A1\").SpecialCells(xlLastCell).Row        \n\n       Set src = ws1.Range(\"A\" &amp; i &amp; \":AL\" &amp; i + 50)\n       Set dest = ws2.Range(\"A\" &amp; i &amp; \":AL\" &amp; i + 50)\n\n        If Source.Cells(i, 31).Value = \"Completed - Appointment made / Compl\u00e9t\u00e9 - Nomination faite\" Then\n\n          '(i,31) this is  for my drop down list's condition\n\n\n          src.Copy Destination:=dest\n          dest.Value = dest.Value\n       End If\n   Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powershell", "charts"], "answers": [{"tags": [], "owner": {"reputation": 30007, "user_id": 3245749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYDwR.jpg?s=128&g=1", "display_name": "TheMadTechnician", "link": "https://stackoverflow.com/users/3245749/themadtechnician"}, "is_accepted": false, "score": 0, "last_activity_date": 1443655599, "creation_date": 1443655599, "answer_id": 32877123, "question_id": 32875588, "link": "https://stackoverflow.com/questions/32875588/powershell-excel-chart-obtain-data-series-from-existing-chart/32877123#32877123", "title": "Powershell Excel Chart - obtain data series from existing chart", "body": "<p>The property that you're looking for is either the <code>Formula</code> or <code>FormulaLocal</code> property. They appear to be duplicates of each other. If updating one doesn't work, try the other, or just set both.</p>\n\n<pre><code>$ChartTemplate.SeriesCollection(1).Formula = '=SERIES(Template!$G$1,Template!$A$2:$A$112,Template!$G$2:$G$112,4)'\n$ChartTemplate.SeriesCollection(1).FormulaLocal = '=SERIES(Template!$G$1,Template!$A$2:$A$112,Template!$G$2:$G$112,4)'\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5394737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0b6090ff39986005662ae18797af9ff?s=128&d=identicon&r=PG&f=1", "display_name": "C-Rod", "link": "https://stackoverflow.com/users/5394737/c-rod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 865, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443655599, "creation_date": 1443647007, "last_edit_date": 1443650794, "question_id": 32875588, "link": "https://stackoverflow.com/questions/32875588/powershell-excel-chart-obtain-data-series-from-existing-chart", "title": "Powershell Excel Chart - obtain data series from existing chart", "body": "<p>I have a Powershell script that copies a worksheet (with a custom dual axis chart) from one workbook to another workbook and then populates the new copy with data. That portion of the script works fine but I am trying to change the data series in the existing chart and I do not know the fields to change the data series.</p>\n\n<p>I can change the chart title and the legend labels of the existing chart with no issues. I have tried the <code>$ChartTemplate.SeriesCollection(1).Values</code> field and the <code>$ChartTemplate.SeriesCollection(1).XValues</code> with and with out the <code>$ChartTemplate.SeriesCollection().NewSeries.Invoke()</code> command and I have had no success.</p>\n\n<p>Does anyone know the Powershell syntax to edit an existing data series of a custom dual axis line chart (<code>=SERIES(Template!$G$1,Template!$A$2:$A$112,Template!$G$2:$G$112,4</code>) ?</p>\n\n<p>The following is my Powershell code which I have obtained from googling:</p>\n\n<pre><code>$file1 = $global:ChartTemplateXlsx    # source's fullpath\n$file2 = $Path                        # destination's fullpath\n$xl = new-object -c excel.application \n$xl.Visible = $False                  # dont display the spreadsheet\n$xl.displayAlerts = $false            # don't prompt the user\n$wb1 = $xl.workbooks.open($file1, $null, $true)   # open source, readonly\n$wb = $xl.workbooks.open($file2)      # open target workbook/worksheet\n$sh1_wb = $wb.sheets.item(1)          # 1st sheet in destination workbook\n$sheetToCopy = $wb1.sheets.item('Template')   # source sheet to copy\n$sheetToCopy.copy($sh1_wb)   # copy source sheet to destination workbook\n\n$ws = $wb.ActiveSheet                        # set the worksheet\n\n$ChartTemplate = $ws.chartobjects(1).chart   # obtain the existing chart\n$ChartTemplate.HasTitle = $true              # turn on chart title\n$ChartTemplate.ChartTitle.Text = \"Test Chart\" # set a new chart title\n\n$ChartTemplate.SeriesCollection(1).Name = \"=\"\"Test01\"\"\"\n$ChartTemplate.SeriesCollection(2).Name = \"=\"\"Test02\"\"\"\n$ChartTemplate.SeriesCollection(3).Name = \"=\"\"Test03\"\"\"\n$ChartTemplate.SeriesCollection(4).Name = \"=\"\"Test04\"\"\"\n\n$wb1.close($false)               # close source workbook w/o saving\n$wb.close($true)                 # close and save destination workbook\n$xl.quit()\nspps -n excel\n</code></pre>\n\n<p>By the way, I am using a separate workbook with the chart so that users can create their own chart templates and then I will populate it with data.</p>\n"}, {"tags": ["excel", "vba", "popupmenu"], "comments": [{"owner": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "edited": false, "score": 0, "creation_date": 1443646817, "post_id": 32875245, "comment_id": 53582452, "body": "Shiva  - Thanks for the edit. I was just doing the amendments you spotted (already noticed them) and you beat me to the punch. ^_^"}, {"owner": {"reputation": 377, "user_id": 564588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a2b42b1ecc453876137905791fcff3?s=128&d=identicon&r=PG", "display_name": "Jason K.", "link": "https://stackoverflow.com/users/564588/jason-k"}, "edited": false, "score": 0, "creation_date": 1443651619, "post_id": 32875245, "comment_id": 53584387, "body": "Hi Neo, you don&#39;t appear to be displaying your menu bar (at least for Excel 2007+ you need to edit the ribbon). Are you using Excel 2000 /03?"}], "answers": [{"tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": true, "score": 2, "last_activity_date": 1443646838, "creation_date": 1443646838, "answer_id": 32875540, "question_id": 32875245, "link": "https://stackoverflow.com/questions/32875245/how-to-add-hyperlinks-to-pop-up-menu-in-visual-basic/32875540#32875540", "title": "How To Add Hyperlinks To Pop up menu in Visual Basic?", "body": "<p>You can put</p>\n\n<pre><code>ThisWorkbook.FollowHyperlink \"http://......\"\n</code></pre>\n\n<p>In your TestMacro</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "edited": false, "score": 0, "creation_date": 1443712006, "post_id": 32875608, "comment_id": 53611507, "body": "Awesome. I never thought of doing it this way.  I have figured out adding another menu that appears from the context menu. It&#39;s in the code section.  &#39; Next, add a menu that contains two buttons.is it possible to add a third and fourth menu beffore the buttons?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1443647079, "creation_date": 1443647079, "answer_id": 32875608, "question_id": 32875245, "link": "https://stackoverflow.com/questions/32875245/how-to-add-hyperlinks-to-pop-up-menu-in-visual-basic/32875608#32875608", "title": "How To Add Hyperlinks To Pop up menu in Visual Basic?", "body": "<p>If you are going to use this as a method of launching hyperlinks, add a parameter to the <code>Testmacro</code> sub procedure.</p>\n\n<pre><code>.OnAction = \"'\" &amp; ThisWorkbook.Name &amp; \"'!\" &amp; \"TestMacro(1)\"\n...\n.OnAction = \"'\" &amp; ThisWorkbook.Name &amp; \"'!\" &amp; \"TestMacro(2)\"\n...\n.OnAction = \"'\" &amp; ThisWorkbook.Name &amp; \"'!\" &amp; \"TestMacro(3)\"\n</code></pre>\n\n<p>The actual <code>TestMacro</code> sub would institute a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278665.aspx\" rel=\"nofollow\">Select Case statement</a> to handle all of the menu commands.</p>\n\n<pre><code>Sub TestMacro(Optional iTYP As Long = 1)\n    Select Case iTYP\n        Case 1\n            MsgBox \"option 1\"\n            ActiveWorkbook.FollowHyperlink \"http://www.google.com\"\n        Case 2\n            MsgBox \"option 2\"\n            ActiveWorkbook.FollowHyperlink \"http://www.yahoo.com\"\n        Case 3\n            MsgBox \"option 3\"\n            ActiveWorkbook.FollowHyperlink \"http://www.bing.com\"\n        Case Else\n            ActiveWorkbook.FollowHyperlink \"http://stackoverflow.com\"\n    End Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 1, "last_activity_date": 1443647266, "creation_date": 1443647266, "answer_id": 32875659, "question_id": 32875245, "link": "https://stackoverflow.com/questions/32875245/how-to-add-hyperlinks-to-pop-up-menu-in-visual-basic/32875659#32875659", "title": "How To Add Hyperlinks To Pop up menu in Visual Basic?", "body": "<p>as with Bas answer you can set your TestMacro to have an input string for the url and then pass that when calling it</p>\n\n<pre><code>' Finally, add a single button.\n    With .Controls.Add(Type:=msoControlButton)\n        .Caption = \"Button 3\"\n        .FaceId = 73\n        .OnAction = \"'\" &amp; ThisWorkbook.Name &amp; \"'!\" &amp; \"TestMacro(\" &amp; Chr(34) &amp; \"http://www.google.com\" &amp; Chr(34) &amp; \")\"\n    End With\n\n\n\nSub TestMacro(url As String)\n    ThisWorkbook.FollowHyperlink url\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 759, "favorite_count": 0, "accepted_answer_id": 32875540, "answer_count": 3, "score": 0, "last_activity_date": 1443647266, "creation_date": 1443645679, "last_edit_date": 1443645984, "question_id": 32875245, "link": "https://stackoverflow.com/questions/32875245/how-to-add-hyperlinks-to-pop-up-menu-in-visual-basic", "title": "How To Add Hyperlinks To Pop up menu in Visual Basic?", "body": "<p>How do I make one of the menu items open a hyperlink?</p>\n\n<p>For example say Button 1 when selected in the menu opens \"<a href=\"http://www.google.com\" rel=\"nofollow\">www.google.com</a>\" and Button 2 opens \"<a href=\"http://www.yahoo.com\" rel=\"nofollow\">www.yahoo.com</a>\" instead of test Macro. I tried changing the <code>.OnAction</code> to <code>.FollowHyperlink</code>. </p>\n\n<p>I even tried just entering the hyperlink in the <code>.OnAction</code> section with no luck.</p>\n\n<p>Any advice?</p>\n\n<pre><code>Option Explicit\n\nPublic Const Mname As String = \"MyPopUpMenu\"\n\nSub DeletePopUpMenu()\n    ' Delete the popup menu if it already exists.\n    On Error Resume Next\n    Application.CommandBars(Mname).Delete\n    On Error GoTo 0\nEnd Sub\n\nSub CreateDisplayPopUpMenu()\n    ' Delete any existing popup menu.\n    Call DeletePopUpMenu\n\n    ' Create the popup menu.\n    Call Custom_PopUpMenu_1\n\n    ' Display the popup menu.\n    On Error Resume Next\n    Application.CommandBars(Mname).ShowPopup\n    On Error GoTo 0\nEnd Sub\n\nSub Custom_PopUpMenu_1()\n    Dim MenuItem As CommandBarPopup\n    ' Add the popup menu.\n    With Application.CommandBars.Add(Name:=Mname, Position:=msoBarPopup, _\n         MenuBar:=False, Temporary:=True)\n\n        ' First, add two buttons to the menu.\n        With .Controls.Add(Type:=msoControlButton)\n            .Caption = \"Button 1\"\n            .FaceId = 71\n            .OnAction = \"'\" &amp; ThisWorkbook.Name &amp; \"'!\" &amp; \"TestMacro\"\n        End With\n\n        With .Controls.Add(Type:=msoControlButton)\n            .Caption = \"Button 2\"\n            .FaceId = 72\n            .OnAction = \"'\" &amp; ThisWorkbook.Name &amp; \"'!\" &amp; \"TestMacro\"\n        End With\n\n        ' Next, add a menu that contains two buttons.\n        Set MenuItem = .Controls.Add(Type:=msoControlPopup)\n        With MenuItem\n            .Caption = \"My Special Menu\"\n\n            With .Controls.Add(Type:=msoControlButton)\n                .Caption = \"Button 1 in menu\"\n                .FaceId = 71\n                .OnAction = \"'\" &amp; ThisWorkbook.Name &amp; \"'!\" &amp; \"TestMacro\"\n            End With\n\n            With .Controls.Add(Type:=msoControlButton)\n                .Caption = \"Button 2 in menu\"\n                .FaceId = 72\n                .OnAction = \"'\" &amp; ThisWorkbook.Name &amp; \"'!\" &amp; \"TestMacro\"\n            End With\n        End With\n\n        ' Finally, add a single button.\n        With .Controls.Add(Type:=msoControlButton)\n            .Caption = \"Button 3\"\n            .FaceId = 73\n            .OnAction = \"'\" &amp; ThisWorkbook.Name &amp; \"'!\" &amp; \"TestMacro\"\n        End With\n\n    End With\nEnd Sub\n\nSub TestMacro()\n    MsgBox \"Hi there!\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1443645327, "creation_date": 1443645327, "answer_id": 32875151, "question_id": 32874862, "link": "https://stackoverflow.com/questions/32874862/copy-multiples-excel-ranges-with-vba-to-word-as-figures/32875151#32875151", "title": "Copy Multiples Excel Ranges with VBA to Word as figures", "body": "<p>Tested (changed the ranges for my testing):</p>\n\n<pre><code>Sub imagem1()\n\n    Dim objWord As Object, objDoc As Object, Rng As Object\n    Dim wb As Workbook\n\n    Set wb = ActiveWorkbook\n\n    'see if Word is already open\n    On Error Resume Next\n    Set objWord = GetObject(, \"Word.Application\")\n    On Error GoTo 0\n\n    'not open - create a new instance and add a document\n    If objWord Is Nothing Then\n        Set objWord = CreateObject(\"Word.Application\")\n        objWord.Visible = True\n        objWord.documents.Add\n    End If\n\n    Set objDoc = objWord.activedocument\n    Set Rng = objWord.Selection\n\n    wb.Windows(1).View = xlNormalView\n\n    wb.Worksheets(1).Range(\"A1:C5\").CopyPicture Appearance:=xlScreen, Format:=xlPicture\n    Rng.Paste\n    Rng.typeparagraph\n\n    wb.Worksheets(1).Range(\"A7:C12\").CopyPicture Appearance:=xlScreen, Format:=xlPicture\n    Rng.Paste\n    Rng.typeparagraph\n\n    wb.Worksheets(1).Range(\"A14:C19\").CopyPicture Appearance:=xlScreen, Format:=xlPicture\n    Rng.Paste\n    Rng.typeparagraph\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 2292821, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f03e25bcdf0d1390d685190b276545c?s=128&d=identicon&r=PG", "display_name": "user2292821", "link": "https://stackoverflow.com/users/2292821/user2292821"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 32875151, "answer_count": 1, "score": 0, "last_activity_date": 1443646496, "creation_date": 1443644281, "last_edit_date": 1443646496, "question_id": 32874862, "link": "https://stackoverflow.com/questions/32874862/copy-multiples-excel-ranges-with-vba-to-word-as-figures", "title": "Copy Multiples Excel Ranges with VBA to Word as figures", "body": "<p>Hi all i\u00b4m very new to VBA i\u00b4m struggling with a macro i\u00b4m trying to create. I want to copy paste as figures to a word file multiples ranges from Excel.</p>\n\n<p>This is the code i\u00b4ve come up with:</p>\n\n<pre><code>Sub imagem1()\n    Dim objWord, objDoc As Object\n    ActiveWindow.View = xlNormalView\n    Worksheets(2).Range(\"A1:O47\").Select\n    Selection.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n    Set objWord = CreateObject(\"Word.Application\")\n    Set objDoc = objWord.Documents.Add\n    objWord.Visible = True\n    objWord.Selection.Paste\n    objWord.Selection.TypeParagraph\n    ActiveWindow.View = xlPageBreakPreview\n\nEnd Sub\n\nSub imagem2()\n    Dim objWord, objDoc As Object\n    ActiveWindow.View = xlNormalView\n    Worksheets(2).Range(\"U1:AI47\").Select\n    Selection.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n    Set objWord = CreateObject(\"Word.Application\")\n    Set objDoc = objWord.Documents.Add\n    objWord.Visible = True\n    objWord.Selection.Paste\n    objWord.Selection.TypeParagraph\n    ActiveWindow.View = xlPageBreakPreview\nEnd Sub\n\nSub imagem3()\n    Dim objWord, objDoc As Object\n    Worksheets(4).Activate\n    ActiveWindow.View = xlNormalView\n    Worksheets(4).Range(\"A1:Q47\").Select\n    Selection.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n    Set objWord = CreateObject(\"Word.Application\")\n    Set objDoc = objWord.Documents.Add\n    objWord.Visible = True\n    objWord.Selection.Paste\n    objWord.Selection.TypeParagraph\n    ActiveWindow.View = xlPageBreakPreview\nEnd Sub\n</code></pre>\n\n<p>The problem i\u00b4m having is that it will create three different word files with one image each. I would like to know how can i code it so it will paste the 3 images to the same word file. </p>\n\n<p>I would also like to make it not creating a new word file every time i used the macro but instead copy the 3 images to an already opened word file where the cursor is.</p>\n\n<p>Thanks a lot for the help. </p>\n"}, {"tags": ["html", "forms", "vba", "excel", "internet-explorer-11"], "comments": [{"owner": {"reputation": 118524, "user_id": 3146, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/acc637690f49e2b5a2146deb17874d6f?s=128&d=identicon&r=PG", "display_name": "1800 INFORMATION", "link": "https://stackoverflow.com/users/3146/1800-information"}, "edited": false, "score": 0, "creation_date": 1443644716, "post_id": 32874819, "comment_id": 53581421, "body": "Hello and welcome to StackOverflow! I recommend you should edit your question to include an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> - this will help others to understand your problem and to help you arrive at a solution. It looks like the problem you are trying to resolve is somewhat complex and involves a number of moving parts. Also, it is not entirely clear what your actual issue is. It might be also helpful to review <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>."}, {"owner": {"reputation": 2805, "user_id": 864414, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2188a4ca54a65d0f77ed573329fd5dd1?s=128&d=identicon&r=PG", "display_name": "transistor1", "link": "https://stackoverflow.com/users/864414/transistor1"}, "edited": false, "score": 0, "creation_date": 1443645991, "post_id": 32874819, "comment_id": 53582039, "body": "Could IE be using AutoFill? Try disabling it."}], "owner": {"reputation": 21, "user_id": 2686269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e662d78d61862d18e164f7891fce517d?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dolan", "link": "https://stackoverflow.com/users/2686269/kevin-dolan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1443649839, "creation_date": 1443644134, "last_edit_date": 1443649839, "question_id": 32874819, "link": "https://stackoverflow.com/questions/32874819/form-submitting-with-onload-input-values-instead-of-user-inputted-values-when-au", "title": "form submitting with onLoad input values instead of user inputted values when automated with VBA", "body": "<p>Main Issue: When I submit a form using vba, the form's inputs' values change unexpectedly. I'm looking to see if there's an issue I don't know of with document.forms().submit in vba that might be related?</p>\n\n<p>Code first, explanation follows:</p>\n\n<pre><code>htmlwindow.Document.getElementById(\"ReportNum_DropDownList\").selectedIndex = 15\nhtmlwindow.Document.getElementById(\"ToMMYY_TextBox\").Value = QtrMo &amp; \"/\" &amp; QtrYr\nhtmlwindow.Document.getElementById(\"FromMMYY_TextBox\").Value = QtrMo_min2 &amp; \"/\" &amp; QtrYr\nhtmlwindow.Document.getElementById(\"ReportCols_DropDownList\").selectedIndex = 2\nhtmlwindow.Document.getElementById(\"__EVENTTARGET\").Value = \"Display\"\nhtmlwindow.Document.forms(\"Form1\").submit\n</code></pre>\n\n<p>Using vba in excel I open IE, navigate to a login page and login, then arrive at \"Reports\" page which has \"Form1\", which has several  elements.</p>\n\n<p>When the Reports page loads, all of Form1's inputs have pre-loaded values from the last time I used the website.  For instance input \"FromMMYY_TextBox\" is a text box that already reads \"08/15\" when the Reports page loads.  I have several lines of code that update the inputs, including \"FromMMYY_TextBox\".  Then I submit the form, and when it submits, it ignores the new values in the inputs and uses the pre-loaded values that populated the inputs upon originally loading the page.  So if I made \"FromMMYY_TextBox\".Value = \"09/15\", it submits as \"08/15\" for some reason.</p>\n\n<p>There is no \"on_submit\" in the  element.  I also tried to clear history/cookies/form submissions/passwords/etc from IE and do this, but when the Reports page loads, the inputs are still pre-populated.  When I use \".click\" on Form1's submit button, I have a more \"intense\" problem so that's ruled out as an option I think.</p>\n\n<p>Is there anything strange about document.forms().submit that might cause this?  Or should I try to see if I'm tripping some kind of validation code?  I'm lost on what could cause this.</p>\n\n<p>Edit: When I use \".click\" on the Form's submit button, the form submits with the correct input values, but it will not display in the browser like it should. Instead it attempts to download the table as an excel file, which I do not want.</p>\n\n<p>Edit2: I turned off auto-complete in IE and it did not help.</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5394787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84292cb2059da6c4d72015f602758b8c?s=128&d=identicon&r=PG&f=1", "display_name": "LifesGood", "link": "https://stackoverflow.com/users/5394787/lifesgood"}, "edited": false, "score": 0, "creation_date": 1443731024, "post_id": 32877293, "comment_id": 53621745, "body": "I mean, I&#39;ve already stated that it is because of what you just said. My question is precisely HOW to, as you say, handle it without changing the table itself.  The reason I want to do this is because I&#39;m trying to automatically generate a chart that shows agents&#39; counts of PRD, both CT1, IB, CT2, and OB, whether they necessarily have tickets that fit those criteria or not. There should be a way to do this, I don&#39;t understand why it would return an error rather than just a 0 for an empty column and full row field."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 1, "user_id": 5394787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84292cb2059da6c4d72015f602758b8c?s=128&d=identicon&r=PG&f=1", "display_name": "LifesGood", "link": "https://stackoverflow.com/users/5394787/lifesgood"}, "edited": false, "score": 0, "creation_date": 1443747348, "post_id": 32877293, "comment_id": 53626844, "body": "Can&#39;t you just create a PivotChart that directly shows this, using no VBA whatsoever? Iterating through the PivotItems collection in order to get information about a data field is a very indirect way of doing whatever it is you&#39;re doing. If you&#39;re doing this because you want seperate charts for each agent, then you should check out the Show Report Filter Pages functionality, which produces seperate reports for each of the items in a particular field. See <a href=\"http://www.contextures.com/Excel-Pivot-Table-Report-Filters.html\" rel=\"nofollow noreferrer\">contextures.com/Excel-Pivot-Table-Report-Filters.html</a>"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 1, "user_id": 5394787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84292cb2059da6c4d72015f602758b8c?s=128&d=identicon&r=PG&f=1", "display_name": "LifesGood", "link": "https://stackoverflow.com/users/5394787/lifesgood"}, "edited": false, "score": 0, "creation_date": 1443747797, "post_id": 32877293, "comment_id": 53626970, "body": "Re your comment &quot; I don&#39;t understand why it would return an error rather than just a 0 for an empty column and full row field&quot;...that&#39;s because the  PivotTable simply does not have a value for the combination that you&#39;re asking for. It would be bad programming on MS&#39;s behalf if it returned a zero (which is a number) when there was actually no such combination."}, {"owner": {"reputation": 1, "user_id": 5394787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84292cb2059da6c4d72015f602758b8c?s=128&d=identicon&r=PG&f=1", "display_name": "LifesGood", "link": "https://stackoverflow.com/users/5394787/lifesgood"}, "edited": false, "score": 0, "creation_date": 1443814827, "post_id": 32877293, "comment_id": 53657137, "body": "By &quot;chart&quot; I didn&#39;t mean visualization such as a PivotChart; I just meant an arrangement of the same numbers in a different format. I need to keep doing this for work and I&#39;m trying to automate it, hence the use of VBA. As for &quot;the PivotTable simply does not have that value and it would be bad programming to return any value,&quot; you&#39;re incorrect, as this screenshot (<a href=\"http://i62.tinypic.com/16i9pn8.png\" rel=\"nofollow noreferrer\">i62.tinypic.com/16i9pn8.png</a>) of the same GETPIVOTDATA operation shows outside of the VBA editor context."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 1, "user_id": 5394787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84292cb2059da6c4d72015f602758b8c?s=128&d=identicon&r=PG&f=1", "display_name": "LifesGood", "link": "https://stackoverflow.com/users/5394787/lifesgood"}, "edited": false, "score": 0, "creation_date": 1443911008, "post_id": 32877293, "comment_id": 53682355, "body": "Can&#39;t you just use the worksheet function GETPIVOTDATA to give you an arrangement of the same numbers in a different format? Can you elaborate why you need VBA?   No I&#39;m not incorrect about the error. Rather, you have not understood me. Your code iterates through each Agent and asks for the value where the CT1 field = &quot;IB&quot;. But for agents C and D, there IS no data where CT1 = &quot;IB&quot;. Again, the PivotTable simply does not have a value for the combination that you&#39;re asking for."}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1443656604, "creation_date": 1443656604, "answer_id": 32877293, "question_id": 32874780, "link": "https://stackoverflow.com/questions/32874780/iterating-through-items-in-a-pivottable-column/32877293#32877293", "title": "Iterating through items in a PivotTable column", "body": "<p>That no doubt happens because there is some combination of PvtTbl.GetPivotData(\"PRD\", \"Agent\", PivotItem.Name, \"CT1\", \"IB\") that does not exist in your PivotTable. So you would need to check to see if that returns an error, and then handle it accordingly.</p>\n\n<p>That said, it seems strange to me that you would want to do this via iteration in the first place. Why not just directly check if the thing in the DataField is zero or not? Or why not use the GETPIVOTDATA formula in the worksheet cells concerned?</p>\n\n<p>Can you elaborate further about what you are trying to achieve with this code?</p>\n"}], "owner": {"reputation": 1, "user_id": 5394787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84292cb2059da6c4d72015f602758b8c?s=128&d=identicon&r=PG&f=1", "display_name": "LifesGood", "link": "https://stackoverflow.com/users/5394787/lifesgood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 449, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1443656604, "creation_date": 1443643977, "last_edit_date": 1443646672, "question_id": 32874780, "link": "https://stackoverflow.com/questions/32874780/iterating-through-items-in-a-pivottable-column", "title": "Iterating through items in a PivotTable column", "body": "<p>My loop doesn't work when the data field for a given row and column is empty.\nThe relevant code is as follows -</p>\n\n<pre><code>For Each PivotItem In PvtTbl.RowFields(\"Agent\").PivotItems\n    rw = rw + 1\n        If PvtTbl.GetPivotData(\"PRD\", \"Agent\", PivotItem.Name, \"CT1\", \"IB\") = 0 Then\n            Worksheets(\"Sheet1\").Cells(16, rw).Value = 0\n         Else\n            Worksheets(\"Sheet1\").Cells(16, rw).Value = PvtTbl.GetPivotData(\"PRD\", \"Agent\", PivotItem.Name, \"CT1\", \"IB\")\n         End If\nNext PivotItem\n</code></pre>\n\n<p>The error I get is:  </p>\n\n<blockquote>\n  <p>Run-time error 1004/\"Application-defined or Object-defined error\"  </p>\n</blockquote>\n\n<p>I've tried \"ISERROR\" instead of setting the offending line to zero, but neither works.</p>\n"}, {"tags": ["vba", "excel", "find", "format", "infinite-loop"], "comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 1, "creation_date": 1443644203, "post_id": 32874637, "comment_id": 53581179, "body": "You haven&#39;t reassigned endAt to be LookFor during each subsequent search..."}, {"owner": {"reputation": 377, "user_id": 564588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a2b42b1ecc453876137905791fcff3?s=128&d=identicon&r=PG", "display_name": "Jason K.", "link": "https://stackoverflow.com/users/564588/jason-k"}, "edited": false, "score": 0, "creation_date": 1443653020, "post_id": 32874637, "comment_id": 53584764, "body": "Right Flephal, that&#39;s how he knows he&#39;s at the end/staring spot."}, {"owner": {"reputation": 13, "user_id": 5394731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8756001c8a12cb6df8d4a62987d223b8?s=128&d=identicon&r=PG&f=1", "display_name": "TC79", "link": "https://stackoverflow.com/users/5394731/tc79"}, "edited": false, "score": 0, "creation_date": 1443657796, "post_id": 32874637, "comment_id": 53586048, "body": "Thanks Flephal, that was what was causing the infinit loop!"}, {"owner": {"reputation": 13, "user_id": 5394731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8756001c8a12cb6df8d4a62987d223b8?s=128&d=identicon&r=PG&f=1", "display_name": "TC79", "link": "https://stackoverflow.com/users/5394731/tc79"}, "edited": false, "score": 0, "creation_date": 1443659619, "post_id": 32874637, "comment_id": 53586439, "body": "It didn&#39;t find all cells with the border, though."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1443645340, "creation_date": 1443645340, "answer_id": 32875155, "question_id": 32874637, "link": "https://stackoverflow.com/questions/32874637/infinite-loop-with-find-method/32875155#32875155", "title": "Infinite loop with .Find method", "body": "<p>I would recommend going back to the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow\">Range.Find</a>/<a href=\"https://msdn.microsoft.com/en-us/library/office/ff196143.aspx\" rel=\"nofollow\">Range.FindNext method</a>. There were some holes in your logic conditions and I believe I've adjusted them.</p>\n\n<pre><code>Set LookFor = WhereToLook.Find(What:=\"\", After:=Cells(5, 2), _\n    LookIn:=xlFormulas, LookAt:=xlPart, _\n    SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=True)\nIf Not LookFor Is Nothing Then 'Test if a cell with a bottom border is found\n  'What happens when a subtotal cell is found:\n  FoundHere = LookFor.Address\n  Debug.Print \"Found at: \" &amp; FoundHere\n  'Loop to set a range, sum values and put them in the right cell\n  Do\n\n   'do something with LookFor as a Range Object here\n\n    'Call for next search\n    Set LookFor = WhereToLook.FindNext(After:=LookFor)   '&lt;~~ look for next after current cell\n    Debug.Print \"LookFor now is: \" &amp; LookFor.Address\n  Loop Until LookFor.Address = FoundHere ' Do not allow wrapped search (LookFor will never be nothing here)\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 3600226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/732238a947944efab4724e1778a7af73?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeTrickPony", "link": "https://stackoverflow.com/users/3600226/threetrickpony"}, "is_accepted": true, "score": 0, "last_activity_date": 1443645423, "creation_date": 1443645423, "answer_id": 32875184, "question_id": 32874637, "link": "https://stackoverflow.com/questions/32874637/infinite-loop-with-find-method/32875184#32875184", "title": "Infinite loop with .Find method", "body": "<p>Consider using a range object to loop through your range. You can add a total if you need a grand total, but this is probably an easier way than trying to select all cells that have formatting.</p>\n\n<p>For example:</p>\n\n<pre><code>Sub TestStackOverflowCode()\n    Dim r As Range\n    Dim rngToChk As Range\n\n    'This is where you'd insert WhereToLook\n    Set rngToChk = ActiveSheet.Range(\"B1:B4\")\n\n    For Each r In rngToChk\n\n        'If the top edge does not NOT have a border\n        If r.Borders(xlEdgeTop).LineStyle &lt;&gt; xlNone Then\n            'Copy the cell value to two cells to the right\n            r.Offset(, 2).Value = r.Value\n        End If\n    Next r\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 377, "user_id": 564588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a2b42b1ecc453876137905791fcff3?s=128&d=identicon&r=PG", "display_name": "Jason K.", "link": "https://stackoverflow.com/users/564588/jason-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1443652770, "creation_date": 1443652770, "answer_id": 32876689, "question_id": 32874637, "link": "https://stackoverflow.com/questions/32874637/infinite-loop-with-find-method/32876689#32876689", "title": "Infinite loop with .Find method", "body": "<p>The findNext may not have worked if</p>\n\n<ul>\n<li>you had [FindFormat.Borders...] after the [Set LookFor = WhereToLook.Find(...]  </li>\n</ul>\n\n<p>I do think ThreeTrickPony's answer is more elegant, but in general I'd suggest finding an alternative way to identify cells rather than formatting.</p>\n"}], "owner": {"reputation": 13, "user_id": 5394731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8756001c8a12cb6df8d4a62987d223b8?s=128&d=identicon&r=PG&f=1", "display_name": "TC79", "link": "https://stackoverflow.com/users/5394731/tc79"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 927, "favorite_count": 0, "accepted_answer_id": 32875184, "answer_count": 3, "score": 1, "last_activity_date": 1443652770, "creation_date": 1443643360, "question_id": 32874637, "link": "https://stackoverflow.com/questions/32874637/infinite-loop-with-find-method", "title": "Infinite loop with .Find method", "body": "<p>I am trying to write a VBA script to automate moving things around in an spreadsheet that has a balance sheet imported from an accounting software. \nThe values on imported balance sheet start at row 5, column A has some text describing what the values of each row mean, and columns B and D have the amounts for each item.</p>\n\n<p>The subtotals for each section and subsection of the balance sheet are on columns C and E. Each subtotal has is in a cell formatted with a solid upper border.</p>\n\n<p>I would like to bring all these subtotals to the same columns as the values (i.e, columns B and D). I've tried to do this using the .Find method to search for cells with the specific format (cells with an upper border) and a Do loop to keep searching until I find all cells that should have a subtotal in it.</p>\n\n<p>Notes:</p>\n\n<ol>\n<li>I didn't use FindNext because it seems that it ignores format settings used in the preceding Find method, as described <a href=\"https://support.microsoft.com/en-us/kb/282151\" rel=\"nofollow\">here</a>.</li>\n<li>I tried to used the <a href=\"http://www.tushar-mehta.com/publish_train/xl_vba_cases/1001%20range.find%20and%20findall.shtml#_Using_the_SearchFormat\" rel=\"nofollow\">FindAll function described by Tushar Mehta</a> to go around this problem with FindNext, but it didn't find all cells with the specified format.</li>\n</ol>\n\n<p>Here's the code. Any help is greatly appreciated!</p>\n\n<pre><code>Sub FixBalanceSheet()\n  Dim LookFor As Range\n  Dim FoundHere As String 'Address of the cell that should contain a subtotal\n  Dim beginAt As Range, endAt As Range, rng As Range 'Set the ranges for the sum to get the subtotal\n  Dim place As String 'String with the address of a cell that will contain a subtotal\n  Dim WhereToLook As Range 'Range where subtotals are to be found\n\n  'Set workbook and worksheet\n  With Sheets(\"Sheet1\")\n    Set WhereToLook = Range(\"A5:F100\")\n    'Every cell containing a subtotal has an upper border. So, look for cells containing border!\n    With Application.FindFormat.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n    End With\n    'Call search using .Find\n    Set LookFor = WhereToLook.Find(What:=\"\", After:=Cells(5, 2), _\n        LookIn:=xlFormulas, LookAt:=xlPart, _\n        SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=True)\n    If Not LookFor Is Nothing Then 'Test if a cell with a bottom border is found\n      'What happens when a subtotal cell is found:\n      FoundHere = LookFor.Address\n      Debug.Print \"Found at: \" &amp; Found\n      'Loop to set a range, sum values and put them in the right cell\n      Do\n       '% find out a range to calculate subtotals and put the value in the right cells  %'\n        'Call for next search\n        With Application.FindFormat.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        End With\n        Set LookFor = WhereToLook.Find(What:=\"\", After:=endAt, SearchFormat:=True)\n        Debug.Print \"LookFor now is: \" &amp; LookFor.Address\n        Rem If LookFor.Address = Found Then ' Do not allow wrapped search\n          Rem Exit Do\n        Rem End If\n      Loop Until LookFor Is Nothing Or LookFor.Address = FoundHere ' Do not allow wrapped search\n    End If\n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 4971631, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yv7lbt8gO-0/AAAAAAAAAAI/AAAAAAAAABk/6dOnX_lw3D8/photo.jpg?sz=128", "display_name": "Josh Fierro", "link": "https://stackoverflow.com/users/4971631/josh-fierro"}, "is_accepted": false, "score": 0, "last_activity_date": 1443666219, "last_edit_date": 1443666219, "creation_date": 1443664010, "answer_id": 32878230, "question_id": 32874596, "link": "https://stackoverflow.com/questions/32874596/vba-formular1c1-adds-parentheses-when-hlookup-referances-another-workbook/32878230#32878230", "title": "VBA FormulaR1C1 adds parentheses when HLOOKUP referances another workbook", "body": "<p>I see that you're using Indirect in this formula, and that would only work if the referenced workbook is open.  If it is open, then you can make your whole formula indirect and get rid of all the hassles that way.  You can do this by referencing Address(Row()-x,Column()-y) within your formulas so that they work like an R1C1 style formula, and they reference different rows/columns depending on their own position even though the formula is identical in every cell.  An example of a simple formula that works this way is this:<br>\n=INDIRECT(\"'[My Workbook.xlsx]Sheet1'!\"&amp;ADDRESS(ROW()-3,COLUMN()-1))</p>\n\n<p>I believe this will do what you need:</p>\n\n<pre><code>Range(\"R8:R\" &amp; FinalRow).Formula = \"=IFERROR(HLOOKUP(IF(RIGHT(INDIRECT(Address(Row()-13,Column()+2)))=\"\"B4\"\",INDEX('[\" &amp; MyNM &amp; \" \" &amp; MyCC &amp; \" \" &amp; MyUnit &amp; \" EVMS.xlsm]\" &amp; myUA _\n            &amp; \"'!D:E,MATCH(INDIRECT(Address(Row(),Column()+4)),'[\" &amp; MyNM &amp; \" \" &amp; MyCC &amp; \" \" &amp; MyUnit &amp; \" EVMS.xlsm]\" &amp; myUA &amp; \"'!E:E,0),1),\" _\n            &amp; \"INDEX(INDIRECT(\"\"'[\" &amp; MyNM &amp; \" \" &amp; MyCC &amp; \" \" &amp; MyUnit &amp; \" EVMS.xlsm]\"\"&amp;RC5&amp;\"\"'!D:E\"\",TRUE),\" _\n            &amp; \"MATCH(INDIRECT(Address(Row(),Column()+4)),INDIRECT(\"\"'[\" &amp; MyNM &amp; \" \" &amp; MyCC &amp; \" \" &amp; MyUnit &amp; \" EVMS.xlsm]\"\"&amp;RC5&amp;\"\"'!E:E\"\",TRUE),0),1))\" _\n            &amp; \",'[\" &amp; MyNM &amp; \" \" &amp; MyCC &amp; \" \" &amp; MyUnit &amp; \" EVMS.xlsm]SOP'!INDIRECT(ADDRESS(ROW()+1,COLUMN()+3 &amp;\":\"&amp; ADDRESS(ROW()+4, COLUMN()+41)),4,FALSE),\"\"NP\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe20aff6c6269235510df807c9b4765c?s=128&d=identicon&r=PG&f=1", "display_name": "T. Dunar", "link": "https://stackoverflow.com/users/5394541/t-dunar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443666219, "creation_date": 1443643187, "last_edit_date": 1531164843, "question_id": 32874596, "link": "https://stackoverflow.com/questions/32874596/vba-formular1c1-adds-parentheses-when-hlookup-referances-another-workbook", "title": "VBA FormulaR1C1 adds parentheses when HLOOKUP referances another workbook", "body": "<p>I'm using the following code to look up a variable workbook and retrieve that data. It enters a formula into the cell range that grabs the data out of the other workbook. My problem is that if I use R1C1 style in the formula to indicate what range in the other workbook I want to search, VBA enters the formula as if it is A1 style. Then the formula will not return the correct info. </p>\n\n<p>But if I leave that portion of the code in A1 style, VBA adds parentheses to the range when it enters it into the cell and the formula fails. </p>\n\n<p>Here is the line of code:</p>\n\n<pre><code>Range(\"R8:R\" &amp; FinalRow).FormulaR1C1 = \"=IFERROR(HLOOKUP(IF(RIGHT(RC[-13],2)=\"\"B4\"\",INDEX('[\" &amp; MyNM &amp; \" \" &amp; MyCC &amp; \" \" &amp; MyUnit &amp; \" EVMS.xlsm]\" &amp; myUA _\n                &amp; \"'!D:E,MATCH(RC4,'[\" &amp; MyNM &amp; \" \" &amp; MyCC &amp; \" \" &amp; MyUnit &amp; \" EVMS.xlsm]\" &amp; myUA &amp; \"'!E:E,0),1),\" _\n                &amp; \"INDEX(INDIRECT(\"\"'[\" &amp; MyNM &amp; \" \" &amp; MyCC &amp; \" \" &amp; MyUnit &amp; \" EVMS.xlsm]\"\"&amp;RC5&amp;\"\"'!D:E\"\",TRUE),\" _\n                &amp; \"MATCH(RC4,INDIRECT(\"\"'[\" &amp; MyNM &amp; \" \" &amp; MyCC &amp; \" \" &amp; MyUnit &amp; \" EVMS.xlsm]\"\"&amp;RC5&amp;\"\"'!E:E\"\",TRUE),0),1))\" _\n                &amp; \",'[\" &amp; MyNM &amp; \" \" &amp; MyCC &amp; \" \" &amp; MyUnit &amp; \" EVMS.xlsm]SOP'!R1C3:R4C41,4,FALSE),\"\"NP\"\")\"\n</code></pre>\n\n<p>Here is the result:</p>\n\n<blockquote>\n  <p>=IFERROR(HLOOKUP(IF(RIGHT(E13,2)=\"B4\",INDEX('[5P1B 4520 5015 EVMS.xlsm]UA1B'!D:(E),MATCH($D13,'[5P1B 4520 5015\n  EVMS.xlsm]UA1B'!E:(E),0),1),INDEX(INDIRECT(\"'[5P1B 4520 5015\n  EVMS.xlsm]\"&amp;$E13&amp;\"'!D:E\",TRUE),MATCH($D13,INDIRECT(\"'[5P1B 4520 5015\n  EVMS.xlsm]\"&amp;$E13&amp;\"'!E:E\",TRUE),0),1)),'[5P1B 4520 5015\n  EVMS.xlsm]SOP'!$C$1:$AO$4,4,FALSE),\"NP\")</p>\n</blockquote>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1021, "user_id": 3633236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02ecf3e314b19317cbeb0dcebc8af3eb?s=128&d=identicon&r=PG&f=1", "display_name": "OSUZorba", "link": "https://stackoverflow.com/users/3633236/osuzorba"}, "edited": false, "score": 0, "creation_date": 1454344402, "post_id": 32874278, "comment_id": 57991037, "body": "I realized the original code would miss the second to last row if it was merged with the last row. I added a new block of code to make sure the last two rows stayed together if they were merged."}], "tags": [], "owner": {"reputation": 1021, "user_id": 3633236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02ecf3e314b19317cbeb0dcebc8af3eb?s=128&d=identicon&r=PG&f=1", "display_name": "OSUZorba", "link": "https://stackoverflow.com/users/3633236/osuzorba"}, "is_accepted": true, "score": 2, "last_activity_date": 1454344222, "last_edit_date": 1454344222, "creation_date": 1443641900, "answer_id": 32874278, "question_id": 32874277, "link": "https://stackoverflow.com/questions/32874277/prevent-vertically-merged-cells-from-breaking-across-page-automatically/32874278#32874278", "title": "Prevent Vertically Merged Cells from Breaking Across Page - Automatically", "body": "<p>Yes, working with merged cells in Word (and Excel for that matter) is quite annoying.</p>\n\n<p>This can be done, though, by accessing individual cells in table. I have written the following Sub Routine below that should work for you. I assumed that you had at least one column with no vertically merged cells in it and that you only had one column that controlled the length of the merged block. Although adding more controlling columns should be easy.</p>\n\n<pre><code>Sub MergedWithNext() 'FTable As Table)\n\nDim Tester As String\nDim FTable As Table\nDim i As Integer\nDim imax As Integer\nDim RowStart As Integer\nDim RowEnd As Integer\nDim CNMerged As Integer\nDim CNNotMerged As Integer\nDim CNMax As Integer\n\nCNMerged = 2 'A column number that is vertically merged that you don't want to split pages\nCNNotMerged = 1 'A column number that has no vertical mergers\n\nSet FTable = Selection.Tables(1)\n\nWith FTable\nimax = .Rows.Count\nCNMax = .Columns.Count\n\n'Start with no rows kept with next\nActiveDocument.Range(Start:=.Cell(1, 1).Range.Start, _\n    End:=.Cell(imax, CNMax).Range.End).ParagraphFormat.KeepWithNext = False\n\nOn Error Resume Next\nFor i = 2 To imax 'Assume table has header\n\n    Tester = .Cell(i, CNMerged).Range.Text 'Test to see if cell exists\n    If Err.Number = 0 Then 'Only the first row in the merged cell will exist, others will not\n\n        'If you are back in this If statement, then you have left the previous block of rows\n        'even if that was a block of one. The next If statement checks to see if the previous\n        'row block had more than one row. If so it applies the \"KeepWithNext\" property\n\n        If (RowEnd = (i - 1)) Then\n\n            '.Cell(RowStart, 1).Range.ParagraphFormat.KeepWithNext = True\n            ActiveDocument.Range(Start:=.Cell(RowStart, CNNotMerged).Range.Start, _\n                End:=.Cell(RowEnd - 1, CNNotMerged).Range.End).ParagraphFormat.KeepWithNext = True\n\n                'Use RowEnd - 1 because you don't care if the whole merged block stays with the next\n                'row that is not part of the merger block\n\n        End If\n\n        RowStart = i 'Beginning of a possible merger block\n        RowEnd = 0 'Reset to 0, not really needed, used for clarity\n\n    Else\n\n        RowEnd = i 'This variable will be used to determine the last merged row\n        Err.Clear\n\n    End If\n\n    If i = imax Then 'Last Row\n\n        If (RowStart &lt;&gt; imax) Then\n\n            ActiveDocument.Range(Start:=.Cell(RowStart, CNNotMerged).Range.Start, _\n                End:=.Cell(imax - 1, CNNotMerged).Range.End).ParagraphFormat.KeepWithNext = True\n\n                'Use imax - 1 because you don't care if the whole merged block stays with the next\n                'row that is not part of the merger block\n\n        End If\n\n    End If\n\nNext i\nOn Error GoTo 0\nEnd With\nEnd Sub\n</code></pre>\n\n<p>This code will loop through each row in the table, excluding the header, looking for vertically merged cells. Once it finds a block, it will assign the \"Keep With Next\" property to each row in the block, except for the last row. </p>\n"}], "owner": {"reputation": 1021, "user_id": 3633236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02ecf3e314b19317cbeb0dcebc8af3eb?s=128&d=identicon&r=PG&f=1", "display_name": "OSUZorba", "link": "https://stackoverflow.com/users/3633236/osuzorba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6358, "favorite_count": 1, "accepted_answer_id": 32874278, "answer_count": 1, "score": 2, "last_activity_date": 1542297422, "creation_date": 1443641900, "question_id": 32874277, "link": "https://stackoverflow.com/questions/32874277/prevent-vertically-merged-cells-from-breaking-across-page-automatically", "title": "Prevent Vertically Merged Cells from Breaking Across Page - Automatically", "body": "<p>I have to create documents that have large tables of data copied into them from Excel. The tables can be hundreds of rows long and generally ~20 columns wide. Many of the columns have been merged vertically to enhance readability and group sets of data. </p>\n\n<p>I have been able to write a macro that will fully format the entire table, except I have not been able to figure out how to automatically prevent the Vertically Merged cells from breaking/splitting across multiple pages. To do it manually, you select all of the rows in the merger except for the last one and then you turn on \"Keep With Next\" in the paragraph settings. I thought this would be easy to do, but you can not access individual rows in VBA if there are any vertically merged cells in the table. </p>\n\n<p>Does anyone have an idea how to automatically go through the rows and set the \"Keep With Next\" property for groups of rows that have been merged together?</p>\n\n<p>Here is an example of how Word normally handles vertically merged cells across tables:\n<a href=\"https://i.stack.imgur.com/BUNAP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BUNAP.png\" alt=\"Here is an example of how Word normally handles vertically merged cells across tables\"></a></p>\n\n<p>This is how I would like it to look, with doing all the work manually:\n<a href=\"https://i.stack.imgur.com/36GKb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/36GKb.png\" alt=\"This is how I would like it to look, with doing all the work manually\"></a></p>\n"}, {"tags": ["vba", "excel", "constants", "formulas"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1443642014, "post_id": 32874207, "comment_id": 53580166, "body": "You are asking for a way to parse all the formulas in a sheet and remove any literal values in the formula?  For example, <code>=A1+10</code> you wish to remove the <code>+10</code>  and you want to do similar for all the formulas in a sheet?"}, {"owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "edited": false, "score": 0, "creation_date": 1443642078, "post_id": 32874207, "comment_id": 53580201, "body": "Do you mean that you want to remove &#39;+1181&#39; and &#39;+1292.76&#39; ?"}, {"owner": {"reputation": 113, "user_id": 5310470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153267371183515/picture?type=large", "display_name": "Thomas", "link": "https://stackoverflow.com/users/5310470/thomas"}, "edited": false, "score": 0, "creation_date": 1443642878, "post_id": 32874207, "comment_id": 53580566, "body": "Yes, but I only want to remove it from this range.  I&#39;ll want to do it across about 36 sheets but the range will be the same on each sheet."}, {"owner": {"reputation": 377, "user_id": 564588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7a2b42b1ecc453876137905791fcff3?s=128&d=identicon&r=PG", "display_name": "Jason K.", "link": "https://stackoverflow.com/users/564588/jason-k"}, "edited": false, "score": 0, "creation_date": 1443653455, "post_id": 32874207, "comment_id": 53584917, "body": "I&#39;ll offer a solution with Split() if desired, otherwise I&#39;d suggest a [For each s in sheets...] as an edit to paul bica&#39;s to handle all sheets in a workbook, and including the appropriate range."}], "answers": [{"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1443645921, "post_id": 32875198, "comment_id": 53582007, "body": "What if the literal is BEFORE the reference, like <code>=10+A1</code>. What about all the other operators <code>- * &#47; &amp;</code> ? What about literal parameters to functions? Perhaps your solution will work for the asker, but not in the more interesting general case."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1443646342, "post_id": 32875198, "comment_id": 53582220, "body": "@ExcelHero: I provided a solution for the requirement presented; it can be extrapolated based on particular need: for <code>=10+A1</code> change search pattern to <code>*+</code>, or create a Select Case for the 4 basic math operators as required. The answer though, addresses the only pattern posted :) (show one of the ways to approach the problem)"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1443646747, "post_id": 32875198, "comment_id": 53582428, "body": "No need to answer, it was rhetorical. I suspect though that to do this properly in the general case is not trivial and cannot be accomplished with an extrapolation. It requires complete parsing and a bunch of heuristics, and is likely not doable for parameters."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1444184090, "post_id": 32875198, "comment_id": 53790680, "body": "@paulbica the tricky part with parsing formula rather than the constant is that you need to cope with the absolute and relative reference combinations as well."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1444185678, "post_id": 32875198, "comment_id": 53791071, "body": "@brettdj - good point! the pattern in regex will be a bit easier to adjust to something like <code>[^a-zA-Z$][0-9]...</code> (I haven&#39;t tested it though)"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 1, "last_activity_date": 1443659104, "last_edit_date": 1443659104, "creation_date": 1443645475, "answer_id": 32875198, "question_id": 32874207, "link": "https://stackoverflow.com/questions/32874207/clear-constants-in-a-range-without-clearing-references-and-formulas/32875198#32875198", "title": "Clear Constants in a range without clearing references and formulas", "body": "<p>This will remove constants from all formulas in current workbook based on 2 patterns:</p>\n\n<ul>\n<li><p><code>\"=Formula-[Space]-</code><strong><code>PlusSign</code></strong><code>-[Space]-Constant\"</code> (space optional)</p>\n\n<ul>\n<li><code>=(G83*H1)+1181.05 or =(G83*H1) +1181.05 or =(G83*H1)+ 1181.05</code> becomes <strong><code>=(G83*H1)</code></strong></li>\n<li><code>=E33+1292.76 or =E33 +1292.76 or =E33+ 1292.76 or =E33 + 1292.76</code> becomes <strong><code>=E33</code></strong></li>\n</ul></li>\n<li><p><code>\"=Formula-[Space]-</code><strong><code>MinusSign</code></strong><code>-[Space]-Constant\"</code> (space optional)</p></li>\n</ul>\n\n<hr>\n\n<pre><code>Public Sub clearConstantsFromWorkBookFormulas()\n    Const PATTERNS As String = \"~+*|~+ *|~ +*| ~+ *|~-*|~- *|~ -*|~ - *\"\n    Dim pat As Variant\n\n    For Each pat In Split(PATTERNS, \"|\")\n        Cells.Replace What:=pat, _\n                      Replacement:=vbNullString, _\n                      LookAt:=xlPart, _\n                      SearchOrder:=xlByRows, _\n                      MatchCase:=False\n    Next\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>.</p>\n\n<p>This is a more generic option using regEx pattern matching and arrays:</p>\n\n<pre><code>Public Sub testClear()\n    Dim ws As Worksheet\n\n    For Each ws In Application.ActiveWorkbook.Worksheets\n        removeConstantsFromFormulas ws.Range(\"B2:B11\"), getRegEx\n    Next\nEnd Sub\n\nPublic Sub removeConstantsFromFormulas(ByRef rng As Range, ByRef regEx As Object)\n    Dim v As Variant, r As Long, c As Long, lr As Long, lc As Long\n\n    lr = rng.Rows.Count\n    lc = rng.Columns.Count\n\n    If lr &gt; 0 And lc &gt; 0 Then\n\n        v = rng.Formula\n        For r = 1 To lr\n           For c = 1 To lc\n              If Left(v(r, c), 1) = \"=\" Then\n                 If regEx.Test(v(r, c)) Then v(r, c) = regEx.Replace(v(r, c), vbNullString)\n              End If\n           Next\n        Next\n        rng.Formula = v\n\n    End If\nEnd Sub\n\nPrivate Function getRegEx() As Object\n    Set getRegEx = CreateObject(\"VBScript.RegExp\")\n    getRegEx.Pattern = \"[^a-zA-Z][0-9]+(\\.?[0-9]+)\"\n    getRegEx.Global = True\n    getRegEx.IgnoreCase = True\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>RegEx pattern: one or more digits, digit group not preceded by a letter, with or without a fraction part</p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1443683448, "last_edit_date": 1443683448, "creation_date": 1443679188, "answer_id": 32880385, "question_id": 32874207, "link": "https://stackoverflow.com/questions/32874207/clear-constants-in-a-range-without-clearing-references-and-formulas/32880385#32880385", "title": "Clear Constants in a range without clearing references and formulas", "body": "<p>This attempt should handle most examples using a Regexp.</p>\n\n<p>There may be some edge cases as the discussion above points out. For the code below</p>\n\n<blockquote>\n  <p>=(G83*H1)+1181.05<br>\n  =10+A1<br>\n  =A1+10<br>\n  =A1+(10)<br>\n  =A1+10.0  </p>\n</blockquote>\n\n<p>becomes</p>\n\n<blockquote>\n  <p>=(G83*H1)<br>\n  =+A1<br>\n  =A1<br>\n  =A1<br>\n  =A1  </p>\n</blockquote>\n\n<p>I note it would also take out the <em>^2</em> in <code>=A1^2</code></p>\n\n<p>It clearly also won't cater for named formulae (named ranges).</p>\n\n<p><em>Updated: Now handles cascading parentheses, ie</em></p>\n\n<blockquote>\n  <p>=A1+(27+(11-2))</p>\n</blockquote>\n\n<p>becomes</p>\n\n<blockquote>\n  <p>=A1</p>\n</blockquote>\n\n<pre><code>Sub Format()\nDim objRegexB As Object\nDim lngCnt As Long\nDim X\n\nX = [b2:b11].Formula\n\nSet RegExB = CreateObject(\"vbscript.regexp\")\nWith RegExB\n    .Pattern = \"[=\\+\\/\\*^\\-](\\([0-9]\\d*(\\.\\d+)?\\)|[0-9]\\d*(\\.\\d+)?|\\.\\d+)\"\n   .Global = True\n    For lngCnt = 1 To UBound(X)\n        Do While .Test(X(lngCnt, 1))\n           X(lngCnt, 1) = .Replace(X(lngCnt, 1), vbNullString)\n        Loop\n    Next\nEnd With\n[b2:b11].Formula = X\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 5310470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153267371183515/picture?type=large", "display_name": "Thomas", "link": "https://stackoverflow.com/users/5310470/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 32875198, "answer_count": 2, "score": 1, "last_activity_date": 1443683448, "creation_date": 1443641542, "question_id": 32874207, "link": "https://stackoverflow.com/questions/32874207/clear-constants-in-a-range-without-clearing-references-and-formulas", "title": "Clear Constants in a range without clearing references and formulas", "body": "<p>I am trying to clear all the number constants in a range of cells without clearing any formulas or cell references.  Clearing the constants from cells without any formulas or cell references is simple but I am having trouble doing it when those are present.  Below is the code I have so far.</p>\n\n<pre><code>Range(\"B2:B11\").Select\nSelection.SpecialCells(xlCellTypeConstants, 1).Select\nSelection.ClearContents\n</code></pre>\n\n<p>In this range cells B5 and B7 have formulas with cell references as follows:</p>\n\n<p>B5: =(G83*H1)+1181.05</p>\n\n<p>B7: =E33+1292.76</p>\n\n<p>The cell references will also at times reference cells on other sheets in the same workbook.  I need to clear the constants from these formulas while leaving the references intact.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 2, "creation_date": 1443641304, "post_id": 32874100, "comment_id": 53579835, "body": "start with the search box in the upper right hand corner of this page.  Type in excel VBA Find Multiple and you will get your answer"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1443643914, "post_id": 32874100, "comment_id": 53581027, "body": "Your methods break your data. Unless the user edits the information on the database worksheet and Sheet2 is populated from that, the data on Sheet2 is useless."}, {"owner": {"reputation": 1303, "user_id": 5254224, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-oOkdF0Z_r48/AAAAAAAAAAI/AAAAAAAAAK4/U1wsJOhA9rM/photo.jpg?sz=128", "display_name": "ahinkle", "link": "https://stackoverflow.com/users/5254224/ahinkle"}, "edited": false, "score": 0, "creation_date": 1443647617, "post_id": 32874100, "comment_id": 53582798, "body": "@Jeeped I understand what you are trying to say to work out of the Database sheet. It&#39;s more of a visual editing for a week-by-week schedule. It has a code that deletes old saves and saves new ones. I created a base for searching and finding the dates.. That is now attached."}], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1443692974, "creation_date": 1443692974, "answer_id": 32884475, "question_id": 32874100, "link": "https://stackoverflow.com/questions/32874100/find-based-on-multiple-search-criteria/32884475#32884475", "title": "Find based on multiple search criteria", "body": "<p>You will need to work on x to get the proper hours calculated, but this will get the results you are looking for.</p>\n\n<pre><code>Sub DoIt()\n    Dim sh As Worksheet, ws As Worksheet\n    Dim fr As Range    'range to filter\n    Dim nRng As Range, Crng As Range, c As Range, Lrw As Long, r As Range, x\n\n    Set ws = Sheets(\"Database\")\n    Set sh = Sheets(\"Schedule Admin\")\n    Set fr = sh.Range(\"A9\")\n\n    With ws\n        .ListObjects(\"Table1\").Range.AutoFilter Field:=2, Criteria1:=fr\n        lrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Set nRng = .Range(\"A3:A\" &amp; lrow).SpecialCells(xlCellTypeVisible)\n    End With\n\n    With sh\n        Set Crng = .Range(\"B8:H8\")\n        For Each c In Crng.Cells\n            Set r = nRng.Find(what:=c.Value, lookat:=xlWhole)\n            If Not r Is Nothing Then\n                x = ws.Range(\"D\" &amp; r.Row) - ws.Range(\"C\" &amp; r.Row)    'calculate hours\n                c.Offset(1) = x\n            Else: MsgBox \"Not Found\"\n            End If\n        Next c\n    End With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1303, "user_id": 5254224, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-oOkdF0Z_r48/AAAAAAAAAAI/AAAAAAAAAK4/U1wsJOhA9rM/photo.jpg?sz=128", "display_name": "ahinkle", "link": "https://stackoverflow.com/users/5254224/ahinkle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1443692974, "creation_date": 1443641076, "last_edit_date": 1443647695, "question_id": 32874100, "link": "https://stackoverflow.com/questions/32874100/find-based-on-multiple-search-criteria", "title": "Find based on multiple search criteria", "body": "<p>I have a large data sheet that I want to search and place values using VBA.</p>\n\n<p>The worksheet has to do with scheduling and I would like to pull an employees schedule from this spreadsheet - Name:\"Database\" (Sheet5):</p>\n\n<p><a href=\"https://i.stack.imgur.com/XSksF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XSksF.png\" alt=\"enter image description here\"></a></p>\n\n<p>to this sheet- Name:\"Schedule Admin\" (Sheet2)</p>\n\n<p><a href=\"https://i.stack.imgur.com/0IT3h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0IT3h.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm trying to get B9, Sheet2 to search and match the name(A9,Sheet2) in the database (Sheet5, Column B) and then match the date(B8, Sheet2) to the database(Sheet5, Column A). Once from there it will paste the opening value from the C column (Sheet5).</p>\n\n<p>At first I thought about a formula, but I would like the user to edit that as I have a working Save to Database button.</p>\n\n<p>I created a base for looping and it works perfectly.. Just need something easier so I don't have to write this code cell-by-cell </p>\n\n<pre><code> Sub Load()\n    Dim dtFrom As String\n    Dim LoadDate As String\n    Dim y As Long\n    Dim i As Long\n    Dim vCont As Variant\n    Dim iCont As Variant\n    Dim Result As Variant\n    dtFrom = Sheets(\"Schedule Admin\").Range(\"A9\").Value\n    LoadDate = Sheets(\"Schedule Admin\").Range(\"B8\").Value\n    With Sheets(\"Schedule Admin\")\n        For y = 27 To 9 Step -3\n            vCont = .Cells(y, 1).Value\n            If Not IsError(vCont) Then\n                If vCont = dtFrom Then\n                With Sheets(\"Database\")\n                    For i = 100 To 2 Step -1\n                        iCont = .Cells(i, 1).Value\n                        If Not IsError(iCont) Then\n                            If iCont = LoadDate Then\n                                If vCont = Sheet5.Range(\"B\" &amp; i).Value2 Then\n                                Result = Sheet5.Range(\"C\" &amp; i).Value2\n                                Sheet2.Range(\"B9\").Value2 = Result\n                                End If\n                            End If\n                        End If\n                        Next\n                        End With\n                End If\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop", "recursion", "permutation"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 1, "creation_date": 1443641618, "post_id": 32873982, "comment_id": 53580001, "body": "Can you restate your objective? What do you want to do?"}, {"owner": {"reputation": 369, "user_id": 4011878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1d78babefd9a85be90d609807f361d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shan", "link": "https://stackoverflow.com/users/4011878/shan"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1443642061, "post_id": 32873982, "comment_id": 53580196, "body": "I would like to set the number of loops as variable. for example in the above example i used 8 loops so output is 2^8=256. but some times i need only 2 for example. so output will be 2x2 matrix."}, {"owner": {"reputation": 369, "user_id": 4011878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1d78babefd9a85be90d609807f361d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shan", "link": "https://stackoverflow.com/users/4011878/shan"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1443642242, "post_id": 32873982, "comment_id": 53580262, "body": "it just fills up data from my array. this array length is variable so all loops runs according to each array length."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1443642470, "post_id": 32873982, "comment_id": 53580390, "body": "If you want to get <i>full outer join</i> of different arrays elements you can take a look at this question: <a href=\"http://stackoverflow.com/questions/31472816\">link</a>. There are ranges instead of arrays but it&#39;s easy to adapt. No need for recursion."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1443665037, "post_id": 32873982, "comment_id": 53587602, "body": "@BradNicku, Great link! I made an answer on that same post. OP should consider a VBA recordset connection to workbook and run a Cartesian Cross Product SQL across all arrays."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1443644565, "creation_date": 1443644565, "answer_id": 32874944, "question_id": 32873982, "link": "https://stackoverflow.com/questions/32873982/vba-recursive-for-loops-permutation/32874944#32874944", "title": "VBA recursive &quot;For loops&quot; Permutation?", "body": "<p>If you still want the fix to the code to produce the desired outcome.</p>\n\n<pre><code>Sub RecurseMe(a, v, depth, rw)\n\n    If a &gt; depth Then\n        rw = rw + 1\n        PrintV v, rw\n        Exit Sub\n    End If\n    For x = 1 To 2\n        v(a) = x + ((a - 1) * 2)\n        a = a + 1\n        RecurseMe a, v, depth, rw\n        a = a - 1\n    Next x\nEnd Sub\n\nSub PrintV(v, rw)\n    For j = 1 To UBound(v)\n        ActiveSheet.Cells(rw, j) = v(j) ' &amp; \" \";\n    Next j\nEnd Sub\nSub test()\n    Dim v()\n    Dim rw As Long\n    rw = 0\n    depth = 8 'adjust to adjust the number of columns\n    a = 1\n    ReDim v(1 To depth)\n    RecurseMe a, v, depth, rw\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": false, "score": 0, "last_activity_date": 1443650458, "last_edit_date": 1443650458, "creation_date": 1443649492, "answer_id": 32876129, "question_id": 32873982, "link": "https://stackoverflow.com/questions/32873982/vba-recursive-for-loops-permutation/32876129#32876129", "title": "VBA recursive &quot;For loops&quot; Permutation?", "body": "<p>I approached it as a binary problem:</p>\n\n<pre><code>Public Sub Perms(lCyles As Long)\n\n    Dim sBin As String\n    Dim i As Long\n    Dim j As Long\n    Dim n As Long\n\n    With Sheets(\"Criteria\")\n        .Cells.Clear\n        n = 1\n        For i = 0 To 2 ^ lCyles - 1\n            sBin = WorksheetFunction.Dec2Bin(i)\n            sBin = String(lCyles - Len(sBin), \"0\") &amp; sBin\n            For j = 1 To Len(sBin)\n                .Cells(n, j) = IIf(Mid(sBin, j, 1) = \"1\", j * 2, j * 2 - 1)\n            Next j\n            n = n + 1\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1443683616, "post_id": 32878660, "comment_id": 53593530, "body": "This solution sounds amazingly neat and simple, but can you confirm that <code>[ArraySheet1$A1:A3]</code> is <b>Sheet1!A1:A3</b>, <code>[ArraySheet2$A1:A3]</code> is <b>Sheet2!A1:A3</b>. etc? How to modify the <code>strSQL</code> to suit different ranges? That is, to build the <b>strSQL</b> for generic use?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1443684008, "post_id": 32878660, "comment_id": 53593751, "body": "Also, can this be on the same workbook as in <b>C:\\Path To\\Excel\\Workbook.xlsx</b> connecting to <b>C:\\Path To\\Excel\\Workbook.xlsx</b>?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1443711404, "post_id": 32878660, "comment_id": 53611135, "body": "@Patrick Yes <code>ArraySheet</code> is a named worksheet and you can use different ranges in same worksheet. Unfortunately, as far as I know ODBC workbook connections must be done externally and not on same workbook."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1443738654, "post_id": 32878660, "comment_id": 53624736, "body": "Thanks @Parfait, I will try play around with ranges, hopefully it works for named ranges too!"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 2, "last_activity_date": 1443667579, "creation_date": 1443667579, "answer_id": 32878660, "question_id": 32873982, "link": "https://stackoverflow.com/questions/32873982/vba-recursive-for-loops-permutation/32878660#32878660", "title": "VBA recursive &quot;For loops&quot; Permutation?", "body": "<p>For future readers, OP's needs essentially follows a <a href=\"https://en.wikipedia.org/wiki/Cartesian_product\" rel=\"nofollow noreferrer\">Cartesian Product</a>, a mathematical operation of all ordered pairs between sets. One can easily run the <a href=\"https://technet.microsoft.com/en-us/library/ms190690%28v=sql.105%29.aspx\" rel=\"nofollow noreferrer\">Cross Join SQL</a> query or specifically a query without any <code>JOIN</code> statements to achieve the resultset. This is also known as the full outer join query.</p>\n\n<p>Some SQL engines like SQL Server use the <code>CROSS JOIN</code> statement with a resultset equal to rows of product of each included query table (e.g., <code>2*2*2*2*2*2*2*2 = 2^8 = 256</code>).</p>\n\n<p>In MS Access (the database sibling to MS Excel), using tables defined as the 8 arrays of two items, below would be the cross join query. Item field in each Array table carries the pairing <code>(1,2), (3,4), (5,6) ...</code></p>\n\n<pre><code>SELECT Array1.Item, Array2.Item, Array3.Item, Array4.Item, \n       Array5.Item, Array6.Item, Array7.Item, Array8.Item\nFROM Array1, Array2, Array3, Array4, \n     Array5, Array6, Array7, Array8;\n</code></pre>\n\n<p><strong>Design</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/uhjNF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uhjNF.png\" alt=\"SQL Query\"></a></p>\n\n<p><strong>Output</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/9FkB8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9FkB8.png\" alt=\"Query Output\"></a></p>\n\n<p><strong>Excel solution</strong></p>\n\n<p>Because VBA can connect to various SQL engines by associated drivers including Excel's ODBC Jet Driver, a workbook can connect to ranges of worksheets and run the same cross join query:</p>\n\n<pre><code>Sub CrossJoinQuery()\n\n    Dim conn As Object\n    Dim rst As Object\n    Dim sConn As String, strSQL As String\n\n    Set conn = CreateObject(\"ADODB.Connection\")\n    Set rst = CreateObject(\"ADODB.Recordset\")\n\n    sConn = \"Driver={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};\" _\n               &amp; \"DBQ=C:\\Path To\\Excel\\Workbook.xlsx;\"\n    conn.Open sConn\n\n    strSQL = \"SELECT * FROM [ArraySheet1$A1:A3], [ArraySheet2$A1:A3], \n                            [ArraySheet3$A1:A3], [ArraySheet4$A1:A3],\n                            [ArraySheet5$A1:A3], [ArraySheet6$A1:A3], \n                            [ArraySheet7$A1:A3], [ArraySheet8$A1:A3]\"\n    rst.Open strSQL, conn\n\n    Range(\"A1\").CopyFromRecordset rst\n\n    rst.Close\n    conn.Close\n\n    Set rst = Nothing\n    Set conn = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 369, "user_id": 4011878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1d78babefd9a85be90d609807f361d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shan", "link": "https://stackoverflow.com/users/4011878/shan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1651, "favorite_count": 0, "accepted_answer_id": 32874944, "answer_count": 3, "score": 1, "last_activity_date": 1443667579, "creation_date": 1443640682, "question_id": 32873982, "link": "https://stackoverflow.com/questions/32873982/vba-recursive-for-loops-permutation", "title": "VBA recursive &quot;For loops&quot; Permutation?", "body": "<p>Below is my code. I would like to achieve the same result by recursive method because the number of nested loops is varying from 2 to max 8. </p>\n\n<pre><code>Sub permutation()\n\nc1 = Array(1, 2)\nc2 = Array(3, 4)\nc3 = Array(5, 6)\nc4 = Array(7, 8)\nc5 = Array(9, 10)\nc6 = Array(11, 12)\nc7 = Array(13, 14)\nc8 = Array(15, 16)\n\nWith Sheets(\"Criteria\")\n    .Cells.Clear\n    n = 1\n    For a = LBound(c1) To UBound(c1)\n        For b = LBound(c2) To UBound(c2)\n            For c = LBound(c3) To UBound(c3)\n                For d = LBound(c4) To UBound(c4)\n                    For e = LBound(c5) To UBound(c5)\n                         For f = LBound(c6) To UBound(c6)\n                             For g = LBound(c7) To UBound(c7)\n                                 For h = LBound(c8) To UBound(c8)\n\n                                Cells(n, 1).Value = c1(a)\n                                Cells(n, 2).Value = c2(b)\n                                Cells(n, 3).Value = c3(c)\n                                Cells(n, 4).Value = c4(d)\n                                Cells(n, 5).Value = c5(e)\n                                Cells(n, 6).Value = c6(f)\n                                Cells(n, 7).Value = c7(g)\n                                Cells(n, 8).Value = c8(h)\n                                n = n + 1\n\n                                Next h\n                            Next g\n                        Next f\n                    Next e\n                Next d\n            Next c\n        Next b\n    Next a\nEnd With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/tKDRa.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tKDRa.jpg\" alt=\"Result\"></a>    </p>\n\n<p>I have also found a recursive code sample on the internet but i really don't know how to modify according to my need. Any help would be really great.</p>\n\n<p>Recursive code sample</p>\n\n<pre><code>Sub RecurseMe(a, v, depth)\n    If a &gt; depth Then\n        PrintV v\n        Exit Sub\n    End If\n    For x = 1 To 4\n        v(a) = x\n        a = a + 1\n        RecurseMe a, v, depth\n        a = a - 1\n    Next x\nEnd Sub\n\nSub PrintV(v)\n    For J = 1 To UBound(v): Debug.Print v(J) &amp; \" \";: Next J\n    Debug.Print\nEnd Sub\nSub test()\n    Dim v()\n    depth = 4 'adjust\n    a = 1\n    ReDim v(1 To depth)\n    RecurseMe a, v, depth\nEnd Sub\n</code></pre>\n\n<p>Regards</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1443641265, "post_id": 32873866, "comment_id": 53579820, "body": "I think you have an extra &quot;End if&quot; in your post... Also, you have your &quot;Next i&quot; inside your if statement."}, {"owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "reply_to_user": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1443641352, "post_id": 32873866, "comment_id": 53579862, "body": "the extra end if it has been posted  by mistake , where i can put my condition"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "edited": false, "score": 0, "creation_date": 1443641958, "post_id": 32874208, "comment_id": 53580144, "body": "source its for my drop down list"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "edited": false, "score": 0, "creation_date": 1443642645, "post_id": 32874208, "comment_id": 53580463, "body": "So the code I wrote only does the copy if yu have selected &quot;complete&quot; in your drop down list.  You need to use a lot more words and give us more info if we are going to be able help you more."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "edited": false, "score": 0, "creation_date": 1443644555, "post_id": 32874208, "comment_id": 53581342, "body": "@Riadh.  Sorry but his isn&#39;t a code writing service and I find your explainations hard to follow.  I won&#39;t be able to offer you any more help that that already given.  I hope I have helped you somewhat."}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1443643827, "last_edit_date": 1443643827, "creation_date": 1443641549, "answer_id": 32874208, "question_id": 32873866, "link": "https://stackoverflow.com/questions/32873866/copy-data-data-from-one-worksheet-to-another-with-a-condition/32874208#32874208", "title": "Copy data data from one worksheet to another with a condition", "body": "<p>Here some changes to your code that might help.</p>\n\n<pre><code>Sub copier()\n    Dim ws1 As Worksheet, ws2 As Worksheet, src As Range, dest As Range, i As Integer\n\n    Set ws1 = Worksheets(\"Workload - Charge de travail\")\n    Set ws2 = Worksheets(\"Sheet1\")\n\n    For i = 2 To ws1.Range(\"A1\").SpecialCells(xlLastCell).Row   \n            ' this is more reliable than the method you used (which relies ont eh workbook being saved)\n            ' but there must be no gaps in column A.\n\n        ' Your code would not work.  Think about whay happens as i increases!\n        ' ws1.Range(\"A2\" &amp; i &amp; \":AG10\" &amp; i)\n\n        Set src  = ws1.Range(\"A\" &amp; i &amp; \":AG\" &amp; i+10  )\n        Set dest = ws2.Range(\"A\" &amp; i &amp; \":AG\" &amp; i+10 )\n\n         If Source.Cells(1, 4).Value = \"complete\" Then \n             ' what is source?   \n             ' What is this trying to do!  I think you mean i+1 not 1.     \n             ' I think you mean src not source.  I'm not psychic.\n\n           src.Copy Destination:=dest\n           dest.Value = dest.Value\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 5003701, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/909639425763095/picture?type=large", "display_name": "Riadh Sa&#239;d", "link": "https://stackoverflow.com/users/5003701/riadh-sa%c3%afd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443645434, "creation_date": 1443640185, "last_edit_date": 1443645434, "question_id": 32873866, "link": "https://stackoverflow.com/questions/32873866/copy-data-data-from-one-worksheet-to-another-with-a-condition", "title": "Copy data data from one worksheet to another with a condition", "body": "<p>I'm working on a macro that helps me to copy data from one worksheet to another in Excel with some conditions. I tried the following code; it works, but I got an infinite loop and I was not able to make the condition correctly in the code (I have to copy only the lines with the drop down list displays (complete), actually it's filled with  3 options (complete/cancel/in process)</p>\n\n<pre><code>Sub copier()\nDim ws1 As Worksheet, ws2 As Worksheet, src As Range, dest As Range, i As Integer\nSet ws1 = Worksheets(\"Workload - Charge de travail\")\nSet ws2 = Worksheets(\"Sheet1\")\n\nFor i = 2 To ws1.UsedRange.Rows.Count\n    Set src = ws1.Range(\"A2\" &amp; i &amp; \":AG10\" &amp; i)\n    Set dest = ws2.Range(\"A2\" &amp; i &amp; \":AG10\" &amp; i)\n    If Source.Cells(1, 4).Value = \"complete\" Then\n         src.Copy Destination:=dest\n         dest.Value = dest.Value\n         Next i\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1443637253, "post_id": 32873006, "comment_id": 53577804, "body": "I think the interesting thing you wrote was that &quot;manually import the Excel file&quot; also only imported A1 and A2.   Forget getting the code to work for now and try and get manually importing the workbook to do what you expect!   I would try saving the excel file in various different excel formats.  I would try recreating a NEW excel file that you can trust is not &quot;corrupted&quot; somehow.  This will case more light on what is going wrong..   I would try importing the xl fiel that does not work into access installed on another PC.  Good idea?"}], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1443637747, "creation_date": 1443637747, "answer_id": 32873237, "question_id": 32873006, "link": "https://stackoverflow.com/questions/32873006/importing-ms-excel-sheet-into-ms-access-via-vba-not-importing-everything/32873237#32873237", "title": "Importing MS Excel sheet into MS Access via VBA not importing everything", "body": "<pre><code>\"DELETE tbl_Work_Plan_Item_Import.*, * \" &amp; _\n</code></pre>\n\n<p>This has the * twice.</p>\n\n<p>Change to </p>\n\n<pre><code>\"DELETE tbl_Work_Plan_Item_Import.* \" &amp; _\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 3112431, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ae087dd5e5b10a05aa53553832658b29?s=128&d=identicon&r=PG&f=1", "display_name": "mittra", "link": "https://stackoverflow.com/users/3112431/mittra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 577, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443637747, "creation_date": 1443636851, "question_id": 32873006, "link": "https://stackoverflow.com/questions/32873006/importing-ms-excel-sheet-into-ms-access-via-vba-not-importing-everything", "title": "Importing MS Excel sheet into MS Access via VBA not importing everything", "body": "<p>I have an MS Access Database program that brings in the data from an MS Excel workbook (it's only one sheet) that is then processed and kicks out a completed form for the user. </p>\n\n<p>The whole thing was working fine, but when they encountered an error in the report I went to work with the database program to find the problem and a new one cropped up. MS Access is only importing cells A1 and A2. </p>\n\n<p>When I try to manually import the Excel file and append to a table, the Import Wizard only shows those two cells as being included in the file. Somehow, MS Access is not seeing the entire sheet of data. </p>\n\n<p>I have tried manually changing the acSpreadsheetType option in DoCmd.TransferSpreadsheet and it worked once. I have also tried changing it programmatically with no effect (i.e., I still only get cells A1 and A2). </p>\n\n<p>Here is the segment of the VBA that deals with this part of the program: </p>\n\n<pre><code>Dim acSpreadsheetType As Integer\n\nstrFile2Import = txtFindFile\n\nacSpreadsheetType = ExcelVersion(strFile2Import)\n\nDoCmd.Hourglass (HourglassOn)\nDoCmd.SetWarnings (WarningsOff)\n\nDoCmd.RunSQL _\n    \"DELETE tbl_Work_Plan_Item_Import.*, * \" &amp; _\n    \"FROM tbl_Work_Plan_Item_Import;\"\n\nDoCmd.TransferSpreadsheet _\n    acImport, acSpreadsheetType, \"tbl_Work_Plan_Item_Import\", strFile2Import, True\n</code></pre>\n\n<p>and here is the \"ExcelVersion\" function: </p>\n\n<pre><code>Public Function ExcelVersion(ByVal strFile2Import As String)\n    'https://msdn.microsoft.com/en-us/library/office/ff840717.aspx\n    'https://msdn.microsoft.com/en-us/library/office/ff198017.aspx\n    Set objapp = CreateObject(\"Excel.Application\")\n    objapp.Visible = True\n    Set wb = objapp.workbooks.Open(strFile2Import, True, False)\n    ExcelVersion = wb.FileFormat\n    wb.Close\n\n    objapp.Quit\n\n    Set objapp = Nothing\n\n    Select Case ExcelVersion\n        Case 29             'xlExcel3 (Excel3)\n            ExcelVersion = 0    'acSpreadsheetTypeExcel3 (Microsoft Excel 3.0 format)\n        Case 33             'xlExcel4 (Excel4)\n            ExcelVersion = 6    'acSpreadsheetTypeExcel4 (Microsoft Excel 4.0 format)\n        Case 39             'xlExcel5 (Excel5)\n                            'xlExcel7 (Excel7)\n            ExcelVersion = 5    'acSpreadsheetTypeExcel5 (Microsoft Excel 5.0 format)\n                                'acSpreadsheetTypeExcel7 (Microsoft Excel 95 format)\n        Case 46             'xlXMLSpreadsheet (XML Spreadsheet)\n            ExcelVersion = 10   'acSpreadsheetTypeExcel12Xml (Microsoft Excel 2010 XML format)\n        Case 50, 51         'xlExcel12 (Excel12)\n                            'xlWorkbookDefault (Workbook Default)\n            ExcelVersion = 9    'acSpreadsheetTypeExcel12 (Microsoft Excel 2010 format)\n        Case 56             'xlExcel8   (Excel8)\n            ExcelVersion = 8    'acSpreadsheetTypeExcel8 (Microsoft Excel 97 format)\n                                'acSpreadsheetTypeExcel9 (Microsoft Excel 2000 format)\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>\"strFile2Import\" and \"txtFindFile\" are the file name and full path to be imported that are gotten from a File Dialog box. </p>\n\n<p>My original program didn't have the ExcelVersion function and I had hardcoded acSpreadsheetType as \"acSpreadsheetTypeExcel12XML\" and when I changed that to \"acSpreadsheetTypeExcel9\" it worked correctly once. </p>\n\n<p>What am I missing? </p>\n\n<p>For the record, I have also tried doing a .recalc and .requery to the entire form after performing the import, and that was unsuccessful as well. </p>\n\n<p>Any help you guys can throw my way would be greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 2, "last_activity_date": 1443635670, "creation_date": 1443635670, "answer_id": 32872712, "question_id": 32872635, "link": "https://stackoverflow.com/questions/32872635/working-with-chartobjects/32872712#32872712", "title": "Working with ChartObjects", "body": "<p>Add <code>.Chart</code> near the end of your <code>With</code> statement:</p>\n\n<pre><code>With Worksheets(\"DurationByDate\").ChartObjects(\"DurationByDateChart\").Chart.Axes(xlValue)\n</code></pre>\n"}], "owner": {"reputation": 731, "user_id": 1188470, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9e9032beede85fd517ca7586ed822a05?s=128&d=identicon&r=PG", "display_name": "detroitwilly", "link": "https://stackoverflow.com/users/1188470/detroitwilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 32872712, "answer_count": 1, "score": 1, "last_activity_date": 1443635922, "creation_date": 1443635424, "last_edit_date": 1443635922, "question_id": 32872635, "link": "https://stackoverflow.com/questions/32872635/working-with-chartobjects", "title": "Working with ChartObjects", "body": "<p>I have a quick question regarding modifying the axes of a ChartObject with VBA in Excel.</p>\n\n<p>I have the following code, which modifies the min/max value of an axis based on the data it is charting:</p>\n\n<pre><code>Worksheets(\"DurationByDate\").ChartObjects(\"DurationByDateChart\").Activate\nWith ActiveChart.Axes(xlValue)\n    .MinimumScale = iDurMin - 2\n    .MaximumScale = iDurMax + 2\nEnd With\n</code></pre>\n\n<p>This works well, but I don't like \"activating\" objects if I don't need to.</p>\n\n<p>So I tried the following code:</p>\n\n<pre><code>With Worksheets(\"DurationByDate\").ChartObjects(\"DurationByDateChart\") _\n.Axes(xlValue)\n    .MinimumScale = iDurMin - 2\n    .MaximumScale = iDurMax + 2\nEnd With\n</code></pre>\n\n<p>This code throws an error:</p>\n\n<blockquote>\n  <p>Run-time Error '438': Object doesn't support this property or method</p>\n</blockquote>\n\n<p>Does anyone know why it seems like the chart needs to be active in order to adjust the axes?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1443635667, "post_id": 32872633, "comment_id": 53576999, "body": "What if you have two names that have the same last name and first initial? For example: <code>John Doe</code> and <code>Jane Doe</code>.  Then it would try to name both sheets <code>Doe, J.</code> which would cause an error."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1443636198, "post_id": 32872633, "comment_id": 53577254, "body": "Though technical concerns aside, this line of code should work for you: <code>rs.Name = Split(rs.Range(&quot;B5&quot;).Value, &quot; &quot;)(1) &amp; &quot;, &quot; &amp; Left(Split(rs.Range(&quot;B5&quot;).Value)(0), 1) &amp; &quot;.&quot;</code>"}, {"owner": {"reputation": 19, "user_id": 5394383, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/44efca75b20496f41d096bbd51b25371?s=128&d=identicon&r=PG&f=1", "display_name": "matt rashty", "link": "https://stackoverflow.com/users/5394383/matt-rashty"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1443639320, "post_id": 32872633, "comment_id": 53578916, "body": "Im not worried about having the same last name at this point, but i do see your concern about that"}, {"owner": {"reputation": 19, "user_id": 5394383, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/44efca75b20496f41d096bbd51b25371?s=128&d=identicon&r=PG&f=1", "display_name": "matt rashty", "link": "https://stackoverflow.com/users/5394383/matt-rashty"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1443639536, "post_id": 32872633, "comment_id": 53579029, "body": "And it worked so you are amazing!"}], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1443639247, "last_edit_date": 1443639247, "creation_date": 1443638885, "answer_id": 32873519, "question_id": 32872633, "link": "https://stackoverflow.com/questions/32872633/renaming-a-sheet-based-of-specific-words-in-a-cell/32873519#32873519", "title": "Renaming a sheet based of specific words in a cell", "body": "<p>You need to parse the string with the name first, and hence check if the sheet exists already (if so, adding a counter and make sure you don't name two sheets with the same name). Something like this: </p>\n\n<pre><code>Sub RenameSheet()\n\n'VARIABLES DECLARATION\nDim rs As Worksheet\nDim new_name As String, tmp_new_name As String\nDim counter As Integer: counter = 0\nDim counter1 As Integer: counter1 = 1\nDim allNames As Object\n\n'CODE\nSet allNames = CreateObject(\"Scripting.Dictionary\")\n\nFor Each rs In Sheets\n    'FIRST, LET'S PARSE THE NAME \"LAST NAME\" + \", \" + \"NAME INITIAL\" + \".\"  \n    new_name = Split(rs.Range(\"B5\"), \" \")(1) + \", \" + Left(Split(rs.Range(\"B5\"), \" \")(0), 1) + \".\"\n    'CHECK IF IT EXISTS\n    If allNames.Exists(new_name) Then\n        'ADD A COUNTER \"(N)\" UNTIL IT DOESN'T EXIST ANYMORE\n        tmp_new_name = new_name\n        Do While allNames.Exists(tmp_new_name) &lt;&gt; False\n            tmp_new_name = new_name &amp; \" (\" &amp; counter1 &amp; \")\"\n            counter1 = counter1 + 1\n        Loop\n        counter1 = 1\n        new_name = tmp_new_name\n    End If\n    'RENAME\n    rs.name = new_name\n    counter = counter + 1\n    'KEEP THE NAME STORED IN MEMORY (INTO THE DICTIONARY)\n    allNames.Add rs.name, counter\nNext rs\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5394383, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/44efca75b20496f41d096bbd51b25371?s=128&d=identicon&r=PG&f=1", "display_name": "matt rashty", "link": "https://stackoverflow.com/users/5394383/matt-rashty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 506, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443639314, "creation_date": 1443635414, "last_edit_date": 1443639314, "question_id": 32872633, "link": "https://stackoverflow.com/questions/32872633/renaming-a-sheet-based-of-specific-words-in-a-cell", "title": "Renaming a sheet based of specific words in a cell", "body": "<p>I want to make a macro that will take the value in a cell and rename the sheet using this value. I only want a part the cell value to be used as the sheet name.</p>\n\n<p>For example, in cell A1, it says \"John Doe\"... I want the macro to name that sheet \"Doe, J.\". How would I do that?</p>\n\n<p>I already know how to name the sheet based off the entire cell.</p>\n\n<pre><code>Sub RenameSheet()    \n    Dim rs As Worksheet\n    For Each rs In Sheets\n        rs.Name = rs.Range(\"B5\")\n    Next rs    \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "controls", "userform"], "comments": [{"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1443634632, "post_id": 32872106, "comment_id": 53576449, "body": "See this article <a href=\"https://msdn.microsoft.com/en-us/library/aa733656(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa733656(v=vs.60).aspx</a>"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1443634883, "post_id": 32872106, "comment_id": 53576606, "body": "Also see here: <a href=\"http://stackoverflow.com/questions/12012206/formatting-mm-dd-yyyy-dates-in-textbox-in-vba/12013961#12013961\" title=\"formatting mm dd yyyy dates in textbox in vba\">stackoverflow.com/questions/12012206/&hellip;</a>"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1443636327, "post_id": 32872106, "comment_id": 53577316, "body": "I would advise against using &quot;On Error Resume Next&quot;.  It can mask errors and cause a lot of problems."}], "owner": {"reputation": 61, "user_id": 5177995, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd549c5a16ed5ceea8bde5f8d3649880?s=128&d=identicon&r=PG&f=1", "display_name": "nickelcap", "link": "https://stackoverflow.com/users/5177995/nickelcap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 595, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1443639657, "creation_date": 1443633495, "last_edit_date": 1443639657, "question_id": 32872106, "link": "https://stackoverflow.com/questions/32872106/monthview-multiselect-start-and-end-date-into-cells", "title": "MonthView multiselect Start and End date into cells", "body": "<p>I'm creating a userform, part of which includes a MonthView control set up with the multiselect option enabled. I'm trying to get the start date and end date that the users select into two different cells on the worksheet (let's say A1 and B1 for example). From what I've looked up I understand that you can get the start/end date using SelStart and SelEnd, but I'm unsure of how to do this or how this works. I can get it to put in the first date selected by using something like this:</p>\n\n<pre><code>Private Sub MonthView1_DateClick(ByVal DateClicked As Date)\n   On Error Resume Next\n   Range(\"A1\") = DateClicked\n   Unload Me\nEnd Sub\n</code></pre>\n\n<p>But that doesn't include the last date.</p>\n\n<p>A workaround would be to have two separate MonthView controls programmed like the one above to put the two dates in separately, but I'd much rather use this drag to select functionality if possible.  </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2805, "user_id": 864414, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2188a4ca54a65d0f77ed573329fd5dd1?s=128&d=identicon&r=PG", "display_name": "transistor1", "link": "https://stackoverflow.com/users/864414/transistor1"}, "is_accepted": true, "score": 5, "last_activity_date": 1443632508, "creation_date": 1443632508, "answer_id": 32871829, "question_id": 32871795, "link": "https://stackoverflow.com/questions/32871795/vba-using-a-wild-card-in-filename-to-avoid-processing-a-file/32871829#32871829", "title": "VBA - using a wild card in filename to avoid processing a file", "body": "<p>Try:</p>\n\n<pre><code>If Not fl.Name Like \"*-Help-Me.xlsx\" Then\n</code></pre>\n"}], "owner": {"reputation": 3895, "user_id": 4972716, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a7c5b54d4f13c6bb4d1d4d40ca4d4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Stacey", "link": "https://stackoverflow.com/users/4972716/stacey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 32871829, "answer_count": 1, "score": 1, "last_activity_date": 1585085248, "creation_date": 1443632411, "last_edit_date": 1585085248, "question_id": 32871795, "link": "https://stackoverflow.com/questions/32871795/vba-using-a-wild-card-in-filename-to-avoid-processing-a-file", "title": "VBA - using a wild card in filename to avoid processing a file", "body": "<p>I am looping though a number of directories in VBA and am trying to avoid processing one file in each directory.  The first two letters of the filename changes depending on the directory I am searching.</p>\n\n<p>So for example in one directory the file would be called EE-Help-Me.xlsx and in another it would be called F-Help-Me.xlsx. I have tried to use the wildcard *-Help-Me but have obviously done something wrong as the file is processed. How can I fix this?</p>\n\n<p>My code is:</p>\n\n<pre><code>Sub ListFiles(fld As Object, Mask As String)\nDim fl As Object 'File\nFor Each fl In fld.Files\n    If fl.Name Like Mask Then\n    'open and interrogate file here\n\n       If fl.Name &lt;&gt; \"*-Help-Me.xlsx\" Then '&lt;&lt;-- not catching when the offending file is present\n            Debug.Print fld.Path &amp; \"\\\" &amp; fl.Name\n            'Do something\n       End If\n\n\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "reporting-services", "ssrs-2008", "ssrs-expression"], "comments": [{"owner": {"reputation": 8131, "user_id": 4459617, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9cebe9a45f0438824814ce252c6b0a74?s=128&d=identicon&r=PG&f=1", "display_name": "Hannover Fist", "link": "https://stackoverflow.com/users/4459617/hannover-fist"}, "edited": false, "score": 3, "creation_date": 1443637063, "post_id": 32871453, "comment_id": 53577705, "body": "Aren&#39;t you doing the same thing with the <b>Running Value</b> for <b>MyOtherField</b> as you do with your code (with MyField)? I don&#39;t get what your problem is."}], "owner": {"reputation": 653, "user_id": 3581526, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/31lGf.png?s=128&g=1", "display_name": "Nickso", "link": "https://stackoverflow.com/users/3581526/nickso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1449120265, "creation_date": 1443631245, "last_edit_date": 1449120265, "question_id": 32871453, "link": "https://stackoverflow.com/questions/32871453/how-to-apply-a-code-in-a-runningvalue-expression-in-ssrs", "title": "How to Apply a code in a RunningValue expression in SSRS", "body": "<p>I have the following conundrum:</p>\n\n<p>I made a code inside my report that basically accumulate value, here:</p>\n\n<pre><code>Dim number as Double \n\nFunction Accumulate(ByVal value as Double) As Double\n\nnumber=number + value\n\nReturn number\n\nEnd Function\n</code></pre>\n\n<p>And I made a calculated field like this:</p>\n\n<pre><code>Code.Accumulate(Fields!MyField.Value)\n</code></pre>\n\n<p>Now, the field <code>Myfield</code> It's a number so the Function will run smoothly, the problem is the following expression I want to apply the code:</p>\n\n<pre><code>=FormatNumber(RunningValue(Fields!MyOtherField.Value, Sum,\"Dataset\"), 2)\n</code></pre>\n\n<p>I can't because as you see it have an aggregate function so I can't create a calculated field with this expression.</p>\n\n<p>Is there any way I can apply my code to this expression or I have to create a code that does the same as this expression?</p>\n\n<p>If you need more info, ask away and I will edit my original thread.</p>\n"}, {"tags": ["excel", "insert", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443630376, "post_id": 32870865, "comment_id": 53574093, "body": "Running out of resources is bad XD How many rows do you have?"}, {"owner": {"reputation": 1952, "user_id": 4178262, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MVZ9ZR1BFos/AAAAAAAAAAI/AAAAAAAAAAA/aEP8yOumPbw/photo.jpg?sz=128", "display_name": "Mark Stewart", "link": "https://stackoverflow.com/users/4178262/mark-stewart"}, "edited": false, "score": 0, "creation_date": 1443632915, "post_id": 32870865, "comment_id": 53575529, "body": "Have you tried single-stepping through the code via debug?  I wonder if somehow your code is causing an endless loop."}, {"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "edited": false, "score": 0, "creation_date": 1443635308, "post_id": 32870865, "comment_id": 53576822, "body": "You should used Cells(lRow,1).Value or Range(&quot;A&quot; &amp; lRow).value. Cells takes row and column number (1,1) inputs and Range takes Cell Reference A1 type input"}, {"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443635752, "post_id": 32870865, "comment_id": 53577041, "body": "Also, to build on @findwindow &#39;s questions, depending on how you have lRow declared you could be running out of space there. Integer data types only allow numbers between -32768 and 32767. So if you have more than 32767 rows, you should declare it as Long"}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1443636963, "post_id": 32870865, "comment_id": 53577657, "body": "i found the problem. I had a cell range that I copied, its used to find the last cell in a column and starts at a100000 then uses xlup to find the last row with data. I forgot to change that 100,000 and it pasted roughly 2 million cells of data at once hence the error. But Thanks for the notes and is there a better way to do this insert? it still looks clunky to me."}], "answers": [{"tags": [], "owner": {"reputation": 212, "user_id": 3650464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ec0f9dea5d90a96b766cc97cc5de55?s=128&d=identicon&r=PG&f=1", "display_name": "Brumder", "link": "https://stackoverflow.com/users/3650464/brumder"}, "is_accepted": false, "score": 1, "last_activity_date": 1443646553, "last_edit_date": 1443646553, "creation_date": 1443643369, "answer_id": 32874639, "question_id": 32870865, "link": "https://stackoverflow.com/questions/32870865/find-change-in-col-a-and-insert-4-rows-using-excel-vba/32874639#32874639", "title": "Find change in Col A and insert 4 rows using Excel VBA", "body": "<p>If you want a less-clunky was (as you mentioned), I would default to using arrays to increase speed. Give the code below a try and see what you think. This assumes your data starts in row 6 (if not, change the value of \"offset\" to the final row before the data in question starts). If you want to change how many rows you insert in the future, just change the value of rows_to_insert to the desired number. </p>\n\n<pre><code>Sub insertrows()\n\nDim check_col() As Variant\nDim rng As Range\nDim lcell As Range\nDim i As Long\nDim rows_to_insert As Long\nDim rows_added As Long\nDim offset As Long\nDim insert_cell As Long\n\nWorksheets(\"HR-Calc\").Activate\nlrow = Cells(Cells.Rows.Count, \"A\").End(xlUp).Row\nSet lcell = Cells(lrow, 1)\nSet rng = Range(\"A6\", lcell)\ncheck_col = rng\nrows_to_insert = 4\nrows_added = 0\noffset = 5\n\nrows_added = 0\nFor i = 1 To (UBound(check_col, 1) - 1)\n    If check_col(i, 1) &lt;&gt; check_col(i + 1, 1) Then\n        check_col(i, 1) = i + rows_added + offset\n        rows_added = rows_added + rows_to_insert\n    Else: check_col(i, 1) = VBnllstring\n    End If\nNext i\ncheck_col(UBound(check_col, 1), 1) = vbNullString\nrows_to_insert = rows_to_insert - 1\nFor i = 1 To UBound(check_col, 1)\n    If check_col(i, 1) &lt;&gt; vbNullString Then\n        insert_cell = check_col(i, 1) + 1\n        Range(Cells(insert_cell, 1), Cells(insert_cell + rows_to_insert, 1)).EntireRow.Select\n        Range(Cells(insert_cell, 1), Cells(insert_cell + rows_to_insert, 1)).EntireRow.Insert\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1443644413, "post_id": 32874736, "comment_id": 53581277, "body": "Col A is a count for location ID. the ID will restart every so often. block1 box1, block1 box2, block1 box3, block2 box 1 block 2 box2, block3 box1 etc etc. I insert 4 rows with every change that way I didn&#39;t need to run this macro twice once for the block #, and again for the box #."}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "reply_to_user": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1443644925, "post_id": 32874736, "comment_id": 53581511, "body": "Yes - that is what is assumed... It filters by each block# then inserts 4 rows below the last row (which will be a transition to the next block#)"}], "tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": true, "score": 1, "last_activity_date": 1443643785, "creation_date": 1443643785, "answer_id": 32874736, "question_id": 32870865, "link": "https://stackoverflow.com/questions/32870865/find-change-in-col-a-and-insert-4-rows-using-excel-vba/32874736#32874736", "title": "Find change in Col A and insert 4 rows using Excel VBA", "body": "<p>A neater way would be to use an autofilter on the table</p>\n\n<p>(The code assumes that column A is a sorted integer ID - as seems to be the case from the image)</p>\n\n<pre><code>Sub InsertRowsBetweenIncrements()\n\n    Dim ws As Worksheet: Set ws = Worksheets(\"HR-Calc\")\n    Dim HeaderRow As Long: HeaderRow = 4\n\n    Application.ScreenUpdating = False\n\n        Dim LastRow As Long: LastRow = ws.Columns(1).Find(\"*\", _\n            SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        Dim LastCol As Long: LastCol = ws.Cells.Find(\"*\", _\n            SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n        Dim Tbl As Range: Set Tbl = ws.Range(Cells(HeaderRow, 1), Cells(LastRow, LastCol))\n        Dim i As Long, j As Long\n\n        For i = ws.Cells(LastRow, 1).Value To 1 Step -1\n            Tbl.AutoFilter Field:=1, Criteria1:=i\n            j = Tbl.SpecialCells(xlCellTypeVisible).SpecialCells(xlCellTypeLastCell).Row\n            Tbl.AutoFilter\n            If j &lt;&gt; HeaderRow And j &lt; LastRow Then _\n                ws.Rows(j + 1 &amp; \":\" &amp; j + 4).Insert Shift:=xlDown\n        Next i\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 32874736, "answer_count": 2, "score": 2, "last_activity_date": 1443646553, "creation_date": 1443629296, "last_edit_date": 1531164843, "question_id": 32870865, "link": "https://stackoverflow.com/questions/32870865/find-change-in-col-a-and-insert-4-rows-using-excel-vba", "title": "Find change in Col A and insert 4 rows using Excel VBA", "body": "<p>I'm trying to get my code to insert four rows every time it finds a difference in the cell below. If A5-55 = 1, A56-80 = 2, A81 - 100 = 3 I want the code to see that 56 isn't equal to 55 and insert 4 rows, then continue down the A column until there are no more values.</p>\n\n<p>I keep getting an error from Excel,</p>\n\n<blockquote>\n  <p>can not complete task. Resources error</p>\n</blockquote>\n\n<p>And then a runtime 1004 insert method of range class failed, and the debugger highlights the code for inserting rows</p>\n\n<p><a href=\"https://i.stack.imgur.com/wiC7Q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wiC7Q.png\" alt=\"Enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/NRtlW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NRtlW.png\" alt=\"Enter image description here\"></a></p>\n\n<p>This is what my data looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jf1Ki.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jf1Ki.png\" alt=\"Enter image description here\"></a></p>\n\n<pre><code>Worksheets(\"HR-Calc\").Activate\nFor lRow = Cells(Cells.Rows.Count, \"A\").End(xlUp).Row To 6 Step -1\n\nIf Cells(lRow, \"A\") &lt;&gt; Cells(lRow - 1, \"A\") Then\n            Rows(lRow).EntireRow.Insert\n            Rows(lRow).EntireRow.Insert\n            Rows(lRow).EntireRow.Insert\n            Rows(lRow).EntireRow.Insert\nEnd If\nNext lRow\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1443630215, "post_id": 32870809, "comment_id": 53573999, "body": "Is there one column that will have contiguous data down to the last row, for example column A?"}, {"owner": {"reputation": 21, "user_id": 5393919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ba53cbe96f034fbc7f507976988f2b?s=128&d=identicon&r=PG&f=1", "display_name": "Totohydra", "link": "https://stackoverflow.com/users/5393919/totohydra"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1443638457, "post_id": 32870809, "comment_id": 53578443, "body": "My apologies, A is fair game!"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5393919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ba53cbe96f034fbc7f507976988f2b?s=128&d=identicon&r=PG&f=1", "display_name": "Totohydra", "link": "https://stackoverflow.com/users/5393919/totohydra"}, "edited": false, "score": 0, "creation_date": 1443638665, "post_id": 32871224, "comment_id": 53578563, "body": "This works, can watch it loop through the worksheets!"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 21, "user_id": 5393919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ba53cbe96f034fbc7f507976988f2b?s=128&d=identicon&r=PG&f=1", "display_name": "Totohydra", "link": "https://stackoverflow.com/users/5393919/totohydra"}, "edited": false, "score": 1, "creation_date": 1443638938, "post_id": 32871224, "comment_id": 53578720, "body": "Yeah, there are fast ways to do things but if it&#39;s a one time thing or something like that, I go with a simple loop. Sometimes it&#39;s easier to see what is going on and feel comfortable that it&#39;s working."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1443630943, "last_edit_date": 1443630943, "creation_date": 1443630459, "answer_id": 32871224, "question_id": 32870809, "link": "https://stackoverflow.com/questions/32870809/dynamically-populate-column-with-worksheet-name/32871224#32871224", "title": "Dynamically populate column with worksheet name", "body": "<p>Loop though the rows and check a column for data, then write the name in that row if it exists.</p>\n\n<pre><code>Sub Worksheet_Name_Plop()\n    Dim lRow As Long\n    Dim ws As Excel.Worksheet\n    Dim iIndex As Integer\n\n    For iIndex = 1 To ActiveWorkbook.Worksheets.count\n\n        Set ws = Worksheets(iIndex)\n        ws.Activate\n\n        'Start at row 2\n        lRow = 2\n\n        'Loop through the rows in the worksheet\n        Do While lRow &lt;= ws.UsedRange.Rows.count\n\n            'Check if some column has data\n            If ws.Range(\"A\" &amp; lRow).Value &lt;&gt; \"\" Then\n                 'Write the worksheet name to column AG of that row\n                 ws.Range(\"AG\" &amp; lRow).Value = ws.Name\n            End if\n\n            'Increment you counter\n            lRow = lRow + 1\n            ws.Range(\"A\" &amp; lRow).Activate\n        Loop\n\n       Columns(\"AG\").Select\n       Selection.EntireColumn.AutoFit\n\n    Next iIndex    \n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5393919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ba53cbe96f034fbc7f507976988f2b?s=128&d=identicon&r=PG&f=1", "display_name": "Totohydra", "link": "https://stackoverflow.com/users/5393919/totohydra"}, "edited": false, "score": 0, "creation_date": 1443638982, "post_id": 32871847, "comment_id": 53578746, "body": "Lightning fast indeed! Are the print stats comment line supposed to updated when ran? Also (didn&#39;t see this until tested), can word wrap be disabled for the results?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 21, "user_id": 5393919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ba53cbe96f034fbc7f507976988f2b?s=128&d=identicon&r=PG&f=1", "display_name": "Totohydra", "link": "https://stackoverflow.com/users/5393919/totohydra"}, "edited": false, "score": 0, "creation_date": 1443641847, "post_id": 32871847, "comment_id": 53580101, "body": "I updated it to include <code>.WrapText = False</code> and also a slightly faster alternative (<code>.FillDown</code>). The print stats line will update when executed but you&#39;ll have to open the Immediate Window: in VBA editor - View -&gt; Immediate Window (<code>Ctrl+G</code>)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443644324, "post_id": 32871847, "comment_id": 53581231, "body": "Increased by .1 second. Flagged =P"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443652249, "post_id": 32871847, "comment_id": 53584568, "body": "Finally getting to reading the code XD HUH. So <code>with</code> is slower eh. Good to know ^_^"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1443653255, "post_id": 32871847, "comment_id": 53584835, "body": "@findwindow - no, <code>with</code> is faster, but in the second option the <code>.FillDown</code> is faster (I&#39;ll have to test this: both solutions using <code>with</code>, the 1st changed to use <code>.Value2 = </code>, and 1 million records in each sheet)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443710093, "post_id": 32871847, "comment_id": 53610128, "body": "9 seconds for 10 million rows. Now you&#39;re just bragging. Flagged =P"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 3, "last_activity_date": 1443698186, "last_edit_date": 1443698186, "creation_date": 1443632559, "answer_id": 32871847, "question_id": 32870809, "link": "https://stackoverflow.com/questions/32870809/dynamically-populate-column-with-worksheet-name/32871847#32871847", "title": "Dynamically populate column with worksheet name", "body": "<p>10 million rows in 9 seconds:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub setID1()\n    Const FIRST_ROW As Long = 2\n    Const COL       As String = \"AG\"\n    Dim ws As Worksheet, lastRow As Long, t As Double, tr As Long\n\n    Application.ScreenUpdating = False: t = Timer\n    For Each ws In Application.ActiveWorkbook.Worksheets\n        lastRow = ws.UsedRange.Row + ws.UsedRange.Rows.Count - 1\n\n        ws.Range(COL &amp; FIRST_ROW &amp; \":\" &amp; COL &amp; lastRow).Value2 = ws.Name\n        With ws.Cells(FIRST_ROW, COL)\n            .WrapText = False\n            .EntireColumn.AutoFit\n        End With\n        tr = tr + lastRow - FIRST_ROW + 1\n    Next\n    Debug.Print \"setID1 - Sheets: \" &amp; Worksheets.Count &amp; _\n                       \", Rows: \" &amp; tr &amp; \", Duration: \" &amp; Timer - t\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub setID2()\n    Const FIRST_ROW As Long = 2\n    Const COL       As String = \"AG\"\n    Dim ws As Worksheet, lastRow As Long, t As Double, tr As Long\n\n    Application.ScreenUpdating = False: t = Timer\n    For Each ws In Application.ActiveWorkbook.Worksheets\n        lastRow = ws.UsedRange.Row + ws.UsedRange.Rows.Count - 1\n\n        With ws.Cells(FIRST_ROW, COL)\n            .Value2 = ws.Name\n            .WrapText = False\n            .EntireColumn.AutoFit\n        End With\n        ws.Range(COL &amp; FIRST_ROW &amp; \":\" &amp; COL &amp; lastRow).FillDown\n        tr = tr + lastRow - FIRST_ROW + 1\n    Next\n    Debug.Print \"setID2 - Sheets: \" &amp; Worksheets.Count &amp; _\n                       \", Rows: \" &amp; tr &amp; \", Duration: \" &amp; Timer - t\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Tests:</p>\n\n<pre><code>setID1 - Sheets: 10, Rows: 10000000, Duration: 9.08203125\nsetID1 - Sheets: 10, Rows: 10000000, Duration: 9.064453125\nsetID1 - Sheets: 10, Rows: 10000000, Duration: 9.0625\n\nsetID2 - Sheets: 10, Rows: 10000000, Duration: 8.580078125\nsetID2 - Sheets: 10, Rows: 10000000, Duration: 8.58203125\nsetID2 - Sheets: 10, Rows: 10000000, Duration: 8.56640625\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5393919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90ba53cbe96f034fbc7f507976988f2b?s=128&d=identicon&r=PG&f=1", "display_name": "Totohydra", "link": "https://stackoverflow.com/users/5393919/totohydra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 32871847, "answer_count": 2, "score": 1, "last_activity_date": 1443698186, "creation_date": 1443629143, "last_edit_date": 1531161705, "question_id": 32870809, "link": "https://stackoverflow.com/questions/32870809/dynamically-populate-column-with-worksheet-name", "title": "Dynamically populate column with worksheet name", "body": "<p>I need to populate cells within a specific column with the name of the worksheet.</p>\n\n<p>I have the following code for populating a single cell:</p>\n\n<pre><code>Sub Worksheet_Name_Plop()\n    Cells.WrapText = False ' Disables WordWrap\n    [AG2].Value = ActiveSheet.Name\n    Columns(\"AG\").Select\n    Selection.EntireColumn.AutoFit\nEnd Sub\n</code></pre>\n\n<p>The trouble I'm having is there may be anywhere from one to 10,000+ lines of data per worksheet. Not sure of how to populate just the rows that have data. </p>\n\n<p>There is a header row so it's important that the results start on the second row of each worksheet.</p>\n\n<p>For efficiency: I also need to be able to do this across all worksheets of the same file.</p>\n\n<p>Any assistance greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1443628401, "post_id": 32870502, "comment_id": 53572801, "body": "Sort the data on column M descending and then Data \u25ba Remove Duplicates on column B. Remove Duplicates always removes the duplicate from the higher row number."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5393937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7cd8fc3a8732fd09b4310d00cc55e3bc?s=128&d=identicon&r=PG&f=1", "display_name": "justinua", "link": "https://stackoverflow.com/users/5393937/justinua"}, "edited": false, "score": 0, "creation_date": 1443631377, "post_id": 32870784, "comment_id": 53574693, "body": "Thanks for your advice. The one issue is that there are also some values in column M that are blank so they get sorted to the bottom; however those still might need to get deleted if the value in column L = 0. Is there any way to complete this task using VBA?"}], "tags": [], "owner": {"reputation": 11, "user_id": 5393633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-q7cTPaHJP78/AAAAAAAAAAI/AAAAAAAABb4/9DWtluvQHek/photo.jpg?sz=128", "display_name": "Jottie", "link": "https://stackoverflow.com/users/5393633/jottie"}, "is_accepted": false, "score": 0, "last_activity_date": 1443629071, "creation_date": 1443629071, "answer_id": 32870784, "question_id": 32870502, "link": "https://stackoverflow.com/questions/32870502/delete-duplicates-where-the-value-of-another-column-in-the-same-row-0/32870784#32870784", "title": "Delete duplicates where the value of another column in the same row = 0", "body": "<p>Unless you need to frequently repeat the same process, you can also just filter those rows that match your criteria and manually delete them.</p>\n\n<p>Provided your data is sorted based on column B, you can add a formula in column M that compares the values for each cell in column B with the value above and below to identify duplicates. </p>\n\n<p>The following formula will check if cell B matches value above <strong>OR</strong> below <strong>AND</strong> if column M=0 and result in True/False.\n=AND(OR(B2=B1,B2=B3), M2=0)</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 5393937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7cd8fc3a8732fd09b4310d00cc55e3bc?s=128&d=identicon&r=PG&f=1", "display_name": "justinua", "link": "https://stackoverflow.com/users/5393937/justinua"}, "edited": false, "score": 0, "creation_date": 1443636775, "post_id": 32872543, "comment_id": 53577556, "body": "Thank you, I will give that a shot!"}, {"owner": {"reputation": 2805, "user_id": 864414, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2188a4ca54a65d0f77ed573329fd5dd1?s=128&d=identicon&r=PG", "display_name": "transistor1", "link": "https://stackoverflow.com/users/864414/transistor1"}, "reply_to_user": {"reputation": 53, "user_id": 5393937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7cd8fc3a8732fd09b4310d00cc55e3bc?s=128&d=identicon&r=PG&f=1", "display_name": "justinua", "link": "https://stackoverflow.com/users/5393937/justinua"}, "edited": false, "score": 0, "creation_date": 1443638902, "post_id": 32872543, "comment_id": 53578696, "body": "Saw your comment on the other answer - updated the 2nd code snippet to handle NULLs in column B"}], "tags": [], "owner": {"reputation": 2805, "user_id": 864414, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2188a4ca54a65d0f77ed573329fd5dd1?s=128&d=identicon&r=PG", "display_name": "transistor1", "link": "https://stackoverflow.com/users/864414/transistor1"}, "is_accepted": true, "score": 0, "last_activity_date": 1443638863, "last_edit_date": 1443638863, "creation_date": 1443635033, "answer_id": 32872543, "question_id": 32870502, "link": "https://stackoverflow.com/questions/32870502/delete-duplicates-where-the-value-of-another-column-in-the-same-row-0/32872543#32872543", "title": "Delete duplicates where the value of another column in the same row = 0", "body": "<p>Here's a simple way in VBA, that queries your spreadsheet like a table.  You'll have to adapt the RunQuery() method for your particular case, because I don't know your column names.</p>\n\n<p>This assumes the following:</p>\n\n<ol>\n<li>Your worksheet is laid out like a table, with column names in row 1, and data below it</li>\n<li>You've saved your workbook before running this code</li>\n</ol>\n\n<p>In my particular workbook, I have a Column labeled \"Category\", one labeled \"Types\", and I've added a column called \"DeleteMe\".</p>\n\n<pre><code>'Adapt RunQuery for your particular needs\nSub RunQuery()\n    'Change this SQL statement to reflect your particular need\n    SQL = \"SELECT [Category], [Types] FROM %table(0)% GROUP BY [Category], [Types] HAVING Count(*) &gt; 1\"\n\n    'Change \"Sheet2\" to your sheet name\n    Set rs = QuerySheet(SQL, Sheet2)\n\n    Do While Not rs.EOF\n        SQL = \"UPDATE %table(0)% SET [DeleteMe]='x' WHERE [Category]='\" &amp; rs!Category &amp; \"' AND [Types]='\" &amp; rs!Types &amp; \"'\"\n        'Again, change Sheet2 to your sheet name\n        QuerySheet SQL, Sheet2\n        rs.MoveNext\n    Loop\nEnd Sub\n\n'You don't need to change this function\nFunction QuerySheet(sSQL, ParamArray Worksheets())\n    Dim oSh\n    Dim sConn, n\n\n    On Error GoTo QuerySheet_Err\n    Set QuerySheet = CreateObject(\"ADODB.Recordset\")\n    sConn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; Worksheets(0).Parent.FullName &amp; \";Extended Properties=\"\"Excel 8.0;HDR=Yes\"\";\"\n\n    n = 0\n    For Each oSh In Worksheets\n        sSQL = Replace(sSQL, \"%table(\" &amp; n &amp; \")%\", \"[\" &amp; oSh.Name &amp; \"$]\")\n        n = n + 1\n    Next\n    QuerySheet.Open sSQL, sConn\n    Exit Function\n\nQuerySheet_Err:\n    MsgBox \"Error in QuerySheet(): \" &amp; Err.Description\n    End\nEnd Function\n</code></pre>\n\n<p><a href=\"http://fieldeffect.info/wp/frontpage/vba_library/#QuerySheet_Run_SQL_queries_directly_on_Excel_worksheets\" rel=\"nofollow\">Source</a></p>\n\n<p>The code updates the \"DeleteMe\" column with an x.  Now, you can sort by the \"DeleteMe\", and delete the rows (or write a simple VBA statement to do that).</p>\n\n<p><strong>Your</strong> RunQuery() method will need to look more like this, replacing \"column B\" and \"column M\" with the names of the fields in your sheet's header row:</p>\n\n<pre><code>    ...\n\n    'Change this SQL statement to reflect your particular need\n    SQL = \"SELECT [column B] FROM %table(0)% WHERE [column M] = 0 GROUP BY [column B] HAVING Count(*) &gt; 1\"\n\n    'Change \"Sheet2\" to your sheet name\n    Set rs = QuerySheet(SQL, Sheet2)\n\n    Do While Not rs.EOF\n        SQL = \"UPDATE %table(0)% SET [DeleteMe]='x' \" &amp; _\n           \" WHERE \" &amp; _\n           IIf(IsNull(rs![column B]), _\n               \" [column B] IS NULL\", _\n               \" [column B]='\" &amp; rs![column B] &amp; \"' \") &amp; _\n           \" AND [column M]=0\"\n\n        'Again, change Sheet2 to your sheet name\n        QuerySheet SQL, Sheet2\n\n    ...\n</code></pre>\n\n<p><strong>Note</strong>: Sometimes you get debug errors when you change the names of the worksheets from \"Sheet1\" to something else... Haven't worked that issue out yet.  But this works well for \"Quick N' Dirty\" queries.</p>\n"}, {"tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": false, "score": 0, "last_activity_date": 1443645945, "creation_date": 1443645945, "answer_id": 32875315, "question_id": 32870502, "link": "https://stackoverflow.com/questions/32870502/delete-duplicates-where-the-value-of-another-column-in-the-same-row-0/32875315#32875315", "title": "Delete duplicates where the value of another column in the same row = 0", "body": "<p>You could try this without VBA: </p>\n\n<p>Add a column with formula </p>\n\n<pre><code>=B1&amp;IF(M1=0,\"\",RAND()*9999999)\n</code></pre>\n\n<p>This will create a unique entry if M1=0</p>\n\n<p>Copy paste the new column to values</p>\n\n<p>Do the regular 'Remove duplicates' routine, based on the new column. </p>\n\n<p>Remove the new column</p>\n"}], "owner": {"reputation": 53, "user_id": 5393937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7cd8fc3a8732fd09b4310d00cc55e3bc?s=128&d=identicon&r=PG&f=1", "display_name": "justinua", "link": "https://stackoverflow.com/users/5393937/justinua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 966, "favorite_count": 0, "accepted_answer_id": 32872543, "answer_count": 3, "score": 0, "last_activity_date": 1443645945, "creation_date": 1443628210, "question_id": 32870502, "link": "https://stackoverflow.com/questions/32870502/delete-duplicates-where-the-value-of-another-column-in-the-same-row-0", "title": "Delete duplicates where the value of another column in the same row = 0", "body": "<p>I have a worksheet with ~30k rows of data and 20 columns. A lot of the values in column B are duplicates, and I would like to delete those duplicates. The problem I have is that even though column b may be a duplicate, that row's data in the rest of the columns are not necessarily a duplicate, so it's important that we only delete the row if the value in column B is a duplicate AND the value in column M = 0.</p>\n\n<p>Is there a way to do do this for each row in the worksheet (the worksheet name is Test)? I imagine it involves \"For Each...\", but i don't have a lot of experience with that and haven't been able to find any other macros that can complete this task. Let me know if you need me to elaborate on what I am trying to accomplish.</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["excel", "image", "vba"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1443634290, "post_id": 32869698, "comment_id": 53576253, "body": "I wonder if you can set ShapeRange.ScaleWidth to 1? There&#39;s a RelativeToOriginalSize argument."}], "owner": {"reputation": 401, "user_id": 2812977, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/iudgu.jpg?s=128&g=1", "display_name": "Rocky Scott", "link": "https://stackoverflow.com/users/2812977/rocky-scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1443637194, "creation_date": 1443625959, "last_edit_date": 1443637194, "question_id": 32869698, "link": "https://stackoverflow.com/questions/32869698/get-dimensions-of-cell-comment-background-image-shape-fill-userpicture", "title": "Get Dimensions of Cell Comment Background Image (.Shape.Fill.UserPicture)", "body": "<p>How do I get the dimensions of a cell comment background image?</p>\n\n<p>I have created a comment composed solely of a background image using,</p>\n\n<p><code>ActiveCell.Comment.Shape.Fill.UserPicture    l_strFullPathOfImagePNG</code></p>\n\n<p>I would like to be able to,</p>\n\n<ol>\n<li>Select the cell.</li>\n<li>Run a macro that resizes the comment so the background image is not fuzzy, but rather sized exactly pixel for pixel.</li>\n</ol>\n\n<p>To do this I need to know the dimensions of the background image.</p>\n\n<p>If I know the full path of the image file that created the background image, I can resize the cell comment to achieve what I want:</p>\n\n<pre><code>Sub CommentResizeToFitBackgroundImage()\n\n   Dim l_strFullPathOfImagePNG As String\n   Dim l_lImageWidth_pixels As Long, _\n       l_lImageHeight_pixels As Long\n\n   l_strFullPathOfImagePNG = \"C:\\\u2026\u2026\\BackgroundImage.png\"\n\n   'Get the width and height in pixels of the image to be inserted\n   GetPNGDimensions _\n         l_strFullPathOfImagePNG, _\n         l_lImageWidth_pixels, _\n         l_lImageHeight_pixels\n\n   With ActiveCell.Comment.Shape\n\n      '0.75 scale factor was arrived at empirically\n      'and probably true only for my machine\n      .Width = l_lImageWidth_pixels * 0.75\n      .Height = l_lImageHeight_pixels * 0.75\n\n   End With\nEnd Sub\n</code></pre>\n\n<p>However, I would like to do this to existing comments that no longer have a valid image file to read, so I need to get the dimensions of the background image.</p>\n\n<p><code>.Comment.Shape.ScaleHeight 1, msoTrue</code> looks promising, but fails with the error \"The RelativeToOriginalSize argument applies only to a picture or an OLE object\".</p>\n\n<p><code>.Comment.Shape.Fill.Type</code> = <code>MsoFillType.msoFillPicture</code>; so I do indeed have a picture, and not a solid background, gradient, pattern, or texture; so I don't know what the compiler is complaining about.</p>\n\n<p>Lastly, evidently, <code>.Comment.Shape.Fill.PictureEffects</code> doesn't work for comments.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443625642, "post_id": 32869566, "comment_id": 53570940, "body": "Add it behind <code>xlPasteValues</code>. Might need a comma."}, {"owner": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443625840, "post_id": 32869566, "comment_id": 53571063, "body": "That was my first thought, tried it and it gives me a 1004 error on that line with comma, and a compile error without."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1443626474, "post_id": 32869566, "comment_id": 53571476, "body": "Immediately after the <code>PasteSpecial</code> line of code, put in a second <code>PasteSpecial</code> line of code for the xlPasteFormats"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443626829, "post_id": 32869566, "comment_id": 53571711, "body": "Wait, you can&#39;t paste values AND formats??? I mean the point of values is you don&#39;t want formats XD"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1443627631, "post_id": 32869566, "comment_id": 53572265, "body": "@findwindow That may be true in some cases, but it is very commonly used to bring in data without the formulas.  In that case you may still want the formats."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443628074, "post_id": 32869566, "comment_id": 53572560, "body": "Ah ok. You can see I never copy paste formats XD"}], "answers": [{"tags": [], "owner": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "is_accepted": true, "score": 1, "last_activity_date": 1443626491, "creation_date": 1443626491, "answer_id": 32869892, "question_id": 32869566, "link": "https://stackoverflow.com/questions/32869566/excel-vba-pastespecial/32869892#32869892", "title": "Excel VBA PasteSpecial", "body": "<p>It's not a pretty answer, but </p>\n\n<pre><code>pasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(-4, 0).PasteSpecial xlPasteFormats\n</code></pre>\n\n<p>That does end up working.  I put that right below the first pasteSheet line.</p>\n\n<p>Now I have to insert the month of the year in the first cell after pasting... that will be fun.</p>\n"}], "owner": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "accepted_answer_id": 32869892, "answer_count": 1, "score": 1, "last_activity_date": 1443626491, "creation_date": 1443625559, "question_id": 32869566, "link": "https://stackoverflow.com/questions/32869566/excel-vba-pastespecial", "title": "Excel VBA PasteSpecial", "body": "<pre><code>Set copySheet = Worksheets(\"Metrics\")\nSet pasteSheet = Worksheets(\"Metrics\")\n\ncopySheet.Range(\"A1:J5\").Copy\npasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(2, 0).PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>I have written this chunk of VBA code and it does mostly what I want it to do, but what I cannot figure out is how to apply a second pastespecial to get the formats from the Copied section to the newly pasted section.  I tried adding a second .PasteSpecial xlPasteFormats under the first pastespecial line, but the macro fails at that point.</p>\n\n<p>Any ideas about how to get the format to the newly pasted section?</p>\n"}, {"tags": ["excel", "find", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1443625910, "post_id": 32869239, "comment_id": 53571109, "body": "Have a look here, the question is pretty similar and you should be able to adapt the solution to your needs: <a href=\"http://stackoverflow.com/questions/18262403/excel-vba-find-row-number-where-colum-data-multiple-clauses\" title=\"excel vba find row number where colum data multiple clauses\">stackoverflow.com/questions/18262403/&hellip;</a>"}, {"owner": {"reputation": 77, "user_id": 5393648, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/548f0ddf898665cae9e8c94dfc4286fd?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5393648/johndoe"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1443714346, "post_id": 32869239, "comment_id": 53613024, "body": "worked like a charm!"}], "answers": [{"tags": [], "owner": {"reputation": 216, "user_id": 5045578, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9-VygvgDnJY/AAAAAAAAAAI/AAAAAAAAEi4/-NYkWDu8Zek/photo.jpg?sz=128", "display_name": "Michal Schmitt", "link": "https://stackoverflow.com/users/5045578/michal-schmitt"}, "is_accepted": false, "score": 0, "last_activity_date": 1443626617, "creation_date": 1443626617, "answer_id": 32869935, "question_id": 32869239, "link": "https://stackoverflow.com/questions/32869239/excel-vba-find-method-searching-for-2-values-in-a-row-writing-a-value/32869935#32869935", "title": "Excel VBA Find.Method , searching for 2 Values in a row writing a value", "body": "<p>Advanced filtering would help you identify rows matching your criteria.  </p>\n\n<p>Data > Sort &amp; Filter > Advanced</p>\n\n<p><a href=\"https://support.office.com/en-ie/article/Filter-by-using-advanced-criteria-4c9222fe-8529-4cd7-a898-3f16abdff32b\" rel=\"nofollow noreferrer\">Microsoft Support - Filter by using advanced criteria</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Se7ec.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Se7ec.png\" alt=\"Advanced Filter\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 5393648, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/548f0ddf898665cae9e8c94dfc4286fd?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5393648/johndoe"}, "edited": false, "score": 0, "creation_date": 1443696991, "post_id": 32870529, "comment_id": 53601413, "body": "Hi, thanks, unfortunately it tells me here     N = Cells(Rows.Count, A).End(xlUp).Row is a problem,    A runtime error 1004 &quot;Application-defined or object-defined error&quot;"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 77, "user_id": 5393648, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/548f0ddf898665cae9e8c94dfc4286fd?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5393648/johndoe"}, "edited": false, "score": 0, "creation_date": 1443697542, "post_id": 32870529, "comment_id": 53601744, "body": "@JohnDoe  This will happen if column <b>A</b> is empty.  In my example, I use column <b>A</b>, which columns are you using??"}, {"owner": {"reputation": 77, "user_id": 5393648, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/548f0ddf898665cae9e8c94dfc4286fd?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5393648/johndoe"}, "edited": false, "score": 0, "creation_date": 1443714616, "post_id": 32870529, "comment_id": 53613189, "body": "Hi, i actually use columns F and G , filled from F1 to G11, and adapted the code .  Private Sub ToggleButton1_Click() If ToggleButton1.Value = True Then Dim num As Long, row As Long, search1 As String, search2 As String, result As String Dim rotalrng As Range, currentrng As Range, count As WorksheetFunction Set count = Application.WorksheetFunction search1 = &quot;a&quot; search2 = &quot;b&quot; result = &quot;Yes&quot; num = Cells(Rows.count, F).End(xlUp).row Set totalrng = Range(&quot;F1:G&quot; &amp; num) For row = 1 To num     Set currentrng = Intersect(Rows(row), totalrng)"}, {"owner": {"reputation": 77, "user_id": 5393648, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/548f0ddf898665cae9e8c94dfc4286fd?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5393648/johndoe"}, "edited": false, "score": 0, "creation_date": 1443714911, "post_id": 32870529, "comment_id": 53613353, "body": "If count.CountIf(currentrng, search1) &gt; 0 And count.CountIf(currentrng, search2) &gt; 0 Then         Cells(row, &quot;H&quot;) = result         End If Next row End If End Sub"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1443628300, "creation_date": 1443628300, "answer_id": 32870529, "question_id": 32869239, "link": "https://stackoverflow.com/questions/32869239/excel-vba-find-method-searching-for-2-values-in-a-row-writing-a-value/32870529#32870529", "title": "Excel VBA Find.Method , searching for 2 Values in a row writing a value", "body": "<p>Starting with data like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jn9xZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jn9xZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Running this macro:</p>\n\n<pre><code>Sub dural()\n   Dim N As Long, i As Long, A As String, C As String, v As String\n   Dim rng1 As Range, rng2 As Range, wf As WorksheetFunction\n   Set wf = Application.WorksheetFunction\n   A = \"A\"\n   C = \"C\"\n   v = \"VALUE\"\n   N = Cells(Rows.Count, A).End(xlUp).Row\n   Set rng1 = Range(\"A1:C\" &amp; N)\n\n   For i = 1 To N\n      Set rng2 = Intersect(Rows(i), rng1)\n      If wf.CountIf(rng2, A) &gt; 0 And wf.CountIf(rng2, C) &gt; 0 Then\n         Cells(i, \"D\") = v\n      End If\n   Next i\nEnd Sub\n</code></pre>\n\n<p>will produce:</p>\n\n<p><a href=\"https://i.stack.imgur.com/twKqE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/twKqE.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 77, "user_id": 5393648, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/548f0ddf898665cae9e8c94dfc4286fd?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5393648/johndoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3515, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1443628300, "creation_date": 1443624695, "last_edit_date": 1531161705, "question_id": 32869239, "link": "https://stackoverflow.com/questions/32869239/excel-vba-find-method-searching-for-2-values-in-a-row-writing-a-value", "title": "Excel VBA Find.Method , searching for 2 Values in a row writing a value", "body": "<p>I want to search within a table e.g.  </p>\n\n<p>A B C<br>\nD E C<br>\nA H I<br>\nA H C<br>\nFor the Values  </p>\n\n<p>\"A\" and \"C\" and then put the Value \"Value\" into a cell in the rows where both Values have been found.<br>\nI am fairly new to the whole topic so i searched first on the web to find pieces of code that could help me. </p>\n\n<pre><code>Dim FirstAddress As String\nDim SecondAddress As String\nDim MyArr As Variant\nDim MyArr2 As Variant\nDim Rng As Range\nDim Row As Range\nDim I As Long\nDim B As Long\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\nMyArr = Array(\"A\")\nMyArr2 = Array(\"C\")\nWith Sheets(\"Sheet1\").Range(\"F:F\")\n    .Offset(0, 27).ClearContents\n    For I = LBound(MyArr) To UBound(MyArr)\n        Set Rng = .Find(What:=MyArr(I), After:=.Cells(.Cells.Count), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not Rng Is Nothing Then\n            FirstAddress = Rng.Address\n            Do\n                    Set Rng2 = Rng.EntireRow.Find(What:=MyArr2(I), After:=.Cells(.Cells.Count), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n                    If Not Row Is Nothing Then\n                        SecondAdress = Row.Address\n                        Do\n                            Rng.Offset(0, 27).Value = \"Value\"\n                            Set Row = .FindNext(Row)\n\n                Set Rng = .FindNext(Rng)\n            Loop While Not Rng Is Nothing And Rng.Address &lt;&gt; FirstAddress\n        End If\n    Next I\nEnd With\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\n</code></pre>\n\n<p>It worked for me searching for one value with the .find method, but i struggle to search for the rows that contain both values.\n(The Array in case i want to search for more than one value, say all that have at the beginning A Or D and then a C in the third column)</p>\n\n<p>Do you have any idea?\nI dont get how i could implemented several loops.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1443630801, "post_id": 32869632, "comment_id": 53574357, "body": "I just stuck in c:\\temp\\ as a path example. But yes, &#39;Environ(&quot;Temp&quot;)&#39; would get that for you.  Wouldn&#39;t it actually get the users\\temp directory?"}, {"owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1443631116, "post_id": 32869632, "comment_id": 53574550, "body": "Well, it depends on the environment, but yes it will be something like <code>C:\\Users\\stuartd\\AppData\\Local\\Temp</code>"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 1, "last_activity_date": 1443625751, "creation_date": 1443625751, "answer_id": 32869632, "question_id": 32869131, "link": "https://stackoverflow.com/questions/32869131/temp-file-trying-to-save-to-non-existing-location/32869632#32869632", "title": "Temp file trying to save to non-existing location", "body": "<p>You can add a path to the save location for the temporary file.</p>\n\n<pre><code>'Save temporary file\nLWorkbook.SaveAs Filename:=\"C:\\Temp\\\" &amp; LFileName\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 138, "user_id": 1196836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff57ff1cd61d46ada3d82605584cd77?s=128&d=identicon&r=PG", "display_name": "Simon White", "link": "https://stackoverflow.com/users/1196836/simon-white"}, "is_accepted": true, "score": 2, "last_activity_date": 1443625853, "creation_date": 1443625853, "answer_id": 32869665, "question_id": 32869131, "link": "https://stackoverflow.com/questions/32869131/temp-file-trying-to-save-to-non-existing-location/32869665#32869665", "title": "Temp file trying to save to non-existing location", "body": "<p>After your line </p>\n\n<pre><code>LWorkbook.SaveAs Filename:=LFileName\n</code></pre>\n\n<p>put this line:</p>\n\n<pre><code>Debug.Print LWorkbook.FullName\n</code></pre>\n\n<p>Now when your colleague runs it, ask them to open the VBA editor first, and ask them to make sure the Immediate window is shown. Then get them to run it, and ask them what is shown in the Immediate window after the error. (It would be also useful if you say what the actual error was, and where in the code it stops at, but I'll make some assumptions about that!).</p>\n\n<p>When I run your code with my extra line, on a new workbook, my Immediate window shows <code>C:\\Users\\Simon\\Documents\\Sheet1.xlsx</code>. And it then saves the temporary file with that name and folder.</p>\n\n<p>If you can ask your colleague what theirs says, then you can find out if that folder perhaps does not allow write permission (ask them to try to save something into that folder).</p>\n\n<p>If this is the problem (if I have assumed correctly!), then you need to change your <code>SaveAs</code> line to add the path where they do have permission. For example:</p>\n\n<pre><code>LWorkbook.SaveAs Filename:= \"C:\\Users\\xxx\\Documents\\\" &amp; LFileName\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4655840, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152816247618282/picture?type=large", "display_name": "SyntaxJutsu", "link": "https://stackoverflow.com/users/4655840/syntaxjutsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "accepted_answer_id": 32869665, "answer_count": 2, "score": 1, "last_activity_date": 1443625853, "creation_date": 1443624422, "last_edit_date": 1531161705, "question_id": 32869131, "link": "https://stackoverflow.com/questions/32869131/temp-file-trying-to-save-to-non-existing-location", "title": "Temp file trying to save to non-existing location", "body": "<p>I am having issues with the below module. Well, my colleagues are and I don't know how to resolve. When I run the sub myself, it works fine, but some of my colleagues are getting an error. It looks as though it's trying to save the temp file to a folder that doesn't exist.</p>\n\n<p>Is there a way I can amend the code to save the temp file to a specific location?</p>\n\n<p>Thank you.</p>\n\n<pre><code>Sub Email_Sheet()\n\nDim oApp As Object\nDim oMail As Object\nDim LWorkbook As Workbook\nDim LFileName As String\n\nActiveSheet.Calculate\nSubjectPanel = InputBox(\"Please Enter the Time\") &amp; \" text\"\n\n'Turn off screen updating\nApplication.ScreenUpdating = False\n\n'Copy the active worksheet and save to a temporary workbook\nActiveSheet.Copy\nSet LWorkbook = ActiveWorkbook\n\n'Create a temporary file\nLFileName = LWorkbook.Worksheets(1).Name\nOn Error Resume Next\n'Delete the file if it already exists\nKill LFileName\nOn Error GoTo 0\n'Save temporary file\nLWorkbook.SaveAs Filename:=LFileName\n\n'Create an Outlook object and new mail message\nSet oApp = CreateObject(\"Outlook.Application\")\nSet oMail = oApp.CreateItem(0)\n\n\nWith oMail\n    .SentOnBehalfOfName = \"\"\n    .To = \"\" &amp; _\n    \"address\"\n    .CC = \"\" &amp; _\n    \"other address\"\n    .Subject = SubjectPanel\n    .Body = \"Hello all,\" &amp; vbNewLine &amp; vbNewLine &amp; _\n            \"body\" &amp; vbNewLine &amp; vbNewLine &amp; _\n            \"Thank you.\"\n    .Attachments.Add LWorkbook.FullName\n  .Display\nEnd With\n\n'Delete the temporary file and close temporary Workbook\nLWorkbook.ChangeFileAccess Mode:=xlReadOnly\nKill LWorkbook.FullName\nLWorkbook.Close SaveChanges:=False\n\n'Turn back on screen updating\nApplication.ScreenUpdating = True\nSet oMail = Nothing\nSet oApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "email"], "comments": [{"owner": {"reputation": 938, "user_id": 835677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68ecafab42b0b9cb26ca9f1b8df4f18c?s=128&d=identicon&r=PG", "display_name": "tlbignerd", "link": "https://stackoverflow.com/users/835677/tlbignerd"}, "edited": false, "score": 0, "creation_date": 1443623640, "post_id": 32868735, "comment_id": 53569549, "body": "I see the On Error Resume Next already in your code. Is an error being raised on the .Send line even with your this in place?"}, {"owner": {"reputation": 105, "user_id": 5093451, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c274f79ce13c1a76c2654d33d5abb883?s=128&d=identicon&r=PG&f=1", "display_name": "Becky", "link": "https://stackoverflow.com/users/5093451/becky"}, "reply_to_user": {"reputation": 938, "user_id": 835677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68ecafab42b0b9cb26ca9f1b8df4f18c?s=128&d=identicon&r=PG", "display_name": "tlbignerd", "link": "https://stackoverflow.com/users/835677/tlbignerd"}, "edited": false, "score": 0, "creation_date": 1443624070, "post_id": 32868735, "comment_id": 53569835, "body": "The trouble is I don&#39;t know because it works on my machine.  The macro will be used on a number of different versions of systems, so I want to make as sure as I can that the debug error won&#39;t pop up if there is a problem."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 5093451, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c274f79ce13c1a76c2654d33d5abb883?s=128&d=identicon&r=PG&f=1", "display_name": "Becky", "link": "https://stackoverflow.com/users/5093451/becky"}, "edited": false, "score": 0, "creation_date": 1443624386, "post_id": 32868849, "comment_id": 53570069, "body": "When I do this the email doesn&#39;t seem to send at all :("}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 105, "user_id": 5093451, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c274f79ce13c1a76c2654d33d5abb883?s=128&d=identicon&r=PG&f=1", "display_name": "Becky", "link": "https://stackoverflow.com/users/5093451/becky"}, "edited": false, "score": 0, "creation_date": 1443624472, "post_id": 32868849, "comment_id": 53570156, "body": "Then there is an error somewhere in your code before the <code>.Send</code> command - I would start by <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">debugging your code</a>"}, {"owner": {"reputation": 105, "user_id": 5093451, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c274f79ce13c1a76c2654d33d5abb883?s=128&d=identicon&r=PG&f=1", "display_name": "Becky", "link": "https://stackoverflow.com/users/5093451/becky"}, "edited": false, "score": 0, "creation_date": 1443624743, "post_id": 32868849, "comment_id": 53570333, "body": "Must have typed it in wrong, works now.  Now I just hope it works.  Thank you for such a speedy response!"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1443623643, "creation_date": 1443623643, "answer_id": 32868849, "question_id": 32868735, "link": "https://stackoverflow.com/questions/32868735/if-error-then-skip-sending-an-email/32868849#32868849", "title": "If error then skip sending an email", "body": "<p>You could change your error statement to avoid the <code>.Send</code> method in the case of an <em>earlier</em> error - but if the error occurs with the actual sending of the email then there's not a lot you can do as the execution has been handed over to another application and so it's out of the error handler's scope so to speak.</p>\n\n<p>See if this is of any use:</p>\n\n<pre><code>On Error GoTo Skip:\nWith OutMail\n    .To = \"bm@Email.co.uk\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"OGI Statements Used\"\n    .Body = strbody\n    .Send\nEnd With\nSkip:\nOn Error GoTo 0\nSet OutMail = Nothing\nSet OutApp = Nothing\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 5093451, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c274f79ce13c1a76c2654d33d5abb883?s=128&d=identicon&r=PG&f=1", "display_name": "Becky", "link": "https://stackoverflow.com/users/5093451/becky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 32868849, "answer_count": 1, "score": 0, "last_activity_date": 1443623643, "creation_date": 1443623349, "last_edit_date": 1531164843, "question_id": 32868735, "link": "https://stackoverflow.com/questions/32868735/if-error-then-skip-sending-an-email", "title": "If error then skip sending an email", "body": "<p>I have a piece of code that sends me an email when a button is pressed.\nHowever if for some reason the email won't send I don't want the code to break, I would like it to just ignore this command and carry on.  How do I add that into my current code?</p>\n\n<pre><code>Dim OutApp As Object\nDim OutMail As Object\nDim strbody As String\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nstrbody = ThisWorkbook.Name &amp; vbNewLine &amp; _\n          Environ(\"username\")\nOn Error Resume Next\nWith OutMail\n    .To = \"bm@Email.co.uk\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"OGI Statements Used\"\n    .Body = strbody\n    .Send\nEnd With\nOn Error GoTo 0\nSet OutMail = Nothing\nSet OutApp = Nothing\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2805, "user_id": 864414, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2188a4ca54a65d0f77ed573329fd5dd1?s=128&d=identicon&r=PG", "display_name": "transistor1", "link": "https://stackoverflow.com/users/864414/transistor1"}, "edited": false, "score": 1, "creation_date": 1443624519, "post_id": 32868915, "comment_id": 53570190, "body": "As an aside - one thing I like to do in cases like this is to use a named range for your first cell.  This can be done by highlighting the cell you want to start with (in this case, <code>A14</code>), and going to Formulas-&gt;Name Manager.  Then click &quot;New&quot;, and give the cell a name in the &quot;Name&quot; text box (e.g. <code>StartingPoint</code>).  Then you can change the line at the top to <code>Set rng = Sheet1.Range(&quot;StartingPoint&quot;)</code>.  This makes it easier to maintain when you (inevitably) have to mess around with the design of the  Excel form... all you have to do is update the cell reference, rather than changing code."}], "tags": [], "owner": {"reputation": 2805, "user_id": 864414, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2188a4ca54a65d0f77ed573329fd5dd1?s=128&d=identicon&r=PG", "display_name": "transistor1", "link": "https://stackoverflow.com/users/864414/transistor1"}, "is_accepted": true, "score": 2, "last_activity_date": 1443623783, "creation_date": 1443623783, "answer_id": 32868915, "question_id": 32868670, "link": "https://stackoverflow.com/questions/32868670/have-excel-switch-to-next-row-if-first-row-is-populated/32868915#32868915", "title": "Have Excel switch to next row if first row is populated", "body": "<p>Something along these lines should work (untested):</p>\n\n<pre><code>Static rng As Range\nIf rng Is Nothing Then\n  Set rng = Sheet1.Range(\"A14\")\n  Do While rng.Value &lt;&gt; \"\"\n     Set rng = rng.Offset(1)\n  Loop\nEnd If\n\n'Date\nrng.Range(\"A1\").Value = DTPicker1\n'AC Type\nrng.Range(\"B1\").Value = ComboBox1\n'AC Reg\nrng.Range(\"C1\").Value = TextBox3\n'Pic\nrng.Range(\"D1\").Value = TextBox5\n'co-pilot\nrng.Range(\"E1\").Value = TextBox4\n'from\nrng.Range(\"F1\").Value = TextBox7\n'to\nrng.Range(\"G1\").Value = TextBox6\n'remarks\nrng.Range(\"H1\").Value = TextBox8\n\n'Point to the next line\nSet rng = rng.Offset(1)\n</code></pre>\n"}], "owner": {"reputation": 1802, "user_id": 4863513, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dab3939d76cb385472a540b834e6c373?s=128&d=identicon&r=PG&f=1", "display_name": "Jp4Real", "link": "https://stackoverflow.com/users/4863513/jp4real"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 32868915, "answer_count": 1, "score": 2, "last_activity_date": 1443624079, "creation_date": 1443623155, "last_edit_date": 1443624079, "question_id": 32868670, "link": "https://stackoverflow.com/questions/32868670/have-excel-switch-to-next-row-if-first-row-is-populated", "title": "Have Excel switch to next row if first row is populated", "body": "<p>I'm learning Excel VBA and I just hit a wall.</p>\n\n<p>I have a spreadsheet in which I built a UserForm. This userform populates Row 14 from A to AK.</p>\n\n<p>Now I've been able to copy the data from the form using this code (part of it it's way to long to copy completely here):</p>\n\n<pre><code>'Date\nSheet1.Range(\"A14\") = DTPicker1\n'AC Type\nSheet1.Range(\"b14\") = ComboBox1\n'AC Reg\nSheet1.Range(\"C14\") = TextBox3\n'Pic\nSheet1.Range(\"d14\") = TextBox5\n'co-pilot\nSheet1.Range(\"e14\") = TextBox4\n'from\nSheet1.Range(\"f14\") = TextBox7\n'to\nSheet1.Range(\"g14\") = TextBox6\n'remarks\nSheet1.Range(\"h14\") = TextBox8\n</code></pre>\n\n<p>Now what I would like to do is that IF A14 is populated, well everything that writes in 14 switches to 15, and so on.</p>\n\n<p>Is there any way I can do this?</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2007", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "edited": false, "score": 0, "creation_date": 1443626185, "post_id": 32869602, "comment_id": 53571284, "body": "I already have a query that showes me duplicate records   <code>...OR (((Object.Key) In (SELECT [Key] FROM [Object] As Tmp GROUP BY [Key] HAVING Count(*)&gt;1 )));</code>   I am looking for a Formatting Expression that could help me highlight this entries."}], "tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 0, "last_activity_date": 1443625662, "creation_date": 1443625662, "answer_id": 32869602, "question_id": 32868625, "link": "https://stackoverflow.com/questions/32868625/ms-access-conditional-formatting-highlight-duplicates/32869602#32869602", "title": "MS Access: Conditional formatting - highlight duplicates", "body": "<p>I suspect that the original query will need to be bulked up with a sub-query that has an ID column and count of ID.  The outermost query will then need to also return the ID count.</p>\n\n<p>Within the report you'd then need add another field that would show the linked ID count if it was > 1.</p>\n"}, {"comments": [{"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1444032622, "post_id": 32872877, "comment_id": 53712930, "body": "Did you find the above useful?  If so please flag as an answer."}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1443636756, "last_edit_date": 1443636756, "creation_date": 1443636351, "answer_id": 32872877, "question_id": 32868625, "link": "https://stackoverflow.com/questions/32868625/ms-access-conditional-formatting-highlight-duplicates/32872877#32872877", "title": "MS Access: Conditional formatting - highlight duplicates", "body": "<p>Access reporting (and forms) allows conditional formatting to be used in a similar way to excel.</p>\n\n<p>See Ribbon: Report Design Tools>Formt>ControlFormatting...</p>\n\n<p>It will let you change the format of a control depending on the value it, or another control, contains.</p>\n\n<p>It's a very nice feature and will also let you add bar charts to you list forms to graphically represent the values sorted in a control.</p>\n\n<p>However, the data set will need to have a column that indicates whether the current row has duplicate records.  The snippet from you current query that you provided (that I repeat below) will not do this:</p>\n\n<pre><code> ...OR (((Object.Key) In (SELECT [Key] FROM [Object] As Tmp GROUP BY [Key] HAVING Count(*)&gt;1 )));\n</code></pre>\n\n<p>Without seeing the whole query I can't really help much, but you will need to remove the use of IN and make the SELECT statement a subquery of the main SQL Statement.  The main query resultset will need to be  LEFT JOINED to the sub query using the Key field.  Because of the LEFT JOIN you can use \"isnull(Key)\" in the SELECT clause and isnull(Key) will be true for non-duplicate rows.</p>\n\n<p>You can then refer to thiscolumn in your conditional formatting</p>\n\n<p>I hope this makes some sense.</p>\n\n<p>You </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5593637, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/40bf6c52e3975806e93f943acd547a1e?s=128&d=identicon&r=PG", "display_name": "Soxy", "link": "https://stackoverflow.com/users/5593637/soxy"}, "is_accepted": false, "score": 0, "last_activity_date": 1448251509, "creation_date": 1448251509, "answer_id": 33863556, "question_id": 32868625, "link": "https://stackoverflow.com/questions/32868625/ms-access-conditional-formatting-highlight-duplicates/33863556#33863556", "title": "MS Access: Conditional formatting - highlight duplicates", "body": "<p>For a quick and dirty way to highlight duplicate data:</p>\n\n<ol>\n<li><p>Select the object you want to highlight if it's duplicated, and make \nthe background white (or whatever the colour of your background is).</p></li>\n<li><p>Create a <em>copy</em> of the object that you want highlighted if it's\na duplicate.</p></li>\n<li><p>Format the copy so it has a highlight, and/or add extra text \n(eg:  <strong>DUPLICATE</strong>)</p></li>\n<li><p>Put the copy <em>behind</em> the original (so it can't be seen).</p></li>\n<li><p>On the original object, select \"Hide duplicates\" in properties.</p></li>\n<li><p>Ensure \"Hide duplicates\" is NOT selected on the copy.</p></li>\n</ol>\n\n<p>So when the duplicate appears, Access will hide it, but then the object you've created that was originally hidden beneath now becomes visible - effectively highlighting the field.</p>\n\n<p>(Unfortunately it will only highlight the field itself, not the entire section.)</p>\n"}], "owner": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4006, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1448251509, "creation_date": 1443623003, "last_edit_date": 1443628591, "question_id": 32868625, "link": "https://stackoverflow.com/questions/32868625/ms-access-conditional-formatting-highlight-duplicates", "title": "MS Access: Conditional formatting - highlight duplicates", "body": "<p>Is there an expression that I can use in MS Access ,to highlight Duplicate entries in Reports?\nI tried something like Expression is : <code>Count(*)&gt;1</code> but it doesn't work.</p>\n\n<p>Br,</p>\n"}, {"tags": ["json", "excel", "vba", "google-maps", "url"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 2, "creation_date": 1443622709, "post_id": 32868245, "comment_id": 53568882, "body": "Why JSON? Why not XML <a href=\"https://maps.googleapis.com/maps/api/geocode/xml?address=bojon\" rel=\"nofollow noreferrer\">maps.googleapis.com/maps/api/geocode/xml?address=bojon</a>? Much easier to parse with VBA."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1443638447, "post_id": 32868245, "comment_id": 53578439, "body": "You may just want to get a full json parser for VBA. There are a couple that I know of and &#39;<i>shameless plug</i>&#39; I wrote one myself which if you&#39;re interested, I&#39;d be happy to share."}], "answers": [{"tags": [], "owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "is_accepted": false, "score": 0, "last_activity_date": 1443638278, "creation_date": 1443638278, "answer_id": 32873355, "question_id": 32868245, "link": "https://stackoverflow.com/questions/32868245/excel-vba-extract-values-json-url/32873355#32873355", "title": "Excel VBA extract values JSON URL", "body": "<p>Try this pattern: <code>\"\"\"lat\"\"(\\s)*:(\\s)*(\\d)+(.(\\d)+)?\"</code></p>\n\n<p>To break it down, </p>\n\n<ul>\n<li>\"\"lat\"\" matches the string</li>\n<li>(\\s)* matches any spaces which might be in\nbetween the tokens </li>\n<li>: is literal </li>\n<li>(\\s)* again matches spaces </li>\n<li>(\\d)+ matches some number of digits </li>\n<li>(.(\\d)+)? optionally matches a decimal point followed by a string of digits (at least one)</li>\n</ul>\n\n<p>I leave the other two as an exercise to you given this example, but let me know if you have trouble!</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1443812631, "last_edit_date": 1443812631, "creation_date": 1443809756, "answer_id": 32913350, "question_id": 32868245, "link": "https://stackoverflow.com/questions/32868245/excel-vba-extract-values-json-url/32913350#32913350", "title": "Excel VBA extract values JSON URL", "body": "<p>Using a script control to parse the JSON and caching the json responses to avoid unnecessary XMLHTTP calls:</p>\n\n<pre><code>Sub Tester()\n\n    Debug.Print GetResult(\"https://maps.googleapis.com/maps/api/geocode/json?address=bojon\", _\n                       \"results[0].geometry.location.lat\")\n\n    Debug.Print GetResult(\"https://maps.googleapis.com/maps/api/geocode/json?address=bojon\", _\n                       \"results[0].geometry.location.lng\")\n\n\nEnd Sub\n\nFunction GetResult(URL As String, jsonPath As String)\n\n    Static responseCache As Object\n    Dim objHTTP As Object, json As String\n    Dim sc As Object\n\n    If responseCache Is Nothing Then\n        Set responseCache = CreateObject(\"scripting.dictionary\")\n    End If\n\n    If Not responseCache.exists(URL) Then\n        Debug.Print \"Fetching:\" &amp; URL\n        Set objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\n        objHTTP.Open \"GET\", \"https://maps.googleapis.com/maps/api/geocode/json?address=bojon\", False\n        objHTTP.send (\"\")\n        json = objHTTP.responseText\n        responseCache.Add URL, json\n    Else\n        Debug.Print \"Use cache:\" &amp; URL\n        json = responseCache(URL)\n    End If\n\n    Set sc = CreateObject(\"scriptcontrol\")\n    sc.Language = \"JScript\"\n    sc.Eval \"var obj=(\" &amp; json &amp; \")\" 'evaluate the json response\n\n    GetResult = sc.Eval(\"obj.\" &amp; jsonPath)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5393377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36ad1b422a6524ea6241cb5b3373db28?s=128&d=identicon&r=PG&f=1", "display_name": "Balduz", "link": "https://stackoverflow.com/users/5393377/balduz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3523, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1443812631, "creation_date": 1443622010, "last_edit_date": 1443622247, "question_id": 32868245, "link": "https://stackoverflow.com/questions/32868245/excel-vba-extract-values-json-url", "title": "Excel VBA extract values JSON URL", "body": "<p>In Excel</p>\n\n<p>I try to extract this value  \"45.33887499999999\"</p>\n\n<p>by this <strong>Google URL \"<a href=\"https://maps.googleapis.com/maps/api/geocode/json?address=bojon\" rel=\"nofollow\">https://maps.googleapis.com/maps/api/geocode/json?address=bojon</a>\"</strong> (in the example <strong>Google URL +</strong>\"=bojon\" or <strong>+</strong>\"=VENICE%20BEACH%20CA\")</p>\n\n<p>with this VBA code:</p>\n\n<pre><code>Public Function LATITUDE(coord As String)\n    Dim firstVal As String\n    firstVal = \"https://maps.googleapis.com/maps/api/geocode/json?address=\"\n    Set objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\n    URL = firstVal &amp; Replace(coord, \" \", \"+\")\n    objHTTP.Open \"GET\", URL, False\n    objHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n    objHTTP.send (\"\")\n    If InStr(objHTTP.responseText, \"\"\"location\"\" : {\") = 0 Then GoTo ErrorHandl\n    Set regex = CreateObject(\"VBScript.RegExp\"): regex.Pattern = \"\"\"lat\"\".*?([0-9]+)\": regex.Global = False\n    Set matches = regex.Execute(objHTTP.responseText)\n    tmpVal = Replace(matches(Index).SubMatches(0), \".\", Application.International(xlListSeparator))\n    LATITUDE = CDbl(tmpVal)\n    Exit Function\nErrorHandl:\n    LATITUDE = -1\nEnd Function\n</code></pre>\n\n<p>but this code extracts only \"45\" and not \"45.33887499999999\"</p>\n\n<p>I tried to change regex.Pattern = \"\"\"lat\"\".*?([0-9]+)\"</p>\n\n<p>but I haven't found the solution</p>\n\n<hr>\n\n<p>Finally I want to extract 3 values with 3 different formulas (created by VBA code) from this URL</p>\n\n<p><strong>Google URL + \"=bojon\"</strong></p>\n\n<p>in these rows</p>\n\n<pre><code>     \"formatted_address\" : \"30010 Bojon VE, Italia\",\n     \"geometry\" : {\n        \"location\" : {\n           \"lat\" : 45.33887499999999,\n           \"lng\" : 12.06598\n</code></pre>\n\n<p>in A1 cell: \"bojon\"</p>\n\n<p>=GOOGDRESS(A1) result = \"30010 Bojon VE, Italia\"</p>\n\n<p>=LATITUDE(A1) result = \"45.33887499999999\"</p>\n\n<p>=LONGITUDE(A1) result = \"12.06598\"</p>\n\n<hr>\n\n<p>another example:</p>\n\n<p><strong>Google URL + \"=VENICE%20BEACH%20CA\"</strong></p>\n\n<pre><code>     \"formatted_address\" : \"Venice Beach, California, Stati Uniti\",\n     \"geometry\" : {\n        \"bounds\" : {\n           \"northeast\" : {\n              \"lat\" : 33.996311,\n              \"lng\" : -118.4561299\n           },\n           \"southwest\" : {\n              \"lat\" : 33.9636437,\n              \"lng\" : -118.4835886\n           }\n        },\n        \"location\" : {\n           \"lat\" : 33.9936153,\n           \"lng\" : -118.4799099\n</code></pre>\n\n<p>=GOOGDRESS(A1) result = \"Venice Beach, California, Stati Uniti\"</p>\n\n<p>=LATITUDE(A1) result = \"33.9936153\"</p>\n\n<p>=LONGITUDE(A1) result = \"-118.4799099\"</p>\n\n<hr>\n\n<p>can anyone help me?</p>\n"}, {"tags": ["vba", "excel", "casting"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1443621785, "post_id": 32868043, "comment_id": 53568250, "body": "For a Boolean, you&#39;d have to populate the array in a loop. For strings, as long as it&#39;s a one row or column range, you can do it with a little messing about, but looping is still simpler."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1443622528, "post_id": 32868043, "comment_id": 53568766, "body": "Can&#39;t you cast it to a string etc when passing to your function? Something like <code>CStr(arr(1, 1))</code> - or do you pass the entire array into your function?"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1443622989, "post_id": 32868043, "comment_id": 53569079, "body": "I&#39;m not aware of any way of doing that other than manually casting in a loop. Wouldn&#39;t it be easier to test for type within the function and just pass the Variant: <code>If VarType(v) = vbBoolean Then</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 472, "user_id": 3258942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cca53c78fc3f6fac7913a4abfd39c8?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3258942/christian"}, "edited": false, "score": 0, "creation_date": 1443684952, "post_id": 32868578, "comment_id": 53594300, "body": "I was trying to avoid looping but it seems to be the easiest way. Wouldn&#39;t it be easier to loop over the range right of the bat instead of loading into a variant array first?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 472, "user_id": 3258942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cca53c78fc3f6fac7913a4abfd39c8?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3258942/christian"}, "edited": false, "score": 0, "creation_date": 1443686807, "post_id": 32868578, "comment_id": 53595348, "body": "You may test it, but loading an array from a range and working on the array is pretty fast, although reading info in a specific cell isn&#39;t that long but not really efficient. You can check the time spent by code by setting up a variable <code>StartTime = Timer</code> and at the end : <code>MsgBox &quot;Done in &quot; &amp; Timer - StartTime &amp; &quot; seconds&quot;</code>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 472, "user_id": 3258942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cca53c78fc3f6fac7913a4abfd39c8?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3258942/christian"}, "edited": false, "score": 0, "creation_date": 1443701218, "post_id": 32868578, "comment_id": 53603982, "body": "@ChrisUnbroken Glad I could help, if I can just ask that you upvote my answer, it would be nice (I&#39;m working on my &quot;Refiner&quot; badge). Enjoy SO ;)"}, {"owner": {"reputation": 472, "user_id": 3258942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cca53c78fc3f6fac7913a4abfd39c8?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3258942/christian"}, "edited": false, "score": 0, "creation_date": 1443705612, "post_id": 32868578, "comment_id": 53607023, "body": "I would have done so before but I only just passed the 15 Reputation required to do so :) Thanks again"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 472, "user_id": 3258942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cca53c78fc3f6fac7913a4abfd39c8?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3258942/christian"}, "edited": false, "score": 0, "creation_date": 1443705711, "post_id": 32868578, "comment_id": 53607093, "body": "I know I upvoted your 2 questions so that you can! ;) And that&#39;s why I poke you afterwards^^ Have a nice journey here! Thx for the vote! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1443622904, "creation_date": 1443622904, "answer_id": 32868578, "question_id": 32868043, "link": "https://stackoverflow.com/questions/32868043/typecasting-variant-array-into-string-or-boolean-array/32868578#32868578", "title": "Typecasting Variant Array into String or Boolean Array", "body": "<p>Easiest way is to declare your array as an array of Strings or Booleans, simply like this :</p>\n\n<pre><code>Dim arr() as String\nDim arr() as Boolean\n</code></pre>\n\n<p>It works also for functions btw.</p>\n\n<p>And if you can't load the whole range because of a type mismatch, load this in an temporary Variant Array and then ReDim your String or Boolean array to match and loop on everything and use conversion functions : <code>CBool</code>, <code>CStr</code>, <code>CInt</code>, <code>CDbl</code>, ...</p>\n"}], "owner": {"reputation": 472, "user_id": 3258942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cca53c78fc3f6fac7913a4abfd39c8?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/3258942/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 0, "accepted_answer_id": 32868578, "answer_count": 1, "score": 1, "last_activity_date": 1487252010, "creation_date": 1443621514, "last_edit_date": 1487252010, "question_id": 32868043, "link": "https://stackoverflow.com/questions/32868043/typecasting-variant-array-into-string-or-boolean-array", "title": "Typecasting Variant Array into String or Boolean Array", "body": "<p>I have several named ranges inside my Excel sheet where I store data for VBA Macros between sessions. When loading I need to get that data into multiple arrays (<code>String</code> and <code>Booleans</code>).</p>\n\n<pre><code>Dim arr() As Variant\nDim rg As Range\n\nSet rg = Sheets(\"Calc\").Range(\"myRange\")\narr = rg.Value2\n</code></pre>\n\n<p>How can I typecast <code>arr()</code> into a <code>String</code> or <code>Boolean</code> array for use in my macro? </p>\n\n<p>If I try and use <code>Variant</code> arrays instead I get <code>ByRef argument mismatch errors</code> on function calls. </p>\n\n<p>Or Is there maybe another way to get the contents of the ranges into an array of other type than <code>Variant</code>? </p>\n\n<p>Searching did not yield a result on the latter question.</p>\n"}, {"tags": ["vba", "unit-testing"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1443622759, "post_id": 32867987, "comment_id": 53568911, "body": "Really unclear what you are asking but it sounds like you might be looking for <a href=\"http://www.cpearson.com/excel/Implements.aspx\" rel=\"nofollow noreferrer\">Interfaces and Implementation</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1443641084, "post_id": 32867987, "comment_id": 53579736, "body": "You need to see <a href=\"http://codereview.stackexchange.com/q/63004/23788\">this</a> - note that this VBA code / &quot;unit testing framework&quot; was eventually ported to C# into a COM add-in that evolved into what&#39;s currently known as <a href=\"http://www.rubberduck-vba.com\" rel=\"nofollow noreferrer\"><b>Rubberduck</b></a>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1443642671, "post_id": 32867987, "comment_id": 53580472, "body": "You probably don&#39;t need to mock the <code>Address</code> class. What you probably need though is a way to specify the instance from the outside. If you&#39;re <code>New</code>ing up the class inside <code>Person</code> you&#39;re doing it wrong."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1443642014, "last_edit_date": 1492087232, "creation_date": 1443642014, "answer_id": 32874300, "question_id": 32867987, "link": "https://stackoverflow.com/questions/32867987/writing-a-vba-unit-testing-suite/32874300#32874300", "title": "Writing a VBA Unit Testing Suite", "body": "<p>Testable, object-oriented VBA code that lets you control dependencies, must be written against abstractions. <a href=\"https://codereview.stackexchange.com/q/64109/23788\">Extensible logging</a> on Code Review Stack Exchange is a good example of that.</p>\n\n<p>In a nutshell, your code needs to depend on <em>interfaces</em> - only then can your unit tests pass in \"fake\" implementations. Take the <code>ILogger</code> class module from the linked CR post:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Log(ByVal output As String)\nEnd Sub\n\nPublic Property Get Name() As String\nEnd Property\n\nPublic Property Get MinLevel() As LogLevel\nEnd Property\n</code></pre>\n\n<p>That's the <em>interface</em>. One implementation is called <code>DebugLogger</code> and goes like this - notice <strong>Implements ILogger</strong>:</p>\n\n<pre><code>Option Explicit\n\nPrivate Type TDebugLogger\n    Name As String\n    MinLevel As LogLevel\nEnd Type\nPrivate this As TDebugLogger\n\nImplements ILogger\n\nPublic Function Create(ByVal loggerName As String, ByVal loggerMinLevel As LogLevel) As ILogger\n\n    Dim result As New DebugLogger\n    result.Name = loggerName\n    result.MinLevel = loggerMinLevel\n    Set Create = result\n\nEnd Function\n\nFriend Property Get Name() As String\n    Name = this.Name\nEnd Property\n\nFriend Property Let Name(ByVal value As String)\n    this.Name = value\nEnd Property\n\nFriend Property Get MinLevel() As LogLevel\n    MinLevel = this.MinLevel\nEnd Property\n\nFriend Property Let MinLevel(ByVal value As LogLevel)\n    this.MinLevel = value\nEnd Property\n\nPrivate Sub ILogger_Log(ByVal output As String)\n    Debug.Print output\nEnd Sub\n\nPrivate Property Get ILogger_MinLevel() As LogLevel\n    ILogger_MinLevel = this.MinLevel\nEnd Property\n\nPrivate Property Get ILogger_Name() As String\n    ILogger_Name = this.Name\nEnd Property\n</code></pre>\n\n<hr>\n\n<p>Now if you have code that uses an <code>ILogger</code>, your unit tests can pass in an implementation that, instead of printing stuff to the console, raises an event that reports what message is being logged and at what level: your test module can handle these events, set a module-level flag, and [assuming you have implemented an <code>Assert</code> class, or that you are using <a href=\"http://www.rubberduck-vba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> unit tests] you can then call <code>Assert.IsTrue</code> to validate the flag. Or whatever.</p>\n\n<p>Bottom line, it can totally be done: I have an <code>IRepository</code> interface with implementations hitting a database, and my unit tests use \"fake\" implementations that really just wrap a <code>Collection</code> instead.</p>\n\n<p>As for <em>mocking</em>, as in, <em>generating an implementation on-the-fly</em>, and injecting that, ... that's not something easily done, but I can see Rubberduck offering something like it in a future version.</p>\n\n<hr>\n\n<blockquote>\n  <p><strong>Disclaimer</strong> - I co-own the Rubberduck project and repository.</p>\n</blockquote>\n"}], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462514682, "creation_date": 1443621322, "last_edit_date": 1443642058, "question_id": 32867987, "link": "https://stackoverflow.com/questions/32867987/writing-a-vba-unit-testing-suite", "title": "Writing a VBA Unit Testing Suite", "body": "<p>I am trying to write a addin that will let me write Unit tests for VBA. I Have a class setup for testing assertions etc. what I am missing is a way to stubing/mocking classes is there a way of doing that?</p>\n\n<p>For clarification I am talking about instantiating objects that are pretending to be of a different class. For example, I want to write a mock of Address class that Person class will work with:</p>\n\n<p>Person Class </p>\n\n<pre><code> Private Home as Address\n\n Sub ChangeAddress(NewStreetAddress as String)\n      Address.Street = NewStreetAddress\n end Sub\n</code></pre>\n\n<p>Address Class</p>\n\n<pre><code>Dim Street as String\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1443624649, "post_id": 32867878, "comment_id": 53570277, "body": "do you want to specify a location while this code is running (i.e. should it stop somewhere to ask you &quot;Where do you want to drop that pic&quot;) or is the location already selected before <code>Importera_bilder()</code> is called?"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 5192863, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b995d0188c6be0c01e0bd0b2f31380ba?s=128&d=identicon&r=PG&f=1", "display_name": "AgatonSaxx", "link": "https://stackoverflow.com/users/5192863/agatonsaxx"}, "edited": false, "score": 0, "creation_date": 1443623880, "post_id": 32868014, "comment_id": 53569698, "body": "Hi, Thanks for your answer. Could you perhaps help me with understanding where in this code i then should insert the activecell value?  Please look at the code above."}, {"owner": {"reputation": 70, "user_id": 5277903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da2b4d195da59f0a1e97e6d485839e?s=128&d=identicon&r=PG&f=1", "display_name": "Del Kirksey", "link": "https://stackoverflow.com/users/5277903/del-kirksey"}, "reply_to_user": {"reputation": 67, "user_id": 5192863, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b995d0188c6be0c01e0bd0b2f31380ba?s=128&d=identicon&r=PG&f=1", "display_name": "AgatonSaxx", "link": "https://stackoverflow.com/users/5192863/agatonsaxx"}, "edited": false, "score": 0, "creation_date": 1443624458, "post_id": 32868014, "comment_id": 53570138, "body": "Give me a better explanation of what you are currently doing and what you are trying to accomplish."}], "tags": [], "owner": {"reputation": 70, "user_id": 5277903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45da2b4d195da59f0a1e97e6d485839e?s=128&d=identicon&r=PG&f=1", "display_name": "Del Kirksey", "link": "https://stackoverflow.com/users/5277903/del-kirksey"}, "is_accepted": false, "score": 1, "last_activity_date": 1443621407, "creation_date": 1443621407, "answer_id": 32868014, "question_id": 32867878, "link": "https://stackoverflow.com/questions/32867878/how-to-choose-manually-where-to-insert-a-value-picture/32868014#32868014", "title": "How to choose manually where to insert a value/picture", "body": "<p>You want to use the <code>ActiveCell</code> property. </p>\n\n<p>For instance if I wanted to place the number 900 in the cell I have selected my VBA would be:</p>\n\n<pre><code>Sub Insert900()\n    ActiveCell.Value = 900\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 5192863, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b995d0188c6be0c01e0bd0b2f31380ba?s=128&d=identicon&r=PG&f=1", "display_name": "AgatonSaxx", "link": "https://stackoverflow.com/users/5192863/agatonsaxx"}, "edited": false, "score": 0, "creation_date": 1444294589, "post_id": 32869938, "comment_id": 53845768, "body": "Hi everyone, i have another question regarding this issue. Everything has been solved very nicely, but i was wondering if you know any way on how i can set in which order the images should be imported (arranged by newest date etc). Is it any way of doing this?"}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "reply_to_user": {"reputation": 67, "user_id": 5192863, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b995d0188c6be0c01e0bd0b2f31380ba?s=128&d=identicon&r=PG&f=1", "display_name": "AgatonSaxx", "link": "https://stackoverflow.com/users/5192863/agatonsaxx"}, "edited": false, "score": 0, "creation_date": 1444310159, "post_id": 32869938, "comment_id": 53856827, "body": "can you please accept the best answer to the original question (if you can accept any of the answers provided) and raise a new question for what you asked in the comment"}], "tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": false, "score": 0, "last_activity_date": 1443626633, "last_edit_date": 1495541670, "creation_date": 1443626633, "answer_id": 32869938, "question_id": 32867878, "link": "https://stackoverflow.com/questions/32867878/how-to-choose-manually-where-to-insert-a-value-picture/32869938#32869938", "title": "How to choose manually where to insert a value/picture", "body": "<p>in <code>Sub Importera_bilder()</code> include/change</p>\n\n<pre><code>....\nDim PicNail as Range        ' this is where we nail the pic to\nSet PicNail = Selection     ' current cell cusrsor position\n....\nCall insert(strCompFilePath, counter, PicNail)\n</code></pre>\n\n<p>and the Insert function becomes ...</p>\n\n<pre><code>Function insert(PicPath, counter, NailTo As Range)\n'MsgBox PicPath\n    With ActiveSheet.Pictures.Insert(PicPath)\n\n        With .ShapeRange\n            .LockAspectRatio = msoTrue\n            .Width = 270\n            .Height = 230                  ' don't do both!\n        End With\n        .Left = NailTo.Left\n        .Top = NailTo.Top\n        .Placement = 1\n        .PrintObject = True\n    End With\nEnd Function\n</code></pre>\n\n<p><strong><em>Note:</em></strong></p>\n\n<p>When you have AspectRatio locked, there's no use to change both width and height because either one will be automatically adjusted when you set the other one (that's the sense of aspect ratio)</p>\n\n<p>When you want to fit your image into a 270W x 230H box, you need to set the larger dimension (whichever it is) and aspect ratio is retained.</p>\n\n<p>further reading:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/22073463/vba-excel-2010-embedding-pictures-and-resizing/22075626#22075626\">VBA Excel 2010 - Embedding Pictures and Resizing</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/28750196/oleobject-height-and-width-are-not-consistent/28751656#28751656\">OLEObject Height and Width are not consistent</a></p>\n\n<p>Also be aware that the <code>Picture.Insert</code> method in Excel 2010 behaves different than before ... it is insertin g a LINKED object, so you may want to include assignments to <code>LinkToFile</code> and <code>SaveWithDocument</code> or change code to <code>ActiveSheet.Shapes.AddPicture(...)</code></p>\n"}], "owner": {"reputation": 67, "user_id": 5192863, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b995d0188c6be0c01e0bd0b2f31380ba?s=128&d=identicon&r=PG&f=1", "display_name": "AgatonSaxx", "link": "https://stackoverflow.com/users/5192863/agatonsaxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1443639446, "creation_date": 1443621056, "last_edit_date": 1443639446, "question_id": 32867878, "link": "https://stackoverflow.com/questions/32867878/how-to-choose-manually-where-to-insert-a-value-picture", "title": "How to choose manually where to insert a value/picture", "body": "<p>What I am looking for is a way in a VBA macro, to have a setting, so where my cell is activated (wherever in the sheet), there is where the macro will insert a specific value or picture.  </p>\n\n<p>Is it any way in doing this?  </p>\n\n<p>I just know how to specify a range in the macro to where the picture should be inserted, but I would like it to be inserted where I manually have chosen via the mouse. My VBA code:</p>\n\n<pre><code>Sub Importera_bilder()\n    Dim mainWorkBook As Workbook\n    Dim sh As Worksheet\n    Dim ws2 As Worksheet\n    Dim ws As Worksheet\n    Dim sh2 As Worksheet\n\n    Set sh = Sheets(\"Kundinformation\")\n    Set ws2 = Sheets(\"Partner_information\")\n    Set ws = Sheets(\"Kalkyl\")\n    Set sh2 = Sheets(\"Start\")\n\n\n    Set mainWorkBook = ActiveWorkbook\n    Sheets(\"Projektunderlag\").Activate\n    FolderPath = ws2.Range(\"B21\").Value\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    NoOfFiles = fso.GetFolder(FolderPath).Files.Count\n    Set listfiles = fso.GetFolder(FolderPath).Files\n    For Each fls In listfiles\n       strCompFilePath = FolderPath &amp; \"\\\" &amp; Trim(fls.Name)\n        If strCompFilePath &lt;&gt; \"\" Then\n            If (InStr(1, strCompFilePath, \"jpg\", vbTextCompare) &gt; 1 _\n            Or InStr(1, strCompFilePath, \"jpeg\", vbTextCompare) &gt; 1 _\n            Or InStr(1, strCompFilePath, \"png\", vbTextCompare) &gt; 1) Then\n                 counter = counter + 1\n                  'Sheets(\"Object\").Range(\"A\" &amp; counter).Value = fls.Name\n                  'Sheets(\"Projektunderlag\").Range(\"M\" &amp; counter).ColumnWidth = 10\n                'Sheets(\"Projektunderlag\").Range(\"M\" &amp; counter).RowHeight = 13\n                'Sheets(\"Projektunderlag\").Range(\"M\" &amp; counter).Activate\n                Call insert(strCompFilePath, counter)\n                Sheets(\"Projektunderlag\").Activate\n            End If\n        End If\n    Next\nmainWorkBook.Save\nEnd Sub\n\nFunction insert(PicPath, counter)\n'MsgBox PicPath\n    With ActiveSheet.Pictures.insert(PicPath)\n        With .ShapeRange\n            .LockAspectRatio = msoTrue\n            .Width = 270\n            .Height = 230\n        End With\n         ActiveSheet.Range(\"M269\").Select\n        .Left = ActiveSheet.Range(\"M269\").Left\n        .Top = ActiveSheet.Range(\"M269\").Top\n        .Placement = 1\n        .PrintObject = True\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 30431, "user_id": 1507566, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40b799a199eda9317d64e854c9fc8858?s=128&d=identicon&r=PG", "display_name": "Tab Alleman", "link": "https://stackoverflow.com/users/1507566/tab-alleman"}, "edited": false, "score": 1, "creation_date": 1443620773, "post_id": 32867690, "comment_id": 53567491, "body": "Try making all your proc parameter nvarchar, and convert them as needed in the proc code."}, {"owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 2, "creation_date": 1443620822, "post_id": 32867690, "comment_id": 53567523, "body": "Side note: you should <b>not</b> use the <code>sp_</code> prefix for your stored procedures. Microsoft has <a href=\"http://msdn.microsoft.com/en-us/library/ms190669%28v=sql.105%29.aspx\" rel=\"nofollow noreferrer\">reserved that prefix for its own use (see <i>Naming Stored Procedures</i>)</a>, and you do run the risk of a name clash sometime in the future. <a href=\"http://www.sqlperformance.com/2012/10/t-sql-queries/sp_prefix\" rel=\"nofollow noreferrer\">It&#39;s also bad for your stored procedure performance</a>. It&#39;s best to just simply avoid <code>sp_</code> and use something else as a prefix - or no prefix at all!"}, {"owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "edited": false, "score": 0, "creation_date": 1443620923, "post_id": 32867690, "comment_id": 53567609, "body": "As Tab Alleman said, you can convert all parameters in the sp as nvarchar or you will need to cast it in your code as double/decimal."}, {"owner": {"reputation": 79, "user_id": 866345, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eb07f413a4937e2463c7e9b76ddad2f5?s=128&d=identicon&r=PG", "display_name": "Peraklo", "link": "https://stackoverflow.com/users/866345/peraklo"}, "edited": false, "score": 0, "creation_date": 1443621091, "post_id": 32867690, "comment_id": 53567735, "body": "I have tried the suggested... Dim-ed all variables in excel as strings, formated cells as text in the sheet and declared parameters in SQL as nvarchar. Still i get the &#39;error converting nvarchar to numeric&#39; error. Is that possibly the error from code execution and it breaks because i am using nvarchar in the calulation step?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 3, "creation_date": 1443623682, "post_id": 32867690, "comment_id": 53569577, "body": "With the numeric types the command should be like &quot;exec SP_Hello &#39;Portfolio Name as Text&#39;,112.45,123.45,123.45&quot;. As you see, the numbers are without the &#39; &#39; around. So try with the numeric types and <code>.CommandText = &quot;exec SP_Hello &#39;&quot; &amp; Portfolio &amp; &quot;&#39;,&quot; &amp; Str(Discount) &amp; &quot;,&quot; &amp; Str(lowerlimit) &amp; &quot;,&quot; &amp; Str(midlimit) &amp; &quot;&quot;</code>"}, {"owner": {"reputation": 79, "user_id": 866345, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eb07f413a4937e2463c7e9b76ddad2f5?s=128&d=identicon&r=PG", "display_name": "Peraklo", "link": "https://stackoverflow.com/users/866345/peraklo"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1443689995, "post_id": 32867690, "comment_id": 53597147, "body": "@AxelRichter this worked perfectly, except for one thing. The discount is expressed as a percentage and under the hood, that percentage is a decimal number (i.e. 30% is 0,3). Problem appears when VBA code tries to pass that value because it has a comma as a decimal separator, whereas SQL requires it to be a decimal dot."}, {"owner": {"reputation": 79, "user_id": 866345, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eb07f413a4937e2463c7e9b76ddad2f5?s=128&d=identicon&r=PG", "display_name": "Peraklo", "link": "https://stackoverflow.com/users/866345/peraklo"}, "edited": false, "score": 0, "creation_date": 1443690348, "post_id": 32867690, "comment_id": 53597380, "body": "So to be more precise, i want users to be able to enter the Discount in Percentage format, and for that value to be passed as a numeric parameter with decimal DOT. When I look at the resulting table Connection text, it says <code>exec SP_Hello &#39;SB002&#39;, 0, 30, 1000&#39;</code>, and this zero should be 0.3"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1443691066, "post_id": 32867690, "comment_id": 53597852, "body": "Where is <code>Discount</code> coming from? This is not shown in your code."}, {"owner": {"reputation": 79, "user_id": 866345, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eb07f413a4937e2463c7e9b76ddad2f5?s=128&d=identicon&r=PG", "display_name": "Peraklo", "link": "https://stackoverflow.com/users/866345/peraklo"}, "edited": false, "score": 0, "creation_date": 1443691254, "post_id": 32867690, "comment_id": 53597983, "body": "I have edited the VBA part of the question, i had a typo, used Popust instead of Discount."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1443691628, "post_id": 32867690, "comment_id": 53598210, "body": "So <code>Discount</code> is <code>Sheets(&quot;Input&quot;).Range(&quot;B3&quot;).Value</code>? What gets  <code>Debug.Print Discount: Debug.Print Str(Discount)</code>?"}, {"owner": {"reputation": 79, "user_id": 866345, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eb07f413a4937e2463c7e9b76ddad2f5?s=128&d=identicon&r=PG", "display_name": "Peraklo", "link": "https://stackoverflow.com/users/866345/peraklo"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1443694641, "post_id": 32867690, "comment_id": 53600005, "body": "Double checked everything, had one more typo. now everything works. @AxelRichter, thanks for your help."}], "answers": [{"tags": [], "owner": {"reputation": 3306, "user_id": 4475952, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4e04099aa2da5439d784f3d7ceb3ebc8?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/4475952/greg"}, "is_accepted": false, "score": 0, "last_activity_date": 1443630480, "creation_date": 1443630480, "answer_id": 32871236, "question_id": 32867690, "link": "https://stackoverflow.com/questions/32867690/passing-parameters-from-excel-to-sql/32871236#32871236", "title": "Passing parameters from Excel to SQL", "body": "<p>Your stored proc parameters have numeric data types defined, but your TSQL string built is passing in strings.  You need to remove the single quote you are placing around parameters <code>@discount</code>, <code>@lowerlimit</code> and <code>@midlimit</code>.</p>\n\n<p>To see the issue, simply add this code:</p>\n\n<pre><code>Dim tsql As String\ntsql = \"exec SP_Hello '\" &amp; Portfolio &amp; \"','\" &amp; Discount &amp; \"','\" &amp; lowerlimit &amp; \"','\" &amp; midlimit &amp; \"'\"\n</code></pre>\n\n<p>Print out tsql, and execute it in SSMS.  You should see the issue right away.</p>\n"}], "owner": {"reputation": 79, "user_id": 866345, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eb07f413a4937e2463c7e9b76ddad2f5?s=128&d=identicon&r=PG", "display_name": "Peraklo", "link": "https://stackoverflow.com/users/866345/peraklo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 572, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443691167, "creation_date": 1443620551, "last_edit_date": 1443691167, "question_id": 32867690, "link": "https://stackoverflow.com/questions/32867690/passing-parameters-from-excel-to-sql", "title": "Passing parameters from Excel to SQL", "body": "<pre class=\"lang-sql prettyprint-override\"><code>ALTER PROCEDURE [dbo].[SP_Hello] \n    @portfolio nvarchar(5), \n    @discount numeric(18,2), \n    @lowerlimit numeric(18,2), \n    @midlimit numeric(18,2)\nAS\nBEGIN\n    SET NOCOUNT ON;\n\n    SELECT distinct \n        EntityDescription, \n        d.AmountDueInCurr * @discount as [1st part],\n        d.AmountDueInCurr * (1 - @discount) as [2nd Part], \n        CASE WHEN d.AmountDueInCurr &lt;= 0 THEN 'Solution 1'\n             WHEN d.AmountDueInCurr between 0 and @lowerlimit THEN 'Solution 2'\n             WHEN d.AmountDueInCurr between (@lowerlimit + 0.01) and @midlimit THEN CONCAT(@portfolio, '-01')\n             WHEN d.AmountDueInCurr &gt; (@midlimit+0.01) THEN CONCAT(@portfolio, '-02')\n             ELSE 'Error' \n        END AS Solution_type\n    FROM \n        T1 d\n</code></pre>\n\n<p>and I would like to pass parameters from Excel, using VBA as this one:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton1_Click()\n\n    Dim Portfolio As String\n    Dim Discount As Single\n    Dim lowerlimit As Single\n    Dim midlimit As Single\n\n    Portfolio = Sheets(\"Input\").Range(\"B2\").Value\n    Popust = Sheets(\"Input\").Range(\"B3\").Value\n    lowerlimit = Sheets(\"Input\").Range(\"B4\").Value\n    midlimit = Sheets(\"Input\").Range(\"B5\").Value\n\n    With ActiveWorkbook.Connections(\"Hello_data\").OLEDBConnection\n        .CommandText = \"exec SP_Hello '\" &amp; Portfolio &amp; \"','\" &amp; Discount &amp; \"','\" &amp; lowerlimit &amp; \"','\" &amp; midlimit &amp; \"'\"\n        ActiveWorkbook.Connections(\"Hello_data\").Refresh\n    End With\n    Worksheets(2).Activate\nEnd Sub\n</code></pre>\n\n<p>Seems like no matter what I do (format, declare or Dim the variables/parameters), I always get the conversion data type error in Excel. I have tried everything from String to Double in excel as well as all numerical combinations in SQL, none of the combinations seem to work.</p>\n\n<p>If I pass just the Portfolio parameter (string) which is nvarchar in the database, it goes well. As soon as I add a number, or a Date into the combination, conversion errors appear.</p>\n"}, {"tags": ["excel", "vba", "automation", "powerpoint"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1443622411, "post_id": 32867412, "comment_id": 53568696, "body": "No need for a Public Sub, you can work in Excel or PowerPoint regardless (just add the references). Is the first image the powerpoint template? If you want to use macro recorder in PPT, download an old version (2003 or maybe even 2007 but I&#39;m not sure macro recorder wasn&#39;t unabled there yet). For regex in VBA, see the 2 top answers : <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a> And for the way to replace text, if it is just replacing the place holder, you could use the syntax of the manual search in Excel as a start."}, {"owner": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "edited": false, "score": 0, "creation_date": 1443625634, "post_id": 32867412, "comment_id": 53570937, "body": "Have you tried Bookmarks? so if you was to add a bookmark to where you want the value in powerpoint, then in excel add something like <code>.Bookmarks(&quot;Bookmark1&quot;).Range.Text = &quot;Whatever&quot; </code>.. you would need to declare the location of the powerpoint for this though."}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1443680662, "post_id": 32867412, "comment_id": 53591942, "body": "@R3uK, yes the first image is the ppt template, there are more pages like that but not with the same placeholders as the rest may or may not be the same values. Manual search + ctrl H?"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "reply_to_user": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "edited": false, "score": 1, "creation_date": 1443680698, "post_id": 32867412, "comment_id": 53591960, "body": "@Calum, no I haven&#39;t tried, but I am going to go look at it right now. Thank you"}, {"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "edited": false, "score": 0, "creation_date": 1541613603, "post_id": 32867412, "comment_id": 93278996, "body": "try www.pptxbuilder.com"}], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1443687691, "post_id": 32882057, "comment_id": 53595803, "body": "Indeed it is way simpler, but be careful with links between Office documents! I made a lot of reports with Word (and a bit with PowerPoint) but <b>these links are highly unstable in my experience/opinion</b>. I can&#39;t count the number of times I had to redo the whole templates because the links inexplicably crashed... So <b>be careful with that (always check after refresh) and when it is done, save the output as a copy somewhere else and then Break all the links and re-save.</b>"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1443689403, "post_id": 32882057, "comment_id": 53596764, "body": "If the location of both file doesnt change, there shouldn&#39;t be any problems, or less, right?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1443714981, "post_id": 32882057, "comment_id": 53613402, "body": "Better, but I wouldn&#39;t bet on any issue... Maybe PowerPoint is more stable than Word for that... I hope so!"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1443771279, "post_id": 32882057, "comment_id": 53633390, "body": "I don&#39;t have broken links yet, which is good, but when I update values in Excel, I have to update the links on powerpoint so that the updated values appear on Ppt. Do you know of any process that would make it automatic?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1443771511, "post_id": 32882057, "comment_id": 53633508, "body": "You could add code in <code>Worksheet_Change</code>event to update the links eveytime you make an update, but that might be ressource consuming. So maybe in <code>Workbook_BeforeSave</code>, you could prompt a MsgBox to choose if you want to update the value into the templates, I think this might be the best solution! ;)"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1443775107, "post_id": 32882057, "comment_id": 53635309, "body": "so I do need to write a macro after all. I am going to go look that up. thanks. (Do I put it in excel or powerpoint? I would go towards ppt, but the doc is for excel)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1443776883, "post_id": 32882057, "comment_id": 53636223, "body": "You&#39;ll have to put the code in Excel as you&#39;ll use the events happening in the workbook, go in <code>ThisWorkbook</code> module and look for the trigger that will be the best for you and you can simply <code>Call</code> a procedure that you store in a regular module in which you&#39;ll do the actual operations (open the ppt, refresh all links, save, close ppt, quit ppt app). If you want it to be done automatically, yup you&#39;ll have to code. But if it is to be updated 5 times a month, maybe that isn&#39;t really necessary but that only you can know!"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1443789374, "post_id": 32882057, "comment_id": 53642367, "body": "@R3uK When I open the powerpoint after having modified the excel sheet, ppt asks me if I want to update the links. I think that is what Im looking for. In any case, thank you so much for your help and input. It is appreciated."}], "tags": [], "owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "is_accepted": true, "score": 2, "last_activity_date": 1444027034, "last_edit_date": 1444027034, "creation_date": 1443685395, "answer_id": 32882057, "question_id": 32867412, "link": "https://stackoverflow.com/questions/32867412/generating-a-powerpoint-presentation-with-vba-and-excel/32882057#32882057", "title": "Generating a powerpoint presentation with VBA and Excel", "body": "<p>Found an approximate solution, but simpler than code writing.</p>\n\n<ul>\n<li>Open Excel, </li>\n<li>fill the values, and copy them onto the powerpoint presentation : use the special paste option between the cell (or cells/cell range) you want. </li>\n<li>Choose the \"paste the link\" option together with object worksheet Excel, select Ok.</li>\n</ul>\n\n<p>Both files will be linked. You can change the values in Excel, and they will change also in powerpoint. The formating is done on excel.</p>\n\n<p>In order to update all the values in the powerpoint after changing them on excel, powerpoint needs to be re-run, and at the restart of the application, accept the updating box prompt.</p>\n\n<p>I find this simpler than the other solutions.</p>\n"}], "owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 32882057, "answer_count": 1, "score": 1, "last_activity_date": 1444027034, "creation_date": 1443619748, "question_id": 32867412, "link": "https://stackoverflow.com/questions/32867412/generating-a-powerpoint-presentation-with-vba-and-excel", "title": "Generating a powerpoint presentation with VBA and Excel", "body": "<p>I have a template presentation on powerpoint.\nI would like to replace automatically generic placeholders with the value I input in an linked excel worksheet.</p>\n\n<p>I started looking at VBA at the begining of the week, I am not really yet familiar with the syntax, but I am optimistic I will find a way to understand it.</p>\n\n<p>I have put \"[  ]\" everywhere I want a value input:\n<a href=\"https://i.stack.imgur.com/feXyi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/feXyi.png\" alt=\"enter image description here\"></a></p>\n\n<p>the excel sheet present itself like this:\n<a href=\"https://i.stack.imgur.com/6Ayjx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6Ayjx.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would like to have some pointers (first, to know if it is indeed possible in powerpoint) to get me started in the right direction.</p>\n\n<p>Does it need to be a PublicSub()?\nAm I writing the macro on Powerpoint or in Excel?</p>\n\n<p>Can I use a fonction similar to LookupV to get the values to replace the placeholders?</p>\n\n<p>I would imagine something like :</p>\n\n<p>(side question : can I use regex inside of VBA?)</p>\n\n<pre><code>for each \"\\[.\\]\" '(or characterString.startsWith(\"[\")\nlookup characterString in excel, return column 3\nend each\n</code></pre>\n\n<p>Would this be possible?</p>\n\n<p>Thank you in advance, I really appreciate the help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6529, "user_id": 4252320, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh3.googleusercontent.com/-_DAs7Dtci9U/AAAAAAAAAAI/AAAAAAAAIf8/96ZNJAUF2Xk/photo.jpg?sz=128", "display_name": "ergonaut", "link": "https://stackoverflow.com/users/4252320/ergonaut"}, "edited": false, "score": 0, "creation_date": 1443619512, "post_id": 32867269, "comment_id": 53566602, "body": "<a href=\"https://support.microsoft.com/en-us/kb/161394\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/161394</a>"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1443620533, "post_id": 32867269, "comment_id": 53567312, "body": "Also a lot on SO using active directory at [<a href=\"http://stackoverflow.com/questions/7805856/vba-retrieve-the-name-of-the-user-associated-with-logged-username\" title=\"vba retrieve the name of the user associated with logged username\">stackoverflow.com/questions/7805856/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1443621181, "post_id": 32867269, "comment_id": 53567814, "body": "I would start by familiarizing myself with the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264486.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Environ function</a> and the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278665.aspx\" rel=\"nofollow noreferrer\">Select Case statement</a>."}, {"owner": {"reputation": 39, "user_id": 5160925, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f0a3978acac585703ce3d3b90cf3d191?s=128&d=identicon&r=PG&f=1", "display_name": "alessio cazzaniga", "link": "https://stackoverflow.com/users/5160925/alessio-cazzaniga"}, "edited": false, "score": 0, "creation_date": 1443682606, "post_id": 32867269, "comment_id": 53592931, "body": "Thanks for the editing and the answer."}, {"owner": {"reputation": 39, "user_id": 5160925, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f0a3978acac585703ce3d3b90cf3d191?s=128&d=identicon&r=PG&f=1", "display_name": "alessio cazzaniga", "link": "https://stackoverflow.com/users/5160925/alessio-cazzaniga"}, "edited": false, "score": 0, "creation_date": 1443686134, "post_id": 32867269, "comment_id": 53594997, "body": "Solved with the GoTo function and application.username."}, {"owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "edited": false, "score": 0, "creation_date": 1529101725, "post_id": 32867269, "comment_id": 88768832, "body": "Also, don&#39;t use &quot;.Select&quot; and &quot;Selection&quot; so much. <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?s=1|212.0759\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 5160925, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f0a3978acac585703ce3d3b90cf3d191?s=128&d=identicon&r=PG&f=1", "display_name": "alessio cazzaniga", "link": "https://stackoverflow.com/users/5160925/alessio-cazzaniga"}, "is_accepted": false, "score": 0, "last_activity_date": 1443686609, "creation_date": 1443686609, "answer_id": 32882428, "question_id": 32867269, "link": "https://stackoverflow.com/questions/32867269/running-a-different-macro-or-code-part-by-different-user/32882428#32882428", "title": "Running a different macro or code part by different user", "body": "<p>I'd like to post the solution to my issue:</p>\n\n<pre><code>Sub test_salva()\n\n**If Application.UserName = \"Manuela Frignani\" Then GoTo line1 Else GoTo         line2**\n\n**line1:**\nWorkbooks.Open Filename:= _\n    \"Z:\\Certificati SERIE\\2015\\MOD UNICO.xlsm\"\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveSheet.Range(\"A3\").Select\n  Do While Not IsEmpty(ActiveCell)\n  ActiveCell.Offset(1, 0).Select\n  Loop\n  ActiveCell.Offset(-1, 0).Select\n\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"AF31\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"R2\").Select\nActiveSheet.Paste\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"B5\").Select\nActiveSheet.Paste\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"AD4\").Select\nActiveSheet.Paste\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"AD5\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nprogressivo = Range(\"AF31\")\nnomefile = Range(\"B5\")\nActiveWorkbook.SaveAs Filename:= _\n    \"Z:\\Certificati SERIE\\2015\\S - Certificati Tubi\\\" &amp; progressivo &amp; \"-\" &amp;  nomefile _\n    , FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False \n     Windows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveSheet.Range(\"A3\").Select\nDo While Not IsEmpty(ActiveCell)\nActiveCell.Offset(1, 0).Select\nLoop\nActiveCell.Offset(-1, 0).Select\nvariabile = Selection\nnome = ActiveCell.Range(\"c1\")\nActiveCell.Offset(0, 2).Range(\"A1\").Select\nActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:= _\n    \"S%20-%20Certificati%20Tubi\\\" &amp; variabile &amp; \"-\" &amp; nome &amp; \".xlsm\",    TextToDisplay:=nome\nWith Selection.Font\n    .Name = \"Calibri Light\"\n    .Size = 17.6\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleSingle\n    .ThemeColor = xlThemeColorHyperlink\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nSelection.Font.Size = 16\nSelection.Font.Size = 14\nSelection.Font.Size = 12\nSelection.Font.Size = 11\nSelection.Font.Size = 10\nSelection.Font.Underline = xlUnderlineStyleNone\nSelection.Font.Underline = xlUnderlineStyleSingle\nWith Selection.Font\n    .ThemeColor = xlThemeColorLight1\n    .TintAndShade = 0.499984740745262\nEnd With\nActiveCell.Offset(1, -2).Range(\"A1\").Select\nGoTo line3\n\n\n**line2:**\nWorkbooks.Open Filename:= _\n    \"\\\\Share\\Qualita_MG\\Gestione Documentazione\\Doc. TECNICI- QUALITA'\\Moduli di supporto\\C - Controllo Qualita'\\MOD UNICO.xlsm\"\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveSheet.Range(\"A3\").Select\n  Do While Not IsEmpty(ActiveCell)\n  ActiveCell.Offset(1, 0).Select\n  Loop\n  ActiveCell.Offset(-1, 0).Select\n\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"AF31\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks  _\n    :=False, Transpose:=False\n\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"R2\").Select\nActiveSheet.Paste\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"B5\").Select\nActiveSheet.Paste\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"AD4\").Select\nActiveSheet.Paste\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"AD5\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nprogressivo = Range(\"AF31\")\nnomefile = Range(\"B5\")\nActiveWorkbook.SaveAs Filename:= _\n    \"\\\\Share\\Qualita_MG\\Documentazione registrazione\\Certificati SERIE\\2015\\S - Certificati Tubi\\\" &amp; progressivo &amp; \"-\" &amp; nomefile _\n    , FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False \n     Windows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveSheet.Range(\"A3\").Select\nDo While Not IsEmpty(ActiveCell)\n  ActiveCell.Offset(1, 0).Select\nLoop\nActiveCell.Offset(-1, 0).Select\nvariabile = Selection\nnome = ActiveCell.Range(\"c1\")\nActiveCell.Offset(0, 2).Range(\"A1\").Select\nActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:= _\n    \"S%20-%20Certificati%20Tubi\\\" &amp; variabile &amp; \"-\" &amp; nome &amp; \".xlsm\",  TextToDisplay:=nome\nWith Selection.Font\n    .Name = \"Calibri Light\"\n    .Size = 17.6\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleSingle\n    .ThemeColor = xlThemeColorHyperlink\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\n End With\n    Selection.Font.Size = 16\n    Selection.Font.Size = 14\n    Selection.Font.Size = 12\n    Selection.Font.Size = 11\n    Selection.Font.Size = 10\n    Selection.Font.Underline = xlUnderlineStyleNone\n    Selection.Font.Underline = xlUnderlineStyleSingle\nWith Selection.Font\n    .ThemeColor = xlThemeColorLight1\n    .TintAndShade = 0.499984740745262\nEnd With\n    ActiveCell.Offset(1, -2).Range(\"A1\").Select\n\n**line3:**\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5160925, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f0a3978acac585703ce3d3b90cf3d191?s=128&d=identicon&r=PG&f=1", "display_name": "alessio cazzaniga", "link": "https://stackoverflow.com/users/5160925/alessio-cazzaniga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443686609, "creation_date": 1443619349, "last_edit_date": 1443639408, "question_id": 32867269, "link": "https://stackoverflow.com/questions/32867269/running-a-different-macro-or-code-part-by-different-user", "title": "Running a different macro or code part by different user", "body": "<p>I wrote a macro to save a file onto a specific URL.\nThe problem is that the macro is run by different users in my company with       different levels of permission to access to the intranet's folders.\nThe macro is activated by a button on the spreadsheet.\nAs far as I know I have at least 2 solutions:</p>\n\n<ol>\n<li>Create different macros and link them to different buttons(users will press their respective. Not elegant-possibility to get in error)</li>\n<li>Make VBA recognise the user and run a specific macro or code string with the correct SAVE AS url.\nI'd avoid the first solution, but I don't know how to write the second.</li>\n</ol>\n\n<p>Here's the entire code with the path in <strong>SAVE AS</strong> method:</p>\n\n<pre><code>Sub test_salva()\n\nWorkbooks.Open Filename:= _\n    \"\\\\Share\\Qualita_MG\\Gestione Documentazione\\Doc. TECNICI-  QUALITA'\\Moduli di supporto\\C - Controllo Qualita'\\MOD UNICO.xlsm\"\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveSheet.Range(\"A3\").Select\n  Do While Not IsEmpty(ActiveCell)\n  ActiveCell.Offset(1, 0).Select\n  Loop\n  ActiveCell.Offset(-1, 0).Select\n\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"AF31\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"R2\").Select\nActiveSheet.Paste\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"B5\").Select\nActiveSheet.Paste\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"AD4\").Select\nActiveSheet.Paste\nWindows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"MOD UNICO.xlsm\").Activate\nSheets(\"Ita-Eng\").Activate\nRange(\"AD5\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nprogressivo = Range(\"AF31\")\nnomefile = Range(\"B5\")\nActiveWorkbook.SaveAs Filename:= _\"\\\\Share\\Qualita_MG\\Documentazione  registrazione\\Certificati SERIE\\2015\\S - Certificati Tubi\\\" &amp; progressivo &amp; \"-\" &amp; nomefile _ \n, FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False \n     Windows(\"RIEPILOGATIVO 2015.xlsb.xlsm\").Activate\nActiveSheet.Range(\"A3\").Select\nDo While Not IsEmpty(ActiveCell)\nActiveCell.Offset(1, 0).Select\nLoop\nActiveCell.Offset(-1, 0).Select\nvariabile = Selection\nnome = ActiveCell.Range(\"c1\")\nActiveCell.Offset(0, 2).Range(\"A1\").Select\nActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:= _\n    \"S%20-%20Certificati%20Tubi\\\" &amp; variabile &amp; \"-\" &amp; nome &amp; \".xlsm\",   TextToDisplay:=nome\n\nActiveCell.Offset(1, -2).Range(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1443618726, "post_id": 32867005, "comment_id": 53566068, "body": "I would advise not using &quot;On Error Resume Next&quot; unless you know EXACTLY what is happening with you code!!"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1443618772, "post_id": 32867005, "comment_id": 53566102, "body": "What error is the code giving you?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1443618857, "post_id": 32867005, "comment_id": 53566153, "body": "remove the continuation character &#39;_&#39; at the end of the If... Then line and uncomment the Else and end if lines"}, {"owner": {"reputation": 605, "user_id": 2918939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f048b224d7c59c683a18ce3934d0fd81?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/2918939/ale"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1443619164, "post_id": 32867005, "comment_id": 53566377, "body": "@Vincent G in this case (if i remove _ and uncoment Else and End If) i get a compile error: Else without if"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1443619437, "post_id": 32867005, "comment_id": 53566560, "body": "Shouldn&#39;t happen. Did you remove the _ before  or after the comments? You have only one If.. Then and one Else with no End if between."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1443619653, "post_id": 32867005, "comment_id": 53566714, "body": "By the way you didn&#39;t need the Else in any case, see my answer bellow. The x need to be incremented every time, and you will need a variable for the destination row."}], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 2918939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f048b224d7c59c683a18ce3934d0fd81?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/2918939/ale"}, "edited": false, "score": 0, "creation_date": 1443625143, "post_id": 32867335, "comment_id": 53570598, "body": "Thanks it almost does what i need. The only problem, for the string: If .Cells(x, 4) = &quot;ATTIVO&quot; And .Cells(x, 6) &gt;= 130 Then it gives an error: Run- Time error &#39;13&#39;: Type mismatch, what could it be?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 605, "user_id": 2918939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f048b224d7c59c683a18ce3934d0fd81?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/2918939/ale"}, "edited": false, "score": 0, "creation_date": 1443629903, "post_id": 32867335, "comment_id": 53573801, "body": "you might need to access the data through the Value Property? try <code>If .Cells(x, 4).Value2 = &quot;ATTIVO&quot; And .Cells(x, 6).Value2 &gt;= 130 Then</code>"}, {"owner": {"reputation": 605, "user_id": 2918939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f048b224d7c59c683a18ce3934d0fd81?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/2918939/ale"}, "edited": false, "score": 0, "creation_date": 1443685192, "post_id": 32867335, "comment_id": 53594439, "body": "unfortunately it gives the same error also with the modification specified above"}, {"owner": {"reputation": 605, "user_id": 2918939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f048b224d7c59c683a18ce3934d0fd81?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/2918939/ale"}, "edited": false, "score": 0, "creation_date": 1443686105, "post_id": 32867335, "comment_id": 53594980, "body": "When it copies 960680/90 value, and passes to the string If (.Cells(x, 4).Value2 = &quot;ATTIVO&quot;) And (.Cells(x, 6).Value2 &gt;= 130) Then, the macro stops giving an error"}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1443630030, "last_edit_date": 1443630030, "creation_date": 1443619517, "answer_id": 32867335, "question_id": 32867005, "link": "https://stackoverflow.com/questions/32867005/how-to-check-a-table-range-and-paste-selected-values-to-a-new-worksheet-in-vba/32867335#32867335", "title": "How to check a table range and paste selected values to a new worksheet in VBA?", "body": "<pre><code>Sub Macroarea1()\n    Dim ws As Worksheet\n    Dim LastRow As Long\n    Dim LastRow1 As Long, LastRow3 As Long\n    Dim i, n, x As Integer, y As Integer\n    Set ws = ActiveWorkbook.Sheets(\"Report KIT\")\n\n    n = Sheets(\"Migrazioni\").Range(\"N\" &amp; 7).Value\n    LastRow3 = Sheets(\"Report KIT\").Range(\"G\" &amp; Sheets(\"Report KIT\").Rows.Count).End(xlUp).Row\n    y = 3\n    For x = n To LastRow3\n        With Sheets(\"Report KIT\")\n        If (.Cells(x, 4).Value2 = \"ATTIVO\") And (.Cells(x, 6).Value2 &gt;= 130) Then\n            .Cells(x, 7).Copy\n            Sheets(\"KIT\").Cells(y, 1).PasteSpecial xlPasteValues\n            y = y + 1\n        End if\n        x = x + 1\n        End With\n    Next x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 605, "user_id": 2918939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f048b224d7c59c683a18ce3934d0fd81?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/2918939/ale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443630030, "creation_date": 1443618594, "last_edit_date": 1531164843, "question_id": 32867005, "link": "https://stackoverflow.com/questions/32867005/how-to-check-a-table-range-and-paste-selected-values-to-a-new-worksheet-in-vba", "title": "How to check a table range and paste selected values to a new worksheet in VBA?", "body": "<p>I\u2019m trying to check all the rows from 63 to 69 in table 1, if column D value is \u201cATTIVO\u201d AND column \u201cF\u201d value  >= 130,\ni'd like to paste the G column value into another WorkSheet starting from A3 cell.\nIf the condition is False I\u2019d like to to pass to next row and do the same check for all rows, coping and pasting if the condition is True.</p>\n\n<p>n = 63; LastRow3 = 69.</p>\n\n<p>Table 1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ea464.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ea464.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Table 2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NeKYG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NeKYG.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Macroarea1()\n    Dim ws As Worksheet\n    Dim LastRow As Long\n    Dim LastRow1 As Long, LastRow3 As Long\n    Dim i, n, x As Integer\n    Set ws = ActiveWorkbook.Sheets(\"Report KIT\")\n\n    n = Sheets(\"Migrazioni\").Range(\"N\" &amp; 7).Value\n    LastRow3 = Sheets(\"Report KIT\").Range(\"G\" &amp; Sheets(\"Report KIT\").Rows.Count).End(xlUp).Row\n\n    For x = n To LastRow3\n        On Error Resume Next\n        If Sheets(\"Report KIT\").Range(\"D\" &amp; x) = \"ATTIVO\" And Cells(x, 6) &gt;= 130 Then _\n        Sheets(\"Report KIT\").Range(\"G\" &amp; x).Copy\n        Sheets(\"KIT\").Range(\"A3\").PasteSpecial xlPasteValues\n        'Else\n        x = x + 1\n        'End If\n    Next x\n\nEnd Sub\n</code></pre>\n\n<p>For example for 1st table input I\u2019d like to have a second table as an output.</p>\n\n<p>Unfortunately a VBA gives me an error (that Else condition is not ok). \nI guess I\u2019ve built all the For cycle in a wrong way.\nCan anyone help with it, please?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1443668597, "post_id": 32866767, "comment_id": 53588394, "body": "If you search stack overflow you will find lots of examples"}, {"owner": {"reputation": 1, "user_id": 5392848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee3fd091cfaa19066c2fe77e43ecfe3?s=128&d=identicon&r=PG&f=1", "display_name": "Chandresh Batra", "link": "https://stackoverflow.com/users/5392848/chandresh-batra"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1443699280, "post_id": 32866767, "comment_id": 53602760, "body": "It would be great if you can share the link."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1443765973, "post_id": 32866767, "comment_id": 53631270, "body": "What does the email body looks like ?"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1444506994, "creation_date": 1444506994, "answer_id": 33058366, "question_id": 32866767, "link": "https://stackoverflow.com/questions/32866767/display-mail-on-the-basis-of-the-subject/33058366#33058366", "title": "Display mail on the basis of the subject", "body": "<p>I'd suggest starting from the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article which explains the basics.</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863686.aspx\" rel=\"nofollow\">NewMailEx</a> event of the Application class is fired when a new item is received in the Inbox. This event fires once for every received item that is processed by Microsoft Outlook. The item can be one of several different item types, for example, MailItem, MeetingItem, or SharingItem. The EntryIDsCollection string contains the Entry ID that corresponds to that item.</p>\n\n<p>The NewMailEx event fires when a new message arrives in the Inbox and before client rule processing occurs. You can use the Entry ID returned in the EntryIDCollection array to call the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869893.aspx\" rel=\"nofollow\">NameSpace.GetItemFromID</a> method and process the item. Use this method with caution to minimize the impact on Outlook performance. However, depending on the setup on the client computer, after a new message arrives in the Inbox, processes like spam filtering and client rules that move the new message from the Inbox to another folder can occur asynchronously. Y</p>\n\n<p>You may check the <code>Subject</code> property and export the data from the message body if required. For that you can automate Excel from Outlook. See <a href=\"https://support.microsoft.com/en-us/kb/219151\" rel=\"nofollow\">How to automate Microsoft Excel from Visual Basic</a> for more information.</p>\n"}], "owner": {"reputation": 1, "user_id": 5392848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee3fd091cfaa19066c2fe77e43ecfe3?s=128&d=identicon&r=PG&f=1", "display_name": "Chandresh Batra", "link": "https://stackoverflow.com/users/5392848/chandresh-batra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1593074523, "creation_date": 1443617974, "last_edit_date": 1593074523, "question_id": 32866767, "link": "https://stackoverflow.com/questions/32866767/display-mail-on-the-basis-of-the-subject", "title": "Display mail on the basis of the subject", "body": "<p>On a daily basis I receive a mail which is comprised of tables and text. </p>\n\n<p>I want to detect the mail on the basis of the mail subject and copy data of the table to an Excel sheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1443623138, "post_id": 32866530, "comment_id": 53569181, "body": "Is there a problem with your code? Do you have a error popping up or is the code just not doing what you expect it to do? If so, what is it doing as opposed to what you wanted it to do? At the same time, I would like to comment that you should code a bit more explicitly: tell VBA what to compare and don&#39;t let VBA assume what you want to compare. Hence, I would change <code>If r1 = r2 then</code> to <code>If r1.Value2 = r2.Value2 then</code> (same for the line <code>If Range(&quot;B&quot; &amp; i).Offet...</code>."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 5103111, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81d8854c847ac9a8976f5edd04294387?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/5103111/gaus-shaikh"}, "edited": false, "score": 0, "creation_date": 1443704463, "post_id": 32869394, "comment_id": 53606226, "body": "Just one more favour. Can i also compare the column &quot;B&quot; wiht column &quot;XDF&quot; and highlight the unmatch cell with red"}], "tags": [], "owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "is_accepted": false, "score": 0, "last_activity_date": 1443625077, "creation_date": 1443625077, "answer_id": 32869394, "question_id": 32866530, "link": "https://stackoverflow.com/questions/32866530/compare-column-and-colour-the-cell-if-not-matched/32869394#32869394", "title": "Compare column and colour the cell if not matched", "body": "<p>Try this ...</p>\n\n<pre><code>Application.ScreenUpdating = False\nDim stNow As Date\nDim lastA As Long\nDim lastB As Long\nDim i As Long\nDim j As Long\nDim r1 As Range\nDim r2 As Range\nDim i_store As Integer\n\nlastA = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nlastB = Range(\"XFD\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 2 To lastA\n   Set r1 = Range(\"B\" &amp; i)\n   i_store = 0\n   For j = 2 To lastB\n      Set r2 = Range(\"XFD\" &amp; j)\n      If r1.Value = r2.Value Then\n         If Range(\"B\" &amp; i).Offset(0, 1) = Range(\"XFD\" &amp; j).Offset(0, -1)   Then\n            i_store = 0\n            Exit For\n         Else\n            If i_store = 0 Then\n               i_store = i\n            End If\n         End If\n       End If\n   Next j\n   If i_store &gt; 0 Then\n      Range(\"B\" &amp; i_store).Offset(0, 1).Interior.Color = RGB(255, 0, 0)\n   End If\n Next i\n Application.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5103111, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81d8854c847ac9a8976f5edd04294387?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/5103111/gaus-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443627979, "creation_date": 1443617261, "last_edit_date": 1531164843, "question_id": 32866530, "link": "https://stackoverflow.com/questions/32866530/compare-column-and-colour-the-cell-if-not-matched", "title": "Compare column and colour the cell if not matched", "body": "<p>I have two columns which I am comparing with another two columns. First Column 'B' is checking with Column 'XFD' and if the values are not matching, the cells groundcolour get changed to red. Simultaniously, I am check if column 'C' is matching with column'XFC'. </p>\n\n<p>I want to color the column 'C' if values are not matching but my coding the changing the colour if values are matching. Please advise on coding.</p>\n\n<pre><code>Column B  Column C     Column 'XFC    Column 'XFD' \nQ1          Jan-15      Jan-15           Q1\nQ2          Oct-15      Feb-15           Q1\nQ3          Jul-15      Mar-15           Q1\nQ4          Dec-15      Apr-15           Q2\n                        May-15           Q2\n                        Jun-15           Q2\n                        Jul-15           Q3\n                        Aug-15           Q3\n                        Sep-15           Q3\n                        Oct-15           Q4\n                        Nov-15           Q4\n                        Dec-15           Q4\n</code></pre>\n\n<p>Coding</p>\n\n<pre><code>Application.ScreenUpdating = False\n  Dim stNow As Date\n  Dim lastA As Long\n  lastA = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n  Dim lastB As Long\n  lastB = Range(\"XFD\" &amp; Rows.Count).End(xlUp).Row\n  Dim match As Boolean\n  Dim i As Long, j As Long\n  Dim r1 As Range, r2 As Range\n  For i = 2 To lastA\n   Set r1 = Range(\"B\" &amp; i)\n   match = False\n   For j = 2 To lastB\n      Set r2 = Range(\"XFD\" &amp; j)\n      If r1 = r2 Then\n         match = True\n         If Range(\"B\" &amp; i).Offset(0, 1) = Range(\"XFD\" &amp; j).Offset(0, -1) Then\n\n            Range(\"B\" &amp; i).Offset(0, 1).Interior.Color = RGB(255, 0, 0)\n\n         End If\n      End If\n   Next j\nNext i\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1443616266, "post_id": 32866167, "comment_id": 53564345, "body": "If IsNothing(sCell.Value2) Then...    Or you could try: If IsEmpty(sCell.Value2) Then"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1443616343, "post_id": 32866167, "comment_id": 53564398, "body": "&quot;what i cannot get working&quot; - <i>what</i> isn&#39;t working? You need to clarify this."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1443616405, "post_id": 32866167, "comment_id": 53564437, "body": "@JeremyThompson did you mean <code>IsEmpty()</code>? :)"}, {"owner": {"reputation": 31, "user_id": 5375180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea90bc9e37b315970d5158568e6960b?s=128&d=identicon&r=PG&f=1", "display_name": "Velocius", "link": "https://stackoverflow.com/users/5375180/velocius"}, "edited": false, "score": 0, "creation_date": 1443617614, "post_id": 32866167, "comment_id": 53565266, "body": "Updated question with the IsEmpty() function. Same as the code beforehand it returns Runtime Error 424 (Object Required)"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5375180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea90bc9e37b315970d5158568e6960b?s=128&d=identicon&r=PG&f=1", "display_name": "Velocius", "link": "https://stackoverflow.com/users/5375180/velocius"}, "edited": false, "score": 0, "creation_date": 1443620491, "post_id": 32867268, "comment_id": 53567281, "body": "Thanks for this. Works now."}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1443619348, "creation_date": 1443619348, "answer_id": 32867268, "question_id": 32866167, "link": "https://stackoverflow.com/questions/32866167/checking-if-the-cell-is-empty-and-updating-the-cell-value-if-empty-with-vba/32867268#32867268", "title": "Checking if the cell is empty and updating the cell value if empty with VBA", "body": "<p>sCell is not an object, its a variant containing a value:</p>\n\n<p>Try</p>\n\n<pre><code>    Dim sCell as range\n    Set sCell=book2.Sheets(\"TB\").Range(\"D\" &amp; rw)\n    If IsEmpty(sCell) then\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5375180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea90bc9e37b315970d5158568e6960b?s=128&d=identicon&r=PG&f=1", "display_name": "Velocius", "link": "https://stackoverflow.com/users/5375180/velocius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 542, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443619348, "creation_date": 1443616187, "last_edit_date": 1443618863, "question_id": 32866167, "link": "https://stackoverflow.com/questions/32866167/checking-if-the-cell-is-empty-and-updating-the-cell-value-if-empty-with-vba", "title": "Checking if the cell is empty and updating the cell value if empty with VBA", "body": "<p>So i am trying to get users to submit times to a spreadsheet and have it update an external workbook. The updating works fine but what i cannot get working is the If statement before the external workbook closes that checks if the cell you are updating is empty or not first.\nIf the cell is empty, go ahead and update, otherwise return Message.</p>\n\n<p>Code so far: Gets Runtime Error 424 (Object Required)</p>\n\n<pre><code>Private Sub submit_Click()\nApplication.ScreenUpdating = False\nWorkbooks.Open Filename:=\"Test_Book.xlsx\"\nThisWorkbook.Activate\nApplication.ScreenUpdating = True\n\nDim fDate As Date\nDim rw As Long\nDim srchRange As Range\nDim book2Name As String, book2 As Workbook\n\nbook2Name = \"Test_Book.xlsx\"    ' Name of Source File\nSet book2 = Workbooks(book2Name)\n\nfDate = Format(CDate(Month.Text &amp; \"/\" &amp; Day.Text &amp; \"/2015\"), \"dd/mm/yy\")\nfTime = Format(Hour.Text &amp; \":\" &amp; Min.Text, \"hh:mm\")\n\nSet srchRange = book2.Sheets(\"TB\").Range(\"B:B\")    ' Search Range\n\nIf Application.CountIf(srchRange, fDate) Then\n    rw = Application.Match(CLng(fDate), srchRange, 0)   ' Return row of result\nElse\n    MsgBox Format(fDate, \"dd/mm/yy\") &amp; \" not found.\"\nEnd If\n\nsCell = book2.Sheets(\"TB\").Range(\"D\" &amp; rw)\n\nIf IsEmpty(sCell.Value) Then\nsCell.Value = fTime\nElse\nMsgBox (\"There is already a time in this cell\")\nEnd If\n\nApplication.DisplayAlerts = False\nWorkbooks(\"Master_Timesheet.xlsx\").Close SaveChanges:=True\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1443619119, "post_id": 32865498, "comment_id": 53566340, "body": "You can make your life a lot easier by using single quotes for SQL that you create in VBA: <code>&quot;[Fornavn] Like &#39;*&quot; &amp; [Forms]![Navigationsformular]![NavigationUnderformular]![Sea&zwnj;&#8203;rchFor] &amp; &quot;*&#39; Or [CPR] Like &#39;*&quot; &amp; [Forms]!...</code> -- No more double and triple quotes."}], "answers": [{"comments": [{"owner": {"reputation": 43082, "user_id": 74195, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/2Il1P.jpg?s=128&g=1", "display_name": "DRapp", "link": "https://stackoverflow.com/users/74195/drapp"}, "edited": false, "score": 0, "creation_date": 1443615477, "post_id": 32865820, "comment_id": 53563789, "body": "Just to clarify... the missing &quot; was at the end of the last &quot;&quot;*&quot;&quot; section.  Otherwise without knowing they might miss it as it looks like a blur anyhow :)"}, {"owner": {"reputation": 5566, "user_id": 1771479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5m0gd.jpg?s=128&g=1", "display_name": "agold", "link": "https://stackoverflow.com/users/1771479/agold"}, "reply_to_user": {"reputation": 43082, "user_id": 74195, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/2Il1P.jpg?s=128&g=1", "display_name": "DRapp", "link": "https://stackoverflow.com/users/74195/drapp"}, "edited": false, "score": 0, "creation_date": 1443615800, "post_id": 32865820, "comment_id": 53564001, "body": "Actually they were missing after and before the others (<code>&quot;&quot;*&quot;&quot;</code>) also."}, {"owner": {"reputation": 587, "user_id": 5392844, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53671a73197b767208eb7ae40f3db2fc?s=128&d=identicon&r=PG&f=1", "display_name": "Danishdjinn", "link": "https://stackoverflow.com/users/5392844/danishdjinn"}, "edited": false, "score": 0, "creation_date": 1443616652, "post_id": 32865820, "comment_id": 53564616, "body": "ah, now it&#39;s sort of working. There&#39;re no more syntax error, but &quot;Compile error: External name not defined&quot; showed up instead. Hmm... any idea?"}, {"owner": {"reputation": 5566, "user_id": 1771479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5m0gd.jpg?s=128&g=1", "display_name": "agold", "link": "https://stackoverflow.com/users/1771479/agold"}, "edited": false, "score": 0, "creation_date": 1443616743, "post_id": 32865820, "comment_id": 53564686, "body": "To which name does it refer to? Have you checked all the column, form, and field names?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1443619348, "post_id": 32865820, "comment_id": 53566504, "body": "It&#39;s <code>Forms!Mainform!Subform1.Form!ControlName</code> i.e. <code>[Forms]![Navigationsformular]![NavigationUnderformular].Form&zwnj;&#8203;![SearchFor]</code>. Here is a good reference: <a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow noreferrer\">access.mvps.org/access/forms/frm0031.htm</a>"}, {"owner": {"reputation": 587, "user_id": 5392844, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53671a73197b767208eb7ae40f3db2fc?s=128&d=identicon&r=PG&f=1", "display_name": "Danishdjinn", "link": "https://stackoverflow.com/users/5392844/danishdjinn"}, "edited": false, "score": 0, "creation_date": 1443693077, "post_id": 32865820, "comment_id": 53599102, "body": "@Agold: Yes, I have checked all of them. Nothing looks really out of place, so I&#39;m more or less clueless."}, {"owner": {"reputation": 587, "user_id": 5392844, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53671a73197b767208eb7ae40f3db2fc?s=128&d=identicon&r=PG&f=1", "display_name": "Danishdjinn", "link": "https://stackoverflow.com/users/5392844/danishdjinn"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1443693266, "post_id": 32865820, "comment_id": 53599216, "body": "@Andre451: Well, the error is still there after change the refer. But thanks for the link anyway!"}, {"owner": {"reputation": 5566, "user_id": 1771479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5m0gd.jpg?s=128&g=1", "display_name": "agold", "link": "https://stackoverflow.com/users/1771479/agold"}, "edited": false, "score": 0, "creation_date": 1443693903, "post_id": 32865820, "comment_id": 53599580, "body": "Try to debug it by doing a query directly, and put the values which you put in the form. If then query doesn&#39;t give you good results, try to do just parts of the query. If the query does work then check if your form is correct, and if you really got the correct values."}, {"owner": {"reputation": 587, "user_id": 5392844, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53671a73197b767208eb7ae40f3db2fc?s=128&d=identicon&r=PG&f=1", "display_name": "Danishdjinn", "link": "https://stackoverflow.com/users/5392844/danishdjinn"}, "edited": false, "score": 0, "creation_date": 1443696300, "post_id": 32865820, "comment_id": 53600982, "body": "@agold: Well, the query works. The form is correct, however I&#39;m kinda confuse with the correct values. Weird enough the macro version of it works by giving the correct values when the VBA version don&#39;t."}], "tags": [], "owner": {"reputation": 5566, "user_id": 1771479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5m0gd.jpg?s=128&g=1", "display_name": "agold", "link": "https://stackoverflow.com/users/1771479/agold"}, "is_accepted": true, "score": 1, "last_activity_date": 1443615660, "last_edit_date": 1443615660, "creation_date": 1443615319, "answer_id": 32865820, "question_id": 32865498, "link": "https://stackoverflow.com/questions/32865498/seach-function-in-access-syntax-error-missing-a-comma-in-query-expression/32865820#32865820", "title": "Seach function in Access syntax error: missing a comma in query expression", "body": "<p>You have forgotten to put some quote signs (\"): </p>\n\n<pre><code>DoCmd.SetFilter \"S\u00f8gnings foresp\u00f8rgelse\", \"[Fornavn] Like \"\"*\"\"\" &amp; [Forms]![Navigationsformular]![NavigationUnderformular]![SearchFor] &amp; \"\"\"*\"\" Or [CPR] Like \"\"*\"\"\" &amp; [Forms]![Navigationsformular]![NavigationUnderformular]![SearchFor] &amp; \"\"\"*\"\" Or [Efternavn] Like \"\"*\"\"\" &amp; [Formularer]![Navigationsformular]![NavigationUnderformular]![SearchFor] &amp; \"\"*\"\"\", \"\"\"\"\n</code></pre>\n\n<p>You probably forgot them because you need to put the quote character twice  to have it in the string (as escape character).</p>\n"}], "owner": {"reputation": 587, "user_id": 5392844, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53671a73197b767208eb7ae40f3db2fc?s=128&d=identicon&r=PG&f=1", "display_name": "Danishdjinn", "link": "https://stackoverflow.com/users/5392844/danishdjinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 32865820, "answer_count": 1, "score": 0, "last_activity_date": 1443615660, "creation_date": 1443614302, "question_id": 32865498, "link": "https://stackoverflow.com/questions/32865498/seach-function-in-access-syntax-error-missing-a-comma-in-query-expression", "title": "Seach function in Access syntax error: missing a comma in query expression", "body": "<p>I have a problem while I'm working on a search function at Windows Access that allowed me to search after 3 things. In this case, it's first name, Last name and CPR. Now the CPR means it's a serial of unique numbers to each users on my Database. </p>\n\n<p>It started as a macro then I changed it into VBA code because I want it to have the option to search after 3.</p>\n\n<p>when it's in macro, it can only find 2 things because the limit for write characters in macro is 255, which is the reason that I changed it to VBA code which the characters limit should be unlimited.</p>\n\n<p>Ah, I almost forgot, the code's in danish, but I think the basic functions of the code is almost pretty much same everywhere so...</p>\n\n<p>Here is the problem: </p>\n\n<pre><code>On Error GoTo S\u00f8gEfterFornavn_Err\n\n    If (IsNull(Forms!Navigationsformular!NavigationUnderformular!SearchFor)) Then\n        Beep\n        Exit Function\n    Else\n        DoCmd.SetFilter \"S\u00f8gnings foresp\u00f8rgelse\", \"[Fornavn] Like \"\"*\"\" &amp; [Forms]![Navigationsformular]![NavigationUnderformular]![SearchFor] &amp; \"\"*\"\" Or [CPR] Like \"\"*\"\" &amp; [Forms]![Navigationsformular]![NavigationUnderformular]![SearchFor] &amp; \"\"*\"\" Or [Efternavn] Like \"\"*\"\" &amp; [Formularer]![Navigationsformular]![NavigationUnderformular]![SearchFor] &amp; \"\"*\"\", \"\"\"\"\n        Exit Function\n    End If\n\n\nS\u00f8gEfterFornavn_Exit:\n    Exit Function\n\nS\u00f8gEfterFornavn_Err:\n    MsgBox Error$\n    Resume S\u00f8gEfterFornavn_Exit\n</code></pre>\n\n<p>It keeps saying that \"Syntax error: missing a comma in query expression\" \nwhich I don't understand? Did I do something wrong or?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1443615901, "post_id": 32865438, "comment_id": 53564083, "body": "You need to grab the instance of Excel that&#39;s (presumably) already open, and then qualify the workbook reference with an application object. Alternatively, create a new instance of Excel and open the workbook through that instance setting a reference to it."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1443618599, "post_id": 32865438, "comment_id": 53565963, "body": "As said @MacroMan, the issue is probably that your code is in Outlook and cannot detect which workbook you are trying to use."}, {"owner": {"reputation": 71, "user_id": 1983577, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf23853df74fda5dfcee0fb9fdd94681?s=128&d=identicon&r=PG", "display_name": "lifeinvba", "link": "https://stackoverflow.com/users/1983577/lifeinvba"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1443694010, "post_id": 32865438, "comment_id": 53599633, "body": "Thanks @Macro Man, Since I already tried and failed with the referencing the Excel application object,  could you please confirm where the changes to be done in the code with Excel.application object, will change the code accordingly."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1443694150, "post_id": 32865438, "comment_id": 53599712, "body": "@lifeinvba Is the workbook already open when you run this code - or do you want to open the workbook with the code?"}, {"owner": {"reputation": 71, "user_id": 1983577, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf23853df74fda5dfcee0fb9fdd94681?s=128&d=identicon&r=PG", "display_name": "lifeinvba", "link": "https://stackoverflow.com/users/1983577/lifeinvba"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1443694151, "post_id": 32865438, "comment_id": 53599713, "body": "@R3uK thanks for the update,since am facing this issue for the first time, if you can modify the code and assist me it would be extremely helpful."}, {"owner": {"reputation": 71, "user_id": 1983577, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf23853df74fda5dfcee0fb9fdd94681?s=128&d=identicon&r=PG", "display_name": "lifeinvba", "link": "https://stackoverflow.com/users/1983577/lifeinvba"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1443694408, "post_id": 32865438, "comment_id": 53599855, "body": "@Macro Man well I open the excel file and then run the code. If you can tweak the code to make the excel open that will also help me a lot."}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 0, "last_activity_date": 1443695465, "last_edit_date": 1443695465, "creation_date": 1443694785, "answer_id": 32885086, "question_id": 32865438, "link": "https://stackoverflow.com/questions/32865438/method-thisworkbook-of-object-global-failed/32885086#32885086", "title": "Method &#39;ThisWorkbook&#39; of object &#39;_Global&#39; failed", "body": "<p>Just a couple of quick tweaks, try this:</p>\n\n<pre><code>Option Explicit\nSub Download_Outlook_Mail_To_Excel()\nDim Folder          As Outlook.MAPIFolder\nDim sFolders        As Outlook.MAPIFolder\nDim iRow            As Integer\nDim oRow            As Integer\nDim MailBoxName     As String\nDim Pst_Folder_Name As String\n\nConst xlWorkbookName As String = \"C:\\Users\\MacroMan\\MyWorkbook.xlsx\" '// change as required\n\n'// I'm using late binding in case you don't actually have a reference set.\nDim xlApp           As Object\nDim xlWB            As Object\n\nSet xlApp = CreateObject(\"Excel.Application\")\n    xlApp.Visible = False\n\nSet xlWB = xlApp.Workbooks.Open(xlWorkbookName)\n\nMailBoxName = \"Backupmailbox\"\n\n\nPst_Folder_Name = \"Inbox1\" 'Sample \"Inbox\" or \"Sent Items\"\n\n'To directly a Folder at a high level\n'Set Folder = Outlook.Session.Folders(MailBoxName).Folders(Pst_Folder_Name)\n\n'To access a main folder or a subfolder (level-1)\nFor Each Folder In Outlook.Session.Folders(MailBoxName).Folders\n    If VBA.UCase(Folder.Name) = VBA.UCase(Pst_Folder_Name) Then GoTo Label_Folder_Found\n    For Each sFolders In Folder.Folders\n        If VBA.UCase(sFolders.Name) = VBA.UCase(Pst_Folder_Name) Then\n            Set Folder = sFolders\n            GoTo Label_Folder_Found\n        End If\n    Next sFolders\nNext Folder\n\nLabel_Folder_Found:\n If Folder.Name = \"\" Then\n    MsgBox \"Invalid Data in Input\"\n    GoTo End_Lbl1:\nEnd If\n\n'Read Through each Mail and export the details to Excel for Email Archival\nxlWB.Sheets(1).Activate\nFolder.Items.Sort \"Received\"\n\n'Insert Column Headers\nxlWB.Sheets(1).Cells(1, 1) = \"Sender\"\nxlWB.Sheets(1).Cells(1, 2) = \"Subject\"\nxlWB.Sheets(1).Cells(1, 3) = \"Date\"\nxlWB.Sheets(1).Cells(1, 4) = \"Size\"\nxlWB.Sheets(1).Cells(1, 5) = \"EmailID\"\n'ThisWorkbook.Sheets(1).Cells(1, 6) = \"Body\"\n\n'Export eMail Data from PST Folder\noRow = 1\nFor iRow = 1 To Folder.Items.Count\n    'If condition to import mails received in last 60 days\n    'To import all emails, comment or remove this IF condition\n    If VBA.DateValue(VBA.Now) - VBA.DateValue(Folder.Items.Item(iRow).ReceivedTime) &lt;= 60 Then\n       oRow = oRow + 1\n       xlWB.Sheets(1).Cells(oRow, 1).Select\n       xlWB.Sheets(1).Cells(oRow, 1) = Folder.Items.Item(iRow).SenderName\n       xlWB.Sheets(1).Cells(oRow, 2) = Folder.Items.Item(iRow).Subject\n       xlWB.Sheets(1).Cells(oRow, 3) = Folder.Items.Item(iRow).ReceivedTime\n       xlWB.Sheets(1).Cells(oRow, 4) = Folder.Items.Item(iRow).Size\n       xlWB.Sheets(1).Cells(oRow, 5) = Folder.Items.Item(iRow).SenderEmailAddress\n       'ThisWorkbook.Sheets(1).Cells(oRow, 6) = Folder.Items.Item(iRow).Body\n    End If\nNext iRow\nMsgBox \"Outlook Mails Extracted to Excel\"\nSet Folder = Nothing\nSet sFolders = Nothing\n\nxlWB.Close False\nSet xlWB = Nothing\n\nxlApp.Quit\nSet xlApp = Nothing\n\nEnd_Lbl1:\nEnd Sub\n</code></pre>\n\n<p>This will open the workbook for you, so no need to do so before hand</p>\n"}], "owner": {"reputation": 71, "user_id": 1983577, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf23853df74fda5dfcee0fb9fdd94681?s=128&d=identicon&r=PG", "display_name": "lifeinvba", "link": "https://stackoverflow.com/users/1983577/lifeinvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1316, "favorite_count": 0, "accepted_answer_id": 32885086, "answer_count": 1, "score": 0, "last_activity_date": 1593517990, "creation_date": 1443614122, "last_edit_date": 1593517990, "question_id": 32865438, "link": "https://stackoverflow.com/questions/32865438/method-thisworkbook-of-object-global-failed", "title": "Method &#39;ThisWorkbook&#39; of object &#39;_Global&#39; failed", "body": "<p>I'm trying to copy the Mail's subject, sendername, date of the email from the PST mailbox to the excel workbook.\nHere's the code I have so far :</p>\n\n<pre><code>Option Explicit\nSub Download_Outlook_Mail_To_Excel()\nDim Folder As Outlook.MAPIFolder\nDim sFolders As Outlook.MAPIFolder\nDim iRow As Integer, oRow As Integer\nDim MailBoxName As String, Pst_Folder_Name  As String\n\n\nMailBoxName = \"Backupmailbox\"\n\n\nPst_Folder_Name = \"Inbox1\" 'Sample \"Inbox\" or \"Sent Items\"\n\n'To directly a Folder at a high level\n'Set Folder = Outlook.Session.Folders(MailBoxName).Folders(Pst_Folder_Name)\n\n'To access a main folder or a subfolder (level-1)\nFor Each Folder In Outlook.Session.Folders(MailBoxName).Folders\n    If VBA.UCase(Folder.Name) = VBA.UCase(Pst_Folder_Name) Then GoTo Label_Folder_Found\n    For Each sFolders In Folder.Folders\n        If VBA.UCase(sFolders.Name) = VBA.UCase(Pst_Folder_Name) Then\n            Set Folder = sFolders\n            GoTo Label_Folder_Found\n        End If\n    Next sFolders\nNext Folder\n\nLabel_Folder_Found:\n If Folder.Name = \"\" Then\n    MsgBox \"Invalid Data in Input\"\n    GoTo End_Lbl1:\nEnd If\n\n'Read Through each Mail and export the details to Excel for Email Archival\nThisWorkbook.Sheets(1).Activate\nFolder.Items.Sort \"Received\"\n\n'Insert Column Headers\nThisWorkbook.Sheets(1).Cells(1, 1) = \"Sender\"\nThisWorkbook.Sheets(1).Cells(1, 2) = \"Subject\"\nThisWorkbook.Sheets(1).Cells(1, 3) = \"Date\"\nThisWorkbook.Sheets(1).Cells(1, 4) = \"Size\"\nThisWorkbook.Sheets(1).Cells(1, 5) = \"EmailID\"\n'ThisWorkbook.Sheets(1).Cells(1, 6) = \"Body\"\n\n'Export eMail Data from PST Folder\noRow = 1\nFor iRow = 1 To Folder.Items.Count\n    'If condition to import mails received in last 60 days\n    'To import all emails, comment or remove this IF condition\n    If VBA.DateValue(VBA.Now) - VBA.DateValue(Folder.Items.Item(iRow).ReceivedTime) &lt;= 60 Then\n       oRow = oRow + 1\n       ThisWorkbook.Sheets(1).Cells(oRow, 1).Select\n       ThisWorkbook.Sheets(1).Cells(oRow, 1) = Folder.Items.Item(iRow).SenderName\n       ThisWorkbook.Sheets(1).Cells(oRow, 2) = Folder.Items.Item(iRow).Subject\n       ThisWorkbook.Sheets(1).Cells(oRow, 3) = Folder.Items.Item(iRow).ReceivedTime\n       ThisWorkbook.Sheets(1).Cells(oRow, 4) = Folder.Items.Item(iRow).Size\n       ThisWorkbook.Sheets(1).Cells(oRow, 5) = Folder.Items.Item(iRow).SenderEmailAddress\n       'ThisWorkbook.Sheets(1).Cells(oRow, 6) = Folder.Items.Item(iRow).Body\n    End If\nNext iRow\nMsgBox \"Outlook Mails Extracted to Excel\"\nSet Folder = Nothing\nSet sFolders = Nothing\n\nEnd_Lbl1:\nEnd Sub\n</code></pre>\n\n<p>When I run the code I get the </p>\n\n<blockquote>\n  <p>\"method of range of object _ Global Failed\"  </p>\n</blockquote>\n\n<p>from the statement <code>ThisWorkbook.Sheets(1).Activate</code></p>\n\n<p>I have enabled Microsoft Excel 14.0 Object Library reference, since the code is executed from outlook application.</p>\n\n<p>Does anyone know what this error means and how can I fix it ? </p>\n"}, {"tags": ["excel", "text", "colors", "vba"], "comments": [{"owner": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1443613134, "post_id": 32864958, "comment_id": 53562242, "body": "You haven&#39;t provided enough information to help anyone to help you. Can you show an actual example of what your source data looks like and what you want the output to be? You could use <b>bold</b> formatting to show which text is one colour and which is another (place ** before and after the text that should be bold)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5392783"}, "reply_to_user": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "edited": false, "score": 0, "creation_date": 1443679239, "post_id": 32864958, "comment_id": 53591336, "body": "@nekomatic, Sorry, if the question is not clear..What i meant was, Actually i have used another macro for spell check and the font color is changed to red of incorrect spelling, i have to extract the words. the macro in the above link was giving answer like this without any separator between two words.like below. i need to get like Connectores, longe (A) Original..........(B)  Connectores are very longe. ..........Connectoreslonge"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5392783"}, "edited": false, "score": 0, "creation_date": 1443679727, "post_id": 32865858, "comment_id": 53591533, "body": "Thanks for the UDF, but if word contains only one red word it is giving me &quot;, word&quot;. i don&#39;t want delimiter if there is single word. Original\tColor abcgef\t, abc ...Here abc is red colored but from ur udf i am getting&quot;, abc&quot;, i don&#39;t need the comma for single words."}, {"owner": {"reputation": 741, "user_id": 2714304, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/30007138880f8dbbe3237bfea5dcec14?s=128&d=identicon&r=PG&f=1", "display_name": "RanonKahn", "link": "https://stackoverflow.com/users/2714304/ranonkahn"}, "edited": false, "score": 0, "creation_date": 1488577366, "post_id": 32865858, "comment_id": 72310077, "body": "Hi @Jeeped, Can you kindly suggest on how to solve this issue posted at <a href=\"http://stackoverflow.com/questions/42588557/parsing-multicolored-text-in-excel-spreadsheet-cell-into-multiple-cells\" title=\"parsing multicolored text in excel spreadsheet cell into multiple cells\">stackoverflow.com/questions/42588557/&hellip;</a>?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1443694487, "last_edit_date": 1443694487, "creation_date": 1443615426, "answer_id": 32865858, "question_id": 32864958, "link": "https://stackoverflow.com/questions/32864958/how-to-extract-text-based-on-font-color-from-a-cell-with-text-of-multiple-colors/32865858#32865858", "title": "How to extract text based on font color from a cell with text of multiple colors and separate multiple words by Delimiter?", "body": "<p>A User Defined Function (aka UDF) should get you through this.</p>\n\n<pre><code>Function udf_Whats_Colored(rTXT As Range, Optional iCLRNDX As Long = 3)\n    Dim c As Long, str As String\n\n    For c = 1 To Len(rTXT.Text)\n        With rTXT.Characters(Start:=c, Length:=1)\n            If .Font.ColorIndex = iCLRNDX Then\n                If Not CBool(Len(str)) Or _\n                   rTXT.Characters(Start:=c + (c &gt; 1), Length:=1).Font.ColorIndex = iCLRNDX Then\n                    str = str &amp; Mid(rTXT.Text, c, 1)\n                Else\n                    str = str &amp; \", \" &amp; Mid(rTXT.Text, c, 1)\n                End If\n            End If\n        End With\n    Next c\n    udf_Whats_Colored = str\n\nEnd Function\n</code></pre>\n\n<p>After considering all of the shades of red that are available, I opted for the simpler solution of <code>.ColorIndex = 3</code>. There is an optional parameter so that you can set your own <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840443.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">ColorIndex property</a> number. If you need more colors, it should be a small matter to swap the code over to the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837437.aspx\" rel=\"nofollow noreferrer\">.Font.Color property</a>.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/zsaF7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zsaF7.png\" alt=\"Which Red Characters\"></a></p>\n\n<p>The syntax used in the above image in B2 is,</p>\n\n<pre><code>=udf_Whats_Colored(A2)\n</code></pre>\n\n<hr>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/wCtLW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wCtLW.png\" alt=\"ColorIndex Palette Table\"></a><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>ColorIndex Palette Table</sup></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5392783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1848, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443694487, "creation_date": 1443612646, "last_edit_date": 1531161705, "question_id": 32864958, "link": "https://stackoverflow.com/questions/32864958/how-to-extract-text-based-on-font-color-from-a-cell-with-text-of-multiple-colors", "title": "How to extract text based on font color from a cell with text of multiple colors and separate multiple words by Delimiter?", "body": "<p><a href=\"https://stackoverflow.com/questions/21514704/how-to-extract-text-based-on-font-color-from-a-cell-with-text-of-multiple-colors\">How to extract text based on font color from a cell with text of multiple colors</a></p>\n\n<p>I have a column of data (A). The data in each cell in column (A) is half one color and half another color. I have to extract each word separated by delimiter if they are at different places. I tried the solution in the above link but unable to make changes to suit my purpose as i am a beginner for vba.  please suggest methods to sole this problem.</p>\n\n<p>(A) Original..........(B) Red</p>\n\n<p>abcdefgh..........abc, gh</p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 973, "user_id": 3165854, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/11f6f82651558700823312e4545ff3df?s=128&d=identicon&r=PG&f=1", "display_name": "user3165854", "link": "https://stackoverflow.com/users/3165854/user3165854"}, "edited": false, "score": 0, "creation_date": 1443618119, "post_id": 32865352, "comment_id": 53565660, "body": "Thanks for the help.  Using the code above, it looks like it is comparing column L against column L.  Is that correct and I need to modify it or have I done something wrong?"}, {"owner": {"reputation": 973, "user_id": 3165854, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/11f6f82651558700823312e4545ff3df?s=128&d=identicon&r=PG&f=1", "display_name": "user3165854", "link": "https://stackoverflow.com/users/3165854/user3165854"}, "edited": false, "score": 0, "creation_date": 1443631221, "post_id": 32865352, "comment_id": 53574609, "body": "Works great.  Thanks again."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 0, "last_activity_date": 1443618260, "last_edit_date": 1443618260, "creation_date": 1443613825, "answer_id": 32865352, "question_id": 32864848, "link": "https://stackoverflow.com/questions/32864848/excel-compare-arrays-and-specify-which-columns-to-compare-until-the-first-colu/32865352#32865352", "title": "Excel - Compare arrays and specify which columns to compare until the first column is blank", "body": "<p>How about something like this:</p>\n\n<pre><code>Sub compareSheets(shtBefore As String)\nDim strArray As Variant\nDim mydiffs As Integer\nDim lngLastRow As Long\nDim mycell As Range\n\nFor Each strArray In Array(\"L/A\", \"G/B\")\n    With ActiveWorkbook.Worksheets(shtBefore)\n        lngLastRow = .Cells(.Rows.Count, Split(strArray, \"/\")(0)).End(xlUp).Row\n        For Each mycell In .Range(Split(strArray, \"/\")(0) &amp; \"1:\" &amp; Split(strArray, \"/\")(0) &amp; lngLastRow)\n            If Not mycell.Value = .Range(Split(strArray, \"/\")(1) &amp; mycell.Row).Value Then\n                mydiffs = mydiffs + 1\n            End If\n        Next\n    End With\nNext strArray\n\nEnd Sub\n</code></pre>\n\n<p>Obviously, you can extend upon the array to include additional columns to compare to one another. L/A stands for: compare column L to column A, where column L (the first column) dictates how many rows will be compared (until there are no more in column L even though there still might be some more in column A).</p>\n\n<p>Note, you could optimize the code by using <code>.Value2</code> instead of <code>.Value</code> if that's an option.</p>\n"}], "owner": {"reputation": 973, "user_id": 3165854, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/11f6f82651558700823312e4545ff3df?s=128&d=identicon&r=PG&f=1", "display_name": "user3165854", "link": "https://stackoverflow.com/users/3165854/user3165854"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 32865352, "answer_count": 1, "score": 0, "last_activity_date": 1443618260, "creation_date": 1443612298, "last_edit_date": 1531161705, "question_id": 32864848, "link": "https://stackoverflow.com/questions/32864848/excel-compare-arrays-and-specify-which-columns-to-compare-until-the-first-colu", "title": "Excel - Compare arrays and specify which columns to compare until the first column is blank", "body": "<p>I am looking to compare 2 arrays in the same sheet row by row, but would like to specify which column in array 1 should be compared to which column in array 2 and do this until the value is column A is blank. For example array 1 is A:E and array 2 is G:L and I would like to compare column B to the values in column G and say column A will be compared with values in column L.</p>\n\n<p>What is the best way to do this and how can I stop when the value is blank for the row I'm comparing in column A when I'm comparing columns B and G?  </p>\n\n<p>At the moment it looks like I will need to loop through each column in turn which would mean about 5 separate loops like below.</p>\n\n<pre><code>Sub compareSheets(shtBefore As String)\nDim mycell As Range\nDim mydiffs As Integer\n\nFor Each mycell In ActiveWorkbook.Worksheets(shtBefore).Range(\"L:L\")\n    If Not mycell.Value = ActiveWorkbook.Worksheets(shtBefore).Range(\"A:A\").Cells(mycell.Row, mycell.Column).Value Then\n\n        mydiffs = mydiffs + 1\n\n    End If\nNext\n\nFor Each mycell In ActiveWorkbook.Worksheets(shtBefore).Range(\"G:G\")    \n    If Not mycell.Value = ActiveWorkbook.Worksheets(shtBefore).Range(\"B:B\").Cells(mycell.Row, mycell.Column).Value Then\n\n        mydiffs = mydiffs + 1\n\n    End If  \nNext\n\n'Repeated 3 more times.....\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "filter"], "comments": [{"owner": {"reputation": 16544, "user_id": 4346285, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8e2aac571a1fb790a21ebf5c7e4a484e?s=128&d=identicon&r=PG&f=1", "display_name": "JenB", "link": "https://stackoverflow.com/users/4346285/jenb"}, "edited": false, "score": 0, "creation_date": 1443612226, "post_id": 32864789, "comment_id": 53561695, "body": "What does your filter statement look like now?"}, {"owner": {"reputation": 73, "user_id": 4949790, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3f9533509bd8ae066251795a019568b0?s=128&d=identicon&r=PG&f=1", "display_name": "alexandre", "link": "https://stackoverflow.com/users/4949790/alexandre"}, "reply_to_user": {"reputation": 16544, "user_id": 4346285, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8e2aac571a1fb790a21ebf5c7e4a484e?s=128&d=identicon&r=PG&f=1", "display_name": "JenB", "link": "https://stackoverflow.com/users/4346285/jenb"}, "edited": false, "score": 0, "creation_date": 1443613362, "post_id": 32864789, "comment_id": 53562402, "body": "Come on, I just don&#39;t show becouse it is on my work, and I can&#39;t show this here, Is just a filter in a sheet, some lines was supressed, and I want to take the first line that appears"}, {"owner": {"reputation": 16544, "user_id": 4346285, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8e2aac571a1fb790a21ebf5c7e4a484e?s=128&d=identicon&r=PG&f=1", "display_name": "JenB", "link": "https://stackoverflow.com/users/4346285/jenb"}, "edited": false, "score": 1, "creation_date": 1443613995, "post_id": 32864789, "comment_id": 53562808, "body": "What&#39;s with the &quot;Come on&quot;? If you provide your vba for the filter, then answerers can give you specific advice of how to modify the vba to do what you want."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1443613343, "creation_date": 1443613343, "answer_id": 32865208, "question_id": 32864789, "link": "https://stackoverflow.com/questions/32864789/how-to-select-the-first-visible-row-after-applying-a-filter/32865208#32865208", "title": "How to select the first visible row after applying a filter", "body": "<p>Use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow\">Range.SpecialCells method</a> with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836534.aspx\" rel=\"nofollow\">xlCellTypeVisible</a> parameter on the filtered range. <code>.Rows(1).Cells</code> should be what you want.</p>\n\n<pre><code>Sub first_row()\n    Dim rFirstFilteredRow As Range\n    With Worksheets(\"Sheet1\")\n        With .Cells(1, 1).CurrentRegion\n            'do all the .autofilter stuff here\n            With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n                If CBool(Application.Subtotal(103, .Cells)) Then\n                    Set rFirstFilteredRow = _\n                      .SpecialCells(xlCellTypeVisible).Rows(1).Cells\n                    '~~&gt; rFirstFilteredRow is not a copy of the first visible row\n                    'do something with rFirstFilteredRow\n                End If\n            End With\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>You will have to transcribe this to suit your own implementation of the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221844%28v=office.11%29.aspx\" rel=\"nofollow\">AutoFilter Method</a>. </p>\n\n<hr>\n\n<p><sub>The native worksheet <a href=\"https://support.office.com/en-us/article/SUBTOTAL-function-e27c301c-be9a-458b-9d12-b9a2ce3c62af\" rel=\"nofollow\">SUBTOTAL function</a> was used as it only counts visible cells. This is an easy non-destructive way of determining whether there are any cells to reference after the filter has been applied.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 391, "user_id": 1913233, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/a20x8.png?s=128&g=1", "display_name": "S4nd33p", "link": "https://stackoverflow.com/users/1913233/s4nd33p"}, "edited": false, "score": 0, "creation_date": 1513913627, "post_id": 43928902, "comment_id": 82840443, "body": "This worked for me .. inspired by the code above.   frow_main = Worksheets(main_sheet_name).AutoFilter.Range.Offset(1).Speci&zwnj;&#8203;alCells(xlCellTypeVi&zwnj;&#8203;sible).Cells().Row"}], "tags": [], "owner": {"reputation": 11, "user_id": 8000671, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/333799b372a31ef6b448d0c93a7b7732?s=128&d=identicon&r=PG", "display_name": "Vikneswaran", "link": "https://stackoverflow.com/users/8000671/vikneswaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1494592161, "last_edit_date": 1494592161, "creation_date": 1494560381, "answer_id": 43928902, "question_id": 32864789, "link": "https://stackoverflow.com/questions/32864789/how-to-select-the-first-visible-row-after-applying-a-filter/43928902#43928902", "title": "How to select the first visible row after applying a filter", "body": "<pre><code>Worksheets(\"Raw\").AutoFilter.Range.Offset(1).SpecialCells(xlCellTypeVisible).Cells(Row, Column)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10397345, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e73eba89db8988655dd8ca181250405a?s=128&d=identicon&r=PG", "display_name": "Cynthia", "link": "https://stackoverflow.com/users/10397345/cynthia"}, "is_accepted": false, "score": 0, "last_activity_date": 1537546869, "last_edit_date": 1537546869, "creation_date": 1537541272, "answer_id": 52446207, "question_id": 32864789, "link": "https://stackoverflow.com/questions/32864789/how-to-select-the-first-visible-row-after-applying-a-filter/52446207#52446207", "title": "How to select the first visible row after applying a filter", "body": "<p>I tried this and it worked beautifully for me.  First piece of code that did.  Thank you!</p>\n\n<pre><code>frow_main = Worksheets(main_sheet_name).AutoFilter.Range.Offset(1).SpecialCells(xlCellTypeVisible).Cells().Row \n</code></pre>\n\n<p>I was trying to find the first row after an autofilter, but other offset codes kept giving me row 1.  </p>\n\n<p>I needed row 27, but it wasn't guaranteed that it would be row 27 each time.</p>\n\n<p>Your inspiration worked!</p>\n\n<pre><code>'Reset LastRow\nLastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n'Remove the \"Bear\" invoice method\nActiveSheet.Range(\"$A$1:$E$\" &amp; LastRow).AutoFilter Field:=5, Criteria1:=\"=BEAR\", Operator:=xlOr, Criteria2:=\"=#REF!\"\nFirstRow = Worksheets(\"testOriginalData\").AutoFilter.Range.Offset(1).SpecialCells(xlCellTypeVisible).Cells().Row\nRows(FirstRow).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.SpecialCells(xlCellTypeVisible).Select\nSelection.Delete Shift:=xlUp\nActiveSheet.ShowAllData\nRange(\"A2\").Select\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 4949790, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3f9533509bd8ae066251795a019568b0?s=128&d=identicon&r=PG&f=1", "display_name": "alexandre", "link": "https://stackoverflow.com/users/4949790/alexandre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9307, "favorite_count": 0, "accepted_answer_id": 32865208, "answer_count": 3, "score": 0, "last_activity_date": 1537546869, "creation_date": 1443612141, "last_edit_date": 1443615798, "question_id": 32864789, "link": "https://stackoverflow.com/questions/32864789/how-to-select-the-first-visible-row-after-applying-a-filter", "title": "How to select the first visible row after applying a filter", "body": "<p>I'm filtering a table in Excel but I only want the first line that appears.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1443993234, "post_id": 32864693, "comment_id": 53702336, "body": "And what is your filter? You can easily translate the expression to a <code>WHERE</code> clause?"}, {"owner": {"reputation": 99, "user_id": 4973994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb1ada29cf21efbadf59b084b4eb1e7a?s=128&d=identicon&r=PG&f=1", "display_name": "GroovySu", "link": "https://stackoverflow.com/users/4973994/groovysu"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1451393759, "post_id": 32864693, "comment_id": 56763728, "body": "That was the point - I wanted to translate the filters to a WHERE clause, but the filter will be set by a user."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4973994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb1ada29cf21efbadf59b084b4eb1e7a?s=128&d=identicon&r=PG&f=1", "display_name": "GroovySu", "link": "https://stackoverflow.com/users/4973994/groovysu"}, "edited": false, "score": 0, "creation_date": 1451393849, "post_id": 32864945, "comment_id": 56763776, "body": "Thanks Dorian, I see where you&#39;re going with this. What I was really after was another approach entirely, hoping that there would be a function or something that I&#39;ve overlooked, but I&#39;ve drawn a blank.  Never mind, it did work, despite being inelegant :)"}], "tags": [], "owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "is_accepted": true, "score": 0, "last_activity_date": 1443612616, "creation_date": 1443612616, "answer_id": 32864945, "question_id": 32864693, "link": "https://stackoverflow.com/questions/32864693/in-vba-how-to-convert-filter-to-sql-string-where-clause/32864945#32864945", "title": "In VBA, how to convert filter to sql string where clause", "body": "<p>The only thing you could do is to shorten your procedure. You could do something like this:</p>\n\n<pre><code>currentdb.Execute \"UPDATE tblRCmDataSheetExtract SET Completed = 1 WHERE \" &amp; Replace(Forms!frmReplen!FrmReplenSheet.Form.Filter, \"[FrmReplenSheet].\", \"\")\n</code></pre>\n\n<p>Or when you're running it from within frmReplen you could use</p>\n\n<pre><code>currentdb.Execute \"UPDATE tblRCmDataSheetExtract SET Completed = 1 WHERE \" &amp; Replace(Me.FrmReplenSheet.Form.Filter, \"[FrmReplenSheet].\", \"\")\n</code></pre>\n\n<p>or from within the subform \"FrmReplenSheet\":</p>\n\n<pre><code>currentdb.Execute \"UPDATE tblRCmDataSheetExtract SET Completed = 1 WHERE \" &amp; Replace(Me.Form.Filter, \"[FrmReplenSheet].\", \"\")\n</code></pre>\n\n<p>that puts your whole procedure into one single command. It's up to you if you like better readability or shorter procedures.</p>\n"}], "owner": {"reputation": 99, "user_id": 4973994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb1ada29cf21efbadf59b084b4eb1e7a?s=128&d=identicon&r=PG&f=1", "display_name": "GroovySu", "link": "https://stackoverflow.com/users/4973994/groovysu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 32864945, "answer_count": 1, "score": 0, "last_activity_date": 1594643592, "creation_date": 1443611814, "last_edit_date": 1594643592, "question_id": 32864693, "link": "https://stackoverflow.com/questions/32864693/in-vba-how-to-convert-filter-to-sql-string-where-clause", "title": "In VBA, how to convert filter to sql string where clause", "body": "<p>Has anyone got a better way to do this? I want the users to be able to filter to a set of records, and then use a sql statement to do something to just the filtered records.</p>\n\n<p>My code at the moment looks something like the following, and it works.  But I do wonder if there is any better (or other?) way to achieve this that could avoid the clunky Replace statement? I wondered if I could do it using a recordset instead, but unless I'm missing something, there's no way to do set operations over a recordset, I'd have to loop through the records individually to do that. </p>\n\n<p>Any other suggestions?</p>\n\n<pre><code>Dim db As Database\nDim frm As Form\nDim sqlCmd As String\nDim filter As String\n\nSet db = CurrentDb\nSet frm = Forms(\"frmReplen\").Controls(\"FrmReplenSheet\").Form\nfilter = Replace(frm.filter, \"[FrmReplenSheet].\", \"\")\n\nsqlCmd = \"UPDATE tblRCmDataSheetExtract \" &amp; _\n    \"SET Completed = 1 \" &amp; _\n    \"WHERE \" &amp; filter\n\ndb.Execute sqlCmd\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1443612529, "post_id": 32864662, "comment_id": 53561863, "body": "Is the PDF open when you are trying to saveas PDF again?"}, {"owner": {"reputation": 307, "user_id": 2928055, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8d9dc81569deb183245bb7e4058e1c9?s=128&d=identicon&r=PG&f=1", "display_name": "INOH", "link": "https://stackoverflow.com/users/2928055/inoh"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1443626678, "post_id": 32864662, "comment_id": 53571613, "body": "Davexcel, You are right didnot see that pdf was open in form, i needed to unload form, slipped my mind"}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 2928055, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8d9dc81569deb183245bb7e4058e1c9?s=128&d=identicon&r=PG&f=1", "display_name": "INOH", "link": "https://stackoverflow.com/users/2928055/inoh"}, "edited": false, "score": 0, "creation_date": 1443615628, "post_id": 32864960, "comment_id": 53563893, "body": "Thanks for the quick response, I have run into a error step2 kill FileName (wrong number of arguments or invalid property assignments"}, {"owner": {"reputation": 307, "user_id": 2928055, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8d9dc81569deb183245bb7e4058e1c9?s=128&d=identicon&r=PG&f=1", "display_name": "INOH", "link": "https://stackoverflow.com/users/2928055/inoh"}, "edited": false, "score": 0, "creation_date": 1443617729, "post_id": 32864960, "comment_id": 53565338, "body": "Kill FileName  is highlighted"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 307, "user_id": 2928055, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8d9dc81569deb183245bb7e4058e1c9?s=128&d=identicon&r=PG&f=1", "display_name": "INOH", "link": "https://stackoverflow.com/users/2928055/inoh"}, "edited": false, "score": 1, "creation_date": 1443618376, "post_id": 32864960, "comment_id": 53565817, "body": "Try Kill (Filename). Of that doesn&#39;t work, then  can you tell me what value of <code>FileName</code> and whether such file exists?"}, {"owner": {"reputation": 307, "user_id": 2928055, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8d9dc81569deb183245bb7e4058e1c9?s=128&d=identicon&r=PG&f=1", "display_name": "INOH", "link": "https://stackoverflow.com/users/2928055/inoh"}, "edited": false, "score": 2, "creation_date": 1443626610, "post_id": 32864960, "comment_id": 53571576, "body": "David, thanks for fixing my code, it makes more sense now without clutter, for the Issue that I had started and asked for help has been resolved, it took a while to understand, that it was me the whole time, the form that i did not unload, was still carry the existance of the pdf file, and that was why it would not save.  Sorry for the nusence, i am just learning as i go.  Thanks"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1481044013, "last_edit_date": 1481044013, "creation_date": 1443612651, "answer_id": 32864960, "question_id": 32864662, "link": "https://stackoverflow.com/questions/32864662/excel-save-as-pdf-and-overwrite-existing/32864960#32864960", "title": "Excel Save As PDF And Overwrite Existing", "body": "<p>Most of your <code>With</code> blocks appear to be poorly constructed and may be contributing to some errors (or, maybe not, it's hard to say for certain). Generally, you'll qualify objects to the <code>With</code> object. In your case, you don't seem to be doing that except for one or two lines of code. </p>\n\n<p>You don't need variables to represent form controls, and doing so the way you have done is making your code more complicated to read. I've revised Step1 accordingly.</p>\n\n<p>However, to the main problem: generally when you are trying to <code>Save</code> a file, you first need to check if the same file already exists, and if so, delete it.</p>\n\n<pre><code>Sub Step1()\nDim rng As Range\nDim nwb As Workbook\nDim FileName As String\n\n\nFileName = \"SEQ-\" &amp; frmsetup.lblsequence.Caption &amp; \" \" &amp; frmsetup.lbldate.Caption\n'## Add the PATH and EXTENSION to the filename\nFileName = \"H:\\APPLICATIONS\\SEAT AUDIT\\QUERY RESULTS\\SEAT AUDIT - PDF\\\" &amp; FileName &amp; \".pdf\"\n\nWith Sheets(Array(\"END RESULTS\", \"DRIVER SEAT\", \"PASSENGER SEAT\", \"40% SEAT\", \"60% SEAT\", \"RSC SEAT\")).Select\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, FileName:= _\n    FileName, Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\n    False\nEnd With\nApplication.ScreenUpdating = False\nApplication.WindowState = xlMaximized\n\n**'This is the next part of the step1, it opens a existing workbook and adds log information including hyperlink to pdf'**\n\nSet nwb = Workbooks.Open(\"H:\\APPLICATIONS\\SEAT AUDIT\\LOG FILES\\Seat Audit Log.xlsm\")\nWith Sheets(\"Seat Audit Log\")\n    nextrow = Range(\"B\" &amp; .Rows.Count).End(xlUp).Row + 1\n    .Cells(nextrow, 1).Value = frmsetup.cmbauditor.Text\n    .Cells(nextrow, 2).Value = frmsetup.lblsequence.Caption\n    .Cells(nextrow, 3).Value = frmsetup.cmbtrimstyle.Text\n    .Cells(nextrow, 4).Value = frmsetup.lbldate.Caption\n    .Set rng = .Range(\"E\" &amp; nextrow)\n    rng.Parent.Hyperlinks.Add Anchor:=rng, Address:=FileName, TextToDisplay:=\"CLICK HERE!\"\nEnd With\nApplication.ScreenUpdating = True\nActiveWorkbook.Save\nActiveWindow.Close\nEnd Sub\n\nSub Step2()\nDim FileName As String\n\nFileName = \"SEQ-\" &amp; frmsetup.lblsequence.Caption &amp; \" \" &amp; frmsetup.lbldate.Caption\n'## Add the PATH and EXTENSION to the filename\nFileName = \"H:\\APPLICATIONS\\SEAT AUDIT\\QUERY RESULTS\\SEAT AUDIT - PDF\\\" &amp; FileName &amp; \".pdf\"\n\n'## Check to see if this file exists, and delete it if it does\nIf Dir(FileName) &lt;&gt; vbNullString Then\n    Kill FileName\nEnd If\n\nWith Sheets(Array(\"END RESULTS\", \"DRIVER SEAT\", \"PASSENGER SEAT\", \"40% SEAT\", \"60% SEAT\", \"RSC SEAT\", \"ACTIONS\")).Select\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, FileName:= _\n    FileName, Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\n    False\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 2928055, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8d9dc81569deb183245bb7e4058e1c9?s=128&d=identicon&r=PG&f=1", "display_name": "INOH", "link": "https://stackoverflow.com/users/2928055/inoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9294, "favorite_count": 0, "accepted_answer_id": 32864960, "answer_count": 1, "score": 2, "last_activity_date": 1481044013, "creation_date": 1443611706, "last_edit_date": 1531164843, "question_id": 32864662, "link": "https://stackoverflow.com/questions/32864662/excel-save-as-pdf-and-overwrite-existing", "title": "Excel Save As PDF And Overwrite Existing", "body": "<p>Here is the Problem I have encountered.</p>\n\n<p>I have created a Excel Project. At a point in my project I save the current workbook as a PDF and update a existing workbook with log information and hyperlink to the PDF (<strong>Step1</strong>).  </p>\n\n<p>At another point in the project I re-save the project as the same PDF (to Overwrite Existing PDF). At the point I try to re-save the PDF I receive:</p>\n\n<blockquote>\n  <p>run-time error-1004 </p>\n</blockquote>\n\n<p>Document is not saved, may be opened or error may have been encountered. Here is the 2 scripts I use. </p>\n\n<p>I think maybe it might have something to do with the second part of <strong>step1</strong> script (when opening a workbook and updating log info, that it may not be closing properly)</p>\n\n<p>Please any help would be greatly appreciated, as I will continue to trouble shoot.</p>\n\n<p><strong>Step1:</strong></p>\n\n<pre><code>Sub Step1()\nDim rng As Range\nDim nwb As Workbook\nDim FileName As String\nDim var\nDim var1\nDim var2\nDim var3\nDim var4\nDim var5\nDim var6\nvar1 = frmsetup.cmbauditor.Text\nvar2 = frmsetup.lblsequence.Caption\nvar3 = frmsetup.cmbtrimstyle.Text\nvar = \"SEQ-\" &amp; frmsetup.lblsequence.Caption &amp; \" \"\nvar4 = frmsetup.lbldate.Caption\nFileName = var &amp; var4\n\nWith Sheets(Array(\"END RESULTS\", \"DRIVER SEAT\", \"PASSENGER SEAT\", \"40% SEAT\", \"60% SEAT\", \"RSC SEAT\")).Select\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, FileName:= _\n    \"H:\\APPLICATIONS\\SEAT AUDIT\\QUERY RESULTS\\SEAT AUDIT - PDF\\\" &amp; FileName &amp; \".pdf\", Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\n    False\nEnd With\nApplication.ScreenUpdating = False\nApplication.WindowState = xlMaximized\n</code></pre>\n\n<p>This is the next part of the <strong>step1</strong>, it opens a existing workbook and adds log information including hyperlink to pdf:</p>\n\n<pre><code>Set nwb = Workbooks.Open(\"H:\\APPLICATIONS\\SEAT AUDIT\\LOG FILES\\Seat Audit Log.xlsm\")\nWith Sheets(\"Seat Audit Log\")\nnextrow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\nCells(nextrow, 1).Value = var1\nCells(nextrow, 2).Value = var2\nCells(nextrow, 3).Value = var3\nCells(nextrow, 4).Value = var4\nSet rng = .Range(\"E\" &amp; nextrow)\nrng.Parent.Hyperlinks.Add Anchor:=rng, Address:=\"H:\\APPLICATIONS\\SEAT AUDIT\\QUERY RESULTS\\SEAT AUDIT - PDF\\\" &amp; FileName &amp; \".pdf\", TextToDisplay:=\"CLICK HERE!\"\nEnd With\nApplication.ScreenUpdating = True\nActiveWorkbook.Save\nActiveWindow.Close\nEnd Sub\n</code></pre>\n\n<p>This is the <strong>Step2</strong> re-save as PDF to overwrite existing PDF from Step1:</p>\n\n<pre><code>Sub Step2()\nDim FileName As String\nDim var\nDim var4\nvar = \"SEQ-\" &amp; frmsetup.lblsequence.Caption &amp; \" \"\nvar4 = frmsetup.lbldate.Caption\nFileName = var &amp; var4\n\nWith Sheets(Array(\"END RESULTS\", \"DRIVER SEAT\", \"PASSENGER SEAT\", \"40% SEAT\", \"60% SEAT\", \"RSC SEAT\", \"ACTIONS\")).Select\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, FileName:= _\n    \"H:\\APPLICATIONS\\SEAT AUDIT\\QUERY RESULTS\\SEAT AUDIT - PDF\\\" &amp; FileName &amp; \".pdf\", Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\n    False\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "charts", "userform", "multipage"], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 2440200, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ce71e765b5f54ddb2a481cd021d77082?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Lima", "link": "https://stackoverflow.com/users/2440200/jo%c3%a3o-lima"}, "is_accepted": false, "score": 0, "last_activity_date": 1443619621, "creation_date": 1443619621, "answer_id": 32867370, "question_id": 32864075, "link": "https://stackoverflow.com/questions/32864075/copy-charts-to-userform-multipage-pages-in-runtime/32867370#32867370", "title": "Copy charts to userform multipage pages in runtime", "body": "<p>Nevermind, I solved it! Instead of using an image object inside each page of multipage1, I removed them and replaced </p>\n\n<pre><code> UserForm2.Image1.Picture = LoadPicture(imageName) \n</code></pre>\n\n<p>with</p>\n\n<pre><code> UserForm2.MultiPage1.Pages(k).Picture = LoadPicture(imageName)\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 2440200, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ce71e765b5f54ddb2a481cd021d77082?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Lima", "link": "https://stackoverflow.com/users/2440200/jo%c3%a3o-lima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 539, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443619621, "creation_date": 1443609811, "question_id": 32864075, "link": "https://stackoverflow.com/questions/32864075/copy-charts-to-userform-multipage-pages-in-runtime", "title": "Copy charts to userform multipage pages in runtime", "body": "<p>I have some data in a worksheet with which I need to create charts. These charts are going to populate different pages of a multipage in a userform.\nThese pages need to be populated in the sequence the charts are created.</p>\n\n<p>I have no difficulty with the charts and creating an image from them. I can copy that image to the first page (it already has an image object). In order to create a new page, I'm using the following code:</p>\n\n<pre><code>MultiPage1.Pages.Add\nMultiPage1.Pages(0).Controls.Copy\nMultiPage1.Pages(k).Paste\n</code></pre>\n\n<p>When I copy the controls, it also copies the previous image. That shouldn't be a problem as long as the new image gets replaced by the newly created chart image. The problem is, the new chart is being copied to the first page, not to the last one created (but this is not always the case... I don't understand). I tried to force the selection of the new page by using <code>UserForm2.MultiPage1.Value = k</code> but it's still not working.</p>\n\n<p>Here is the code I wrote:</p>\n\n<pre><code>Dim MyChart         As Chart\nDim ChartData       As Range\nDim ChartName       As String\nDim thiswb          As Workbook\nDim imageName       As String\nDim nColunas        As Long       \nDim i, j, k         As Integer \n\nSet thiswb = ThisWorkbook\n\nk = 0\nWith thisWb.Sheets(3)\nnColunas = .Cells(2, .Columns.Count).End(xlToLeft).Column\nFor i = 1 To nColunas - 1 Step 3\n    If i &gt; 1 Then\n        MultiPage1.Pages.Add\n        MultiPage1.Pages(0).Controls.Copy\n        MultiPage1.Pages(k).Paste\n    End If\n    Set ChartData = .Range(.Cells(2, i), .Cells(95, i))\n    Set MyChart = .Shapes.AddChart(xlXYScatterLines).Chart\n    MyChart.SeriesCollection(1).Values = ChartData\n    MyChart.SeriesCollection(1).XValues = .Range(.Cells(2, i + 1), .Cells(95, i + 1))\n\n    imageName = Application.DefaultFilePath &amp; Application.PathSeparator &amp; \"TempChart.gif\"\n    MyChart.Export Filename:=imageName, FilterName:=\"GIF\"\n    .ChartObjects(1).Delete\n\n    UserForm2.MultiPage1.Value = k\n    UserForm2.Image1.Picture = LoadPicture(imageName)\n    Kill imageName\n\n    k = k + 1\nNext i\nEnd With\n</code></pre>\n\n<p>If I have 4 charts to display, the final result will be: chart4/chart1/chart2/chart3 instead of chart1/chart2/chart3/chart4</p>\n"}, {"tags": ["vba", "excel", "templates"], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 0, "last_activity_date": 1443612285, "creation_date": 1443612285, "answer_id": 32864841, "question_id": 32863941, "link": "https://stackoverflow.com/questions/32863941/insert-photo-from-form-office-2007/32864841#32864841", "title": "Insert photo from Form (Office 2007)", "body": "<p>See if this version of the code works. Change the file name to how you want it.</p>\n\n<pre><code>Sub Button1_Click()\n    Set myRng = Range(\"Q3:S5\")\n    Set mypict = myRng.Parent.Pictures.Insert(\"C:\\Users\\Dave\\Downloads\\9-29-2015 4-21-06 AM.jpg\")\n    mypict.Top = myRng.Top\n    mypict.Width = myRng.Width\n    mypict.Height = myRng.Height\n    mypict.Left = myRng.Left\n    mypict.Placement = xlMoveAndSize\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 32864841, "answer_count": 1, "score": 1, "last_activity_date": 1443612285, "creation_date": 1443609359, "last_edit_date": 1531164843, "question_id": 32863941, "link": "https://stackoverflow.com/questions/32863941/insert-photo-from-form-office-2007", "title": "Insert photo from Form (Office 2007)", "body": "<p>After this code </p>\n\n<pre><code>  With Sheets(\"Sheet1\")\n        ActiveSheet.Unprotect\n        Range(\"Q3:S5\").Select\n        MyRange = Selection.Address\n\n        PicLocation = UserForm1.txtImage\n\n        If PicLocation &lt;&gt; \"False\" Then\n            ActiveSheet.Pictures.Insert(PicLocation).Select\n        Else\n            Exit Sub\n        End If\n\n        With Selection.ShapeRange\n            .LockAspectRatio = msoTrue\n            If .Width &gt; .Height Then\n                .Width = Range(MyRange).Width\n                If .Height &gt; Range(MyRange).Height Then .Height = Range(MyRange).Height\n            Else\n                .Height = Range(MyRange).Height\n                If .Width &gt; Range(MyRange).Width Then .Width = Range(MyRange).Width\n            End If\n        End With\n\n        With Selection\n            .Placement = xlMoveAndSize\n            .PrintObject = True\n        End With\n\nEnd With\n</code></pre>\n\n<p>`</p>\n\n<p>My image isn't in the merged cell I want to be (\"Q3:S5\"). </p>\n\n<p>But in the office 2010 this code is just fine. \nUnfortunately, I need to run in Office 2007.</p>\n\n<p><a href=\"https://www.dropbox.com/s/dmp454xhpuybtq9/ImageIssue.jpg?dl=0\" rel=\"nofollow\">imageIssue</a> </p>\n\n<p>Sorry for external link, but I don't have reputation to upload an image.</p>\n\n<p>Also, I want image to be in \"Middle alignment\".</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 5392112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pCHTUdaH3dw/AAAAAAAAAAI/AAAAAAAAAB4/36zLaTIn5oA/photo.jpg?sz=128", "display_name": "Jan Malan", "link": "https://stackoverflow.com/users/5392112/jan-malan"}, "edited": false, "score": 0, "creation_date": 1443627024, "post_id": 32863915, "comment_id": 53571843, "body": "I have the following Idea how it should work:"}, {"owner": {"reputation": 3, "user_id": 5392112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pCHTUdaH3dw/AAAAAAAAAAI/AAAAAAAAAB4/36zLaTIn5oA/photo.jpg?sz=128", "display_name": "Jan Malan", "link": "https://stackoverflow.com/users/5392112/jan-malan"}, "edited": false, "score": 0, "creation_date": 1443628055, "post_id": 32863915, "comment_id": 53572549, "body": "I have the following Idea how it should work: Read value of A2 in Price-list save to a variable1. Start loop Read value of A2 in Update and compare with variable1 if = then Read value of C2 in Update and store in variable2 and write variable2 to D2 of Price-list. Then delete line 2 in Update. If A2 in Update not = to Varible1 Then go to next line read A3 and compare with Varible1 extr..  If read value is False meaning no data, end loop and start new loop with next line in Price-list"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 1, "creation_date": 1443877434, "post_id": 32863915, "comment_id": 53672472, "body": "Your description of how it should work and the fact that you want to have lines deleted implies use of VBA, however your question is tagged as excel-formula. Are you going for a VBA solution? If so, show us what have you done and what problems are you facing. On the other hand, deleting lines as they are processed it will not allow to audit the process in case something goes wrong, but yet again it just have to do with the level of standards and quality you want to work with. This can be done with formulas, but then you&#39;ll have to delete lines manually (if insist on doing it), or with VBA."}, {"owner": {"reputation": 3, "user_id": 5392112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pCHTUdaH3dw/AAAAAAAAAAI/AAAAAAAAAB4/36zLaTIn5oA/photo.jpg?sz=128", "display_name": "Jan Malan", "link": "https://stackoverflow.com/users/5392112/jan-malan"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1446038701, "post_id": 32863915, "comment_id": 54575886, "body": "I wrote some Code But I&#39;m not to clued up with VBA .  Now I do not know how to go forward, I want to copy the code here but It is to long"}, {"owner": {"reputation": 3, "user_id": 5392112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pCHTUdaH3dw/AAAAAAAAAAI/AAAAAAAAAB4/36zLaTIn5oA/photo.jpg?sz=128", "display_name": "Jan Malan", "link": "https://stackoverflow.com/users/5392112/jan-malan"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1446039073, "post_id": 32863915, "comment_id": 54576173, "body": "Sub UpdateMisilanious()     &#39; UpdateMisilanious Macro    &#39; This will update the misilanious List     &#39;The variable for the active line in Misilanious   Dim ALMis As Integer   ALMis = 4   &#39;The variable for the active line in Update   Dim ALUp As Integer   ALUp = 2   &#39;The varible for product code of Misilanious   Dim PrCMis As String   &#39;The varible for product code of Update    Dim PrCUp As String    &#39;The temp Varible for the Price   Dim NewPrice As Currency"}, {"owner": {"reputation": 3, "user_id": 5392112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pCHTUdaH3dw/AAAAAAAAAAI/AAAAAAAAAB4/36zLaTIn5oA/photo.jpg?sz=128", "display_name": "Jan Malan", "link": "https://stackoverflow.com/users/5392112/jan-malan"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1446039702, "post_id": 32863915, "comment_id": 54576642, "body": "&#39;Read the first Product code in Pricelist PrCMis = Worksheets(&quot;Misilanious&quot;).Range(&quot;A&quot; &amp; ALMis).Value  &#39;Start the Loop to update all Products Do While PrCMis &lt;&gt; &quot;&quot;      PrCMis = Worksheets(&quot;Misilanious&quot;).Range(&quot;A&quot; &amp; ALMis).Value     PrCUp = Worksheets(&quot;Update&quot;).Range(&quot;A&quot; &amp; ALUp).Value         If PrCMis = PrCUp Then             &#39;Copy price from Update to Pricelist             NewPrice = Worksheets(&quot;Update&quot;).Range(&quot;c&quot; &amp; ALUp).Value             Worksheets(&quot;Misilanious&quot;).Range(&quot;E&quot; &amp; ALMis) = NewPrice"}, {"owner": {"reputation": 3, "user_id": 5392112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pCHTUdaH3dw/AAAAAAAAAAI/AAAAAAAAAB4/36zLaTIn5oA/photo.jpg?sz=128", "display_name": "Jan Malan", "link": "https://stackoverflow.com/users/5392112/jan-malan"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1446039745, "post_id": 32863915, "comment_id": 54576674, "body": "&#39;Add one to Active line of price list             ALMis = ALMis + 1             &#39;Reset Active line of Update             ALUp = 2         Else:             &#39;Loop through update untilmaching Product code is found             Do Until PrCMis = PrCUp                 ALUp = ALUp + 1                 PrCUp = Worksheets(&quot;Update&quot;).Range(&quot;A&quot; &amp; ALUp).Value"}, {"owner": {"reputation": 3, "user_id": 5392112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pCHTUdaH3dw/AAAAAAAAAAI/AAAAAAAAAB4/36zLaTIn5oA/photo.jpg?sz=128", "display_name": "Jan Malan", "link": "https://stackoverflow.com/users/5392112/jan-malan"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1446039791, "post_id": 32863915, "comment_id": 54576708, "body": "Loop                 NewPrice = Worksheets(&quot;Update&quot;).Range(&quot;c&quot; &amp; ALUp).Value                 Worksheets(&quot;Misilanious&quot;).Range(&quot;E&quot; &amp; ALMis) = NewPrice                 &#39;Add one to Active line of price list                 ALMis = ALMis + 1                 &#39;Reset Active line of Update                 ALUp = 2         End If"}, {"owner": {"reputation": 3, "user_id": 5392112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pCHTUdaH3dw/AAAAAAAAAAI/AAAAAAAAAB4/36zLaTIn5oA/photo.jpg?sz=128", "display_name": "Jan Malan", "link": "https://stackoverflow.com/users/5392112/jan-malan"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1446039838, "post_id": 32863915, "comment_id": 54576745, "body": "Loop MsgBox &quot;Update Done&quot;  End Sub"}, {"owner": {"reputation": 3, "user_id": 5392112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pCHTUdaH3dw/AAAAAAAAAAI/AAAAAAAAAB4/36zLaTIn5oA/photo.jpg?sz=128", "display_name": "Jan Malan", "link": "https://stackoverflow.com/users/5392112/jan-malan"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1446039908, "post_id": 32863915, "comment_id": 54576792, "body": "Sorry about the mess But I can&#39;t format the code nicely that it is more readable"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5392112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pCHTUdaH3dw/AAAAAAAAAAI/AAAAAAAAAB4/36zLaTIn5oA/photo.jpg?sz=128", "display_name": "Jan Malan", "link": "https://stackoverflow.com/users/5392112/jan-malan"}, "edited": false, "score": 0, "creation_date": 1446284089, "post_id": 33418751, "comment_id": 54687222, "body": "Thank you EEM, your code runs fine, I will use that as a base to learn more VBA."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 3, "user_id": 5392112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pCHTUdaH3dw/AAAAAAAAAAI/AAAAAAAAAB4/36zLaTIn5oA/photo.jpg?sz=128", "display_name": "Jan Malan", "link": "https://stackoverflow.com/users/5392112/jan-malan"}, "edited": false, "score": 0, "creation_date": 1446285398, "post_id": 33418751, "comment_id": 54687505, "body": "Glad to know it encourage you, we can assist you in the process, keep posting your questions..."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 0, "last_activity_date": 1446133445, "creation_date": 1446133445, "answer_id": 33418751, "question_id": 32863915, "link": "https://stackoverflow.com/questions/32863915/updating-data-in-excel-workbook-with-data-in-an-other-workbook/33418751#33418751", "title": "Updating data in Excel workbook with data in an other workbook", "body": "<p>Good attempt at writing the code, just a short comment about it:</p>\n\n<p><em>This part will loop endlessly if the Product is discontinued\u2026</em></p>\n\n<pre><code>'Loop through update untilmaching Product code is found\nDo Until PrCMis = PrCUp\n    ALUp = ALUp + 1\n    PrCUp = Worksheets(\"Update\").Range(\"A\" &amp; ALUp).Value\nLoop\n</code></pre>\n\n<p>The solution provided below, loop through the products in the <strong>Price List</strong> but the instead of looping again through the <strong>Update</strong>, it finds the matching record. Runs a comparison of <strong>Price List</strong> vs. <strong>Update</strong> identifying new prices and discontinued products, then runs a second comparison from <strong>Update</strong> to <strong>Price List</strong> in order to add new products. Have a look at the procedure below and the suggested readings, hope this will encourage you to continue working on automating all those tedious and repetitive daily tasks.</p>\n\n<p>This solutions uses these three worksheets: </p>\n\n<ol>\n<li><strong>Update</strong>: Contains the latest price update for all products. It may include new products, also <em>\u201cDiscontinued\u201d</em> products are not included in this list. Its data is a continuous range of cells starting at <code>E7</code>, <em>delimited by blank cells</em>.</li>\n<li><strong>Price List</strong>: Contains the list of all products with respective price and other associated data. Its data is a continuous range of cells starting at <code>C6</code>, <em>delimited by blank cells</em>.</li>\n<li><strong>Discontinued</strong>: Contains the list of the discontinued products. Its data is a continuous range of cells starting at <code>B2</code>, <em>delimited by blank cells</em>. This worksheet will be created by the procedure if not present.</li>\n</ol>\n\n<p>This code runs a comparison of the Products between the Price List and Update worksheets <em>(both ways)</em> and updates <em>new prices</em>, adds <em>new products</em> and deletes <em>discontinued products</em> in the <strong>Price List</strong> data, with track of the updates and keeping a list of the discontinued products in a separated worksheet.</p>\n\n<p>As this code use resources that might be unknown to the user, I have added some indications of their purpose and suggested pages for extended reading and understanding, nevertheless let me know of any question you might have about the code.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff194565.aspx\" rel=\"nofollow noreferrer\">Application Object (Excel)</a>, \n<a href=\"https://msdn.microsoft.com/EN-US/library/office/gg251601.aspx\" rel=\"nofollow noreferrer\">For...Next Statement</a>, \n<a href=\"https://msdn.microsoft.com/en-us/library/office/gg251821(v=office.15).aspx\" rel=\"nofollow noreferrer\">MsgBox Function</a>, </p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">Range Object (Excel)</a>, \n<a href=\"http://www.excelfunctions.net/VBA-Variables-And-Constants.html\" rel=\"nofollow noreferrer\">Variables &amp; Constants</a>, \n<a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264723.aspx\" rel=\"nofollow noreferrer\">With Statement</a>, </p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff821537.aspx\" rel=\"nofollow noreferrer\">Worksheets Object (Excel)</a>, \n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow noreferrer\">WorksheetFunction Object (Excel)</a></p>\n\n<pre><code>Option Explicit\n\nSub Update_Miscellaneous()\n\nRem Constants to Hold Starting Cell of Data Ranges (update as required)\n'see [Variables &amp; Constants]\nConst kIniPlst As String = \"C6\"\nConst kIniUpdt As String = \"E7\"\nConst kIniDisc As String = \"B2\"\n\nRem Declare Objects as Variables\n'see [Range Object (Excel)]\nDim rUpdt As Range, rMisc As Range, rDisc As Range\n\nRem Declare Process Variables\nDim sProd As String, dPric As Double, dPOld As Double\n\nDim Wsh As Worksheet, Rng As Range\nDim bProdUpdt As Byte, bPricUpdt As Byte\nDim bProd As Byte, bPric As Byte, bPOld As Byte, bPStt As Byte\nDim lRow0 As Long, lRow1 As Long, lNew As Long\nDim tTme As Date, sNow As String\n\n    Rem Application Settings To Improve Performance\n    'see [Application Object (Excel)]\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n\n    Rem Set Time &amp; Date\n    tTme = Now\n    sNow = Format(Now, \" dd-mmm-yy hh:mm\")\n\n    Rem Set Objects\n    'see [With Statement]\n    With ThisWorkbook\n        Set rUpdt = .Worksheets(\"Update\").Range(kIniUpdt).CurrentRegion\n        Set rMisc = .Worksheets(\"Price List\").Range(kIniPlst).CurrentRegion\n        On Error GoTo WshAdd\n        Set rDisc = .Worksheets(\"Discontinued\").Range(kIniDisc).CurrentRegion\n        On Error GoTo 0\n        Set rDisc = rDisc.Rows(1).Offset(rDisc.Rows.Count)\n    End With\n\n    Rem Set Field Position - Updated\n    'see [WorksheetFunction Object (Excel)]\n    With rUpdt\n        Rem Set Field Position\n        'Using Excel Worksheet Functions in VBA\n        bProdUpdt = WorksheetFunction.Match(\"Product Code\", .Rows(1), 0)\n        'Can also be used with Application\n        bPricUpdt = Application.Match(\"Price\", .Rows(1), 0)\n        Rem Set Body Range\n        Set rUpdt = .Offset(1, 0).Resize(-1 + .Rows.Count)\n    End With\n\n    Rem Set Field Position - Miscellaneous\n    With rMisc\n        Rem Set AutoFilter Off\n        If Not .Worksheet.AutoFilter Is Nothing Then .AutoFilter\n        Rem Set Field Position\n        bProd = WorksheetFunction.Match(\"PRC\", .Rows(1), 0)\n        bPric = WorksheetFunction.Match(\"PRICE\", .Rows(1), 0)\n        bPOld = WorksheetFunction.Match(\"Price.Old\", .Rows(1), 0)\n        bPStt = WorksheetFunction.Match(\"Status\", .Rows(1), 0)\n        Rem Set Body Range\n        Set rMisc = .Offset(1, 0).Resize(-1 + .Rows.Count)\n    End With\n\n    Rem Update Current Products\n    With rMisc\n\n        Rem Set Latest Price\n        'see [For...Next Statement]\n        For lRow0 = 1 To .Rows.Count\n            sProd = .Cells(lRow0, bProd).Value2\n            dPOld = .Cells(lRow0, bPric).Value2\n\n            Rem Get Latest Price\n            lRow1 = 0\n            On Error Resume Next\n            lRow1 = WorksheetFunction.Match(sProd, rUpdt.Columns(bProdUpdt), 0)\n            On Error GoTo 0\n            If lRow1 &lt;&gt; 0 Then\n                Rem Prices Comparison\n                dPric = rUpdt.Cells(lRow1, bPricUpdt).Value2\n                If dPric &lt;&gt; dPOld Then\n                    Rem New Price\n                    .Cells(lRow0, bPOld).Value = dPOld\n                    .Cells(lRow0, bPric).Value = dPric\n                    .Cells(lRow0, bPStt).Value = \"Price Change\" &amp; sNow\n                End If\n\n            Else\n                Rem Product Discontinued\n                .Cells(lRow0, bPOld).Value = dPOld\n                .Cells(lRow0, bPric).ClearContents\n                .Cells(lRow0, bPStt).Value = \"Discontinued\" &amp; sNow\n\n    End If: Next: End With\n\n    Rem Set New Products\n    lNew = rMisc.Rows.Count\n    With rUpdt\n        For lRow0 = 1 To .Rows.Count\n            sProd = .Cells(lRow0, bProd).Value2\n            dPric = .Cells(lRow0, bPricUpdt).Value2\n\n            Rem Get New Product\n            lRow1 = 0\n            On Error Resume Next\n            lRow1 = WorksheetFunction.Match(sProd, rMisc.Columns(bProdUpdt), 0)\n            On Error GoTo 0\n            If lRow1 = 0 Then\n                Rem Add New Product\n                lNew = 1 + lNew\n                With rMisc\n                    .Cells(lNew, bProd).Value = sProd\n                    .Cells(lNew, bPric).Value = dPric\n                    .Cells(lNew, bPStt).Value = \"!New Product\" &amp; sNow\n\n    End With: End If: Next: End With\n\n    Rem Reset Range Misc\n    If lNew &lt;&gt; rMisc.Rows.Count Then\n        Set rMisc = rMisc.CurrentRegion\n        Set rMisc = rMisc.Offset(1, 0).Resize(-1 + rMisc.Rows.Count)\n        Debug.Print xlPasteFormats, Now,\n        rMisc.Rows(1).Copy\n        rMisc.PasteSpecial Paste:=xlPasteFormats\n        Application.CutCopyMode = False\n        Debug.Print Now\n    End If\n\n    Rem Move Discontinued Records\n    With rMisc\n\n        Rem Sort By Status\n        'Sort is a Property of the Worksheet Object\n        With .Worksheet.Sort\n            .SortFields.Clear\n            .SortFields.Add Key:=rMisc.Columns(bPStt), _\n                SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            .SetRange rMisc\n            .Header = xlYes\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n\n        Rem Set AutoFilter\n        .CurrentRegion.AutoFilter\n\n        Rem Filter by Status\\Discontinued\n        .AutoFilter Field:=bPStt, Criteria1:=\"=*Discontinued*\"\n        On Error Resume Next\n        Set Rng = .SpecialCells(xlCellTypeVisible)\n        On Error GoTo 0\n\n        Rem Set AutoFilter Off\n        If Not .Worksheet.AutoFilter Is Nothing Then .AutoFilter\n\n        Rem Work with Discontinued Records\n        If Not Rng Is Nothing Then\n\n            Rem Add Discontinued Records\n            rDisc.Resize(Rng.Rows.Count).Value = Rng.Value2\n            rDisc.CurrentRegion.Columns.AutoFit\n            Application.Goto rDisc.Worksheet.Cells(1), 1\n            Application.Goto rDisc.Cells(1)\n\n            Rem Delete Discontinued Records\n            'Rng.EntireRow.Delete       'Use this line if no other data in worksheet\n            Rng.Delete Shift:=xlUp     'Use this line if there is other data in worksheet\n\n    End If: End With\n\n    Rem Sort Remaining Records By Product\n    With rMisc.Worksheet.Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=rMisc.Columns(bProd), _\n            SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .SetRange rMisc\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    Rem Restate Application Settings\n    Application.Goto rMisc.Worksheet.Cells(1), 1\n    Application.Goto rMisc.Cells(1)\n    Application.EnableEvents = True\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n\n    'see [MsgBox Function]\n    Rem Process Completed\n    MsgBox \"Update Completed in \" &amp; Format(Now - tTme, \"hh : mm : ss.001\"), _\n        vbApplicationModal + vbInformation + vbOKOnly, _\n        \"Product Price Update\"\n\nExit Sub\nWshAdd:\n    'see [Worksheets Object (Excel)]\n    Rem Add Worksheet Discontinued\n    With ThisWorkbook\n        Set Wsh = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n    End With\n    Wsh.Name = \"Discontinued\"\n    Wsh.Range(kIniDisc).Resize(, rMisc.Columns.Count).Value = rMisc.Rows(1).Value2\n    Resume\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Lif8D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lif8D.png\" alt=\"Price List before update\"></a></p>\n\n<p>Fig.1 Price List before update</p>\n\n<p><a href=\"https://i.stack.imgur.com/VMgrD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VMgrD.png\" alt=\"Update data\"></a></p>\n\n<p>Fig.2 Update data</p>\n\n<p><a href=\"https://i.stack.imgur.com/w68cP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w68cP.png\" alt=\"Price List after update\"></a></p>\n\n<p>Fig. 3 Price list after update</p>\n\n<p><a href=\"https://i.stack.imgur.com/d7rdC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d7rdC.png\" alt=\"Discontinued after update\"></a></p>\n\n<p>Fig. 4 Discontinued after update</p>\n"}], "owner": {"reputation": 3, "user_id": 5392112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pCHTUdaH3dw/AAAAAAAAAAI/AAAAAAAAAB4/36zLaTIn5oA/photo.jpg?sz=128", "display_name": "Jan Malan", "link": "https://stackoverflow.com/users/5392112/jan-malan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "accepted_answer_id": 33418751, "answer_count": 1, "score": 0, "last_activity_date": 1462559999, "creation_date": 1443609280, "last_edit_date": 1531161705, "question_id": 32863915, "link": "https://stackoverflow.com/questions/32863915/updating-data-in-excel-workbook-with-data-in-an-other-workbook", "title": "Updating data in Excel workbook with data in an other workbook", "body": "<p>I have a workbook Called Price list, it contain several worksheets each worksheet is in the same format but contain different classifications of products. The format of a work sheet is as folows:</p>\n\n<blockquote>\n<pre><code> A          B          C      D\n</code></pre>\n  \n  <p>1    PRC      DESCRIPTION  UNIT  PRICE</p>\n  \n  <p>2   A001      Product1     Each    20.00</p>\n  \n  <p>3   D001      Product2      L       5.00</p>\n  \n  <p>4   H001      Product3      Rol     4.00  </p>\n</blockquote>\n\n<p>Every month We get an Updated Price List as an Exel workbook.</p>\n\n<p>In the past we got all the information as above but something changed at the Supplier and we only receive the \"Product code\" \"Bar-code\" and \"Price\"</p>\n\n<p>I need to update my <strong>\"Price-list\"</strong> by matching the Product Code in the <strong>\"Update\"</strong> with the one in my Price list. Then compare price, if the price differs it should change the price in the <strong>\"Price-list\"</strong> to that of the <strong>\"Update\"</strong> </p>\n\n<p>If posible it should delete the line in the <strong>\"Update\"</strong> for us to know if there are new Products and delete the Line in the <strong>\"Price-List\"</strong> if the product code is not found in the \"Update\", For discontinued Products. </p>\n\n<p>The \"Update\" Contains about 12000 lines</p>\n\n<p><strong>Is there an easy way in doing it?</strong></p>\n\n<p><strong><em>EDITED TO INCLUDE COMMENTS AND CODE FROM OP</em></strong></p>\n\n<p>I wrote some Code But I'm not to clued up with VBA.</p>\n\n<pre><code>Sub UpdateMisilanious_Original()\n' UpdateMisilanious Macro\n' This will update the misilanious List\n'The variable for the active line in Misilanious\nDim ALMis As Integer\n    ALMis = 4\n'The variable for the active line in Update\nDim ALUp As Integer\n    ALUp = 2\n'The varible for product code of Misilanious\nDim PrCMis As String\n'The varible for product code of Update\nDim PrCUp As String\n'The temp Varible for the Price\nDim NewPrice As Currency\n\n    'Read the first Product code in Pricelist\n    PrCMis = Worksheets(\"Misilanious\").Range(\"A\" &amp; ALMis).Value\n    'Start the Loop to update all Products\n    Do While PrCMis &lt;&gt; \"\"\n        PrCMis = Worksheets(\"Misilanious\").Range(\"A\" &amp; ALMis).Value\n        PrCUp = Worksheets(\"Update\").Range(\"A\" &amp; ALUp).Value\n        If PrCMis = PrCUp Then\n            'Copy price from Update to Pricelist\n            NewPrice = Worksheets(\"Update\").Range(\"c\" &amp; ALUp).Value\n            Worksheets(\"Misilanious\").Range(\"E\" &amp; ALMis) = NewPrice\n            'Add one to Active line of price list\n            ALMis = ALMis + 1\n            'Reset Active line of Update\n            ALUp = 2\n        Else:\n\n            'Loop through update untilmaching Product code is found\n            Do Until PrCMis = PrCUp\n                ALUp = ALUp + 1\n                PrCUp = Worksheets(\"Update\").Range(\"A\" &amp; ALUp).Value\n            Loop\n            NewPrice = Worksheets(\"Update\").Range(\"c\" &amp; ALUp).Value\n            Worksheets(\"Misilanious\").Range(\"E\" &amp; ALMis) = NewPrice\n            'Add one to Active line of price list\n            ALMis = ALMis + 1\n            'Reset Active line of Update\n            ALUp = 2\n        End If\n    Loop\n    MsgBox \"Update Done\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1443609095, "post_id": 32863742, "comment_id": 53559904, "body": "you split the  on chr(58) which is :, maybe there is no : il the line?"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1443610022, "last_edit_date": 1443610022, "creation_date": 1443609365, "answer_id": 32863943, "question_id": 32863742, "link": "https://stackoverflow.com/questions/32863742/subscript-out-of-range-when-copying-to-cell/32863943#32863943", "title": "Subscript out of range when copying to cell", "body": "<p>Replace this:</p>\n\n<pre><code>   vItem = Split(vText(i), Chr(58))\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>  vItem = Split(vText(i),\"-\")\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5309925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590915f5df952b99305fba4b7c2add71?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Webb", "link": "https://stackoverflow.com/users/5309925/robert-webb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "closed_date": 1506781294, "answer_count": 1, "score": -3, "last_activity_date": 1592699566, "creation_date": 1443608783, "last_edit_date": 1592699566, "question_id": 32863742, "link": "https://stackoverflow.com/questions/32863742/subscript-out-of-range-when-copying-to-cell", "closed_reason": "Not suitable for this site", "title": "Subscript out of range when copying to cell", "body": "<p>I am trying to extract Data from emails by using this script I found online with some changes to run for my specific information:</p>\n\n<pre><code>Option Explicit\n\nSub CopyToExcel()\nDim xlApp As Object\nDim xlWB As Object\nDim xlSheet As Object\nDim olItem As Outlook.MailItem\nDim vText As Variant\nDim sText As String\nDim vItem As Variant\nDim i As Long\nDim rCount As Long\nDim bXStarted As Boolean\nConst strPath As String = \"C:\\Users\\Rob\\Documents\\Excel\\ExcelTest.xlsx\" 'the path of the workbook\n\nIf Application.ActiveExplorer.Selection.Count = 0 Then\n    MsgBox \"No Items selected!\", vbCritical, \"Error\"\n    Exit Sub\nEnd If\nOn Error Resume Next\nSet xlApp = GetObject(, \"Excel.Application\")\nIf Err &lt;&gt; 0 Then\n    Application.StatusBar = \"Please wait while Excel source is opened ... \"\nSet xlApp = CreateObject(\"Excel.Application\")\nbXStarted = True\nEnd If\nOn Error GoTo 0\n'Open the workbook to input the data\nSet xlWB = xlApp.Workbooks.Open(strPath)\nSet xlSheet = xlWB.Sheets(\"Sheet1\")\n\n'Process each selected record\nrCount = xlSheet.UsedRange.Rows.Count\nFor Each olItem In Application.ActiveExplorer.Selection\n    sText = olItem.Body\n    vText = Split(sText, Chr(13))\n    'Find the next empty line of the worksheet\n    rCount = rCount + 1\n\n    'Check each line of text in the message body\n    For i = UBound(vText) To 0 Step -1\n        If InStr(1, vText(i), \"Destination -\") &gt; 0 Then\n            vItem = Split(vText(i), Chr(58))\n            xlSheet.Range(\"A\" &amp; rCount) = Trim(vItem(1))\n        End If\n    Next i\n\n    xlWB.Save\nNext olItem\nxlWB.Close SaveChanges:=True\nIf bXStarted Then\n    xlApp.Quit\nEnd If\nSet xlApp = Nothing\nSet xlWB = Nothing\nSet xlSheet = Nothing\nSet olItem = Nothing\nEnd Sub\n</code></pre>\n\n<p>The information I have to extract from the emails are shown below in BOLD.</p>\n\n<p>Destination State - Pennsylvania</p>\n\n<p><strong>Destination - Pittsburgh</strong></p>\n\n<p>UK Airport - London Gatwick</p>\n\n<p>Airline - United Airlines</p>\n\n<p><strong>Flight Class - Premium - from \u00a3499</strong></p>\n\n<p><strong>Depart Date - 27/07/2011</strong></p>\n\n<p>Return Date - 10/08/2011</p>\n\n<p>Adults - 2</p>\n\n<p>Children - 1</p>\n\n<p><strong>First Name - Andrew</strong></p>\n\n<p><strong>Last Name - Leakey</strong></p>\n\n<p><strong>Telephone - 07785 496123</strong> // Number Is fake</p>\n\n<p><strong>Contact Email - AmdrewsEmail@Email.org.uk</strong></p>\n\n<p>When I run the code it says \"Subscript out of range\" and the debugger says it is occurring on this line.</p>\n\n<pre><code>xlSheet.Range(\"A\" &amp; rCount) = Trim(vItem(1))\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 5096, "user_id": 175349, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ae3888fdec3e7ba86cbaf3976cace655?s=128&d=identicon&r=PG", "display_name": "Ihor Kaharlichenko", "link": "https://stackoverflow.com/users/175349/ihor-kaharlichenko"}, "edited": false, "score": 0, "creation_date": 1443609364, "post_id": 32863713, "comment_id": 53560063, "body": "Please explain what exactly is your problem?"}], "answers": [{"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 0, "last_activity_date": 1443617388, "creation_date": 1443617388, "answer_id": 32866566, "question_id": 32863713, "link": "https://stackoverflow.com/questions/32863713/sql-query-to-extract-employee-details-from-access-table/32866566#32866566", "title": "SQL query to extract employee details from access table", "body": "<p>You need to move through each record in the recordset. Currently you are trying to read all of the fields from a single record but your query only returns one field. Try this instead:</p>\n\n<pre><code>MsgBox \"There are no records in the recordset!\", vbCritical, \"No Records\"\nExit Sub\nEnd If\ni = 0\nDo Until rs.EOF\n    comboamo.AddItem rs.Fields(\"Nameofemployee\").Value, i\n    rs.MoveNext\n    i = i + 1\nLoop\nrs.Close\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3395230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e689b8561ad1e92c83e1e0f07d37a571?s=128&d=identicon&r=PG&f=1", "display_name": "user3395230", "link": "https://stackoverflow.com/users/3395230/user3395230"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443691429, "creation_date": 1443608716, "last_edit_date": 1531164843, "question_id": 32863713, "link": "https://stackoverflow.com/questions/32863713/sql-query-to-extract-employee-details-from-access-table", "title": "SQL query to extract employee details from access table", "body": "<p>I am new to Excel VBA. I have a user form in which I am trying to populate names of those employees who are AMO. I have a database called <code>Ofc</code>. Under which I have a table <code>EmployeeDetails</code>. Primary key is <code>PeoplesoftId</code>.</p>\n\n<p>Here is the structure and the contents of the <code>Employee</code> table:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>PeoplesoftId  Nameofemployee  RacifId  Employeeid  Designation\n43243309      Maddala         V43309   99651823    AMO\n43243310      Abhishek        A43301   99651824    AMO\n43243311      Atanu           A43311   99651825    MO\n43243312      Rajiv           R43312   99651826    CSE\n</code></pre>\n\n<p>This is the code I've written so far:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim cnn As ADODB.Connection 'dim the ADO collection class\nDim rs As ADODB.Recordset 'dim the ADO recordset class\nDim dbPath As String\nDim SQL As String\nDim i As Integer\nDim var\n'add error handling\nOn Error GoTo errHandler:\n'Disable screen flickering.\nApplication.ScreenUpdating = False\ndbPath = \"E:\\office_hsbc\\ofc.accdb\"\nvar = \"AMO\"\nSet cnn = New ADODB.Connection ' Initialise the collection class variable\ncnn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; dbPath\ncnn.Open\nSQL = \"SELECT Nameofemployee FROM EmployeeDetails where Designation= '\" &amp; var &amp; \"'\"\nSet rs = New ADODB.Recordset 'assign memory to the recordset\nrs.Open SQL, cnn\nIf rs.EOF And rs.BOF Then\nrs.Close\ncnn.Close\n'clear memory\nSet rs = Nothing\nSet cnn = Nothing\n'Enable the screen.\nApplication.ScreenUpdating = True\nMsgBox \"There are no records in the recordset!\", vbCritical, \"No Records\"\nExit Sub\nEnd If\nFor i = 0 To rs.Fields.Count - 1\n    comboamo.AddItem rs.Fields(i).Value, i\nNext\nrs.Close\ncnn.Close\nSet rs = Nothing\nSet cnn = Nothing\nMsgBox \"Congratulation the data has been successfully Imported\", vbInformation, \"Import successful\"\n'error handler\nOn Error GoTo 0\nExit Sub\nerrHandler:\n'clear memory\nSet rs = Nothing\nSet cnn = Nothing\nMsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure Import_Data\"\n</code></pre>\n"}, {"tags": ["vba", "hidden", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1443613814, "post_id": 32863173, "comment_id": 53562683, "body": "Thanks that&#39;s exactly the function I was looking for. Do you know if I can count those hidden slides and substract that number to the slide count dynamically? (I edited the question, I get a &quot;object not defined&quot; error)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1443615275, "post_id": 32863173, "comment_id": 53563650, "body": "Don&#39;t use the <code>Set</code> keyword, it&#39;s only use for Object variables, so String, Long, Boolean, ... won&#39;t work with it! It&#39;ll work with Shapes, Workbook, Worksheet, ... And when you say subtract to the slide count, do you mean Slides.Count property? Because that, you can&#39;t do : <code>Property Count As Long, Read Only</code>"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1443616230, "post_id": 32863173, "comment_id": 53564310, "body": "Without the set keyword,it works better. For the substract part, i mean the value of y, not the presentation properties. For instance, if i have a hidden slide at index 8 and a titled slide at 9, i want the titled slide to appear in ToC with the number 8."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 1, "creation_date": 1443616581, "post_id": 32863173, "comment_id": 53564562, "body": "I would say yes, if you use something like this <code>Format(y - counthidden, &quot;0 - &quot;)</code>. And btw, I&#39;m glad you post this because I thought a long time ago to build something like this, but I didn&#39;t think that the <code>HasTitle</code> in <code>Shapes</code> would mean that the slide has a title or not! :)"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1443616822, "post_id": 32863173, "comment_id": 53564737, "body": "Yep, that&#39;ll do. It is perfect! Do you know if it is possible to generate a powerpoint presentation automatically, replacing placeholder with their values in an excel sheet? I have the question prepared to be sent, but I dont have internet on my desktop."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1443617791, "post_id": 32863173, "comment_id": 53565395, "body": "Yes, it is most probably possible, but I don&#39;t have the full structure in mind, but the idea is to add a new slide for each line in excel and use slide&#39;s templates (layout in VBA if I remember well and then I think you can do the heavy lifting with what you already have, the fine tunes maybe worth a question afterwards). If you post the question, poke me here so I&#39;ll know ;)"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1443618657, "post_id": 32863173, "comment_id": 53566011, "body": "I meant in a way of keywords inside slides. I already have the layout of the presentation. The slide are set, the content of them is what I want changed."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1443618896, "post_id": 32863173, "comment_id": 53566184, "body": "I don&#39;t exactly know how to do this but if you seek a bit, I think it is possible but you&#39;ll have to prepare the data properly to place it in the way you want with VBA. Let me know if you post the question, I&#39;ll try to help you ;)"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 1, "creation_date": 1443619811, "post_id": 32863173, "comment_id": 53566830, "body": "I have finally internet again, and posted the question : <a href=\"http://stackoverflow.com/questions/32867412/generating-a-powerpoint-presentation-with-vba-and-excel\" title=\"generating a powerpoint presentation with vba and excel\">stackoverflow.com/questions/32867412/&hellip;</a>"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1443617862, "last_edit_date": 1443617862, "creation_date": 1443607108, "answer_id": 32863173, "question_id": 32862864, "link": "https://stackoverflow.com/questions/32862864/ignore-hidden-slides-when-printing-a-table-of-contents-in-vba-powerpoint/32863173#32863173", "title": "Ignore hidden slides when printing a table of contents in VBA - Powerpoint", "body": "<p>Here you go ;)</p>\n\n<pre><code>For y = 3 To ActivePresentation.Slides.Count\n    Set Diapo = ActivePresentation.Slides(y)\n    If Diapo.SlideShowTransition.Hidden = msoTrue Then 'other value : msoFalse\n        CountHidden = CountHidden + 1\n    Else\n        'The slide is not hidden\n        If Diapo.Shapes.HasTitle Then\n            'si la diapo a un titre\n            Set titre = Diapo.Shapes.Title\n            texte_ajout = texte_ajout &amp; Format(y - CountHidden, \"0 - \") &amp; titre.TextFrame. _\n                TextRange.Text &amp; Chr(13) &amp; vbCrLf\n        End If\n    End If\nNext y\n</code></pre>\n"}], "owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 32863173, "answer_count": 1, "score": 1, "last_activity_date": 1487250169, "creation_date": 1443606150, "last_edit_date": 1487250169, "question_id": 32862864, "link": "https://stackoverflow.com/questions/32862864/ignore-hidden-slides-when-printing-a-table-of-contents-in-vba-powerpoint", "title": "Ignore hidden slides when printing a table of contents in VBA - Powerpoint", "body": "<p>I am trying to write a table of contents at the begining of my powerpoint presentation.</p>\n\n<p>The code I have fetches all the slide that have a title, and print them along with their index.</p>\n\n<p>I would like to know where can I find the command to determine wether or not a slide is hidden. I have searched the msdn VBA Powerpoint section, but came up empty.</p>\n\n<p>For example, my current project is :</p>\n\n<pre><code>For y = 3 To ActivePresentation.Slides.Count\nSet Diapo = ActivePresentation.Slides(y)\n'si la diapo a un titre\nIf Diapo.Shapes.HasTitle Then\nSet titre = Diapo.Shapes.Title\ntexte_ajout = texte_ajout &amp; Format(y, \"0 - \") &amp; titre.TextFrame. _\nTextRange.Text &amp; Chr(13) &amp; vbCrLf\nEnd If\nNext y\n</code></pre>\n\n<p>It counts all of the slides, including those that might be hidden.</p>\n\n<p>I would like (if it is possible) to write this before the first if and after the set Diapo</p>\n\n<pre><code>If Diapo.SlideShowTransition.Hidden = msoTrue Then\nSet counthidden = counthidden + 1\n</code></pre>\n\n<p>...</p>\n\n<pre><code>texte_ajout = texte_ajout &amp; Format(y-counthidden, \"0 - \") &amp; titre.TextFrame. _\nTextRange.Text &amp; Chr(13) &amp; vbCrLf\nEnd If\n</code></pre>\n\n<p>(I defined counthidden as byte first, then as long, but it's not working)\nIs it possible?</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2007", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1443606891, "creation_date": 1443606891, "answer_id": 32863098, "question_id": 32862779, "link": "https://stackoverflow.com/questions/32862779/ms-access-freeze-table-header-in-report/32863098#32863098", "title": "Ms Access : Freeze Table Header in Report", "body": "<p>Reports are for printing, the Print preview ist just that, a preview.</p>\n\n<p>Since there is no \"freezing a header\" on paper, the answer is no.</p>\n\n<p>But of course you can put the table header into the <strong>page header</strong> of the report, so it will show up on every page.</p>\n"}, {"tags": [], "owner": {"reputation": 349, "user_id": 3140152, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e3f288a1fd65f635e45be0ac2cc2f7c0?s=128&d=identicon&r=PG&f=1", "display_name": "pegicity", "link": "https://stackoverflow.com/users/3140152/pegicity"}, "is_accepted": false, "score": 0, "last_activity_date": 1443621599, "creation_date": 1443621599, "answer_id": 32868077, "question_id": 32862779, "link": "https://stackoverflow.com/questions/32862779/ms-access-freeze-table-header-in-report/32868077#32868077", "title": "Ms Access : Freeze Table Header in Report", "body": "<p>You would probably have more success in presenting your report how you want if you use Excel to link to your database, much easier to produce visually appealing reports that way.</p>\n"}], "owner": {"reputation": 311, "user_id": 2857740, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5870407206e91db4674d4cd3b9c795a1?s=128&d=identicon&r=PG&f=1", "display_name": "adp", "link": "https://stackoverflow.com/users/2857740/adp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1496, "favorite_count": 0, "accepted_answer_id": 32863098, "answer_count": 2, "score": -2, "last_activity_date": 1443621599, "creation_date": 1443605931, "question_id": 32862779, "link": "https://stackoverflow.com/questions/32862779/ms-access-freeze-table-header-in-report", "title": "Ms Access : Freeze Table Header in Report", "body": "<p>i have a rather large report in MS Access , I would like to freez the table header,when scrolling down. Is this possible?</p>\n\n<p>bR,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1443606440, "post_id": 32862763, "comment_id": 53558338, "body": "Have you try a workaround for <code>cell.ClearContents</code>? Like using the others <code>.Clear*</code> (<code>.Clear</code>, <code>.ClearFormats</code>, ...) or simply by using <code>cell.Value=vbNullString</code>?"}, {"owner": {"reputation": 3422, "user_id": 1458030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3728aa864efa903f4d0c7db9ac39989?s=128&d=identicon&r=PG", "display_name": "qPCR4vir", "link": "https://stackoverflow.com/users/1458030/qpcr4vir"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1443606725, "post_id": 32862763, "comment_id": 53558506, "body": "probably .ClearContents invalidate the iteration on .UsedRange.Cells. Try @R3uK sugestions. Alternatively first &quot;fix&quot; the range in another variable and only then go iterate"}, {"owner": {"reputation": 6434, "user_id": 1943849, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/032941e928dde4d60ee11c9eef2abddd?s=128&d=identicon&r=PG", "display_name": "astef", "link": "https://stackoverflow.com/users/1943849/astef"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1443606766, "post_id": 32862763, "comment_id": 53558533, "body": "@R3uK I&#39;ve just tried all of them. No change. Also tried <code>cell.Value=&quot;&quot;</code>"}, {"owner": {"reputation": 6434, "user_id": 1943849, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/032941e928dde4d60ee11c9eef2abddd?s=128&d=identicon&r=PG", "display_name": "astef", "link": "https://stackoverflow.com/users/1943849/astef"}, "reply_to_user": {"reputation": 3422, "user_id": 1458030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3728aa864efa903f4d0c7db9ac39989?s=128&d=identicon&r=PG", "display_name": "qPCR4vir", "link": "https://stackoverflow.com/users/1458030/qpcr4vir"}, "edited": false, "score": 0, "creation_date": 1443607049, "post_id": 32862763, "comment_id": 53558701, "body": "@qPCR4vir Don&#39;t get what you mean about &quot;fixing&quot; the range. Can you show?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 3422, "user_id": 1458030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3728aa864efa903f4d0c7db9ac39989?s=128&d=identicon&r=PG", "display_name": "qPCR4vir", "link": "https://stackoverflow.com/users/1458030/qpcr4vir"}, "edited": false, "score": 0, "creation_date": 1443607293, "post_id": 32862763, "comment_id": 53558851, "body": "Like @qPCR4vir suggested, create a <b>Range</b> variable and use <code>Set varRange = Sh.UsedRange.Cells</code> between your 2 first <code>For Each</code> and use this variable in your 2nd <code>For Each</code> (<code>For Each cell In Sh.UsedRange.Cells</code> become <code>For Each cell In varRange</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 6434, "user_id": 1943849, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/032941e928dde4d60ee11c9eef2abddd?s=128&d=identicon&r=PG", "display_name": "astef", "link": "https://stackoverflow.com/users/1943849/astef"}, "is_accepted": true, "score": 1, "last_activity_date": 1443607873, "creation_date": 1443607873, "answer_id": 32863451, "question_id": 32862763, "link": "https://stackoverflow.com/questions/32862763/clearing-cell-contents-prevent-next-button-to-be-added/32863451#32863451", "title": "Clearing cell contents prevent next button to be added", "body": "<p>I'm sorry, but the problem was in the code I didn't show you:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    Sh.Unprotect pwd\n    Target.Locked = False\n    Sh.Protect pwd\nEnd Sub\n</code></pre>\n\n<p>Updating cell's value raised SheetChange event. My solution is to temporarily disable events:</p>\n\n<pre><code>Application.EnableEvents = False\n\nFor Each Sh In ActiveWorkbook.Worksheets\n...\n\nApplication.EnableEvents = True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 6434, "user_id": 1943849, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/032941e928dde4d60ee11c9eef2abddd?s=128&d=identicon&r=PG", "display_name": "astef", "link": "https://stackoverflow.com/users/1943849/astef"}, "edited": false, "score": 0, "creation_date": 1443610019, "post_id": 32863490, "comment_id": 53560424, "body": "Sorry, forgot one line in the code. Now the <code>.OnAction</code> event handler is added correctly."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 6434, "user_id": 1943849, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/032941e928dde4d60ee11c9eef2abddd?s=128&d=identicon&r=PG", "display_name": "astef", "link": "https://stackoverflow.com/users/1943849/astef"}, "edited": false, "score": 0, "creation_date": 1443616146, "post_id": 32863490, "comment_id": 53564245, "body": "BTW: these are merely <code>shapes</code>. Note, that almost <b>any</b> shape in Excel can get a macro assigned and most of these <code>shapes</code> look better than a button: <a href=\"http://stackoverflow.com/questions/32333488/vba-windows-7-style-buttons/32335204#32335204\" title=\"vba windows 7 style buttons\">stackoverflow.com/questions/32333488/&hellip;</a>"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1443609986, "last_edit_date": 1443609986, "creation_date": 1443608055, "answer_id": 32863490, "question_id": 32862763, "link": "https://stackoverflow.com/questions/32862763/clearing-cell-contents-prevent-next-button-to-be-added/32863490#32863490", "title": "Clearing cell contents prevent next button to be added", "body": "<p>Although your code works perfectly fine on my computer, I could understand if there is an issue with the <code>Button</code> collection. If you go into the Object Browser you will see that the <code>Button</code> collection is hidden. I am not sure if this collection will be depreciated. Yet, it also caused me some problems in the past. Why don't you try this instead:</p>\n\n<pre><code>Dim Sh As Worksheet\nDim cell As Range\nFor Each Sh In ActiveWorkbook.Worksheets\n    For Each cell In Sh.UsedRange.Cells\n        If cell.Value = \"{magic_value}\" Then\n            Sh.Shapes.AddFormControl(xlButtonControl, cell.Left, cell.Top, cell.EntireColumn.Width, cell.EntireRow.Height).Name = _\n                \"Btn_\" &amp; cell.Left &amp; \"_\" &amp; cell.Top\n            Sh.Shapes(\"Btn_\" &amp; cell.Left &amp; \"_\" &amp; cell.Top).OnAction = \"ButtonClickHandler\"\n            cell.ClearContents ' everything works without this line\n        End If\n    Next\nNext\n</code></pre>\n\n<p>The name and the caption are identical in this (the above) case and the on_click action is automatically assigned to these form controls.</p>\n"}], "owner": {"reputation": 6434, "user_id": 1943849, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/032941e928dde4d60ee11c9eef2abddd?s=128&d=identicon&r=PG", "display_name": "astef", "link": "https://stackoverflow.com/users/1943849/astef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 32863451, "answer_count": 2, "score": 0, "last_activity_date": 1443609986, "creation_date": 1443605870, "last_edit_date": 1531164843, "question_id": 32862763, "link": "https://stackoverflow.com/questions/32862763/clearing-cell-contents-prevent-next-button-to-be-added", "title": "Clearing cell contents prevent next button to be added", "body": "<p>I want to replace some cell values with buttons, but clearing the value prevents next button to be added. Here's the script:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim Sh As Worksheet\n    Dim btn As Button\n    Dim cell As Range\n    For Each Sh In ActiveWorkbook.Worksheets\n        For Each cell In Sh.UsedRange.Cells\n            If cell.Value = \"{magic_value}\" Then\n                Set btn = Sh.Buttons.Add(cell.Left, cell.Top, cell.Width, cell.Height)\n                With btn\n                    .OnAction = \"ButtonClickHandler\"\n                    .Caption = \"Btn_\" &amp; cell.Left &amp; \"_\" &amp; cell.Top\n                    .Name = \"Btn_\" &amp; cell.Left &amp; \"_\" &amp; cell.Top\n                End With\n                cell.ClearContents ' everything works without this line\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>When I open a workbook, first button is added but next buttons are not, and <code>Runtime error '1004'</code> occurs: <code>Unable to get property Add of class Buttons</code> (my translation). And debugger points to the line <code>Set btn = Sh.Buttons.Add ...</code></p>\n\n<p>From my research, the reason is the line <code>cell.ClearContents</code>. But I can't imagine how an error is related to a cell clearing.</p>\n"}, {"tags": ["vba", "excel", "split"], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "edited": false, "score": 0, "creation_date": 1443605860, "post_id": 32861964, "comment_id": 53558018, "body": "Awesome. Thanks for the complete explanation @R3uK. Appreciate your help"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "edited": false, "score": 0, "creation_date": 1443606177, "post_id": 32861964, "comment_id": 53558192, "body": "Glad I could help! ;) If your expressions to split become much more complex, you may want to use regular expressions, see how to do it in the 2 big answers in this post : <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a>"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 13, "last_activity_date": 1443603533, "creation_date": 1443603533, "answer_id": 32861964, "question_id": 32861636, "link": "https://stackoverflow.com/questions/32861636/how-to-split-a-string-and-store-in-variables/32861964#32861964", "title": "How to Split a String and Store in variables?", "body": "<p>Here are a few possibilities to show you how you can do that :</p>\n\n<pre><code>Dim var1 As String, _\n    var2 As String, _\n    sSplit() As String\n  GetID = \"13H4\"\n\n  sSplit = Split(GetID, \"H\")\n  var1 = sSplit(0)\n  var2 = sSplit(1)\n\n'--- OR ---\n\n  var1 = Split(GetID, \"H\")(0)\n  var2 = Split(GetID, \"H\")(1)\n</code></pre>\n\n<p>If you want to output numbers directly and not a text of a number, this will be the way to do it :</p>\n\n<pre><code>Dim var1 As Integer, _\n    var2 As Integer, _\n    sSplit() As String\n\n  GetID = \"13H4\"\n  sSplit = Split(GetID, \"H\")\n  var1 = CInt(sSplit(0))\n  var2 = CInt(sSplit(1))\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4812, "favorite_count": 2, "accepted_answer_id": 32861964, "answer_count": 1, "score": 3, "last_activity_date": 1491289399, "creation_date": 1443602506, "last_edit_date": 1491289399, "question_id": 32861636, "link": "https://stackoverflow.com/questions/32861636/how-to-split-a-string-and-store-in-variables", "title": "How to Split a String and Store in variables?", "body": "<p>I want to split a certain string and store them in a variable.</p>\n\n<pre><code>  GetID = \"13H4\"\n  sSplit = Split(GetID)\n</code></pre>\n\n<p><strong>I want to split them and store \"13\" in a variable and \"4\" in another variable.</strong></p>\n\n<p>I don't want to use MID,RIGHT,LEFT methods because I don't want to put a location of string to get \"13\" or \"4\". Do you guys know how to do it?</p>\n\n<p>Thanks guys. </p>\n"}, {"tags": ["vba", "excel", "conditional-statements", "excel-2003"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1443601910, "post_id": 32861177, "comment_id": 53555478, "body": "Is there a reason for not using <code>Cells(sRow, &quot;A&quot;).RESIZE(1, 39).Copy Destination:=DestSheet.Cells(dRow, &quot;A&quot;)</code>"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1443603181, "post_id": 32861177, "comment_id": 53556274, "body": "If you copy full rows why not using <code>DestSheet2.Rows(sRow).Copy destination:=DestSheet.Rows(dRow)</code>? Btw your code did not increment dRow in the X case, and you can factor the x and X cases."}, {"owner": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443603524, "post_id": 32861177, "comment_id": 53556525, "body": "as i said fellas, i&#39;m vba newbie. Thanks for your suggestions, gonna try it out and let you know"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1443603529, "post_id": 32861177, "comment_id": 53556530, "body": "Agreed @VincentG - I was thinking along the lines of <code>If LCase(.Cells(sRow, &quot;AD&quot;).Value2) Like &quot;*x*&quot; Then</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1443603597, "post_id": 32861177, "comment_id": 53556583, "body": "a) Can it be relied upon that the <code>.Top</code> of the shapes have the same <code>.Top</code> as the rows? b) Are there more than one shape to be copied across per row?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1443604375, "post_id": 32861177, "comment_id": 53557100, "body": "You can use <code>.Cells(sRow,30) Like &quot;*[xX]*&quot;</code>to test x and X in the same Like"}, {"owner": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443605241, "post_id": 32861177, "comment_id": 53557673, "body": "alright, so i got simplified copy of data, but shapes are copied still in silly (my) way. so when i execute macro, it copy data right after another, but position of shapes are still calculated from top - so when one row of data is missing (not marked by x), shapes are not matching with data"}, {"owner": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443605296, "post_id": 32861177, "comment_id": 53557708, "body": "gonna put image to original post, so you can have better look at this - cant, dont have reputation :("}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1443605488, "post_id": 32861177, "comment_id": 53557825, "body": "You can post an image to any public file share (<a href=\"http://imgur.com/\" rel=\"nofollow noreferrer\">imgur.com</a> is a nice one) and edit your question to include the public link. Very often someone with a little more rep will come along and edit your question to include the image from the link."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1443605547, "post_id": 32861177, "comment_id": 53557854, "body": "are all the shape associated to a matching row? if so why didn&#39;t you link the shape and the cells so that they are copied at the same time?"}, {"owner": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443605625, "post_id": 32861177, "comment_id": 53557893, "body": "didint work for me vincent - tryied that like first solution that comes to my mind."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1443605419, "creation_date": 1443605419, "answer_id": 32862597, "question_id": 32861177, "link": "https://stackoverflow.com/questions/32861177/excel-vba-specific-copy-paste-row-to-another-sheet-with-all-kind-of-shapes-if/32862597#32862597", "title": "excel vba - specific copy/paste row to another sheet with all kind of shapes if conditions are met", "body": "<p>There isn't enough information provided on the nature, position and relationship to the rows on the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa174301(v=office.11).aspx\" rel=\"nofollow\">Shape objects</a> so I had to make a few assumptions.</p>\n\n<pre><code>Sub test150929()\n    Dim DestSheet        As Worksheet\n    Dim Destsheet2       As Worksheet\n    Dim sRow       As Long     'row index on source worksheet\n    Dim dRow       As Long     'row index on destination worksheet\n    Dim sCount     As Long\n    Dim Range_to As Integer\n    Dim Cell As String\n    Dim oneShape As Shape\n    Dim myLeft As Single, myTop As Single\n    Dim dSHAPEs As Object, vSHAPE As Variant\n\n    Application.ScreenUpdating = False\n\n    sCount = 0\n    dRow = 16\n\n    Set DestSheet = Worksheets(\"odch.l.2\")\n    Set Destsheet2 = Worksheets(\"ot.2\")\n    Set dSHAPEs = CreateObject(\"Scripting.Dictionary\")\n\n    For Each oneShape In Destsheet2.Shapes\n        With oneShape\n            If Not dSHAPEs.exists(.Top) Then\n                dSHAPEs.Add Key:=.Top, Item:=Join(Array(.Name, .Top, .Left), Chr(124))\n            End If\n        End With\n     Next oneShape\n\n    With Destsheet2\n        Range_to = .Range(\"AM12\")\n        For sRow = 1 To Range_to\n            'use pattern matching to find \"X\" anywhere in cell\n            If LCase(.Cells(sRow, \"AD\").Value2) Like \"*x*\" Then\n                sCount = sCount + 1\n                dRow = dRow + 1\n                'copy cols A,F,E &amp; D\n                .Cells(sRow, \"A\").Resize(1, 39).Copy Destination:=DestSheet.Cells(dRow, \"A\")\n                If dSHAPEs.exists(.Cells(sRow, \"A\").Top) Then\n                    vSHAPE = Split(dSHAPEs.Item(.Cells(sRow, \"A\").Top), Chr(124))\n                    .Shapes(vSHAPE(0)).Copy\n                    With DestSheet\n                        .Paste\n                        With .Shapes(.Shapes.Count)\n                            .Top = .Parent.Cells(dRow, \"A\").Top\n                            .Left = Destsheet2.Shapes(vSHAPE(0)).Left\n                        End With\n                    End With\n                End If\n            End If\n        Next sRow\n    End With\n    MsgBox sCount &amp; \" Rows Copied\", vbInformation, \"Transfer Done\"\n\nEnd Sub\n</code></pre>\n\n<p>I've created a dictionary of the <code>.Top</code> dimension for each shape on the source worksheet. A dictionary uses a unique index, so the method I've chosen to identify the objects in the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa174305%28v=office.11%29.aspx\" rel=\"nofollow\">Shapes Collection</a> will not work if a) the shapes have a different <code>.Top</code> than the rows they are to copied with and b) there are more than a single shape to be copied for each row.</p>\n\n<p>With that said, the framework is sound and tested. If this is not working for you, perhaps you can adjust the method as you have more details available to you about the shapes. You might have to collect the shapes and their properties differently and then loop through each shape for every copied row and see if it should be copied along with the row. That's just speculation but I'm flying blind as far as the shapes go.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443679770, "post_id": 32863237, "comment_id": 53591548, "body": "works absolutly great man, BUT :-D there is problem with some merged cells - is there any way to copy cells with shapes and with formating of the cell?"}, {"owner": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443680512, "post_id": 32863237, "comment_id": 53591872, "body": "already looked up for method &quot;pastespecial&quot; with &quot;Paste:=xlPasteFormats&quot;, sadly i am noob and i am not really sure how to implemetn it in code above, when there is not &quot;copy / paste&quot; but &quot;copy without paste&quot; :-D anyone please?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443686047, "post_id": 32863237, "comment_id": 53594934, "body": "Are your merged cells over multiples rows?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443701171, "post_id": 32863237, "comment_id": 53603941, "body": "since your are copying full rows, merged columns should not be a problem, but merged rows might be. The only workaround I see is to <code>Select</code> the rows since it will Select all the rows linked by merged cells. See my updated answer."}, {"owner": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443704344, "post_id": 32863237, "comment_id": 53606150, "body": "maybe i am doing something wrong, but its not working. Data and shapes are still copied in same way like before. merged cels over rows are not copied at all"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443705265, "post_id": 32863237, "comment_id": 53606772, "body": "Could you show us how the merged cells are distributed over the range to copy?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443775310, "post_id": 32863237, "comment_id": 53635409, "body": "could you add the columns labels on the top of the image?"}, {"owner": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443780647, "post_id": 32863237, "comment_id": 53638069, "body": "ups, sorry. here you go <a href=\"http://i.stack.imgur.com/lQc0C.jpg\" rel=\"nofollow noreferrer\">i.stack.imgur.com/lQc0C.jpg</a> added red squares for examples of merged cells +there is hidden rows 1-14 so you could see labels"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443783203, "post_id": 32863237, "comment_id": 53639253, "body": "All tests I do here copy merged cells/rows without problems. If you execute <code>Worksheets(&quot;ot.2&quot;).Rows(28).Select</code>in the Immediate window, does it select both rows 28 and 29?"}, {"owner": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "edited": false, "score": 0, "creation_date": 1443786519, "post_id": 32863237, "comment_id": 53640890, "body": "not really sure, what is happening, but now i make it work :-D what kind of sorcery is this?! Thank you so much for your time man!"}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1443701378, "last_edit_date": 1443701378, "creation_date": 1443607280, "answer_id": 32863237, "question_id": 32861177, "link": "https://stackoverflow.com/questions/32861177/excel-vba-specific-copy-paste-row-to-another-sheet-with-all-kind-of-shapes-if/32863237#32863237", "title": "excel vba - specific copy/paste row to another sheet with all kind of shapes if conditions are met", "body": "<p>For my part the following code is working fine, assuming that the shapes are not higher than a row.</p>\n\n<pre><code>Public Sub test()\n    Dim sRange As Range\n    Dim dst As Worksheet, src As Worksheet\n    Dim dRow As Long, sRow As Long, lastRow As Long\n    Dim sCount As Long\n\n    Set dst = Worksheets(\"odch.l.2\") 'Destination worksheet\n    Set src = Worksheets(\"ot.2\") 'Source worksheet\n    sRow = 1 'Starting source row\n    dRow = 16 'Starting destination row\n    lastRow = 12 'Last row to copy\n\n    Dim shp As Shape\n    'Ensure Shapes are moved with cells\n    For Each shp In src.Shapes\n        shp.Placement = xlMove\n    Next shp\n\n    sCount = 0\n    For sRow = sRow To lastRow\n    If Cells(sRow, 30) Like \"*[Xx]*\" Then\n        src.Rows(sRow).Select 'Select current and all linked rows\n         Selection.Copy Destination:=dst.Rows(dRow)\n        'lookup to copy shape\n        sCount = sCount + 1 'should it count as 1 or more?\n        dRow = dRow + Selection.Rows.Count ' Move down by the number of rows in the selection\n        sRow = sRow + Selection.Rows.Count - 1 'Skip the linked rows so that we don't duplicate them\n    End If\n    Next sRow\n    MsgBox sCount &amp; \" Rows Copied\", vbInformation, \"Transfer Done\"\n    Set src = Nothing\n    Set dst = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5392035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57d0003f61415992b165dbd1cb0d1d1?s=128&d=identicon&r=PG&f=1", "display_name": "helloweenx", "link": "https://stackoverflow.com/users/5392035/helloweenx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 0, "accepted_answer_id": 32863237, "answer_count": 2, "score": 1, "last_activity_date": 1443701378, "creation_date": 1443601063, "question_id": 32861177, "link": "https://stackoverflow.com/questions/32861177/excel-vba-specific-copy-paste-row-to-another-sheet-with-all-kind-of-shapes-if", "title": "excel vba - specific copy/paste row to another sheet with all kind of shapes if conditions are met", "body": "<p>i have pretty specific situation. i need to copy every row from sheet1 (ot.2) to sheet2 (odch.l.2) if column \"AD\" in that row have in cell \"NOK\" mark \"x\" or \"X\". Shapes must stay with data.</p>\n\n<p>so far i managed to copy all shapes no matter if there is x or X, while data depends if there is x or X - BUT data and shapes are not sticked together - data are sorted right after another, and shapes are copied by position in source sheet</p>\n\n<p>i have no idea how to proceed, i am newbie in this matter and i would appreciate every kind of help.</p>\n\n<p>if you gonna need some more info, please let me know, i am gonna watch this thread all the time :-D thanks </p>\n\n<p>here is my code:</p>\n\n<pre><code> Sub test150929()\n\nApplication.ScreenUpdating = False\n\n    Dim DestSheet        As Worksheet\n    Dim Destsheet2       As Worksheet\n    Set DestSheet = Worksheets(\"odch.l.2\")\n    Set Destsheet2 = Worksheets(\"ot.2\")\n    Dim sRow       As Long     'row index on source worksheet\n    Dim dRow       As Long     'row index on destination worksheet\n    Dim sCount     As Long\n    Dim Range_to As Integer\n    Dim Cell As String\n    Dim oneShape As Shape\n    Dim myLeft As Single, myTop As Single\n\n    sCount = 0\n    dRow = 16\n\n\n            'DestSheet.Select\n            'Cell = Range(\"AM12\")\n            'Range(Cells(15, 1), Cells(Cell, 39)).Select\n\n\n            Destsheet2.Select\n            Cell = \"A15:AM\" &amp; Range(\"AM12\")\n            Range_to = Range(\"AM12\")\n\n            For Each oneShape In Destsheet2.Shapes\n         With oneShape\n             myLeft = .Left\n             myTop = .Top\n             .Copy\n         End With\n         With DestSheet\n             .Paste\n             With .Shapes(.Shapes.Count)\n                 .Top = myTop\n                 .Left = myLeft\n             End With\n         End With\n     Next oneShape\n\n\n    Destsheet2.Select\n            For sRow = 1 To Range_to\n                'use pattern matching to find \"X\" anywhere in cell\n                If Cells(sRow, \"AD\") Like \"*X*\" Then\n                    sCount = sCount + 1\n\n\n                    Cells(sRow, \"A\").Copy Destination:=DestSheet.Cells(dRow, \"A\")\n                    Cells(sRow, \"B\").Copy Destination:=DestSheet.Cells(dRow, \"B\")\n                    Cells(sRow, \"C\").Copy Destination:=DestSheet.Cells(dRow, \"C\")\n                    Cells(sRow, \"D\").Copy Destination:=DestSheet.Cells(dRow, \"D\")\n                    Cells(sRow, \"E\").Copy Destination:=DestSheet.Cells(dRow, \"E\")\n                    Cells(sRow, \"F\").Copy Destination:=DestSheet.Cells(dRow, \"F\")\n                    Cells(sRow, \"G\").Copy Destination:=DestSheet.Cells(dRow, \"G\")\n                    Cells(sRow, \"H\").Copy Destination:=DestSheet.Cells(dRow, \"H\")\n                    Cells(sRow, \"I\").Copy Destination:=DestSheet.Cells(dRow, \"I\")\n                    Cells(sRow, \"J\").Copy Destination:=DestSheet.Cells(dRow, \"J\")\n                    Cells(sRow, \"K\").Copy Destination:=DestSheet.Cells(dRow, \"K\")\n                    Cells(sRow, \"L\").Copy Destination:=DestSheet.Cells(dRow, \"L\")\n                    Cells(sRow, \"M\").Copy Destination:=DestSheet.Cells(dRow, \"M\")\n                    Cells(sRow, \"N\").Copy Destination:=DestSheet.Cells(dRow, \"N\")\n                    Cells(sRow, \"O\").Copy Destination:=DestSheet.Cells(dRow, \"O\")\n                    Cells(sRow, \"P\").Copy Destination:=DestSheet.Cells(dRow, \"P\")\n                    Cells(sRow, \"Q\").Copy Destination:=DestSheet.Cells(dRow, \"Q\")\n                    Cells(sRow, \"R\").Copy Destination:=DestSheet.Cells(dRow, \"R\")\n                    Cells(sRow, \"S\").Copy Destination:=DestSheet.Cells(dRow, \"S\")\n                    Cells(sRow, \"T\").Copy Destination:=DestSheet.Cells(dRow, \"T\")\n                    Cells(sRow, \"U\").Copy Destination:=DestSheet.Cells(dRow, \"U\")\n                    Cells(sRow, \"V\").Copy Destination:=DestSheet.Cells(dRow, \"V\")\n                    Cells(sRow, \"W\").Copy Destination:=DestSheet.Cells(dRow, \"W\")\n                    Cells(sRow, \"X\").Copy Destination:=DestSheet.Cells(dRow, \"X\")\n                    Cells(sRow, \"Y\").Copy Destination:=DestSheet.Cells(dRow, \"Y\")\n                    Cells(sRow, \"Z\").Copy Destination:=DestSheet.Cells(dRow, \"Z\")\n                    Cells(sRow, \"AA\").Copy Destination:=DestSheet.Cells(dRow, \"AA\")\n                    Cells(sRow, \"AB\").Copy Destination:=DestSheet.Cells(dRow, \"AB\")\n                    Cells(sRow, \"AC\").Copy Destination:=DestSheet.Cells(dRow, \"AC\")\n                    Cells(sRow, \"AD\").Copy Destination:=DestSheet.Cells(dRow, \"AD\")\n                    Cells(sRow, \"AE\").Copy Destination:=DestSheet.Cells(dRow, \"AE\")\n                    Cells(sRow, \"AF\").Copy Destination:=DestSheet.Cells(dRow, \"AF\")\n                    Cells(sRow, \"AG\").Copy Destination:=DestSheet.Cells(dRow, \"AG\")\n                    Cells(sRow, \"AH\").Copy Destination:=DestSheet.Cells(dRow, \"AH\")\n                    Cells(sRow, \"AI\").Copy Destination:=DestSheet.Cells(dRow, \"AI\")\n                    Cells(sRow, \"AJ\").Copy Destination:=DestSheet.Cells(dRow, \"AJ\")\n                    Cells(sRow, \"AK\").Copy Destination:=DestSheet.Cells(dRow, \"AK\")\n                    Cells(sRow, \"AL\").Copy Destination:=DestSheet.Cells(dRow, \"AL\")\n                    Cells(sRow, \"AM\").Copy Destination:=DestSheet.Cells(dRow, \"AM\")\n\n\n                End If\n\n                If Cells(sRow, \"AD\") Like \"*x*\" Then\n\n                    sCount = sCount + 1\n                    dRow = dRow + 1\n                    'copy cols A,F,E &amp; D\n                    Cells(sRow, \"A\").Copy Destination:=DestSheet.Cells(dRow, \"A\")\n                    Cells(sRow, \"B\").Copy Destination:=DestSheet.Cells(dRow, \"B\")\n                    Cells(sRow, \"C\").Copy Destination:=DestSheet.Cells(dRow, \"C\")\n                    Cells(sRow, \"D\").Copy Destination:=DestSheet.Cells(dRow, \"D\")\n                    Cells(sRow, \"E\").Copy Destination:=DestSheet.Cells(dRow, \"E\")\n                    Cells(sRow, \"F\").Copy Destination:=DestSheet.Cells(dRow, \"F\")\n                    Cells(sRow, \"G\").Copy Destination:=DestSheet.Cells(dRow, \"G\")\n                    Cells(sRow, \"H\").Copy Destination:=DestSheet.Cells(dRow, \"H\")\n                    Cells(sRow, \"I\").Copy Destination:=DestSheet.Cells(dRow, \"I\")\n                    Cells(sRow, \"J\").Copy Destination:=DestSheet.Cells(dRow, \"J\")\n                    Cells(sRow, \"K\").Copy Destination:=DestSheet.Cells(dRow, \"K\")\n                    Cells(sRow, \"L\").Copy Destination:=DestSheet.Cells(dRow, \"L\")\n                    Cells(sRow, \"M\").Copy Destination:=DestSheet.Cells(dRow, \"M\")\n                    Cells(sRow, \"N\").Copy Destination:=DestSheet.Cells(dRow, \"N\")\n                    Cells(sRow, \"O\").Copy Destination:=DestSheet.Cells(dRow, \"O\")\n                    Cells(sRow, \"P\").Copy Destination:=DestSheet.Cells(dRow, \"P\")\n                    Cells(sRow, \"Q\").Copy Destination:=DestSheet.Cells(dRow, \"Q\")\n                    Cells(sRow, \"R\").Copy Destination:=DestSheet.Cells(dRow, \"R\")\n                    Cells(sRow, \"S\").Copy Destination:=DestSheet.Cells(dRow, \"S\")\n                    Cells(sRow, \"T\").Copy Destination:=DestSheet.Cells(dRow, \"T\")\n                    Cells(sRow, \"U\").Copy Destination:=DestSheet.Cells(dRow, \"U\")\n                    Cells(sRow, \"V\").Copy Destination:=DestSheet.Cells(dRow, \"V\")\n                    Cells(sRow, \"W\").Copy Destination:=DestSheet.Cells(dRow, \"W\")\n                    Cells(sRow, \"X\").Copy Destination:=DestSheet.Cells(dRow, \"X\")\n                    Cells(sRow, \"Y\").Copy Destination:=DestSheet.Cells(dRow, \"Y\")\n                    Cells(sRow, \"Z\").Copy Destination:=DestSheet.Cells(dRow, \"Z\")\n                    Cells(sRow, \"AA\").Copy Destination:=DestSheet.Cells(dRow, \"AA\")\n                    Cells(sRow, \"AB\").Copy Destination:=DestSheet.Cells(dRow, \"AB\")\n                    Cells(sRow, \"AC\").Copy Destination:=DestSheet.Cells(dRow, \"AC\")\n                    Cells(sRow, \"AD\").Copy Destination:=DestSheet.Cells(dRow, \"AD\")\n                    Cells(sRow, \"AE\").Copy Destination:=DestSheet.Cells(dRow, \"AE\")\n                    Cells(sRow, \"AF\").Copy Destination:=DestSheet.Cells(dRow, \"AF\")\n                    Cells(sRow, \"AG\").Copy Destination:=DestSheet.Cells(dRow, \"AG\")\n                    Cells(sRow, \"AH\").Copy Destination:=DestSheet.Cells(dRow, \"AH\")\n                    Cells(sRow, \"AI\").Copy Destination:=DestSheet.Cells(dRow, \"AI\")\n                    Cells(sRow, \"AJ\").Copy Destination:=DestSheet.Cells(dRow, \"AJ\")\n                    Cells(sRow, \"AK\").Copy Destination:=DestSheet.Cells(dRow, \"AK\")\n                    Cells(sRow, \"AL\").Copy Destination:=DestSheet.Cells(dRow, \"AL\")\n                    Cells(sRow, \"AM\").Copy Destination:=DestSheet.Cells(dRow, \"AM\")\n\n\n\n                End If\n            Next sRow\n    MsgBox sCount &amp; \" Rows Copied\", vbInformation, \"Transfer Done\"\n\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "mkdir"], "comments": [{"owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "edited": false, "score": 0, "creation_date": 1443603189, "post_id": 32861113, "comment_id": 53556282, "body": "Yo can create with one XLSM file as many XLSX files as you wish. Yet, saving the macro in the new XLSX is not possible."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "edited": false, "score": 0, "creation_date": 1443603628, "post_id": 32861113, "comment_id": 53556604, "body": "@Balinti: I don&#39;t see Swi asking for a solution where a macro is saved in an XLSX file. But I am also a bit hazy as to what he/she wants. In the title is <code>.xls</code> which would indicate that old Excel file formats should be created. At the same time the code suggests to save the new workbooks as <code>.xlsm</code>. So, what is it now?"}, {"owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "reply_to_user": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "edited": false, "score": 0, "creation_date": 1443616042, "post_id": 32861113, "comment_id": 53564175, "body": "@Balinti do you have an idea how i can stop it from closing itself?"}, {"owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "edited": false, "score": 0, "creation_date": 1443616380, "post_id": 32861113, "comment_id": 53564420, "body": "After the saving as you can activate the xlsm once again."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "edited": false, "score": 0, "creation_date": 1443608782, "post_id": 32862730, "comment_id": 53559693, "body": "What does this do? <code>SheetToExport = Range(&quot;A1&quot;).Value &#39;Or specify UserForm output</code>"}, {"owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "edited": false, "score": 0, "creation_date": 1443609455, "post_id": 32862730, "comment_id": 53560108, "body": "At first thank you really much, i appreciate that.  It works almost perfectly, the problem that i have is that it exports all sheets, it only should export the one sheet, the form/template.. how to :o"}, {"owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "edited": false, "score": 0, "creation_date": 1443612765, "post_id": 32862730, "comment_id": 53562012, "body": "I don&#39;t want that it always closes the file.... how can i stop that? And when i reopen the <code>.xlsm</code> file it asks me every time if i want to update, how can i stop this to?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "edited": false, "score": 0, "creation_date": 1443615983, "post_id": 32862730, "comment_id": 53564132, "body": "1. <code>SheetToExport = Range(&quot;A1&quot;).Value</code> is to specify where you are going to take the information (the name of the sheet you want to export) 2. It should export only the sheet that you name in the argument <code>SheetToExport</code> 3. See edit for closing file or not 4. For links update, it depends what you exported, if the sheet that you copy has formulas in it, you should add <code>WbCopy.Sheets(1).Cells.Copy : WbCopy.Sheets(1).Cells.PasteSpecial Paste:=xlPasteValues</code> before saving. And if you want to turn the notifications off, just google it, you&#39;ll find (I don&#39;t remember how to do it)"}, {"owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "edited": false, "score": 0, "creation_date": 1443620864, "post_id": 32862730, "comment_id": 53567551, "body": "Thank you really much everything works great now! wunderful!"}, {"owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "edited": false, "score": 0, "creation_date": 1443680662, "post_id": 32862730, "comment_id": 53591943, "body": "There is only one question left. In the exportet file the button stays, how can i not save the button? (The button also exports kind of..)"}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 0, "creation_date": 1478183539, "post_id": 32862730, "comment_id": 68058448, "body": "after you copy the sheet, and before you save the book, wbcopy.oleobjects (buttonname).delete"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1443615842, "last_edit_date": 1443615842, "creation_date": 1443605767, "answer_id": 32862730, "question_id": 32861113, "link": "https://stackoverflow.com/questions/32861113/creating-folders-and-new-xlsx-file-with-macro-from-template-like-xlsm-file/32862730#32862730", "title": "Creating folders and new *.xlsx file with macro from template like xlsm file", "body": "<p>Be careful on your variable declaration!</p>\n\n<p>The way you did it in your OP (original post) : </p>\n\n<p><code>strFilename</code>, <code>strDirname</code> and <code>strPathname</code> are declared as <code>Variant</code> and not as <code>String</code>.</p>\n\n<p>You can still use them BUT it'll take much more memory and can be issue if you use them as arguments.</p>\n\n<hr>\n\n<p>See the code :</p>\n\n<pre><code>Dim strFilename As String, _\n    strDirname As String, _\n    strPathname As String, _\n    strDefpath As String, _\n    SheetToExport As String, _\n    WbMaster As Workbook, _\n    WbCopy As Workbook\n\n\nOn Error Resume Next ' If directory exist goto next line\nstrDirname = Range(\"D81\").Value ' New directory name\nstrFilename = Range(\"D8\").Value 'New file name\n\nSet WbMaster = Application.ActiveWorkbook\nSheetToExport = Range(\"A1\").Value 'Or specify UserForm output\n\nstrDefpath = WbMaster.Path 'Default path name\n\nIf IsEmpty(strDirname) Then Exit Sub\nIf IsEmpty(strFilename) Then Exit Sub\n\nMkDir strDefpath &amp; \"\\\" &amp; strDirname\nstrPathname = strDefpath &amp; \"\\\" &amp; strDirname &amp; \"\\\" &amp; strFilename 'create total string\n\nWbMaster.Sheets(SheetToExport).Copy\nSet WbCopy = Application.ActiveWorkbook\n\nWbCopy.SaveAs Filename:=strPathname &amp; \".xlsx\", _\n                FileFormat:=xlOpenXMLWorkbook, Password:=\"\", WriteResPassword:=\"\", _\n                ReadOnlyRecommended:=False, CreateBackup:=False\n\nClosingWb = MsgBox(\"Do you wish to close the exported file?\",vbYesNo,\"Close exported file\")\nIf ClosingWb &lt;&gt; vbNo Then WbCopy.Close\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 5325288, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e0f9a5611b80af452e9343e6c9640353?s=128&d=identicon&r=PG&f=1", "display_name": "Swi", "link": "https://stackoverflow.com/users/5325288/swi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1761, "favorite_count": 0, "accepted_answer_id": 32862730, "answer_count": 1, "score": 2, "last_activity_date": 1443615842, "creation_date": 1443600823, "last_edit_date": 1443613327, "question_id": 32861113, "link": "https://stackoverflow.com/questions/32861113/creating-folders-and-new-xlsx-file-with-macro-from-template-like-xlsm-file", "title": "Creating folders and new *.xlsx file with macro from template like xlsm file", "body": "<p>I have this code that <strong>creates a folder and a saves the actual file in it, but i want that it only saves a copy with only one sheet in it</strong>. So that the file with the code works like a template...</p>\n\n<p>You write your stuff and press the button and it saves an .xlsx file with one sheet (the sheet with the form) in the new created folder... so you could do this with hundreds of files an folders.</p>\n\n<p>So in the end it should work like this: </p>\n\n<ol>\n<li>You open the .xlsm file where the code below is in.  </li>\n<li>You got to sheets one FORM (what should be \"exported\" later on) and\na list where you copy stuff in the form.</li>\n<li>When you filled the form and press the button and it saves the Form\nsheet in the new folder as .xlsx and you can continue in the .xlsm\nfile.</li>\n</ol>\n\n<p>If it's unclear for you please ask.</p>\n\n<p>The code i have now</p>\n\n<pre><code>Sub Macro1()\nDim strFilename, strDirname, strPathname, strDefpath As String\nOn Error Resume Next ' If directory exist goto next line\nstrDirname = Range(\"D81\").Value ' New directory name\n\nstrFilename = Range(\"D8\").Value 'New file name\nstrDefpath = Application.ActiveWorkbook.Path 'Default path name\nIf IsEmpty(strDirname) Then Exit Sub\nIf IsEmpty(strFilename) Then Exit Sub\n\nMkDir strDefpath &amp; \"\\\" &amp; strDirname\nstrPathname = strDefpath &amp; \"\\\" &amp; strDirname &amp; \"\\\" &amp; strFilename 'create total string\n\nActiveWorkbook.SaveAs Filename:=strPathname &amp; \".xlsm\", _\nFileFormat:=xlOpenXMLWorkbookMacroEnabled, Password:=\"\", WriteResPassword:=\"\", _\nReadOnlyRecommended:=False, CreateBackup:=False\nEnd Sub\n</code></pre>\n\n<p>Problem here is i have Names for the forms that are like 1102,1103 an going on like that. the next step is that there are files with the name 1102_1 and 1102_2 and they both should go in the folder 1102 ...</p>\n\n<p>It's a bit out of my knownledge please help me guys :) greets</p>\n\n<p>Now i am using this code below\nProblem is that it always closes the <code>xlsm</code> file what really annoyes and when i reopen it it wants to update the file i need to remove that but i don't know how :/... and it only should export/save one special sheet</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim strFilename As String, _\nstrDirname As String, _\nstrPathname As String, _\nstrDefpath As String, _\nSheetToExport As String, _\nWbMaster As Workbook, _\nWbCopy As Workbook\n\n\nOn Error Resume Next ' If directory exist goto next line\nstrDirname = Range(\"W12\").Value ' New directory name\nstrFilename = Range(\"D8\").Value 'New file name\n\nSet WbMaster = Application.ActiveWorkbook\nSheetToExport = Range(\"A1\").Value 'Or specify UserForm output\n\nstrDefpath = WbMaster.Path 'Default path name\n\nIf IsEmpty(strDirname) Then Exit Sub\nIf IsEmpty(strFilename) Then Exit Sub\n\nMkDir strDefpath &amp; \"\\\" &amp; strDirname\nstrPathname = strDefpath &amp; \"\\\" &amp; strDirname &amp; \"\\\" &amp; strFilename 'create total string\n\nWbMaster.Sheets(SheetToExport).Copy\nSet WbCopy = Application.ActiveWorkbook\n\nWbCopy.SaveAs Filename:=strPathname &amp; \".xlsx\", _\n                FileFormat:=xlOpenXMLWorkbook, Password:=\"\", WriteResPassword:=\"\", _\n                ReadOnlyRecommended:=False, CreateBackup:=False\n\nWbCopy.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "scripting", "highlight"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1443600338, "post_id": 32860792, "comment_id": 53554598, "body": "If the Excel data is the result of an SQL query, I&#39;d recommend sculpting the T-SQL with a subquery or partition that delivers the results along with the rest of the data."}, {"owner": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "edited": false, "score": 0, "creation_date": 1443614341, "post_id": 32860792, "comment_id": 53563045, "body": "The messages column can have more than one key phrase that is present in the first column. E,g, if the key phrase is say &quot; this is to be tested&quot; , then this string can occur in messages column as substring in many rows. e.g &quot;hello world; this is to be tested; and this also is being tested;&quot;. this sort of values are available in column B."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1443615528, "post_id": 32860792, "comment_id": 53563825, "body": "Yes, that is what a sub-query does in a SELECT statement."}], "answers": [{"comments": [{"owner": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "edited": false, "score": 0, "creation_date": 1443614396, "post_id": 32862444, "comment_id": 53563084, "body": "Could you please help me understand this.sorry i am not a frequent user of excel."}, {"owner": {"reputation": 1322, "user_id": 5308054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d20aa4d7553a178d0720ff4289b2715f?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Polyakov", "link": "https://stackoverflow.com/users/5308054/dmitry-polyakov"}, "reply_to_user": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "edited": false, "score": 0, "creation_date": 1443620233, "post_id": 32862444, "comment_id": 53567098, "body": "<code>B:B</code> is a refering to the entire column B, where you have the messages. The formula will look over it. <code>A2</code> is a refering to the cell in the second row of the column A where you have the key. Asterisk(<code>*</code>) is a wildcard for searching. Ampersand (&amp;) is an operator for concatenating strings. F. e., if you have a key &quot;excel&quot; in the column A and a message &quot;Excel 2016 is compatible with Windows 10&quot; in the column B, you need to build search pattern <code>*excel*</code>. That&#39;s why you use the string parts <code>&quot;*&quot;</code> in the start and the end of your formula parameter. And you concatenate it with the key using <code>&amp;</code>."}, {"owner": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "edited": false, "score": 0, "creation_date": 1443655896, "post_id": 32862444, "comment_id": 53585573, "body": "Thanks, But sorry, I have one doubt. Will this be comparing only one element that is A2 with entire column B:B?. I need to compare all values of column A with all values of coulmn B."}, {"owner": {"reputation": 1322, "user_id": 5308054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d20aa4d7553a178d0720ff4289b2715f?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Polyakov", "link": "https://stackoverflow.com/users/5308054/dmitry-polyakov"}, "reply_to_user": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "edited": false, "score": 0, "creation_date": 1443701775, "post_id": 32862444, "comment_id": 53604396, "body": "@Megan, try insert the formula <code>=(SUMPRODUCT(LEN(B:B))-SUMPRODUCT(LEN(SUBSTITUTE(B:B;A2;&quot;&quot;))&zwnj;&#8203;))&#47;LEN(A2)</code> into the cell C2 and then expand it down"}], "tags": [], "owner": {"reputation": 1322, "user_id": 5308054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d20aa4d7553a178d0720ff4289b2715f?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Polyakov", "link": "https://stackoverflow.com/users/5308054/dmitry-polyakov"}, "is_accepted": false, "score": 0, "last_activity_date": 1443604959, "creation_date": 1443604959, "answer_id": 32862444, "question_id": 32860792, "link": "https://stackoverflow.com/questions/32860792/count-and-highlight-keywords-within-phrases/32862444#32862444", "title": "Count and Highlight keywords within phrases", "body": "<p>You can use this formula <code>COUNTIF(B:B;\"*\"&amp;A2&amp;\"*\")</code> starting from the second row.</p>\n"}, {"comments": [{"owner": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "edited": false, "score": 0, "creation_date": 1443670883, "post_id": 32878493, "comment_id": 53588904, "body": "This is awesome. Thanks a lot for the reply. It works perfectly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "edited": false, "score": 0, "creation_date": 1443671060, "post_id": 32878493, "comment_id": 53588950, "body": "That&#39;s great to hear. I had to make some assumptions during the process but it seems that I guessed right."}, {"owner": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "edited": false, "score": 0, "creation_date": 1443673074, "post_id": 32878493, "comment_id": 53589426, "body": "One more help required. Some of the key phrases have some dates and numbers, which in the original message may vary but the rest of the message remains same. e.g the key phrase is &quot;Id creation xx-xx-xx fails&quot; and the message is &quot;Id creation 9823023 fails&quot;. Could you please help me in this that it ignores the number while matching."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "edited": false, "score": 0, "creation_date": 1443697443, "post_id": 32878493, "comment_id": 53601694, "body": "Adding that functionality would mean involving RegEx (Regular Expression) and some fuzzy logic. In short, that would break this effort and require a complete rewrite. Given that a lack of sample keywords and phrases led to this shortcoming, why not <a href=\"http://stackoverflow.com/help/someone-answers\">close off this question</a> and initiate another where you can outline the new requirements. You might even drop off a quick comment here regarding the new question as I have some ideas on how to proceed."}, {"owner": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "edited": false, "score": 0, "creation_date": 1443750720, "post_id": 32878493, "comment_id": 53627559, "body": "I can not post another question for next one week :("}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "edited": false, "score": 0, "creation_date": 1443752308, "post_id": 32878493, "comment_id": 53627948, "body": "Sorry to say, but that might have something to do with your posting history. Typically, you seem to abandon a question after receiving an answer. Accepting one of the replies as your &#39;Accepted Answer&#39; by clicking the checkmark found in the left-hand alley beside the best answer and marking one or more as &#39;Helpful&#39; by clicking the \u25b2 helps build both your site reputation and the people answering your inquiries. See <a href=\"http://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>. More reputation means that you can post more questions."}, {"owner": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "edited": false, "score": 0, "creation_date": 1444042585, "post_id": 32878493, "comment_id": 53718641, "body": "I have raised another question. This is the link. please check: <a href=\"https://stackoverflow.com/questions/32946884/pattern-matching-in-excel\" title=\"pattern matching in excel\">stackoverflow.com/questions/32946884/pattern-matching-in-exc&zwnj;&#8203;el</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "edited": false, "score": 0, "creation_date": 1444104977, "post_id": 32878493, "comment_id": 53748161, "body": "See my reply involving RegEx pattern matching <a href=\"https://stackoverflow.com/questions/32946884/pattern-matching-in-excel/32960315#32960315\">here</a>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1443666263, "creation_date": 1443666263, "answer_id": 32878493, "question_id": 32860792, "link": "https://stackoverflow.com/questions/32860792/count-and-highlight-keywords-within-phrases/32878493#32878493", "title": "Count and Highlight keywords within phrases", "body": "<p>It's possible that you might be able to collect an efficient count with a module sub procedure that performs all of the maths in memory arrays\u00b9 and returns the counts to the worksheet.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/CgevX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CgevX.png\" alt=\"Counts keywords in phrases sample data\"></a></p>\n\n<p>I've used some standard <a href=\"http://lipsum.com/\" rel=\"nofollow noreferrer\">Lorem Ipsum</a> keywords and phrases to create the above sample data.</p>\n\n<p>Tap <kbd>Alt</kbd>+<kbd>F11</kbd> and when the VBE opens, immediately use the pull-down menus to Insert \u25ba Module (<kbd>Alt</kbd>+<kbd>I</kbd>,<kbd>M</kbd>). Paste the following into the new module code sheet titled something like <em>Book1 - Module1 (Code)</em>.</p>\n\n<pre><code>Option Explicit\n\nSub count_strings_inside_strings()\n    Dim rw As Long, lr As Long\n    Dim k As Long, p As Long, vKEYs As Variant, vPHRASEs As Variant, vCOUNTs As Variant\n\n    ReDim vKEYs(0)\n    ReDim vPHRASEs(0)\n\n    With Worksheets(\"Sheet1\")   '&lt;~~ set to the correct worksheet name\\\n        'populate the vKEYs array\n        For rw = 2 To .Cells(Rows.Count, 1).End(xlUp).Row\n            vKEYs(UBound(vKEYs)) = LCase(.Cells(rw, 1).Value2)\n            ReDim Preserve vKEYs(UBound(vKEYs) + 1)\n        Next rw\n        ReDim Preserve vKEYs(UBound(vKEYs) - 1)\n\n        'populate the vPHRASEs array\n        For rw = 2 To .Cells(Rows.Count, 2).End(xlUp).Row\n            vPHRASEs(UBound(vPHRASEs)) = LCase(.Cells(rw, 2).Value2)\n            ReDim Preserve vPHRASEs(UBound(vPHRASEs) + 1)\n        Next rw\n        ReDim Preserve vPHRASEs(UBound(vPHRASEs) - 1)\n        ReDim vCOUNTs(0 To UBound(vPHRASEs))\n\n        'perform the counts\n        For p = LBound(vPHRASEs) To UBound(vPHRASEs)\n            For k = LBound(vKEYs) To UBound(vKEYs)\n                vCOUNTs(p) = CInt(vCOUNTs(p)) + _\n                    (Len(vPHRASEs(p)) - Len(Replace(vPHRASEs(p), vKEYs(k), vbNullString))) / Len(vKEYs(k))\n            Next k\n        Next p\n\n        'return the counts to the worksheet\n        .Cells(2, 3).Resize(UBound(vCOUNTs) + 1, 1) = Application.Transpose(vCOUNTs)\n\n        'run the helper procedure to Blue|Bold all of the found keywords within the phrases\n        Call key_in_phrase_helper(vKEYs, .Range(.Cells(2, 2), .Cells(Rows.Count, 2).End(xlUp)))\n\n    End With\nEnd Sub\n\nSub key_in_phrase_helper(vKYs As Variant, rPHRSs As Range)\n    Dim p As Long, r As Long, v As Long\n\n    With rPHRSs\n        For r = 1 To rPHRSs.Rows.Count\n            .Cells(r, 1) = .Cells(r, 1).Value2\n            For v = LBound(vKYs) To UBound(vKYs)\n                p = 0\n                Do While CBool(InStr(p + 1, .Cells(r, 1).Value2, vKYs(v), vbTextCompare))\n                    p = InStr(p + 1, .Cells(r, 1).Value2, vKYs(v), vbTextCompare)\n                    Debug.Print vKYs(v)\n                    With .Cells(r, 1).Characters(Start:=p, Length:=Len(vKYs(v))).Font\n                        .Bold = True\n                        .ColorIndex = 5\n                    End With\n                Loop\n            Next v\n        Next r\n    End With\nEnd Sub\n</code></pre>\n\n<p>You may have to rename the worksheet to be processed in the 5<sup>th</sup> code line. I've also included a helper routine that identifies the key words within the phrases with a Blue|Bold font. Comment out or delete the <code>Call key_in_phrase_helper(...)</code> line at the bottom of the first sub procedure if this is not desired.</p>\n\n<p>Tap <kbd>Alt</kbd>+<kbd>Q</kbd> to return to your worksheet. Tap <kbd>Alt</kbd>+<kbd>F8</kbd> to open the <strong>Macros</strong> dialog and <kbd>Run</kbd> the sub procedure. If you data resembles the sample data I've put together then you should have similar results.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/RAAM7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RAAM7.png\" alt=\"Counts keys in phrases\"></a></p>\n\n<hr>\n\n<p>\u00b9 <sub>These are some advanced methods but I feel that they are also the best way to tackle your problem. If you have <strong>specific questions</strong> that your own research does not adequately explain, I will try to address them in the Comments section. The sample workbook I created to create this solution can be made available on request.</sub></p>\n"}], "owner": {"reputation": 649, "user_id": 3330733, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/18bb3afcac8bdaeac2b71aa7c0842a11?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/3330733/megan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 1, "accepted_answer_id": 32878493, "answer_count": 2, "score": 3, "last_activity_date": 1472276864, "creation_date": 1443599753, "last_edit_date": 1472276864, "question_id": 32860792, "link": "https://stackoverflow.com/questions/32860792/count-and-highlight-keywords-within-phrases", "title": "Count and Highlight keywords within phrases", "body": "<p>I have an excel sheet with two columns. The first column is the key phrase and the second is the messages. The key phrase may occur in the messages column. I need to know how many times a key phrase has occurred in messages column. please suggest some good and easy way of finding.</p>\n\n<p>The key phrase is one column and the messages is the second column. The messages column is combination (concatenation) of 1 or more than 1 key phrases. I need to find out that how many key phrases does each message contain.</p>\n"}, {"tags": ["vba", "validation", "popup"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5391975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653e8a33698f88369ddacc89ae3058?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis", "link": "https://stackoverflow.com/users/5391975/yanis"}, "edited": false, "score": 0, "creation_date": 1443602107, "post_id": 32860937, "comment_id": 53555597, "body": "A.S.H thanks for your reply, but even when adding the Nothing did not change anything, same error again.  I further changed the code to your suggestion and I can now run my previous macro, but still I dont get the Pop Up Warning/Message I want when I change the cell value.  Private Sub Worksheet_Change(ByVal Target As Range) On Error GoTo finish Dim myRange As Range myRange = Range(&quot;E16:DW39&quot;) &#39;-&gt; Mission Mix Table If Intersect(myRange, Target) Is Nothing Then Application.EnableEvents = False MsgBox &quot;Mission Plan is not maching&quot; End If finish: Application.EnableEvents = True End Sub"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 5391975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653e8a33698f88369ddacc89ae3058?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis", "link": "https://stackoverflow.com/users/5391975/yanis"}, "edited": false, "score": 0, "creation_date": 1443602280, "post_id": 32860937, "comment_id": 53555688, "body": "@Yanis I see, it is because you should use Set for objects : <code>Set myRange = Range(&quot;E16:DW39&quot;)</code>  (edited the answer)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 5391975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653e8a33698f88369ddacc89ae3058?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis", "link": "https://stackoverflow.com/users/5391975/yanis"}, "edited": false, "score": 0, "creation_date": 1443602560, "post_id": 32860937, "comment_id": 53555861, "body": "@Yanis, you want to call you subroutine if the target and the range do overlap, and the message box if not, did I understand correctly?"}, {"owner": {"reputation": 1, "user_id": 5391975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653e8a33698f88369ddacc89ae3058?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis", "link": "https://stackoverflow.com/users/5391975/yanis"}, "edited": false, "score": 0, "creation_date": 1443602781, "post_id": 32860937, "comment_id": 53556010, "body": "I don\u2019t want to call any subroutine. The subroutine is executed at a click of a button, but it was prevented before your suggestion."}, {"owner": {"reputation": 1, "user_id": 5391975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653e8a33698f88369ddacc89ae3058?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis", "link": "https://stackoverflow.com/users/5391975/yanis"}, "edited": false, "score": 0, "creation_date": 1443602947, "post_id": 32860937, "comment_id": 53556115, "body": "Still the Pop Up Message does not work, is this related to the fact that the Cell is using a LIST of values, therefore cannot identify that the displayed value has changed? Only guessing here."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 5391975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653e8a33698f88369ddacc89ae3058?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis", "link": "https://stackoverflow.com/users/5391975/yanis"}, "edited": false, "score": 0, "creation_date": 1443603089, "post_id": 32860937, "comment_id": 53556211, "body": "No, the event should be triggered even if the cell is picked through a list. But the doubt i have is, if you change the cells inside your range, the msgbox will not popup because the If condition is not met. try inverting the condition? (if Not...)"}, {"owner": {"reputation": 1, "user_id": 5391975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653e8a33698f88369ddacc89ae3058?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis", "link": "https://stackoverflow.com/users/5391975/yanis"}, "edited": false, "score": 0, "creation_date": 1443603390, "post_id": 32860937, "comment_id": 53556420, "body": "A.S.H Apologies, I missed the If NOT, it works as I wanted to BUT when I run my independent Macro (the second way to copy data) I get the Message at every change which is not good as you can imagine, any ideas? Thanks for your time."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 5391975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653e8a33698f88369ddacc89ae3058?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis", "link": "https://stackoverflow.com/users/5391975/yanis"}, "edited": false, "score": 0, "creation_date": 1443603516, "post_id": 32860937, "comment_id": 53556519, "body": "This is supposed to be the role of <code>Appllication.EnableEvents=False</code>. Are you sure you are setting this statement when entering the routine? I mean, at the entry of the routine, add <code>Application.EnableEvents=False</code>, and at the exit, add <code>Application.EnableEvents=true</code>."}, {"owner": {"reputation": 1, "user_id": 5391975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653e8a33698f88369ddacc89ae3058?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis", "link": "https://stackoverflow.com/users/5391975/yanis"}, "edited": false, "score": 0, "creation_date": 1443603676, "post_id": 32860937, "comment_id": 53556634, "body": "A.S.H, found the solution (as you have already said so in your first comment). Thanks again for your time."}, {"owner": {"reputation": 1, "user_id": 5391975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653e8a33698f88369ddacc89ae3058?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis", "link": "https://stackoverflow.com/users/5391975/yanis"}, "edited": false, "score": 0, "creation_date": 1443604425, "post_id": 32860937, "comment_id": 53557129, "body": "A.S.H, is there any way to store the initial Cell value, and only if the value is different to that, only then show the message, e.g. lets say that the initial cell value if &quot;F&quot; and I change to &quot;D&quot;, then I get the Message, but if I &quot;change&quot; to &quot;F&quot; then I shouldn&#39;t. Just noticed this detail, that even if I click on the same value from the dropdown menu, I still get the Message. I know not big issue, but nice to have. Thanks again for your wisdom sharing."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 5391975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653e8a33698f88369ddacc89ae3058?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis", "link": "https://stackoverflow.com/users/5391975/yanis"}, "edited": false, "score": 0, "creation_date": 1443604819, "post_id": 32860937, "comment_id": 53557411, "body": "That is a little bit more complicated. The answer is here:<a href=\"http://stackoverflow.com/questions/4668410/how-do-i-get-the-old-value-of-a-changed-cell-in-excel-vba\" title=\"how do i get the old value of a changed cell in excel vba\">stackoverflow.com/questions/4668410/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 5391975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653e8a33698f88369ddacc89ae3058?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis", "link": "https://stackoverflow.com/users/5391975/yanis"}, "edited": false, "score": 0, "creation_date": 1443605233, "post_id": 32860937, "comment_id": 53557668, "body": "Thanks, I will have a look."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1443603727, "last_edit_date": 1443603727, "creation_date": 1443600235, "answer_id": 32860937, "question_id": 32860661, "link": "https://stackoverflow.com/questions/32860661/message-when-a-cell-list-values-value-is-changed/32860937#32860937", "title": "Message when a cell (List values) value is changed", "body": "<p>The error code is because you are referencing an null object when the two ranges dont intersect. Fix:</p>\n\n<pre><code>If Intersect(myRange, Target) Is Nothing then...\n</code></pre>\n\n<p>If you want to process changes that happen only from Excel GUI and not from code, The usual approach is to use <code>Application.EnableEvents = False</code> at the beginning of your macros, then <code>Application.EnableEvents = true</code> at the end of the macro. This way, any change made inside the macro will not toggle event handling.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n        On Error goto finish\n        Dim myRange As Range\n\n        Set myRange = Range(\"E16:DW39\") ' &lt;~~ dont forget \"Set\"\n        If Not Intersect(myRange, Target) Is Nothing Then\n            MsgBox ...\n        End If\n    finish:\n        Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5391975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653e8a33698f88369ddacc89ae3058?s=128&d=identicon&r=PG&f=1", "display_name": "Yanis", "link": "https://stackoverflow.com/users/5391975/yanis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 781, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443603727, "creation_date": 1443599316, "last_edit_date": 1443599615, "question_id": 32860661, "link": "https://stackoverflow.com/questions/32860661/message-when-a-cell-list-values-value-is-changed", "title": "Message when a cell (List values) value is changed", "body": "<p>I am relatively new to VBA.</p>\n\n<p>I have a table <code>Range(E16:DW39)</code>, where each Cell has a dropdown menu <code>(Data Validation = List)</code> to pick a value manually BUT at the same time I have a Macro to copy data from another worksheet (two ways to populate the table).</p>\n\n<p>I want to get a Message every time the user changes any cell value <strong><em>Manually</em></strong>. </p>\n\n<p>I want to be able to still run the Macro (as I noticed that I cannot after adding the following code) independently. This Intersect check I want it only for the manual data input.</p>\n\n<p>In order to do this check I have the following code (in the specific Sheet):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n------------------------------------------------------\nDim myRange As Range\n\nmyRange = Range(\"E16:DW39\") '-&gt; Mission Mix Table\n\nIf Intersect(myRange, Target) Then\n\nMsgBox \"Mission Plan is not matching with this change\"\n\nEnd If\n\nEnd Sub\n------------------------------------------------\n</code></pre>\n\n<p>I get the following ERROR </p>\n\n<blockquote>\n  <p>Run-Time Error 91: Object variable or With block variable not set</p>\n</blockquote>\n\n<p>When I tried to change a cell value to another one from the dropdown menu, I get the above ERROR, any idea how to solve this problem?</p>\n\n<p>Please notice that due to this code I cannot run my previously running fine Copy macro.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 175, "user_id": 1934827, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAvq5.jpg?s=128&g=1", "display_name": "EyePeaSea", "link": "https://stackoverflow.com/users/1934827/eyepeasea"}, "edited": false, "score": 0, "creation_date": 1443595461, "post_id": 32859310, "comment_id": 53551958, "body": "Hi haven&#39;t tried your code and so don&#39;t know <i>why</i> you&#39;re getting a border.  But can&#39;t you just remove the border after you copy the range?  See:  <a href=\"http://stackoverflow.com/questions/6974965/how-to-remove-borders-from-cells-in-a-range-in-excel-using-vb-net\" title=\"how to remove borders from cells in a range in excel using vb net\">stackoverflow.com/questions/6974965/&hellip;</a> - Ian"}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "reply_to_user": {"reputation": 175, "user_id": 1934827, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAvq5.jpg?s=128&g=1", "display_name": "EyePeaSea", "link": "https://stackoverflow.com/users/1934827/eyepeasea"}, "edited": false, "score": 0, "creation_date": 1443595563, "post_id": 32859310, "comment_id": 53552004, "body": "I could remove the border but the user will find it troublesome having to always delete the border every time he or she runs the code. That is why i am wondering if there is any way i could remove the border to prevent from regularly delete the border when the code is played @EyePeaSea"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1443597171, "post_id": 32859310, "comment_id": 53552822, "body": "Last line of code to remove borders, <code>Cells.Borders.LineStyle = xlNone</code>"}, {"owner": {"reputation": 175, "user_id": 1934827, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAvq5.jpg?s=128&g=1", "display_name": "EyePeaSea", "link": "https://stackoverflow.com/users/1934827/eyepeasea"}, "edited": false, "score": 0, "creation_date": 1443598649, "post_id": 32859310, "comment_id": 53553656, "body": "@nabilah - Sorry for the confusion - the link I provided (and the answer also given by Katz and Davesexcel) relate to adding code to your existing VBA - so the user doesn&#39;t have to do anything."}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "reply_to_user": {"reputation": 175, "user_id": 1934827, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAvq5.jpg?s=128&g=1", "display_name": "EyePeaSea", "link": "https://stackoverflow.com/users/1934827/eyepeasea"}, "edited": false, "score": 0, "creation_date": 1443598992, "post_id": 32859310, "comment_id": 53553855, "body": "Alright thank you! I did take a look at it :) @EyePeaSea"}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1443597685, "post_id": 32859690, "comment_id": 53553120, "body": "Hi i did try your code but it doesnt seem to work. The border is still there"}], "tags": [], "owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "is_accepted": false, "score": 0, "last_activity_date": 1443668885, "last_edit_date": 1443668885, "creation_date": 1443596074, "answer_id": 32859690, "question_id": 32859310, "link": "https://stackoverflow.com/questions/32859310/removing-the-border-lines-in-a-worksheet-when-code-has-been-run/32859690#32859690", "title": "Removing the border lines in a worksheet when code has been run", "body": "<p>At the end of the code,\nplease add a new line to format paint of the 3rd row.</p>\n\n<p>So basically before the last two lines\n    wb1.Select ' please make sure you select the correct one wb1 or wb2 here and try again\n    Rows(\"3:3\").Select\n    Selection.Copy\n    Rows(\"4:10000\").Select\n    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = False\n    end with\n    end sub 'This is the last line of your code</p>\n"}, {"comments": [{"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1443756459, "post_id": 32859714, "comment_id": 53628927, "body": "Thanks for your help!"}], "tags": [], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "is_accepted": false, "score": 4, "last_activity_date": 1443596146, "creation_date": 1443596146, "answer_id": 32859714, "question_id": 32859310, "link": "https://stackoverflow.com/questions/32859310/removing-the-border-lines-in-a-worksheet-when-code-has-been-run/32859714#32859714", "title": "Removing the border lines in a worksheet when code has been run", "body": "<p>As EyePeaSea said you can remove the border by vba code, e.g.</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"XY\").Range(\"A1\", \"Z99\").Borders.LineStyle = xlNone\n</code></pre>\n\n<p>In your case the code should be (untested)</p>\n\n<pre><code>copyFrom.Borders.LineStyle = xlNone\n</code></pre>\n\n<p>after you copied the row</p>\n"}, {"tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": true, "score": 2, "last_activity_date": 1443596353, "creation_date": 1443596353, "answer_id": 32859779, "question_id": 32859310, "link": "https://stackoverflow.com/questions/32859310/removing-the-border-lines-in-a-worksheet-when-code-has-been-run/32859779#32859779", "title": "Removing the border lines in a worksheet when code has been run", "body": "<p>I assume this formatting is coming from the source worksheet.  If so, you could <code>PasteSpecial</code> to just paste values, keeping the destination formatting.  To do so, simply replace</p>\n\n<pre><code>copyFrom.Copy .Rows(lRow)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>copyFrom.Copy\n.Rows(lRow).PasteSpecial xlPasteValues, xlPasteSpecialOperationNone, False, False\n</code></pre>\n\n<p>If you do need some formatting from the source sheet, you can use <code>xlPasteAllExceptBorders</code> instead of <code>xlPasteValues</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 2, "last_activity_date": 1443597221, "last_edit_date": 1443597221, "creation_date": 1443596878, "answer_id": 32859950, "question_id": 32859310, "link": "https://stackoverflow.com/questions/32859310/removing-the-border-lines-in-a-worksheet-when-code-has-been-run/32859950#32859950", "title": "Removing the border lines in a worksheet when code has been run", "body": "<p>Paste Special, this will paste to the first empty cell in column A</p>\n\n<pre><code>copyfrom.Copy\nws2.Cells(ws2.Rows.Count, \"A\").End(xlUp).Offset(1).PasteSpecial xlPasteValues\nApplication.CutCopyMode = 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1443597463, "post_id": 32860031, "comment_id": 53552983, "body": "I also have no idea where the border come from too. Thank you! But the Code will also remove the border for my column headers too"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1443597647, "post_id": 32860031, "comment_id": 53553097, "body": "@nabilah is that the only place where you have a border in the destination sheet?"}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1443597802, "post_id": 32860031, "comment_id": 53553194, "body": "Nope. Every Sheet there is a border for my column headers. And the code that you gave i use it for other worksheet and the result is the same. Still produce the border line on the last row"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1443598151, "post_id": 32860031, "comment_id": 53553388, "body": "ok, plz try the edited version.. it will remove borders from the point the rows where added."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1443665995, "last_edit_date": 1443665995, "creation_date": 1443597149, "answer_id": 32860031, "question_id": 32859310, "link": "https://stackoverflow.com/questions/32859310/removing-the-border-lines-in-a-worksheet-when-code-has-been-run/32860031#32860031", "title": "Removing the border lines in a worksheet when code has been run", "body": "<p>You can add this line after removing the duplicates </p>\n\n<pre><code>.UsedRange.Offset(lRow).Borders.Value = 0\n</code></pre>\n\n<p>This will remove any borders from the inserted rows</p>\n\n<p>p.s.: I still dont understand where these borders came from, most probably from the original worksheet.. :)</p>\n"}], "owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1695, "favorite_count": 0, "accepted_answer_id": 32859779, "answer_count": 5, "score": 1, "last_activity_date": 1443668885, "creation_date": 1443594773, "last_edit_date": 1443595396, "question_id": 32859310, "link": "https://stackoverflow.com/questions/32859310/removing-the-border-lines-in-a-worksheet-when-code-has-been-run", "title": "Removing the border lines in a worksheet when code has been run", "body": "<p>I have a code that successfully looks into an external file and copy/pastes the rows that contain that particular condition into the current workbook. For example I am searching for <code>Singapore</code> in the external workbook called Active master project file and copy all the rows containing <code>Singapore</code> to the current workbook that is open.</p>\n\n<p>A problem that occurs is that when I run the same code twice, a border line will exist on the last row of the worksheet. For example when I run the code, it will copy paste the information containing <code>Singapore</code> to the current worksheet called \"New Upcoming Projects\":  </p>\n\n<p><a href=\"https://i.stack.imgur.com/XzZRZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XzZRZ.png\" alt=\"enter image description here\"></a>  </p>\n\n<p>However, when I run the code again it will create a border line on each column such as the image shown below:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/K9CJG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K9CJG.png\" alt=\"enter image description here\"></a>  </p>\n\n<p>And the code that I have for now is:</p>\n\n<pre><code>Sub UpdateNewUpcomingProj()\n    Dim wb1 As Workbook, wb2 As Workbook\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim copyFrom As Range\n    Dim lRow As Long '&lt;~~ Not Integer. Might give you error in higher versions of excel\n    Dim strSearch As String\n\n    Set wb1 = Application.Workbooks.Open(\"U:\\Active Master Project.xlsm\")\n    Set ws1 = wb1.Worksheets(\"New Upcoming Projects\")\n\n    strSearch = \"Singapore\"\n    With ws1\n\n        '~~&gt; Remove any filters\n        .AutoFilterMode = False\n\n        '~~&gt; I am assuming that the names are in Col A\n        '~~&gt; if not then change A below to whatever column letter\n        lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        With .Range(\"A1:A\" &amp; lRow)\n            .AutoFilter Field:=1, Criteria1:=\"=*\" &amp; strSearch &amp; \"*\"\n            Set copyFrom = .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow\n        End With\n\n        .AutoFilterMode = False\n    End With\n\n    '~~&gt; Destination File\n    Set wb2 = ThisWorkbook\n    Set ws2 = wb2.Worksheets(\"New Upcoming Projects\")\n     With ws2\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            lRow = .Cells.Find(What:=\"*\", _\n                          After:=.Range(\"A1\"), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n        Else\n            lRow = 2\n        End If\n\n       copyFrom.Copy .Rows(lRow)\n      .Rows.RemoveDuplicates Array(2), xlNo\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>Is there any improvement or additional codes that I have to add in so that the border line would disappear?</p>\n"}, {"tags": ["vba", "insert", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3364550, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fb135e07000b48556f0c61a57bfe8bf6?s=128&d=identicon&r=PG&f=1", "display_name": "user3364550", "link": "https://stackoverflow.com/users/3364550/user3364550"}, "edited": false, "score": 0, "creation_date": 1443595053, "post_id": 32859220, "comment_id": 53551774, "body": "Hi Tim, thanks for the quick reply,  I have just tried you code but I get an invalid Procedure call"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1443594429, "creation_date": 1443594429, "answer_id": 32859220, "question_id": 32859066, "link": "https://stackoverflow.com/questions/32859066/inserting-ini-file-into-word-with-formatting/32859220#32859220", "title": "inserting ini File into word with formatting", "body": "<p>This will use the formatting of the bookmark and replace whatever text the bookmark has:</p>\n\n<pre><code>Dim fPath\nfPath = \"C:\\Users\\TestUser\\Desktop\\test.txt\"\n\nActiveDocument.Bookmarks(\"BK_Puchase_Invioces\").Range.Text = _\n   CreateObject(\"scripting.filesystemobject\").opentextfile(fPath).ReadAll()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3364550, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fb135e07000b48556f0c61a57bfe8bf6?s=128&d=identicon&r=PG&f=1", "display_name": "user3364550", "link": "https://stackoverflow.com/users/3364550/user3364550"}, "is_accepted": false, "score": 0, "last_activity_date": 1443596682, "creation_date": 1443596682, "answer_id": 32859892, "question_id": 32859066, "link": "https://stackoverflow.com/questions/32859066/inserting-ini-file-into-word-with-formatting/32859892#32859892", "title": "inserting ini File into word with formatting", "body": "<p>sorry I missed the fpath variable in your code,  I have just tested it and it works fine, many thanks.</p>\n"}], "owner": {"reputation": 11, "user_id": 3364550, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fb135e07000b48556f0c61a57bfe8bf6?s=128&d=identicon&r=PG&f=1", "display_name": "user3364550", "link": "https://stackoverflow.com/users/3364550/user3364550"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1483261740, "creation_date": 1443593810, "last_edit_date": 1483261740, "question_id": 32859066, "link": "https://stackoverflow.com/questions/32859066/inserting-ini-file-into-word-with-formatting", "title": "inserting ini File into word with formatting", "body": "<p>I have  small bit of VBA code which works and inserts a File into a specific bookmark within word, but I'm struggling to format the Text from the file that gets inserted, either to use the format of the bookmark or to use specify the format on insert.</p>\n\n<p>working code</p>\n\n<pre><code>    File_purchase_inv_def = HarvDir + \"\\v1live\" + \"\\Purchase_Invoices.def\"\n\n    Selection.Range.InsertFile FileName:=(File_purchase_inv_def) \n        oRng = ActiveDocument.Bookmarks(\"BK_Puchase_Invioces\").Range\n        oRng.Select\n        Selection.Range.InsertFile FileName:=(File_purchase_inv_def)\n</code></pre>\n\n<p>The format i'm trying to use is \"Verdana\" and Font size \"7\" I have tried formatting the area of the bookmark and also the below code.</p>\n\n<p><strong>Not working Example1</strong>    </p>\n\n<pre><code>    File_purchase_inv_def = HarvDir + \"\\v1live\" + \"\\Purchase_Invoices.def\"\n\n    Selection.Range.InsertFile FileName:=(File_purchase_inv_def) \n        oRng = ActiveDocument.Bookmarks(\"BK_Puchase_Invioces\").Range\n        oRng.Select\n        Selection.Range.InsertFile FileName:=(File_purchase_inv_def)\n           With .Styles(Normal).Font\n                .Name = \"Verdana\"\n                .Size = 7\n                  End with \n</code></pre>\n\n<p><strong>Not working example 2</strong></p>\n\n<pre><code>File_purchase_inv_def = HarvDir + \"\\v1live\" + \"\\Purchase_Invoices.def\"\n\n    Selection.Range.InsertFile FileName:=(File_purchase_inv_def) \n        oRng = ActiveDocument.Bookmarks(\"BK_Puchase_Invioces\").Range\n        oRng.Select\n        Selection.Range.InsertFile FileName:=(File_purchase_inv_def)\n          Selection.Font.Name = \"Verdana\"\n          Selection.Font.Size = 7\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1443593161, "creation_date": 1443593161, "answer_id": 32858929, "question_id": 32858449, "link": "https://stackoverflow.com/questions/32858449/column-values-to-be-replaced-with-another-columns-values/32858929#32858929", "title": "Column values to be replaced with another column&#39;s values", "body": "<p>Split Text to Columns with pipe as the delimiter and then assuming the first <code>user1</code> is in B2 and with <code>0</code> in E1 you might put in E2:  </p>\n\n<pre><code>=IF(B1=B2,E1,\"Manager\"&amp;RIGHT(E1,1)+1+IF(RIGHT(E1,1)=\"4\",-4))  \n</code></pre>\n\n<p>copy down to suit, then use the output to look up actual names in a table from your other sheet.</p>\n"}, {"comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1443596527, "post_id": 32859027, "comment_id": 53552474, "body": "Sorry, I don&#39;t quite understand what needs to be done for that step, it&#39;s more clear if there is before and after. Does OP means something like <code>20120615|Manager1|mak||ToBeReplaced|20150114</code>?"}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 1, "last_activity_date": 1443593597, "creation_date": 1443593597, "answer_id": 32859027, "question_id": 32858449, "link": "https://stackoverflow.com/questions/32858449/column-values-to-be-replaced-with-another-columns-values/32859027#32859027", "title": "Column values to be replaced with another column&#39;s values", "body": "<p>Something like this?<br>\n<a href=\"https://i.stack.imgur.com/TOV7F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TOV7F.png\" alt=\"Sample\"></a></p>\n\n<p>Column A are your text strings.<br>\nB2 formula: <code>User</code> (with the white space at the end)<br>\nC2 formula: <code>=MID(A2,SEARCH(B2,A2)+LEN(B2),SEARCH(\"|mak|\",A2)-SEARCH(B2,A2)-LEN(B2))</code><br>\nD2 formula: <code>ToBeReplaced</code><br>\nE2 formula: <code>=CONCATENATE(\"Manager\",C2)</code><br>\nF2 formula: <code>=REPLACE(A2,SEARCH(D2,A2),LEN(D2),E2)</code><br></p>\n"}], "owner": {"reputation": 635, "user_id": 4328225, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/fd26ef05f6a395db9d56acf2823a5d54?s=128&d=identicon&r=PG&f=1", "display_name": "ImCoder", "link": "https://stackoverflow.com/users/4328225/imcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 32859027, "answer_count": 2, "score": 1, "last_activity_date": 1444193230, "creation_date": 1443590865, "last_edit_date": 1444193230, "question_id": 32858449, "link": "https://stackoverflow.com/questions/32858449/column-values-to-be-replaced-with-another-columns-values", "title": "Column values to be replaced with another column&#39;s values", "body": "<p>I have an Excel file with '|' separated values in it: </p>\n\n<pre><code>20120615|User 1|mak||ToBeReplaced|20150114\n20120615|User 1|mak||ToBeReplaced|20150115\n20120615|User 1|mak||ToBeReplaced|20150116\n20120615|User 2|mak||ToBeReplaced|20150114\n20120615|User 2|mak||ToBeReplaced|20150115\n20120615|User 2|mak||ToBeReplaced|20150116\n20120615|User 3|mak||ToBeReplaced|20150114\n20120615|User 3|mak||ToBeReplaced|20150115\n20120615|User 3|mak||ToBeReplaced|20150116\n</code></pre>\n\n<p>I also have another Excel spreadsheet that has the names of all Managers. Eg</p>\n\n<pre><code>Manager1\nManager2\nManager3\nManager4\n</code></pre>\n\n<p>Now I want the Managers names to be replaced with the column values ToBeReplaced for each User. i.e</p>\n\n<pre><code>20120615|User 1|mak||Manager1|20150114\n20120615|User 1|mak||Manager1|20150115\n20120615|User 1|mak||Manager1|20150116\n20120615|User 2|mak||Manager2|20150114\n20120615|User 2|mak||Manager2|20150115\n20120615|User 2|mak||Manager2|20150116\n20120615|User 3|mak||Manager3|20150114\n20120615|User 3|mak||Manager3|20150115\n20120615|User 3|mak||Manager3|20150116\n</code></pre>\n\n<p>That should go on replacing for all Users, the use case is</p>\n\n<ol>\n<li>If all Managers names are replaced and still more users are remaining, then it should start again from Manager1.</li>\n</ol>\n\n<p>Can anyone help me with an Excel formula or something to get the desired result?  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1443606289, "post_id": 32857457, "comment_id": 53558250, "body": "welcome to stack overflow.  You need to give more information.  How about posting the code you wrote."}, {"owner": {"reputation": 3, "user_id": 5391185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b941d5da887deccd097afc8be071c5d9?s=128&d=identicon&r=PG&f=1", "display_name": "J.Rookie", "link": "https://stackoverflow.com/users/5391185/j-rookie"}, "reply_to_user": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1443621347, "post_id": 32857457, "comment_id": 53567948, "body": "The following is the code: Select Range(&quot;A1&quot;).Value   Case 50, Range(&quot;A2&quot;).Value=1000 End Selection    I thought it should be a easy code, but in the excel workbook, when I choose 50 in A1, there is an error and my excel crushed,"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1443634391, "post_id": 32857457, "comment_id": 53576324, "body": "Do you know about debugging VBA code.  If not find out.  You need to quote the error given to you.  Does your code compile.  What module is your code in."}, {"owner": {"reputation": 3, "user_id": 5391185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b941d5da887deccd097afc8be071c5d9?s=128&d=identicon&r=PG&f=1", "display_name": "J.Rookie", "link": "https://stackoverflow.com/users/5391185/j-rookie"}, "reply_to_user": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1443638164, "post_id": 32857457, "comment_id": 53578272, "body": "Hi I edited my post. I debugged but the info poped out is not enough for me to solve. I use the change mode in VBE."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1443639434, "post_id": 32857457, "comment_id": 53578985, "body": "I see what you are trying to do now....See my answer.  In future try to give as much information and explanation as possible.  People can&#39;t help you much otherwose!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5391185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b941d5da887deccd097afc8be071c5d9?s=128&d=identicon&r=PG&f=1", "display_name": "J.Rookie", "link": "https://stackoverflow.com/users/5391185/j-rookie"}, "edited": false, "score": 0, "creation_date": 1443709496, "post_id": 32873649, "comment_id": 53609645, "body": "Hi friend. It did work! Thank you so much! But do you know which part I&#39;m wrong? Your code is very useful but  for this part &quot;If Target.Address = &quot;$A$1&quot; Then&quot; what&#39;s the difference between &quot;A1&quot; and &quot;$A$1&quot;. and can you explain a little bit for me? Thanks again,"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 0, "last_activity_date": 1443639399, "creation_date": 1443639399, "answer_id": 32873649, "question_id": 32857457, "link": "https://stackoverflow.com/questions/32857457/vba-data-validation-list-selection/32873649#32873649", "title": "VBA Data Validation List Selection", "body": "<p>Add this code to the module of the sheet with the cells you want validation added to </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = \"$A$1\" Then\n\n        If Target.Value = 50 Then\n\n             Range(\"A2\") = 1000\n\n            ' Add valid values of 1000 allowed only\n            With Range(\"A2\").Validation\n                .Delete\n                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=\"1000\"\n                .IgnoreBlank = True\n                .InCellDropdown = True\n                .InputTitle = \"\"\n                .ErrorTitle = \"\"\n                .InputMessage = \"\"\n                .ErrorMessage = \"Enter a valid value\"\n                .ShowInput = False\n                .ShowError = True\n            End With\n\n        Else\n            ' Add valid values of 1000 and 5000 allowed\n            With Range(\"A2\").Validation\n                .Delete\n                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=\"1000,5000\"\n                .IgnoreBlank = True\n                .InCellDropdown = True\n                .InputTitle = \"\"\n                .ErrorTitle = \"\"\n                .InputMessage = \"\"\n                .ErrorMessage = \"Enter a valid value\"\n                .ShowInput = False\n                .ShowError = True\n            End With\n        End If\n\n\n\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5391185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b941d5da887deccd097afc8be071c5d9?s=128&d=identicon&r=PG&f=1", "display_name": "J.Rookie", "link": "https://stackoverflow.com/users/5391185/j-rookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1047, "favorite_count": 0, "accepted_answer_id": 32873649, "answer_count": 1, "score": 0, "last_activity_date": 1443640205, "creation_date": 1443584978, "last_edit_date": 1443640205, "question_id": 32857457, "link": "https://stackoverflow.com/questions/32857457/vba-data-validation-list-selection", "title": "VBA Data Validation List Selection", "body": "<p>I'm writing a code to embed in one table. The situation is like this:\nCell A1 (with option of 50,100 and 150) and cell A2 (with option of 1000 and 5000), both have data validation list in them. When I choose cell A1 of 50, A2 has to be 1000. When I wrote the code and made the selection, there is always an error:</p>\n\n<blockquote>\n  <p>Run-time error '-2147417848(80010108)': Method 'Add' of object 'Validation' failed.</p>\n</blockquote>\n\n<p>Please share your opinions or if need I post my codes here to resolve this issue.</p>\n\n<p>The basic code is as following: </p>\n\n<pre><code>Select Case Range(\"A1\").Value\nCase \"50\"\n         Range(\"A2\").ClearContents\n        Range(\"A6\").Value2 = \"1000\"\n\nCase \"`100\"\n         Range(\"A2\").ClearContents\n       With Range(\"A2\").Validation\n        .Delete\n        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _\n        :=xlBetween\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n    End With\n        Range(\"A2\").Value2 = 1000\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1443598726, "post_id": 32857323, "comment_id": 53553701, "body": "<code>=Application.WorksheetFunction.Sum(Worksheets(&quot;Data&quot;).Range.&zwnj;&#8203;Cells(1, i))</code>  this is not a cumulative sum, this is similar to saying <code>Worksheets(&quot;Data&quot;).Cells(1, i)).value</code>"}, {"owner": {"reputation": 69, "user_id": 5327399, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153131737536616/picture?type=large", "display_name": "Pat Dillon", "link": "https://stackoverflow.com/users/5327399/pat-dillon"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1443616114, "post_id": 32857323, "comment_id": 53564213, "body": "Okay can you suggest a method to sum this range then?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1443616256, "post_id": 32857323, "comment_id": 53564334, "body": "What you want basically is Skl = Sum(Aij) for i = 1 to k and j= 1 to l, is that it?"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 5327399, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153131737536616/picture?type=large", "display_name": "Pat Dillon", "link": "https://stackoverflow.com/users/5327399/pat-dillon"}, "edited": false, "score": 0, "creation_date": 1444126532, "post_id": 32866910, "comment_id": 53759356, "body": "Seems to be running well. Thanks!"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1443618345, "creation_date": 1443618345, "answer_id": 32866910, "question_id": 32857323, "link": "https://stackoverflow.com/questions/32857323/cumulative-sum-in-a-column/32866910#32866910", "title": "Cumulative Sum in a column", "body": "<p>As I see from your example, you want to shift down one row and calculate at each cell the cumulative sum on the column.</p>\n\n<pre><code>  Dim i As Integer, j As Integer, nRows As Integer, nCols As Integer\n  With Worksheets(\"Data\")\n     nRows = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n     nCols = .Cells(1, .Columns.Count).End(xlToLeft).Column\n     Worksheets(\"LG\").Cells.Clear\n     For i = 1 To nRows\n        For j = 1 To nCols\n            Worksheets(\"LG\").Cells(i + 1, j) = Application.Sum(.Range(.Cells(1, j), .Cells(i, j)))\n        Next\n     Next\n\n     For j = 1 To nCols + 2\n        Worksheets(\"LG\").Cells(1, j) = 0\n     Next\n   End With\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 5327399, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153131737536616/picture?type=large", "display_name": "Pat Dillon", "link": "https://stackoverflow.com/users/5327399/pat-dillon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3658, "favorite_count": 0, "accepted_answer_id": 32866910, "answer_count": 1, "score": 1, "last_activity_date": 1443618345, "creation_date": 1443584087, "question_id": 32857323, "link": "https://stackoverflow.com/questions/32857323/cumulative-sum-in-a-column", "title": "Cumulative Sum in a column", "body": "<p>I am trying to write a VBA code to run a cumulative sum for a matrix of variable size to be output  to another sheet for further analysis. These cells need to be offset by 1 row and 1 column as well as the new top row assigned a \"0\" value. such as shown below (done by manual calc)</p>\n\n<p><a href=\"https://i.stack.imgur.com/hUyes.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hUyes.png\" alt=\"Manual analysis\"></a></p>\n\n<p>I am struggling to develop the code for this however what i have is shown below.</p>\n\n<pre><code>'Private Sub LGMethod_Click()\n'Declare Variables\n    Dim i As Integer\n    Dim J As Integer\n'Clear Worksheet\n    Worksheets(\"LG\").Cells.Clear\n'Loop to count and and analyse\n    For i = 1 To Worksheets(\"Data\").Cells(Rows.Count, \"A\").End(xlUp).Row\n        For J = 1 To Worksheets(\"Data\").Cells(1, Columns.Count).End(xlToLeft).Column\n            Worksheets(\"LG\").Cells(i + 1, J + 1) = Application.WorksheetFunction.Sum(Worksheets(\"Data\").Range.Cells(1, i))\n\n        Next\n    Next\nEnd Sub'\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "mergefield"], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 5391178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/168f05ff9ac45f0522563baf7bf051f4?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Veloso", "link": "https://stackoverflow.com/users/5391178/michael-veloso"}, "is_accepted": true, "score": 2, "last_activity_date": 1443591549, "creation_date": 1443591549, "answer_id": 32858563, "question_id": 32857162, "link": "https://stackoverflow.com/questions/32857162/nested-if-field-in-word-vba/32858563#32858563", "title": "Nested IF field in Word VBA", "body": "<p>So I found a solution to my problem.</p>\n\n<p>I used the word macro recorder(View>Macros>Record Macro...) to record me entering the complex if statement, then viewed the macro, by pressing Alt + F11 and selecting macros, and I simply replaced some strings with my variables.\nand that has fixed the issues.</p>\n\n<p>Hopefully this will be helpful for someone else, saving them hours of head scratching.</p>\n\n<p>I had no Idea that you could record these actions to be reviewed later. You learn something new every day.</p>\n\n<p>This is what the recording looked like. </p>\n\n<pre><code>Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False\nSelection.TypeText Text:=\"IF \"\nSelection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False\nSelection.TypeText Text:=\" = AND (\"\nSelection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False\nSelection.TypeText Text:=\" COMPARE \"\nSelection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False\nSelection.TypeText Text:=\"MERGEFIELD FHB\"\nSelection.MoveRight Unit:=wdCharacter, Count:=2\nSelection.TypeText Text:=\" = \"\"\"\"\"\nSelection.MoveLeft Unit:=wdCharacter, Count:=1\nSelection.TypeText Text:=\"T\"\nSelection.MoveRight Unit:=wdCharacter, Count:=3\nSelection.TypeText Text:=\", \"\nSelection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False\nSelection.TypeText Text:=\"COMPARE \"\nSelection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False\nSelection.TypeText Text:=\"MERGEFIELD Other\"\nSelection.MoveRight Unit:=wdCharacter, Count:=2\nSelection.TypeText Text:=\" &lt;&gt; \"\"\"\"\"\nSelection.MoveLeft Unit:=wdCharacter, Count:=1\nSelection.TypeText Text:=\"T\"\nSelection.MoveRight Unit:=wdCharacter, Count:=3\nSelection.TypeText Text:=\")\"\nSelection.MoveRight Unit:=wdCharacter, Count:=2\nSelection.TypeText Text:=\" = 1 \"\"\"\"\"\nSelection.MoveLeft Unit:=wdCharacter, Count:=1\nSelection.TypeText Text:=\"IfTrue\"\nSelection.MoveRight Unit:=wdCharacter, Count:=1\nSelection.TypeText Text:=\" \"\"\"\"\"\nSelection.MoveLeft Unit:=wdCharacter, Count:=1\nSelection.TypeText Text:=\"IfFalse\"\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5391178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/168f05ff9ac45f0522563baf7bf051f4?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Veloso", "link": "https://stackoverflow.com/users/5391178/michael-veloso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "accepted_answer_id": 32858563, "answer_count": 1, "score": 0, "last_activity_date": 1443806170, "creation_date": 1443582954, "last_edit_date": 1443806170, "question_id": 32857162, "link": "https://stackoverflow.com/questions/32857162/nested-if-field-in-word-vba", "title": "Nested IF field in Word VBA", "body": "<p>I'm trying to create a word addin that adds complex IF Statement Creation, from a list of possible mergefields.</p>\n\n<p><strong>Complex is</strong></p>\n\n<p><code>{ IF { = OR ( { COMPARE { MERGEFIELD Field_1 } &lt;= \"Value\" }, { COMPARE { MERGEFIELD Field_2 } &gt;= \"Value\" } ) } = 1 \"True Instructions\" \"False Instructions\" }</code></p>\n\n<p>Im trying to do this all in VBA, but im having issues with my Complex if, as I cant get the \"}\" to end in the right locations.</p>\n\n<p>If I use the terminator \"Selection.EndKey Unit:=wdLine\" in any other location besides the end, it creates a mess and putts all the } at that line.</p>\n\n<p>Here is my Code:</p>\n\n<pre><code>Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False\nSelection.TypeText Text:=\"IF \"\n\n\nSelection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False\n    Selection.TypeText Text:=\" = \" &amp; JointOperator1 &amp; \" ( \"\n\n'FIRST ARG\nSelection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False\n    Selection.TypeText Text:=\"COMPARE \"\n\n\nSelection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False, Text:=\"MERGEFIELD \" &amp; FirstArg1\n\n    Selection.TypeText Text:=\" \"\n    Selection.TypeText Text:=ComparisonType1\n    Selection.TypeText Text:=\" \"\n    Selection.TypeText Text:=Chr(34) &amp; SecondArg1 &amp; Chr(34)\n\n\nSelection.TypeText Text:=\", \"\n\n\n'SECOND ARG\nSelection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False\n    Selection.TypeText Text:=\"COMPARE \"\n\n\nSelection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False, Text:=\"MERGEFIELD \" &amp; FirstArg2\n\n    Selection.TypeText Text:=\" \"\n    Selection.TypeText Text:=ComparisonType2\n    Selection.TypeText Text:=\" \"\n    Selection.TypeText Text:=Chr(34) &amp; SecondArg2 &amp; Chr(34)\n\n\nSelection.TypeText Text:=\" ) \"\n\nSelection.TypeText Text:=\" = 1 \"\n\nSelection.TypeText Text:=vbCrLf &amp; \" \" &amp; Chr(34)\n\n\nSelection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False\nSelection.TypeText Text:=strTempIfTrue\n\n\nSelection.TypeText Text:=Chr(34) &amp; \" \" &amp; vbCrLf\nSelection.TypeText Text:=\" \" &amp; Chr(34)\n\nSelection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _\n    PreserveFormatting:=False\nSelection.TypeText Text:=strTempIfFalse\n\n\nSelection.TypeText Text:=Chr(34)\nSelection.EndKey Unit:=wdLine\nSelection.TypeParagraph\n</code></pre>\n\n<p>And this is what I get when generating the \"Complex if\"</p>\n\n<pre><code>{IF { = AND ( {COMPARE{MERGEFIELD FHB} = \"T\", { COMPARE {MERGEFIELD BLAH} = \"F\") = 1 \"If True text\" \"If False Text\"}}}}\n</code></pre>\n\n<p><strong>But it should be this:</strong></p>\n\n<pre><code>{IF { = AND ( {COMPARE{MERGEFIELD FHB} = \"T\" **}** , { COMPARE {MERGEFIELD BLAH} = \"F\" **}** ) **}**  = 1 \"If True text\" \"If False Text\"}\n</code></pre>\n\n<p>If someone could shed some light on this matter, where am I going wrong.\nOr If there is a way of forcing the location of the Ending }, that would be great\nI'm very new to VBA (I'm a C++ Programmer)</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5303443, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/32805efb2fef7585b6d0ecbcd965d8f6?s=128&d=identicon&r=PG&f=1", "display_name": "nara son", "link": "https://stackoverflow.com/users/5303443/nara-son"}, "edited": false, "score": 1, "creation_date": 1443592037, "post_id": 32856951, "comment_id": 53550557, "body": "Thank you. But what does value2 use for?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 39, "user_id": 5303443, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/32805efb2fef7585b6d0ecbcd965d8f6?s=128&d=identicon&r=PG&f=1", "display_name": "nara son", "link": "https://stackoverflow.com/users/5303443/nara-son"}, "edited": false, "score": 0, "creation_date": 1443614762, "post_id": 32856951, "comment_id": 53563335, "body": "When working with cells (ranges) there are 3 properties used to get the actual data from the Range object: <code>rng.Value</code>, <code>rng.Value2</code>, and <code>rng.Text</code>. <code>rng.Value2</code> is the &quot;raw data&quot;, extracted without formatting, for example if A1 contains NOW(): .Text: <b>#######</b> (when column is too narrow to show entire value), .Value: <b>9/28/2015 6:43:43 PM</b>, .Value2: <b>42275.7803555556</b>. <a href=\"http://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\">This answer</a> has more info about the differences between them"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1443584192, "last_edit_date": 1443584192, "creation_date": 1443581486, "answer_id": 32856951, "question_id": 32856712, "link": "https://stackoverflow.com/questions/32856712/how-can-i-detect-null-value-in-excel/32856951#32856951", "title": "How can i detect null value in excel?", "body": "<p>Here are a few ways to validate parameters</p>\n\n<pre><code>Option Explicit\n\nPublic Function MySum(a As Range, b As Range) As String\n    Dim itmsOK As Boolean\n\n    MySum = \"No value\"  'default return value, if a or b are not valid\n\n    itmsOK = (Not a Is Nothing And Not b Is Nothing)    'validate the Range objects\n\n    If itmsOK Then itmsOK = (Not IsNull(a.Value2) And Not IsNull(b.Value2))       'DB vals\n    If itmsOK Then itmsOK = (Len(Trim(a.Value2)) &gt; 0 And Len(Trim(b.Value2)) &gt; 0) 'Empty\n    If itmsOK Then itmsOK = (IsNumeric(a.Value2) And IsNumeric(b.Value2))         'Numbers\n\n    If itmsOK Then MySum = Val(a.Value2) + Val(b.Value2)   'if both valid, perform math\n\nEnd Function\n</code></pre>\n\n<p>(checking just for Nulls is more specific to importing data from a database)</p>\n"}, {"comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1443631087, "post_id": 32859889, "comment_id": 53574532, "body": "You might want to expand your answer to explain what the added functions do."}], "tags": [], "owner": {"reputation": 127, "user_id": 4427323, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9629056833622a15f54176f296d716b2?s=128&d=identicon&r=PG&f=1", "display_name": "Isu", "link": "https://stackoverflow.com/users/4427323/isu"}, "is_accepted": false, "score": 0, "last_activity_date": 1443648240, "last_edit_date": 1443648240, "creation_date": 1443596677, "answer_id": 32859889, "question_id": 32856712, "link": "https://stackoverflow.com/questions/32856712/how-can-i-detect-null-value-in-excel/32859889#32859889", "title": "How can i detect null value in excel?", "body": "<p>CountA function returns value \"0\" when when the cell is empty. SO you can use CountA function in this case to check whether there is any data in the cell.</p>\n\n<pre><code>If CountA(\"a\") = 0 and CountA(\"b\") = 0 Then\nMySum = \"No value sir\"\n    Else\nMySum = a.Value + b.Value\nElse IF\nEND\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5303443, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/32805efb2fef7585b6d0ecbcd965d8f6?s=128&d=identicon&r=PG&f=1", "display_name": "nara son", "link": "https://stackoverflow.com/users/5303443/nara-son"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 749, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1443648240, "creation_date": 1443579564, "last_edit_date": 1531164843, "question_id": 32856712, "link": "https://stackoverflow.com/questions/32856712/how-can-i-detect-null-value-in-excel", "title": "How can i detect null value in excel?", "body": "<p>I have a problem with value detection in excel. When it doesn't have value in cell i want excel show me message warning rather than zero value and i have code below.</p>\n\n<pre><code>Public Function MySum(a As Range, b As Range) As String\n\n    If IsNull(a) And IsNull(b) Then\n        MySum = \"No value sir\"\n    Else\n        MySum = a.Value + b.Value\n    End If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1443577573, "last_edit_date": 1443577573, "creation_date": 1443577190, "answer_id": 32856411, "question_id": 32856338, "link": "https://stackoverflow.com/questions/32856338/add-a-new-row-with-data/32856411#32856411", "title": "Add a new row with data", "body": "<p>Say you want to insert data at row i. you can do this:</p>\n\n<pre><code>myWorkSheet.Rows(i).insert\nmyWorkSheet.Range(\"A\" &amp; i).value = userId\nmyWorkSheet.Range(\"B\" &amp; i).value = username\nmyWorkSheet.Range(\"C\" &amp; i).value = userLastName ' etc...\n</code></pre>\n\n<p>If you want to have the new row be a copy of the row above it (usually useful when wanting to repeat formulas), you can then do this:</p>\n\n<pre><code>myWorkSheet.Rows(i).insert\nmyWorkSheet.Rows(i-1).copy myWorkSheet.Rows(i)\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4162490, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ktfl9.jpg?s=128&g=1", "display_name": "jose", "link": "https://stackoverflow.com/users/4162490/jose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 32856411, "answer_count": 1, "score": -1, "last_activity_date": 1443594213, "creation_date": 1443576599, "last_edit_date": 1531161705, "question_id": 32856338, "link": "https://stackoverflow.com/questions/32856338/add-a-new-row-with-data", "title": "Add a new row with data", "body": "<p>How can I add a new row to my Excel sheet using a macro but with data, I've search and all I could find is to add a new 'blank' row, and that's not what I need</p>\n\n<p>I want when I execute the macro, create the row with some content in the cells, like:</p>\n\n<p><code>cell 1   | cell 2    | cell 3 | \nuserId    username   user last name</code></p>\n\n<p>The information will be hardcoded formulas or simple hardcoded data that I want that every time the macro runs the rows will be created with that information.</p>\n"}, {"tags": ["vba", "visio"], "answers": [{"comments": [{"owner": {"reputation": 25584, "user_id": 501459, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/29b9e5f5d700524e3a6eaef99de7d069?s=128&d=identicon&r=PG", "display_name": "Mud", "link": "https://stackoverflow.com/users/501459/mud"}, "edited": false, "score": 0, "creation_date": 1443664665, "post_id": 32875135, "comment_id": 53587532, "body": "That&#39;s fantastic news. So how then do I access my &quot;details&quot; shape by name (I can&#39;t see <i>where</i> you can name a shape, even) so I can update its text?"}, {"owner": {"reputation": 25584, "user_id": 501459, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/29b9e5f5d700524e3a6eaef99de7d069?s=128&d=identicon&r=PG", "display_name": "Mud", "link": "https://stackoverflow.com/users/501459/mud"}, "edited": false, "score": 0, "creation_date": 1443681374, "post_id": 32875135, "comment_id": 53592265, "body": "Figured it out. The whole API is kludgey as hell, but it works."}, {"owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "reply_to_user": {"reputation": 25584, "user_id": 501459, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/29b9e5f5d700524e3a6eaef99de7d069?s=128&d=identicon&r=PG", "display_name": "Mud", "link": "https://stackoverflow.com/users/501459/mud"}, "edited": false, "score": 0, "creation_date": 1443704517, "post_id": 32875135, "comment_id": 53606273, "body": "Yeah it has a bit of a learning curve, but I&#39;m on the other side, and it really is very powerful.  Stick with it, and the VBA macro recorder helps a lot with learning this stuff."}], "tags": [], "owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "is_accepted": true, "score": 3, "last_activity_date": 1443645279, "creation_date": 1443645279, "answer_id": 32875135, "question_id": 32855701, "link": "https://stackoverflow.com/questions/32855701/programmatic-access-to-visio-shape-tooltip/32875135#32875135", "title": "Programmatic access to Visio shape tooltip", "body": "<p>Visio's API is capable of doing this, handily.</p>\n\n<p>It seems you're not aware of Visio's shapesheet, which is where the screen tip text is stored, along with pretty much anything you'd want to know about a shape.</p>\n\n<p>To access the screen tip text you simply read the Comment cell from the selected shape's shapesheet:</p>\n\n<pre><code>Application.Selection(1).CellsU(\"Comment\").ResultStr(visNone)\n</code></pre>\n\n<p>This code will return the comment text.</p>\n\n<p>You're on the right track using the SelectionChange event, though of course you're checking that the selection count = 1, or at least >0.</p>\n"}], "owner": {"reputation": 25584, "user_id": 501459, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/29b9e5f5d700524e3a6eaef99de7d069?s=128&d=identicon&r=PG", "display_name": "Mud", "link": "https://stackoverflow.com/users/501459/mud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "accepted_answer_id": 32875135, "answer_count": 1, "score": 1, "last_activity_date": 1593554500, "creation_date": 1443571536, "last_edit_date": 1593554500, "question_id": 32855701, "link": "https://stackoverflow.com/questions/32855701/programmatic-access-to-visio-shape-tooltip", "title": "Programmatic access to Visio shape tooltip", "body": "<p>To avoid an <a href=\"http://xyproblem.info/\" rel=\"nofollow\">XY problem</a>, here's what I'm trying to accomplish: <strong>when a shape is selected, I want detail text about that shape to appear on the screen.</strong></p>\n\n<p>I first tried using Shape Data, but it supports only single-line name=value pairs. My detail information is an arbitrary, multiline text blob.</p>\n\n<p>My next thought was to used the shape's ScreenTip (aka tooltip) to hold the text data, then write some VBA code to handle the _SelectionChanged event. When a shape is selected I want to copy it's ScreenTip text into the text of another object (my details panel).</p>\n\n<p>I got the _SelectionChange event-handling working, but poking around the Selection object in the debugger I can't find any property of the selected object that exposes the ScreenTip information.</p>\n\n<p>Is Visio's programming API too anemic to support his kind of thing? Is there another way I might be able to do this? Is there another <em>tool</em> that might be better for this (preferably free)?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 630, "user_id": 3406714, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MgPAp.jpg?s=128&g=1", "display_name": "Guizmoo03", "link": "https://stackoverflow.com/users/3406714/guizmoo03"}, "edited": false, "score": 1, "creation_date": 1443573638, "post_id": 32855702, "comment_id": 53545463, "body": "Thanks a lot, the problem was in the range because I was working with the full path of the source file."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1443576537, "last_edit_date": 1443576537, "creation_date": 1443571539, "answer_id": 32855702, "question_id": 32855469, "link": "https://stackoverflow.com/questions/32855469/find-cell-address-in-another-workbook-with-its-value-run-time-error-9-subscr/32855702#32855702", "title": "Find cell address in another workbook with its value: &quot;Run time error &#39;9&#39; Subscript out of range&quot;", "body": "<p>I can see the following problems you might be facing:</p>\n\n<p>1) use Application.Match instead of WorksheetFunction, the latter is not a member of the UserForm Object</p>\n\n<p>2) I doubt that the name of the listBox member is not listbox, most probably ListBox1 or so</p>\n\n<p>3)</p>\n\n<blockquote>\n  <p>Workbooks(\"c:\\sourceFile\")</p>\n</blockquote>\n\n<p>.. does that reference an open workbook? if so, you should get it by using its name (with extension) but without the path.</p>\n\n<pre><code>With Me.ListBox1\n   For i=0 To .ListCount -1\n       colNum = Application.Match(.List(i), Workbooks(\"sourceFile.xlsx\").Worksheets(1).Range(\"1:1\"), 0)\n       MsgBox \"Column :\" &amp; colNum\n   Next i\nEnd With \n</code></pre>\n\n<p>Finally, your code can be better optimized by getting the range to search once for all, not inside the loop:</p>\n\n<pre><code>set r = Workbooks(\"sourceFile.xlsx\").Worksheets(1).Range(\"1:1\")\nWith Me.ListBox1\n   For i=0 To .ListCount -1\n       colNum = Application.Match(.List(i), r, 0)\n       MsgBox \"Column :\" &amp; colNum\n   Next i\nEnd With \n</code></pre>\n"}], "owner": {"reputation": 630, "user_id": 3406714, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MgPAp.jpg?s=128&g=1", "display_name": "Guizmoo03", "link": "https://stackoverflow.com/users/3406714/guizmoo03"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 32855702, "answer_count": 1, "score": 0, "last_activity_date": 1443748066, "creation_date": 1443570166, "last_edit_date": 1531164843, "question_id": 32855469, "link": "https://stackoverflow.com/questions/32855469/find-cell-address-in-another-workbook-with-its-value-run-time-error-9-subscr", "title": "Find cell address in another workbook with its value: &quot;Run time error &#39;9&#39; Subscript out of range&quot;", "body": "<p>I'm working with a user form that contains a listBox and I'm trying to look for the list items in another workbook to get their cell addresses if found.</p>\n\n<p>My code is as follow:</p>\n\n<pre><code>With Me.listbox\n   For i=0 To listbox.ListCount -1\n       colNum = WorksheetFunction.Match(listbox.List(i), Workbooks(\"c:\\sourceFile\").Worksheets(1).Range(\"1:1\"), 0)\n       MsgBox \"Column :\" &amp; colNum\n\n   Next i\nEnd With \n</code></pre>\n\n<p>An error message pops up telling me \"Run time error '9' Subscript out of range\".</p>\n"}, {"tags": ["vba", "excel", "append", "match"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1443569396, "creation_date": 1443569396, "answer_id": 32855362, "question_id": 32855318, "link": "https://stackoverflow.com/questions/32855318/import-append-cell-from-one-column-newrawdata-to-another-column-centrallibrar/32855362#32855362", "title": "Import/append cell from one column (newrawdata) to another column (centrallibrary) if not preexisting - date error with Match Function", "body": "<p>You need to <code>Set</code> a range and date lookups perform better with raw values using the worksheet's <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow\">MATCH function</a>.</p>\n\n<pre><code>MatchLookup = Cells(ImportRange, 3).VALUE2   '&lt;~~ use the raw date value for the lookup\nSET MatchArray = ActiveSheet.Range(\"A:A\")   '&lt;~~ SET the range\n\nMsgBox (\"LookupValue \" &amp; MatchLookup)\n\nMatchAns = Application.Match(MatchLookup, MatchArray, 0)\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5390637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/243589c09a53296467cf9d8b3d7f7373?s=128&d=identicon&r=PG&f=1", "display_name": "Lewgo94", "link": "https://stackoverflow.com/users/5390637/lewgo94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 32855362, "answer_count": 1, "score": 0, "last_activity_date": 1446314011, "creation_date": 1443569081, "last_edit_date": 1446314011, "question_id": 32855318, "link": "https://stackoverflow.com/questions/32855318/import-append-cell-from-one-column-newrawdata-to-another-column-centrallibrar", "title": "Import/append cell from one column (newrawdata) to another column (centrallibrary) if not preexisting - date error with Match Function", "body": "<p>The code below uses the <strong>match</strong> function to check if a new set of values stored in the cells of Column C exists within a pre-existing range stored in Column A.</p>\n\n<p>If so, then within the msgbox prompt, the row corresponding to that value is displayed.  Otherwise, error n/a is handled with an \"if iserror\" statement, which will append the value in question to the next empty row within Column A</p>\n\n<p>Problem:</p>\n\n<p>This works for Text and Numbers, but the match function doesn't seem to correctly return Dates.  A date value gets appended to the bottom of column A, regardless if pre-existing.</p>\n\n<p>Likely error:</p>\n\n<p>Formatting or value of date within the match function</p>\n\n<p>To note: </p>\n\n<p>Below is a line that is set as a comment, but creates an error for dates when uncommented - used to display which row the data is found within Column A</p>\n\n<p>'MsgBox (\"Data pre-exists in row \" &amp; MatchAns)</p>\n\n<p>Happy to provide examples.</p>\n\n<pre><code>Option Explicit\n\nSub AppendNewRecords()\n\n\n'example used - Column A, listed with a number of values including numbers, dates and text,\n'Column C contains new raw data some matching Column A and some not,\n'append new raw data not matching Column A to the end of Column A\n\n\n'Declarations\n\n    Dim NeAvRow As Integer\n    Dim NeAvRecAdr As String\n\n\n'Declarations\n\n    Dim ImportRange As Long\n    Dim MatchLookup As Variant\n    Dim MatchArray As Variant\n    Dim MatchAns As Variant\n\n\n\n'Use the match function to see if record exists within the range\n\n    For ImportRange = 1 To Worksheets(\"sheet2\").Cells(Rows.Count, \"C\").End(xlUp).Row\n\n    MatchLookup = Cells(ImportRange, 3)\n    MatchArray = ActiveSheet.Range(\"A:A\")\n\n    MsgBox (\"LookupValue \" &amp; MatchLookup)\n\n    MatchAns = Application.Match(MatchLookup, MatchArray, 0)\n\n'MsgBox (\"Data pre-exists in row \" &amp; MatchAns)\n\n'Find the address of the last empty row in a column\n\n    NeAvRow = Worksheets(\"sheet2\").Cells(Rows.Count, \"A\").End(xlUp).Row\n    NeAvRecAdr = \"A\" &amp; NeAvRow + 1 'Next Available row for appending\n\nIf IsError(MatchAns) Then\n    Range(NeAvRecAdr) = MatchLookup\n\nEnd If\n\n    Next ImportRange\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv", "visio"], "answers": [{"tags": [], "owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "is_accepted": false, "score": 0, "last_activity_date": 1443644983, "creation_date": 1443644983, "answer_id": 32875045, "question_id": 32855181, "link": "https://stackoverflow.com/questions/32855181/creating-diagram-from-excel-using-vb/32875045#32875045", "title": "Creating Diagram from Excel Using VB", "body": "<p>I would approach this problem by first defining or finding Visio masters that would the data I'm drawing to the page.  In your case it looks like you'd want a master for your Foo items, and one for your Bar items.</p>\n\n<p>So then you'd step through your Bars, then within each Bar you'd have one or more Foos.  For each Foo, you would drop that master out, and set the text of the shape to what you want in the blue Foo section (maybe a grouped sub-shape for the Foo master), and then text in the white body.</p>\n\n<p>When stepping through all the Bars, you'd obviously have to drop out a Bar shape and position/size it to contain all the Foos.</p>\n"}], "owner": {"reputation": 180, "user_id": 5390623, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/190f4470f708126a6720330725826825?s=128&d=identicon&r=PG&f=1", "display_name": "ZtoYi", "link": "https://stackoverflow.com/users/5390623/ztoyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 505, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443644983, "creation_date": 1443568113, "last_edit_date": 1443594818, "question_id": 32855181, "link": "https://stackoverflow.com/questions/32855181/creating-diagram-from-excel-using-vb", "title": "Creating Diagram from Excel Using VB", "body": "<p>Sorry I can't embed images, I have the links instead (... I can only post two links. I have removed the http:// substring from   some of the links).</p>\n\n<p>I am looking to take an .csv file (really, any file, as I am generating this myself), and create a Visio (2010) diagram out of it. I have successfully imported the excel sheet to Visio, and can create some rough diagrams, but they are not enough. This is what I'm trying to <a href=\"http://imgur.com/g5hVycA\" rel=\"nofollow\">create</a>. Here are the following tactics I have tried, I prefer the VB method, but whatever works works:</p>\n\n<p><strong>Data Graphics:</strong> This is the closest I've gotten to a solution. Basically you create shapes and you can put data in it. Problem is, the style of display available are limited, as we can see here (imgur.com/clTLcxk). After importing the excel sheet, all I had to do was drag and drop to create these shapes. The closest I have gotten is <a href=\"http://imgur.com/ZkT2IOW\" rel=\"nofollow\" title=\"here\">here</a>. However, I really need the outside box (or container, for aesthetic reasons). (Some information here [support.office.com/en-us/article/Enhance-your-data-with-data-graphics-45af64a4-1dcb-4463-9a7e-67709786181c])</p>\n\n<p><strong>VB:</strong> I have been using this (msdn.microsoft.com/en-us/library/office/ff959245%28v=office.14%29.aspx). I have ran some of the example code, but I am really lost. I have run some of the example code but the only one I have really gotten to work are useless to me. Also, I don't see any API methods that actually add data to these diagrams!  </p>\n\n<p>So how is this done?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "is_accepted": false, "score": 1, "last_activity_date": 1443568662, "creation_date": 1443568662, "answer_id": 32855256, "question_id": 32855076, "link": "https://stackoverflow.com/questions/32855076/get-the-name-of-a-query-from-an-access-table-then-run-the-query/32855256#32855256", "title": "get the name of a query from an access table, then run the query", "body": "<p>Your code will loop through, even if you found your query and you do not pass the Query-Name to the OpenQuery command...  This won't work...</p>\n\n<p>The collection <code>CurrentDb.QueryDefs</code> knows all existing queries, but there is no \"Exists\" or \"Contains\" method.</p>\n\n<p>So: The approach would be a loop (as you tried it) or an Error handling.</p>\n\n<p>It's quite a time ago since I've coded with VBA, but I think you could try:</p>\n\n<pre><code>On Error Resume Next\nDoCmd.OpenQuery \"YourQueryName\"\nIf Err Then\n    MsgBox(\"The query does not exist!\")\n    Err.Clear\nEnd If\nOn Error Goto 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "edited": false, "score": 0, "creation_date": 1443602701, "post_id": 32861020, "comment_id": 53555957, "body": "Your code would iterate through all rows of &quot;vol&quot; and open all queries. The first not existing query name will break into err_MySub and that&#39;s it. I&#39;m quite sure that this is not what the OP wants..."}, {"owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "reply_to_user": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "edited": false, "score": 0, "creation_date": 1443603277, "post_id": 32861020, "comment_id": 53556351, "body": "As far as I understood, he has a query which fills the &quot;FacilityVolume&quot; table with all query names which should be opened. So each query which is listed in the table has to be opened one after another. If it doesn&#39;t find a query, Access will raise the Error 7874 (MyDatabase can&#39;t find the object &quot;NotExistingQuery&quot;). This error is handled in err_MySub. If it occurs, it will show the Message &quot;The Query xyz wasn&#39;t found&quot; and resume at the next command which is vol.MoveNext. So the code won&#39;t stop at a missing query."}, {"owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "edited": false, "score": 0, "creation_date": 1443603841, "post_id": 32861020, "comment_id": 53556746, "body": "Ah, yes, missed that... Still I think, that the Do-Loop was not intended to iterate through a list and open many queries. But you could be right with your assumption..."}, {"owner": {"reputation": 11, "user_id": 5390676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66d950c11b9ec617caa856bf44efe25?s=128&d=identicon&r=PG&f=1", "display_name": "HelpNeeded", "link": "https://stackoverflow.com/users/5390676/helpneeded"}, "reply_to_user": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "edited": false, "score": 0, "creation_date": 1443622255, "post_id": 32861020, "comment_id": 53568586, "body": "@Shnugo, thanks for the code.  I tried running it and received a compile error - &quot;label not defined&quot;.  It highlighted the On Error GoTo err_MySub line (2nd line).  Any suggestions?"}, {"owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "edited": false, "score": 0, "creation_date": 1443626631, "post_id": 32861020, "comment_id": 53571587, "body": "Sorry, there is an <code>End Sub</code> under the <code>Loop</code> statement. I didn&#39;t notice that. You have to delete it. Also you may want to run <code>DoCmd.SetWarnings False</code> somewhere at the beginning of the Sub. Otherwise it will ask you if you really want to run the query for every query in the list. Don&#39;t forget to set warnings to true when you&#39;re finished."}], "tags": [], "owner": {"reputation": 423, "user_id": 5078272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99538cdddfbf3b847875d971756fa70?s=128&d=identicon&r=PG&f=1", "display_name": "Dorian", "link": "https://stackoverflow.com/users/5078272/dorian"}, "is_accepted": false, "score": 1, "last_activity_date": 1443626730, "last_edit_date": 1443626730, "creation_date": 1443600497, "answer_id": 32861020, "question_id": 32855076, "link": "https://stackoverflow.com/questions/32855076/get-the-name-of-a-query-from-an-access-table-then-run-the-query/32861020#32861020", "title": "get the name of a query from an access table, then run the query", "body": "<p>The answer of @Shnugo is already good. Just to give you a complete VBA function, this should be working for you.</p>\n\n<pre><code>Public Sub MySub()\nOn Error GoTo err_mySub \nDim db as Database\nDim vol as Recordset\n\nSet db = CurrentDb()\nSet vol = db.OpenRecordset(\"FacilityVolume\", dbOpenDynaset) ' I don't know if you want to run all queries of the table \"FacilityVolume\". \n'So maybe you could also use something like \"SELECT Volume FROM FacilityVolume WHERE Volume LIKE \"\"*10*\"\"\"\n\nVol.MoveFirst\nDo Until vol.EOF = True\n    DoCmd.OpenQuery vol!Volume\n    vol.MoveNext\nLoop\n\nexit_MySub:\nExit Sub\n\nerr_MySub:\nIf Err.Number = 7874 Then\n    MsgBox \"The Query \"\"\" &amp; Vol!Volume &amp; \"\"\" wasn't found.\"\n    Resume Next\nElse\n    MsgBox Err.Description\n    Resume exit_MySub\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 704, "user_id": 4999393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8b5ed2ea0bdebd8989c9122f6c7c22?s=128&d=identicon&r=PG&f=1", "display_name": "Jericho Johnson", "link": "https://stackoverflow.com/users/4999393/jericho-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1443623829, "creation_date": 1443623829, "answer_id": 32868929, "question_id": 32855076, "link": "https://stackoverflow.com/questions/32855076/get-the-name-of-a-query-from-an-access-table-then-run-the-query/32868929#32868929", "title": "get the name of a query from an access table, then run the query", "body": "<p>I recommend using full DAO in VBA to accomplish your goal.  <code>DoCmd.OpenQuery</code> is really a VBA function that mimics the Macro <code>RunQuery</code> action.  You don't get much control or true error handling capability.</p>\n\n<p>Here is a complete code function that</p>\n\n<ol>\n<li>Gives you an example of how to select all or some records from your table that lists the queries, including the ability to only select \"Active\" records, and even sort them in a particular execution sequence</li>\n<li>Handles the instances where the query name in your table does not exist</li>\n<li>Allows you to display a message about any errors that occur</li>\n<li>Allows you to return an exit code to the calling procedure so that you can possibly act on the results of running these queries (such as choosing not to do the next step in your code if this function encounters an error of any kind (returns a non-zero value)</li>\n</ol>\n\n<p>Here is the code.  You will need to modify the SQL statement for your correct table name and field names, but this should be a good example to get you on your way.</p>\n\n<pre><code>Public Function lsProcessQuerySet() As Long\nOn Error GoTo Err_PROC\n    Dim ErrMsg As String\n    Dim db As DAO.Database\n    Dim rstEdits As DAO.Recordset\n    Dim qdf As DAO.QueryDef\n    Dim mssql As String\n    Dim ReturnCode As Long\n\n    Set db = CurrentDb()\n    '============================\n    'Select the list of Queries you want to process\n    '============================\n    mssql = \"SELECT tblQueryList.ID, tblQueryList.QueryName, \"\n    mssql = mssql &amp; \"tblQueryList.QueryShortDesc \"\n    mssql = mssql &amp; \"FROM tblQueryList \"\n    mssql = mssql &amp; \"WHERE tblQueryList.QueryActive = True \"\n    mssql = mssql &amp; \"ORDER BY tblQueryList.SortOrder;\"\n    Set rstEdits = db.OpenRecordset(mssql, dbOpenDynaset)\n    DoCmd.Hourglass True\n    '============================\n    'Execute each query, allowing processing to continue\n    'if the query does not exist (an error occurs)\n    '============================\n    Do While Not rstEdits.EOF\n        Set qdf = db.QueryDefs(rstEdits(\"QueryName\"))\n        qdf.Execute dbSeeChanges\nResumeNextEdit:\n        rstEdits.MoveNext\n    Loop\n    rstEdits.Close\n\nExit_PROC:\n    lsProcessQuerySet = ReturnCode\n    Set qdf = Nothing\n    Set rstEdits = Nothing\n    db.Close\n    Set db = Nothing\n    DoCmd.Hourglass False\n    Exit Function\n\nErr_PROC:\n    Select Case Err.Number\n        Case 3265   'Item Not Found in this Collection\n            ReturnCode = Err.Number\n            ErrMsg = \"Query Not Found:\" &amp; vbCrLf &amp; vbCrLf\n            ErrMsg = ErrMsg &amp; rstEdits(\"QueryName\")\n            DoCmd.Hourglass False\n            MsgBox ErrMsg, vbOKOnly + vbCritical, \"Function lsProcessQuerySet\"\n            Resume ResumeNextEdit\n        Case Else\n            ReturnCode = Err.Number\n            ErrMsg = \"Error: \" &amp; Err.Number &amp; vbCrLf\n            ErrMsg = ErrMsg &amp; Err.Description\n            DoCmd.Hourglass False\n            MsgBox ErrMsg, vbOKOnly + vbCritical, \"Function lsProcessQuerySet\"\n            Resume Exit_PROC\n    End Select\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5390676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66d950c11b9ec617caa856bf44efe25?s=128&d=identicon&r=PG&f=1", "display_name": "HelpNeeded", "link": "https://stackoverflow.com/users/5390676/helpneeded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1594643588, "creation_date": 1443567428, "last_edit_date": 1594643588, "question_id": 32855076, "link": "https://stackoverflow.com/questions/32855076/get-the-name-of-a-query-from-an-access-table-then-run-the-query", "title": "get the name of a query from an access table, then run the query", "body": "<p>I have an access db that pulls volumes from a table of exceptions.  Each volume has an ID.  I've created queries to pull details, for all possible volumes, and saved each one with the same name as each volume ID.  Each time the volume exceptions are pulled into this db, the volume IDs can change. So, there is a query that runs that updates the volume table with the new IDs.</p>\n\n<p>Unless you know a way to do this with a query, I need to write Access VBA code that will loop through the volume table, identify the name of each query and then run those queries until it reaches the end of the table. For example, the code needs to look at the first record in the volume table, say it is 1040.  This is the name of the query that needs to run. The code then needs to find the query named 1040 and run it.  It is a make table query.   </p>\n\n<p>The table name is FacilityVolume and it has one field named Volume.  The value in the field is shorttext format even though it is numeric.    </p>\n\n<p>I've tried a couple of different things.  Here is my latest try.  </p>\n\n<pre><code>    Dim db as Database\n    Dim vol as Recordset\n    Dim code as QueryDef\n\n    Set db = CurrentDb()\n    Set vol = db.OpenRecordset(\"FacilityVolume\")\n    Set Volume = vol.Fields(\"Volume\")\n\n    Vol.MoveFirst\n    Do Until vol.EOF = True\n        If QueryDef.Name = Volume Then\n           DoCmd.OpenQuery\n        Else MsgBox(\"The query does not exist\")\n        vol.MoveNext\n    Loop\n    End Sub\n</code></pre>\n\n<p>I've searched the internet for a few days and can't find any reference to this particular code.  I'm sure other users would like to know how to do this.  I'm a novice and still learning VBA so any help you can provide is greatly appreciated.</p>\n"}, {"tags": ["vba", "loops", "copy", "copy-paste", "worksheet"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5390629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b23775803c6bad32990b3fe6055b79f?s=128&d=identicon&r=PG&f=1", "display_name": "Toby Kim", "link": "https://stackoverflow.com/users/5390629/toby-kim"}, "edited": false, "score": 0, "creation_date": 1443564765, "post_id": 32854475, "comment_id": 53542911, "body": "Thank you so much!! Saved my life. It works perfectly"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 3, "user_id": 5390629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b23775803c6bad32990b3fe6055b79f?s=128&d=identicon&r=PG&f=1", "display_name": "Toby Kim", "link": "https://stackoverflow.com/users/5390629/toby-kim"}, "edited": false, "score": 0, "creation_date": 1443565014, "post_id": 32854475, "comment_id": 53543012, "body": "@TobyKim You are welcome. Glad it helped :). Please dont forget to check the answered button to close the topic."}, {"owner": {"reputation": 3, "user_id": 5390629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b23775803c6bad32990b3fe6055b79f?s=128&d=identicon&r=PG&f=1", "display_name": "Toby Kim", "link": "https://stackoverflow.com/users/5390629/toby-kim"}, "edited": false, "score": 0, "creation_date": 1443630605, "post_id": 32854475, "comment_id": 53574241, "body": "I have been looking for the answered button but i cant find it.. first time user"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 3, "user_id": 5390629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b23775803c6bad32990b3fe6055b79f?s=128&d=identicon&r=PG&f=1", "display_name": "Toby Kim", "link": "https://stackoverflow.com/users/5390629/toby-kim"}, "edited": false, "score": 0, "creation_date": 1443658902, "post_id": 32854475, "comment_id": 53586300, "body": "@TobyKim please take a look here: <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\" title=\"how does accepting an answer work\">meta.stackexchange.com/questions/5234/&hellip;</a>"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1443564018, "creation_date": 1443564018, "answer_id": 32854475, "question_id": 32854235, "link": "https://stackoverflow.com/questions/32854235/copy-from-multiple-sheets-and-paste-into-sheet-1/32854475#32854475", "title": "Copy from multiple sheets and paste into sheet 1", "body": "<p>Inside your loop, you are copying from the <code>ActiveSheet</code>, not from <code>ws</code>. if the activeSheet is \"table 1\" (in fact, you activate table 1 yourself in the statement <code>Worksheets(\"Table 1\").Activate</code>), then of course if will keep copying from it.</p>\n\n<p>Besides, it is always better to copy directly from ranges without using Activate  and Select. I guess this is what you want to do:</p>\n\n<pre><code>With Worksheets(\"Table 1\")\n    For Each ws In ThisWorkbook.Worksheets\n        If ws.Name &lt;&gt; \"Table 1\" Then\n            For i = 1 To 5000\n                If IsEmpty(.Cells(i, 1)) And IsEmpty(.Cells(i + 1, 1)) Then\n                    ws.Range(\"A15:X35\").Copy .Cells(i, 1)\n                    Exit For\n                End If\n            Next i\n        End If\n    Next ws\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5390629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b23775803c6bad32990b3fe6055b79f?s=128&d=identicon&r=PG&f=1", "display_name": "Toby Kim", "link": "https://stackoverflow.com/users/5390629/toby-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 32854475, "answer_count": 1, "score": 0, "last_activity_date": 1443564018, "creation_date": 1443562828, "last_edit_date": 1443563532, "question_id": 32854235, "link": "https://stackoverflow.com/questions/32854235/copy-from-multiple-sheets-and-paste-into-sheet-1", "title": "Copy from multiple sheets and paste into sheet 1", "body": "<p>I am trying to get data from multiple worksheets and paste into sheet 1 but my code isnt working properly. It keeps copying from the sheet \"table 1\" over and over again. Does anyone know what is wrong with my code?</p>\n\n<p>Thanks</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\nDim ws As Worksheet\nDim i As Integer\n\n    For Each ws In ThisWorkbook.Worksheets\n        If ws.Name &lt;&gt; \"Table 1\" Then\n\n            ActiveSheet.Range(\"A15:X35\").Select\n            Selection.Copy\n\n            Worksheets(\"Table 1\").Activate\n\n                For i = 1 To 5000\n\n                    If IsEmpty(Cells(i, 1)) = True And IsEmpty(Cells(i + 1, 1)) = True Then\n                    ActiveSheet.Cells(i, 1).Select\n                    ActiveSheet.Paste\n                    Exit For\n                    End If\n\n                Next i\n\n        End If\n    Next ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1443561495, "post_id": 32853816, "comment_id": 53541577, "body": "Don&#39;t use <code>Date</code> as variable, since it&#39;s predefined function, returning current date."}, {"owner": {"reputation": 2421, "user_id": 369619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a229f6bec8489362b3b3c8debc8a08f6?s=128&d=identicon&r=PG&f=1", "display_name": "Cannon", "link": "https://stackoverflow.com/users/369619/cannon"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1443561953, "post_id": 32853816, "comment_id": 53541777, "body": "I have updated ref code."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1443562102, "post_id": 32853816, "comment_id": 53541844, "body": "You can use a couple of scripting dictionary objects to map dates to column/row numbers.  Are the column/row headers pre-defined, or are you populating them from the list (array?) of objects?"}, {"owner": {"reputation": 2421, "user_id": 369619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a229f6bec8489362b3b3c8debc8a08f6?s=128&d=identicon&r=PG&f=1", "display_name": "Cannon", "link": "https://stackoverflow.com/users/369619/cannon"}, "edited": false, "score": 0, "creation_date": 1443562187, "post_id": 32853816, "comment_id": 53541886, "body": "Row/col headers arent predefined. They need to be populated based on object values. So dynamic"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1443562225, "post_id": 32853816, "comment_id": 53541908, "body": "Are the objects in the array sorted in any way?"}, {"owner": {"reputation": 2421, "user_id": 369619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a229f6bec8489362b3b3c8debc8a08f6?s=128&d=identicon&r=PG&f=1", "display_name": "Cannon", "link": "https://stackoverflow.com/users/369619/cannon"}, "edited": false, "score": 0, "creation_date": 1443562339, "post_id": 32853816, "comment_id": 53541949, "body": "Not sorted. But I can do a sort after service call by attribute Date1 or Date2."}], "answers": [{"comments": [{"owner": {"reputation": 2421, "user_id": 369619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a229f6bec8489362b3b3c8debc8a08f6?s=128&d=identicon&r=PG&f=1", "display_name": "Cannon", "link": "https://stackoverflow.com/users/369619/cannon"}, "edited": false, "score": 0, "creation_date": 1443567641, "post_id": 32854614, "comment_id": 53543869, "body": "That is perfect. I will post the tested version of it. Many thanks."}, {"owner": {"reputation": 2421, "user_id": 369619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a229f6bec8489362b3b3c8debc8a08f6?s=128&d=identicon&r=PG&f=1", "display_name": "Cannon", "link": "https://stackoverflow.com/users/369619/cannon"}, "edited": false, "score": 0, "creation_date": 1443629397, "post_id": 32854614, "comment_id": 53573454, "body": "What if I have slight different object structure? Date1,Date2,Val1,Val2? I have edited question. or that needs separate question?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 2421, "user_id": 369619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a229f6bec8489362b3b3c8debc8a08f6?s=128&d=identicon&r=PG&f=1", "display_name": "Cannon", "link": "https://stackoverflow.com/users/369619/cannon"}, "edited": false, "score": 0, "creation_date": 1443634206, "post_id": 32854614, "comment_id": 53576208, "body": "Try adapting the example I wrote, and post a new question with your code if you run into problems."}, {"owner": {"reputation": 2421, "user_id": 369619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a229f6bec8489362b3b3c8debc8a08f6?s=128&d=identicon&r=PG&f=1", "display_name": "Cannon", "link": "https://stackoverflow.com/users/369619/cannon"}, "edited": false, "score": 0, "creation_date": 1443639084, "post_id": 32854614, "comment_id": 53578793, "body": "That was helpful. I just created dict using concated dates. I will update my answer for both scenarios."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1443585339, "last_edit_date": 1443585339, "creation_date": 1443564646, "answer_id": 32854614, "question_id": 32853816, "link": "https://stackoverflow.com/questions/32853816/data-range-transformation/32854614#32854614", "title": "data range transformation", "body": "<p>Untested, but something like this:</p>\n\n<pre><code>Sub Test()\n\n    Dim points, i As Long, r As Long, c As Long\n    Dim dictRows, dictCols, grid(0, 0)\n    'dictionary to map \"key\" values to row numbers\n    Set dictRows = CreateObject(\"scripting.dictionary\")\n    'dictionary to map \"key\" values to column numbers\n    Set dictCols = CreateObject(\"scripting.dictionary\")\n\n    points = getPoints()\n    r = 0\n    c = 0\n\n    '[sort points by date1 here]\n    'map date1 to \"row\"\n    For i = LBound(points) To UBound(points)\n        If Not dictRows.exists(points(i).date1) Then\n            r = r + 1\n            dictRows.Add points(i).date1, r\n        End If\n    Next i\n    '[sort points by date2 here]\n    'map date2 to \"column\"\n    For i = LBound(points) To UBound(points)\n        If Not dictCols.exists(points(i).date2) Then\n            c = c + 1\n            dictCols.Add points(i).date2, c\n        End If\n    Next i\n\n    ReDim grid(1 To r, 1 To c)\n\n    For i = LBound(points) To UBound(points)\n        grid(dictRows(points(i).date1), dictCols(points(i).date2)) = points(i).Value\n    Next i\n\n    'populate on worksheet\n    With ActiveSheet\n        .Range(\"A2\").Resize(r, 1).Value = Application.Transpose(dictRows.keys)\n        .Range(\"B2\").Resize(r, c).Value = grid\n        .Range(\"B1\").Resize(1, c).Value = dictCols.keys\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2421, "user_id": 369619, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a229f6bec8489362b3b3c8debc8a08f6?s=128&d=identicon&r=PG&f=1", "display_name": "Cannon", "link": "https://stackoverflow.com/users/369619/cannon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 32854614, "answer_count": 1, "score": 0, "last_activity_date": 1447182190, "creation_date": 1443561015, "last_edit_date": 1447182190, "question_id": 32853816, "link": "https://stackoverflow.com/questions/32853816/data-range-transformation", "title": "data range transformation", "body": "<p>I have a list of objects that is being returned from service call.</p>\n\n<pre><code>Object has below attributes:\nDateVal1\nDateVal2\nValue\n</code></pre>\n\n<p>How do I assign object to range as 2D matrix range:\nDate1 as column, Date2 as header row</p>\n\n<p>If there is object with row,column combination print value else print NA.</p>\n\n<p>Data can be large (Max 30x30) so trying to avoid lookup in list every time.</p>\n\n<pre><code>Date     1/31/2015 2/28/2015 3/31/2015\n1/1/2015 1         NA         NA\n1/2/2015 NA        2          NA\n1/3/2015 NA        NA         3\n</code></pre>\n\n<p>What if this is slight different?</p>\n\n<pre><code> Object has below attributes:\n    DateVal1\n    DateVal2\n    Value1\n    Value2\n</code></pre>\n\n<p>And desired o/p is this:</p>\n\n<pre><code>Date1     Date2             110        20         30\n1/1/2015  1/10/2015          1         NA         NA\n1/2/2015  1/20/2015         NA         2          NA\n1/3/2015  1/31/2015         NA         NA         3\n</code></pre>\n"}, {"tags": ["vba", "excel", "worksheet"], "comments": [{"owner": {"reputation": 1, "user_id": 5390482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125b28db78708045ca3d9e73844a11d9?s=128&d=identicon&r=PG&f=1", "display_name": "user5390482", "link": "https://stackoverflow.com/users/5390482/user5390482"}, "edited": false, "score": 0, "creation_date": 1443559580, "post_id": 32853410, "comment_id": 53540501, "body": "I also need to automatically fill the new worksheet with information from the &quot;Summary&quot; worksheet. any ideas?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5390482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125b28db78708045ca3d9e73844a11d9?s=128&d=identicon&r=PG&f=1", "display_name": "user5390482", "link": "https://stackoverflow.com/users/5390482/user5390482"}, "edited": false, "score": 0, "creation_date": 1443561086, "post_id": 32853572, "comment_id": 53541361, "body": "Thanks, unfortunately it still stops when it hits two empty cells in a row"}], "tags": [], "owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "is_accepted": false, "score": 0, "last_activity_date": 1443561446, "last_edit_date": 1443561446, "creation_date": 1443560058, "answer_id": 32853572, "question_id": 32853410, "link": "https://stackoverflow.com/questions/32853410/create-new-worksheet-based-on-cell-but-ignore-empty-cell/32853572#32853572", "title": "Create new worksheet based on cell but ignore empty cell", "body": "<p>replace</p>\n\n<pre><code>Set MyRange = Sheets(\"Summary\").Range(\"C4\")\nSet MyRange = Range(MyRange, MyRange.End(xlDown))\n\nFor Each MyCell In MyRange\n    Sheets.Add after:=Sheets(Sheets.Count) 'creates a new workbook\n    Sheets(Sheets.Count).Name = MyCell.Value 'renames the new workbook\nNext MyCell\n</code></pre>\n\n<p>by </p>\n\n<pre><code>set MyRange=range(sheets(\"Summary\").[c4],sheets(\"Summary\").cells(rows.count,\"C\").end(xlup))\n\nFor Each MyCell In MyRange\n    if len(mycell.text)&gt;0 then \n        Sheets.Add after:=Sheets(Sheets.Count) 'creates a new workbook\n        Sheets(Sheets.Count).Name = MyCell.Value 'renames the new workbook\n    end if\nNext MyCell\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5390482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125b28db78708045ca3d9e73844a11d9?s=128&d=identicon&r=PG&f=1", "display_name": "user5390482", "link": "https://stackoverflow.com/users/5390482/user5390482"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1256, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443561446, "creation_date": 1443559361, "last_edit_date": 1443561186, "question_id": 32853410, "link": "https://stackoverflow.com/questions/32853410/create-new-worksheet-based-on-cell-but-ignore-empty-cell", "title": "Create new worksheet based on cell but ignore empty cell", "body": "<p>I would like to create a new worksheet in my workbook; name based on the information in the C column (starting at C4) of the \"Summary\" Worksheet. I have the following VBA so far but when it gets to a blank cell it stops. I need it to ignore blank cells and continue. Any help?</p>\n\n<pre><code>Sub CreateSheetsFromAListTEST()\n\nDim MyCell As Range, MyRange As Range\n\nSet MyRange = Sheets(\"Summary\").Range(\"C4\")\nSet MyRange = Range(MyRange, MyRange.End(xlDown))\n\nFor Each MyCell In MyRange\nSheets.Add after:=Sheets(Sheets.Count) 'creates a new workbook\nSheets(Sheets.Count).Name = MyCell.Value 'renames the new workbook\nNext MyCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "combinations", "vba"], "comments": [{"owner": {"reputation": 713, "user_id": 2321104, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b301526acaf0c9b25363cafb77e77d56?s=128&d=identicon&r=PG", "display_name": "AndrewB", "link": "https://stackoverflow.com/users/2321104/andrewb"}, "edited": false, "score": 0, "creation_date": 1443559447, "post_id": 32853339, "comment_id": 53540440, "body": "I imagine there are no prebuilt functions for something so specific. Are you asking for the code? Have you made an attempt at it?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443562391, "post_id": 32853339, "comment_id": 53541984, "body": "Maybe something like <a href=\"http://stackoverflow.com/questions/31454110/the-brute-force-method-using-vba-for-solving-an-equation-with-nine-unknown-varia?s=3|0.0454\">this</a>?"}, {"owner": {"reputation": 89, "user_id": 3574547, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/M2s79.jpg?s=128&g=1", "display_name": "user3574547", "link": "https://stackoverflow.com/users/3574547/user3574547"}, "edited": false, "score": 0, "creation_date": 1443587219, "post_id": 32853339, "comment_id": 53548923, "body": "AndrewB--I haven&#39;t tried anything in code yet.  Partly because I was hoping that there might be some built in functions that would make coding unnecessary, and partly because I don&#39;t think I&#39;d have any idea where to start with the coding given my limited skill with VBA.  I spent some time trying it by hand on paper to see if ideas for coding would become obvious.  No luck."}], "answers": [{"tags": [], "owner": {"reputation": 832, "user_id": 5350218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kn49B.jpg?s=128&g=1", "display_name": "Bas Verlaat", "link": "https://stackoverflow.com/users/5350218/bas-verlaat"}, "is_accepted": false, "score": 2, "last_activity_date": 1443639294, "last_edit_date": 1443639294, "creation_date": 1443566440, "answer_id": 32854921, "question_id": 32853339, "link": "https://stackoverflow.com/questions/32853339/creating-combinations-using-excel/32854921#32854921", "title": "Creating combinations using Excel", "body": "<p>I built a binary evaluator:</p>\n\n<pre><code>Public Sub DebugAllCombinations(lPickSize As Long, sPossibilities As String, Optional sDelimiter As String = \";\")\n\n    Dim i                   As Long\n    Dim j                   As Long\n    Dim sBIN                As String\n    Dim aPossibilities()    As String\n    Dim lSum                As Long\n    Dim lHitCount           As Long\n\n    aPossibilities = Split(sPossibilities, sDelimiter)\n\n    For i = 1 To 2 ^ (UBound(aPossibilities) + 1) - 1\n        lSum = 0\n        sBIN = WorksheetFunction.Dec2Bin(i)\n        For j = 1 To Len(sBIN)\n            lSum = lSum + CLng(Mid(sBIN, j, 1))\n        Next j\n        If lSum = lPickSize Then\n            For j = 1 To Len(sBIN)\n                If Mid(sBIN, j, 1) = \"1\" Then Debug.Print aPossibilities(Len(sBIN) - j) &amp; sDelimiter;\n            Next j\n            Debug.Print\n            lHitCount = lHitCount + 1\n        End If\n    Next i\n\n    Debug.Print lHitCount &amp; \" possibilities found\"\n\nEnd Sub\n</code></pre>\n\n<p>You can use it like this</p>\n\n<pre><code>DebugAllCombinations 4, \"Person1;Person2;Person3;Person4;Person5;Person6;Person7;Person8\"\n</code></pre>\n\n<p>It will debug in the immediate window</p>\n"}, {"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": false, "score": 0, "last_activity_date": 1443613689, "last_edit_date": 1443613689, "creation_date": 1443609284, "answer_id": 32863917, "question_id": 32853339, "link": "https://stackoverflow.com/questions/32853339/creating-combinations-using-excel/32863917#32863917", "title": "Creating combinations using Excel", "body": "<p>Not tested, but if I understood your question right I think this should do it:</p>\n\n<pre><code>Sub combinationEnumeration(pool As String, elements As Integer, Optional delim As String)\nDim poolArray() As String, result As String\n\nIf delim = \"\" Then delim = \";\"\npoolArray = Split(pool, delim)\n\nresult = \"Selection pool: \" &amp; pool &amp; vbCr &amp; \"Number of selected elements: \" &amp; elements &amp; vbCr &amp; vbCr &amp; \"Result:\" &amp; vbCr\n\nFor i = 0 To UBound(poolArray) - 3\n    For j = i + 1 To UBound(poolArray) - 2\n        For k = j + 1 To UBound(poolArray)) - 1\n            For l = k + 1 To UBound(poolArray)\n                result = result &amp; poolArray(i) &amp; poolArray(j) &amp; poolArray(k) &amp; poolArray(l) &amp; \";\" &amp; vbCr\n            Next l\n        Next k\n    Next j\nNext i\n\nDebug.Print result\nEnd Sub\n</code></pre>\n\n<p>Usage: <code>Call combinationEnumeration(\"A;B;C;D;E;F;G;H\", 4)</code></p>\n\n<p>EDIT: Fixed small error. Code is correct now and outputs the expected number of results. You will get 70 lines, which you can double check by solving the binomial <code>C(8,4)</code>: <a href=\"http://www.wolframalpha.com/input/?i=c%288%2C4%29\" rel=\"nofollow\">http://www.wolframalpha.com/input/?i=c%288%2C4%29</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 3992, "user_id": 1330560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4869869f3ab6b5c0dd7d4affddf113?s=128&d=identicon&r=PG&f=1", "display_name": "Tedinoz", "link": "https://stackoverflow.com/users/1330560/tedinoz"}, "edited": false, "score": 0, "creation_date": 1570083996, "post_id": 58210091, "comment_id": 102803373, "body": "Welcome. Although code answers are acceptable can you add some explanation.  Remember, you answer will be read by people in the future so you need to add a description so that they can understand your solution."}, {"owner": {"reputation": 26057, "user_id": 2469308, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f313d606d93f59980b6504d64dc8182e?s=128&d=identicon&r=PG&f=1", "display_name": "Madhur Bhaiya", "link": "https://stackoverflow.com/users/2469308/madhur-bhaiya"}, "edited": false, "score": 0, "creation_date": 1570086055, "post_id": 58210091, "comment_id": 102804152, "body": "Please add some explanation to your code only answer, for future users."}], "tags": [], "owner": {"reputation": 1, "user_id": 4956030, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mnWDnGIJkR8/AAAAAAAAAAI/AAAAAAAAHG4/1X5GD16zTm4/photo.jpg?sz=128", "display_name": "Fran&#231;ois H Leblanc", "link": "https://stackoverflow.com/users/4956030/fran%c3%a7ois-h-leblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1570056221, "last_edit_date": 1570056221, "creation_date": 1570055108, "answer_id": 58210091, "question_id": 32853339, "link": "https://stackoverflow.com/questions/32853339/creating-combinations-using-excel/58210091#58210091", "title": "Creating combinations using Excel", "body": "<p><code>=COMBIN(number, number_chosen)</code></p>\n"}], "owner": {"reputation": 89, "user_id": 3574547, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/M2s79.jpg?s=128&g=1", "display_name": "user3574547", "link": "https://stackoverflow.com/users/3574547/user3574547"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1570056221, "creation_date": 1443559080, "last_edit_date": 1531161705, "question_id": 32853339, "link": "https://stackoverflow.com/questions/32853339/creating-combinations-using-excel", "title": "Creating combinations using Excel", "body": "<p>I was wondering if there is a function, or combination of functions (maybe it requires VBA) in Excel that will help me solve the following problem:</p>\n\n<p>There are 8 people in the group.  I need to figure out and display all of the possible, non-repeating combinations created when 4 people are selected out of the 8.  The order of the selected individuals isn\u2019t important.  I just need to find all of the unique combinations.</p>\n\n<p>For example:\nThe 8 people are Bob, Carol, Ted, Alice, Reed, Sue, Johnny, Ben (Cells A1 through A8 each contain one of the names).</p>\n\n<p>One combination is Bob, Ted, Reed, Johnny.  For my problem the order of the names isn\u2019t important meaning Bob, Ted, Reed, Johnny is the same as Ted, Bob, Johnny, Reed.  So any combination of those 4 people counts as one instance.</p>\n\n<p>I\u2019m not just trying to figure out how many combinations are possible.  I need to actually see the possible combinations.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1443559406, "post_id": 32853328, "comment_id": 53540422, "body": "<code>.Sheet</code> is not a property of the <code>Workbook</code> object?  Also, you may need to do <code>.Value = lastsavetime.value</code>"}, {"owner": {"reputation": 209, "user_id": 2754623, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8ba89180a5e67ace384ce2844a8de7fe?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/2754623/doug"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1443560259, "post_id": 32853328, "comment_id": 53540877, "body": "Good point on .Sheet for Workbook object. I added Workbooks(A) to make it clear where the data was going for purposes of the question but in reality I just have Sheet1.Range.... My apologies I can see how that was misleading. I will try the .Value = lastsavetime.value as you suggest."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1443560347, "post_id": 32853328, "comment_id": 53540932, "body": "It may also raise an error if the property hasn&#39;t been set, i.e., on a new/un-saved Workbook."}], "answers": [{"tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": false, "score": 1, "last_activity_date": 1443570336, "last_edit_date": 1443570336, "creation_date": 1443569864, "answer_id": 32855427, "question_id": 32853328, "link": "https://stackoverflow.com/questions/32853328/vba-builtindocumentproperties/32855427#32855427", "title": "VBA BuiltInDocumentProperties", "body": "<p>Try this:</p>\n\n<pre><code>Workbooks(A).Worksheets(\"Sheet1\").Range(lastsave).Formula = Workbooks(B).BuiltinDocumentProperties(\"Last Save Time\")\n</code></pre>\n\n<p>Here:<br>\n<code>A</code> is a string holding the name of your destination wb (\"SaveTimeLog.xlsx\")<br>\n<code>B</code> is a string holding the name of the wb for which you're capturing last save time e.g. \"MyWB.xlsx\"<br>\n<code>Sheet1</code> is the name of the worksheet where you want to write last save time e.g. \"Sheet1\"<br>\n<code>lastsave</code> is a string holding a reference to the cell where the info goes, e.g., \"G4\"  </p>\n\n<p>As is this will write last save time as a numeric value. To get it in a human-friendly format you can either format the destination cell as a date/time, or covert the right-hand side of the statement above by enclosing it in CStr().</p>\n\n<p><strong>FYI</strong> Workbooks(A).Sheet1 fails because Workbooks(A) is a workbook object. There is no Sheet1 method or property of a workbook object. </p>\n"}, {"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1443570165, "creation_date": 1443570165, "answer_id": 32855468, "question_id": 32853328, "link": "https://stackoverflow.com/questions/32853328/vba-builtindocumentproperties/32855468#32855468", "title": "VBA BuiltInDocumentProperties", "body": "<p>Assuming your workbook B is opened, this works for a module in workbook A.</p>\n\n<pre><code>ThisWorkbook.Names(\"lastsave\").RefersToRange.Value = Workbooks(B).BuiltinDocumentProperties(\"Last Save Time\").Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1443572808, "creation_date": 1443572808, "answer_id": 32855860, "question_id": 32853328, "link": "https://stackoverflow.com/questions/32853328/vba-builtindocumentproperties/32855860#32855860", "title": "VBA BuiltInDocumentProperties", "body": "<ul>\n<li><p>In errors 1, 3, 4 and 5: the object Workbook does not support the method Sheet1. Use <code>Workbooks(A).Sheets(1)</code></p></li>\n<li><p>In error 2 it should have been the same message. I cant tell why the error message had changed. Something went worng.</p></li>\n</ul>\n\n<p>All in all, it is the <code>.Sheet1</code> that is causing all this trouble. use <code>.sheets(1)</code> instead.</p>\n"}], "owner": {"reputation": 209, "user_id": 2754623, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8ba89180a5e67ace384ce2844a8de7fe?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/2754623/doug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1718, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1443572808, "creation_date": 1443559040, "last_edit_date": 1531164843, "question_id": 32853328, "link": "https://stackoverflow.com/questions/32853328/vba-builtindocumentproperties", "title": "VBA BuiltInDocumentProperties", "body": "<p>I have a macro that sits in WorkbookA and retrieves data from WorkbookB. I want to return the \"Last Save Time\" for WorkbookB and put it into a cell within WorkbookA. In the code below \"lastsave\" is a named range referring to a cell in WorkbookA.</p>\n\n<p>I have tried the following from various websites and similar questions but to no avail. I suspect the solution has to do with objects, items in a list, values, etc. but I cannot seem to put my finger on it.</p>\n\n<p>1) Error: Object Doesn't support this property or method</p>\n\n<pre><code> Dim lastsavetime as Object\n set lastsavetime = Workbooks(B).BuiltinDocumentProperties(\"Last Save Time\")\n Workbooks(A).Sheet1.Range(\"lastsave\").Value = lastsavetime\n</code></pre>\n\n<p>2) Error: Automation Error, Unspecified Error</p>\n\n<pre><code> Dim lastsavetime as variant\n set lastsavetime = Workbooks(B).BuiltinDocumentProperties(\"Last Save Time\")\n Workbooks(A).Sheet1.Range(\"lastsave\").Value = lastsavetime\n</code></pre>\n\n<p>3) Error: Method 'Value' of object 'DocumentProperty' failed</p>\n\n<pre><code> Workbooks(A).Sheet1.Range(\"lastsave\").Value = Workbooks(B).BuiltinDocumentProperties(\"Last Save Time\").Value\n</code></pre>\n\n<p>4) Error: Object Doesn't support this property or method</p>\n\n<pre><code> Workbooks(A).Sheet1.Range(\"lastsave\").Value = Workbooks(B).BuiltinDocumentProperties(\"Last Save Time\").Value\n</code></pre>\n\n<p>5) Error: Method 'Value' of object 'DocumentProperty' failed</p>\n\n<pre><code> Dim propertylist as DocumentProperties\n Set propertylist = Workbooks(B).BuiltinDocumentProperties\n\n Workbooks(A).Sheet1.Range(\"lastsave\").Value = (propertylist.Item(\"Last Save Time\"))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 5373621, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/94dc14a4cda18f09e8ed0d7f1237ce60?s=128&d=identicon&r=PG&f=1", "display_name": "IvnBam", "link": "https://stackoverflow.com/users/5373621/ivnbam"}, "edited": false, "score": 0, "creation_date": 1443562097, "post_id": 32853326, "comment_id": 53541840, "body": "Thank you!! Thank you very much :D Sorry for the late thanks, I was trying to figure out what the bIgnore did.. I had&#39;nt thought that when moving one scrollbar the other one moved too and both events would fire creating a conflict. That was the part I was missing. Thank you very much again @ExcelHero"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 2, "last_activity_date": 1443559034, "creation_date": 1443559034, "answer_id": 32853326, "question_id": 32852854, "link": "https://stackoverflow.com/questions/32852854/how-to-handle-events-of-a-frame-scrollbar/32853326#32853326", "title": "How to handle events of a Frame Scrollbar?", "body": "<p>Place all of the following into the userform code module:</p>\n\n<pre><code>Private bIgnore As Boolean\n\n\nPrivate Sub Frame1_Scroll(ByVal ActionX As MSForms.fmScrollAction, ByVal ActionY As MSForms.fmScrollAction, ByVal RequestDx As Single, ByVal RequestDy As Single, ByVal ActualDx As MSForms.ReturnSingle, ByVal ActualDy As MSForms.ReturnSingle)\n    If Not bIgnore Then\n        bIgnore = 1\n        Frame2.ScrollLeft = Frame1.ScrollLeft + ActualDx\n        bIgnore = 0\n    End If\nEnd Sub\n\n\nPrivate Sub Frame2_Scroll(ByVal ActionX As MSForms.fmScrollAction, ByVal ActionY As MSForms.fmScrollAction, ByVal RequestDx As Single, ByVal RequestDy As Single, ByVal ActualDx As MSForms.ReturnSingle, ByVal ActualDy As MSForms.ReturnSingle)\n    If Not bIgnore Then\n        bIgnore = 1\n        Frame1.ScrollLeft = Frame2.ScrollLeft + ActualDx\n        bIgnore = 0\n    End If\nEnd Sub\n</code></pre>\n\n<p>Note: this assumes your frames are named Frame1 and Frame2 and that both frames have been configured with the same ScrollWidth value.</p>\n"}], "owner": {"reputation": 127, "user_id": 5373621, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/94dc14a4cda18f09e8ed0d7f1237ce60?s=128&d=identicon&r=PG&f=1", "display_name": "IvnBam", "link": "https://stackoverflow.com/users/5373621/ivnbam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1473, "favorite_count": 0, "accepted_answer_id": 32853326, "answer_count": 1, "score": 2, "last_activity_date": 1443561325, "creation_date": 1443557188, "last_edit_date": 1443561325, "question_id": 32852854, "link": "https://stackoverflow.com/questions/32852854/how-to-handle-events-of-a-frame-scrollbar", "title": "How to handle events of a Frame Scrollbar?", "body": "<p>I have two frames on a userform and there's a picture on each frame, the pictures can be wider or higher than the frames and that's why I need the scrollbars. What I want to do is that when/if the user needs to use the horizontal scrollbar on say frame 1, the horizontal scrollbar on frame2 should take the same value. </p>\n\n<p>I was looking for something like: </p>\n\n<pre><code>Frame1.HorizontalScrollBar.Value\n</code></pre>\n\n<p>But that's not a property of the scrollbars. I found in a website that the event handler of a frame's scrollbar is: </p>\n\n<pre><code>Private Sub Frame1_Scroll(ByVal ActionX As MSForms.fmScrollAction, ByVal ActionY As MSForms.fmScrollAction, ByVal RequestDx As Single, ByVal RequestDy As Single, ByVal ActualDx As MSForms.ReturnSingle, ByVal ActualDy As MSForms.ReturnSingle) \n\nEnd sub\n</code></pre>\n\n<p>And I tried it but I can't figure out how to assign those values to the second horizontal scrollbar when the event is fired.</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 3792, "user_id": 4076315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e9c36091b47cc051f1a2e6b78afc83?s=128&d=identicon&r=PG&f=1", "display_name": "BSMP", "link": "https://stackoverflow.com/users/4076315/bsmp"}, "edited": false, "score": 0, "creation_date": 1443556403, "post_id": 32852450, "comment_id": 53538788, "body": "<i>Can someone direct me to what I need to search for?</i> - Why not just ask how to do it without reloading the form? You&#39;ve already described what you&#39;re trying to do."}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1443561289, "last_edit_date": 1443561289, "creation_date": 1443558022, "answer_id": 32853067, "question_id": 32852450, "link": "https://stackoverflow.com/questions/32852450/vba-userforms-excel/32853067#32853067", "title": "VBA / Userforms Excel", "body": "<p>use the \"Change\" event of the combobox A. Here is how you can adjust the combo B without reloading the form:</p>\n\n<pre><code>Private Sub ComboA_Change()\n    ComboB.Clear \n    If ComboA.Text = \"Pending\" Then\n        ComboB.AddItem (\"Damaged\") \n        ComboB.AddItem (\"New\") \n        ComboB.AddItem (\"Added\") \n    Else\n        ComboB.Text = \"Optional\" \n    Endif\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5390253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bbce88769ef3832e0afad3c482bbaf5?s=128&d=identicon&r=PG&f=1", "display_name": "Tom B", "link": "https://stackoverflow.com/users/5390253/tom-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 32853067, "answer_count": 1, "score": -3, "last_activity_date": 1443561289, "creation_date": 1443555668, "question_id": 32852450, "link": "https://stackoverflow.com/questions/32852450/vba-userforms-excel", "title": "VBA / Userforms Excel", "body": "<p>Not really sure how to search for what I am needing,  New to VBA and Userform.</p>\n\n<p>I have many boxes in my form,   with two,, combobox's, ones list is dependend on the selection of the first</p>\n\n<p>Say Combobox A options are:   \"On\", \"Off\", \"Locked\", and \"Pending\".\nWith Combobox B, If ComboBox A is selected as \"Pending\", then the options may be \"Damaged\", \"New\" or \"Added\",  all other options in Combobox A would cause B to simply show \"OPTIONAL\". (not actual combobox list's, just fictional options for simplified question)</p>\n\n<p>I have managed to get it to work, in sorts,  it works, based on the status of ComboBox A at time form is loaded.  However, If I change the Status of Combobox A  I have to save and exit / reload the form in order for Box B to see the change and updated based on my If then Else statement.</p>\n\n<p>Can someone direct me to what I need to search for?  The terminology used? or some direction?</p>\n\n<p>Thanks in advance.\nTom</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443555458, "post_id": 32852292, "comment_id": 53538259, "body": "You can either change macro1 to a function for use in macro2 or just move code from macro1 to macro2 then use <code>lastRow</code> in place of D360."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1443556612, "post_id": 32852292, "comment_id": 53538902, "body": "Just to be clear, use the <code>lastRow</code> in place of the <b>360</b> in D<b>360</b> like <code>&quot;D2:D&quot; &amp; lastRow</code>."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1443555769, "post_id": 32852405, "comment_id": 53538445, "body": "<code>Sub</code> can return values to objects passed <code>ByRef</code> :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1443556804, "post_id": 32852405, "comment_id": 53538996, "body": "@DavidZemens - but they cannot be concatenated into a string construction. The variable can be altered with a call to the helper sub procedure and the variable would have to be part of the range address&#39; string construction."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1443556897, "post_id": 32852405, "comment_id": 53539061, "body": "Correct @Jeeped I was just adding the comment for technicality&#39;s sake."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1443557017, "post_id": 32852405, "comment_id": 53539138, "body": "@DavidZemens -No worries. I&#39;m just trying to maintain complete clarity given the entry level of the question. Too easy to cause confusion when a user is just starting out."}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1443558219, "post_id": 32852405, "comment_id": 53539803, "body": "Actually that&#39;s a new one for me too. Thanks!"}], "tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": false, "score": 1, "last_activity_date": 1443555522, "creation_date": 1443555522, "answer_id": 32852405, "question_id": 32852292, "link": "https://stackoverflow.com/questions/32852292/vba-macros-code/32852405#32852405", "title": "VBA macros code", "body": "<p>You need to change the first sub into a function. Functions return values, whereas subs just run procedures.</p>\n\n<pre><code>Function sbLastRowOfDColumn()\n'Find the last Row with data in a Column\n'In this example we are finding the last row of column D\nDim lastRow As Long\nWith ActiveSheet\n    lastRow = .Cells(.Rows.Count, \"D\").End(xlUp).Row\nEnd With\n sbLastRowOfDColumn = lastrow 'this line sets the value that the function will return.\nEnd Function\n</code></pre>\n\n<p>Then, anywhere in your second macro that you need this value, instead of the number, just put <code>sbLastRowOfDColumn</code>. For example:</p>\n\n<p><code>Selection.AutoFill Destination:=Range(\"D2:D\" &amp; sbLastRowOfDColumn)</code></p>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1443556930, "post_id": 32852613, "comment_id": 53539084, "body": "<i>It really isn&#39;t clear on what you want to accomplish.</i>  I&#39;d wager this is because Macro Recorder :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1443556281, "last_edit_date": 1495540703, "creation_date": 1443556281, "answer_id": 32852613, "question_id": 32852292, "link": "https://stackoverflow.com/questions/32852292/vba-macros-code/32852613#32852613", "title": "VBA macros code", "body": "<p>It really isn't clear on what you want to accomplish. You put a values into A1 then immediately <code>.ClearContents</code> on the entire column A. There are other examples of this put-a-value-erase-a-value coding. I get that you recorded it, but you need to step through it and remove the lines that do nothing. Possibly, reorganize the steps that you need to accomplish and re-record it.</p>\n\n<p>Here is my attempt at cleaning up your code. I've commented a few spots that look like trouble.</p>\n\n<pre><code>Sub test()\n    Dim lr As Long\n    With ActiveSheet\n        lr = .Cells(Rows.Count, \"D\").End(xlUp).Row\n\n        .Columns(\"A:A\").ClearContents\n        .Range(\"A1\") = \"gdgs\"\n        .Range(\"A2\").FormulaR1C1 = \"6\"\n        .Range(\"A2:A\" &amp; lr).FillDown    '&lt;~~see how lr is used\n\n        .Range(\"B1\") = \"dgdgsg\"\n        .Range(\"C1\") = \"gdsgsdgsd\"\n        .Range(\"D1\") = \"sdgsdgsfh\"    '&lt;~~this gets cleared further down\n\n        .Columns(\"E:E\").Delete Shift:=xlToLeft\n        .Range(\"E1\") = \"dgsdgsgs\"\n        .Range(\"F1\") = \"url\"\n\n        'i'm not sure if these columns are correct as you deleted column E:E above\n        'and shifted everything left one column\n        .Range(\"G:G,H:H,I:I,J:J,K:K,L:L,M:M\").Delete Shift:=xlToLeft\n\n        .Columns(\"D:D\").ClearContents\n        .Range(\"D1\") = \"dgdfggsdgh\"\n        .Range(\"D2\").FormulaR1C1 = \"dgsdgdshshdh\"   '&lt;~~maybe use .Range(\"D2\").Formula for regulat xlA1 style formulas\n        .Range(\"D2:D\" &amp; lr).FillDown    '&lt;~~see how lr is used\n    End With\nEnd Sub\n</code></pre>\n\n<p>As you can see, there is no reason to use the <code>.Select</code> process that the macro recorder uses. The code that the macro recorder supplies is very verbose and can almost always be trimmed down to what is actually necessary. </p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</p>\n"}], "owner": {"reputation": 11, "user_id": 5390117, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wfGOp1wqn9M/AAAAAAAAAAI/AAAAAAAAADo/MKQ9rR0piik/photo.jpg?sz=128", "display_name": "Addy", "link": "https://stackoverflow.com/users/5390117/addy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1443556281, "creation_date": 1443555036, "last_edit_date": 1443555291, "question_id": 32852292, "link": "https://stackoverflow.com/questions/32852292/vba-macros-code", "title": "VBA macros code", "body": "<p>I would like integrate two macros code in to one. The first macros code is used to find the exact number of rows in a specific column. The second macros code is used to do a certain set of changes in the worksheet. I need the result of the first macros code to automatically be inserted in the second macros code. ( basically where the range is defined)</p>\n\n<p>Macros code 1</p>\n\n<pre><code>Sub sbLastRowOfDColumn()\n    'Find the last Row with data in a Column\n    'In this example we are finding the last row of column D\n    Dim lastRow As Long\n    With ActiveSheet\n        lastRow = .Cells(.Rows.Count, \"D\").End(xlUp).Row\n    End With\n    MsgBox lastRow\nEnd Sub\n</code></pre>\n\n<p>Macros code 2</p>\n\n<pre><code>Sub test()\n    Range(\"A1\").Select\n    ActiveCell.FormulaR1C1 = \"variable1\"\n    Columns(\"A:A\").Select\n    Selection.ClearContents\n    Range(\"A1\").Select\n    ActiveCell.FormulaR1C1 = \"gdgs\"\n    Range(\"A2\").Select\n    ActiveCell.FormulaR1C1 = \"6\"\n    Range(\"A2\").Select\n    Selection.AutoFill Destination:=Range(\"A2:A360\"), Type:=xlFillDefault\n\n    'need the result of last row at the place of A360\n    Range(\"A2:A360\").Select\n    ActiveWindow.SmallScroll Down:=-1034\n    Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"dgdgsg\"\n    Range(\"C1\").Select\n    ActiveCell.FormulaR1C1 = \"gdsgsdgsd\"\n    Range(\"D1\").Select\n    ActiveCell.FormulaR1C1 = \"sdgsdgsfh\"\n    Columns(\"E:E\").Select\n    Selection.Delete Shift:=xlToLeft\n    Range(\"E1\").Select\n    ActiveCell.FormulaR1C1 = \"dgsdgsgs\"\n    Range(\"F1\").Select\n    ActiveCell.FormulaR1C1 = \"url\"\n    Range(\"G:G,H:H,I:I,J:J,K:K,L:L,M:M\").Select\n    Range(\"M1\").Activate\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"D:D\").Select\n    Selection.ClearContents\n    Range(\"D1\").Select\n    ActiveCell.FormulaR1C1 = \"dgdfggsdgh\"\n    Range(\"D2\").Select\n    ActiveCell.FormulaR1C1 = \"dgsdgdshshdh\"\n    Range(\"D2\").Select\n    Selection.AutoFill Destination:=Range(\"D2:D360\"), Type:=xlFillDefault\n\n    'need the result of last row at the place of D360\n    Range(\"D2:D360\").Select\n    ActiveWindow.SmallScroll Down:=-984\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "call", "worksheet", "vba"], "comments": [{"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1443555921, "post_id": 32851795, "comment_id": 53538529, "body": "Change <code>Private Sub Worksheet_Change(ByVal Target As Range)</code> to <code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)</code>"}, {"owner": {"reputation": 61, "user_id": 5177995, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd549c5a16ed5ceea8bde5f8d3649880?s=128&d=identicon&r=PG&f=1", "display_name": "nickelcap", "link": "https://stackoverflow.com/users/5177995/nickelcap"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1443560125, "post_id": 32851795, "comment_id": 53540790, "body": "@PortlandRunner I made the change you suggested but still got the same issue."}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1443561400, "post_id": 32851795, "comment_id": 53541531, "body": "Quick check, is the Worksheet_SelectionChange code in the code behind the worksheet of interest?  Once I made the method change I could run your code just fine."}, {"owner": {"reputation": 61, "user_id": 5177995, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd549c5a16ed5ceea8bde5f8d3649880?s=128&d=identicon&r=PG&f=1", "display_name": "nickelcap", "link": "https://stackoverflow.com/users/5177995/nickelcap"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1443619140, "post_id": 32851795, "comment_id": 53566351, "body": "Do you mean do I have the second block of code in my original post in the &quot;Dashboard&quot; sheet? Then yes. I have that code there and the code I&#39;m trying to call in a separate module. I modified the code slightly, I&#39;ll add that to my original post as an edit."}, {"owner": {"reputation": 546, "user_id": 2819134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73c576016b3a8fb462b71b87ffc4648?s=128&d=identicon&r=PG&f=1", "display_name": "Raugmor", "link": "https://stackoverflow.com/users/2819134/raugmor"}, "edited": false, "score": 0, "creation_date": 1443710375, "post_id": 32851795, "comment_id": 53610346, "body": "just to confirm, @nickelcap , you are checking for the intersection on <code>C2:G2</code> so it will definitely not run if you change any other cells, correct?"}, {"owner": {"reputation": 61, "user_id": 5177995, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd549c5a16ed5ceea8bde5f8d3649880?s=128&d=identicon&r=PG&f=1", "display_name": "nickelcap", "link": "https://stackoverflow.com/users/5177995/nickelcap"}, "reply_to_user": {"reputation": 546, "user_id": 2819134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73c576016b3a8fb462b71b87ffc4648?s=128&d=identicon&r=PG&f=1", "display_name": "Raugmor", "link": "https://stackoverflow.com/users/2819134/raugmor"}, "edited": false, "score": 0, "creation_date": 1443793050, "post_id": 32851795, "comment_id": 53644671, "body": "@Raugmor I think you may have hit on something. The idea is for the user to select an item from a drop down list that are in that cell range, and if any of those cells change the code runs."}, {"owner": {"reputation": 546, "user_id": 2819134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73c576016b3a8fb462b71b87ffc4648?s=128&d=identicon&r=PG&f=1", "display_name": "Raugmor", "link": "https://stackoverflow.com/users/2819134/raugmor"}, "edited": false, "score": 0, "creation_date": 1443798986, "post_id": 32851795, "comment_id": 53648863, "body": "@nickelcap so does it RUN when you change those intersect cells or it does NOT but you expect it too? Also, do you have the <code>Worksheet_SelectionChange</code> macro enabled on the same sheet by any chance?"}, {"owner": {"reputation": 546, "user_id": 2819134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d73c576016b3a8fb462b71b87ffc4648?s=128&d=identicon&r=PG&f=1", "display_name": "Raugmor", "link": "https://stackoverflow.com/users/2819134/raugmor"}, "edited": false, "score": 0, "creation_date": 1443799573, "post_id": 32851795, "comment_id": 53649235, "body": "Reason i am asking about selection change as you do have a selection change within the above code and it might trigger something else that wouldn&#39;t let the macro run further. You can also try to put a stop point on the intersect check and see if it even does go into the <code>Sub</code> and if it does, does it go into the <code>if</code> condition"}], "owner": {"reputation": 61, "user_id": 5177995, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd549c5a16ed5ceea8bde5f8d3649880?s=128&d=identicon&r=PG&f=1", "display_name": "nickelcap", "link": "https://stackoverflow.com/users/5177995/nickelcap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1443640895, "creation_date": 1443553187, "last_edit_date": 1531164843, "question_id": 32851795, "link": "https://stackoverflow.com/questions/32851795/sub-called-when-using-worksheet-change-wont-run", "title": "Sub Called When Using Worksheet_Change Won&#39;t Run", "body": "<p>I'm trying to call a sub called ScaleAxes that sits in a module elsewhere. The ScaleAxes code is:</p>\n\n<pre><code>Option Explicit\nSub ScaleAxes()\n  Worksheets(\"Dashboard\").ChartObjects(\"Measure Chart\").Activate\n  With ActiveChart.Axes(xlCategory, xlPrimary)\n    .MaximumScale = Sheets(\"Lists and Data\").Range(\"R7\").Value\n    .MinimumScale = Sheets(\"Lists and Data\").Range(\"Q7\").Value\n    .MajorUnit = Sheets(\"Lists and Data\").Range(\"S7\").Value\n  End With\n  With ActiveChart.Axes(xlValue, xlPrimary)\n    .MaximumScale = Sheets(\"Lists and Data\").Range(\"R9\").Value\n    .MinimumScale = Sheets(\"Lists and Data\").Range(\"Q9\").Value\n    .MajorUnit = Sheets(\"Lists and Data\").Range(\"S9\").Value\n  End With\nEnd Sub\n</code></pre>\n\n<p>The code I'm trying to call it in is here:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nDim KeyCells As Range\nSet KeyCells = Range(\"H2:N2\")\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n        Is Nothing Then\n        Dim addIn As COMAddIn\n        Dim automationObject As Object\n        Set addIn = Application.COMAddIns(\"PI DataLink\")\n            Set automationObject = addIn.Object\n        Dim MyRange As Range\n            Set MyRange = Range(\"J2\")\n            MyRange.Select\n            automationObject.SelectRange\n            automationObject.ResizeRange\n            Application.CalculateFull\n     End If\n     If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n        Is Nothing Then\n        Call ScaleAxes\n    End If\nEnd Sub\n</code></pre>\n\n<p>ScaleAxes works on its own when I run it separately, and no error comes up when the code it's called in is run. The problem is that the code above seems to run properly, but the ScaleAxes code doesn't run. I've also tried pulling the code out of the ScaleAxes() sub and pasting it into the IF function that the working part of the code is in, but that didn't work either. </p>\n\n<p>Any help you can provide helping me remedy this issue would be appreciated.</p>\n\n<p><strong>EDIT 1:</strong></p>\n\n<p>Here's my code in its current state:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nDim KeyCells As Range\nSet KeyCells = Sheets(\"Dashboard\").Range(\"C2:G2\")\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n        Is Nothing Then\n        Dim addIn As COMAddIn\n        Dim automationObject As Object\n        Set addIn = Application.COMAddIns(\"PI DataLink\")\n            Set automationObject = addIn.Object\n        Dim MyRange As Range\n            Set MyRange = Range(\"N2\")\n            MyRange.Select\n            automationObject.SelectRange\n            automationObject.ResizeRange\n            Application.CalculateFull\n    End If\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n        Is Nothing Then\n        Call ScaleAxes\n    End If\nEnd Sub\n</code></pre>\n\n<p>The same problem is occurring. The code above is in Sheet2(Dashboard) and the code being called is in Module2.</p>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>Just as an update. When I call the ScaleAxes sub using a Command Button it works. This is OK as a temporary resolution, but I'd like to have the sub called at the same time as the rest of the code if possible. </p>\n"}, {"tags": ["vba", "excel", "email"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1443552887, "post_id": 32851623, "comment_id": 53536982, "body": "If you study the code you found and understand what it&#39;s doing, you can easily solve your first problem XD"}, {"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 0, "creation_date": 1443558332, "post_id": 32851623, "comment_id": 53539859, "body": "That is a huge button..."}], "answers": [{"comments": [{"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1443560290, "post_id": 32853376, "comment_id": 53540902, "body": "Microsoft outlook object library isn&#39;t installed by default - I think a couple of the lines rely on it. Do you have it loaded?"}, {"owner": {"reputation": 2986, "user_id": 4316726, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a9dbbe67417449dad8b918b8f1756266?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Powell", "link": "https://stackoverflow.com/users/4316726/brian-powell"}, "reply_to_user": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1443560426, "post_id": 32853376, "comment_id": 53540994, "body": "Yeah - but the code didn&#39;t run as intended because of the missing period before the <code>SUBJECT</code> header."}, {"owner": {"reputation": 17, "user_id": 5390071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf046d5dac63b483ee7409a60424487?s=128&d=identicon&r=PG&f=1", "display_name": "Ner", "link": "https://stackoverflow.com/users/5390071/ner"}, "edited": false, "score": 0, "creation_date": 1443561364, "post_id": 32853376, "comment_id": 53541512, "body": "Thanks Brian! I added in the missing period which fixed up the issue of only having the subject as &quot;Reminder to email Andrew&quot;.  However, now all the email subjects are &quot;Reminder to email Nerr;Reminder to email Roo;Reminder to email Andrew&quot;  I tried taking out the second half of the code    <code>ElseIf SUBJECT &lt;&gt; &quot;&quot; And Cells(iCounter, 4).Offset(0, -1) = &quot;Send Reminder&quot; Then         SUBJECT = SUBJECT &amp; &quot;;&quot; &amp; Cells(iCounter, 6).Value </code>   But this made it so the subjects now all default to the first subject, &quot;Reminder to email Nerr&quot;"}], "tags": [], "owner": {"reputation": 2986, "user_id": 4316726, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a9dbbe67417449dad8b918b8f1756266?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Powell", "link": "https://stackoverflow.com/users/4316726/brian-powell"}, "is_accepted": false, "score": 2, "last_activity_date": 1443560369, "last_edit_date": 1443560369, "creation_date": 1443559244, "answer_id": 32853376, "question_id": 32851623, "link": "https://stackoverflow.com/questions/32851623/custom-subject-line-for-outlook/32853376#32853376", "title": "Custom Subject line for Outlook", "body": "<p>I believe you're looking for everything in between this line:</p>\n\n<p><code>With OutLookMailItem</code></p>\n\n<p>and this line</p>\n\n<p><code>End With</code></p>\n\n<p>to run ONCE for each row in your spreadsheet, am I right?  For each individual row, if you have the \"Send Reminder\" text in <code>Cells(iCounter,4)</code>, you want an email to be sent out to that person.</p>\n\n<p>If that's the case - that's never going to happen because you iterate through this code from 1 all the way to 6</p>\n\n<pre><code>For iCounter = 1 To WorksheetFunction.CountA(Columns(4))\nIf SUBJECT = \"\" And Cells(iCounter, 4).Offset(0, -1) = \"Send Reminder\" Then\n.SUBJECT = Cells(iCounter, 6).Value\nElseIf SUBJECT &lt;&gt; \"\" And Cells(iCounter, 4).Offset(0, -1) = \"Send Reminder\" Then\nSUBJECT = SUBJECT &amp; \";\" &amp; Cells(iCounter, 6).Value\n\nEnd If\n</code></pre>\n\n<p>prior to ever executing this code:</p>\n\n<p><code>.Send</code></p>\n\n<p>This is why your <code>.SUBJECT</code> is always \"Reminder to email Andrew.\"  It <strong>was</strong> \"Reminder to email Ner,\" but that was overwritten by \"Reminder to email Roo\", which was overwritten by \"Reminder to email Andrew.\"</p>\n\n<p>I copied your code into VBA and ran it for myself and I'm not sure how it's working for you because I can't get it to run.</p>\n\n<p>If my suggestion above is not what you're looking to do, then your problem is probably lying in the fact that you are not using a <code>.</code> before <code>SUBJECT</code> in your <code>ElseIf</code> statement:</p>\n\n<pre><code>For iCounter = 1 To WorksheetFunction.CountA(Columns(4))\n    If SUBJECT = \"\" And Cells(iCounter, 4).Offset(0, -1) = \"Send Reminder\" Then\n        .SUBJECT = Cells(iCounter, 6).Value\n    ElseIf SUBJECT &lt;&gt; \"\" And Cells(iCounter, 4).Offset(0, -1) = \"Send Reminder\" Then\n        SUBJECT = SUBJECT &amp; \";\" &amp; Cells(iCounter, 6).Value\n     '^ period here\n    End If\nNext iCounter\n</code></pre>\n\n<p>If you're actually looking to build out the <code>.SUBJECT</code> property of <code>OutlookMailItem</code>, you need to put a period before it, as you want to reference <code>.SUBJECT</code> - the property of <code>OutlookMailItem</code>, not the variable <code>SUBJECT</code> (which is very confusing btw).</p>\n\n<p>Some other notes:</p>\n\n<p>your <code>For</code> loop doesn't need to start at 1, because that's your header row.  It might be easier in the future to do something like this:</p>\n\n<pre><code>lastRow = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n\nFor iCounter = 2 to lastRow step 1\n  '/ VBA will iterate through each row until it hits the end\n  '/ Assuming column D has data in it to your actual \"last row\"\nNext iCounter\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "is_accepted": false, "score": 1, "last_activity_date": 1443560097, "creation_date": 1443560097, "answer_id": 32853585, "question_id": 32851623, "link": "https://stackoverflow.com/questions/32851623/custom-subject-line-for-outlook/32853585#32853585", "title": "Custom Subject line for Outlook", "body": "<p>Use F8 to step through your code. Turn on your locals window and watch what is happening with your variables at each step. Hover your cursor over the yellow line or any previous line to see what the variables / functions are at that point or when previous lines finished executing.</p>\n\n<p>Pay particular attention to your subject variable.</p>\n\n<p>This bit is also probably not doing what you want it to be doing:</p>\n\n<pre><code>For iCounter = 1 To WorksheetFunction.CountA(Columns(4))\n</code></pre>\n\n<p>If I put that into a spreadsheet with a bunch of values in columns A through J and run this:</p>\n\n<pre><code>Sub testing()\nDim X\nX = WorksheetFunction.CountA(Columns(4))\nEnd Sub\n</code></pre>\n\n<p>X is 0 \nI suspect you want the last row with a value in column D.</p>\n\n<pre><code>Sub lastrow()\nDim X\nX = Worksheets(\"Sheet1\").Cells(Rows.Count, \"D\").End(xlUp).Row\nEnd Sub\n</code></pre>\n\n<p>That gives me 19. The last cell in column D with a value. You don't want to count or counta because it won't count blanks. So you might have 20 rows of data but if only 5 have a value in column D, your loop will go through 5 times, since you based it off the cells with values, not the rows.</p>\n\n<p>Mainly, if you are going to be doing these regularly, play with F8 and your View/Locals window while doing this and you will start to see where things go wrong.</p>\n\n<p>Then make a very simple sub like that one to play with the individual piece of code until you understand it, before you try to modify a larger complex chunk. That will help you learn to fish.</p>\n\n<p>I don't have outlook so I can't test the rest of your code, but that block will give your trouble even if everything else is perfect.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 5390071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf046d5dac63b483ee7409a60424487?s=128&d=identicon&r=PG&f=1", "display_name": "Ner", "link": "https://stackoverflow.com/users/5390071/ner"}, "edited": false, "score": 0, "creation_date": 1443619744, "post_id": 32855082, "comment_id": 53566777, "body": "Thanks so much @findwindow, the code works perfectly! I very much appreciate you taking your time to write it out. I&#39;m new to stack overflow and this community is amazing &lt;3 Also yes I wouldn&#39;t have changed the worksheet if it werent for the comment, thanks!"}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": true, "score": 6, "last_activity_date": 1443567464, "creation_date": 1443567464, "answer_id": 32855082, "question_id": 32851623, "link": "https://stackoverflow.com/questions/32851623/custom-subject-line-for-outlook/32855082#32855082", "title": "Custom Subject line for Outlook", "body": "<p>So tempted to leave out the comment but there's still a possibility you will miss it XD</p>\n\n<pre><code>Sub SendReminderMail()\n\nDim OutLookApp As Object\nDim OutLookMailItem As Object\nDim lastRow As Long\nDim iCounter As Long\nDim MailDest As String\nDim subj As String\n\nlastRow = ThisWorkbook.WorkSheets(\"Sheet6\").Cells(Rows.Count, \"D\").End(xlUp).Row 'change worksheet\n\nFor iCounter = 2 To lastRow\n\n    Set OutLookApp = CreateObject(\"Outlook.application\")\n    Set OutLookMailItem = OutLookApp.CreateItem(0)\n\n    With OutLookMailItem\n        subj = \"\"\n        MailDest = \"\"\n\n        If Cells(iCounter, 3) = \"Send Reminder\" Then\n            subj = Cells(iCounter, 6).Value\n            MailDest = Cells(iCounter, 4).Value\n\n            .BCC = MailDest\n            .SUBJECT = subj\n            .Body = \"Reminder: Time to contact this firm\"\n            .Send\n        End If\n\n    End With\n\nNext iCounter\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5390071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf046d5dac63b483ee7409a60424487?s=128&d=identicon&r=PG&f=1", "display_name": "Ner", "link": "https://stackoverflow.com/users/5390071/ner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1902, "favorite_count": 0, "accepted_answer_id": 32855082, "answer_count": 3, "score": 0, "last_activity_date": 1443567464, "creation_date": 1443552607, "last_edit_date": 1443555197, "question_id": 32851623, "link": "https://stackoverflow.com/questions/32851623/custom-subject-line-for-outlook", "title": "Custom Subject line for Outlook", "body": "<p>I'm working on automating an Excel database so by clicking a button, the macro will automatically send an email using the email, subject, and body for that specific row entry.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Av5z1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Av5z1.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>For example, I want to press the button and the macro automatically sends out emails to the cells filled in Red to their respective emails with the customized subject.</p>\n\n<p>I found some code online that, once pressed, will send out an automatic email. However, the subject line isn't customized.</p>\n\n<p>Here's the code I'm working on right now:</p>\n\n<pre><code>Sub SendReminderMail()\nDim OutLookApp As Object\nDim OutLookMailItem As Object\nDim iCounter As Integer\nDim MailDest As String\nDim SUBJECT As String\n\nSet OutLookApp = CreateObject(\"Outlook.application\")\nSet OutLookMailItem = OutLookApp.CreateItem(0)\n\nWith OutLookMailItem\n.SUBJECT = \"\"\nFor iCounter = 1 To WorksheetFunction.CountA(Columns(4))\nIf SUBJECT = \"\" And Cells(iCounter, 4).Offset(0, -1) = \"Send Reminder\" Then\n.SUBJECT = Cells(iCounter, 6).Value\nElseIf SUBJECT &lt;&gt; \"\" And Cells(iCounter, 4).Offset(0, -1) = \"Send Reminder\" Then\nSUBJECT = SUBJECT &amp; \";\" &amp; Cells(iCounter, 6).Value\n\nEnd If\nNext iCounter\n\nMailDest = \"\"\nFor iCounter = 1 To WorksheetFunction.CountA(Columns(4))\nIf MailDest = \"\" And Cells(iCounter, 4).Offset(0, -1) = \"Send Reminder\" Then\nMailDest = Cells(iCounter, 4).Value\nElseIf MailDest &lt;&gt; \"\" And Cells(iCounter, 4).Offset(0, -1) = \"Send Reminder\" Then\nMailDest = MailDest &amp; \";\" &amp; Cells(iCounter, 4).Value\nEnd If\n\nNext iCounter\n\n\n.BCC = MailDest\n.Body = \"Reminder: Time to contact this firm\"\n.Send\n\nEnd With\n\nSet OutLookMailItem = Nothing\nSet OutLookApp = Nothing\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Current problems I'm facing:</p>\n\n<ol>\n<li><p>The email sends out to the correct email addresses but the subject is ALWAYS the subject in the 6th row - \"Reminder to email Andrew\". It doesn't change for other contacts. I need the subject to change for every email to each different contact.</p></li>\n<li><p>I noticed if I have different contact names but they're listed under the same e-mail address, then the macro will only e-mail to the first entry with the same e-mail, but not the second one.</p></li>\n</ol>\n\n<p>Any help is appreciated. Thanks</p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1443552704, "post_id": 32851600, "comment_id": 53536906, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/17386091/vba-excel-2010-open-internet-explore-in-new-tab\">VBA, Excel 2010, open internet explore in new tab</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1443552780, "post_id": 32851600, "comment_id": 53536928, "body": "Instead of doing hyperlink <code>.Follow</code> method, get an explicit handle on the browser (presumably IE as default) and have the browser <code>.Navigate</code> to the <code>xHyperlink.Address</code> using the method in the other answer."}, {"owner": {"reputation": 347, "user_id": 4777929, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ddf40c38cf4432bb8098cf8a7d269c41?s=128&d=identicon&r=PG&f=1", "display_name": "xxxRxxx", "link": "https://stackoverflow.com/users/4777929/xxxrxxx"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1443553989, "post_id": 32851600, "comment_id": 53537499, "body": "I have no idea why, but when I opened a new window in Firefox then tried to run the code again, it worked just fine, opening each hyperlink in a new tab. So actually the code works fine as is. Previously I tried to open it in an existing window which already had some tabs open"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1443556717, "post_id": 32851600, "comment_id": 53538949, "body": "Works in Chrome too."}, {"owner": {"reputation": 347, "user_id": 4777929, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ddf40c38cf4432bb8098cf8a7d269c41?s=128&d=identicon&r=PG&f=1", "display_name": "xxxRxxx", "link": "https://stackoverflow.com/users/4777929/xxxrxxx"}, "edited": false, "score": 0, "creation_date": 1443565865, "post_id": 32851600, "comment_id": 53543317, "body": "Yeah it&#39;s nice that it uses whatever your current open browser is, before I found this solution I was trying to use IE automation. I hate IE automation."}, {"owner": {"reputation": 347, "user_id": 4777929, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ddf40c38cf4432bb8098cf8a7d269c41?s=128&d=identicon&r=PG&f=1", "display_name": "xxxRxxx", "link": "https://stackoverflow.com/users/4777929/xxxrxxx"}, "edited": false, "score": 0, "creation_date": 1471378163, "post_id": 32851600, "comment_id": 65320017, "body": "Update: I haven&#39;t been able to get this code to work recently. As a result I&#39;ve posted an answer that works consistently."}], "answers": [{"tags": [], "owner": {"reputation": 347, "user_id": 4777929, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ddf40c38cf4432bb8098cf8a7d269c41?s=128&d=identicon&r=PG&f=1", "display_name": "xxxRxxx", "link": "https://stackoverflow.com/users/4777929/xxxrxxx"}, "is_accepted": true, "score": 0, "last_activity_date": 1471377607, "creation_date": 1471377607, "answer_id": 38983463, "question_id": 32851600, "link": "https://stackoverflow.com/questions/32851600/opening-multiple-hyperlinks-in-vba-in-separate-tabs/38983463#38983463", "title": "Opening multiple hyperlinks in VBA in separate tabs", "body": "<p>Welp, I finally found a better solution: Just use Wscript.</p>\n\n<pre><code>Sub OpenDemLinksBoi()\n    Dim SelecRng As Range\n\n    Set SelecRng = Application.Selection\n    Set SelecRng = Application.InputBox(\"Range\", SelecRng, Type:=8)\n\n    For Each Cell In SelecRng\n    Set objShell = CreateObject(\"Wscript.Shell\") 'I think this basically allows you to input shell commands, hence the \"Run\" in the next line, which functions exactly like Run. Test it out, try putting a link_\n    'into Run and see what happens. Same thing as this script.\n    objShell.Run (Cell)\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4777929, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ddf40c38cf4432bb8098cf8a7d269c41?s=128&d=identicon&r=PG&f=1", "display_name": "xxxRxxx", "link": "https://stackoverflow.com/users/4777929/xxxrxxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2599, "favorite_count": 0, "accepted_answer_id": 38983463, "answer_count": 1, "score": 0, "last_activity_date": 1471377607, "creation_date": 1443552548, "last_edit_date": 1531164843, "question_id": 32851600, "link": "https://stackoverflow.com/questions/32851600/opening-multiple-hyperlinks-in-vba-in-separate-tabs", "title": "Opening multiple hyperlinks in VBA in separate tabs", "body": "<p>I've found many different solutions for this issue, but here's the best code I've found so far:</p>\n\n<pre><code>Sub OpenHyperLinks()\n    Dim xHyperlink As Hyperlink\n    Dim WorkRng As Range\n    On Error Resume Next\n    xTitleId = \"KutoolsforExcel\"\n    Set WorkRng = Application.Selection\n    Set WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\n    For Each xHyperlink In WorkRng.Hyperlinks\n        xHyperlink.Follow\n    Next\nEnd Sub\n</code></pre>\n\n<p>The problem is that this opens all of the hyperlinks in the same tab, so that I only get the last page loaded. What I want is all of the links displayed in separate tabs. How can I modify this to get what I'm looking for?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1016, "user_id": 3856624, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b18b401d3a489632aa8eb16cb9eb04cf?s=128&d=identicon&r=PG&f=1", "display_name": "ivan7707", "link": "https://stackoverflow.com/users/3856624/ivan7707"}, "edited": false, "score": 1, "creation_date": 1443552562, "post_id": 32851530, "comment_id": 53536822, "body": "what have you tried so far? You ask for the best way, have you figured out any way to do it?"}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "reply_to_user": {"reputation": 1016, "user_id": 3856624, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b18b401d3a489632aa8eb16cb9eb04cf?s=128&d=identicon&r=PG&f=1", "display_name": "ivan7707", "link": "https://stackoverflow.com/users/3856624/ivan7707"}, "edited": false, "score": 0, "creation_date": 1443563123, "post_id": 32851530, "comment_id": 53542309, "body": "No, i have no solution so far. The code works even if the cell is black as long as there are conditional formatting rules applied. But, I would like it to ignore cells without conditional formatting rules applied."}], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1443562351, "post_id": 32853460, "comment_id": 53541957, "body": "I want the code to handle cells without conditional formating. I have columns of varying length, and each cell with data has 3 conditional formating rules. Each rule changes the color of the cell. The code i was using counted the number of (for example) purple, green, &amp; blue cells. So, you are on to something here, but really i still want input a range and a cell that matches the conditional formating that I can looking for in the range. From that, I want the count of the purple (or green or blue) cells. And, I don&#39;t want an error when the range includes a cell without conditional formatting."}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1443562397, "post_id": 32853460, "comment_id": 53541986, "body": "&quot;blank cells should actually be okay in the above code so long as they&#39;re assigned a rule&quot; - This is true"}, {"owner": {"reputation": 212, "user_id": 3650464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ec0f9dea5d90a96b766cc97cc5de55?s=128&d=identicon&r=PG&f=1", "display_name": "Brumder", "link": "https://stackoverflow.com/users/3650464/brumder"}, "reply_to_user": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1443563705, "post_id": 32853460, "comment_id": 53542551, "body": "My re-written code can already handle cells without conditional formatting rules (it skips them). I&#39;ve added the second argument back in, which will only match on a selected color as it did originally."}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1443565129, "post_id": 32853460, "comment_id": 53543037, "body": "This code doesn&#39;t work, and I think it does not work because counting the color fill is different than counting the color fill that results from conditional formatting. If you have a cell with white color fill, a value of 8 and a conditional format rule that changes the color fill to red if the value is &gt; 10, the cell color fill will be red, but the actual color fill is still white."}, {"owner": {"reputation": 212, "user_id": 3650464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ec0f9dea5d90a96b766cc97cc5de55?s=128&d=identicon&r=PG&f=1", "display_name": "Brumder", "link": "https://stackoverflow.com/users/3650464/brumder"}, "reply_to_user": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1443568844, "post_id": 32853460, "comment_id": 53544283, "body": "Conditional formatting is tricky- the code didn&#39;t work because it turns out that <code>.DisplayFormat</code> can&#39;t actually be used in a function. See my updated response."}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1443575345, "post_id": 32853460, "comment_id": 53545927, "body": "I don&#39;t know if this code is working.I cannot get it to evaluate without an error. Why is the second argument optional? In my original code, the first argument is the range of cells in which the conditional formatting will be counted, and argument 2 is a cell in which the conditional formatting that i am counting in the range is true and applied."}, {"owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "edited": false, "score": 0, "creation_date": 1443576677, "post_id": 32853460, "comment_id": 53546262, "body": "Ok, I see there are two functions. This appears to have solved the question! Thank you"}], "tags": [], "owner": {"reputation": 212, "user_id": 3650464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ec0f9dea5d90a96b766cc97cc5de55?s=128&d=identicon&r=PG&f=1", "display_name": "Brumder", "link": "https://stackoverflow.com/users/3650464/brumder"}, "is_accepted": true, "score": 1, "last_activity_date": 1443572300, "last_edit_date": 1443572300, "creation_date": 1443559553, "answer_id": 32853460, "question_id": 32851530, "link": "https://stackoverflow.com/questions/32851530/excel-vba-module-does-not-ignore-blank-cells/32853460#32853460", "title": "Excel VBA module does not ignore blank cells", "body": "<p>Okay you have a few errors. The code isn't designed to handle a cell (\"CFCELL\") where conditional formatting is nonexistent (blank cells should actually be okay in the above code so long as they're assigned a rule). </p>\n\n<p>So, let's try this instead: </p>\n\n<pre><code>Function CountCFCells(rng As Range, C As Range) As Long\nDim i As Single, j As Long, Total As Long\nDim CFCELL As Range\nDim Match_CI As Long\n\nj = 0\nMatch_CI = C.Interior.ColorIndex\n\nFor Each CFCELL In rng\n    If CFCELL.FormatConditions.Count &gt; 0 And Len(CFCELL) &gt; 0 Then\n        If DisplayedColor(CFCELL) = Match_CI Then\n            j = j + 1\n        End If\n    End If\nNext CFCELL\n\nTotal = j\nCountCFCells = Total\n\nEnd Function\n\n\nFunction DisplayedColor(Cell As Range, Optional CellInterior As Boolean = True, _\n                        Optional ReturnColorIndex As Long = True) As Long\n  Dim X As Long, Test As Boolean, CurrentCell As String\n  If Cell.Count &gt; 1 Then Err.Raise vbObjectError - 999, , \"Only single cell references allowed for 1st argument.\"\n  CurrentCell = ActiveCell.Address\n  For X = 1 To Cell.FormatConditions.Count\n    With Cell.FormatConditions(X)\n      If .Type = xlCellValue Then\n        Select Case .Operator\n          Case xlBetween:      Test = Cell.Value &gt;= Evaluate(.Formula1) And Cell.Value &lt;= Evaluate(.Formula2)\n          Case xlNotBetween:   Test = Cell.Value &lt;= Evaluate(.Formula1) Or Cell.Value &gt;= Evaluate(.Formula2)\n          Case xlEqual:        Test = Evaluate(.Formula1) = Cell.Value\n          Case xlNotEqual:     Test = Evaluate(.Formula1) &lt;&gt; Cell.Value\n          Case xlGreater:      Test = Cell.Value &gt; Evaluate(.Formula1)\n          Case xlLess:         Test = Cell.Value &lt; Evaluate(.Formula1)\n          Case xlGreaterEqual: Test = Cell.Value &gt;= Evaluate(.Formula1)\n          Case xlLessEqual:    Test = Cell.Value &lt;= Evaluate(.Formula1)\n        End Select\n      ElseIf .Type = xlExpression Then\n        Application.ScreenUpdating = False\n        Cell.Select\n        Test = Evaluate(.Formula1)\n        Range(CurrentCell).Select\n        Application.ScreenUpdating = True\n      End If\n      If Test Then\n        If CellInterior Then\n          DisplayedColor = IIf(ReturnColorIndex, .Interior.ColorIndex, .Interior.color)\n        Else\n          DisplayedColor = IIf(ReturnColorIndex, .Font.ColorIndex, .Font.color)\n        End If\n        Exit Function\n      End If\n    End With\n  Next\n  If CellInterior Then\n    DisplayedColor = IIf(ReturnColorIndex, Cell.Interior.ColorIndex, Cell.Interior.color)\n  Else\n    DisplayedColor = IIf(ReturnColorIndex, Cell.Font.ColorIndex, Cell.Font.color)\n  End If\nEnd Function\n</code></pre>\n\n<p>This will count all cells which have conditional formatting rules applied to them containing data within the selected range. It will only match entries which are the same color as cell you select second in the formula. In this case, I made it so it counts user-entered zero's as a value (will not skip it if someone actually entered a zero).</p>\n"}], "owner": {"reputation": 387, "user_id": 5170800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-EtcS8xRzg0Q/AAAAAAAAAAI/AAAAAAABCkU/iWskI4FvKrw/photo.jpg?sz=128", "display_name": "Britt", "link": "https://stackoverflow.com/users/5170800/britt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 32853460, "answer_count": 1, "score": 1, "last_activity_date": 1443572300, "creation_date": 1443552265, "last_edit_date": 1531164843, "question_id": 32851530, "link": "https://stackoverflow.com/questions/32851530/excel-vba-module-does-not-ignore-blank-cells", "title": "Excel VBA module does not ignore blank cells", "body": "<p>I have a VBA module I got online to count cell with conditional formatting. This module has an issue in that it returns an error if in the range it is counting, a cell is either blank or does not have a conditional format rule. The module is:</p>\n\n<pre><code>Function CountCFCells(rng As Range, C As Range)\nDim i As Single, j As Long, k As Long\nDim chk As Boolean, Str1 As String, CFCELL As Range\nchk = False\nFor i = 1 To rng.FormatConditions.Count\n    If rng.FormatConditions(i).Interior.ColorIndex = C.Interior.ColorIndex Then\n        chk = True\n        Exit For\n    End If\nNext i\nj = 0\nk = 0\nIf chk = True Then\n    For Each CFCELL In rng\n        Str1 = CFCELL.FormatConditions(i).Formula1\n        Str1 = Application.ConvertFormula(Str1, xlA1, xlR1C1)\n        Str1 = Application.ConvertFormula(Str1, xlR1C1, xlA1, , ActiveCell.Resize(rng.Rows.Count, rng.Columns.Count).Cells(k + 1))\n        If Evaluate(Str1) = True Then j = j + 1\n        k = k + 1\n    Next CFCELL\nElse\nCountCFCells = \"Color not found\"\nExit Function\nEnd If\nCountCFCells = j\nEnd Function\n</code></pre>\n\n<p>When I call this function using <code>=CountCFCells(A1:A30, B1)</code>, I want it to ignore any cells don't have any conditional formating rules or data (type is number). What is the best way to disregard any cells in the range that do not have conditional formatting rules or data?</p>\n"}, {"tags": ["vba", "ms-word", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 2071618, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95a65fdb4ad534d8898054baa5324c75?s=128&d=identicon&r=PG", "display_name": "Eitan Waks", "link": "https://stackoverflow.com/users/2071618/eitan-waks"}, "edited": false, "score": 0, "creation_date": 1443550288, "post_id": 32850605, "comment_id": 53535673, "body": "Thank you so much for giving me such a quick response. I have been tackling this issue for three days now. Can you possibly give me a quick explanation of why this works so that I can learn the reasoning behind the code.  Also, it seems to me that you would be the right person to ask the following question: I would like the macro to open up the attachments dialogue to a specific folder. I couldn&#39;t find any method that fits the bill. What would be my best way of implementing the above?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 59, "user_id": 2071618, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95a65fdb4ad534d8898054baa5324c75?s=128&d=identicon&r=PG", "display_name": "Eitan Waks", "link": "https://stackoverflow.com/users/2071618/eitan-waks"}, "edited": false, "score": 0, "creation_date": 1443551154, "post_id": 32850605, "comment_id": 53536128, "body": "See revisions to my answer above :)"}, {"owner": {"reputation": 59, "user_id": 2071618, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95a65fdb4ad534d8898054baa5324c75?s=128&d=identicon&r=PG", "display_name": "Eitan Waks", "link": "https://stackoverflow.com/users/2071618/eitan-waks"}, "edited": false, "score": 0, "creation_date": 1443555090, "post_id": 32850605, "comment_id": 53538046, "body": "Thank you so much for all of your help!!!  Out of curiosity, why would the file dialog work as opposed to using something from the Attachments object? The first place I looked to find a method was in the Attachments object. In my going about coding the wrong way?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 59, "user_id": 2071618, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95a65fdb4ad534d8898054baa5324c75?s=128&d=identicon&r=PG", "display_name": "Eitan Waks", "link": "https://stackoverflow.com/users/2071618/eitan-waks"}, "edited": false, "score": 0, "creation_date": 1443555258, "post_id": 32850605, "comment_id": 53538132, "body": "The <code>FileDialog</code> method uses the <code>olItem.Attachments</code> object and adds each -- this is explicitly <i>part of the VBA code</i>.  If you rely on the <code>.ExecuteMSO</code> method, that should also work. They should both work. My preference would just be for explicit solution, rather than handing the process over to something that is outside of the program&#39;s execution code."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1443554927, "last_edit_date": 1443554927, "creation_date": 1443548999, "answer_id": 32850605, "question_id": 32850485, "link": "https://stackoverflow.com/questions/32850485/how-to-paste-into-outlook-from-microsoft-word/32850605#32850605", "title": "How to paste into Outlook from Microsoft Word", "body": "<p>Get a handle on the MailItem's Inspector which has a <code>.WordEditor</code> (basically MS Word Document instance)</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868098.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff868098.aspx</a></p>\n\n<p>This should do the trick:</p>\n\n<pre><code>oItem.To = \"xxxx@bxxxx.co.il; xxxx@xxxx.co.il\"\noItem.BCC = \"xxxx@docs.xxxx.co.uk\"\noItem.Subject = Subject\n'oItem.Body = 'NEED HELP\n\nDim mailWord as Object 'WordEditor\noItem.Display\nSet mailWord = oItem.GetInspector.WordEditor\nmailWord.Range(0).PasteAndFormat (wdFormatOriginalFormatting)\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>The explanation is fairly simple. In order to use a method like <code>PasteSpecial</code> you need to be working with an object that has that method available. The <code>MailItem</code> class does not directly have this, but it does contain the <code>Inspector.WordEditor</code> which is a word Document -- so any method you would use in word should be available to the <code>olItem.Inspector.WordEditor</code>.</p>\n\n<p><strong>FOLLOW-UP:</strong></p>\n\n<p>I would just use the <code>FileDialog</code> to select files to attach, like so:</p>\n\n<pre><code>Dim filePicker As FileDialog\nDim fileName As Variant\n\nSet filePicker = Application.FileDialog(msoFileDialogFilePicker)\nfilePicker.AllowMultiSelect = True\n\n'### specify the folder default for the fileDialog object\nfilePicker.InitialFileName = \"C:\\Path\\to\\your\\folder\\\" \nfilePicker.Show\n\nFor Each fileName In filePicker.SelectedItems\n    oItem.Attachments.Add (fileName)\nNext\n</code></pre>\n\n<p>Alternatively, and this may be simpler or it may be more problematic as is sometimes the case when you hand the thread over to another application:</p>\n\n<pre><code>olItem.GetInspector.CommandBars.ExecuteMSO \"AttachFile\"\n</code></pre>\n\n<p>I would prefer the <code>FileDialog</code> method just because it gives you more control over the resulting selections.</p>\n"}], "owner": {"reputation": 59, "user_id": 2071618, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95a65fdb4ad534d8898054baa5324c75?s=128&d=identicon&r=PG", "display_name": "Eitan Waks", "link": "https://stackoverflow.com/users/2071618/eitan-waks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4208, "favorite_count": 0, "accepted_answer_id": 32850605, "answer_count": 1, "score": 1, "last_activity_date": 1443554927, "creation_date": 1443548614, "last_edit_date": 1443549449, "question_id": 32850485, "link": "https://stackoverflow.com/questions/32850485/how-to-paste-into-outlook-from-microsoft-word", "title": "How to paste into Outlook from Microsoft Word", "body": "<p>I want to write some VBA code that will automatically create a new email from an RTF document. I'm using the following programs:\n1. Microsoft Word 2013\n2. Microsoft Outlook 2013</p>\n\n<p>I have managed to do everything I want except how to paste the content that I copied into the body of the email.</p>\n\n<p>I have searched all over the web for how to do this however I have not found any simple way of doing this. In addition, all of the examples that I have found were related to Microsoft Excel. I have noticed that there is a difference when using Microsoft Word.</p>\n\n<p>Below is the code that I have written:</p>\n\n<pre><code>Sub SendDocAsMail()\n\nDim oOutlookApp As Outlook.Application\nDim oItem As Outlook.MailItem\nDim TheUser As String\nDim Subject As String\nDim ClientRef As String\nDim Body As String\nDim Signature As String\nDim SigString As String\nDim i As Integer\nDim Pos As Integer\nDim myAttachments As Outlook.Attachments\n\nTheUser = Environ(\"UserName\")\n\nOn Error Resume Next\n\n'Start Outlook if it isn't running\nSet oOutlookApp = GetObject(, \"Outlook.Application\")\nIf Err &lt;&gt; 0 Then\n    Set oOutlookApp = CreateObject(\"Outlook.Application\")\nEnd If\n\n'Create a new message\nSet oItem = oOutlookApp.CreateItem(olMailItem)\n\n'Copy the open document to subject and body\n\n'Change only Mysig.htm to the name of your signature\n    SigString = Environ(\"appdata\") &amp; _\n                \"\\Microsoft\\Signatures\\\" &amp; TheUser &amp; \".htm\"\n\nSelection.MoveDown Unit:=wdLine, Count:=1, Extend:=wdExtend\nSubject = Selection.Text\nSubject = Left(Subject, Len(Subject) - 1)\nClientRef = Subject\nClientRef = Right(ClientRef, Len(ClientRef) - 1)\nFor i = 1 To Len(ClientRef)\n    If Mid(ClientRef, i, 1) = \"|\" Then\n        Pos = i\n    End If\nNext i\nClientRef = Left(ClientRef, Pos - 1)\n\nSelection.Delete Unit:=wdCharacter, Count:=1\nSelection.Delete Unit:=wdCharacter, Count:=1\nSelection.EndKey Unit:=wdStory\nSelection.TypeParagraph\nSelection.TypeParagraph\nSelection.InsertFile (SigString)\n\nSelection.WholeStory\nSelection.Copy\n\noItem.To = \"xxxx@xxxx.co.il; xxxx@xxxx.co.il\"\noItem.BCC = \"xxxx@xxxx.co.uk\"\noItem.Subject = Subject\n'oItem.Body = 'NEED HELP\n'Selection.PasteAndFormat (wdFormatOriginalFormatting)\n\noItem.Display\n\nSet myAttachments = oItem.Attachments\n'myAttachments.Add.PathName = \"C:\\Users\\\" &amp; TheUser &amp; \"\\Dropbox\\PATENT\\Bressler\\\" &amp; ClientRef &amp; \"\\\"\n'Clean up\n'    Word.ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges\n'    Word.Application.Quit SaveChanges:=wdDoNotSaveChanges\n\n\nEnd Sub\n</code></pre>\n\n<p>All help in pasting the copy text with the original formatting would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1443547615, "post_id": 32850001, "comment_id": 53534163, "body": "I&#39;m getting run-time error 1004: Application-defined or object-defined error on that line"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1443548771, "post_id": 32850001, "comment_id": 53534833, "body": "What happens when you do the page setup in the same procedure before issuing a <code>.Printout</code>"}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1443548977, "post_id": 32850001, "comment_id": 53534949, "body": "I&#39;ve added a Call to the code that does all the formatting right in the print macro and it&#39;s the same outcome.  I have thought of a solution but I&#39;m not sure how to work it.  I would like to pick these sheets and insert a blank sheet between each and generate the print preview."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1443549051, "post_id": 32850001, "comment_id": 53534999, "body": "How would inserting a blank sheet help?"}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1443549406, "post_id": 32850001, "comment_id": 53535195, "body": "I can not control duplex printing so inserting blank pages would fix the duplex issue for me."}], "answers": [{"comments": [{"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1443554026, "post_id": 32851344, "comment_id": 53537516, "body": "That doesn&#39;t work and I believe it&#39;s because my charts are sheets, they are not selectable objects."}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1443610951, "post_id": 32851344, "comment_id": 53560958, "body": "Using that gives me &quot;The index into the specified collection is out of bounds.&quot;"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1443562295, "last_edit_date": 1443562295, "creation_date": 1443551557, "answer_id": 32851344, "question_id": 32850001, "link": "https://stackoverflow.com/questions/32850001/printing-using-vba-code-not-the-same-as-using-ui/32851344#32851344", "title": "Printing using VBA code not the same as using UI", "body": "<p>Try using <strong><code>.PageSetup.PrintArea</code></strong>:</p>\n\n<pre><code>Application.ScreenUpdating = False\nWith Sheets(\"83IO\")\n\n    .PageSetup.PrintArea = .Shapes(1).TopLeftCell.Address &amp; \":\" &amp; _\n                           .Shapes(1).BottomRightCell.Address\n\n    With .PageSetup\n        .CenterHorizontally = True\n        .CenterVertically = True\n        .Orientation = xlLandscape\n        .Zoom = 100\n        .FitToPagesWide = 1\n        .FitToPagesTall = 1\n    End With\n    .PrintPreview\nEnd With\nApplication.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443562295, "creation_date": 1443546933, "last_edit_date": 1531161705, "question_id": 32850001, "link": "https://stackoverflow.com/questions/32850001/printing-using-vba-code-not-the-same-as-using-ui", "title": "Printing using VBA code not the same as using UI", "body": "<p>I am having a problem with my Excel file.  I am copying graphs from other files and pasting them as sheets so they are now \"Chart Sheets\".  All of this works fine but the issue comes when printing.  I have a page setup macro that sets the margins and footer and IF I print it using the print button it comes out fine.  The graph is nicely centered and white space is equal all around, it is printing the same as it appears in Print Preview.  The problem is when I print from VBA using either of the following codes:</p>\n\n<pre><code>Sheets(\"83IO\").Activate\nActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n    IgnorePrintAreas:=False\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Sheets(\"83IO\").Activate\nActiveChart.ChartArea.Select\nActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n    IgnorePrintAreas:=False\n</code></pre>\n\n<p>These printouts have the charts off to the side and double the whitespace on the bottom and right.  Changing the margins does not seem to alter these printout and I'm at a loss what to do with this.</p>\n\n<p>I've tried setting <code>IgnorePrintAreas</code> to true since these pages are nothing but graphs and the result is the same.</p>\n\n<p>Thank you for any help you can provide.</p>\n"}, {"tags": ["vba", "excel", "date", "datetime"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 1, "creation_date": 1443546975, "post_id": 32849959, "comment_id": 53533794, "body": "VBA is biased toward American dates. When using CDate() if a legal date can be formed by mm/dd it will go that way."}], "answers": [{"comments": [{"owner": {"reputation": 64, "user_id": 5278917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f25b8d72fcdafdf5c83543b22692b539?s=128&d=identicon&r=PG&f=1", "display_name": "ramesses", "link": "https://stackoverflow.com/users/5278917/ramesses"}, "edited": false, "score": 0, "creation_date": 1443547380, "post_id": 32850071, "comment_id": 53534023, "body": "Yes, that&#39;s the only way I can see it working, but was hoping for a more generic way, as the data source isn&#39;t very consistent either, it could dd/mm one day, and mm/dd the other."}, {"owner": {"reputation": 64, "user_id": 5278917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f25b8d72fcdafdf5c83543b22692b539?s=128&d=identicon&r=PG&f=1", "display_name": "ramesses", "link": "https://stackoverflow.com/users/5278917/ramesses"}, "edited": false, "score": 0, "creation_date": 1443547536, "post_id": 32850071, "comment_id": 53534112, "body": "Thanks a lot for DateSerial hint. That&#39;s the way to go for now."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 64, "user_id": 5278917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f25b8d72fcdafdf5c83543b22692b539?s=128&d=identicon&r=PG&f=1", "display_name": "ramesses", "link": "https://stackoverflow.com/users/5278917/ramesses"}, "edited": false, "score": 0, "creation_date": 1443547556, "post_id": 32850071, "comment_id": 53534125, "body": "If the data are not consistent, you are in a tough spot."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 3, "last_activity_date": 1443547625, "last_edit_date": 1443547625, "creation_date": 1443547251, "answer_id": 32850071, "question_id": 32849959, "link": "https://stackoverflow.com/questions/32849959/vba-interpretation-of-input-date/32850071#32850071", "title": "VBA interpretation of input date", "body": "<p>Use DateSerial() instead of CDate():</p>\n\n<pre><code>    Dim d$\n    d = \"06/08/2015\"\n    MsgBox DateSerial(Right$(d, 4), Mid$(d, 4, 2), Left$(d, 2))\n</code></pre>\n\n<p>This way you control which bits of the date are which.</p>\n"}], "owner": {"reputation": 64, "user_id": 5278917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f25b8d72fcdafdf5c83543b22692b539?s=128&d=identicon&r=PG&f=1", "display_name": "ramesses", "link": "https://stackoverflow.com/users/5278917/ramesses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 32850071, "answer_count": 1, "score": 2, "last_activity_date": 1460545055, "creation_date": 1443546768, "last_edit_date": 1460545055, "question_id": 32849959, "link": "https://stackoverflow.com/questions/32849959/vba-interpretation-of-input-date", "title": "VBA interpretation of input date", "body": "<p>I have this annoying date format inconsistency with Excel VBA. I have a source text file, which has dates in format of <code>dd/mm/yyyy</code> (i.e. the sane format). But I need to convert it to <code>yyyy/mm/dd</code> (for consistency, I also set up this format as default in my computer). </p>\n\n<p>When I export this text file into database, if both of the <code>dd</code> and <code>mm</code> values are less than 12, VBA treats them as <code>mm/dd/yyyy</code> instead of <code>dd/mm/yyyy</code>. Even I am very confused about this non-standard date format, poor VBA.</p>\n\n<p>For example, I have <code>06/08/2015</code> in text file, which is <code>6th August</code>, but  <code>CDate(\"06/08/2015\")</code> returns <code>2015/06/08</code>, i.e. <code>8th June</code>. But if the text file has <code>15/08/201</code>5, VBA can identify it as <code>2015/08/15</code>.</p>\n\n<p>How to tell VBA that <code>06/08/2015</code> is in <code>dd/mm/yyyy</code> format?</p>\n\n<p>Any help with this annoying and tedious task would be greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1443548402, "creation_date": 1443548402, "answer_id": 32850434, "question_id": 32849758, "link": "https://stackoverflow.com/questions/32849758/creating-duplicate-excel-row-based-the-values-in-another-excel-file-cell/32850434#32850434", "title": "Creating Duplicate Excel Row based the values in another Excel file cell", "body": "<p>Your question comes in three parts.</p>\n\n<ol>\n<li><p>restructuring the data in file 1</p></li>\n<li><p>Using VLOOKUP to get the data from file 2 and put it into your restuctured data  (this is different to how you were thinking about it).</p></li>\n<li><p>adding the line number column.</p></li>\n</ol>\n\n<p>Solving 2 is not to bad - find out how vlookup works if you don't know.</p>\n\n<p>Solving 3 is easy once you have the data restructured.  You simply add a formula to the line number column that uses an IF statement to see if the value in the bomitem column in the same row is different to the one in the bomitem column in the row above.  If it is add one to the value in the cell in the row above the forumla column (ie the line number column) , if not use 1.</p>\n\n<p>Solving 1. Is harder.  There is no majic button for this in excel.  I suspect the easiest way will be to copy and paste!  I say this as you are probably only going to do this once, and there are probably not many BOM PN columns.</p>\n\n<p>If either of these statements are not true, you might want to consider writing VBA.</p>\n\n<p>You could also write formulas to do it.</p>\n\n<p>I've run out of time.</p>\n"}], "owner": {"reputation": 285, "user_id": 4085182, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2c126d380f3496750fc50473eae10f2?s=128&d=identicon&r=PG&f=1", "display_name": "Kinfe", "link": "https://stackoverflow.com/users/4085182/kinfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443552943, "creation_date": 1443546070, "last_edit_date": 1443552943, "question_id": 32849758, "link": "https://stackoverflow.com/questions/32849758/creating-duplicate-excel-row-based-the-values-in-another-excel-file-cell", "title": "Creating Duplicate Excel Row based the values in another Excel file cell", "body": "<p>I have  two Excel Files <code>Excel File 1</code> and <code>Excel File 2</code>\nI want to create Bill of Material to import into one of my Applications. I have components listed in the same row. I want to create duplicate Rows like if Part Number have 3 Components i want duplicate the same row 3 times and change the <code>lineNbr</code>and <code>PartId</code> fields of <code>Excel File 2</code></p>\n\n<p><code>Excel File 1</code>\n<a href=\"https://i.stack.imgur.com/tWkcv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tWkcv.png\" alt=\"Source\"></a></p>\n\n<p><code>Excel File 2</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/x14Kk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x14Kk.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to update <code>Excel File 2</code> as shown below in the same Sheet. \n<a href=\"https://i.stack.imgur.com/l9W6D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l9W6D.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "find"], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 0, "last_activity_date": 1443549365, "creation_date": 1443549365, "answer_id": 32850729, "question_id": 32849716, "link": "https://stackoverflow.com/questions/32849716/im-trying-to-find-a-value-from-one-range-in-another-if-exist-replace-except-bl/32850729#32850729", "title": "I&#39;m trying to find a value from one range in another. If exist replace except blanks, if not exist create new line", "body": "<p>You can add a check around the update statements for B and C.  Only update if the values in the SourceFile are not blank.</p>\n\n<pre><code>    If Not j Is Nothing Then\n        If Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 2).Value &lt;&gt; \"\" Then\n            .Cells(j.Row, j.Column).Offset(0, 1).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 2).Value\n            .Cells(j.Row, j.Column).Offset(0, 2).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 3).Value\n        End if\n    Else\n        .Cells(l, 1).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 1).Value\n        .Cells(l, 2).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 2).Value\n        .Cells(l, 3).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 3).Value\n    End If\n</code></pre>\n\n<p>if you want one or the other if it exists in the sourcefile, put the check around each one.</p>\n\n<pre><code>    If Not j Is Nothing Then\n        If Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 2).Value &lt;&gt; \"\" Then\n            .Cells(j.Row, j.Column).Offset(0, 1).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 2).Value\n        End if\n        If Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 3).Value &lt;&gt; \"\" Then\n            .Cells(j.Row, j.Column).Offset(0, 2).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 3).Value\n        End if\n    Else\n        .Cells(l, 1).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 1).Value\n        .Cells(l, 2).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 2).Value\n        .Cells(l, 3).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 3).Value\n    End If\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5389590, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10153195219322621/picture?type=large", "display_name": "Luis Lara", "link": "https://stackoverflow.com/users/5389590/luis-lara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 32850729, "answer_count": 1, "score": 1, "last_activity_date": 1443549365, "creation_date": 1443545932, "last_edit_date": 1531164843, "question_id": 32849716, "link": "https://stackoverflow.com/questions/32849716/im-trying-to-find-a-value-from-one-range-in-another-if-exist-replace-except-bl", "title": "I&#39;m trying to find a value from one range in another. If exist replace except blanks, if not exist create new line", "body": "<p>I'm trying to find a value from one range in another.\nIf exist replace except blanks, if not exist create new line</p>\n\n<p>I have two files 'SourceFile' and 'TargetFile'.<br>\n'TargetFile' is where I store my information.<br>\n'SourceFile' is an updated file with new information.</p>\n\n<p>This code right now does the following.<br>\nFinds a value in TargetFile, goes to SourceFile and updates column B and C.<br>\nIf the value is not found, copies from SourceFile to TargetFile columns A, B and C.</p>\n\n<p>But what I need is that if the SourceFile contains blanks in column B or C and if the TargetFile already contains information.\nBasically I want to keep the previous information when we have a blank in the SourceFile.</p>\n\n<p>Do you have any idea how to modify this current code to make it funtional? </p>\n\n<pre><code>Sub Test2()\n\nDim i As Integer\nk = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row\nFor i = 1 To k\nl = 1\n\n    findvalue = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 1).Value\n\n    With Workbooks(\"TargetFile.xlsm\").Sheets(\"Sheet1\")\n        l = .Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n        Set j = .Range(\"A:A\").Find(findvalue)\n\n        If Not j Is Nothing Then\n            .Cells(j.Row, j.Column).Offset(0, 1).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 2).Value\n            .Cells(j.Row, j.Column).Offset(0, 2).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 3).Value\n        Else\n            .Cells(l, 1).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 1).Value\n            .Cells(l, 2).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 2).Value\n            .Cells(l, 3).Value = Workbooks(\"SourceFile.xlsm\").Sheets(\"Sheet1\").Cells(i, 3).Value\n        End If\n\n    End With\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>Thanks for your help,<br>\nLuis</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1443547249, "post_id": 32849642, "comment_id": 53533943, "body": "From Workbook2, you want to use a UDF stored in Workbook1 and have all the descriptions carry over?"}, {"owner": {"reputation": 31, "user_id": 5368045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nImoo.jpg?s=128&g=1", "display_name": "ceegers", "link": "https://stackoverflow.com/users/5368045/ceegers"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1443549975, "post_id": 32849642, "comment_id": 53535522, "body": "@vsoraas Yup. In the second, the UDFs from the first work fine, and the function description displays, just the argument descriptions don&#39;t. Slightly edited to hopefully make that clearer for future people."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1443567835, "post_id": 32849642, "comment_id": 53543939, "body": "Did you try running the <code>DescribeFunction()</code> in the new workbook?"}, {"owner": {"reputation": 31, "user_id": 5368045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nImoo.jpg?s=128&g=1", "display_name": "ceegers", "link": "https://stackoverflow.com/users/5368045/ceegers"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1443627429, "post_id": 32849642, "comment_id": 53572140, "body": "@paul bica This is not reasonable due to these functions being constantly used in new workbooks throughout my company. My current workaround of doing my best to describe everything in the 255 character function description is preferable to that."}], "answers": [{"comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1443628309, "post_id": 32860992, "comment_id": 53572728, "body": "I was going to suggest the PERSONAL.xlsb, but I&#39;m not sure how it can be loaded permanently"}, {"owner": {"reputation": 31, "user_id": 5368045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nImoo.jpg?s=128&g=1", "display_name": "ceegers", "link": "https://stackoverflow.com/users/5368045/ceegers"}, "edited": false, "score": 0, "creation_date": 1443708695, "post_id": 32860992, "comment_id": 53609086, "body": "Thank you for your advice - when I have time I will have to look into XLAM and how it is different from what we currently do, which is have a xlsm file in the xlstart folder that opens hidden automatically."}, {"owner": {"reputation": 31, "user_id": 5368045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nImoo.jpg?s=128&g=1", "display_name": "ceegers", "link": "https://stackoverflow.com/users/5368045/ceegers"}, "edited": false, "score": 0, "creation_date": 1443799010, "post_id": 32860992, "comment_id": 53648881, "body": "Huh... well that was oddly easy. Still curious why the other method makes the overall description transfer ok and not the argument descriptions, but this does appear to sufficiently resolve the issue. Thanks!"}, {"owner": {"reputation": 31, "user_id": 5368045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nImoo.jpg?s=128&g=1", "display_name": "ceegers", "link": "https://stackoverflow.com/users/5368045/ceegers"}, "edited": false, "score": 0, "creation_date": 1443799500, "post_id": 32860992, "comment_id": 53649175, "body": "On the other hand... while shortcuts and ribbon buttons work, the add-in macros do not show up when you choose Macros in the Developer tab???"}, {"owner": {"reputation": 31, "user_id": 5368045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nImoo.jpg?s=128&g=1", "display_name": "ceegers", "link": "https://stackoverflow.com/users/5368045/ceegers"}, "edited": false, "score": 0, "creation_date": 1443800377, "post_id": 32860992, "comment_id": 53649695, "body": "Alright, as per <a href=\"http://www.mrexcel.com/forum/excel-questions/410251-add-not-showing-macros-list.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a> and <a href=\"http://www.pcreview.co.uk/threads/cannot-display-add-in-macro-list-without-going-to-vba-project.4039730/\" rel=\"nofollow noreferrer\">pcreview.co.uk/threads/&hellip;</a> it seems I cannot have macros from an add-in show up with the macro button. So the best solution seems to be to use an add-in for the functions and a hidden auto-opening workbook for the macros."}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1443600411, "creation_date": 1443600411, "answer_id": 32860992, "question_id": 32849642, "link": "https://stackoverflow.com/questions/32849642/see-udf-argument-descriptions-in-other-workbooks/32860992#32860992", "title": "See UDF Argument Descriptions in Other Workbooks", "body": "<p>It works Ok if you put the UDF and DESCRIBEFUNCTION in an XLAM and open that before opening another workbook.<br>\nBut note that you cannot run DESCRIBEFUNCTION in the workbook open event of the XLAM if it is opened before any other workbooks.</p>\n"}], "owner": {"reputation": 31, "user_id": 5368045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nImoo.jpg?s=128&g=1", "display_name": "ceegers", "link": "https://stackoverflow.com/users/5368045/ceegers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 32860992, "answer_count": 1, "score": 0, "last_activity_date": 1443600411, "creation_date": 1443545584, "last_edit_date": 1443550127, "question_id": 32849642, "link": "https://stackoverflow.com/questions/32849642/see-udf-argument-descriptions-in-other-workbooks", "title": "See UDF Argument Descriptions in Other Workbooks", "body": "<ol>\n<li>Create a UDF.</li>\n<li>Use <a href=\"http://spreadsheetpage.com/index.php/tip/user-defined_function_argument_descriptions_in_excel_2010/\" rel=\"nofollow\">this site</a> to create function and argument descriptions.</li>\n<li>Use UDF, open function wizard, all descriptions are displayed. Great!</li>\n<li>Go to another workbook while this is still open.</li>\n<li>Use UDF from initial workbook (with the necessary prefix), open function wizard, only the function description is displayed (no argument descriptions). Boo!</li>\n</ol>\n\n<p>Is there a way to have the argument descriptions display in #5?</p>\n\n<p>Adding function and argument descriptions for a UDF appears to be brand new to Excel 2010, so I suspect this may simply be not currently possible, but I cannot actually find the idea of using it in other workbooks discussed, and haven't been able to get it to work myself. Descriptive variable names can only get you so far, and function descriptions are limited to 255 characters (at least that's the largest using the link's method).</p>\n\n<p>It would be ideal to have this work using the built-in function wizard so it can be accessed outside a macro, but these functions are often created using macros, so if you have a particularly good alternate suggestion, that would be appreciated as well.</p>\n\n<p>Excel 2010, Windows 7 Professional</p>\n"}, {"tags": ["excel", "vba", "csv"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4811488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a802f7494a25f3e9462110e3f7da3ac9?s=128&d=identicon&r=PG&f=1", "display_name": "Rocko_roll", "link": "https://stackoverflow.com/users/4811488/rocko-roll"}, "edited": false, "score": 0, "creation_date": 1443548470, "post_id": 32849552, "comment_id": 53534662, "body": "It works, but in the end it creates also a file named TRUE or FALSE, wheter I click the accept or de cancel button; and also the save as type is not choosed CSV by default."}], "tags": [], "owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "is_accepted": false, "score": 0, "last_activity_date": 1443545241, "creation_date": 1443545241, "answer_id": 32849552, "question_id": 32849450, "link": "https://stackoverflow.com/questions/32849450/set-fixed-save-as-type-for-a-save-as-macro/32849552#32849552", "title": "Set Fixed Save As Type for a Save As Macro", "body": "<pre><code>ActiveWorkbook.SaveAs Application.Dialogs(xlDialogSaveAs).Show, xlCSV\n</code></pre>\n\n<p>Should get you started. You should consider assigning the value to a variable.</p>\n"}], "owner": {"reputation": 3, "user_id": 4811488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a802f7494a25f3e9462110e3f7da3ac9?s=128&d=identicon&r=PG&f=1", "display_name": "Rocko_roll", "link": "https://stackoverflow.com/users/4811488/rocko-roll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1443552959, "creation_date": 1443544935, "last_edit_date": 1443552959, "question_id": 32849450, "link": "https://stackoverflow.com/questions/32849450/set-fixed-save-as-type-for-a-save-as-macro", "title": "Set Fixed Save As Type for a Save As Macro", "body": "<p>I've been working in this macro, the only thing that I need to do is to save the Final sheet into a CSV file.</p>\n\n<p>The problem is that I need to choose the path and the name of the file. I've managed to open the pop up window to save it, but I need to set fixed the CSV value, is it possible? </p>\n\n<p>Here's my code</p>\n\n<pre><code>    Sub Fin()\n        Sheets(\"COI\").Select\n        Columns(\"A:O\").Select\n        Selection.Copy\n        Sheets(\"Final\").Select\n        Columns(\"A:A\").Select\n        Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks _\n           :=True, Transpose:=False\n        On Error Resume Next\n        xTitleId = \"Selecci\u00f3n: \"\n        Set WorkRng = Application.Selection\n        Set WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\n        For Each Rng In WorkRng\n        If Rng.Value &lt;&gt; \"\" Then\n        If OutRng Is Nothing Then\n        Set OutRng = Rng\n        Else\n        Set OutRng = Union(OutRng, Rng)\n        End If\n        End If\n        Next\n        If Not OutRng Is Nothing Then\n        OutRng.Select\n        End If\n        Selection.Copy\n        ActiveSheet.Select\n        If MsgBox(\"\u00bfEst\u00e1 seguro de haber rellenado correctamente la plantilla?\", vbQuestion + vbYesNo) = vbYes Then\n        ActiveWorkbook.SaveAs Application.Dialogs(xlDialogSaveAs).Show\n        MsgBox \"Se ha guardado correctamente.\", vbInformation\n      End If\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 239, "user_id": 1912544, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3a09d9151f7ca34ef7365375478fe975?s=128&d=identicon&r=PG", "display_name": "kris", "link": "https://stackoverflow.com/users/1912544/kris"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1443554725, "post_id": 32849432, "comment_id": 53537839, "body": "<b>@pnuts</b> when I do several rows it is not a problem. But when I do the <i>complete</i> range ... <i>the problem occurs</i>. So maybe I have to look ... for a loop over the rows of the range"}, {"owner": {"reputation": 239, "user_id": 1912544, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3a09d9151f7ca34ef7365375478fe975?s=128&d=identicon&r=PG", "display_name": "kris", "link": "https://stackoverflow.com/users/1912544/kris"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1443554919, "post_id": 32849432, "comment_id": 53537941, "body": "@pnuts How do you mean?"}], "owner": {"reputation": 239, "user_id": 1912544, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3a09d9151f7ca34ef7365375478fe975?s=128&d=identicon&r=PG", "display_name": "kris", "link": "https://stackoverflow.com/users/1912544/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1460544144, "creation_date": 1443544879, "last_edit_date": 1531161705, "question_id": 32849432, "link": "https://stackoverflow.com/questions/32849432/inserting-data-in-a-pivot-table-via-a-macro", "title": "Inserting data in a pivot table via a macro", "body": "<p>The intention is to copy dynamically the complete range of data from page <code>INPUT</code> to the pivot table <code>Table16</code> on page <code>OUTPUT</code> - in the first cell under the title <code>NAME</code>.</p>\n\n<p><em>A small remark in the pivot table (some kind of template) contains more columns then just the 3 I want to copy in.</em></p>\n\n<pre><code>Sub SelectCopy()\n '\n ' SelectCopy Macro\n '\n\n' the intention is to copy dynamically  the complete range of data - on page INPUT\n ' to the pivot table Table16 on OUTPUT page - in the first cel under the title NAME\n\nRange_cels = Sheets(\"info\").Range(\"M4\").Value\n\n    ThisWorkbook.Sheets(\"input\").Select\n\n     Range(Range_cels).Select\n     Selection.Copy\n\n      MsgBox \"The data has been successfully copied.\"\n\n     ThisWorkbook.Sheets(\"output\").Select\n     '1/\n     'table16 is a pivot table, wanted select the first cell beneath the title row\n     ' complains about 'ActiveSheet.Paste' failure\n     ActiveCell.Offset(0, 0).Range(\"Table16[[#Headers],[Name]]\").Select\n     '2/ - works fine but puts it in the last selected cell\n     'ActiveCell.Offset(rowOffset:=0, columnOffset:=0).Activate\n     '3/ - fails complains it is in pivot table\n     'Range(\"A2\").Select\n\n      MsgBox \"almost ... pasted.\"\n\n     ActiveSheet.Paste\n\n      MsgBox \"The data has been successfully pasted.\"\n      MsgBox \"The data has been successfully copied &amp; pasted.\"\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Xlnxm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xlnxm.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Method 1:</strong></p>\n\n<pre><code>ActiveCell.Offset(0, 0).Range(\"Table16[[#Headers],[Name]]\").Select \n</code></pre>\n\n<p>Gives error 1004:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mZ1y7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mZ1y7.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the pivot table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ka30y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ka30y.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "edited": false, "score": 0, "creation_date": 1443543919, "post_id": 32849106, "comment_id": 53531992, "body": "You should remove your password from the code."}, {"owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "edited": false, "score": 0, "creation_date": 1443543977, "post_id": 32849106, "comment_id": 53532029, "body": "In which sub does this error occur?"}, {"owner": {"reputation": 1, "user_id": 5389594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4285bea449df6b7017089389dbeb7be0?s=128&d=identicon&r=PG&f=1", "display_name": "R. B.", "link": "https://stackoverflow.com/users/5389594/r-b"}, "reply_to_user": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "edited": false, "score": 0, "creation_date": 1443544316, "post_id": 32849106, "comment_id": 53532243, "body": "thanks... error occurs in Button2_Click() subroutine"}, {"owner": {"reputation": 16152, "user_id": 205233, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fd3b79356ba4ea1f7e8d6be783446e59?s=128&d=identicon&r=PG&f=1", "display_name": "Filburt", "link": "https://stackoverflow.com/users/205233/filburt"}, "edited": false, "score": 1, "creation_date": 1443544601, "post_id": 32849106, "comment_id": 53532418, "body": "Looks like you&#39;re simply missing the <code>Next sh</code> on your first <code>For Each</code>"}, {"owner": {"reputation": 1, "user_id": 5389594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4285bea449df6b7017089389dbeb7be0?s=128&d=identicon&r=PG&f=1", "display_name": "R. B.", "link": "https://stackoverflow.com/users/5389594/r-b"}, "edited": false, "score": 0, "creation_date": 1443548180, "post_id": 32849106, "comment_id": 53534497, "body": "Now its telling me that my password is incorrect and that I should check if caps lock in on... Caps lock is off &amp; I definitely have the correct password in the code and in excel"}, {"owner": {"reputation": 1, "user_id": 5389594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4285bea449df6b7017089389dbeb7be0?s=128&d=identicon&r=PG&f=1", "display_name": "R. B.", "link": "https://stackoverflow.com/users/5389594/r-b"}, "edited": false, "score": 0, "creation_date": 1443548804, "post_id": 32849106, "comment_id": 53534858, "body": "I have 3 worksheets in my file only 1 is protected do I have to protect all 3 sheets for the VB code to work?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5389594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4285bea449df6b7017089389dbeb7be0?s=128&d=identicon&r=PG&f=1", "display_name": "R. B.", "link": "https://stackoverflow.com/users/5389594/r-b"}, "edited": false, "score": 0, "creation_date": 1443548175, "post_id": 32849368, "comment_id": 53534494, "body": "Now its telling me that my password is incorrect and that I should check if caps lock in on... Caps lock is off &amp; I definitely have the correct password in the code and in excel"}, {"owner": {"reputation": 1, "user_id": 5389594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4285bea449df6b7017089389dbeb7be0?s=128&d=identicon&r=PG&f=1", "display_name": "R. B.", "link": "https://stackoverflow.com/users/5389594/r-b"}, "edited": false, "score": 0, "creation_date": 1443548810, "post_id": 32849368, "comment_id": 53534862, "body": "I have 3 worksheets in my file only 1 is protected do I have to protect all 3 sheets for the VB code to work?"}], "tags": [], "owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "is_accepted": false, "score": 0, "last_activity_date": 1443544645, "creation_date": 1443544645, "answer_id": 32849368, "question_id": 32849106, "link": "https://stackoverflow.com/questions/32849106/i-need-help-in-putting-data-into-a-protected-sheet/32849368#32849368", "title": "I need help in-putting data into a protected sheet", "body": "<pre><code>**'Delete this following line \n    For Each sh In ActiveWorkbook.Worksheets**\n        sh.Protect Password:=Password\n    Next sh\n\nEnd Sub\n</code></pre>\n\n<p>You create a second loop with the same variable before you exit the first. </p>\n"}], "owner": {"reputation": 1, "user_id": 5389594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4285bea449df6b7017089389dbeb7be0?s=128&d=identicon&r=PG&f=1", "display_name": "R. B.", "link": "https://stackoverflow.com/users/5389594/r-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1443545993, "creation_date": 1443543797, "last_edit_date": 1531161705, "question_id": 32849106, "link": "https://stackoverflow.com/questions/32849106/i-need-help-in-putting-data-into-a-protected-sheet", "title": "I need help in-putting data into a protected sheet", "body": "<p>I've tried a \" probable solution\" I found here on this site but I get an error saying \"Compile Error: For control variable already in use\" the macro uses a button that has to be clicked for it to run.</p>\n\n<p>My Code is as follows....</p>\n\n<pre><code>Sub Coa()\nCoa.Unprotect Password:=Password\n'\n' Coa Macro\n' create coa\n'\n' Keyboard Shortcut: Ctrl+Shift+C\n'\n    Sheets(\"GeneralFormat\").Select\n    ActiveSheet.Range(\"$B:$B\").AutoFilter Field:=1, Criteria1:=Array(\"1\", \"10\", _\n        \"15\", \"20\", \"25\", \"5\", \"30\", \"35\", \"40\", \"45\", \"50\", \"55\", \"60\", \"65\", \"70\", _\n        \"75\", \"80\", \"85\", \"90\", \"95\", \"100\"), Operator:=xlFilterValues\n    Range(\"D6:O105\").Select\n    Selection.Copy\n    Sheets(\"CoA\").Select\n    ActiveSheet.Range(\"E25:E25\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=True\n    Sheets(\"GeneralFormat\").Select\n    Selection.AutoFilter\n    Sheets(\"CoA\").Select\nCoa.Protect Password:=Password\nEnd Sub\n\nSub Button2_Click()\n\nDim sh As Worksheet\n\nDim yourPassword As String\n\n    yourPassword = \"Password\"\n\n   For Each sh In ActiveWorkbook.Worksheets\n        sh.Unprotect Password:=Password\n' ---------------------------------------------------------------------------------------------------------------------------------------\n    Sheets(\"GeneralFormat\").Select\n    ActiveSheet.Range(\"$B:$B\").AutoFilter Field:=1, Criteria1:=Array(\"1\", \"10\", _\n        \"15\", \"20\", \"25\", \"5\", \"30\", \"35\", \"40\", \"45\", \"50\", \"55\", \"60\", \"65\", \"70\", _\n        \"75\", \"80\", \"85\", \"90\", \"95\", \"100\"), Operator:=xlFilterValues\n    Range(\"D6:O105\").Select\n    Selection.Copy\n    Sheets(\"CoA\").Select\n    ActiveSheet.Range(\"E25:E25\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=True\n    Sheets(\"GeneralFormat\").Select\n    Selection.AutoFilter\n    Sheets(\"CoA\").Select\n' --------------------------------------------------------------------------------------------------------------------------------------\n\nFor Each sh In ActiveWorkbook.Worksheets\n        sh.Protect Password:=Password\n    Next sh\n\nEnd Sub\n</code></pre>\n"}]