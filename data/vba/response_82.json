[{"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470267275, "post_id": 38755217, "comment_id": 64884243, "body": "The first parameter should be your &quot;field name&quot;, so does it need to be &quot;[Customer Number]&quot;?  Also <code>&quot;Customer Number=&quot; &amp; Range(&quot;A2&quot;)</code> should probably be <code>&quot;[Customer Number]=&quot; &amp; Range(&quot;A2&quot;)</code> or, maybe, <code>&quot;[Customer Number]=&#39;&quot; &amp; Range(&quot;A2&quot;) &amp; &quot;&#39;&quot;</code> (Not an expert on this aspect of VBA, so I am guessing.)  Also, you have a typo in <code>before you contiue</code>.  (But I doubt if that is causing any issues! ;) )"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470267603, "post_id": 38755217, "comment_id": 64884314, "body": "What exactly are you trying to use DCount <i>on</i>?  Is the data already in Excel? It would be a lot easier to see what is going on if you posted the rest of the code."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470267987, "post_id": 38755217, "comment_id": 64884416, "body": "Also (and only tangentially related to your question), enforcing database unique constraints on the client side is a losing battle.  The real solution would be to normalize and configure the DB to reject duplicate records - then just check for the INSERT error on the client side."}, {"owner": {"reputation": 15, "user_id": 6619940, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3217497ee9ca268b4b87162679f46a67?s=128&d=identicon&r=PG&f=1", "display_name": "mYxCHa", "link": "https://stackoverflow.com/users/6619940/myxcha"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470268170, "post_id": 38755217, "comment_id": 64884456, "body": "@Comintern I&#39;m trying to use the DCount on a table in an Access Database, basically the excel spreadsheet will export the record to the Access Database if their isn&#39;t already an existing record in the DB. Range(&quot;A2&quot;) is a field in excel spreadsheet to see if record already exists in Access DB"}, {"owner": {"reputation": 15, "user_id": 6619940, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3217497ee9ca268b4b87162679f46a67?s=128&d=identicon&r=PG&f=1", "display_name": "mYxCHa", "link": "https://stackoverflow.com/users/6619940/myxcha"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470268555, "post_id": 38755217, "comment_id": 64884551, "body": "@Comintern updated to include all the code shortened the ssql because it would be over 100 fields"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470268698, "post_id": 38755217, "comment_id": 64884585, "body": "The syntax for the Excel DCOUNT function is <code>DCOUNT(database, field, criteria)</code> so you probably need <code>DCount(&quot;[Investment Data]&quot;, &quot;[Customer Number]&quot;, &quot;[Customer Number]=&quot;&amp; Range(&quot;A2&quot;))</code>"}, {"owner": {"reputation": 15, "user_id": 6619940, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3217497ee9ca268b4b87162679f46a67?s=128&d=identicon&r=PG&f=1", "display_name": "mYxCHa", "link": "https://stackoverflow.com/users/6619940/myxcha"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470268986, "post_id": 38755217, "comment_id": 64884648, "body": "@YowE3K I tried changing it up but still the same error, and if I dont include Application.WorksheetFunction before the DCount I get a Sub or Function not defined error isntead."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470270808, "post_id": 38755217, "comment_id": 64885114, "body": "Sorry - I wasn&#39;t intending that you should try it without the &quot;Application.WorksheetFunction&quot; part - it&#39;s definitely needed.  That was just me being lazy while typing the comment."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470271812, "post_id": 38755217, "comment_id": 64885364, "body": "It appears that Excel requires the criteria to be formed by having the &quot;Customer Number&quot; and the &quot;=A2&quot; in a 2-cell vertical range."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6619940, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3217497ee9ca268b4b87162679f46a67?s=128&d=identicon&r=PG&f=1", "display_name": "mYxCHa", "link": "https://stackoverflow.com/users/6619940/myxcha"}, "edited": false, "score": 0, "creation_date": 1470272028, "post_id": 38755842, "comment_id": 64885411, "body": "I need to alert the user that their is a similar entry already in the DB so they can make appropriate changes. I&#39;m just not sure how this would allow it. Also only 1 row of data will be exported at a time not multiple."}, {"owner": {"reputation": 15, "user_id": 6619940, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3217497ee9ca268b4b87162679f46a67?s=128&d=identicon&r=PG&f=1", "display_name": "mYxCHa", "link": "https://stackoverflow.com/users/6619940/myxcha"}, "edited": false, "score": 0, "creation_date": 1470275393, "post_id": 38755842, "comment_id": 64887033, "body": "I&#39;m getting a data type mismatch in criteria expression error when it tries to run the &#39;Set rs = cN.Execute(ssql)&#39; line."}, {"owner": {"reputation": 15, "user_id": 6619940, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3217497ee9ca268b4b87162679f46a67?s=128&d=identicon&r=PG&f=1", "display_name": "mYxCHa", "link": "https://stackoverflow.com/users/6619940/myxcha"}, "edited": false, "score": 0, "creation_date": 1470276237, "post_id": 38755842, "comment_id": 64887222, "body": "If i remove the <code>WHERE</code> and <code>IN</code> clause, I get another error &quot;Operation is not allowed when the object is closed&quot; on the <code>If Not rs.BOF And Not rs.EOF Then</code> condition"}, {"owner": {"reputation": 15, "user_id": 6619940, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3217497ee9ca268b4b87162679f46a67?s=128&d=identicon&r=PG&f=1", "display_name": "mYxCHa", "link": "https://stackoverflow.com/users/6619940/myxcha"}, "edited": false, "score": 0, "creation_date": 1470277879, "post_id": 38755842, "comment_id": 64887616, "body": "I get the operations not allowed error at the <code>Do While</code> Loop, so I commented out my <code>INSERT INTO</code> clause and it returned a result (The Customer Number). It then gets a data type mismatch on the second <code>Set rs = cN.Execute(ssql)</code>"}, {"owner": {"reputation": 15, "user_id": 6619940, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3217497ee9ca268b4b87162679f46a67?s=128&d=identicon&r=PG&f=1", "display_name": "mYxCHa", "link": "https://stackoverflow.com/users/6619940/myxcha"}, "edited": false, "score": 0, "creation_date": 1470283162, "post_id": 38755842, "comment_id": 64888900, "body": "Yes, using latest one"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 15, "user_id": 6619940, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3217497ee9ca268b4b87162679f46a67?s=128&d=identicon&r=PG&f=1", "display_name": "mYxCHa", "link": "https://stackoverflow.com/users/6619940/myxcha"}, "edited": false, "score": 0, "creation_date": 1470283470, "post_id": 38755842, "comment_id": 64888987, "body": "Is [Customer Number]  a text field in the database?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 15, "user_id": 6619940, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3217497ee9ca268b4b87162679f46a67?s=128&d=identicon&r=PG&f=1", "display_name": "mYxCHa", "link": "https://stackoverflow.com/users/6619940/myxcha"}, "edited": false, "score": 0, "creation_date": 1470283701, "post_id": 38755842, "comment_id": 64889051, "body": "I just updated my answer casting the [Customer Number]  into a number.  I believe that it will work now."}, {"owner": {"reputation": 15, "user_id": 6619940, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3217497ee9ca268b4b87162679f46a67?s=128&d=identicon&r=PG&f=1", "display_name": "mYxCHa", "link": "https://stackoverflow.com/users/6619940/myxcha"}, "edited": false, "score": 0, "creation_date": 1470347058, "post_id": 38755842, "comment_id": 64927182, "body": "I tried the revised version and it works with the <code>SELECT</code> and <code>WHERE</code> clauses, but as soon as I bring the <code>INSERT INTO</code> back into the SUB I get a <i>Operation is not allowed when the object is close</i> error."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1470283617, "last_edit_date": 1470283617, "creation_date": 1470271809, "answer_id": 38755842, "question_id": 38755217, "link": "https://stackoverflow.com/questions/38755217/dcount-type-mismatch-error-vba/38755842#38755842", "title": "DCount Type Mismatch Error VBA", "body": "<h2>This should resolve your problem</h2>\n\n<p>You can add a WHERE clause to your query that will skip the [Customer Number] that already exists in the [Investment Data] table.</p>\n\n<pre>\n\nssql = ssql & _\n \" WHERE [Customer Number] NOT IN(SELECT [Customer Number] FROM [Investment Data]);)\"\n\n</pre>\n\n<p>You can then use <code>Connection.Execute</code> to return the number of records added.</p>\n\n<pre>\n\nResults = cN.Execute(ssql)\n\nMsgBox Results & \" Records were added \" & (allRecordsCount - Results) & \"Records Were Skipped\"\n\n</pre>\n\n<hr>\n\n<p>If you want to alert the user before you insert the records you'll need two queries.</p>\n\n<pre><code>ssql = ssql &amp; \"SELECT [Customer Number] FROM [Excel 8.0;HDR=YES;DATABASE=\" &amp; dbWb &amp; \"].\" &amp; dsh &amp; _\n   ssql &amp; \" WHERE [Customer Number] IN(SELECT [Customer Number] FROM [Investment Data]);)\"\n\n\nSet rs = CreateObject(\"ADODB.Recordset\")\nSet rs = cN.Execute(ssql)\n\n\nIf Not rs.BOF AND  Not rs.EOF Then\n    msg = msg &amp; vbCrLf &amp; rs.Fields(\"Customer Number\").Value\n    rs.MoveNext\nEnd If\n\nIf msg &lt;&gt; \"\" Then\n\n    MsgBox \"These Records Are Duplicates\" &amp; vbCrLf &amp; msg\n    Exit Sub\nEnd If\n</code></pre>\n\n<h2>This should answer your question</h2>\n\n<p>You are getting the \"DCount Type Mismatch Error VBA\" because you are trying to query an external Access Database using the Excel WorksheetFunction DCount.</p>\n\n<h2>Test Queries</h2>\n\n<pre><code>Public Sub TestQueries()\n    Set cN = CreateObject(\"ADODB.Connection\")\n    Set rs = CreateObject(\"ADODB.Recordset\")\n    dbPath = Application.ActiveWorkbook.path &amp; \"\\PRID.mdb\"\n    'dbPath = \"C:\\Users\\best buy\\Downloads\\stackoverfow\\Sample Data File\\test.mdb\"\n    dbWb = Application.ActiveWorkbook.FullName\n    dbWs = Application.ActiveSheet.Name\n    scn = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; dbPath\n    dsh = \"[\" &amp; Application.ActiveSheet.Name &amp; \"$]\"\n    cN.Open scn\n\n    ssql = ssql &amp; \"SELECT [Customer Number] FROM [Excel 8.0;HDR=YES;DATABASE=\" &amp; dbWb &amp; \"].\" &amp; dsh\n\n    Set rs = cN.Execute(ssql)\n\n    Do While Not rs.BOF And Not rs.EOF\n        msg = msg &amp; vbCrLf &amp; rs.FIelds(0).Value\n        rs.MoveNext\n    Loop\n\n    MsgBox msg, vbInformation, \"Results Query Without Where Clause\"\n\n    ssql = ssql &amp; _\n \" WHERE [Customer Number] IN(SELECT CDbl([Customer Number]) FROM [Investment Data])\"\n\n    msg = \"\"\n\n    Set rs = cN.Execute(ssql)\n\n    Do While Not rs.BOF And Not rs.EOF\n        msg = msg &amp; vbCrLf &amp; rs.FIelds(0).Value\n        rs.MoveNext\n    Loop\n\n    MsgBox msg, vbInformation, \"Results Query With Where Clause\"\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6619940, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3217497ee9ca268b4b87162679f46a67?s=128&d=identicon&r=PG&f=1", "display_name": "mYxCHa", "link": "https://stackoverflow.com/users/6619940/myxcha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594655337, "creation_date": 1470266931, "last_edit_date": 1594655337, "question_id": 38755217, "link": "https://stackoverflow.com/questions/38755217/dcount-type-mismatch-error-vba", "title": "DCount Type Mismatch Error VBA", "body": "<p>I'm trying to use DCount to see if records exist in a table before inserting the data into the database but I keep getting a type mismatch error on \"Customer Number\" and have no idea why. The code is below: </p>\n\n<pre><code>Public Sub ExportData()\nSet cn = CreateObject(\"ADODB.Connection\")\ndbPath = Application.ActiveWorkbook.Path &amp; \"\\PRID.mdb\"\ndbWb = Application.ActiveWorkbook.FullName\ndbWs = Application.ActiveSheet.Name\nscn = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; dbPath\ndsh = \"[\" &amp; Application.ActiveSheet.Name &amp; \"$]\"\ncn.Open scn\n\nssql = \"INSERT INTO [Investment Data] ([Customer Number])\"\nssql = ssql &amp; \"SELECT  [Customer Number] FROM [Excel 8.0;HDR=YES;DATABASE=\" &amp; dbWb &amp; \"].\" &amp; dsh\n\nIf Application.WorksheetFunction.DCount(\"Customer Number\", \"Investment Data\", \"[Customer Number]=\" &amp; Range(\"A2\")) &gt; 0 Then\n    MsgBox (\"A similar entry has been detected within the PRID database, please make sure that this is a new entry before you continue.\")\nElse\n    MsgBox (\"Entry has been entered into the database.\")\n    cn.Execute ssql\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>Any help would be appreciated thanks.</p>\n"}, {"tags": ["excel", "vba", "ms-access", "userform", "named-ranges"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1470267267, "post_id": 38754949, "comment_id": 64884241, "body": "IIR (and I might be wrong because I never use bound controls), setting the <code>.RowSource</code> to a <code>String</code> in Excel requires that you have a matching named <code>Range</code>. Do you have a named <code>Range</code> called &quot;DataAccess&quot;?"}, {"owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470321668, "post_id": 38754949, "comment_id": 64912207, "body": "@Comintern, thank you for your reply. I&#39;m not sure what you mean by setting &#39;.RowSource to a String&#39; (sorry, I&#39;m kind of new to this), but I do have a named range called DataAccess with the formula above: OFFSET(Import!$A$1,1,,COUNTA(Import!$A$2:$A$10000),7)--there are 7 fields to the table we are transporting from Access to Excel)"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470337571, "post_id": 38754949, "comment_id": 64922338, "body": "Thanks for the screenshots and troubleshooting update - do you have one for your sample Import data - and maybe what the results of your DataAccess Offset range should look like in your mind? Is there a header line? How many rows/columns?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470337865, "post_id": 38754949, "comment_id": 64922521, "body": "When you say 7 fields - that corresponds to 7 columns in your listbox?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470344665, "post_id": 38754949, "comment_id": 64926134, "body": "Added alternative code based on what little I know of your SQL and columns. It DOES work for your offset function and a filled column A - columns 2-7 are empty but that&#39;s because your offset function supplies that data"}, {"owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470405695, "post_id": 38754949, "comment_id": 64952482, "body": "@dbmitch, I&#39;m sorry for the delay in replying. Yes, there are 7 columns. I&#39;ve been wondering about the listbox on my userform lately. I saw your note about OFFSET/Named range but it does show the named range but when I have data and when I open Name Mgr and put my cursor in the formula (I hope I&#39;m not misunderstanding what you said). I&#39;m going to add what has happened lately to my orig. post and add more code. Thank you for the code below and will comment on that below. THANK you for your help!"}, {"owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470407714, "post_id": 38754949, "comment_id": 64953788, "body": "@dbmitch, I&#39;ve added 2 updates called UPDATE 1 and UPDATE 2 to the original code."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470408834, "post_id": 38754949, "comment_id": 64954617, "body": "I still have no idea what your data looks like and what the offset cells look like. I assumed everything else was working before but if you&#39;re just now setting your list box column count =7 ... And I thought I was clear that it will not work setting Rowsource to your named range if it&#39;s based on the offset function. Replace that line with a call to my function. Also.. Why do you close your record set before you copy it? That code will not compile so it must not be actual code you&#39;re using. You have an endif after end sub"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470405902, "post_id": 38773338, "comment_id": 64952603, "body": "I&#39;m going to try this and I&#39;m going to add the code that the tutorial has for the listbox and other code that I think I should have told you about earlier b/c I think it does this, but I might be wrong. I&#39;m very sorry but I am new to VBA. I will add all to my original post. Thank you for your help!!"}, {"owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470407692, "post_id": 38773338, "comment_id": 64953779, "body": "I&#39;ve added 2 updates called UPDATE 1 and UPDATE 2 to the original code. I will try out this code too."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470409335, "post_id": 38773338, "comment_id": 64954984, "body": "I updated instructions but it sounds like your code has more issues. You should post images of your input data after copyrecordset, the offset data range, and the userform. Does your code compile? If so replace the displayed code with your actual code. It doesn&#39;t help us at all if you don&#39;t show us what you&#39;re actually working with."}, {"owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470412327, "post_id": 38773338, "comment_id": 64956799, "body": "I cannot add more images - the forum says I need more reputations. I already added the image for the userform and the named range dialog box showing that offset refers to cells A2 to A10000 and goes 7 columns over on the Import! sheet which is Sheet2!. I will add the full code for Sub ImportUserForm () and explain further about the data and OFFSET, etc. in the post."}, {"owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470413893, "post_id": 38773338, "comment_id": 64957758, "body": "I&#39;m getting a msg saying do I want to continue as a chat and my comment is not showing. Do you have a Google Docs account or Dropbox? Perhaps I can upload the file? I&#39;m going to try your solutions now."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470414100, "post_id": 38773338, "comment_id": 64957858, "body": "You don&#39;t need your named range display - you&#39;ve already shown us the value for that. But it would be useful to have all the ACTUAL code for <code>Sub ImportUserForm()</code>, the first few rows from A1:A10000, and understand why you keep saying <code>the Import! sheet which is Sheet2!.</code>"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470414142, "post_id": 38773338, "comment_id": 64957878, "body": "Yes - you can upload a file to either and send me the download link"}, {"owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470507856, "post_id": 38773338, "comment_id": 64983141, "body": "Thank you! Above are 2 links to download the files--Excel and Access db with table, from Google Docs. See PLEASE NOTE above b/c it semi works but I would like to use the OFFSET function in the name mgr rather than the fix I use now of using an absolute range, but if it can&#39;t be done then it is fine. I just want to be able to import the data to the listbox, which semi works now, so that I can go on to see if the Append and Delete buttons work. Thank you so much for your help, I really appreciate it."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470509122, "post_id": 38773338, "comment_id": 64983499, "body": "You sent a link to Google Sheet - not an Excel spreadsheet. Not much use to me. At least your updated code is making more sense than it did before. I&#39;ll see if I can work with that. You should be sharing via Google Drive not Google Docs. PLEASE DO NOT START CHANGING TO ABSOLUTE RANGE UNLESS THAT IS WHAT YOU WANT IN THE END. I am not going to be chasing the solution because of ever changing code."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470512992, "post_id": 38773338, "comment_id": 64984541, "body": "Tested and Works fine using my suggested code on your data"}, {"owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470673090, "post_id": 38773338, "comment_id": 65033374, "body": "just making a quick note that something has come up at work and it might be until tomorrow when I can work on this. I will upload to Google Drive tonight and update w/ links, if that is okay b/c you saying that it works when you try your suggested code is still going to be a puzzle for me. I ran into the error I mention above when I tried it. I will also put OFFSET back in. If you don&#39;t want to do this anymore, I understand. I would appreciate your help b/c I would like to see how your code works since I had trouble. Again, I s/b able to check back tomorrow. Thank you."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470683500, "post_id": 38773338, "comment_id": 65039113, "body": "Did you try and copy/paste my code WITHOUT edits? If you&#39;re making edits you need to repost your code and say WHY you made the change(s). Don&#39;t upload anyything - just show your code in the question"}, {"owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470696439, "post_id": 38773338, "comment_id": 65044887, "body": "@dbmitcch, I just saw your update to my original post. I did not see it before. Before I upload to Google Drive, if needed, I will try your solution tomorrow. I think I must have misunderstood what you said when you initially posted your code. I will try tomorrow after the work project is finished and let you know. Thank you very much."}, {"owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470769079, "post_id": 38773338, "comment_id": 65080964, "body": "I used your code and it works. It worked the first import but then I have to close the userform and then open it again for the data to show up in the listbox properly b/c it omits the email. You can see in your screenshot what I mean. I&#39;m marking this as the answer b/c you have answered the problem of getting the data to the list box. I will definitely give you many ups in your reputation, if possible. If I can do anything else to help you as far as votes, please let me know. I&#39;m considering this closed. Thank you, again, for your help very much."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "edited": false, "score": 0, "creation_date": 1470771622, "post_id": 38773338, "comment_id": 65082364, "body": "Glad you got it going finally. Userforms are in their own separate world of VBA. Not much interaction with outside modules. Enjoy the coding experience ahead of you"}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 4, "last_activity_date": 1470512951, "last_edit_date": 1470512951, "creation_date": 1470329962, "answer_id": 38773338, "question_id": 38754949, "link": "https://stackoverflow.com/questions/38754949/error-380-could-not-set-the-rowsource-property-invalid-property-value-for-ex/38773338#38773338", "title": "&#39;Error 380: Could not set the RowSource property. Invalid Property value&#39; for Excel user form to import data from Access to Excel", "body": "<p>We've been beating our heads for an answer that was hidden behind all the details. It is your range definition that is the problem. </p>\n\n<p>Even though you're using a Named Range - you can see the issue immediately if you look at the values in the Name Manager. They're not defined.</p>\n\n<p>Similarly if you run the named range thru using VBA, you can immediately see the problem. VBA does not see the Offset function as returning a range - it returns a reference to a range - and the format is actually a Variant array.</p>\n\n<p>In a test function you can see what your range holds by adding a watch to <code>[DataAccess]</code>. It is a two dimensional Variant array.</p>\n\n<p>So the simple answer is:   </p>\n\n<p><strong>You CANNOT DIRECTLY set the RowSource to a Named Range that is using the Offset function</strong></p>\n\n<p>There may be ways to convert the variant array to a real range, but you cannot treat this type of Range Name as a true range.</p>\n\n<p>Just try using <code>Debug.Print Range(\"DataAccess\").Cells.Address</code> or adding a watch to <code>Range(\"DataAccess\")</code> and it will give you an error unlike other basic range names that refer to cells.</p>\n\n<p>You can access this type of range's values is by wrapping the range name in square brackets eg. <code>[DataAccess]</code></p>\n\n<blockquote>\n  <p><strong>EDIT - You can fill the ListBox using the OFFSET range by using the AddItem method on the resulting array.</strong></p>\n</blockquote>\n\n<p>I still believe there's a problem with your OFFSET formula, because from my tests you only end up with 1 filled column in the array.</p>\n\n<p>However - without confirming your listbox properties, seeing a screenshot of your data, viewing actual recordset fields, or your code that fills the spreadsheet (instead of \"etc.etc.etc\"), it's hard to test or even guess.</p>\n\n<p><strong>But this code will fill your ListBox based on a Range names that use an OFFSET function:</strong></p>\n\n<p>Replace the line that sets <code>.Rowsource = DataAccess</code> with <code>FillListBoxFromOffsetRange</code></p>\n\n<p>Add this code to your UserForm module</p>\n\n<pre><code>Private Sub FillListBoxFromOffsetRange()\n\n    Dim arrData     As Variant\n\n    Dim intRow      As Integer\n    Dim intCol      As Integer\n    Dim strRowData  As String\n\n    With ListBox1\n        .Clear              'Make sure the Listbox is empty\n        .ColumnCount = 7    'Set number of columns\n\n        ' In order to access Workbook ranges need to use Application Object\n        arrData = Application.Range(\"DataAccess\")\n\n        For intRow = LBound(arrData, 1) To UBound(arrData, 1)\n\n            ' Process first column of new row\n            intCol = 1\n            strRowData = arrData(intRow, intCol)\n            .AddItem strRowData ' Add the first Column of the row\n\n            ' Append remaining columns to end of row\n            For intCol = LBound(arrData, 2) + 1 To UBound(arrData, 2)\n                strRowData = arrData(intRow, intCol)\n                ' List rows have zero-based index\n                .List(intRow - 1, intCol) = strRowData\n            Next intCol\n\n        Next intRow\n    End With\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p><strong>No Problem - Works as it should - your data - your simulated userform</strong></p>\n</blockquote>\n\n<p><strong>All I changed was using my above function exactly as I suggested and commented out your code</strong>   </p>\n\n<pre><code>FillListBoxFromOffsetRange\n\n'Me.lstDataAccess.RowSource = DataAccess\n'Me.lstDataAccess.ColumnCount =\n'Sheets(\"Import\").Range(\"DataAccess\").Columns.Count\n</code></pre>\n\n<p><strong>And changed the <code>With ListBox1</code> to match actual Listbox name <code>With lstDataAccess</code></strong></p>\n\n<blockquote>\n  <p><strong>Results in:</strong></p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/VllEl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VllEl.jpg\" alt=\"Actual Results\"></a></p>\n"}], "owner": {"reputation": 79, "user_id": 6651483, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3f7a1fdd60dc4f3ffc7c9b82c1745a0c?s=128&d=identicon&r=PG&f=1", "display_name": "sturdy267", "link": "https://stackoverflow.com/users/6651483/sturdy267"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3701, "favorite_count": 0, "accepted_answer_id": 38773338, "answer_count": 1, "score": 2, "last_activity_date": 1594150396, "creation_date": 1470265044, "last_edit_date": 1594150396, "question_id": 38754949, "link": "https://stackoverflow.com/questions/38754949/error-380-could-not-set-the-rowsource-property-invalid-property-value-for-ex", "title": "&#39;Error 380: Could not set the RowSource property. Invalid Property value&#39; for Excel user form to import data from Access to Excel", "body": "<p>I am using Excel 2013 in Windows 7. </p>\n\n<p>I\u2019ve created a userform in Excel, using VBA in Excel to import data from Access into Excel after clicking a button per onlinepclearning(dot)com/append-and-delete-ms-access-record-sets-from-an-excel-userform/. This site is where he amends his Import subroutine. </p>\n\n<p>After hitting the Import button, data from Access should appear in a listbox on the userform. Data is not to be imported directly into the userform but imported onto the worksheet and referenced as a named range in the worksheet (called DataAccess with a named range formula of: OFFSET(Import!$A$1,1,,COUNTA(Import!$A$2:$A$10000),7)--there are 7 fields to the table we are transporting from Access to Excel) in the user form.</p>\n\n<p><a href=\"http://i.stack.imgur.com/04lyH.png\" rel=\"nofollow\">Name Manager</a></p>\n\n<p>A screenshot of the userform in Excel:</p>\n\n<p><a href=\"http://i.stack.imgur.com/DVxKs.png\" rel=\"nofollow\">Excel Userform</a></p>\n\n<p>When I click the Import button on the userform I get 'Error 380: Could not set the RowSource property. Invalid Property value'. Is it having a problem with the named range or the list box? I\u2019ve looked through so many tuts and no answer.</p>\n\n<p>I've also tried changing: </p>\n\n<ol>\n<li>Me to UserForm1 and receive Error 424 (Object required) in procedure Import_Data.</li>\n<li>Me.listData...=\"Sheet2!DataAccess\" and I received the original Error 380 but the data imported onto the Excel Sheet2 just not the listbox on the Excel userform.</li>\n<li>Me.listData...=Sheet2!DataAccess without quotes and I received Error 438 (Object doesn't support this property or method) in procedure Import_Data but the data imported onto the Excel Sheet2 just not the listbox on the Excel userform.</li>\n<li>Me.listData...Import!DataAccess and I received Compile error: Expected Function or variable. The data did not come over to Sheet2 of Excel.</li>\n<li>Me.listData...Sheet2.Range(\"DataAccess\") but received Error 1004 (Method 'Range' object '_Worksheet' failed) in procedure Import_Data but the data imported onto the Excel Sheet2 just not the listbox on the Excel userform.</li>\n</ol>\n\n<p><strong>(1) UPDATE 1 8/5/2016</strong> - I've removed the quotes from around DataAccess without referring to Sheet2! so that the one line of code in the Sub ImportUserForm() reads</p>\n\n<pre><code>Me.lstDataAccess.RowSource = DataAccess\n</code></pre>\n\n<p>and I will now get no error msg but a msgbox saying that the data has been imported; however, the data appears only on the spreadsheet (Sheet2! aka Import!) that the OFFSET/Named Range refers to and not my listbox. </p>\n\n<p>Other tutorials say to set column width (which I set to 40 pt;40pt, etc...7 times total) and column count (which I set to 7)</p>\n\n<p>Still no data appears in listbox on userform in Excel.</p>\n\n<p>Here is the code for the listbox which is called lstDataAccess along with the code to initialize the userform. I don't know why they made this a double click (not sure what this means) b/c all he does on the tutorial is hit the import button and all of the data from the Access table will import to the Excel userform.</p>\n\n<p>(Arec1-7 is the name of the text boxes on the userform, which correspond to the field names in Access--Surname, FirstName, Address, etc.)<br>\n(lstDataAccess is the name of the listbox on the userform.)</p>\n\n<pre><code>Private Sub lstDataAccess_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n'dim the variables\nDim i As Integer\n\n'find the selected list item\ni = Me.lstDataAccess.ListIndex\nMe.lstDataAccess.Selected(i) = True\n\n'add the values to the text boxes\nMe.Arec1.Value = Me.lstDataAccess.Column(0, i)\nMe.Arec2.Value = Me.lstDataAccess.Column(1, i)\nMe.Arec3.Value = Me.lstDataAccess.Column(2, i)\nMe.Arec4.Value = Me.lstDataAccess.Column(3, i)\nMe.Arec5.Value = Me.lstDataAccess.Column(4, i)\nMe.Arec6.Value = Me.lstDataAccess.Column(5, i)\nMe.Arec7.Value = Me.lstDataAccess.Column(6, i)\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub UserForm_Initialize()\n'does not get assigned to any button\nMe.Arec1 = Sheet1.Range(\"J3\").Value\nEnd Sub\n</code></pre>\n\n<p>(Again, all of this code is in the userform and not the module for the spreadsheet portion of the tutorial.)</p>\n\n<p><strong>(1) END OF UPDATE 1 8/5/2016</strong> - (I'm going to try the Private Sub Import_Click() in the answer below, but there is no other code that I see would be applicable to the import part of this project. The rest is to close, open the userform and then append and delete the data but I need to import the data to the listbox first before I can tackle append/delete.)</p>\n\n<p><strong>(2) UPDATE 8/5/2016</strong> - I've replaced the code for Sub ImportUserForm () with the entire code for clarity. </p>\n\n<p>I can only add two links b/c I need 10 reputations per the forum rules, but I've already added the named range's scope and a shot of the user form. The data is imported from the Access table into Sheet2! of the spreadsheet per the OFFSET formula in the named range adding it to A2 and going over 7 columns all the why down to A10000 if ever needed. It currently looks like this:</p>\n\n<p>Cell A1:ID | Cell B2:Surname  |  Cell C3:FirstName  |  Cell D4:Address  |  Cell E5:Phone  |  Cell F6:Mobile  |  Cell G7:Email</p>\n\n<p>It's wrapping but the headers go across the 7 columns in Excel with data starting in Row 2 (A2 to G2) all the down to Row 7 b/c I only have 7 rows of data in Access.</p>\n\n<p><strong>(3) UPDATE 8/6/2016</strong> Below is a link to download the file from Google Docs. See PLEASE NOTE below b/c it semi works but I would like to use the OFFSET function in the name mgr rather than the fix I use now of using an absolute range.</p>\n\n<p>-Excel wkbk and userform - (I'm not allowed to include more links so see below) https(colon)//docs(dot)google(dot)com/spreadsheets/d/1tRF3bJf4ng-bM6Kiefptpbrw9jr4T_BGZ0gKm9S9614/edit?usp=sharing\n(Just click on the button on the Export wksht, Click for Userform, to activate userform. I don't need help with any of the other buttons on either worksheet, incl. the Import button on the Import wksht.)</p>\n\n<p>-Access DB with PhoneList table - https(colon)//drive(dot)google(dot)com/file/d/0B9IyKJSJ52ghNEFfYVNWUE1wcEU/view?usp=sharing</p>\n\n<p>HOW IT WORKS: The reason I want to import is b/c I need to see if the append/delete buttons will work on the userform. You are supposed to be able to import data from the Access table PhoneList into the listbox on the Excel userform, which it actually imports into the Import wksht and gets reflected into the listbox via the named range DataAccess. You should then be able to select a line of imported data from the listbox where it will appear in the text boxes above so you can change the data if needed and then append the table in Access or you can just delete the line of data via the Append or Delete buttons.</p>\n\n<p><strong>PLEASE NOTE:</strong> The Import on the userform now imports data to the listbox on the userform but only after I close and open the userform. I am supposed to be able to click the Import button, even with nothing in the search box next to it, and import all of the data from the Access database. You have to delete the data from the Import worksheet to clear the data on the userform and start over.</p>\n\n<ol>\n<li><p>I went to the properties of the listbox of the userform and changed:<br>\nthe column count to 7<br>\nthe column width to 40 pt<br>\nthe multiselect to 1-fmmultiselectmulti<br>\nthe RowSource to Import!DataAccess (I believe this was a big key)  </p></li>\n<li><p>for the above to work I had to change the DataAccess named range and make it an absolute range and remove the OFFSET function. (Named ranges with OFFSET don't appear in the range selector box, by the way, so now it appears in the range selector). The Named Range in the name mgr called KEEP is the old named range that was DataAccess using the OFFSET function. I would like to use this, if I can.</p></li>\n<li><p>I tried using the Private Sub FillListBoxFromOffsetRange () but received an error with</p>\n\n<p>arr.Data=Application.Range(\"DataAccess\") </p></li>\n</ol>\n\n<p>highlighted yellow when try to debug the code. I also tried calling it from my ImportUserForm code but it didn't work (maybe I was doing it wrong), but the internet says you need to call to a Private Sub from a 2nd module. I gave up trying that and started working on step 1. above and have semi-success, but still need help.</p>\n\n<p><strong>END OF UPDATE 8/6/2016</strong></p>\n\n<p>(below is continuation of original post)</p>\n\n<p>P.S. I didn\u2019t double click the Import button on my form before adding the new code to the userform, but I didn\u2019t do that w/ another button and it works on the userform. Also, I added the code to the userform and not the module (which is what we used to import and export btw Access and Excel via some buttons on an Excel worksheet). </p>\n\n<p>I\u2019m new to VBA and userforms. Here is his correction per the website along with excerpted code:</p>\n\n<p>Thank you in advance</p>\n\n<p><strong>(1) UPDATE 2 8/5/2016</strong> - I added the entire code for Sub ImportUserForm () below.</p>\n\n<pre><code>'Import button click event\nPrivate Sub cmdImport_Click()\nImportUserForm\n'Inform the user that the macro was executed successfully.\nMsgBox \"Congratulation the data has been successfully Imported\",  \nvbInformation, \"Import successful\"\nEnd Sub\n_____\n\nSub ImportUserForm()\n'we are not importing the data directly into user form but importing onto     \n'the worksheet and referencing _\n'it as a named range in the user form\n'he made a slight change to the code per his Append and Delete webpage b/c     \n'once we delete and append data we want to import back into _\n'list box again to show new values have been removed or appended\n'Declaring the necessary variables.\nDim cnn As ADODB.Connection 'dim the ADO collection class\nDim rs As ADODB.Recordset 'dim the ADO recordset class\nDim dbPath As String\nDim SQL As String\nDim i As Integer\nDim var\n'add error handling\nOn Error GoTo errHandler:\n'Disable screen flickering.\nApplication.ScreenUpdating = False\n'clear the values from the worksheet\nSheet2.Range(\"A2:G10000\").ClearContents\n'get the path to the database\ndbPath = Sheet1.Range(\"I3\").Value\n'set the search variable\nvar = Me.txtSearch\nSet cnn = New ADODB.Connection ' Initialise the collection class variable\n\n'Connection class is equipped with a \u2014method\u2014 named Open\n'\u2014-4 aguments\u2014- ConnectionString, UserID, Password, Options\n'ConnectionString formula\u2014-Key1=Value1;Key2=Value2;Key_n=Value_n;\ncnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; dbPath\n\n'Create the SQL statement to retrieve the data from table.\nIf CheckBox1 = True Then\nSQL = \"SELECT * FROM PhoneList WHERE SURNAME = '\" &amp; var &amp; \"'\"\nElse\nSQL = \"SELECT * FROM PhoneList WHERE SURNAME LIKE '\" &amp; var &amp; \"%\" &amp; \"'\"\nEnd If\n\n'Create the ADODB recordset object.\nSet rs = New ADODB.Recordset 'assign memory to the recordset\n\n'ConnectionString Open '\u2014-5 aguments\u2014-\n'Source, ActiveConnection, CursorType, LockType, Options\nrs.Open SQL, cnn\n\n'Check if the recordset is empty. 'EOF is end of file\nIf rs.EOF And rs.BOF Then\n'Close the recordet and the connection.\nrs.Close\ncnn.Close\n'clear memory\nSet rs = Nothing\nSet cnn = Nothing\n'Enable the screen.\nApplication.ScreenUpdating = True\n'In case of an empty recordset display an error.\n'DataAccess is a named range in the worksheet _\n'OFFSET(Import!$A$1,1,,COUNTA(Import!$A$2:$A$10000),7)\nMsgBox \"There are no records in the recordset!\", vbCritical, \"No Records\"\nMe.lstDataAccess.RowSource = \"\"\nExit Sub\nEnd If\n\n'Write the reocrdset values in the sheet.\nSheet2.Range(\"A2\").CopyFromRecordset rs\n\n'Close the recordset and the connection.\nrs.Close\ncnn.Close\n'clear memory\nSet rs = Nothing\nSet cnn = Nothing\n\n'Enable the screen.\nApplication.ScreenUpdating = True\n\nMe.lstDataAccess.RowSource = DataAccess\n'Me.lstDataAccess.ColumnCount =     \nSheets(\"Import\").Range(\"DataAccess\").Columns.Count\n\n'error handler\nOn Error GoTo 0\nExit Sub\nerrHandler:\n'clear memory\nSet rs = Nothing\nSet cnn = Nothing\nMsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure     \nImport_Data\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 1, "creation_date": 1470264182, "post_id": 38754633, "comment_id": 64883372, "body": "What is the problem? I am not sure &quot;\\t&quot; works in vba, I would use vbtab constant."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470264290, "post_id": 38754633, "comment_id": 64883413, "body": "What are you showing us - do you have code that doesn&#39;t work the way you want it - what does it spit out now - and how should that change? Example data helps - are these two separate functions taht get called from somewhere else?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1470265283, "post_id": 38754633, "comment_id": 64883730, "body": "<code>Sheet1.Cells(iRow, iCol + 2).Value = LineItems(13, 2)</code> is going to be a Subscript out of range error - <code>Split</code> returns a one dimensional array."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1470265455, "post_id": 38754633, "comment_id": 64883777, "body": "@Comintern - and also because iRow will be zero (iCol is also zero, but iCol + 2 will evaluate to a valid column number)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470265537, "post_id": 38754633, "comment_id": 64883804, "body": "@YowE3K - LOL! Missed that one. Your subscript error will throw before mine too."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470265556, "post_id": 38754633, "comment_id": 64883809, "body": "The line saying <code>splitFile = Split(sFile, &quot;.txt&quot;)</code> is weird - if someone creates a filename of &quot;abcd.txtfile.txt.xls&quot;, you will end up with &quot;abcd&quot; in column A, &quot;file&quot; in column B, and &quot;.xls&quot; in column C"}, {"owner": {"reputation": 47, "user_id": 6378333, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/3d395eeba265e32eb6294bebf169ac93?s=128&d=identicon&r=PG&f=1", "display_name": "Sharath", "link": "https://stackoverflow.com/users/6378333/sharath"}, "edited": false, "score": 0, "creation_date": 1470313429, "post_id": 38754633, "comment_id": 64905585, "body": "I need to pull only one data from each of the txt files. The first part of the script works, as I am pulling out file names, which is what I want to do. The second part is try to pull &quot;EngagementId&quot; from the 2nd row, from each of these text files, which I am unable to do."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 6378333, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/3d395eeba265e32eb6294bebf169ac93?s=128&d=identicon&r=PG&f=1", "display_name": "Sharath", "link": "https://stackoverflow.com/users/6378333/sharath"}, "edited": false, "score": 0, "creation_date": 1470313590, "post_id": 38755513, "comment_id": 64905708, "body": "Thanks Thomas. But I don&#39;t think this answers my question. I am a beginner in VBA coding. All I am trying to do is go thru multiple text files, in a folder and pull out the name of the file and one record , &quot;EngagementId&quot; from row 2 or any row, since all the values for EngagmentId for one text file is going to be the same. I have about 13 columns in my text file."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1470268986, "creation_date": 1470268986, "answer_id": 38755513, "question_id": 38754633, "link": "https://stackoverflow.com/questions/38754633/read-only-one-record-from-multiple-text-files-into-excel-using-vba/38755513#38755513", "title": "Read only one record from Multiple text files into Excel using VBA", "body": "<p>Using an ADODB.Recordset to query would be more versatile.</p>\n\n<hr>\n\n<pre><code>Sub Example()\n    On Error Resume Next\n    Dim rs As Object, f As Object, conn  As Object\n    Dim FolderPath As String, FileName As String, FilterString As String\n    FolderPath = \"C:\\Users\\best buy\\Downloads\\stackoverfow\\Sample Data File\\\"\n    FileName = \"example.csv\"\n    FilterString = \"WHERE EngagementId = 20\"\n\n    Set rs = getDataset(FolderPath, FileName, FilterString)\n\n    Do While Not rs.BOF And Not rs.EOF\n        Debug.Print rs.Fields(\"EngagementId\")\n        Debug.Print rs.Fields(\"Company\")\n        Debug.Print rs.Fields(\"City\")\n        Debug.Print rs.Fields(\"State\")\n\n        rs.MoveNext\n    Loop\n\n    Set conn = rs.ActiveConnection\n    rs.Close\n    conn.Close\n    Set rs = Nothing\n    Set conn = Nothing\nEnd Sub\n\nFunction getDataset(FolderPath As String, FileName As String, FilterString As String) As Object\n    Dim conn As Object, rs As Object\n    Set conn = CreateObject(\"ADODB.Connection\")\n    Set rs = CreateObject(\"ADODB.Recordset\")\n    conn.Open (\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; FolderPath &amp; \";\" &amp; _\n             \"Extended Properties=\"\"text; HDR=Yes; FMT=Delimited; IMEX=1;\"\"\")\n    rs.ActiveConnection = conn\n    rs.Source = \"SELECT * FROM \" &amp; FileName &amp; \" \" &amp; FilterString\n    rs.Open\n    Set getDataset = rs\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 6378333, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/3d395eeba265e32eb6294bebf169ac93?s=128&d=identicon&r=PG&f=1", "display_name": "Sharath", "link": "https://stackoverflow.com/users/6378333/sharath"}, "edited": false, "score": 0, "creation_date": 1470317897, "post_id": 38768244, "comment_id": 64909014, "body": "Thanks a lot Vincent. It works, but is there any way to quicken up the process? It hangs every time I try to run the script."}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1470316072, "creation_date": 1470316072, "answer_id": 38768244, "question_id": 38754633, "link": "https://stackoverflow.com/questions/38754633/read-only-one-record-from-multiple-text-files-into-excel-using-vba/38768244#38768244", "title": "Read only one record from Multiple text files into Excel using VBA", "body": "<p>Since you only need the second line of each file, you don't need to loop, just read and discard the fist line, then read and split the second one:</p>\n\n<pre><code>    Open (MyFolder &amp; MyFile) For Input As #1 'MyFolder &amp; MyFile won't be the correct name (probably should be MyFolder &amp; \"\\Individual Reports\\\" &amp; MyFile)\n    Line Input #1, LineFromFile 'line to discard\n    Line Input #1, LineFromFile 'line to use\n    LineItems = Split(LineFromFile, vbTab)\n    Sheet1.Cells(someplace).Value = LineItems(13) ' replace some place with the correct value that we don't know\n    Close #1\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6378333, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/3d395eeba265e32eb6294bebf169ac93?s=128&d=identicon&r=PG&f=1", "display_name": "Sharath", "link": "https://stackoverflow.com/users/6378333/sharath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 38768244, "answer_count": 2, "score": 0, "last_activity_date": 1470316072, "creation_date": 1470263001, "last_edit_date": 1470314652, "question_id": 38754633, "link": "https://stackoverflow.com/questions/38754633/read-only-one-record-from-multiple-text-files-into-excel-using-vba", "title": "Read only one record from Multiple text files into Excel using VBA", "body": "<p>I have multiple txt files in a folder, which are tab delimited. Each of these files have a column called EngagementId, which is the same value, irrespective of number of records. However, it changes for every txt file, which is what I want to capture.</p>\n\n<ol>\n<li>I am trying to get the file name in the first row. The GetFileNames() works for that (as pointed out in the comments) </li>\n</ol>\n\n<hr>\n\n<pre><code>Sub GetFileNames()\n    Dim sPath As String\n    Dim sFile As String\n    Dim iRow As Integer\n    Dim iCol As Integer\n    Dim splitFile As Variant\n\n    'specify directory to use - must end in \"\\\"\n    sPath = ActiveWorkbook.Path\n    iRow = 0\n    sFile = Dir(sPath &amp; \"\\Individual Reports\\\")\n    Do While sFile &lt;&gt; \"\"\n        iRow = iRow + 1\n        splitFile = Split(sFile, \".txt\")\n        For iCol = 0 To UBound(splitFile)\n            Sheet1.Cells(iRow, iCol + 1) = splitFile(iCol)\n        Next iCol\n        sFile = Dir     ' Get next filename\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Each of these txt files have one column (which is in the 13th position in each of the text files), called \"EngagementId\". I want to pull only the first \"Engagement Id\", which is from the 2nd row(since the first row contains headers).</p>\n\n<pre><code>Sub Extractrec()\n    Dim filename As String, nextrow As Long, MyFolder As String\n    Dim MyFile As String, text As String, textline As String\n\n    MyFolder = ActiveWorkbook.Path\n    MyFile = Dir(MyFolder &amp; \"\\Individual Reports\\*.txt\")\n\n    Do While MyFile &lt;&gt; \"\"\n        Open (MyFolder &amp; MyFile) For Input As #1\n        Do Until EOF(1)\n            Line Input #1, LineFromFile\n            LineItems = Split(LineFromFile, \"\\t\") 'second loop text is already stored \n                                                  '-&gt; see reset text\n            Sheet1.Cells(iRow, iCol + 2).Value = LineItems(13, 2)\n        Loop\n        Close #1\n\n    Loop\n</code></pre>\n"}, {"tags": ["database", "ms-access", "vba", "filenames", "filepath"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470263603, "post_id": 38754306, "comment_id": 64883191, "body": "Thsi is basic ms-access database work - look up examples for adding new records and try something out. This is not relevant code you&#39;e sharing"}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 6658527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697851e215cde76bb56f4cb4bf12899d?s=128&d=identicon&r=PG&f=1", "display_name": "John W Fowler", "link": "https://stackoverflow.com/users/6658527/john-w-fowler"}, "is_accepted": false, "score": 0, "last_activity_date": 1470265337, "last_edit_date": 1470265337, "creation_date": 1470262828, "answer_id": 38754605, "question_id": 38754306, "link": "https://stackoverflow.com/questions/38754306/ms-access-save-filename-and-filepath-to-fields-in-a-table/38754605#38754605", "title": "MS Access - Save Filename and Filepath to Fields in a Table", "body": "<p>Here's a tweaked snippet.  Add the items to the recordset of a related table to store the full file name/path with the foreign key.  I move all mine using the <code>Save AS</code> to a folder.</p>\n\n<pre><code>dim obj as object\ndim rsimg as dao.recordset\nSet obj = CreateObject(\"WScript.shell\")\nSet rsimg = CurrentDb.OpenRecordset(\"tbltostorefilenameswforeignkey\", dbOpenDynaset)\nSet fdialog = Application.FileDialog(msoFileDialogFilePicker)\nWith fdialog\n    .AllowMultiSelect = True\n    .Title = \"Select Images To Add - Multiples OK\"\n    .InitialFileName = obj.specialfolders(\"desktop\")\n    .InitialView = msoFileDialogViewLargeIcons\n    .Filters.Clear\n    .Filters.Add \"Images\", \"*.jpg,*.gif,*.png\"\n    If .Show = True Then\n        For Each varfile In .SelectedItems\n        Name varfile As Currentproject.path &amp; \"\\yourfilefoldername\" &amp; \"\\\" &amp;  Right(varfile, Len(varfile) - InStrRev(varfile, \"\\\"))\n       rsimg.AddNew\n       rsimg(\"ItemId\") = Me.ID\n       rsimg(\"filepath\") = Currentproject.path &amp; \"\\yourfilefoldername\" &amp; \"\\\" &amp; Right(varfile, Len(varfile) - InStrRev(varfile, \"\\\"))\n       rsimg.Update\n       Next varfile\n   End If\nEnd With\n</code></pre>\n\n<p>If you are only using one file for each record and want to save them in the table then set <code>.allowmultiselect = false</code>, remove the <code>for each next</code> loop, and in place of <code>varfile</code> just use <code>.selecteditems.item(1)</code></p>\n\n<p>As you got it,</p>\n\n<pre><code>dim itm as string\nitm = f.selecteditems.item(1)\nme.imagefilename = dir(itm)\n</code></pre>\n\n<p>and the same for the folder path</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7206344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ada1c562706c9e25813646e9d4c195be?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando Quiles", "link": "https://stackoverflow.com/users/7206344/fernando-quiles"}, "is_accepted": false, "score": 0, "last_activity_date": 1480007742, "last_edit_date": 1480007742, "creation_date": 1480006105, "answer_id": 40791427, "question_id": 38754306, "link": "https://stackoverflow.com/questions/38754306/ms-access-save-filename-and-filepath-to-fields-in-a-table/40791427#40791427", "title": "MS Access - Save Filename and Filepath to Fields in a Table", "body": "<p>I used your code and after the msgBox line I added (Me.\"<code>FieldName</code> you want to save the path to\". <code>value = strFolder &amp; strFile</code>), it saved the whole path to my field after it showed the info on the <code>msgBox</code></p>\n"}], "owner": {"reputation": 1, "user_id": 6674380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04d1ebece76fb64223cac62ac4ce5431?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6674380/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4123, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1480007742, "creation_date": 1470261441, "last_edit_date": 1470271972, "question_id": 38754306, "link": "https://stackoverflow.com/questions/38754306/ms-access-save-filename-and-filepath-to-fields-in-a-table", "title": "MS Access - Save Filename and Filepath to Fields in a Table", "body": "<p>I am trying to save a selected file name and file path into fields in table. I am using a form and inserting a button and applying some code I found online to get the filename and path into a msgbox.</p>\n\n<pre><code>Private Sub Command0_Click()\n\n    Dim f As Object\n    Dim strFile As String\n    Dim strFolder As String\n    Dim varItem As Variant\n\n    Set f = Application.FileDialog(3)\n    f.AllowMultiSelect = True\n    If f.Show Then\n        For Each varItem In f.SelectedItems\n            strFile = Dir(varItem)\n            strFolder = Left(varItem, Len(varItem) - Len(strFile))\n            MsgBox \"Folder: \" &amp; strFolder &amp; vbCrLf &amp; _\n                \"File: \" &amp; strFile\n        Next\n    End If\n    Set f = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Could anybody please help me and explain how I now get the resulting data from the the message box into the fields in my table (The field destinations are called \"<code>ImageFilePath</code>\" &amp; \"<code>ImageFileName</code>\").</p>\n\n<p>Thanks Guys</p>\n"}, {"tags": ["excel", "vba", "scroll", "row"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1470261993, "post_id": 38754232, "comment_id": 64882686, "body": "Try adding <code>DoEvents</code> after the Goto"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1470280652, "creation_date": 1470280652, "answer_id": 38757938, "question_id": 38754232, "link": "https://stackoverflow.com/questions/38754232/scroll-the-page-to-show-the-active-row/38757938#38757938", "title": "Scroll the page to show the active row", "body": "<p>Are you trying to goto Row 400?</p>\n\n<pre><code>Application.Goto  Rows(400)\n</code></pre>\n\n<p>If you want to pause execution you can use <code>Stop</code> or <code>Debug.Assert False</code></p>\n\n<pre>\n\nFor i = 0 to to lastRow\n\n    If i = 400 then \n        Application.Goto Rows(400)\n        Stop\n    End IF\n\nNext\n\n</pre>\n\n<p>If you want pause the macro is a condition is true then use <code>Debug.Assert False</code>.  Note: Debug.Assert pauses the code when the condition is false.</p>\n\n<pre>\n\nFor i = 0 to to lastRow\n\n    Debug.Assert i &lt;&gt 400 \n\nNext\n\n</pre>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 1, "last_activity_date": 1470371268, "last_edit_date": 1470371268, "creation_date": 1470285833, "answer_id": 38758623, "question_id": 38754232, "link": "https://stackoverflow.com/questions/38754232/scroll-the-page-to-show-the-active-row/38758623#38758623", "title": "Scroll the page to show the active row", "body": "<p>Try with below it will auto move to the active cell</p>\n\n<pre><code>Sub test()\n    Dim i as Long    \n    For i = 1 To 1000\n        Range(\"A\" &amp; i).Select\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 535, "user_id": 9291731, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zcRa1.jpg?s=128&g=1", "display_name": "Rtronic", "link": "https://stackoverflow.com/users/9291731/rtronic"}, "is_accepted": false, "score": 0, "last_activity_date": 1543411229, "last_edit_date": 1543411229, "creation_date": 1543410852, "answer_id": 53520312, "question_id": 38754232, "link": "https://stackoverflow.com/questions/38754232/scroll-the-page-to-show-the-active-row/53520312#53520312", "title": "Scroll the page to show the active row", "body": "<p>You can control it like that:  </p>\n\n<pre><code>Private Sub seid_Change() \n    If seid.Value = 1 Then \n        wsM.Range (\"A125\").Select \n        Application.Goto ActiveCell.EntireRow, True \n    ElseIf seid.Value = 2 Then \n        wsM.Range (\"A128\").Select\n        Application.Goto &lt;br&gt;ActiveCell.EntireRow, True \n    End If \nEnd sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 980, "favorite_count": 2, "accepted_answer_id": 38758623, "answer_count": 3, "score": 0, "last_activity_date": 1555401565, "creation_date": 1470261079, "last_edit_date": 1555401565, "question_id": 38754232, "link": "https://stackoverflow.com/questions/38754232/scroll-the-page-to-show-the-active-row", "title": "Scroll the page to show the active row", "body": "<p>I am doing my calculation and using VBA. When I run the code I can not see what is happening, let's say in line 400, till the end of run.</p>\n\n<p>I found this code:</p>\n\n<pre><code>ActiveWindow.ScrollRow = Selection.Row \nActiveWindow.ScrollColumn = Selection.Column \n</code></pre>\n\n<p>or </p>\n\n<pre><code>Application. Goto ActiveCell.EntireRow,True \n</code></pre>\n\n<p>How do I scroll the page and show the active row while code is running?</p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470264887, "post_id": 38754212, "comment_id": 64883602, "body": "Which line of code gives the error, and what is the error description? Is it &quot;Unable to get the PivotTables property of the Worksheet class&quot;?"}, {"owner": {"reputation": 1720, "user_id": 6471733, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e96b247d3862d042b84490a62d42e?s=128&d=identicon&r=PG", "display_name": "Muntasir Alam", "link": "https://stackoverflow.com/users/6471733/muntasir-alam"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470265224, "post_id": 38754212, "comment_id": 64883712, "body": "The error is simply &quot;application defined or object defined error&quot; the same as the title. I also get an error on the first block of code, namely  ActiveWorkbook.Worksheets(&quot;Pivot&quot;).PivotTables(&quot;PivotTable1&quot;&zwnj;&#8203;).PivotCache. _         CreatePivotTable TableDestination:=&quot;Sheet5!R3C1&quot;, TableName:=&quot;PivotTable3&quot; _         , DefaultVersion:=xlPivotTableVersion12"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1470270106, "post_id": 38754212, "comment_id": 64884947, "body": "What does the debugger tell you when you step through the code? Which <b>specific line</b> is causing the error?"}, {"owner": {"reputation": 1720, "user_id": 6471733, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e96b247d3862d042b84490a62d42e?s=128&d=identicon&r=PG", "display_name": "Muntasir Alam", "link": "https://stackoverflow.com/users/6471733/muntasir-alam"}, "edited": false, "score": 0, "creation_date": 1470270325, "post_id": 38754212, "comment_id": 64884993, "body": "It highlights the code that I wrote above your comment, in yellow."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1470271102, "post_id": 38754212, "comment_id": 64885188, "body": "Don&#39;t write it in the comments. Instead, <a href=\"https://stackoverflow.com/posts/38754212/edit\">edit</a> your question where it can be seen and properly formatted."}, {"owner": {"reputation": 1720, "user_id": 6471733, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e96b247d3862d042b84490a62d42e?s=128&d=identicon&r=PG", "display_name": "Muntasir Alam", "link": "https://stackoverflow.com/users/6471733/muntasir-alam"}, "edited": false, "score": 0, "creation_date": 1470274064, "post_id": 38754212, "comment_id": 64886786, "body": "Yup I did, You can see it above"}], "answers": [{"comments": [{"owner": {"reputation": 1720, "user_id": 6471733, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e96b247d3862d042b84490a62d42e?s=128&d=identicon&r=PG", "display_name": "Muntasir Alam", "link": "https://stackoverflow.com/users/6471733/muntasir-alam"}, "edited": false, "score": 0, "creation_date": 1470265834, "post_id": 38755032, "comment_id": 64883889, "body": "What is pivot cache? Could you also tab the code and format in the one I gave, so its easier for me to understand? I don&#39;t really know VBA."}, {"owner": {"reputation": 1720, "user_id": 6471733, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e96b247d3862d042b84490a62d42e?s=128&d=identicon&r=PG", "display_name": "Muntasir Alam", "link": "https://stackoverflow.com/users/6471733/muntasir-alam"}, "edited": false, "score": 0, "creation_date": 1470274050, "post_id": 38755032, "comment_id": 64886780, "body": "Now it says invalid procedure call or argument"}, {"owner": {"reputation": 41, "user_id": 6669475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3dDXq.png?s=128&g=1", "display_name": "NapSolo", "link": "https://stackoverflow.com/users/6669475/napsolo"}, "reply_to_user": {"reputation": 1720, "user_id": 6471733, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e96b247d3862d042b84490a62d42e?s=128&d=identicon&r=PG", "display_name": "Muntasir Alam", "link": "https://stackoverflow.com/users/6471733/muntasir-alam"}, "edited": false, "score": 0, "creation_date": 1470319294, "post_id": 38755032, "comment_id": 64910152, "body": "invalid procedure call probably because my example used xlPivotTableVersion14 (Excel 2010) instead of your xlPivotTableVersion12 (Excel 2007). I have no success running recorded macro for pivots."}, {"owner": {"reputation": 1720, "user_id": 6471733, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e96b247d3862d042b84490a62d42e?s=128&d=identicon&r=PG", "display_name": "Muntasir Alam", "link": "https://stackoverflow.com/users/6471733/muntasir-alam"}, "edited": false, "score": 0, "creation_date": 1470319348, "post_id": 38755032, "comment_id": 64910196, "body": "It works now, just fine. Could you see my new question here <a href=\"http://stackoverflow.com/questions/38757461/taking-data-from-pivot-table-and-inserting-under-specific-headers\" title=\"taking data from pivot table and inserting under specific headers\">stackoverflow.com/questions/38757461/&hellip;</a>"}], "tags": [], "owner": {"reputation": 41, "user_id": 6669475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3dDXq.png?s=128&g=1", "display_name": "NapSolo", "link": "https://stackoverflow.com/users/6669475/napsolo"}, "is_accepted": true, "score": 0, "last_activity_date": 1470319493, "last_edit_date": 1470319493, "creation_date": 1470265572, "answer_id": 38755032, "question_id": 38754212, "link": "https://stackoverflow.com/questions/38754212/pivot-table-macro-not-working-error-1004-application-defined-or-object-define/38755032#38755032", "title": "Pivot table Macro not working (Error 1004 : Application defined or Object defined error)", "body": "<p>Try creating the pivot cache first and then the pivot table. Sample code snippet below. Also remember that destination sheets needs to be unique name each time you run this.</p>\n\n<pre><code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"Pivot!R2C2:R6C5\", Version:=xlPivotTableVersion14).CreatePivotTable _\n    TableDestination:=\"Sheet5!R3C1\", TableName:=\"PivotTabletest\", DefaultVersion:=xlPivotTableVersion12\n</code></pre>\n"}], "owner": {"reputation": 1720, "user_id": 6471733, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e96b247d3862d042b84490a62d42e?s=128&d=identicon&r=PG", "display_name": "Muntasir Alam", "link": "https://stackoverflow.com/users/6471733/muntasir-alam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 0, "accepted_answer_id": 38755032, "answer_count": 1, "score": 0, "last_activity_date": 1470319493, "creation_date": 1470260991, "last_edit_date": 1470271899, "question_id": 38754212, "link": "https://stackoverflow.com/questions/38754212/pivot-table-macro-not-working-error-1004-application-defined-or-object-define", "title": "Pivot table Macro not working (Error 1004 : Application defined or Object defined error)", "body": "<p>I'm creating a pivot table on the macro recorder and for some reason my macro is giving me this error. I've tread reading other SO problems on this similar error, however none of the solutions seem to be working. Here is the code</p>\n\n<pre><code>Sub macro5()\n'\n' macro5 Macro\n'\n\n'\n    Sheets.Add\n    ActiveWorkbook.Worksheets(\"Pivot\").PivotTables(\"PivotTable1\").PivotCache. _\n        CreatePivotTable TableDestination:=\"Sheet5!R3C1\", TableName:=\"PivotTable3\" _\n        , DefaultVersion:=xlPivotTableVersion12\n    Sheets(\"Sheet5\").Select\n    Cells(3, 1).Select\n    With ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Employee/app.name\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable3\").AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable3\").PivotFields(\"     Hours\"), \"Sum of      Hours\", xlSum\nEnd Sub\n</code></pre>\n\n<p>ERROR HERE</p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"Pivot\").PivotTables(\"PivotTable1\").PivotCache. _ CreatePivotTable TableDestination:=\"Sheet5!R3C1\", TableName:=\"PivotTable3\" _ , DefaultVersion:=xlPivotTableVersion12\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470259625, "post_id": 38753763, "comment_id": 64881637, "body": "If you don&#39;t have some other need to use VBA, you could probably achieve that result by just having a VLOOKUP formula in column B of Sheet2."}, {"owner": {"reputation": 23, "user_id": 1483720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20281ca8bceac55742a319775119121?s=128&d=identicon&r=PG", "display_name": "Geoffrey K", "link": "https://stackoverflow.com/users/1483720/geoffrey-k"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470272234, "post_id": 38753763, "comment_id": 64885453, "body": "I could, but what I should have added was that I need to retain the ability for the user to manually enter those totals there too, for different reasons. By doing a simple lookup, they&#39;d then be overwriting formulas."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470275941, "post_id": 38753763, "comment_id": 64887156, "body": "A simple macro could then just paste formulae into Sheet2, which the users could overwrite if they wished to.  That would be no different to the macro pasting values into Sheet2, which the users could overwrite if they wished to.  I think <code>Worksheets(&quot;Sheet2&quot;).Range(&quot;B4:B18&quot;).Formula = &quot;=IFERROR(VLOOKUP(A4,_dynamicrangename_,2,False),&quot;&quot;Not found&quot;&quot;)&quot;</code> would probably work."}, {"owner": {"reputation": 23, "user_id": 1483720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20281ca8bceac55742a319775119121?s=128&d=identicon&r=PG", "display_name": "Geoffrey K", "link": "https://stackoverflow.com/users/1483720/geoffrey-k"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470282903, "post_id": 38753763, "comment_id": 64888831, "body": "That would be a fallback if all else fails, but it goes against the objective of the range on Sheet 2 being an input cell that is either populated by a direct input or from Sheet 1 where a formula was used to create a quantity on Sheet 2 or to populate it with any different quantity. In short, I want users to be able to adjust the quantities that are copied across and preferably not have to overwrite a formula to do so."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470283322, "post_id": 38753763, "comment_id": 64888934, "body": "Your macro could use two commands then: <code>Worksheets(&quot;Sheet2&quot;).Range(&quot;B4:B18&quot;).Formula = &quot;=IFERROR(VLOOKUP(A4,dynamicrangename,2,False),&quot;&quot;Not found&quot;&quot;)&quot;</code> followed by <code>Worksheets(&quot;Sheet2&quot;).Range(&quot;B4:B18&quot;).Value = Worksheets(&quot;Sheet2&quot;).Range(&quot;B4:B18&quot;).Value</code>"}, {"owner": {"reputation": 23, "user_id": 1483720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20281ca8bceac55742a319775119121?s=128&d=identicon&r=PG", "display_name": "Geoffrey K", "link": "https://stackoverflow.com/users/1483720/geoffrey-k"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470293350, "post_id": 38753763, "comment_id": 64892554, "body": "Of course! I don&#39;t know why I didn&#39;t think of that. That&#39;ll work perfectly, thank you."}], "owner": {"reputation": 23, "user_id": 1483720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20281ca8bceac55742a319775119121?s=128&d=identicon&r=PG", "display_name": "Geoffrey K", "link": "https://stackoverflow.com/users/1483720/geoffrey-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470258929, "creation_date": 1470258929, "last_edit_date": 1531164843, "question_id": 38753763, "link": "https://stackoverflow.com/questions/38753763/match-descriptions-and-copy-paste-associated-quantity", "title": "Match descriptions and copy/paste associated quantity", "body": "<p>In Sheet 1, column A contains a list of product names and column B a list of quantities. The number of rows is variable and could be a minimum of 1 and a maximum of 15 (from row 62 to 76 - blank rows are automatically hidden). In Sheet 2, column A contains the same product list, but all 15 of them, ie Sheet 1 is a dynamic range and Sheet 2 is a static range. I am attempting to set up a VBA procedure whereby the macro will match the product in column A62 (Sheet 1) with column A4-18 (Sheet 2), copy the corresponding quantity from column B in Sheet 1 to column B in Sheet 2 and then move down the product list in Sheet 1, doing the same till it reaches the end of the dynamic range.</p>\n\n<p>If anyone can assist or point me in the right direction, I'd be very grateful. Many thanks.</p>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1470259677, "post_id": 38753567, "comment_id": 64881656, "body": "Pramod: can you elaborate a little more on the outcome you&#39;re after? In your other post you say that you want an array of visible items. Is this also the case here? Out of interest, what do you intend to do with the array? I have some ideas but it would help if I knew your ultimate intent"}, {"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1470259975, "post_id": 38753567, "comment_id": 64881827, "body": "Thanks for you interest Jeff. I have 5 Pivot Fields on my Report Filter and user can select items from any of them. Whenever they make a selection on one Filter, I want to collect the visible items into an array and pass that array to VisibleItemsList method to reflect the same changes in other pivot table. In simple words, I want to apply filter on one pivot table to other pivot table whenever a pivot field&#39;s items are selected"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1470260745, "post_id": 38753567, "comment_id": 64882163, "body": "And I take it you&#39;re using excel 2007?"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1470260918, "post_id": 38753567, "comment_id": 64882249, "body": "Can you also advise how many items roughly in each of the 5 pivotfields? Easiest way to tell is to create a pivot with just one field in it as rowfield and see how many rows it takes up"}, {"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1470261866, "post_id": 38753567, "comment_id": 64882641, "body": "3 of them have maximum of 6 Items. But 2 of those have 30 and 53 Items each. So Row Label is not an option for me as it&#39;ll occupy too many rows and I have few other things to show below the filters. To over come this, I&#39;ve named the cell where each field is present and whenever a change occurs in that cell, I move that field to Column Label get the changes and reflect them on other pivot table."}, {"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1470262044, "post_id": 38753567, "comment_id": 64882704, "body": "But the method is tried doesn&#39;t work effectively. Because, when a field is moved from Report Filter to Column Label, the Field below that is occupying the previous fields place triggering a change in the cell which in turn causes another macro to run. This is becoming a chain event. So, rather than moving the fields i want to get the Visible Items when the Field is in Report Filter itself. Hope I explained my situation clearly."}, {"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1470262083, "post_id": 38753567, "comment_id": 64882714, "body": "And, I&#39;m using Excel 2007"}], "answers": [{"comments": [{"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "edited": false, "score": 0, "creation_date": 1470276100, "post_id": 38755069, "comment_id": 64887197, "body": "Awesome Jeff. Simply Superb. I was struggling to do this for past 1 week and you solve it in a blink of an eye. I&#39;ve downloaded the sample workbook and modified according to my need and it&#39;s working perfectly."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "edited": false, "score": 0, "creation_date": 1470276201, "post_id": 38755069, "comment_id": 64887212, "body": "Cool. Glad to have helped"}, {"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "edited": false, "score": 0, "creation_date": 1470322763, "post_id": 38755069, "comment_id": 64913151, "body": "I have a doubt Jeff. I see that when I applied filter on ONE field, all the other fields status is also getting copied. Is it possible to apply filter ONLY ON THE FIELD I changed?"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "edited": false, "score": 0, "creation_date": 1470431822, "post_id": 38755069, "comment_id": 64966079, "body": "Not easily.  Read these.  <a href=\"http://dailydoseofexcel.com/archives/2014/07/07/what-caused-that-pivottableupdate-part-one/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/2014/07/07/&hellip;</a>   <a href=\"http://dailydoseofexcel.com/archives/2014/07/08/what-caused-that-pivottableupdate-part-two/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/2014/07/08/&hellip;</a>   <a href=\"http://dailydoseofexcel.com/archives/2014/07/09/what-caused-that-pivottableupdate-part-tres/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/2014/07/09/&hellip;</a> <a href=\"http://dailydoseofexcel.com/archives/2014/07/10/what-caused-that-pivottableupdate-episode-iv/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/2014/07/10/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": true, "score": 1, "last_activity_date": 1470265856, "creation_date": 1470265856, "answer_id": 38755069, "question_id": 38753567, "link": "https://stackoverflow.com/questions/38753567/how-to-access-pivot-items-of-a-pivot-field-which-is-present-in-report-filter-usi/38755069#38755069", "title": "How to access Pivot Items of a Pivot Field which is present in Report Filter using VBA", "body": "<p>See my code at the below link that lets you sync PivotTables efficiently in the event that you can't use Slicers\n<a href=\"http://blog.contextures.com/archives/2012/08/28/update-specific-pivot-tables-automatically/\" rel=\"nofollow\">http://blog.contextures.com/archives/2012/08/28/update-specific-pivot-tables-automatically/</a></p>\n"}], "owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1249, "favorite_count": 0, "accepted_answer_id": 38755069, "answer_count": 1, "score": 0, "last_activity_date": 1470265856, "creation_date": 1470258133, "last_edit_date": 1531164843, "question_id": 38753567, "link": "https://stackoverflow.com/questions/38753567/how-to-access-pivot-items-of-a-pivot-field-which-is-present-in-report-filter-usi", "title": "How to access Pivot Items of a Pivot Field which is present in Report Filter using VBA", "body": "<p>I used the below code to print the Pivot Items present in Each PivotField and their visible status. I have 5 Pivot Fields in the Report Filter.</p>\n\n<p>The problem is, it is fetching the no.of Pivot Fields Properly. But when it comes to the no.of Pivot Items is returning 0 for every pivot field. In real each Field has many items. I'm not trying to print the visible items. But Items and their Visible Status.</p>\n\n<pre><code>Dim pf As PivotField\nDim pt As PivotTable\nDim pi As PivotItem\n\nSet pt = Sheets(\"Reasons\").PivotTables(\"PivotFields\")\nFor Each pf In pt.PageFields\n     For Each pi In pf.PivotItems\n         Debug.Print pi.Name &amp; \" : \" &amp; pi.Visible\n     Next\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470256195, "post_id": 38752976, "comment_id": 64879992, "body": "Is there a fixed number of &quot;Op&quot;s, and would it matter if all of those Ops were displayed in the final results even if the values of A, B and C were 0?  (i.e. can the results have a fixed number of lines generated for each Part #, or do you need to have only 3 lines shown if a Part # only has source records for 3 Ops?)"}, {"owner": {"reputation": 11, "user_id": 6673954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caeacbc56af46d343aae960555e93f45?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Williams", "link": "https://stackoverflow.com/users/6673954/nathan-williams"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470256714, "post_id": 38752976, "comment_id": 64880236, "body": "Every Part will need each of the 4 ops even if it is zero. It may also be easier to have 4 of the same Part #s as well which can be used later with excel&#39;s Filter."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470256804, "post_id": 38752976, "comment_id": 64880285, "body": "And is the data currently sorted, or can it be sorted, into Ops within Part# order?  The process is so much simpler if it is."}, {"owner": {"reputation": 11, "user_id": 6673954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caeacbc56af46d343aae960555e93f45?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Williams", "link": "https://stackoverflow.com/users/6673954/nathan-williams"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470257022, "post_id": 38752976, "comment_id": 64880399, "body": "Data comes sorted by part number, numerically. The Ops within each part number is not sorted as shown and comes in every which order."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1470259085, "last_edit_date": 1470259085, "creation_date": 1470258396, "answer_id": 38753638, "question_id": 38752976, "link": "https://stackoverflow.com/questions/38752976/looping-through-ranges-rows-and-columns/38753638#38753638", "title": "Looping Through Ranges, Rows, and Columns", "body": "<p>I was bored while eating my breakfast, so here is some (untested) code:</p>\n\n<pre><code>Option Explicit\n\nPrivate rowDst As Long\nPrivate Results() As Integer\nPrivate currentPartNo As String\nPrivate Ops(4) As String\nPrivate wsDst As Worksheet\nPrivate op As Integer\nPrivate abc As Integer\n\nSub RunMe()\n    'Switch off ScreenUpdating to speed up execution time\n    Application.ScreenUpdating = False\n\n    Dim wsSrc As Worksheet\n    Dim rowSrc As Long\n    Ops(1) = \"Foundry\"\n    Ops(2) = \"Machining\"\n    Ops(3) = \"Outside\"\n    Ops(4) = \"Polishing\"\n\n    Set wsSrc = Worksheets(\"Sheet1\")\n    Set wsDst = Worksheets(\"Sheet2\")\n\n    currentPartNo = \"\"\n\n    rowSrc = 2\n    rowDst = 2\n    Do While wsSrc.Cells(rowSrc, 1).Value &lt;&gt; \"\"\n        If wsSrc.Cells(rowSrc, 1).Value &lt;&gt; currentPartNo Then\n            'Different part #, so need to write out results for previous part #\n            WriteResults\n            'Keep track of current part # so we know when to write out results\n            currentPartNo = wsSrc.Cells(rowSrc, 1).Value\n            'Clear out current values from Results array\n            ReDim Results(3, 4) As Integer\n        End If\n        'Determine Op position\n        For op = 1 To 4\n            If wsSrc.Cells(rowSrc, 5).Value = Ops(op) Then\n                Exit For\n            End If\n        Next\n        'Loop through A, B and C, adding values into Results array\n        For abc = 1 To 3\n            Results(abc, op) = Results(abc, op) + wsSrc.Cells(rowSrc, abc + 1).Value\n        Next\n        'Increment row pointer\n        rowSrc = rowSrc + 1\n    Loop\n    'Write results for final part #\n    WriteResults\n\n    'Switch ScreenUpdating back on\n    Application.ScreenUpdating = True\n\nEnd Sub\n\nPrivate Sub WriteResults()\n    If currentPartNo &lt;&gt; \"\" Then\n        wsDst.Cells(rowDst + 0, 1).Value = currentPartNo\n        For op = 1 To 4\n            wsDst.Cells(rowDst + op - 1, 5).Value = Ops(op)\n            For abc = 1 To 3\n                wsDst.Cells(rowDst + op - 1, abc + 1).Value = Results(abc, op)\n            Next\n        Next\n        rowDst = rowDst + 4\n        currentPartNo = \"\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>(I really shouldn't be providing code for you - StackOverflow is here to help you resolve the problems you have with <strong>your</strong> code but, as I said, I was bored.)</p>\n"}, {"tags": [], "owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1470258659, "creation_date": 1470258659, "answer_id": 38753701, "question_id": 38752976, "link": "https://stackoverflow.com/questions/38752976/looping-through-ranges-rows-and-columns/38753701#38753701", "title": "Looping Through Ranges, Rows, and Columns", "body": "<p>As per the below code the results will be put into G,H,I,J,K columns</p>\n\n<pre><code>Dim records As Integer, count As Integer, x As String\nrecords = 24\ncount = 1\nDim ops(4) As Variant\nops(1) = \"Foundry\"\nops(2) = \"Machining\"\nops(3) = \"Outside\"\nops(4) = \"Polishing\"\n\nFor i = 2 To records + 1\n    If x &lt;&gt; Cells(i, 1).Value Then\n        x = Cells(i, 1).Value\n        For op = 1 To 4\n            For j = 2 To records + 1\n                If Cells(j, 1).Value = x And Cells(j, 5).Value = ops(op) Then\n                    a = a + Cells(j, 2).Value\n                    b = b + Cells(j, 3).Value\n                    c = c + Cells(j, 4).Value\n                End If\n            Next j\n\n            If op = 1 Then\n                Cells(count, 7).Value = x\n            End If\n            Cells(count, 8).Value = a\n            Cells(count, 9).Value = b\n            Cells(count, 10).Value = c\n            Cells(count, 11).Value = ops(op)\n\n            count = count + 1\n            a = 0\n            b = 0\n            c = 0\n        Next op\n\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1470272524, "last_edit_date": 1470272524, "creation_date": 1470264681, "answer_id": 38754892, "question_id": 38752976, "link": "https://stackoverflow.com/questions/38752976/looping-through-ranges-rows-and-columns/38754892#38754892", "title": "Looping Through Ranges, Rows, and Columns", "body": "<p>If you don't need the precise format you show above, a Pivot table can give you similar information in a slightly different layout.</p>\n\n<p>Using your data, drag <code>Part #</code> and <code>Op</code> to the Rows area; Drag <code>A</code>, <code>B</code> and <code>C</code> to the Values area for the Sum</p>\n\n<p><a href=\"https://i.stack.imgur.com/Dw6oF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dw6oF.png\" alt=\"enter image description here\"></a></p>\n\n<p>The result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xAg8l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xAg8l.png\" alt=\"enter image description here\"></a></p>\n\n<p>Or, if you select Outline form:</p>\n\n<p><a href=\"https://i.stack.imgur.com/miqcq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/miqcq.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 6673954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caeacbc56af46d343aae960555e93f45?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Williams", "link": "https://stackoverflow.com/users/6673954/nathan-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1470272524, "creation_date": 1470255834, "last_edit_date": 1531161705, "question_id": 38752976, "link": "https://stackoverflow.com/questions/38752976/looping-through-ranges-rows-and-columns", "title": "Looping Through Ranges, Rows, and Columns", "body": "<p>I have a large data dump that I need to sort through with a snippet of the information below.</p>\n\n<pre><code>    Part #  A   B   C   Op\n    2403253 1   7   4   Foundry\n    2403253 2   8   5   Foundry\n    2403253 3   9   6   Foundry\n    2403253 4   1   7   Foundry\n    2403253 5   2   8   Outside\n    2403253 6   3   9   Machining\n    2403253 7   4   1   Machining\n    2403253 8   5   2   Polishing\n    2403253 9   6   3   Polishing\n    2403254 1   7   4   Foundry\n    2403254 2   8   5   Foundry\n    2403254 3   9   6   Machining\n    2403254 4   1   7   Polishing\n    2403256 5   2   8   Foundry\n    2403256 6   3   9   Foundry\n    2403256 7   4   1   Machining\n    2403256 8   5   2   Polishing\n    2403257 9   6   3   Foundry\n    2403257 1   7   4   Foundry\n    2403257 2   8   5   Machining\n    2403257 3   9   6   Polishing\n    2403258 4   1   7   Foundry\n    2403258 5   2   8   Foundry\n    2403258 6   3   9   Polishing\n</code></pre>\n\n<p>What I am looking to do is loop through each of the \"Part #s\" and pair it with each of the \"Ops\" adding A, B, &amp; C together to get a final result like:</p>\n\n<pre><code>    Part #  A   B   C   Op\n    2403253 X   X   X   Foundry\n            X   X   X   Machining \n            X   X   X   Outside\n            X   X   X   Polishing\n    2403254 X   X   X   Foundry\n            X   X   X   Machining \n            X   X   X   Outside\n            X   X   X   Polishing\n    2403256 X   X   X   Foundry\n            X   X   X   Machining \n            X   X   X   Outside\n            X   X   X   Polishing\n    2403257 X   X   X   Foundry\n            X   X   X   Machining \n            X   X   X   Outside\n            X   X   X   Polishing\n    2403258 X   X   X   Foundry\n            X   X   X   Machining \n            X   X   X   Outside\n            X   X   X   Polishing\n</code></pre>\n\n<p>I am not sure how to go about it. Any help is appreciated. I have tried comprehending looping, consolidating, and some others.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1470255834, "post_id": 38752920, "comment_id": 64879827, "body": "I don&#39;t know whether it is possible or not, but I&#39;m certainly <b>hoping</b> that it isn&#39;t.  I&#39;d hate to be using a file and then have some other user close it on me."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470257070, "post_id": 38752920, "comment_id": 64880429, "body": "Yes it is possible if you have Admin Access"}, {"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470257224, "post_id": 38752920, "comment_id": 64880513, "body": "@SiddharthRout assuming I had admin access, what would be the best way to execute it."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470257290, "post_id": 38752920, "comment_id": 64880539, "body": "I am still deciding whether it is ethical to share it or not :D because like @YowE3K is concerned, I would be damn pissed if someone closes the file I am working on..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470257464, "post_id": 38752920, "comment_id": 64880640, "body": "I will let the community decide. If majority says, post it, I will..."}, {"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1470258210, "post_id": 38752920, "comment_id": 64880980, "body": "@SiddharthRout Hm, to give some context, I work in a room with monitors all over the walls.  We keep the report up on a screen from the day before, and in an effort to not have to get up and walk across a room to close it every day, I want to be able to remotely close it.  Small price to pay in walking, but if I can get around it, that would be nice.  I can assure the audience that nobody well ever be working with the pdf document."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470258393, "post_id": 38752920, "comment_id": 64881062, "body": "I have posted a question in <a href=\"http://meta.stackoverflow.com/questions/330572/unsure-if-i-should-post-an-answer\">meta</a> Please gimme some time"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1470258713, "post_id": 38752920, "comment_id": 64881209, "body": "@Rivers31334: The better approach is to have an application on the target computer that automatically opens the correct document each day."}, {"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1470259219, "post_id": 38752920, "comment_id": 64881432, "body": "@RobertHarvey This is actually a great work around and solution.  I saw your comment on the Meta, but what you are saying here works just fine."}], "answers": [{"comments": [{"owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "edited": false, "score": 0, "creation_date": 1470259256, "post_id": 38753818, "comment_id": 64881455, "body": "I think Robert Harvey has a great work around.  Apologies that I just saw this as you posted this solution.  Thank you for your help."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470260042, "post_id": 38753818, "comment_id": 64881857, "body": "(a) Will that actually work on a different computer, or do you have to remote in to the computer that the file is open on, or at least be logged on to the computer (file server) on which the file is located?  (b) does it actually close the file, or does it just disconnect the connection between the file server (for example) and the user&#39;s computer, thus leaving the user reading the document from the memory cache?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470260352, "post_id": 38753818, "comment_id": 64882009, "body": "<code>1</code> No you do not need to remote in <code>2</code> It closes the file"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470260525, "post_id": 38753818, "comment_id": 64882071, "body": "Seems strange that even an admin user on computer A can see files that are located on server S which are open by a user on computer B with just a simple command.  I would have thought that they would need to either specify the file that they are interested in, or the server that the file is located on, or the computer that is accessing the file."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470260573, "post_id": 38753818, "comment_id": 64882092, "body": "Ahh - I see you mentioned that they could do the disconnect with just the filename"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470260814, "post_id": 38753818, "comment_id": 64882204, "body": "Can you not remotely log off the machine? As an administrator, it will be much easier? Lot of Admins do that when users forget to logoff/switch off the pcs before going home..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470260842, "post_id": 38753818, "comment_id": 64882216, "body": "Anyways it is 3:17AM on this part of the planet. I am off to bed Gnite :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 3, "last_activity_date": 1470259431, "last_edit_date": 1470259431, "creation_date": 1470259110, "answer_id": 38753818, "question_id": 38752920, "link": "https://stackoverflow.com/questions/38752920/close-an-adobe-acrobat-file-opened-by-another-user-on-different-computer-same-n/38753818#38753818", "title": "Close an Adobe Acrobat file opened by another user on different computer (same network)", "body": "<p>Yes it is possible if you have <code>Admin Rights (Phew!)</code>.</p>\n\n<p>To manually test it</p>\n\n<ol>\n<li>Click Windows Start | Run | Cmd.exe</li>\n<li>Type <code>OpenFiles</code> at command prompt and press the Enter key</li>\n<li>You will see the list of files/folders that are opened. They will be listed as <code>ID</code>, <code>Accessed By</code>, <code>Type</code> , <code>Open File (Path\\executable)</code></li>\n<li>To disconnect you can use File ID, UserName, or file name Like <code>OpenFiles /Disconnect /ID 123</code></li>\n</ol>\n\n<p>Now all this can be done from VBA if you know how to issue DOS commands from VBA.</p>\n"}], "owner": {"reputation": 585, "user_id": 3216810, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da8ba75a9d7a5581ace535e9d9474d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Rivers31334", "link": "https://stackoverflow.com/users/3216810/rivers31334"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 38753818, "answer_count": 1, "score": 2, "last_activity_date": 1470259431, "creation_date": 1470255627, "last_edit_date": 1470256748, "question_id": 38752920, "link": "https://stackoverflow.com/questions/38752920/close-an-adobe-acrobat-file-opened-by-another-user-on-different-computer-same-n", "title": "Close an Adobe Acrobat file opened by another user on different computer (same network)", "body": "<p>I have been working on a process to automate a report for my work.  One of the final bits that i would like to work on is understanding if it is possible to close a pdf file that is opened by another user at a different computer (albeit on the same network).  I have used tutorials and written the following macro and function to successfully test if the file is open, however, I now want to know if it is possible to actually close the file from a different and remote location.</p>\n\n<p>Does anyone have any advice for how to do this, or if it is possible.  I have seen similar items for close excel documents, but not the pdf documents.</p>\n\n<pre><code>'function to determine if file is open\nFunction IsFileOpen(FileName As String)\n\nDim ff As Long, ErrNo As Long\n\nOn Error Resume Next\nff = FreeFile()\nOpen FileName For Input Lock Read As #ff\nClose ff\nErrNo = Err\nOn Error GoTo 0\n\n'select case depending on if file is open or not\nSelect Case ErrNo\nCase 0:    IsFileOpen = False\nCase 70:   IsFileOpen = True\nCase Else: Error ErrNo\n\nEnd Select\n\nEnd Function\n\n\n\n'method to close DOR in pdf form if it is already open\nSub closeAcrobat()\n\nDim sStatus\n\nsStatus = IsFileOpen(\"M:\\Daily_Outage_Report\\Active\\Operations_Daily_Outage_Report_\" _\n&amp; Format(Date, \"yyyy-mm-dd\") &amp; \".pdf\")\n\nIf sStatus = True Then\n    MsgBox \"file is open\"\nElse\n    MsgBox \"file is not open\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "filter", "listbox"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6672206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_YVL00Gu5Hk/AAAAAAAAAAI/AAAAAAAAAO0/Mcm6ITqQAmM/photo.jpg?sz=128", "display_name": "Diana", "link": "https://stackoverflow.com/users/6672206/diana"}, "edited": false, "score": 0, "creation_date": 1470314033, "post_id": 38754139, "comment_id": 64905996, "body": "Thanks for the help, John.  Unfortunately, when I replace that code the search-as-you-type no longer works."}, {"owner": {"reputation": 76, "user_id": 6658527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697851e215cde76bb56f4cb4bf12899d?s=128&d=identicon&r=PG&f=1", "display_name": "John W Fowler", "link": "https://stackoverflow.com/users/6658527/john-w-fowler"}, "reply_to_user": {"reputation": 1, "user_id": 6672206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_YVL00Gu5Hk/AAAAAAAAAAI/AAAAAAAAAO0/Mcm6ITqQAmM/photo.jpg?sz=128", "display_name": "Diana", "link": "https://stackoverflow.com/users/6672206/diana"}, "edited": false, "score": 0, "creation_date": 1470315230, "post_id": 38754139, "comment_id": 64906907, "body": "Add <code>me.refresh</code> ?"}], "tags": [], "owner": {"reputation": 76, "user_id": 6658527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697851e215cde76bb56f4cb4bf12899d?s=128&d=identicon&r=PG&f=1", "display_name": "John W Fowler", "link": "https://stackoverflow.com/users/6658527/john-w-fowler"}, "is_accepted": false, "score": 0, "last_activity_date": 1470260679, "creation_date": 1470260679, "answer_id": 38754139, "question_id": 38752873, "link": "https://stackoverflow.com/questions/38752873/listbox-filtered-dynamically-by-textbox-is-recording-saving-wrong-value/38754139#38754139", "title": "Listbox filtered dynamically by textbox is recording/saving wrong value", "body": "<p>Replace:</p>\n\n<pre><code>'run the search\nfLiveSearch Me.txtSearch, Me.lstItems, strFullList, strFilteredList,  Me.txtCount\n</code></pre>\n\n<p>With</p>\n\n<pre><code>me.lstitems.rowsourcetype = \"Table/Query\"\nme.lstitems.rowsource = strfilteredlist\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6672206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_YVL00Gu5Hk/AAAAAAAAAAI/AAAAAAAAAO0/Mcm6ITqQAmM/photo.jpg?sz=128", "display_name": "Diana", "link": "https://stackoverflow.com/users/6672206/diana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 447, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470261991, "creation_date": 1470255437, "last_edit_date": 1470261991, "question_id": 38752873, "link": "https://stackoverflow.com/questions/38752873/listbox-filtered-dynamically-by-textbox-is-recording-saving-wrong-value", "title": "Listbox filtered dynamically by textbox is recording/saving wrong value", "body": "<p>I have a textbox that dynamically filters a listbox on the same form as you type.  The listbox filters perfectly, but the selected value is not saving correctly.  For example, if you click on the fourth value after filtering the listbox and then close the form, it actually saves what would have been the fourth value had the list not been filtered.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Private Sub txtSearch_Change()\n'CODE THAT HANDLES WHAT HAPPENS WHEN THE USER TYPES IN THE SEARCH BOX\n    Dim strFullList       As String\n    Dim strFilteredList   As String\n\n\n    If blnSpace = False Then\n        Me.Refresh 'refresh to make sure the text box changes are actually available to use\n\n        'specify the default/full rowsource for the control\n        strFullList = \"SELECT [Project ID], [Project Name] FROM [Admin: Projects] ORDER BY [Project Name];\"\n        'specify the way you want the rowsource to be filtered based on the user's entry\n        strFilteredList = \"SELECT [Project ID], [Project Name] FROM [Admin: Projects] WHERE [Project Name] LIKE \"\"*\" &amp; Me.txtSearch.Value &amp; \"*\"\" ORDER BY [Project Name]\"\n\n        'run the search\n        fLiveSearch Me.txtSearch, Me.lstItems, strFullList, strFilteredList, Me.txtCount\n    End If\n\nEnd Sub\n\nPrivate Sub txtSearch_KeyPress(KeyAscii As Integer)\n'NECESSARY TO IDENTIFY IF THE USER IS HITTING THE SPACEBAR\n'IN WHICH CASE WE WANT TO IGNORE THE INPUT\n\n    On Error GoTo err_handle\n\n    If KeyAscii = 32 Then\n        blnSpace = True\n    Else\n        blnSpace = False\n    End If\n\n\n    Exit Sub\n    err_handle:\n    Select Case Err.Number\n    Case Else\n        MsgBox \"An unexpected error has occurred: \" &amp; vbCrLf &amp; Err.Description &amp; _\n        vbCrLf &amp; \"Error \" &amp; Err.Number &amp; \"(\" &amp; Erl &amp; \")\"\n    End Select\nEnd Sub\n\nPrivate Sub txtSearch_GotFocus()\n' USED TO REMOVE THE PROMPT IF THE CONTROL GETS FOCUS\n    On Error Resume Next\n    If Me.txtSearch.Value = \"(type to search)\" Then\n        Me.txtSearch.Value = \"\"\n    End If\nEnd Sub\n\nPrivate Sub txtSearch_LostFocus()\n' USED TO ADD THE PROMPT BACK IN IF THE CONTROL LOSES FOCUS\n    On Error Resume Next\n    If Me.txtSearch.Value = \"\" Then\n        Me.txtSearch.Value = \"(type to search)\"\n    End If\n\nEnd Sub\n\nPrivate Sub Form_Close()\n    DoCmd.SetWarnings False\nEnd Sub\n</code></pre>\n\n<p>I've inherited this database and am trying to fix up areas that are not working.  I'm definitely a novice and I can't seem to figure out where the error might be in the code that is causing the wrong value to save to the record.  Any guidance would be appreciated.</p>\n"}, {"tags": ["database", "ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6640057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0311d97383cc7ae5fce834875d0e2df8?s=128&d=identicon&r=PG&f=1", "display_name": "Skmr60", "link": "https://stackoverflow.com/users/6640057/skmr60"}, "edited": false, "score": 0, "creation_date": 1470260494, "post_id": 38752754, "comment_id": 64882063, "body": "I think this can be done and I&#39;ll give it a try.  I think that will address the four query issue, but won&#39;t I still wind up with three queries (qryComponents, qryFormulations and the new qryFiltered)?  When the combobox  modify the criteria in  qryComponents or qryFormulations the requery on frmFiltered will still only requery qryFiltered, not the underlying qryComponents and qryFormulations.  The big problem with this nested query solution is getting the early queries to update with the new criteria so the final query shows the formulations meeting the criteria.  Maybe I&#39;m missing something"}, {"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "reply_to_user": {"reputation": 1, "user_id": 6640057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0311d97383cc7ae5fce834875d0e2df8?s=128&d=identicon&r=PG&f=1", "display_name": "Skmr60", "link": "https://stackoverflow.com/users/6640057/skmr60"}, "edited": false, "score": 0, "creation_date": 1470314258, "post_id": 38752754, "comment_id": 64906165, "body": "have you tried it?  It should refresh the query you&#39;re displaying including all its underlying queries."}], "tags": [], "owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "is_accepted": false, "score": 1, "last_activity_date": 1470255037, "creation_date": 1470255037, "answer_id": 38752754, "question_id": 38752639, "link": "https://stackoverflow.com/questions/38752639/filtering-unique-records-from-a-table-meeting-criteria-in-three-related-tables/38752754#38752754", "title": "Filtering unique records from a table meeting criteria in three related tables", "body": "<p>re: <em>Access won't let me just do a Join on these with tblFormulation in a final query due to \"Ambiguous Outer Joins\"</em> </p>\n\n<p>Try using a left outer join from <code>tblFormulation</code> to <code>qryComponents</code> using all rows from <code>tblFormulation</code> and a second left outer join from <code>tblFormulation</code> to <code>qryApprovals</code> again, with all the rows from <code>tblFormulation</code>.</p>\n\n<p>That should be all you need.  If you only want formulations with at least one component and approval, use inner joins instead of outer.</p>\n\n<p>If you're still having problems, post your SQL.</p>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 6658527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697851e215cde76bb56f4cb4bf12899d?s=128&d=identicon&r=PG&f=1", "display_name": "John W Fowler", "link": "https://stackoverflow.com/users/6658527/john-w-fowler"}, "is_accepted": false, "score": 0, "last_activity_date": 1470273679, "last_edit_date": 1470273679, "creation_date": 1470273007, "answer_id": 38756974, "question_id": 38752639, "link": "https://stackoverflow.com/questions/38752639/filtering-unique-records-from-a-table-meeting-criteria-in-three-related-tables/38756974#38756974", "title": "Filtering unique records from a table meeting criteria in three related tables", "body": "<p>Sounds like the real challenge is going to be in building the WHERE clause</p>\n\n<p>I think as a query, this would work</p>\n\n<pre><code>dim strsql1 = _\n\"SELECT tblformulation.*, tblcomponents.FormulationID, tblcomponents.FormulationID  FROM tblformulation AS a JOIN tblcomponents as B ON  a.FormulationID = b.FormulationID JOIN tblComponents as c ON a.FormulationID = c.FormulationID WHERE \" &amp; strwhere &amp; \";\")\n</code></pre>\n\n<p>And then Select Distinct a.FormulationID from there and voila</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6640057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0311d97383cc7ae5fce834875d0e2df8?s=128&d=identicon&r=PG&f=1", "display_name": "Skmr60", "link": "https://stackoverflow.com/users/6640057/skmr60"}, "is_accepted": false, "score": 0, "last_activity_date": 1470347586, "creation_date": 1470347586, "answer_id": 38778015, "question_id": 38752639, "link": "https://stackoverflow.com/questions/38752639/filtering-unique-records-from-a-table-meeting-criteria-in-three-related-tables/38778015#38778015", "title": "Filtering unique records from a table meeting criteria in three related tables", "body": "<p>With help I found the answer and learned something. While I said I needed only fields from frmFormulatins I included others to see results. This created redundant unique records. </p>\n\n<p>Final query: SELECT DISTINCT tblFormulation.FormulationID, tblFormulation.SponsorCode, tblFormulation.AddCo, tblFormulation.Application FROM tblComponent RIGHT JOIN (tblApprovals RIGHT JOIN tblFormulation ON tblApprovals.FormulationID = tblFormulation.FormulationID) ON tblComponent.FormulationID = tblFormulation.FormulationID WHERE (((tblApprovals.Authority)=\"API\") AND ((tblComponent.BOGrp)=\"Grp III\")); </p>\n\n<p>I also learned to post code - it makes it a lot clearer.  First question.  Thanks all </p>\n"}], "owner": {"reputation": 1, "user_id": 6640057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0311d97383cc7ae5fce834875d0e2df8?s=128&d=identicon&r=PG&f=1", "display_name": "Skmr60", "link": "https://stackoverflow.com/users/6640057/skmr60"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1594641579, "creation_date": 1470254580, "last_edit_date": 1594641579, "question_id": 38752639, "link": "https://stackoverflow.com/questions/38752639/filtering-unique-records-from-a-table-meeting-criteria-in-three-related-tables", "title": "Filtering unique records from a table meeting criteria in three related tables", "body": "<p>I am having trouble in Access 2010 filtering records meeting criteria from three possible tables all linked by a common <code>FormulationID</code>.</p>\n\n<p>A simplified description is </p>\n\n<ul>\n<li><p>I have a table called <code>tblFormulation</code> with a <code>FormulationID</code> key and fields describing who created it, general characteristics, formulation date, etc.  I will need to filter on some of these fields.  Most of the fields I will display are in this table.</p></li>\n<li><p>Linked through <code>FormulationID</code> is a second table, <code>tblComponents</code>, which includes all the components, their type, and volumes.  Each <code>FormulationID</code> has 4-7 components.  I want to select <code>FormulationsIDs</code> by Component and/or Type.  I only need to know which <code>FormulationIDs</code> meet the criteria.  I am not displaying any of these fields.</p></li>\n<li><p>Also linked through FormulationID is a third table called <code>tblApprovals</code>.  Let's think of this as <code>Authorites</code> who have published different Levels of Approval for these formulations.  Again, I want to select <code>FormulationsIDs</code> by Approvals and/or <code>Authorites</code>.  Each <code>Forumulation</code> can have 1 to 30 Approvals.  I only need to know which <code>FormulationIDs</code> meet the criteria.  I am not displaying any of these fields.  Editing of Components and Approvals takes place on separate forms that are called up after a formulation is selected.</p></li>\n</ul>\n\n<p>I have tried two approaches to generate a list of Formulations and general characteristics containing selected components with certain selected approvals.</p>\n\n<ul>\n<li><p>First, I have created queries with criteria for each leg.  Let's call them <code>qryComponents</code> and <code>qryApprovals</code>.  These each produce a listing of <code>FormulationIDs</code> filtered for the criteria.  Access won't let me just do a Join on these with <code>tblFormulation</code> in a final query due to <strong>'Ambiguous Outer Joins'</strong> issue so I wind up creating an intermediate query, qryStep2, with <code>tblFormulation</code> records only found in <code>qryApprovals</code>.  I then join that in a final query, <code>qryFiltered</code>, with the <code>tblFormulation</code> records found in <code>qryComponents</code>.\nI then use <code>qryFiltered</code> as the <code>recordsournce</code> for <code>frmFiltered</code> which includes comboboxes for criteria in <code>tblFormulations</code> and <code>qryComponents</code> and <code>qryApprovals</code>.  <strong>In theory this should work.  In reality, it doesn't.</strong>  I change the comboboxes and requery the form, but it doesn't requery the underlying three queries.  I use VBA and haven't figured out if there is a way to requery the underlying queries so the cascade gives me the final desired listing of filtered formluations.  So the question on this solution is how can I get the after_update subroutine for <code>frmFiltered.cboApprovals</code> to force the four requeries - or is  there another solution?</p></li>\n<li><p>After failing with this solution, I tried the heavy-duty VBA approach.  I created a single query, <code>qryEverything</code>, with all the fields from all the tables.  This gives me a FormulationID record with each formulation Approval and still another of the combined records for every Component.  There are a lot of records.  I then set up <code>frmFilter</code> with comboboxes and a subForm of the fields I want.  The after update event on the comboboxes triggers modifications to the WHERE clause of the <code>qryEverything</code> SQL statement which I use for the recordset for subForm.  This works, but I have repeated FormulationIDs where a single formulation meets criteria in both the Component and Approval legs.  I thought I could use <code>SELECT UNIQUE on FormulationID</code> after the filtering, but it's before the <code>WHERE</code> clause so the filtering doesn't work.  I really need to be able to do a second <code>SELECT UNIQUE</code> on this recordset.  I guess I could step through it and delete repeats.  Doesn't sound right.</p></li>\n</ul>\n\n<p>So I'm stuck.  I'll keep playing, but could really use some help.</p>\n"}, {"tags": ["excel", "outlook", "vba"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1470255328, "creation_date": 1470255328, "answer_id": 38752834, "question_id": 38752588, "link": "https://stackoverflow.com/questions/38752588/explain-the-differences-between-these-methods-of-sending-e-mail-from-excel/38752834#38752834", "title": "Explain the differences between these methods of sending e-mail from Excel?", "body": "<blockquote>\n  <p>Is it really useful to change the file type when attaching it?</p>\n</blockquote>\n\n<p>Not that I am aware of unless you are attaching an <strong>Exe</strong> file.</p>\n\n<blockquote>\n  <p>Is there really an advantage to using CreateObject(\"Outlook.Application\") </p>\n</blockquote>\n\n<p>For me, <strong>Yes</strong>. It is easy to use (<em>be it late or early binding</em>). It is part of MS Office (<em>depending on the package you take</em>). Most of the people have it.</p>\n\n<p>Your long version can be reduced by approx 50-60 %. Here is a example (<strong>Untested</strong>) using <strong>Late Binding</strong>.</p>\n\n<pre><code>Sub Sample()\n    Dim OutApp As Object, OutMail As Object\n    Dim Destwb As Workbook\n\n    Set Destwb = ActiveWorkbook\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    With OutMail\n        .to = \"dummyEmail@example.com\"\n        .Subject = \"Enter Subject Here\"\n        .Body = \"Hi there\"\n        .Attachments.Add Destwb.FullName\n        .Display ' .Send\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>You can cut down few more lines if that really matters :)</p>\n\n<pre><code>Sub Sample()\n    Dim OutApp As Object, OutMail As Object\n    Dim Destwb As Workbook\n\n    Set Destwb = ActiveWorkbook\n\n    With Application\n        .ScreenUpdating = False: .EnableEvents = False\n    End With\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    With OutMail\n        .to = \"dummyEmail@example.com\"\n        .Subject = \"Enter Subject Here\"\n        .Body = \"Hi there\"\n        .Attachments.Add Destwb.FullName\n        .Display ' .Send\n    End With\n\n    Set OutMail = Nothing: Set OutApp = Nothing\n\n    With Application\n        .ScreenUpdating = True: .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "edited": false, "score": 0, "creation_date": 1470258645, "post_id": 38753352, "comment_id": 64881180, "body": "Actually, you don&#39;t &quot;attach by hand&quot;. The xlDialogSendMail variable automatically attaches the workbook as soon as the e-mail page opens."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "edited": false, "score": 0, "creation_date": 1470318986, "post_id": 38753352, "comment_id": 64909923, "body": "Thank you very much @ShawnV.Wilson! I&#39;ll edit my answer."}], "tags": [], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "is_accepted": false, "score": 0, "last_activity_date": 1470319137, "last_edit_date": 1470319137, "creation_date": 1470257334, "answer_id": 38753352, "question_id": 38752588, "link": "https://stackoverflow.com/questions/38752588/explain-the-differences-between-these-methods-of-sending-e-mail-from-excel/38753352#38753352", "title": "Explain the differences between these methods of sending e-mail from Excel?", "body": "<h2>From the first example</h2>\n\n<ul>\n<li><p><code>Dim strRecipient, strSubject As String, booReturnReceipt As Boolean</code></p>\n\n<p>This is not being declared properly. Right now strRecipient is being declared as a variant. The correct method would be <code>Dim strRecipient as String, strSubject as String, ...</code></p></li>\n</ul>\n\n<hr>\n\n<h2>From the second example</h2>\n\n<ul>\n<li><p><code>With Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With</code></p>\n\n<p>These lines speed up the procedure.</p></li>\n<li><p><code>If Val(Application.Version) &lt; 12 Then\n    'You use Excel 97-2003\nElse</code></p>\n\n<p>These lines mean that this procedure is prepared for handling any version of Excel. This code is more portable.</p></li>\n</ul>\n\n<hr>\n\n<pre><code>If Val(Application.Version) &lt; 12 Then\n    'You use Excel 97-2003\n    FileExtStr = \".xls\": FileFormatNum = -4143\nElse\n    'You use Excel 2007-2016\n    Select Case Sourcewb.FileFormat\n    Case 51: FileExtStr = \".xlsx\": FileFormatNum = 51\n    Case 52:\n        If .HasVBProject Then\n            FileExtStr = \".xlsm\": FileFormatNum = 52\n        Else\n            FileExtStr = \".xlsx\": FileFormatNum = 51\n        End If\n    Case 56: FileExtStr = \".xls\": FileFormatNum = 56\n    Case Else: FileExtStr = \".xlsb\": FileFormatNum = 50\n    End Select\nEnd If\n</code></pre>\n\n<p>This code is useful if you open a non-Excel file in Excel - for example, if you use Excel to do text-to-columns on a delimited or fixed width text file. By attaching as <code>.xlsb</code> for non-Excel files, you preserve the Excel features that you added by manipulating the file in Excel.</p>\n\n<blockquote>\n  <p>Is there really an advantage to using CreateObject(\"Outlook.Application\")?</p>\n</blockquote>\n\n<p>Paraphrasing what Sidd already said, there can be. I know that when you use the base <code>Send Mail</code> prompt for Gmail, you get a more stripped down application to work with. I am not sure if the same is true for Outlook, but if it is, this would allow you to use the full-featured Outlook for your mail. For example, I am not sure if <code>Send Mail</code> prompts include signatures.</p>\n\n<pre><code>With OutMail\n    .to = \"dummyEmail@example.com\"\n    .Subject = \"Enter Subject Here\"\n    .Body = \"Hi there\"\n    .Attachments.Add Destwb.FullName\n    .Display\nEnd With\n</code></pre>\n\n<p>Finally, this method allows you features the <code>Send Mail</code> prompt doesn't - editting the body text of the e-mail, etc.</p>\n\n<p>Sorry for the inconsistent formatting, the StackExchange editor was a bit finicky for what I was trying to accomplish.</p>\n"}, {"tags": [], "owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1470263929, "creation_date": 1470263929, "answer_id": 38754782, "question_id": 38752588, "link": "https://stackoverflow.com/questions/38752588/explain-the-differences-between-these-methods-of-sending-e-mail-from-excel/38754782#38754782", "title": "Explain the differences between these methods of sending e-mail from Excel?", "body": "<p>I just discovered a significant difference. The Short Version does not allow you to automatically put anything in the message body (which is mainly the point of a form letter). </p>\n\n<p>For some messages -- for instance, a report that the recipient expects every week -- a longish Subject line would suffice. </p>\n"}], "owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1470319137, "creation_date": 1470254406, "last_edit_date": 1531164843, "question_id": 38752588, "link": "https://stackoverflow.com/questions/38752588/explain-the-differences-between-these-methods-of-sending-e-mail-from-excel", "title": "Explain the differences between these methods of sending e-mail from Excel?", "body": "<p>My Excel macro needs to start a new e-mail, with the current workbook as an attachment. (All of the users have Outlook.) The user can modify anything in the e-mail, then click \"Send\".</p>\n\n<p>I've found two different examples online to do this, but one involves much more code than the other. The simpler version seems to work, but I wonder if there's a reason for the complexity of the other.</p>\n\n<p>The short version:</p>\n\n<pre><code>Dim strRecipient, strSubject As String, booReturnReceipt As Boolean\n\nstrRecipient =\"dummyEmail@example.com\"\nstrSubject = \"Enter Subject Here\"\nbooReturnReceipt = True\n\nApplication.Dialogs(xlDialogSendMail).Show Arg1:=strRecipient, _ \n         Arg2:=strSubject, Arg3:=booReturnReceipt\n</code></pre>\n\n<p>The long version:</p>\n\n<pre><code>Sub Mail_ActiveSheet()\n'Working in Excel 2000-2016\n\nDim FileExtStr As String\nDim FileFormatNum As Long\nDim Destwb As Workbook\nDim OutApp As Object\nDim OutMail As Object\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nSet Destwb = ActiveWorkbook\n\n'Determine the Excel version and file extension/format\nWith Destwb\n    If Val(Application.Version) &lt; 12 Then\n        'You use Excel 97-2003\n        FileExtStr = \".xls\": FileFormatNum = -4143\n    Else\n        'You use Excel 2007-2016\n        Select Case Sourcewb.FileFormat\n        Case 51: FileExtStr = \".xlsx\": FileFormatNum = 51\n        Case 52:\n            If .HasVBProject Then\n                FileExtStr = \".xlsm\": FileFormatNum = 52\n            Else\n                FileExtStr = \".xlsx\": FileFormatNum = 51\n            End If\n        Case 56: FileExtStr = \".xls\": FileFormatNum = 56\n        Case Else: FileExtStr = \".xlsb\": FileFormatNum = 50\n        End Select\n    End If\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nWith Destwb\n    On Error Resume Next\n    With OutMail\n        .to = \"dummyEmail@example.com\"\n        .Subject = \"Enter Subject Here\"\n        .Body = \"Hi there\"\n        .Attachments.Add Destwb.FullName\n        .Display\n    End With\n    On Error GoTo 0\n    .Close savechanges:=False\nEnd With\n\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Is there really an advantage to using CreateObject(\"Outlook.Application\")?\nIs it really useful to change the file type when attaching it?</p>\n\n<p>Thanks.</p>\n\n<p>EDIT: Based on the first two answers, it must not be clear that the Short Version functions the same way as the Long Version: rather than just <strong>send</strong> an e-mail, it opens the Compose E-mail window of Outlook (which all of the users have), with the active workbook already attached. The user can edit, add or change recipients, etc. before pressing \"Send\". </p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1470255677, "post_id": 38752517, "comment_id": 64879750, "body": "Try <a href=\"http://stackoverflow.com/questions/8850836/how-to-add-a-custom-ribbon-tab-using-vba/8852767#8852767\">This</a> I have explained it in a very simple way."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1470255757, "post_id": 38752517, "comment_id": 64879791, "body": "especially this part <code>Public Sub Callback1(control As IRibbonControl)</code>"}, {"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470257204, "post_id": 38752517, "comment_id": 64880502, "body": "thanks for the comment! I&#39;ve tried it, but still has the same issue:( (I&#39;ve restarted excel after edit if that matters)."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470257647, "post_id": 38752517, "comment_id": 64880722, "body": "What error did you get? the same?"}, {"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470257778, "post_id": 38752517, "comment_id": 64880782, "body": "yes, still the same"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470258006, "post_id": 38752517, "comment_id": 64880881, "body": "I just tested it. it works just fine for me"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470258037, "post_id": 38752517, "comment_id": 64880892, "body": "Are you sure the message is for that. Is there any other code in your workbook?"}, {"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470258285, "post_id": 38752517, "comment_id": 64881018, "body": "no, there isn&#39;t any other code there."}], "answers": [{"comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1470257248, "post_id": 38752971, "comment_id": 64880523, "body": "thanks for the suggestion. I&#39;ve tried it, but still has the same issue:( (I&#39;ve restarted excel after edit if that matters)"}, {"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "reply_to_user": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 1, "creation_date": 1470260172, "post_id": 38752971, "comment_id": 64881921, "body": "this could be because you are having your code in a private module [ eg : ThisWorkbook or Sheet1 ] Try inserting a new module and insert the code there. This will solve the issue. When i inserted the code in &#39; ThisWorkbook &#39; module it gave me the error but not when put in a new module (public module; say &#39;Module1&#39;)"}, {"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1470283113, "post_id": 38752971, "comment_id": 64888894, "body": "It was already in a &quot;module&quot;, the issue was having also another workbook with a sub called &quot;test&quot;. Thanks again for your effort!"}], "tags": [], "owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1470255807, "creation_date": 1470255807, "answer_id": 38752971, "question_id": 38752517, "link": "https://stackoverflow.com/questions/38752517/add-in-not-working-from-custom-ui/38752971#38752971", "title": "add-in not working from custom UI", "body": "<p>Add ' control As IRibbonControl ' as argument to your subroutine.</p>\n\n<p>For example if the name of your subroutine is ' test ', then</p>\n\n<pre><code>Sub test(control As IRibbonControl)\n    'your code goes here\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1470260177, "last_edit_date": 1495542783, "creation_date": 1470260177, "answer_id": 38754036, "question_id": 38752517, "link": "https://stackoverflow.com/questions/38752517/add-in-not-working-from-custom-ui/38754036#38754036", "title": "add-in not working from custom UI", "body": "<p>Once you have incorporated <code>Public Sub test(control As IRibbonControl)</code> as suggetsed <a href=\"https://stackoverflow.com/questions/8850836/how-to-add-a-custom-ribbon-tab-using-vba/8852767#8852767\">Here</a> and if you are still getting the error then I believe that there is some other code in one of the open Workbooks/Add-In which is interfering with this code.</p>\n\n<ol>\n<li>Close all other open workbooks</li>\n<li>Check for any other installed Add-Ins.</li>\n</ol>\n"}], "owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 38754036, "answer_count": 2, "score": 2, "last_activity_date": 1470260177, "creation_date": 1470254144, "last_edit_date": 1531164843, "question_id": 38752517, "link": "https://stackoverflow.com/questions/38752517/add-in-not-working-from-custom-ui", "title": "add-in not working from custom UI", "body": "<p>I'm trying to create my first add-in with Custom UI based on this <a href=\"https://msdn.microsoft.com/en-us/library/office/gg597509(v=office.14).aspx\" rel=\"nofollow noreferrer\">guidance</a>. (As I don't have Visual Studio I'm working with VBA; Excel 2013 in Windows 7)</p>\n\n<p>For testing I've just created one sub in a module:</p>\n\n<pre><code>Sub test()\n    MsgBox \"test\"\nEnd Sub\n</code></pre>\n\n<p>As described in the guidance, I've created CustomUI folder with CustomUI.xml in it. CustomUI.xml's content: </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\"&gt;\n  &lt;ribbon&gt;\n    &lt;tabs&gt;\n      &lt;tab id=\"TestTab\" label=\"Test tab\" &gt;\n        &lt;group id=\"TestGroup\" label=\"Test group\" &gt;\n          &lt;button id=\"test\" visible=\"true\" size=\"large\" \n                  label=\"Test Sub\" \n                  onAction=\"test\" /&gt;\n        &lt;/group&gt;\n      &lt;/tab&gt;\n    &lt;/tabs&gt;\n  &lt;/ribbon&gt;\n&lt;/customUI&gt;\n</code></pre>\n\n<p>Also added<br>\n<code>https://msdn.microsoft.com/en-us/library/office/gg597509(v=office.14).aspx</code><br>\nto .rels as described.</p>\n\n<p>Now I've the add-in loading correctly, the only issue that clicking on the newly created ribbon item I'm keep getting below error message (of course the macro works correctly when I start it from VBA editor):<br>\n<a href=\"https://i.stack.imgur.com/8Dmlx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8Dmlx.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I'm doing wrong?</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1470252561, "post_id": 38752075, "comment_id": 64878126, "body": "Can you post a screenshot of the data validation list? You don&#39;t give enough information to set up a pattern."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470253665, "post_id": 38752075, "comment_id": 64878731, "body": "How is your data validation created? <code>=NamedRange</code> or <code>aaa,bbb,ccc,ddd</code> or something like <code>=$O$17:$O$18</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6673968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6485893971630c6c653b27120d89a91b?s=128&d=identicon&r=PG&f=1", "display_name": "S Chamberlain", "link": "https://stackoverflow.com/users/6673968/s-chamberlain"}, "edited": false, "score": 0, "creation_date": 1470323265, "post_id": 38752567, "comment_id": 64913544, "body": "The data validation is just set through the Data Validation button on the Data Tab, I have it =Sheet1!$C$2:$C$259  How would I input this code next to my email code? For example, I want to click the command button, and have it email the first person, and then go to the next person on the validation list and then email that person, and so on and so on until the list runs through it&#39;s course. I input the code above after my &quot;End Sub&quot; for my email code, but it is giving me an error. Can you please help with that? (I am new at VBA)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1470254347, "creation_date": 1470254347, "answer_id": 38752567, "question_id": 38752075, "link": "https://stackoverflow.com/questions/38752075/create-loop-to-go-down-cell-then-repeat-macro-code/38752567#38752567", "title": "Create loop to go down cell then repeat macro code", "body": "<p>I quickly wrote an example to show how to loop through the Data Validation List.</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim acell As Range, DataValCell As Range, tmpRng As Range\n    Dim s As String\n    Dim MyAr As Variant\n    Dim i As Long\n\n    Set ws = Sheet1 '&lt;~~&gt; Change this to the relevant sheet\n\n    With ws\n        Set DataValCell = .Range(\"B2\")\n\n        '~~&gt; Handles =NamedRange or =$O$17:$O$18\n        If Left(DataValCell.Validation.Formula1, 1) = \"=\" Then\n            s = Mid(DataValCell.Validation.Formula1, 2)\n            Set tmpRng = .Range(s)\n        Else '~~&gt; Handles aaa,bbb,ccc,ddd\n            s = DataValCell.Validation.Formula1\n        End If\n\n        If Not tmpRng Is Nothing Then '~~&gt; Handles =NamedRange or =$O$17:$O$18\n            For Each acell In tmpRng.Cells\n                Debug.Print acell.Value\n                '~~&gt; this is where you loop through the DV List\n            Next\n        Else '~~&gt; Handles aaa,bbb,ccc,ddd\n            MyAr = Split(s, \",\")\n\n            For i = LBound(MyAr) To UBound(MyAr)\n                Debug.Print MyAr(i)\n                '~~&gt; this is where you loop through the DV List\n            Next i\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6673968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6485893971630c6c653b27120d89a91b?s=128&d=identicon&r=PG&f=1", "display_name": "S Chamberlain", "link": "https://stackoverflow.com/users/6673968/s-chamberlain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470254347, "creation_date": 1470252371, "last_edit_date": 1470253531, "question_id": 38752075, "link": "https://stackoverflow.com/questions/38752075/create-loop-to-go-down-cell-then-repeat-macro-code", "title": "Create loop to go down cell then repeat macro code", "body": "<p>I currently have a code that Saves the excel sheet in a PDF based on infomation specific to the text in cell B2, and then attach the PDF into an email and email out to the specific user. </p>\n\n<p>I am unsure how to add a macro to the current code to have the cell in B2 go down the data validation list inbetted and then repeat the macro to send the next person the email specific to them. </p>\n\n<p>This is the current code that I have to save pdf and then email:</p>\n\n<pre><code> Sub AttachActiveSheetPDF()\n Dim IsCreated As Boolean\n Dim i As Long\n Dim PdfFile As String, Title As String\n Dim OutlApp As Object\n\n\n Title = Range(\"A1\")\n\n PdfFile = ActiveWorkbook.FullName\n i = InStrRev(PdfFile, \".\")\n If i &gt; 1 Then PdfFile = Left(PdfFile, i - 1)\n PdfFile = Range(\"G5\") &amp; \"_\" &amp; ActiveSheet.Name &amp; \".pdf\"\n\n With ActiveSheet\n .ExportAsFixedFormat Type:=xlTypePDF, Filename:=PdfFile, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n End With\n\n On Error Resume Next\n Set OutlApp = GetObject(, \"Outlook.Application\")\n If Err Then\n Set OutlApp = CreateObject(\"Outlook.Application\")\n IsCreated = True\n End If\n OutlApp.Visible = True\n On Error GoTo 0\n\n With OutlApp.CreateItem(0)\n\n .Subject = Title\n .To = Range(\"B4\")\n .CC = Range(\"G3\")\n .Body = \"Hello \" &amp; Range(\"G5\") &amp; \",\" &amp; vbLf &amp; vbLf _\n &amp; \"Your Summary is attached. If you have any further questions about your selections, please call 1-800-XXX-XXXX.\" &amp; vbLf &amp; vbLf _\n &amp; \"Best Regards,\" &amp; vbLf _\n &amp; Application.UserName &amp; vbLf _\n &amp; \"Implementation Specialist\" &amp; vbLf &amp; vbLf\n .Attachments.Add PdfFile\n\n On Error Resume Next\n .Send\n Application.Visible = True\n If Err Then\n MsgBox \"E-mail was not sent\", vbExclamation\n Else\n MsgBox \"E-mail successfully sent\", vbInformation\n End If\n On Error GoTo 0\n\n End With\n\n ' Delete PDF file\n Kill PdfFile\n\n ' Quit Outlook if it was created by this code\n If IsCreated Then OutlApp.Quit\n\n ' Release the memory of object variable\n Set OutlApp = Nothing\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470251688, "post_id": 38751817, "comment_id": 64877585, "body": "See <a href=\"http://stackoverflow.com/a/38724667/4088852\">this answer</a>. Just change the locale (unless you need it in Polish)."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470252028, "post_id": 38751817, "comment_id": 64877790, "body": "...and <a href=\"http://stackoverflow.com/a/36706171/4088852\">this answer</a> is the method to get the system list separator via the Windows API."}, {"owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "edited": false, "score": 0, "creation_date": 1470253446, "post_id": 38751817, "comment_id": 64878636, "body": "Why in the world do you replace a dot with a list separator before calling CDbl on the value?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470254621, "post_id": 38751817, "comment_id": 64879219, "body": "@Comintern: Thanks :)"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1470265490, "post_id": 38751817, "comment_id": 64883787, "body": "What is the error the code throws up? A very important tidbit to include."}, {"owner": {"reputation": 76, "user_id": 2993190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IGBU.jpg?s=128&g=1", "display_name": "DaveMac", "link": "https://stackoverflow.com/users/2993190/davemac"}, "edited": false, "score": 0, "creation_date": 1470296619, "post_id": 38751817, "comment_id": 64894561, "body": "It just bring back the delimiter for a local list.  Just change <code>Application.International(xlListSeparator)</code> to a separator of your choice. e.g. <code>&quot;,&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8203278, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3dd0abd90d539d46bc3c3008ca4a08ef?s=128&d=identicon&r=PG", "display_name": "Aqif Mukhtar", "link": "https://stackoverflow.com/users/8203278/aqif-mukhtar"}, "is_accepted": false, "score": 0, "last_activity_date": 1498205646, "last_edit_date": 1498205646, "creation_date": 1498194411, "answer_id": 44713439, "question_id": 38751817, "link": "https://stackoverflow.com/questions/38751817/ms-access-equivalent-to-application-internationalxllistseparator/44713439#44713439", "title": "MS Access equivalent to Application.International(xlListSeparator)?", "body": "<p>If you ignore <code>Application.International(xlListSeparator)</code> bit and just use:</p>\n\n<pre><code>tmpVal = matches (0).SubMatches (0)\n</code></pre>\n\n<p>It does the trick for me in MS Access.</p>\n"}], "owner": {"reputation": 11, "user_id": 6662933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdad61325fa0573fbc426b2096539b8d?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/6662933/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 726, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527075282, "creation_date": 1470251363, "question_id": 38751817, "link": "https://stackoverflow.com/questions/38751817/ms-access-equivalent-to-application-internationalxllistseparator", "title": "MS Access equivalent to Application.International(xlListSeparator)?", "body": "<p>I found the following code at <a href=\"http://analystcave.com/excel-calculate-distances-between-addresses/#Calculate_distance_between_two_addresses_using_Google_Maps_in_Excel\" rel=\"nofollow\">http://analystcave.com/excel-calculate-distances-between-addresses/#Calculate_distance_between_two_addresses_using_Google_Maps_in_Excel</a></p>\n\n<p>But want to use it in my Access DB to take the values from 2 text boxes on a form and then calculate the distance and return the distance in meters into a third textbox on the form when a command button is clicked. When I use the code, it throws up an error for the part of the code that uses the fn Application.International(xlListSeparator). How can I get this to work in Access?</p>\n\n<pre><code>'Calculate Google Maps distance between two addresses\nPublic Function GetDistance(start As String, dest As String)\n    Dim firstVal As String, secondVal As String, lastVal As String\n    firstVal = \"http://maps.googleapis.com/maps/api/distancematrix/json?origins=\"\n    secondVal = \"&amp;destinations=\"\n    lastVal = \"&amp;mode=car&amp;language=pl&amp;sensor=false\"\n    Set objHTTP = CreateObject(\"MSXML2.ServerXMLHTTP\")\n    URL = firstVal &amp; Replace(start, \" \", \"+\") &amp; secondVal &amp; Replace(dest, \" \", \"+\") &amp; lastVal\n    objHTTP.Open \"GET\", URL, False\n    objHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\n    objHTTP.send (\"\")\n    If InStr(objHTTP.responseText, \"\"\"distance\"\" : {\") = 0 Then GoTo ErrorHandl\n    Set regex = CreateObject(\"VBScript.RegExp\"): regex.Pattern = \"\"\"value\"\".*?([0-9]+)\": regex.Global = False\n    Set matches = regex.Execute(objHTTP.responseText)\n    tmpVal = Replace(matches(0).SubMatches(0), \".\", Application.International(xlListSeparator))\n    GetDistance = CDbl(tmpVal)\n    Exit Function\nErrorHandl:\n    GetDistance = -1\nEnd Function\n</code></pre>\n"}, {"tags": ["datetime", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1470253164, "post_id": 38751429, "comment_id": 64878475, "body": "This kind of self answered questions would be better suited for <a href=\"http://stackoverflow.com/documentation/vba/topics\">documentation</a>"}, {"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 1, "creation_date": 1470301337, "post_id": 38751429, "comment_id": 64897578, "body": "I hoped this would help users searching for answers (As I was). But it seems SO users did not like it."}, {"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1470301353, "post_id": 38751429, "comment_id": 64897588, "body": "@litelite, Documentation is still in Beta."}, {"owner": {"reputation": 379, "user_id": 4228193, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/5nPj1.jpg?s=128&g=1", "display_name": "mpag", "link": "https://stackoverflow.com/users/4228193/mpag"}, "edited": false, "score": 1, "creation_date": 1545160066, "post_id": 38751429, "comment_id": 94527350, "body": "(and now cancelled, I believe)"}], "answers": [{"comments": [{"owner": {"reputation": 1180, "user_id": 571213, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b8c46e659e7edafb2a646b196a1218c6?s=128&d=identicon&r=PG", "display_name": "paulroho", "link": "https://stackoverflow.com/users/571213/paulroho"}, "edited": false, "score": 3, "creation_date": 1511399442, "post_id": 38751430, "comment_id": 81847606, "body": "Note that this code does not consider the <code>TZD</code> (time zone designator) as in <code>2017-11-13T21:42:30.000+03:00</code> (the <code>+03:00</code>). Refer to <a href=\"https://www.w3.org/TR/NOTE-datetime\" rel=\"nofollow noreferrer\">w3.org/TR/NOTE-datetime</a>."}, {"owner": {"reputation": 379, "user_id": 4228193, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/5nPj1.jpg?s=128&g=1", "display_name": "mpag", "link": "https://stackoverflow.com/users/4228193/mpag"}, "edited": false, "score": 0, "creation_date": 1545160481, "post_id": 38751430, "comment_id": 94527528, "body": "I would like this to be recognized at time-of-import from a csv or Excel file. Is there a way to hook a similar (TZD-aware or &quot;Z&quot; specific) string as a recognized DateTime format string? Or to auto-convert the field from &quot;Short Text&quot;?"}], "tags": [], "owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "is_accepted": true, "score": 5, "last_activity_date": 1470250046, "creation_date": 1470250046, "answer_id": 38751430, "question_id": 38751429, "link": "https://stackoverflow.com/questions/38751429/using-iso-8601-dates-in-ms-access/38751430#38751430", "title": "Using ISO 8601 dates in MS Access", "body": "<p>Create a module and paste the below code. These functions then can be called in any of the Forms / Modules</p>\n\n<pre><code>'ISO to Access\nPublic Function DtIsoToAccess(myisodate as String) as date\nDtIsotoaccess=cdate(Replace(myisodate, \"T\",\" \"))\nEnd function\n\n'Access to ISO\nPublic Function DtAccessToIso(myaccdate as Date) as string\nDtAccessToIso= format(myaccdate, \"yyyy-mm-dd\\Thh:nn:ss\")\nEnd function\n</code></pre>\n"}], "owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3166, "favorite_count": 0, "accepted_answer_id": 38751430, "answer_count": 1, "score": 2, "last_activity_date": 1594641604, "creation_date": 1470250046, "last_edit_date": 1594641604, "question_id": 38751429, "link": "https://stackoverflow.com/questions/38751429/using-iso-8601-dates-in-ms-access", "title": "Using ISO 8601 dates in MS Access", "body": "<blockquote>\n  <p>Q1</p>\n</blockquote>\n\n<p>Is there a method to handle ISO 8601 dates in MS Access.  I need to be able to use the date:\n2010-05-31T06:00:00 in VBA code.  Also I need to be able to take 5/31/10 6:00am and put in the other format</p>\n\n<blockquote>\n  <p>Q2</p>\n</blockquote>\n\n<p>I am saving date &amp; Time in <code>NoSQL</code> database (eg Firebase) and  also will be retrieving data and time stamp. Hence need a function which convert back and forth between Access data &amp; time data type and ISO 8601 dates.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 836, "user_id": 6419727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f5532e6c9f3d91e56fdffd792dcf9?s=128&d=identicon&r=PG&f=1", "display_name": "random_answer_guy", "link": "https://stackoverflow.com/users/6419727/random-answer-guy"}, "edited": false, "score": 0, "creation_date": 1470250286, "post_id": 38751393, "comment_id": 64876822, "body": "<code>I&#39;ve tried where arguments on the open form cmd, but that doesn&#39;t apply for new records.</code> Did you save the <code>Contract Form</code> first?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470250994, "post_id": 38751393, "comment_id": 64877217, "body": "This is not true: &quot;...arguments on the open form cmd, but that doesn&#39;t apply for new records.&quot;"}, {"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1470256881, "post_id": 38751393, "comment_id": 64880332, "body": "personally, I would leave the key fields on your parent form and exclude them from the child (activity) subform, as you don&#39;t want them modified."}, {"owner": {"reputation": 43, "user_id": 6540449, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154955564439112/picture?type=large", "display_name": "Olivia Rose", "link": "https://stackoverflow.com/users/6540449/olivia-rose"}, "reply_to_user": {"reputation": 836, "user_id": 6419727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f5532e6c9f3d91e56fdffd792dcf9?s=128&d=identicon&r=PG&f=1", "display_name": "random_answer_guy", "link": "https://stackoverflow.com/users/6419727/random-answer-guy"}, "edited": false, "score": 0, "creation_date": 1470336732, "post_id": 38751393, "comment_id": 64921909, "body": "@random_answer_guy Yeah, I imagine this kind of code will have to be in the after update section"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 6540449, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154955564439112/picture?type=large", "display_name": "Olivia Rose", "link": "https://stackoverflow.com/users/6540449/olivia-rose"}, "is_accepted": true, "score": 0, "last_activity_date": 1470405911, "creation_date": 1470405911, "answer_id": 38791216, "question_id": 38751393, "link": "https://stackoverflow.com/questions/38751393/ms-access-2010-how-to-open-to-a-new-form-with-fields-pre-populated-based-on-a-d/38791216#38791216", "title": "MS Access 2010, How to open to a new form with fields pre-populated based on a different form", "body": "<p>I found this tutorial:\n<a href=\"https://www.youtube.com/watch?v=CxuIS2JuH4k\" rel=\"nofollow\">https://www.youtube.com/watch?v=CxuIS2JuH4k</a></p>\n\n<p>Granted this uses Macros, but it works. It is easy with a command button as opposed to an after update event. I have found this to be preferable anyways since otherwise I risk created a lot of duplicate data. </p>\n\n<p>Best,</p>\n"}], "owner": {"reputation": 43, "user_id": 6540449, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154955564439112/picture?type=large", "display_name": "Olivia Rose", "link": "https://stackoverflow.com/users/6540449/olivia-rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 38791216, "answer_count": 1, "score": 0, "last_activity_date": 1470405911, "creation_date": 1470249888, "last_edit_date": 1495541288, "question_id": 38751393, "link": "https://stackoverflow.com/questions/38751393/ms-access-2010-how-to-open-to-a-new-form-with-fields-pre-populated-based-on-a-d", "title": "MS Access 2010, How to open to a new form with fields pre-populated based on a different form", "body": "<p>I have two linked tables with their corresponding forms: contracts and activities. A given contract can have several activities. I would like to have a function that allows me to open the activities form to a new record from the contract form such that the contract number AND output number is pre-populated. </p>\n\n<p>I've tried where arguments on the open form cmd, but that doesn't apply for new records. </p>\n\n<p>I tried to follow this thread </p>\n\n<p>\"<a href=\"https://stackoverflow.com/questions/35557746/access-2010-form-new-record-pre-filled-button\">access 2010 form new record pre filled button</a>\"</p>\n\n<p>but I'm new to access and didn't understand the code. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["arrays", "string", "vba", "find", "move"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6553916, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-SXwrH9BdN1E/AAAAAAAAAAI/AAAAAAAAABY/Bi1KuBFrXCw/photo.jpg?sz=128", "display_name": "andrew", "link": "https://stackoverflow.com/users/6553916/andrew"}, "edited": false, "score": 0, "creation_date": 1470433087, "post_id": 38751551, "comment_id": 64966561, "body": "Hey thanks for the help. Im new to vba so my coding may not be typical. But i&#39;ll explain my thought process. The offset doesn&#39;t need two values, if only one is entered it assumes you want to offset by row. And my rows.count is referencing the last column, that is because my actual last cell changes so i can&#39;t say a1:a2, so im using xlUP to go up from the bottom row to find my last cell.  But i figured it out, i needed to use a Boolean variable to return a true or false. So i set it to put it in sheet1. if true leave it, and check remaining values. If false copy to sheet2 and delete from sh1"}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 0, "last_activity_date": 1470250413, "creation_date": 1470250413, "answer_id": 38751551, "question_id": 38751218, "link": "https://stackoverflow.com/questions/38751218/if-all-columns-say-complete-move-to-sheet2-else-move-to-sheet3/38751551#38751551", "title": "If all columns say &quot;Complete&quot; move to sheet2 else move to sheet3", "body": "<p>There are some suggestions below, but some of your code is unclear, like offset needs 2 values .offset(1,0).  You also use Rows.count- which rows are you applying that too?  all in the worksheet?  you need to use Range(\"A1:A2\").Rows.Count for example. </p>\n\n<p>Ive corrected your dimensioning, and changed a range/cells reference that was confused, but you need to make this into something more understandable before it can be properly corrected.</p>\n\n<p>see here for a good starting point with cell references</p>\n\n<p><strong><a href=\"http://www.excel-easy.com/vba/examples/formulaR1C1.html\" rel=\"nofollow\">http://www.excel-easy.com/vba/examples/formulaR1C1.html</a></strong></p>\n\n<pre><code>Sub test()\n\nDim P as long, lastrow4 as long\nlastrow4 = Sheets(\"Sheet1\").Range(\"a\" &amp; Rows.Count).End(xlUp).Row\nFor P = 1 To lastrow4\n'****if complete****\n'if row one is complete and row 2 is blank place in sheet 2\n\nIf Sheets(\"sheet1\").Cells(P, 1).Value = \"COMPLETE   \" And Sheets(\"sheet1\").Cells(P + 1, 1).Value = \"\" Then\n    Sheets(\"Sheet1\").Cells(P, 1).EntireRow.Copy Destination:=Sheets(\"sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\nEnd If\n\n\n'****/if not complete*********************\n'if row 1 isn't complete and is not blank put in sheet 5\n\n\nIf Sheets(\"sheet1\").Cells(P, \"J\").Value &lt;&gt; \"COMPLETE   \" And Sheets(\"sheet1\").Cells(P, \"J\").Value &lt;&gt; \"\" Then\n    Sheets(\"Sheet1\").Cells(P, \"J\").EntireRow.Copy Destination:=Sheets(\"sheet3\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\nEnd If\nNext P\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 6553916, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-SXwrH9BdN1E/AAAAAAAAAAI/AAAAAAAAABY/Bi1KuBFrXCw/photo.jpg?sz=128", "display_name": "andrew", "link": "https://stackoverflow.com/users/6553916/andrew"}, "is_accepted": false, "score": 0, "last_activity_date": 1507281340, "last_edit_date": 1507281340, "creation_date": 1470433275, "answer_id": 38798122, "question_id": 38751218, "link": "https://stackoverflow.com/questions/38751218/if-all-columns-say-complete-move-to-sheet2-else-move-to-sheet3/38798122#38798122", "title": "If all columns say &quot;Complete&quot; move to sheet2 else move to sheet3", "body": "<p>I wasn't actually dealing w/ sheet 1 &amp; 2 I just changed that for help. This works for row 15 down from sheet 2, and moved to sheet 4 if true sheet 5 is false</p>\n\n<pre><code>Dim P, lastrow4\nP = 15\nlastrow4 = Sheets(\"Sheet2\").Range(\"J\" &amp; Rows.Count).End(xlUp).Row\nDim check As Boolean\n\nSheets(\"Sheet2\").Cells(lastrow4, \"J\").EntireRow.Copy Destination:=Sheets(\"sheet4\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n                For P = 15 To lastrow4\n                    check = Sheets(\"sheet2\").Range(\"J\" &amp; P) = \"COMPLETE   \"\n                    If check = False Then\n                        Sheets(\"Sheet2\").Cells(P, \"J\").EntireRow.Copy Destination:=Sheets(\"sheet5\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n                        Sheets(\"sheet4\").Range(\"A\" &amp; Rows.Count).End(xlUp).EntireRow.Delete\n                    End If\n\n                Next P\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6553916, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-SXwrH9BdN1E/AAAAAAAAAAI/AAAAAAAAABY/Bi1KuBFrXCw/photo.jpg?sz=128", "display_name": "andrew", "link": "https://stackoverflow.com/users/6553916/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507295492, "creation_date": 1470249246, "last_edit_date": 1507295492, "question_id": 38751218, "link": "https://stackoverflow.com/questions/38751218/if-all-columns-say-complete-move-to-sheet2-else-move-to-sheet3", "title": "If all columns say &quot;Complete&quot; move to sheet2 else move to sheet3", "body": "<p>I need help with my code. The logic is: if they all say \"complete\" then copy the first line of code to sheet 2. If one says something besides \"complete\" copy it to sheet 3. It may have more than one line that says something beside \"complete\". I have a web_scraper flashing this area with data and I need to sort it. The IMAGE included is basically what the data will look like. Also the complete has (3) spaces after it, so I've included it in my code. </p>\n\n<p><a href=\"https://i.stack.imgur.com/gdGTj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gdGTj.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>    Sub test()\n\nDim P, lastrow4\nlastrow4 = Sheets(\"Sheet1\").Range(\"a\" &amp; Rows.Count).End(xlUp).Row\nFor P = 1 To lastrow4\n\n'****if complete****\n'if row one is complete and row 2 is blank place in sheet 2\n\n\nIf Sheets(\"sheet1\").Cells(P, \"A\").Value = \"COMPLETE   \" And Sheets(\"sheet1\").Cells(P + 1, \"A\").Value = \"\" Then\nSheets(\"Sheet1\").Cells(P, \"A\").EntireRow.Copy Destination:=Sheets(\"sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\nEnd If\n\n\n****/if not complete*********************\n\n'if row 1 isn't complete and is not blank put in sheet 5\n\n\nIf Sheets(\"sheet1\").Cells(P, \"J\").Value &lt;&gt; \"COMPLETE   \" And Sheets(\"sheet1\").Cells(P, \"J\").Value &lt;&gt; \"\" Then\n\nSheets(\"Sheet1\").Cells(P, \"J\").EntireRow.Copy Destination:=Sheets(\"sheet3\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n\nEnd If\n\nNext P\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1470248824, "post_id": 38751008, "comment_id": 64875943, "body": "open task manager and make sure no other instances of Excel are open.  Then clean out your temp directory."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1470248828, "post_id": 38751008, "comment_id": 64875947, "body": "So, the filename, when opened, becomes &quot;DTS_Data_Files.xls (1)&quot; or &quot;DTS_Data_Files1.xls&quot;? (Or some other way?)  Sounds like it&#39;s a second instance of that workbook.  What happens if you restart your computer, and run the code first thing?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470255209, "post_id": 38751008, "comment_id": 64879526, "body": "FYI - <code>Looking at the &#39;Type&#39; column in the Explorer window, it shows that the target file is &#39;Microsoft Excel 97-2003 Worksheet&#39;</code> - Explorer shows the &quot;Type&quot; based solely on the file extension, not on what the file actually is.  To see that, create a text file with a .txt extension, then use Explorer to rename it to have a .xls extension.  It will then display it as a &quot;Microsoft Excel 97-2003 Worksheet&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6673504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd2234617b10d053e7885a3b3d43da06?s=128&d=identicon&r=PG&f=1", "display_name": "Garbunkel", "link": "https://stackoverflow.com/users/6673504/garbunkel"}, "edited": false, "score": 0, "creation_date": 1470339320, "post_id": 38754245, "comment_id": 64923354, "body": "Thank you!  That was exactly the issue.  I found that when I opened &amp; performed a &#39;Save As&#39;, .xlt was listed as the default file type in the &#39;Save As Type&#39;. As soon as I saved it as an .xls file, closed it &amp; re-ran the script, this time it opened it with the correct filename.  Kudos!!"}], "tags": [], "owner": {"reputation": 191, "user_id": 5149107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbf2d7652f551f5c58c3005cb880f39f?s=128&d=identicon&r=PG&f=1", "display_name": "hughg", "link": "https://stackoverflow.com/users/5149107/hughg"}, "is_accepted": false, "score": 1, "last_activity_date": 1470261132, "creation_date": 1470261132, "answer_id": 38754245, "question_id": 38751008, "link": "https://stackoverflow.com/questions/38751008/excel-2013-vba-workbooks-open-opens-with-wrong-filename/38754245#38754245", "title": "Excel 2013 VBA Workbooks.Open opens with wrong filename", "body": "<p>This can happen if the target workbook was originally saved as a template (.xlt) file and then the extension manually changed (to .xls) in Windows Explorer. You can open the target workbook and do a 'save as...' to .xls file format.</p>\n"}], "owner": {"reputation": 21, "user_id": 6673504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd2234617b10d053e7885a3b3d43da06?s=128&d=identicon&r=PG&f=1", "display_name": "Garbunkel", "link": "https://stackoverflow.com/users/6673504/garbunkel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1470261132, "creation_date": 1470248520, "last_edit_date": 1470248716, "question_id": 38751008, "link": "https://stackoverflow.com/questions/38751008/excel-2013-vba-workbooks-open-opens-with-wrong-filename", "title": "Excel 2013 VBA Workbooks.Open opens with wrong filename", "body": "<p>When I attempt to open a certain target .xls file using the Workbooks.Open command in an Excel VBA macro, the target Excel file opens with a \"1\" appended to the end of the file name.  This altered filename shows up in the file window ().  With each subsequent attempt (manually closing the target Excel file &amp; re-running the script) the appended number at the end of the target filename increments by one.  </p>\n\n<p>The target Excel file itself does not appear to be corrupted, as I am able to open the file manually in windows explorer without any issue.  Also, when I do open it this way, the filename shows up correctly (without the '1' appended to the end).  Looking at the 'Type' column in the Explorer window, it shows that the target file is 'Microsoft Excel 97-2003 Worksheet', so the file extension does match with the actual file format.</p>\n\n<p>Below is the code that I am using:</p>\n\n<pre><code>Public Sub Import_TD_TVs()\n\n     Dim ActiveWB As Workbook\n     Dim srcTDWB As Workbook\n\n     Dim wkbkStr As String\n\n\n          Set ActiveWB = ActiveWorkbook\n\n          wkbkStr = \"X:\\sites\\DTS_Data_Files.xls\"\n\n          Set srcTDWB = Workbooks.Open(wkbkStr, , False)\n\nEnd Sub\n</code></pre>\n\n<p>Any assistance on this issue would be greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470248279, "post_id": 38750813, "comment_id": 64875624, "body": "<code>ws.Range(&quot;C9:G20&quot;)</code> returns a <code>Variant</code> containing an array. You can&#39;t compare that to a <code>String</code>."}], "answers": [{"tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 1, "last_activity_date": 1470248256, "creation_date": 1470248256, "answer_id": 38750948, "question_id": 38750813, "link": "https://stackoverflow.com/questions/38750813/type-mismatch-error-vba-loop-through-worksheets/38750948#38750948", "title": "Type mismatch error VBA loop through worksheets", "body": "<p>You can't get the <code>value</code> of <code>ws.Range(\"C9:G20\")</code> and compare it to one string. You've selected multiple cells. If you want to return <code>True</code> when nay one of these cells contains \"Word\" or when all of them contain \"Word\" you'll need to iterate over them. </p>\n\n<p>This is an example of how to return whether or not your range contains \"Word\" anywhere at least once</p>\n\n<pre><code>Function CheckWord()\n    Dim arrVar As Variant\n    Dim ws As Worksheet\n\n    Set arrVar = ActiveWorkbook.Worksheets\n\n    For Each ws In arrVar\n       Dim c\n       For Each c In ws.Range(\"C9:G20\").Cells\n            If c = \"Word\" Then\n                CheckWord = True\n                Exit Function\n            End If\n       Next c\n    Next ws\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 1, "creation_date": 1470248556, "post_id": 38750964, "comment_id": 64875794, "body": "You can&#39;t iterate over the values and then call .value on the value. You&#39;ll need to remove one of them"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1470248773, "post_id": 38750964, "comment_id": 64875917, "body": "Good call @Brad it&#39;s the Cells collection, not the Value property."}], "tags": [], "owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "is_accepted": true, "score": 1, "last_activity_date": 1470248650, "last_edit_date": 1470248650, "creation_date": 1470248357, "answer_id": 38750964, "question_id": 38750813, "link": "https://stackoverflow.com/questions/38750813/type-mismatch-error-vba-loop-through-worksheets/38750964#38750964", "title": "Type mismatch error VBA loop through worksheets", "body": "<p>When you have a <code>range</code> with many columns, it creates an array.\nTaking the array into consideration like so:</p>\n\n<pre><code>Sub CheckWord()\n\n\nDim arrVar As Variant\nDim ws As Worksheet\nDim strCheck As Range\n\nSet arrVar = ActiveWorkbook.Worksheets\n'MsgBox (arrVar)\n\nFor Each ws In arrVar\n   For each col in ws.Range(\"C9:G20\").Cells\n      if col.Value = \"Word\" Then\n         MsgBox (True)\n      end if\n   End If\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1470724038, "post_id": 38754844, "comment_id": 65052048, "body": "@OluO.: did you get through it?"}, {"owner": {"reputation": 17, "user_id": 6664379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4ee5aad77015043469264585362fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Olu O.", "link": "https://stackoverflow.com/users/6664379/olu-o"}, "edited": false, "score": 0, "creation_date": 1470944768, "post_id": 38754844, "comment_id": 65168407, "body": "Yeah I did, once I saw the explanation ti all made sense. Thanks!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 17, "user_id": 6664379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4ee5aad77015043469264585362fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Olu O.", "link": "https://stackoverflow.com/users/6664379/olu-o"}, "edited": false, "score": 0, "creation_date": 1470976035, "post_id": 38754844, "comment_id": 65177626, "body": "You sre welcome. Then mark the answer you adopted as solution"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 17, "user_id": 6664379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4ee5aad77015043469264585362fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Olu O.", "link": "https://stackoverflow.com/users/6664379/olu-o"}, "edited": false, "score": 0, "creation_date": 1471940120, "post_id": 38754844, "comment_id": 65538499, "body": "@Oluo.: it&#39;d be nice of you to give proper feedbakcs to people helping you"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1470264306, "creation_date": 1470264306, "answer_id": 38754844, "question_id": 38750813, "link": "https://stackoverflow.com/questions/38750813/type-mismatch-error-vba-loop-through-worksheets/38754844#38754844", "title": "Type mismatch error VBA loop through worksheets", "body": "<pre><code>Sub CheckWord()\n    Dim ws As Worksheet\n\n    For Each ws In ActiveWorkbook.Worksheets\n        If Not ws.Range(\"C9:G20\").Find(What:=\"Word\", LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False) Is Nothing Then MsgBox \"Found in \" &amp; ws.Name\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6664379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4ee5aad77015043469264585362fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Olu O.", "link": "https://stackoverflow.com/users/6664379/olu-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1401, "favorite_count": 1, "accepted_answer_id": 38750964, "answer_count": 3, "score": 0, "last_activity_date": 1470264306, "creation_date": 1470247737, "question_id": 38750813, "link": "https://stackoverflow.com/questions/38750813/type-mismatch-error-vba-loop-through-worksheets", "title": "Type mismatch error VBA loop through worksheets", "body": "<p>I keep getting a type mismatch error and have tried changing the type a few times. I'm just trying to loop through each worksheet and a specified range to see if that word exists in every cell of that range. </p>\n\n<pre><code>Sub CheckWord()\n\n\nDim arrVar As Variant\nDim ws As Worksheet\nDim strCheck As Range\n\nSet arrVar = ActiveWorkbook.Worksheets\n'MsgBox (arrVar)\n\nFor Each ws In arrVar\n   If ws.Range(\"C9:G20\").Value = \"Word\" Then\n    MsgBox (True)\n   End If\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1470249594, "post_id": 38750798, "comment_id": 64876422, "body": "It depends on what kind of combo boxes you are using: if you are using form controls then there is no change event for this control and you&#39;ll have to keep track of the current value for the combo box somewhere in your file. If you are using ActiveX controls then there is an event handler called <code>Private Sub ComboBox1_Change()</code> (if the name of your combo box is <code>ComboBox1</code>)."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470252176, "post_id": 38750798, "comment_id": 64877884, "body": "@Comintern as mentioned above, you comment applies only if the OP uses ActiveX components. Otherwise, your approach is not feasible."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1470252851, "post_id": 38750798, "comment_id": 64878285, "body": "@Comintern yes, you can assign a macro to a from control combo box. Yet, there is only the <code>click</code> event for form controls. There is <b>not</b> a change event handler for form controls (as your comment seems to indicate with <code>DropDown1_Change</code>). The click event occurs <b>each</b> time the drop down box is clicked (whether the value is changed or not does not matter). That&#39;s not what the OP wants. Hence, your solution works only for ActiveX controls (as written above). Maybe you should try that yourself?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1470253482, "post_id": 38750798, "comment_id": 64878656, "body": "I have done it multiple times and now again (just because you insisted so much). The click event for form control combo boxes occurs each time the box is clicked and is <b>not</b> a direct indication that the value of the combo box has actually changed (Excel 2016 64-bit). Furthermore, if the combo box is linked to a cell and the combo box value is changed via the linked cell then this change is not captured via the macro neither (yet a WorkSheet_Change event handler could capture this). Only with ActiveX combo boxes and the underlying <code>_Change</code> event handler such changes are captured."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1470257278, "post_id": 38750798, "comment_id": 64880532, "body": "@Comintern:  I did say that I verified what I said. So, please refrain from comments such as &quot;my assertions&quot;. That&#39;s just rude. Also, instead of posting non-constructive comments such as &quot;simply wrong&quot; it would be beneficial to provide any kind of support. Here is a screencast to support my comments: <a href=\"http://www.directupload.net/file/d/4436/8qjkxxbt_gif.htm\" rel=\"nofollow noreferrer\">directupload.net/file/d/4436/8qjkxxbt_gif.htm</a> and here is the file: <a href=\"https://www.dropbox.com/s/3pr29bvbz77pswu/StackOverflow%20Question%2038750798%20changes%20to%20form%20control%20combo%20boxes.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/3pr29bvbz77pswu/&hellip;</a> So, please stop posting incorrect / incomplete answers. It&#39;s not helping this site."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1470257873, "post_id": 38750798, "comment_id": 64880820, "body": "@Ralph - The answer isn&#39;t incorrect.  It works as exactly described above in my environment.  As far as &quot;helping the site&quot;, I&#39;m not sure your attitude is doing much either. I consider this discussion over, and I&#39;ll be cleaning up the comments on the OP&#39;s post.  I suggest you do the same."}, {"owner": {"reputation": 129, "user_id": 6620600, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/p5nMR.png?s=128&g=1", "display_name": "Pisti", "link": "https://stackoverflow.com/users/6620600/pisti"}, "edited": false, "score": 0, "creation_date": 1470380097, "post_id": 38750798, "comment_id": 64936495, "body": "Thanks answers! :)"}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 6620600, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/p5nMR.png?s=128&g=1", "display_name": "Pisti", "link": "https://stackoverflow.com/users/6620600/pisti"}, "edited": false, "score": 0, "creation_date": 1470379424, "post_id": 38752145, "comment_id": 64936152, "body": "Thanks a lot your answer! That is working!"}, {"owner": {"reputation": 129, "user_id": 6620600, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/p5nMR.png?s=128&g=1", "display_name": "Pisti", "link": "https://stackoverflow.com/users/6620600/pisti"}, "edited": false, "score": 0, "creation_date": 1470382741, "post_id": 38752145, "comment_id": 64938049, "body": "What kind of events of dropdown are?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 129, "user_id": 6620600, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/p5nMR.png?s=128&g=1", "display_name": "Pisti", "link": "https://stackoverflow.com/users/6620600/pisti"}, "edited": false, "score": 0, "creation_date": 1470399003, "post_id": 38752145, "comment_id": 64947861, "body": "@Pisti - Unfortunately form controls only get the one event that can be assigned using the method above. ActiveX controls have more."}, {"owner": {"reputation": 129, "user_id": 6620600, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/p5nMR.png?s=128&g=1", "display_name": "Pisti", "link": "https://stackoverflow.com/users/6620600/pisti"}, "edited": false, "score": 0, "creation_date": 1470431084, "post_id": 38752145, "comment_id": 64965804, "body": "Aha, and what are different ActiveXs and Form Controls?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 129, "user_id": 6620600, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/p5nMR.png?s=128&g=1", "display_name": "Pisti", "link": "https://stackoverflow.com/users/6620600/pisti"}, "edited": false, "score": 1, "creation_date": 1470431319, "post_id": 38752145, "comment_id": 64965880, "body": "@Pisti - You should be able to see both types on the ribbon. Look it Developer -&gt; Insert.  The Form Controls should be on the top, and the ActiveX ones on the bottom.  The Form Controls are basically severely stripped down versions of the ActiveX ones - those are basically the same ones you would use on a UserForm."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1470252608, "creation_date": 1470252608, "answer_id": 38752145, "question_id": 38750798, "link": "https://stackoverflow.com/questions/38750798/can-i-make-change-listener-in-vba/38752145#38752145", "title": "Can I make &quot;change listener&quot; in VBA?", "body": "<p>Right click on the ComboBox, and select Assign Macro... </p>\n\n<p><a href=\"https://i.stack.imgur.com/vKnWT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vKnWT.png\" alt=\"enter image description here\"></a></p>\n\n<p>It will default to something like \"Book1!DropDown1_Change\". Click the \"New\" button. </p>\n\n<p><a href=\"https://i.stack.imgur.com/uKE5w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uKE5w.png\" alt=\"enter image description here\"></a></p>\n\n<p>It will generate stub code for the event handler, i.e.:</p>\n\n<pre><code>Sub DropDown1_Change()\n    'Put your event handler here.\nEnd Sub\n</code></pre>\n\n<p>Alternately, you can assign an existing macro.</p>\n"}], "owner": {"reputation": 129, "user_id": 6620600, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/p5nMR.png?s=128&g=1", "display_name": "Pisti", "link": "https://stackoverflow.com/users/6620600/pisti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "closed_date": 1470379382, "accepted_answer_id": 38752145, "answer_count": 1, "score": 0, "last_activity_date": 1470400136, "creation_date": 1470247694, "last_edit_date": 1531164843, "question_id": 38750798, "link": "https://stackoverflow.com/questions/38750798/can-i-make-change-listener-in-vba", "closed_reason": "Duplicate", "title": "Can I make &quot;change listener&quot; in VBA?", "body": "<p>I want similiar like Java, or C#. When a Range(1, A).Value was changed, then occurs an method for example Range(1, B).Value be Range(1, A).Value.\nI know VBA has Worksheet_Change method, but I use  ComboBox and when I choose an value from Combobox, the change was not occurred.</p>\n\n<p>I'm using a form control, not an ActiveX control.</p>\n"}, {"tags": ["excel", "vba", "function", "udf"], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1470257117, "post_id": 38752089, "comment_id": 64880461, "body": "Interesting. I never would have thought to use Evaluate as a wrapper function."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1470257222, "post_id": 38752089, "comment_id": 64880511, "body": "@Comintern - related: <a href=\"https://stackoverflow.com/questions/23433096/using-a-udf-in-excel-to-update-the-worksheet/23437280#23437280\" title=\"using a udf in excel to update the worksheet\">stackoverflow.com/questions/23433096/&hellip;</a>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1470267372, "last_edit_date": 1470267372, "creation_date": 1470252415, "answer_id": 38752089, "question_id": 38750643, "link": "https://stackoverflow.com/questions/38750643/custom-excel-formula-function-udf-to-count-conditional-formatting/38752089#38752089", "title": "Custom excel formula function UDF to count Conditional Formatting", "body": "<p>Following on from @Jeeped and @Comintern...</p>\n\n<p>This works for me - a simplified example: </p>\n\n<pre><code>Function WrapCountReds(rRange)\n    WrapCountReds = rRange.Parent.Evaluate(\"CountReds(\" &amp; _\n                          rRange.Address(False, False) &amp; \")\")\nEnd Function\n\n'can't call this directly from a worksheet but can be called via evaluate\nPublic Function CountReds(rRange As Range)\n\n    Dim rCell As Range\n    Dim vResult\n\n    For Each rCell In rRange\n      If rCell.DisplayFormat.Interior.ColorIndex = 3 Then\n             vResult = 1 + vResult\n      End If\n    Next rCell\n\n    CountReds = vResult\nEnd Function\n</code></pre>\n\n<p>Worksheet usage example:</p>\n\n<pre><code>=WrapCountReds(\"A1:A100\")\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 4541083, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-EZyRVAiJQhc/AAAAAAAAAAI/AAAAAAAAADc/wCn4jjBJjwc/photo.jpg?sz=128", "display_name": "Orin Moyer", "link": "https://stackoverflow.com/users/4541083/orin-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 1, "accepted_answer_id": 38752089, "answer_count": 1, "score": 3, "last_activity_date": 1478553683, "creation_date": 1470247110, "question_id": 38750643, "link": "https://stackoverflow.com/questions/38750643/custom-excel-formula-function-udf-to-count-conditional-formatting", "title": "Custom excel formula function UDF to count Conditional Formatting", "body": "<p>Has anyone run across a function that will actually work with conditional formatting?</p>\n\n<p>there are some addons for kutools and albebits but they are not formula based (you have to select everything manually)</p>\n\n<p>I have found this, but only works with manual formatting</p>\n\n<pre><code>Function ColorFunction(rColor As Range, rRange As Range, Optional SUM As Boolean)\nDim rCell As Range\nDim lCol As Long\nDim vResult\nlCol = rColor.Interior.ColorIndex\nIf SUM = True Then\n   For Each rCell In rRange\n    If rCell.Interior.ColorIndex = lCol Then\n            vResult = WorksheetFunction.SUM(rCell) + vResult\n    End If\n   Next rCell\nElse\n    For Each rCell In rRange\n    If rCell.Interior.ColorIndex = lCol Then\n            vResult = 1 + vResult\n    End If\n   Next rCell\nEnd If\nColorFunction = vResult\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1470291739, "post_id": 38750381, "comment_id": 64891784, "body": "You already have put your letters and numbers the way you want them to, what am I missing? Do you have value data as well (not shown) in your table? You could get those by calling GETPIVOTDATA(...)"}, {"owner": {"reputation": 105, "user_id": 4811191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-jLmm4c1NuJU/AAAAAAAAAAI/AAAAAAAAAB0/CrNz9kTPSqQ/photo.jpg?sz=128", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/4811191/adam-smith"}, "reply_to_user": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1470611011, "post_id": 38750381, "comment_id": 65005431, "body": "There is plenty of value data in the table. The issue I am trying to solve is only having some of the letters show up under some of the numbers.If I add Numbers and Letters to the row field, it will calculate all occurances of the letter within each number. I want it to ignore specific combinations, in the above example, I do not want it show the combinations 2C, 3B, and 3C."}], "owner": {"reputation": 105, "user_id": 4811191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-jLmm4c1NuJU/AAAAAAAAAAI/AAAAAAAAAB0/CrNz9kTPSqQ/photo.jpg?sz=128", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/4811191/adam-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474928270, "creation_date": 1470246156, "last_edit_date": 1531161705, "question_id": 38750381, "link": "https://stackoverflow.com/questions/38750381/excel-vba-pivot-table-arrayed-filtering", "title": "Excel VBA Pivot Table Arrayed Filtering", "body": "<p>I have some pivot tables that I want to apply some advanced filtering to via VBA, but I'm not sure how to go about it or if it is even possible without doing some work on the data first.</p>\n\n<p>To simplify the data, the current pivot tables rows, with fields Numbers and Letters looks like:</p>\n\n<pre><code>1\n    A\n    B\n    C\n2\n    A\n    B\n    C\n3\n    A\n    B\n    C\n</code></pre>\n\n<p>I would like to be able to filter the table more specifically to end up like:</p>\n\n<pre><code>1\n    A\n    B\n    C\n2\n    A\n    B\n3\n    A\n</code></pre>\n\n<p>I'm not sure how to even describe the process beyond arrayed filtering. I know I could manipulate the source data to reach these results, but similar things have come up frequently enough that if there is a way to do it purely through pivot table filtering, that would be a great help.</p>\n\n<p>Any assistance is appreciated.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1470246750, "post_id": 38750375, "comment_id": 64874853, "body": "Is the <code>DepositReportOptions</code> form closed when you requery the report?"}, {"owner": {"reputation": 117, "user_id": 3507530, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dfb20a349c542ea876ceffcdfd0f0f59?s=128&d=identicon&r=PG&f=1", "display_name": "user646464", "link": "https://stackoverflow.com/users/3507530/user646464"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1470246942, "post_id": 38750375, "comment_id": 64874955, "body": "@HansUp Yes, the form closes when you click OK."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1470247041, "post_id": 38750375, "comment_id": 64875003, "body": "I have no idea where you click OK.  But my thought is don&#39;t close <code>DepositReportOptions</code> where you were closing it before.  Instead you can minimize or hide it, and then those text box values should be accessible when you requery the report."}, {"owner": {"reputation": 117, "user_id": 3507530, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dfb20a349c542ea876ceffcdfd0f0f59?s=128&d=identicon&r=PG&f=1", "display_name": "user646464", "link": "https://stackoverflow.com/users/3507530/user646464"}, "edited": false, "score": 0, "creation_date": 1470248610, "post_id": 38750375, "comment_id": 64875824, "body": "Using <code>Me.Refresh</code> throws an error."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1470249436, "post_id": 38750375, "comment_id": 64876307, "body": "Right, <code>Refresh</code> triggers a compile error, <i>&quot;Method or data member not found&quot;</i>.  Use <code>Me.Requery</code> in your report&#39;s &quot;refresh&quot; button click event."}], "answers": [{"tags": [], "owner": {"reputation": 117, "user_id": 3507530, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dfb20a349c542ea876ceffcdfd0f0f59?s=128&d=identicon&r=PG&f=1", "display_name": "user646464", "link": "https://stackoverflow.com/users/3507530/user646464"}, "is_accepted": true, "score": 0, "last_activity_date": 1470249491, "creation_date": 1470249491, "answer_id": 38751290, "question_id": 38750375, "link": "https://stackoverflow.com/questions/38750375/requery-report-based-on-form-fields/38751290#38751290", "title": "Requery Report based on Form fields", "body": "<p>Found a solution.  Using <code>Me.Visible = False</code> on the form keeps the values there, allowing you to run the report, edit records, and refresh the report, using those same values.  When you get back to the form, the values are still there, which actually could be a \"feature\", making the fields sticky.</p>\n"}], "owner": {"reputation": 117, "user_id": 3507530, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dfb20a349c542ea876ceffcdfd0f0f59?s=128&d=identicon&r=PG&f=1", "display_name": "user646464", "link": "https://stackoverflow.com/users/3507530/user646464"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 38751290, "answer_count": 1, "score": 0, "last_activity_date": 1470275417, "creation_date": 1470246143, "last_edit_date": 1470275417, "question_id": 38750375, "link": "https://stackoverflow.com/questions/38750375/requery-report-based-on-form-fields", "title": "Requery Report based on Form fields", "body": "<p>I have a report, DepositsReport, where the user can specify a date range and a deposit type to display, by entering them on a form (called DepositReportOptions).  Once the form is submitted, it runs the report, which is based on a query.</p>\n\n<p>Among other things, the report displays DepositDate and DepositType.</p>\n\n<p>In the query the report is based on, the criteria for DepositDate are:</p>\n\n<pre><code>Between [Forms]![DepositReportOptions]![Date1] And [Forms]![DepositReportOptions]![Date2]\n</code></pre>\n\n<p>The criterion for DepositType is:</p>\n\n<pre><code>[Forms]![DepositReportOptions]![DepositType]\n</code></pre>\n\n<p>The report works just fine, but I am running into issues when I try to refresh the report.  You can click on a record on the report, which opens it up in a form so you can edit the record.  When you get back to report, I'd like it to refresh.  I have a refresh button on the report, that just has   <code>DoCmd.Requery</code> behind it.  This is making Access pop up windows that prompt me to enter Date1, Date2, and DepositType again.  I want it to use those same values (that I initially provided on the DepositReportOptions form) when it requeries, so you don't get prompted to enter them again.</p>\n\n<p>Is it possible to do this?</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470246377, "post_id": 38750171, "comment_id": 64874638, "body": "Looks complicated. You only want to look at actual words not include punctuation - and you want to look at formatting. Probably need some kind of regular expression and then be able to look at formatting based on the posiition of the word in the cell"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470248689, "post_id": 38750171, "comment_id": 64875869, "body": "Add example code using your definitions - no need for reg expressions"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1470248736, "post_id": 38750171, "comment_id": 64875898, "body": "You&#39;re not changing the destination range within the loop. If you do it that way, there will only be one output value on Sheet2..."}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 1, "creation_date": 1470258078, "post_id": 38751010, "comment_id": 64880908, "body": "Thank you for taking the time"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 1, "creation_date": 1470259829, "post_id": 38751010, "comment_id": 64881748, "body": "@johndoe253 - This was fun, nice question."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1470248527, "creation_date": 1470248527, "answer_id": 38751010, "question_id": 38750171, "link": "https://stackoverflow.com/questions/38750171/array-split-and-extract-vba-excel/38751010#38751010", "title": "Array split and extract vba excel", "body": "<p>It's not the prettiest solution, but you can take each cell, put their contents in an array.  Then, make some room, and \"unload them\" and move along.</p>\n\n<p>I tested with some simple data, but if you have errors, can you show more examples of text/data?</p>\n\n<pre><code>Sub proj()\nDim cl      As Range\nDim x       As Long\n\nx = 0\n\nFor Each cl In Sheets(\"Sheet1\").Range(\"C1:C5\")\n    Call CopyItalicUnderlined(cl, Worksheets(\"Sheet2\").Range(\"A1\").Offset(x, 0))\n    x = x + 1\nNext\nCall breakOutWords\nEnd Sub\n\nSub CopyItalicUnderlined(rngToCopy As Range, rngToPaste As Range)\nDim foundWords() As Variant\n\nrngToCopy.Copy rngToPaste\n\nDim i\nFor i = Len(rngToCopy.Value2) To 1 Step -1\n    With rngToPaste.Characters(i, 1)\n        Debug.Print .Text\n        If Not .Font.Italic And Not .Font.Underline Then\n            If .Text &lt;&gt; \" \" Then\n                .Text = vbNullString\n            Else\n                .Text = \" \"\n            End If\n        End If\n    End With\nNext\nrngToPaste.Value = Trim(rngToPaste.Value)\nrngToPaste.Value = WorksheetFunction.Substitute(rngToPaste, \"  \", \" \")\n\n\nEnd Sub\nSub breakOutWords()\nDim lastRow As Long, i As Long, k As Long, spaceCounter As Long\nDim myWords As Variant\nDim groupRange As Range\n\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = lastRow To 1 Step -1\n    ' Determine how many spaces - this means we have X+1 words\n    spaceCounter = Len(Cells(i, 1)) - Len(WorksheetFunction.Substitute(Cells(i, 1), \" \", \"\")) + 1\n    If spaceCounter &gt; 1 Then\n        Set groupRange = Range(Cells(i, 1), Cells(WorksheetFunction.Max(2, i + spaceCounter - 1), 1))\n        groupRange.Select\n        myWords = Split(Cells(i, 1), \" \")\n        groupRange.Clear\n        For k = LBound(myWords) To UBound(myWords)\n            groupRange.Cells(1 + k, 1).Value = myWords(k)\n        Next k\n    Else\n        ' how many new rows will we need for the next cell?\n        Dim newRows As Long\n        newRows = Len(Cells(i - 1, 1)) - Len(WorksheetFunction.Substitute(Cells(i - 1, 1), \" \", \"\"))\n        Range(Cells(i, 1), Cells(i + newRows - 1, 1)).EntireRow.Insert\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1470249003, "post_id": 38751035, "comment_id": 64876047, "body": "Thank you! Just to clarify, how could I move it to start at V4?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1470250490, "post_id": 38751035, "comment_id": 64876934, "body": "What should start ar V4?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1470248593, "creation_date": 1470248593, "answer_id": 38751035, "question_id": 38750171, "link": "https://stackoverflow.com/questions/38750171/array-split-and-extract-vba-excel/38751035#38751035", "title": "Array split and extract vba excel", "body": "<p><code>Split()</code> could help, but only after you already found out and parsed italic words since <code>Characters()</code> method can be called on <code>Range</code> object only </p>\n\n<p>you could then try the following code:</p>\n\n<pre><code>Option Explicit\n\nSub proj()\n    Dim dataRng As range, cl As range\n    Dim arr As Variant\n\n    Set dataRng = Worksheets(\"ItalicSourceSheet\").range(\"C1:C5\") '&lt;--| change \"ItalicSourceSheet\" with your actual source sheet name\n    With Worksheets(\"ItalicOutputSheet\") '&lt;--|change \"ItalicOutputSheet\" with your actual output sheet name\n        For Each cl In dataRng\n            arr = GetItalics(cl) '&lt;--| get array with italic words\n            If IsArray(arr) Then .Cells(.Rows.Count, 1).End(xlUp).Offset(1).Resize(UBound(arr) + 1) = Application.Transpose(arr) '&lt;--| if array is filled then write it down to output sheet first blank cell in column \"A\"\n        Next\n    End With\nEnd Sub\n\nFunction GetItalics(rng As range) As Variant\n    Dim strng As String\n    Dim iEnd As Long, iIni As Long, strngLen As Long\n\n    strngLen = Len(rng.Value2)\n    iIni = 1\n    Do While iEnd &lt;= strngLen\n        Do While rng.Characters(iEnd, 1).Font.Italic And rng.Characters(iEnd, 1).Font.Underline\n            If iEnd = strngLen Then Exit Do\n            iEnd = iEnd + 1\n        Loop\n        If iEnd &gt; iIni Then strng = strng &amp; Mid(rng.Value2, iIni, iEnd - iIni) &amp; \"|\"\n        iEnd = iEnd + 1\n        iIni = iEnd\n    Loop\n    If strng &lt;&gt; \"\" Then GetItalics = Split(Left(strng, Len(strng) - 1), \"|\")\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1470248609, "creation_date": 1470248609, "answer_id": 38751043, "question_id": 38750171, "link": "https://stackoverflow.com/questions/38750171/array-split-and-extract-vba-excel/38751043#38751043", "title": "Array split and extract vba excel", "body": "<p>I think this should work - I modified your code to match your example.  </p>\n\n<ul>\n<li>Change the top constants to mark where you want to start appending\ninto Sheet 2</li>\n<li>Change names of Worksheets to match your real life sheets</li>\n<li>Change range of cells to check in <code>Set rge = ws1.Range(\"C8:C100\")</code>   </li>\n</ul>\n\n<blockquote>\n  <p><strong>Example Code:</strong></p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nPublic Sub ExtractUnderlinedItalicizedWords()\n\n    ' Where to start appending new words '\n    Const INSERT_COL        As Integer = 1\n    Const START_AT_ROW      As Integer = 1\n\n    Dim ws1         As Worksheet\n    Dim ws2         As Worksheet\n\n    Dim rge         As Range\n    Dim cel         As Range\n    Dim c           As Object\n\n    Dim countChars  As Integer\n    Dim i           As Integer\n    Dim intRow      As Integer        \n    Dim strWord     As String\n\n    Set ws1 = Worksheets(\"Sheet1\")\n    Set ws2 = Worksheets(\"Sheet2\")\n\n    intRow = START_AT_ROW\n\n    ' Define the range of cells to check\n    Set rge = ws1.Range(\"C8:C100\")\n\n    For Each cel In rge.Cells\n        countChars = cel.Characters.count\n        ' Only do this until we find a blank cell\n        If countChars = 0 Then Exit For\n\n        strWord = \"\"\n\n        For i = 1 To countChars\n            Set c = cel.Characters(i, 1)\n            With c.Font\n                If (.Underline &lt;&gt; xlUnderlineStyleNone) And (.Italic) Then\n                    strWord = strWord &amp; c.Text\n                Else\n                    If Len(strWord) &gt; 0 Then\n                        ws2.Cells(intRow, INSERT_COL).Value = strWord\n                        intRow = intRow + 1\n                        strWord = \"\"\n                    End If\n                End If\n            End With\n        Next i\n\n        ' Get Last Word in cell\n        If Len(strWord) &gt; 0 Then\n            ws2.Cells(intRow, INSERT_COL).Value = strWord\n            intRow = intRow + 1\n            strWord = \"\"\n        End If\n\n    Next ' Next cell in column range        \n\nEnd Sub   \n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 1, "accepted_answer_id": 38751035, "answer_count": 3, "score": 3, "last_activity_date": 1470248609, "creation_date": 1470245369, "last_edit_date": 1470245477, "question_id": 38750171, "link": "https://stackoverflow.com/questions/38750171/array-split-and-extract-vba-excel", "title": "Array split and extract vba excel", "body": "<p>I got help with this code but when it runs it does not execute what it needs to do. I'm trying to extract words that are underlined and italicized from row C of the first sheet and move them to the secondsheet. The expected outcome is in the second image. Would array splitting be of use in this situation? Hopefully the sample data make it more clear.</p>\n\n<p><a href=\"https://i.stack.imgur.com/gVjUh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gVjUh.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/tYBaN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tYBaN.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub proj()\n\n\nFor Each cl In Range(\"C1:C5\")\n        Call CopyItalicUnderlined(cl, Worksheets(\"Sheet2\").Range(\"A1\"))\n    Next\n\nEnd Sub\n\nSub CopyItalicUnderlined(rngToCopy, rngToPaste)\n\nrngToCopy.Copy rngToPaste\n\nDim i\nFor i = Len(rngToCopy.Value2) To 1 Step -1\n    With rngToPaste.Characters(i, 1)\n        If Not .Font.Italic And Not .Font.Underline Then\n            .Text = vbNullString\n        End If\n    End With\nNext\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1470265151, "post_id": 38750137, "comment_id": 64883687, "body": "Would you mind adding some more details?"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1470248812, "post_id": 38750400, "comment_id": 64875935, "body": "thanks so much for the reply. There is no way to code it to entail every value though? I have 35 different criteria generating data, most of which are checkboxes.  If I have to rewrite each so be it, was just hoping I could stick something at the beginning and/or end of the button click or userform."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1470249203, "post_id": 38750400, "comment_id": 64876162, "body": "@Awill - Not unless you&#39;re using something like an array of controls. You could update all of the cells <i>again</i> afterward, but that would be horribly inefficient.  Just copy and paste the code into an editor that does regex search and replace - should be a quick job if you don&#39;t want to hunt everything down."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1506033670, "last_edit_date": 1506033670, "creation_date": 1470246232, "answer_id": 38750400, "question_id": 38750137, "link": "https://stackoverflow.com/questions/38750137/convert-all-t-f-values-from-userform-to-numbers-when-populating-cells/38750400#38750400", "title": "convert all T/F values from userform to numbers when populating cells", "body": "<p><code>checkbox1.Value</code> returns a <code>Boolean</code>.  If you want to cast it to a number, just use <code>CInt()</code> (or <code>CLng()</code>).  VBA treats <code>0</code> as <code>False</code> and <code>-1</code> as <code>True</code>, so if you want your averages/totals to be positive, take the absolute value:</p>\n\n<pre><code>{desired cell range}.Value = Abs(CInt(checkbox1.Value))\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 38750400, "answer_count": 1, "score": 0, "last_activity_date": 1506033670, "creation_date": 1470245274, "question_id": 38750137, "link": "https://stackoverflow.com/questions/38750137/convert-all-t-f-values-from-userform-to-numbers-when-populating-cells", "title": "convert all T/F values from userform to numbers when populating cells", "body": "<p>I am nearing completion of my first userform to data table template many thanks to you all! </p>\n\n<p>I'm puzzled however as to how I am going to pivot all this data that populates onto my sheet from the userform selections as they return \"True\" &amp; \"False\" values. </p>\n\n<p>My only thought in order to get the averages/totals I need, is to have the values change to 1 &amp; 0 respectively. Is there a way to code all true or false values of checkboxes to these numbers before populating the data on the sheet or will I have to manually change the value of each box so that it places a 1 or 0 in the destined cell? As you could imagine. </p>\n\n<p>ex.\n<code>\"desired cell range\".Value = checkbox1.Value</code></p>\n\n<p>Picture example of what populates the data table, which is 35 rows across.\n<a href=\"https://i.stack.imgur.com/fH77z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fH77z.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sql", "sql-server", "vba", "ms-access"], "comments": [{"owner": {"reputation": 5778, "user_id": 5921693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104a78260ca097069cf8f8179e41acdd?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/5921693/nick"}, "edited": false, "score": 0, "creation_date": 1470244344, "post_id": 38749834, "comment_id": 64873497, "body": "Why default <code>NULL</code> to <code>NULL</code> if it is already <code>NULL</code> by default? :-)"}, {"owner": {"reputation": 2524, "user_id": 1504882, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e071b156e2d26def3d6988e424c38ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Elias", "link": "https://stackoverflow.com/users/1504882/elias"}, "reply_to_user": {"reputation": 5778, "user_id": 5921693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104a78260ca097069cf8f8179e41acdd?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/5921693/nick"}, "edited": false, "score": 0, "creation_date": 1470244555, "post_id": 38749834, "comment_id": 64873611, "body": "@Nicarus, because it wasn&#39;t defaulting to Null :("}, {"owner": {"reputation": 5778, "user_id": 5921693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104a78260ca097069cf8f8179e41acdd?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/5921693/nick"}, "edited": false, "score": 0, "creation_date": 1470244668, "post_id": 38749834, "comment_id": 64873674, "body": "But it was defaulting to <code>NULL</code> - the difference is that you were supplying it with a non-Null value... If you want to make a specific value NULL, you can do that with <code>NULLIF</code> or, if it is more complex, a <code>CASE</code> statement."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1470244941, "post_id": 38749834, "comment_id": 64873810, "body": "What is your full INSERT statement? How is the Time(0) column in the linked table shown in Access table design? Maybe Access doesn&#39;t really handle that datatype very well. What Access version do you use?"}], "answers": [{"tags": [], "owner": {"reputation": 2524, "user_id": 1504882, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e071b156e2d26def3d6988e424c38ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Elias", "link": "https://stackoverflow.com/users/1504882/elias"}, "is_accepted": true, "score": 0, "last_activity_date": 1470249986, "last_edit_date": 1470249986, "creation_date": 1470246053, "answer_id": 38750349, "question_id": 38749834, "link": "https://stackoverflow.com/questions/38749834/set-time0-data-type-in-sql-server-to-null/38750349#38750349", "title": "Set Time(0) Data Type in Sql Server to NULL", "body": "<p>The solution is a little easier than expected.</p>\n\n<p>The IsNull() function was evaluation to False. The reason for that was the field was empty and not null.</p>\n\n<p>Checking IsNull and IsEmpty solved every problem I was having.</p>\n\n<p>I also did not set it to the recordset field. I set it to a non existing variable.</p>\n\n<p>Doh.</p>\n"}], "owner": {"reputation": 2524, "user_id": 1504882, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e071b156e2d26def3d6988e424c38ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Elias", "link": "https://stackoverflow.com/users/1504882/elias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 0, "accepted_answer_id": 38750349, "answer_count": 1, "score": 2, "last_activity_date": 1470249986, "creation_date": 1470244276, "last_edit_date": 1470245238, "question_id": 38749834, "link": "https://stackoverflow.com/questions/38749834/set-time0-data-type-in-sql-server-to-null", "title": "Set Time(0) Data Type in Sql Server to NULL", "body": "<p>I am currently in the process of moving an Access table to SQL Server. The access table uses the <a href=\"https://support.office.com/en-us/article/Add-and-customize-date-and-time-formats-763b9b04-ccf8-46a8-9ee3-6d8f6fb9e2f8\" rel=\"nofollow\">Long Time</a> format. I am moving the data from the Long Time into a <a href=\"https://msdn.microsoft.com/en-us/library/bb677243.aspx\" rel=\"nofollow\">Time(0)</a> format. </p>\n\n<p>The Time(0) is defined as:</p>\n\n<pre><code>[timePosted] [time](0) NULL DEFAULT (NULL)\n</code></pre>\n\n<p>When I insert into the table through a pass through query, I check for Nulls in VBA:</p>\n\n<pre><code>IIf(IsNull(timePosted), \" NULL \", \"'\" &amp; rs!timePosted &amp; \"'\")\n</code></pre>\n\n<p>The table has the data:</p>\n\n<pre><code>00:00:00\n</code></pre>\n\n<p>How do I insert a Null into a time field?</p>\n"}, {"tags": ["string", "excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1470243566, "post_id": 38749451, "comment_id": 64873031, "body": "You could use <code>Instr</code>"}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 2, "last_activity_date": 1470243358, "creation_date": 1470243358, "answer_id": 38749570, "question_id": 38749451, "link": "https://stackoverflow.com/questions/38749451/vba-excel-partial-string-search/38749570#38749570", "title": "vba excel partial string search", "body": "<p>You can use the VBA <code>LEFT()</code> string function:</p>\n\n<pre><code>If Left(ws.range(\"A93\").value, 3) = \"LN:\" Then\n</code></pre>\n\n<p>That will take the 3 leftmost characters of the range's value and compare it to the string \"LN:\"</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1470243590, "creation_date": 1470243590, "answer_id": 38749645, "question_id": 38749451, "link": "https://stackoverflow.com/questions/38749451/vba-excel-partial-string-search/38749645#38749645", "title": "vba excel partial string search", "body": "<p>Another option is to use the Like operator with a wildcard</p>\n\n<pre><code>If ws.Range(\"A93\") Like \"LN:*\" &amp;  Then\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 38749645, "answer_count": 2, "score": 0, "last_activity_date": 1470243590, "creation_date": 1470243022, "last_edit_date": 1531164843, "question_id": 38749451, "link": "https://stackoverflow.com/questions/38749451/vba-excel-partial-string-search", "title": "vba excel partial string search", "body": "<pre><code>  With Worksheets(\"Sheet2\")\n  NewRow = .Range(\"C\" &amp; Rows.Count).End(xlUp).Row + 1\n\n\n.Range(\"A\" &amp; NewRow) = ws.Range(\"A91\")\n.Range(\"B\" &amp; NewRow) = ws.Range(\"A92\")\n\n\nIf ws.Range(\"A93\") = \"LN:\" &amp;  Then\n    .Range(\"C\" &amp; NewRow) = ws.Range(\"A94\")\nElse\n    .Range(\"C\" &amp; NewRow) = ws.Range(\"A93\")\n End If\n\n\nEnd With\n</code></pre>\n\n<p>How can I change that line:</p>\n\n<pre><code>  If ws.Range(\"A93\") = \"LN:\" &amp;   Then\n</code></pre>\n\n<p>Code should copy cell A94 if text in cell A93 starts with:  <strong><em>LN:</em></strong>\nregardless what characters are following LN:</p>\n"}, {"tags": ["vba", "excel", "filtering"], "answers": [{"tags": [], "owner": {"reputation": 48, "user_id": 6561510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99a30232e1cf79df1db7f301147465f3?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6561510/paul"}, "is_accepted": true, "score": 3, "last_activity_date": 1470247093, "creation_date": 1470247093, "answer_id": 38750636, "question_id": 38749387, "link": "https://stackoverflow.com/questions/38749387/vba-filtering-and-deleting-contents-in-column/38750636#38750636", "title": "VBA: Filtering and deleting contents in column", "body": "<p>While you could accomplish this by filtering and then clearing visible cells, iterating over employee ids and checking their value is a bit more straightforward. This will also continue to work even if the number of rows in your spreadsheet grows, provided the values in column C are continuous. </p>\n\n<pre><code>Sub ClearCells()\n     Dim employeeId As Range\n     Dim deleteIds As Variant\n     deleteIds = Array(14, 35, 17) ' Put your employee ids in here\n     For Each employeeId In Range(ActiveSheet.Range(\"C1\"), ActiveSheet.Range(\"C1\").End(xlDown))\n        If Not (IsError(Application.Match(employeeId.Value, deleteIds, 0))) Then\n            ActiveSheet.Range(\"Z\" &amp; employeeId.Row).Value = \"\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 6433076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71d867ac1f38d3025649e69b64b691b5?s=128&d=identicon&r=PG&f=1", "display_name": "jellyxbean", "link": "https://stackoverflow.com/users/6433076/jellyxbean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 0, "accepted_answer_id": 38750636, "answer_count": 1, "score": 0, "last_activity_date": 1470247093, "creation_date": 1470242802, "last_edit_date": 1531164843, "question_id": 38749387, "link": "https://stackoverflow.com/questions/38749387/vba-filtering-and-deleting-contents-in-column", "title": "VBA: Filtering and deleting contents in column", "body": "<p>Sorry for the simple question, still pretty new to VBA.</p>\n\n<p>I have a spreadsheet with columns A-Z populated. What I want to do is to filter column C (contains employee ID) based on a few employees, and then delete only the contents in column Q (which contains employee hours worked), deleting only the visible contents.</p>\n\n<p>To be clearer, I would filter column C based on some criteria, then go to column Z. In column Z I would like to delete only the contents in column Z (not the entire row), based on the visible rows. So essentially after filtering I'd like to delete all the visible contents in column Z. The number of rows for the spreadsheet is always growing, so I can't use what I'm using right now which is just selecting specific cells and deleting the contents. Hopefully that makes sense! </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1470242098, "post_id": 38749161, "comment_id": 64872126, "body": "You&#39;ll get a better answer if you post your code.  Guessing that you&#39;re converting to a <code>Variant</code> somewhere."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1470243605, "post_id": 38749432, "comment_id": 64873054, "body": "Welcome to SO.  <code>FormatNumber</code> already returns a <code>String</code>, so there isn&#39;t a need to cast <code>num</code> unless all of the variable types are already messed up and there&#39;s implicit casting going on: <code>Debug.Print TypeName(FormatNumber(CDbl(42), 2))</code>"}, {"owner": {"reputation": 9, "user_id": 6596423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fa929c6fc85bfb76092248af43995f3?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bibicoff", "link": "https://stackoverflow.com/users/6596423/j-bibicoff"}, "edited": false, "score": 0, "creation_date": 1470244086, "post_id": 38749432, "comment_id": 64873350, "body": "Thanks, Works great"}, {"owner": {"reputation": 9, "user_id": 6596423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fa929c6fc85bfb76092248af43995f3?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bibicoff", "link": "https://stackoverflow.com/users/6596423/j-bibicoff"}, "edited": false, "score": 0, "creation_date": 1470244138, "post_id": 38749432, "comment_id": 64873391, "body": "Thanks. Works great."}, {"owner": {"reputation": 9, "user_id": 6596423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fa929c6fc85bfb76092248af43995f3?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bibicoff", "link": "https://stackoverflow.com/users/6596423/j-bibicoff"}, "edited": false, "score": 0, "creation_date": 1470339827, "post_id": 38749432, "comment_id": 64923624, "body": "I have to take back my thanks. I had created an invoice where the total for each row is shown and of course a grand total is also shown. After a third entry is made the grand total reverts back to not displaying the grand total correctly.  ex 14.50 now again shown as 14.5"}, {"owner": {"reputation": 1, "user_id": 6673462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b87011846788b4ab5ea7b465a99ce5?s=128&d=identicon&r=PG&f=1", "display_name": "A Bright", "link": "https://stackoverflow.com/users/6673462/a-bright"}, "edited": false, "score": 0, "creation_date": 1470678624, "post_id": 38749432, "comment_id": 65036480, "body": "That wouldn&#39;t be the fault of my solution. All it does is add an extra decimal place. As Comintern said, post your entire code if you want meaningful feedback."}], "tags": [], "owner": {"reputation": 1, "user_id": 6673462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b87011846788b4ab5ea7b465a99ce5?s=128&d=identicon&r=PG&f=1", "display_name": "A Bright", "link": "https://stackoverflow.com/users/6673462/a-bright"}, "is_accepted": false, "score": 0, "last_activity_date": 1470242971, "creation_date": 1470242971, "answer_id": 38749432, "question_id": 38749161, "link": "https://stackoverflow.com/questions/38749161/string-does-not-equal-another-string/38749432#38749432", "title": "String does not equal another string", "body": "<p>Try this:</p>\n\n<pre><code>num = FormatNumber(CDbl(string1), 2)\nstring1 = CStr(num)\n</code></pre>\n\n<p>'num' is just a placeholder here for the converted value (14.50), you don't need a second string.</p>\n"}], "owner": {"reputation": 9, "user_id": 6596423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fa929c6fc85bfb76092248af43995f3?s=128&d=identicon&r=PG&f=1", "display_name": "J. Bibicoff", "link": "https://stackoverflow.com/users/6596423/j-bibicoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1470242971, "creation_date": 1470241979, "question_id": 38749161, "link": "https://stackoverflow.com/questions/38749161/string-does-not-equal-another-string", "title": "String does not equal another string", "body": "<p>Original string1 looks like this 14.5\nI have a procedure that will change the above to 14.50\nand place this back into string1.</p>\n\n<p>if I have string2 = string 1,  string2 will be 14.5</p>\n\n<p>Not what I want. I have tried converting string1 to a numeric with the Val function and then resetting it with the Str function. does not work.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 9, "last_activity_date": 1542752303, "last_edit_date": 1542752303, "creation_date": 1470241469, "answer_id": 38749007, "question_id": 38748961, "link": "https://stackoverflow.com/questions/38748961/vba-refer-to-chart-name/38749007#38749007", "title": "VBA refer to chart name", "body": "<p>A ChartObject is just a \"container\" for a Chart on a worksheet: you need to access its <code>Chart</code> property to get to the chart itself:</p>\n\n<pre><code>ActiveSheet.ChartObjects(\"Sale\").Chart.Axes(xlValue).MinimumScale = 1000\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1594735048, "post_id": 59762437, "comment_id": 111225782, "body": "OP asked how to <i>refer</i> to a chart by it&#39;s name (not how to <i>set</i> the name)."}], "tags": [], "owner": {"reputation": 298, "user_id": 1806618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/becfee70c214763e13d385617629c43d?s=128&d=identicon&r=PG", "display_name": "masarapmabuhay", "link": "https://stackoverflow.com/users/1806618/masarapmabuhay"}, "is_accepted": false, "score": -2, "last_activity_date": 1579143546, "creation_date": 1579143546, "answer_id": 59762437, "question_id": 38748961, "link": "https://stackoverflow.com/questions/38748961/vba-refer-to-chart-name/59762437#59762437", "title": "VBA refer to chart name", "body": "<p>You can set the name of the chart to which you intend to refer using the following:</p>\n\n<pre><code>ActiveSheet.Shapes(1).name = \"Sale\"\n</code></pre>\n\n<p>Note that the value of <code>1</code> in <code>Shapes(1)</code> is the Chart number of the first chart you create. </p>\n\n<p>If you are creating more than one (1) chart, you will need to update the number accordingly.</p>\n\n<p>I hope this helps you. </p>\n\n<p>Thank you. </p>\n\n<p>Peace. </p>\n"}], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9461, "favorite_count": 0, "accepted_answer_id": 38749007, "answer_count": 2, "score": 4, "last_activity_date": 1579143546, "creation_date": 1470241327, "question_id": 38748961, "link": "https://stackoverflow.com/questions/38748961/vba-refer-to-chart-name", "title": "VBA refer to chart name", "body": "<p>Why this does not work:</p>\n\n<pre><code>ActiveSheet.ChartObjects(\"Sale\").Axes(xlValue).MinimumScale = 1000\n</code></pre>\n\n<p>while this does:</p>\n\n<pre><code>  With ActiveChart.Axes(xlValue, xlPrimary)\n    .MinimumScale = 1000\n  End With\n</code></pre>\n\n<p>First I did this:</p>\n\n<pre><code>ActiveChart.Parent.Name=\"Sale\"\n</code></pre>\n\n<p>I was not able to do this:</p>\n\n<pre><code>ActiveChart.Name=\"Sale\"\n</code></pre>\n\n<p>I want to refer specifically to the chart \"Sale\", not to ActiveChart.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1470240787, "post_id": 38748657, "comment_id": 64871291, "body": "When you randomize things, there is no way to exclude the appearance of  value that already appeared. The only reasonable solution is to check of the person appeared already the max number of times and, if yes, re-run the random to get new names."}, {"owner": {"reputation": 1069, "user_id": 5620071, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Vw86Z.jpg?s=128&g=1", "display_name": "Mister 832", "link": "https://stackoverflow.com/users/5620071/mister-832"}, "edited": false, "score": 0, "creation_date": 1470241328, "post_id": 38748657, "comment_id": 64871666, "body": "Acutally, you could use the solver instead of vba. Its a built-in addon designed to solve scenarios. There are enough tutorials on the web."}, {"owner": {"reputation": 1069, "user_id": 5620071, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Vw86Z.jpg?s=128&g=1", "display_name": "Mister 832", "link": "https://stackoverflow.com/users/5620071/mister-832"}, "edited": false, "score": 0, "creation_date": 1470243536, "post_id": 38748657, "comment_id": 64873005, "body": "You could also delete / shrink the list of available names, once a name is used the maximum times. A dictionary would be nice for this."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6673272, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153508753213751/picture?type=large", "display_name": "Frederik Steenfeldt", "link": "https://stackoverflow.com/users/6673272/frederik-steenfeldt"}, "edited": false, "score": 0, "creation_date": 1470245728, "post_id": 38749180, "comment_id": 64874288, "body": "Your initial comment made me think and come to a solution. Not as smooth but it is something. See the update in my post :) And thank you"}], "tags": [], "owner": {"reputation": 1069, "user_id": 5620071, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Vw86Z.jpg?s=128&g=1", "display_name": "Mister 832", "link": "https://stackoverflow.com/users/5620071/mister-832"}, "is_accepted": true, "score": 0, "last_activity_date": 1470243350, "last_edit_date": 1470243350, "creation_date": 1470242046, "answer_id": 38749180, "question_id": 38748657, "link": "https://stackoverflow.com/questions/38748657/making-a-schedule-with-vba-in-excel/38749180#38749180", "title": "Making a schedule with VBA in Excel", "body": "<p>You could put your random generation in a separte function, that checks the worksheet, if the selected name has already been used twice. If false, it returns the name. If true, the function calls itself (hence generates a new name), until a name is found, which fits your criteria. </p>\n\n<p><strong>Update</strong> Please note, that this is some kind of pseudo-code, which is not intended to work</p>\n\n<p>In your Sub cookplan, you add the name of the Function everytime you need a new name</p>\n\n<pre><code>cook1 = GetName()\n</code></pre>\n\n<p>After the End Sub you insert a new Funktion called GetName (or whatever you want)</p>\n\n<pre><code>Function GetName() As String\n\n    'Determine your name here\n    If CountForDeterminedName &gt; 2 Then\n\n        'Call Function Again to find another Name\n        GetName = GetName()\n\n    Else\n\n        GetName = DeterminedName\n\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6673272, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153508753213751/picture?type=large", "display_name": "Frederik Steenfeldt", "link": "https://stackoverflow.com/users/6673272/frederik-steenfeldt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2180, "favorite_count": 0, "accepted_answer_id": 38749180, "answer_count": 1, "score": 1, "last_activity_date": 1507292514, "creation_date": 1470240466, "last_edit_date": 1507292514, "question_id": 38748657, "link": "https://stackoverflow.com/questions/38748657/making-a-schedule-with-vba-in-excel", "title": "Making a schedule with VBA in Excel", "body": "<p>I am working on a schedule determining who is going to cook and who is doing dishes for a trip with some friends.\nI have the names for the participants listed in column \"A\" and using CountIf to see how many times the specific person appears on the schedule to make it fair for everyone. The code picks 2 random persons for cooking and 2 for dishes making sure they are not the same. Then putting those names into the schedule I have defined in the worksheet.\nMy current code looks like this and is working so far as intended.</p>\n\n<pre><code>Private Sub cookplan()\nlast_row = Range(\"A1\").End(xlDown).Row\nDim awesome()\nDim index1 As Integer\nDim index2 As Integer\nDim cook1 As String\nDim cook2 As String\nDim dish1 As String\nDim dish2 As String\nReDim awesome(last_row - 1, 0)\nFor i = 0 To last_row - 1\n    awesome(i, 0) = Range(\"A\" &amp; i + 1)\nNext\n\nFor i = 1 To 5\n        index1 = Int((last_row - 1 - 0 + 1) * Rnd + 0)\n        cook1 = awesome(index1, 0)\n        Cells(i * 2, 6).Value = cook1\n\n        Do\n            index2 = Int((last_row - 1 - 0 + 1) * Rnd + 0)\n            cook2 = awesome(index2, 0)\n            Cells(i * 2, 7).Value = cook2\n        Loop While cook2 = cook1\n\n        Do\n            index1 = Int((last_row - 1 - 0 + 1) * Rnd + 0)\n            dish1 = awesome(index1, 0)\n        Loop While dish1 = cook1 Or dish1 = cook2\n\n        Do\n            index2 = Int((last_row - 1 - 0 + 1) * Rnd + 0)\n            dish2 = awesome(index2, 0)\n        Loop While dish2 = cook1 Or dish2 = cook2 Or dish2 = dish1\n\n        Cells(i * 2, 8).Value = dish1\n        Cells(i * 2, 9).Value = dish2\nNext\nEnd Sub\n</code></pre>\n\n<p>Is there a way to make a name appear a maximum and minimum number of times? As it is now, 2 or 3 times seems to be a fair number when I run the code and look at the CountIf results.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I have now gotten the code to work as intended. Each person needs at least one cooking and dishes duty, so the coding looks like this now. I know it is not that pretty, but it gets the job done :)</p>\n\n<pre><code>Private Sub cookplan()\nlast_row = Range(\"A1\").End(xlDown).Row\nDim awesome()\nDim index As Integer\nDim cook1 As String\nDim cook2 As String\nDim dish1 As String\nDim dish2 As String\nDim counter1 As Integer\nDim counter2 As Integer\nReDim awesome(last_row - 2, 0)\nFor i = 0 To last_row - 2\n    awesome(i, 0) = Range(\"A\" &amp; i + 2)\nNext\nDo\n    For i = 1 To 5\n        Do\n            index = Int((last_row - 2 - 0 + 1) * Rnd + 0)\n            cook1 = awesome(index, 0)\n            Cells(i * 2, 6).Value = cook1\n        Loop While Cells(index + 2, 2) &gt; 2 Or Cells(index + 2, 3) &gt; 2\n        Do\n            index = Int((last_row - 2 - 0 + 1) * Rnd + 0)\n            cook2 = awesome(index, 0)\n            Cells(i * 2, 7).Value = cook2\n        Loop While Cells(index + 2, 2) &gt; 2 Or Cells(index + 2, 3) &gt; 2 Or cook2 = cook1\n        Do\n            index = Int((last_row - 2 - 0 + 1) * Rnd + 0)\n            dish1 = awesome(index, 0)\n            Cells(i * 2, 8).Value = dish1\n        Loop While Cells(index + 2, 2) &gt; 2 Or Cells(index + 2, 3) &gt; 2 Or dish1 = cook1 Or dish1 = cook2\n        Do\n            index = Int((last_row - 2 - 0 + 1) * Rnd + 0)\n            dish2 = awesome(index, 0)\n            Cells(i * 2, 9).Value = dish2\n        Loop While Cells(index + 2, 2) &gt; 2 Or Cells(index + 2, 3) &gt; 2 Or dish2 = cook1 Or dish2 = cook2 Or dish2 = dish1\n    Next\n    counter1 = 0\n    counter2 = 0\n    For i = 2 To last_row\n        If Cells(i, 2).Value = 0 Then\n            counter1 = counter1 + 1\n        End If\n        If Cells(i, 3).Value = 0 Then\n            counter2 = counter2 + 1\n        End If\n    Next\nLoop While counter1 &gt; 0 Or counter2 &gt; 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "format", "string-formatting"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1470241043, "post_id": 38748579, "comment_id": 64871492, "body": "Try using <code>Length:=Len(ActiveCell.Offset(0,1))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1470242031, "post_id": 38749151, "comment_id": 64872082, "body": "I don&#39;t think you&#39;ll be able to call it length, <code>length:=length</code> looks like it would cause a reserved name problem"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1470242481, "post_id": 38749151, "comment_id": 64872356, "body": "Length:= is a named parameter not a reserved word."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1470308691, "post_id": 38749151, "comment_id": 64902584, "body": "I&#39;m glad that I could help!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1470242304, "last_edit_date": 1470242304, "creation_date": 1470241936, "answer_id": 38749151, "question_id": 38748579, "link": "https://stackoverflow.com/questions/38748579/excel-vba-formatting-partial-string-in-a-cell-using-the-length-of-a-string-in/38749151#38749151", "title": "Excel VBA - Formatting partial string in a cell using the length of a string in a different cell", "body": "<p>Here is how you can iterate over Range(\"C4:C30\") and change the character formatting based on the text length in Range(\"D4:D30\").</p>\n\n<pre><code>Sub Example()\n    Dim r As Range\n    Dim length As Integer\n\n    For Each r In Range(\"C4:C30\")\n        length = Len(r.Offset(0, 1))\n\n        With r.Characters(Start:=1, Length:=length).Font\n            .Color = -16776961\n        End With\n\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6673196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9dc4f28a31e81e02e013de7036077a8?s=128&d=identicon&r=PG&f=1", "display_name": "0263359", "link": "https://stackoverflow.com/users/6673196/0263359"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 870, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470242304, "creation_date": 1470240202, "question_id": 38748579, "link": "https://stackoverflow.com/questions/38748579/excel-vba-formatting-partial-string-in-a-cell-using-the-length-of-a-string-in", "title": "Excel VBA - Formatting partial string in a cell using the length of a string in a different cell", "body": "<p>I'm trying to automate a the formatting of a spreadsheet, and I'm stuck on formatting part of a string in a cell. What I need to do is change the colour of part of a string (starting at the beginning of the string) based on the length of the cell next to it.</p>\n\n<p>I think I've figured out part of the solution but I'm not sure on one bit:</p>\n\n<pre><code>Sub Macro1()\nRange(\"C4\").Select\nWith ActiveCell.Characters(Start:=1, Length:=??).font\n.Color = -16776961\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I want the ?? to be the length of the cell next to it (in this case D4)</p>\n\n<p>I haven't been using VBA for long, so I'm not even sure I'm on the right track. </p>\n\n<p>If it makes any difference, I would like to be able to apply the formatting to a range of cells (something like C4:C30), but that is beyond me at the moment.</p>\n\n<p>Thanks for any help</p>\n"}, {"tags": ["excel", "vba", "optimization"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1470240646, "post_id": 38748556, "comment_id": 64871211, "body": "If your code works but you want it improved, you should consider deleting the question here and posting it to <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a> instead."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1470240756, "post_id": 38748556, "comment_id": 64871272, "body": "I didn&#39;t even know that existed. Thank you so much John!"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1470240924, "post_id": 38748556, "comment_id": 64871393, "body": "It is useful to know that that site exists, but now that you already have at least one answer, you should probably leave it here since cross-posting is frowned upon."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1470240940, "post_id": 38748556, "comment_id": 64871405, "body": "@JohnColeman, you are right. I should have recommended as such and posted my answer there. Either way, my answer below will do this much faster than 30 seconds."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1470241971, "post_id": 38748556, "comment_id": 64872053, "body": "I will leave it here, but keep in mind that questions of this sort would be better placed in the code review site in the future. :)"}], "answers": [{"comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470241191, "post_id": 38748767, "comment_id": 64871594, "body": "There&#39;s no way this runs. You&#39;re splitting <code>str</code> which you never define, so that alone will give an error. And you&#39;re always indexing only the first substring <code>S(1)</code> instead of using the loop variable you defined <code>j</code>, so you&#39;ll never count anything but the first word in each sentence."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1470241811, "post_id": 38748767, "comment_id": 64871952, "body": "For me it doesn&#39;t produce any output at all. I&#39;m not familiar enough with many of these scripts to pinpoint specific issues though. Thanks Mikegrann for pointing out the potential problem."}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470244174, "post_id": 38748767, "comment_id": 64873407, "body": "@Comintern It does compile because str does get declared as a Variant up at the top. It&#39;s definitely bad form to do that, but at least it could have passed a compiler check before he posted up an answer. At least, VBE compiles and runs it (with no output of course) for me as-is."}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "reply_to_user": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1470244292, "post_id": 38748767, "comment_id": 64873468, "body": "@EmilyAlden Kyle hasn&#39;t edited out his errors. Did you manage to fix it based on my suggestions? You should replace <code>S = Split(str, &quot; &quot;)</code> with <code>Split(X(i, 1), &quot; &quot;)</code> and replace every instance of <code>S(1)</code> with <code>S(j)</code>. I also suggest considering using something like <code>Lcase(S(j))</code> instead, so that you can count &quot;Hello&quot; and &quot;hello&quot; and &quot;heLLo&quot; as the same words. Might even want to strip punctuation (<a href=\"http://stackoverflow.com/questions/1355215/strip-all-punctuation-from-a-string-in-vb-net\" title=\"strip all punctuation from a string in vb net\">stackoverflow.com/questions/1355215/&hellip;</a>) such that &quot;Hello&quot; and &quot;Hello!&quot; match."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470245020, "post_id": 38748767, "comment_id": 64873861, "body": "@Mikegrann That worked perfectly! (And far more quickly then mine) Thank you so much. I am going to strip punctuation and that thread will be very helpful as well."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470246169, "post_id": 38748767, "comment_id": 64874533, "body": "@Mikegrann Thanks for correcting my stupid mistakes. I had a script I wrote the other day to do basically this same thing and did a sloppy job cleaning it up to post here."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1470246420, "post_id": 38748767, "comment_id": 64874669, "body": "@EmilyAlden In the script I copied this from, I take out a bunch of punctuation and other characters. if you are interested, I can post that code as well."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1470246706, "post_id": 38748767, "comment_id": 64874818, "body": "@Kyle: I&#39;ve got that figured out. Thanks for the offer though. I&#39;ve definitely copy pasted code and then not been able to figure out why it wasn&#39;t working because I forgot to change worksheet names and such. No worries."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1470249811, "post_id": 38748767, "comment_id": 64876555, "body": "@Kyle: Actually could you add that in. I cannot seem to get my code to work with the Regex command that Mikegrann linked. I&#39;m sure I&#39;m missing some basic syntax. I want to remove everything that is not a letter or a space."}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": true, "score": 0, "last_activity_date": 1470250457, "last_edit_date": 1470250457, "creation_date": 1470240753, "answer_id": 38748767, "question_id": 38748556, "link": "https://stackoverflow.com/questions/38748556/optomizing-excel-vba-with-multiple-loops/38748767#38748767", "title": "Optomizing Excel VBA with Multiple Loops", "body": "<p>I am going to assume that all the sentences are single line and contain one space between words. Add a sheet called \"Output\" to your workbook. In cell A1 type a header (ex \"Word\") and in cells B2 type a header (ex \"Count\"). The following will take your sentences and output the words in column A and the count of the words in column B, then will sort so the most used is at the top. Depending on how much data you have, this should take a second or two to run.</p>\n\n<p>Note: You will need to add a reference to the \"Microsoft Scripting Runtime\" library.</p>\n\n<pre><code>Sub Example()\nDim X As Variant, S As Variant, key As Variant\nDim str As String\nDim oDict As Scripting.Dictionary\nDim i As Double, j As Double, k As Double\nDim Anchor As Range\n\nSet oDict = New Scripting.Dictionary\n\nWith ThisWorkbook\n   'Clear past output\n   With .Sheets(\"Output\")\n       .Range(\"a2:\" &amp; .Cells(.Rows.Count,    .Columns.Count).Address).ClearContents\n   End With\n\n'Fill array with text to search\n   With .Sheets(\"Raw\")\n       X = .Range(\"a2:a\" &amp; .Range(\"a\" &amp; .Rows.Count).End(xlUp).Row).Value2\n   End With\nEnd With\n\nFor i = LBound(X,1) To UBound(X,1)\n  S = Split(X(i,1), \" \")\n\n  For j = LBound(S, 1) To UBound(S, 1)\n      If oDict.Exists(S(j)) Then\n          oDict.Item(S(j)) = oDict.Item(S(j)) + 1\n      Else\n          oDict.Add S(j), 1\n      End If\n  Next j\nNext i\n\n'Output results to sheet \"Output\"\nWith ThisWorkbook.Sheets(\"Output\")\nFor Each key In oDict.Keys\n    Set Anchor = .Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\n    Anchor = key\n    Anchor.Offset(0, 1) = oDict.Item(key)\nNext key\n\n.Range(\"a1:\" &amp; .Range(\"a\" &amp; .Rows.Count).End(xlUp).Offset(0, 1).Address).Sort .Range(\"b:b\"), xlDescending\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Here is my full, unadulterated code. Note that the workbook and sheet references are not updated for your purpose. to use RegExp, you will need to add a reference to the \"Microsoft VBScript Regular Expressions 5.5\" library. I use \"5.5\", but I'm sure any will work for this. </p>\n\n<pre><code> Sub Example()\n Dim X As Variant, S As Variant, S2 As Variant, S3 As Variant, key As      Variant\n Dim oDict As Scripting.Dictionary\n Dim i As Double, j As Double, k As Double\n Dim Anchor As Range\n Dim oReg As New RegExp\n Dim str As String\n Dim st As Single\n\n Application.ScreenUpdating = False\n\n\n st = Timer\n Set oDict = New Scripting.Dictionary\n\n With ThisWorkbook\n 'Clear past output\n     With .Sheets(\"Output\")\n         .Range(\"a2:\" &amp; .Cells(.Rows.Count, .Columns.Count).Address).ClearContents\n     End With\n\n     'Fill array with text to search\n     With .Sheets(\"Input\")\n         X = .Range(\"a2:a\" &amp; .Range(\"a\" &amp; .Rows.Count).End(xlUp).Row).Value2\n     End With\n End With\n\n With oReg\n     .Global = True\n     .IgnoreCase = True\n     .Pattern = \"[^\\w\\s]\"\n End With\n\n For i = LBound(X, 1) + 1 To UBound(X, 1)\n     'Get rid of none letter and white space\n          str = oReg.Replace(X(i, 1), \"\")\n\n\n     S = Split(str, \" \")\n\n     For j = LBound(S, 1) To UBound(S, 1)\n         If oDict.Exists(LCase(S(j))) Then\n             oDict.Item(LCase(S(j))) = oDict.Item(LCase(S(j))) + 1\n         Else\n             oDict.Add LCase(S(j)), 1\n         End If\n     Next j\n Next i\n\n 'Output results to sheet \"Output\"\n With ThisWorkbook.Sheets(\"Output\")\n     For Each key In oDict.Keys\n         Set Anchor = .Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\n         Anchor = key\n         Anchor.Offset(0, 1) = oDict.Item(key)\n     Next key\n\n      .Range(\"a1:\" &amp; .Range(\"a\" &amp; .Rows.Count).End(xlUp).Offset(0, 1).Address).Sort .Range(\"b:b\"), xlDescending\n End With\n\n Debug.Print Timer - st\n\n Application.ScreenUpdating = True\n End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 170, "user_id": 6142378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593e89e4256dd201a541c13e29abdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Dammer15", "link": "https://stackoverflow.com/users/6142378/dammer15"}, "is_accepted": false, "score": 0, "last_activity_date": 1470252218, "creation_date": 1470252218, "answer_id": 38752037, "question_id": 38748556, "link": "https://stackoverflow.com/questions/38748556/optomizing-excel-vba-with-multiple-loops/38752037#38752037", "title": "Optomizing Excel VBA with Multiple Loops", "body": "<p>Your function takes so long to run because you are operating within the excel sheet cell by cell. This method does not pull any data into RAM memory(Fast). Simply take the columns of interest and insert them into an array or list. Operate on the list in the same way your function does. This will drastically speed up it's operation. \nFor instance,</p>\n\n<pre><code>Dim Whole_Sentence_List As New Collection\nDim Word_Count_List As New Collection\nDim Array_of_Words_List As New Collection\n</code></pre>\n\n<p>Array_of_Words_List is a collection of Arrays that you can put the words of sentence into one by one instead of 3,4,5...100th Column. Play around with collections for awhile to get an understanding of how they work</p>\n"}], "owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 38748767, "answer_count": 2, "score": 0, "last_activity_date": 1470252218, "creation_date": 1470240144, "question_id": 38748556, "link": "https://stackoverflow.com/questions/38748556/optomizing-excel-vba-with-multiple-loops", "title": "Optomizing Excel VBA with Multiple Loops", "body": "<p>I am new to Excel VBA code and I need help optimizing this code. It does exactly what I want it to do, but takes almost 30 seconds to run which will not be acceptable to the end users.</p>\n\n<p>The purpose is to assess how often a word is used with inputs being sentences. In the sheet \"Raw\" the first column is the whole sentence. The second is a count of how many words are in the sentence. And the third-100th are the first, second, third.... word in the sentence. Up to 1,000 sentences are analyzed at one time. </p>\n\n<p>It is then pasted into the first column of \"OneColumn\" only if they are unique. I tried pasting all and then removing duplicates, but that ran to about 45 seconds. </p>\n\n<p>I am certainly open to other ways to analyze how often a word is used, but I could not figure out how to have it check within the cells for counting without breaking them out. </p>\n\n<p>I would greatly appreciate any help. </p>\n\n<pre><code>   Option Explicit\n\nSub ListUniqueWords()\nDim i As Integer\nDim j As Integer\nDim k As Integer\n\nDim StartTime As Double\nDim SecondsElapsed As Double\n  StartTime = Timer\n\ni = 2\nj = 3\nk = 2\n\n'i=row j=column k=paste into row\n\n   Do While i &lt; 1001\n    j = 3\n            Do While j &lt; 103\n                            If Sheets(\"Raw\").Cells(i, j).Value &lt;&gt; \"\" And Sheets(\"Raw\").Cells(i, j).Value &lt;&gt; \" \" And Sheets(\"OneColumn\").Range(\"A2:A2000\").Find(Sheets(\"Raw\").Cells(i, j), LookAt:=xlWhole) Is Nothing Then\n                                    Worksheets(\"Raw\").Activate\n                                    Cells(i, j).Select\n                                    Selection.Copy\n                                    Worksheets(\"OneColumn\").Activate\n                                    Cells(k, 1).Activate\n                                    ActiveCell.PasteSpecial Paste:=xlPasteValues\n                                    k = k + 1\n                                    j = j + 1\n                                Else\n                                    j = j + 1\n                                End If\n            Loop\n            i = i + 1\n    Loop\nSecondsElapsed = Round(Timer - StartTime, 2)\n  MsgBox \"This code ran successfully in \" &amp; SecondsElapsed &amp; \" seconds\", vbInformation\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470240800, "post_id": 38748459, "comment_id": 64871303, "body": "Can&#39;t do <code>myForward.Recipients.Add &quot;test@test.com&quot;</code> and <code>myForward.Recipients.Add &quot;test1@test.com&quot;</code> and <code>myForward.Recipients.Add &quot;test2@test.com&quot;</code>? Should be able to just add more lines with recipients."}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1470247462, "last_edit_date": 1470247462, "creation_date": 1470241091, "answer_id": 38748886, "question_id": 38748459, "link": "https://stackoverflow.com/questions/38748459/forwarding-outlook-emails-to-multiple-recipients/38748886#38748886", "title": "Forwarding Outlook Emails to Multiple Recipients", "body": "<p>Try adding  the following line for each recipient </p>\n\n<pre><code>myForward.Recipients.Add \"test1@test.com\"\n\nmyForward.Recipients.Add \"test2@test.com\"\n\nmyForward.Recipients.Add \"test3@test.com\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1470245165, "creation_date": 1470245165, "answer_id": 38750104, "question_id": 38748459, "link": "https://stackoverflow.com/questions/38748459/forwarding-outlook-emails-to-multiple-recipients/38750104#38750104", "title": "Forwarding Outlook Emails to Multiple Recipients", "body": "<p>Or set the <code>Mailtem.To</code> property to a \";\" separated list of addresses. </p>\n"}], "owner": {"reputation": 13, "user_id": 6673223, "user_type": "registered", "profile_image": "https://graph.facebook.com/1130823743656980/picture?type=large", "display_name": "Sergey Alakov", "link": "https://stackoverflow.com/users/6673223/sergey-alakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 38748886, "answer_count": 2, "score": 1, "last_activity_date": 1592873189, "creation_date": 1470239840, "last_edit_date": 1592873189, "question_id": 38748459, "link": "https://stackoverflow.com/questions/38748459/forwarding-outlook-emails-to-multiple-recipients", "title": "Forwarding Outlook Emails to Multiple Recipients", "body": "<p>How do I add multiple email addresses to the myForward.Recipients.Add bit? I've tried adding them like that <strong><code>\"test@test.com; test1@test.com; test2@test.com\",</code></strong> </p>\n\n<p>But only the first one receives the message. </p>\n\n<pre><code>Sub ChangeSubjectForward(Item As Outlook.MailItem)\n    Item.Subject = \"Test\"\n Item.Save\n\nSet myForward = Item.Forward\nmyForward.Recipients.Add \"test@test.com\"\n\nmyForward.Send\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "rounding", "truncate"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1470239225, "post_id": 38748110, "comment_id": 64870226, "body": "What do you mean - loop through all the worksheets? Or loop through multiple ranges in the same worksheet?"}, {"owner": {"reputation": 130, "user_id": 6662729, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/da2d2b80e8602c4425d1ff8e375dfed8?s=128&d=identicon&r=PG&f=1", "display_name": "lo1gur", "link": "https://stackoverflow.com/users/6662729/lo1gur"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1470315931, "post_id": 38748110, "comment_id": 64907412, "body": "I meant loop through multiple ranges in the same worksheet, sorry if it wasnt clear !"}], "answers": [{"comments": [{"owner": {"reputation": 130, "user_id": 6662729, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/da2d2b80e8602c4425d1ff8e375dfed8?s=128&d=identicon&r=PG&f=1", "display_name": "lo1gur", "link": "https://stackoverflow.com/users/6662729/lo1gur"}, "edited": false, "score": 0, "creation_date": 1470316660, "post_id": 38748197, "comment_id": 64908005, "body": "When I try to run the marco I get an error message saying &quot;Argument not optional&quot; for thousand. I changed the function to declare thousand as a Variant as well but i still get &quot;argument not optional for <code>Debug.Print thousand(DSA.Worksheets(1).Range(&quot;G10&quot;))</code>   Do you know why ? I think I may need to add a &#39;Set&#39; somewhere !"}], "tags": [], "owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "is_accepted": false, "score": 1, "last_activity_date": 1470239083, "creation_date": 1470239083, "answer_id": 38748197, "question_id": 38748110, "link": "https://stackoverflow.com/questions/38748110/call-function-sub-in-code-vba/38748197#38748197", "title": "Call function/Sub in code vba", "body": "<p>I'm not exactly sure what you mean but instead of the sub just use a function and pass different i:</p>\n\n<pre><code>Function thousand(i As Variant) As Variant\n\nIf Right(i, 3) = \"000\" Then\n  thousand = Left(i, Len(i) - 3)\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Then you just do something along the lines of <code>debug.print thousand(DSA.Worksheets(1).Range(\"G10\"))</code></p>\n"}], "owner": {"reputation": 130, "user_id": 6662729, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/da2d2b80e8602c4425d1ff8e375dfed8?s=128&d=identicon&r=PG&f=1", "display_name": "lo1gur", "link": "https://stackoverflow.com/users/6662729/lo1gur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470239083, "creation_date": 1470238828, "question_id": 38748110, "link": "https://stackoverflow.com/questions/38748110/call-function-sub-in-code-vba", "title": "Call function/Sub in code vba", "body": "<p>I wrote a code in VBA that takes values from a workbook and copies them to another workbook. So for instance in cell G20 I will have  45 678\nThe code then rounds this number to 46 000, and then I need a function to delete the last 3 figures if the number is big enough using the If statement provided below.\nI think the content is right but I don't think I am calling it the right way.</p>\n\n<pre><code>DSA.Worksheets(1).Range(\"G10\").Value = Application.WorksheetFunction.Round(tax_declaration.Worksheets(1)Range(\"I72\").Value, -3)\nDSA.Worksheets(1).Range(\"G11\").Value = Application.WorksheetFunction.Round(Val(Application.WorksheetFunction.Sum(Range(\"I25:I27\"))), -3)\n\nCall thousand(DSA.Worksheets(1).Range(\"G10\"))\n\nEnd Sub\n\nSub thousand(i As Variant)\n\nIf Right(i, 3) = \"000\" Then\n  i = Left(i, Len(i) - 3)\nEnd If\n\nEnd Sub`\n</code></pre>\n\n<p>How could I create a function like my If statement, and use it to Loop through all my 'DSA.Worksheets(1)Ranges' ? - I have several of those.</p>\n\n<p>Thanks in advance !</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1470238560, "post_id": 38747963, "comment_id": 64869748, "body": "Try <code>.Cells.Find(&quot;260707&quot;)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470239524, "post_id": 38748216, "comment_id": 64870461, "body": "<code>.Find</code> takes a <code>Variant</code> as the <code>What</code> parameter, and it can be &quot;a string or any Microsoft Excel data type&quot;.  This code will explicitly cast a <code>Long</code> literal to a <code>String</code>, then <i>implicitly</i> cast it to a <code>Variant</code>. The end result is pretty much the same as the OP&#39;s code."}, {"owner": {"reputation": 13, "user_id": 6673125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9461ff60df2e6ab42e3b986311276efb?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6673125/andre"}, "edited": false, "score": 0, "creation_date": 1470247655, "post_id": 38748216, "comment_id": 64875314, "body": "That solved it! thank you. Now, I am getting the NTlogin and Role variables return as blank, when they should be whatever the text value in those cells are. Is there something else I need to change with the way I defined those variables?"}, {"owner": {"reputation": 1386, "user_id": 2712565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/269uE.png?s=128&g=1", "display_name": "GlennFromIowa", "link": "https://stackoverflow.com/users/2712565/glennfromiowa"}, "reply_to_user": {"reputation": 13, "user_id": 6673125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9461ff60df2e6ab42e3b986311276efb?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6673125/andre"}, "edited": false, "score": 0, "creation_date": 1470442648, "post_id": 38748216, "comment_id": 64968780, "body": "@Andre I&#39;m not sure if this will solve it or not, but I use the <i>.Value</i> property instead of .Text. I remember there&#39;s a subtle difference between the two, but can&#39;t remember right now what it is.   <code>NTlogin = .Cells(FoundRange.Rows, 1).Value</code> <code>Role = .Cells(FoundRange.Rows, 4).Value</code>"}, {"owner": {"reputation": 1386, "user_id": 2712565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/269uE.png?s=128&g=1", "display_name": "GlennFromIowa", "link": "https://stackoverflow.com/users/2712565/glennfromiowa"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470443664, "post_id": 38748216, "comment_id": 64968983, "body": "@Comintern I almost wish it were that easy. Variants actually have types also, depending on what is stored in the variable, and a <i>string</i> Variant often doesn&#39;t match a <i>numeric</i> Variant. The msdn <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251448.aspx\" rel=\"nofollow noreferrer\">Variant Data Type</a> page: &quot;Generally, numeric Variant data is maintained in its original data type within the Variant.&quot; And if you have a way to have VLOOKUP() find a number in cells either stored as text or as a numeric value automatically, I&#39;d love to hear that, because I&#39;m always having to switch it manually from one type to the other."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470444122, "post_id": 38748216, "comment_id": 64969059, "body": "@GlennFromIowa - Yes, I know all about <a href=\"http://stackoverflow.com/documentation/vba/3418/data-types-and-limits/11786/variant#t=201608060036163968204\">Variants</a>.  Point taken though - it would be a Variant(String) instead of a Variant(Long).  That&#39;s why I usually roll my own lookups instead of using the Excel ones.  ;-)"}], "tags": [], "owner": {"reputation": 1386, "user_id": 2712565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/269uE.png?s=128&g=1", "display_name": "GlennFromIowa", "link": "https://stackoverflow.com/users/2712565/glennfromiowa"}, "is_accepted": false, "score": 0, "last_activity_date": 1470239153, "creation_date": 1470239153, "answer_id": 38748216, "question_id": 38747963, "link": "https://stackoverflow.com/questions/38747963/using-word-vba-to-automate-excel-i-get-run-time-error-13-type-mismatch-when/38748216#38748216", "title": "Using Word VBA to automate Excel, I get Run-time error &#39;13&#39;: Type mismatch when using the .Find function", "body": "<p>With the assumption that the ID values are stored as text in the worksheet, either with a cell type of Text or with an apostrophe/single-quote in front of the number, you may need to format the ID as string. With the further assumption that eventually you may want to pass the ID via parameter to the procedure, give this a try:</p>\n\n<p><code>Set FoundRange = .Cells.Find(CStr(260707))</code></p>\n\n<p>That will also allow you to replace the constant number with a variable if desired.</p>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 2, "last_activity_date": 1470239179, "creation_date": 1470239179, "answer_id": 38748225, "question_id": 38747963, "link": "https://stackoverflow.com/questions/38747963/using-word-vba-to-automate-excel-i-get-run-time-error-13-type-mismatch-when/38748225#38748225", "title": "Using Word VBA to automate Excel, I get Run-time error &#39;13&#39;: Type mismatch when using the .Find function", "body": "<p>You are using late binding and have <code>FoundRange</code> declared as a <code>Range</code>.  Since this is in a Word document, you're implicitly declaring it as a <code>Word.Range</code> here:</p>\n\n<pre><code>Dim FoundRange As Range\n</code></pre>\n\n<p><code>.Find</code> is returning an <code>Excel.Range</code>. Change it to:</p>\n\n<pre><code>Dim FoundRange As Object\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6673125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9461ff60df2e6ab42e3b986311276efb?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/6673125/andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 38748225, "answer_count": 2, "score": 1, "last_activity_date": 1470239179, "creation_date": 1470238429, "question_id": 38747963, "link": "https://stackoverflow.com/questions/38747963/using-word-vba-to-automate-excel-i-get-run-time-error-13-type-mismatch-when", "title": "Using Word VBA to automate Excel, I get Run-time error &#39;13&#39;: Type mismatch when using the .Find function", "body": "<p>I'm trying to get data from an excel sheet to a word document. I try using the 'Find' function however I keep getting the same error \"Type mismatch\" on this line:</p>\n\n<pre><code>Set FoundRange = .Cells.Find(260707)\n</code></pre>\n\n<p>Here is the subroutine I am running.</p>\n\n<pre><code>    Sub GetID()\nDim oXL As Object\nDim oWB As Object\nDim oSheet As Object\nDim WorkbookToWorkOn As String\nDim FoundRange As Range\nDim dummyvar As String\n\n'Start a new instance of Excel\nSet oXL = CreateObject(\"Excel.Application\")\n'Line to make Excel Visible or not\noXL.Visible = False\n'Open the workbook\n'Set the file path to access the 'Certified Personnel' table\nWorkbookToWorkOn = \"\\\\DataSource\\CertifiedPersonnel.xlsx\"\nSet oWB = oXL.Workbooks.Open(FileName:=WorkbookToWorkOn, ReadOnly:=True, IgnoreReadOnlyRecommended:=True)\nSet oSheet = oXL.ActiveWorkbook.Sheets(\"tblCertifiedPersonnel\")\n'End of Excel Automation. Everything from this point on can reference Excel.\n\nWith oSheet\n    dummyvar = .Cells(1, 2).Text\n    .Cells(1, 2).Select\n    'Set the range of the cell containing the ID number\n     'If the ID was found\n    Set FoundRange = .Cells.Find(260707)\n\n    If Not FoundRange Is Nothing Then\n        'Set the NTlogin equal to the value of column 1, and row corresponding to the FoundRange row\n        NTlogin = .Cells(FoundRange.Rows, 1).Text\n        Role = .Cells(FoundRange.Rows, 4).Text\n    End If\nEnd With\n\n'End Excel reference\noXL.ActiveWorkbook.Close SaveChanges:=False\noXL.Application.Quit\nSet oXL = Nothing\nSet oWB = Nothing\nSet oSheet = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>I know it is accessing the correct workbook, because the dummy variable (dummyvar) is returning the value I expect. I have tried several things related to the 'Find' function, however I have not been able to get it to work. Any ideas? Much appreciated.</p>\n"}, {"tags": ["vba", "input", "textbox", "controls"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470238548, "post_id": 38747863, "comment_id": 64869739, "body": "Could write an onchange handler to actively check that the input fits the format you expect."}, {"owner": {"reputation": 3190, "user_id": 5496634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207922765092562/picture?type=large", "display_name": "Sam", "link": "https://stackoverflow.com/users/5496634/sam"}, "edited": false, "score": 0, "creation_date": 1470239339, "post_id": 38747863, "comment_id": 64870316, "body": "You could use regex if you never need the code to work on a mac. Are you okay with no mac compatibility for the code?"}, {"owner": {"reputation": 6037, "user_id": 521554, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/595a13ad379874ee331b6693e959a005?s=128&d=identicon&r=PG", "display_name": "LosManos", "link": "https://stackoverflow.com/users/521554/losmanos"}, "edited": false, "score": 0, "creation_date": 1470253505, "post_id": 38747863, "comment_id": 64878664, "body": "Better title. Small text changes."}, {"owner": {"reputation": 1, "user_id": 6673121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c60912817cdecefbf6a3d32cb29b297?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Robinson", "link": "https://stackoverflow.com/users/6673121/rob-robinson"}, "edited": false, "score": 0, "creation_date": 1470297550, "post_id": 38747863, "comment_id": 64895095, "body": "The document will be sent out to lots of people so there is a chance that some of them will be mac users."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6673121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c60912817cdecefbf6a3d32cb29b297?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Robinson", "link": "https://stackoverflow.com/users/6673121/rob-robinson"}, "edited": false, "score": 0, "creation_date": 1470297493, "post_id": 38748663, "comment_id": 64895068, "body": "This was really helpful, thanks and I have got most of what I needed however I need the entry after the character to be a letter not a digit and so using ignoring anything but numbers doesn&#39;t work for my case."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1470240494, "creation_date": 1470240494, "answer_id": 38748663, "question_id": 38747863, "link": "https://stackoverflow.com/questions/38747863/how-to-force-the-input-of-a-textbox-on-a-userform-to-be-a-specific-format-in-vba/38748663#38748663", "title": "How to force the input of a textbox on a userform to be a specific format in VBA", "body": "<p>The built in <code>Textbox</code> is a little lacking in this department. The way I'd approach this would be to use the <code>Change</code> event to enforce formatting. Note that the Key* events won't handle any of the other ways to get text into a Textbox (drag-drop, copy-paste, etc.). Something along these lines (this is for zip + 4, but a similar concept would work):</p>\n\n<pre><code>Private Sub TextBox1_Change()\n    Static reentry As Boolean                           'anti-recursion flag\n    If reentry Then Exit Sub\n    Dim chars() As Byte\n    chars = StrConv(TextBox1.Text, vbFromUnicode)\n\n    Dim buffer As String\n    Dim i As Integer\n    For i = LBound(chars) To UBound(chars)\n        If Len(buffer) = 5 Then buffer = buffer &amp; \"-\"   'auto-insert the dash\n        If Len(buffer) = 10 Then Exit For               'limit to 10 chars\n        If chars(i) &gt;= 48 And chars(i) &lt;= 57 Then       'ignore anything but numbers.\n            buffer = buffer &amp; Chr$(chars(i))\n        End If\n    Next i\n\n    reentry = True\n    TextBox1.Text = buffer\n    reentry = False\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6673121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c60912817cdecefbf6a3d32cb29b297?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Robinson", "link": "https://stackoverflow.com/users/6673121/rob-robinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1470668487, "creation_date": 1470668487, "answer_id": 38832570, "question_id": 38747863, "link": "https://stackoverflow.com/questions/38747863/how-to-force-the-input-of-a-textbox-on-a-userform-to-be-a-specific-format-in-vba/38832570#38832570", "title": "How to force the input of a textbox on a userform to be a specific format in VBA", "body": "<p>I came up with a solution that works okay, I'm sure this could be improved to prevent the user inputting special characters but this works well enough to reduce most errors</p>\n\n<pre><code>'Checks that document number is the correct format (5 digits, 1 letter, 4 digits)\nSub TextBox_DocumentNumber_AfterUpdate()\n\nIf (IsNumeric(Left(TextBox_DocumentNumber, 5))) = False Then\nCall DocumentNumberFormat\n\n\nElseIf (IsNumeric(Mid(TextBox_DocumentNumber, 7))) = True Then\nCall DocumentNumberFormat\n\n\nElseIf (IsNumeric(Right(TextBox_DocumentNumber, 4))) = False Then\nCall DocumentNumberFormat\n\nEnd If\n\nEnd Sub\n\n\n\nSub DocumentNumberFormat()\n\nDim DocNum As String\nDim Response As VbMsgBoxResult\n\nDocNum = MsgBox(\"Please enter document numbers in the formart 00000-A-0000\", vbRetryCancel + vbExclamation, \"Incorrect Format\")\n\n\nUserForm3.TextBox_DocumentNumber = \"\"\nIf DocNum = vbCancel Then\n           Call Cancel\nEnd If\n\nExit Sub\nEnd Sub\n\n\n\n\n\n'Auto inserts hyphens and sets max length for document number\nPrivate Sub TextBox_DocumentNumber_Change()\nIf Len(TextBox_DocumentNumber) = 5 Then TextBox_DocumentNumber = TextBox_DocumentNumber &amp; \"-\"\nIf Len(TextBox_DocumentNumber) = 7 Then TextBox_DocumentNumber = TextBox_DocumentNumber &amp; \"-\"\nTextBox_DocumentNumber.MaxLength = 12\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6673121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c60912817cdecefbf6a3d32cb29b297?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Robinson", "link": "https://stackoverflow.com/users/6673121/rob-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1852, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1470668487, "creation_date": 1470238173, "last_edit_date": 1470253354, "question_id": 38747863, "link": "https://stackoverflow.com/questions/38747863/how-to-force-the-input-of-a-textbox-on-a-userform-to-be-a-specific-format-in-vba", "title": "How to force the input of a textbox on a userform to be a specific format in VBA", "body": "<p>I have a user form with a series of input textboxes and am looking for a way to prevent the user from inputing anything other than 5 digits followed by one letter followed by 4 digits. E.g. <em>12345A6789</em></p>\n\n<p>I can see a way to use only numeric and only alphabetic and create three text boxes and then somehow merge them all together- although not sure how to do that either. Ideally there would just be one textbox.  </p>\n\n<p>Any help is appreciated </p>\n"}, {"tags": ["excel", "vba", "vbscript", "macros", "windows-task-scheduler"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 2, "creation_date": 1470238393, "post_id": 38747849, "comment_id": 64869642, "body": "Windows Scheduler is probably the best option, honestly. Better not to have some process constantly running if you don&#39;t have to."}], "answers": [{"tags": [], "owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "is_accepted": true, "score": 0, "last_activity_date": 1470240667, "creation_date": 1470240667, "answer_id": 38748743, "question_id": 38747849, "link": "https://stackoverflow.com/questions/38747849/running-different-excel-macros-from-one-vbscript-at-different-hours/38748743#38748743", "title": "Running different excel macros from one vbscript at different hours", "body": "<p>You should be able to do this using the timer function which returns the number of seconds since midnight.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg264416.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg264416.aspx</a></p>\n\n<p>To ensure it's not checking every second try the Wait function as well. </p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff822851.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff822851.aspx</a></p>\n\n<p>I'm still new, so hopefully someone else will expand on this for you, but it should be a good starting point. </p>\n"}], "owner": {"reputation": 3, "user_id": 6673113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b9a17101f3ba5224fb621673a31f6a?s=128&d=identicon&r=PG&f=1", "display_name": "SneakyDexter", "link": "https://stackoverflow.com/users/6673113/sneakydexter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 38748743, "answer_count": 1, "score": 0, "last_activity_date": 1470240667, "creation_date": 1470238134, "question_id": 38747849, "link": "https://stackoverflow.com/questions/38747849/running-different-excel-macros-from-one-vbscript-at-different-hours", "title": "Running different excel macros from one vbscript at different hours", "body": "<p>I want to use <strong>vbs</strong> file - which will fire <strong>different macros</strong> at <strong>different hours</strong>. I was thinking about putting it in the <strong>windows startup programs</strong> folder</p>\n\n<p>The point is I want this vbs to fire each of these macros in different hours (Let's assume I will have machine on long enough).</p>\n\n<p>I tried to make separate vbs files for each macro and launch it with windows scheduler. It works, but i dont like this solution and I want to learn smth. To be clear what i want to achieve is:</p>\n\n<blockquote>\n  <p>Launching Computer at 12 -> VBScript is launching at windows start,\n  then it fires:</p>\n  \n  <p>Macro a at 13, and update it on 13.15</p>\n  \n  <p>Macro b at 15</p>\n  \n  <p>then Macro c at 16 using data from Macro b, and then closing itself\n  (both macro and vbs).</p>\n</blockquote>\n\n<p>OFC i will launch computer and close it manually :)</p>\n\n<p>Thanks,\nDawid</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "edited": false, "score": 1, "creation_date": 1470238099, "post_id": 38747554, "comment_id": 64869433, "body": "Presumably you could set your range dynamically using wb.ws.Range.Rows(4).Cells.Find(&quot;XXX&quot;).Offset(0, 1).Address. Not sure from your wording exactly what you need to use as the range though."}, {"owner": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "edited": false, "score": 0, "creation_date": 1470238421, "post_id": 38747554, "comment_id": 64869661, "body": "Well, depending on where you stand on VBA &amp; Excel, this may be too much of a stretch in terms of learning. However, I you are keen, I would strongly encourage you to learn about working with tables instead of raw ranges for this sort of things.  Tables will manage for you the active range, makes it easier to refer to specific columns by names, etc. They make VBA a lot easier to use as well...."}, {"owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "reply_to_user": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "edited": false, "score": 0, "creation_date": 1470238862, "post_id": 38747554, "comment_id": 64869965, "body": "@Francky_V Do you know of any good resources for learning this?"}, {"owner": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "edited": false, "score": 0, "creation_date": 1470239375, "post_id": 38747554, "comment_id": 64870340, "body": "Sure are a few - a quick cheatsheet that I refer to once in a while is this one: <a href=\"http://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/blog/2014/6/20/&hellip;</a> . It&#39;s good for the VBA part of using tables.  For the in-sheet formulas, that one is a good overview to start with:  <a href=\"http://peltiertech.com/structured-referencing-excel-tables/\" rel=\"nofollow noreferrer\">peltiertech.com/structured-referencing-excel-tables</a>  Like many other excel things, the value-add becomes clearer with use. The main gain is flexibility: it keeps tracks of ranges &amp; references for you, so no need for dirty $A$5:$B$15 anymore..."}, {"owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "reply_to_user": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "edited": false, "score": 0, "creation_date": 1470241924, "post_id": 38747554, "comment_id": 64872019, "body": "@TimEdwards I have an asset that records a value every month.  Rows are assets, and Columns are months.  After the last month of data (so at the end of the Row), Is a place holder column with the text &quot;XXX&quot; in a cell for each asset.  <a href=\"https://docs.google.com/spreadsheets/d/1B-dIFNkGhDyDwW63k-eLlvV_93XBnPKRS5Qf0hn11L8/edit?usp=sharing\" rel=\"nofollow noreferrer\"><b>Here</b></a> is a simplified version of the document.  The range I need to make Sparklines of is from the first value entered, to the cell before &quot;XXX&quot;.  That way the spark lines will automatically adjust no matter how many months of data I have."}, {"owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "reply_to_user": {"reputation": 1161, "user_id": 3633696, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d12ec3ab32aaa93f9c1438856dd72e0?s=128&d=identicon&r=PG&f=1", "display_name": "logicOnAbstractions", "link": "https://stackoverflow.com/users/3633696/logiconabstractions"}, "edited": false, "score": 0, "creation_date": 1470242403, "post_id": 38747554, "comment_id": 64872292, "body": "@Francky_V Thanks I&#39;ll have to read through this stuff when I get time."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "edited": false, "score": 0, "creation_date": 1470240707, "post_id": 38747856, "comment_id": 64871239, "body": "Doesn&#39;t seem to work.  I got this message.  Run-time error &#39;1004&#39;:                  Method &#39;Range&#39; of object&#39;_Global&#39; failed"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "edited": false, "score": 0, "creation_date": 1470241075, "post_id": 38747856, "comment_id": 64871511, "body": "What line did it fail on? Did you add your range in <code>yourRange</code>?"}, {"owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "edited": false, "score": 0, "creation_date": 1470242233, "post_id": 38747856, "comment_id": 64872192, "body": "<code>wb.ws.Range.Rows(4).Cells.Find(&quot;XXX&quot;).Offset(0, -1).SparklineGroups.Add Type:=xlSparkLine, SourceData:=Range(&quot;D4&quot; &amp; &quot;:&quot; &amp; rng)</code> This is all one line."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "edited": false, "score": 0, "creation_date": 1470243803, "post_id": 38747856, "comment_id": 64873179, "body": "Try copying and pasting mine."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "edited": false, "score": 0, "creation_date": 1470245373, "post_id": 38747856, "comment_id": 64874085, "body": "Your picture helped, too. Try it now."}, {"owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "edited": false, "score": 0, "creation_date": 1470246477, "post_id": 38747856, "comment_id": 64874701, "body": "Same error.  I pasted yours into mine and everything looks to match when I look at it.  In the Debugger when I hold over the Range for the <code>SourceData:=Range(&quot;D4&quot; &amp; &quot;:&quot; &amp; rng)</code> is where it says there is an error."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "edited": false, "score": 0, "creation_date": 1470247083, "post_id": 38747856, "comment_id": 64875034, "body": "My apologies. I tested the above this time and it works. I tested it with your attachment so it should be fine this time. :)"}, {"owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "edited": false, "score": 0, "creation_date": 1470247829, "post_id": 38747856, "comment_id": 64875408, "body": "okay that worked.  Would you mind explaining what adding <code>.Address</code> did.  Thanks very much!"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "edited": false, "score": 0, "creation_date": 1470248241, "post_id": 38747856, "comment_id": 64875605, "body": "<code>.Address</code> returns a string that represents the range. Without it you get the value in the range instead of where the value lives."}], "tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": true, "score": 0, "last_activity_date": 1470247030, "last_edit_date": 1470247030, "creation_date": 1470238152, "answer_id": 38747856, "question_id": 38747554, "link": "https://stackoverflow.com/questions/38747554/selecting-a-range-that-is-from-one-cell-to-a-found-value/38747856#38747856", "title": "Selecting a range that is from one cell to a found value?", "body": "<p><strong>EDITED:</strong></p>\n\n<pre><code>Sub Test()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim rng As Range\n\nSet wb = ActiveWorkbook\nSet ws = wb.Worksheets(\"Sheet1\")\nSet rng = ws.Rows(4).Cells.Find(\"XXX\").Offset(0, -1)\n\nRange(rng.Offset(0, 1).Address).SparklineGroups.Add Type:=xlSparkLine, SourceData:=Range(\"D4\" &amp; \":\" &amp; rng.Address).Address\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 38747856, "answer_count": 1, "score": 0, "last_activity_date": 1470247030, "creation_date": 1470237395, "question_id": 38747554, "link": "https://stackoverflow.com/questions/38747554/selecting-a-range-that-is-from-one-cell-to-a-found-value", "title": "Selecting a range that is from one cell to a found value?", "body": "<p>I'm making some sparklines and I'm trying to reference a range for the source data.  The Problem is that the Range is added onto every month.  I need to be able to use a range from a known first cell to until it finds a value.Offset(0,-1)  </p>\n\n<pre><code>Dif wb As Workbook \nDif ws As Worksheet \n\n    Set wb = Workbooks(\"HardDrive location\")\n    Set ws = wb.Worksheets(\"Sheet1\")\n\nwb.ws.Range.Rows(4).Cells.Find(\"XXX\").Offset(0, 1).Select\n\nSelection.SparklineGroups.Add Type:=xlSparkLine, SourceData:= Range(\"D4\", wb.ws.Range.Rows(4).Find(\"XXX\").Offset(0,-1))\n\n'Other Parameters are below, but there aren't any problems past this point'\n</code></pre>\n\n<p>Not really sure how to get that to work. Any help would be appreciated.  </p>\n"}, {"tags": ["vba", "ms-access", "attachment"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1470237140, "post_id": 38747416, "comment_id": 64868695, "body": "don&#39;t use text fields for binary data. text fields are subject to characterset translation rules and validation. binary data can/will contain byte sequences that are invalid for whatever collation/charset the field&#39;s using, and can/will get corrupted."}, {"owner": {"reputation": 49, "user_id": 6523767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7365737827a338694ccc04eee4a5fce8?s=128&d=identicon&r=PG&f=1", "display_name": "hajan11", "link": "https://stackoverflow.com/users/6523767/hajan11"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1470238557, "post_id": 38747416, "comment_id": 64869747, "body": "So how would I do it?  Can I transform a different field type into an attachment?"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1470253264, "post_id": 38747416, "comment_id": 64878539, "body": "Why is a code solution needed for this? Is the designer unacceptable for some reason?"}, {"owner": {"reputation": 49, "user_id": 6523767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7365737827a338694ccc04eee4a5fce8?s=128&d=identicon&r=PG&f=1", "display_name": "hajan11", "link": "https://stackoverflow.com/users/6523767/hajan11"}, "edited": false, "score": 0, "creation_date": 1470257375, "post_id": 38747416, "comment_id": 64880590, "body": "It should be automated. That is the problem. My idea is to write everything in a module and then run it. The requirement to that project is that one does not have to make adjustments by hand"}, {"owner": {"reputation": 76, "user_id": 6658527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697851e215cde76bb56f4cb4bf12899d?s=128&d=identicon&r=PG&f=1", "display_name": "John W Fowler", "link": "https://stackoverflow.com/users/6658527/john-w-fowler"}, "edited": false, "score": 0, "creation_date": 1470258451, "post_id": 38747416, "comment_id": 64881087, "body": "<code>db.tbldefs(&quot;tbl...&quot;).createfield(&quot;CoCAtt..&quot;,dblongbinary)</code>"}, {"owner": {"reputation": 49, "user_id": 6523767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7365737827a338694ccc04eee4a5fce8?s=128&d=identicon&r=PG&f=1", "display_name": "hajan11", "link": "https://stackoverflow.com/users/6523767/hajan11"}, "edited": false, "score": 0, "creation_date": 1470310813, "post_id": 38747416, "comment_id": 64903839, "body": "what would this be equal to? I assume that there has to be an equality?"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6523767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7365737827a338694ccc04eee4a5fce8?s=128&d=identicon&r=PG&f=1", "display_name": "hajan11", "link": "https://stackoverflow.com/users/6523767/hajan11"}, "edited": false, "score": 0, "creation_date": 1470253665, "post_id": 38749004, "comment_id": 64878733, "body": "You cannot replace TEXT with Attachment. It gives an erros."}, {"owner": {"reputation": 76, "user_id": 6658527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697851e215cde76bb56f4cb4bf12899d?s=128&d=identicon&r=PG&f=1", "display_name": "John W Fowler", "link": "https://stackoverflow.com/users/6658527/john-w-fowler"}, "reply_to_user": {"reputation": 49, "user_id": 6523767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7365737827a338694ccc04eee4a5fce8?s=128&d=identicon&r=PG&f=1", "display_name": "hajan11", "link": "https://stackoverflow.com/users/6523767/hajan11"}, "edited": false, "score": 0, "creation_date": 1470255470, "post_id": 38749004, "comment_id": 64879652, "body": "Try <code>OLE Object</code> then?"}], "tags": [], "owner": {"reputation": 76, "user_id": 6658527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697851e215cde76bb56f4cb4bf12899d?s=128&d=identicon&r=PG&f=1", "display_name": "John W Fowler", "link": "https://stackoverflow.com/users/6658527/john-w-fowler"}, "is_accepted": false, "score": 0, "last_activity_date": 1470259472, "last_edit_date": 1470259472, "creation_date": 1470241462, "answer_id": 38749004, "question_id": 38747416, "link": "https://stackoverflow.com/questions/38747416/attachment-field-in-ms-access/38749004#38749004", "title": "attachment field in MS Access", "body": "<p>If you aren't appending data, just adding a field you could always just keep it simple and add the field in design view, no? </p>\n\n<p>You just inspired some research.    </p>\n\n<pre><code>currentdb.TableDefs(\"Table\").CreateField(\"Attachment\",dblongbinary)\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff845510.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff845510.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8955537, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/7e60ea459509ba15e1d2cbcd2ddb2703?s=128&d=identicon&r=PG", "display_name": "Terry", "link": "https://stackoverflow.com/users/8955537/terry"}, "is_accepted": false, "score": 0, "last_activity_date": 1510892318, "creation_date": 1510892318, "answer_id": 47343223, "question_id": 38747416, "link": "https://stackoverflow.com/questions/38747416/attachment-field-in-ms-access/47343223#47343223", "title": "attachment field in MS Access", "body": "<p>If anyone is searching for an answer to this question, this does the trick:</p>\n\n<pre><code>Dim fld As DAO.Field\n\nSet fld = CurrentDb().TableDefs(\"MyTable\").CreateField(\"NewField\", 101&amp;)\nCurrentDb().TableDefs(\"MyTable\").Fields.Append fld\nCurrentDb().TableDefs.Refresh\n\nSet fld = Nothing\n</code></pre>\n\n<p>FieldType values for other complex data types can be found here:\n<a href=\"http://allenbrowne.com/func-DAO.html#FieldTypeName\" rel=\"nofollow noreferrer\">http://allenbrowne.com/func-DAO.html#FieldTypeName</a></p>\n"}], "owner": {"reputation": 49, "user_id": 6523767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7365737827a338694ccc04eee4a5fce8?s=128&d=identicon&r=PG&f=1", "display_name": "hajan11", "link": "https://stackoverflow.com/users/6523767/hajan11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 484, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593955989, "creation_date": 1470237021, "last_edit_date": 1593955989, "question_id": 38747416, "link": "https://stackoverflow.com/questions/38747416/attachment-field-in-ms-access", "title": "attachment field in MS Access", "body": "<p>I want to alter a table and create a new field with the type Attachment.</p>\n\n<p>First I thought of the following:</p>\n\n<pre><code>Dim SQL_Attachement_Str As String\nSQL_Attachement_Str = \"ALTER TABLE tbl_FinalTable_summerized ADD CoCAttachement ATTACHMENT\"\nDoCmd.RunSQL SQL_Attachement_Str\n</code></pre>\n\n<p>But unfortunately (in my case) this is not possible.</p>\n\n<p>My second attempt was it to first create the field as a TEXT type and then later change the type into Attachment as the following:</p>\n\n<pre><code>Dim SQL_Attachement_Str As String\nSQL_Attachement_Str = \"ALTER TABLE tbl_FinalTable_summerized ADD CoCAttachement TEXT\"\nDoCmd.RunSQL SQL_Attachement_Str\n\nDim tbl As TableDef\n\nSet db = CurrentDb\nSet tbl = db.TableDefs(\"tbl_FINALtable_Summerized\")\ntbl.Fields(\"CoCAttachement\").Type = dbAttachment\n\nSet tbl = Nothing\nSet db = Nothing\n</code></pre>\n\n<p>So What I need is a way to add a field with the type Attachment to the table</p>\n\n<p>thank you people :D</p>\n"}, {"tags": ["vba", "excel", "listbox"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1470240613, "post_id": 38746855, "comment_id": 64871185, "body": "Could you please edit your question.  There are several typos.  You also have a lot of irrelevant code."}, {"owner": {"reputation": 35, "user_id": 6672913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00255e98b3c44272d900c680f5127753?s=128&d=identicon&r=PG&f=1", "display_name": "d00nn12345", "link": "https://stackoverflow.com/users/6672913/d00nn12345"}, "edited": false, "score": 0, "creation_date": 1470240818, "post_id": 38746855, "comment_id": 64871319, "body": "sorry my english it&#39;s really not good  I have a listbox with search option search DATA .DATA and time is in C excel Columne I want to be A column B columns E columns F Columne displayed in a listbox when i search"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6672913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00255e98b3c44272d900c680f5127753?s=128&d=identicon&r=PG&f=1", "display_name": "d00nn12345", "link": "https://stackoverflow.com/users/6672913/d00nn12345"}, "edited": false, "score": 0, "creation_date": 1470244505, "post_id": 38749531, "comment_id": 64873581, "body": "thets work to search but dosent schow the cells  just cell C its showing"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 35, "user_id": 6672913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00255e98b3c44272d900c680f5127753?s=128&d=identicon&r=PG&f=1", "display_name": "d00nn12345", "link": "https://stackoverflow.com/users/6672913/d00nn12345"}, "edited": false, "score": 0, "creation_date": 1470245054, "post_id": 38749531, "comment_id": 64873881, "body": "I think that the ColumnWidths are set to hide the extra columns.  Can you try my updated answer and let me know what happens."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1470244968, "last_edit_date": 1470244968, "creation_date": 1470243230, "answer_id": 38749531, "question_id": 38746855, "link": "https://stackoverflow.com/questions/38746855/how-to-add-more-columns-to-vba-listbox-with-searchbox/38749531#38749531", "title": "How to add more columns to VBA Listbox with searchbox", "body": "<p>This is a minimalistic example of how to fill multiple columns in a listbox by iterating over a table.  </p>\n\n<pre><code>Private loActive As Excel.ListObject\n\nPrivate Sub Example()\n\n    Dim r As Range\n    Dim i As Integer\n\n    lstDetail.ColumnCount = 6\n    lstDetail.ColumnWidths = \"\"\n\n    Set loActive = ActiveSheet.ListObjects(1)\n\n    For Each r In loActive.ListColumns(1).Range\n\n        lstDetail.AddItem r.Value\n        i = lstDetail.ListCount - 1\n\n        lstDetail.List(i, 1) = r.Cells(1, \"B\")\n        lstDetail.List(i, 2) = r.Cells(1, \"C\")\n        lstDetail.List(i, 3) = r.Cells(1, \"E\")\n        lstDetail.List(i, 4) = r.Cells(1, \"F\")\n        lstDetail.List(i, 5) = r.Address 'Test Column\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6672913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00255e98b3c44272d900c680f5127753?s=128&d=identicon&r=PG&f=1", "display_name": "d00nn12345", "link": "https://stackoverflow.com/users/6672913/d00nn12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1470244968, "creation_date": 1470235471, "question_id": 38746855, "link": "https://stackoverflow.com/questions/38746855/how-to-add-more-columns-to-vba-listbox-with-searchbox", "title": "How to add more columns to VBA Listbox with searchbox", "body": "<p>hello i have this Searchbox and listbox in my VBA and work great to search DATA but i wont to show more columns  the neimes and price thets it in excel \nHello i have this search in listbox and work great to search by data but i want to show in the listbox more  columns  for example to load columns to it from excel</p>\n\n<pre><code>Option Explicit\nPrivate loActive As Excel.ListObject\nPrivate Sub UserForm_Activate()\nSet loActive = ActiveSheet.ListObjects(1)\nMe.lstDetail.TextColumn = 2\nMe.lstDetail.MatchEntry = fmMatchEntryComplete\nEnd Sub\nSub ResetFilter()\nDim rngTableCol As Excel.Range\nDim varTableCol As Variant\nDim RowCount As Long\nDim collUnique As Collection\nDim FilteredRows() As String\nDim i As Long\nDim ArrCount As Long\nDim FilterPattern As String\nDim UniqueValuesOnly As Boolean\nDim UniqueConstraint As Boolean\nDim CaseSensitive As Boolean\n'the asterisks make it match anywhere within the string\nIf Not ValidLikePattern(Me.txtFilter.Text) Then\n    Exit Sub\nEnd If\nFilterPattern = \"*\" &amp; Me.txtFilter.Text &amp; \"*\"\nUniqueValuesOnly = Me.chkUnique.Value\nCaseSensitive = Me.chkCaseSensitive\n'used only if UniqueValuesOnly is true\nSet collUnique = New Collection\nSet rngTableCol = loActive.ListColumns(1).DataBodyRange\n'note that Transpose won't work with &gt; 65536 rows\nvarTableCol = Application.WorksheetFunction.Transpose(rngTableCol.Value)\nRowCount = UBound(varTableCol)\nReDim FilteredRows(1 To 2, 1 To RowCount)\nFor i = 1 To RowCount\n    If UniqueValuesOnly Then\n        On Error Resume Next\n        'reset for this loop iteration\n        UniqueConstraint = False\n        'Add fails if key isn't UniqueValuesOnly\n        collUnique.Add Item:=\"test\", Key:=CStr(varTableCol(i))\n        If Err.Number &lt;&gt; 0 Then\n            UniqueConstraint = True\n        End If\n        On Error GoTo 0\n    End If\n    'True if UniqueValuesOnly is false or if\n    'UniqueValuesOnly is True and this is the\n    'first occurrence of the item\n    If Not UniqueConstraint Then\n        'Like operator is case sensitive,\n        'so need to use LCase if not CaseSensitive\n        If (Not CaseSensitive And LCase(varTableCol(i)) Like     LCase(FilterPattern)) _\n           Or (CaseSensitive And varTableCol(i) Like FilterPattern) Then\n            'add to array if ListBox item matches filter\n            ArrCount = ArrCount + 1\n            'there's a hidden ListBox column that stores the record num\n           FilteredRows(1, ArrCount) = i\n            FilteredRows(2, ArrCount) = varTableCol(i)\n        End If\n    End If\nNext i\nIf ArrCount &gt; 0 Then\n    'delete empty array items\n    'a ListBox cannot contain more than 65536 items\n    ReDim Preserve FilteredRows(1 To 2, 1 To         Application.WorksheetFunction.Min(ArrCount, 65536))\nElse\n    're-initialize the array\n    Erase FilteredRows\nEnd If\nIf ArrCount &gt; 1 Then\n    Me.lstDetail.List = Application.WorksheetFunction.Transpose(FilteredRows)\nElse\n    Me.lstDetail.Clear\n    'have to add separately if just one match\n    'or we get two rows, not two columns, in ListBox\n    If ArrCount = 1 Then\n        Me.lstDetail.AddItem FilteredRows(0, 1)\n        Me.lstDetail.List(0, 1) = FilteredRows(2, 1)\n    End If\nEnd If\nEnd Sub\n\nPrivate Sub txtFilter_Change()\nResetFilter\nEnd Sub\n\nPrivate Sub chkCaseSensitive_Click()\nResetFilter\nEnd Sub\nPrivate Sub chkUnique_Click()\nResetFilter\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1470237967, "post_id": 38746748, "comment_id": 64869339, "body": "You cannot run code which is contained in an Access database unless the database is open in an Access session."}, {"owner": {"reputation": 576, "user_id": 4504877, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b559095215902fb25dd589bfa6f3f76f?s=128&d=identicon&r=PG&f=1", "display_name": "user33484", "link": "https://stackoverflow.com/users/4504877/user33484"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1470238207, "post_id": 38746748, "comment_id": 64869513, "body": "Is there any way to copy code from access without opening access? I.e. using Excel-VBA code to mimic the above code?"}, {"owner": {"reputation": 576, "user_id": 4504877, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b559095215902fb25dd589bfa6f3f76f?s=128&d=identicon&r=PG&f=1", "display_name": "user33484", "link": "https://stackoverflow.com/users/4504877/user33484"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1470239074, "post_id": 38746748, "comment_id": 64870123, "body": "No, connecting is fine - but a way without opening Access is what I&#39;m looking for. I&#39;ve edited my post as requested."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1470239507, "post_id": 38746748, "comment_id": 64870442, "body": "Can you edit your question &amp; description? It sounds like you want a way to extract the data from Access database <i>without</i> opening the DB and running the macro from Access. On that note: google for &quot;excel vba adodb.connection access database&quot; and see what turns up, you should be able to use ADODB to read the database without opening access."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1470239665, "post_id": 38746748, "comment_id": 64870548, "body": "Alternatively, in the other Excel file, you can create a connection to an existing database table, see <a href=\"http://stackoverflow.com/a/31999290/1467082\">here</a>. That would avoid the need for the Access macro, and also you most likely wouldn&#39;t need to &quot;convert&quot; that macro to Excel VBA, either."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1470240054, "post_id": 38746748, "comment_id": 64870803, "body": "E.g., if your real question is &quot;How can I read/import data from an Access database without opening Access application&quot;, that would be a better and more accurate description of your problem than &quot;How can I run an Access Macro from Excel without opening Access?&quot;"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1471696598, "post_id": 38746748, "comment_id": 65457520, "body": "Just open the database.  What is preventing you from opening it?"}], "answers": [{"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 2, "last_activity_date": 1470243704, "creation_date": 1470243704, "answer_id": 38749682, "question_id": 38746748, "link": "https://stackoverflow.com/questions/38746748/running-a-macro-from-access-in-excel-without-opening-access/38749682#38749682", "title": "Running a macro from Access in Excel without opening Access", "body": "<p>I think I understand what you're asking, but correct me if I misunderstand.</p>\n\n<p>You can plug this code into a Excel Workbook - add the required reference to <code>Microsoft Office 14.0 Access database engine Object Library</code> (under Tools | References) and change the variables to match your parameters.</p>\n\n<p>You should also add error checking </p>\n\n<pre><code>Option Explicit\n\nPublic Sub SaveAccessTableToXL()\n\n    ' Under References, Add This\n    ' Microsoft Office 14.0 Access database engine Object Library\n\n    Dim db              As DAO.Database\n    Dim rs              As DAO.Recordset\n\n    Dim wb              As Workbook\n    Dim ws              As Worksheet\n    Dim rge             As Range\n\n    Dim strDatabase         As String\n    Dim strTable            As String\n    Dim strWorksheetPath    As String\n\n    ' These are variables you need to set before running\n    strDatabase = \"c:\\databases\\heatlink\\linktest.accdb\"\n    strWorksheetPath = \"c:\\databases\\heatlink\\\" &amp; \"test.xlsx\"\n    strTable = \"tbl_areas\"\n\n    ' Create New Workbook\n    Set wb = Workbooks.Add()\n    Set ws = wb.Sheets(\"Sheet1\")\n    Set rge = ws.Range(\"A1\")\n\n    ' Get Table Data from Database\n    Set db = DBEngine.OpenDatabase(strDatabase)\n    Set rs = db.OpenRecordset(strTable, dbOpenDynaset, dbReadOnly)\n\n    ' Copy Recordset into Worksheet\n    rge.CopyFromRecordset rs\n    rs.Close\n\n    ' Save Workbook\n    wb.SaveAs strWorksheetPath\n    wb.Close\n\n    MsgBox \"Workbook Created: \" &amp; strWorksheetPath\n    Set wb = Nothing\n    Set ws = Nothing\n    Set rge = Nothing\n\n    Set rs = Nothing\n    Set db = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 576, "user_id": 4504877, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b559095215902fb25dd589bfa6f3f76f?s=128&d=identicon&r=PG&f=1", "display_name": "user33484", "link": "https://stackoverflow.com/users/4504877/user33484"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2619, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470243704, "creation_date": 1470235230, "last_edit_date": 1470239043, "question_id": 38746748, "link": "https://stackoverflow.com/questions/38746748/running-a-macro-from-access-in-excel-without-opening-access", "title": "Running a macro from Access in Excel without opening Access", "body": "<p>I have an excel program which writes data to an Access database. In this database, I have a macro which, when run, copies the data onto another excel file. I want to edit the original excel program so that, after it writes the data to the Access database, it will automatically run the macro. Right now, I have it set so that it writes the data to the database, then opens the database, runs the macro and then closes the database - this seems somewhat ineffecient. Here is the macro in the access database:</p>\n\n<pre><code>Sub copy()\n\n\n\nDim strTable As String\nDim strWorksheetPath As String\n\n\nstrWorksheetPath = \"FilePath\" &amp; \"test.xlsx\"\nstrTable = \"test\"\n\nDoCmd.OutputTo acOutputTable, strTable, acFormatXLSX, strWorksheetPath\n\n\n\nEnd Sub\n</code></pre>\n\n<p>The relevant code in the program simply opens the database, calls the macro and closes it. If there is a way around this, without opening the database at all it'd be great. Thanks.</p>\n\n<p>i.e. just to make it clear, I'm looking for a way to mimic the above code in excel, so that I don't need to open the access database at all i.e. someway to transfer data from access, to an excel workbook, without using access VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 1, "creation_date": 1470235666, "post_id": 38746679, "comment_id": 64867570, "body": "<code>isnblank</code> isn&#39;t a built-in Excel function. Unless you&#39;ve defined it yourself as a UDF, that will give you problems. Have you tried <code>NOT(ISBLANK(...))</code>?"}, {"owner": {"reputation": 41, "user_id": 6672893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ad629f3c58b9c15347ce4a4a1eea8d?s=128&d=identicon&r=PG&f=1", "display_name": "huehuehuehuehuehuehuehuehuehue", "link": "https://stackoverflow.com/users/6672893/huehuehuehuehuehuehuehuehuehue"}, "reply_to_user": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470236547, "post_id": 38746679, "comment_id": 64868270, "body": "sorry, that was a typo. but even with ISBLANK or ISNA it gives me an error.."}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470236980, "post_id": 38746679, "comment_id": 64868578, "body": "Double check the subexpression <code>VLOOKUP([@[Uid]],tblProjectPlan[[Uid]:[Adjusted Sart]],13,false)</code> either by stepping through the formula execution or executing that expression manually. Does it give you what you expect? Also, where/what is the exact error you are getting?"}], "owner": {"reputation": 41, "user_id": 6672893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39ad629f3c58b9c15347ce4a4a1eea8d?s=128&d=identicon&r=PG&f=1", "display_name": "huehuehuehuehuehuehuehuehuehue", "link": "https://stackoverflow.com/users/6672893/huehuehuehuehuehuehuehuehuehue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507288035, "creation_date": 1470235066, "last_edit_date": 1507288035, "question_id": 38746679, "link": "https://stackoverflow.com/questions/38746679/how-do-i-correctly-utilize-the-if-and-isblank-function-when-trying-to-hardcode-f", "title": "How do I correctly utilize the IF and isblank function when trying to hardcode Formulas in VBA?", "body": "<p>I have the following hardcoded formula in VBA, which keeps giving me an error when I try to execute it. Is it the <code>\"\"\"\"</code> that is causing the syntax error? </p>\n\n<pre><code>IF(isnblank(VLOOKUP([@[Uid]],tblProjectPlan[[Uid]:[Adjusted Sart]],13,false)),\"\"\"\",VLOOKUP([@[Uid]],tblProjectPlan[[Uid]:[Adjusted Start]],13,false))\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 1, "last_activity_date": 1470237859, "last_edit_date": 1470237859, "creation_date": 1470237472, "answer_id": 38747573, "question_id": 38746670, "link": "https://stackoverflow.com/questions/38746670/variable-named-ranges-in-excel/38747573#38747573", "title": "Variable Named Ranges in Excel", "body": "<p>Try this VBA code</p>\n\n<pre><code>Sub test()\n    application.DisplayAlerts = false\n    Range(\"B8\").currentregion.createnames _\n        top:true, right:=false, left:=false, bottom:=false\n    application.DisplayAlerts = true\nend sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1470238294, "post_id": 38747642, "comment_id": 64869573, "body": "I would prefer <code>=OFFSET(Sheet1!$B$8,0,0,COUNTA(Sheet1!$B:$B),1)</code>"}, {"owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "edited": false, "score": 2, "creation_date": 1470238373, "post_id": 38747642, "comment_id": 64869621, "body": "Wow, never knew items in colon range notation could be calculated!! Great!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1470238537, "post_id": 38747642, "comment_id": 64869731, "body": "You can use <code>OFFSET</code>, but that&#39;s a <code>volatile</code> function unlike <code>INDEX</code>.  Meaning it will recalculate every time Excel recalculates regardless whether precedent data is changed (pretty much copied that word for word, so here&#39;s the link: <a href=\"http://www.decisionmodels.com/calcsecretsi.htm\" rel=\"nofollow noreferrer\">decisionmodels.com/calcsecretsi.htm</a>)."}, {"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1491932261, "post_id": 38747642, "comment_id": 73768579, "body": "I was returning to this old code and just had a quick question for you. How would I adjust this formula to apply to a range rather than a column, for instance A:K starting from A1? I tried to change the formulas accordingly but without success."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1491983278, "post_id": 38747642, "comment_id": 73788481, "body": "If the only data in the column is the data you&#39;re after you can use <code>=Sheet1!$A$1:INDEX(Sheet1!$K:$K,COUNTA(Sheet1!$A:$A))</code>.  The <code>INDEX</code> is returning column K.  <code>COUNTA</code> should still be referencing a column that doesn&#39;t have any blank cells in your data set - this will tell it which row to return in column K."}, {"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1492003947, "post_id": 38747642, "comment_id": 73803867, "body": "Thank you! That&#39;s perfect"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 3, "last_activity_date": 1470238011, "last_edit_date": 1470238011, "creation_date": 1470237623, "answer_id": 38747642, "question_id": 38746670, "link": "https://stackoverflow.com/questions/38746670/variable-named-ranges-in-excel/38747642#38747642", "title": "Variable Named Ranges in Excel", "body": "<p>This named range formula will do it:</p>\n\n<pre><code>=Sheet1!$B$8:INDEX(Sheet1!$B:$B,COUNTA(Sheet1!$B:$B)+8)\n</code></pre>\n\n<p>Remember to add the sheet name as the named range will operate on the active sheet otherwise.  </p>\n\n<p>The formula starts takes B8 as it's starting point: <code>Sheet1!$B$8</code><br>\nIt then counts how many cells are not blank in column B:  <code>COUNTA(Sheet1!$B:$B)</code><br>\nIt adds 8 to the count (assuming your first rows are blank).<br>\nIt then uses <code>INDEX</code> and the <code>COUNTA</code> to reference the last cell.  </p>\n\n<p><a href=\"https://support.office.com/en-gb/article/INDEX-function-a5dcf0dd-996d-40a4-a822-b56b061328bd\" rel=\"nofollow\">https://support.office.com/en-gb/article/INDEX-function-a5dcf0dd-996d-40a4-a822-b56b061328bd</a><br>\n<a href=\"https://support.office.com/en-gb/article/COUNTA-function-7dc98875-d5c1-46f1-9a82-53f3219e2509\" rel=\"nofollow\">https://support.office.com/en-gb/article/COUNTA-function-7dc98875-d5c1-46f1-9a82-53f3219e2509</a></p>\n"}], "owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "accepted_answer_id": 38747642, "answer_count": 2, "score": 1, "last_activity_date": 1470238011, "creation_date": 1470235047, "question_id": 38746670, "link": "https://stackoverflow.com/questions/38746670/variable-named-ranges-in-excel", "title": "Variable Named Ranges in Excel", "body": "<p>I have a table in Excel formatted as follows: </p>\n\n<pre><code>Date      Asset Return\n1/3/2005    0.003582399\n1/4/2005    -0.01908258\n1/5/2005    0.002080625\n1/6/2005    0.005699497\n1/7/2005    -0.008040505\n1/10/2005   -0.00339116\n1/11/2005   -0.009715187\n1/12/2005   0.002371855\n1/13/2005   -0.00580783\n1/14/2005   0.001058481\n1/18/2005   0.015483842\n1/19/2005   -0.014690715\n1/20/2005   -0.015714799\n1/21/2005   -0.010796326\n</code></pre>\n\n<p>I need a named range to reference each column. The workbook is a template, so the named range won't always cover the same number of rows depending on the data. I want to set it so that the named range \"Date\" and the named range \"Asset Return\" are automatically sized to cover the entire column from the first value until the last, without going past the last value in the column. </p>\n\n<p>It will always start at cell B8, but might end at a different row depending on the size of the data. </p>\n\n<p>How can I set a dynamic named range to accomplish this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470235417, "post_id": 38746653, "comment_id": 64867346, "body": "Variant is usually not preferred because it uses extra memory, can require a pointer dereference, and can carry unexpected types that cause runtime errors. However, it definitely has the advantage of being tested for uninitialized values. A typical approach to this sort of problem in programming is to simple initialize your data to a program-defined &quot;illegal value&quot; like -1, then check against this condition. But this obviously doesn&#39;t work if your Double could be legally assigned any value, including -1!"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 3, "last_activity_date": 1470236858, "creation_date": 1470236858, "answer_id": 38747359, "question_id": 38746653, "link": "https://stackoverflow.com/questions/38746653/discriminate-double-that-has-no-value-and-double-that-is-0-in-vba/38747359#38747359", "title": "Discriminate double that has no value and double that is 0 in VBA", "body": "<p>The downside has nothing to do with making the variable a <code>Double</code> or a <code>Variant</code>.  It has to do with exposing the guts of your class to anything that wants to muck around in them.</p>\n\n<p>I'd recommend creating actual properties and using those to report on the state of your object.  This line...</p>\n\n<pre><code>Public myVal As Double\n</code></pre>\n\n<p>...does <strong>not</strong> make <code>myVal</code> a property of the class.  It gives it a public internal member variable and breaks <a href=\"https://en.wikipedia.org/wiki/Encapsulation_(computer_programming)\" rel=\"nofollow\">encapsulation</a>.  Make it an actual property instead.  That way, you can have other properties that report the object's state if needed:</p>\n\n<p><strong>MyClass.cls:</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate mInit As Boolean\nPrivate mVal As Double\n\nPublic Property Get DoubleValue() As Double\n    DoubleValue = mVal\nEnd Property\n\nPublic Property Let DoubleValue(inValue As Double)\n    mInit = True\n    mVal = inValue\nEnd Property\n\nPublic Property Get Initialized() As Boolean\n    Initialized = mInit\nEnd Property\n</code></pre>\n\n<p><strong>Calling code:</strong></p>\n\n<pre><code>Dim myObject As New MyClass\nmyObject.DoubleValue = 0\nDebug.Print myObject.DoubleValue        '0\nDebug.Print myObject.Initialized        'True\n\nDim myOtherObject As New MyClass\nDebug.Print myOtherObject.DoubleValue   '0\nDebug.Print myOtherObject.Initialized   'False\n</code></pre>\n"}], "owner": {"reputation": 1105, "user_id": 4412610, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/de9ba9338d342841ada0d83532f52bd1?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime", "link": "https://stackoverflow.com/users/4412610/maxime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 38747359, "answer_count": 1, "score": 1, "last_activity_date": 1470236858, "creation_date": 1470235015, "question_id": 38746653, "link": "https://stackoverflow.com/questions/38746653/discriminate-double-that-has-no-value-and-double-that-is-0-in-vba", "title": "Discriminate double that has no value and double that is 0 in VBA", "body": "<p>Good day to you all.</p>\n\n<p>I have a little question regarding VBA, and variable initialization:</p>\n\n<p>I have a class, with property</p>\n\n<pre><code>Public myVal As Double\n</code></pre>\n\n<p>The two scripts:</p>\n\n<pre><code>Dim myObject As new MyClass\nmyObject.myClass = 0\nDebug.Print myObject.myClass\n\nDim myObject As new MyClass\nDebug.Print myObject.myClass\n</code></pre>\n\n<p>give the same output: 0.</p>\n\n<p>Is there any way to tell the two zeroes (Value has been assigned to 0 - No value has been assigned, so output is 0 by default) apart?</p>\n\n<p>Side question:\nIf I declared as </p>\n\n<pre><code>Public myVal As Variant\n</code></pre>\n\n<p>I have no problem, as I can use IsEmpty(myClass.myVal).</p>\n\n<p>Since people usually prefer using Double over Variant, I guess there is a downside to it. What is it?</p>\n\n<p>Thanks for your help :)</p>\n\n<p>Maxime</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 6501013, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01572db3ae30a16eb088ae4deab0e525?s=128&d=identicon&r=PG&f=1", "display_name": "David.L", "link": "https://stackoverflow.com/users/6501013/david-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1470237514, "creation_date": 1470237514, "answer_id": 38747595, "question_id": 38746476, "link": "https://stackoverflow.com/questions/38746476/excel-vba-hide-and-or-unhide-sheets-via-array-range/38747595#38747595", "title": "Excel VBA + Hide and/or Unhide Sheets via Array range", "body": "<p>Was able to resolve it by 'hiding' the sheets and then another loop to check if sheet is what I want to unhide.</p>\n\n<pre><code>myArray = Split(blah, \"|\")\n\ninputCell = 4\n\n\nFor Each sht In Worksheets\n    If (sht.Tab.Color = 192 Or sht.Tab.Color = 5296274) And (sht.Name Like \"* Consol\" Or sht.Name Like \"* Detail\") Then\n        sht.Visible = xlSheetHidden\n    End If\nNext sht\n\n\nFor Each cell In myArray\n    If cell &lt;&gt; \"\" Then\n        dtlCommName = Replace(cell, \" Consol\", \" Detail\")\n        If Sheets(cell).Visible = xlSheetHidden Or Sheets(dtlCommName).Visible = xlSheetHidden Then\n            Sheets(cell).Visible = xlSheetVisible\n            Sheets(dtlCommName).Visible = xlSheetVisible\n        End If\n\n        Sheets(\"Consolidation Summary\").Range(\"AB\" &amp; inputCell).Value = cell\n        inputCell = inputCell + 1\n    End If\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6501013, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01572db3ae30a16eb088ae4deab0e525?s=128&d=identicon&r=PG&f=1", "display_name": "David.L", "link": "https://stackoverflow.com/users/6501013/david-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 559, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470237514, "creation_date": 1470234543, "last_edit_date": 1531164843, "question_id": 38746476, "link": "https://stackoverflow.com/questions/38746476/excel-vba-hide-and-or-unhide-sheets-via-array-range", "title": "Excel VBA + Hide and/or Unhide Sheets via Array range", "body": "<p>I have multiple sheets in a workbook.</p>\n\n<p>NotToTouchSheet1,NotToTouchSheet2,NotToTouchSheet3,NotToTouchSheet4,\nHideOrToUnhideSheet1,HideOrToUnhideSheet2, ... ... ..., HideOrToUnhideSheet10</p>\n\n<p>As you can see above, there's sheets that I do not want to hide no matter what happens, and sheets to hide or unhide given the condition.</p>\n\n<p>The condition is, when a user choose a value from the combobox, the combobox listed out the sheet name which is spit out from the Array.</p>\n\n<p>My question is, given the number of sheets that I have, how do I make it hide those that are Not in the range/array PLUS those that I do not want them to hide 'NotToTouchSheet'.</p>\n\n<p>For example, a user choose 'A' from combobox list. 'A' value consist of HideOrToUnhideSheet1, HideOrToUnhideSheet3, HideOrToUnhideSheet5. Thus, I'd like 'NotToTouchSheet' sheets INCLUDING 'HideOrToUnhideSheet1,3 and 5' to show, and the rest to hide.</p>\n\n<p>When a user choose 'B' from combobox list. 'B' value consist of HideOrToUnhideSheet8, HideOrToUnhideSheet9, HideOrToUnhideSheet10. Since, these sheets were hidden, I'd like to have it unhide, and to hide HideOrToUnhideSheet1,3 and 5.</p>\n\n<p>I hope the above examples would helped you understand and visualize what I'd like to accomplish.</p>\n\n<pre><code>myArray = Split(blah, \"|\")\n\ninputCell = 4\n\n\nFor Each sht In Worksheets\n    For myArrayIndex = LBound(myArray) + 1 To UBound(myArray) - 1\n        commName = Replace(myArray(myArrayIndex), \" Consol\", \"\")\n        If (sht.Tab.Color = 192 Or sht.Tab.Color = 5296274) And (sht.Name Like \"* Consol\" Or sht.Name Like \"* Detail\") Then\n\n        if the above condition is true, hide those sheets that are not in the array PLUS those 'NotToTouchSheet'\n\n        End If\n\n    Next myArrayIndex\nNext sht\n</code></pre>\n"}, {"tags": ["vba", "function", "ms-access"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 1, "creation_date": 1470234798, "post_id": 38746400, "comment_id": 64866820, "body": "Where exactly are you getting the error? You&#39;ve shown us the function definition, but somewhere else you must be trying to use it and are getting the &quot;undefined function&quot; error."}, {"owner": {"reputation": 36, "user_id": 4520451, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/690362927/picture?type=large", "display_name": "Jake Duddy", "link": "https://stackoverflow.com/users/4520451/jake-duddy"}, "reply_to_user": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470234915, "post_id": 38746400, "comment_id": 64866925, "body": "Running it in a simple query as a test for the moment to get out option 2 (XCoeff) XCoeff: DSimpleRegress(&quot;X&quot;,&quot;Y&quot;,&quot;Query1&quot;,&quot;&#39;&quot;,2)"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1470235094, "post_id": 38746400, "comment_id": 64867079, "body": "Are you running the query in an Access session which has the database which contains <code>DSimpleRegress</code> open?"}, {"owner": {"reputation": 36, "user_id": 4520451, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/690362927/picture?type=large", "display_name": "Jake Duddy", "link": "https://stackoverflow.com/users/4520451/jake-duddy"}, "edited": false, "score": 0, "creation_date": 1470235254, "post_id": 38746400, "comment_id": 64867206, "body": "Running the query and have the module both in the same database. The module is closed whilst I am trying to run the query"}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 1, "creation_date": 1470258251, "post_id": 38746400, "comment_id": 64880996, "body": "Did you save your module using a different name from your function name?"}], "owner": {"reputation": 36, "user_id": 4520451, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/690362927/picture?type=large", "display_name": "Jake Duddy", "link": "https://stackoverflow.com/users/4520451/jake-duddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 544, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470234812, "creation_date": 1470234357, "last_edit_date": 1470234812, "question_id": 38746400, "link": "https://stackoverflow.com/questions/38746400/access-vba-function-undefined-function-dsimpleregress-in-expression", "title": "Access VBA Function = &quot;Undefined function &#39;DSimpleRegress&#39; in expression", "body": "<p>Got some code that works in a Access 2000 format but not in Access 2010. I have tried un-selecting MS 14.0 Access Database Engine Object Libaray and selecting the ActiveX 2.1 and DAO 3.6 libaries that are selected in the 2000 instance but still getting the same error. </p>\n\n<p>Any suggestion to code changes or other solutions?</p>\n\n<p>Code is as follows:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\n' Enumeration used for determining which regression stat(s) the DSimpleRegress function returns\n\nEnum SimpleRegressStat\n    SimpleRegressStat_All = 0\n    SimpleRegressStat_RSquared = 1\n    SimpleRegressStat_XCoeff = 2\n    SimpleRegressStat_Intercept = 3\n    SimpleRegressStat_SE_Resid = 4\n    SimpleRegressStat_SE_XCoeff = 5\n    SimpleRegressStat_SE_Intercept = 6\n    SimpleRegressStat_T_XCoeff = 7\n    SimpleRegressStat_T_Intercept = 8\nEnd Enum\n\nFunction DSimpleRegress(X_Column As String, Y_Column As String, Tbl As String, _\n    Optional Criteria As String = \"\", Optional Stat As Variant = \"\")\n\n    ' Function by Patrick G. Matthews\n\n    ' Feel free to use and distribute this code, so long as you credit authorship and indicate the\n    ' URL where you found it\n\n    ' This function calculates statistics for simple linear regression between a single independent\n    ' variable (X_Column) and a dependent variable (Y_Column), and is intended for use in Microsoft\n    ' Access.  This function requires a reference to the Microsoft DAO library.\n\n    ' Depending on the value of the Stat argument, this function returns a single regression\n    ' statistic, such as the R squared or the X coefficient, or it returns an array of all\n    ' available regression stats (for a list of available stats, please see the enumeration\n    ' SimpleRegressStat)\n\n    ' If either or both corresponding values in the paired X, Y data set are null, those records\n    ' are ignored\n\n    ' This function is labeled according to the domain aggregate function naming convention as it\n    ' behaves similarly to the other domain aggregates\n\n    ' X_Column is the independent variable\n    ' Y_Column is the dependent variable\n    ' Tbl is the source table or query for the data\n    ' Criteria defines any filtering criteria you wish to apply to the data set.  Be sure to enclose\n    '       text items in single quotes and date values in the # date qualifiers\n    ' Stat determines which regression statistic the function returns.  For a full list of the valid\n    '       values (NOT case sensitive) for the Stat argument, see the Select Case structure under\n    '       the label DetermineMode\n\n    ' For each of the arguments, I strongly recommend that you encase column and table names in\n    ' square brackets.  This is mandatory of the column/table name does not follow the usual rules\n    ' for naming database objects\n\n    Static Last_X_Column As String\n    Static Last_Y_Column As String\n    Static Last_Tbl As String\n    Static Last_Criteria As String\n    Static Last_Runtime As Date\n    Static Result_RSquared As Variant\n    Static Result_XCoeff As Variant\n    Static Result_Intercept As Variant\n    Static Result_SE_Resid As Variant\n    Static Result_SE_XCoeff As Variant\n    Static Result_SE_Intercept As Variant\n    Static Result_T_XCoeff As Variant\n    Static Result_T_Intercept As Variant\n\n    Dim N As Long\n    Dim AvgX As Variant\n    Dim AvgY As Variant\n    Dim AvgXY As Variant\n    Dim VarPX As Variant\n    Dim VarPY As Variant\n    Dim Covar As Variant\n\n    Dim SQL As String\n    Dim rs As DAO.Recordset\n    Dim Mode As SimpleRegressStat\n    Dim Results(1 To 8) As Variant\n\n    Const ForceRefreshSeconds As Long = 30\n\n    On Error GoTo ErrHandler\n\nDetermineMode:\n\n    ' Determines whether a single regression stat is returned (and if so, which), or whether\n    ' an array of all available stats is returned\n\n    Select Case LCase(Stat)\n        Case \"1\", \"r squared\", \"rsquared\", \"r sq\", \"rsq\", \"r square\", \"rsquare\", \"r-squared\", \"r-squared\", _\n            \"r-sq\", \"r-sq\", \"r-square\", \"r-square\"\n            Mode = SimpleRegressStat_RSquared\n        Case \"2\", \"x\", \"x coefficient\", \"x coeff\", \"xcoeff\", \"coeff\", \"coefficient\"\n            Mode = SimpleRegressStat_XCoeff\n        Case \"3\", \"intercept\", \"constant\"\n            Mode = SimpleRegressStat_Intercept\n        Case \"4\", \"se model\", \"se regression\", \"se resid\", \"se residual\", \"se residuals\", \"std error model\", _\n            \"std error regression\", \"std error resid\", \"std error residual\", \"std error residuals\", _\n            \"standard error model\", \"standard error regression\", \"standard error resid\", _\n            \"standard error residual\", \"standard error residuals\"\n            Mode = SimpleRegressStat_SE_Resid\n        Case \"5\", \"se x\", \"se x coefficient\", \"se x coeff\", \"se xcoeff\", \"se coeff\", \"se coefficient\", _\n            \"std error x\", \"std error x coefficient\", \"std error x coeff\", \"std error xcoeff\", _\n            \"std error coeff\", \"std error coefficient\", \"standard error x\", \"standard error x coefficient\", _\n            \"standard error x coeff\", \"standard error xcoeff\", \"standard error coeff\", _\n            \"standard error coefficient\"\n            Mode = SimpleRegressStat_SE_XCoeff\n        Case \"6\", \"se intercept\", \"se constant\", \"std error intercept\", \"std error constant\", _\n            \"standard error intercept\", \"standard error constant\"\n            Mode = SimpleRegressStat_SE_Intercept\n        Case \"7\", \"t x\", \"t x coefficient\", \"t x coeff\", \"t xcoeff\", \"t coeff\", \"t coefficient\"\n            Mode = SimpleRegressStat_T_XCoeff\n        Case \"8\", \"t intercept\", \"t constant\"\n            Mode = SimpleRegressStat_T_Intercept\n        Case Else\n            Mode = SimpleRegressStat_All\n    End Select\n\nCalculateStats:\n\n    ' Calculate the regression stats\n\n    ' This function holds the regression stats in static variables, which retain their state\n    ' between calls.  If the values for the X_Column, Y_Column, Tbl, and Criteria arguments\n    ' are the same as those for the last call, and if the seconds elapsed since the last\n    ' call are less than what is specified in the ForceRefreshSeconds constant, then we can\n    ' skip the calculations and go right to assigning the return value\n\n    If DateDiff(\"s\", Last_Runtime, Now) &gt;= ForceRefreshSeconds Or Last_X_Column &lt;&gt; X_Column Or _\n        Last_Y_Column &lt;&gt; Y_Column Or Last_Tbl &lt;&gt; Tbl Or Last_Criteria &lt;&gt; Criteria Then\n\n        ' Initialize stats to null\n\n        Result_RSquared = Null\n        Result_XCoeff = Null\n        Result_Intercept = Null\n        Result_SE_Resid = Null\n        Result_SE_XCoeff = Null\n        Result_SE_Intercept = Null\n        Result_T_XCoeff = Null\n        Result_T_Intercept = Null\n\n        ' All the regression stats can be calculated from the following six values: N, Avg(X), Avg(Y),\n        ' Avg(X * Y), VarP(X), and VarP(Y).  Use the following SQL statement to get these six values\n\n        SQL = \"SELECT Count(1) AS N, Avg(\" &amp; X_Column &amp; \") AS AvgX, Avg(\" &amp; Y_Column &amp; \") AS AvgY, \" &amp; _\n            \"Avg(\" &amp; X_Column &amp; \" * \" &amp; Y_Column &amp; \") AS AvgXY, VarP(\" &amp; X_Column &amp; \") AS VarPX, \" &amp; _\n            \"VarP(\" &amp; Y_Column &amp; \") AS VarPY \" &amp; _\n            \"FROM \" &amp; Tbl &amp; \" \" &amp; _\n            \"WHERE \" &amp; IIf(Trim(Criteria) &lt;&gt; \"\", Criteria &amp; \" And \", \"\") &amp; X_Column &amp; \" Is Not Null \" &amp; _\n                \"And \" &amp; Y_Column &amp; \" Is Not Null\"\n\n        Set rs = CurrentDb.OpenRecordset(SQL, dbOpenSnapshot)\n\n        ' Transfer values from recordset to variables, then close recordset\n\n        AvgX = CDbl(rs!AvgX)\n        AvgY = CDbl(rs!AvgY)\n        AvgXY = CDbl(rs!AvgXY)\n        N = rs!N\n        VarPX = CDbl(rs!VarPX)\n        VarPY = CDbl(rs!VarPY)\n        Covar = AvgXY - AvgX * AvgY\n\n        rs.Close\n\n        ' There must be at least 3 valid data points for regression to work.  If there are 2 or\n        ' fewer data points, we skip the rest of the calculations, thus allowing the regression\n        ' stats to remain as null\n\n        If N &gt; 2 Then\n\n            ' Calculate various stats\n\n            Result_RSquared = Covar ^ 2 / (VarPX * VarPY)\n\n            Result_XCoeff = Covar / VarPX\n\n            Result_Intercept = AvgY - AvgX * Result_XCoeff\n\n            Result_SE_Resid = ((N / (N - 2)) * (VarPY - Covar ^ 2 / VarPX)) ^ 0.5\n\n            Result_SE_XCoeff = Result_SE_Resid * (1 / (N * VarPX)) ^ 0.5\n\n            Result_SE_Intercept = Result_SE_Resid * ((VarPX + AvgX ^ 2) / (N * VarPX)) ^ 0.5\n\n            Result_T_XCoeff = Result_XCoeff / Result_SE_XCoeff\n\n            Result_T_Intercept = Result_Intercept / Result_SE_Intercept\n\n        End If\n\n    End If\n\nReturnValue:\n\n    ' Set the fnction's return value\n\n    Select Case Mode\n        Case SimpleRegressStat_All\n            Results(1) = Result_RSquared\n            Results(2) = Result_XCoeff\n            Results(3) = Result_Intercept\n            Results(4) = Result_SE_Resid\n            Results(5) = Result_SE_XCoeff\n            Results(6) = Result_SE_Intercept\n            Results(7) = Result_T_XCoeff\n            Results(8) = Result_T_Intercept\n            DSimpleRegress = Results\n        Case SimpleRegressStat_RSquared\n            DSimpleRegress = Result_RSquared\n        Case SimpleRegressStat_XCoeff\n            DSimpleRegress = Result_XCoeff\n        Case SimpleRegressStat_Intercept\n            DSimpleRegress = Result_Intercept\n        Case SimpleRegressStat_SE_Resid\n            DSimpleRegress = Result_SE_Resid\n        Case SimpleRegressStat_SE_XCoeff\n            DSimpleRegress = Result_SE_XCoeff\n        Case SimpleRegressStat_SE_Intercept\n            DSimpleRegress = Result_SE_Intercept\n        Case SimpleRegressStat_T_XCoeff\n            DSimpleRegress = Result_T_XCoeff\n        Case SimpleRegressStat_T_Intercept\n            DSimpleRegress = Result_T_Intercept\n    End Select\n\n    Last_Runtime = Now\n\n    GoTo Cleanup\n\nErrHandler:\n    SimpleRegress = CVErr(Err.Number)\n\nCleanup:\n    Set rs = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1470234321, "post_id": 38746310, "comment_id": 64866414, "body": "You need to get the code module and find where the line is.  Looping the lines and using instr"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470234424, "post_id": 38746310, "comment_id": 64866505, "body": "Are you deleting an entire procedure, or lines inside a procedure?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1470234433, "post_id": 38746310, "comment_id": 64866518, "body": "Why do you need to remove lines from a procedure? Surely you can use an <code>If</code> statement somewhere instead?"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1470234821, "post_id": 38746310, "comment_id": 64866838, "body": "I&#39;m a couple of creating buttons based on user input/data in a list, so I will need to add/remove button_Click() ... end sub from the worksheet module  if the buttons are no longer necessary.  And Comintern, an entire procedure."}, {"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470235043, "post_id": 38746310, "comment_id": 64867037, "body": "@tompreston If you&#39;re totally removing a procedure, you can find the start of the procedure with ProcBodyLine (<a href=\"https://msdn.microsoft.com/en-us/library/aa445197(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa445197(v=vs.60).aspx</a>) and the number of lines to delete with ProcCountLines (<a href=\"https://msdn.microsoft.com/en-us/library/aa445200(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa445200(v=vs.60).aspx</a>)"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1470235155, "post_id": 38746310, "comment_id": 64867117, "body": "There&#39;s a fairly comprehensive guide on looping through the lines in a code module here for anyone that ends up here in search of a similar answer <a href=\"http://www.codeproject.com/Articles/640258/Deconstruction-of-a-VBA-Code-Module\" rel=\"nofollow noreferrer\">codeproject.com/Articles/640258/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470234984, "post_id": 38746504, "comment_id": 64866984, "body": "I ran it fine, but have exited the loop to be on the safe side, OP suggests it&#39;s one line to go, then no more, so wouldn&#39;t need to count on."}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1470235406, "post_id": 38746504, "comment_id": 64867337, "body": "it might be better if you change the loop to For i = vb.CodeModule.CountOfLines To 1 step - 1 for anyone else whe might need the answer"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 2, "last_activity_date": 1470235787, "last_edit_date": 1470235787, "creation_date": 1470234635, "answer_id": 38746504, "question_id": 38746310, "link": "https://stackoverflow.com/questions/38746310/remove-specific-code-from-a-module-vba-using-deletelines/38746504#38746504", "title": "Remove specific code from a module VBA using .DeleteLines", "body": "<pre><code>Sub test()\n\nDim vb As VBComponent\nDim i As Integer\n\nSet vb = ThisWorkbook.VBProject.VBComponents(\"Module2\")\n\nFor i =vb.CodeModule.CountOfLines to 1 step -1\n\n    If InStr(1, vb.CodeModule.Lines(i, 1), \"'   remove\") &lt;&gt; 0 Then\n        vb.CodeModule.DeleteLines i, 1\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I would of also suggested using a condition statement to allow execution of the code line, rather than deleting it, when is it put back?  this could cause issues if you wish to automate that bit, as you'll need to know where it came from.</p>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 4, "last_activity_date": 1470235858, "last_edit_date": 1495542855, "creation_date": 1470235466, "answer_id": 38746853, "question_id": 38746310, "link": "https://stackoverflow.com/questions/38746310/remove-specific-code-from-a-module-vba-using-deletelines/38746853#38746853", "title": "Remove specific code from a module VBA using .DeleteLines", "body": "<p>If you're removing the entire procedure, you can find its location with the <a href=\"https://msdn.microsoft.com/en-us/library/aa445207(v=vs.60).aspx\" rel=\"nofollow noreferrer\">ProcStartLine</a> property and the line count with <a href=\"https://msdn.microsoft.com/en-us/library/aa445200(v=vs.60).aspx\" rel=\"nofollow noreferrer\">ProcCountLines</a>.</p>\n\n<pre><code>Dim module As CodeModule\nSet module = Workbooks(\"ClassExperiment.xlsm\").VBProject.VBComponents(\"Module2\").CodeModule\n\nDim start As Long\nDim lines As Long\nWith module\n    start = .ProcStartLine(\"button_Click\", vbext_pk_Proc)\n    lines = .ProcCountLines(\"button_Click\", vbext_pk_Proc)\n    .DeleteLines start, lines\nEnd With\n</code></pre>\n\n<h2>Warning:</h2>\n\n<p>This should be obvious, but I'll throw it out there anyway. <strong><em>Do not</em></strong> use this (or any other method) to alter the module that the code is running from in Debug mode. This is a good way to <a href=\"https://stackoverflow.com/q/33698257/4088852\">break your workbook</a>.</p>\n"}], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4186, "favorite_count": 2, "accepted_answer_id": 38746853, "answer_count": 2, "score": 4, "last_activity_date": 1470235858, "creation_date": 1470234122, "question_id": 38746310, "link": "https://stackoverflow.com/questions/38746310/remove-specific-code-from-a-module-vba-using-deletelines", "title": "Remove specific code from a module VBA using .DeleteLines", "body": "<p>I'd like to use the <code>.DeleteLines</code>function in VBA.  As I'm not deleting all the lines in the module i need a targeted approach.  I assume there is a function like Find(\"FooBar\").LineNumber, however I can't find it here/with google: </p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg264546.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg264546.aspx</a></p>\n\n<pre><code>Sub Deletings()\n    With Workbooks(\"ClassExperiment.xlsm\").VBProject.VBComponents(\"Module2\").CodeModule\n        .DeleteLines(HowDoIGetThisValue, 0)\n    End With\nEnd Sub\n</code></pre>\n\n<p>Help appreciated.</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 864, "user_id": 2039431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f752361a0ef448dc2fd54c200cfce947?s=128&d=identicon&r=PG", "display_name": "Michael Westwort", "link": "https://stackoverflow.com/users/2039431/michael-westwort"}, "edited": false, "score": 0, "creation_date": 1470234877, "post_id": 38746299, "comment_id": 64866890, "body": "I don&#39;t see any difference. Where is it?"}, {"owner": {"reputation": 152, "user_id": 2480558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4cd5853762efc75a182c92b8134fca1b?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Granger", "link": "https://stackoverflow.com/users/2480558/joshua-granger"}, "reply_to_user": {"reputation": 864, "user_id": 2039431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f752361a0ef448dc2fd54c200cfce947?s=128&d=identicon&r=PG", "display_name": "Michael Westwort", "link": "https://stackoverflow.com/users/2039431/michael-westwort"}, "edited": false, "score": 0, "creation_date": 1470235070, "post_id": 38746299, "comment_id": 64867055, "body": "The &quot;Broken&quot; sheets show delta in all of the values. (Except that one sheet that shows #N/A for some reason)  The &quot;Working&quot; sheets show the correct corresponding values; &quot;alpha#&quot; &quot;beta#&quot;, etc"}, {"owner": {"reputation": 152, "user_id": 2480558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4cd5853762efc75a182c92b8134fca1b?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Granger", "link": "https://stackoverflow.com/users/2480558/joshua-granger"}, "reply_to_user": {"reputation": 864, "user_id": 2039431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f752361a0ef448dc2fd54c200cfce947?s=128&d=identicon&r=PG", "display_name": "Michael Westwort", "link": "https://stackoverflow.com/users/2039431/michael-westwort"}, "edited": false, "score": 0, "creation_date": 1470235294, "post_id": 38746299, "comment_id": 64867232, "body": "The database looks as follows: <a href=\"https://s32.postimg.org/bld2rekn9/database.png\" rel=\"nofollow noreferrer\">s32.postimg.org/bld2rekn9/database.png</a>   A correct entry would be LS-TSF showing &quot;delta&quot;, like such: <a href=\"https://s32.postimg.org/b7bqrt0jp/correct.png\" rel=\"nofollow noreferrer\">s32.postimg.org/b7bqrt0jp/correct.png</a>   An incorrect entry would be LS-TTF showing &quot;delta&quot; instead of &quot;alpha&quot;: <a href=\"https://s32.postimg.org/5lpbnqzut/incorrect.png\" rel=\"nofollow noreferrer\">s32.postimg.org/5lpbnqzut/incorrect.png</a>   When the names of the columns are changed, though, like in the working spreadsheet, this issue does not occur"}], "answers": [{"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": true, "score": 10, "last_activity_date": 1470260342, "creation_date": 1470260342, "answer_id": 38754070, "question_id": 38746299, "link": "https://stackoverflow.com/questions/38746299/microsoft-excel-lookup-function-just-doesnt-work/38754070#38754070", "title": "Microsoft Excel LOOKUP function just... doesn&#39;t work?", "body": "<p>From the help for the <a href=\"https://support.office.microsoft.com/en-us/article/LOOKUP-function-446d94af-663b-451d-8251-369d5e3864cb?NS=EXCEL&amp;Version=16&amp;SysLcid=1033&amp;UiLcid=1033&amp;AppVer=ZXL160&amp;HelpId=xlmain11.chm60076&amp;ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"noreferrer\">LOOKUP function</a>:</p>\n\n<blockquote>\n  <p>IMPORTANT: The values in lookup_vector must be placed in ascending\n  order: ..., -2, -1, 0, 1, 2, ..., A-Z, FALSE, TRUE; otherwise, LOOKUP\n  might not return the correct value. Uppercase and lowercase text are\n  equivalent.</p>\n</blockquote>\n\n<p>The set of values which work correctly - \"LS-A, LS-B, LS-C, LS-D\" - are in alphabetical order. The set of values which don't work correctly - \"LS-TTF, LS-TTD, LS-TSD, LS-TSF\" - are not in alphabetical order. Also, LOOKUP doesn't necessarily find an exact match - as specified in the help:</p>\n\n<blockquote>\n  <p>If the LOOKUP function can't find the lookup_value, the function\n  matches the largest value in lookup_vector that is less than or equal\n  to lookup_value.</p>\n</blockquote>\n\n<p>To fix, either:</p>\n\n<ul>\n<li>reorder the non-working set of values to be in alphabetical order (although you still won't guarantee an exact match), or</li>\n<li>switch to using the <a href=\"https://support.office.microsoft.com/en-us/article/HLOOKUP-function-a3034eec-b719-4ba3-bb65-e1ad662ed95f?NS=EXCEL&amp;Version=16&amp;SysLcid=1033&amp;UiLcid=1033&amp;AppVer=ZXL160&amp;HelpId=xlmain11.chm60149&amp;ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"noreferrer\">HLOOKUP function</a> instead. Ensure that the <code>Range_lookup</code> parameter is false to require an exact match. Sample usage: <code>=HLOOKUP(H2,'Database (Cols)'!D2:AN3,2,FALSE)</code></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 967, "user_id": 1283704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29c2f5f9e61ee51b659c40fd0b5d347?s=128&d=identicon&r=PG", "display_name": "Michael Fayad", "link": "https://stackoverflow.com/users/1283704/michael-fayad"}, "is_accepted": false, "score": 0, "last_activity_date": 1545344361, "creation_date": 1545344361, "answer_id": 53876838, "question_id": 38746299, "link": "https://stackoverflow.com/questions/38746299/microsoft-excel-lookup-function-just-doesnt-work/53876838#53876838", "title": "Microsoft Excel LOOKUP function just... doesn&#39;t work?", "body": "<p>I had a similar problem because I was wrongly using lookup. To find a value in a vector, I had to use </p>\n\n<pre><code>=MATCH(\"KEY\";F5:F48;0)\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>=LOOKUP(\"KEY\";F5:F48)\n</code></pre>\n\n<p>LOOKUP just didn't work for my objectives.</p>\n"}], "owner": {"reputation": 152, "user_id": 2480558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4cd5853762efc75a182c92b8134fca1b?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Granger", "link": "https://stackoverflow.com/users/2480558/joshua-granger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9602, "favorite_count": 0, "accepted_answer_id": 38754070, "answer_count": 2, "score": 4, "last_activity_date": 1545344361, "creation_date": 1470234091, "last_edit_date": 1531161705, "question_id": 38746299, "link": "https://stackoverflow.com/questions/38746299/microsoft-excel-lookup-function-just-doesnt-work", "title": "Microsoft Excel LOOKUP function just... doesn&#39;t work?", "body": "<p>So, I have a fairly involved workbook.</p>\n\n<p><strong>Sheet 1:</strong> A database where the user enters a list of instruments as well as some data about the instruments in a vertical column.</p>\n\n<p><strong>Sheet 2:</strong> A sheet that contains the exact same information as sheet 1 but displays it in a different format. Automatically populates based on entries from Sheet 1. (Not useful in this question)</p>\n\n<p>There exists a macro on Sheet 1 that is executed by clicking a button. This macro takes every column from Sheet 1 and creates a new Sheet for each column. Each new sheet, <strong>Sheet 3</strong>, is renamed to the first value in the column of Sheet 1 that it represents.</p>\n\n<ul>\n<li><strong>i.e.,</strong> There are 4 columns in Sheet 1 with the first value in each column being: LS-ALPHA, LS-BRAVO, LS-CHARLIE, LS-DELTA. My macro will create 4 new sheets called LS-ALPHA, LS-BRAVO, LS-CHARLIE, LS-DELTA.</li>\n</ul>\n\n<p>The first cell (technically H2) on each of the new sheets contains a formula to reference the sheet name. </p>\n\n<pre><code>=MID(CELL(\"filename\",A1),FIND(\"]\",CELL(\"filename\",A1))+1,255)\n</code></pre>\n\n<ul>\n<li><strong>i.e.,</strong> H2 on the LS-ALPHA sheet will actually say \"LS-ALPHA\", H2 on the LS-BRAVO sheet will say LS-BRAVO, etc.</li>\n</ul>\n\n<p>Every other data cell on the new sheet will automatically look up that value on the main sheet (Sheet 1) to determine what column it is from. Then, it will go below that value and get the contents from some cell x rows below.</p>\n\n<pre><code>=LOOKUP(H2,'Database (Cols)'!D2:AN2,'Database (Cols)'!D3:AN3)\n</code></pre>\n\n<p>This works absolutely perfectly. It does everything well.</p>\n\n<p>Except, not always.</p>\n\n<ul>\n<li>If I rename the columns to \"LS-A, LS-B, LS-C, LS-D\", it works. If I rename the columns to \"LS-AA, LS-AB, LS-AC, LS-AD\", it works. If I rename the columns to \"LS-AAA, LS-AAB, LS-AAC, LS-AAD\", it works.</li>\n</ul>\n\n<p><strong>However,</strong> if I rename the columns to something like \"LS-TTF, LS-TTD,LS-TSD, LS-TSF\" they are all broken somehow.... None of the links on the sheets work any more. Some of them point to the incorrect column if they even do show something. This issue I'm having is incredibly peculiar. I don't know why these names break it in particular, nor do I know what other names would also break it.</p>\n\n<p><strong>What happens when it 'breaks':</strong> All of the references seem to find the last available column in the LOOKUP. Three of the four sheets all use values from the fourth column when they aren't supposed to. Then, one sheet just gives me errors (#N/A). When I step through the calculation, it is looking for the correct value in the LOOKUP function, it's just not returning the right thing....</p>\n\n<p>I can't really give much more information without showing you what's happening so I've included a working spreadsheet and a broken spreadsheet. The sheets have been generated from the macro so you don't have to mess with it. The working and broken files are below:</p>\n\n<p>Working: <a href=\"https://drive.google.com/file/d/0B9zbU-BeMQNfSmRrWVhKVW9RN3M/view?usp=drivesdk\" rel=\"nofollow\">https://drive.google.com/file/d/0B9zbU-BeMQNfSmRrWVhKVW9RN3M/view?usp=drivesdk</a></p>\n\n<p>Broken: <a href=\"https://drive.google.com/file/d/0B9zbU-BeMQNfd1FUemwxQjQwMEE/view?usp=drivesdk\" rel=\"nofollow\">https://drive.google.com/file/d/0B9zbU-BeMQNfd1FUemwxQjQwMEE/view?usp=drivesdk</a></p>\n\n<p><em>Note, the echo column is for debugging purposes. I was trying to see if they would all show echo instead of delta. Apparently, they don't.</em></p>\n"}, {"tags": ["vba", "excel", "debugging"], "comments": [{"owner": {"reputation": 1177, "user_id": 4734515, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh4.googleusercontent.com/-LkOMfutk0Eg/AAAAAAAAAAI/AAAAAAAAAEk/N5dZ__kGZw4/photo.jpg?sz=128", "display_name": "pheeper", "link": "https://stackoverflow.com/users/4734515/pheeper"}, "edited": false, "score": 0, "creation_date": 1470233135, "post_id": 38745818, "comment_id": 64865563, "body": "Based on this <a href=\"http://stackoverflow.com/questions/16540071/out-of-range-error-for-windows-activate\">post</a> I would double check what version of Excel he is running and what file format the workbook is saved in."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1470233371, "post_id": 38745818, "comment_id": 64865728, "body": "you&#39;re missing the extension &quot;.xlsb&quot; by the looks of the post."}, {"owner": {"reputation": 716, "user_id": 6518147, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1204875876202728/picture?type=large", "display_name": "Hynek Bernard", "link": "https://stackoverflow.com/users/6518147/hynek-bernard"}, "edited": false, "score": 0, "creation_date": 1470233453, "post_id": 38745818, "comment_id": 64865780, "body": "The file is on shared disk, so there should not be format/extension problem, also the version of excel is same for our whole department. Sadly I can update tomorrow with the provided debug, because he now left."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470234368, "post_id": 38745818, "comment_id": 64866460, "body": "Do you have a reference to the Workbook in a variable already?"}, {"owner": {"reputation": 716, "user_id": 6518147, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1204875876202728/picture?type=large", "display_name": "Hynek Bernard", "link": "https://stackoverflow.com/users/6518147/hynek-bernard"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470237295, "post_id": 38745818, "comment_id": 64868804, "body": "No, I don&#39;t @Comintern"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470237617, "post_id": 38745818, "comment_id": 64869052, "body": "You might need to post more of the code then.  If you can get a reference to the Workbook, it&#39;s as easy as doing this: <code>Application.Windows(wb.Name).Activate</code>"}], "answers": [{"comments": [{"owner": {"reputation": 716, "user_id": 6518147, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1204875876202728/picture?type=large", "display_name": "Hynek Bernard", "link": "https://stackoverflow.com/users/6518147/hynek-bernard"}, "edited": false, "score": 0, "creation_date": 1470314277, "post_id": 38748754, "comment_id": 64906173, "body": "This was the thing ! I needed to add Windows(&quot;MyxlsbFile.xlsb&quot;) . Thank you very much"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 10, "last_activity_date": 1473197201, "last_edit_date": 1473197201, "creation_date": 1470240707, "answer_id": 38748754, "question_id": 38745818, "link": "https://stackoverflow.com/questions/38745818/windows-activate-works-on-every-computer-except-one/38748754#38748754", "title": "Windows().Activate works on every computer except one", "body": "<p>Whether or not you can leave off the file extension when calling (eg)</p>\n\n<pre><code>Windows(\"MyxlsbFile\") \n</code></pre>\n\n<p>or</p>\n\n<pre><code>Workbooks(\"MyxlsbFile\")\n</code></pre>\n\n<p>depends on whether the Windows Explorer setting \"hide extensions for known file types\" has been checked or not: if file extensions are shown in Windows Explorer then you must include the extension when calling <code>WorkBooks()</code>. </p>\n\n<p>I'm guessing this is the issue on the one PC where you have the problem.</p>\n\n<p>Including the file extension always works (as long as there's no other error of course) </p>\n"}], "owner": {"reputation": 716, "user_id": 6518147, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1204875876202728/picture?type=large", "display_name": "Hynek Bernard", "link": "https://stackoverflow.com/users/6518147/hynek-bernard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2116, "favorite_count": 0, "accepted_answer_id": 38748754, "answer_count": 1, "score": 2, "last_activity_date": 1473197201, "creation_date": 1470232863, "question_id": 38745818, "link": "https://stackoverflow.com/questions/38745818/windows-activate-works-on-every-computer-except-one", "title": "Windows().Activate works on every computer except one", "body": "<p>I have encountered a strange problem, I made macro about a <strong>year ago</strong> and it is being used <strong>every month without problems</strong>. Yesterday my boss told me, he cannot use it anymore, that it gives him some errors. I now tried the macro on <strong>8 computers</strong> and the macro <strong>ran perfectly</strong>. Why is it that macro runs on everyone else's computer, except for my boss.</p>\n\n<p>The line it breaks on</p>\n\n<pre><code>Windows(\"MyxlsbFile\").Activate\n</code></pre>\n\n<p>And the error given is</p>\n\n<blockquote>\n  <p>Run-time error '9': Subscript out of range.</p>\n</blockquote>\n"}, {"tags": ["excel", "vba", "alignment", "excel-2007", "rows"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470233095, "post_id": 38745657, "comment_id": 64865526, "body": "Your code aligns exactly as expected for me: <a href=\"http://i.imgur.com/F1ypKi8.png\" rel=\"nofollow noreferrer\">i.imgur.com/F1ypKi8.png</a> (running Excel 2013 - works in all magnifications but 70% is depicted). Could be a 2007 thing? Can someone else with 2007 verify?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1470264682, "post_id": 38745657, "comment_id": 64883528, "body": "In Excel 2010 they also align perfectly at various zoom levels."}, {"owner": {"reputation": 31, "user_id": 6620638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be27fd89091263cf2160453236708b1?s=128&d=identicon&r=PG&f=1", "display_name": "John Douglas", "link": "https://stackoverflow.com/users/6620638/john-douglas"}, "edited": false, "score": 0, "creation_date": 1470274842, "post_id": 38745657, "comment_id": 64886929, "body": "Hey thanks Laur for confirming the issue.  I have also tested with Active-X controls, demonstrating that OLEObjects suffer from the same misalignment issue. My research has also shown that this is a concurrent issue in Excel versions&#39; at least involving, and up to Ver07. Any solutions welcomed, or comments based on experience ?  Thanks again in advance ;)"}], "owner": {"reputation": 31, "user_id": 6620638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be27fd89091263cf2160453236708b1?s=128&d=identicon&r=PG&f=1", "display_name": "John Douglas", "link": "https://stackoverflow.com/users/6620638/john-douglas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1470257462, "creation_date": 1470232488, "last_edit_date": 1470257462, "question_id": 38745657, "link": "https://stackoverflow.com/questions/38745657/formbuttons-misalignment", "title": "FormButtons misalignment?", "body": "<p>I am currently having an issue with form button misalignment with the rows. I am running the following code and getting different results each time. As per snap shot below, it appears that unless I zoom to 100% view, the following misalignment occurs. Does anyone have a solution?</p>\n\n<p>Main Procedure:       </p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    '   Sub ColumnA_Buttons()\n        Dim buttons As Button\n        Dim rng As Range\n        Dim LineQty As Variant\n\n            Application.ScreenUpdating = False\n            ActiveSheet.buttons.Delete\n\n        LineQty = 20\n\n        For i = 1 To LineQty\n            Set rng = ActiveSheet.Range(Cells(i, 1), Cells(i, 1))\n            Set buttons = ActiveSheet.buttons.Add(rng.Left, rng.Top, rng.Width, rng.Height)\n\n                With buttons\n                    .OnAction = \"Buttons\"\n                    .Caption = \"Line \" &amp; i\n                    .Name = \"Line \" &amp; i\n                    End With\n            Next i\n\n            Application.ScreenUpdating = True\n       End Sub\n</code></pre>\n\n<p>Button Module:</p>\n\n<pre><code>Sub buttons()\n    Dim Btn As Variant\n\n     Btn = Application.Caller\n\n     'MyUserForm1.Show 'Launch custom userform\n     MsgBox Btn &amp; \"  was Clicked\"\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/YhJFI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YhJFI.jpg\" alt=\"Excel Misalignment\"></a></p>\n"}, {"tags": ["vba", "excel", "listbox", "add-in"], "comments": [{"owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 1, "creation_date": 1470232347, "post_id": 38745515, "comment_id": 64864915, "body": "Probably your old project had a reference that imported MSForms.ListBox. Check the references each are using and make sure they match. Menu is at <code>Tools &gt; References...</code> in the VBE"}, {"owner": {"reputation": 11, "user_id": 6390859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d8eadfc30c76b5f369bf4d82f31c7dd?s=128&d=identicon&r=PG&f=1", "display_name": "kaleme", "link": "https://stackoverflow.com/users/6390859/kaleme"}, "reply_to_user": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "edited": false, "score": 0, "creation_date": 1470233138, "post_id": 38745515, "comment_id": 64865569, "body": "Thank you very much!   I add the <i>Microsoft Forms 2.0 Object Library</i> reference to my Add-in project and It works well."}], "owner": {"reputation": 11, "user_id": 6390859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d8eadfc30c76b5f369bf4d82f31c7dd?s=128&d=identicon&r=PG&f=1", "display_name": "kaleme", "link": "https://stackoverflow.com/users/6390859/kaleme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1120, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1470232103, "creation_date": 1470232103, "last_edit_date": 1531164843, "question_id": 38745515, "link": "https://stackoverflow.com/questions/38745515/add-in-msforms-listbox", "title": "Add-in MSForms.ListBox", "body": "<p>I wrote a function to populate a listbox object : </p>\n\n<pre><code>Sub populate_listBox(ByRef wsSheet As Worksheet, ByRef colonne As String, ByRef myListBox As MSForms.ListBox)\n\nDim rnData As Range\nDim vaData As Variant               'the list, stored in a variant\nDim ncData As New VBA.Collection    'the list, stored in a collection\nDim lnCount As Long                 'the count used in the On Error Resume Next loop.\nDim vaItem As Variant               'a variant representing the type of items in ncData\n\n'Using Sheet2,retrieve the range of the list in Column A.\nWith wsSheet\n    Set rnData = .Range(.Range(colonne &amp; \"2\"), .Range(colonne &amp; \"2\").End(xlDown))\n    'Set rnData = .Range(\"D:D\")\n    rnData.Sort Key1:=.Range(colonne &amp; \"2\"), order1:=xlAscending, Header:=xlNo\nEnd With\n\n'Place the list values into vaData.\nvaData = rnData.Value\n'Place the list values from vaData into the VBA.Collection.\nOn Error Resume Next\nFor lnCount = 1 To UBound(vaData)\n    ncData.Add vaData(lnCount, 1), CStr(vaData(lnCount, 1))\nNext lnCount\nOn Error GoTo 0\n\n'Clear the List box (in case you ran the macro before),\n'and then add each unique variant item from ncData to the combo box.\n\nWith myListBox\n    .Clear\n    For Each vaItem In ncData\n        .AddItem vaItem\n    Next vaItem\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This function works very well when it is defined in the current project : </p>\n\n<pre><code>Private Sub UserForm_Initialize()\nDim wsSheet As Worksheet\n\nSet wsSheet = ThisWorkbook.Worksheets(\"data\")\nwsSheet.AutoFilterMode = False\n\nCall populate_listBox(wsSheet, \"F\", UserFormCoutMoyen.ListBoxReparateurs)\n\nEnd Sub\n</code></pre>\n\n<p>But I am currently using an Add-in project called src_vba.xlam.<br>\nI added the <em>populate_listBox</em> function to this Add-in but it raises an error when I called it :  </p>\n\n<pre><code>Private Sub UserForm_Initialize()\n'The Excel workbook and worksheets that contain the data, as well as the range placed on that data\n\nDim wsSheet As Worksheet\n\nSet wsSheet = ThisWorkbook.Worksheets(\"data\")\nwsSheet.AutoFilterMode = False\n\nCall src.populate_listBox(wsSheet, \"F\", UserFormCoutMoyen.ListBoxReparateurs)\n\nEnd Sub\n</code></pre>\n\n<p>The message error is : <em>\"type defined by user is not defined\"</em> and the application stopped on that line : </p>\n\n<pre><code>Sub populate_listBox(ByRef wsSheet As Worksheet, ByRef colonne As String, ByRef myListBox As MSForms.ListBox)\n</code></pre>\n\n<p>I think that the problem is about the definition of the listbox when I use an Add-in function as it works well before using Add-in. </p>\n\n<p>Could you please tell me what do I have to modify? </p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1470233508, "post_id": 38745314, "comment_id": 64865814, "body": "Get rid of <code>On Error Resume Next</code> (See <a href=\"https://stackoverflow.com/documentation/vba/3211/error-handling/11022/resume-keyword\">Documentation</a>). Because of this line, any error you&#39;re getting in your code is being totally ignored. Report back any error messages (edit your post to include them) you&#39;re getting. Then read the rest of that Documentation section on error handling. There is <i>almost</i> <b>never</b> a good reason to use OERN."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1470234223, "post_id": 38745314, "comment_id": 64866342, "body": "Also, you are trying to filter field #35 on a one column range.  The previous post you linked to shows this correction in the comments."}, {"owner": {"reputation": 11, "user_id": 6672425, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2GnSU1I7ZZY/AAAAAAAAAAI/AAAAAAAAAk8/O4ThLBA-YNA/photo.jpg?sz=128", "display_name": "dmalvareg", "link": "https://stackoverflow.com/users/6672425/dmalvareg"}, "edited": false, "score": 0, "creation_date": 1470308018, "post_id": 38745314, "comment_id": 64902176, "body": "I just updated the code. Still nothing is being solved. Any suggestions?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6672425, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2GnSU1I7ZZY/AAAAAAAAAAI/AAAAAAAAAk8/O4ThLBA-YNA/photo.jpg?sz=128", "display_name": "dmalvareg", "link": "https://stackoverflow.com/users/6672425/dmalvareg"}, "is_accepted": false, "score": 0, "last_activity_date": 1470318424, "creation_date": 1470318424, "answer_id": 38769187, "question_id": 38745314, "link": "https://stackoverflow.com/questions/38745314/splitting-data-from-excel-worksheet-into-multiple-workbooks-based-in-a-column-va/38769187#38769187", "title": "Splitting data from excel worksheet into multiple workbooks based in a column value", "body": "<p>I found the answer. I post it in here in case is of help for somebody using named tables or databases :)</p>\n\n<pre><code>Sub CreateBatchWorkbooks()\n\nOn Error Resume Next\nApplication.DisplayAlerts = False\n\nWith ThisWorkbook.Sheets(\"CalcData\")  'Replace the sheet name with the raw data sheet name\n\nSet Newsheet = ThisWorkbook.Sheets(\"cal\")\n\n    If Newsheet Is Nothing Then\n            Worksheets.Add.Name = \"cal\"\n        Else\n            ThisWorkbook.Sheets(\"cal\").Delete\n            Worksheets.Add.Name = \"cal\"\n    End If\n\n        FilterField = WorksheetFunction.Match(\"BatchNumber ()\", ThisWorkbook.Sheets(\"CalcData\").Range(\"1:1\"), 0)\n\n        .Columns(FilterField).Copy\n\n            With ThisWorkbook.Sheets(\"cal\")\n                .Range(\"a1\").PasteSpecial (xlPasteAll)\n                .Columns(\"a\").RemoveDuplicates Columns:=1, Header:=xlYes\n            End With\n\n                    Dim rngFilteredCalcData\n                    For Each cell In ThisWorkbook.Sheets(\"cal\").Columns(\"a\").Cells\n                        i = i + 1\n                            If i &lt;&gt; 1 And cell.Value &lt;&gt; \"\" Then\n                                Set rngFilteredCalcData = .ListObjects(\"tblCalcData\").Range\n                                rngFilteredCalcData.AutoFilterMode = False\n                                rngFilteredCalcData.AutoFilter field:=FilterField, Criteria1:=cell.Value\n\n                                Set new_book = Workbooks.Add\n                                rngFilteredCalcData.SpecialCells(xlCellTypeVisible).Rows.Copy\n                                new_book.Sheets(1).Range(\"a1\").PasteSpecial (xlPasteAll)\n                                new_book.SaveAs Filename:=ThisWorkbook.Path &amp; \"\\\" &amp; cell.Value &amp; \".xlsx\"\n                                new_book.Sheets(1).UsedRange.Columns.AutoFit\n                                new_book.Save\n                                new_book.Close\n                            End If\n                    Next cell\n\n                        ThisWorkbook.Sheets(\"cal\").Delete\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6672425, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2GnSU1I7ZZY/AAAAAAAAAAI/AAAAAAAAAk8/O4ThLBA-YNA/photo.jpg?sz=128", "display_name": "dmalvareg", "link": "https://stackoverflow.com/users/6672425/dmalvareg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470318424, "creation_date": 1470231561, "last_edit_date": 1495535324, "question_id": 38745314, "link": "https://stackoverflow.com/questions/38745314/splitting-data-from-excel-worksheet-into-multiple-workbooks-based-in-a-column-va", "title": "Splitting data from excel worksheet into multiple workbooks based in a column value", "body": "<p>I'm using this code (from <a href=\"https://stackoverflow.com/questions/26144525/splitting-data-from-excel-worksheet-into-multiple-workbooks/38744297#38744297\">Splitting worksheet into multiple workbooks</a>) and the code works wonders when I use a short database to be filtered in column 3. However, I have a database where the column to be used as filter, aka <em>field</em>, is in the 35 column or \"AI\" and in this case the code doesn't work. So, this code just creates the workbooks depending on the value of the filtered column (good) but the data itself is not filtered, creating (in this case) three identical files. Any Suggestions? This is the code I used:</p>\n\n<pre><code>Sub CreateBatchWorkbooks()\n\nOn Error Resume Next\nApplication.DisplayAlerts = False\n\nWith ThisWorkbook.Sheets(\"CalcData\")  'Replace the sheet name with the raw data sheet name\n\nSet Newsheet = ThisWorkbook.Sheets(\"cal\")\n\n    If Newsheet Is Nothing Then\n            Worksheets.Add.Name = \"cal\"\n        Else\n            ThisWorkbook.Sheets(\"cal\").Delete\n            Worksheets.Add.Name = \"cal\"\n    End If\n\n        FilterField = WorksheetFunction.Match(\"BatchNumber ()\", ThisWorkbook.Sheets(\"CalcData\").Range(\"1:1\"), 0)\n\n        .Columns(FilterField).Copy\n\n            With ThisWorkbook.Sheets(\"cal\")\n                .Range(\"a1\").PasteSpecial (xlPasteAll)\n                .Columns(\"a\").RemoveDuplicates Columns:=1, Header:=xlYes\n            End With\n\n                    For Each cell In ThisWorkbook.Sheets(\"cal\").Columns(\"a\").Cells\n                        i = i + 1\n                            If i &lt;&gt; 1 And cell.Value &lt;&gt; \"\" Then\n                                .AutoFilterMode = False\n                                .Rows(1).AutoFilter field:=FilterField, Criteria1:=cell.Value\n                                Set new_book = Workbooks.Add\n                                .UsedRange.Copy\n                                new_book.Sheets(1).Range(\"a1\").PasteSpecial (xlPasteAll)\n                                new_book.SaveAs Filename:=ThisWorkbook.Path &amp; \"\\\" &amp; cell.Value &amp; \".xlsx\"\n                                new_book.Sheets(1).UsedRange.Columns.AutoFit\n                                new_book.Save\n                                new_book.Close\n                            End If\n                    Next cell\n\n                        ThisWorkbook.Sheets(\"cal\").Delete\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1470231361, "post_id": 38744859, "comment_id": 64864131, "body": "Hi Alex, can you try the solution posted in this <a href=\"http://stackoverflow.com/questions/25247671/saving-multiple-worksheets-to-a-single-pdf?rq=1\">very similar question</a>? I&#39;m closing yours as a duplicate for now -- if you have trouble with that solution, please edit your Question with updated code &amp; problem(s), and I&#39;ll re-open it."}, {"owner": {"reputation": 4365, "user_id": 1887723, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/nNfYR.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1887723/alex"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1470231614, "post_id": 38744859, "comment_id": 64864355, "body": "Hi David, I must have not explained it correctly. The similar question linked would work if I was printing all my templates. But I&#39;m actually sending my template information to a more professional, sleek looking report Worksheet. The report is then the one that I want into a PDF. The problem is, I only have one report worksheet that gets filled in by multiple templates. Does that make more sense?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1470232541, "post_id": 38744859, "comment_id": 64865072, "body": "Use workbook instead of worksheet. <code>ActiveWorkbook.ExportAsFixedFormat</code>"}, {"owner": {"reputation": 4365, "user_id": 1887723, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/nNfYR.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1887723/alex"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1470232719, "post_id": 38744859, "comment_id": 64865215, "body": "@Nathan_Sav That will export all my templates and only 1 report. I don&#39;t want all my templates to be exported to PDF. For each serial number I want that template&#39;s information to be sent to the report, then the report is turned into a PDF page, and so on. No templates are exported, only the report."}, {"owner": {"reputation": 4365, "user_id": 1887723, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/nNfYR.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1887723/alex"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1470232742, "post_id": 38744859, "comment_id": 64865233, "body": "@DavidZemens Modified the post a little. Take a look at my comment."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1470232769, "post_id": 38744859, "comment_id": 64865258, "body": "Yes that makes more sense and I&#39;ve re-opened the question, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 4365, "user_id": 1887723, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/nNfYR.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1887723/alex"}, "edited": false, "score": 1, "creation_date": 1470234854, "post_id": 38746059, "comment_id": 64866874, "body": "Exactly what I was starting to do once I asked this question, haha. I&#39;ll accept your answer, thank you David."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1470233515, "creation_date": 1470233515, "answer_id": 38746059, "question_id": 38744859, "link": "https://stackoverflow.com/questions/38744859/how-to-create-pdf-using-a-single-worksheet-in-a-loop/38746059#38746059", "title": "How to create PDF using a single worksheet in a loop", "body": "<p>I think you can handle this in a loop. My idea is to do the following:</p>\n\n<p><em>After</em> copying the data to the \"Report\" sheet, create a <em>Copy</em> of that sheet in a new workbook. This new workbook will contain each of the \"Report\" sheets, and then you can export the entire new workbook</p>\n\n<p>I haven't tested it, but let's try something like this:</p>\n\n<pre><code>Sub CreatePDF()\nDim currentSerialNumber As String 'Worksheet name is the same as the serial number\nDim ws As Worksheet\nDim pdfFilePath As String\nDim reports As Workbook\n\n'## Add a new workbook an\nSet reports = Workbooks.Add\nThisWorkbook.Activate\nDo Until reports.Worksheets.Count = 1\n    reports.Worksheets(reports.Worksheets.Count).Delete\nLoop\n\n'Create a report for each serial number written in the Summary worksheet and export it to PDF\nFor i = 10 To Rows.Count 'Start at row #10\n    If IsEmpty(Worksheets(\"Summary\").Range(\"B\" &amp; i).Value) = False Then\n        'Do work\n        currentSerialNumber = Worksheets(\"Summary\").Range(\"B\" &amp; i).Value 'Fetches the serial number\n        pdfFilePath = \"C:\\\" &amp; currentSerialNumber &amp; \".pdf\" 'Ex: C:\\1000.pdf\n        Worksheets(currentSerialNumber).Activate 'Activate the template for this current serial number\n        GenerateReport (currentSerialNumber) 'Put all the info from the template of this serial # into the report worksheet\n        Set ws = Worksheets(\"Reports\") 'Set ws object as the report worksheet\n        '## Copy the Reports sheet to the new workbook\n        ws.Copy After:=reports.Worksheets(reports.Worksheets.Count)\n\n    Else\n        'No more serial numbers found, exit this loop\n        Exit For\n    End If\nNext i\n\n'## There is an empty worksheet in the Reports file, so we can remove it:\nreports.Worksheets(1).Delete\n'## select all sheets in reports:\nreports.Worksheets.Select\n'## Export the entire file as fixedformat:\nreports.ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\n                           Filename:=pdfFilePath, _\n                           Quality:=xlQualityStandard, _\n                           IncludeDocProperties:=True, _\n                           IgnorePrintAreas:=False, _\n                           OpenAfterPublish:=False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4365, "user_id": 1887723, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/nNfYR.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1887723/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1441, "favorite_count": 0, "accepted_answer_id": 38746059, "answer_count": 1, "score": 1, "last_activity_date": 1470233515, "creation_date": 1470230438, "last_edit_date": 1470232750, "question_id": 38744859, "link": "https://stackoverflow.com/questions/38744859/how-to-create-pdf-using-a-single-worksheet-in-a-loop", "title": "How to create PDF using a single worksheet in a loop", "body": "<h2>Current Situation</h2>\n\n<p>My Excel workbook contains anywhere from <strong>10 to 32 worksheets used as templates</strong>. It also contains 1 worksheet called \"Report\". I currently loop through all template worksheets and <strong>put the information into the Report</strong> worksheet, then I create a PDF using that report worksheet.</p>\n\n<p>However this creates 1 PDF per template because it passes through my Report worksheet.</p>\n\n<p>Everytime I send the information to my Report worksheet, that gets turned into a PDF. The problem with that is it generates a PDF everytime my report worksheet gets filled in. I am <strong>not exporting my templates</strong> as PDF.</p>\n\n<hr>\n\n<h2>Code</h2>\n\n<p>Here's the code that <strong>generates 1 PDF file per template</strong>:</p>\n\n<pre><code>Sub CreatePDF()\nDim currentSerialNumber As String 'Worksheet name is the same as the serial number\nDim ws As Worksheet\nDim pdfFilePath As String\n\n'Create a report for each serial number written in the Summary worksheet and export it to PDF\nFor i = 10 To Rows.Count 'Start at row #10\n    If IsEmpty(Worksheets(\"Summary\").Range(\"B\" &amp; i).Value) = False Then\n        'Do work\n        currentSerialNumber = Worksheets(\"Summary\").Range(\"B\" &amp; i).Value 'Fetches the serial number\n        pdfFilePath = \"C:\\\" &amp; currentSerialNumber &amp; \".pdf\" 'Ex: C:\\1000.pdf\n        Worksheets(currentSerialNumber).Activate 'Activate the template for this current serial number\n        GenerateReport (currentSerialNumber) 'Put all the info from the template of this serial # into the report worksheet\n        Set ws = Worksheets(\"Reports\") 'Set ws object as the report worksheet\n        ws.UsedRange.Select\n        ws.ExportAsFixedFormat Type:=xlTypePDF, _\n                               Filename:=pdfFilePath, _\n                               Quality:=xlQualityStandard, _\n                               IncludeDocProperties:=True, _\n                               IgnorePrintAreas:=False, _\n                               OpenAfterPublish:=False\n    Else\n        'No more serial numbers found, exit this loop\n        Exit For\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>Goal</h2>\n\n<p>I want to loop through each template, send the information to my report, add that report information as a page in a PDF file, and repeat until no more templates. </p>\n\n<p>The similar question linked would work if I was printing all my templates. But I'm actually sending my template information to a more professional, sleek looking report Worksheet. The report is then the one that I want into a PDF. The problem is, I only have one report worksheet that gets filled in by multiple templates. </p>\n\n<p>Is this possible using VBA in Excel?</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010", "ms-access-2013"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1470230646, "post_id": 38744828, "comment_id": 64863609, "body": "Add a field to your table with the <i>Sent</i> date, then filter for <i>Sent</i> dates being Null or older than two weeks. For this recordset update <i>Sent</i> to <code>Date()</code>."}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1470231195, "post_id": 38744828, "comment_id": 64864014, "body": "This will work. The reason I&#39;m asking is because I have a list of Calibrations that have not been started are approaching the due date. I want to remind the users every two weeks. Informing them about each calibrations and their due date so they can always be alert."}, {"owner": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470232514, "post_id": 38744828, "comment_id": 64865048, "body": "Is  calibarationDate list in other table, or they are fields in the same record?"}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "edited": false, "score": 1, "creation_date": 1470233676, "post_id": 38744828, "comment_id": 64865916, "body": "If you&#39;re referring to the SerialNo, ModelNo, AssetNo, and Equip than no. Those fields are in the equipment table. The due date employee, location, and ID is in the calibration table. I created a query for those records to create a list of calibrations that have the status of &quot;Not Started&quot;. I&#39;m trying to send that list to users as a email reminder once every two weeks. I need to know if I need some type of vba code in my GenerateEmail that will let the system know to only send this list once every two weeks."}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1470234362, "post_id": 38744828, "comment_id": 64866456, "body": "@Gustav what code are you referring to when you mention update Sent to Date(). Are you referring to rs!DateEmailSent = Date or the query?"}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1470234553, "post_id": 38744828, "comment_id": 64866623, "body": "@Gustav is this correct for the criteria in the query <code>&lt;Date()-14</code>"}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "reply_to_user": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470234650, "post_id": 38744828, "comment_id": 64866695, "body": "@M.Hassan, what do you think?"}, {"owner": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470235209, "post_id": 38744828, "comment_id": 64867164, "body": "you have to loop over the calibration list and check if (date() -[due date] = 14) and ( not_started)"}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "reply_to_user": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470235656, "post_id": 38744828, "comment_id": 64867559, "body": "@M.Hassan do I put that in my query or my vba code"}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "reply_to_user": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470236070, "post_id": 38744828, "comment_id": 64867900, "body": "@M.Hassan, also what do you mean by loop over? Do I input if (date() -[due date] = 14) and ( not_started) under the loop in my vba code?"}, {"owner": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470236621, "post_id": 38744828, "comment_id": 64868328, "body": "I mean you  OpenRecordset (your_caliberation_list_sql) , and the loop over is (Do Until rs.EOF). I suggest re-engineer your code and divide your procedure to two procedures. The first one is looping using rs.EOF and call sendEmail() (the second). The second one is the new sendEmail procedure that conatain all your email logic."}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "reply_to_user": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470237022, "post_id": 38744828, "comment_id": 64868617, "body": "@M.Hassan  Can you show me an example pretty please?"}, {"owner": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470237184, "post_id": 38744828, "comment_id": 64868719, "body": "Ok, first can you edit your question and dump the structure of your tables."}, {"owner": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470237340, "post_id": 38744828, "comment_id": 64868843, "body": "Can you chat with me"}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "reply_to_user": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470237367, "post_id": 38744828, "comment_id": 64868860, "body": "@M.Hassan, can you show me an example? Please. When you say dump my table are you referring to my vba code or an actually table in my database."}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "reply_to_user": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470237443, "post_id": 38744828, "comment_id": 64868913, "body": "@M.Hassan, how do I chat with you?"}, {"owner": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470237546, "post_id": 38744828, "comment_id": 64868990, "body": "yes, i refer to your actual code. i want to the structure of calibaration table to write eample."}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "reply_to_user": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470241113, "post_id": 38744828, "comment_id": 64871536, "body": "@M.Hassan, The vba code is calling from a query that I created with a relationship between my Equipment table and Calibration table"}, {"owner": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470241366, "post_id": 38744828, "comment_id": 64871684, "body": "have a look for <a href=\"http://pasted.co/7a1b2fc2\" rel=\"nofollow noreferrer\">pasted.co/7a1b2fc2</a> . It contain the main skeleton to the code."}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "reply_to_user": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470244810, "post_id": 38744828, "comment_id": 64873759, "body": "@M.Hassan, when I test out the code I get this error stating that the oEmailAddressItem is variable not defined."}, {"owner": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1470246035, "post_id": 38744828, "comment_id": 64874461, "body": "This variable is in your code, modify the code as you wish, i can&#39;t run it bez i didn&#39;t have the table structure.just it is the skeleton of logic."}], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1470248436, "post_id": 38750034, "comment_id": 64875732, "body": "That pretty much covers it."}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "edited": false, "score": 0, "creation_date": 1470313579, "post_id": 38750034, "comment_id": 64905693, "body": "Thank you @dbmitch"}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "edited": false, "score": 0, "creation_date": 1470314368, "post_id": 38750034, "comment_id": 64906236, "body": "@dbmitch. Everything works now. I have another question. I want to include 2 weeks approaching LeadDate. How do I go about doing that."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470319360, "post_id": 38750034, "comment_id": 64910204, "body": "Should I know what LeadDate is and how you want to include it? As a new field? As a new criteria? Combine with other criteria? You should probably start a new question or update above one if it&#39;s trivial."}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "edited": false, "score": 0, "creation_date": 1470323774, "post_id": 38750034, "comment_id": 64913953, "body": "@dbmitch. Lead Time is the time between the initiation and completion of a production process. I call it Lead Date, because I create some code that calculated that change to a date. Lead Date is a field I created in a query.  If a Calibration was due on 9/15/2016 I will subtract the lead time from that due date. Lead time can be measure up to 3 weeks, 6 weeks, 9 weeks, 12 weeks, etc. Once you have that calculation than I want to send a reminder for a calibration 2 weeks approaching the LeadDate. Does this makes any sense to you?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470325134, "post_id": 38750034, "comment_id": 64914954, "body": "Sure - I just don&#39;t see any field like LeadTime or LeadDate in your query. It souns like it should be a different field and perhaps even a different function. Are you thinking of using same function?"}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "edited": false, "score": 0, "creation_date": 1470325846, "post_id": 38750034, "comment_id": 64915430, "body": "@dbmitch, SELECT CalibrationRecord.RecordID, CalibrationRecord.CalRequirement, CalibrationRecord.CalStatus, CalibrationRecord.CalLocation, Equipment.EquipmentType, Equipment.SerialNo, Equipment.ModelNo, Equipment.AssetNo, CalibrationRecord.EmpName, Employees.EmailAddress, CalibrationRecord.LastCalDate, CalibrationRecord.CalTimeInterval, CalibrationRecord.UOM"}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "edited": false, "score": 0, "creation_date": 1470325868, "post_id": 38750034, "comment_id": 64915450, "body": "DateAdd(IIf([CalibrationRecord]![UOM]=&quot;days&quot;,&quot;d&quot;,IIf([Calibr&zwnj;&#8203;ationRecord]![UOM]=&quot;&zwnj;&#8203;month&quot;,&quot;m&quot;,&quot;yyyy&quot;)),&zwnj;&#8203;[CalTimeInterval],[L&zwnj;&#8203;astCalDate]) AS CalUpcomingDate, CalibrationRecord.DateEmailSent, DateAdd(IIf([Equipment]![UOM]=&quot;weeks&quot;,&quot;ww&quot;),-[LeadInterval],&zwnj;&#8203;[CalUpcomingDate]) AS LeadDate FROM Equipment INNER JOIN (Employees INNER JOIN CalibrationRecord ON Employees.EmpID = CalibrationRecord.EmpName) ON Equipment.ItemID = CalibrationRecord.EquipItemID"}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "edited": false, "score": 0, "creation_date": 1470325886, "post_id": 38750034, "comment_id": 64915467, "body": "WHERE (((CalibrationRecord.CalStatus)=&quot;Not Started&quot;) AND ((Employees.EmailAddress) Is Not Null) AND ((CalibrationRecord.CalTimeInterval) Between 6 And 9) AND ((CalibrationRecord.UOM) Like &quot;month&quot;) AND ((Employees.EmpName) Not Like &quot;MFGUSER&quot;)) OR (((CalibrationRecord.UOM) Like &quot;days&quot;));"}, {"owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "edited": false, "score": 0, "creation_date": 1470325949, "post_id": 38750034, "comment_id": 64915514, "body": "@dbmitch. Above is the query that I am using."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470327816, "post_id": 38750034, "comment_id": 64916817, "body": "I&#39;d suggest you start a new question or edit your question above and append the query and new question. Posting code in comments is unreadable"}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1470244898, "creation_date": 1470244898, "answer_id": 38750034, "question_id": 38744828, "link": "https://stackoverflow.com/questions/38744828/i-want-to-set-up-my-email-reminder-on-a-bi-weekly-basis-in-access/38750034#38750034", "title": "I want to set up my email reminder on a bi-weekly basis in access", "body": "<p>It looks like you had the right idea once - and @Gustav pointed out the solution. </p>\n\n<p>You first need to uncomment out the lines:</p>\n\n<pre><code>' rs.Edit\n' rs!DateEmailSent = Date\n' rs.Update\n</code></pre>\n\n<p>Then change what happens when you process each email address:</p>\n\n<blockquote>\n  <p><strong>Suggested new look of your program:</strong>   </p>\n</blockquote>\n\n<pre><code>rs.MoveFirst\nDo Until rs.EOF\n\n    If Not IsNull(rs!EmailAddress) Then\n\n        ' Only Send Emails if never been sent before - or past 14 days since last one'\n         If (IsNull(rs!DateEmailSent)) Or DateDiff(\"d\", rs!DateEmailSent, Date) &gt;= 14 Then\n\n            If oOutLook Is Nothing Then\n                Set oOutLook = New Outlook.Application\n            End If\n            Set oEmailAddressItem = oOutLook.CreateItem(olMailItem)\n\n            ' ... rest of email processing '\n            ' .................... '\n\n            .Display\n            .Send\n\n            ' Make sure to record that reminder was sent '\n             rs.Edit\n             rs!DateEmailSent = Date\n             rs.Update\n\n            ' Only do this if this has been set '\n            Set oEmailAddressItem = Nothing\n         End If\n    End If\n\n    rs.MoveNext\nLoop\n\n' Do this at end '\nSet oOutLook = Nothing\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6635995, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a29191da3fa91e47459356ed4515ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6635995/unknown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 38750034, "answer_count": 1, "score": 1, "last_activity_date": 1593988474, "creation_date": 1470230352, "last_edit_date": 1593988474, "question_id": 38744828, "link": "https://stackoverflow.com/questions/38744828/i-want-to-set-up-my-email-reminder-on-a-bi-weekly-basis-in-access", "title": "I want to set up my email reminder on a bi-weekly basis in access", "body": "<p>I need help creating some code that will send email reminders once every two weeks. I already have code that send email reminders, but it sends the emails once everyday. That can be very annoying to the users </p>\n\n<p>Here is my vba code from access:</p>\n\n<pre><code> Function GenerateEmail(MySQL As String)\n 'On Error GoTo Exit_Function:\n  Dim oOutLook As Outlook.Application\n  Dim oEmailAddress As MailItem\n  Dim MyEmpName As String\n  Dim MyEquip As String\n  Dim MyModel As String\n  Dim MyAsset As String\n  Dim MySerial As String\n  Dim rs As Recordset\n  Set rs = CurrentDb.OpenRecordset(MySQL)\n If rs.RecordCount &gt; 0 Then\nrs.MoveFirst\nDo Until rs.EOF\nIf IsNull(rs!EmailAddress) Then\n        rs.MoveNext\nElse\nIf oOutLook Is Nothing Then\nSet oOutLook = New Outlook.Application\nEnd If\n Set oEmailAddressItem = oOutLook.CreateItem(olMailItem)\n With oEmailAddressItem\n\n           MyEmpName = DLookup(\"EmpName\", \"Employees\", \"[EmpID]= \" &amp; rs!EmpName)\n            MyEquip = rs!EquipmentType\n            MyModel = rs!ModelNo\n            MyAsset = rs!AssetNo\n            MySerial = rs!SerialNo\n            .To = \"another@.com;another@.com;another@.com\"\n            .Subject = \"Calibration that's due between 1 to 11 months\"\n            .Body = \"Calibration ID: \" &amp; rs!RecordID &amp; vbCr &amp; _\n                    \"Location: \" &amp; rs!CalLocation &amp; vbCr &amp; _\n                   \"Requirement: \" &amp; rs!CalRequirement &amp; vbCr &amp; _\n                   \"Employee: \" &amp; MyEmpName &amp; vbCr &amp; _\n                   \"Name: \" &amp; MyEquip &amp; vbCr &amp; _\n                   \"Serial No.: \" &amp; MySerial &amp; vbCr &amp; _\n                   \"Model No.: \" &amp; MyModel &amp; vbCr &amp; _\n                   \"Asset No.: \" &amp; MyAsset &amp; vbCr &amp; _\n                   \"Due Date : \" &amp; rs!CalUpcomingDate &amp; vbCr &amp; vbCr &amp; _\n                   \"This email is auto generated. Please Do Not Replay!\"\n            'MyEmpName = DLookup(\"EmpName\", \"Employees\", \"[EmpID]= \" &amp; rs!EmpName)\n            '.To = rs!EmailAddress\n            '.Subject = \"Task due in between 1st and 11th month reminder for \" &amp; MyEmpName\n            '.Body = \"Task ID: \" &amp; rs!RecordID &amp; vbCr &amp; _\n                   '\"Task Name: \" &amp; rs!TaskName &amp; vbCr &amp; _\n                   '\"Employees: \" &amp; MyEmpName &amp; vbCr &amp; _\n                  ' \"Task Due: \" &amp; rs!CalUpcomingDate &amp; vbCr &amp; vbCr &amp; _\n                   '\"This email is auto generated from Task Database. Please Do Not Replay!\"\n             .Display\n             '.Send\n             ' rs.Edit\n             ' rs!DateEmailSent = Date\n             ' rs.Update\n      End With\n      Set oEmailAddressItem = Nothing\n      Set oOutLook = Nothing\n      rs.MoveNext\n  End If\nLoop\nElse\n'do nothing\nEnd If\nrs.Close\nExit_Function:\nExit Function\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1470233826, "post_id": 38744688, "comment_id": 64866048, "body": "Even if a query results in an empty recordset, you should be able to execute and run the query without a problem. So, if the command <code>.Open</code>  results in an error then the problem must be something else. Also, do you mind adding the appropriate tag to the post of the server (sql-2008r2, sql-2012, or something else)."}], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 6667879, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d24125511b2a08c2ed9f433f6412aae4?s=128&d=identicon&r=PG&f=1", "display_name": "JuniorDev", "link": "https://stackoverflow.com/users/6667879/juniordev"}, "edited": false, "score": 0, "creation_date": 1470232028, "post_id": 38745230, "comment_id": 64864672, "body": "thanks for your answer but still the same problem. I get an error in objMyRecordset.Open because my recordset is empty"}], "tags": [], "owner": {"reputation": 123, "user_id": 6370467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9778aeec18a9b296a9f8c4da6cc9041?s=128&d=identicon&r=PG&f=1", "display_name": "V. Wolf", "link": "https://stackoverflow.com/users/6370467/v-wolf"}, "is_accepted": false, "score": 0, "last_activity_date": 1470231343, "creation_date": 1470231343, "answer_id": 38745230, "question_id": 38744688, "link": "https://stackoverflow.com/questions/38744688/vba-macro-save-sql-query-in-a-csv-file/38745230#38745230", "title": "VBA macro save SQL query in a csv file", "body": "<p>you should go with your <code>.EOF</code> solution. Here is an example of mine, which I use regularly.</p>\n\n<pre><code>Sub AnySub()\n\n    ''recordsets\n    Dim rec as ADODB.Recordset\n\n    ''build your query here\n    sSql = \"SELECT * FROM mytable where 1=0\" ''just to have no results\n\n    ''Fire query\n    Set rec = GetRecordset(sSql, mycnxnstring)\n\n    ''and then loop throug your results, if there are any\n    While rec.EOF = False\n\n        ''do something with rec()\n        rec.MoveNext\n    Wend\nEnd sub\n</code></pre>\n\n<p>Here the Function <code>GetRecordset()</code> is given by:</p>\n\n<pre><code>Function GetRecordset(strQuery As String, connstring As String) As Recordset\n    Dim DB As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Set DB = New ADODB.Connection\n    With DB\n        .CommandTimeout = 300\n        .ConnectionString = connstring\n        .Open\n    End With\n    Set GetRecordset = DB.Execute(strQuery)\n\nEnd Function\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 2, "last_activity_date": 1470236807, "creation_date": 1470236807, "answer_id": 38747334, "question_id": 38744688, "link": "https://stackoverflow.com/questions/38744688/vba-macro-save-sql-query-in-a-csv-file/38747334#38747334", "title": "VBA macro save SQL query in a csv file", "body": "<p>If you experience problems connecting to your server then this is due to any of the following:</p>\n\n<ol>\n<li>an incorrect connection string</li>\n<li>incorrect credentials</li>\n<li>the server is not reachable (for example: network cable disconnected)</li>\n<li>the server is not up and running</li>\n</ol>\n\n<p>Sending a query to a server which results in an empty recordset is <strong>not</strong> a reason for an <code>ADODB.Connection</code> to fail.</p>\n\n<p>Here is a little bit of code for you to try and debug the connection in a first step and then the query in a second step:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub tmpSO()\n\nDim strSQL As String\nDim strServer As String\nDim strDatabase As String\nDim OutMail As Outlook.MailItem\nDim rstResult As ADODB.Recordset\nDim conServer As ADODB.Connection\nDim OutApp As Outlook.Application\n\nstrServer = \".\"\nstrDatabase = \"master\"\n\nSet conServer = New ADODB.Connection\nconServer.ConnectionString = \"PROVIDER=SQLOLEDB; \" _\n    &amp; \"DATA SOURCE=\" &amp; strServer &amp; \";\" _\n    &amp; \"INITIAL CATALOG=\" &amp; strDatabase &amp; \";\" _\n    &amp; \"User ID='UserNameWrappedInSingleQuotes'; \" _\n    &amp; \"Password='PasswordWrappedInSingleQuotes'; \"\nOn Error GoTo SQL_ConnectionError\nconServer.Open\nOn Error GoTo 0\n\nstrSQL = \"set nocount on; \"\nstrSQL = strSQL &amp; \"select  * \"\nstrSQL = strSQL &amp; \"from    sys.tables as t \"\nstrSQL = strSQL &amp; \"where   t.name = ''; \"\n\nSet rstResult = New ADODB.Recordset\nrstResult.ActiveConnection = conServer\nOn Error GoTo SQL_StatementError\nrstResult.Open strSQL\nOn Error GoTo 0\n\nIf Not rstResult.EOF And Not rstResult.BOF Then\n    ThisWorkbook.Worksheets(1).Range(\"A1\").CopyFromRecordset rstResult\n'    While Not rstResult.EOF And Not rstResult.BOF\n'        'do something\n'        rstResult.MoveNext\n'    Wend\nElse\n    'https://msdn.microsoft.com/en-us/library/windows/desktop/ms675546(v=vs.85).aspx\n    Select Case conServer.State\n        'adStateClosed\n        Case 0\n            MsgBox \"The connection to the server is closed.\"\n        'adStateOpen\n        Case 1\n            MsgBox \"The connection is open but the query did not return any data.\"\n        'adStateConnecting\n        Case 2\n            MsgBox \"Connecting...\"\n        'adStateExecuting\n        Case 4\n            MsgBox \"Executing...\"\n        'adStateFetching\n        Case 8\n            MsgBox \"Fetching...\"\n        Case Else\n            MsgBox conServer.State\n        End Select\nEnd If\n\nSet rstResult = Nothing\n\nExit Sub\n\nSQL_ConnectionError:\nMsgBox \"Couldn't connect to the server. Please make sure that you have a working connection to the server.\"\n\nSet OutApp = New Outlook.Application\nSet OutMail = OutApp.CreateItem(0)\nWith OutMail\n    .Subject = \"Problems connecting to database '\" &amp; strDatabase &amp; \"' hosted on the server '\" &amp; strServer &amp; \"'\"\n    .HTMLBody = \"&lt;span style=\"\"font-size:10px\"\"&gt;---Automatically generated Error-Email---\" &amp; _\n            \"&lt;/span&gt;&lt;br&gt;&lt;br&gt;Error report from the file '\" &amp; _\n            \"&lt;span style=\"\"color:blue\"\"&gt;\" &amp; ThisWorkbook.Name &amp; _\n            \"&lt;/span&gt;' located and saved on '&lt;span style=\"\"color:blue\"\"&gt;\" &amp; _\n            ThisWorkbook.Path &amp; \"&lt;/span&gt;'.&lt;br&gt;\" &amp; _\n            \"Excel is not able to establish a connection to the server. Technical data to follow.\" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; _\n            \"Computer Name:    &lt;span style=\"\"color:green;\"\"&gt;\" &amp; Environ(\"COMPUTERNAME\") &amp; \"&lt;/span&gt;&lt;br&gt;\" &amp; _\n            \"Logged in as:     &lt;span style=\"\"color:green;\"\"&gt;\" &amp; Environ(\"USERDOMAIN\") &amp; \"/\" &amp; Environ(\"USERNAME\") &amp; \"&lt;/span&gt;&lt;br&gt;\" &amp; _\n            \"Domain Server:    &lt;span style=\"\"color:green;\"\"&gt;\" &amp; Environ(\"LOGONSERVER\") &amp; \"&lt;/span&gt;&lt;br&gt;\" &amp; _\n            \"User DNS Domain:  &lt;span style=\"\"color:green;\"\"&gt;\" &amp; Environ(\"USERDNSDOMAIN\") &amp; \"&lt;/span&gt;&lt;br&gt;\" &amp; _\n            \"Operating System: &lt;span style=\"\"color:green;\"\"&gt;\" &amp; Environ(\"OS\") &amp; \"&lt;/span&gt;&lt;br&gt;\" &amp; _\n            \"Excel Version:    &lt;span style=\"\"color:green;\"\"&gt;\" &amp; Application.Version &amp; \"&lt;/span&gt;&lt;br&gt;\" &amp; _\n            \"&lt;br&gt;&lt;span style=\"\"font-size:10px\"\"&gt;&lt;br&gt;\" &amp; _\n            \"&lt;br&gt;&lt;br&gt;---Automatically generated Error-Email---\"\n    .Display\nEnd With\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nExit Sub\n\nSQL_StatementError:\nMsgBox \"There seems to be a problem with the SQL Syntax in the programming.\"\n\nSet OutApp = New Outlook.Application\nSet OutMail = OutApp.CreateItem(0)\nWith OutMail\n    .Subject = \"Problems with the SQL Syntax in file '\" &amp; ThisWorkbook.Name &amp; \"'.\"\n    .HTMLBody = \"&lt;span style=\"\"font-size:10px\"\"&gt;\" &amp; _\n            \"---Automatically generated Error-Email---\" &amp; _\n            \"&lt;/span&gt;&lt;br&gt;&lt;br&gt;\" &amp; _\n            \"Error report from the file '\" &amp; _\n            \"&lt;span style=\"\"color:blue\"\"&gt;\" &amp; _\n            ActiveWorkbook.Name &amp; _\n            \"&lt;/span&gt;\" &amp; _\n            \"' located and saved on '\" &amp; _\n            \"&lt;span style=\"\"color:blue\"\"&gt;\" &amp; _\n            ActiveWorkbook.Path &amp; _\n            \"&lt;/span&gt;\" &amp; _\n            \"'.&lt;br&gt;\" &amp; _\n            \"It seems that there is a problem with the SQL-Code within trying to upload an extract to the server.\" &amp; _\n            \"SQL-Code causing the problems:\" &amp; _\n            \"&lt;br&gt;&lt;br&gt;&lt;span style=\"\"color:green;\"\"&gt;\" &amp; _\n            strSQL &amp; _\n            \"&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span style=\"\"font-size:10px\"\"&gt;\" &amp; _\n            \"---Automatically generated Error-Email---\"\n    .Display\nEnd With\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nExit Sub\n\nEnd Sub\n</code></pre>\n\n<p>Note, that the above code clearly distinguishes between (first) connecting to the server and then (afterwards) issuing a query to the server to retrieve some data. Both steps are separated and there is a different error handler for either case.</p>\n\n<p>Furthermore, the above sample code also results in an empty recordset being returned. But the code is able to handle that incident with yet another error handler.</p>\n\n<p>If the connection fails or if the SQL syntax being sent to the server contains error(s) then the above code will automatically generate an error email (using Outlook) with some details for you to check the connection and the SQL syntax.</p>\n"}], "owner": {"reputation": 403, "user_id": 6667879, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d24125511b2a08c2ed9f433f6412aae4?s=128&d=identicon&r=PG&f=1", "display_name": "JuniorDev", "link": "https://stackoverflow.com/users/6667879/juniordev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2499, "favorite_count": 1, "accepted_answer_id": 38747334, "answer_count": 2, "score": 2, "last_activity_date": 1470236807, "creation_date": 1470229941, "last_edit_date": 1531164843, "question_id": 38744688, "link": "https://stackoverflow.com/questions/38744688/vba-macro-save-sql-query-in-a-csv-file", "title": "VBA macro save SQL query in a csv file", "body": "<p>I am working on a VBA macro which connects to my database on SQL Server and run some queries and save the results on CSV files... it works fine just when the queries returns data but i have days where the query doesn't return any results, just an empty table. I made a temporary solution based on checking the date and according it the macro runs that query or no... I want to make it other way now in my code so that i don't need to change the date everytime manually...</p>\n\n<p>I tried these solutions : </p>\n\n<pre><code>If (objMyRecordset.EOF = False) Or (objMyRecordset.BOF = False) Then\n</code></pre>\n\n<p>Also this </p>\n\n<pre><code>If objMyRecordset.RecordCount &lt;&gt; 0 Then\n</code></pre>\n\n<p>but the problem is my Recordset is empty because the query doesn't return any rows so it shows me error in <code>objMyRecordset.Open</code>\nI want to add a line of code like this for example : </p>\n\n<pre><code>'// Pseudo Code\nIf (the query doesn't return result)  Then \n    ( just the headers will be save on my file )\nElse \n    (do the rest of my code)\nEnd If\n</code></pre>\n\n<hr>\n\n<p>Here is my code. Any suggestions please ? Thank you very much.</p>\n\n<pre><code>Sub Load_after_cutoff_queryCSV()\n\n    Dim objMyConn As ADODB.Connection\n    Dim objMyCmd As ADODB.Command\n    Dim objMyRecordset As ADODB.Recordset\n\n    Dim fields As String\n    Dim i As Integer\n\n    Set objMyConn = New ADODB.Connection\n    Set objMyCmd = New ADODB.Command\n    Set objMyRecordset = New ADODB.Recordset\n\n'Open Connection\n    objMyConn.ConnectionString = \"Provider=SQLOLEDB;Data Source=*****;User ID=*****;Password=*****;\"\n    objMyConn.Open\n\n'Set and Excecute SQL Command\n    Set objMyCmd.ActiveConnection = objMyConn\n\n    objMyCmd.CommandText = \"SELECT * FROM [vw_X86_LOAD_AFTER_CUTOFF_REPORT_GAMMA]\"\n\n    objMyCmd.CommandType = adCmdText\n\n'Open Recordset\n    Set objMyRecordset.Source = objMyCmd\n\n    objMyRecordset.Open\n\n    Workbooks.Open Filename:=\"C:\\Reports\\load_after_cutoff_postGamma.csv\"\n    Workbooks(\"load_after_cutoff_postGamma.csv\").Sheets(\"load_after_cutoff_postGamma\").Activate\n    ActiveSheet.Range(\"A2\").CopyFromRecordset objMyRecordset\n\n     For i = 0 To objMyRecordset.fields.Count - 1\n    Worksheets(\"load_after_cutoff_postGamma\").Cells(1, i + 1) = objMyRecordset.fields(i).name\n    Next i\n\n    Workbooks(\"load_after_cutoff_postGamma.csv\").Sheets(\"load_after_cutoff_postGamma\").Cells.EntireColumn.AutoFit\n\n    Workbooks(\"load_after_cutoff_postGamma.csv\").Close SaveChanges:=True\n    MsgBox \"Your file has been saved as load_after_cutoff_postGamma.csv\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1470229779, "post_id": 38744560, "comment_id": 64862963, "body": "worksheet_change event should help, but, think on how the value is added to A1, could it just be done in here?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1470229990, "post_id": 38744560, "comment_id": 64863134, "body": "Would cell <b>A1</b> contain a <i>Formula</i> or a <i>Typed Value</i> ??"}, {"owner": {"reputation": 152, "user_id": 6533234, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/795d09b41281a690026186a5e44e1b16?s=128&d=identicon&r=PG&f=1", "display_name": "casualprogrammer", "link": "https://stackoverflow.com/users/6533234/casualprogrammer"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1470230356, "post_id": 38744560, "comment_id": 64863399, "body": "it&#39;s technically a bloomberg function that live updates values @Gary&#39;sStudent"}], "answers": [{"tags": [], "owner": {"reputation": 983, "user_id": 5065581, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac5d7a1c0e02b47ec4a1b48c5b5b4303?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Edwards", "link": "https://stackoverflow.com/users/5065581/tim-edwards"}, "is_accepted": false, "score": 0, "last_activity_date": 1470229790, "creation_date": 1470229790, "answer_id": 38744630, "question_id": 38744560, "link": "https://stackoverflow.com/questions/38744560/excel-vba-update-cell-every-time-value-in-another-cell-changes/38744630#38744630", "title": "Excel/VBA update cell every time value in another cell changes", "body": "<p>You could use the Worksheet_SelectionChange event. I guess it depends on what else you're doing in the worksheet as to whether it would fire or not.\nYou'd have to compare the value in A1 against what was in A1 previously which would be stored in another cell.</p>\n"}, {"comments": [{"owner": {"reputation": 152, "user_id": 6533234, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/795d09b41281a690026186a5e44e1b16?s=128&d=identicon&r=PG&f=1", "display_name": "casualprogrammer", "link": "https://stackoverflow.com/users/6533234/casualprogrammer"}, "edited": false, "score": 0, "creation_date": 1470230393, "post_id": 38744659, "comment_id": 64863433, "body": "Thank you! ill give it a try"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1470229847, "creation_date": 1470229847, "answer_id": 38744659, "question_id": 38744560, "link": "https://stackoverflow.com/questions/38744560/excel-vba-update-cell-every-time-value-in-another-cell-changes/38744659#38744659", "title": "Excel/VBA update cell every time value in another cell changes", "body": "<p>The <code>Worksheet_Change()</code> is being fired when something on the sheet changes its value, so add something like this to your Sheet-Codemodule:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Address = \"$A$1\" Then\n\n    Debug.Print \"A1 has been changed!\"\n    'do something\nEnd If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 152, "user_id": 6533234, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/795d09b41281a690026186a5e44e1b16?s=128&d=identicon&r=PG&f=1", "display_name": "casualprogrammer", "link": "https://stackoverflow.com/users/6533234/casualprogrammer"}, "edited": false, "score": 0, "creation_date": 1470230818, "post_id": 38744727, "comment_id": 64863743, "body": "So this worked wonderfully when i typed in a different value, but the cell A1 contains a formula that autoupdates"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 152, "user_id": 6533234, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/795d09b41281a690026186a5e44e1b16?s=128&d=identicon&r=PG&f=1", "display_name": "casualprogrammer", "link": "https://stackoverflow.com/users/6533234/casualprogrammer"}, "edited": false, "score": 0, "creation_date": 1470230925, "post_id": 38744727, "comment_id": 64863816, "body": "@casualprogrammer I noticed Gary&#39;s Student picked up on that before me - makes it a lot more difficult if you don&#39;t have access to the source code for the bloomberg fnuction"}, {"owner": {"reputation": 152, "user_id": 6533234, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/795d09b41281a690026186a5e44e1b16?s=128&d=identicon&r=PG&f=1", "display_name": "casualprogrammer", "link": "https://stackoverflow.com/users/6533234/casualprogrammer"}, "edited": false, "score": 0, "creation_date": 1470231096, "post_id": 38744727, "comment_id": 64863935, "body": "I thought I could just have a cell in A3 that takes A1&#39;s value whenever it autoupdates, something like =A1 or =Value(A1) and just use the code run it on A3 instead. But that didnt work either"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1470231737, "last_edit_date": 1470231737, "creation_date": 1470230045, "answer_id": 38744727, "question_id": 38744560, "link": "https://stackoverflow.com/questions/38744560/excel-vba-update-cell-every-time-value-in-another-cell-changes/38744727#38744727", "title": "Excel/VBA update cell every time value in another cell changes", "body": "<p><strong><em>Update:</em></strong></p>\n\n<p>It seems you need the calculate event also as you're using a formula. you could try something like this:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\n    Application.EnableEvents = False\n\n    ActiveSheet.Calculate\n    DoEvents\n\n    With Range(\"A1\")\n        .Value = .Value\n        DoEvents\n    End With\n\n    Application.EnableEvents = True\n\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = \"$A$1\" Then\n        Range(\"A2\").Value = Date\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1470231601, "last_edit_date": 1470231601, "creation_date": 1470230970, "answer_id": 38745063, "question_id": 38744560, "link": "https://stackoverflow.com/questions/38744560/excel-vba-update-cell-every-time-value-in-another-cell-changes/38745063#38745063", "title": "Excel/VBA update cell every time value in another cell changes", "body": "<p>If you are using a Bloomberg function in cell <strong>A1</strong> like <em>BDP()</em> or <em>BDH()</em> or <em>BDS()</em>, then you could use the <code>Worksheet_Calculate()</code> event macro to detect changes in that cell.</p>\n\n<p>In this example, I use cell <strong>A3</strong> as a \"memory\" to avoid re-posting the date too often:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    Application.EnableEvents = False\n        If [A1] &lt;&gt; [A3] Then\n            [A3] = Range(\"A1\").Value\n            [A2] = Date\n            MsgBox \"Date recorded\"\n        End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 152, "user_id": 6533234, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/795d09b41281a690026186a5e44e1b16?s=128&d=identicon&r=PG&f=1", "display_name": "casualprogrammer", "link": "https://stackoverflow.com/users/6533234/casualprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9072, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1470231737, "creation_date": 1470229578, "question_id": 38744560, "link": "https://stackoverflow.com/questions/38744560/excel-vba-update-cell-every-time-value-in-another-cell-changes", "title": "Excel/VBA update cell every time value in another cell changes", "body": "<p>I'm very new to VBA. I have a cell in the worksheet that live updates a value. the Value changes about once every month. Is there a way for me to record the day that the value changed in an adjacent cell? \nFor example,\nIf the value in A1 changes from 5 to 6 today, I just want to record today's date in A2.</p>\n\n<p>I don't really need to keep a record of previous changes. </p>\n\n<p>Thank you so much!</p>\n"}, {"tags": ["excel", "vba", "location", "variant"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1470230533, "post_id": 38744370, "comment_id": 64863532, "body": "at first i was thinking like this but it gives syntax error"}, {"owner": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1470231445, "post_id": 38744370, "comment_id": 64864202, "body": "at location part it gives 1004"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1470231596, "post_id": 38744370, "comment_id": 64864333, "body": "location part? do you mean <code>Workbooks.Open</code>? If so, try it without the brackets: <code>Workbooks.Open &quot;C:\\Users\\&quot; &amp; variablePart &amp; &quot;\\Desktop\\Excel Before Code Templates (BCT)\\Data_BCT.xlsx&quot;</code>"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1470229090, "creation_date": 1470229090, "answer_id": 38744370, "question_id": 38744306, "link": "https://stackoverflow.com/questions/38744306/how-to-make-location-variable-in-vba/38744370#38744370", "title": "How to make location variable in vba?", "body": "<pre><code>Dim variablePart as String\n\nvariablePart = \"someFolderName\"\n\nWorkbooks.Open(\"C:\\Users\\\" &amp; variablePart &amp; \"\\Desktop\\Excel Before Code Templates (BCT)\\Data_BCT.xlsx\")\n\n'will lead to: C:\\Users\\someFolderName\\Desktop\\Excel Before Code Templates (BCT)\\Data_BCT.xlsx\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "edited": false, "score": 0, "creation_date": 1470230537, "post_id": 38744374, "comment_id": 64863534, "body": "at first i was thinking like this but it gives syntax error"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1470229097, "creation_date": 1470229097, "answer_id": 38744374, "question_id": 38744306, "link": "https://stackoverflow.com/questions/38744306/how-to-make-location-variable-in-vba/38744374#38744374", "title": "How to make location variable in vba?", "body": "<p>Just use the code below:</p>\n\n<pre><code>Sub InsertUserName()\n\nDim folder_var  As String\n\nfolder_var = InputBox(\"Insert your User Name\")\n\nWorkbooks.Open (\"C:\\\" &amp; folder_var &amp; \" \\Desktop\\Excel Before Code Templates (BCT)\\Data_BCT.xlsx\")\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1470230352, "post_id": 38744436, "comment_id": 64863395, "body": "Just a note, the actual command is <code>Environ</code> the <code>$</code> is a <a href=\"http://stackoverflow.com/documentation/vba/877/declaring-variables#t=201608031318332236455\">type hint</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1470231194, "post_id": 38744436, "comment_id": 64864012, "body": "@litelite - No, it&#39;s actually a different function entirely. <code>Environ</code> is an alias for <code>_B_var_Environ</code> and returns a <code>Variant</code>.  <code>Environ$</code> is an alias for <code>_B_str_Environ</code> and returns a <code>String</code>."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1470233325, "post_id": 38744436, "comment_id": 64865694, "body": "Oh yeah just saw the doc. The notation is quite confusing tough."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 3, "last_activity_date": 1470229259, "creation_date": 1470229259, "answer_id": 38744436, "question_id": 38744306, "link": "https://stackoverflow.com/questions/38744306/how-to-make-location-variable-in-vba/38744436#38744436", "title": "How to make location variable in vba?", "body": "<p>You can use <code>Environ$</code> to get the current user:</p>\n\n<pre><code>Dim desktop As String\ndesktop = \"C:\\Users\\\" &amp; Environ$(\"USERNAME\") &amp; \"\\Desktop\\\"\nDebug.Print desktop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470231251, "post_id": 38744820, "comment_id": 64864053, "body": "this the proper way to find the Desktop location. On most of the corporate machines you will hardly find the Desktop hosted on local root. +1"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1470231311, "post_id": 38744820, "comment_id": 64864099, "body": "^^^Agreed and upvoted.  I was actually going to edit this into my answer but I had to drive to work.  ;-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1470231648, "post_id": 38744820, "comment_id": 64864384, "body": "I already gave your answer the +1.  It cuts straight to the chase."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1470230334, "creation_date": 1470230334, "answer_id": 38744820, "question_id": 38744306, "link": "https://stackoverflow.com/questions/38744306/how-to-make-location-variable-in-vba/38744820#38744820", "title": "How to make location variable in vba?", "body": "<h2>Reference: <a href=\"http://ss64.com/vb/special.html\" rel=\"nofollow\">Special Folders</a></h2>\n\n<pre><code>FilePath = getDeskTopPath &amp; \"\\Excel Before Code Templates (BCT)\\Data_BCT.xlsx\"\n\nIf Len(Dir(FilePath)) &gt; 0 then\n\n    Workbooks.Open (FilePath)\n\nEnd If\n</code></pre>\n\n<hr>\n\n<pre><code>Function getDeskTopPath()\n    Dim objShell As Object\n    Dim strPath As String\n\n    Set objShell = CreateObject(\"Wscript.Shell\")\n    strPath = objShell.SpecialFolders(\"Desktop\")\n    getDeskTopPath = strPath\n\n    Set objShell = Nothing\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>You can also have use the Application.FileDialog to choose a file or folder. See this artice for details: <a href=\"http://analystcave.com/vba-application-filedialog-select-file/\" rel=\"nofollow\">VBA FILEDIALOG \u2013 OPENING, SELECTING AND SAVING FILES AND FOLDERS</a></p>\n"}], "owner": {"reputation": 51, "user_id": 6640114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c59da0bd394759641c73e983e1f3a8ed?s=128&d=identicon&r=PG&f=1", "display_name": "hakandeep", "link": "https://stackoverflow.com/users/6640114/hakandeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 38744436, "answer_count": 4, "score": 0, "last_activity_date": 1470231374, "creation_date": 1470228930, "last_edit_date": 1470231374, "question_id": 38744306, "link": "https://stackoverflow.com/questions/38744306/how-to-make-location-variable-in-vba", "title": "How to make location variable in vba?", "body": "<pre><code>Workbooks.Open (\"C:\\Users\\**VARIANT**\\Desktop\\Excel Before Code Templates (BCT)\\Data_BCT.xlsx\")\n</code></pre>\n\n<p>I want to make the \"variant\" part a variable dependent on input. I want to do that because it needs to be revised for every other user.</p>\n"}, {"tags": ["vba", "excel", "copy-paste", "citrix"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1470230027, "post_id": 38744298, "comment_id": 64863149, "body": "My only solution is to tell you to copy the formula from the bar and paste that into the other."}, {"owner": {"reputation": 11, "user_id": 6258085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb490e8b4f67f601b52df6ec565a075?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa14", "link": "https://stackoverflow.com/users/6258085/mostafa14"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1470230154, "post_id": 38744298, "comment_id": 64863243, "body": "Yeah but when I&#39;m copying a big number of cell with different formulas in each, it&#39;s not ideal. Thx for your answer though."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6258085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb490e8b4f67f601b52df6ec565a075?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa14", "link": "https://stackoverflow.com/users/6258085/mostafa14"}, "edited": false, "score": 0, "creation_date": 1470233699, "post_id": 38745217, "comment_id": 64865937, "body": "Thank you very much. That fixes my issue."}], "tags": [], "owner": {"reputation": 1071, "user_id": 3397613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c84f8f3350dcd4782f95a89061e26ad?s=128&d=identicon&r=PG&f=1", "display_name": "Mikegrann", "link": "https://stackoverflow.com/users/3397613/mikegrann"}, "is_accepted": false, "score": 2, "last_activity_date": 1470231317, "creation_date": 1470231317, "answer_id": 38745217, "question_id": 38744298, "link": "https://stackoverflow.com/questions/38744298/copy-from-local-excel-2010-and-paste-formula-to-remote-citrix-server-excel-201/38745217#38745217", "title": "Copy from local Excel 2010 and paste formula to remote (Citrix server) Excel 2013 not working", "body": "<p>Excel will only copy-paste that nicely (formulas, formatting, etc) between local Office applications. So when you try to copy from the one device to the other, it's forcing your cells down to a simple plaintext representation. For evidence of this, you could try pasting that same value into a simple text editor like Notepad - you'll see that the only data in your clipboard are the plaintext values, formatted with tabs and newlines to denote the cell positions.</p>\n\n<p>But, we can get around this! Turn your spreadsheet over to \"Formula View Mode\" temporarily - you can toggle this on/off with CTRL+` (which is the \"backtick\" located under the escape button on a standard QWERTY keyboard). Now you'll see all the formulas in your cells instead of the values. If you copy cells, these formulas will be copied. Then you should be able to paste directly into the remote instance of Excel without any issues.</p>\n"}], "owner": {"reputation": 11, "user_id": 6258085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb490e8b4f67f601b52df6ec565a075?s=128&d=identicon&r=PG&f=1", "display_name": "mostafa14", "link": "https://stackoverflow.com/users/6258085/mostafa14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470231317, "creation_date": 1470228913, "question_id": 38744298, "link": "https://stackoverflow.com/questions/38744298/copy-from-local-excel-2010-and-paste-formula-to-remote-citrix-server-excel-201", "title": "Copy from local Excel 2010 and paste formula to remote (Citrix server) Excel 2013 not working", "body": "<p>I have Excel 2010 running on my local computer (Windows 7) and also another Excel 2013 running on a remote Citrix Server. When I copy a cell containing a formula from my local Excel 2010 and try to paste it to remote Excel 2013, it only pastes the value and not the formula. If I do paste special, it does not give me the formula option but rather the option to paste as picture, Bitmap,DIF, Unicode Text or Text. I want to be able to paste the formula. Is the problem occuring because Im copying from local and pasting to remote or is it the difference of Excel versions (2010 vs 2013). Are there any solutions? </p>\n\n<p>Thanks in advance for your help. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 576, "user_id": 4504877, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b559095215902fb25dd589bfa6f3f76f?s=128&d=identicon&r=PG&f=1", "display_name": "user33484", "link": "https://stackoverflow.com/users/4504877/user33484"}, "edited": false, "score": 0, "creation_date": 1470236836, "post_id": 38744263, "comment_id": 64868475, "body": "Just an extra question, if I wanted to call say, the third item in an array - how would I do that?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 576, "user_id": 4504877, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b559095215902fb25dd589bfa6f3f76f?s=128&d=identicon&r=PG&f=1", "display_name": "user33484", "link": "https://stackoverflow.com/users/4504877/user33484"}, "edited": false, "score": 0, "creation_date": 1470237309, "post_id": 38744263, "comment_id": 64868813, "body": "Assuming you have assigned the array to a variable: <code>MsgBox list(2)</code> (arrays are zero-based by default in VBA, so 2 is actually the third item)"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 4, "last_activity_date": 1470229312, "last_edit_date": 1470229312, "creation_date": 1470228806, "answer_id": 38744263, "question_id": 38744147, "link": "https://stackoverflow.com/questions/38744147/vba-is-there-something-similar-to-lists/38744263#38744263", "title": "VBA - Is there something similar to lists?", "body": "<p>Do you mean like this? You can use an array (which I suppose is <em>technically</em> a tuple when no data type is defined)</p>\n\n<pre><code>For Each i In Array(\"0\", \"1\", \"2\", \"3\")\n    If InStr(\"1289\", i) Then\n        '// Do Something\n    End If\nNext\n</code></pre>\n\n<p>Similarly:</p>\n\n<pre><code>Dim list As Variant\nDim someString As String\n\nsomeString = \"1289\"\nlist = Array(\"0\", \"1\", \"2\", \"3\")\n\nFor Each i In list\n    If InStr(someString, i) Then\n        '// Do Something\n    End If\nNext\n</code></pre>\n\n<hr>\n\n<p>Bonus notes:</p>\n\n<p><code>InStr()</code> doesn't actually return <code>True/False</code> it returns the start position of a substring inside another string reading from left to right. In this case however, we can rely on VBA's implicit conversion to evaluate anything greater than <code>0</code> as <code>True</code> because it's being used in an <code>If</code> statement.</p>\n"}], "owner": {"reputation": 576, "user_id": 4504877, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b559095215902fb25dd589bfa6f3f76f?s=128&d=identicon&r=PG&f=1", "display_name": "user33484", "link": "https://stackoverflow.com/users/4504877/user33484"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 38744263, "answer_count": 1, "score": 1, "last_activity_date": 1470229312, "creation_date": 1470228467, "last_edit_date": 1531164843, "question_id": 38744147, "link": "https://stackoverflow.com/questions/38744147/vba-is-there-something-similar-to-lists", "title": "VBA - Is there something similar to lists?", "body": "<p>For instance, I have a list of two numbers 0, 1 and I want to run a script in vba which goes like this:</p>\n\n<pre><code>for i in list:\n    if i in string:\n       do something\n    end if\n</code></pre>\n\n<p>i.e. I want to first check if \"0\" is in some string, then do something, and then check if \"1\" is in the string then do something etc. In python I would have a tuple [\"0\",\"1\"] and do it like that, but how would I go about this in VBA?</p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 2, "creation_date": 1470228296, "post_id": 38744006, "comment_id": 64861752, "body": "Important to note: If you have 32-bit Excel, it caps out at 2Gb of RAM usage. So your 8Gb computer is only 1 quarter used. 64 bit excel will use whatever is available."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 2, "creation_date": 1470228875, "post_id": 38744006, "comment_id": 64862241, "body": "I don&#39;t understand why you keep opening and closing the WbToPaste, it&#39;s always the same one isn&#39;t it? Open and set it outside the loop and save it after the loop. Also if you have any Workbook events in these workbooks, disable events before doing all this, it will prevent running useless Workbook Activate/deactivate code. <code>Application.EnableEvents = false</code> Set it back to true at the end with the screen updating like DragonSamu mentioned."}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 1, "creation_date": 1470228972, "post_id": 38744006, "comment_id": 64862325, "body": "I would suggest using <a href=\"https://msdn.microsoft.com/en-us/library/office/aa196875(v=office.11).aspx\" rel=\"nofollow noreferrer\">Application.ScreenUpdating</a> this will not show you what happens and make the process go much faster as nothing needs to be displayed."}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1470229107, "post_id": 38744006, "comment_id": 64862423, "body": "I&#39;d highly recommend not using <code>.Select</code>"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1470230406, "post_id": 38744006, "comment_id": 64863445, "body": "Why even bother to <code>Copy</code> and <code>Paste</code> the data if you can just <code>Copy</code> the entire <code>Sheet</code> into the summary <code>Sheet</code>"}, {"owner": {"reputation": 33, "user_id": 6641115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837b249bc034ecaa7ce63a97c2579aad?s=128&d=identicon&r=PG&f=1", "display_name": "BRL", "link": "https://stackoverflow.com/users/6641115/brl"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1470232833, "post_id": 38744006, "comment_id": 64865315, "body": "@David G I checked my Excel installation, yes, it is 32-bit so I&#39;m only getting 2GB. Not much we can do about that one. I&#39;ll follow your advice and open and close the workbook outside of the loop."}, {"owner": {"reputation": 33, "user_id": 6641115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837b249bc034ecaa7ce63a97c2579aad?s=128&d=identicon&r=PG&f=1", "display_name": "BRL", "link": "https://stackoverflow.com/users/6641115/brl"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1470233227, "post_id": 38744006, "comment_id": 64865633, "body": "@DragonSamu  I&#39;ll try to integrate that process (or lack thereof rather) into the script.  Below, Siddarth Rout gives me a way to copy and paste only the range that has values in it. I&#39;ll get that plugged into my code and see what I get.  Once it&#39;s all done, I&#39;ll post the revised script here so other may use it.  Thank you to all."}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1470230093, "creation_date": 1470230093, "answer_id": 38744740, "question_id": 38744006, "link": "https://stackoverflow.com/questions/38744006/can-you-find-whats-causing-my-excel-vb-script-to-slow-down/38744740#38744740", "title": "Can you find what&#39;s causing my Excel VB script to slow down?", "body": "<p><code>Cells.Select</code> is taking a lot of memory. Find the actual range of the sheet and copy that. </p>\n\n<p>For <strong>example</strong></p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim Lrow As Long, LCol As Long\n    Dim rng As Range\n\n    Set ws = Sheet1\n\n    With ws\n        '~~&gt; Find Last row which has data\n        Lrow = .Cells.Find(What:=\"*\", _\n                After:=wks.Range(\"A1\"), _\n                Lookat:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Row\n\n        '~~&gt; Find Last column which has data                    \n        LCol = .Cells.Find(What:=\"*\", _\n                After:=wks.Range(\"A1\"), _\n                Lookat:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByColumns, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Column\n\n        Set rng = .Range(\"A1:\" &amp; Split(Cells(, LCol).address, \"$\")(1) &amp; Lrow)\n\n        rng.Copy\n\n        '~~&gt; Paste where you want\n    End With\nEnd Sub\n</code></pre>\n\n<p>Also do not close the file before you paste it. You also have to be careful while pasting. Put the <code>Copy</code> command one line before you paste. Sometimes the clipboard clears up and you may face a problem.</p>\n"}], "owner": {"reputation": 33, "user_id": 6641115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837b249bc034ecaa7ce63a97c2579aad?s=128&d=identicon&r=PG&f=1", "display_name": "BRL", "link": "https://stackoverflow.com/users/6641115/brl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 1, "accepted_answer_id": 38744740, "answer_count": 1, "score": 3, "last_activity_date": 1470230093, "creation_date": 1470228115, "last_edit_date": 1470228727, "question_id": 38744006, "link": "https://stackoverflow.com/questions/38744006/can-you-find-whats-causing-my-excel-vb-script-to-slow-down", "title": "Can you find what&#39;s causing my Excel VB script to slow down?", "body": "<p>First a little background: I had a need for a script to take <em>n</em> CSV files in a directory I selected and copy and paste their individual data into a \"master\" Excel Workbook file with <em>n</em> tabs. I also need the script to automatically name the tabs something useful. </p>\n\n<p>I Frankenstein'd a script together using a combination of macro recording, pieces I found on here, and good ol' fashioned Googling. It runs without too many errors; however, towards the end of the process (if there's 10+ CSV files) it slows down quite a bit.</p>\n\n<p>I've tried a few different versions of making sure the clipboard is cleared, the current file being copied is closed, suppressing the opening and closing animation of the master file, etc. The only thing that was successful up to this point was (what I think works) clearing the clipboard.</p>\n\n<p>I will admit this is my first venture into Visual Basic and I'm not a professional programmer so the code probably doesn't handle memory properly. </p>\n\n<p><strong>My question is:</strong> Can you spot a section(s) / operation(s) that is / are slowing the code down towards the end? Or at least provide a viable explanation as to why it would be happening? In general, my laptop is no slouch. It's an HP EliteBook with i5 processor and 8GB of RAM so I can't imagine it's a resource problem.</p>\n\n<p>I've sanitized the code and any references to personal directories and posted it below. </p>\n\n<p>Thank you in advance for the assistance.</p>\n\n<pre><code>Sub MultiCSV_to_Tabs()\nDim vaFiles As Variant\nDim i As Long\nDim wbkToCopy As Workbook\nDim wbkToPaste As Workbook\n\nvaFiles = Application.GetOpenFilename(\"CSV Files (*.csv), *.csv\", _\n          Title:=\"Select files\", MultiSelect:=True)\n\n'User_Created_File = \"PLACE YOUR DIRECTORY AND FILE NAME IN BETWEEN THESE QUOTATION MARKS\"\n\nIf IsArray(vaFiles) Then\n    For i = LBound(vaFiles) To UBound(vaFiles)\n\n        'Open the first CSV file in the list of selections\n        Set wbkToCopy = Workbooks.Open(Filename:=vaFiles(i))\n\n        'Split the vaFiles variable on backslashes to dissect the PathName and FileName\n        SplitFileName = Split(vaFiles(i), \"\\\")\n\n        'Go find the last entry in the SplitFileName variable. This should be the exported file name we selected.\n        ExportedCSVFileName = SplitFileName(UBound(SplitFileName))\n\n        'Select all cells and copy that selection\n        wbkToCopy.Application.DisplayAlerts = False\n        Cells.Select\n        Selection.Copy\n\n        'Close the current workbook without saving changes\n        wbkToCopy.Close savechanges:=False\n\n        'Open the summary workbook\n        Set wbkToPaste = Workbooks.Open(User_Created_File)\n\n        'Add a new tab to the end of the last tab\n        Sheets.Add After:=Sheets(Sheets.Count)\n\n        'Define new sheetname using the parsed filename from the workbook\n        shtname = Mid(ExportedCSVFileName, 17, 25)\n        ActiveSheet.Name = shtname\n\n        'Paste the selection we copied earlier\n        wbkToPaste.Application.DisplayAlerts = False\n        ActiveSheet.Paste\n\n        wbkToPaste.Application.CutCopyMode = False\n\n        'Close the summary workbook and save the changes. Go to the next file in the array.\n        wbkToPaste.Close savechanges:=True\n\n    Next i\n\nEnd If\n\nSet wbkToCleanUp = Workbooks.Open(User_Created_File)\nSheets(\"Sheet1\").Delete\nwbkToCleanUp.Close savechanges:=True\nMsgBox (\"Copy/Paste complete\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 1, "creation_date": 1470227728, "post_id": 38743820, "comment_id": 64861312, "body": "That has to be some sort of a record response time- Champion (Will accept in 11 mins)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1470227632, "creation_date": 1470227632, "answer_id": 38743820, "question_id": 38743786, "link": "https://stackoverflow.com/questions/38743786/refering-to-a-vbcomponent-by-the-worksheet-codename/38743820#38743820", "title": "Refering to a VBComponent by the worksheet codename", "body": "<blockquote>\n  <p>is there a way to find this for the activesheet?</p>\n</blockquote>\n\n<p>Is this what you want?</p>\n\n<pre><code>Activesheet.Codename\n</code></pre>\n"}], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 38743820, "answer_count": 1, "score": 1, "last_activity_date": 1470227883, "creation_date": 1470227550, "last_edit_date": 1470227883, "question_id": 38743786, "link": "https://stackoverflow.com/questions/38743786/refering-to-a-vbcomponent-by-the-worksheet-codename", "title": "Refering to a VBComponent by the worksheet codename", "body": "<p>I am trying to use the <code>VBComponents(\"Sheet1\").CodeModule.InsterLines...</code> function.</p>\n\n<p>However, the VBComponent wants to take the module name from the object explorer, not the name of the tab. Is there a way to find this for the <code>Activesheet</code>?</p>\n\n<p>To clarify, in the picture below, if I use the use <code>VBComponents(\"Sheet1\").CodeMo...</code>, it will print to the module labeled 1.  I would like it to print to the module named 2.  </p>\n\n<p>How can I find the module name associated to the sheet?</p>\n\n<p><a href=\"https://i.stack.imgur.com/au43B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/au43B.png\" alt=\"Whats going on...\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470228185, "post_id": 38743719, "comment_id": 64861646, "body": "Next time could you please format your code. Will save us a lot of time either trying to format it or read code which is not intdented properly."}, {"owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470228284, "post_id": 38743719, "comment_id": 64861739, "body": "I see my mistake now, sorry"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1470228516, "creation_date": 1470228516, "answer_id": 38744166, "question_id": 38743719, "link": "https://stackoverflow.com/questions/38743719/fetching-data-from-website-error/38744166#38744166", "title": "Fetching data from website error", "body": "<p>This <code>string</code></p>\n\n<pre><code>http://www.airliners.net/search?registrationActual=SP-LRC&amp;display=detail\n</code></pre>\n\n<p>can be written as</p>\n\n<pre><code>\"http://www.airliners.net/search?registrationActual=\" &amp; \"SP-LRC\" &amp; \"&amp;display=detail\"\n</code></pre>\n\n<p>So change </p>\n\n<pre><code>\"URL;https://www.flightradar24.com/data/aircraft/\" &amp; address\n</code></pre>\n\n<p>to</p>\n\n<pre><code>\"URL;http://www.airliners.net/search?registrationActual=\" &amp; address &amp; \"&amp;display=detail\"\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 38744166, "answer_count": 1, "score": 0, "last_activity_date": 1470228516, "creation_date": 1470227381, "last_edit_date": 1531161705, "question_id": 38743719, "link": "https://stackoverflow.com/questions/38743719/fetching-data-from-website-error", "title": "Fetching data from website error", "body": "<pre><code>Sub GetDataFromLandings()\n    Dim lastrow As Long, x As Long\n\n    Application.ScreenUpdating = False\n\n    ActiveWorkbook.Sheets(\"Sheet2\").Range(\"A2:F250\") = Null\n\n    With Worksheets(\"Sheet2\")\n        lastrow = .Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n\n        For x = 2 To lastrow\n            RequeryLandings .Cells(x, \"G\")\n        Next\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n\nSub RequeryLandings(address As String)\n    Dim ws As Worksheet\n    Dim NewRow As Long\n\n    With Worksheets(\"Sheet2\")\n\n        Set ws = ActiveWorkbook.Sheets(\"Sheet1\")\n\n        With ws.QueryTables.Add(Connection:= _\n        \"URL;https://www.flightradar24.com/data/aircraft/\" &amp; address, _\n        Destination:=ws.Range(\"$A$1\"))\n            .Name = \"NNum_Results.aspx?NNumbertxt=22NA\"\n            .FieldNames = True\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .BackgroundQuery = True\n            .RefreshStyle = xlInsertDeleteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .WebSelectionType = xlEntirePage\n            .WebFormatting = xlWebFormattingNone\n            .WebPreFormattedTextToColumns = True\n            .WebConsecutiveDelimitersAsOne = True\n            .WebSingleBlockTextImport = False\n            .WebDisableDateRecognition = False\n            .WebDisableRedirections = False\n            .Refresh BackgroundQuery:=False\n\n            DoEvents\n</code></pre>\n\n<p>Above code gets data from website <a href=\"https://www.flightradar24.com/data/aircraft/\" rel=\"nofollow\">https://www.flightradar24.com/data/aircraft/</a></p>\n\n<p>and loops through different values taken from column G :  </p>\n\n<pre><code>RequeryLandings .Cells(x, \"G\")\n</code></pre>\n\n<p>so URL address is in this form </p>\n\n<pre><code>\"URL;https://www.flightradar24.com/data/aircraft/\" &amp; address,\n</code></pre>\n\n<p>where   &amp; address    is the values from column G.</p>\n\n<p>If the first row in G column is <em>SP-LRC</em> then it searches URL</p>\n\n<pre><code>\"URL;https://www.flightradar24.com/data/aircraft/SP-LRC\"\n</code></pre>\n\n<p>I am trying to get data from different website which is </p>\n\n<p><a href=\"http://www.airliners.net/search?registrationActual=SP-LRC&amp;display=detail\" rel=\"nofollow\">http://www.airliners.net/search?registrationActual=SP-LRC&amp;display=detail</a></p>\n\n<p>and I can not figure out how the code should change to properly work for that address...in this case <code>SP-LRC</code> is not in the end of address but is before <code>&amp;display=detail</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1470226762, "post_id": 38743333, "comment_id": 64860522, "body": "I don&#39;t think it will affect the outcome, but you&#39;re using &quot;Monthly Data&quot; in your <code>With</code> line and referencing <code>ws2</code> in the message box."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1470227052, "post_id": 38743333, "comment_id": 64860757, "body": "If the visible cells are not contiguous, you have to separately count the rows in each <code>Area</code>.  (Or you could try the <code>SubTotal</code> function as suggested by J.B.)"}, {"owner": {"reputation": 454, "user_id": 6638903, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d28e4d32cd9e7191df4c53e99c23955b?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmoy", "link": "https://stackoverflow.com/users/6638903/tanmoy"}, "edited": false, "score": 0, "creation_date": 1470227387, "post_id": 38743333, "comment_id": 64861033, "body": "@J.B &quot;Object variable or With block variable not set&quot;"}, {"owner": {"reputation": 454, "user_id": 6638903, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d28e4d32cd9e7191df4c53e99c23955b?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmoy", "link": "https://stackoverflow.com/users/6638903/tanmoy"}, "edited": false, "score": 0, "creation_date": 1470294198, "post_id": 38743333, "comment_id": 64893011, "body": "To apply 2 separate filters on 2 separate columns count the number of rows. With Sheets(&quot;LifeTimeData&quot;) .Range(&quot;A1:BB&quot; &amp; lastrow).AutoFilter Field:=21, Criteria1:=xlFilterLastMonth, Operator:=xlAnd .Range(&quot;A1:BB&quot; &amp; lastrow).AutoFilter Field:=16, Criteria1:=&quot;*&quot; &amp; &quot;Deposit&quot;, Operator:=xlFilterDynamic Set r = Intersect(.AutoFilter.Range, .Range(&quot;A:A&quot;)) Filtred_Rows_Count = Application.WorksheetFunction.Subtotal(103, r) - 1 &#39;Worksheets(&quot;LifeTimeData&quot;).AutoFilterMode = False &#39;Sheets(&quot;Overview&quot;).Range(&quot;G16&quot;) = Filtred_Rows_Count MsgBox Filtred_Rows_Count En"}], "answers": [{"comments": [{"owner": {"reputation": 454, "user_id": 6638903, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d28e4d32cd9e7191df4c53e99c23955b?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmoy", "link": "https://stackoverflow.com/users/6638903/tanmoy"}, "edited": false, "score": 0, "creation_date": 1470227136, "post_id": 38743411, "comment_id": 64860826, "body": "ws2 is not the active sheet where the data is getting filtered."}, {"owner": {"reputation": 454, "user_id": 6638903, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d28e4d32cd9e7191df4c53e99c23955b?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmoy", "link": "https://stackoverflow.com/users/6638903/tanmoy"}, "edited": false, "score": 0, "creation_date": 1470227561, "post_id": 38743411, "comment_id": 64861178, "body": "done that. no joy. application defined or object defined error."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 454, "user_id": 6638903, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d28e4d32cd9e7191df4c53e99c23955b?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmoy", "link": "https://stackoverflow.com/users/6638903/tanmoy"}, "edited": false, "score": 0, "creation_date": 1470227611, "post_id": 38743411, "comment_id": 64861224, "body": "@Tanmoy Then you didn&#39;t change it <i>correctly</i> . I&#39;ll post an answer"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1470227729, "post_id": 38743411, "comment_id": 64861313, "body": "J.B. - I&#39;ve posted an answer showing how the ranges should be qualified - if you want to update yours to do the same I&#39;ll delete mine."}], "tags": [], "owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1470226558, "creation_date": 1470226558, "answer_id": 38743411, "question_id": 38743333, "link": "https://stackoverflow.com/questions/38743333/incorrect-count-of-filtered-rows-vba/38743411#38743411", "title": "Incorrect count of filtered rows VBA", "body": "<p>Try this:</p>\n\n<pre><code>With Sheets(\"Monthly Data\")\n    .Range(\"A1:BB\" &amp; lastrow1).AutoFilter Field:=21, Criteria1:=xlFilterLastMonth, Operator:=xlFilterDynamic\n\n    Set r = Intersect(ActiveSheet.AutoFilter.Range, Range(\"A:A\"))\n    Filtred_Rows_Count = Application.WorksheetFunction.Subtotal(103, r) - 1\n\n    MsgBox Filtred_Rows_Count\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 454, "user_id": 6638903, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d28e4d32cd9e7191df4c53e99c23955b?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmoy", "link": "https://stackoverflow.com/users/6638903/tanmoy"}, "edited": false, "score": 0, "creation_date": 1470278391, "post_id": 38743767, "comment_id": 64887763, "body": "@Tanmoy It does work. I try all my code before posting it as an answer. What is your statement for <code>LastRow1</code>? I used <code>LastRow1 = Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row</code> provided your range of data is a well-formatted data sheet. What I mean by a &quot;well-formatted data sheet&quot;, is a worksheet with data that starts in cell A1 and the number of the rows in column A and columns in row 1 must be equal to the range of all data."}, {"owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "reply_to_user": {"reputation": 454, "user_id": 6638903, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d28e4d32cd9e7191df4c53e99c23955b?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmoy", "link": "https://stackoverflow.com/users/6638903/tanmoy"}, "edited": false, "score": 0, "creation_date": 1470278988, "post_id": 38743767, "comment_id": 64887909, "body": "@Tanmoy See this <a href=\"http://i.stack.imgur.com/k4SPS.png\" rel=\"nofollow noreferrer\">screenshot of my worksheet</a>. I modified the above code to fit in with the dummy data. Have a look the entire picture. See also in the bottom left corner."}], "tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": false, "score": 0, "last_activity_date": 1470227508, "creation_date": 1470227508, "answer_id": 38743767, "question_id": 38743333, "link": "https://stackoverflow.com/questions/38743333/incorrect-count-of-filtered-rows-vba/38743767#38743767", "title": "Incorrect count of filtered rows VBA", "body": "<p>Assuming there are headers for each column, then try this</p>\n\n<pre><code>Dim Data1 As Range, Data2 As Range\n\n\nSet Data1 = Sheets(\"Monthly Data\").Range(\"A1:BB\" &amp; LastRow1)\n\nData1.AutoFilter Field:=21, Criteria1:=xlFilterLastMonth, Operator:=xlFilterDynamic\n\nSet Data2 = Range(Cells(2, 21), Cells(LastRow1, 21)).SpecialCells(xlCellTypeVisible)\n\nFor Each cell In Data2\n    i = i + 1\nNext\n\nWorksheets(\"Monthly Data\").AutoFilterMode = False\nMsgBox \"The number of filtered rows is \" &amp; i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 454, "user_id": 6638903, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d28e4d32cd9e7191df4c53e99c23955b?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmoy", "link": "https://stackoverflow.com/users/6638903/tanmoy"}, "edited": false, "score": 0, "creation_date": 1470289702, "post_id": 38743842, "comment_id": 64890987, "body": "To apply 2 separate filters on 2 separate columns count the number of rows. With Sheets(&quot;LifeTimeData&quot;)     .Range(&quot;A1:BB&quot; &amp; lastrow).AutoFilter Field:=21, Criteria1:=xlFilterLastMonth, Operator:=xlAnd     .Range(&quot;A1:BB&quot; &amp; lastrow).AutoFilter Field:=16, Criteria1:=&quot;*&quot; &amp; &quot;Deposit&quot;, Operator:=xlFilterDynamic          Set r = Intersect(.AutoFilter.Range, .Range(&quot;A:A&quot;))     Filtred_Rows_Count = Application.WorksheetFunction.Subtotal(103, r) - 1     &#39;Worksheets(&quot;LifeTimeData&quot;).AutoFilterMode = False     &#39;Sheets(&quot;Overview&quot;).Range(&quot;G16&quot;) = Filtred_Rows_Count     MsgBox Filtred_Rows_Count En"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 0, "last_activity_date": 1470227686, "creation_date": 1470227686, "answer_id": 38743842, "question_id": 38743333, "link": "https://stackoverflow.com/questions/38743333/incorrect-count-of-filtered-rows-vba/38743842#38743842", "title": "Incorrect count of filtered rows VBA", "body": "<p>Based on J.B.s answer:</p>\n\n<pre><code>With Sheets(\"Monthly Data\")\n    .Range(\"A1:BB\" &amp; lastrow1).AutoFilter Field:=21, Criteria1:=xlFilterLastMonth, Operator:=xlFilterDynamic\n\n    Set r = Intersect(.AutoFilter.Range, .Range(\"A:A\"))\n    Filtred_Rows_Count = Application.WorksheetFunction.Subtotal(103, r) - 1\n\n    MsgBox Filtred_Rows_Count\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 454, "user_id": 6638903, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d28e4d32cd9e7191df4c53e99c23955b?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmoy", "link": "https://stackoverflow.com/users/6638903/tanmoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "accepted_answer_id": 38743842, "answer_count": 3, "score": 0, "last_activity_date": 1470227686, "creation_date": 1470226359, "last_edit_date": 1470226503, "question_id": 38743333, "link": "https://stackoverflow.com/questions/38743333/incorrect-count-of-filtered-rows-vba", "title": "Incorrect count of filtered rows VBA", "body": "<p>I have an Excel ws \"Monthly Data\". I am trying to apply an auto filter (xlFilterLastMonth) and count the number of filtered rows.</p>\n\n<pre><code>With Sheets(\"Monthly Data\")                     \n    .Range(\"A1:BB\" &amp; lastrow1).AutoFilter Field:=21, Criteria1:=xlFilterLastMonth, Operator:=xlFilterDynamic\n\nMsgBox ws2.UsedRange.SpecialCells(xlCellTypeVisible).Rows.Count\n\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1470226776, "post_id": 38743311, "comment_id": 64860532, "body": "While pasting the data just use &quot;Paste Special&quot; &amp; &quot;Value&quot;. if you are doing this using VBA, the paste line should be Range(&quot;A1&quot;).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False"}, {"owner": {"reputation": 505, "user_id": 6204844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pK6Ih.jpg?s=128&g=1", "display_name": "Clusks", "link": "https://stackoverflow.com/users/6204844/clusks"}, "edited": false, "score": 0, "creation_date": 1470227579, "post_id": 38743311, "comment_id": 64861195, "body": "Are you copying sheets from the multiple workbooks into one worksheet or a separate worksheet for each workbook that is copied in? Have you got any code at all that you can post?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1470227670, "post_id": 38743311, "comment_id": 64861277, "body": "@J.B. you just described the exact opposite of what the OP wants to achieve. He would like to preserve the format <code>...as it is in my source workbook</code>. Hence, he should copy it over including the format (an not the values only as you described) and any possible conditional formatting. Yet, the way to go is pretty much the same. Just use something along the following: <code>wbSource.Range(&quot;A1:C10&quot;).Copy Destination:=wbDestination.Range(&quot;A1:C10&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6629298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210228009399861/picture?type=large", "display_name": "Shajee Rehman", "link": "https://stackoverflow.com/users/6629298/shajee-rehman"}, "edited": false, "score": 0, "creation_date": 1470312015, "post_id": 38745215, "comment_id": 64904647, "body": "Thanks alot guys. I am successful :)"}, {"owner": {"reputation": 149, "user_id": 5285928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040c0b16ef524025c2e0f0d606641f73?s=128&d=identicon&r=PG&f=1", "display_name": "Generic Guy", "link": "https://stackoverflow.com/users/5285928/generic-guy"}, "reply_to_user": {"reputation": 33, "user_id": 6629298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210228009399861/picture?type=large", "display_name": "Shajee Rehman", "link": "https://stackoverflow.com/users/6629298/shajee-rehman"}, "edited": false, "score": 0, "creation_date": 1470314130, "post_id": 38745215, "comment_id": 64906069, "body": "Glad to help! If you could mark this as the right answer, I am trying to build up my reputation and it would help a lot. Thanks!"}], "tags": [], "owner": {"reputation": 149, "user_id": 5285928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040c0b16ef524025c2e0f0d606641f73?s=128&d=identicon&r=PG&f=1", "display_name": "Generic Guy", "link": "https://stackoverflow.com/users/5285928/generic-guy"}, "is_accepted": true, "score": 0, "last_activity_date": 1470231309, "creation_date": 1470231309, "answer_id": 38745215, "question_id": 38743311, "link": "https://stackoverflow.com/questions/38743311/preserve-formatting-in-master-workbook/38745215#38745215", "title": "Preserve Formatting in Master Workbook", "body": "<p>So here is how you copy from one workbook to another, keeping the source formatting. You can adjust the range and the name of the workbook as necessary.</p>\n\n<pre><code>Workbooks(\"source\").Worksheets(\"Sheet1\").Range(\"A1\").Copy\nWorkbooks(\"destination\").Worksheets(\"Sheet1\").Range(\"A1\").PasteSpecial paste:=xlPasteAllUsingSourceTheme\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6629298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210228009399861/picture?type=large", "display_name": "Shajee Rehman", "link": "https://stackoverflow.com/users/6629298/shajee-rehman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 38745215, "answer_count": 1, "score": 0, "last_activity_date": 1470231309, "creation_date": 1470226305, "question_id": 38743311, "link": "https://stackoverflow.com/questions/38743311/preserve-formatting-in-master-workbook", "title": "Preserve Formatting in Master Workbook", "body": "<p>I am gathering data from multiple workbooks into master workbook. I want to preserve the format of the text in my master workbook as it is in my source workbooks. Can Anybody help?</p>\n"}, {"tags": ["vba", "excel", "aspect-ratio"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1470227794, "post_id": 38743232, "comment_id": 64861363, "body": "Should <code>PictureHeight</code> be <code>Picture.Height</code>? Also, the <code>With</code> block appears to be redundant."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1470228622, "post_id": 38743232, "comment_id": 64862042, "body": "the <code>LockAspectRatio = msoFalse</code> is a member of the <code>Shape</code> object library"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1470229411, "post_id": 38743232, "comment_id": 64862666, "body": "@marldog  see my answer below"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1470229391, "creation_date": 1470229391, "answer_id": 38744490, "question_id": 38743232, "link": "https://stackoverflow.com/questions/38743232/disabling-lock-aspect-ratio-vba-excel/38744490#38744490", "title": "Disabling Lock Aspect Ratio VBA - Excel", "body": "<p>Use the code below, the <code>LockAspectRatio</code> attribute is a property of the <code>Picture.ShapeRange</code> object, and not the <code>Picture</code>.</p>\n\n<pre><code>Option Explicit\n\nSub ImageAttributes()\n\nDim img_url As String\nDim picture As Object\n\nimg_url = Range(\"A1\")    'Some url with an img\n\nWith ActiveSheet\n   Set picture = .Pictures.Insert(img_url)\n   With picture\n        With .ShapeRange\n          .LockAspectRatio = msoFalse\n          .Width = 25\n          .Height = 25\n        End With\n   End With\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4891671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0b703366813ba2952b97ec5a95b4924?s=128&d=identicon&r=PG&f=1", "display_name": "marldog", "link": "https://stackoverflow.com/users/4891671/marldog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7049, "favorite_count": 0, "accepted_answer_id": 38744490, "answer_count": 1, "score": 0, "last_activity_date": 1470229391, "creation_date": 1470226068, "question_id": 38743232, "link": "https://stackoverflow.com/questions/38743232/disabling-lock-aspect-ratio-vba-excel", "title": "Disabling Lock Aspect Ratio VBA - Excel", "body": "<p>I've read a few forums but none of them seem to be working for me. </p>\n\n<p>I'm pulling pictures from the web, and inserting them into my spreadsheet. I'd like all of these pictures to have the same dimension. </p>\n\n<p>My code is as follows:</p>\n\n<pre><code>Dim img_url as string, picture as object\nimg_url = Range(\"A1\")    'Some url with an img\n\nWith ActiveSheet.Pictures\n   Set Picture = ActiveSheet.Pictures.Insert(img_url)\n   Picture.LockAspectRatio = msoFalse\n   Picture.Width = 25\n   PictureHeight = 25\nEnd With\n</code></pre>\n\n<p>Every time I run it, the Lock Aspect Ratio setting is still checked, and the image is not in the square format I'm looking for. </p>\n\n<p>Any advice would be much appreciated. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 1, "creation_date": 1470226202, "post_id": 38743021, "comment_id": 64860090, "body": "Where&#39;s <code>startCell</code> defined?"}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 1, "creation_date": 1470226346, "post_id": 38743021, "comment_id": 64860182, "body": "Looks like your comparing a integer with a string which will give you a <code>Type Mismatch</code> error. Instead of <code>objSheet.range(startCell).offset(counter) = &quot;&quot;</code> as a condition use <code>Len(objSheet.range(startCell).offset(counter) &amp; &quot;&quot;) &lt; 1</code>."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1470226368, "post_id": 38743021, "comment_id": 64860201, "body": "At what iteration does it fail. When it errors out, hit &quot;Debug&quot; and see what the value of <code>counter</code> is. My guess is that you get through a lot of iterations before it fails. Is counter defined as an integer. Perhaps it&#39;s maxing out at 65535 (the upper bound for an integer in VBA). Instead, define it as a Long."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1470226445, "post_id": 38743021, "comment_id": 64860260, "body": "@JNevill That&#39;s a good point, I assumed that was the value in the cell not the iteration it got to though. Also if that was the cause wouldn&#39;t the iteration have got to <code>65535</code> before it threw an error?"}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1470227043, "post_id": 38743021, "comment_id": 64860749, "body": "Right, I&#39;m being stupid don&#39;t do much Excel VBA COM stuff. The <code>Offset()</code> method returns a <code>Range</code> object not a string or integer, but the <code>Range</code> object has a default method of <code>Value()</code> which does return a <code>Variant</code>. You likely need to cast it to integer before comparing it which is why <code>Len() &lt; </code> is a good idea. You can explicitly cast it using <code>CInt()</code>, <code>CLng()</code> or <code>CDbl()</code> depending on the size of the numeric value."}, {"owner": {"reputation": 135, "user_id": 4141193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0a3sU.png?s=128&g=1", "display_name": "AndyT", "link": "https://stackoverflow.com/users/4141193/andyt"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1470227123, "post_id": 38743021, "comment_id": 64860811, "body": "@JNevill - It fails at the first iteration (as shown by the fact that in my tests it only prints &quot;not blank&quot; once). Edited question to clarify."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1470227190, "post_id": 38743021, "comment_id": 64860866, "body": "When you write &quot;Not Blank&quot; you are outside your loop. The iterations of the loop only affect the code inside. When it fails, double check the value of your counter."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1470227292, "post_id": 38743021, "comment_id": 64860951, "body": "If your IF statement inside the loop results in false, then you merely iterate your counter. You don&#39;t do anything else, so it&#39;s probably iterating very fast. How about before that <code>counter = counter + 1</code> line you stick a <code>debug.print counter</code> and then you can watch the iterations happen in your VBA&#39;s Immediate window."}, {"owner": {"reputation": 135, "user_id": 4141193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0a3sU.png?s=128&g=1", "display_name": "AndyT", "link": "https://stackoverflow.com/users/4141193/andyt"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1470227409, "post_id": 38743021, "comment_id": 64861049, "body": "@JNevill - :slapshead: Yep, I&#39;m being stupid. I will add the debug.print counter when I can, and update the question with the result. (Currently all licences to the software I&#39;m using are in use by others.)"}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1470227422, "post_id": 38743021, "comment_id": 64861061, "body": "@JNevill <code>Debug.Print</code> won&#39;t work as the OP is using the Excel VBA object modal via VBScript, but they do have their own <code>WriteLine()</code> function."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1470227498, "post_id": 38743021, "comment_id": 64861132, "body": "Ah! ok. I thought that <code>WriteLine()</code> was a call to a UDF. In that case, then stick <code>WriteLine(counter)</code> above the counter increment line."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1470227628, "post_id": 38743021, "comment_id": 64861233, "body": "@JNevill It is, VBScript doesn&#39;t have an equivalent <code>Debug.Print</code> you have to write your own debugging logic like this UDF the OP is using."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1470227941, "post_id": 38743021, "comment_id": 64861462, "body": "Also an <code>Integer</code> in VBScript is <code>-32,768 to 32,767</code> - See <a href=\"https://msdn.microsoft.com/en-us/library/9e7a57cf%28v=vs.84%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">VBScript Data Types</a>"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1470228133, "post_id": 38743021, "comment_id": 64861613, "body": "That&#39;s not very much. Darned Integers. Thanks for the clarification. I&#39;ve written a bit of vbscript in the past and always found it tricky to debug."}, {"owner": {"reputation": 135, "user_id": 4141193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0a3sU.png?s=128&g=1", "display_name": "AndyT", "link": "https://stackoverflow.com/users/4141193/andyt"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1470230276, "post_id": 38743021, "comment_id": 64863338, "body": "@JNevill - Many thanks for pointing out my debugging wasn&#39;t telling me how many loops it did. That ultimately allowed me to find the solution."}], "answers": [{"comments": [{"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1470229856, "post_id": 38744036, "comment_id": 64863016, "body": "Wouldn&#39;t that still error at the first line of the loop? It doesn&#39;t return <code>vbError</code> it just triggers a runtime error."}, {"owner": {"reputation": 135, "user_id": 4141193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0a3sU.png?s=128&g=1", "display_name": "AndyT", "link": "https://stackoverflow.com/users/4141193/andyt"}, "reply_to_user": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 1, "creation_date": 1470230049, "post_id": 38744036, "comment_id": 64863169, "body": "@Lankymart - Nope, it works. Axel&#39;s hit the nail on the head: I have error values in some cells in the sheet. Axel&#39;s code handles the error, preventing the Type mismatch."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "reply_to_user": {"reputation": 135, "user_id": 4141193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0a3sU.png?s=128&g=1", "display_name": "AndyT", "link": "https://stackoverflow.com/users/4141193/andyt"}, "edited": false, "score": 0, "creation_date": 1470230291, "post_id": 38744036, "comment_id": 64863352, "body": "@AndyT Ah right, makes sense. Like I said don&#39;t do a lot of Excel COM stuff anymore. So the actual cells contained <code>#ERROR</code> I guess."}, {"owner": {"reputation": 135, "user_id": 4141193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0a3sU.png?s=128&g=1", "display_name": "AndyT", "link": "https://stackoverflow.com/users/4141193/andyt"}, "reply_to_user": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1470230891, "post_id": 38744036, "comment_id": 64863792, "body": "@Lankymart - #REF in this case, but I assume the same issue would occur for #N/A and any other excel error type."}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 2, "last_activity_date": 1470233370, "last_edit_date": 1470233370, "creation_date": 1470228182, "answer_id": 38744036, "question_id": 38743021, "link": "https://stackoverflow.com/questions/38743021/why-is-a-condition-working-outside-a-do-loop-but-giving-type-mismatch-within-it/38744036#38744036", "title": "Why is a condition working outside a Do-Loop, but giving Type Mismatch within it", "body": "<p>Maybe there are error values within the cells of the sheet.</p>\n\n<p>Try</p>\n\n<pre><code>Do \n\n    val = objSheet.range(startCell).offset(counter)\n    MsgBox TypeName(val)\n\n    if VarType(val) = vbError then val = \"Error\"\n    MsgBox val\n\n    if val = \"\" then exit do\n\n    counter = counter + 1\n    MsgBox counter\n\nLoop\n</code></pre>\n\n<hr>\n\n<p>To be clear:\nThe runtime error is thrown if the code tries to compare the Excel cell error value with the string <code>\"\"</code>. Surely you could catch the runtime error with error handling. But then you will have much trouble to read cells after the cell containing the cell error value. So the better way here is in my opinion to check whether there is a cell error value and if so converting it into a string. So no runtime error is thrown.</p>\n\n<p>If the need is exactly to know which Excel cell error value it is, then one could do:</p>\n\n<pre><code>...\n    if VarType(val) = vbError then val = objSheet.range(startCell).offset(counter).text\n    MsgBox val\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "is_accepted": false, "score": 1, "last_activity_date": 1470230094, "last_edit_date": 1592644375, "creation_date": 1470228414, "answer_id": 38744125, "question_id": 38743021, "link": "https://stackoverflow.com/questions/38743021/why-is-a-condition-working-outside-a-do-loop-but-giving-type-mismatch-within-it/38744125#38744125", "title": "Why is a condition working outside a Do-Loop, but giving Type Mismatch within it", "body": "<p>Was just about to post but <a href=\"https://stackoverflow.com/users/3915431/axel-richter\">@axel-richter</a> has <a href=\"https://stackoverflow.com/a/38744036/692942\">beat me too it</a>.</p>\n<p>But the issue I believe <em>(with a bit of toing and froing with <a href=\"https://stackoverflow.com/users/2221001/jnevill\">@jnevill</a>)</em> lies with the fact that <code>counter</code> loops around your <code>Do</code> loop so fast you reach an <code>Offset()</code> that the sheet doesn't like and it returns a</p>\n<blockquote>\n<p>Microsoft VBScript Runtime Error: Type mismatch</p>\n</blockquote>\n<p>You could test this using <code>On Error Resume Next</code> to determine what the value of <code>Err.Source</code> is to see if Excel COM is raising the error.</p>\n<pre><code>counter = 0\nCall writeLine(objSheet.range(startCell).offset(counter))   \nIf Not objSheet.range(startCell).offset(counter) = &quot;&quot; Then Call writeLine(&quot;not blank&quot;)\n\nDo\n    'Capture errors\n    On Error Resume Next\n    'If the &quot;If&quot; statement errors will jump over and execute the next\n    'statement which will be the error check.\n    If objSheet.range(startCell).offset(counter) = &quot;&quot; Then\n        Exit Do\n    Else\n        counter = counter + 1\n    End If\n    If Err.Number &lt;&gt; 0 Then\n        Call writeLine(&quot;Error: &quot; &amp; Err.Source &amp; &quot; (&quot; &amp; Err.Number &amp; &quot;) - &quot; &amp; Err.Description)\n    End If\n    'Stop capturing errors.\n    On Error Goto 0\nLoop\n</code></pre>\n<p>A simple fix would be to set a constant upper limit value</p>\n<pre><code>Const MAX_ROWS = 65536\n</code></pre>\n<p><sup># <code>MAX_ROW</code> value taken from information in Related Links</sup></p>\n<p>Then inside the loop check you've not exceeded this value</p>\n<pre><code>If counter &lt;= MAX_ROWS Then\n    ...\nEnd If\n</code></pre>\n<p>Another approach is to use <code>On Error Resume Next</code> to trigger the loop to exit.</p>\n<pre><code>Dim value\n...\nDo\n    'Capture errors\n    On Error Resume Next\n    value = objSheet.range(startCell).offset(counter)\n    If value = &quot;&quot; Or Err.Number &lt;&gt; 0 Then\n        Exit Do\n    Else\n        counter = counter + 1\n    End If\n    On Error Goto 0\nLoop \n</code></pre>\n<hr />\n<h3>Related Links</h3>\n<ul>\n<li><a href=\"https://stackoverflow.com/q/20425257/692942\">What is the maximum value for row and column offsets in VBA for Excel 2010?</a></li>\n<li><a href=\"https://stackoverflow.com/a/2146390/692942\">What is the maximum value for row and column Range offset in VBA/Excel?</a></li>\n</ul>\n"}], "owner": {"reputation": 135, "user_id": 4141193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0a3sU.png?s=128&g=1", "display_name": "AndyT", "link": "https://stackoverflow.com/users/4141193/andyt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 38744036, "answer_count": 2, "score": 1, "last_activity_date": 1470233370, "creation_date": 1470225572, "last_edit_date": 1592644375, "question_id": 38743021, "link": "https://stackoverflow.com/questions/38743021/why-is-a-condition-working-outside-a-do-loop-but-giving-type-mismatch-within-it", "title": "Why is a condition working outside a Do-Loop, but giving Type Mismatch within it", "body": "<p>I have a Do-Loop in some vbscript code which was definitely working when I last used it (a month or two ago). Today it's not working, with a runtime error:</p>\n<blockquote>\n<p>Microsfot VBScript runtime error: Type mismatch at line <em>{Line with the Do on it}</em></p>\n</blockquote>\n<p>Here is the original code:</p>\n<pre><code>counter = 0 \nDo until objSheet.range(startCell).offset(counter) = &quot;&quot;     \n    counter = counter + 1\nLoop\n</code></pre>\n<p>I've tested whether the conditional should work, by adding an if statement:</p>\n<pre><code>counter = 0 \ncall writeLine(objSheet.range(startCell).offset(counter))    \nif not objSheet.range(startCell).offset(counter) = &quot;&quot; then call writeLine(&quot;not blank&quot;)\nDo until objSheet.range(startCell).offset(counter) = &quot;&quot;     \n    counter = counter + 1\nLoop\n</code></pre>\n<p>The if statement executes fine, and in my output window I get:</p>\n<blockquote>\n<p>10100</p>\n<p>not blank</p>\n</blockquote>\n<p>But then it still gets a type mismatch on the Do line, at the first attempt.</p>\n<p>So then I tried an alternative Do Loop:</p>\n<pre><code>counter = 0\ncall writeLine(objSheet.range(startCell).offset(counter))   \nif not objSheet.range(startCell).offset(counter) = &quot;&quot; then call writeLine(&quot;not blank&quot;)\n    \nDo \n    if objSheet.range(startCell).offset(counter) = &quot;&quot; then\n        Exit Do\n    else\n        counter = counter + 1\n    end if\nLoop\n</code></pre>\n<p>It still outputs &quot;10100, not blank&quot;, i.e. it executes the first if statement absolutely fine, but then it gets a Type Mismatch on the if statement within the Do-Loop.</p>\n<p><strong>Why am I getting a type Mismatch?</strong></p>\n<p>Possibly more relevant way of writing the same question: <strong>Why does the If statement have a Type Mismatch when within a Do-Loop, but not when it's outside it?</strong></p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 123, "user_id": 6370467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9778aeec18a9b296a9f8c4da6cc9041?s=128&d=identicon&r=PG&f=1", "display_name": "V. Wolf", "link": "https://stackoverflow.com/users/6370467/v-wolf"}, "edited": false, "score": 0, "creation_date": 1470231846, "post_id": 38743016, "comment_id": 64864533, "body": "Your question is very vague. Please give us more details. What kind of data do you want to compare? Give us a short but practical example, if possible. A nice comparing/matching function is the <code>range.find</code> method in vba. Look <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6625627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79c72d25264e2f35f3361ab49d8e5a0a?s=128&d=identicon&r=PG&f=1", "display_name": "Heisenbug", "link": "https://stackoverflow.com/users/6625627/heisenbug"}, "is_accepted": false, "score": 0, "last_activity_date": 1470231938, "creation_date": 1470231938, "answer_id": 38745454, "question_id": 38743016, "link": "https://stackoverflow.com/questions/38743016/finding-duplicates-with-the-data-of-three-sheets/38745454#38745454", "title": "Finding Duplicates with the data of three sheets", "body": "<p>Without more context/information, I can only give you a high-level response but hopefully it can get you started.</p>\n\n<p>To check if items in one range are found in another range, the code below builds a string from one range then uses \"Instr\" to compare each item from another range against it.  To do more sophisticated comparisons, I'd build arrays from the ranges.</p>\n\n<pre><code>Sub CompareLists()\nDim rng1 As Range, rng2 As Range\nDim cell As Range\nDim tmp As String\n\nSet rng1 = Worksheets(\"Sheet1\").Range(\"A1:A6\")\nSet rng2 = Worksheets(\"Sheet2\").Range(\"A1:A6\")\n\n'Build pipe-delimited string from cells in range\nFor Each cell In rng1\n    tmp = tmp &amp; cell &amp; \"|\"\nNext cell\n\n'Remove last pipe\ntmp = Left(tmp, Len(tmp) - 1)\n\n'Loop list 2 and compare against list 1.\n'Specifically, see if each item in list 2 is found in list 1\nFor Each cell In rng2\n    If InStr(1, tmp, cell) &gt; 0 Then\n\n        'Print items from list 2 that are found in list 1\n        Debug.Print \"Found: \" &amp; cell.Value\n\n    Else\n\n        'Print items from list 2 that are NOT found in list 1\n        Debug.Print \"NOT Found: \" &amp; cell.Value\n\n    End If\n\nNext cell\n\nSet rng1 = Nothing\nSet rng2 = Nothing\nSet cell = Nothing\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 6672235, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ebc7gWYthCY/AAAAAAAAAAI/AAAAAAAAAcY/pvne7SDjzMM/photo.jpg?sz=128", "display_name": "Mangalambigai Prakash", "link": "https://stackoverflow.com/users/6672235/mangalambigai-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1470240693, "creation_date": 1470225553, "last_edit_date": 1531161705, "question_id": 38743016, "link": "https://stackoverflow.com/questions/38743016/finding-duplicates-with-the-data-of-three-sheets", "title": "Finding Duplicates with the data of three sheets", "body": "<p>I have data in column A of three sheets.  I have to take one sheet's data and have to compare with the remaining two sheets' data.</p>\n\n<p>Can anybody help me?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470225477, "post_id": 38742708, "comment_id": 64859565, "body": "What is <code>iRow</code>? What is <code>destination</code>?"}, {"owner": {"reputation": 91, "user_id": 6399647, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b01afc2351152df54a6ca3f50f805f12?s=128&d=identicon&r=PG&f=1", "display_name": "JeanLo", "link": "https://stackoverflow.com/users/6399647/jeanlo"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470225544, "post_id": 38742708, "comment_id": 64859612, "body": "@SiddharthRout i edit the code"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470225609, "post_id": 38742708, "comment_id": 64859659, "body": "One last question, what is the value that you have in col A and Col B? Type it here. There is an easier way to do this"}, {"owner": {"reputation": 91, "user_id": 6399647, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b01afc2351152df54a6ca3f50f805f12?s=128&d=identicon&r=PG&f=1", "display_name": "JeanLo", "link": "https://stackoverflow.com/users/6399647/jeanlo"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470225663, "post_id": 38742708, "comment_id": 64859699, "body": "c:\\Mycomputer\\Folder\\client1.xlsx  and the destination is : c:\\Mycomputer\\folder2\\client1.xlsx"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470226939, "post_id": 38742708, "comment_id": 64860665, "body": "I have posted an answer. See if that helps you. You may have to refresh the page"}], "answers": [{"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 1, "last_activity_date": 1470225395, "creation_date": 1470225395, "answer_id": 38742949, "question_id": 38742708, "link": "https://stackoverflow.com/questions/38742708/vba-copyfile-it-it-doesnt-exist/38742949#38742949", "title": "VBA copyfile it it doesn&#39;t exist", "body": "<pre><code>If Not fso.FileExists(ClientsFolderDestination) Then\n    fso.CopyFile source, ClientsFolderDestination\nEnd If\n</code></pre>\n\n<p>or if you want to <strong>overwrite</strong> the destination file </p>\n\n<pre><code>fso.CopyFile source, ClientsFolderDestination, True\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/e1wf9e7w\" rel=\"nofollow\">CopyFile Method</a></p>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1470226878, "last_edit_date": 1470226878, "creation_date": 1470226159, "answer_id": 38743265, "question_id": 38742708, "link": "https://stackoverflow.com/questions/38742708/vba-copyfile-it-it-doesnt-exist/38743265#38743265", "title": "VBA copyfile it it doesn&#39;t exist", "body": "<p>Try this. </p>\n\n<ol>\n<li>This doesn't use <code>Microsoft Scripting Runtime Library</code>. </li>\n<li>It uses one common function to check for existence of file and folder</li>\n<li>It caters for destination paths like <code>C:\\Sample.xlsx</code></li>\n</ol>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub FC_Copy()\n    Dim ws As Worksheet\n    Dim source As String, Destination As String, sTemp As String\n    Dim lRow As Long, i As Long, j As Long\n    Dim MyAr As Variant\n\n    Set ws = ThisWorkbook.Sheets(\"XClients\")\n\n    With ws\n        '~~&gt; Find Last Row\n        lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        For i = 5 To lRow            \n            source = .Range(\"A\" &amp; i).Value\n            Destination = .Range(\"B\" &amp; i).Value                \n            MyAr = Split(Destination, \"\\\")\n\n            '~~&gt; This check is required for destination paths like C:\\Sample.xlsx\n            If UBound(MyAr) &gt; 1 Then\n                sTemp = MyAr(0)                \n                For j = 1 To UBound(MyAr)\n                    sTemp = sTemp &amp; \"\\\" &amp; MyAr(j)\n                    If Not FileFolderExists(sTemp) = True Then MkDir sTemp\n                Next j\n            End If\n\n            If Not FileFolderExists(Destination) Then FileCopy source, Destination\n        Next i\n    End With\nEnd Sub\n\nPublic Function FileFolderExists(strFullPath As String) As Boolean\n    On Error GoTo Whoa\n    If Not Dir(strFullPath, vbDirectory) = vbNullString Then FileFolderExists = True\n    On Error GoTo 0\nWhoa:\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 6399647, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b01afc2351152df54a6ca3f50f805f12?s=128&d=identicon&r=PG&f=1", "display_name": "JeanLo", "link": "https://stackoverflow.com/users/6399647/jeanlo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1470226878, "creation_date": 1470224830, "last_edit_date": 1470225527, "question_id": 38742708, "link": "https://stackoverflow.com/questions/38742708/vba-copyfile-it-it-doesnt-exist", "title": "VBA copyfile it it doesn&#39;t exist", "body": "<p>I have a list of file in 2 columns <code>A</code> and <code>B</code>.</p>\n\n<ul>\n<li><code>A</code> column is the source the B</li>\n<li><code>B</code> column is the destination</li>\n</ul>\n\n<p>The code below copy file from source to destination. But if the destination exists it give me errors. What is the condition so that if it find that it exists it will not do anyting ?? </p>\n\n<p>What is the wrong with the code ?</p>\n\n<pre><code>  Sub FC_Copy()\n\nDim ClientsFolderDestination\nDim fso As New FileSystemObject\nDim rep_destination\nDim source\n\n    lastrow = ThisWorkbook.Worksheets(\"XClients\").Cells(Application.Rows.Count, 1).End(xlUp).Row\n\n    For i = 5 To lastrow\n        source = ThisWorkbook.Worksheets(\"XClients\").Cells(i, 1).Value\n        ClientsFolderDestination= ThisWorkbook.Worksheets(\"XClients\").Cells(i, 2).Value\n        If fso.FileExists(source) Then\n            rep_destination = Left(ClientsFolderDestination, Len(ClientsFolderDestination) - Len(fso.GetFileName(ClientsFolderDestination)) - 1)\n\n         If Not fso.FolderExists(rep_destination) Then\n          sub_rep = Split(rep_destination, \"\\\")\n          myrep = sub_rep(0)\n          If Not fso.FolderExists(myrep) Then\n              MkDir myrep\n           End If\n           For irep = 1 To UBound(sub_rep)\n              myrep = myrep &amp; \"\\\" &amp; sub_rep(irep)\n               If Not fso.FolderExists(myrep) Then\n                    MkDir myrep\n               End If\n         Next\n    End If\n\n            fso.CopyFile source, ClientsFolderDestination\n        End If\n    Next i\nend sub\n</code></pre>\n"}, {"tags": ["vba", "unicode", "ms-word", "macros"], "answers": [{"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1470227129, "creation_date": 1470227129, "answer_id": 38743618, "question_id": 38742435, "link": "https://stackoverflow.com/questions/38742435/some-characters-lose-formatting-in-vba-macro-others-dont/38743618#38743618", "title": "some characters lose formatting in vba macro others don&#39;t", "body": "<p>You can try turning AutoCorrect off as that can replace some characters.</p>\n\n<p>In Word characters have Paragraph style and character style, so you can try looking into those:</p>\n\n<pre><code>Debug.Print ThisRng.Style.Description\nDebug.Print ThisRng.CharacterStyle.Description\nDebug.Print ThisRng.ParagraphStyle.Description\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 2, "last_activity_date": 1470233823, "last_edit_date": 1495541843, "creation_date": 1470233823, "answer_id": 38746181, "question_id": 38742435, "link": "https://stackoverflow.com/questions/38742435/some-characters-lose-formatting-in-vba-macro-others-dont/38746181#38746181", "title": "some characters lose formatting in vba macro others don&#39;t", "body": "<p>Firstly, just as a suggestion, you could have a smaller code base if you set the array as: -</p>\n\n<pre><code>Dim ValueMap(270)  As String\nDim AryTemp()      As String\nValueMap(0) = \"&amp;H30|&amp;H30\"\n\nFor i = 0 To 270\n    AryTemp = Split(ValueMap(i),\"|\")\n    'AryTemp(0) = The Old\n    'AryTemp(1) = The New\nNext\n</code></pre>\n\n<p>As to an answer to your question. I am unaware of how to stop it losing the italic, I suspect this could be caused by it being set to italic via a style instead of formatting or vice versa, but that depth of investigation would not fit in this environment (Q&amp;A) I don't think.</p>\n\n<p>As for a solution, there are many ways to do what you need to, as solutioned in your <a href=\"https://stackoverflow.com/questions/38739331/ms-word-macro-to-correct-partially-formatted-words\">other question</a>, I don't think this can be done in a blanket manner (i.e. there is no way to set all those that were italic back to italic in one go) as the information is not retained after the find and replace is executed. So it would have to be done at the point the character is swapped, meaning it can only do one find and replace at a time which will have a performance impact.</p>\n\n<p>In the below example I have also used the shorter array method described above.</p>\n\n<pre><code>Public Sub Sample()\nDim BlnWasItalic        As Boolean\nDim AryValueMap(270)    As String\nDim AryTemp()           As String\nDim LngLocation         As Long\nDim LngValueID          As Long\nDim WdDoc               As Word.Document\nDim WdFnd               As Word.Find\nDim WdRng               As Word.Range\nDim WdSlct              As Word.Selection\n\nAryValueMap(0) = \"&amp;H30|&amp;H30\"\nAryValueMap(1) = \"&amp;H31|&amp;H31\"\n'...\nAryValueMap(269) = \"&amp;H2C|H2C\"\nAryValueMap(270) = \"&amp;H9|&amp;H9\"\n\nSet WdDoc = ThisDocument\n    For Each WdRng In WdDoc.StoryRanges\n        For LngValueID = 0 To 270\n            WdRng.Select\n            Set WdSlct = Selection\n                WdSlct.SetRange 0, 0\n                Set WdFnd = WdSlct.Find\n\n                    'Clear any previous find settings\n                    If LngValueID = 0 Then\n                        WdFnd.ClearAllFuzzyOptions\n                        WdFnd.ClearFormatting\n                        WdFnd.ClearHitHighlight\n\n                        .Font.Name = \"AO Times New Roman\"\n\n                    End If\n\n                    AryTemp = Split(AryValueMap(LngValueID), \"|\")\n\n                    'Look for any italic character\n                    Do Until Not WdFnd.Execute(FindText:=ChrW(AryTemp(0)), MatchCase:=True, _\n                                                MatchWholeWord:=False, MatchWildcards:=False, _\n                                                MatchSoundsLike:=False, MatchAllWordForms:=False, _\n                                                Forward:=True, Wrap:=wdFindStop, Format:=True, _\n                                                ReplaceWith:=\"\", Replace:=wdReplaceNone, _\n                                                MatchKashida:=False, MatchDiacritics:=False, _\n                                                MatchAlefHamza:=False, MatchControl:=False)\n\n                        'Take note if it was italic\n                        BlnWasItalic = WdSlct.Font.Italic\n\n                        'Make the replacement\n                        WdSlct = ChrW(AryTemp(1))\n\n                        'Remember the location (in case there are due to be more than\n                        'one change in one word\n                        LngLocation = WdSlct.End\n\n                        'Expand the selection to the whole word\n                        WdSlct.Expand wdWord\n\n                        'Set the font\n                        WdSlct.Font.Name = \"Arial Unicode MS\"\n\n                        'Set the word to be italic if it was meant to be\n                        WdSlct.Font.Italic = BlnWasItalic\n\n                        'Move past the word\n                        WdSlct.SetRange LngLocation, LngLocation\n                    Loop\n                Set WdFnd = Nothing\n            Set WdSlct = Nothing\n            DoEvents\n        Next\n        DoEvents\n    Next\nSet WdDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p>(This code is untested and formed to exemplify a solution)</p>\n"}], "owner": {"reputation": 87, "user_id": 4045481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/980197bfbe13208d76b7140fc29ce3f6?s=128&d=identicon&r=PG&f=1", "display_name": "peterv", "link": "https://stackoverflow.com/users/4045481/peterv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1470233823, "creation_date": 1470224108, "last_edit_date": 1495542734, "question_id": 38742435, "link": "https://stackoverflow.com/questions/38742435/some-characters-lose-formatting-in-vba-macro-others-dont", "title": "some characters lose formatting in vba macro others don&#39;t", "body": "<p>I have a number of documents that are made in the pre-Unicode era, and contain transcriptions of various languages, each with their own fonts. \nI made a macro that replaces every character in a document with another character (from multiple old transcription fonts into a unicode font). (see code below of the macro for one of these fonts)</p>\n\n<p>For some reason, the macro keeps the formatting (in my case, mostly italics) for some characters, not for others. This leaves me with a lot of words in which some letters are italicized, and other letters aren't, e.g.</p>\n\n<p><em>al-Malik al-Mu</em>\u01e7\u0101<em>hid \u1e2bu</em>\u1e6d<em>ba</em></p>\n\n<p>The characters that lose the formatting are all characters with diacritics, but not all characters with diacritics lose their formatting (e.g., the \u1e2b in the example). \nNot all characters that keep their formatting have the same code point in the original font as in the unicode font (e.g., the \u1e2b in the example has unicode number U+23 in the original font and U+1E2B in the unicode font).</p>\n\n<p>Do you have an idea why the formatting is kept for some characters, and not for others? Or how I could solve this problem? </p>\n\n<p>Alternatively, I could add another macro to the procedure that would format all words that contain at least one letter in italics into italics (but how to do that is another question: <a href=\"https://stackoverflow.com/questions/38739331/ms-word-macro-to-correct-partially-formatted-words\">MS Word macro to correct partially formatted words</a>).</p>\n\n<pre><code>Sub BatchReplaceAOTimes()\n\n'Replace the font AO Times New Roman in the body and footnotes\n'of the active document\n\nDebug.Print \"Replacing AO Times New Roman font\"\nDim old_values(270) As String\nDim unicode_values(270) As Long\n\nold_values(0) = &amp;H30\nold_values(1) = &amp;H31\n(...)\nold_values(263) = &amp;HFD\nold_values(264) = &amp;HDD\nold_values(265) = &amp;H178\nold_values(266) = &amp;HFF\nold_values(267) = &amp;H5A\nold_values(268) = &amp;H7A\nold_values(269) = &amp;H2C\nold_values(270) = &amp;H9\n\nunicode_values(0) = &amp;H30\nunicode_values(1) = &amp;H31\n(...)\nunicode_values(263) = &amp;H2BE\nunicode_values(264) = &amp;H2BF\nunicode_values(265) = &amp;H1E6E\nunicode_values(267) = &amp;H5A\nunicode_values(268) = &amp;H7A\nunicode_values(269) = &amp;H2C\nunicode_values(270) = &amp;H9\n\nSelection.HomeKey Unit:=wdStory\n\nDim ThisRng As Range\n\n'do body text\nSet ThisRng = ActiveDocument.StoryRanges(wdMainTextStory)\nFor i = 0 To 270\n    Debug.Print i\n\n    ThisRng.Find.ClearFormatting\n    ThisRng.Find.Replacement.ClearFormatting\n\n    With ThisRng.Find\n        .Font.Name = \"AO Times New Roman\"\n        .Text = ChrW(old_values(i))\n        .Replacement.Font.Name = \"Arial Unicode MS\"\n        .Replacement.Text = ChrW(unicode_values(i))\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = True\n        .MatchCase = True\n        .MatchWholeWord = False\n        .MatchKashida = False\n        .MatchDiacritics = False\n        .MatchAlefHamza = False\n        .MatchControl = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    ThisRng.Find.Execute Replace:=wdReplaceAll\n    Next i\n\n   (...: do the same for the footnotes)\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1470223677, "post_id": 38742266, "comment_id": 64858262, "body": "So why don&#39;t you just add it?  What&#39;s your question?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1470223746, "post_id": 38742266, "comment_id": 64858302, "body": "What&#39;s your problem?"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1470224161, "post_id": 38742266, "comment_id": 64858615, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/27332602/vba-event-unlock-cell-in-protected-sheets-if-selected\">VBA event - Unlock cell in protected sheets if selected</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "is_accepted": false, "score": -1, "last_activity_date": 1470223860, "creation_date": 1470223860, "answer_id": 38742346, "question_id": 38742266, "link": "https://stackoverflow.com/questions/38742266/lock-unlock-with-vba/38742346#38742346", "title": "Lock &amp; Unlock with VBA", "body": "<p>Done it!!</p>\n\n<p>Private Sub CommandButton1_Click()</p>\n\n<p>ActiveSheet.Unprotect\n'\n' New_Risk_4 Macro\n    ActiveSheet.UsedRange\n    'reset the last active cell'</p>\n\n<pre><code>Sheets(\"Risk Template\").Select\n'Looks at the risk template sheet'\n\nActiveCell.Rows(\"1:7\").EntireRow.Select\nActiveCell.Offset(0, 4).Range(\"A1\").Activate\n'selects everything within the range'\n\nSelection.Copy\n'Copies to clipboard'\n\nSheets(\"Risk Input Sheet\").Select\n'Switches back to Risk Input sheet'\n\nActiveCell.SpecialCells(xlLastCell).Select\n'Selects last active cell'\n\nActiveCell.Offset(1, 0).Rows(\"1:1\").EntireRow.Select\n'Selects row with last active cell'\n\nActiveSheet.Paste\n'Paste to select row'\n\nActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _\n    , AllowFormattingCells:=True, AllowFormattingColumns:=True, _\n    AllowFormattingRows:=True, AllowInsertingColumns:=True, AllowInsertingRows _\n    :=True, AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _\n    AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _\n    AllowUsingPivotTables:=True\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 366, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1470223860, "creation_date": 1470223646, "question_id": 38742266, "link": "https://stackoverflow.com/questions/38742266/lock-unlock-with-vba", "title": "Lock &amp; Unlock with VBA", "body": "<p>Right i have some code that i wrote using VBA recorder but i would like to add unlock sheet at the beginning and then lock sheet at the end.</p>\n\n<p>Private Sub CommandButton1_Click()</p>\n\n<p>'\n' New_Risk_4 Macro\n    ActiveSheet.UsedRange\n    'reset the last active cell'</p>\n\n<pre><code>Sheets(\"Risk Template\").Select\n'Looks at the risk template sheet'\n\nActiveCell.Rows(\"1:7\").EntireRow.Select\nActiveCell.Offset(0, 4).Range(\"A1\").Activate\n'selects everything within the range'\n\nSelection.Copy\n'Copies to clipboard'\n\nSheets(\"Risk Input Sheet\").Select\n'Switches back to Risk Input sheet'\n\nActiveCell.SpecialCells(xlLastCell).Select\n'Selects last active cell'\n\nActiveCell.Offset(1, 0).Rows(\"1:1\").EntireRow.Select\n'Selects row with last active cell'\n\nActiveSheet.Paste\n'Paste to select row'\n</code></pre>\n"}, {"tags": ["excel", "excel-2007", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1470221246, "post_id": 38741328, "comment_id": 64856677, "body": "Go into Excel Option ([alt]+F, T) then Advanced. In the Display section (about a third of the way down in the right pane) there is a Default direction option. Change it to Left-to-right."}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 1, "creation_date": 1470221455, "post_id": 38741328, "comment_id": 64856797, "body": "There is also an option further down, still under &#39;Display&#39; but for the specific worksheet that needs to be unchecked, its called &#39;Show sheet right-to-left&#39;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1470221833, "post_id": 38741328, "comment_id": 64857047, "body": "btw, you can record these actions with the macro recorder if you are having trouble finding the correct VBA syntax for them."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6671884, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9b65337b15d60d6b973a0191eb4f0a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Drozdowski", "link": "https://stackoverflow.com/users/6671884/maciej-drozdowski"}, "edited": false, "score": 0, "creation_date": 1470221801, "post_id": 38741479, "comment_id": 64857027, "body": "Thanks, but I&#39;m using Excel 2007 and I can&#39;t find the aforesaid option."}], "tags": [], "owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "is_accepted": true, "score": 2, "last_activity_date": 1470223031, "last_edit_date": 1592644375, "creation_date": 1470221412, "answer_id": 38741479, "question_id": 38741328, "link": "https://stackoverflow.com/questions/38741328/reversed-columns-a-column-at-the-end-of-a-spreadsheet/38741479#38741479", "title": "Reversed columns (&#39;A&#39; column at the end of a Spreadsheet)", "body": "<p>It looks that Excel 2007 has a diferent approach to reverse the order of columns from other Excel versions, as mentioned in <a href=\"http://www.rondebruin.nl/win/s5/win004.htm\" rel=\"nofollow noreferrer\">http://www.rondebruin.nl/win/s5/win004.htm</a></p>\n<h2>Excel 2007:</h2>\n<ol>\n<li>Open Excel and create a new workbook</li>\n<li>Alt+F11 to open the VBA editor</li>\n<li>Ctrl+G to open the Immediate window and then type in the window</li>\n</ol>\n<p>Application.DefaultSheetDirection = xlRTL</p>\n<p>Press Enter.</p>\n<ol start=\"4\">\n<li>Alt+Q to close the VBA editor</li>\n<li>Create a new workbook to test it</li>\n</ol>\n<p><strong>Note:</strong> you can type <code>Application.DefaultSheetDirection = xlLTR</code> to reverse again.</p>\n<h2>Excel 2013:</h2>\n<p>Go to File -&gt; Options -&gt; Advanced -&gt; Display (tab) -&gt; Default direction -&gt; Right-to-Left.</p>\n<p>Hope that helps ;)</p>\n"}], "owner": {"reputation": 29, "user_id": 6671884, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9b65337b15d60d6b973a0191eb4f0a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Drozdowski", "link": "https://stackoverflow.com/users/6671884/maciej-drozdowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 38741479, "answer_count": 1, "score": 1, "last_activity_date": 1470223031, "creation_date": 1470221000, "last_edit_date": 1531161705, "question_id": 38741328, "link": "https://stackoverflow.com/questions/38741328/reversed-columns-a-column-at-the-end-of-a-spreadsheet", "title": "Reversed columns (&#39;A&#39; column at the end of a Spreadsheet)", "body": "<p>I'm asked to solve this kind of problem, but it's too hard for me.\n<a href=\"http://i.stack.imgur.com/KXK7o.jpg\" rel=\"nofollow\">Click to see reversed columns</a></p>\n\n<p>Of course, I want the sheet to show columns from 'A'. Has anybody got any idea how to figure it out?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 1, "creation_date": 1470218983, "post_id": 38740478, "comment_id": 64855203, "body": "If you are calling proc 1/2/3 from mycode it will run. are you sure there isn&#39;t something else wrong in your code?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1470219190, "post_id": 38740478, "comment_id": 64855334, "body": "Do you have lots of lines like ` ActiveWindow.ScrollRow = 9838`?  I&#39;d advise looking at the accepted answer on this thread: <a href=\"http://stackoverflow.com/questions/11450232/getting-error-procedure-too-large-in-vba-macros-excel\" title=\"getting error procedure too large in vba macros excel\">stackoverflow.com/questions/11450232/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6650447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/90e4187dc773414fba59b156a8963fff?s=128&d=identicon&r=PG&f=1", "display_name": "MissMacro", "link": "https://stackoverflow.com/users/6650447/missmacro"}, "edited": false, "score": 0, "creation_date": 1470223005, "post_id": 38740709, "comment_id": 64857797, "body": "Hey Macro Man, thank you for your quick answer, well when i replaced END by Exit Sub I got a message box &quot;with an error&quot;"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1470223763, "post_id": 38740709, "comment_id": 64858317, "body": "@MacroMan His question shows he uses <code>End Sub</code>, it simply seems like he is replacing <code>End Sub</code> with <code>Exit Sub</code>...thus the <code>Sub</code> is never closed."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 1, "creation_date": 1470223895, "post_id": 38740709, "comment_id": 64858419, "body": "@DragonSamu that&#39;s why I&#39;m asking for the error message. If it&#39;s a compile error then OP misunderstood my answer."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 21, "user_id": 6650447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/90e4187dc773414fba59b156a8963fff?s=128&d=identicon&r=PG&f=1", "display_name": "MissMacro", "link": "https://stackoverflow.com/users/6650447/missmacro"}, "edited": false, "score": 0, "creation_date": 1470227492, "post_id": 38740709, "comment_id": 64861125, "body": "@IkrameBahhar Don&#39;t replace <code>End Sub</code> with <code>Exit Sub</code> - I meant somewhere in your code <i>before</i> <code>End Sub</code> there must be the word <code>End</code> written on it&#39;s own somewhere. <i>That</i> is what needs to be replaced"}, {"owner": {"reputation": 21, "user_id": 6650447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/90e4187dc773414fba59b156a8963fff?s=128&d=identicon&r=PG&f=1", "display_name": "MissMacro", "link": "https://stackoverflow.com/users/6650447/missmacro"}, "edited": false, "score": 0, "creation_date": 1470227775, "post_id": 38740709, "comment_id": 64861355, "body": "@MacroMan I don&#39;t have any  <code>End</code> in the proc1 that&#39;s why i&#39;m struggling with this :("}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 21, "user_id": 6650447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/90e4187dc773414fba59b156a8963fff?s=128&d=identicon&r=PG&f=1", "display_name": "MissMacro", "link": "https://stackoverflow.com/users/6650447/missmacro"}, "edited": false, "score": 0, "creation_date": 1470228394, "post_id": 38740709, "comment_id": 64861817, "body": "@IkrameBahhar how come you&#39;ve accepted it as the answer then?"}, {"owner": {"reputation": 21, "user_id": 6650447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/90e4187dc773414fba59b156a8963fff?s=128&d=identicon&r=PG&f=1", "display_name": "MissMacro", "link": "https://stackoverflow.com/users/6650447/missmacro"}, "edited": false, "score": 0, "creation_date": 1470228434, "post_id": 38740709, "comment_id": 64861858, "body": "I really don&#39;t understand, that&#39;s getting me crazy :/"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 21, "user_id": 6650447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/90e4187dc773414fba59b156a8963fff?s=128&d=identicon&r=PG&f=1", "display_name": "MissMacro", "link": "https://stackoverflow.com/users/6650447/missmacro"}, "edited": false, "score": 0, "creation_date": 1470228470, "post_id": 38740709, "comment_id": 64861892, "body": "@IkrameBahhar can you come into this room? <a href=\"http://chat.stackoverflow.com/rooms/111528/vba-lounge\">chat.stackoverflow.com/rooms/111528/vba-lounge</a>"}, {"owner": {"reputation": 21, "user_id": 6650447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/90e4187dc773414fba59b156a8963fff?s=128&d=identicon&r=PG&f=1", "display_name": "MissMacro", "link": "https://stackoverflow.com/users/6650447/missmacro"}, "edited": false, "score": 0, "creation_date": 1470230393, "post_id": 38740709, "comment_id": 64863432, "body": "@MacroMan They told me : You must have 20 reputation on Stack Overflow to talk here. See the faq."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 21, "user_id": 6650447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/90e4187dc773414fba59b156a8963fff?s=128&d=identicon&r=PG&f=1", "display_name": "MissMacro", "link": "https://stackoverflow.com/users/6650447/missmacro"}, "edited": false, "score": 0, "creation_date": 1470230739, "post_id": 38740709, "comment_id": 64863682, "body": "@IkrameBahhar I&#39;ve updated your access it should let you now"}, {"owner": {"reputation": 21, "user_id": 6650447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/90e4187dc773414fba59b156a8963fff?s=128&d=identicon&r=PG&f=1", "display_name": "MissMacro", "link": "https://stackoverflow.com/users/6650447/missmacro"}, "edited": false, "score": 0, "creation_date": 1470320362, "post_id": 38740709, "comment_id": 64911122, "body": "@MacroMan I&#39;m sorry, due to the jet lag I slept.. :/"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1470220400, "last_edit_date": 1470220400, "creation_date": 1470219313, "answer_id": 38740709, "question_id": 38740478, "link": "https://stackoverflow.com/questions/38740478/vba-procedure-too-large-only-the-first-procedure-works/38740709#38740709", "title": "VBA Procedure too large, only the first procedure works", "body": "<p>You must have the <code>End</code> keyword somewhere in proc1:</p>\n\n<pre><code>'// some code here\n'// some more code\nEnd\n</code></pre>\n\n<p>Replace this with:</p>\n\n<pre><code>'// some code here\n'// some more code\nExit Sub\n</code></pre>\n\n<p>which will return control to the calling procedure.</p>\n\n<hr>\n\n<p>The <code>End</code> word on it's own will stop execution without returning control to the calling procedure and shouldn't really be used unless there is good reason.</p>\n\n<p>As a side note, there is no need to use the <code>Call</code> keyword in VBA it's just there for legacy purposes.</p>\n"}], "owner": {"reputation": 21, "user_id": 6650447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/90e4187dc773414fba59b156a8963fff?s=128&d=identicon&r=PG&f=1", "display_name": "MissMacro", "link": "https://stackoverflow.com/users/6650447/missmacro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 38740709, "answer_count": 1, "score": 0, "last_activity_date": 1470229404, "creation_date": 1470218713, "last_edit_date": 1470229404, "question_id": 38740478, "link": "https://stackoverflow.com/questions/38740478/vba-procedure-too-large-only-the-first-procedure-works", "title": "VBA Procedure too large, only the first procedure works", "body": "<p>Well after writing a big big code and running it I got the message</p>\n\n<blockquote>\n  <p>Procedure too large. </p>\n</blockquote>\n\n<p>After some researches I found that i can write the code this way :</p>\n\n<pre><code>Sub mycode()\nCall proc1\nCall proc2\nCall proc3\nEnd sub\n\nSub proc1()\n'the code\nEnd sub\n\nSub proc2()\n'the code\nEnd sub\n\nSub proc3()\n'the code\nEnd sub\n</code></pre>\n\n<p>And that's exactly what I've done but unfortunately only PROC1 code that is being executed.</p>\n\n<p>How can I do to run the whole code : PROC1 then PROC2 then PROC3 ????</p>\n"}, {"tags": ["vba", "function", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470223384, "post_id": 38740388, "comment_id": 64858057, "body": "Well you tell us if it is correct or not? What values you were expecting and what did you exactly get :) Since you are new here, I would recommend visiting <a href=\"http://stackoverflow.com/tour\">This Link</a> and then rewording your question"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1470225157, "post_id": 38740388, "comment_id": 64859332, "body": "Is you question about the code or about the validity of the formula you are using?"}, {"owner": {"reputation": 161, "user_id": 6518800, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-uuL2Qg0lx5M/AAAAAAAAAAI/AAAAAAAAAD4/jd4856XxBUU/photo.jpg?sz=128", "display_name": "rania triki", "link": "https://stackoverflow.com/users/6518800/rania-triki"}, "edited": false, "score": 0, "creation_date": 1470232013, "post_id": 38740388, "comment_id": 64864661, "body": "it is about the validity of the formula..."}, {"owner": {"reputation": 161, "user_id": 6518800, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-uuL2Qg0lx5M/AAAAAAAAAAI/AAAAAAAAAD4/jd4856XxBUU/photo.jpg?sz=128", "display_name": "rania triki", "link": "https://stackoverflow.com/users/6518800/rania-triki"}, "edited": false, "score": 0, "creation_date": 1470232277, "post_id": 38740388, "comment_id": 64864873, "body": "in fact, I want to determine the adjacens radio sites like 3G sites. now I have to determine the cells in a half circle in front bounded by the perpendicular to the direction of the cell (azimuth) and a radius which is configurable"}], "answers": [{"tags": [], "owner": {"reputation": 2724, "user_id": 3397819, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/seOux.jpg?s=128&g=1", "display_name": "Anastasiya-Romanova \u79c0", "link": "https://stackoverflow.com/users/3397819/anastasiya-romanova-%e7%a7%80"}, "is_accepted": true, "score": 1, "last_activity_date": 1470224134, "creation_date": 1470224134, "answer_id": 38742448, "question_id": 38740388, "link": "https://stackoverflow.com/questions/38740388/calculate-the-azimuth-between-two-points-given-the-latitude-and-longitude-are-kn/38742448#38742448", "title": "Calculate the azimuth between two points given the latitude and longitude are known with VBA", "body": "<p>Assuming your formula is correct (since I interpret it to the code below without checking it), then here is the code:</p>\n\n<pre><code>Function Azimuth(lat1 As Single, lat2 As Single, lon1 As Single, lon2 As Single) As Single\n\nDim X1 As Single, X2 As Single, Y As Single, dX As Single, dY As Single\n\nWith Application.WorksheetFunction\n    X1 = .Radians(lat1)\n    X2 = .Radians(lat2)\n    Y = .Radians(lon2 - lon1)\nEnd With\n\n    dX = Math.Cos(X1) * Math.Sin(X2) - Math.Sin(X1) * Math.Cos(X2) * Math.Cos(Y)\n    dY = Math.Cos(X2) * Math.Sin(Y)\n\n\nWith Application.WorksheetFunction\n    Azimuth = .Degrees(.Atan2(dX, dY))\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>Well, even if the formula turns out to be incorrect, at least the code above should give you the idea to start with.</p>\n"}], "owner": {"reputation": 161, "user_id": 6518800, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-uuL2Qg0lx5M/AAAAAAAAAAI/AAAAAAAAAD4/jd4856XxBUU/photo.jpg?sz=128", "display_name": "rania triki", "link": "https://stackoverflow.com/users/6518800/rania-triki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1436, "favorite_count": 0, "accepted_answer_id": 38742448, "answer_count": 1, "score": -2, "last_activity_date": 1470224134, "creation_date": 1470218494, "last_edit_date": 1531164843, "question_id": 38740388, "link": "https://stackoverflow.com/questions/38740388/calculate-the-azimuth-between-two-points-given-the-latitude-and-longitude-are-kn", "title": "Calculate the azimuth between two points given the latitude and longitude are known with VBA", "body": "<p>I have to calculate the azimuth between two points given in latitude and longitude\nis this fynction correct?</p>\n\n<pre><code>Function azimut(lat1, lat2, lon1, lon2)\n\nazimut = WorksheetFunction.Degrees(WorksheetFunction.Atan2(\n   Cos(Application.WorksheetFunction.Radians(lat1)) * \n   Sin(Application.WorksheetFunction.Radians(lat2)) -\n   Sin(Application.WorksheetFunction.Radians(lat1)) * \n   Cos(Application.WorksheetFunction.Radians(lat2)) * \n   Cos(Application.WorksheetFunction.Radians(lon2 - lon1)), \n   Sin(Application.WorksheetFunction.Radians(lon2 - lon1)) * \n   Cos(Application.WorksheetFunction.Radians(lat2))))\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 2, "creation_date": 1470219503, "post_id": 38740233, "comment_id": 64855551, "body": "If the Named Range only includes the ActiveCell then ActiveCell.Name.Name will return the Named Range."}, {"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1470221148, "post_id": 38740233, "comment_id": 64856619, "body": "Thanks Thomas, thats useful, but already exploited I guess in Excel&#39;s adress window (up on the left)."}], "answers": [{"comments": [{"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1470230864, "post_id": 38741614, "comment_id": 64863775, "body": "Of course it is, and if anyone might come, the question may be relevant too?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1470231326, "post_id": 38741614, "comment_id": 64864110, "body": "@MLind I agree.   By the way, I like your concept."}, {"owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1470231832, "post_id": 38741614, "comment_id": 64864525, "body": "It&#39;s nothing fancy, a class module in the personal workbook with Appl_SheetSelectionChange calling a subroutine writing info about the current cell at the left of the statusbar much the same way as Excel 2010 writes range sums to the right of the bar. Maybe I could share it here somehow? It&#39;s only like two screenpages of code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "edited": false, "score": 0, "creation_date": 1470232967, "post_id": 38741614, "comment_id": 64865425, "body": "Could you email it to me? tommy70458@gmail"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 3, "last_activity_date": 1470221784, "creation_date": 1470221784, "answer_id": 38741614, "question_id": 38740233, "link": "https://stackoverflow.com/questions/38740233/find-the-named-ranges-a-given-cell-belongs-to/38741614#38741614", "title": "Find the named ranges a given cell belongs to", "body": "<p>The easiest way is to loop through the names.</p>\n\n<pre><code>Function getRangeNames(Target As Range)\n    Dim n As Name\n    Dim s As String\n    For Each n In ThisWorkbook.Names\n        On Error Resume Next\n        If Not Intersect(Target, n.RefersToRange) Is Nothing Then\n            s = s &amp; n.Name &amp; \", \"\n        End If\n        On Error GoTo 0\n    Next n\n\n    getRangeNames = Left(s, Len(s) - 2)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 904, "user_id": 6595438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8lHrz.png?s=128&g=1", "display_name": "Mats Lind", "link": "https://stackoverflow.com/users/6595438/mats-lind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 814, "favorite_count": 0, "accepted_answer_id": 38741614, "answer_count": 1, "score": 1, "last_activity_date": 1470222110, "creation_date": 1470218071, "last_edit_date": 1531161705, "question_id": 38740233, "link": "https://stackoverflow.com/questions/38740233/find-the-named-ranges-a-given-cell-belongs-to", "title": "Find the named ranges a given cell belongs to", "body": "<p>I'm writing a personal macro that displays important info about the ActiveCell on the statusbar, like the names (if any) of tables or pivottables it belongs to, what <em>unformatted</em> value it holds and such. </p>\n\n<p>Now I would also like to display the names of the named ranges the cell is included in. I guess I could scan through some Names Collection for the ActiveWorkbook and test with intersect, but is there any easier way?</p>\n"}, {"tags": ["excel", "vba", "merge", "duplicates", "row"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1470217292, "post_id": 38739758, "comment_id": 64854121, "body": "Create a Class where one member is <code>Name</code> and all the other information and the other is a Dictionary of <code>Units</code>.  Use the <code>.Exists</code> method to weed out the duplicate units."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1470217404, "post_id": 38739758, "comment_id": 64854190, "body": "@MaciejLos  What is your point?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1470219167, "post_id": 38739758, "comment_id": 64855316, "body": "@MaciejLos It is common in VBA.  From the VBE main menu bar, select <code>Insert</code> \u25ba <code>Class Module</code>.  For further information about Classes in VBA, I refer you to Chip Pearson&#39;s <a href=\"http://www.cpearson.com/Excel/Classes.aspx\" rel=\"nofollow noreferrer\">Introduction to Classes</a>"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6294766, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb33d1ed1925238bb66ef1ba279b062e?s=128&d=identicon&r=PG&f=1", "display_name": "llorcs", "link": "https://stackoverflow.com/users/6294766/llorcs"}, "edited": false, "score": 0, "creation_date": 1470225582, "post_id": 38739940, "comment_id": 64859648, "body": "Hi! I&#39;ve tried to insert it (the first one) however it does not seem to change anything for me unfortunately. Any ideas as to why?"}, {"owner": {"reputation": 1069, "user_id": 5620071, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Vw86Z.jpg?s=128&g=1", "display_name": "Mister 832", "link": "https://stackoverflow.com/users/5620071/mister-832"}, "reply_to_user": {"reputation": 71, "user_id": 6294766, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb33d1ed1925238bb66ef1ba279b062e?s=128&d=identicon&r=PG&f=1", "display_name": "llorcs", "link": "https://stackoverflow.com/users/6294766/llorcs"}, "edited": false, "score": 0, "creation_date": 1470234175, "post_id": 38739940, "comment_id": 64866314, "body": "Hi, just to check, you did delete the existing data, right? If so, try to set a breaktpoint or use debug.print in the line, to see what it does in more detail."}], "tags": [], "owner": {"reputation": 1069, "user_id": 5620071, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Vw86Z.jpg?s=128&g=1", "display_name": "Mister 832", "link": "https://stackoverflow.com/users/5620071/mister-832"}, "is_accepted": false, "score": 0, "last_activity_date": 1470220827, "last_edit_date": 1470220827, "creation_date": 1470217294, "answer_id": 38739940, "question_id": 38739758, "link": "https://stackoverflow.com/questions/38739758/vba-deleting-duplicate-rows-and-merging-cells-with-unique-data/38739940#38739940", "title": "VBA - Deleting duplicate rows and merging cells with unique data", "body": "<p>Try the following</p>\n\n<pre><code>If Records.Exists(Data(Index, 1)) Then\n    If InStr(Destination.Cells(Records(Data(Index, 1)), 5).Value2, Data(Index, 5)) = 0 Then \n        Destination.Cells(Records(Data(Index, 1)), 5).Value2 = Destination.Cells(Records(Data(Index, 1)), 5).Value2 &amp; \", \" &amp; Data(Index, 5)\n    End if\n...\n</code></pre>\n\n<p>InStr searches for a certain String in another, and returns the position at which the string is found. Hence, if Marketing not found, instr will return 0 and it will be added to the cell. If it is already there, Instr will return something largern than 0 and it will not be added again.</p>\n\n<p><strong>Update</strong> If you have more records with more than one unit, try this</p>\n\n<pre><code>UnitFull = Data(Index, 5)\n\nDo Until Len(UnitFull) = 0\n    If InStr(UnitFull, \",\") &gt; 0 Then\n        Unit = Left(UnitFull, Instr(UnitFull, \",\") - 1)\n        UnitFull = Trim(Right(UnitFull, Len(UnitFull) - InStr(UnitFull, \",\")))\n\n    Else\n\n        Unit = UnitFull\n        UnitFull = \"\"\n\n    End If\n\n    Destination.Cells(Records(Data(Index, 1)), 5).Value2 = Destination.Cells(Records(Data(Index, 1)), 5).Value2 &amp; \", \" &amp; Unit\n\n    Unit = \"\"\n\nLoop\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1470221207, "creation_date": 1470221207, "answer_id": 38741396, "question_id": 38739758, "link": "https://stackoverflow.com/questions/38739758/vba-deleting-duplicate-rows-and-merging-cells-with-unique-data/38741396#38741396", "title": "VBA - Deleting duplicate rows and merging cells with unique data", "body": "<p>I use a Dictionary to remove duplicates in a comma delimit string.  Email, code and Country are also copied over to the Destination worksheet.  </p>\n\n<pre><code>Sub Main()\n    Dim Source As Worksheet: Set Source = ThisWorkbook.Worksheets(\"Sheet1\")\n    Dim Destination As Worksheet: Set Destination = ThisWorkbook.Worksheets(\"Sheet2\")\n    Dim Records As Object: Set Records = CreateObject(\"Scripting.Dictionary\")\n\n    Dim Data As Variant\n    Dim Index As Long\n    Dim Row As Integer: Row = 1\n\n    Data = Source.Range(\"A1\", \"E\" &amp; Source.Rows(Source.UsedRange.Rows.Count).Row).Value2\n    With Destination\n\n        For Index = LBound(Data, 1) To UBound(Data, 1)\n            If Records.Exists(Data(Index, 1)) Then\n                Destination.Cells(Records(Data(Index, 1)), 5).Value2 = removeDuplicates(Destination.Cells(Records(Data(Index, 1)), 5).Value2 &amp; \", \" &amp; Data(Index, 5))\n            Else\n                Records.Add Data(Index, 1), Row\n                Destination.Cells(Row, 1).Value2 = Data(Index, 1)\n                Destination.Cells(Row, 2).Value2 = Data(Index, 2)\n                Destination.Cells(Row, 3).Value2 = Data(Index, 3)\n                Destination.Cells(Row, 4).Value2 = Data(Index, 4)\n                Destination.Cells(Row, 5).Value2 = Data(Index, 5)\n                Row = Row + 1\n            End If\n        Next Index\n\n    End With\n    Set Records = Nothing\n\nEnd Sub\n\nFunction removeDuplicates(values As String)\n    Dim v As Variant\n    Dim d As Object\n    Set d = CreateObject(\"Scripting.Dictionary\")\n\n    For Each v In Split(values, \",\")\n        If v &lt;&gt; \"\" Then d(v) = 1\n    Next\n\n    removeDuplicates = Join(d.Keys, \", \")\n\n    Set d = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 6294766, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb33d1ed1925238bb66ef1ba279b062e?s=128&d=identicon&r=PG&f=1", "display_name": "llorcs", "link": "https://stackoverflow.com/users/6294766/llorcs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 1, "accepted_answer_id": 38741396, "answer_count": 2, "score": 0, "last_activity_date": 1470221207, "creation_date": 1470216801, "last_edit_date": 1470216872, "question_id": 38739758, "link": "https://stackoverflow.com/questions/38739758/vba-deleting-duplicate-rows-and-merging-cells-with-unique-data", "title": "VBA - Deleting duplicate rows and merging cells with unique data", "body": "<p>I have would like some help regarding the following problem. Every quarter we a have excel sheets sent to us with client info containing rows often more than a 1000. I've managed to write a code that deletes duplicate rows that are a 100% match, however, a considerable portion still remains due to the following:</p>\n\n<p><img src=\"https://i.stack.imgur.com/8w98l.png\" alt=\"enter image description here\"></p>\n\n<p>A new code I have found kinda works, however I would need some help tweaking it, as it does the following:\n<img src=\"https://i.stack.imgur.com/SycO9.png\" alt=\"enter image description here\"></p>\n\n<p>It deletes the duplicate and merges the cells, however, if one cell value (in this case Marketing) appears both times it keeps it twice. Also, it does not retain other info like mail/name/phone etc.</p>\n\n<p>Here's the code itself:</p>\n\n<pre><code>Sub Main()\nDim Source As Worksheet: Set Source = ThisWorkbook.Worksheets(\"Sheet1\")\nDim Destination As Worksheet: Set Destination = ThisWorkbook.Worksheets(\"Sheet2\")\n\nDim Records As Object: Set Records = CreateObject(\"Scripting.Dictionary\")\n\nDim Data As Variant\nDim Index As Long\nDim Row As Integer: Row = 1\n\nData = Source.Range(\"A1\", \"E\" &amp; Source.Rows(Source.UsedRange.Rows.Count).Row).Value2\n\nFor Index = LBound(Data, 1) To UBound(Data, 1)\nIf Records.Exists(Data(Index, 1)) Then\n    Destination.Cells(Records(Data(Index, 1)), 5).Value2 = Destination.Cells(Records(Data(Index, 1)), 5).Value2 &amp; \", \" &amp; Data(Index, 5)\nElse\n    Records.Add Data(Index, 1), Row\n    Destination.Cells(Row, 1).Value2 = Data(Index, 1)\n    Destination.Cells(Row, 5).Value2 = Data(Index, 5)\n    Row = Row + 1\nEnd If\nNext Index\n\nSet Records = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I was wondering if there is a way to tackle this problem, or is it too complicated? If the latter, no problems, only deleting the duplicates works fine and reduces work hours a lot.</p>\n\n<p>Thank you for any input and comment!</p>\n"}, {"tags": ["vba", "ms-word", "macros"], "comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1470221814, "post_id": 38739331, "comment_id": 64857038, "body": "Where is the other question peterv? It would be better if we could see that code and and fix that problem."}, {"owner": {"reputation": 87, "user_id": 4045481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/980197bfbe13208d76b7140fc29ce3f6?s=128&d=identicon&r=PG&f=1", "display_name": "peterv", "link": "https://stackoverflow.com/users/4045481/peterv"}, "reply_to_user": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1470224148, "post_id": 38739331, "comment_id": 64858605, "body": "Sorry, couldn&#39;t post two questions at the same time. It&#39;s here: <a href=\"http://stackoverflow.com/questions/38742435/some-characters-lose-formatting-in-vba-macro-others-dont\" title=\"some characters lose formatting in vba macro others dont\">stackoverflow.com/questions/38742435/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1470225593, "post_id": 38742967, "comment_id": 64859655, "body": "Moving onto your <a href=\"http://stackoverflow.com/questions/38742435/some-characters-lose-formatting-in-vba-macro-others-dont\">other question</a> now."}, {"owner": {"reputation": 87, "user_id": 4045481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/980197bfbe13208d76b7140fc29ce3f6?s=128&d=identicon&r=PG&f=1", "display_name": "peterv", "link": "https://stackoverflow.com/users/4045481/peterv"}, "edited": false, "score": 0, "creation_date": 1470227104, "post_id": 38742967, "comment_id": 64860793, "body": "This works well, thanks; but it is restricted to the main body of the text, in the footnotes, nothing has changed. What would be the best way to make this macro work also in footnotes (and headers)?"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 87, "user_id": 4045481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/980197bfbe13208d76b7140fc29ce3f6?s=128&d=identicon&r=PG&f=1", "display_name": "peterv", "link": "https://stackoverflow.com/users/4045481/peterv"}, "edited": false, "score": 0, "creation_date": 1470228516, "post_id": 38742967, "comment_id": 64861932, "body": "From memory you have enter the footnote section (i.e. move the selection into it) and then repeat, same goes for endnotes and I can&#39;t remember if you have to do each footnote/endnote individually. I do remember it&#39;s a pain. That wasn&#39;t part of the question (i&#39;d probably walk away if I had to answer that to fo you!) but what I have done should be enough to adapt."}, {"owner": {"reputation": 87, "user_id": 4045481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/980197bfbe13208d76b7140fc29ce3f6?s=128&d=identicon&r=PG&f=1", "display_name": "peterv", "link": "https://stackoverflow.com/users/4045481/peterv"}, "edited": false, "score": 1, "creation_date": 1470229642, "post_id": 38742967, "comment_id": 64862852, "body": "using this trick (<a href=\"http://word.mvps.org/faqs/customization/ReplaceAnywhere.htm\" rel=\"nofollow noreferrer\">word.mvps.org/faqs/customization/ReplaceAnywhere.htm</a>) helped me apply your solution to all story ranges (incl. footnotes and headers): Dim myStoryRng As Range For Each myStoryRng In ActiveDocument.StoryRanges     Debug.Print myStoryRng     myStoryRng.Select     Set ThisRng = Selection         Set WdSlct = Selection         WdSlct.SetRange 0, 0         Set WdFnd = WdSlct.Find etc."}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": true, "score": 0, "last_activity_date": 1470232089, "last_edit_date": 1470232089, "creation_date": 1470225435, "answer_id": 38742967, "question_id": 38739331, "link": "https://stackoverflow.com/questions/38739331/ms-word-macro-to-correct-partially-formatted-words/38742967#38742967", "title": "MS Word macro to correct partially formatted words", "body": "<p>The below code answers the question of 'find all words that have at least one letter in italics, and apply italics formatting to all those words'</p>\n\n<p>I've added comments to describe what is happening. I've automated Word a lot and I find it to have a lot of quirks, so the below worked in a simple test but you should test thoroughly before releasing code into the wild.  </p>\n\n<pre><code>Public Sub Sample()\nDim WdDoc   As Word.Document\nDim WdSlct  As Word.Selection\nDim WdFnd   As Word.Find\nSet WdDoc = ThisDocument\n    WdDoc.Content.Select\n    Set WdSlct = Selection\n        WdSlct.SetRange 0, 0\n        Set WdFnd = WdSlct.Find\n\n            'Clear any previous find settings\n            WdFnd.ClearAllFuzzyOptions\n            WdFnd.ClearFormatting\n            WdFnd.ClearHitHighlight\n\n            'Set the find to look for italic text\n            WdFnd.Font.Italic = True\n\n            'Look for any italic character\n            Do Until Not WdFnd.Execute(FindText:=\"?\", MatchWildcards:=True, Forward:=True, Wrap:=wdFindStop, Format:=True, Replace:=wdReplaceNone)\n\n                'Expand the selection to the whole word\n                WdSlct.Expand wdWord\n\n                'Set the word to be italic\n                WdSlct.Font.Italic = True\n\n                'Move past the word\n                WdSlct.SetRange WdSlct.End, WdSlct.End\n            Loop\n        Set WdFnd = Nothing\n    Set WdSlct = Nothing\nSet WdDoc = Nothing\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Adapted from edit request from @peterv (the OP)</p>\n\n<p>To make this work in footnotes, headers and other storyranges, I adapted Gary's solution by combining it with <a href=\"http://word.mvps.org/faqs/customization/ReplaceAnywhere.htm\" rel=\"nofollow\">this trick</a>: </p>\n\n<pre><code>Sub RemedyPartialItalics()\nDim WdDoc   As Word.Doc\nDim WdFnd   As Word.Find\nDim WdRng   As Word.Range\nDim WdSlct  As Word.Selection\nSet WdDoc = ActiveDocument\n    For Each WdRng In WdDoc.StoryRanges\n        wdRng.Select\n        Set WdSlct = Selection\n            WdSlct.SetRange 0, 0\n            Set WdFnd = WdSlct.Find\n                WdFnd.ClearAllFuzzyOptions\n                WdFnd.ClearFormatting\n                WdFnd.ClearHitHighlight\n                WdFnd.Font.Italic = True\n                Do Until Not WdFnd.Execute(FindText:=\"?\", MatchWildcards:=True, Forward:=True, Wrap:=wdFindStop, Format:=True, Replace:=wdReplaceNone)\n                    WdSlct.Expand wdWord\n                    WdSlct.Font.Italic = True\n                    WdSlct.SetRange WdSlct.End, WdSlct.End\n                Loop\n            Set WdFnd = Nothing\n        Set WdSlct = Nothing\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 4045481, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/980197bfbe13208d76b7140fc29ce3f6?s=128&d=identicon&r=PG&f=1", "display_name": "peterv", "link": "https://stackoverflow.com/users/4045481/peterv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 38742967, "answer_count": 1, "score": 0, "last_activity_date": 1470232089, "creation_date": 1470215685, "last_edit_date": 1495542166, "question_id": 38739331, "link": "https://stackoverflow.com/questions/38739331/ms-word-macro-to-correct-partially-formatted-words", "title": "MS Word macro to correct partially formatted words", "body": "<p>I made a macro that replaces all characters in a text, from old transcription fonts to a unicode font. I don't know why, but some characters keep the original formatting, while others lose the formatting (in my case, mostly italics), often within the same word. This leaves me with a lot of words in which some letters are italicized, and other letters aren't (e.g., \"<em>al-Malik al-Mu</em>\u01e7\u0101<em>hid \u1e2bu</em>\u1e6d<em>ba</em>\"). The characters that lose the formatting are all characters with diacritics, but not all characters with diacritics lose their formatting (e.g., the \u1e2b in the example). </p>\n\n<p>What would be the best way to find all words that have at least one letter in italics, and apply italics formatting to all those words?</p>\n\n<p>If someone could point me to a solution for the original problem, that would of course be even better (but that is the subject of another question: <a href=\"https://stackoverflow.com/questions/38742435/some-characters-lose-formatting-in-vba-macro-others-dont\">some characters lose formatting in vba macro others don&#39;t</a>). </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1470214618, "post_id": 38738783, "comment_id": 64852271, "body": "What is pColumnLabels?"}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1470216468, "post_id": 38738783, "comment_id": 64853609, "body": "@Nathan_Sav <code>Private pColumnLabels() As MSForms.Label</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1470216822, "post_id": 38738783, "comment_id": 64853845, "body": "Is this defined to hold the labels, i.e. does an index of x exist in this array? as it&#39;s defined empty  check if index&lt;=ubound(pcolumnlabels)"}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1470217882, "post_id": 38738783, "comment_id": 64854497, "body": "I do the checks in <code>&#39;some irrelevant code here</code> section to ensure proper array size."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1470217905, "post_id": 38738783, "comment_id": 64854515, "body": "and you redim it then?  so it has to have GET called before SET will work I think"}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1470218080, "post_id": 38738783, "comment_id": 64854625, "body": "I initialise the array with the class initialisation to give it 1 label space (ie. <code>ReDim pColumnLabels(0)</code> as it will always hold at least 1 column. Afterwards every time I GET I make sure that it is not out of bounds, and in case of SET I ReDim Preserve to extend the columns if needed. The problem is the Set with those 2 arguments is throwing the error I mentioned."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1470220448, "creation_date": 1470220448, "answer_id": 38741123, "question_id": 38738783, "link": "https://stackoverflow.com/questions/38738783/property-procedure-definitions-inconsistent-get-and-set-vba/38741123#38741123", "title": "Property procedure definitions inconsistent - Get and Set VBA", "body": "<p>The set to parameter needs to be last, this I got working</p>\n\n<pre><code>Option Explicit\n\nPrivate pColumnLabels() As MSForms.Label\n\nPublic Property Get columnx(i As Integer) As MSForms.Label\n    Set columnx = pColumnLabels(i)\nEnd Property\n\nPublic Property Set columnx(i As Integer, lbl As MSForms.Label)\n    Set pColumnLabels(i) = lbl\nEnd Property\n</code></pre>\n"}], "owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 38741123, "answer_count": 1, "score": 0, "last_activity_date": 1470220448, "creation_date": 1470214205, "last_edit_date": 1470218411, "question_id": 38738783, "link": "https://stackoverflow.com/questions/38738783/property-procedure-definitions-inconsistent-get-and-set-vba", "title": "Property procedure definitions inconsistent - Get and Set VBA", "body": "<p>Error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VrNDE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VrNDE.png\" alt=\"enter image description here\"></a></p>\n\n<p>Code:</p>\n\n<pre><code>Private pColumnLabels() As MSForms.Label\n\nPublic Property Get Column(Index As Integer) As MSForms.Label\n    'some irrelevant code here\n    Set Column = pColumnLabels(Index)\nEnd Property\n\nPublic Property Set Column(lbl As MSForms.Label, Index As Integer) &lt;--- errornous line\n    Set pColumnLabels(Index) = lbl\nEnd Property\n</code></pre>\n\n<p>Basically I'm creating something similar to ListBox control (but with the ability to adjust specific cells to my liking, e.g. background color, font etc) and so each of my rows has multiple columns. I create labels elsewhere and then I want to assign these labels to the array that holds it for each row. </p>\n\n<p>Given index, I want to return (<code>Get</code>) the label for that specific column, such that for example <code>row.Column(0).caption</code> would return caption for the given column.</p>\n\n<p>Provided label and index will <code>Set</code> the label to that specific row, such that: <code>Set row.Column(0) = someLabel</code>. I can see why the Set is wrong, ie. I should be doing something like <code>Set row.Column = {someLabel, 0}</code>, but that's not possible in VBA.</p>\n\n<p>Any suggestion how to make this neat? I know I can create a function that will be passing the parameters, ie something like:</p>\n\n<pre><code>Public Function passParams(lbl as MSForms.Label, Index as Integer)\n    Set pColumnLabels(Index) = lbl\nEnd Function\n</code></pre>\n\n<p>But then I don't get the nice functionality of being able to do the examples I provided above, that is, instead of:</p>\n\n<pre><code>row.Column(0).caption         'get\nSet row.Column(0) = someLabel 'set\n</code></pre>\n\n<p>I would have to do</p>\n\n<pre><code>row.Column(0).caption             'get\nCall row.passParams(someLabel, 0) 'set\n</code></pre>\n"}, {"tags": ["vba", "excel", "parsing", "yaml"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1470213463, "post_id": 38738162, "comment_id": 64851519, "body": "Most likely not. If you are on 32bit, then by using scriptcontrol, you can try to leverage the JS-YAML library. more robust and flexible way will be a C#Com dll. But anyways, there&#39;s nothing ready made, so you will have to write it yourself."}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470213613, "post_id": 38738162, "comment_id": 64851604, "body": "If so, how can i write a parser? what tools should I use to wrote an parser? What language should I use to create it and how do I import in excel vba?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1470214072, "post_id": 38738162, "comment_id": 64851907, "body": "I have nothing for YAML but see this link <a href=\"http://ashuvba.blogspot.com/2014/09/json-parser-in-vba-browsing-through-net.html?m=1\" rel=\"nofollow noreferrer\">ashuvba.blogspot.com/2014/09/&hellip;</a> as it uses scriptcontrol to crate json parser in Vba"}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470214789, "post_id": 38738162, "comment_id": 64852398, "body": "I see, so this scriptcontrol doesn&#39;t work for 64 bit systems? How do I create C#Com dll, do I need Visual Studio, or is there any open source way to do the same?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1470215327, "post_id": 38738162, "comment_id": 64852765, "body": "Yes 32 bit only. No offense but how good are you in c#? Don&#39;t rush. Having visual studio is the best option when writing office related COMs.  You can try sharp develop but its bit tricky when it comes to office related development. Anyways you can find a com tutorial too in my blog. Have a look."}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470216190, "post_id": 38738162, "comment_id": 64853416, "body": "I have never used C#, but I guess it might be similar to Java, which I am good at. Sure, I will check your blog, thanks for writing."}, {"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470217396, "post_id": 38738162, "comment_id": 64854181, "body": "I was wondering if I can use Arrays and Hash available in Excel VBA itself to create a Hash of Hash. I am not able to store references to a Dictionary and get value of a reference. Is that possible? What will be the challenges I need to face in this approach?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1470218419, "post_id": 38738162, "comment_id": 64854859, "body": "In Vba dictionary has no data type boundation. Unlike collections, in dicts you can store objects/refs."}], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 1862421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78dde6970e3ad20bbc4326772a5111f6?s=128&d=identicon&r=PG", "display_name": "cgasp", "link": "https://stackoverflow.com/users/1862421/cgasp"}, "is_accepted": false, "score": 0, "last_activity_date": 1479398925, "creation_date": 1479398925, "answer_id": 40659701, "question_id": 38738162, "link": "https://stackoverflow.com/questions/38738162/yaml-parser-for-excel-vba/40659701#40659701", "title": "YAML Parser for Excel VBA", "body": "<p>I tried to found a ready to use solution and found none. \nI made something usable. It is not pure YAML interpreter but can parse key:value data. </p>\n\n<p><em>Function VBA ParseYAML</em>   </p>\n\n<pre><code>Sub ParseYAML()\nDim myFile As String, text As String, textline As String\n' open YAML file\nmyFile = Application.GetOpenFilename()\n' verify if a file were open\nIf Not myFile = \"Falsch\" Then\n    Open myFile For Input As #1\n    Dim dataArray\n    Dim c As Collection\n    Set c = New Collection\n    Line = 0\n    Do Until EOF(1)\n        Line Input #1, textline\n        oneline = Replace(textline, \" \", \"\")\n        dataArray = Split(oneline, \":\", 2)\n        sizeArray = UBound(dataArray, 1) - LBound(dataArray, 1) + 1\n        ' Verification Empty Lines and Split don't occur\n        If Not textline = \"\" And Not sizeArray = 0 Then\n            Data = dataArray(1)\n            Key = dataArray(0)\n            ' test if line don't start with -\n            If InStr(1, Key, \"-\") = 0 Then\n                c.Add Data, Key\n            End If\n            ' just for debug\n            Line = Line + 1\n            'text = text &amp; textline\n        End If\n    Loop\n    Close #1\n\n    Range(\"D6\").Value = c.Item(\"key1\")\n    Range(\"D7\").Value = c.Item(\"key2\")\n    Range(\"C18\").Value = c.Item(\"key3\")\n    Set c = Nothing\nEnd If   \nEnd Sub\n</code></pre>\n\n<p><em>Example of YAML file</em></p>\n\n<blockquote>\n  <p>- section1:<br>\n      key1:data1<br>\n      key2:data2<br>\n  - section2:<br>\n      key3:data3  </p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12640986, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCar1N6TcCfRrDFF3mCnjjXnNwadEfZn4ombAVVzw=k-s128", "display_name": "mitz", "link": "https://stackoverflow.com/users/12640986/mitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1605240248, "creation_date": 1605240248, "answer_id": 64815317, "question_id": 38738162, "link": "https://stackoverflow.com/questions/38738162/yaml-parser-for-excel-vba/64815317#64815317", "title": "YAML Parser for Excel VBA", "body": "<p>If using cJObject.cls, we can convert a yaml file to cJObject.</p>\n<p><a href=\"https://medium.com/@sakai.memoru/convert-a-yaml-file-to-cjobject-in-vba-2fee22e85818\" rel=\"nofollow noreferrer\">https://medium.com/@sakai.memoru/convert-a-yaml-file-to-cjobject-in-vba-2fee22e85818</a></p>\n<p>Example YAML file</p>\n<pre><code># YAML\nmartin:\n    name: Martin Jobson\n    job: Developer\n    skills:\n        - fortran\n        - lisp\n        - erlang\n</code></pre>\n<p>Code sample</p>\n<pre><code>Sub TestYaml2Json()\n'''' *********************************************\n''\nDim objYaml As O_YAML\nSet objYaml = New O_YAML\n''\nDim file_name As String\nLet file_name = &quot;input/yamlformat.yaml&quot;\n''\nDim jObj As cJobject\nSet jObj = New cJobject\n''\nSet jObj = objYaml.YamlFileToJObject(file_name)\nConsole.info jObj.formatData\nConsole.info jObj.serialize\n''\nEnd Sub\n</code></pre>\n<p>immediate windows</p>\n<pre><code>{\u201cmartin\u201d:{\u201cname\u201d:\u201dMartin Jobson\u201d,\u201djob\u201d:\u201dDeveloper\u201d,\u201dskills\u201d:[\u201cfortran\u201d,\u201dlisp\u201d,\u201derlang\u201d ]}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 1146659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d556bc2eb929df9c31c85ce284065acc?s=128&d=identicon&r=PG", "display_name": "seakintruth", "link": "https://stackoverflow.com/users/1146659/seakintruth"}, "is_accepted": false, "score": 0, "last_activity_date": 1613676659, "last_edit_date": 1613676659, "creation_date": 1612905046, "answer_id": 66127204, "question_id": 38738162, "link": "https://stackoverflow.com/questions/38738162/yaml-parser-for-excel-vba/66127204#66127204", "title": "YAML Parser for Excel VBA", "body": "<p>Expanding on <a href=\"https://stackoverflow.com/users/1862421/cgasp\">cgasp</a>'s <a href=\"https://stackoverflow.com/a/40659701/1146659\">answer</a> this function kind of handles nesting and loads a YAML file into an array, additionally it can run in VBA, VBS, HTA contexts.</p>\n<pre><code>Public Function ParseYAMLtoArray(ByVal filePath) ' as array\n' Version 1.0.4\n' Dependencies: NONE\n' Modified from this post: https://stackoverflow.com/a/40659701/1146659\n' License: - CC BY-SA 4.0 - &lt;https://creativecommons.org/licenses/by-sa/4.0/&gt;\n' Contributors: cgasp &lt;https://stackoverflow.com/users/1862421/cgasp&gt;; Jeremy D. Gerdes &lt;jeremy.gerdes@navy.mil&gt;;\n' Reference: https://yaml.org/refcard.html\n' Usage Example: debug.print ParseYAMLtoArray(GetCurrentFileFolder() &amp; &quot;\\&quot; &amp; &quot;documentation&quot; &amp; &quot;\\&quot; &amp; &quot;exampleNested.yaml&quot;)(1,3)\n' Notes: Using late binding to run for all vb engines\n' -------------------------------\n' Known ParserIssues:\n'   - Niave: This is not spec conforming, just usefull enough, use another parser if you need more features.\n'     See spec at: http://yaml.org/spec/1.2/spec.html\n'   - A block scalar indicator should include all subsequent rows that have the same white space intentation past the current line\n'     this parser fails to do this if any of those following row contains a &quot;:&quot;\n'   - YAML denotes nesting via indent delimitation (white space), this parser attempts to record nested &quot;{level=n}&quot; in the data\n'     column for each empty Category, and ignores all other nesting.\n'   -This parser ignores all cast data types like &quot;!!float &quot; whatever is accepting the results of this Public Function will\n'     have to handle any type casting in the YAML document.\n\nConst ForReading = 1\nDim arryReturn() ' As variant\nDim text ' As String\nDim textline ' As String\nDim objFSO 'As Scripting.FileSystemObject\nDim objFile 'As Scripting.TextStream\nDim intLastLineWhiteSpace 'As Integer\nDim dataArray 'As Variant\nDim sizeArray 'As Long\nDim oneline 'As String\nDim Data 'As Variant\nDim Key 'As Variant\nDim intRow 'as integer\nDim intColumn 'as integer\nDim intNestingLevel 'As Integer\nDim intLastNestingSpaces 'As Integer\nDim intCurrentNestingSpaces 'As Integer\nDim intThisLineWhiteSpace\nDim fIsNestedHeader\n    Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;)\n    ' verify if file exists\n    If objFSO.FileExists(filePath) Then\n        Set objFile = objFSO.GetFile(filePath).OpenAsTextStream(ForReading)\n        'Open FilePath For Input As #1\n        intRow = 0\n        intNestingLevel = 1\n        Do Until objFile.AtEndOfStream\n            intThisLineWhiteSpace = Len(textline) - Len(LTrim(textline))\n            textline = objFile.ReadLine\n            oneline = Trim(textline) 'remove leading/trailing spaces\n            ' test if line doesn't start with --- or #\n            If Left(oneline, 3) &lt;&gt; &quot;---&quot; And Left(oneline, 1) &lt;&gt; &quot;#&quot; Then\n                dataArray = Split(oneline, &quot;:&quot;, 2)\n                sizeArray = UBound(dataArray, 1) - LBound(dataArray, 1) + 1\n                ' Verification Empty Lines and Split don't occur\n                If Not Len(oneline) = 0 And Not sizeArray = 0 Then\n                    fIsNestedHeader = False\n                    If sizeArray = 1 And intThisLineWhiteSpace &gt; intLastLineWhiteSpace Then  ' HEADER\n                        fIsNestedHeader = True\n                    ElseIf sizeArray = 2 Then  ' HEADER: &lt;NULL&gt;\n                        fIsNestedHeader = Len(Trim(dataArray(0))) &lt;&gt; 0 And Len(Trim(dataArray(1))) = 0\n                    End If\n                    If sizeArray = 1 And intThisLineWhiteSpace &gt;= intLastLineWhiteSpace And Len(Trim(dataArray(0))) &gt; 0 Then ' semicolins in a block breaks this parser\n                        'assume we are continuing the data from previous line\n                        intRow = intRow - 1 ' use previous row in the array\n                        Data = Trim(dataArray(0))\n                        'remove leading block annotation | or &gt;\n                        If arryReturn(1, intRow) = &quot;|&quot; Or arryReturn(1, intRow) = &quot;&gt;&quot; Then\n                            If Len(arryReturn(1, intRow)) = 1 Then\n                                arryReturn(1, intRow) = vbNullString\n                            Else\n                                arryReturn(1, intRow) = Right(arryReturn(1, intRow), Len(arryReturn(1, intRow) - 1))\n                            End If\n                        End If\n                        arryReturn(1, intRow) = arryReturn(1, intRow) &amp; vbCrLf &amp; Data\n                    ElseIf fIsNestedHeader Then\n                        'Category/Header\n                        Key = Trim(dataArray(0))\n                        ReDim Preserve arryReturn(1, intRow)\n                        arryReturn(0, intRow) = Key\n                        ' calculate nesting level - just kind of works,\n                        ' doesn't really map to what's in the YAML as nesting back up is actually dependent on the number of spaces not previous nesting...\n                        intCurrentNestingSpaces = intThisLineWhiteSpace\n                        If intThisLineWhiteSpace = 0 Then\n                            'We are back at level 1\n                            intNestingLevel = 1\n                        Else\n                            If intCurrentNestingSpaces &gt; intLastNestingSpaces Then\n                                intNestingLevel = intNestingLevel + 1\n                            ElseIf intCurrentNestingSpaces &lt; intLastNestingSpaces Then\n                                intNestingLevel = intNestingLevel - 1\n                            'Else 'should be equal so intNestingLevel, stays the same\n                                'intCurrentNestingSpaces = intLastNestingSpaces\n                            End If\n                        End If\n                        arryReturn(1, intRow) = &quot;{level=&quot; &amp; intNestingLevel &amp; &quot;}&quot;\n                        intLastNestingSpaces = intThisLineWhiteSpace\n                    Else\n                        Data = Trim(dataArray(1))\n                        Key = Trim(dataArray(0))\n                        ReDim Preserve arryReturn(1, intRow)\n                        arryReturn(0, intRow) = Key\n                        arryReturn(1, intRow) = Data\n                    End If\n                    intRow = intRow + 1\n                End If\n            End If\n            intLastLineWhiteSpace = Len(textline) - Len(LTrim(textline))\n        Loop\n        objFile.Close\n        Dim arryReturnTemp\n        'Must build array in Array(column,row) format to be able to append rows in VBScript, now transform to the standard Array(row,column) format\n        If TransposeArray(arryReturn, arryReturnTemp) Then\n            ParseYAMLtoArray = arryReturnTemp\n        Else\n            Err.Raise vbObjectError + 667, &quot;ParseYAML&quot;, &quot;Failed to Transform array&quot;\n        End If\n    Else\n        Err.Raise vbObjectError + 666, &quot;ParseYAML&quot;, &quot;Config file not found&quot;\n    End If\nEnd Function\n\nPublic Function TransposeArray(ByRef InputArr, ByRef OutputArr) 'As Variant, ByRef OutputArr As Variant) As Boolean\n    ' Version 1.0.0\n    ' Dependencies: NONE\n    ' Note: The following Public Function has been modified by jeremy.gerdes@navy.mil to conform to VBScipt from:\n    '   http://www.cpearson.com/excel/vbaarrays.htm\n    ' License: Charles H. Pearson. All of the formulas and VBA code are explicitly granted to the Public Domain. You may use the formulas and VBA code on this site for any purpose you see fit without permission from me. This includes inclusion in commercial works and works for hire. By using the formula and code on this site, you agree to hold Charles H. Pearson and Pearson Software Consulting, LLC, free of any liability. The formulas and code are presented as is and the author makes no warranty, express or implied, of their fitness for use. You assume all responsibility for testing and ensuring that the code works properly in your environment\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    ' TransposeArray\n    ' This transposes a two-dimensional array. It returns True if successful or\n    ' False if an error occurs. InputArr must be two-dimensions. OutputArr must be\n    ' a dynamic array. It will be Erased and resized, so any existing content will\n    ' be destroyed.\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n    Dim RowNdx ' As Long\n    Dim ColNdx ' As Long\n    Dim LB1  ' As Long\n    Dim LB2 ' As Long\n    Dim UB1 ' As Long\n    Dim UB2 ' As Long\n\n    '''''''''''''''''''''''''''''''''''\n    ' Ensure InputArr is an array\n    '''''''''''''''''''''''''''''''''''\n    If (IsArray(InputArr) = False) Then\n        TransposeArray = False\n        Exit Function\n    End If\n\n    '''''''''''''''''''''''''''''''''''''''\n    ' Get the Lower and Upper bounds of\n    ' InputArr.\n    '''''''''''''''''''''''''''''''''''''''\n    LB1 = LBound(InputArr, 1)\n    LB2 = LBound(InputArr, 2)\n    UB1 = UBound(InputArr, 1)\n    UB2 = UBound(InputArr, 2)\n\n    '''''''''''''''''''''''''''''''''''''''''\n    ' Erase and ReDim OutputArr\n    '''''''''''''''''''''''''''''''''''''''''\n    On Error Resume Next\n    'If it's an array empty it, if not then it's empty\n    Erase OutputArr\n    On Error GoTo 0\n    'In VBS we can't ReDim Array(LowBound To HighBound) all arrays must conform to Lbound = 0\n    If LB1 &lt;&gt; 0 Or LB2 &lt;&gt; 0 Then\n        TransposeArray = False\n        Exit Function\n    End If\n\n\n    ReDim OutputArr(UB2, UB1)\n\n    For RowNdx = LBound(InputArr, 2) To UBound(InputArr, 2)\n        For ColNdx = LBound(InputArr, 1) To UBound(InputArr, 1)\n            OutputArr(RowNdx, ColNdx) = InputArr(ColNdx, RowNdx)\n        Next ' ColNdx\n    Next ' RowNdx\n\n    TransposeArray = True\n\nEnd Function\n</code></pre>\n<p>YAML will parse better into a Dictionary or Collection then an array, the above solution was created to run in Scripts but will still work in Excel.</p>\n<h2>Example</h2>\n<p>To use this function in excel we can map arrays directly to a ranges values like this:</p>\n<pre><code>Public Sub ToolTestImportYaml(strYamlFilePath As String, rngDestination As Range)\nDim arryYaml As Variant\nDim rngDestinationReturn As Range\n    arryYaml = ParseYAMLtoArray(strYamlFilePath)\n    rngDestination.Worksheet.Activate\n    rngDestination.Activate\n    Set rngDestinationReturn = rngDestination.Worksheet.Range( _\n        rngDestination.Address, _\n        rngDestination.Offset( _\n            UBound(arryYaml, 1) - LBound(arryYaml, 1), _\n            UBound(arryYaml, 2) - LBound(arryYaml, 2) _\n        ).Address _\n    )\n    'Assign the values to the destination range\n    rngDestinationReturn.Value = arryYaml\nEnd Sub\n</code></pre>\n<p>And call with:</p>\n<pre><code>ToolTestImportYaml ThisWorkbook.path &amp; &quot;\\&quot; &amp; &quot;exampleNested.yaml&quot;, ActiveSheet.Range(&quot;a1&quot;)\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3037, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1613676659, "creation_date": 1470212366, "question_id": 38738162, "link": "https://stackoverflow.com/questions/38738162/yaml-parser-for-excel-vba", "title": "YAML Parser for Excel VBA", "body": "<p>I have some YAML files and I need to populate those data in Excel using MS Excel Macros. I am able to read YAML files and try to read line by line and find the semantics. But the process is getting more and more complex. I am looking for an alternative solution.</p>\n\n<p>Is there a YAML Parser for Excel VBA? If so, can you suggest few? I need this YAML in a Hash of Hash format, so that I can access the YAML data in hash of Hash format? </p>\n\n<p>Thanks\nJeevan</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1470209470, "post_id": 38736910, "comment_id": 64849123, "body": "Since you are starting, here are few tips... 1. <code>CountIf</code> is an unreliable way to find last row. You may want to see <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920\">This</a> 2. Avoid the use of <code>.Select</code>. You may want to see <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">This</a>. 3. You can enter formulas in a range in one go if they are contiguous. You do not need to do that individually."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470214533, "post_id": 38736910, "comment_id": 64852222, "body": "For Bloomberg the best approach is to call the function in Vba by passing array, store the return values in another array and just dump the resulting array on report sheet/ data sheet. Avoid writing a lot of formulas in cells. Specially BDH is async, down the line it will become pretty messy to manage."}, {"owner": {"reputation": 3, "user_id": 6670990, "user_type": "registered", "profile_image": "https://graph.facebook.com/1387549147928131/picture?type=large", "display_name": "Peteris Celms", "link": "https://stackoverflow.com/users/6670990/peteris-celms"}, "edited": false, "score": 0, "creation_date": 1470217615, "post_id": 38736910, "comment_id": 64854320, "body": "Thanks, I&#39;ll keep this in mind in the future!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6670990, "user_type": "registered", "profile_image": "https://graph.facebook.com/1387549147928131/picture?type=large", "display_name": "Peteris Celms", "link": "https://stackoverflow.com/users/6670990/peteris-celms"}, "edited": false, "score": 0, "creation_date": 1470213695, "post_id": 38737057, "comment_id": 64851658, "body": "Great, thanks a lot for your help! The function executes in seconds now!"}], "tags": [], "owner": {"reputation": 128, "user_id": 5049784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5oJ5s.png?s=128&g=1", "display_name": "ManInTheMiddle", "link": "https://stackoverflow.com/users/5049784/maninthemiddle"}, "is_accepted": true, "score": 0, "last_activity_date": 1470209212, "creation_date": 1470209212, "answer_id": 38737057, "question_id": 38736910, "link": "https://stackoverflow.com/questions/38736910/shortening-the-runtime-of-vba-macro/38737057#38737057", "title": "Shortening the runtime of VBA macro", "body": "<p>Set below the Sub New_monthly() function the following line:</p>\n\n<pre><code>Application.ScreenUpdating = False\n</code></pre>\n\n<p>and in the end of you function set it on <code>Application.ScreenUpdating = True</code>.</p>\n\n<p>In this link you will get some advices for improve your Performance:</p>\n\n<p><a href=\"http://datapigtechnologies.com/blog/index.php/ten-things-you-can-do-to-speed-up-your-excel-vba-code/\" rel=\"nofollow\">http://datapigtechnologies.com/blog/index.php/ten-things-you-can-do-to-speed-up-your-excel-vba-code/</a></p>\n"}, {"comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1470213938, "post_id": 38738422, "comment_id": 64851823, "body": "psst, you forgot to turn them back on at the end of the code, your turning them off twice atm ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1470214089, "post_id": 38738422, "comment_id": 64851919, "body": "@DragonSamu Thanks!"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1470216143, "post_id": 38738422, "comment_id": 64853371, "body": "And to be sure you do not mess with other parts of code you should save the  previous values of ScreenUpdating and Calculation and restore the saved values at the end (maybe for some reasons the default value for Calculation was xlCalculationSemiautomatic)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1470218758, "post_id": 38738422, "comment_id": 64855053, "body": "That is actually what I was thinking about when I neglected to re-enable events and calculations.  Stock is the only value taken from the worksheet and all the formulas are absolute; so I think we are good there."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1470214050, "last_edit_date": 1470214050, "creation_date": 1470213153, "answer_id": 38738422, "question_id": 38736910, "link": "https://stackoverflow.com/questions/38736910/shortening-the-runtime-of-vba-macro/38738422#38738422", "title": "Shortening the runtime of VBA macro", "body": "<p>You should turn off ScreenUpdating and Calculations.</p>\n\n<pre><code>Sub New_monthly()\n\n    Dim i As Integer\n    Dim Measure As Integer\n    Dim Count As Integer\n    Dim Stock As Integer\n    Dim Monthend As Long\n\n    Stock = Application.WorksheetFunction.CountIf(Range(\"AP1:AP50\"), \"&gt;0\")\n\n    Monthend = Range(\"AS1\").Value\n\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n    For i = 0 To Stock - 1\n        ' Copy old values and move them over one space\n\n        Range(\"B54:B115\").Offset(i * 115, 0).Select\n        Selection.Insert Shift:=xlToRight\n\n        ' Enter new values\n\n        Cells(108 + i * 115, 2).Value = Monthend\n        Cells(109 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(100 + i * 115, 1).Address &amp; \",\" &amp; Cells(109 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n        Cells(110 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(100 + i * 115, 1).Address &amp; \",\" &amp; Cells(110 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n        Cells(111 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(100 + i * 115, 1).Address &amp; \",\" &amp; Cells(111 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n        Cells(112 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(112 + i * 115, 1).Address &amp; \",\" &amp; Cells(111 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n        Cells(113 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(100 + i * 115, 1).Address &amp; \",\" &amp; Cells(113 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n        Cells(114 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(100 + i * 115, 1).Address &amp; \",\" &amp; Cells(114 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n        Cells(115 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(100 + i * 115, 1).Address &amp; \",\" &amp; Cells(115 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n\n        For Measure = 0 To 5\n\n            Cells(54 + i * 115 + Measure * 9, 3).Value = Monthend\n            For f = 0 To 7\n                Cells(55 + i * 115 + Measure * 9 + f, 3).Formula = \"=BDH(\" &amp; Cells(19 + i * 115 + f, 1).Address &amp; \",\" &amp; Cells(54 + i * 115 + Measure * 9, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n            Next f\n            Cells(57 + i * 115 + Measure * 9, 3).Formula = \"=AVERAGE(\" &amp; Cells(58 + i * 115 + Measure * 9, 3).Address &amp; \":\" &amp; Cells(62 + i * 115 + Measure * 9, 3).Address &amp; \")\"\n        Next Measure\n    Next i\n\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 1, "last_activity_date": 1470221108, "creation_date": 1470221108, "answer_id": 38741369, "question_id": 38736910, "link": "https://stackoverflow.com/questions/38736910/shortening-the-runtime-of-vba-macro/38741369#38741369", "title": "Shortening the runtime of VBA macro", "body": "<p>In addition to what everyone else has said, there is an article here which I found helpful:</p>\n\n<p><a href=\"https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/\" rel=\"nofollow\">https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/</a></p>\n\n<p>Essentially add this at the start of your code:</p>\n\n<pre><code>With Application.Excel\n    .ScreenUpdating = False\n    .DisplayStatusBar = False\n    .Calculation = xlCalculationManual\n    .EnableEvents = False\nEnd With\n</code></pre>\n\n<p>and this at the end:</p>\n\n<pre><code>With Application.Excel\n    .ScreenUpdating = True\n    .DisplayStatusBar = True\n    .Calculation = xlCalculationAutomatic\n    .EnableEvents = True\nEnd With\n</code></pre>\n\n<p>You can also use </p>\n\n<pre><code>ActiveSheet.DisplayPageBreaks = False 'at the beginning and True at the end\n</code></pre>\n\n<p>Personally though I have found that the biggest performance upgrade generally comes with deactivating the calculations.</p>\n"}], "owner": {"reputation": 3, "user_id": 6670990, "user_type": "registered", "profile_image": "https://graph.facebook.com/1387549147928131/picture?type=large", "display_name": "Peteris Celms", "link": "https://stackoverflow.com/users/6670990/peteris-celms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 38737057, "answer_count": 3, "score": 0, "last_activity_date": 1470221108, "creation_date": 1470208727, "last_edit_date": 1531164843, "question_id": 38736910, "link": "https://stackoverflow.com/questions/38736910/shortening-the-runtime-of-vba-macro", "title": "Shortening the runtime of VBA macro", "body": "<p>I'm fairly new to this (started yesterday), so maybe someone has some suggestions. I have created a macro which updates a download sheet with new columns and formulas for monthly values, while leaving the yearly and static values unchanged. The code executes its intended function, but takes almost 30 minutes to cycle through loop through when Stock = 25</p>\n\n<pre><code>Sub New_monthly()\n\n    Dim i As Integer\n\n    Dim Measure As Integer\n\n    Dim Count As Integer\n\n    Dim Stock As Integer\n\n    Dim Monthend As Long\n\n\n    Stock = Application.WorksheetFunction.CountIf(Range(\"AP1:AP50\"), \"&gt;0\")\n\n    Monthend = Range(\"AS1\").Value\n\n\n    For i = 0 To Stock - 1\n        ' Copy old values and move them over one space\n\n        Range(\"B54:B115\").Offset(i * 115, 0).Select\n        Selection.Insert Shift:=xlToRight\n\n        ' Enter new values\n\n        Cells(108 + i * 115, 2).Value = Monthend\n        Cells(109 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(100 + i * 115, 1).Address &amp; \",\" &amp; Cells(109 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n        Cells(110 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(100 + i * 115, 1).Address &amp; \",\" &amp; Cells(110 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n        Cells(111 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(100 + i * 115, 1).Address &amp; \",\" &amp; Cells(111 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n        Cells(112 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(112 + i * 115, 1).Address &amp; \",\" &amp; Cells(111 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n        Cells(113 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(100 + i * 115, 1).Address &amp; \",\" &amp; Cells(113 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n        Cells(114 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(100 + i * 115, 1).Address &amp; \",\" &amp; Cells(114 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n        Cells(115 + i * 115, 2).Formula = \"=BDH(\" &amp; Cells(100 + i * 115, 1).Address &amp; \",\" &amp; Cells(115 + i * 115, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n\n        For Measure = 0 To 5\n            Cells(54 + i * 115 + Measure * 9, 3).Value = Monthend\n            For f = 0 To 7\n                Cells(55 + i * 115 + Measure * 9 + f, 3).Formula = \"=BDH(\" &amp; Cells(19 + i * 115 + f, 1).Address &amp; \",\" &amp; Cells(54 + i * 115 + Measure * 9, 1).Address &amp; \",$AS$1,$AS$1,\"\"DAYS=C\"\")\"\n            Next f\n            Cells(57 + i * 115 + Measure * 9, 3).Formula = \"=AVERAGE(\" &amp; Cells(58 + i * 115 + Measure * 9, 3).Address &amp; \":\" &amp; Cells(62 + i * 115 + Measure * 9, 3).Address &amp; \")\"\n        Next Measure\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1470208782, "post_id": 38736655, "comment_id": 64848738, "body": "are you looking to find the last folder of the open excel file where you want this code ?"}, {"owner": {"reputation": 91, "user_id": 6399647, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b01afc2351152df54a6ca3f50f805f12?s=128&d=identicon&r=PG&f=1", "display_name": "JeanLo", "link": "https://stackoverflow.com/users/6399647/jeanlo"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1470209102, "post_id": 38736655, "comment_id": 64848929, "body": "@ShaiRado    i want to write it in a cell like : thisworkbook.worksheets(&quot;This&quot;).cells(1,1)=&quot;The name of the last folder&quot;"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1470209380, "post_id": 38736655, "comment_id": 64849066, "body": "see my answer below"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1470209350, "creation_date": 1470209350, "answer_id": 38737095, "question_id": 38736655, "link": "https://stackoverflow.com/questions/38736655/vba-find-the-name-of-last-folder/38737095#38737095", "title": "VBA find the name of last folder", "body": "<p>Here is a code that will put the name of <code>ThisWorkbook</code> last folder (from full path) in <strong>Cell A1</strong> in sheet \"<strong><em>This</em></strong>\".</p>\n\n<pre><code>Option Explicit\n\nSub GetLastFolderName()\n\nDim LastFolder                  As String\nDim FullPath                    As String\nDim c                           As Long\n\nFullPath = ThisWorkbook.Path\n\nc = InStrRev(FullPath, \"\\\")\nLastFolder = Right(FullPath, Len(FullPath) - c)\n\nThisWorkbook.Worksheets(\"This\").Cells(1, 1) = LastFolder\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 7, "last_activity_date": 1470209669, "creation_date": 1470209669, "answer_id": 38737220, "question_id": 38736655, "link": "https://stackoverflow.com/questions/38736655/vba-find-the-name-of-last-folder/38737220#38737220", "title": "VBA find the name of last folder", "body": "<p>not tested, quickly written here but you get the idea: </p>\n\n<pre><code>function GetRightFolder(fname) as string\n    dim a\n    a = split(fname, \"\\\")\n    getRightFolder = a(ubound(a)-1)\nend function\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1470212072, "creation_date": 1470212072, "answer_id": 38738061, "question_id": 38736655, "link": "https://stackoverflow.com/questions/38736655/vba-find-the-name-of-last-folder/38738061#38738061", "title": "VBA find the name of last folder", "body": "<p>I included a function to get the files parent folder name and one to get it's path</p>\n\n<ul>\n<li>getParentFolderPath(\"P:\\Folder1..\\Thisfolder\\Test.txt\") : P:\\Folder1..\\Thisfolder</li>\n<li>getParentFolderName(\"P:\\Folder1..\\Thisfolder\\Test.txt\") : Thisfolder</li>\n</ul>\n\n<hr>\n\n<pre><code>Function getParentFolderPath(BasePath As String)\n    getParentFolderPath = Left(BasePath, InStrRev(BasePath, \"\\\") - 1)\nEnd Function\n\nFunction getParentFolderName(BasePath As String)\n    BasePath = Left(BasePath, InStrRev(BasePath, \"\\\") - 1)\n    getParentFolderName = Right(BasePath, Len(BasePath) - InStrRev(BasePath, \"\\\"))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 6399647, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b01afc2351152df54a6ca3f50f805f12?s=128&d=identicon&r=PG&f=1", "display_name": "JeanLo", "link": "https://stackoverflow.com/users/6399647/jeanlo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5144, "favorite_count": 0, "accepted_answer_id": 38737220, "answer_count": 3, "score": 0, "last_activity_date": 1470212072, "creation_date": 1470208015, "last_edit_date": 1470208430, "question_id": 38736655, "link": "https://stackoverflow.com/questions/38736655/vba-find-the-name-of-last-folder", "title": "VBA find the name of last folder", "body": "<p>How can I code a function in VBA that helps me to get the last folder(example: Thisfolder) before the file .</p>\n\n<pre><code>P:\\Folder1\\..\\Thisfolder\\Test.txt\n</code></pre>\n\n<p>I want to just extract : Thisfolder</p>\n"}, {"tags": ["arrays", "excel", "vba", "compilation"], "comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 1, "creation_date": 1470205061, "post_id": 38735283, "comment_id": 64846846, "body": "This has to do with how you bind, see <a href=\"https://support.microsoft.com/en-gb/kb/245115\" rel=\"nofollow noreferrer\">early binding vs late binding</a> for more information."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470205082, "post_id": 38735283, "comment_id": 64846857, "body": "Its 2 am and I am mobile so no code. But all you need to do is use late binding. Search google with excel Vba power point late binding."}], "owner": {"reputation": 11, "user_id": 6670643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd3f786bc27460843c7cb7448ee2ac02?s=128&d=identicon&r=PG&f=1", "display_name": "phoenicopterus", "link": "https://stackoverflow.com/users/6670643/phoenicopterus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1470202921, "creation_date": 1470202921, "question_id": 38735283, "link": "https://stackoverflow.com/questions/38735283/compile-error-with-array-reference", "title": "&quot;Compile Error&quot; with array-reference", "body": "<p>this is my first post on here, so please be gentle if I missed anything or screwed up.</p>\n\n<p>I've been working on an Excel-Tool in Excel 2010 and am currently testing if it also works in Excel 2013. \nMost of it works all fine, but I got one small Problem that confuses me. When I open the file in 2013, enter some data and test it, it runs smoothly; but when I go back to 2010 to use the same file I get the message \"Compile Error: Can't Find Project or Library.\"</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Label1_Click()\n\nIf Application.Sum([ci_pke_cfbiat]) &lt; 0 Then\n     MsgBox (\"With the current numbers, Excel won't be able to calcualte a   valid IRR.\")\nEnd If\n\nCall IRRcalculation(Me.Name)\n\nCall Paybackcalculation(Me.Name)\n\nEnd Sub\n</code></pre>\n\n<p>The highlighted part of the code after I hit the \"debug\" button is the array reference \"[ci_pke_cfbiat]\". Now I already did some research on that matter and looked into the references on both 2010 and 2013, and found that under Excel 2010 it says \"MISSING: Microsoft PowerPoint 15.0 Object Library\". When I deactivated that reference all works as it is supposed to. What I don't understand is why a PowerPoint-Library would cause a problem for my array-references?</p>\n\n<p>Also, is there some \"easy\" way to solve this problem; easier than manually turning that library off everytime I open a file from 2013 in 2010? I already tried some things in the code like using \"VBA.\" instead of \"Application.\" and similar, but that didn't work.</p>\n\n<p>Again sorry if I did anything wrong, and I hope this topic hasn't been discussed somewhere else already; I couldn't find anything related that was really helpful. Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6670582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98eb110cb3df13a077ec8d65e144394e?s=128&d=identicon&r=PG&f=1", "display_name": "user6670582", "link": "https://stackoverflow.com/users/6670582/user6670582"}, "edited": false, "score": 0, "creation_date": 1470218826, "post_id": 38734889, "comment_id": 64855098, "body": "I tried this out and it worked out if it is not drag and drop, but the client wants the worksheet to be a drag and drop type."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 3, "last_activity_date": 1470201249, "creation_date": 1470201249, "answer_id": 38734889, "question_id": 38734811, "link": "https://stackoverflow.com/questions/38734811/excel-comparing-multiple-cells-with-vba/38734889#38734889", "title": "Excel comparing multiple cells with vba", "body": "<p>First things first.</p>\n\n<pre><code>Dim R1, R2, R3 As Range \n</code></pre>\n\n<p>You can do this in VB.Net and all three will be declared as a <code>Range</code> but in VBA, you have to explicitly declare them as <code>Range</code> else the first two will be declared as a <code>Variant</code></p>\n\n<pre><code>Dim R1 As Range, R2 As Range, R3 As Range \n</code></pre>\n\n<p>To compare multiple rows and columns you can use a loop. For example</p>\n\n<pre><code>With Sheet1 '&lt;~~ Change this to the relevant sheet\n    For i = 3 To 8 '&lt;~~ You actual row numbers\n        If .Range(\"E\" &amp; i).Value = .Range(\"G\" &amp; i).Value Or _\n           .Range(\"E\" &amp; i).Value = .Range(\"I\" &amp; i).Value Then\n            '~~&gt; do something\n        End If\n    Next i\nEnd With\n</code></pre>\n\n<p>Also instead of <em>Drag &amp; Drop</em>, I would recommend using a <em>Data Validation List</em> so that you do not have to use <code>.Undo</code>. You can simply clear the contents of the cell.</p>\n"}, {"tags": [], "owner": {"reputation": 178, "user_id": 5656296, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed50544a4557d43add0caac2f8305762?s=128&d=identicon&r=PG&f=1", "display_name": "JBStovers", "link": "https://stackoverflow.com/users/5656296/jbstovers"}, "is_accepted": false, "score": 0, "last_activity_date": 1470206512, "creation_date": 1470206512, "answer_id": 38736184, "question_id": 38734811, "link": "https://stackoverflow.com/questions/38734811/excel-comparing-multiple-cells-with-vba/38736184#38736184", "title": "Excel comparing multiple cells with vba", "body": "<p>No need for VBA here. Set a custom data validation rule for cell E3 with the following formula: </p>\n\n<pre><code>=OR(ISBLANK(E3),COUNTIF($E3:$I3,E3)=1)\n</code></pre>\n\n<p>Then copy the cell to G3 and I3, and copy row 3 down as far as you need.  You could then set a custom error message using the Data Validation wizard. </p>\n\n<p>The above formula assumes that you only need to check values across the same row (as you state).</p>\n"}], "owner": {"reputation": 21, "user_id": 6670582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98eb110cb3df13a077ec8d65e144394e?s=128&d=identicon&r=PG&f=1", "display_name": "user6670582", "link": "https://stackoverflow.com/users/6670582/user6670582"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3162, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1470206512, "creation_date": 1470200879, "last_edit_date": 1470201988, "question_id": 38734811, "link": "https://stackoverflow.com/questions/38734811/excel-comparing-multiple-cells-with-vba", "title": "Excel comparing multiple cells with vba", "body": "<p>I need help here with Excel VBA.</p>\n\n<p>I want to know how to compare multiple cells in the same row, but in different columns.</p>\n\n<p>I need to compare something like specific cells E3, G3, I3 and find out if any of it are duplicates and remove the duplicate of whichever was put in first.</p>\n\n<p>Note: A drag and drop function is used to fill in the data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/MU0RJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MU0RJ.jpg\" alt=\"Image of Spreadsheet\"></a></p>\n\n<p>I tried using something like this</p>\n\n<pre><code>Dim R1, R2, R3 As Range \nSet R1 = Range(\"E3\")\nSet R2 = Range(\"G3\")\nSet R3 = Range(\"I3\")\n\nIf (R1 = R2 Or R1 = R3) Then \nMsgBox \"Room Already Used!\" \n            With Application\n                .EnableEvents = False\n                .Undo\n                .EnableEvents = True\n            End With\nEnd If\n</code></pre>\n\n<p>But I need to compare even more rows and columns.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6629298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210228009399861/picture?type=large", "display_name": "Shajee Rehman", "link": "https://stackoverflow.com/users/6629298/shajee-rehman"}, "edited": false, "score": 0, "creation_date": 1470205594, "post_id": 38734792, "comment_id": 64847131, "body": "Still giving error. If there are no Excel files in the folder, exit.     FilesInPath = Dir(MyPath &amp; &quot;<i>.xl</i>&quot;)     If FilesInPath = &quot;&quot; Then         MsgBox &quot;No files found&quot;         Exit Sub     End If there is a bug in FilesInPath. :("}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 33, "user_id": 6629298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210228009399861/picture?type=large", "display_name": "Shajee Rehman", "link": "https://stackoverflow.com/users/6629298/shajee-rehman"}, "edited": false, "score": 0, "creation_date": 1470206513, "post_id": 38734792, "comment_id": 64847587, "body": "change <code>Dir(MyPath &amp; &quot;.xl&quot;)</code> to <code>Dir(MyPath &amp; &quot;.xl*&quot;)</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 33, "user_id": 6629298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210228009399861/picture?type=large", "display_name": "Shajee Rehman", "link": "https://stackoverflow.com/users/6629298/shajee-rehman"}, "edited": false, "score": 0, "creation_date": 1470208154, "post_id": 38734792, "comment_id": 64848440, "body": "debug and check what does MyPath have?"}, {"owner": {"reputation": 33, "user_id": 6629298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210228009399861/picture?type=large", "display_name": "Shajee Rehman", "link": "https://stackoverflow.com/users/6629298/shajee-rehman"}, "edited": false, "score": 0, "creation_date": 1470208323, "post_id": 38734792, "comment_id": 64848524, "body": "On my PC my shared drive is displayed like this (&quot;\\\\151.208.196.138\\ats) (Z:). So if I write my code like this  &quot;Z:\\F&amp;HC\\PSG OPS\\New DDS Sheet\\&quot;. it works. But if some other person opens the shared drive this Z folder will be let&#39;s say Y: on his PC. So it will not work on his PC. There&#39;s a problem with my 151.208.196.138 code line. There must be a way or a function to display such numerical values that I am missing in my code."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 33, "user_id": 6629298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210228009399861/picture?type=large", "display_name": "Shajee Rehman", "link": "https://stackoverflow.com/users/6629298/shajee-rehman"}, "edited": false, "score": 0, "creation_date": 1470208584, "post_id": 38734792, "comment_id": 64848647, "body": "Try this <code>&quot;\\\\151.208.196.138\\F&amp;HC\\PSG OPS\\New DDS Sheet&quot;</code>"}, {"owner": {"reputation": 33, "user_id": 6629298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210228009399861/picture?type=large", "display_name": "Shajee Rehman", "link": "https://stackoverflow.com/users/6629298/shajee-rehman"}, "edited": false, "score": 0, "creation_date": 1470209538, "post_id": 38734792, "comment_id": 64849172, "body": "No again giving error 52. Actually i am a bit new at VBA. How to debug and check what does MyPath have?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 33, "user_id": 6629298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210228009399861/picture?type=large", "display_name": "Shajee Rehman", "link": "https://stackoverflow.com/users/6629298/shajee-rehman"}, "edited": false, "score": 0, "creation_date": 1470210201, "post_id": 38734792, "comment_id": 64849529, "body": "If you type <code>\\\\151.208.196.138\\ATS shared drive\\F&amp;HC\\PSG OPS\\New DDS Sheet</code> in the windows explorer, does it take you to the correct folder?"}, {"owner": {"reputation": 33, "user_id": 6629298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210228009399861/picture?type=large", "display_name": "Shajee Rehman", "link": "https://stackoverflow.com/users/6629298/shajee-rehman"}, "edited": false, "score": 0, "creation_date": 1470213604, "post_id": 38734792, "comment_id": 64851597, "body": "no items found, when I tried to search it in windows explorer"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 33, "user_id": 6629298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210228009399861/picture?type=large", "display_name": "Shajee Rehman", "link": "https://stackoverflow.com/users/6629298/shajee-rehman"}, "edited": false, "score": 0, "creation_date": 1470213670, "post_id": 38734792, "comment_id": 64851644, "body": "forget the items. Does it take you to the correct folder? If not then that means your path is incorrect"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1470200764, "creation_date": 1470200764, "answer_id": 38734792, "question_id": 38734687, "link": "https://stackoverflow.com/questions/38734687/upload-excel-workbook-on-shared-drive/38734792#38734792", "title": "Upload Excel Workbook on shared drive", "body": "<p>The UNC (<em>Universal Naming Convention</em>) is basically the full file path location.  It takes the format:</p>\n\n<pre><code>\\\\Server\\Share\\filepath\n</code></pre>\n\n<p>Notice the <code>\"\\\\\"</code>?</p>\n\n<p>In your case, it will be</p>\n\n<pre><code>\"\\\\151.208.196.138\\ATS shared drive\\F&amp;HC\\PSG OPS\\New DDS Sheet\"\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6629298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210228009399861/picture?type=large", "display_name": "Shajee Rehman", "link": "https://stackoverflow.com/users/6629298/shajee-rehman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1472310145, "creation_date": 1470200161, "last_edit_date": 1472310145, "question_id": 38734687, "link": "https://stackoverflow.com/questions/38734687/upload-excel-workbook-on-shared-drive", "title": "Upload Excel Workbook on shared drive", "body": "<p>I have created a master workbook which gathers the data from other Excel workbooks. Below is the path where my other workbooks are placed (from which data need to be gathered) and my master workbook is on desktop. Below is the code I am using.</p>\n\n<pre><code>' Change this to the path\\folder location of the files.\nMyPath = \"C:\\P&amp;G\\\"\n\n' Add a slash at the end of path if needed.\nIf Right(MyPath, 1) &lt;&gt; \"\\\" Then\n    MyPath = MyPath &amp; \"\\\"\nEnd If\n\n' If there are no Excel files in the folder, exit.\nFilesInPath = Dir(MyPath &amp; \"*.xl*\")\nIf FilesInPath = \"\" Then\n    MsgBox \"No files found\"\n    Exit Sub\nEnd If\n\n' Fill in the myFiles array with the list of Excel files in\n' the search folder.\nFNum = 0\nDo While FilesInPath &lt;&gt; \"\"\n    FNum = FNum + 1\n    ReDim Preserve MyFiles(1 To FNum)\n    MyFiles(FNum) = FilesInPath\n    FilesInPath = Dir()\nLoop\n</code></pre>\n\n<p>When I am uploading this file on shared drive, I am giving my path as follows:</p>\n\n<p><code>\"\\\\151.208.196.138\\ATS shared drive\\F&amp;HC\\PSG OPS\\New DDS Sheet\"</code></p>\n\n<p>But this is giving error. can anybody help me?</p>\n"}, {"tags": ["regex", "vba", "ms-word"], "comments": [{"owner": {"reputation": 13601, "user_id": 1564659, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f7524296b1d11599c7a1bd2c045a73ac?s=128&d=identicon&r=PG", "display_name": "Aminah Nuraini", "link": "https://stackoverflow.com/users/1564659/aminah-nuraini"}, "edited": false, "score": 0, "creation_date": 1470198991, "post_id": 38734437, "comment_id": 64844508, "body": "I think there are options there. Do you really need to use Regex? I don&#39;t think so"}, {"owner": {"reputation": 215, "user_id": 5358847, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/cfef798e2cc05cd00ff4fa7c2b936383?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin ", "link": "https://stackoverflow.com/users/5358847/kevin"}, "reply_to_user": {"reputation": 13601, "user_id": 1564659, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f7524296b1d11599c7a1bd2c045a73ac?s=128&d=identicon&r=PG", "display_name": "Aminah Nuraini", "link": "https://stackoverflow.com/users/1564659/aminah-nuraini"}, "edited": false, "score": 0, "creation_date": 1470200538, "post_id": 38734437, "comment_id": 64844999, "body": "@AminahNuraini: I have edited the question for your convenience. Please check"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1470210619, "post_id": 38734437, "comment_id": 64849763, "body": "You have added VBA tags, are you using the real regex, not the search and replace dialog? If yes, use a simple <a href=\"https://regex101.com/r/hY4vL3/1\" rel=\"nofollow noreferrer\"><code>\\[\\d+([-,]+\\d+)*\\]</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1470211145, "post_id": 38737555, "comment_id": 64850059, "body": "It will also match <code>[-------]</code> and <code>[     ]</code>, and <code>[--,--,]</code>, and <code>[-, -,]</code>, etc."}, {"owner": {"reputation": 6392, "user_id": 1252228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wOcT1.png?s=128&g=1", "display_name": "Pradeep Kumar", "link": "https://stackoverflow.com/users/1252228/pradeep-kumar"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1470211215, "post_id": 38737555, "comment_id": 64850100, "body": "Yes, but that&#39;s assuming that this is a sensible document and has real text."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1470211244, "post_id": 38737555, "comment_id": 64850110, "body": "Good, but the question is tagged VBA."}, {"owner": {"reputation": 6392, "user_id": 1252228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wOcT1.png?s=128&g=1", "display_name": "Pradeep Kumar", "link": "https://stackoverflow.com/users/1252228/pradeep-kumar"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1470211499, "post_id": 38737555, "comment_id": 64850288, "body": "That&#39;s probably because the OP thinks that there is no built-in way to to search for these type of text. Anyways, its good if someone posts a VBA solution and he prefers that one. :)"}], "tags": [], "owner": {"reputation": 6392, "user_id": 1252228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wOcT1.png?s=128&g=1", "display_name": "Pradeep Kumar", "link": "https://stackoverflow.com/users/1252228/pradeep-kumar"}, "is_accepted": false, "score": 1, "last_activity_date": 1470213795, "last_edit_date": 1470213795, "creation_date": 1470210690, "answer_id": 38737555, "question_id": 38734437, "link": "https://stackoverflow.com/questions/38734437/square-bracket-content-coding/38737555#38737555", "title": "square bracket content coding", "body": "<p>Bring up the <code>Find and Replace</code> box and enter the following in the <code>Find what:</code> textbox:</p>\n\n<pre><code>\\[[0-9, -]@\\]\n</code></pre>\n\n<p>The click the <code>More &gt;&gt;</code> button and ensure that <code>Use wildcards</code> checkbox is checked.</p>\n\n<p>You may use the <code>Replace with:</code> textbox to replace these with whatever text or formatting you want to.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5bjAO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5bjAO.png\" alt=\"Find and Replace with Wildcard\"></a></p>\n\n<p><strong>NOTE:</strong> If you are looking for a VBA solution only, the easiest way is to record a macro while performing the above steps, and then customize it according to your needs.</p>\n"}], "owner": {"reputation": 215, "user_id": 5358847, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/cfef798e2cc05cd00ff4fa7c2b936383?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin ", "link": "https://stackoverflow.com/users/5358847/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470213795, "creation_date": 1470198538, "last_edit_date": 1470200818, "question_id": 38734437, "link": "https://stackoverflow.com/questions/38734437/square-bracket-content-coding", "title": "square bracket content coding", "body": "<p>I want to apply a style in ms-word to all the square brackets with only number/numbers(numbers separated with comma or dash/hyphen and space) in them. </p>\n\n<p>Eg:  [1 ] , [1 , 2] [1,2,3], [1, 2, 3], [1-3],[1 , 2]</p>\n\n<p><a href=\"https://i.stack.imgur.com/A5d4U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A5d4U.png\" alt=\"enter image description here\"></a></p>\n\n<p>The reason I have to apply regex in this case is because, in each case as shown in the attached image, numbers may come in different formats inside the square brackets. Such as single digits, digits with/without space after/before comma, hyphen/endash in between digits etc.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 25756, "user_id": 925913, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69de717f8f47bc852b7e452d890ef166?s=128&d=identicon&r=PG&f=1", "display_name": "slackwing", "link": "https://stackoverflow.com/users/925913/slackwing"}, "edited": false, "score": 0, "creation_date": 1470198496, "post_id": 38734381, "comment_id": 64844394, "body": "What are you expecting instead of <code>[object]</code>?"}, {"owner": {"reputation": 737, "user_id": 6670494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uxOEU.jpg?s=128&g=1", "display_name": "Matthew Snell", "link": "https://stackoverflow.com/users/6670494/matthew-snell"}, "reply_to_user": {"reputation": 25756, "user_id": 925913, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69de717f8f47bc852b7e452d890ef166?s=128&d=identicon&r=PG&f=1", "display_name": "slackwing", "link": "https://stackoverflow.com/users/925913/slackwing"}, "edited": false, "score": 0, "creation_date": 1470198630, "post_id": 38734381, "comment_id": 64844433, "body": "I&#39;m hoping to see the result of the <code>&lt;br&gt;</code> element that shows &quot;TRACT: ...&quot;.  When I inspect element on the webpage I can see the field I want I&#39;m just not sure how to access it."}], "answers": [{"comments": [{"owner": {"reputation": 737, "user_id": 6670494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uxOEU.jpg?s=128&g=1", "display_name": "Matthew Snell", "link": "https://stackoverflow.com/users/6670494/matthew-snell"}, "edited": false, "score": 0, "creation_date": 1470199407, "post_id": 38734486, "comment_id": 64844615, "body": "Progress! Thank you. When I <code>MsgBox</code> the <code>innerHTML</code> one it returns a lot of information, in that output is the single field I need. How should I go about drilling even further to pull a single <code>&lt;br&gt;</code>?"}, {"owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "reply_to_user": {"reputation": 737, "user_id": 6670494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uxOEU.jpg?s=128&g=1", "display_name": "Matthew Snell", "link": "https://stackoverflow.com/users/6670494/matthew-snell"}, "edited": false, "score": 0, "creation_date": 1470199510, "post_id": 38734486, "comment_id": 64844652, "body": "I just posted a simple parsing technique that you can review."}, {"owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "reply_to_user": {"reputation": 737, "user_id": 6670494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uxOEU.jpg?s=128&g=1", "display_name": "Matthew Snell", "link": "https://stackoverflow.com/users/6670494/matthew-snell"}, "edited": false, "score": 0, "creation_date": 1470199618, "post_id": 38734486, "comment_id": 64844684, "body": "You can also split the string like I did using the &lt;br&gt; as the delimiter.  You may want to try just using the innertext  like I posted.  Then you can check if its blank and then ignore it or whatever else you need to do with it."}, {"owner": {"reputation": 737, "user_id": 6670494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uxOEU.jpg?s=128&g=1", "display_name": "Matthew Snell", "link": "https://stackoverflow.com/users/6670494/matthew-snell"}, "edited": false, "score": 0, "creation_date": 1470200123, "post_id": 38734486, "comment_id": 64844858, "body": "The code you posted prints the information broken out perfectly. I&#39;ve never used the <code>Debug.Print</code> feature before. What&#39;s the best method to take a single <code>v</code> from your <code>for</code> statement and direct it to a cell?"}, {"owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "reply_to_user": {"reputation": 737, "user_id": 6670494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uxOEU.jpg?s=128&g=1", "display_name": "Matthew Snell", "link": "https://stackoverflow.com/users/6670494/matthew-snell"}, "edited": false, "score": 0, "creation_date": 1470200222, "post_id": 38734486, "comment_id": 64844903, "body": "Sorry I&#39;m still figuring out the commenting part on Stackoverflow.  Please see my revised answer."}, {"owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "reply_to_user": {"reputation": 737, "user_id": 6670494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uxOEU.jpg?s=128&g=1", "display_name": "Matthew Snell", "link": "https://stackoverflow.com/users/6670494/matthew-snell"}, "edited": false, "score": 0, "creation_date": 1470200736, "post_id": 38734486, "comment_id": 64845056, "body": "Depending on what your workbook looks like you may want to actually print your result on a different worksheet.  I typically use a variable called <code>resultRow</code> then I will just increase that right after I print out a value."}, {"owner": {"reputation": 737, "user_id": 6670494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uxOEU.jpg?s=128&g=1", "display_name": "Matthew Snell", "link": "https://stackoverflow.com/users/6670494/matthew-snell"}, "edited": false, "score": 0, "creation_date": 1470200887, "post_id": 38734486, "comment_id": 64845119, "body": "I&#39;ve done the same thing 5 times in this conversation alone.   That worked great. I can polish it from here; thank you!"}, {"owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "reply_to_user": {"reputation": 737, "user_id": 6670494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uxOEU.jpg?s=128&g=1", "display_name": "Matthew Snell", "link": "https://stackoverflow.com/users/6670494/matthew-snell"}, "edited": false, "score": 0, "creation_date": 1470201018, "post_id": 38734486, "comment_id": 64845162, "body": "You are very welcome.  Feel free to mark the answer as the chosen one so this question can be &quot;closed&quot;  Thanks again."}], "tags": [], "owner": {"reputation": 86, "user_id": 6653009, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b0HN-iCBNZI/AAAAAAAAAAI/AAAAAAAAALI/Xw6Ox8yjaSk/photo.jpg?sz=128", "display_name": "excelledsoftware", "link": "https://stackoverflow.com/users/6653009/excelledsoftware"}, "is_accepted": false, "score": 0, "last_activity_date": 1470201092, "last_edit_date": 1470201092, "creation_date": 1470198857, "answer_id": 38734486, "question_id": 38734381, "link": "https://stackoverflow.com/questions/38734381/vba-returns-object-when-using-doc-getelementsbytagname-cant-locate-correct-t/38734486#38734486", "title": "VBA returns [object] when using Doc.getElementsByTagName. Can&#39;t locate correct TagName from browser", "body": "<p>You are very close.  All you need to do is pull the correct data from the object.  You can use one of the following</p>\n\n<pre><code>sDD = Doc.getElementsByName(\"pl_gov_census_geo_geocoder_domain_AddressResult\").item(0).innerText\nsDD = Doc.getElementsByName(\"pl_gov_census_geo_geocoder_domain_AddressResult\").item(0).innerHTML\nsDD = Doc.getElementsByName(\"pl_gov_census_geo_geocoder_domain_AddressResult\").item(0).outerHTML\n</code></pre>\n\n<p>Right now its just pulling the object, adding innerText, innerHTML or outerHTML should pull your result.</p>\n\n<p>Once you have that pulled you may want to split the results into an array so you can do what you need with each of the elements.  the code below should get you started.</p>\n\n<pre><code>Sub censusTract()\nDim sht As Worksheet\nDim lastRow As Long, v As Variant, block As Variant, x As Integer\n\n\nSet sht = ActiveWorkbook.Sheets(\"Sheet1\")\nlastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\n'For i = 2 To lastRow\n Dim IE As New InternetExplorer\n 'IE.Visible = True\n IE.navigate \"http://geocoding.geo.census.gov/geocoder/geographies/address?street=1308+Lapwing+Rd&amp;city=Edmond&amp;state=OK&amp;zip=73003&amp;benchmark=4&amp;vintage=4\"\n Do\n DoEvents\n Loop Until IE.readyState = READYSTATE_COMPLETE\n Dim Doc As HTMLDocument\n Set Doc = IE.document\n Dim sDD As String\n 'sDD = Doc.getElementsByTagName(\"br\")(0)\n sDD = Doc.getElementsByName(\"pl_gov_census_geo_geocoder_domain_AddressResult\").Item(0).innerText\n block = Split(sDD, vbLf)\n x = 2 'start column\n For Each v In block\n  If v &lt;&gt; \"\" Then\n    Cells(i, x).Value = v\n    x = x + 1\n  End If\nNext v\n 'IE.Quit\n 'sht.Cells(i, 41).Value = sDD\n'Next i\nEnd Sub\n</code></pre>\n\n<p>Let me know if you have any questions.</p>\n"}], "owner": {"reputation": 737, "user_id": 6670494, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/uxOEU.jpg?s=128&g=1", "display_name": "Matthew Snell", "link": "https://stackoverflow.com/users/6670494/matthew-snell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522491101, "creation_date": 1470198243, "question_id": 38734381, "link": "https://stackoverflow.com/questions/38734381/vba-returns-object-when-using-doc-getelementsbytagname-cant-locate-correct-t", "title": "VBA returns [object] when using Doc.getElementsByTagName. Can&#39;t locate correct TagName from browser", "body": "<p>I'm having trouble locating the correct tag name from Chrome. When I run the following code all that is returned is \"[object]\". Does anyone have any suggestions to pull in the correct field? </p>\n\n<p>Here's <a href=\"http://geocoding.geo.census.gov/geocoder/geographies/address?street=1308+Lapwing+Rd&amp;city=Edmond&amp;state=OK&amp;zip=73003&amp;benchmark=4&amp;vintage=4\" rel=\"nofollow\">the website</a> I'm attempting to pull information. Specifically Census Tract but at this point if someone could show me how to return any information I will mine the correct one. </p>\n\n<p>Here's my code, currently running the output to a MsgBox just to find the right field. From there I will reenable to <code>for</code> statement and make the URL in the VBA dynamic. Also note that I've attempted to use <code>getElementsByName</code> but no progress there either:</p>\n\n<pre><code>Sub censusTract()\nDim sht As Worksheet\nDim lastRow As Long\n\nSet sht = ActiveWorkbook.Sheets(\"Sheet1\")\nlastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\n'For i = 2 To lastRow\n Dim IE As New InternetExplorer\n 'IE.Visible = True\n IE.navigate \"http://geocoding.geo.census.gov/geocoder/geographies/address?street=1308+Lapwing+Rd&amp;city=Edmond&amp;state=OK&amp;zip=73003&amp;benchmark=4&amp;vintage=4\"\n Do\n DoEvents\n Loop Until IE.readyState = READYSTATE_COMPLETE\n Dim Doc As HTMLDocument\n Set Doc = IE.document\n Dim sDD As String\n 'sDD = Doc.getElementsByTagName(\"br\")(0)\n sDD = Doc.getElementsByName(\"pl_gov_census_geo_geocoder_domain_AddressResult\")(0)\n MsgBox sDD\n 'IE.Quit\n 'sht.Cells(i, 41).Value = sDD\n'Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1470197160, "post_id": 38734011, "comment_id": 64843990, "body": "Tongue in cheek answer:-  Open the Visual Basic Editor, insert module, start coding.  More &quot;sane&quot; response:- What code have you produced so far?  What problems are occurring when you run it?  What error messages are you getting?  Have you tried recording what happens when you do some of the steps manually?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1470198657, "post_id": 38734011, "comment_id": 64844437, "body": "you may want to look at reversing <a href=\"http://stackoverflow.com/questions/34166267/transpose-every-2nd-and-3rd-line?rq=1\">this code</a> and change the count to 12 instead of 2 or 3.  See if it help you out any:"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1470197477, "post_id": 38734221, "comment_id": 64844071, "body": "Excellent solution, but one caveat - it requires data to exist starting in row 1 (which it probably does), but if it doesn&#39;t (perhaps because of headings) you will need to add an offset to your calculation - e.g. if source data starts in row 5 then you will need to add 4 to your calculation."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470197999, "post_id": 38734221, "comment_id": 64844240, "body": "Your edit has gotten rid of my caveat - I wish I could upvote twice!"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470198059, "post_id": 38734221, "comment_id": 64844262, "body": "The edit is there because of your positive comment along with the upvote."}], "tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": false, "score": 1, "last_activity_date": 1470198273, "last_edit_date": 1592644375, "creation_date": 1470197200, "answer_id": 38734221, "question_id": 38734011, "link": "https://stackoverflow.com/questions/38734011/macro-for-transposing-every-12-rows/38734221#38734221", "title": "Macro for Transposing every 12 rows", "body": "<h1>NON VBA SOLUTION:</h1>\n<p>Lets assume your data in column format is set up with the date in column A and your values in column B.  If you were to place the values starting in D1, you could use the following formula:</p>\n<pre><code>=INDEX($B:$B,(COLUMN(D1)-COLUMN($D$1)+1)+(ROW(D1)-ROW($D$1))*12)\n</code></pre>\n<p>You can adjust the full column reference of B:B to suit your data.  Change D1 to whatever cell you choose for your top left corner.  Change the +1 to reflect the start row of your data.  The 12 represents the number of rows to essentially transpose.  Copy it across 12 columns, then copy the 12 cells down as far as needed.</p>\n<p>Proof of Concept</p>\n<p><a href=\"https://i.stack.imgur.com/Luszb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Luszb.png\" alt=\"POF\" /></a></p>\n<p>EDIT:</p>\n<pre><code>=INDEX($B:$B,(COLUMN(D1)-COLUMN($D$1)+ROW(B1))+(ROW(D1)-ROW($D$1))*12)\n</code></pre>\n<p>where B1 is the first row of your value to be transposed.</p>\n"}], "owner": {"reputation": 1, "user_id": 6670384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204981122926647/picture?type=large", "display_name": "Tyler Lamparter", "link": "https://stackoverflow.com/users/6670384/tyler-lamparter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1470203058, "creation_date": 1470195884, "last_edit_date": 1531161705, "question_id": 38734011, "link": "https://stackoverflow.com/questions/38734011/macro-for-transposing-every-12-rows", "title": "Macro for Transposing every 12 rows", "body": "<p>I have data points for every month for over 50 years. So all the data are in a column and it is sorted by date then gives the data point of interest. I need to transpose all the months of each year. Here is an example of my data. All of the ... are where data continues on. What is on the left is what I have. What is on the right is what I need. How can I make a transposing loop for this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/4Wy9I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4Wy9I.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6666397, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154203112535923/picture?type=large", "display_name": "Tristan Larner", "link": "https://stackoverflow.com/users/6666397/tristan-larner"}, "edited": false, "score": 0, "creation_date": 1470204312, "post_id": 38734263, "comment_id": 64846489, "body": "Thank you @Tim-Williams. Now all that remains is to have my default Outlook signature to appear at the bottom of the text."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1470197466, "creation_date": 1470197466, "answer_id": 38734263, "question_id": 38733873, "link": "https://stackoverflow.com/questions/38733873/how-can-i-populate-the-new-e-mail-window-subject-and-body-fields-using-a-userf/38734263#38734263", "title": "How can I populate the New E-mail Window (Subject and Body fields) using a Userform in MS Outlook?", "body": "<pre><code>With MItem\n    .To = email_\n    .Subject = subject_\n    .Body = body_\n    .Display '&lt;&lt;  \nEnd With\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6666397, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154203112535923/picture?type=large", "display_name": "Tristan Larner", "link": "https://stackoverflow.com/users/6666397/tristan-larner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 38734263, "answer_count": 1, "score": 2, "last_activity_date": 1593331382, "creation_date": 1470194872, "last_edit_date": 1593331382, "question_id": 38733873, "link": "https://stackoverflow.com/questions/38733873/how-can-i-populate-the-new-e-mail-window-subject-and-body-fields-using-a-userf", "title": "How can I populate the New E-mail Window (Subject and Body fields) using a Userform in MS Outlook?", "body": "<p>I regularly issue Purchase Orders to vendors for my job, and either;</p>\n\n<ul>\n<li>Write the email like a normal person or;</li>\n<li><a href=\"https://i.stack.imgur.com/BxVHZ.png\" rel=\"nofollow noreferrer\">Use a macro to open a template that I have generated</a>\n<pre><code>\n    Sub New_Email_from_PO_Template()\n    Dim myOlApp As Outlook.Application\n    Dim MyItem As Outlook.MailItem\n    Set myOlApp = CreateObject(\"Outlook.Application\")\n    Set MyItem = myOlApp.CreateItemFromTemplate(\"C:\\Blah\\template.oft\")\n    MyItem.Display\n    End Sub\n</pre></code></li>\n</ul>\n\n<p>My aim is to eliminate the possibility of error by creating a userform, which will then populate a New E-mail window, allowing me to make any desired changes, and add attachments, before manually clicking [Send].</p>\n\n<p><a href=\"https://i.stack.imgur.com/wXiU5.png\" rel=\"nofollow noreferrer\">Included here is a Userform I have created.</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/9fvbA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9fvbA.png\" alt=\"enter image description here\"></a></p>\n\n<p>The textboxes in the Userform that I have created are as follows;</p>\n\n<ol>\n<li>RecipientName</li>\n<li>PurchaseOrderNumber</li>\n<li>PurchaseOrderDescription</li>\n<li>Location</li>\n<li>ProjectNumber</li>\n<li>DateRequired</li>\n</ol>\n\n<p>Following [SubmitButton], the data would then be populated into the Subject and Body fields in the New E-mail window.</p>\n\n<p><b>Subject Line:</b></p>\n\n<ul>\n<li>\"PO# [PurchaseOrderNumber] - [PurchaseOrderDescription] - [Location]\"</li>\n</ul>\n\n<p><b>Body:</b></p>\n\n<ul>\n<li>\"To [Recipient_Name],\nPlease find attached Purchase Order (PO# [PurchaseOrderNumber]) pertaining to [PurchaseOrderDescription] for [Location]. Date Required: [DateRequired]\nThanks and Kind Regards, [User's Outlook Signature]\"</li>\n</ul>\n\n<p>The code I have developed is below;</p>\n\n<pre><code>Sub ShowPOSubmissionUserform()\nPOSubmissionEmailGenerator.Show\nEnd Sub\n\nSub InitialisePOSubmissionUserform()\n'Empty ProjectNumberTextbox\nProjectNumberTextbox.Value = \"\"\n\n'Empty ProjectNameTextbox\nProjectNameTextbox.Value = \"\"\n\n'Empty PONumberTextbox\nPONumberTextbox.Value = \"\"\n\n'Empty RecipientNameTextbox\nRecipientNameTextbox.Value = \"\"\n\n'Empty DateRequiredTextbox\nDateRequiredTextbox.Value = \"\"\nEnd Sub\n\n\nPrivate Sub CloseButton_Click()\nUnload Me\nEnd Sub\n\n\nPrivate Sub SubmitButton_Click()\n'Creates a new e-mail item and modifies its properties\nDim OutlookApp As Object\nDim MItem As Object\nDim email_ As String\nDim subject_ As String\nDim body_ As String\nDim attach_ As String\nSet OutlookApp = CreateObject(\"Outlook.Application\")\nemail_ = POSubmissionEmailGenerator.ProjectNumberTextbox.Value\nsubject_ = \"Hello this is the subject\"\nbody_ = \"Line 1\" &amp; vbNewLine &amp; vbNewLine &amp; \"Line 3\"\n'create Mail Item and send it\nSet MItem = OutlookApp.CreateItem(0)\nWith MItem\n.To = email_\n.Subject = subject_\n.Body = body_\nEnd With\nEnd Sub\n</code></pre>\n\n<p>At the moment, when pressing submit, NOTHING happens.\nWhat needs to be added to make it at least open the New E-mail window?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 0, "creation_date": 1470196256, "post_id": 38734017, "comment_id": 64843741, "body": "This isn&#39;t very robust in cases where files are added or removed from the folder. You can&#39;t just refresh the query; you&#39;d need to append the new files and remove references to the old ones."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 0, "creation_date": 1470196930, "post_id": 38734017, "comment_id": 64843934, "body": "Wrong. It can be completely dynamic to open all files in a folder, not by name, but just all files. Ken Puls has a blog about that <a href=\"http://www.excelguru.ca/blog/2015/02/25/combine-multiple-excel-workbooks-in-power-query/\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "edited": false, "score": 0, "creation_date": 1470197229, "post_id": 38734017, "comment_id": 64844013, "body": "Oh wow, you&#39;re right. I had forgotten about the import From Folder button. The way you said &quot;Open all files in folder&quot; made it sound very manual in my mind."}, {"owner": {"reputation": 45, "user_id": 6670347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3a334d8d1a189108a491795d38a5b0?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvin Wong", "link": "https://stackoverflow.com/users/6670347/kelvin-wong"}, "edited": false, "score": 0, "creation_date": 1470205742, "post_id": 38734017, "comment_id": 64847207, "body": "Hey Teylyn, thanks alot for the great alternative solution. Good information for me to learn new stuff. Unfortunately, my boss just prefer the Macro VBA with just once click on the macro and everything runs itself. Thanks alot for the quick response! Appreciate it alot !"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1470195906, "creation_date": 1470195906, "answer_id": 38734017, "question_id": 38733860, "link": "https://stackoverflow.com/questions/38733860/vba-excel-how-to-automatically-compare-multiple-files-to-one-master-file-then-co/38734017#38734017", "title": "VBA Excel How to automatically compare multiple files to one master file then copy/paste the result", "body": "<p>Conceptually, this can be done completely without VBA, using Power Query, a free Microsoft add-in for Excel 2010 and 2013 and built into Excel 2013 as Get and Transform.</p>\n\n<p>Open all files in a folder, append them, remove duplicates and save as master file.</p>\n\n<p>When new files are added, refresh the query.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 6670347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3a334d8d1a189108a491795d38a5b0?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvin Wong", "link": "https://stackoverflow.com/users/6670347/kelvin-wong"}, "edited": false, "score": 0, "creation_date": 1470205645, "post_id": 38734282, "comment_id": 64847160, "body": "Thank you Alexis for the great solution. It is just what i needed. Apparently my VBA Excel 2007 doesn&#39;t read Set fso = New FileSystemObject yet only able to run if the code is this Set fso = CreateObject(&quot;scripting.FileSystemObject&quot;). I wonder why, anyway thanks alot for the help appreciate it alot."}], "tags": [], "owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "is_accepted": true, "score": 0, "last_activity_date": 1470197584, "last_edit_date": 1495542156, "creation_date": 1470197584, "answer_id": 38734282, "question_id": 38733860, "link": "https://stackoverflow.com/questions/38733860/vba-excel-how-to-automatically-compare-multiple-files-to-one-master-file-then-co/38734282#38734282", "title": "VBA Excel How to automatically compare multiple files to one master file then copy/paste the result", "body": "<p>Take a look at <a href=\"https://stackoverflow.com/questions/14245712/cycle-through-sub-folders-and-files-in-a-user-specified-root-directory\">this question</a>. From that code, yours will look something like the following:</p>\n\n<pre><code>Sub Compare()\nDim Dic As Object\nDim fso As Object 'FileSystemObject\nDim fldStart As Object 'Folder\nDim fl As Object 'File\nDim Mask As String, i As Long\nDim Wbk As Workbook\n\nSet fso = New FileSystemObject\nSet fld = fso.GetFolder(\"C:\\UsersSurvey Testing\")\n\nSet Dic = CreateObject(\"Scripting.Dictionary\")\n\nMask = \"*.xlsx\"\n\nFor Each fl in fld.Files\n    If fl.Name Like Mask Then\n        Set Wbk = Workbooks.Open(fld &amp; \"\\\" &amp; fl.Name).Sheets(\"Sheet1\")\n        i = Wbk.Cells.SpecialCells(xlCellTypeLastCell).Row\n        For Each oCell In Wbk.Range(\"A2:A\" &amp; i)\n            If Not Dic.exists(oCell.Value) Then\n                Dic.Add oCell.Value, oCell.Offset(, 0).Value\n            End If\n        Next oCell\n    End If\nNext fl\nEnd Sub\n</code></pre>\n\n<p>Note: I have not tested this code. It's just to get you an idea of what to try.</p>\n"}], "owner": {"reputation": 45, "user_id": 6670347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3a334d8d1a189108a491795d38a5b0?s=128&d=identicon&r=PG&f=1", "display_name": "Kelvin Wong", "link": "https://stackoverflow.com/users/6670347/kelvin-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 454, "favorite_count": 0, "accepted_answer_id": 38734282, "answer_count": 2, "score": 1, "last_activity_date": 1470197584, "creation_date": 1470194754, "last_edit_date": 1531164843, "question_id": 38733860, "link": "https://stackoverflow.com/questions/38733860/vba-excel-how-to-automatically-compare-multiple-files-to-one-master-file-then-co", "title": "VBA Excel How to automatically compare multiple files to one master file then copy/paste the result", "body": "<p><a href=\"https://postimg.org/image/laeyoj9wn/\" rel=\"nofollow noreferrer\">https://postimg.org/image/laeyoj9wn/</a> = List</p>\n\n<p><a href=\"https://i.stack.imgur.com/isHmX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/isHmX.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://postimg.org/image/ihlr4i9k7/\" rel=\"nofollow noreferrer\">https://postimg.org/image/ihlr4i9k7/</a> = Master list</p>\n\n<p><a href=\"https://i.stack.imgur.com/UcekG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UcekG.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would like to compare the List and Master list serial number. If there is similarity value in serial number the serial number value will be automatically paste on the third column</p>\n\n<pre><code>Sub AutoUpdate()\nDim Dic As Object, key As Variant, oCell As Range, i&amp;\nDim w1 As Worksheet, w2 As Worksheet\n\n    Set Dic = CreateObject(\"Scripting.Dictionary\")\n    Set w1 = Workbooks(\"Book1.xlsm\").Sheets(\"Sheet1\")\n    Set w2 = Workbooks.Open(\"C:\\UsersSurvey Testing\\Book2.xlsx\").Sheets(\"Sheet1\")\n    Set w3 = Workbooks.Open(\"C:\\Users\\Survey Testing\\Book3.xlsx\").Sheets(\"Sheet1\")\n\n\n    i = w2.Cells.SpecialCells(xlCellTypeLastCell).Row\n    For Each oCell In w2.Range(\"A2:A\" &amp; i)\n        If Not Dic.exists(oCell.Value) Then\n            Dic.Add oCell.Value, oCell.Offset(, 0).Value\n        End If\n\n    Next\n    i = w3.Cells.SpecialCells(xlCellTypeLastCell).Row\n    For Each oCell In w3.Range(\"A2:A\" &amp; i)\n        If Not Dic.exists(oCell.Value) Then\n            Dic.Add oCell.Value, oCell.Offset(, 0).Value\n        End If\n\n\n    Next\n    i = w1.Cells.SpecialCells(xlCellTypeLastCell).Row\n    For Each oCell In w1.Range(\"A2:A\" &amp; i)\n        For Each key In Dic\n            If oCell.Value = key Then\n                oCell.Offset(, 2).Value = Dic(key)\n        End If\n\n\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Instead of setting the workbook 1 by 1 in the code, I would like to automatically find and set all the workbook in the folder and compare. Because there might be alot of workbook that need to be compare.</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 149, "user_id": 5285928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040c0b16ef524025c2e0f0d606641f73?s=128&d=identicon&r=PG&f=1", "display_name": "Generic Guy", "link": "https://stackoverflow.com/users/5285928/generic-guy"}, "edited": false, "score": 0, "creation_date": 1470191782, "post_id": 38733396, "comment_id": 64842787, "body": "Could you run the find method for each value you want and then union them together?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1470195522, "post_id": 38733396, "comment_id": 64843595, "body": "Why VBA and not a formula?"}], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 1, "last_activity_date": 1470191791, "creation_date": 1470191791, "answer_id": 38733464, "question_id": 38733396, "link": "https://stackoverflow.com/questions/38733396/excel-vba-find-method-with-2-search-values/38733464#38733464", "title": "Excel VBA find method with 2 search values?", "body": "<p>You can do two separate searches and then use the <code>Union</code> function to combine the two <code>Ranges</code>. E.g.:</p>\n\n<pre><code>Option Explicit\n\nSub TestUnionFind()\n\n    Dim rngSearch1 As Range\n    Dim rngSearch2 As Range\n    Dim rngUnionSearch As Range\n\n    Set rngSearch1 = Sheet1.Cells.Find(What:=\"A\")\n    Set rngSearch2 = Sheet1.Cells.Find(What:=\"B\")\n    Set rngUnionSearch = Union(rngSearch1, rngSearch2)\n\n    Debug.Print rngUnionSearch.Address\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1470192090, "creation_date": 1470192090, "answer_id": 38733505, "question_id": 38733396, "link": "https://stackoverflow.com/questions/38733396/excel-vba-find-method-with-2-search-values/38733505#38733505", "title": "Excel VBA find method with 2 search values?", "body": "<p>You will have to do each search separately. </p>\n\n<pre><code>Set d = .Find(What:=a, After:=ActionCodeCell, LookIn:=xlValues, _ \nLookAt:= xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, _ \nMatchCase:=False, SearchFormat:=False)\n\nIf d is Nothing Then\n\n    Set d = .Find(What:=b, After:=ActionCodeCell, LookIn:=xlValues, _ \n    LookAt:= xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, _ \n    MatchCase:=False, SearchFormat:=False)\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 1727657, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d59bae4da5a21b40b26a2cbcfd3314fe?s=128&d=identicon&r=PG", "display_name": "OutThere", "link": "https://stackoverflow.com/users/1727657/outthere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1470193945, "creation_date": 1470191257, "last_edit_date": 1531164843, "question_id": 38733396, "link": "https://stackoverflow.com/questions/38733396/excel-vba-find-method-with-2-search-values", "title": "Excel VBA find method with 2 search values?", "body": "<p>Is there a way to use the FIND method to search for 1 of 2 alternative values?  <code>Set d = .Find(What:=[a OR b])</code></p>\n\n<p>EDIT:  Thanks for the UNION suggestions.  I had no idea that was possible or I would've provided more detail originally to make the question more clear.  So here's a 2nd try:</p>\n\n<p>I have 3 columns.  A is filled with dates. B is a code.  And D is where I need to insert a function.  The function will evaluate the code in colB and if the code is a \"2\", it will run the FIND method to find the nearest previous code 1 OR 2 in colB, then it will subtract the dates from colA on the two rows.  For example:</p>\n\n<pre><code>A       |B  ...|D\n[date1] |5     |[function does nothing]\n[date2] |1     |[function does nothing]\n[date3] |3     |[function does nothing]\n[date4] |2     |[code 2 found, function inserts result of [date4]-[date2]\n</code></pre>\n\n<p>(last row would be same if 2nd row had a code 2 instead of a 1)</p>\n\n<p>Here's the code I have now:</p>\n\n<pre><code>Private Function FindPrevActionCode(ActionCodeCell As Range, SearchCode As Byte)\n\n'ActionCodeCell is the cell to check, search the value of that cell\n'SearchCode is the code to look for\n\nDim d As Range 'Holds result of Find method\n\nIf ActionCodeCell.Value = 2 Then\n  With Worksheets(AppTab).Columns(cnAppActionCode)\n       Set d = .Find(What:=SearchCode, After:=ActionCodeCell, _ \n       LookIn:=xlValues, LookAt:= _\n       xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, _ \n       MatchCase:=False, SearchFormat:=False)\n  End With\n\nFindPrevActionCode = Cells(ActionCodeCell.row, cnAppTransEffDate).Value  \n - Cells(d.row, cnAppTransEffDate).Value\n\n\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-access-2007", "excel-2007"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1470186644, "post_id": 38732780, "comment_id": 64841666, "body": "What line is error? Is it on the update?"}, {"owner": {"reputation": 31, "user_id": 5752007, "user_type": "registered", "profile_image": "https://graph.facebook.com/751069631661673/picture?type=large", "display_name": "Ronan O&#39;Driscoll", "link": "https://stackoverflow.com/users/5752007/ronan-odriscoll"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470186733, "post_id": 38732780, "comment_id": 64841692, "body": "Sorry its on the &quot;.addNew&quot; or at least thats the line that becomes highlighted  The error is the 3251 error and it states  &quot;Current Recordset does not support Updating.  This may be a limitation of the provider, or of the selected locktype&quot;"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470187678, "post_id": 38732780, "comment_id": 64841887, "body": "I hate ado with access databases. But if you don&#39;t want to use DAO try opening with adoopendynamic instead of keyset. Check RS.updatable property right after .open to make sure you recorded can be updated. Is ID a primary key field?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1470187901, "post_id": 38732780, "comment_id": 64841929, "body": "ADO version 2.1 is really out of date (it seems to have been released in the late 1990s). Try referencing version 2.8 instead"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470187978, "post_id": 38732780, "comment_id": 64841946, "body": "You might need to add &quot;;Persist Security Info&quot; to your connection string... Or you could always try DAO"}, {"owner": {"reputation": 31, "user_id": 5752007, "user_type": "registered", "profile_image": "https://graph.facebook.com/751069631661673/picture?type=large", "display_name": "Ronan O&#39;Driscoll", "link": "https://stackoverflow.com/users/5752007/ronan-odriscoll"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470188013, "post_id": 38732780, "comment_id": 64841956, "body": "@dbmitch - yes the ID is a primary key field should i remove this? ... will try using the adoopendynamic thanks"}, {"owner": {"reputation": 31, "user_id": 5752007, "user_type": "registered", "profile_image": "https://graph.facebook.com/751069631661673/picture?type=large", "display_name": "Ronan O&#39;Driscoll", "link": "https://stackoverflow.com/users/5752007/ronan-odriscoll"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1470188018, "post_id": 38732780, "comment_id": 64841958, "body": "@barrowc - will try that now thanks"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470188074, "post_id": 38732780, "comment_id": 64841972, "body": "No. You need primary key in ado recordsetr updates"}, {"owner": {"reputation": 31, "user_id": 5752007, "user_type": "registered", "profile_image": "https://graph.facebook.com/751069631661673/picture?type=large", "display_name": "Ronan O&#39;Driscoll", "link": "https://stackoverflow.com/users/5752007/ronan-odriscoll"}, "edited": false, "score": 0, "creation_date": 1470189135, "post_id": 38732780, "comment_id": 64842197, "body": "Halfway there! Thank you to everyone who has made suggestions / edits so far.  I went into the connections in Excel and altered the ShareDeny and changed it to      Mode=Share Deny None  Also some minor alterations to the code which I have show n the main code on the question.  However now i get an really random error saying im trying to assign a Null value?"}, {"owner": {"reputation": 31, "user_id": 5752007, "user_type": "registered", "profile_image": "https://graph.facebook.com/751069631661673/picture?type=large", "display_name": "Ronan O&#39;Driscoll", "link": "https://stackoverflow.com/users/5752007/ronan-odriscoll"}, "edited": false, "score": 0, "creation_date": 1470189683, "post_id": 38732780, "comment_id": 64842317, "body": "RESOLVED NULL (commented the auto field)"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5752007, "user_type": "registered", "profile_image": "https://graph.facebook.com/751069631661673/picture?type=large", "display_name": "Ronan O&#39;Driscoll", "link": "https://stackoverflow.com/users/5752007/ronan-odriscoll"}, "is_accepted": true, "score": 1, "last_activity_date": 1470190179, "creation_date": 1470190179, "answer_id": 38733239, "question_id": 38732780, "link": "https://stackoverflow.com/questions/38732780/vba-excel-access-3251-runtime-error/38733239#38733239", "title": "VBA Excel-Access 3251 Runtime error", "body": "<p>ANSWER</p>\n\n<p>OK so the issue was I was getting a runtime error when trying to \"Add\" a new record to a database with</p>\n\n<pre><code>Do While Len(Range(\"K\" &amp; i).Offset(0, x).Formula) &gt; 0\n        With rs\n            'create a new record\n            .AddNew\n            .Fields(\"ID\") = Range(\"A1\" &amp; i).Value ...\n</code></pre>\n\n<p>This was so I could save the records from an Excel Spreadsheet into an Access Database (both office 2007).</p>\n\n<p>I opened the connections option in Excel slected the properties of my connection and changed the mode to the following \";Mode=Share Deny None!\"</p>\n\n<p>So now my connection string looks like this:</p>\n\n<pre><code>Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data\nSource=C:\\linktest.accdb;Mode=Share Deny None;Extended Properties=\"\";\nJet OLEDB:System database=\"\";\nJet OLEDB:Registry Path=\"\";Jet OLEDB:Engine Type=6;\nJet OLEDB:Database Locking Mode=1;Jet OLEDB:Global Partial Bulk Ops=2;\nJet OLEDB:Global Bulk Transactions=1;Jet OLEDB:\nNew Database Password=\"\";Jet OLEDB:Create System Database=False;\nJet OLEDB:Encrypt Database=False;Jet OLEDB:Don't Copy Locale on Compact=False;\nJet OLEDB:Compact Without Replica Repair=False;\nJet OLEDB:SFP=False;Jet OLEDB:Support Complex Data=False\n</code></pre>\n\n<p>I then had a second issue when i returned an error stating that the data I was trying to return gave a \"NULL\" value.  This was because I was trying to save data t the primary key in the database which returned the error.  </p>\n\n<p>I simply commented out this line and this resolved this issue.</p>\n\n<p>I also changed the reference to \nMicrosoft ActiveX Data Objects 6.1 Library</p>\n"}, {"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1470195701, "creation_date": 1470195701, "answer_id": 38733988, "question_id": 38732780, "link": "https://stackoverflow.com/questions/38732780/vba-excel-access-3251-runtime-error/38733988#38733988", "title": "VBA Excel-Access 3251 Runtime error", "body": "<p>Thought I'd show a DAO alternative - it's the default db method now with the newer Access versions. As I noted in the code it requires a reference to <code>Microsoft Office 14.0 Access database engine Object Library</code> or whatever version you have on your system now.</p>\n\n<pre><code>Option Explicit\n\nSub DAOExcelToAccess()\n    ' Requires Reference To\n    ' Microsoft Office 14.0 Access database engine Object Library\n\n    Dim db      As DAO.Database\n    Dim rs      As DAO.Recordset\n    Dim strFile As String\n    Dim i       As Integer\n    Dim x       As Integer\n\n    strFile = Application.ActiveWorkbook.Path &amp; \"\\linktest.accdb\"\n    Set db = DBEngine.OpenDatabase(strFile)\n    Set rs = db.OpenRecordset(\"linktest\", dbOpenDynaset)\n    With rs\n        For i = 4 To 16\n            x = 0\n\n            ' repeat until first empty cell in column A\n            Range(\"A2\").Activate\n\n            'create a new record\n            .AddNew\n            ' Remove ID if it is AutoIncrement field\n            ' .Fields(\"ID\") = Range(\"A1\" &amp; i).Value\n            .Fields(\"Area\") = \"Test\" &amp; i\n            .Fields(\"ProductCode\") = Range(\"C1\").Value\n            .Fields(\"Price\") = Range(\"D1\" &amp; i).Value\n            .Fields(\"CurrencyType\") = Range(\"E1\").Value\n            .Fields(\"Type\") = Range(\"F1\").Value\n            .Fields(\"Production\") = Range(\"G1\" &amp; i).Value\n            .Fields(\"Quantity\") = Range(\"H1\" &amp; i).Value\n            .Fields(\"Details\") = Range(\"I1\" &amp; i).Value\n            .Fields(\"DateUpdated\") = Range(\"J1\" &amp; i).Value\n            .Fields(\"Setup\") = Range(\"K1\" &amp; i).Value\n\n            ' stores the new record\n            .Update\n\n             x = x + 1\n        Next i\n\n        .Close\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5752007, "user_type": "registered", "profile_image": "https://graph.facebook.com/751069631661673/picture?type=large", "display_name": "Ronan O&#39;Driscoll", "link": "https://stackoverflow.com/users/5752007/ronan-odriscoll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 991, "favorite_count": 0, "accepted_answer_id": 38733239, "answer_count": 2, "score": 2, "last_activity_date": 1470195701, "creation_date": 1470186458, "last_edit_date": 1531164843, "question_id": 38732780, "link": "https://stackoverflow.com/questions/38732780/vba-excel-access-3251-runtime-error", "title": "VBA Excel-Access 3251 Runtime error", "body": "<p>I currently use Microsoft Office 2007 and have linked an Access 2007 Database to Excel 2007 Database.  So far so good.  I can update the Access Database and it shows automatically in the Excel file.  Here is where I have the problem.</p>\n\n<p>When I try to update an Access Database from within Excel; I keep getting the runtime 3251 Error. =>runtime error now resolved but NEW issue regarding a NULL value when im trying to add data?</p>\n\n<pre><code>Sub ADODBExcelToAccess()\n'Collecting data from the\n    Dim cn As ADODB.Connection, rs As ADODB.Recordset, r As Long\n\n    '---NOTE: Sheet is set to auto refresh data from the database on loading---\n\n    ' connect to the Access database\n    Set cn = New ADODB.Connection\n    cn.Open \"Provider=Microsoft.ACE.OLEDB.12.0; \" &amp; _\n            \"Data Source=\" &amp; Application.ActiveWorkbook.Path &amp; \"\\linktest.accdb;\"\n\n    ' open a recordset (i.e. a table)\n    Set rs = New ADODB.Recordset\n\n    rs.Open \"linktest\", cn, adOpenKeyset, adLockOptimistic, adCmdTable\n\n    ' all records in a table\n    For i = 4 To 16\n        x = 0\n\n        Do While Len(Range(\"K\" &amp; i).Offset(0, x).Formula) &gt; 0\n            With rs\n                'create a new record\n                .AddNew\n                .Fields(\"ID\") = Range(\"A1\" &amp; i).Value\n                .Fields(\"PriceID\") = Range(\"B1\").Value\n                .Fields(\"ProductCode\") = Range(\"C1\").Value\n                .Fields(\"Price\") = Range(\"D1\" &amp; i).Value\n                .Fields(\"CurrencyType\") = Range(\"E1\").Value\n                .Fields(\"Type\") = Range(\"F1\").Value\n                .Fields(\"Production\") = Range(\"G1\" &amp; i).Value\n                .Fields(\"Quantity\") = Range(\"H1\" &amp; i).Value\n                .Fields(\"Details\") = Range(\"I1\" &amp; i).Value\n                .Fields(\"DateUpdated\") = Range(\"J1\" &amp; i).Value\n                .Fields(\"Setup\") = Range(\"K1\" &amp; i).Value\n\n                ' stores the new record\n                .Update\n\n            End With\n            x = x + 1\n        Loop\n    Next i\n    rs.Close\n    Set rs = Nothing\n    cn.Close\n    Set cn = Nothing\nEnd Sub\n</code></pre>\n\n<p>The current reference library that I'm using is Active X Data Objects 2.1 Library.</p>\n"}, {"tags": ["excel", "vba", "ms-access", "macros"], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1471696470, "creation_date": 1471696470, "answer_id": 39054210, "question_id": 38732643, "link": "https://stackoverflow.com/questions/38732643/execute-excel-macro-then-import-into-access-table-on-multiple-excel-files-in-a/39054210#39054210", "title": "Execute Excel Macro, Then Import Into Access Table On Multiple Excel Files In A Folder", "body": "<p>This looks like some simple vlookups to me.  Once you get the excel stuff straightened out, and you are ready to import multiple files into a table, just run a script like this.</p>\n\n<pre><code>Sub ImportAllFilesIntoOneTable\n\n        Dim strPathFile As String, strFile As String, strPath As String\n        Dim strTable As String\n        Dim blnHasFieldNames As Boolean\n\n        ' Change this next line to True if the first row in EXCEL worksheet\n        ' has field names\n        blnHasFieldNames = False\n\n        ' Replace C:\\Documents\\ with the real path to the folder that\n        ' contains the EXCEL files\n        strPath = \"C:\\Documents\\\"\n\n        ' Replace tablename with the real name of the table into which\n        ' the data are to be imported\n        strTable = \"tablename\"\n\n        strFile = Dir(strPath &amp; \"*.xls\")\n        Do While Len(strFile) &gt; 0\n              strPathFile = strPath &amp; strFile\n              DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, _\n                    strTable, strPathFile, blnHasFieldNames\n\n        ' Uncomment out the next code step if you want to delete the\n        ' EXCEL file after it's been imported\n        '       Kill strPathFile\n\n              strFile = Dir()\n        Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6245473, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e0f7d28ad976a7c2df3f001a3de92dab?s=128&d=identicon&r=PG&f=1", "display_name": "HTMLHelpMe", "link": "https://stackoverflow.com/users/6245473/htmlhelpme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593958157, "creation_date": 1470185182, "last_edit_date": 1593958157, "question_id": 38732643, "link": "https://stackoverflow.com/questions/38732643/execute-excel-macro-then-import-into-access-table-on-multiple-excel-files-in-a", "title": "Execute Excel Macro, Then Import Into Access Table On Multiple Excel Files In A Folder", "body": "<p>I need to import multiple Excel spreadsheets into an Access table.  The spreadsheets currently look like this:</p>\n\n<pre><code>ID | Year | Sales | Commissions\n-- | ---- | ----- | -----------\n 1 | 2016 | 1,000 |  100\n 2 | 2016 | 2,000 |  200\n 3 | 2016 | 3,000 |  300\n 4 | 2016 | 1,000 |  300\n</code></pre>\n\n<p>They need to look like this:</p>\n\n<pre><code>ID | Name | Year | Month | Sales | Commissions | Discount | Net Sales | %\n-- | ---- | ---- | ----- | ----- | ----------- | -------- | --------- | -\n 1 | John | 2016 |  2    | 1,000 |  100        |          |           |\n 2 | Mary | 2016 |  2    | 2,000 |  200        |          |           |\n 3 | Jake | 2016 |  2    | 3,000 |  300        |          |           |\n 4 | Bob  | 2016 |  2    | 1,000 |  300        |          |           |\n</code></pre>\n\n<p>The last three columns will be blank.  Names (\"John, Mary...\") will use a lookup based on ID on another spreadsheet, but this can be done later in Access.  3 rows will have to be deleted at the top as well.  The month (\"2\") will be in the file path of the Excel file.  It will be the only number in the file name.  I.e., \"2\" for February.  All the spreadsheets will be in the same folder.  Each Excel workbook will have a spreadsheet titles \"DataSheet\".  This is the spreadsheet that will be imported from each workbook.</p>\n\n<p>Can I write a script in Access to do all of this?</p>\n\n<p>So far I've got this for the Excel macro:</p>\n\n<pre><code>  Sub Macro2()\n    Rows(\"1:3\").Select\n    Range(\"A3\").Activate\n    Selection.Delete Shift:=xlUp\n    Columns(\"B:B\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"Name\"\n    Columns(\"D:D\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"D1\").Select\n    ActiveCell.FormulaR1C1 = \"Month\"\n    Range(\"G1\").Select\n    ActiveCell.FormulaR1C1 = \"Discount\"\n    Range(\"H1\").Select\n    ActiveCell.FormulaR1C1 = \"Net Sales\"\n    Range(\"I1\").Select\n    ActiveCell.FormulaR1C1 = \" %\"\n    Range(\"G2\").Select\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://www.accessmvp.com/kdsnell/EXCEL_Import.htm\" rel=\"nofollow\">Here's something</a> like this would import multiple files:</p>\n\n<pre><code>    Dim strPathFile As String, strFile As String, strPath As String\n    Dim strTable As String\n    Dim blnHasFieldNames As Boolean\n    blnHasFieldNames = False\n    strTable = \"tablename\"\n    strFile = Dir(strPath &amp; \"*.xls\")\n    Do While Len(strFile) &gt; 0\n          strPathFile = strPath &amp; strFile\n          DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, _\n                strTable, strPathFile, blnHasFieldNames\n          strFile = Dir()\n    Loop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 0, "creation_date": 1470187611, "post_id": 38732541, "comment_id": 64841870, "body": "Hi @David Zemens thank you for your thoughtful answer. I edited my code in the original question...but may have gotten some of the syntax wrong. It is telling me that the last three lines under <code>Filter Data</code> have incorrec syntax. What am i doing wrong? (I am a vba novice)"}, {"owner": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 0, "creation_date": 1470187664, "post_id": 38732541, "comment_id": 64841883, "body": "also how do i refer to the listobjects by name instead of index ##?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 0, "creation_date": 1470187949, "post_id": 38732541, "comment_id": 64841940, "body": "You can&#39;t have an empty line after the <code>AutoFilter_</code>, get rid of the empty line and that should avoid the compile error. A <code>ListObject</code> has a name, and unless you&#39;ve done it manually it is probably like &quot;Table1&quot; etc., but you should be able to see these from the Table Tools ribbon, and edit it there too if needed: <a href=\"http://imgur.com/a/otxHA\" rel=\"nofollow noreferrer\">imgur.com/a/otxHA</a>"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1470184419, "creation_date": 1470184419, "answer_id": 38732541, "question_id": 38732442, "link": "https://stackoverflow.com/questions/38732442/filtering-multiple-tables-at-once-via-a-search-box-on-excel/38732541#38732541", "title": "Filtering multiple tables at once via a search box on excel", "body": "<blockquote>\n  <p>Is there any way to code the searchbox to refer to multiple tables in multiple sheets? </p>\n</blockquote>\n\n<p>Nope. As you may have gathered somewhat, your attempt doesn't work, but it's enough that I think I understand what you're trying to do:</p>\n\n<blockquote>\n  <p>Set DataRange = sheets.ListObjects(\"January\"\"February\"\"March\").Range </p>\n</blockquote>\n\n<p>For a number of reasons it's invalid syntax (as you're probably aware) but you also can't assign a range that spans multiple worksheets.  What you're looking for is going to be done in a loop, instead of 1 range you're going to have 13 ranges (or however many you need).</p>\n\n<blockquote>\n  <p>I would need to identify the worksheet name, and the table name. I'm\n  not sure how to do this</p>\n</blockquote>\n\n<p>You can refer to the sheets by Name or Index, e.g.:</p>\n\n<pre><code>Worksheets(1) '## Refers to the first sheet in the book\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>Worksheets(\"January\") '## Refers to worksheet named 'January' or raise error if sheet name doesn't exist\n</code></pre>\n\n<p>What you'll need to do is a <code>For/Each</code> loop, and handle each sheet successively, if you want a handle on all of their respective ranges, dump them in to a collection or dictionary:</p>\n\n<pre><code>Dim dict as Object\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\nDim i as Long\nFor i = 1 to 13 'Modify as needed\n    '## Assumes only 1 ListObject table on each sheet; if there are multiple,\n    '  you should refer to the ListObjects by name instead of index\n    Set dict(i) = Worksheets(i).ListObjects(1).Range\nNext\n</code></pre>\n\n<p>Then, later you would apply the filter in a similar loop. Since the <code>dict</code> Values <em>are</em> ranges, you can work directly with the <code>dict</code> object like so:</p>\n\n<pre><code>For i = 1 to 13\n    dict(i).AutoFilter ...\n\n\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 0, "creation_date": 1470189167, "post_id": 38732939, "comment_id": 64842202, "body": "Hi @Thomas Inzinia thanks for your solution, however I get an error message saying &quot;expected: end of statement&quot; after the <code>mySearch = &quot;=*&quot; &amp; mySearch &quot;*&quot;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 0, "creation_date": 1470189358, "post_id": 38732939, "comment_id": 64842254, "body": "You sample should look like this: <code>mySearch = &quot;=*&quot; &amp; mySearch &amp; &quot;*&quot;</code>.  It is correct in my answer."}, {"owner": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 0, "creation_date": 1470190405, "post_id": 38732939, "comment_id": 64842475, "body": "Hi @Thomas, apologies. I didn&#39;t notice my typo. I put in your entire solution, and when I run it, an error message pops up telling me &quot;object required&quot; for the <code>FilterTable MonthName (m), FieldName, mySearch. True</code> line. How does the <code>m = 1 to 12</code> line work? Can this code be edited to just list out the 12 listobjects?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 0, "creation_date": 1470190741, "post_id": 38732939, "comment_id": 64842559, "body": "MonthName takes a number from 1 to 12 and returns the name of the month based on that number (e.g. <code>Month(1) returns January</code>)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 0, "creation_date": 1470190984, "post_id": 38732939, "comment_id": 64842610, "body": "I assumed that your tables are named after the months.  What are the table names?"}, {"owner": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 0, "creation_date": 1470191110, "post_id": 38732939, "comment_id": 64842638, "body": "Yes, the Sheet name that each table is in (one per sheet) is the short form of each month (ex: Jan, Feb, Mar) and each table is titled &quot;January, February, March&quot;"}, {"owner": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "edited": false, "score": 0, "creation_date": 1470191405, "post_id": 38732939, "comment_id": 64842705, "body": "Not exactly sure what I did wrong the first time around, but it works now!!! thank you so much."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1470191767, "last_edit_date": 1470191767, "creation_date": 1470187923, "answer_id": 38732939, "question_id": 38732442, "link": "https://stackoverflow.com/questions/38732442/filtering-multiple-tables-at-once-via-a-search-box-on-excel/38732939#38732939", "title": "Filtering multiple tables at once via a search box on excel", "body": "<p>You should be able to reference the ListObjects by name using <code>Range(Name)</code>.</p>\n\n<p>I extracted the filter process into it's own sub.  I also added an optional parameter ClearFilters.  This will give you the option to stack the filters.</p>\n\n<pre><code>Sub ApplyFilters()\n    Dim FieldName As String, mySearch As Variant\n    Dim myButton As OptionButton\n    Dim m As Integer\n\n    For Each myButton In ActiveSheet.OptionButtons\n        If myButton.Value = 1 Then\n            FieldName = myButton.Text\n            Exit For\n        End If\n    Next myButton\n\n    mySearch = ActiveSheet.Shapes(\"StaffLookUp\").TextFrame.Characters.Text    'Control Form\n    mySearch = \"=*\" &amp; mySearch &amp; \"*\"\n\n    For m = 1 To 12\n\n       FilterTable MonthName(m), FieldName, mySearch, True\n\n    Next\n\nEnd Sub\n\n\nSub FilterTable(TableName As String, FieldName As String, mySearch As Variant, Optional ClearFilters As Boolean = False)\n    Dim DataRange As Range, FilterColumn As Integer\n\n    On Error Resume Next\n    Set DataRange = Range(TableName)\n    On Error GoTo 0\n\n    If DataRange Is Nothing Then\n        MsgBox TableName &amp; \" not found\"\n        Exit Sub\n    End If\n\n    If ClearFilters Then\n        On Error Resume Next\n        DataRange.Worksheet.ShowAllData\n        On Error GoTo 0\n    End If\n\n    On Error Resume Next\n    FilterColumn = DataRange.ListObject.ListColumns(FieldName).Index\n    On Error GoTo 0\n\n    If FilterColumn = 0 Then\n        MsgBox TableName &amp; \": \" &amp; FieldName &amp; \" not found\"\n        Exit Sub\n    End If\n\n    DataRange.AutoFilter _\n            Field:=FilterColumn, _\n            Criteria1:=mySearch, _\n            Operator:=xlAnd\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1599, "favorite_count": 1, "accepted_answer_id": 38732939, "answer_count": 2, "score": 1, "last_activity_date": 1470191767, "creation_date": 1470183534, "last_edit_date": 1470187533, "question_id": 38732442, "link": "https://stackoverflow.com/questions/38732442/filtering-multiple-tables-at-once-via-a-search-box-on-excel", "title": "Filtering multiple tables at once via a search box on excel", "body": "<p>I have an excel workbook with 13 sheets (one for each month in the year + a main sheet) and an identical table of employee stats in each sheet. The employee stat table is named after it's corresponding month and has identical column headers. \nI have a dashboard on the main sheet that has charts pulling from the other tables. </p>\n\n<p><strong>I want to create a searchbox that will allow you to filter all of the tables in their respective worksheets at once</strong> </p>\n\n<p>Here is the line of code that I can't figure out. I am attempting to make the filter range refer to more than one table.</p>\n\n<pre><code> Set DataRange = sheets.ListObjects(\"January\"\"February\"\"March\").Range \n</code></pre>\n\n<p>Is there any way to code the searchbox to refer to multiple tables in multiple sheets? I would need to identify the worksheet name, and the table name. I'm not sure how to do this</p>\n\n<p>For reference, January is the table in the sheet titled \"Jan\". </p>\n\n<p>Here is the full code I use: </p>\n\n<pre><code> Sub SearchBox()\n  Dim dict as Object\n  Set dict = CreateObject(\"Scripting.Dictionary\")\n\n Dim i as Long\n For 1 = 3 to 14\n Set dict(i) = Worksheets(i).ListObjects(1).Range\n\n   Dim myButton As OptionButton\n   Dim MyVal As Long\n   Dim ButtonName As String\n   Dim sht As Worksheet\n   Dim myField As Long\n   Dim DataRange As Range\n   Dim mySearch As Variant\n\n  'Load Sheet into A Variable\n   Set sht = ActiveSheet\n\n 'Unfilter Data (if necessary)\n  On Error Resume Next\n  sht.ShowAllData\n  On Error GoTo 0\n\n 'Filtered Data Range (include column heading cells)\n\n   dict(i).Autofilter_\n\n   Field:=myField,_\n   Criteria1:=\"=*\" &amp; mySearch &amp; \"*\", _\n   Operator:=xlAnd\n\n   Next\n\n  'Retrieve User's Search Input\n   mySearch = sht.Shapes(\"StaffLookUp\").TextFrame.Characters.Text 'Control Form\n\n\n   'Loop Through Option Buttons\n    For Each myButton In ActiveSheet.OptionButtons\n    If myButton.Value = 1 Then\n    ButtonName = myButton.Text\n    Exit For\n      End If\n     Next myButton\n\n  'Determine Filter Field\n   On Error GoTo HeadingNotFound\n   myField = Application.WorksheetFunction.Match(ButtonName,          DataRange.Rows(1), 0)\n  On Error GoTo 0\n\n  'Filter Data\n   DataRange.AutoFilter _\n     Field:=myField, _\n     Criteria1:=\"=*\" &amp; mySearch &amp; \"*\", _\n     Operator:=xlAnd\n\n  'Clear Search Field\n   sht.Shapes(\"UserSearch\").TextFrame.Characters.Text = \"\" 'Control Form\n\n\nExit Sub\n\n'ERROR HANDLERS\nHeadingNotFound:\n MsgBox \"The column heading [\" &amp; ButtonName &amp; \"] was not found in cells \" &amp;        DataRange.Rows(1).Address &amp; \". \" &amp; _\n vbNewLine &amp; \"Please check for possible typos.\", vbCritical, \"Header Name Not Found!\"\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1470182545, "post_id": 38732297, "comment_id": 64840698, "body": "<code>MyRangeArray</code> has only one member (indexed at 0), but <code>MySlideArray</code> has 5 elements (0 to 4)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1470183093, "post_id": 38732297, "comment_id": 64840831, "body": "Do simply: <code>MyRangeArray = Sheet1.Range(&quot;A2:B10&quot;).Value2</code>. Otherwise, see <a href=\"http://stackoverflow.com/questions/35157187/copying-table-from-excel-into-powerpoint-using-a-predefined-template/35228836#35228836\">this</a> for better reliable way to copy/paste from Excel to PowerPoint using the <code>ExecuteMSO</code> method."}], "owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1470188702, "creation_date": 1470182353, "last_edit_date": 1531164843, "question_id": 38732297, "link": "https://stackoverflow.com/questions/38732297/how-can-i-make-powerpoint-slides-for-excel-each-range-in-vba", "title": "How can I Make PowerPoint slides for excel each Range in VBA", "body": "<p>How can I make powerpoint slides based on Excel Range A2:B2. All the characters(countryname) for excel rows A1 to A10 make it as a Powerpoint Slide.</p>\n\n<p>Here is the Code that is throwing an array error:</p>\n\n<pre><code>Sub PasteMultipleSlides()\n    Dim myPresentation As Object\n    Dim mySlide As Object\n    Dim PowerPointApp As Object\n    Dim shp As Object\n    Dim MySlideArray As Variant\n    Dim MyRangeArray As Variant\n    Dim x As Long\n\n    On Error Resume Next\n\n    Set PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n\n    'Clear the error between errors\n    Err.Clear\n\n    'If PowerPoint is not already open then Exit\n    If PowerPointApp Is Nothing Then\n        MsgBox \"PowerPoint Presentation is not open, aborting.\"\n        Exit Sub\n    End If\n\n    'Handle if the PowerPoint Application is not found\n    If Err.Number = 429 Then\n        MsgBox \"PowerPoint could not be found, aborting.\"\n        Exit Sub\n    End If\n\n    On Error GoTo 0\n\n    'Make PowerPoint Visible and Active\n    PowerPointApp.ActiveWindow.Panes(2).Activate\n\n    'Create a New Presentation\n    Set myPresentation = PowerPointApp.ActivePresentation\n\n    'List of PPT Slides to Paste to\n    MySlideArray = Array(2, 3, 4, 5, 6)\n\n    'List of Excel Ranges to Copy from\n    MyRangeArray = Array(Sheet1.Range(\"A2:B10\"))\n\n    'Loop through Array data\n    For x = LBound(MySlideArray) To UBound(MySlideArray)\n        'Copy Excel Range\n        MyRangeArray(x).Copy\n\n        'Paste to PowerPoint and position\n        On Error Resume Next\n        Set shp = myPresentation.Slides(MySlideArray(x)).Shapes.PasteSpecial(DataType:=2)    'Excel 2007-2010\n        Set shp = PowerPointApp.ActiveWindow.Selection.ShapeRange    'Excel 2013\n        On Error GoTo 0\n\n        'Center Object\n        With myPresentation.PageSetup\n            shp.Left = (.SlideWidth \\ 2) - (shp.Width \\ 2)\n            shp.Top = (.SlideHeight \\ 2) - (shp.Height \\ 2)\n        End With\n\n    Next x\n\n    'Transfer Complete\n    Application.CutCopyMode = False\n    ThisWorkbook.Activate\n    MsgBox \"Complete!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470185943, "post_id": 38732007, "comment_id": 64841515, "body": "What comes back if you check dB.RecordsAffected right after dB.execute."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1470186537, "post_id": 38732007, "comment_id": 64841641, "body": "Where do you receive the error message? What line? Does the data get inserted? Does the SQL match your manual sql effort?"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1470212122, "post_id": 38732007, "comment_id": 64850644, "body": "Are you getting this message because you have table level properties; <code>required: yes</code> and <code>allow zero length: No</code>?"}, {"owner": {"reputation": 23, "user_id": 6576980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff7cbeb11dbf36a4ebcea0f3683a640?s=128&d=identicon&r=PG&f=1", "display_name": "randomname", "link": "https://stackoverflow.com/users/6576980/randomname"}, "edited": false, "score": 0, "creation_date": 1470241477, "post_id": 38732007, "comment_id": 64871760, "body": "I edited the description to include the AssignmentQuery values and a constraint on the table. When I create a query, they both do what&#39;s expected. For the insert, when I click on another row, I get the error message, even though the record was actually inserted into my table. I have to hit escape to move to another record, but my changes are preserved. If I put me.requery or me.dirty = false into my code, I get the error at that line. For the update, I get the &quot;Write Conflict&quot; error message, but when I save my changes it behaves as expected."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1470243795, "post_id": 38732007, "comment_id": 64873173, "body": "The insert/update sql looks valid. Try <code>db.Execute AssignmentQuery, dbFailOnError</code> to see if it throws an error."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6576980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff7cbeb11dbf36a4ebcea0f3683a640?s=128&d=identicon&r=PG&f=1", "display_name": "randomname", "link": "https://stackoverflow.com/users/6576980/randomname"}, "edited": false, "score": 0, "creation_date": 1470241644, "post_id": 38739977, "comment_id": 64871853, "body": "Thanks for the feedback, I&#39;ve taken that into account and updated the description."}, {"owner": {"reputation": 23, "user_id": 6576980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff7cbeb11dbf36a4ebcea0f3683a640?s=128&d=identicon&r=PG&f=1", "display_name": "randomname", "link": "https://stackoverflow.com/users/6576980/randomname"}, "edited": false, "score": 0, "creation_date": 1470265247, "post_id": 38739977, "comment_id": 64883718, "body": "A temp table worked great, I added &quot;select ... into&quot; for my recordsource query, then used my temp table as the form&#39;s recordsource.  Thanks!"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 0, "last_activity_date": 1470244177, "last_edit_date": 1470244177, "creation_date": 1470217401, "answer_id": 38739977, "question_id": 38732007, "link": "https://stackoverflow.com/questions/38732007/how-to-avoid-a-you-must-enter-a-value-error-message-in-access-vba/38739977#38739977", "title": "How to avoid a &quot;You must enter a value&quot; error message in Access VBA", "body": "<p>Beware of wrong datatypes, each <code>Dim</code> needs its own datatype!</p>\n\n<pre><code>Dim CurrentUser As String, AssignmentQuery As String\nDim SelectedUserID As Long, SelectedTaskID As Long  ' don't use 16-bit Integer for ID columns\nDim ShouldInsert As Boolean, IsAssigned As Boolean\n</code></pre>\n\n<hr>\n\n<p>To avoid troubles with date/time formatting: the database engine knows <code>Now()</code>, so you can directly use this in the Insert SQL:</p>\n\n<pre><code>AssignmentQuery = \"insert into TaskAssignments (UserID, taskID, DateAssignmentUpdated, AssignmentUpdatedBy, is_assigned) values \" _\n&amp; vbCrLf &amp; \"(\" &amp; SelectedUserID &amp; \",\" &amp; SelectedTaskID &amp; \", Now(), '\" &amp; CurrentUser &amp; \"',\" &amp; IsAssigned &amp; \");\"\n</code></pre>\n\n<p>If it still doesn't work, use <code>Debug.Print AssignmentQuery</code> instead of <code>MsgBox</code> and add the actual SQL to your question (Ctrl+G shows the output).</p>\n\n<hr>\n\n<p><strong>Edit</strong></p>\n\n<p>Re-reading the question and comment, I think the problem is:</p>\n\n<p>You are editing a bound form, and are updating/inserting in the same table the form is based on. That's where the Write conflict on Update comes from, the other error is probably because the bound form is trying to insert a record when you click <code>is_assigned</code>, but can't.</p>\n\n<p>So yes, you need to rethink your approach, at least partially. </p>\n\n<p>One solution is to insert the recordsource into a temp table, and base your form on that. Then the rest of the code will probably work.</p>\n\n<p>It may be over-complicating things, though.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6595855, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153661426967411/picture?type=large", "display_name": "Abe Mauricio", "link": "https://stackoverflow.com/users/6595855/abe-mauricio"}, "is_accepted": false, "score": 0, "last_activity_date": 1527794068, "creation_date": 1527794068, "answer_id": 50631287, "question_id": 38732007, "link": "https://stackoverflow.com/questions/38732007/how-to-avoid-a-you-must-enter-a-value-error-message-in-access-vba/50631287#50631287", "title": "How to avoid a &quot;You must enter a value&quot; error message in Access VBA", "body": "<p>I got this problem trying to update a field that use to be a primary field in my table. When I altered what was considered the primary field I assume access would automatically stop enforcing is not null, but for some reason it didn't.</p>\n\n<p>I fixed it by deleting the field, saving the table recreating the field and saving the table and the problem went away. Of course this wouldn't be an ideal solution if you have data in that table you don't want to lose so you might want to try backing it up first, before you give the solution a try, then reinserting the values.</p>\n"}], "owner": {"reputation": 23, "user_id": 6576980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff7cbeb11dbf36a4ebcea0f3683a640?s=128&d=identicon&r=PG&f=1", "display_name": "randomname", "link": "https://stackoverflow.com/users/6576980/randomname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7620, "favorite_count": 0, "accepted_answer_id": 38739977, "answer_count": 2, "score": 2, "last_activity_date": 1527794068, "creation_date": 1470180406, "last_edit_date": 1470243422, "question_id": 38732007, "link": "https://stackoverflow.com/questions/38732007/how-to-avoid-a-you-must-enter-a-value-error-message-in-access-vba", "title": "How to avoid a &quot;You must enter a value&quot; error message in Access VBA", "body": "<p>I'm having issues avoiding a \"You must enter a value in the __ field\" error message in Access 2016. I have three tables, Tasks, Users, and TaskAssignments, and a split form that looks like:</p>\n\n<pre><code>User    Task    Assigned?\n\nUser1   Task1   True\nUser1   Task2   False\nUser1   Task3   True\nUser2   Task1   False\nUser2   Task2   False\nUser2   Task3   True\nUser3   Task1   True\nUser3   Task2   True\nUser3   Task3   True\n</code></pre>\n\n<p>Each task can have multiple users assigned to it, and each user is assigned to multiple tasks. I want my form to display every possible value, then use a checkbox, so that I can click and add a user to that task. The TaskAssignments table has a primary key and a unique constraint on both TaskID and UserID.</p>\n\n<p>The recordsource for my form is a query:</p>\n\n<pre><code>select x.UserName, x.TaskName, ta.is_assigned\nfrom (select * from Tasks, Users) x\nleft join TaskAssignments ta on (ta.TaskID = x.TaskID and ta.UserID = x.UserID)\n</code></pre>\n\n<p>I have an on click event that checks if a record exists in TaskAssignments and either updates or inserts into TaskAssignments. When I debug.print and manually run my queries, they both do what's expected. When I manually insert a record into my TaskAssignments table, my form behaves how I expect. When I need to insert a new record, however, I receive a message stating that I must enter a TaskID in TaskAssignments.</p>\n\n<p>I've tried requerying the form, but I still receive the error message. Why can't it find the record that I just inserted?</p>\n\n<p>Help please?!? Do I need to drastically rethink my approach here?</p>\n\n<p>Here's the VBA:</p>\n\n<pre><code>Private Sub is_assigned_Click()\n\nDim CurrentUser, AssignmentQuery As String, SelectedUserID, SelectedTaskID As Integer\nDim ShouldInsert, IsAssigned As Boolean\n\nCurrentUser = Environ$(\"Username\")\nSelectedUserID = Me.UserID\nSelectedTaskID = Me.TaskID\nIsAssigned = Me.is_assigned\n\nDim db As DAO.Database, rs As DAO.Recordset, strSQL As String\nSet db = CurrentDb\nstrSQL = \"select UserID, taskID from TaskAssignments where UserID=\" &amp; SelectedUserID &amp; \" and taskID =\" &amp; SelectedTaskID &amp; \";\"\n\nSet rs = db.OpenRecordset(strSQL)\n\nIf rs.EOF = True Then\n    ShouldInsert = True\n    Else: ShouldInsert = False\nEnd If\n\nIf ShouldInsert = True Then\n    AssignmentQuery = \"insert into TaskAssignments (UserID, taskID, DateAssignmentUpdated, AssignmentUpdatedBy, is_assigned) values \" _\n    &amp; vbCrLf &amp; \"(\" &amp; SelectedUserID &amp; \",\" &amp; SelectedTaskID &amp; \",#\" &amp; Now &amp; \"#,'\" &amp; CurrentUser &amp; \"',\" &amp; IsAssigned &amp; \");\"\n\nElseIf ShouldInsert = False Then\n    AssignmentQuery = \"update TaskAssignments set UserID=\" &amp; SelectedUserID &amp; \", DateAssignmentUpdated=#\" &amp; Now &amp; \"#, AssignmentUpdatedBy='\" &amp; CurrentUser &amp; \"',is_assigned=\" &amp; IsAssigned _\n    &amp; vbCrLf &amp; \" where taskID = \" &amp; SelectedTaskID &amp; \" And UserID = \" &amp; SelectedUserID &amp; \";\"\nEnd If\n\nMsgBox AssignmentQuery\ndb.Execute (AssignmentQuery)\n\nForms(\"Task Assignments\").Requery\n\nSet rs = Nothing\nSet db = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit</strong> - here are the queries produced:</p>\n\n<p><strong>Insert</strong></p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>insert into TaskAssignments \n(UserID, TaskID, DateAssignmentUpdated, AssignmentUpdatedBy, is_assigned) \nvalues (301,4,Now(),'mylogin',True);\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>update TaskAssignments \nset UserID=270, DateAssignmentUpdated=Now(), AssignmentUpdatedBy='mylogin', is_assigned=False\nwhere TaskID = 1 And UserID = 270;\n</code></pre>\n\n<p>And a constraint on my TaskAssignments table. Both TaskID and UserID are set as required in my table design (which was my whole goal - I was hoping to avoid adding records to TaskAssignments until the user has actually been assigned to a task).</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>alter table TaskAssignments add constraint TaskAssignmentsConstraint unique (TaskID, UserID);\n</code></pre>\n"}, {"tags": ["excel", "error-handling", "vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470179505, "post_id": 38731764, "comment_id": 64840007, "body": "what is <code>PopulateHood1Qs.PopulateHood1Qs</code> is it modulename.subname? if yes then that&#39;s the issue. Use different names for modules and subs. what do you mean by not working? do you get any error? why doing this  <code>onaction = nothing</code>?"}, {"owner": {"reputation": 5, "user_id": 6669757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80c38ef545177585b512f5e3b99078d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doomz", "link": "https://stackoverflow.com/users/6669757/j-doomz"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1470181270, "post_id": 38731764, "comment_id": 64840434, "body": "&#39;PopulateHood1Qs.PopulateHood1Qs&#39; is a modulename.subname, so I got really excited and changed them and I&#39;m still getting the same results. It&#39;s not that it&#39;s populating an error, it&#39;s that it&#39;s just not populating. The initial module the form box calls is &#39;PopulateQuestions&#39;, which then in turn determines how many ranges to add (HoodRng1/2/3/4) and then designates those ranges and calls separate modules &#39;PopulateHood1Qs.PopulateHood1Qs(1)&#39;. The &#39;.onaction = nothing&#39; was added as a desparate attempt to reset the range to get it to switch between the two modules and it worked so I kept it."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1470183035, "post_id": 38731764, "comment_id": 64840812, "body": "If there&#39;s no error on calling (eg) <code>PopulateHood1Qs</code>, but it doesn&#39;t seem to do anything, then most likely the problem is in that procedure (and the others which also do nothing).  You don&#39;t show that code so it&#39;s not possible to offer any further suggestions."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1470184298, "post_id": 38731764, "comment_id": 64841133, "body": "Put some breakpoints in <code>PopulateHood1Qs</code> and see where it reaches."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6669757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80c38ef545177585b512f5e3b99078d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doomz", "link": "https://stackoverflow.com/users/6669757/j-doomz"}, "edited": false, "score": 0, "creation_date": 1470185627, "post_id": 38732444, "comment_id": 64841444, "body": "It&#39;s set up so that ans1rng.value can only be 1, 2, 3, or 4. I put breakpoints throughout PopulateQuestions, but when I run it from the module it works, it&#39;s just when I try to run from the boxes that it doesn&#39;t work."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 5, "user_id": 6669757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80c38ef545177585b512f5e3b99078d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doomz", "link": "https://stackoverflow.com/users/6669757/j-doomz"}, "edited": false, "score": 0, "creation_date": 1470186223, "post_id": 38732444, "comment_id": 64841582, "body": "By boxes do you mean buttons?"}, {"owner": {"reputation": 5, "user_id": 6669757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80c38ef545177585b512f5e3b99078d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doomz", "link": "https://stackoverflow.com/users/6669757/j-doomz"}, "edited": false, "score": 0, "creation_date": 1470186295, "post_id": 38732444, "comment_id": 64841600, "body": "Yes the buttons, sorry. Specifically that one &quot;RunBox&quot; button."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 5, "user_id": 6669757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80c38ef545177585b512f5e3b99078d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doomz", "link": "https://stackoverflow.com/users/6669757/j-doomz"}, "edited": false, "score": 0, "creation_date": 1470188115, "post_id": 38732444, "comment_id": 64841982, "body": "Do you have to keep adding and deleting the button?  Could you just hide it?  Have you tried assigning the macro manually to the buttons?  if so, does the macro run that way?"}, {"owner": {"reputation": 5, "user_id": 6669757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80c38ef545177585b512f5e3b99078d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doomz", "link": "https://stackoverflow.com/users/6669757/j-doomz"}, "edited": false, "score": 0, "creation_date": 1470189193, "post_id": 38732444, "comment_id": 64842207, "body": "This was originally intended to delete and re-add the sheet as it ran each time, but I&#39;ve only recently found out the sheets can&#39;t be deleted. So theoretically it doesn&#39;t have to be deleted each time. And yes I tried created a new button and assigning it manually and it still gives me the same thing. I know I must be doing something monumentally stupid, but I haven&#39;t found out it is."}, {"owner": {"reputation": 5, "user_id": 6669757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80c38ef545177585b512f5e3b99078d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doomz", "link": "https://stackoverflow.com/users/6669757/j-doomz"}, "edited": false, "score": 0, "creation_date": 1470190369, "post_id": 38732444, "comment_id": 64842468, "body": "....the ones that say Answer All Questions to the Left populate little red/grey boxes for Hoods 1/2/3/4 whatever the hood count is? And they look like they&#39;re properly merged?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 5, "user_id": 6669757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80c38ef545177585b512f5e3b99078d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doomz", "link": "https://stackoverflow.com/users/6669757/j-doomz"}, "edited": false, "score": 0, "creation_date": 1470190468, "post_id": 38732444, "comment_id": 64842486, "body": "Worksheets Hazard 1 RunBox has ` &#39;Macro Workbook 2.xlsm&#39;!PopulateQuestions.PopulateQuestions` assigned to it instead of <code>PopulateQuestions.PopulateQuestions1</code>"}, {"owner": {"reputation": 5, "user_id": 6669757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80c38ef545177585b512f5e3b99078d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doomz", "link": "https://stackoverflow.com/users/6669757/j-doomz"}, "edited": false, "score": 0, "creation_date": 1470190680, "post_id": 38732444, "comment_id": 64842539, "body": "Whoops, I knew I missed one. Sorry about that. But the others populate the Hood 1/2/3/4 sections properly for you?"}, {"owner": {"reputation": 5, "user_id": 6669757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80c38ef545177585b512f5e3b99078d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doomz", "link": "https://stackoverflow.com/users/6669757/j-doomz"}, "edited": false, "score": 0, "creation_date": 1470191006, "post_id": 38732444, "comment_id": 64842615, "body": "So I downloaded the one from my shared drive instead of using the one on my desktop and for some reason now it&#39;s working, so whatever changes you&#39;ve inspired me to make have at some point fixed the problem/maybe this was all just user error/lack of sleep. I applaud your patience and aide, and I apologize for being a n00b. Thanks for putting up with me :D"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1470183541, "creation_date": 1470183541, "answer_id": 38732444, "question_id": 38731764, "link": "https://stackoverflow.com/questions/38731764/excel-vba-error-calling-sub-from-control-form-box/38732444#38732444", "title": "Excel VBA Error Calling Sub From Control Form Box", "body": "<p>I agree with Tim Williams; the problem is probably with <strong>Populate1HoodQs</strong> and <strong>PopulateQuestions</strong>.  I tested the code and had no  problems.  Have you tries putting breakpoints in the <strong>Populate1HoodQs</strong> and <strong>PopulateQuestions</strong>  to see if they are actually being called or not?</p>\n\n<p>The module name is optional. What if <code>Ans1Rng.Value = 0</code> or <code>Ans1Rng.Value = \"\"</code>?  I agree with </p>\n\n<p>I get an error on <code>.Display3DShading = True</code>.</p>\n\n<pre><code>Const RUNBOX_NAME = \"RunBox\"\n\nOn Error Resume Next\nwks.Shapes.Range(RUNBOX_NAME).Delete\nOn Error GoTo 0\n\nSet RunBoxRng = Ans1Rng.Offset(3, 3)\n\n'Adds button to populate the rest of the questions\nWith RunBoxRng.Resize(3, 2)\n    Set RunBox = wks.Buttons.Add(.Left, .Top, .Width, .Height)\nEnd With\nWith RunBox\n    .Name = RUNBOX_NAME\n    .Characters.Text = \"Answer All Questions to the Left Then Click Here\"\n    With .Characters(Start:=1, Length:=48).Font\n        .FontStyle = \"Bold\"\n        .Size = 12\n    End With\n    '.Display3DShading = True\n    .OnAction = IIf(Ans1Rng.Value = 1, \"Populate1HoodQs\", \"PopulateQuestions\")\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6669757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80c38ef545177585b512f5e3b99078d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doomz", "link": "https://stackoverflow.com/users/6669757/j-doomz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 38732444, "answer_count": 1, "score": 0, "last_activity_date": 1470184856, "creation_date": 1470178700, "last_edit_date": 1531164843, "question_id": 38731764, "link": "https://stackoverflow.com/questions/38731764/excel-vba-error-calling-sub-from-control-form-box", "title": "Excel VBA Error Calling Sub From Control Form Box", "body": "<p>I'm in the process of building a very-rushed and multi-tiered macro in VBA that is supposed to do the following things:</p>\n\n<ol>\n<li>User chooses number 1-4 on starting sheet; additional sheets 1 - 4 appear and call the first module to format the worksheets (Works successfully)</li>\n<li>User navigates to the first of the 4 worksheets and answers question 1, then 2-4 populate (works successfully)</li>\n<li>User fills out questions 2-4 (maybe more depending on criteria) and clicks the button (control form, not active-x) to run a macro from another sub (This is where it fails)</li>\n</ol>\n\n<p>If I run it from the module itself, the code that the button is assigned to works. If I run it from the button, it doesn't follow through with the secondary sub calls (Example: It adds \"Hood 1\" to a range value like it should, but then it doesn't follow-up with the macro call to format the column listed under \"Hood 1\"</p>\n\n<p>Add runbox:</p>\n\n<pre><code>    'Removes the old run button\nWks.Shapes.Range(Array(\"RunBox\")).Delete\nSet RunBoxRng = Nothing\nSet RunBoxRng = Ans1Rng.Offset(3, 3)\n\n'Adds button to populate the rest of the questions\nWith RunBoxRng.Resize(3, 2)\n    Set RunBox = Wks.Buttons.Add(.Left, .Top, .Width, .Height)\nEnd With\nWith RunBox\n    .Name = \"RunBox\"\n    .Characters.Text = \"Answer All Questions to the Left Then Click Here\"\n    With .Characters(Start:=1, Length:=48).Font\n        .FontStyle = \"Bold\"\n        .Size = 12\n    End With\n    .Display3DShading = True\n    If Ans1Rng.Value &gt; 1 Then\n        .OnAction = Nothing\n        .OnAction = \"PopulateQuestions.PopulateQuestions\"\n    End If\n    If Ans1Rng.Value = 1 Then\n        .OnAction = Nothing\n        .OnAction = \"Populate1HoodQs.Populate1HoodQs\"\n    End If\n    .Locked = False\nEnd With\n</code></pre>\n\n<p>That will successfully pull from the other modules, but won't let those modules call their secondary subs. </p>\n\n<p>Secondary sub call example:</p>\n\n<pre><code>If Not HoodRng1 Is Nothing Then\n    HoodRng1.Value = \"Hood 1\"              'Works\n    Call PopulateHood1Qs.PopulateHood1Qs   'Doesn't work\nEnd If\nIf Not HoodRng2 Is Nothing Then\n    HoodRng2.Value = \"Hood 2\"              'Works\n    Call PopulateHood2Qs.PopulateHood2Qs   'Doesn't work\nEnd If\nIf Not HoodRng3 Is Nothing Then\n    HoodRng3.Value = \"Hood 3\"              'Works\n    Call PopulateHood3Qs.PopulateHood3Qs   'Doesn't work\nEnd If\nIf Not HoodRng4 Is Nothing Then\n    HoodRng4.Value = \"Hood 4\"              'Works\n    Call PopulateHood4Qs.PopulateHood4Qs  'Doesn't work\nEnd If\n</code></pre>\n\n<p>I haven't slept in around 36 hours because of this thing, and I can't find a way to get it to work without having to manually run it from the module. And it also makes it so that the FormatMerging sub I have can't be called for them either. PLEASE SOMEONE SAVE ME, WHAT AM I DOING WRONG?! </p>\n\n<p>Edit: First part of the secondary PopulateHood1Qs1 module:</p>\n\n<pre><code>       Set HoodRng1 = Nothing\nSet Ans2Rng = Nothing\nSet Ans3Rng = Nothing\nSet Ans4Rng = Nothing\nSet HoodRng1 = .UsedRange.Find(What:=\"Hood 1\", LookAt:=xlWhole)\nSet Ans2Rng = .UsedRange.Find(What:=\"General Questions\").Offset(4, 4)\nSet Ans3Rng = Ans2Rng.Offset(2)\nSet Ans4Rng = Ans3Rng.Offset(2)\n\n'Defines hood question strings\nHoodQ = \"What is the length of Hood 1?\"\nASPQ = \"How many appliance specific coverages are required?\"\nZODQ = \"Is the Hood protected by continuous Linear Heat Detection?\"\nZOPQ = \"How many Zones of Protection are there?\"\nDuctQ = \"How many ducts are in Hood 1?\"\n\n'Defines question ranges\nSet Q1Rng1 = Nothing\nSet Q2Rng1 = Nothing\nSet Q3Rng1 = Nothing\nSet Q4Rng1 = Nothing\nSet Q5Rng1 = Nothing\nSet Ans1Rng1 = Nothing\nSet Ans2Rng1 = Nothing\nSet Ans3Rng1 = Nothing\nSet Ans4Rng1 = Nothing\nSet Ans5Rng1 = Nothing\nSet Q1Rng1 = HoodRng1.Offset(2)\nSet Q2Rng1 = Q1Rng1.Offset(2)\nSet Q3Rng1 = Q2Rng1.Offset(2)\nSet Q4Rng1 = Q3Rng1.Offset(2)\nSet Q5Rng1 = Q4Rng1.Offset(2)\nSet Ans1Rng1 = Q1Rng1.Offset(, LineSz)\nSet Ans2Rng1 = Q2Rng1.Offset(, LineSz)\nSet Ans3Rng1 = Q3Rng1.Offset(, LineSz)\nSet Ans4Rng1 = Q4Rng1.Offset(, LineSz)\nSet Ans5Rng1 = Q5Rng1.Offset(, LineSz)\n\n'Adds questions 1 &amp; 2\nQ1Rng1.Value = \"1. \" &amp; HoodQ\nQ2Rng1.Value = \"2. \" &amp; ASPQ\n\n'Determines where to add the next question\nSet NextQRng = Q3Rng1\n\n'If adding linear heat\nIf Ans2Rng.Value = 2 Then\n    NextQRng.Value = ZODQ\n    Set NextQRng = NextQRng.Offset(2)\nEnd If\n\n'If adding ZOP\nIf Ans3Rng.Value = 2 Then\n    NextQRng.Value = ZOPQ\n    Set NextQRng = NextQRng.Offset(2)\nEnd If\n\n'If adding ducts\nIf Ans4Rng.Value = 2 Then\n    If NextQRng.Offset(-2).Value &lt;&gt; DuctQ And NextQRng.Offset(-4).Value &lt;&gt; DuctQ And NextQRng.Offset(-6).Value &lt;&gt; DuctQ Then\n        NextQRng.Value = DuctQ\n    End If\nEnd If\n\n'Adds numbers\nIf Q3Rng1.Value &lt;&gt; \"\" Then Q3Rng1.Value = \"3. \" &amp; Q3Rng1.Value\nIf Q4Rng1.Value &lt;&gt; \"\" Then Q4Rng1.Value = \"4. \" &amp; Q4Rng1.Value\nIf Q5Rng1.Value &lt;&gt; \"\" Then Q5Rng1.Value = \"5. \" &amp; Q5Rng1.Value\n\n'Defines box ranges\nSet ASPRng1 = Nothing\nSet ZODRng1 = Nothing\nSet ZOPRng1 = Nothing\nSet DuctRng1 = Nothing\nSet ASPRng1 = Ans2Rng1\nSet ZODRng1 = HoodRng1.EntireColumn.Find(What:=\"Is the Hood protected by continuous Linear Heat Detection\", LookAt:=xlPart).Offset(, LineSz)\nSet ZOPRng1 = HoodRng1.EntireColumn.Find(What:=\"Zones of Protection\", LookAt:=xlPart).Offset(, LineSz)\nSet DuctRng1 = HoodRng1.EntireColumn.Find(What:=\"How many ducts\", LookAt:=xlPart).Offset(, LineSz)\n\n'Names Hazard 1\nIf InStr(1, Wks.Name, \"1\") &gt; 0 Then\n    If Not ASPRng1 Is Nothing Then ASPRng1.Name = \"H1ASPRng1\"\n    If Not ZODRng1 Is Nothing Then ZODRng1.Name = \"H1ZODRng1\"\n    If Not ZOPRng1 Is Nothing Then ZOPRng1.Name = \"H1ZOPRng1\"\n    If Not DuctRng1 Is Nothing Then DuctRng1.Name = \"H1DuctRng1\"\nEnd If\n\n'Names Hazard 2\nIf InStr(1, Wks.Name, \"2\") &gt; 0 Then\n    If Not ASPRng1 Is Nothing Then ASPRng1.Name = \"H2ASPRng1\"\n    If Not ZODRng1 Is Nothing Then ZODRng1.Name = \"H2ZODRng1\"\n    If Not ZOPRng1 Is Nothing Then ZOPRng1.Name = \"H2ZOPRng1\"\n    If Not DuctRng1 Is Nothing Then DuctRng1.Name = \"H2DuctRng1\"\nEnd If\n\n'Names Hazard 3\nIf InStr(1, Wks.Name, \"3\") &gt; 0 Then\n    If Not ASPRng1 Is Nothing Then ASPRng1.Name = \"H3ASPRng1\"\n    If Not ZODRng1 Is Nothing Then ZODRng1.Name = \"H3ZODRng1\"\n    If Not ZOPRng1 Is Nothing Then ZOPRng1.Name = \"H3ZOPRng1\"\n    If Not DuctRng1 Is Nothing Then DuctRng1.Name = \"H3DuctRng1\"\nEnd If\n    'Names Hazard 1\nIf InStr(1, Wks.Name, \"4\") &gt; 0 Then\n    If Not ASPRng1 Is Nothing Then ASPRng1.Name = \"H4ASPRng1\"\n    If Not ZODRng1 Is Nothing Then ZODRng1.Name = \"H4ZODRng1\"\n    If Not ZOPRng1 Is Nothing Then ZOPRng1.Name = \"H4ZOPRng1\"\n    If Not DuctRng1 Is Nothing Then DuctRng1.Name = \"H4DuctRng1\"\nEnd If\n\n'Adds ASP box\nWith ASPRng1\n    If Wks.Shapes.Range(Array(\"ASPBox1\")) Is Nothing Then Set ASPBox1 = Wks.DropDowns.Add(.Left, .Top + 0.75, .Width - 0.5, .Height - 1.6)\nEnd With\nWith ASPBox1\n    .Name = \"ASPBox1\"\n    .ListFillRange = \"ZeroToFour\"\n    If InStr(1, Wks.Name, \"1\") &gt; 0 Then .LinkedCell = \"H1ASPRng1\"\n    If InStr(1, Wks.Name, \"2\") &gt; 0 Then .LinkedCell = \"H2ASPRng1\"\n    If InStr(1, Wks.Name, \"3\") &gt; 0 Then .LinkedCell = \"H3ASPRng1\"\n    If InStr(1, Wks.Name, \"4\") &gt; 0 Then .LinkedCell = \"H4ASPRng1\"\n    .DropDownLines = 9\n    .Display3DShading = True\n    .Locked = False\n    .Deselect\nEnd With\n\n'Adds ZOD box\nWith ZODRng1\n    If Wks.Shapes.Range(Array(\"ZODBox1\")) Is Nothing Then Set ZODBox1 = Wks.DropDowns.Add(.Left, .Top + 0.75, .Width - 0.5, .Height - 1.6)\nEnd With\nWith ZODBox1\n    .Name = \"ZODBox1\"\n    .ListFillRange = \"YesNo\"\n    If InStr(1, Wks.Name, \"1\") &gt; 0 Then .LinkedCell = \"H1ZODRng1\"\n    If InStr(1, Wks.Name, \"2\") &gt; 0 Then .LinkedCell = \"H2ZODRng1\"\n    If InStr(1, Wks.Name, \"3\") &gt; 0 Then .LinkedCell = \"H3ZODRng1\"\n    If InStr(1, Wks.Name, \"4\") &gt; 0 Then .LinkedCell = \"H4ZODRng1\"\n    .DropDownLines = 9\n    .Display3DShading = True\n    .Locked = False\n    .Deselect\nEnd With\n\n'Adds ZOP box\nWith ZOPRng1\n    If Wks.Shapes.Range(Array(\"ZOPBox1\")) Is Nothing Then Set ZOPBox1 = Wks.DropDowns.Add(.Left, .Top + 0.75, .Width - 0.5, .Height - 1.6)\nEnd With\nWith ZOPBox1\n    .Name = \"ZOPBox1\"\n    .ListFillRange = \"ZeroToFour\"\n    If InStr(1, Wks.Name, \"1\") &gt; 0 Then .LinkedCell = \"H1ZOPRng1\"\n    If InStr(1, Wks.Name, \"2\") &gt; 0 Then .LinkedCell = \"H2ZOPRng1\"\n    If InStr(1, Wks.Name, \"3\") &gt; 0 Then .LinkedCell = \"H3ZOPRng1\"\n    If InStr(1, Wks.Name, \"4\") &gt; 0 Then .LinkedCell = \"H4ZOPRng1\"\n    .DropDownLines = 9\n    .Display3DShading = True\n    .Locked = False\n    .Deselect\nEnd With\n\n'Adds Duct box\nWith DuctRng1\n    Set DuctBox1 = Wks.DropDowns.Add(.Left, .Top + 0.75, .Width - 0.5, .Height - 1.6)\nEnd With\nWith DuctBox1\n    .Name = \"DuctBox1\"\n    .ListFillRange = \"DuctList\"\n    If InStr(1, Wks.Name, \"1\") &gt; 0 Then .LinkedCell = \"H1DuctRng1\"\n    If InStr(1, Wks.Name, \"2\") &gt; 0 Then .LinkedCell = \"H2DuctRng1\"\n    If InStr(1, Wks.Name, \"3\") &gt; 0 Then .LinkedCell = \"H3DuctRng1\"\n    If InStr(1, Wks.Name, \"4\") &gt; 0 Then .LinkedCell = \"H4DuctRng1\"\n    .DropDownLines = 9\n    .Display3DShading = True\n    .Locked = False\n    .Deselect\nEnd With\n\n'Adds default values\nIf Not ASPRng1 Is Nothing Then ASPRng1.Value = 1\nIf Not ZOPRng1 Is Nothing Then ZOPRng1.Value = 2\nIf Not ZODRng1 Is Nothing Then ZODRng1.Value = 1\nIf Not DuctRng1 Is Nothing Then DuctRng1.Value = 1\n\n'Defines range for new button\nSet RunBoxRng1 = Nothing\nSet RunBoxRng1 = Q5Rng1.Offset(2, 1)\n\n'Adds button to populate the rest of the questions\nWith RunBoxRng1.Resize(2, 2)\n    If Wks.Shapes.Range(Array(\"RunBox1\")) Is Nothing Then Set RunBox1 = Wks.Buttons.Add(.Left, .Top, .Width, .Height)\nEnd With\nWith RunBox1\n    .Name = \"RunBox1\"\n    .Characters.Text = \"Answer All Fields and Click to Populate\"\n    .Display3DShading = True\n    .OnAction = \"PopulateHood1Qs.PopulateHood1Part2\"\n    .Locked = False\n    .Deselect\nEnd With\n\n'Realigns\nWith RunBoxRng1.Resize(2, 2)\n    RunBox1.Top = .Top\n    RunBox1.Height = .Height\n    RunBox1.Width = .Width\n    RunBox1.Left = .Left\nEnd With\n</code></pre>\n\n<p>I've uploaded a copy of it in all of of various/glorious forms of failure. <a href=\"https://drive.google.com/file/d/0B29iJExWAL75cTVnMkwyU2p0WEk/view?usp=sharing\" rel=\"nofollow\">Uploaded here</a></p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1470256974, "post_id": 38731626, "comment_id": 64880375, "body": "Pramod: You&#39;ve &#39;edited&#39; your question so much that now this is a completely different question, and as a result doesn&#39;t match the answers given below. Suggest you revert your edits, and post a new question."}, {"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1470258161, "post_id": 38731626, "comment_id": 64880947, "body": "Hi @jeffreyweir Thanks for the suggestion. I&#39;ve posted a new question here: <a href=\"http://stackoverflow.com/questions/38753567/how-to-access-pivot-items-of-a-pivot-field-which-is-present-in-report-filter-usi\" title=\"how to access pivot items of a pivot field which is present in report filter usi\">stackoverflow.com/questions/38753567/&hellip;</a> I know I didn&#39;t make any sense after editing the question. I appreciate your comment instead of downvoting my question"}], "answers": [{"comments": [{"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "edited": false, "score": 0, "creation_date": 1470240790, "post_id": 38741210, "comment_id": 64871296, "body": "Hi @Jeffreyweir I&#39;m trying to count the no.of items not the no.of visible items. Please refer to my edited question"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "edited": false, "score": 0, "creation_date": 1470257084, "post_id": 38741210, "comment_id": 64880438, "body": "Note that your edited question is a very different question to the one you initially asked, and I&#39;m still not 100% clear on what you want, because your comment above says you want the count, but your edited question says you want to print each PivotItem along with its visible status. Please clarify."}, {"owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "edited": false, "score": 0, "creation_date": 1470257893, "post_id": 38741210, "comment_id": 64880832, "body": "Sorry about that. Actually to do either of them I need to access the pivot items. My main problem is accessing the pivot items. So, I tried printing the no.of pivot items in my previous to edited question. The actual thing I want to do is to get the list of visible items inside an array, one after other. To do so, I&#39;m trying various ways to access the pivot items of a pivot field present in a Report Filter. Thanks for asking"}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1470220995, "last_edit_date": 1470220995, "creation_date": 1470220678, "answer_id": 38741210, "question_id": 38731626, "link": "https://stackoverflow.com/questions/38731626/how-to-get-the-no-of-items-from-a-pivot-field-in-report-filter-using-vba/38741210#38741210", "title": "How to get the no.of Items from a Pivot Field in Report Filter using VBA", "body": "<p>Assuming you want to know the count of <em>visible</em> items and not just of <em>all</em> items, then iterating through each item to test the .visible status is by far the simplest method. But it might take a while: A per a post I wrote some time back at <a href=\"http://dailydoseofexcel.com/archives/2013/11/14/filtering-pivots-based-on-external-ranges/\" rel=\"nofollow\">http://dailydoseofexcel.com/archives/2013/11/14/filtering-pivots-based-on-external-ranges/</a> it takes upwards of one minute and twenty seconds just to read the .visible status of a PivotField with 20,000 items in it. Many of the PivotTables I work with easily have that number of items in them, so when I write code that must work on <em>any</em> PivotField I don't use that approach. </p>\n\n<p>So if your PivotField has many items, a less straightforward - but potentially much faster - way than Doug's fine approach above is to make a copy of the PivotTable, remove/unfilter every field but the one of interest, change the layout of that field to a PageField, and then count how many rows it occupies.</p>\n\n<p>I usually make TWO copies of the PivotTable, and use one of them to determine what is currently visible in the field, and the other to determine </p>\n\n<ul>\n<li>What (if anything) is filtered but NOT visible due to filters applied\non other PivotFields; and</li>\n<li>What (if anything) is not filtered AND not visible</li>\n</ul>\n\n<p>The code to accomplish this is pretty complicated, and part of a commercial add-in I'm building, so I can't share it I'm afraid.</p>\n"}], "owner": {"reputation": 1385, "user_id": 609282, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/49ec064489b38832193cd7d9a6df5ecf?s=128&d=identicon&r=PG", "display_name": "Pramod", "link": "https://stackoverflow.com/users/609282/pramod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1022, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470258039, "creation_date": 1470177715, "last_edit_date": 1470258039, "question_id": 38731626, "link": "https://stackoverflow.com/questions/38731626/how-to-get-the-no-of-items-from-a-pivot-field-in-report-filter-using-vba", "title": "How to get the no.of Items from a Pivot Field in Report Filter using VBA", "body": "<p>I used the below line to get the no.of items from a Pivot Field in a \"Report Filter\": <code>MsgBox pt.PageFields(5).PivotItems.Count</code> </p>\n\n<p>But it is returning 0 everytime. I'm not sure if this is the correct way. This field for sure has Pivot Items in it. Can someone help me?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1470177609, "post_id": 38731476, "comment_id": 64839462, "body": "I think you want to add them <code>MonthsWithValues = MonthsWithValues + Excel...</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1470179044, "post_id": 38731476, "comment_id": 64839890, "body": "The last part of your formula should be <code>&quot;&lt;&gt;&quot;&quot;&quot;&quot;&quot;</code> (or just <code>&quot;&lt;&gt;&quot;</code>) instead of <code>&quot;&lt;&gt;&quot;&quot;&quot;</code> (unless you are trying to check for the existence of a quotation mark within the range), but that isn&#39;t the reason for your problem."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1470183007, "post_id": 38731476, "comment_id": 64840804, "body": "What are you using for the With block that your code is within?  If it is a worksheet, is it the one with your data on it?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1470187125, "post_id": 38731476, "comment_id": 64841763, "body": "There is insufficient data to reproduce your error. Please read the HELP topics for <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>, and also <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 67, "user_id": 5987643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd0399651cdbcd76d14e24d9031bf707?s=128&d=identicon&r=PG&f=1", "display_name": "HeatherD", "link": "https://stackoverflow.com/users/5987643/heatherd"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1470231738, "post_id": 38731476, "comment_id": 64864450, "body": "@RonRosenfeld, I have re-formatted my question above and added the relevant code.  Please let me know if I need to add or clarify anything."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1470245764, "post_id": 38731476, "comment_id": 64874304, "body": "@HeatherD The third argument of your <code>COUNTIFS</code> is a criteria; it should be a range. And there should be a 4th argument as a criteria. And why do you repeat the <code>COUNTIFS</code> multiple times?  You seem to only be using the final result."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1470245844, "post_id": 38731476, "comment_id": 64874345, "body": "@HeatherD  In general, a VBA Function is used to return a value; a VBA Sub is used to modify the worksheet.  Sometimes mixing that will work, sometimes it may have unexpected results."}, {"owner": {"reputation": 67, "user_id": 5987643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd0399651cdbcd76d14e24d9031bf707?s=128&d=identicon&r=PG&f=1", "display_name": "HeatherD", "link": "https://stackoverflow.com/users/5987643/heatherd"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1470340744, "post_id": 38731476, "comment_id": 64924169, "body": "Thanks @RonRosenfeld!  I had been playing around with the formula for <code>MonthsWithValues</code>, and someone else suggested I take out my range as the third argument; good to know I had the formula formatted correctly originally.  And thanks for explaining the difference between using a sub and function - will definitely keep that in mind going forward."}], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 5987643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd0399651cdbcd76d14e24d9031bf707?s=128&d=identicon&r=PG&f=1", "display_name": "HeatherD", "link": "https://stackoverflow.com/users/5987643/heatherd"}, "is_accepted": false, "score": 1, "last_activity_date": 1470402610, "creation_date": 1470402610, "answer_id": 38790125, "question_id": 38731476, "link": "https://stackoverflow.com/questions/38731476/excel-vba-formula-breaks-after-adding-data-in-spreadsheet/38790125#38790125", "title": "Excel VBA - Formula Breaks After Adding Data in Spreadsheet", "body": "<p>It was giving me the error because <code>MonthsWithValues</code> wasn't being initialized with a number, so it was being evaluated to 0.</p>\n\n<p>The correct code is:</p>\n\n<pre><code>Sub ReduceCost_Percentage()\n\nWith Worksheets(\"Analysis Worksheet\")\n\nDim i As Long\nDim LastRow As Long\nLastRow = Range(\"X\" &amp; Rows.Count).End(xlUp).Row\nDim Orig2016Total(68) As Long\nDim MonthsWithValues(68) As Long\n\nFor i = 5 To LastRow\nOrig2016Total(i) = Excel.WorksheetFunction.Sum(.Range((\"BC\" &amp; i), (\"BN\" &amp; i)))\nMonthsWithValues(i) = Excel.WorksheetFunction.CountIfs(.Range((\"M\" &amp; i), (\"X\" &amp; i)), \"&lt;&gt;0\", .Range((\"M\" &amp; i), (\"X\" &amp; i)), \"&lt;&gt;\"\"\"\"\")\nNext i\n</code></pre>\n\n<p>Now it works! Thanks for the help everyone!</p>\n"}], "owner": {"reputation": 67, "user_id": 5987643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd0399651cdbcd76d14e24d9031bf707?s=128&d=identicon&r=PG&f=1", "display_name": "HeatherD", "link": "https://stackoverflow.com/users/5987643/heatherd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470402610, "creation_date": 1470176872, "last_edit_date": 1470231472, "question_id": 38731476, "link": "https://stackoverflow.com/questions/38731476/excel-vba-formula-breaks-after-adding-data-in-spreadsheet", "title": "Excel VBA - Formula Breaks After Adding Data in Spreadsheet", "body": "<p>I have an Excel spreadsheet with monthly costs for Jan. 2016 through Dec. 2016 (columns M through X). There are also two buttons on the sheet.  When you click the \"Perform Analysis\" button, it reduces each monthly cost by the percentage entered in column D (i.e. if you enter 15 in column D, columns M (January) through X (December) are reduced by 15%).</p>\n\n<p>Once columns M through X are reduced, then columns Z (Jan. 2017) through AK (Dec. 2017) are populated.  To determine the value of columns Z through AK, I see if the average monthly cost for 2016 is greater than or less than the difference between the original total yearly cost for 2016 (column Y) and the newly reduced cost.  If the average cost is greater than the difference, then Jan. 2017 (column Z) is equal to the difference between the original cost and reduced cost.  If the average is less than the difference, then Jan. 2017 is equal to the average monthly cost for 2016.  </p>\n\n<p>Next, we use the same logic as above to determine the value of column AA (Feb. 2017).  However, this time we are subtracting the value of Jan. 2017 from the difference between the original yearly cost for 2016 and the newly reduced cost.</p>\n\n<p>For example, if the original yearly cost for 2016 was $350,000 and the reduced cost was $297,500 (reduced by 15%), and the average monthly cost was $45,000 (also the cost for Jan. 2017), then we would calculate the value for Feb. 2017 by saying:</p>\n\n<p>If average monthly cost ($45,000) greater than ($350,000 - $297,500 - $45,000) Then Feb. 2017 = $275,300</p>\n\n<p>Else average monthly cost ($45,000) less than ($350,000 - $297,500 - $45,000) Then Feb. 2017 = $45,000</p>\n\n<p>This pattern continues through Dec. 2017, column AK.</p>\n\n<p>All of my code was working great, until I added numbers to Row 5 in my spreadsheet.  After I added the data, my COUNTIFS formula no longer returns the correct result.  </p>\n\n<p>For Row 5, <code>MonthsWithValues</code> should equal 10; however, each time I run the code now, it gives me a 0.  I have tried debugging it using Step Into, Break Points/Toggle Points, and Watch.  Each time I run the code, it keeps saying the value of <code>MonthsWithValues</code> is 0. Because my code contains a formula where you divide by <code>MonthsWithValues</code>, I keep getting Run-time Error 11 (you can't divide by 0).  Help!\nThe relevant code is:</p>\n\n<pre><code>Function ReduceCost_Percentage()\n\nWith Worksheets(\"Analysis Worksheet\")\n\nDim i As Long\nDim LastRow As Long\nLastRow = Range(\"X\" &amp; Rows.Count).End(xlUp).Row\nDim Orig2016Total(65) As Long\nDim MonthsWithValues As Long\nDim TodayDate As Date\nTodayDate = Format(Date, \"DD/MM/YYYY\")\n\nFor i = 5 To LastRow\nOrig2016Total(i) = Excel.WorksheetFunction.Sum(.Range((\"BC\" &amp; i), (\"BN\" &amp; i)))\nMonthsWithValues = Excel.WorksheetFunction.CountIfs(.Range((\"M\" &amp; i), (\"X\" &amp; i)), \"&lt;&gt;0\", \"&lt;&gt;\")\nNext i\n\nFor i = 5 To LastRow\nIf .Range(\"D\" &amp; i).Value &gt; 0 And IsEmpty(.Range(\"B\" &amp; i).Value) And IsEmpty(.Range(\"C\" &amp; i).Value) Then\n  If .Range(\"X\" &amp; i).Value &gt; 0 And Not IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value) _\n  And Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value &lt;= #12/31/2016# Then\n    If (((Orig2016Total(i) - (Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value * (12 - Left(Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value, 2)))) / MonthsWithValues)) &lt; (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) Then\n      .Range(\"Z\" &amp; i).Value = ((Orig2016Total(i) - (Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value * (12 - Left(Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value, 2)))) / MonthsWithValues) + Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value\n    End If\n  ElseIf .Range(\"X\" &amp; i).Value &gt; 0 And Not IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value) _\n  And Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value &lt;= #12/31/2016# Then\n    If (((Orig2016Total(i) - (Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value * (12 - Left(Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value, 2)))) / MonthsWithValues)) &gt; (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) Then\n      .Range(\"Z\" &amp; i).Value = (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) + Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value\n    End If\n  ElseIf .Range(\"X\" &amp; i).Value &gt; 0 And Not IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value) And Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value &gt; #12/31/2016# _\n  And (Orig2016Total(i) / MonthsWithValues) &lt; (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) Then\n    .Range(\"Z\" &amp; i).Value = Orig2016Total(i) / MonthsWithValues\n  ElseIf .Range(\"X\" &amp; i).Value &gt; 0 And IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value) _\n  And (Orig2016Total(i) / MonthsWithValues) &lt; (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) Then\n    .Range(\"Z\" &amp; i).Value = Orig2016Total(i) / MonthsWithValues\n  ElseIf .Range(\"X\" &amp; i).Value &gt; 0 And Not IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value) And Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value &gt; #12/31/2016# _\n  And (Orig2016Total(i) / MonthsWithValues) &gt; (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) Then\n    .Range(\"Z\" &amp; i).Value = Orig2016Total(i) - .Range(\"Y\" &amp; i).Value\n  ElseIf .Range(\"X\" &amp; i).Value &gt; 0 And IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value) _\n  And (Orig2016Total(i) / MonthsWithValues) &gt; (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) Then\n    .Range(\"Z\" &amp; i).Value = Orig2016Total(i) - .Range(\"Y\" &amp; i).Value\n  ElseIf .Range(\"X\" &amp; i).Value = Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value And Not IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value) _\n  And Not IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value) And Orig2016Total(i) &gt; 0 Then\n    If (((Orig2016Total(i) - (Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value * (12 - Left(Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value, 2)))) / MonthsWithValues)) &lt; (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) Then\n      .Range(\"Z\" &amp; i).Value = ((Orig2016Total(i) - (Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value * (12 - Left(Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value, 2)))) / MonthsWithValues) + Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value\n    End If\n  ElseIf .Range(\"X\" &amp; i).Value = Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value And Not IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value) _\n  And Not IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value) And Orig2016Total(i) &gt; 0 Then\n    If (((Orig2016Total(i) - (Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value * (12 - Left(Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value, 2)))) / MonthsWithValues)) &gt; (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) Then\n      .Range(\"Z\" &amp; i).Value = (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) + Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value\n    End If\n  ElseIf (IsEmpty(.Range(\"X\" &amp; i).Value) Or .Range(\"X\" &amp; i).Value = 0) And Not IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value) _\n  And Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value &gt; #11/30/2016# And Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value &lt;= #12/31/2016# Then\n    If ((Orig2016Total(i) - (Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value * (12 - Left(Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value, 2)))) / MonthsWithValues) &lt; (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) Then\n     .Range(\"Z\" &amp; i).Value = ((Orig2016Total(i) - (Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value * (12 - Left(Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value, 2)))) / MonthsWithValues) + Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value\n    End If\n  ElseIf (IsEmpty(.Range(\"X\" &amp; i).Value) Or .Range(\"X\" &amp; i).Value = 0) And Not IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value) _\n  And Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value &gt; #11/30/2016# And Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value &lt;= #12/31/2016# Then\n    If ((Orig2016Total(i) - (Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value * (12 - Left(Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value, 2)))) / MonthsWithValues) &gt; (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) Then\n     .Range(\"Z\" &amp; i).Value = (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) + Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value\n    End If\n  ElseIf (IsEmpty(.Range(\"X\" &amp; i).Value) Or .Range(\"X\" &amp; i).Value = 0) And ((Not IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value) And Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value &gt; #12/31/2016#) Or IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value)) _\n  And (Orig2016Total(i) / MonthsWithValues) &gt; (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) Then\n    .Range(\"Z\" &amp; i).Value = Orig2016Total(i) - .Range(\"Y\" &amp; i).Value\n  ElseIf (IsEmpty(.Range(\"X\" &amp; i).Value) Or .Range(\"X\" &amp; i).Value = 0) And ((Not IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value) And Worksheets(\"Fixed Cost Test Data\").Range(\"C\" &amp; i).Value &gt; #12/31/2016#) Or IsEmpty(Worksheets(\"Fixed Cost Test Data\").Range(\"B\" &amp; i).Value)) _\n  And (Orig2016Total(i) / MonthsWithValues) &lt; (Orig2016Total(i) - .Range(\"Y\" &amp; i).Value) Then\n    .Range(\"Z\" &amp; i).Value = Orig2016Total(i) / MonthsWithValues\n  End If\nEnd If\nNext i\n</code></pre>\n"}]