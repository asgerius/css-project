[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569461013, "post_id": 58107250, "comment_id": 102607026, "body": "Do you have another function named <code>Enthalpy</code>?"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1569477851, "post_id": 58107250, "comment_id": 102610855, "body": "And today I learned how to return a value with <code>Application.Run</code> @sadele89 Thanks!"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1569487464, "post_id": 58107250, "comment_id": 102615406, "body": "Always declare your variables and always add <code>Option Explicit</code> on the very top of your code to prevent you from not doing so. What data type does the <code>&#39;psychrometric functions.xla&#39;!TdbGrainstoEnthalpy</code> return? What data type should <code>Enthalpy</code> be? Same goes for all the other variables as well."}], "owner": {"reputation": 19, "user_id": 12121806, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EV7ocCeeBxQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfxe6rZqDNK7egvPNK5-6sQGshwrw/photo.jpg?sz=128", "display_name": "sadele89", "link": "https://stackoverflow.com/users/12121806/sadele89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1569461277, "creation_date": 1569449887, "last_edit_date": 1569461277, "question_id": 58107250, "link": "https://stackoverflow.com/questions/58107250/compile-error-function-call-on-left-hand-side-of-assignment", "title": "Compile Error: Function Call on Left-hand side of assignment", "body": "<p>I got the compile error </p>\n\n<blockquote>\n  <p>\"Function call on left-hand side of assignment must return Variant or Object\"</p>\n</blockquote>\n\n<p>Trying to fix an inherited Excel file that calculates various values related to HVAC. The file relies on a couple of Add-In .xla files which contain many functions. I am unable to get results from most of the functions. Either I get numbers that immediately turn to zeros, or I just get #VALUE and #NAME errors.</p>\n\n<p>My VBA skills are somewhat limited as well as my knowledge of the calculations this file is performing.</p>\n\n<pre><code>Function EvapDeltaGrn(altitude, evap_on, tdb_ma, hr_ma, sat_goal, hr_min)\n    'use to calculate the delta grain when tdb_oa &gt; than sat_goal\n\n    EvapDeltaGrn = 0\n\n    If tdb_ma = \"\" Then Exit Function\n    If hr_ma = \"\" Then Exit Function\n\n    If evap_on Then\n        If tdb_ma &gt;= (sat_goal) Then 'use evaporative cooling\n            Enthalpy = Application.Run(\"'psychrometric functions.xla'!TdbGrainstoEnthalpy\", altitude, tdb_ma, hr_ma)\n            'Range(\"v14\") = enthalpy\n            EvapDeltaGrn = Application.Run(\"'psychrometric functions.xla'!TdbEnthalpytoGrains\", altitude, sat_goal, Enthalpy)\n            EvapDeltaGrn = EvapDeltaGrn - hr_ma\n            EvapDeltaGrn = Round(EvapDeltaGrn, 2)\n        Else    'evaporative humidification\n            If hr_ma &lt; hr_min Then EvapDeltaGrn = Round(hr_min - hr_ma, 2)\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p>The error seems to be at <code>Enthalpy =</code>.</p>\n"}, {"tags": ["excel", "vba", "loops", "if-statement"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1569449228, "post_id": 58107136, "comment_id": 102604862, "body": "You should not use <code>range</code> as a variable name. What is the value of <code>y</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1569449563, "post_id": 58107136, "comment_id": 102604941, "body": "Not your problem but, Use VBA&#39;s Replace: <code>step = Replace(step, cell, UCase(cell))</code> and your instr is backwards: <code>If InStr(step, cell, vbTextCompare) &lt;&gt; 0 Then</code>"}, {"owner": {"reputation": 1, "user_id": 10541037, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QoboM4uJIpU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAqplMLnRKOmbD5dknYk64IvyM79A/mo/photo.jpg?sz=128", "display_name": "ushir maharaj", "link": "https://stackoverflow.com/users/10541037/ushir-maharaj"}, "edited": false, "score": 0, "creation_date": 1569449563, "post_id": 58107136, "comment_id": 102604942, "body": "Hi There, Well Range is a list defined in Excel and y is a cell containing the string"}, {"owner": {"reputation": 1, "user_id": 10541037, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QoboM4uJIpU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAqplMLnRKOmbD5dknYk64IvyM79A/mo/photo.jpg?sz=128", "display_name": "ushir maharaj", "link": "https://stackoverflow.com/users/10541037/ushir-maharaj"}, "edited": false, "score": 0, "creation_date": 1569449642, "post_id": 58107136, "comment_id": 102604966, "body": "Hi Scott, Swapped the variables and still no luck :("}, {"owner": {"reputation": 121, "user_id": 4608461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c7a8cd4b69fa96bcd0c7627ff1f831?s=128&d=identicon&r=PG", "display_name": "Roy Brander", "link": "https://stackoverflow.com/users/4608461/roy-brander"}, "edited": false, "score": 0, "creation_date": 1569449650, "post_id": 58107136, "comment_id": 102604970, "body": "Ummm...how do you have a function that doesn&#39;t set the value of &quot;test&quot; the function itself?  Doesn&#39;t that guarantee that the value of the function will be #VALUE ?   If you just want to run the replace, not return a value, I&#39;m not sure this should be a function."}, {"owner": {"reputation": 1, "user_id": 10541037, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QoboM4uJIpU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAqplMLnRKOmbD5dknYk64IvyM79A/mo/photo.jpg?sz=128", "display_name": "ushir maharaj", "link": "https://stackoverflow.com/users/10541037/ushir-maharaj"}, "edited": false, "score": 0, "creation_date": 1569450078, "post_id": 58107136, "comment_id": 102605060, "body": "Hi Roy, So if I Remove the If statement and ensure that all the words in the lists exist in the Strings it works perfectly. However, in the real-world application, there would be cases where some words are not in a specific string and would need to be skipped."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10541037, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QoboM4uJIpU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAqplMLnRKOmbD5dknYk64IvyM79A/mo/photo.jpg?sz=128", "display_name": "ushir maharaj", "link": "https://stackoverflow.com/users/10541037/ushir-maharaj"}, "edited": false, "score": 0, "creation_date": 1569450501, "post_id": 58107277, "comment_id": 102605167, "body": "Hi Scott, Thanks so much! Worked like a Charm. I&#39;m new to using VBA with Excel. I&#39;ll take my time to understand and learn for this. Thank you! :)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1569450115, "creation_date": 1569450115, "answer_id": 58107277, "question_id": 58107136, "link": "https://stackoverflow.com/questions/58107136/if-statement-in-for-loop-vba/58107277#58107277", "title": "If Statement in for loop VBA", "body": "<p>first you have the variable backwards in the Instr.  and you must use the firs criterion if you use the last.</p>\n\n<p>Also if you are looking for complete words then you need to use <code>\" \"</code> on the search and replace.</p>\n\n<p>Lastly use vba's Replace:</p>\n\n<pre><code>Public Function test(rng As range, y As String)\n    Dim step As String\n    step = y\n\n    Dim cell As range\n    For Each cell In rng\n        If InStr(1, \" \" &amp; step &amp; \" \", \" \" &amp; cell &amp; \" \", vbTextCompare) &gt; 0 Then\n            step = Replace(\" \" &amp; step &amp; \" \", \" \" &amp; cell &amp; \" \", UCase(\" \" &amp; cell &amp; \" \"))\n        End If\n    Next cell\n\n    test = Application.Trim(step)\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/wRX3D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wRX3D.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 10541037, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QoboM4uJIpU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAqplMLnRKOmbD5dknYk64IvyM79A/mo/photo.jpg?sz=128", "display_name": "ushir maharaj", "link": "https://stackoverflow.com/users/10541037/ushir-maharaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 58107277, "answer_count": 1, "score": 0, "last_activity_date": 1569450115, "creation_date": 1569449116, "question_id": 58107136, "link": "https://stackoverflow.com/questions/58107136/if-statement-in-for-loop-vba", "title": "If Statement in for loop VBA", "body": "<p>Im tring to get my Function to skip words in my list that arent in my string but it doesnt seem to be working</p>\n\n<p>Iv tried using VBA and excel native commands... however i get the same result</p>\n\n<pre><code>Public Function test(range, y)\n\nstep = y\n\nFor Each cell In range\n\nIf InStr(cell, step, vbTextCompare) &lt;&gt; 0 Then\n\nstep = Application.WorksheetFunction.Replace(step,Application.WorksheetFunction.Search(cell, step), Len(cell), UCase(cell))\n\ntest = step\nEnd If\nNext cell\n\nEnd Function\n</code></pre>\n\n<p>When I try to use this Function in Excel I get #VALUE, I suspect this is because not all the values in the list are found in the string however that the reason for the if statement</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1569448127, "post_id": 58106940, "comment_id": 102604559, "body": "FYI - you only need to add <code>On Error Resume Next</code> once (unless you revert to normal error handling which you have not done). <b>However</b>, It doesn&#39;t appear that you need to do this at all here. You can just code for the negative outcome"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1569448354, "post_id": 58106940, "comment_id": 102604624, "body": "You may want to look at <a href=\"http://rubberduckvba.com/Indentation\" rel=\"nofollow noreferrer\">indenting your code properly</a> -- makes things much easier to follow"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1569451982, "post_id": 58106940, "comment_id": 102605478, "body": "you write &quot;On the second loop the first two workbooks should be skipped (as False) in the loop and the Else should be the results.&quot; If you step through the code with F8, can&#39;t you work out why that does not happen? Is the condition still TRUE? If so, what causes the condition to not be FALSE? Stepping through the code should illustrate that."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1569452506, "post_id": 58106940, "comment_id": 102605562, "body": "Remove all of your <code>On Error Resume Next</code> and see what happens"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1569452814, "post_id": 58106940, "comment_id": 102605628, "body": "Every line like <code>Dim M13F3 As Integer: On Error Resume Next: M13F3 = Application.MATCH(MV(3), TF13, 0)</code> is a problem.  If <code>Application.MATCH</code> does not find a match, it returns an Error <i>Value</i>, not a runtime error. So, use <code>Dim M13F3 as Variant</code>and drop the <code>On Error Resume Next</code>.  The <code>If Not IsError(M13F3) And ... And M13C2 = M13F3 Then</code> is also an issue.  VBA <code>If</code> does not short circuit evaluation, if <code>IsError(...)</code> is true then comparing that value to another will cause a runtime error.  So, nest your <code>If</code>&#39;s - first the <code>If Not IsError(...) And ... Then</code> followed by <code>If X = Y And ... Then</code>"}, {"owner": {"reputation": 45, "user_id": 7474299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYZnf.jpg?s=128&g=1", "display_name": "DanielT", "link": "https://stackoverflow.com/users/7474299/danielt"}, "edited": false, "score": 0, "creation_date": 1569505920, "post_id": 58106940, "comment_id": 102625547, "body": "Regarding the &quot;On Error Resume Next&quot; (urdearboy, Tim Williams, chris neilsen) I recently added that because of the way I need to place certain variables before and after operations. At this point I have 6 things that need to be true and 3 of them need to ignore the variable error so the VBA can still run to determine if all six statements are true, to which Then would take over or move on to the next match validation..."}, {"owner": {"reputation": 45, "user_id": 7474299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYZnf.jpg?s=128&g=1", "display_name": "DanielT", "link": "https://stackoverflow.com/users/7474299/danielt"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1569505960, "post_id": 58106940, "comment_id": 102625581, "body": "@teylyn, I typically do follow proper indent in any code and even with previous build of this VBA code, but this last version got a little tricky and I had to indent in a way to help me see the major If, ElseIf, Else clearly, aside from the smaller If, Then, EndIf assisting with the declaration and variables. Nonetheless, thanks for that link. I will add it to my resources..."}, {"owner": {"reputation": 45, "user_id": 7474299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYZnf.jpg?s=128&g=1", "display_name": "DanielT", "link": "https://stackoverflow.com/users/7474299/danielt"}, "edited": false, "score": 0, "creation_date": 1569506013, "post_id": 58106940, "comment_id": 102625614, "body": "Btw everyone, I&#39;ve added another image of the front end of Excel to help with the big picture in case there are some better ways to approach my requirements."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7474299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYZnf.jpg?s=128&g=1", "display_name": "DanielT", "link": "https://stackoverflow.com/users/7474299/danielt"}, "edited": false, "score": 0, "creation_date": 1569501833, "post_id": 58109942, "comment_id": 102623169, "body": "Thank you for your time. At this stage of connecting files I&#39;m using proper names and being liberal with the declarations to make the additional code easier to read and troubleshoot... Btw, I think this &#39;answer&#39; probably was marked down because it was not really an &#39;solve&#39; type answer, but qualifies more as a comment. Nobody  likes to get marked down, so just sharing my advice to a new stackoverflow contributor. ;)"}], "tags": [], "owner": {"reputation": 1, "user_id": 12122591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbce47ff8551ad11da879d3ade95a5f3?s=128&d=identicon&r=PG&f=1", "display_name": "DavidH", "link": "https://stackoverflow.com/users/12122591/davidh"}, "is_accepted": false, "score": -1, "last_activity_date": 1569485982, "last_edit_date": 1569485982, "creation_date": 1569474751, "answer_id": 58109942, "question_id": 58106940, "link": "https://stackoverflow.com/questions/58106940/for-if-elseif-else-application-match-loop-is-producing-incorrect-results/58109942#58109942", "title": "For, If, ElseIf, Else Application.Match Loop is Producing Incorrect Results", "body": "<p>After a through reading of the code I did notice that you have declared:\n<code>ThisWorkbook.Worksheets</code> and probably should read <code>Workbook.Sheet</code> whereas \n<code>WB2.Worksheets</code> should probably read <code>WB2.Sheet</code>\nAll of the declared variables should also match excel syntax spelling unless you have specifically named excel \"Sheet\" \"WorkSheets\" and \"WorkBooks\" check your code for Excel Name spelling errors.</p>\n"}], "owner": {"reputation": 45, "user_id": 7474299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYZnf.jpg?s=128&g=1", "display_name": "DanielT", "link": "https://stackoverflow.com/users/7474299/danielt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1569506201, "creation_date": 1569447893, "last_edit_date": 1569506201, "question_id": 58106940, "link": "https://stackoverflow.com/questions/58106940/for-if-elseif-else-application-match-loop-is-producing-incorrect-results", "title": "For, If, ElseIf, Else Application.Match Loop is Producing Incorrect Results", "body": "<p>I'm using Excel VBA code to help me sort and filter through multiple workbooks/sheets to be placed on a \"MATCHES\" sheet in a workbook holding the VBA code. This \"MATCHES\" workbook also contains another worksheet holding \"SOURCES\" data for the multiple worksheet locations in one or two worksheets per workbook for reviewed. I've come very far with my code, but I'm running into a head scratcher with results from a <em>Application.Match</em> not working as expected through a <em>For</em>, <em>If</em>, <em>ElseIf</em>, <em>Else</em> loop. Below is the code I have using an anchored sheet (\"WB2\") and two other sheets for now.</p>\n\n<pre><code>Sub MATCH()\n\n' KEY: \n' L = LIVE worksheet\n' T = TEST worksheet\n' R = Range (LR, TR)\n' B, C, F = Column of values to match (LB, TB, LC, TC, LF, TF)\n' # (2,13,etc.) = number associated with SOURCES worksheet (LB2, TF13, TR13, etc.)\n' MV = Match value\n' MX = Maximum rows of data compared among all sheets\n' AR = Active Row Number\n' WB = Workbook\n\n' Start position\nThisWorkbook.Worksheets(\"MATCHES\").Activate\nCells(2, 1).Activate\n' Calculate max rows among sheets\nDim MX1 As Range: Set MX1 = Worksheets(\"SOURCES\").Range(\"D2:D17\") 'LIVE worksheets\nDim MX2 As Range: Set MX2 = Worksheets(\"SOURCES\").Range(\"D12:D17\") 'TEST worksheets\nDim MX As Integer: MX = WorksheetFunction.Max(MX1, MX2) 'Max of 2 lines above\n\n' Variables for 'Kept' worksheet\nDim Filename2 As Variant: Filename2 = Worksheets(\"SOURCES\").Range(\"A2\") &amp; \".xlsx\"\n If Len(Filename2) &gt; 5 And Worksheets(\"SOURCES\").Range(\"C2\") = \"YES\" Then\n    Dim WB2 As Workbook: Set WB2 = Workbooks(Filename2)\n    Dim LB2 As Variant: LB2 = WB2.Worksheets(\"LIVE KEYS\").Range(\"$B$1:$B$\" &amp; MX)\n    Dim LC2 As Variant: LC2 = WB2.Worksheets(\"LIVE KEYS\").Range(\"$C$1:$C$\" &amp; MX)\n    Dim LF2 As Variant: LF2 = WB2.Worksheets(\"LIVE KEYS\").Range(\"$F$1:$F$\" &amp; MX)\n End If\n\n' Calculation Loop\nFor X = 2 To 5 'MX\n\n  ' Active row number\n  Dim AR As Integer: AR = ActiveCell.Row\n  ' Match values from 'Kept' work sheet\n  Dim MV(1 To 3) As Variant 'TEST KEPT FROM MERGE\n  MV(1) = WB2.Worksheets(\"LIVE KEYS\").Range(\"$B\" &amp; AR)\n  MV(2) = WB2.Worksheets(\"LIVE KEYS\").Range(\"$C\" &amp; AR)\n  MV(3) = WB2.Worksheets(\"LIVE KEYS\").Range(\"$F\" &amp; AR)\n\nMsgBox \"THE SURVEY SAYS...\"\n\n' Variables for non-kept sheets and match operations\n    Dim Filename13 As Variant: Filename13 = Worksheets(\"SOURCES\").Range(\"A13\") &amp; \".xlsx\"\n    If Len(Filename13) &gt; 5 And Worksheets(\"SOURCES\").Range(\"C13\") = \"YES\" Then\n    ' Range to search on workbook's worksheet\n    Dim WB13 As Workbook: Set WB13 = Workbooks(Filename13)\n    Dim TB13 As Variant: TB13 = WB13.Worksheets(\"TEST KEYS\").Range(\"$B$1:$B$\" &amp; MX)\n    Dim TC13 As Variant: TC13 = WB13.Worksheets(\"TEST KEYS\").Range(\"$C$1:$C$\" &amp; MX)\n    Dim TF13 As Variant: TF13 = WB13.Worksheets(\"TEST KEYS\").Range(\"$F$1:$F$\" &amp; MX)\n    ' Match results for current sheet\n    Dim M13F3 As Integer: On Error Resume Next: M13F3 = Application.MATCH(MV(3), TF13, 0)\n    Dim M13C2 As Integer: On Error Resume Next: M13C2 = Application.MATCH(MV(2), TC13, 0)\n    Dim M13B1 As Integer: On Error Resume Next: M13B1 = Application.MATCH(MV(1), TB13, 0)\n    End If\n  ' If below is \"True\" paste values from matched row (columns A-F) into \"MATCHES\" sheet\n  If Not IsError(M13F3) And Not IsError(M13C2) And Not IsError(M13B1) And M13B1 = M13C2 And M13B1 = M13F3 And M13C2 = M13F3 Then\n    Dim TR13 As Variant: TR13 = WB13.Worksheets(\"TEST KEYS\").Range(\"$A$\" &amp; M13B1 &amp; \":$F$\" &amp; M13B1)\n    Worksheets(\"MATCHES\").Range(\"$A$\" &amp; AR &amp; \":$F$\" &amp; AR) = TR13\n    MsgBox \"MATCH : 13\"\n    MsgBox \"NEXT!\"\n\n    Dim Filename14 As Variant: Filename14 = Worksheets(\"SOURCES\").Range(\"A14\") &amp; \".xlsx\"\n    If Len(Filename14) &gt; 5 And Worksheets(\"SOURCES\").Range(\"C14\") = \"YES\" Then\n    ' Range to search on workbook's worksheet\n    Dim WB14 As Workbook: Set WB14 = Workbooks(Filename14)\n    Dim TB14 As Variant: TB14 = WB14.Worksheets(\"TEST KEYS\").Range(\"$B$1:$B$\" &amp; MX)\n    Dim TC14 As Variant: TC14 = WB14.Worksheets(\"TEST KEYS\").Range(\"$C$1:$C$\" &amp; MX)\n    Dim TF14 As Variant: TF14 = WB14.Worksheets(\"TEST KEYS\").Range(\"$F$1:$F$\" &amp; MX)\n    ' Match results for current sheet\n    Dim M14F3 As Integer: On Error Resume Next: M14F3 = Application.MATCH(MV(3), TF14, 0)\n    Dim M14C2 As Integer: On Error Resume Next: M14C2 = Application.MATCH(MV(2), TC14, 0)\n    Dim M14B1 As Integer: On Error Resume Next: M14B1 = Application.MATCH(MV(1), TB14, 0)\n    End If\n  ' If below is \"True\" paste values from matched row (columns A-F) into \"MATCHES\" sheet\n  ElseIf Not IsError(M14F3) And Not IsError(M14C2) And Not IsError(M14B1) And M14B1 = M14C2 And M14B1 = M14F3 And M14C2 = M14F3 Then\n    Dim TR14 As Variant: TR14 = WB14.Worksheets(\"TEST KEYS\").Range(\"$A$\" &amp; M14B1 &amp; \":$F$\" &amp; M14B1)\n    MsgBox \"THE SURVEY SAYS...\"\n    Worksheets(\"MATCHES\").Range(\"$A$\" &amp; AR &amp; \":$F$\" &amp; AR) = TR14\n    MsgBox \"MATCH : 14\"\n    MsgBox \"NEXT!\"\n\n  Else\n    ' Match results for current sheet\n    Dim M2F3 As Integer: On Error Resume Next: M2F3 = Application.MATCH(MV(3), LF2, 0)\n    Dim M2C2 As Integer: On Error Resume Next: M2C2 = Application.MATCH(MV(2), LC2, 0)\n    Dim M2B1 As Integer: On Error Resume Next: M2B1 = Application.MATCH(MV(1), LB2, 0)\n    ' If \"True\" paste values from matched row (columns A-F) into \"MATCHES\" sheet\n    If Not IsError(M2F3) And Not IsError(M2C2) And Not IsError(M2B1) And M2B1 = M2C2 And M2B1 = M2F3 And M2C2 = M2F3 Then\n      Dim LR2 As Variant: LR2 = WB2.Worksheets(\"LIVE KEYS\").Range(\"$A$\" &amp; M2B1 &amp; \":$F$\" &amp; M2B1)\n      Worksheets(\"MATCHES\").Range(\"$A$\" &amp; AR &amp; \":$F$\" &amp; AR) = LR2\n      MsgBox \"MATCH : KEPT\"\n    End If\n    MsgBox \"NEXT!\"\n\n  End If\n\nY = X + 1\nCells(Y, 1).Activate\n\nNext\nMsgBox \"GAME OVER\"\n\nEnd Sub\n\n\n\n\n</code></pre>\n\n<p>The first loop works, but the second loop is matching values from a sheet where the values do not exist. On the second loop the first two workbooks should be skipped (as <em>False</em>) in the loop and the <em>Else</em> should be the results. - Btw, the <em>Else</em> workbook (referred to as \"anchored sheet\" above) is the sheet (\"WB2\") holding a bunch of merged data I have to unmerge in SQL db. So in other words, if a search for a value <strong>from</strong> this sheet pulls <em>False</em> in the other sheets then the value belongs with the \"anchor\" (\"WB2\") record. <strong>However</strong>, the first sheet is producing <em>True</em> where I've manually conducted a <em>Find</em> in Excel to verify it is NOT true, specifically this line...</p>\n\n<pre><code>Dim M13F3 As Integer: On Error Resume Next: M13F3 = Application.MATCH(MV(3), TF13, 0)\n</code></pre>\n\n<p>I have a screenshot that may or may not help.</p>\n\n<p><a href=\"https://i.stack.imgur.com/p4P7V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p4P7V.png\" alt=\"VBA Code\"></a> </p>\n\n<p>Btw, I've added another image below of the front end of Excel to help with the big picture in case there are some better ways to approach my requirements.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uKr3p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uKr3p.png\" alt=\"Excel Side\"></a></p>\n\n<p>I hope I provided enough information and not too much to troubleshoot this issue. Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1569446823, "post_id": 58106723, "comment_id": 102604159, "body": "You&#39;re missing <code>Set</code>: <code>Set a = a.Offset(1, 1)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1569447460, "last_edit_date": 1569447460, "creation_date": 1569447115, "answer_id": 58106793, "question_id": 58106723, "link": "https://stackoverflow.com/questions/58106723/vba-how-to-change-a-range-variable-using-something-like-offset/58106793#58106793", "title": "VBA how to change a range variable using something like offset", "body": "<p>Your current issue is that you're missing a <code>Set</code>:</p>\n\n<pre><code>Set a = a.Offset(1, 1)  \n</code></pre>\n\n<p>Note that you could also just use <code>i</code> and not re<code>Set</code>:</p>\n\n<pre><code>a.Offset(i, i).Value = i\n</code></pre>\n\n<p>Another option is to use <code>Cells</code>, e.g.</p>\n\n<pre><code>Sheets(1).Cells(i + 1, i + 1).Value = i\n</code></pre>\n\n<p>There's more than one way to skin a cat - pick whatever is easiest and most intuitive to future you.</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 10479237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c934033a757e883e8ce01c6196f5614?s=128&d=identicon&r=PG&f=1", "display_name": "RamenZzz", "link": "https://stackoverflow.com/users/10479237/ramenzzz"}, "is_accepted": false, "score": 0, "last_activity_date": 1569447626, "creation_date": 1569447626, "answer_id": 58106895, "question_id": 58106723, "link": "https://stackoverflow.com/questions/58106723/vba-how-to-change-a-range-variable-using-something-like-offset/58106895#58106895", "title": "VBA how to change a range variable using something like offset", "body": "<p>Thanks for the answer, I didn't know <code>set</code> was required in this case.  The specific answer I was looking for I have now found at:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/349613/what-does-the-keyword-set-actually-do-in-vba\">What does the keyword Set actually do in VBA?</a></p>\n\n<p>Specifically, the following answer by LeppyR64. \"Set is used for setting object references, as opposed to assigning a value.\"</p>\n\n<p>I didn't know that equality alone only impacted the value of the range object <code>a</code>.  To actually change the range <code>a</code> was referencing, I needed <code>set</code> because <code>a</code> is supposed to refer to a new range object. </p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1569476891, "creation_date": 1569476891, "answer_id": 58110302, "question_id": 58106723, "link": "https://stackoverflow.com/questions/58106723/vba-how-to-change-a-range-variable-using-something-like-offset/58110302#58110302", "title": "VBA how to change a range variable using something like offset", "body": "<p>the issue has already been addressed by @BigBen</p>\n\n<p>but you could avoid re-setting the range at every iteration by means of <code>With...End With</code> block </p>\n\n<pre><code>Option Explicit\n\nSub RangeExample()\n    Dim i As Long\n\n    With Sheets(1).Range(\"a1\") ' reference topleftmost cell\n        .Value = 0 ' write referenced cell value\n        For i = 1 To 100\n            .Offset(i, i).Value = i 'write referenced cell current offset value\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10479237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c934033a757e883e8ce01c6196f5614?s=128&d=identicon&r=PG&f=1", "display_name": "RamenZzz", "link": "https://stackoverflow.com/users/10479237/ramenzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 58106793, "answer_count": 3, "score": 0, "last_activity_date": 1569476891, "creation_date": 1569446718, "last_edit_date": 1569446890, "question_id": 58106723, "link": "https://stackoverflow.com/questions/58106723/vba-how-to-change-a-range-variable-using-something-like-offset", "title": "VBA how to change a range variable using something like offset", "body": "<p>I'd think that the following code should produce a diagonal of numbers, and I am wondering why this code doesn't work as intended:</p>\n\n<pre><code>Sub RangeExample()\n\nDim a As Range\n\nSet a = Sheets(1).Range(\"a1\")\n\na.Value = 0\n\nDim i As Integer\n\n\n    For i = 1 To 100\n\n        a = a.Offset(1, 1)\n        a.Value = i\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>I understand there are many ways of producing a diagonal of numbers,  I'm not asking how to do that.<br>\nWhat I'm asking is how I would change my range variable a to become a different range, and do that iteratively.  It seems to me that as <code>a.offset(1,1)</code> returns a range object that's one over and one down, I should be able to reassign a as this new range, assign a value, and move on.  </p>\n"}, {"tags": ["excel", "vba", "nested", "with-statement"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1569446106, "post_id": 58106543, "comment_id": 102603947, "body": "Since you don&#39;t actually make use of the second <code>With</code> (the one for &quot;Names and vendors&quot;), why not just remove it?"}, {"owner": {"reputation": 39, "user_id": 10642369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41bd0eb65ce084302a568011a05d30e?s=128&d=identicon&r=PG&f=1", "display_name": "Poppenhoffer", "link": "https://stackoverflow.com/users/10642369/poppenhoffer"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1569446209, "post_id": 58106543, "comment_id": 102603982, "body": "I will be. I&#39;ll be putting a loop in there to loop in all the extra data contained within, as designated by the &#39;more commands will go here&#39; comment."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1569446446, "post_id": 58106543, "comment_id": 102604052, "body": "Yes you can nest With blocks but there can only be one acting scope - that will be the scope of whatever is the closest <code>With</code>"}, {"owner": {"reputation": 39, "user_id": 10642369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41bd0eb65ce084302a568011a05d30e?s=128&d=identicon&r=PG&f=1", "display_name": "Poppenhoffer", "link": "https://stackoverflow.com/users/10642369/poppenhoffer"}, "edited": false, "score": 0, "creation_date": 1569446543, "post_id": 58106543, "comment_id": 102604075, "body": "Sorry, but can you elaborate? I assumed that whatever is contained inside the With would only finish via either by an End With command or by nesting another With in it (as I tried here)."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1569447290, "post_id": 58106543, "comment_id": 102604310, "body": "I am trying to replicate the Error 91.  Is the above code in Trials, Template, or elsewhere?  Is it in a sheet module or a class module?  How is the above code executed?  Is above code in a Sub or Function?  In order to determine which line of code is failing."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569447785, "post_id": 58106543, "comment_id": 102604465, "body": "If you&#39;re in a <code>With</code> and your code enters a second <code>With</code> (without first having hit an <code>End With</code> then the scope defined by the second <code>With</code> becomes the active scope until you hit the <code>End With</code>"}, {"owner": {"reputation": 39, "user_id": 10642369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41bd0eb65ce084302a568011a05d30e?s=128&d=identicon&r=PG&f=1", "display_name": "Poppenhoffer", "link": "https://stackoverflow.com/users/10642369/poppenhoffer"}, "edited": false, "score": 0, "creation_date": 1569447923, "post_id": 58106543, "comment_id": 102604506, "body": "It activates when clicking an ActiveX button in the Program sheet. Code is in Trials under a Private Sub."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1569447913, "creation_date": 1569447913, "answer_id": 58106942, "question_id": 58106543, "link": "https://stackoverflow.com/questions/58106543/can-i-nest-a-with-inside-a-with-when-both-are-designating-a-different-sheet-in-t/58106942#58106942", "title": "Can I nest a With inside a With when both are designating a different sheet in the same workbook? VBA", "body": "<p>If you're in a <code>With</code> block and your code enters a second <code>With</code> (without first having hit an <code>End With</code>) then the scope defined by the second <code>With</code> becomes the active scope until you hit the <code>End With</code> (or another <code>With</code>)</p>\n\n<pre><code>With A\n   'scope here is A\n   With B\n       'scope here is B\n   End with\n   'scope here is A\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 10642369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41bd0eb65ce084302a568011a05d30e?s=128&d=identicon&r=PG&f=1", "display_name": "Poppenhoffer", "link": "https://stackoverflow.com/users/10642369/poppenhoffer"}, "edited": false, "score": 0, "creation_date": 1569448505, "post_id": 58106979, "comment_id": 102604663, "body": "Thank you very much. As you can tell, I&#39;m sitting here with a VBA textbook my buddy lent me and using Google to try and bend this language to my purposes. I don&#39;t understand what you mean when talking about &quot;Me&quot; though. I have been using it to refer to the ActiveSheet basically. I assumed that Me designated the object in the scoped With."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 39, "user_id": 10642369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41bd0eb65ce084302a568011a05d30e?s=128&d=identicon&r=PG&f=1", "display_name": "Poppenhoffer", "link": "https://stackoverflow.com/users/10642369/poppenhoffer"}, "edited": false, "score": 0, "creation_date": 1569448936, "post_id": 58106979, "comment_id": 102604779, "body": "<i>I assumed that Me designated the object in the scoped With</i> no, it does not.  In a comment to the Q you said <i>Code is in Trials under a Private Sub</i> if this code is in the <code>Trials</code> module (listed under the &quot;Microsoft Excel Objects&quot; in the VBA editor) then <code>Me</code> refers to the <code>Trials</code> sheet.  The with block object is referenced with a leading <code>.</code> (as you have done with <code>.Rows</code> in <code>Me.Cells(.Rows.Count, &quot;B&quot;).End(xlUp).Row</code>)"}, {"owner": {"reputation": 39, "user_id": 10642369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41bd0eb65ce084302a568011a05d30e?s=128&d=identicon&r=PG&f=1", "display_name": "Poppenhoffer", "link": "https://stackoverflow.com/users/10642369/poppenhoffer"}, "edited": false, "score": 0, "creation_date": 1569508774, "post_id": 58106979, "comment_id": 102627472, "body": "Can I get you to clear up one last thing for me? I&#39;m getting a type mismatch with the check = .Evaluate..... line and after testing, it centers on the namecheck.Value and vencheck.Value. I&#39;ve used similar code elsewhere and it works, but not here for some reason. Tried rewriting it so that my code uses variants but that doesn&#39;t work. Here&#39;s the line that works already:                                                                                  rw = ThisWorkbook.Sheets(&quot;Names and Vendors&quot;).Evaluate(&quot;MATCH(1,(B1:B&quot; &amp; lr &amp; &quot;=&quot;&quot;&quot; &amp; arr(0) &amp; &quot;&quot;&quot;)*(C1:C&quot; &amp; lr &amp; &quot;=&quot;&quot;&quot; &amp; arr(1) &amp; &quot;&quot;&quot;),0)&quot;)"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 39, "user_id": 10642369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41bd0eb65ce084302a568011a05d30e?s=128&d=identicon&r=PG&f=1", "display_name": "Poppenhoffer", "link": "https://stackoverflow.com/users/10642369/poppenhoffer"}, "edited": false, "score": 0, "creation_date": 1569525969, "post_id": 58106979, "comment_id": 102635557, "body": "What are the values of the variables at that point? Do they produce a valid formula string?"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1569449279, "last_edit_date": 1569449279, "creation_date": 1569448122, "answer_id": 58106979, "question_id": 58106543, "link": "https://stackoverflow.com/questions/58106543/can-i-nest-a-with-inside-a-with-when-both-are-designating-a-different-sheet-in-t/58106979#58106979", "title": "Can I nest a With inside a With when both are designating a different sheet in the same workbook? VBA", "body": "<p>There are many issues in your code, none of which have anything to do with the <code>With</code> blocks.</p>\n\n<p>Based on a comment <em>I assumed that Me designated the object in the scoped With</em> use of <code>Me.</code> should be replaced with just <code>.</code></p>\n\n<p>See annotaions in code below marked with <code>'~~~</code></p>\n\n<pre><code>Dim RMs As Worksheet\nDim FLF As Worksheet\nSet RMs = Workbooks(\"FLF Coding Trials.xlsm\").Worksheets(\"Program\")\nSet FLF = Workbooks(\"FLF Template.xlsx\").Worksheets(\"FLF Sheet\")\n\nDim lng As Long\nDim cnt As Long\nDim check As Long\nDim length As Long\n\nDim namecheck As Range\nDim vencheck As Range\n\nWith ThisWorkbook.Sheets(\"Program\")\n    '~~~ .Rows refers to ThisWorkbook.Sheets(\"Program\").Rows\n    lng = .Cells(.Rows.Count, \"N\").End(xlUp).Row '~~~ drop the Me\n    For cnt = 1 To lng - 1 Step 1\n        'The two below lines work reliably\n        '~~~ Me implies this code is in a Worksheet code behind module, and refers to that sheet.  Is this what you intend?\n        FLF.Range(\"B\" &amp; cnt + 23).Value = .Range(\"N\" &amp; cnt + 1).Value '~~~ drop the Me\n        FLF.Range(\"N\" &amp; cnt + 23).Value = .Range(\"P\" &amp; cnt + 1).Value '~~~ drop the Me\n\n        'Adding the following variable designations and the With gives me the error. If I change the below two variables to strings I get a compile error\n        '~~~ there is no reference to the With block in these 2 lines of code\n        '~~~ And you havn't Set namecheck or vencheck. Add\n        Set namecheck = FLF.Range(\"B\" &amp; cnt + 23) '~~~ or whatever range you actually meant\n        Set vencheck = FLF.Range(\"N\" &amp; cnt + 23)\n        namecheck.Value = Range(\"N\" &amp; cnt + 1).Value '~~~ the unqualified Range(...) refers to the ActiveSheet.  Maybe should be .Range? \n        vencheck.Value = Range(\"P\" &amp; cnt + 1).Value\n\n        With ThisWorkbook.Sheets(\"Names and Vendors\")\n            '~~~ .Rows now refers to ThisWorkbook.Sheets(\"Names and Vendors\").Rows\n            length = .Cells(.Rows.Count, \"B\").End(xlUp).Row '~~~ drop the Me\n            '~~~ you can leave out ThisWorkbook.Sheets(\"Names and Vendors\") as this is in the With block for that sheet\n            check = .Evaluate(\"MATCH(1,(B1:B\" &amp; length &amp; \"=\"\"\" &amp; namecheck.Value &amp; \"\"\")*(C1:C\" &amp; length &amp; \"=\"\"\" &amp; vencheck.Value &amp; \"\"\"),0)\")\n            'more commands will go here\n        End With\n        '~~~ .Anything now refers to ThisWorkbook.Sheets(\"Program\").Anything again\n    Next cnt\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": -1, "last_activity_date": 1569489273, "last_edit_date": 1569489273, "creation_date": 1569451359, "answer_id": 58107432, "question_id": 58106543, "link": "https://stackoverflow.com/questions/58106543/can-i-nest-a-with-inside-a-with-when-both-are-designating-a-different-sheet-in-t/58107432#58107432", "title": "Can I nest a With inside a With when both are designating a different sheet in the same workbook? VBA", "body": "<p>The more correct answer to this question is that the With construct should be retricted to a simple sequence  of getters and setters of an object.  </p>\n\n<p>A good example of this is the Word Find object where the code below is common</p>\n\n<pre><code>With ActiveDocument.Content.Find\n     .Text = \"FindText\"\n     .Replacement.Text = \"ReplaceText\"\n     .Forward = True\n     .Wrap = wdFindStop\n     Do While .Execute() = True\n         .TypeParagraph\n         .MoveLeft Unit:=wdWord, Count:=2, Extend:=wdExtend\n         .Find.Replacement.Font.Italic = True\n         .Font.Bold = True\n         .Collapse Direction:=wdCollapseEnd\n     Loop\n End With\n</code></pre>\n\n<p>The more correct way to address the issue you raise is to use appropriate objects with local scope to provide the shortcuts you need  e.g</p>\n\n<p>Rather than </p>\n\n<pre><code>With ThisWorkbook.Sheets(\"Program\")\n\n    'Do xyz\n\nEnd With\n</code></pre>\n\n<p>Use</p>\n\n<pre><code>Dim mySourceWb  as excel.Worksheet\nSet mySOurceWb = ThisWorkbook.Sheets(\"Program\")\nDim myDestWb as Excel.Worksheet\nSet myDestWB = ADifferentWb.Sheets(\"YetAnotherSpreadsheet\")\n\n'Do xyz\n\nset mySourceWb=nothing\nset myDestWb=nothing\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10642369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41bd0eb65ce084302a568011a05d30e?s=128&d=identicon&r=PG&f=1", "display_name": "Poppenhoffer", "link": "https://stackoverflow.com/users/10642369/poppenhoffer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 58106942, "answer_count": 3, "score": 2, "last_activity_date": 1569489273, "creation_date": 1569445613, "question_id": 58106543, "link": "https://stackoverflow.com/questions/58106543/can-i-nest-a-with-inside-a-with-when-both-are-designating-a-different-sheet-in-t", "title": "Can I nest a With inside a With when both are designating a different sheet in the same workbook? VBA", "body": "<p>Basically, I've got a workbook that imports values from one sheet, then allows you to select some, add extra data, then transfers the selected items, your added values, and additional info contained in the sheet whose values are pulled from initially to another workbook. I need to be able to match the values inside the initial worksheet with the corresponding info in the other sheet (in the same workbook) so that I can take data from both and loop them in. I am worried that I am not allowed to nest my Withs when they both designate worksheets within the same workbook because I keep getting Error 91 (Object variable or With block variable not set). Is this true?</p>\n\n<pre><code>Dim RMs As Worksheet\nDim FLF As Worksheet\nSet RMs = Workbooks(\"FLF Coding Trials.xlsm\").Worksheets(\"Program\")\nSet FLF = Workbooks(\"FLF Template.xlsx\").Worksheets(\"FLF Sheet\")\n\nDim lng As Long\nDim cnt As Long\nDim check As Long\nDim length As Long\n\nDim namecheck As Range\nDim vencheck As Range\n\nWith ThisWorkbook.Sheets(\"Program\")\nlng = Me.Cells(.Rows.Count, \"N\").End(xlUp).Row\nFor cnt = 1 To lng - 1 Step 1\n    'The two below lines work reliably\n    FLF.Range(\"B\" &amp; cnt + 23).Value = Me.Range(\"N\" &amp; cnt + 1).Value\n    FLF.Range(\"N\" &amp; cnt + 23).Value = Me.Range(\"P\" &amp; cnt + 1).Value\n\n    'Adding the following variable designations and the With gives me the error. If I change the below two variables to strings I get a compile error\n    namecheck.Value = Range(\"N\" &amp; cnt + 1).Value\n    vencheck.Value = Range(\"P\" &amp; cnt + 1).Value\n\n        With ThisWorkbook.Sheets(\"Names and Vendors\")\n        length = Me.Cells(.Rows.Count, \"B\").End(xlUp).Row\n        check = ThisWorkbook.Sheets(\"Names and Vendors\").Evaluate(\"MATCH(1,(B1:B\" &amp; length &amp; \"=\"\"\" &amp; namecheck.Value &amp; \"\"\")*(C1:C\" &amp; length &amp; \"=\"\"\" &amp; vencheck.Value &amp; \"\"\"),0)\")\n        'more commands will go here\n        End With\n    Next cnt\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "while-loop"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1569444799, "post_id": 58106268, "comment_id": 102603531, "body": "Why do you use <code>myid</code> Offset with variable <code>rr</code> (=A2) and offset <code>0,0</code>?? That will always point <code>myid</code> to cell A2 in your code, no matter what number <code>r</code> currently is."}], "answers": [{"comments": [{"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1569451402, "post_id": 58106454, "comment_id": 102605368, "body": "thank you for taking time to look at my code. I will try your suggestions and revert."}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1569510871, "post_id": 58106454, "comment_id": 102628651, "body": "I tried your suggestions, but it did not seem to work. It continued to update the previous value. It may be possible that i used it in the wrong place. I added your edited before &quot;Wend&quot;."}, {"owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "edited": false, "score": 0, "creation_date": 1569510926, "post_id": 58106454, "comment_id": 102628675, "body": "I did manage to get it to work using a For Each loop. But, i&#39;d be interested to learn the way you had in mind too."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1569445150, "creation_date": 1569445150, "answer_id": 58106454, "question_id": 58106268, "link": "https://stackoverflow.com/questions/58106268/vba-while-wend-loop-updating-the-previous-row/58106454#58106454", "title": "VBA WHILE/WEND Loop Updating the Previous Row", "body": "<p>The variable <code>myid</code> is always pointing to cell A2. If you want the loop to return the ID based on the current row, you need to change the row <code>myid = rr.Offset(0, 0).Value</code>.</p>\n\n<p>Since <code>rr</code> points to A2 and <code>r</code> starts at value 2, maybe you need</p>\n\n<pre><code>myid = rr.Offset(r-1, 0).Value\n</code></pre>\n\n<p>Or initialise <code>r</code> with 1 and just do </p>\n\n<pre><code>myid = rr.Offset(r, 0).Value\n</code></pre>\n"}], "owner": {"reputation": 683, "user_id": 1972914, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/pspXz.jpg?s=128&g=1", "display_name": "marv", "link": "https://stackoverflow.com/users/1972914/marv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594449071, "creation_date": 1569444126, "last_edit_date": 1594449071, "question_id": 58106268, "link": "https://stackoverflow.com/questions/58106268/vba-while-wend-loop-updating-the-previous-row", "title": "VBA WHILE/WEND Loop Updating the Previous Row", "body": "<p>I'm updating MS Access using a While/Wend loop based on a condition. The query seems to update the previous record in my table that <em>does not meet</em> the loop criteria and <em>does not update the actual record</em> that meets the criteria.</p>\n\n<p>This section of the code has the identifier that i use to update Access:</p>\n\n<pre><code>Dim rr As Range\nSet rr = [a2]\n</code></pre>\n\n<p>This section increments the row:</p>\n\n<pre><code>Dim r As Long \nr = 2\n</code></pre>\n\n<p>Now, I'm checking as long as the length in column A that contains the identifier is greater than zero, and the corresponding cell in column F contains a \"Yes\", execute the sql query:</p>\n\n<pre><code>While Len(Sheet2.Range(\"A\" &amp; r).Formula) &gt; 0\n   If Sheet2.Range(\"F\" &amp; r).Value = \"Yes\" Then\n      myid = rr.Offset(0, 0).Value\n      qString = \"UPDATE [table] SET [Status]= '\" &amp; statusvalue &amp; \"' WHERE [Key]='\" &amp; myid &amp; \"'\"\n      cn.Execute qString, dbFailOnError\n   End If\n   r = r + 1\nWend\n</code></pre>\n\n<p>The query updates the database fine, just that it updates the incorrect record. For example, if row 2 does not contain a \"Yes\" and row 3 does, the record on row 2 gets updated in the database instead of the record on row 3!\nI think this has something to do with my loop, which i am not able to figure out.</p>\n\n<p>Hoping someone out there can help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1569444819, "post_id": 58106241, "comment_id": 102603541, "body": "It&#39;s all a matter of <code>scope</code>.  The <code>coll</code> object is defined in your sub and only visible in that sub.  You need to move it to the top of your file making it global."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1569445844, "post_id": 58106241, "comment_id": 102603862, "body": "@BrianMStafford *making it <i>instance state</i> (assuming we&#39;re looking at a UserForm or Worksheet module), not global ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1569447842, "last_edit_date": 1569447842, "creation_date": 1569444883, "answer_id": 58106399, "question_id": 58106241, "link": "https://stackoverflow.com/questions/58106241/passing-an-array-between-click-subs-in-vba/58106399#58106399", "title": "Passing an array between click Subs in VBA", "body": "<p>See <a href=\"https://stackoverflow.com/a/58086375/1188513\">this answer</a> for why you can't just willy-nilly tweak event handler procedure signatures to suit your needs.</p>\n\n<p>Each procedure defines a <em>scope</em>. Local variables (whether declared with <code>Dim</code>, ...or not declared at all) live inside that procedure scope, and have no way out.</p>\n\n<p>The next higher-up scope level is <em>module scope</em>. Variables declared in that scope are accessible to all procedures in the module. Use the <code>Private</code> keyword to declare them (<code>Dim</code> is also legal, but I prefer to reserve it for locals, since <code>Private</code> isn't legal at procedure level) - consider using a <em>meaningful</em> identifier name, too... \"coll\" doesn't say much about <em>what it's for</em>:</p>\n\n<pre><code>Option Explicit\nPrivate RowNumbers As Object\n</code></pre>\n\n<p>And then you can initialize it in the <code>Initialize</code> handler:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Set RowNumbers = CreateObject(\"System.Collections.ArrayList\")\nEnd Sub\n</code></pre>\n\n<p>Probably also a good idea to explicitly wipe it out in the <code>Terminate</code> handler too, since that's a .NET object (FWIW this isn't a VBA array at all and has nothing to do with arrays):</p>\n\n<pre><code>Private Sub UserForm_Terminate()\n    Set RowNumbers = Nothing\nEnd Sub\n</code></pre>\n\n<p>The next higher-up scope level is <em>global scope</em>, but once you understand how to pass parameters between procedures, and when to use module scope variables, you pretty much never need any globals. For completleness' sake, a global variable would be declared in a <em>standard module</em>, using the <code>Public</code> keyword (<code>Global</code> works too, but makes things confusing since what we call \"global\" is really just \"project-scope\", and besides <code>Public</code> is much more clearly antagonizing <code>Private</code>, so it's good for consistency).</p>\n\n<hr>\n\n<p>If you added <code>Option Explicit</code> to the top of your modules, VBA would refuse to compile code that uses undeclared variables - and that would have highlighted <code>coll</code> and, likely, <code>NumberIndex</code> as well.</p>\n\n<p>See if <a href=\"http://www.rubberduckvba.com/\" rel=\"nofollow noreferrer\">Rubberduck</a> inspections flag other issues (disclaimer: I manage that open-source project).</p>\n"}], "owner": {"reputation": 373, "user_id": 11625533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb1436dbdfe05c8c049cc876be3f4f99?s=128&d=identicon&r=PG&f=1", "display_name": "grand2019", "link": "https://stackoverflow.com/users/11625533/grand2019"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569447842, "creation_date": 1569444008, "last_edit_date": 1569444320, "question_id": 58106241, "link": "https://stackoverflow.com/questions/58106241/passing-an-array-between-click-subs-in-vba", "title": "Passing an array between click Subs in VBA", "body": "<p>I am trying to declare and populate an array variable (coll), but wish to access the contents of the array in another Sub (UnassignButton_Click()). I keep getting the error: </p>\n\n<blockquote>\n  <p>Compile error: Sub or Function not defined</p>\n</blockquote>\n\n<p>Below is my code:</p>\n\n<pre><code>Public Sub SearchButton_Click()\nDim RowNum As Long\nDim SearchRow As Long\nDim coll As Object\nSet coll = CreateObject(\"System.Collections.ArrayList\")\n\nRowNum = 2\nSearchRow = 2\n\nDo Until Cells(RowNum, 1).Value = \"\"\n    If InStr(1, Cells(RowNum, 1).Value, SearchTextBox.Value, vbTextCompare) &gt; 0 Then\n        Worksheets(\"Search_Results\").Cells(SearchRow, 1).Value = Cells(RowNum, 1).Value\n        Worksheets(\"Search_Results\").Cells(SearchRow, 2).Value = Cells(RowNum, 2).Value\n        Worksheets(\"Search_Results\").Cells(SearchRow, 3).Value = Cells(RowNum, 3).Value\n        Worksheets(\"Search_Results\").Cells(SearchRow, 4).Value = Cells(RowNum, 4).Value\n        Worksheets(\"Search_Results\").Cells(SearchRow, 5).Value = Cells(RowNum, 5).Value\n        Worksheets(\"Search_Results\").Cells(SearchRow, 6).Value = Cells(RowNum, 6).Value\n        Worksheets(\"Search_Results\").Cells(SearchRow, 7).Value = Cells(RowNum, 7).Value\n        Worksheets(\"Search_Results\").Cells(SearchRow, 8).Value = Cells(RowNum, 8).Value\n        Worksheets(\"Search_Results\").Cells(SearchRow, 9).Value = Cells(RowNum, 9).Value\n        SearchRow = SearchRow + 1\n        coll.Add RowNum\n    End If\n    RowNum = RowNum + 1\nLoop\n\nIf SearchRow = 2 Then\n    MsgBox \"No products were found that match your search criteria\"\n    Exit Sub\nEnd If\n\nSearchResultsListBox.RowSource = \"SearchResults\"\n\nEnd Sub\n\nPrivate Sub SearchResultsListBox_Click()\nNumberIndex = SearchResultsListBox.ListIndex\nEnd Sub\n\nPublic Sub UnassignButton_Click()\nNumberIndex = SearchResultsListBox.ListIndex\nMsgBox coll(NumberIndex)\n\nEnd Sub\n</code></pre>\n\n<p>Any help to resolve this issue would be much appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569443299, "post_id": 58106100, "comment_id": 102603008, "body": "Do you have <code>On Error Resume Next</code> anywhere?"}, {"owner": {"reputation": 59, "user_id": 6391744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b29015e15be2c550c205200f458f8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos", "link": "https://stackoverflow.com/users/6391744/carlos"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569443434, "post_id": 58106100, "comment_id": 102603057, "body": "No I do not. @BigBen"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1569444061, "post_id": 58106100, "comment_id": 102603287, "body": "You may need to explicitly state which workbook <code>Worksheets(&quot;Sheet1&quot;)</code> is in"}], "answers": [{"tags": [], "owner": {"reputation": 498, "user_id": 3649492, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/sW2Cv.jpg?s=128&g=1", "display_name": "Dilnoor Singh", "link": "https://stackoverflow.com/users/3649492/dilnoor-singh"}, "is_accepted": false, "score": -1, "last_activity_date": 1569445088, "creation_date": 1569445088, "answer_id": 58106437, "question_id": 58106100, "link": "https://stackoverflow.com/questions/58106100/vlookup-getting-information-from-different-workbooks/58106437#58106437", "title": "VLookup getting information from different workbooks", "body": "<p>Though the exact problem can be known, If I get the complete code but with the information you gave, In my experience, I have noticed that Excel behaves in a non-deterministic way mostly under 2 circumstances:</p>\n\n<ol>\n<li>Excel may have entered into a Manual Sheet Calculation mode, either because you did so deliberately or if there are a lot of formulas on the sheet. You can verify this if you have the <strong>Calculate</strong> option in the bottom left of excel window.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/qOYP2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qOYP2.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"2\">\n<li>You might have the Record Macro Option turned on.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1569447587, "post_id": 58106518, "comment_id": 102604403, "body": "Also if this is some macro you run al the time, look into <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.executeexcel4macro\" rel=\"nofollow noreferrer\"><code>ExecuteExcel4Macro</code></a> to prevent opening/closing of other workbooks"}], "tags": [], "owner": {"reputation": 59, "user_id": 6391744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b29015e15be2c550c205200f458f8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos", "link": "https://stackoverflow.com/users/6391744/carlos"}, "is_accepted": false, "score": 0, "last_activity_date": 1571603964, "last_edit_date": 1571603964, "creation_date": 1569445485, "answer_id": 58106518, "question_id": 58106100, "link": "https://stackoverflow.com/questions/58106100/vlookup-getting-information-from-different-workbooks/58106518#58106518", "title": "VLookup getting information from different workbooks", "body": "<p>Through tinkering I have figured out my problem and it was two part.</p>\n\n<p>Firstly, this is a guess because I did this on the off chance of it working.</p>\n\n<p>The cell H5 was formatted as General so when the \"-\" was added to the number it made the whole cell be considered as a string and the numbers in the other file are classified as numbers. </p>\n\n<p>Secondly:</p>\n\n<p>I had to specify <code>ThisWorkbook.Worksheets(\"Sheet1\").Range(\"I5\").Value =</code> (thank you @cybernetic.nomad).</p>\n"}], "owner": {"reputation": 59, "user_id": 6391744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b29015e15be2c550c205200f458f8cf?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos", "link": "https://stackoverflow.com/users/6391744/carlos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571603964, "creation_date": 1569443225, "question_id": 58106100, "link": "https://stackoverflow.com/questions/58106100/vlookup-getting-information-from-different-workbooks", "title": "VLookup getting information from different workbooks", "body": "<p>As I step through my code I do not get any error however the code does not return anything. I do not know what to do in order to fix the issue.</p>\n\n<p>Value of H5 = 161-0123. the first three numbers identify the type of part (Also which sheet I will be looking through) and the last four are the part number inside the specific sheet</p>\n\n<pre><code>Dim LookUp As String\nDim Typ As String\n\nTyp = Left(Range(\"H5\"), 3)\nLookUp = Right(Range(\"H5\"), 4)\n\n\nApplication.ScreenUpdating = False\nSet wbk1 = Workbooks.Open(\"R:\\Item Master List\\Item Master Log.xlsx\")\n\nDim sheet1 As Worksheet\nSet sheet1 = wbk1.Worksheets(\"161-Polyimide\")\n\nWorksheets(\"Sheet1\").Range(\"I5\").Value = Application.VLookup(LookUp, sheet1.Range(\"A:J\"), 8, 0)\n</code></pre>\n\n<p>161-0123 has a component number associated with it which is what cell I5 is supposed to retrieve (195-1234)</p>\n\n<p>Input in H5 = 161-0123</p>\n\n<p>Output in I5 = 195-1234</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11704069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984915101ae9b8d0688faca991f1aff2?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/11704069/paul"}, "edited": false, "score": 0, "creation_date": 1569515261, "post_id": 58106086, "comment_id": 102630771, "body": "Thank you for the information! Looks like next on my list of VBA things to understand is the difference between A1 and R1C1."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1569443157, "creation_date": 1569443157, "answer_id": 58106086, "question_id": 58106036, "link": "https://stackoverflow.com/questions/58106036/vba-range-variable-in-a-sumif-formula/58106086#58106086", "title": "VBA: Range Variable in a SUMIF Formula", "body": "<blockquote>\n  <p><code>x.Address(False, False)</code></p>\n</blockquote>\n\n<p>Returns the address in A1 style and you cannot mix A1 and R1C1 styles:</p>\n\n<pre><code>range(\"D3\").FormulaR1C1 = \"=SUMIF(R3C13:R132C13,RC[-2],\" &amp; x.Address(False, False,xlR1C1) &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11704069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984915101ae9b8d0688faca991f1aff2?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/11704069/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 58106086, "answer_count": 1, "score": 0, "last_activity_date": 1569443157, "creation_date": 1569442950, "question_id": 58106036, "link": "https://stackoverflow.com/questions/58106036/vba-range-variable-in-a-sumif-formula", "title": "VBA: Range Variable in a SUMIF Formula", "body": "<p>I'm attempting to use a range variable in a SUMIF function. The issue I have been running into with other answers I've seen is the variable being passed into the formula as 'N2':'N132' and resulting in a #NAME? error. I'm hoping to achieve not only the range being properly passed through but also having it locked $N$2:$N$132. the code is as follows:</p>\n\n<p>Thank you for your help in advance.</p>\n\n<pre><code>Dim sh1 As Worksheet\nDim x As range\nDim y As range\n\n\n\nSet sh1 = ThisWorkbook.Sheets(\"Open Orders 180-365\")\nsh1.Activate\n\nSet x = range(\"N2\", range(\"N2\").End(xlDown))\n\n\nrange(\"K:K\").Find(What:=\"Open Order Detail 90-179 Days\", MatchCase:=True).Select\n\nSelection.Offset(1, 3).Select\n\nSet y = range(Selection, Selection.End(xlDown))\n\nrange(\"D3\").FormulaR1C1 = \"=SUMIF(R3C13:R132C13,RC[-2],\" &amp; x.Address(False, False) &amp; \")\"\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "save"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1569443571, "post_id": 58106013, "comment_id": 102603106, "body": "is your document saved as an <a href=\"https://support.office.com/en-us/article/Save-a-workbook-as-a-template-58c6625a-2c0b-4446-9689-ad8baec39e1e\" rel=\"nofollow noreferrer\"><code>XLTX</code></a>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1569443958, "post_id": 58106013, "comment_id": 102603248, "body": "&quot;preventing save but allowing save as&quot; sounds very, very, very, VERY much like read-only, doesn&#39;t it?"}, {"owner": {"reputation": 1, "user_id": 11449649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec6794f18bd6e5c096f3601facf062c?s=128&d=identicon&r=PG&f=1", "display_name": "SMC_BRL", "link": "https://stackoverflow.com/users/11449649/smc-brl"}, "edited": false, "score": 0, "creation_date": 1569512506, "post_id": 58106013, "comment_id": 102629469, "body": "My document is saved as a XLSM As for making the document read only that would only solve some of my issues. The template would be safe, but working from your own desktop could still compromise other folders. And again Saving is ok if it passes the file name check. -I have updated the title to make this more clear."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11449649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec6794f18bd6e5c096f3601facf062c?s=128&d=identicon&r=PG&f=1", "display_name": "SMC_BRL", "link": "https://stackoverflow.com/users/11449649/smc-brl"}, "edited": false, "score": 0, "creation_date": 1569514501, "post_id": 58110221, "comment_id": 102630387, "body": "Would the second If statement ever be true? The first if statement is identical and turns the second one to false."}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "reply_to_user": {"reputation": 1, "user_id": 11449649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec6794f18bd6e5c096f3601facf062c?s=128&d=identicon&r=PG&f=1", "display_name": "SMC_BRL", "link": "https://stackoverflow.com/users/11449649/smc-brl"}, "edited": false, "score": 0, "creation_date": 1569523893, "post_id": 58110221, "comment_id": 102634661, "body": "If you are coming from Save it will be true si you won&#39;t get a save as windows. If you are coming from Save as, it will be false and you will get your desired Save as windows."}], "tags": [], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "is_accepted": false, "score": 0, "last_activity_date": 1569476369, "creation_date": 1569476369, "answer_id": 58110221, "question_id": 58106013, "link": "https://stackoverflow.com/questions/58106013/preventing-save-througth-conditional-arguments-without-preventing-saveas-due-to/58110221#58110221", "title": "Preventing Save througth conditional arguments without preventing Saveas due to the same conditions", "body": "<p>Workbook_BeforeClose Occurs before the workbook is saved, it doesn\u00b4t matter if it a \"Save\" or \"Save as...\" as describe <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.beforesave\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>So this procedure will work always and just place a MsgBox to bet the value of ThisWorkbook.Saved to monitor it.</p>\n\n<p>If you want to really \"Save as...\" as you will always trigger this procedure it is adding a \"Save as...\" after the backup saving.</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nIf ThisWorkbook.Saved = False Then\nThisWorkbook.Saved = True\nActiveWorkbook.SaveAs Filename:=*backupfilelocation*\nEnd If\nIf ThisWorkbook.Saved = False Then ActiveWorkbook.SaveAs\n</code></pre>\n\n<p>So if you use \"Save\", will work as expected and if you used \"Save as...\", it will create a bckup file but it will allow you to save as properly.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 1, "user_id": 11449649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec6794f18bd6e5c096f3601facf062c?s=128&d=identicon&r=PG&f=1", "display_name": "SMC_BRL", "link": "https://stackoverflow.com/users/11449649/smc-brl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569512617, "creation_date": 1569442824, "last_edit_date": 1569512617, "question_id": 58106013, "link": "https://stackoverflow.com/questions/58106013/preventing-save-througth-conditional-arguments-without-preventing-saveas-due-to", "title": "Preventing Save througth conditional arguments without preventing Saveas due to the same conditions", "body": "<p>I have a template I have been working on. The Sheet uses a two main functions I will be talking about. First is a Save(func) which saves a copy of the document to the correct folder while leaving the template be. The second is a Rev Up function, Whenever a change is made to the template a new copy is saved so the old one remains. Both of these functions work perfectly. </p>\n\n<p>The issues comes from human error. When the template is open it is very easy to hit save(the in excel version not the VBA button I created) or to when closing the template the \"file not saved\" pops up and again it is easy to hit save. </p>\n\n<p>When someone is working from there desktop they will often use a prefiled in spread sheet as some of them have a lot of overlap which can save a lot of work vs starting with the template. So all of my functions have to remain active. When working on a prefiled in sheet, both of those issues are magnified as they cause a lot of mistakes and lost work. </p>\n\n<p>To solve this problem I have added 3 functions that all work fine on there own. </p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n\nIf Fileonly = Filename Then    \n\n    Else:\n        Cancel = True 'Cancels any request to save the file\n        MsgBox \"File name does not match part number, Use Rev up button for format changes or use Save button to create new file!\"\nEnd If\n</code></pre>\n\n<p>I want this code to active when the save button is hit. Then compare the current filename to the name that would be given to the file if the file was saved(func) right there. This code does exactly what i want it to do... and more. </p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nIf ThisWorkbook.Saved = False Then\n\nThisWorkbook.Saved = True\nActiveWorkbook.SaveAs Filename:=*backupfilelocation*\n\nEnd If\n</code></pre>\n\n<p>This code is used to supresse the \"do you want to save changes\" the file will set itself to saved then it will save a copy of the file to a back up location if you saved on accident. Again this code works perfect. But the <code>Saveas</code> function triggers the <code>beforesave</code> code. Then prevents the file from saving. </p>\n\n<p>I have 2 other macros that also save the file. How do I allow the <code>saveas</code> to work while suppressing the ability to save over, unless the titles match. </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1569446827, "post_id": 58105964, "comment_id": 102604161, "body": "Did you try them on a test worksheet?"}], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 2, "creation_date": 1570296253, "post_id": 58106542, "comment_id": 102871700, "body": "Thanks @Dilnoor.  Am I correct in assuming that AutoFill includes and is a superset of FillDown?  for example range(&quot;a1:a5&quot;).FillDown is like shorthand of range(&quot;a1&quot;).AutoFill range(&quot;a1:a5&quot;), xlFillCopy?"}], "tags": [], "owner": {"reputation": 498, "user_id": 3649492, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/sW2Cv.jpg?s=128&g=1", "display_name": "Dilnoor Singh", "link": "https://stackoverflow.com/users/3649492/dilnoor-singh"}, "is_accepted": true, "score": 3, "last_activity_date": 1569445612, "creation_date": 1569445612, "answer_id": 58106542, "question_id": 58105964, "link": "https://stackoverflow.com/questions/58105964/autofill-vs-filldown-whats-the-difference/58106542#58106542", "title": "AutoFill vs FillDown: what&#39;s the difference?", "body": "<p><strong>For Autofill</strong></p>\n\n<pre><code>expression.AutoFill (Destination, Type)\n</code></pre>\n\n<p>The type parameter controls how the information is going to be copied onto the destination cells. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlautofilltype\" rel=\"nofollow noreferrer\">This page</a> lists them all. So you have control over whether only the values or formats or patterns of the source cells will be copied.</p>\n\n<p><strong>For FillDown</strong></p>\n\n<p>There is no such control.\nAnd as the documentation quotes</p>\n\n<blockquote>\n  <p>The <strong>contents and formatting of the cell</strong> or cells in the top row of a\n  range are copied into the rest of the rows in the range.</p>\n</blockquote>\n"}], "owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "accepted_answer_id": 58106542, "answer_count": 1, "score": 1, "last_activity_date": 1569445612, "creation_date": 1569442507, "question_id": 58105964, "link": "https://stackoverflow.com/questions/58105964/autofill-vs-filldown-whats-the-difference", "title": "AutoFill vs FillDown: what&#39;s the difference?", "body": "<p><strong>AutoFill</strong>: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.autofill\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.autofill</a><br>\n<strong>FillDown</strong>: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.filldown\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.filldown</a></p>\n\n<p>What are the difference between the two?</p>\n\n<p>The description of AutoFill in the MS documentation is: \"Performs an autofill on the cells in the specified range.\"<br>\nTotally useless...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1569442698, "post_id": 58105955, "comment_id": 102602783, "body": "the issue of time is not the IF/ELSEIF/ELSE function it is the fact that you are iterating &gt;10,000 rows.  Load the values in bulk into a variant array and iterate the array.  Nothing you do to this function will speed up the code."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1569442709, "post_id": 58105955, "comment_id": 102602788, "body": "If you have cut-points, you can use binary search to find which interval something lies in, but if Excel is freezing, that is unlikely to be the main problem. For a concrete case, the binary search can be hard-wired by nested conditionals which implement a <a href=\"https://en.wikipedia.org/wiki/Binary_decision_diagram\" rel=\"nofollow noreferrer\">binary decision tree</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1569443729, "post_id": 58105955, "comment_id": 102603159, "body": "@JvdV undeclared integers are automatically wrapped in a <code>Variant</code>, <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/data-type-summary\" rel=\"nofollow noreferrer\">that&#39;s 16 bytes for any numeric value</a>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1569443878, "post_id": 58105955, "comment_id": 102603211, "body": "@matthieuguindon, deleted my comment just as you replied as I was not sure if it would matter in this case anyway. But declaring a variable always makes sense. Byte-wise"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1569444019, "post_id": 58105955, "comment_id": 102603267, "body": "Also readability-wise, performance-wise, maintanability-wise, and code-quality -wise... IOW declaring variables is always ...wise ;-)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569444542, "post_id": 58105955, "comment_id": 102603438, "body": "So: <code>Function Function_Name(Input) as Long</code>. Should speed up the code a little bit. I recon <code>VAL</code> is used to return numeric value from a alphanumeric string, where data type string would not have a major impact, if any. @mathieuguindon"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569444664, "post_id": 58105955, "comment_id": 102603479, "body": "Also <code>ByVal input As Range</code>, assuming the input is some cell reference. Or <code>ByVal input As Long</code> if it&#39;s just any number."}, {"owner": {"reputation": 42, "user_id": 12121394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500abfc8a3a455f2cae868a37f16047?s=128&d=identicon&r=PG&f=1", "display_name": "Marat_Muginov", "link": "https://stackoverflow.com/users/12121394/marat-muginov"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1569444814, "post_id": 58105955, "comment_id": 102603536, "body": "@JvdV Thank you for your suggestion, I will attempt that. Your recollection of VAL() is spot on. My source data has leading zeroes so numeric values have to be stored as text, but VAL() converts them back to integers for the purpose of &lt;= / &gt;= comparison."}, {"owner": {"reputation": 42, "user_id": 12121394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500abfc8a3a455f2cae868a37f16047?s=128&d=identicon&r=PG&f=1", "display_name": "Marat_Muginov", "link": "https://stackoverflow.com/users/12121394/marat-muginov"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1569446038, "post_id": 58105955, "comment_id": 102603923, "body": "@JvdV I am afraid declaring the function <code>As Long</code> produced invalid results - my text outputs were turned into <code>#VALUE</code> errors in Excel and my numbers as text outputs were converted into Number format, which was not my intention."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1569446476, "post_id": 58105955, "comment_id": 102604058, "body": "Any reason to ouput numeric values as text?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569451575, "post_id": 58105955, "comment_id": 102605405, "body": "Try invoking the function from the immediate pane (Ctrl+G) instead of from a worksheet cell. <code>#VALUE!</code> indicates a run-time error - the calc engine is swallowing it; the immediate pane won&#39;t."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1569451751, "post_id": 58105955, "comment_id": 102605438, "body": "Also, do not conflate numeric values with number formatting - if this function means to output anything that is or could be later used for any kind of math, you want numbers, not strings that look like they&#39;re numbers. Lastly, consider using an explicit conversion function like <code>CLng</code> instead of <code>Val</code>, lest you&#39;ll possibly run into problems when regional settings and different workstations using different decimal separators factor in."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569451942, "post_id": 58105955, "comment_id": 102605469, "body": "In any case, it looks very much like the entire function could be scrapped and replaced with a VLOOKUP over a sorted lookup table; have the thresholds in column 1 and the output in column 2, sort ascending by col.1, and specify <code>TRUE</code> for the last argument of VLOOKUP."}, {"owner": {"reputation": 42, "user_id": 12121394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500abfc8a3a455f2cae868a37f16047?s=128&d=identicon&r=PG&f=1", "display_name": "Marat_Muginov", "link": "https://stackoverflow.com/users/12121394/marat-muginov"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1569455477, "post_id": 58105955, "comment_id": 102606085, "body": "@JvdV The output will contain leading zeroes. The output data is also intended for users who do not have time to manually reformat the output to include leading zeroes. It would also be time consuming."}], "answers": [{"comments": [{"owner": {"reputation": 42, "user_id": 12121394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500abfc8a3a455f2cae868a37f16047?s=128&d=identicon&r=PG&f=1", "display_name": "Marat_Muginov", "link": "https://stackoverflow.com/users/12121394/marat-muginov"}, "edited": false, "score": 0, "creation_date": 1569456591, "post_id": 58107584, "comment_id": 102606296, "body": "Mathieu, thank you so much for an alternative solution. A table is what I originally used as a reference for the rules and it already includes &quot;threshold&quot;, which I had named &quot;lower_limit&quot;, &quot;upper_limit&quot;, and &quot;result&quot;. if my understanding is correct, I can substitute the column names in the VLOOKUP formula you&#39;ve provided to my own column names. In any case, I will attempt this solution and let you know if it works. Thank you again for your help."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 42, "user_id": 12121394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500abfc8a3a455f2cae868a37f16047?s=128&d=identicon&r=PG&f=1", "display_name": "Marat_Muginov", "link": "https://stackoverflow.com/users/12121394/marat-muginov"}, "edited": false, "score": 0, "creation_date": 1569456643, "post_id": 58107584, "comment_id": 102606307, "body": "@Marat_Muginov you only need the lower limit though - the most important part is the ascending sort, and the <code>TRUE</code> final argument to VLOOKUP."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1569453218, "last_edit_date": 1569453218, "creation_date": 1569452555, "answer_id": 58107584, "question_id": 58105955, "link": "https://stackoverflow.com/questions/58105955/is-there-a-method-for-shortening-nested-if-then-else-statements/58107584#58107584", "title": "Is there a method for shortening nested If...Then...Else statements?", "body": "<p>Scrap the whole function, add a new sheet (hide it if you must), type \"Threshold\" in A1, \"Value\" in A2, then begin populating your lookup table (Ctrl+T) to make it an actual <em>table</em>, then name it, e.g. <code>refTable</code>):</p>\n\n<pre><code>Threshold   Value\n        0   =NA()\n     1100   1100\n     1200   1200\n     1300   1300\n      ...   ...\n</code></pre>\n\n<p>Now wherever you were using that function (where B2 is your current \"input\"):</p>\n\n<pre><code>=IFERROR(VLOOKUP(refTable[[Threshold]:[Value]], B2, TRUE), B2)\n</code></pre>\n\n<p>The TRUE final argument makes the function match the largest value in column 1 that isn't greater than the lookup value, so 4256 would match the 4200 threshold, stopping short of 4300.</p>\n\n<p>This assumes the lookup values aren't calculatable with simple math (i.e. that the 5710 result isn't a typo). Otherwise, there's an easy an much better-performing alternative:</p>\n\n<pre><code>=IF(B2&gt;=1100,INT(B2/100)*100,B2)\n</code></pre>\n\n<p>If the input is greater than or equal to 1100, take the integer value of this input divided by 100, multiply that by 100 (there's probably a way to use a rounding function for that as well); otherwise just return the input. That should calculate pretty much instantly.</p>\n"}], "owner": {"reputation": 42, "user_id": 12121394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500abfc8a3a455f2cae868a37f16047?s=128&d=identicon&r=PG&f=1", "display_name": "Marat_Muginov", "link": "https://stackoverflow.com/users/12121394/marat-muginov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569453218, "creation_date": 1569442459, "question_id": 58105955, "link": "https://stackoverflow.com/questions/58105955/is-there-a-method-for-shortening-nested-if-then-else-statements", "title": "Is there a method for shortening nested If...Then...Else statements?", "body": "<p>I am attempting to create custom Excel functions to reduce menial mental tasks in my department. </p>\n\n<p>The function works but freezes up 32-bit Excel for over a minute. For reference, the average workload is >10,000 rows of inputs. </p>\n\n<pre><code>Function Function_Name(Input)\nIf Val(Input) = 0 Then\n    Function_Name = Input\n    ElseIf Val(Input) = 1 Then Function_Name = Input\n    ElseIf Val(Input) &gt;= 1110 And Val(Input) &lt;= 1999 Then Function_Name = \"1110\"\nElseIf Val(Input) &gt;= 3100 And Val(Input) &lt;= 3199 Then Function_Name = \"3100\"\n'Similar ElseIf statements go on for 40+ lines......'\nElseIf Val(Input) &gt;= 5700 And Val(Input) &lt;= 5799 Then Function_Name = \"5710\"\n'Note that they do not always return the lower limit of Val(Input), but sometimes may'\nEnd If\nEnd Function\n</code></pre>\n\n<p>The function provides accurate outputs, however takes long to process. I would like to know if there is a way to improve the back-end logic to reduce risk of Excel crashes and streamline processing.</p>\n"}, {"tags": ["excel", "vba", "rest"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1569445694, "post_id": 58105919, "comment_id": 102603822, "body": "It&#39;s not in the documentation for VBA-WEB, because reading a value from a cell is in the documentation of VBA for Excel ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1569442467, "creation_date": 1569442467, "answer_id": 58105957, "question_id": 58105919, "link": "https://stackoverflow.com/questions/58105919/use-vba-web-to-send-cell-value-as-body/58105957#58105957", "title": "Use VBA-Web to send cell value as body", "body": "<p>An example would be as follows:</p>\n\n<pre><code>Request.Body = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").value\n</code></pre>\n"}], "owner": {"reputation": 2097, "user_id": 2729481, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/daf7c8512fdec0bdd3c261e2d1105c62?s=128&d=identicon&r=PG&f=1", "display_name": "J.Zil", "link": "https://stackoverflow.com/users/2729481/j-zil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 58105957, "answer_count": 1, "score": 0, "last_activity_date": 1569442467, "creation_date": 1569442221, "question_id": 58105919, "link": "https://stackoverflow.com/questions/58105919/use-vba-web-to-send-cell-value-as-body", "title": "Use VBA-Web to send cell value as body", "body": "<p>I'm looking at VBA-Web, a useful script for using excel to make web requests. This is some POST code:</p>\n\n<pre><code>Dim Client As New WebClient\nClient.BaseUrl = \"https://api.testing.com/\"\n\nDim Request As New WebRequest\nRequest.Resource = \"pages\"\nRequest.Method = WebMethod.HttpPost\n\n' Formatting\n' ---------- '\n' Simple: Request.Format sets four things:\n'         1. Content-Type header\n'         2. Accept header\n'         3. Request Body conversion\n'         4. Response Data conversion\nRequest.Format = WebFormat.Json\n\n' Medium: Set separate request and response format\nRequest.RequestFormat = WebFormat.Json ' Set Content-Type and request converter\nRequest.ResponseFormat = WebFormat.Json ' Set Accept and response converter\n\n' Advanced: Set separate everything\nRequest.RequestFormat = WebFormat.Json\nRequest.ContentType = \"application/json\"\nRequest.ResponseFormat = WebFormat.Json\nRequest.Accept = \"application/json\"\n\n' Body\n' ---- '\n' a. Add body as string\nRequest.Body = \"{\"\"a\"\":123,\"\"b\"\":[456, 789]}\"\n\n' b. Add parameters (converted with RequestFormat)\nRequest.AddBodyParameter \"a\", 123\nRequest.AddBodyParameter \"b\", Array(456, 789)\n' -&gt; Request.Body (for json): \"{\"\"a\"\":123,\"\"b\"\":[456, 789]}\"\n\n' c. Add body as dictionary (or Collection or Array)\nDim Body As New Dictionary\nBody.Add \"a\", 123\nBody.Add \"b\", Array(456, 789)\nSet Request.Body = Body\n' -&gt; Request.Body (for json): \"{\"\"a\"\":123,\"\"b\"\":[456, 789]}\"\n\n' Add other things common to all Requests\nRequest.AddCookie \"cookie\", \"abc\"\nRequest.AddHeader \"header\", \"def\"\nRequest.AddQuerystringParam \"querystring\", \"ghi\"\n' etc.\n\n' To debug the request:\n' 1. From VBA, Open Immediate Window (View &gt; Immediate Window or Ctrl + g)\n' 2. Type: RestHelpers.EnableLogging = True\n' 3. Run request\n\n' Make the request\nDim Response As WebResponse\nSet Response = Client.Execute(Request)\n\n' POST https://api.testing.com/pages?querystring=ghi\n' header: def\n' User-Agent: Excel Client v3.1.4 (https://github.com/timhall/Excel-REST)\n' Content-Type: application/json\n' Accept: application/json\n' Content-Length: 23\n' Cookie: cookie=abc\n'\n' {\"a\":123,\"b\":[456,789]}\n\n' Handle the response\nIf Response.StatusCode = WebStatusCode.Created Then\n    ' ...\nEnd If\n</code></pre>\n\n<p>However I cant see anywhere in the documentation how I would take the value from a cell for example cell A1 and B1 and send this as JSON. </p>\n\n<p>It seems like it's possible but it seems to only hard code the body values. </p>\n"}, {"tags": ["excel", "vba", "date-comparison"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569442251, "post_id": 58105902, "comment_id": 102602588, "body": "Are those actual dates or text that looks like dates? Are they left-aligned? What is in <code>Range(&quot;A1&quot;)</code> on each sheet?"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1569477043, "post_id": 58105902, "comment_id": 102610584, "body": "It is difficult to see what is happening or wrong without a sample of the input. Just a simple view to the code, the issue is that if you have a duplicated date, then, you will get duplicated results. In the cells when you have &quot;NO MATCH&quot; on column H, you have text on column I. It seems to be an unexpected result. Could you upload a sample of the input?"}, {"owner": {"reputation": 1, "user_id": 12121233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55afd2288027b68d1d2105261a14b8c?s=128&d=identicon&r=PG&f=1", "display_name": "AirstarDispatch", "link": "https://stackoverflow.com/users/12121233/airstardispatch"}, "edited": false, "score": 0, "creation_date": 1569512903, "post_id": 58105902, "comment_id": 102629648, "body": "BigBen, these are formatted dates in all cases.  Yes, they are left justified. A1 on each sheet as a header followed by dates."}, {"owner": {"reputation": 1, "user_id": 12121233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55afd2288027b68d1d2105261a14b8c?s=128&d=identicon&r=PG&f=1", "display_name": "AirstarDispatch", "link": "https://stackoverflow.com/users/12121233/airstardispatch"}, "edited": false, "score": 0, "creation_date": 1569513087, "post_id": 58105902, "comment_id": 102629745, "body": "David, Yes, I&#39;ll edit my post to add Sheet2."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12121233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55afd2288027b68d1d2105261a14b8c?s=128&d=identicon&r=PG&f=1", "display_name": "AirstarDispatch", "link": "https://stackoverflow.com/users/12121233/airstardispatch"}, "edited": false, "score": 0, "creation_date": 1569515360, "post_id": 58111582, "comment_id": 102630826, "body": "Profoundly, thanks for the insight into tidying up my code. Your right, since a customer can have more than one job during a month, or over the year using the last name will not always return a unique match.  However, each customer has only one job per day. Recommendations made for that job are usually done in the following days or weeks, but rarely on the same day as in the case of Moss. This is why I wanted to add a macro for date comparison. Job 13877 dated 1/24/2019 could not have been completed on 12/18/2019. I thought if I added a macro such that"}, {"owner": {"reputation": 1, "user_id": 12121233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55afd2288027b68d1d2105261a14b8c?s=128&d=identicon&r=PG&f=1", "display_name": "AirstarDispatch", "link": "https://stackoverflow.com/users/12121233/airstardispatch"}, "edited": false, "score": 0, "creation_date": 1569526429, "post_id": 58111582, "comment_id": 102635780, "body": "If the date on Sheet1 Col A was &lt; than the date on Sheet2 Col A then run the match macro. Do you think that will solve this issue of duplicates?"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "reply_to_user": {"reputation": 1, "user_id": 12121233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55afd2288027b68d1d2105261a14b8c?s=128&d=identicon&r=PG&f=1", "display_name": "AirstarDispatch", "link": "https://stackoverflow.com/users/12121233/airstardispatch"}, "edited": false, "score": 0, "creation_date": 1569547785, "post_id": 58111582, "comment_id": 102641083, "body": "@airstatdipatch It will help but I do not know if it will be the solution that brings 100% accuracy.  I would still try qualifying against more fields.  The effort is trivial, the performance decrease if negligible, the assurance that you are not relying on a single point if failure will let you sleep better at night.  You&#39;ll also be better looking, make more money, and people will like you more."}], "tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 0, "last_activity_date": 1569492543, "last_edit_date": 1569492543, "creation_date": 1569482729, "answer_id": 58111582, "question_id": 58105902, "link": "https://stackoverflow.com/questions/58105902/compare-dates-then-match-columns/58111582#58111582", "title": "Compare dates then match columns", "body": "<p><strong>These two lines do the same thing</strong></p>\n\n<pre><code>Dim i, total, fRow As Integer \n\nDim i As Variant, total As Variant, fRow As Integer\n</code></pre>\n\n<ul>\n<li><p>To <code>Dim</code> as <code>Integer</code></p>\n\n<p><code>Dim i As Integer, total As Integer, fRow As Integer</code></p></li>\n</ul>\n\n<hr>\n\n<p><strong>This looks like it always evaluate to \"1\" unless<code>Column A</code> has empty cells, so how is your <code>For</code> loop functional</strong></p>\n\n<pre><code>`total = Worksheets(1).Range(\"A\" &amp; Rows.Count).End(xlUp).Row`\n</code></pre>\n\n<hr>\n\n<p><strong><code>Find</code> is only returning the first match</strong></p>\n\n<pre><code>`Set found = Worksheets(2).Columns(\"C:C\").Find(what:=answer1)`\n</code></pre>\n\n<ul>\n<li><p>It doesn't look like you are searching for unique values.  Your sample data has \"Last Name\" in <code>Column C</code> and \"Moss\" appears at different times in <code>Shhet1</code>, but your <code>Find</code> function will only return the first occurrence of \"Moss\" in <code>Sheet2</code>.  This means the first \"Moss\" in<code>Sheet2</code> will be written for every \"Moss\" in <code>Sheet1</code>.  So your getting false positives and bad matches.  This is evident in your output, you didn't provide a sample of  <code>Sheet2</code> but I know the first occurrence of \"Moss\" is \"Job Number 13774\" on \"12/18/2018\"  because it is written multiple times in <code>Sheet1</code>. To solve this, use <code>Find</code> with unique values or find every match and compare the the dates, job numbers, etc until you get the correct one.</p></li>\n<li><p>You have been qualifying your ranges to the worksheet level but <code>Rows.Count</code> is not qualified.</p></li>\n</ul>\n\n<hr>\n\n<p><strong>This block can be shortened to one line</strong></p>\n\n<pre><code>`Worksheets(1).Range(\"I\" &amp; i).Value = Worksheets(2).Range(\"A\" &amp; fRow).Value`\n`Worksheets(1).Range(\"J\" &amp; i).Value = Worksheets(2).Range(\"B\" &amp; fRow).Value`\n`Worksheets(1).Range(\"K\" &amp; i).Value = Worksheets(2).Range(\"C\" &amp; fRow).Value`\n`Worksheets(1).Range(\"L\" &amp; i).Value = Worksheets(2).Range(\"D\" &amp; fRow).Value`\n`Worksheets(1).Range(\"M\" &amp; i).Value = Worksheets(2).Range(\"E\" &amp; fRow).Value`\n`Worksheets(1).Range(\"N\" &amp; i).Value = Worksheets(2).Range(\"F\" &amp; fRow).Value`\n`Worksheets(1).Range(\"O\" &amp; i).Value = Worksheets(2).Range(\"G\" &amp; fRow).Value`\n</code></pre>\n\n<p><code>Worksheets(1).Range(\"I\" &amp; i  \":O\" &amp; i) = Worksheets(2).Range(\"A\" &amp; fRow &amp; \":G\" &amp; fRow)</code></p>\n"}], "owner": {"reputation": 1, "user_id": 12121233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55afd2288027b68d1d2105261a14b8c?s=128&d=identicon&r=PG&f=1", "display_name": "AirstarDispatch", "link": "https://stackoverflow.com/users/12121233/airstardispatch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581607906, "creation_date": 1569442133, "last_edit_date": 1581607906, "question_id": 58105902, "link": "https://stackoverflow.com/questions/58105902/compare-dates-then-match-columns", "title": "Compare dates then match columns", "body": "<p>Sheet1 accumulates jobs with recommendations throughout the year.</p>\n\n<p>Sheet2 accumulates completed recommendations.</p>\n\n<p>Any row on Sheet1 without a match needs to be followed up. Duplications are appearing as highlighted on row 14. Since the job on row 14 took place on 1/24/19, the recommendation could not have been completed prior to that date.</p>\n\n<p>Here is the code I'm using to MatchColums;</p>\n\n<pre><code>Sub MatchColums()\n\nDim i, total, fRow As Integer\nDim found As Range\n\ntotal = Worksheets(1).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 1 To total\n    answer1 = Worksheets(1).Range(\"C\" &amp; i).Value\n    Set found = Worksheets(2).Columns(\"C:C\").Find(what:=answer1) 'finds a match\n\n    If found Is Nothing Then\n        Worksheets(1).Range(\"H\" &amp; i).Value = \"NO MATCH\"\n    Else\n        fRow = Sheets(2).Columns(\"C:C\").Find(what:=answer1).Row\n        Worksheets(1).Range(\"I\" &amp; i).Value = Worksheets(2).Range(\"A\" &amp; fRow).Value\n        Worksheets(1).Range(\"J\" &amp; i).Value = Worksheets(2).Range(\"B\" &amp; fRow).Value\n        Worksheets(1).Range(\"K\" &amp; i).Value = Worksheets(2).Range(\"C\" &amp; fRow).Value\n        Worksheets(1).Range(\"L\" &amp; i).Value = Worksheets(2).Range(\"D\" &amp; fRow).Value\n        Worksheets(1).Range(\"M\" &amp; i).Value = Worksheets(2).Range(\"E\" &amp; fRow).Value\n        Worksheets(1).Range(\"N\" &amp; i).Value = Worksheets(2).Range(\"F\" &amp; fRow).Value\n        Worksheets(1).Range(\"O\" &amp; i).Value = Worksheets(2).Range(\"G\" &amp; fRow).Value\n\n     End If\n Next i\n\nEnd Sub\n</code></pre>\n\n<p>I added the following code to prevent duplications;</p>\n\n<pre><code>Sub CompareDates()\n\nIf Sheet1.Range(\"A1\") &lt; Sheet2.Range(\"A1\") Then\n    Run \"MatchColums\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I'm not getting any error message, but it seems that my CompareDates macro is not working. I tried running the matchcolums macro first, but again I have the same result as follows;</p>\n\n<p><a href=\"https://i.stack.imgur.com/EysyJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EysyJ.png\" alt=\"enter image description here\"></a> </p>\n\n<p>Here is a copy of Sheet2<br>\n<a href=\"https://i.stack.imgur.com/AoWxh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AoWxh.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-access", "webbrowser-control", "ms-access-2016"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1569442313, "post_id": 58105889, "comment_id": 102602613, "body": "Not an answer to your exact request but you can automate chrome with selenium basic."}, {"owner": {"reputation": 380, "user_id": 11104095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc0018af5fc00eb65eaae5dcf4473e6?s=128&d=identicon&r=PG&f=1", "display_name": "K753", "link": "https://stackoverflow.com/users/11104095/k753"}, "edited": false, "score": 1, "creation_date": 1569445284, "post_id": 58105889, "comment_id": 102603691, "body": "I think the Web Browser Control is built around IE so it may not be possible or take significant code. Another option is to just open the actual Chrome browser using something like this:  Shell (&quot;C:\\Program Files (x86)\\Google\\Chrome\\Application\\Chrome.exe -url <a href=\"https://yourwebpage.com\" rel=\"nofollow noreferrer\">yourwebpage.com</a>"}, {"owner": {"reputation": 628, "user_id": 4679332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-6A3_vIZehYw/AAAAAAAAAAI/AAAAAAAACI0/ExTSSO1w_l4/photo.jpg?sz=128", "display_name": "Christopher Warrington", "link": "https://stackoverflow.com/users/4679332/christopher-warrington"}, "reply_to_user": {"reputation": 380, "user_id": 11104095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc0018af5fc00eb65eaae5dcf4473e6?s=128&d=identicon&r=PG&f=1", "display_name": "K753", "link": "https://stackoverflow.com/users/11104095/k753"}, "edited": false, "score": 0, "creation_date": 1569447902, "post_id": 58105889, "comment_id": 102604500, "body": "@K753 Thank you for that idea. I do have that code in there for opening up a webpage, there is just some forms that pull in client data and it updates the Control with the client in our CRM2011. It allows me to work side by side. Now that we are going to CRM Dynamics 365, that can only work in Chrome. .... I may just need to cut the tie and change my forms."}, {"owner": {"reputation": 628, "user_id": 4679332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-6A3_vIZehYw/AAAAAAAAAAI/AAAAAAAACI0/ExTSSO1w_l4/photo.jpg?sz=128", "display_name": "Christopher Warrington", "link": "https://stackoverflow.com/users/4679332/christopher-warrington"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1569448094, "post_id": 58105889, "comment_id": 102604546, "body": "@QHarr, Thank you for that, but it would not help in my situation. I appreciate you letting me know though."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1569486493, "post_id": 58105889, "comment_id": 102614882, "body": "QHarr is right. The integrated browser control always uses IE. However, you can find/implement ActiveX controls for other browsers, but this is nontrivial. Also note that the integrated browser control runs in IE 7 compatibility mode by default. Switching that to IE 10/IE 11 often improves the experience a lot already."}, {"owner": {"reputation": 126, "user_id": 9335838, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O7emd.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9335838/mike"}, "edited": false, "score": 0, "creation_date": 1573064518, "post_id": 58105889, "comment_id": 103762806, "body": "I&#39;ve automated Chrome and (older versions of) Firefox from Access, via Selenium, as described in this article.    <a href=\"https://www.makeuseof.com/tag/how-to-automate-firefox-or-chrome-with-vba-and-selenium/\" rel=\"nofollow noreferrer\">makeuseof.com/tag/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1856, "user_id": 6607497, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f0a0b03f5bbd44186399f4b0aea38049?s=128&d=identicon&r=PG&f=1", "display_name": "U. Windl", "link": "https://stackoverflow.com/users/6607497/u-windl"}, "edited": false, "score": 2, "creation_date": 1604478405, "post_id": 64675846, "comment_id": 114356467, "body": "Please try to write answers, not stories. Meaning: Try to concentrate on the essence of the solution. And do format paragraphs (by adding empty lines in between)."}], "tags": [], "owner": {"reputation": 1, "user_id": 8946426, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tobxRoDlYFw/AAAAAAAAAAI/AAAAAAAAABQ/-QrOo0B0Cgw/photo.jpg?sz=128", "display_name": "Bob Massey", "link": "https://stackoverflow.com/users/8946426/bob-massey"}, "is_accepted": false, "score": 0, "last_activity_date": 1604475424, "creation_date": 1604475424, "answer_id": 64675846, "question_id": 58105889, "link": "https://stackoverflow.com/questions/58105889/changing-which-browser-ms-access-web-browser-control-uses-from-ie-to-chrome/64675846#64675846", "title": "Changing which browser MS Access Web Browser Control uses from IE to Chrome", "body": "<p>I THINK I have THE answer. I put together an MS Access form containing the web browser control -- in 2009 or 2010. It worked great! I cycled GPS address selection using Google Maps processor. IE with Compatibility Control &quot;LET&quot; Chrome-Maps do it's thing.\nBUT THEN ... Windows 10 brings &quot;improved&quot; MS Windows Internet. I had little demand for 4 years -- UNTIL NOW!\nEnough already!!!  Windows10 Settings - Default Internet Browser .. CHANGE to CHROME -- TA-DA!  I did a full reboot of my computer -- just to make sure. Without any OTHER code changes, my MS Access form WITH WebBrowserControl - once again - works perfectly as it did when it last worked correctly for me.\nI really did NOT want to switch away from Edge being default browser. But BING Maps does not allow me to implement my needed Mapping activity. Please be careful to examine as many of your possible consequences as you can.</p>\n"}], "owner": {"reputation": 628, "user_id": 4679332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-6A3_vIZehYw/AAAAAAAAAAI/AAAAAAAACI0/ExTSSO1w_l4/photo.jpg?sz=128", "display_name": "Christopher Warrington", "link": "https://stackoverflow.com/users/4679332/christopher-warrington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1429, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1604475424, "creation_date": 1569442082, "last_edit_date": 1594449080, "question_id": 58105889, "link": "https://stackoverflow.com/questions/58105889/changing-which-browser-ms-access-web-browser-control-uses-from-ie-to-chrome", "title": "Changing which browser MS Access Web Browser Control uses from IE to Chrome", "body": "<p>I have an MS Access database application that uses the Web Browser Control on a few different forms. My company is switching a few systems that can only be accessed with Chrome and do not work in IE. Is there a way, using VBA or other method, to change the browser application that MS Access uses to display the webpage on a form?</p>\n"}, {"tags": ["vba", "internet-explorer", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1569456801, "creation_date": 1569456801, "answer_id": 58107981, "question_id": 58105857, "link": "https://stackoverflow.com/questions/58105857/how-to-control-new-pop-up-tab-from-vba/58107981#58107981", "title": "How to control new pop up tab from VBA", "body": "<p>To close an existing tab:</p>\n\n<pre><code>Sub TestClose()\n\n    Dim ie As Object\n\n    Set ie = GetIEByTitle(\"K1000 Service Center\")\n    If Not ie Is Nothing Then\n        ie.Quit\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Function to find an open IE tab based on the document title:</p>\n\n<pre><code>Function GetIEByTitle(sTitle As String) As Object\n    Dim o As Object, rv As Object\n    For Each o In CreateObject(\"Shell.Application\").Windows\n        If TypeName(o) = \"IWebBrowser2\" Then\n            If o.document.Title Like \"*\" &amp; sTitle &amp; \"*\" Then\n                Set rv = o\n                Exit For\n            End If\n        End If\n    Next o\n    Set GetIEByTitle = rv\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 11877464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a09c8ba1089745db5bbd4de9544af051?s=128&d=identicon&r=PG&f=1", "display_name": "Zakiirim", "link": "https://stackoverflow.com/users/11877464/zakiirim"}, "edited": false, "score": 0, "creation_date": 1569602631, "post_id": 58113770, "comment_id": 102663513, "body": "The code seems really clear. I will definitely try and let you know!"}, {"owner": {"reputation": 81, "user_id": 11877464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a09c8ba1089745db5bbd4de9544af051?s=128&d=identicon&r=PG&f=1", "display_name": "Zakiirim", "link": "https://stackoverflow.com/users/11877464/zakiirim"}, "edited": false, "score": 0, "creation_date": 1569794237, "post_id": 58113770, "comment_id": 102701298, "body": "It works! Thank you. Is there a way to switch the focus on the tab i found by name? I tried AppActivate but it works only with active tabs."}, {"owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "reply_to_user": {"reputation": 81, "user_id": 11877464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a09c8ba1089745db5bbd4de9544af051?s=128&d=identicon&r=PG&f=1", "display_name": "Zakiirim", "link": "https://stackoverflow.com/users/11877464/zakiirim"}, "edited": false, "score": 0, "creation_date": 1569807702, "post_id": 58113770, "comment_id": 102703355, "body": "I also found this issue (want to switch to the special tab), but not found a good ways to do that. I will research about that, If I get any solution or a work around then I will try to provide you in the future. Thanks for your understanding."}, {"owner": {"reputation": 81, "user_id": 11877464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a09c8ba1089745db5bbd4de9544af051?s=128&d=identicon&r=PG&f=1", "display_name": "Zakiirim", "link": "https://stackoverflow.com/users/11877464/zakiirim"}, "edited": false, "score": 0, "creation_date": 1569949996, "post_id": 58113770, "comment_id": 102758587, "body": "Hi there. Just the last question regarding the same topic. If two tabs have the same title, teoretically I should use the location to set mine. But is there a way that if my_title  = &quot;amazon&quot;, it ignores the first match and looks for a second?"}], "tags": [], "owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "is_accepted": true, "score": 1, "last_activity_date": 1569490458, "creation_date": 1569490458, "answer_id": 58113770, "question_id": 58105857, "link": "https://stackoverflow.com/questions/58105857/how-to-control-new-pop-up-tab-from-vba/58113770#58113770", "title": "How to control new pop up tab from VBA", "body": "<p>You could use the the Shell Windows to loop through the IE Tabs, then find the special tab based on the title. More detail information, please check the following code:</p>\n\n<pre><code>Sub TestClose()\n    Dim IE As Object, Data As Object\n    Dim ticket As String\n    Dim my_url As String, my_title As String\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    With IE\n        .Visible = True\n        .Navigate \"https://amazon.com\" '1st tab\n        .Navigate \"https://flipkart.com\", CLng(2048) '2nd\n        .Navigate \"https://snapdeal.com\", CLng(2048) '3rd\n\n        While IE.ReadyState &lt;&gt; 4\n            DoEvents\n        Wend\n\n        'wait some time to let page load\n        Application.Wait (Now + TimeValue(\"0:00:05\"))\n\n        Set objShell = CreateObject(\"Shell.Application\")\n        IE_count = objShell.Windows.Count\n\n        'loop through the window and find the tab\n        For x = 0 To (IE_count - 1)\n            On Error Resume Next\n            'get the location and title\n            my_url = objShell.Windows(x).Document.Location\n            my_title = objShell.Windows(x).Document.Title\n\n            'debug to check the value\n            Debug.Print x\n            Debug.Print my_title\n\n            'find the special tab based on the title.\n            If my_title Like \"Amazon\" &amp; \"*\" Then\n                Set IE = objShell.Windows(x)\n                IE.Quit 'call the Quit method to close the tab.\n                Exit For   'exit the for loop \n            Else\n            End If\n        Next\n\n    End With\n    Set IE = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 11877464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a09c8ba1089745db5bbd4de9544af051?s=128&d=identicon&r=PG&f=1", "display_name": "Zakiirim", "link": "https://stackoverflow.com/users/11877464/zakiirim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 58113770, "answer_count": 2, "score": 0, "last_activity_date": 1569490458, "creation_date": 1569441919, "question_id": 58105857, "link": "https://stackoverflow.com/questions/58105857/how-to-control-new-pop-up-tab-from-vba", "title": "How to control new pop up tab from VBA", "body": "<p>i wrote a code that is automatically downloading some documentation if some criterias are met and I just have one problem.. After clicking on a link a new IE tab is opened (child tab) and i would like to close it after some actions. The new tab has always the same title (for example \"online.xxx\") so maybe there is a way to control it.</p>\n\n<p>My parent tab is setted like this:</p>\n\n<pre><code>Dim IE as New ShDocVw.InternetExplorerMedium\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["sql", "excel", "vba", "ms-access", "where-clause"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1569443128, "post_id": 58105845, "comment_id": 102602945, "body": "What is contained in <i>items(u, 1)</i>? Please show. You also <i>tell</i> us criteria is not met but do not <i>show</i> us any data. What actually happens? No results are returned?"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1569445390, "post_id": 58105845, "comment_id": 102603730, "body": "Hi. In the db your field is text or numerical?"}, {"owner": {"reputation": 1, "user_id": 10073721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HNNwX.jpg?s=128&g=1", "display_name": "GhostEcho", "link": "https://stackoverflow.com/users/10073721/ghostecho"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1569447634, "post_id": 58105845, "comment_id": 102604418, "body": "@Parfait I&#39;ve updated my question with the question you&#39;ve requested."}, {"owner": {"reputation": 1, "user_id": 10073721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HNNwX.jpg?s=128&g=1", "display_name": "GhostEcho", "link": "https://stackoverflow.com/users/10073721/ghostecho"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1569447657, "post_id": 58105845, "comment_id": 102604427, "body": "@LuisCurado I&#39;ve updated my post with the answer."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1569451637, "post_id": 58105845, "comment_id": 102605418, "body": "Why do you need Left()? Data in table is not exactly same as from Excel? Could try opposite, make sure number is read as string: <code>CStr(Item)</code>. Really shouldn&#39;t be necessary if field is text type, but try it anyway."}, {"owner": {"reputation": 1, "user_id": 10073721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HNNwX.jpg?s=128&g=1", "display_name": "GhostEcho", "link": "https://stackoverflow.com/users/10073721/ghostecho"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1569452979, "post_id": 58105845, "comment_id": 102605652, "body": "@June7 <code>Left()</code> is so that the user can enter partial SKU&#39;s and still return results, which is useful for items with multiple colors, since only the suffix differs between them.  I actually had <code>CStr(Item)</code> initially but removed it after having researched that it wasn&#39;t necessary; it gave me the same results."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10073721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HNNwX.jpg?s=128&g=1", "display_name": "GhostEcho", "link": "https://stackoverflow.com/users/10073721/ghostecho"}, "is_accepted": false, "score": 0, "last_activity_date": 1569452687, "creation_date": 1569452687, "answer_id": 58107603, "question_id": 58105845, "link": "https://stackoverflow.com/questions/58105845/why-does-my-sql-statement-not-find-a-match-with-the-where-statement-below/58107603#58107603", "title": "Why does my SQL statement not find a match with the WHERE statement below?", "body": "<p>Thank you all for your responses to this, it turns out I was completely hunting for the wrong problem.  The code I posted was actually correct, the issue was with the format of <code>Inv_Date</code> field in the DB.  I had mistakenly entered the last couple of months as text instead of date, so the <code>WHERE Inv_Date BETWEEN #\" &amp; Sdate &amp; \"# AND #\" &amp; Edate &amp; \"#</code> portion of my SQL didn't match anything.</p>\n\n<p>I hadn't identified that this was the issue earlier due to the timing of the sales of the SKU's themselves, which was purely coincidence.  When I expanded the dates range, I found that it did return results for the numerical SKU, but both numerical and text SKU's cut off two months ago.</p>\n\n<p>Thank you again!</p>\n"}], "owner": {"reputation": 1, "user_id": 10073721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HNNwX.jpg?s=128&g=1", "display_name": "GhostEcho", "link": "https://stackoverflow.com/users/10073721/ghostecho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569452687, "creation_date": 1569441866, "last_edit_date": 1569451069, "question_id": 58105845, "link": "https://stackoverflow.com/questions/58105845/why-does-my-sql-statement-not-find-a-match-with-the-where-statement-below", "title": "Why does my SQL statement not find a match with the WHERE statement below?", "body": "<p>I'm attempting to pull data from my MS Access database via an Excel SQL statement.  It does NOT give me any errors, however it also does not pull the data I'm searching for.</p>\n\n<p>If <code>items(u, 1)</code> is text (ex. 308-203BL), then it works perfectly.</p>\n\n<p>I've tried both comparing them as text and as numerical, but neither way find any matches when <code>items(u, 1)</code> is 19310.  </p>\n\n<p>This compares it as text...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>LEFT(Item,\" &amp; Len(items(u, 1)) &amp; \") = '\" &amp; items(u, 1) &amp; \"'\"\n</code></pre>\n\n<p>this compares it as numerical...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>VAL(LEFT(Item,\" &amp; Len(items(u, 1))) &amp; \") = \" &amp; items(u, 1)\n</code></pre>\n\n<p>I have verified that there are records in the DB that match the given criteria.</p>\n\n<p><code>items()</code> is an array populated from a 1 column table on the sheet by <code>items = Range(\"Items\").Value</code><img src=\"https://i.stack.imgur.com/M2gDm.png\" alt=\"Table Snip\">.<br>\nUsing these two SKU's as examples, the first working, the second not, the array would be as follows.  <img src=\"https://i.stack.imgur.com/Yh3qn.png\" alt=\"Pic of populated array\">.<br>\nSKU by SKU, they're fed into the SQL as below.  </p>\n\n<p>With the input in the example, the output I receive is an array populated only the sales for the second item.  The order I put the SKU's in the table doesn't change that result. I have tested it with multiple SKU's, and no matter how many I use, it returns the proper information, with the exception of not returning any results for any numerical SKU's.</p>\n\n<p>The field for <code>Item</code> in the DB is a short text, which is why I used <code>'\" &amp; items(u, 1) &amp; \"'\"</code> to convert the SKU to text when I was trying to match it as text, and <code>Val()</code> to convert the field to a value when trying to match it as a number.  Both gave me 0 record counts in the function, but did not give me a data type error.</p>\n\n<p>Below is the portion of my code which determines the SQL string, and a bit afterwords which basically stuffs it into a UDF which pulls the info from the DB and puts it into an array for me.  Aside from not finding a match when <code>items(u,1)</code> is numerical, it works perfectly.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DBString = \"SELECT Invoice, Line, Inv_Date, Sales_Order, SOLine, SO_Date, CustID, Item, Part_Description, Ship_Qty, Price, Ext_Sales FROM `\" &amp; Year(tabledate) &amp; \"-\" &amp; Format(tabledate, \"mm\") &amp; \"` WHERE Inv_Date BETWEEN #\" &amp; Sdate &amp; \"# AND #\" &amp; Edate &amp; \"# AND LEFT(Item,\" &amp; Len(items(u, 1)) &amp; \") = '\" &amp; items(u, 1) &amp; \"'\"\nSalesHolder = PullFromDB(DBString, SGMDB)\n</code></pre>\n\n<p>I've also tried the below code instead, to force it to compare as a number instead of text, which also doesn't give me any errors, but doesn't find a match.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DBString = \"SELECT Invoice, Line, Inv_Date, Sales_Order, SOLine, SO_Date, CustID, Item, Part_Description, Ship_Qty, Price, Ext_Sales FROM `\" &amp; Year(tabledate) &amp; \"-\" &amp; Format(tabledate, \"mm\") &amp; \"` WHERE Inv_Date BETWEEN #\" &amp; Sdate &amp; \"# AND #\" &amp; Edate &amp; \"# AND VAL(LEFT(Item,\" &amp; Len(items(u, 1))) &amp; \") = \" &amp; items(u, 1)\nSalesHolder = PullFromDB(DBString, SGMDB)\n</code></pre>\n\n<p>Below is the UDF itself which pulls the info from the DB. It works quite nicely.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function PullFromDB(DBStr As String, DBLoc As String) As Variant\n    Dim TheDB As Recordset, DBHolder() As Variant\n\n    Set TheDB = OpenDatabase(DBLoc).OpenRecordset(DBStr)\n    If TheDB.RecordCount = 0 Then GoTo theexit\n\n    TheDB.MoveLast\n    TheDB.MoveFirst\n\n    ReDim DBHolder(0 To TheDB.RecordCount, 1 To TheDB.Fields.Count) As Variant\n\n    For k = 1 To UBound(DBHolder, 2)\n        TheDB.MoveFirst\n        For j = 0 To UBound(DBHolder)\n            If j = 0 Then\n                DBHolder(j, k) = TheDB.Fields(k - 1).Name\n            Else\n                DBHolder(j, k) = TheDB.Fields(k - 1).Value\n                TheDB.MoveNext\n            End If\n         Next j\n    Next k\n\ntheexit:\n    TheDB.Close\n    Set TheDB = Nothing\n    PullFromDB = DBHolder\n\nOn Error GoTo -1\nEnd Function\n</code></pre>\n\n<p>The expected result is to populate the array SalesHolder with the information that matches the criteria.  </p>\n\n<p>What am I missing?  I'm going blind trying to find it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1569441880, "post_id": 58105819, "comment_id": 102602444, "body": "Can you explain how you, the human, would identify the lastrow for the <code>LastRow3</code> variable? (End of the old data, I assume)."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1569442243, "post_id": 58105819, "comment_id": 102602586, "body": "Can we assume that column C is empty for the new data?"}, {"owner": {"reputation": 21, "user_id": 7107865, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jPXnXX3xgrE/AAAAAAAAAAI/AAAAAAAAGBs/ETJ5RZTQwKM/photo.jpg?sz=128", "display_name": "Hannah Whitehead", "link": "https://stackoverflow.com/users/7107865/hannah-whitehead"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1569442413, "post_id": 58105819, "comment_id": 102602662, "body": "@JNevill Yes, the end of the old data. I forgot to include it because it is actually defined above this section of the macro."}, {"owner": {"reputation": 21, "user_id": 7107865, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jPXnXX3xgrE/AAAAAAAAAAI/AAAAAAAAGBs/ETJ5RZTQwKM/photo.jpg?sz=128", "display_name": "Hannah Whitehead", "link": "https://stackoverflow.com/users/7107865/hannah-whitehead"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1569442441, "post_id": 58105819, "comment_id": 102602676, "body": "Yes @ScottCraner Column C is empty for the new data"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1569442443, "post_id": 58105819, "comment_id": 102602678, "body": "<code>Range(&quot;C&quot; &amp; LastRow3 &amp; &quot;:C&quot; &amp; RR).Value = &quot;August&quot;</code>"}, {"owner": {"reputation": 21, "user_id": 7107865, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jPXnXX3xgrE/AAAAAAAAAAI/AAAAAAAAGBs/ETJ5RZTQwKM/photo.jpg?sz=128", "display_name": "Hannah Whitehead", "link": "https://stackoverflow.com/users/7107865/hannah-whitehead"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1569442527, "post_id": 58105819, "comment_id": 102602714, "body": "Wow, I did a comma instead of &amp; :/ Thanks though! @ScottCraner"}], "owner": {"reputation": 21, "user_id": 7107865, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jPXnXX3xgrE/AAAAAAAAAAI/AAAAAAAAGBs/ETJ5RZTQwKM/photo.jpg?sz=128", "display_name": "Hannah Whitehead", "link": "https://stackoverflow.com/users/7107865/hannah-whitehead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1569490980, "creation_date": 1569441739, "last_edit_date": 1569490980, "question_id": 58105819, "link": "https://stackoverflow.com/questions/58105819/autofill-from-last-row-of-old-data-to-new-data", "title": "Autofill From Last Row of Old Data to New Data", "body": "<p>I have a set of data that I am copying and pasting each month, but I need to fill in a column that starts at the \"old\" data to the new pasted data. So, I have two different sets of <code>LastRow</code> values, but I'm not sure how to indicate the range for it to fill. </p>\n\n<pre><code> Dim RR As Long\n Dim LastRow3 as Long\n RR = Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n Range(\"C\" &amp; LastRow3, \":C\" &amp; RR).Value = \"August\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569442468, "post_id": 58105583, "comment_id": 102602689, "body": "Iterating an array is, worst-case, O(n) - i.e. you iterate <i>every</i> item to get the one you want. Contrast with a <code>Dictionary</code> keyed with the concatenation of a stock ticker and a date: retrieval is essentially a O(1) hash lookup, i.e. essentially free. And if the data lives in an actual database, having the server perform the filtering/querying and returning the one result row in a recordset could actually be even faster than anything else, assuming a decent network and proper indexes. TL;DR: way too many variables, there&#39;s no silver bullet. The only proper answer is <code>#ItDepends</code>."}, {"owner": {"reputation": 1, "user_id": 8026996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc76eb70d70ef77196c5f57deeda55ec?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Langford", "link": "https://stackoverflow.com/users/8026996/scott-langford"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569443249, "post_id": 58105583, "comment_id": 102602987, "body": "Thanks for the response. Just to clarify, I have index tables for the date, stock, and price type. For example, the code would retrieve the volume(5) for AAPL(15) on 9/19/2019(4994) with myData(15, 4994, 5). There is no iterating involved except for initially populating the array from all of the stock data files, which takes about 15 seconds. I&#39;m running monte carlo simulations that runs for up to several hours to days so the 15 second load time is nothing."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569455886, "post_id": 58105583, "comment_id": 102606153, "body": "If the array is working for you then it seems like a good solution, as long as the load time is offset by improved access speed.  It&#39;s not clear what type of &quot;recordset&quot; implementation you&#39;re comparing that to though."}, {"owner": {"reputation": 1, "user_id": 8026996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc76eb70d70ef77196c5f57deeda55ec?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Langford", "link": "https://stackoverflow.com/users/8026996/scott-langford"}, "edited": false, "score": 0, "creation_date": 1569514147, "post_id": 58105583, "comment_id": 102630228, "body": "The DAO recordset declaration available in VBA for Access. In this specific case it seemed to be slower since I had to use the .seek option to activate each record. I asked because I am lacking in the &quot;theory&quot; of various data retrieval techniques. My concern with the large array was that it would slow down overall performance because a large chunk of memory is dedicated to it. Sounds like I&#39;m fine based on the two responses. BTW - I know I could test this by running code both ways and I appreciate you helping me learn the theory without wasting days testing."}], "owner": {"reputation": 1, "user_id": 8026996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc76eb70d70ef77196c5f57deeda55ec?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Langford", "link": "https://stackoverflow.com/users/8026996/scott-langford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569509817, "creation_date": 1569440811, "last_edit_date": 1569509817, "question_id": 58105583, "link": "https://stackoverflow.com/questions/58105583/is-there-a-downside-to-huge-arrays-for-quick-data-retrieval", "title": "Is there a downside to huge arrays for quick data retrieval?", "body": "<p>I have a huge (I think) array of 5000 x 750 x 10. I use it to quickly retrieve data for a given stock on a given date. I've found recordsets take way longer since you have to \"seek\" each line before you can retrieve the data. Is there a downside to such a large array besides the initial populating time?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1569441172, "post_id": 58105558, "comment_id": 102602142, "body": "why not check the value of the cell for #N/A first?  excel.worksheetfunction.isna    <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.isna\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1569441526, "post_id": 58105558, "comment_id": 102602298, "body": "It is highly recommended to <b>not</b> use <code>On Error GoTo</code>. Instead, code for the possibility of <code>#N&#47;A</code> rather try to ignore it. In pseudo code, <code>IF NOT ISNA THEN....</code>"}, {"owner": {"reputation": 1, "user_id": 7089331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d87587fd0184635bd997d31fb0d3698b?s=128&d=identicon&r=PG&f=1", "display_name": "BFid", "link": "https://stackoverflow.com/users/7089331/bfid"}, "edited": false, "score": 0, "creation_date": 1569441928, "post_id": 58105558, "comment_id": 102602465, "body": "I guess I had complete brain lock. I will check for N/A as suggested.  It was difficult to understand why it worked before.  thanks."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569442020, "post_id": 58105558, "comment_id": 102602506, "body": "Do you have &quot;Break on all errors&quot; set (<i>Tools</i> &gt; <i>Options</i> &gt; <i>General</i>)? Thata would explain the current scenario."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569446346, "post_id": 58105558, "comment_id": 102604023, "body": "If your error is not triggering your error handler, it&#39;s possible you have set &quot;Break on all errors&quot; in your VBA options. <i>Tools &gt;&gt; Options &gt;&gt; general</i>"}], "owner": {"reputation": 1, "user_id": 7089331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d87587fd0184635bd997d31fb0d3698b?s=128&d=identicon&r=PG&f=1", "display_name": "BFid", "link": "https://stackoverflow.com/users/7089331/bfid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569483104, "creation_date": 1569440716, "last_edit_date": 1569483104, "question_id": 58105558, "link": "https://stackoverflow.com/questions/58105558/on-error-goto-not-being-called-on-type-mismatch", "title": "On Error Goto not being called on Type Mismatch", "body": "<p>I am reading a cell from a spreadsheet that should be a number but may or may not be <code>#N/A</code>.  In the past, if the cell value was <code>#N/A</code> I believe the On Error Goto routine would be invoked.</p>\n\n<p>Setting the cell value to zero will not work in this application.  If the cell formula returns <code>#N/A</code>, I need it to remain <code>#N/A</code> instead of making it zero.</p>\n\n<pre><code>Option Explicit\n    Dim Piecerate_Labor as Single\n    Dim ErrorList() as Variant\n    Dim UniqueID as String\n    Dim CurrentStyleError as Boolean\n    'Other code removed\n\nSub GetCostInfo()\n        On Error GoTo Errorhandler\n        'Other code removed\n        With Workbooks(\"Cost_Master.xlsm\").Worksheets(\"Cost\")\n            Piecerate_Labor = .Range(\"Piecerate_Labor_Cost\").Value\n            'Other code removed\n        End With\n    Exit Sub\n\n    Errorhandler:\n        ErrorCount = ErrorCount + 1\n        ErrorList(ErrorCount, 1) = UniqueID\n        'Other Coe Removed     Workbooks(\"Cost_Master.xlsm\").Worksheets(\"Cost\").Range(\"P565\").Value 'trap labor issue\n        CurrentStyleError = True\n\nEnd Sub\n</code></pre>\n\n<p>Code breaks on line <code>Piecerate_Labor =.Range(\"Piecerate_Labor_Cost\").Value</code> with Run Time Error \"13\": Type Mismatch Error because <code>Piecerate_Labor is Single</code> and the value of <code>.Range(\"Piecerate_Labor_Cost\")</code> is <code>#N/A</code>.  Before I believe it would invoke the On Error Goto Errorhandler.  Why will the type mismatch error not invoke the On Error Goto Errorhandler line?  It seems I am missing something pretty basic.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1569439986, "post_id": 58105188, "comment_id": 102601650, "body": "<code>TheSheet.ListObjects(oldName).Name = newName</code>?"}, {"owner": {"reputation": 1, "user_id": 12121104, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ae9wdJqOZbk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7MN2rwZ-dt2FT_HmBvKsBAaS2WQ/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/12121104/chase"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569440203, "post_id": 58105188, "comment_id": 102601716, "body": "How do I get it to recognize the (oldname)? I tried setting it as a variable but I couldn\u2019t get it to work. Any ideas? Let me clarify too. Because the new table changes names each time I do not know how to get it to retrieve the new table \u201coldname\u201d and change it to the \u201cnew name\u201d."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1569440285, "post_id": 58105188, "comment_id": 102601740, "body": "I don&#39;t understand your question. You have an <code>OldTable</code> object, the <code>oldName</code> is <code>OldTable.Name</code>."}, {"owner": {"reputation": 1, "user_id": 12121104, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ae9wdJqOZbk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7MN2rwZ-dt2FT_HmBvKsBAaS2WQ/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/12121104/chase"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569440693, "post_id": 58105188, "comment_id": 102601882, "body": "You are amazing. I didn\u2019t know to put the \u201c.name\u201d after oldtable. I\u2019m trying to learn and understand how via works still. You have just solved hours of frustration. I can\u2019t thank you enough. Thank you Mathieu Guindon."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1569441028, "post_id": 58105188, "comment_id": 102602078, "body": "Cheers! I manage the <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> open-source project, which analyzes VBA code and can teach you a number of tricks and warn about a number of beginner traps - check it out!"}], "owner": {"reputation": 1, "user_id": 12121104, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ae9wdJqOZbk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7MN2rwZ-dt2FT_HmBvKsBAaS2WQ/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/12121104/chase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1578823519, "creation_date": 1569439023, "last_edit_date": 1578823519, "question_id": 58105188, "link": "https://stackoverflow.com/questions/58105188/changing-name-of-table-which-is-a-copy-of-a-table", "title": "Changing name of table which is a copy of a table", "body": "<p>There are 138 tables on a sheet. </p>\n\n<p>I created a userform to insert a new account. I am trying to insert the new account by copying the table to the left and pasting it in numerical order. </p>\n\n<p>How do I change the name of the new table. All tables are named as \"Ledger_(Account Number)\". </p>\n\n<p>I can find the new table but I can't figure out how to change its name.</p>\n\n<pre><code>Sub AddtoLedger()\n\n' This is a test macro to find the correct place for the new account on the Ledger\n\nDim LedgerAccountCell As Long\n\nDim tbxAccountName As String\nDim cbxAccountType As String\nDim tbxAccountNumber As Long\n\nDim AccountName As String\nDim AccountType As String\nDim AccountNumber As Long\n\nDim NewAccountNumberCellLedger As String\nDim OldTable As ListObject\nDim OldTableName As String\n\nAccountName = CreateNewAccountForm.tbxAccountName.Value\nAccountType = CreateNewAccountForm.cbxAccountType.Value\nAccountNumber = 1002\n'''CreateNewAccountForm.tbxAccountNumber.Value\n\n'More Code Between here that loops through to find the correct numerical order 'to add the new account               \n\nDebug.Print ThisWorkbook.Worksheets(\"Ledger\").Cells(8, LedgerAccountCell + 9).ListObject.Name\n' This gives me the correct name of the new table \"Ledger_1001155\"\n' I am trying to change the name from Ledger_1001155 to Ledger 1002\n\n'This will change the name of the new table that was coppied to have the appropriate name\nSet OldTable = ThisWorkbook.Worksheets(\"Ledger\").Cells(8, LedgerAccountCell + 9).ListObject.DisplayName\n\nThisWorkbook.Worksheets(\"Ledger\").Cells(8, LedgerAccountCell `+ 9).ListObject.Add.Name = \"Ledger_\" &amp; AccountNumber\n\nThisWorkbook.Worksheets(\"Ledger\").ListObject.Name = \"Ledger_\" enter code here&amp; AccountNumber\n</code></pre>\n"}, {"tags": ["vba", "loops"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1569438374, "post_id": 58105002, "comment_id": 102601002, "body": "See <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba\">this question</a> for how to find the last row in that column. Then loop <code>For counter = 4 to lastRow</code> instead of your current <code>Do</code> loop."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1569438397, "post_id": 58105002, "comment_id": 102601017, "body": "Also see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid Select</a>."}], "owner": {"reputation": 1, "user_id": 12121127, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sY0giuu5S1Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc2lx1Bi2pqjDeZqotO_fd8M7DzLQ/photo.jpg?sz=128", "display_name": "tnewt20", "link": "https://stackoverflow.com/users/12121127/tnewt20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569438376, "creation_date": 1569438126, "last_edit_date": 1569438376, "question_id": 58105002, "link": "https://stackoverflow.com/questions/58105002/i-need-help-exiting-a-loop-when-a-cell-is-blank", "title": "I need help exiting a loop when a cell is blank", "body": "<p>Here is my current code. It loops fine and enters the data I need but it does not stop when I would like it to. I need it to stop when it the cell in column B is found to be blank.</p>\n\n<pre><code>Sub Insert_Tasks_Info()\n    '\n    ' Insert_Tasks_Info Macro\n    '\n\n    Dim counter As Integer\n    counter = 4\n\n    'runs macor until first empty cell in Column \"B\"\n\n    Do Until ThisWorkbook.Sheets(\"Data\").Cells(counter, 2).Value = \"\"\n\n        'copies order task info and pastes into data tab\n\n        Sheets(\"Template\").Select\n        Range(\"A4:G9\").Select\n        Selection.Copy\n        Sheets(\"Data\").Select\n        Range(\"A3\").Select\n        Selection.End(xlDown).Select\n        NextFree = Range(\"A3:A\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row\n        Range(\"A\" &amp; NextFree).Select\n        Selection.Insert Shift:=xlDown\n\n        'copies hours info and pastes into data tab\n\n        Sheets(\"Template\").Select\n        Range(\"F3:AA9\").Select\n        Application.CutCopyMode = False\n        Selection.Copy\n        Sheets(\"Data\").Select\n        Range(\"F2\").Select\n        Selection.End(xlDown).Select\n        NextFree = Range(\"F2:F\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row\n        Range(\"F\" &amp; NextFree).Select\n        ActiveSheet.Paste\n\n        Call Insert_Zone\n\n        counter = counter + 1\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 166, "user_id": 11348379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e157387f24dcebef764066025520d0?s=128&d=identicon&r=PG&f=1", "display_name": "SomeNerdAtWork", "link": "https://stackoverflow.com/users/11348379/somenerdatwork"}, "edited": false, "score": 0, "creation_date": 1569437843, "post_id": 58104710, "comment_id": 102600770, "body": "You have more ( than ) Also ROW(H6),))) - seems like just a loose comma"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1569438215, "post_id": 58104710, "comment_id": 102600925, "body": "You&#39;re mixing VBA (<code>Range</code> and <code>End</code> calls) and Worksheet formulas. That&#39;s the bigger problem."}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1569439398, "post_id": 58105215, "comment_id": 102601434, "body": "Looks like you&#39;ve resolved that final issue I wasn&#39;t figuring out with the <code>offset()</code>... will delete my work-in-progress of trying to figure out what was going on"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 9, "user_id": 12119004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31669530cb23549bd152b1f6c0326bd0?s=128&d=identicon&r=PG&f=1", "display_name": "OnTheHunt", "link": "https://stackoverflow.com/users/12119004/onthehunt"}, "edited": false, "score": 0, "creation_date": 1569440765, "post_id": 58105215, "comment_id": 102601917, "body": "@OnTheHunt if it worked please consider marking as correct by clicking the check mark by the answer."}, {"owner": {"reputation": 9, "user_id": 12119004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31669530cb23549bd152b1f6c0326bd0?s=128&d=identicon&r=PG&f=1", "display_name": "OnTheHunt", "link": "https://stackoverflow.com/users/12119004/onthehunt"}, "edited": false, "score": 0, "creation_date": 1569442884, "post_id": 58105215, "comment_id": 102602855, "body": "@ScottCraner However, the table filter isn&#39;t working. I want to apply the table filter"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1569443013, "post_id": 58105215, "comment_id": 102602908, "body": "you will  need to rerun the code manually or put the live formula in instead."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1569439138, "creation_date": 1569439138, "answer_id": 58105215, "question_id": 58104710, "link": "https://stackoverflow.com/questions/58104710/vba-code-to-evaluate-sumproduct-in-a-dynamic-table/58105215#58105215", "title": "VBA Code to Evaluate Sumproduct in a dynamic TABLE", "body": "<p>You want to pass the address of the range to the formula.  The formula is a string and one cannot pass a range object into a string, so we pass the address.</p>\n\n<p>Also we want to ensure the correct sheet on everything so we use the With block:</p>\n\n<pre><code>With Sheet1      \n    .Range(\"P7\").Value = .Evaluate(\"=SUMPRODUCT(\" &amp; .Range(\"G6\", .Range(\"G5\").End(xlDown)).Address(0, 0) &amp; \", SUBTOTAL(109, OFFSET(H6, ROW(\" &amp; .Range(\"H6\", .Range(\"H5\").End(xlDown)).Address(0, 0) &amp; \")-ROW(H6),)))\")\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 12119004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31669530cb23549bd152b1f6c0326bd0?s=128&d=identicon&r=PG&f=1", "display_name": "OnTheHunt", "link": "https://stackoverflow.com/users/12119004/onthehunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569439138, "creation_date": 1569436862, "last_edit_date": 1569437428, "question_id": 58104710, "link": "https://stackoverflow.com/questions/58104710/vba-code-to-evaluate-sumproduct-in-a-dynamic-table", "title": "VBA Code to Evaluate Sumproduct in a dynamic TABLE", "body": "<p>I'm using a data entry form to store information in a table. I am trying to get the sumproduct of values contained in a table which time a user submits an entry (from the userform). </p>\n\n<p>I have tried specifying my range, e.g G6:G1000 which worked but i want it to capture only the values contained in the table. </p>\n\n<pre><code>Sheet1.Range(\"P7\").Value = Evaluate(\"=SUMPRODUCT(range(\"G6\", range(\"G5\").End(xlDown), SUBTOTAL(109, OFFSET(H6, ROW(range(\"H6\", range(\"H5\").End(xlDown)-ROW(H6),)))\")\n</code></pre>\n\n<p>I get a compile error: Expected list separator or )</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1569436493, "post_id": 58104531, "comment_id": 102600226, "body": "You can do with a <code>CountIfs()</code> to capture &lt; or &gt; thresholds."}, {"owner": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "edited": false, "score": 0, "creation_date": 1569451417, "post_id": 58104531, "comment_id": 102605374, "body": "I am confused by this sentence <code>For CM-12 we should take 31-61 and check if values 25,26,185,625 in this threshold or not</code>. I thought you would only check if values <b>under</b> CM-12 are between 31 and 61. But based on what you said you also want to compare values under CM-13 and CM-14 with 31 and 61? If that&#39;s not what you mean please correct your original post. If that&#39;s exactly what you want, please specify the rules for CM-13 and CM-14, or confirm the other numbers in the Threshold row <code>85</code>, <code>101</code> are irrelevant?"}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 1, "last_activity_date": 1569436755, "creation_date": 1569436755, "answer_id": 58104687, "question_id": 58104531, "link": "https://stackoverflow.com/questions/58104531/excel-set-1-or-0-if-any-value-from-array-is-between-two-values-from-treshold/58104687#58104687", "title": "Excel set 1 or 0 IF any value from array is between two values from treshold", "body": "<p>Using this formula, as displayed in the further down image, you can count items in a range that are between thresholds:</p>\n\n<pre><code>=COUNTIFS($B$2:$D$4,\"&lt;\"&amp;F9,$B$2:$D$4,\"&gt;\"&amp;E9)\n</code></pre>\n\n<p>Note the <code>\"&lt;\"&amp;</code> tied to a cell reference...</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZnnEb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZnnEb.png\" alt=\"enter image description here\"></a></p>\n\n<p>Checked for my small array if values were between 0 &amp; 2, 2 &amp; 4, 4 &amp; 10, and 10 &amp; 11.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 10984962, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MEMm85dUNpU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZk5YFBiakrggKeK_Imsd7elYP16w/mo/photo.jpg?sz=128", "display_name": "Gutemberg Schiessl", "link": "https://stackoverflow.com/users/10984962/gutemberg-schiessl"}, "is_accepted": false, "score": 0, "last_activity_date": 1569437539, "last_edit_date": 1569437539, "creation_date": 1569437169, "answer_id": 58104779, "question_id": 58104531, "link": "https://stackoverflow.com/questions/58104531/excel-set-1-or-0-if-any-value-from-array-is-between-two-values-from-treshold/58104779#58104779", "title": "Excel set 1 or 0 IF any value from array is between two values from treshold", "body": "<p>Not a problem, I tried to put the images to help, you just need to adjust the correct cells</p>\n\n<p>put a imput cell, a base value and a upper value to define the condition and put in the cell below</p>\n\n<pre><code>=uppercell + 30\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/u4f56.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u4f56.png\" alt=\"image\"></a></p>\n\n<p>Then use the following formula: </p>\n\n<pre><code>=if(and(base cell &lt; input; imput &lt; upper cell); 1; 0) \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/tFJrd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tFJrd.png\" alt=\"image2\"></a></p>\n"}], "owner": {"reputation": 53, "user_id": 5229500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92379100234b96e717988088be27f056?s=128&d=identicon&r=PG", "display_name": "S3xCodeandRocknRoll", "link": "https://stackoverflow.com/users/5229500/s3xcodeandrocknroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1569437539, "creation_date": 1569436045, "last_edit_date": 1569436564, "question_id": 58104531, "link": "https://stackoverflow.com/questions/58104531/excel-set-1-or-0-if-any-value-from-array-is-between-two-values-from-treshold", "title": "Excel set 1 or 0 IF any value from array is between two values from treshold", "body": "<p>There is a dynamic array in Excel with some values.</p>\n\n<p>Values could change based on some formulas (doesn't matter which formulas).\n<a href=\"https://i.stack.imgur.com/pKzNf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pKzNf.png\" alt=\"array_values\"></a></p>\n\n<p>There are tresholds (0-31, 61-85 and so on).\n<a href=\"https://i.stack.imgur.com/BDHsr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BDHsr.png\" alt=\"tresholds\"></a></p>\n\n<p>Based on these tresholds if any value from the first row of the array is between 0-31 then CM-11 should be 1, else 0.</p>\n\n<p>For CM-12 we should take 31-61 and check if values 25,26,185,625 in this treshold or not. So in this case now it will be 0 since the criteria is false.\nAnd so on for every cell.</p>\n\n<p>Is there any sophisticated approach to solve and automate this task applying Excel formulas? \nOr any other approach usingExcel?</p>\n\n<p><a href=\"https://i.stack.imgur.com/HItOL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HItOL.png\" alt=\"array_and_tresholds\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1569435208, "post_id": 58104316, "comment_id": 102599690, "body": "You can refer to the sheet by name or by index. Just activate it after the loop."}, {"owner": {"reputation": 21, "user_id": 12059998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8599028ac2d8e6d7045763e78543ff0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Marin", "link": "https://stackoverflow.com/users/12059998/jonathan-marin"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1569435871, "post_id": 58104316, "comment_id": 102599978, "body": "@brax got it thanks"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569437375, "post_id": 58104483, "comment_id": 102600598, "body": "Consider iterating the <code>Worksheets</code> collection if you mean to work with <code>Worksheet</code> objects. <code>Sheets</code> can also contains <code>Chart</code> and other sheet types. Also if the &quot;Dashboard&quot; sheet exists in <code>ThisWorkbook</code>, give it a code name and do <code>DashboardSheet.Visible = True</code> and <code>DashboardSheet.Activate</code> and <code>DashboardSheet.Range(&quot;A1&quot;).Select</code> instead of dereferencing the exact same object 3 times off the <code>Sheets</code> collection. Also consider writing your loop as an actual code block rather than some golfed-up minified-for-immediate-pane version."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569437406, "post_id": 58104483, "comment_id": 102600609, "body": "Unqualified <code>Sheets</code> refers to whatever workbook is currently active. You most probably want that to be <code>ThisWorkbook.Worksheets</code>"}, {"owner": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 0, "creation_date": 1569827602, "post_id": 58104483, "comment_id": 102707793, "body": "@Jonathan Marin --- Were you satisfied with your own answer at the end from the functionality point of view? Did it work?"}], "tags": [], "owner": {"reputation": 21, "user_id": 12059998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8599028ac2d8e6d7045763e78543ff0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Marin", "link": "https://stackoverflow.com/users/12059998/jonathan-marin"}, "is_accepted": false, "score": 0, "last_activity_date": 1569435905, "creation_date": 1569435905, "answer_id": 58104483, "question_id": 58104316, "link": "https://stackoverflow.com/questions/58104316/un-hiding-all-sheets-and-go-to-specific-sheet/58104483#58104483", "title": "Un Hiding all sheets and go to specific sheet", "body": "<pre><code>Sub Unhide_All_Tabs()\n\nFor Each ws In Sheets: ws.Visible = True: Next\nThisWorkbook.Sheets(\"Dashboard\").Visible = True\nThisWorkbook.Sheets(\"Dashboard\").Select\nThisWorkbook.Sheets(\"Dashboard\").Range(\"A1\").Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "is_accepted": false, "score": 1, "last_activity_date": 1569438866, "last_edit_date": 1569438866, "creation_date": 1569438364, "answer_id": 58105058, "question_id": 58104316, "link": "https://stackoverflow.com/questions/58104316/un-hiding-all-sheets-and-go-to-specific-sheet/58105058#58105058", "title": "Un Hiding all sheets and go to specific sheet", "body": "<p>I agree with @Mathieu Guindon and @braX.</p>\n\n<p>This is what I would do too:</p>\n\n<pre><code>Option Explicit\n\nSub Unhide_All_Tabs()\n    Dim WB As Workbook\n    Dim WSht As Worksheet\n\n    Set WB = ActiveWorkbook\n\n    For Each WSht In WB.Worksheets\n        WSht.Visible = xlSheetVisible\n    Next\n    Set WSht = WB.Worksheets(\"Dashboard\")\n\n    WSht.Activate\n    WSht.Cells(1, 1).Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12059998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8599028ac2d8e6d7045763e78543ff0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Marin", "link": "https://stackoverflow.com/users/12059998/jonathan-marin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1569438866, "creation_date": 1569435135, "last_edit_date": 1569436971, "question_id": 58104316, "link": "https://stackoverflow.com/questions/58104316/un-hiding-all-sheets-and-go-to-specific-sheet", "title": "Un Hiding all sheets and go to specific sheet", "body": "<p>Hi I have to macro to unhide all sheets but when I run it, it takes me to the bottom of a random sheet. I would like it to go, to a specific sheet and take me to the top of the sheet.</p>\n\n<p>code</p>\n\n<pre><code>Sub Unhide_All_Tabs()\n\nFor Each ws In Sheets: ws.Visible = True: Next\n</code></pre>\n"}, {"tags": ["excel", "vba", "office365"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1569440745, "post_id": 58104248, "comment_id": 102601906, "body": "When <a href=\"https://stackoverflow.com/a/22812127/445425\">copying code</a>   from elsewhere on SO, you are required  to give attribution"}], "answers": [{"tags": [], "owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "is_accepted": false, "score": 0, "last_activity_date": 1569436262, "creation_date": 1569436262, "answer_id": 58104573, "question_id": 58104248, "link": "https://stackoverflow.com/questions/58104248/how-can-i-place-a-formula-in-the-first-empty-cell-on-column-f/58104573#58104573", "title": "How can I place a formula in the first empty cell on Column F?", "body": "<p>You'll need to change your <code>rowCount</code>, the way you have it, the loop will stop before the first blank row. I believe you should just be able to set use <code>.Formula</code> for the empty cell. Hope this helps:</p>\n\n<pre><code>Sub EmptyCellFillFormula()\n\n    Dim sourceCol As Integer, rowCount As Integer, currentRow As Integer\n    Dim currentRowValue As String\n\n    sourceCol = 6   'column F has a value of 6\n    rowCount = Cells(Rows.Count, sourceCol).End(xlUp).Row + 1\n\n    For currentRow = 1 To rowCount\n        currentRowValue = Cells(currentRow, sourceCol).Value\n        If IsEmpty(currentRowValue) Or currentRowValue = \"\" Then\n            Cells(currentRow, sourceCol).Formula = \"=F3\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 11256062, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-otl9LPjfkSs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re62TEpo4b12vviZ4GMm-ISbzkNKQ/mo/photo.jpg?sz=128", "display_name": "Edgar Flores", "link": "https://stackoverflow.com/users/11256062/edgar-flores"}, "edited": false, "score": 0, "creation_date": 1571936386, "post_id": 58106623, "comment_id": 103413063, "body": "I apreciate i just started using it, took me a while to understand it and adapting the code into macro but i finally got.  yes, i wanted with following code (r.Formula = &quot;=&quot; &amp; r.Offset(-1, 0).Address(0, 0))  :P"}, {"owner": {"reputation": 17, "user_id": 11256062, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-otl9LPjfkSs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re62TEpo4b12vviZ4GMm-ISbzkNKQ/mo/photo.jpg?sz=128", "display_name": "Edgar Flores", "link": "https://stackoverflow.com/users/11256062/edgar-flores"}, "edited": false, "score": 0, "creation_date": 1571937077, "post_id": 58106623, "comment_id": 103413351, "body": "can that same Fuction repeat until the last empty cel?"}, {"owner": {"reputation": 17, "user_id": 11256062, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-otl9LPjfkSs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re62TEpo4b12vviZ4GMm-ISbzkNKQ/mo/photo.jpg?sz=128", "display_name": "Edgar Flores", "link": "https://stackoverflow.com/users/11256062/edgar-flores"}, "edited": false, "score": 0, "creation_date": 1572011062, "post_id": 58106623, "comment_id": 103438458, "body": "Neilsem thank you! Yes that&#39;s what I whanted, currently im teachig my self how to doe this but this falls in more advance codes, currently I&#39;m look for what I need on internet and if I find it i use it on my macros, but if i dont i get a similar code and ask if somenhing like this can get use. I really apreciate your help!"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1571939597, "last_edit_date": 1571939597, "creation_date": 1569446161, "answer_id": 58106623, "question_id": 58104248, "link": "https://stackoverflow.com/questions/58104248/how-can-i-place-a-formula-in-the-first-empty-cell-on-column-f/58106623#58106623", "title": "How can I place a formula in the first empty cell on Column F?", "body": "<p>Your existing code implies you want to consider truely Empty cells and cells that contain an empty string (or a formula that returns an empty string) <sup>Note 1</sup>.  (Given you simply copied that code from elsewhere, that may not be the case)</p>\n\n<p>You can use <code>End(xlDown)</code> to locate the first truely Empty cell, or <code>Match</code> to locate the first \"Empty\" cell in a range (either just empty string, or either empty strings or Empty cells, in different forms)</p>\n\n<p>If you want to find the first truely Empty cell, <em>or</em> cell containing an empty string:</p>\n\n<pre><code>Function FindFirstEmptyOrBlankCell(StartingAt As Range) As Range\n    Dim rng As Range\n\n    'Set search range\n    With StartingAt.Worksheet\n        Set rng = .Range(StartingAt, .Cells(.Rows.Count, StartingAt.Column).End(xlUp).Offset(1, 0))\n    End With\n\n    ' Find first empty or blank cell\n    Set FindFirstEmptyOrBlankCell = rng.Cells(StartingAt.Worksheet.Evaluate(\"Match(True, \" &amp; rng.Address &amp; \"=\"\"\"\"\" &amp; \", 0)\"), 1)\nEnd Function\n</code></pre>\n\n<p>If you want to find the first truely Empty cell, and ignore cells containing an empty string:</p>\n\n<pre><code>Function FindFirstEmptyCell(StartingAt As Range) As Range\n    Dim rng As Range\n\n    'Set search range\n    With StartingAt.Worksheet\n        Set rng = .Range(StartingAt, .Cells(.Rows.Count, StartingAt.Column).End(xlUp).Offset(1, 0))\n    End With\n\n    ' Find first empty cell\n    If IsEmpty(StartingAt.Cells(1, 1)) Then\n        Set FindFirstEmptyCell = rng.Cells(1, 1)\n    ElseIf IsEmpty(StartingAt.Cells(2, 1)) Then\n        Set FindFirstEmptyCell = rng.Cells(2, 1)\n    Else\n        Set FindFirstEmptyCell = rng.End(xlDown).Cells(2, 1)\n    End If\nEnd Function\n</code></pre>\n\n<p>And for completeness, if you want to find the fisrt cell containing an empty string, and ignore truely Empty cells:</p>\n\n<pre><code>Function FindFirstBlankCell(StartingAt As Range) As Range\n    Dim rng As Range\n    Dim idx As Variant\n    'Set search range\n    With StartingAt.Worksheet\n        Set rng = .Range(StartingAt, .Cells(.Rows.Count, StartingAt.Column).End(xlUp).Offset(1, 0))\n    End With\n\n    ' Find first blank cell\n    idx = Application.Match(vbNullString, rng, 0)\n    If IsError(idx) Then\n        'There are no Blank cells in the range. Add to end instead\n        Set FindFirstBlankCell = rng.Cells(rng.Rows.Count, 1)\n    Else\n        Set FindFirstBlankCell = rng.Cells(idx, 1)\n    End If\nEnd Function\n\n</code></pre>\n\n<p>In all cases, call like this</p>\n\n<pre><code>Sub Demo()\n    Dim ws As Worksheet\n    Dim r As Range\n\n    Set ws = ActiveSheet '&lt;~~~ or specify required sheet\n    Set r = FindFirstEmptyOrBlankCell(ws.Range(\"F3\"))\n\n    ' literally what was asked for\n    'r.Formula = \"=F3\"\n\n    ' possibly what was actually wanted\n    r.Formula = \"=\" &amp; r.Offset(-1, 0).Address(0, 0)\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><sub>Note 1\n<code>If IsEmpty(currentRowValue) Or currentRowValue = \"\" Then</code> is actually redundant. Any value that returns TRUE for <code>IsEmpty(currentRowValue)</code> will <em>also</em> return TRUE of <code>currentRowValue = \"\"</code> (The reverse does not apply)\n</sub></p>\n\n<p>From comment <em>can that same Fuction repeat until the last empty cel?</em> I think this is what you mean is to continue to fill blank cells down through the used range</p>\n\n<p>If so, try this</p>\n\n<pre><code>Sub Demo()\n    Dim ws As Worksheet\n    Dim cl As Range\n    Dim r As Range\n\n    Set ws = ActiveSheet '&lt;~~~ or specify required sheet\n\n    Set cl = ws.Range(\"F3\")\n    Do\n        Set r = FindFirstEmptyOrBlankCell(cl)\n        If r Is Nothing Then Exit Do\n        r.Formula = \"=\" &amp; r.Offset(-1, 0).Address(0, 0)\n        Set cl = r.Offset(1, 0)\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Note, I've modified <code>FindFirstEmptyOrBlankCell</code> above to aloow it to return <code>Nothing</code>  when it needs to:</p>\n\n<pre><code>Function FindFirstEmptyOrBlankCell(StartingAt As Range) As Range\n    Dim rng As Range\n\n    'Set search range\n    With StartingAt.Worksheet\n        Set rng = .Range(StartingAt, .Cells(.Rows.Count, StartingAt.Column).End(xlUp).Offset(1, 0))\n    End With\n\n    ' Find first empty or blank cell\n    On Error Resume Next ' Allow function to return Nothing\n    Set FindFirstEmptyOrBlankCell = rng.Cells(StartingAt.Worksheet.Evaluate(\"Match(True, \" &amp; rng.Address &amp; \"=\"\"\"\"\" &amp; \", 0)\"), 1)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11256062, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-otl9LPjfkSs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re62TEpo4b12vviZ4GMm-ISbzkNKQ/mo/photo.jpg?sz=128", "display_name": "Edgar Flores", "link": "https://stackoverflow.com/users/11256062/edgar-flores"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 58106623, "answer_count": 2, "score": 0, "last_activity_date": 1571939597, "creation_date": 1569434847, "last_edit_date": 1569442737, "question_id": 58104248, "link": "https://stackoverflow.com/questions/58104248/how-can-i-place-a-formula-in-the-first-empty-cell-on-column-f", "title": "How can I place a formula in the first empty cell on Column F?", "body": "<p>How can I place a formula in the first empty cell on Column <code>F</code>?</p>\n\n<p><code>F3</code> is empty cell.\nNeed for that empty cell be <code>=F2</code></p>\n\n<p>Note: I'm looking for code to look for first empty cell <code>F</code> and I need to be able to insert in the first empty cell <code>=F3</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IGCKt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IGCKt.png\" alt=\"Sample Data\"></a></p>\n\n<p>Currently working with following code <a href=\"https://stackoverflow.com/a/22812127/445425\">copied from here</a></p>\n\n<pre><code>Dim sourceCol As Integer, rowCount As Integer, currentRow As Integer\nDim currentRowValue As String\n\nsourceCol = 6   'column F has a value of 6\nrowCount = Cells(Rows.Count, sourceCol).End(xlUp).Row\n\n'for every row, find the first blank cell and select it\nFor currentRow = 1 To rowCount\n    currentRowValue = Cells(currentRow, sourceCol).Value\n    If IsEmpty(currentRowValue) Or currentRowValue = \"\" Then\n        Cells(currentRow, sourceCol).Select\n        Exit For 'This is missing...\n    End If\nNext\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 4, "creation_date": 1569435528, "post_id": 58104166, "comment_id": 102599825, "body": "Add a <code>)</code> between <code>LastUpdatedBy</code> and <code>SELECT</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569436589, "post_id": 58104166, "comment_id": 102600267, "body": "^ this. Your field list isn&#39;t terminated. Voting to close as a typo."}, {"owner": {"reputation": 23, "user_id": 11967802, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eHKYMTB2yRQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfY9zjSv94CC9PI_3cNxOkpdvTDJA/photo.jpg?sz=128", "display_name": "RussellC", "link": "https://stackoverflow.com/users/11967802/russellc"}, "edited": false, "score": 0, "creation_date": 1569437410, "post_id": 58104166, "comment_id": 102600611, "body": "My Me. code is still not functioning. I am prompted to type in the values."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1569438150, "post_id": 58104166, "comment_id": 102600897, "body": "Double-check the field name spelling for <code>[Corrected Med Ed ID]</code>  Any leading or training spaces in the name will be a problem."}, {"owner": {"reputation": 23, "user_id": 11967802, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eHKYMTB2yRQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfY9zjSv94CC9PI_3cNxOkpdvTDJA/photo.jpg?sz=128", "display_name": "RussellC", "link": "https://stackoverflow.com/users/11967802/russellc"}, "edited": false, "score": 0, "creation_date": 1569439211, "post_id": 58104166, "comment_id": 102601362, "body": "I have checked and the spelling is correct.I have checked, i have tried to rename the field to remove the spaces, nothing is working."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569439429, "post_id": 58104166, "comment_id": 102601445, "body": "In that case we can&#39;t help you - compare your field list against the table definitions. Since we can&#39;t see those, it gets rather hard to put the finger on where the typo is. Consider sticking to <code>PascalCase</code> for all table and column names in the future, to avoid this kind of problem."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1569439477, "post_id": 58104166, "comment_id": 102601464, "body": "Does Access ask you for a parameter value for <code>[Corrected Med Ed ID]</code> three times when you run the code --- once for each of the three SQL statements?  If not all 3, then which of them trigger the parameter request?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1569439652, "post_id": 58104166, "comment_id": 102601535, "body": "Is <code>[Corrected Med Ed ID]</code> a text or number field?"}, {"owner": {"reputation": 23, "user_id": 11967802, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eHKYMTB2yRQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfY9zjSv94CC9PI_3cNxOkpdvTDJA/photo.jpg?sz=128", "display_name": "RussellC", "link": "https://stackoverflow.com/users/11967802/russellc"}, "edited": false, "score": 0, "creation_date": 1569439705, "post_id": 58104166, "comment_id": 102601553, "body": "Yes it asks 3 times  I have retyped the name of the fields so all references of field now read [CorrectedMedEdID]"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1569439843, "post_id": 58104166, "comment_id": 102601599, "body": "Is <code>[Corrected Med Ed ID]</code> part of the Record Source for your form or the name of a control on your form?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1569439945, "post_id": 58104166, "comment_id": 102601631, "body": "Create a new query in the Access query designer.  Switch from Design View to SQL View.  Paste in this highlighted text: <code>SELECT Min([CorrectedMedEdID]) FROM tbl_InterfaceLog</code>  When you run that query, does Access ask you supply a value for <code>CorrectedMedEdID</code>?"}, {"owner": {"reputation": 23, "user_id": 11967802, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eHKYMTB2yRQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfY9zjSv94CC9PI_3cNxOkpdvTDJA/photo.jpg?sz=128", "display_name": "RussellC", "link": "https://stackoverflow.com/users/11967802/russellc"}, "edited": false, "score": 0, "creation_date": 1569440531, "post_id": 58104166, "comment_id": 102601818, "body": "HansUp it returns the correct ID when I do that. I should say that my VBA has been saying Enter Parameter Value and it also has the [CorrectedMedEdID] above where I type the value."}], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 9570309, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101103311742062/picture?type=large", "display_name": "Matt", "link": "https://stackoverflow.com/users/9570309/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1569439370, "creation_date": 1569439370, "answer_id": 58105264, "question_id": 58104166, "link": "https://stackoverflow.com/questions/58104166/why-is-my-me-reference-and-insert-into-causing-error/58105264#58105264", "title": "Why is my Me. Reference and INSERT INTO causing error?", "body": "<p>Have you checked and researched whether the SQL column names in the database are case-sensitive when delimited? That is, on this table creation. If so, <code>[corrected med ed ID]</code> \u2260 <code>[Corrected Med Ed ID]</code></p>\n\n<p>You can try and fix Case and see if it works.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 11967802, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eHKYMTB2yRQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfY9zjSv94CC9PI_3cNxOkpdvTDJA/photo.jpg?sz=128", "display_name": "RussellC", "link": "https://stackoverflow.com/users/11967802/russellc"}, "edited": false, "score": 0, "creation_date": 1569445241, "post_id": 58105404, "comment_id": 102603680, "body": "I am getting a data type conversion error here, Is it because the field is short text and primary key?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 23, "user_id": 11967802, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eHKYMTB2yRQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfY9zjSv94CC9PI_3cNxOkpdvTDJA/photo.jpg?sz=128", "display_name": "RussellC", "link": "https://stackoverflow.com/users/11967802/russellc"}, "edited": false, "score": 0, "creation_date": 1569445515, "post_id": 58105404, "comment_id": 102603762, "body": "I had waited for your response above and originally had a text field. Simply change <code>LONG</code> to <code>TEXT(255)</code>."}, {"owner": {"reputation": 23, "user_id": 11967802, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eHKYMTB2yRQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfY9zjSv94CC9PI_3cNxOkpdvTDJA/photo.jpg?sz=128", "display_name": "RussellC", "link": "https://stackoverflow.com/users/11967802/russellc"}, "edited": false, "score": 0, "creation_date": 1569446072, "post_id": 58105404, "comment_id": 102603935, "body": "I apologize :/ . I am getting &quot;Too few Parameters. Expected 2.&quot;"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 23, "user_id": 11967802, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eHKYMTB2yRQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfY9zjSv94CC9PI_3cNxOkpdvTDJA/photo.jpg?sz=128", "display_name": "RussellC", "link": "https://stackoverflow.com/users/11967802/russellc"}, "edited": false, "score": 0, "creation_date": 1569450118, "post_id": 58105404, "comment_id": 102605067, "body": "Run the queries by themselves in Query Design (cancel action on prompt) and find which fields are not recognized if it asks. It should only ask for <i>idparam</i>. Can be simple spelling issue."}, {"owner": {"reputation": 23, "user_id": 11967802, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eHKYMTB2yRQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfY9zjSv94CC9PI_3cNxOkpdvTDJA/photo.jpg?sz=128", "display_name": "RussellC", "link": "https://stackoverflow.com/users/11967802/russellc"}, "edited": false, "score": 0, "creation_date": 1569498164, "post_id": 58105404, "comment_id": 102621172, "body": "I did just that and it brought me to the fields with the typos. I appreciate you!"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1569445542, "last_edit_date": 1569445542, "creation_date": 1569439983, "answer_id": 58105404, "question_id": 58104166, "link": "https://stackoverflow.com/questions/58104166/why-is-my-me-reference-and-insert-into-causing-error/58105404#58105404", "title": "Why is my Me. Reference and INSERT INTO causing error?", "body": "<p>Simply use parameterized queries and avoid the need to concatenate SQL string in VBA. Specifically, save below two SQL statements as stored Access queries. Then bind parameters using <a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/querydef-object-dao\" rel=\"nofollow noreferrer\">QueryDefs</a> in VBA for cleaner, readable, and maintainable code. </p>\n\n<p>Note: the two update queries can be combined into one. Also, the table alias, <em>t</em>, is used. When using Query Design, Access will not allow you to save queries with syntax error. Below assumes parameter will be a string/text value.</p>\n\n<p><strong>SQL</strong> </p>\n\n<p>Update Query</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS idparam TEXT(255);\nUPDATE tbl_InterfaceLog t\n   SET t.[LastUpdated] = Date(),\n       t.[LastUpdatedBy] = Username()\nWHERE [CorrectedMedEdID] = idparam;\n</code></pre>\n\n<p>Append Query </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS idparam TEXT(255);\nINSERT INTO tbl_AuditLog ([Status], [Comments], [Owner], [corrected med ed ID], \n                          [Upload File Name], [Submission Method], AirfareStatus,\n                          GroundStatus, MealsStatus, AccomodationStatus, \n                          AirfareComment, GroundComment, MealsComment, \n                          AccommodationComment, Coordinator, SupportRequested, \n                          LastUpdated, Reviewed, ReviewerComment, RequiredChange, \n                          EventDate, ProductsMatch, SubmissionMethod, \n                          TravelDestination, LastUpdatedBy)\n\nSELECT t.Status, t.Comments, t.Owner, t.[corrected med ed ID], t.[Upload File Name],\n       t.[Submission Method], t.AirfareStatus, t.GroundStatus, t.MealsStatus, \n       t.AccomodationStatus, t.AirfareComment, t.GroundComment, t.MealsComment, \n       t.AccommodationComment, t.Coordinator, t.SupportRequested, t.LastUpdated, \n       t.Reviewed, t.ReviewerComment, t.RequiredChange, t.EventDate, t.ProductsMatch, \n       t.SubmissionMethod, t.TravelDestination, t.LastUpdatedBy\nFROM tbl_InterfaceLog t\nWHERE t.[CorrectedMedEdID] = idparam;\n</code></pre>\n\n<p><strong>VBA</strong> <em>(no concatenation)</em></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_AfterUpdate()\n    Dim UserName As String\n    Dim qdef as QueryDef\n\n    ' UPDATE QUERY \n    Set qdef = CurrentDb.QueryDefs(\"myUpdateQuery\")        \n    qdef!idparam = Me.[Corrected Med Ed ID]             ' BIND PARAM\n    qdef.Execute dbFailOnError                          ' EXECUTE QUERY\n    Set qdef = Nothing    \n\n    ' APPEND QUERY\n    Set qdef = CurrentDb.QueryDefs(\"myAppendQuery\")        \n    qdef!idparam = Me.[Corrected Med Ed ID]             ' BIND PARAM\n    qdef.Execute dbFailOnError                          ' EXECUTE QUERY\n    Set qdef = Nothing\nEnd Sub\n</code></pre>\n\n<p>Or DRY-er approach:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_AfterUpdate()\n    Dim UserName As String, qry As Variant\n    Dim qdef as QueryDef\n\n    ' RUN ACTION QUERIES\n    For Each qry in Array(\"myUpdateQuery\", \"myAppendQuery\")\n        Set qdef = CurrentDb.QueryDefs(qry)  \n        qdef!idparam = Me.[Corrected Med Ed ID]         ' BIND PARAM\n        qdef.Execute dbFailOnError                      ' EXECUTE QUERY\n        Set qdef = Nothing    \n    Next qry\n\n    Set qdef = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11967802, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eHKYMTB2yRQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfY9zjSv94CC9PI_3cNxOkpdvTDJA/photo.jpg?sz=128", "display_name": "RussellC", "link": "https://stackoverflow.com/users/11967802/russellc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 58105404, "answer_count": 2, "score": 0, "last_activity_date": 1594449091, "creation_date": 1569434497, "last_edit_date": 1594449091, "question_id": 58104166, "link": "https://stackoverflow.com/questions/58104166/why-is-my-me-reference-and-insert-into-causing-error", "title": "Why is my Me. Reference and INSERT INTO causing error?", "body": "<p>I am receiving two errors when attempting to create a query which updates my audit log after an update is made to a record. </p>\n\n<p>First I am prompted to enter a Parameter Value where I believed my <code>ME.</code> code would point to any record with the current value of field <code>[Corrected Med Ed ID]</code>.</p>\n\n<p>Secondly I receive message:</p>\n\n<blockquote>\n  <p>Syntax error in INSERT INTO statement. </p>\n</blockquote>\n\n<p>My form's code is - </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_AfterUpdate()\n    Dim UserName As String\n\n    DoCmd.SetWarnings False\n    'updates date\n    DoCmd.RunSQL \"update tbl_InterfaceLog SET tbl_InterfaceLog.[LastUpdated] = Date() Where [Corrected Med Ed ID] = \" &amp; Me.[Corrected Med Ed ID]\n    'stamps username\n    DoCmd.RunSQL \"update tbl_InterfaceLog SET tbl_InterfaceLog.[LastUpdatedBy] = Username() Where [Corrected Med Ed ID] = \" &amp; Me.[Corrected Med Ed ID]\n    'Adds the record to log\n    DoCmd.RunSQL \"INSERT INTO tbl_AuditLog (Status, Comments, Owner, [corrected med ed ID], [Upload File Name], [Submission Method], AirfareStatus, GroundStatus, MealsStatus, AccomodationStatus, AirfareComment, GroundComment, MealsComment, AccommodationComment, Coordinator, SupportRequested, LastUpdated, Reviewed, ReviewerComment, RequiredChange, EventDate, ProductsMatch, SubmissionMethod, TravelDestination, LastUpdatedBy\" _\n    &amp; \" SELECT tbl_InterfaceLog.Status, tbl_InterfaceLog.Comments, tbl_InterfaceLog.Owner, tbl_InterfaceLog.[corrected med ed ID], tbl_InterfaceLog.[Upload File Name], tbl_InterfaceLog.[Submission Method], tbl_InterfaceLog.AirfareStatus, tbl_InterfaceLog.GroundStatus, tbl_InterfaceLog.MealsStatus, tbl_InterfaceLog.AccomodationStatus, tbl_InterfaceLog.AirfareComment, tbl_InterfaceLog.GroundComment, tbl_InterfaceLog.MealsComment, tbl_InterfaceLog.AccommodationComment, tbl_InterfaceLog.Coordinator, tbl_InterfaceLog.SupportRequested, tbl_InterfaceLog.LastUpdated, tbl_InterfaceLog.Reviewed, tbl_InterfaceLog.ReviewerComment, tbl_InterfaceLog.RequiredChange, tbl_InterfaceLog.EventDate, tbl_InterfaceLog.ProductsMatch, tbl_InterfaceLog.SubmissionMethod, tbl_InterfaceLog.TravelDestination, tbl_InterfaceLog.LastUpdatedBy\" _\n    &amp; \" FROM tbl_InterfaceLog\" _\n    &amp; \" WHERE [Corrected Med Ed ID] = \" &amp; Me.[Corrected Med Ed ID]\n    DoCmd.SetWarnings True\nEnd Sub\n</code></pre>\n"}, {"tags": ["json", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11736976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UX72scn7ZQw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re47MM0t4S6btkoez7BmVpXKARbOg/photo.jpg?sz=128", "display_name": "Sigil", "link": "https://stackoverflow.com/users/11736976/sigil"}, "edited": false, "score": 0, "creation_date": 1569435448, "post_id": 58104219, "comment_id": 102599797, "body": "This is perfect! Thank you for the explanation and code. I&#39;d upvote this but I can&#39;t yet. The edit with the alternative is useful reference too, that&#39;s what I was thinking after seeing your initial response."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 25, "user_id": 11736976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UX72scn7ZQw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re47MM0t4S6btkoez7BmVpXKARbOg/photo.jpg?sz=128", "display_name": "Sigil", "link": "https://stackoverflow.com/users/11736976/sigil"}, "edited": false, "score": 0, "creation_date": 1569436049, "post_id": 58104219, "comment_id": 102600042, "body": "Great! I&#39;m glad you saw the edit. I was rereading the answer and I was like... &quot;Duh.. this would make more sense if I created the dictionary first, then added it to the collection&quot;."}, {"owner": {"reputation": 362, "user_id": 2752308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574f9f2cb6733e7ebcdd340d6ec14b25?s=128&d=identicon&r=PG&f=1", "display_name": "Marcelo Scofano Diniz", "link": "https://stackoverflow.com/users/2752308/marcelo-scofano-diniz"}, "edited": false, "score": 0, "creation_date": 1579834602, "post_id": 58104219, "comment_id": 105908040, "body": "@JNevill and OP: Brilliant approach, so obvious that it was hidden in plain view, at least for me. Thanks."}, {"owner": {"reputation": 362, "user_id": 2752308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574f9f2cb6733e7ebcdd340d6ec14b25?s=128&d=identicon&r=PG&f=1", "display_name": "Marcelo Scofano Diniz", "link": "https://stackoverflow.com/users/2752308/marcelo-scofano-diniz"}, "edited": false, "score": 0, "creation_date": 1579836142, "post_id": 58104219, "comment_id": 105908315, "body": "And to add 0.02$:  <code>Json(1)(&quot;Entries&quot;)(2).Add &quot;Dates&quot;, array(&quot;2019-09-26&quot;,&quot;2019-01-23&quot;,&quot;2020-01-24&quot;)</code>"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 2, "last_activity_date": 1569435443, "last_edit_date": 1569435443, "creation_date": 1569434720, "answer_id": 58104219, "question_id": 58103778, "link": "https://stackoverflow.com/questions/58103778/vba-json-add-entry-to-existing-file/58104219#58104219", "title": "VBA-JSON: Add entry to Existing File", "body": "<p>VBA Json is really just a cheap (and effective) converter/deconverter of a json string into a nested set of dictionaries and collections. So you don't have to <em>\"deconstruct [your] file into dictionaries/collections and rebuild it\"</em> since... it already is. This is why it's necessary to add in the Microsoft Scripting Runtime library to use it. </p>\n\n<p>The struggle you are dealing with is that you are treating every object in your <code>json</code> object as a dictionary. Instead you want to <code>add</code>(pop) to the <code>entries</code> collection. A good way to keep these separate is that in VBA JSON (as far as I've seen) if an object is a key/value pair, then it's a <code>Dictionary</code> and if it's just an object without a <code>key</code> then it's a <code>Collection</code>. I'm certain there is more nuance there, but it works well in this scenario.</p>\n\n<p>Consider:</p>\n\n<pre><code>Sub test()\n    Dim Json As Object\n    Set Json = JsonConverter.ParseJson(\"[{\"\"Entries\"\":[{\"\"Date\"\": 2019-09-25,\"\"a\"\": 1,\"\"b\"\": 2}]}]\")\n\n    Dim entry1 As Object\n    Set entry1 = Json(1)(\"Entries\")\n\n    Stop '&lt;--inspect Locals and see that we have a Collection here\n\n    'Add to the collection (different then adding to a dictionary)\n    'We will add a dictionary to the collection though\n    Json(1)(\"Entries\").Add New Dictionary\n\n    'Now add to the dictionary.\n    Json(1)(\"Entries\")(2).Add \"Date\", \"2019-09-26\"\n\n    Stop\n\n    Debug.Print JsonConverter.ConvertToJson(Json)\n\n    'Alternatively you could create the dictionary and add your keys, then `pop` your entries\n    Dim Entry As Dictionary\n    Set Entry = New Dictionary\n    Entry.Add \"Date\", \"2019-09-26\"\n    Entry.Add \"a\", \"2\"\n    Entry.Add \"b\", \"3\"\n\n    Json(1)(\"Entries\").Add Entry\n\n    Debug.Print JsonConverter.ConvertToJson(Json)\nEnd Sub\n</code></pre>\n\n<p>This should spit out what you are after (I think):</p>\n\n<pre><code>[{\"Entries\":[{\"Date\":\"2019-09-25\",\"a\":1,\"b\":2},{\"Date\":\"2019-09-26\"}]}]\n</code></pre>\n\n<p>I guess another way to think through this is that if we want to add a new array to our <code>Entries</code> then we have to add a new <code>Dictionary</code> object to the <code>Entries</code> collection. Then we can add into the dictionary our key/value pairs like <code>Date</code>, <code>a</code>, and <code>b</code>. </p>\n"}], "owner": {"reputation": 25, "user_id": 11736976, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UX72scn7ZQw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re47MM0t4S6btkoez7BmVpXKARbOg/photo.jpg?sz=128", "display_name": "Sigil", "link": "https://stackoverflow.com/users/11736976/sigil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 58104219, "answer_count": 1, "score": 1, "last_activity_date": 1569435443, "creation_date": 1569432831, "question_id": 58103778, "link": "https://stackoverflow.com/questions/58103778/vba-json-add-entry-to-existing-file", "title": "VBA-JSON: Add entry to Existing File", "body": "<p>I'm using excel to modify existing JSON with the VBA-JSON library and I'm effectively trying to do what .push from javascript does, adding another entry to the nested array.</p>\n\n<p>There's this previously posted question which illustrates what I'm trying to do but in the scope of creating a JSON file.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/49032724/vba-json-create-nested-objects\">VBA-JSON Create nested objects</a></p>\n\n<p>The accepted answer while helpful, doesn't show me how to add to what I already have without rebuilding it entirely. I can picture a mess of loops to parse my existing file into strings, then do something similar to what is in the post. I'm curious if there's another way to do it.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'download json\n\nSet json = JsonConverter.ParseJson(H.responseText)\n\nDebug.print json(1)(\"entries\")(1)(\"Date\")\n'2019-09-25\n\njson(1)(\"entries\")(2)(\"Date\") = \"2019-09-26\"\n'error 9 Subscript out of Range\n\n'upload json\n\n</code></pre>\n\n<pre class=\"lang-json prettyprint-override\"><code>[\n    {\n        \"Entries\": [\n            {\n                \"Date\": 2019-09-25,\n                \"a\": 1,\n                \"b\": 2\n            }\n        ]\n    }\n]\n</code></pre>\n\n<p>I'm able to access and modify existing entries but not add to it. I'm guessing this is because the library parses it as a defined array rather than variable? Any ideas on a simple solution or will I have to deconstruct my file into dictionaries/collections and rebuild it first?</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569432281, "post_id": 58103575, "comment_id": 102598489, "body": "I&#39;m assuming it&#39;s not the issue, but are you working with OLAP data? See the Remarks in the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.pivotfield.function\" rel=\"nofollow noreferrer\">documentation</a>."}, {"owner": {"reputation": 67, "user_id": 10044303, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6dWrBS5Uho4/AAAAAAAAAAI/AAAAAAAAAAo/Zlv8_rhbnnU/photo.jpg?sz=128", "display_name": "Jenna Terral", "link": "https://stackoverflow.com/users/10044303/jenna-terral"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569434262, "post_id": 58103575, "comment_id": 102599323, "body": "No @BigBen I am not. It is just coming from a database in Hadoop"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569434290, "post_id": 58103575, "comment_id": 102599334, "body": "And you can create the field manually?"}, {"owner": {"reputation": 67, "user_id": 10044303, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6dWrBS5Uho4/AAAAAAAAAAI/AAAAAAAAAAo/Zlv8_rhbnnU/photo.jpg?sz=128", "display_name": "Jenna Terral", "link": "https://stackoverflow.com/users/10044303/jenna-terral"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569434785, "post_id": 58103575, "comment_id": 102599535, "body": "Yeah, I can create it manually with no problem."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569437917, "post_id": 58103575, "comment_id": 102600802, "body": "What code does the macro recorder produce when you create it manually?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1569438991, "post_id": 58103575, "comment_id": 102601266, "body": "Can you provide a data sample to go with enough code to reproduce? An image to show layout as well. Reduce to enough to repro problem."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1569439921, "post_id": 58103575, "comment_id": 102601625, "body": "for the sake of asking... is &quot;countactivityuid&quot; spelled correctly and do you have <code>on error resume next</code> anywhere in your code?"}, {"owner": {"reputation": 67, "user_id": 10044303, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6dWrBS5Uho4/AAAAAAAAAAI/AAAAAAAAAAo/Zlv8_rhbnnU/photo.jpg?sz=128", "display_name": "Jenna Terral", "link": "https://stackoverflow.com/users/10044303/jenna-terral"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1569440929, "post_id": 58103575, "comment_id": 102602010, "body": "The macro recorder says the Add a Data Field. But I am not sure why I would need to since it is already on my table. Also, @Cyril, CountActivityUID is spelled correctly."}], "owner": {"reputation": 67, "user_id": 10044303, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6dWrBS5Uho4/AAAAAAAAAAI/AAAAAAAAAAo/Zlv8_rhbnnU/photo.jpg?sz=128", "display_name": "Jenna Terral", "link": "https://stackoverflow.com/users/10044303/jenna-terral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569440874, "creation_date": 1569431924, "last_edit_date": 1569440874, "question_id": 58103575, "link": "https://stackoverflow.com/questions/58103575/function-property-pivottable-class", "title": "Function Property PivotTable Class", "body": "<p>I am at a loss as to what the problem is surrounding this error. I have modeled this snippet of code off of other reports I have done, where there is no error. But this one is unable to get the Function Property of the PivotFields class. I get this error whether I do xlSum or XlCount</p>\n\n<pre><code>    Function exportXl(strSD As String, strED As String) As String\nDim fname As String, fso As Object, xlApp As Object, xlBook As Object, xlSheet As Object, xlObj As Object, xlPT As Object, xlPC As Object, c As Object\nfname = CurrentProject.Path &amp; \"\\SupervisorEscalationsReport_\" &amp; Replace(strED, \"/\", \"-\") &amp; \".xlsx\"\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nIf fso.FileExists(fname) Then Kill fname\n\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"t_SiebCnt\", fname\n\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.Visible = True\nSet xlBook = xlApp.workbooks.Open(fname)\nSet xlSheet = xlBook.sheets(1)\n\nWith xlSheet\n    .Name = \"t_SiebCnt\"\n    Set xlObj = .ListObjects.Add(1, .Range(\"$A$1:\" &amp; .Cells(1, 1).SpecialCells(11).Address), , 1)\n    xlObj.Name = \"Src_Table\"\n    xlObj.TableStyle = \"TableStyleMedium16\"\nEnd With\n\nSet xlPC = xlBook.PivotCaches.Create(1, \"Src_Table\", 5)\nSet xlSheet = xlBook.sheets.Add\nxlSheet.Name = \"Report\"\n\nxlApp.ScreenUpdating = False\n\nSet xlPT = xlPC.CreatePivotTable(xlSheet.Range(\"A3\"), \"Supervisor Escalation Rollup Report\")\n\nWith xlPT\n\n    With .PivotFields(\"AssignedToSalesID\")\n        .Orientation = xlPageField\n        '.Position = 1\n        .Caption = \"Sales ID\"\n    End With\n\n    With .PivotFields(\"Location\")\n        .Orientation = xlRowField\n        '.Position = 1\n        .Caption = \"Site\"\n    End With\n\n     With .PivotFields(\"FullName\")\n        .Orientation = xlRowField\n        '.Position = 1\n        .Caption = \"Supervisor Name\"\n    End With\n\n      With .PivotFields(\"Generated_On\")\n        .Orientation = xlRowField\n       ' .Position = 2\n        .Caption = \"Day Generated\"\n    End With\n\n      With .PivotFields(\"Closed_On\")\n        .Orientation = xlRowField\n       ' .Position = 2\n        .Caption = \"Day Closed\"\n    End With\n\n    With .PivotFields(\"DaysOpen\")\n        .Orientation = xlRowField\n       ' .Position = 2\n        .Caption = \"Days Open\"\n    End With\n\n   With .PivotFields(\"Status\")\n        .Orientation = xlRowField\n       ' .Position = 2\n        .Caption = \"Status\"\n    End With\n\n\n\n\n   With .PivotFields(\"CountActivityUID\")\n        .Orientation = xlDataField\n        .Function = xlCount\n        .NumberFormat = \"#,##0\"\n        .Caption = \"Count of Status\"\n    End With\n\n\n.PivotFields(\"Day Generated\").ShowDetail = False\n\n\n\n    .TableStyle2 = \"PivotStyleMedium2\"\n    .RowAxisLayout 1\n    .InGridDropZones = True\n    .DisplayErrorString = True\nEnd With\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/12zOM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/12zOM.png\" alt=\"enter image description here\"></a></p>\n\n<p>Above is the full code along with a sample image of the table I am creating my pivot table from. </p>\n"}, {"tags": ["excel", "vba", "mouseevent"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 10956787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54d7139ee14674ae4995b00d0bfefa1?s=128&d=identicon&r=PG&f=1", "display_name": "Jumpy73", "link": "https://stackoverflow.com/users/10956787/jumpy73"}, "is_accepted": true, "score": 0, "last_activity_date": 1571832399, "creation_date": 1571832399, "answer_id": 58522498, "question_id": 58103526, "link": "https://stackoverflow.com/questions/58103526/excel-chart-mouseup-event-not-trapped-under-the-same-scenario-trapped-by-the-cor/58522498#58522498", "title": "Excel Chart_MouseUp event not trapped under the same scenario trapped by the corresponding MouseDown event", "body": "<p>Even if no answer I received here about this topic, hoping this could be usefull for others, I append a solution given to me by Peter Thornton, which I thank a lot for the suggestions given.</p>\n\n<p>There is a different way, not sure why I didn\u2019t think of it before --> check the state of the left mouse button with a timer</p>\n\n<p>Below my code written for purpose </p>\n\n<pre><code>Private Declare PtrSafe Function SetTimer Lib \"User32\" (ByVal hwnd As LongPtr, ByVal nIDEvent As LongPtr, ByVal uElapse As Long, ByVal lpTimerFunc As LongPtr) As LongPtr\nPrivate Declare PtrSafe Function KillTimer Lib \"User32\" (ByVal hwnd As LongPtr, ByVal nIDEvent As LongPtr) As Long\nPrivate Declare PtrSafe Function GetAsyncKeyState Lib \"User32\" (ByVal vKey As Long) As Integer\nPrivate Declare PtrSafe Function GetSystemMetrics32 Lib \"User32\" Alias \"GetSystemMetrics\" (ByVal nIndex As Long) As Long\n\nPrivate Const HWND_ZERO As LongPtr = 0\nPrivate Const TIMER_MILLISECS = 150&amp;\n\nPrivate Const VK_LBUTTON = &amp;H1 'Left mouse button\nPrivate Const VK_RBUTTON = &amp;H2 'Right mouse button\nPrivate Const SM_SWAPBUTTON = 23&amp; 'Left and Right mouse buttons are logically swapped (Left mouse button is the default Primary button)\n\nPrivate mTimerID As LongPtr\n\nPublic Sub StartTimer()\n' call StartTimer in the chart's MouseDown event\n    If mTimerID Then\n        Call EndTimer\n    End If\n\n    mTimerID = SetTimer(HWND_ZERO, mTimerID, TIMER_MILLISECS, AddressOf TimerProcedure)\nEnd Sub\n\nPrivate Function TimerProcedure() As LongPtr\n    Dim Ch As Chart\n    Dim obj As Variant\n\n    Dim ret As Integer\n\n    On Error Resume Next\n\n    If mTimerID = 0 Then\n        Call EndTimer\n    Else\n        'map the mouse logical Primary Button to the mouse phisical Left or Right Buttons\n        If Not GetSystemMetrics32(SM_SWAPBUTTON) Then ret = GetAsyncKeyState(VK_LBUTTON) Else ret = GetAsyncKeyState(VK_RBUTTON)\n\n        'the condition is satisfied if the mouse Left Button state is correctly trapped and the Left Button is released\n        If Not ret And 32768 Then\n            Call EndTimer\n            mTimerID = 0\n\n            Call UserDefinedChartMouseUp() procedure\n\n        End If\n    End If\nEnd Function\n\nPrivate Sub EndTimer()\n    On Error Resume Next\n\n    Call KillTimer(HWND_ZERO, mTimerID)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10956787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d54d7139ee14674ae4995b00d0bfefa1?s=128&d=identicon&r=PG&f=1", "display_name": "Jumpy73", "link": "https://stackoverflow.com/users/10956787/jumpy73"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58522498, "answer_count": 1, "score": 0, "last_activity_date": 1571832399, "creation_date": 1569431712, "question_id": 58103526, "link": "https://stackoverflow.com/questions/58103526/excel-chart-mouseup-event-not-trapped-under-the-same-scenario-trapped-by-the-cor", "title": "Excel Chart_MouseUp event not trapped under the same scenario trapped by the corresponding MouseDown event", "body": "<p>I have exactly the same problem of the question <a href=\"https://stackoverflow.com/questions/57479298/excel-chart-mouseup-event-not-trapped\">Excel Chart_MouseUp event not trapped</a> but there no answer has been given</p>\n\n<p>I'm interested in the sequence press shift-ctrl-left mouse (MouseDown event is fired), move left mouse (MouseMove event is fired), release shift-ctrl-left mouse (MouseUp event is NOT fired)</p>\n\n<p>How is it possible that a MouseDown event is fired and the corresponding MouseUp event Not (under the same circumstances)!!!</p>\n\n<p>How can I solve the issue?</p>\n\n<p>Thanks in advance for the help you can give me</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569431547, "post_id": 58103289, "comment_id": 102598194, "body": "Two requests: 1) When using the VBA tag, can you also use the appropriate application, e.g. excel? 2) You&#39;ve received some well crafted answers, such as <a href=\"https://stackoverflow.com/a/58101500/9245853\">this one</a> or <a href=\"https://stackoverflow.com/a/57894889/9245853\">this one</a>, to previous questions. Can you go ahead and accept them by clicking the check next to them, if they&#39;ve satisfactorily answered your issue? It is a token of recognition to the answerer as well as a sign that the question is closed. Much appreciated (note, I didn&#39;t provide either answer but both are deserving of recognition)."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1569434707, "post_id": 58103289, "comment_id": 102599507, "body": "Can you share the complete code that you have so far, or at least a minimal example so we don&#39;t have to recreate it?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569436010, "post_id": 58103289, "comment_id": 102600030, "body": "&quot;I named the three classes &quot;mytable&quot;, &quot;mytable_col&quot;, &quot;mytable_row&quot; to keep a visible relationship in the Project Explorer&quot; - exactly what is wrong with <code>Table</code>, <code>TableColumn</code> and <code>TableRow</code>? Every single class you ever come across in VBA code, is <code>PascalCase</code>, as is every single one of its members. <code>lower_snake_case</code> not only looks weird and clashes with everything else, it will cause compiler errors if/when you start dealing with interfaces."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569436163, "post_id": 58103289, "comment_id": 102600093, "body": "As for keeping related things together, <a href=\"https://stackoverflow.com/a/58104456/1188513\">again</a> that isn&#39;t the job of identifier names. Consider using <a href=\"https://github.com/rubberduck-vba/Rubberduck/wiki/Using-@Folder-Annotations\" rel=\"nofollow noreferrer\">@Folder annotations</a> instead, then you can organize your modules any way you like/need."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1569436280, "post_id": 58103289, "comment_id": 102600141, "body": "That said this question would be more appropriate on <a href=\"https://codereview.stackexchange.com\">Code Review</a>, <b>if</b> you actually included the whole code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1569436920, "post_id": 58103289, "comment_id": 102600401, "body": "<code>row.Initialize = Me</code> looks very suspicious (no <code>Set</code> keyword for an object assignment?). Should probably be <code>row.Initialize Me</code>, but impossible to tell without seeing the actual code."}, {"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1570286575, "post_id": 58103289, "comment_id": 102869299, "body": "Thanks Mathieu, I didn&#39;t know Code Review.  I will try to reorganize the question for that website or to split the question into multiple simpler conceptual questions here."}], "owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569431336, "creation_date": 1569430759, "last_edit_date": 1569431336, "question_id": 58103289, "link": "https://stackoverflow.com/questions/58103289/how-to-organize-a-set-of-similar-functions-in-two-parallel-chained-classes", "title": "How to organize a set of similar functions in two parallel chained-classes", "body": "<p>I would like to obtain this set of properties with 1 class + 2 chained-classes:</p>\n\n<pre><code>mytable.EntireRange\nmytable.DataBodyRange\nmytable.HorizontalHeaderRange\nmytable.VerticalHeaderRange\n\nmytable.col(strTitle).num\nmytable.col(strTitle).firstDataCell\nmytable.col(strTitle).lastDataCell\n\nmytable.row(strTitle).num\nmytable.row(strTitle).firstDataCell\nmytable.row(strTitle).lastDataCell\n</code></pre>\n\n<p>What's the best way to organize (and name) these classes and properties?</p>\n\n<hr>\n\n<p>My current solution to add the chained properties is:<br>\n- I named the three classes \"mytable\", \"mytable_col\", \"mytable_row\" to keep a visible relationship in the Project Explorer<br>\n- inside \"mytable\", I added this:</p>\n\n<pre><code>Property Get col(strTitle As String) As mytable_col\n    Set col = New mytable_col\n    col.Initialize = Me ' passes the parent object\n End Property\nProperty Get row(strTitle As String) As mytable_row\n    Set row = New mytable_row\n    row.Initialize = Me ' passes the parent object\n End Property\n</code></pre>\n\n<p>Now... given that the three properties (\"num\", \"firstDataCell\", \"lastDataCell\") of the two parallel chained classes \"col\" and \"row\" share the same logic with little variations, I'd prefer to not put their complete code separated in 6 properties, three in the \"row\" class and three in the \"col\".<p>\nI ideally would to create just 3 properties/functions (passing a \"row\" or \"col\" as argument for the variations) instead than six.<br>\nHow should I do? Is it possible, without to put them in an additional module?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569434210, "post_id": 58103042, "comment_id": 102599290, "body": "You would need to implement your own <i>watermark</i> functionality, since ActiveX textboxes don&#39;t have any feature like it. Probably something along the lines of defaulting to some &quot;placeholder text&quot; content with a grey-ish foreground, and then a lot of hair-pulling involving the <code>Change</code> handler and some <code>Boolean</code> flag that indicates whether the content is placeholder text or actual legit user input - but that will never look as good as an actual watermarked textbox such as what you could do with, say, WPF in .NET. If you want a modern UI, use a modern UI framework. MSForms is well over 20yo."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1569434392, "post_id": 58103042, "comment_id": 102599379, "body": "In any case, this is <i>a lot</i> of work and effort, and this isn&#39;t a &quot;please code XYZ for me&quot; site. Get started, eventually get stuck on a specific problem, <i>then</i> ask about <i>that</i> specific problem - you&#39;ll have a much better Stack Overflow experience then. Cheers!"}], "owner": {"reputation": 59, "user_id": 10490763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r3KzC.jpg?s=128&g=1", "display_name": "Robin Scherbatsky", "link": "https://stackoverflow.com/users/10490763/robin-scherbatsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569429814, "creation_date": 1569429814, "question_id": 58103042, "link": "https://stackoverflow.com/questions/58103042/how-to-add-a-placeholder-in-an-activex-textbox-in-an-excel-sheet", "title": "How to add a placeholder in an ActiveX textbox in an excel sheet?", "body": "<p>In an excel worksheet, I have an ActiveX textbox (not from a UserForm) where I want to put placeholders in it, and when the user types his data down, the placeholder goes away.</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 1, "creation_date": 1569430331, "post_id": 58103032, "comment_id": 102597597, "body": "Can you show us what you&#39;ve tried so far?"}, {"owner": {"reputation": 3, "user_id": 12120322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163012aac57df707a94d350d4b47d03d?s=128&d=identicon&r=PG&f=1", "display_name": "TArevalo", "link": "https://stackoverflow.com/users/12120322/tarevalo"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1569431702, "post_id": 58103032, "comment_id": 102598268, "body": "I updated and provided the code I am working with for this portion of the macro. I have been looking for 2 days an have been unsuccessful in finding anything relating to adding characters to duplicates. There is a ton of information on deleting duplicates and highlighting duplicates, but have not been able to find anything that will work for what I am trying to do."}, {"owner": {"reputation": 3, "user_id": 12120322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163012aac57df707a94d350d4b47d03d?s=128&d=identicon&r=PG&f=1", "display_name": "TArevalo", "link": "https://stackoverflow.com/users/12120322/tarevalo"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1569432763, "post_id": 58103032, "comment_id": 102598682, "body": "I found this formula: &quot;=A2&amp;IF(COUNTIF($A$2:A2,A2)&gt;26, CHAR(INT((COUNTIF($A$2:A2,A2)-1)/26)+96),&quot;&quot;) &amp; CHAR(MOD(COUNTIF($A$2:A2,A2)-1,26)+97)&quot;. It adds a,b,c to each duplicate instance. Not sure if it could be tweaked to add &quot;a&quot; to first 15, &quot;b&quot; to the second 15... ect"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1569437277, "post_id": 58103032, "comment_id": 102600549, "body": "What in your code isn&#39;t working, or what error (and on what line) is appearing when you execute?"}, {"owner": {"reputation": 3, "user_id": 12120322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163012aac57df707a94d350d4b47d03d?s=128&d=identicon&r=PG&f=1", "display_name": "TArevalo", "link": "https://stackoverflow.com/users/12120322/tarevalo"}, "edited": false, "score": 0, "creation_date": 1569438261, "post_id": 58103032, "comment_id": 102600946, "body": "Everything in the code I provided is working. I am trying to add to this code a feature by which duplicates that exceed 15 instances in column A are marked with characters; &quot;a&quot; for the first 15 instances, &quot;b&quot; for the second 15 instances, and so on."}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1569462209, "creation_date": 1569462209, "answer_id": 58108483, "question_id": 58103032, "link": "https://stackoverflow.com/questions/58103032/excel-macro-to-add-a-character-to-duplicate-values-after-the-value-exceeds-15-in/58108483#58108483", "title": "Excel Macro to add a character to duplicate values after the value exceeds 15 instances", "body": "<p>For an Excel formula, you can use:</p>\n\n<pre><code>=IF(COUNTIF($A:$A,A3)&gt;15,  A3&amp;CHAR(96+INT( (COUNTIF($A$3:A3,A3)-1)/15+1)),A3)\n</code></pre>\n\n<p>where your ID codes are in column <code>A</code> and start at, for example <code>A3</code>.</p>\n\n<p>For a VBA macro, to be run after you have populated your ID column:</p>\n\n<pre><code>Option Explicit\nSub markDups()\n    Dim WB As Workbook, WS As Worksheet\n    Dim rID As Range, C As Range, D As Range\n    Dim lcntID As Long, lposCnt As Long\n\nSet WB = ThisWorkbook\nSet WS = WB.Worksheets(\"sheet1\")\nWith WS\n    Set rID = .Range(.Cells(3, 1), .Cells(.Rows.Count, 1).End(xlUp)) 'alter as needed\nEnd With\n\nFor Each C In rID\n    Set D = C.Offset(0, 1) 'remove offset to overwrite\n    lcntID = WorksheetFunction.CountIf(rID, C.Value2)\n    If lcntID &gt; 15 Then\n        Set D = C.Offset(0, 1) 'remove offset to overwrite\n        lposCnt = WorksheetFunction.CountIf(Range(rID(1, 1), C), C)\n        D = C.Value2 &amp; Chr((lposCnt - 1) \\ 15 + 97)\n    Else\n        D = C.Value2\n    End If\nNext C\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12120322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163012aac57df707a94d350d4b47d03d?s=128&d=identicon&r=PG&f=1", "display_name": "TArevalo", "link": "https://stackoverflow.com/users/12120322/tarevalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 58108483, "answer_count": 1, "score": 0, "last_activity_date": 1569462209, "creation_date": 1569429779, "last_edit_date": 1569431560, "question_id": 58103032, "link": "https://stackoverflow.com/questions/58103032/excel-macro-to-add-a-character-to-duplicate-values-after-the-value-exceeds-15-in", "title": "Excel Macro to add a character to duplicate values after the value exceeds 15 instances", "body": "<p>Currently operating in excel 2010</p>\n\n<p>I am in the process of building a macro to format various reports so that the excel sheets can be input into an auto-load tool. This macro adds a unique number identifier to each case and then breaks cases into multiple lines depending on the amount of services being performed. So initially cases will be numbered in column A as 1,2,3,4,ect. Then the cases are split into multiple rows based on the number of services and the number in column A is used to group the services. So if case one has 3 services, case two has 1 service, and case three has 5 services, column A would look like 1,1,1,2,3,3,3,3,3 descending. </p>\n\n<p>The auto-load tool only builds 15 lines per case. So I need to add code that will search column A and if a duplicate value exceeds 15 instances, add an \"a\" to the first 15 instances, a \"b\" to the second 15 instances, a \"c\" to the third 15 instances, and so on. </p>\n\n<p>example:</p>\n\n<p>In column A desending: if identifier looks like 1,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4\nThen macro would update column A to look like this: 1,2,3a,3a,3a,3a,3a,3a,3a,3a,3a,3a,3a,3a,3a,3a,3a,3b,3b,4</p>\n\n<p>Thanks for your time</p>\n\n<p>This is the code I have worked out so far:</p>\n\n<pre><code>Sub Scrub_File()      \nDim ws As Worksheet\nSet ws = Worksheets(\"Sheet1\")\n    range(\"A2\").Select\n    ActiveCell.FormulaR1C1 = \"1\"\n       LastRow = range(\"K\" &amp; Rows.Count).End(xlUp).Row\n        range(\"A2\").AutoFill Destination:=range(\"A2:A\" &amp; LastRow),   Type:=xlFillSeries\nDim InxSplit As Long\n  Dim SplitCell() As String\n  Dim RowCrnt As Long\n  With Worksheets(\"Sheet1\")\n    RowCrnt = 2         ' The first row containing data.\n    Do While True\n      If .Cells(RowCrnt, \"AI\").Value = \"End\" Then\n        Exit Do\n      End If\n      SplitCell = Split(.Cells(RowCrnt, \"AI\").Value, \",\")\n      If UBound(SplitCell) &gt; 0 Then\n        .Cells(RowCrnt, \"AI\").Value = SplitCell(0)\n        For InxSplit = 1 To UBound(SplitCell)\n          RowCrnt = RowCrnt + 1\n          .Cells(RowCrnt, \"AI\").Value = SplitCell(InxSplit)\n        .range(.Cells(RowCrnt, \"A\"), .Cells(RowCrnt, \"AH\")).Value = .range(.Cells(RowCrnt - 1, \"A\"), .Cells(RowCrnt - 1, \"AH\")).Value\n        .range(.Cells(RowCrnt, \"AL\"), .Cells(RowCrnt, \"AX\")).Value = .range(.Cells(RowCrnt - 1, \"AL\"), .Cells(RowCrnt - 1, \"AX\")).Value\n        Next\n        End If\n      RowCrnt = RowCrnt + 1\n    Loop\n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "printing"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1569442399, "post_id": 58102915, "comment_id": 102602656, "body": "Why is the string &quot;&amp;P&quot; within the Format function?  Is the TitleData supposed to be a date?"}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1569507714, "post_id": 58102915, "comment_id": 102626753, "body": "@mooseman yes sure it&#39;s a date and I hope to add the &amp;P, suppose that the TitleData are 01/01/2019 into 1th page TitleData +&amp;P will be 02/01/2019, the tird page will be 04/01/2019, off course this is not the correct way (if it&#39;s really possible to do) I just ask you how I&#39;ve to do"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1569860578, "post_id": 58102915, "comment_id": 102724517, "body": "Then I believe the &amp;P  will go at the end of that line.  Format(TitleData , &quot;dd-mmm&quot;) + &quot;&amp;P&quot;"}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1570025795, "post_id": 58102915, "comment_id": 102784840, "body": "@mooseman no, I tried .CenterHeader = &quot;&amp;C Elenco servizi del &quot; &amp; Format(TitleData, &quot;dd-mmm&quot;) + &quot;&amp;P&quot; and the result was 02-oct1, 02-oct3, 02-oct4, 02-oct5,.... so I tried  CenterHeader = &quot;&amp;C Elenco servizi del &quot; &amp; DateAdd(&quot;d&quot;, &quot;&amp;P&quot;, Format(TitleData, &quot;dd-mmm&quot;)) but run-time &#39;13&#39; error show. I think that the P value will be valorized just when the page were printed, and not one minute before  to use it as integer."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1570048234, "post_id": 58102915, "comment_id": 102795741, "body": "Is P a variable with a value?  putting it in quotes makes it look like you want the results to be 02-oct&amp;P.  The plus sign and the ampersand are both used for concatenation."}, {"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1570086843, "post_id": 58102915, "comment_id": 102804532, "body": "@mooseman  &amp;P are the VBA code in ActiveSheet.PageSetup that return &quot;Prints the page number.&quot;, my goal will be to convert &amp;P as integer to add at my date. Then, for each page printed, the Header will be different, each page the following day"}], "answers": [{"comments": [{"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1570877366, "post_id": 58330517, "comment_id": 103060477, "body": "as I wrote in the header of this tread, I&#39;ve ONE sheet. in this sheet I&#39;ve many records then when I print this sheet, the printer outpout are 4-5-xx pages. Right, I want to customize the Header of each page printed. The standard parameters to retreive the &quot;corrente&quot; page printed are &amp;P, I ask you if exist some way to use the &amp;P counter as parameter to add it at my variable. I think that aren&#39;t possible. Then I added one loop in my page that, for each break page insert one row and I put into my variable, then when I print this are the 1th row in each page."}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1570738690, "creation_date": 1570738690, "answer_id": 58330517, "question_id": 58102915, "link": "https://stackoverflow.com/questions/58102915/set-excel-pagesetup-centerheader-with-variable-counter/58330517#58330517", "title": "Set Excel PageSetup.CenterHeader with variable/counter", "body": "<p>I wrote this to show you how to increment the date by 1 day.   If you need to increment the month, just change the \"d\", to \"m\" in the Dateadd function</p>\n\n<p>This will do it for each sheet in the workbook the x is increased for each new sheet.\nYou could do this with sh.index in stead of the x variable.</p>\n\n<p>I hope this helps some to show you what is possible.</p>\n\n<pre><code>Sub Day_increase_header()\nx = 0\nFor Each sh In Sheets\n\nWith sh.PageSetup\nTitleData = Date\n    .CenterHeader = \"&amp;C Elenco servizi del \" &amp; Format(DateAdd(\"d\", x, TitleData), \"dd-mmm\")\n    .Orientation = xlLandscape\n    '.PrintArea = rgn.Address\n    .PrintTitleRows = ActiveSheet.Rows(1).Address\n    .Zoom = False\n    .FitToPagesTall = False\n    .FitToPagesWide = False\nEnd With\nx = x + 1\nNext sh\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570738690, "creation_date": 1569429284, "last_edit_date": 1569507357, "question_id": 58102915, "link": "https://stackoverflow.com/questions/58102915/set-excel-pagesetup-centerheader-with-variable-counter", "title": "Set Excel PageSetup.CenterHeader with variable/counter", "body": "<p>In my xlsx file I've one page with this fields Date, Time, Carrier, Destination, ordered by date/time\nEach time that che date change I insert HPageBreaks</p>\n\n<p>How I can print the center title with the correct data ?\nI tried 1K way without rigth, the last are to set one variable with the first day into my Printarea.range minus one day, then the title will be the variable data plus the page number, obviously it doesn't work.\nare possible to do what I thought''\nany suggestion??</p>\n\n<pre><code>Titledata = 1th date to print - 1\nWith ActiveSheet.PageSetup\nTitleData = TitleData + 1\n    .CenterHeader = \"&amp;C Elenco servizi del \" &amp; Format(TitleData + \"&amp;P\", \"dd-mmm\")\n    .Orientation = xlLandscape\n    .PrintArea = rgn.Address\n    .PrintTitleRows = ActiveSheet.Rows(1).Address\n    .Zoom = False\n    .FitToPagesTall = False\n    .FitToPagesWide = False\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 12122032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vRyyNjKsKXo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHwB4CDoLiZ2qOYCoSxlpO71npag/photo.jpg?sz=128", "display_name": "Connor Lee", "link": "https://stackoverflow.com/users/12122032/connor-lee"}, "is_accepted": true, "score": 3, "last_activity_date": 1569460418, "creation_date": 1569460418, "answer_id": 58108300, "question_id": 58102862, "link": "https://stackoverflow.com/questions/58102862/changing-part-of-a-workbook-name-and-saving-file-as-new-name/58108300#58108300", "title": "Changing part of a workbook name and saving file as new name", "body": "<p>You will need to split the file name further.</p>\n\n<p>Your instinct of splitting at the \".\" to get rid of the file extension was good. The next steps are as follows:</p>\n\n<p>1) Extract the title, in this case the \"Device Language AS\" which can be done as follows</p>\n\n<pre><code>Title = Right(Str1, Len(Str1) - InStr(Str1, \" \"))\n</code></pre>\n\n<p>2) Extract the number of the last file, the \"2\" which can be done as follows</p>\n\n<pre><code>LastNum = Right(Left(Str1, Len(Str1) - Len(Title) - 1), Len(Str1) - Len(Title) - 14)\n</code></pre>\n\n<p>3) Extract the shortened version of the string which can be done as follows</p>\n\n<pre><code>ShortName = Left(Str1, 13)\n</code></pre>\n\n<p>After these steps your if statement for splitting at the \".\" should look like this:</p>\n\n<pre><code>If InStr(filename, \".\") &gt; 0 Then\nStr1 = Left(filename, InStr(filename, \".\") - 1)\nTitle = Right(Str1, Len(Str1) - InStr(Str1, \" \"))\nLastNum = Right(Left(Str1, Len(Str1) - Len(Title) - 1), Len(Str1) - Len(Title) - 14)\nShortName = Left(Str1, 13)\nEnd If\n</code></pre>\n\n<p>From this point you just need to increment the previous \"-YY\" number to the new one, then you can use your existing code to concatenate all the parts together to save the file with the new name which can be done as follows.</p>\n\n<pre><code>LastNum = CStr(CInt(LastNum) + 1)\nSheets(\"Sheet1\").Copy\nActiveWorkbook.SaveAs filename:= _\nfilepath &amp; ShortName &amp; LastNum &amp; \" \" &amp; Title &amp; \".xlsx\"\n\nActiveWindow.Close\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 9090711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcfa527b85ae4b11dc82abb5ed0f99d?s=128&d=identicon&r=PG&f=1", "display_name": "vbAmateur", "link": "https://stackoverflow.com/users/9090711/vbamateur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58108300, "answer_count": 1, "score": 2, "last_activity_date": 1581566060, "creation_date": 1569429055, "last_edit_date": 1581566060, "question_id": 58102862, "link": "https://stackoverflow.com/questions/58102862/changing-part-of-a-workbook-name-and-saving-file-as-new-name", "title": "Changing part of a workbook name and saving file as new name", "body": "<p>I am trying to change a filename (YY number) before saving the workbook as a new file. Every filename has the format: \"HXXX-XXX-XXX-YY Example Title\" </p>\n\n<p>YY is any number starting from 0 to infinity, where the YY always starts 14 characters into the string.</p>\n\n<p>Is there any way to take the original filename (attempted in the code), change the YY number to the next consecutive number then SaveAs with the \"new\" file name?</p>\n\n<p>Example:<br>\nTitle Before: H019-018-072-2 Device Language AS<br>\nExpected Result: H019-018-072-3 Device Language AS</p>\n\n<p>My code is partly there, but would I need to split the string?</p>\n\n<pre><code>Sub SaveAsNewFile1()\nDim filepath As String\nDim filename As String\nDim filepatharch As String\nDim filelist As String\nDim filedate As String\nDim filecount As Integer\n\n'Set where to save and the file naming convention\nfilepath = \"H:\\BoM Drafts Macro\\\"\nfilename = ActiveWorkbook.Name\n\nIf InStr(filename, \".\") &gt; 0 Then\n    Str1 = Left(filename, InStr(filename, \".\") - 1)\nEnd If\n\nWith CreateObject(\"Scripting.FileSystemObject\")\n    Debug.Print Mid$(.GetBaseName(Str1), 13)\nEnd With\n\n'\"HXXX-XXX-XXX-..\" &amp; rest of name\nfilepatharch = \"H:\\BoM Drafts Macro\\\"\n\n'Do While Len(Dir(filepatharch &amp; filename)) &lt;&gt; 0\n    'filecount = filecount + 1\n    'hfilename = \"STR1\" &amp; filename\n'Loop\n\nSheets(\"Sheet1\").Copy\nActiveWorkbook.SaveAs filename:= _\n    \"H:\\BoM Drafts Macro\\\" &amp; hfilename &amp; \".xlsx\"\n\nActiveWindow.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1569430554, "post_id": 58102706, "comment_id": 102597724, "body": "Welcome to SO! It is a pitty that your first question here is not really a good fit for SO, as it is very subjective, and potentially attracts opinionated answers. I can only suggest a third option, actually a variation on your second one. You can use linking / embedding instead of VBA to include selected parts from your Excel workbooks in a word document. As a work process I believe it is easier and more efficient than writing a one time VBA code for the same task."}, {"owner": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1569430734, "post_id": 58102706, "comment_id": 102597816, "body": "Btw, please, take <a href=\"http://stackoverflow.com/tour\"><b>The Tour</b></a> for a brief intro on Stack Overflow, and then read <a href=\"http://stackoverflow.com/help/asking\"><b>Asking</b></a> to learn what you can ask about and how to present your question."}, {"owner": {"reputation": 1, "user_id": 12120331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d99f7d46a27d459ccb8b0c0ab215b7?s=128&d=identicon&r=PG&f=1", "display_name": "PhiSa", "link": "https://stackoverflow.com/users/12120331/phisa"}, "reply_to_user": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1569442221, "post_id": 58102706, "comment_id": 102602579, "body": "hi Tom, many thanks for your response. Maybe I did not make it very clear in my initial post, but the sheet is for multi use in an organization, so it would not be an effort for a one time result"}], "owner": {"reputation": 1, "user_id": 12120331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5d99f7d46a27d459ccb8b0c0ab215b7?s=128&d=identicon&r=PG&f=1", "display_name": "PhiSa", "link": "https://stackoverflow.com/users/12120331/phisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569428413, "creation_date": 1569428413, "question_id": 58102706, "link": "https://stackoverflow.com/questions/58102706/printing-excel-workbook-without-white-space-between-sheets", "title": "Printing excel workbook without white space between sheets", "body": "<p>I am currently working to provide an extensive xls-based form, which is then to be filled by various users and submitted to a committee deciding about the files.</p>\n\n<p>The form will need to be printed for this last step, and as some sheets are limited to a couple lines only and others could flow over to a 2nd or 3rd page depending on free text user input, I see the risk of having a lot of white space in the printouts (e.g. three quarters empty pages).</p>\n\n<p>I have considered/am considering some ideas to get this done:</p>\n\n<p>Moving all individual sheets to one sheet, which is then printed more conveniently - probably not a good idea because of the variety of needed column widths making it impossible to properly format anything</p>\n\n<p>Possibly coding in VBA to copy the individual sheets (by print areas) to a word doc, which is then printed easily - I know basic VBA, but would definitely need guidance as to how this could be achieved</p>\n\n<p>Does anyone on here have other ideas or guidance on the ones posed above?</p>\n\n<p>Many thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1569427815, "post_id": 58102451, "comment_id": 102596529, "body": "Better to pass the full path to <code>Dir</code>  i.e.  <code>Dir(strPath &amp; &quot;*.xlsx&quot;)</code>"}, {"owner": {"reputation": 69, "user_id": 12120097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e39a49e83a3832cf5959a00a8e6b4928?s=128&d=identicon&r=PG&f=1", "display_name": "Forkinator9000", "link": "https://stackoverflow.com/users/12120097/forkinator9000"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569428945, "post_id": 58102451, "comment_id": 102596990, "body": "That did the trick. Thanks! <code>Dir(&quot;*.xls*&quot;)</code> is now <code>Dir(strPath &amp; &quot;*.xls*&quot;)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569433969, "post_id": 58102451, "comment_id": 102599184, "body": "<code>ChDir</code> is not always reliable, particularly if you have multiple drives"}, {"owner": {"reputation": 69, "user_id": 12120097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e39a49e83a3832cf5959a00a8e6b4928?s=128&d=identicon&r=PG&f=1", "display_name": "Forkinator9000", "link": "https://stackoverflow.com/users/12120097/forkinator9000"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569434542, "post_id": 58102451, "comment_id": 102599440, "body": "It seems to be working for both my C: and H: drives. Hopefully it continues to work for different drives."}], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 12120097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e39a49e83a3832cf5959a00a8e6b4928?s=128&d=identicon&r=PG&f=1", "display_name": "Forkinator9000", "link": "https://stackoverflow.com/users/12120097/forkinator9000"}, "is_accepted": true, "score": 0, "last_activity_date": 1569437584, "creation_date": 1569437584, "answer_id": 58104877, "question_id": 58102451, "link": "https://stackoverflow.com/questions/58102451/getting-a-run-time-error-1004-for-my-vba-copy-and-paste-macro/58104877#58104877", "title": "Getting a &quot;Run-time Error &#39;1004&#39;&quot; for my VBA copy and paste macro", "body": "<p>I have figured out what the issue was with the help of another individual who has commented above. A working solution is to replace <code>strExtension = Dir(\"*.xls*\")</code> with <code>strExtension = Dir(strPath &amp; \"*.xls*\")</code>.  </p>\n"}], "owner": {"reputation": 69, "user_id": 12120097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e39a49e83a3832cf5959a00a8e6b4928?s=128&d=identicon&r=PG&f=1", "display_name": "Forkinator9000", "link": "https://stackoverflow.com/users/12120097/forkinator9000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 58104877, "answer_count": 1, "score": 1, "last_activity_date": 1569564256, "creation_date": 1569427359, "last_edit_date": 1569564256, "question_id": 58102451, "link": "https://stackoverflow.com/questions/58102451/getting-a-run-time-error-1004-for-my-vba-copy-and-paste-macro", "title": "Getting a &quot;Run-time Error &#39;1004&#39;&quot; for my VBA copy and paste macro", "body": "<p>The Run-time Error  '1004' I am receiving shows up in the \"SetwkbSource\" line just after the \"Do While\" line (noted in code).</p>\n\n<p><strong>Here is an exact quote of the error:</strong> </p>\n\n<p>\"Rune-time error '1004':</p>\n\n<p>Sorry, we couldn't find\nC:\\Users\\NG\\Desktop\\CopyPaste\\file.xlsm.\nIs it possible it was moved, renamed or deleted?\"</p>\n\n<p><em>(The file.xlsm is a placeholder for another file outside of the CopyPaste folder I specified)</em></p>\n\n<pre><code>Sub CopyRange()\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Dim wkbDest As Workbook\n    Dim wkbSource As Workbook\n    Set wkbDest = ThisWorkbook\n    Dim LastRow As Long\n    Const strPath As String = \"C:\\Users\\NG\\Desktop\\CopyPaste\\\"\n    ChDir strPath\n    strExtension = Dir(\"*.xls*\")\n    Do While strExtension &lt;&gt; \"\"\n        ***'Error in the line below***\n        Set wkbSource = Workbooks.Open(strPath &amp; strExtension)\n        With wkbSource\n            LastRow = .Sheets(\"Sheet1\").Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n            .Sheets(\"Sheet1\").Range(\"A1:F\" &amp; LastRow).Copy wkbDest.Sheets(\"Zone\").Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n            .Close savechanges:=False\n        End With\n        strExtension = Dir\n    Loop\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1569427424, "post_id": 58102413, "comment_id": 102596361, "body": "Is it always three down and one to the right?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1569427778, "post_id": 58102413, "comment_id": 102596514, "body": "Drawing lines with pixels is a well-studied problem which is trickier than it first appears. Using large pixels (which you are in effect doing) makes the problem more visible but doesn&#39;t really alter it. See: <a href=\"https://en.wikipedia.org/wiki/Line_drawing_algorithm\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Line_drawing_algorithm</a>"}, {"owner": {"reputation": 29, "user_id": 11836601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DxCEgp9nAi0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re7xLGHGVtYKGjZUKU67L4HEfNmgQ/photo.jpg?sz=128", "display_name": "Sniper_of_Chess", "link": "https://stackoverflow.com/users/11836601/sniper-of-chess"}, "edited": false, "score": 0, "creation_date": 1569428528, "post_id": 58102413, "comment_id": 102596810, "body": "Hmm,  yeah, this is it. I will study some methods to do this task. Thanks for link :)"}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 12115705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/212fcc8f65c69364884219b75152c6d6?s=128&d=identicon&r=PG&f=1", "display_name": "shade", "link": "https://stackoverflow.com/users/12115705/shade"}, "is_accepted": true, "score": 1, "last_activity_date": 1569496655, "creation_date": 1569496655, "answer_id": 58115658, "question_id": 58102413, "link": "https://stackoverflow.com/questions/58102413/fill-cells-between-2-cells/58115658#58115658", "title": "Fill cells between 2 cells", "body": "<p>You can find intersection points as on image\n(<a href=\"https://i.stack.imgur.com/Qz5G8.png\" rel=\"nofollow noreferrer\">img1</a>), round them. Those are your cells coordinate to fill in color\nOr even better: you can find intersection of each cells boundaries (<a href=\"https://i.stack.imgur.com/9Bxs9.png\" rel=\"nofollow noreferrer\">img2</a>) and play with fraction value (<a href=\"https://i.stack.imgur.com/H1GaP.png\" rel=\"nofollow noreferrer\">img3</a>) to get intensity of pixel\nHere is what achieved: <a href=\"https://i.stack.imgur.com/jfUBl.png\" rel=\"nofollow noreferrer\">img4</a></p>\n"}], "owner": {"reputation": 29, "user_id": 11836601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DxCEgp9nAi0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re7xLGHGVtYKGjZUKU67L4HEfNmgQ/photo.jpg?sz=128", "display_name": "Sniper_of_Chess", "link": "https://stackoverflow.com/users/11836601/sniper-of-chess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 58115658, "answer_count": 1, "score": 1, "last_activity_date": 1569564245, "creation_date": 1569427240, "last_edit_date": 1569564245, "question_id": 58102413, "link": "https://stackoverflow.com/questions/58102413/fill-cells-between-2-cells", "title": "Fill cells between 2 cells", "body": "<p>I have some problem which is grinding my gears for some time now.\nDescription is really simple. I would like to \"draw cells line\" between two cells (which are somehow marked). Like you mark 2 cells, then click button and it creates line with filled cells between these two points.</p>\n\n<p><img src=\"https://i.stack.imgur.com/bvgQm.png\" alt=\"Something like this\"></p>\n\n<p>I still cant figure out how to fill every cell between these two points. I had some mathematical ideas but couldn't get them in code to work properly.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim i As Integer, j As Integer, k As Integer, l As Integer\n\nDim cred As Long\nDim cgreen As Long\nDim startx As Integer\nDim starty As Integer\nDim endx As Integer\nDim endy As Integer\nDim koef As Single\nDim arr(1 To 20, 1 To 20) As Boolean\nDim st As Integer\n\ncgreen = Range(\"X5\").Interior.Color\ncred = Range(\"X6\").Interior.Color\n\n'Start and End\nFor i = 1 To 20\n    For j = 1 To 20\n        If Cells(i, j).Interior.Color = cred Then\n            endx = j\n            endy = -i\n        ElseIf Cells(i, j).Interior.Color = cgreen Then\n            startx = j\n            starty = -i\n        End If\n    Next j\nNext i\n\nkoef = (endy - starty) / (endx - startx)\nIf starty &lt; endy Then\n    st = 1\nElse\n    st = -1\nEnd If\n\n\nFor i = startx To endx\n    For k = starty To endy Step st\n    l = -k / koef\n    j = starty + koef * (i - startx)\n    l = starty + koef * (i + 1 - startx)\n    If k &gt;= j Then\n    arr(i, -j) = True\n    End If\n    Next k\nNext i\n\nFor i = 1 To 20\n    For j = 1 To 20\n        If arr(j, i) = True Then\n            Cells(i, j).Interior.Color = RGB(255, 255, 0)\n        End If\n    Next j\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 1, "creation_date": 1569427007, "post_id": 58102186, "comment_id": 102596164, "body": "Have you tried to <code>debug.print(i)</code> to check that it really is not looping? If it is looping, I&#39;d check to see if there is data that you expect in <code>att</code>, <code>em1</code>, and <code>em2</code> - since you have <code>On Error Resume Next</code> the function will just skip ahead in case of error."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1569427067, "post_id": 58102186, "comment_id": 102596195, "body": "You&#39;re creating a new mailitem for each person in your list, but you&#39;re only working with 1 email you created at the beginning, outside of the loop?  Also, take out the <code>on error resume next</code> and build logic to avoid known issues."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1569427127, "post_id": 58102186, "comment_id": 102596217, "body": "Remove the last 3 lines of your For loop."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1569427413, "post_id": 58102186, "comment_id": 102596354, "body": "@SJR good catch... the loop itself <code>for i = start to end</code> will iterate itself, so adding <code>i = i+1</code> will skip every other person in the loop."}, {"owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1569492873, "post_id": 58102186, "comment_id": 102618412, "body": "Hi Can anyone figure out the logic for if the attachment is not there to skip it instead of sending an email with no attachement?"}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1569427436, "post_id": 58102416, "comment_id": 102596370, "body": "@Leighholling look at SJR&#39;s comment and my explanation on the main post.  Will be significant."}, {"owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1569427523, "post_id": 58102416, "comment_id": 102596411, "body": "i have done this still didnt work, but this and the soloution above is the correct answer"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "edited": false, "score": 0, "creation_date": 1569429221, "post_id": 58102416, "comment_id": 102597126, "body": "@Leighholling sorry; that was meant as an additional change, not in lieu of my solution."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 3, "last_activity_date": 1569427256, "creation_date": 1569427256, "answer_id": 58102416, "question_id": 58102186, "link": "https://stackoverflow.com/questions/58102186/vba-loop-to-go-down-a-distribution-list-and-send-the-correct-attachment/58102416#58102416", "title": "VBA loop to go down a distribution list and send the correct attachment", "body": "<p>I believe you're trying to make a new email for each person in the loop... </p>\n\n<pre><code>Sub Send_Emails()\n\n    Dim OutApp As Object: Set OutApp = CreateObject(\"Outlook.Application\")\n    Dim OutMail As Object 'REMOVED SET FROM HERE\n    Dim r As Range\n    Dim rCell As Range\n    Dim path As String\n    Dim rows As Integer\n\n    Set r = ActiveWorkbook.Sheets(\"Distribution List\").UsedRange\n\n    'Row = Sheets(\"Distribution List\").rows.count   \n\n     'Send Email  \n\n    For i = 2 To 20\n        Set OutMail = OutApp.CreateItem(0) 'MOVED TO CREATE NEW MAILITEM FOR EACH LOOP\n        With OutMail   \n            'OTHER CODE\n</code></pre>\n"}], "owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 58102416, "answer_count": 1, "score": 0, "last_activity_date": 1569492795, "creation_date": 1569426422, "last_edit_date": 1569492795, "question_id": 58102186, "link": "https://stackoverflow.com/questions/58102186/vba-loop-to-go-down-a-distribution-list-and-send-the-correct-attachment", "title": "VBA loop to go down a distribution list and send the correct attachment", "body": "<p>I am sure this is something simple the code below works for the first entry in the list but does not loop, I literally cannot figure this out</p>\n\n<p>Can anyone shed any light on correcting this loop, please?</p>\n\n<p>I have tried moving the loop inside the 'With OutMail' section, I have tried a do while loop.</p>\n\n<pre><code>Sub Send_Emails()\n\n    Dim OutApp As Object: Set OutApp = CreateObject(\"Outlook.Application\")\n    Dim OutMail As Object: Set OutMail = OutApp.CreateItem(0)\n    Dim r As Range\n    Dim rCell As Range\n    Dim path As String\n    Dim rows As Integer\n\n    Set r = ActiveWorkbook.Sheets(\"Distribution List\").UsedRange\n\n    'Row = Sheets(\"Distribution List\").rows.count   \n\n     'Send Email  \n\n    For i = 2 To 20\n    With OutMail   \n      att = r(i, 2).Value\n      em1 = r(i, 3).Value\n      em2 = r(i, 4).Value\n      path = \"\\\\azfs\\YFHPublic\\Farms Project\\Holds By Area\\Holds by Area\" &amp; \"\\\" &amp; att\n\n     On Error Resume Next:\n       .SentOnBehalfOfName = \"email@email.com\"\n       .To = em1\n       .Subject = \"invoices on hold\"\n       .Body = \"this is a test\"\n       .Attachments.Add path\n\n       .Display\n       .Send\n        End With\n\n        OutMail = Nothing\n        OutApp = Nothing\n\n        i = i + 1     \n    Next i\n\n     '  OutMail = Nothing\n     '   OutApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1569426291, "post_id": 58101908, "comment_id": 102595825, "body": "You can&#39;t have the same variable name in both sets of code as the memory is already allocated for that specific variable name; your call for the macro <code>AddFileToDC</code> needs to have the dimensioning/setting removed for that variable being dimensioned/set in <code>Code1</code>.  You will most likely need to dimension the variable globally so both subroutines can utilize it."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 1, "last_activity_date": 1569426448, "creation_date": 1569426448, "answer_id": 58102195, "question_id": 58101908, "link": "https://stackoverflow.com/questions/58101908/implement-subroutine-for-repeating-code-in-macro/58102195#58102195", "title": "Implement subroutine for repeating code in macro", "body": "<p>Making your like-named variable a global variable, while removing the setting/dimensioning from the called macro after you have set the variable:</p>\n\n<pre><code>Public oObjectSearchResults As MFilesAPI.ObjectSearchResults\n\nSub Code1()\n\n        ' Execute the search\n        Set oObjectSearchResults = oVault.ObjectSearchOperations.SearchForObjectsByConditions(oSearchConditions, MFSearchFlagNone, False)\n\n    AddFileToDC\n\nEnd Sub\n\nSub AddFileToDC()\n\n    ' Get a reference to the existing document collection\n    Set oDocumentCollectionOVAP = oVault.ObjectOperations.GetObjectVersionAndProperties(oDCObjectSearchResults.Item(1).ObjVer)\n\n    Set oOldDocumentOVAP = oVault.ObjectOperations.GetObjectVersionAndProperties(oObjectSearchResults.Item(1).ObjVer)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 58102195, "answer_count": 1, "score": 0, "last_activity_date": 1569426448, "creation_date": 1569425414, "question_id": 58101908, "link": "https://stackoverflow.com/questions/58101908/implement-subroutine-for-repeating-code-in-macro", "title": "Implement subroutine for repeating code in macro", "body": "<p>I am wondering is there any way to shorten my current code. I am running one process in a lot of my macros and was thinking about subroutine. I have tried several approaches but can't get it work.</p>\n\n<p>I am performing one search several times:</p>\n\n<pre><code>Sub AddFileToDC()\n\n    '... I am getting oDCSearchConditions from the search, then\n\n    ' Execute the search\n    Dim oDCObjectSearchResults As MFilesAPI.ObjectSearchResults\n    Set oDCObjectSearchResults = oVault.ObjectSearchOperations.SearchForObjectsByConditions(oDCSearchConditions, MFSearchFlagNone, False)\n\n    ' Get a reference to the existing document collection\n    Set oDocumentCollectionOVAP = oVault.ObjectOperations.GetObjectVersionAndProperties(oDCObjectSearchResults.Item(1).ObjVer)\n\n    Set oOldDocumentOVAP = oVault.ObjectOperations.GetObjectVersionAndProperties(oObjectSearchResults.Item(1).ObjVer)\n\nEnd Sub\n</code></pre>\n\n<p>In all other macros I am performing another search from where I get <code>oObjectSearchResults</code>.</p>\n\n<p>Instead of copying code above to all my macros, is it possible to do something like:</p>\n\n<pre><code>Sub Code1()\n\n    '... I am getting oSearchConditions from the search, then\n\n        ' Execute the search\n        Dim oObjectSearchResults As MFilesAPI.ObjectSearchResults\n        Set oObjectSearchResults = oVault.ObjectSearchOperations.SearchForObjectsByConditions(oSearchConditions, MFSearchFlagNone, False)\n\n    AddFileToDC\n\nEnd Sub\n</code></pre>\n\n<p>Now while running <code>Code1</code> I am getting error message saying variable <code>oDCObjectSearchResults</code> not defined as it is in another sub <code>AddFileToDC</code>...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1569426469, "post_id": 58101873, "comment_id": 102595922, "body": "<code>Workbooks(&quot;V_TAUX.xlsx&quot;).Sheets(1).Range(&quot;A2:232&quot;)</code> - should that read <code>&quot;A2:A32&quot;</code> instead?  Or <code>&quot;A2:A232&quot;</code>?  Is that error in the actual code, or just in the question?  (Also, you might want to put the VLOOKUP into a <code>Variant</code> first, so you can test if it <code>IsError</code>, when <code>ActiveSheet.Cells(i,Lcol-4).Value</code> is not in <code>Workbooks(&quot;V_TAUX.xlsx&quot;).Sheets(1).Columns(&quot;A&quot;)</code>)"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1569426694, "post_id": 58101873, "comment_id": 102596013, "body": "Also, <code>VLOOKUP</code> seems a very inefficient way to do this - have you considered <code>If WorksheetFunction.CountIf(Workbooks(&quot;V_TAUX.xlsx&quot;).Sheets(1)&zwnj;&#8203;.Range(&quot;A2:A32&quot;), Cells(i,Lcol-4)) &gt; 0 Then</code> instead?"}], "answers": [{"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": false, "score": 0, "last_activity_date": 1569447331, "last_edit_date": 1569447331, "creation_date": 1569446900, "answer_id": 58106761, "question_id": 58101873, "link": "https://stackoverflow.com/questions/58101873/how-to-fix-the-error-type-13-on-my-vlookup/58106761#58106761", "title": "How to fix the Error type 13 on my VLOOKUP?", "body": "<p><code>Cells(i,Lcol-4)</code> or the equivalent <code>Cells(i,Lcol-4).Value</code> returns a Date type value, whereas the dates listed in your worksheet are actually serial numbers formatted as dates.</p>\n\n<p>As a result, VLookup won't be able to return a match.  And, since you've qualified your reference with Application, instead of WorksheetFunction, it returns a non-breaking error.</p>\n\n<p>However, since the error returned by VLookup is being compared with the value in <code>Cells(i,Lcol-4)</code>, you'll get a type mismatch breaking error.</p>\n\n<p>So, first I would suggest that you convert your lookup value to a Long data type...</p>\n\n<pre><code> Application.Vlookup(CLng(Cells(i,Lcol-4).Value), . . .\n</code></pre>\n\n<p>Then, as already suggested by Chronocidal, assign the return value to a Variant so that you can use IsError to check for an error...</p>\n\n<pre><code>Dim matchVal As Variant\n\nmatchVal = Application.VLookup(CLng(Cells(i, Lcol - 4).Value), Workbooks(\"V_TAUX.xlsx\").Sheets(1).Range(\"A2:A232\"), 1, False)\n\nIf Not IsError(matchVal) Then\n    'etc\n    '\n    '\nEnd If\n</code></pre>\n\n<p>Although, since you're simply checking for a match, you can use Application.Match instead...</p>\n\n<pre><code>Dim matchVal As Variant\n\nmatchVal = Application.Match(CLng(Cells(i, Lcol - 4).Value), Workbooks(\"V_TAUX.xlsx\").Sheets(1).Range(\"A2:A232\"), 0)\n\nIf Not IsError(matchVal) Then\n    'etc\n    '\n    '\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12120007, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-F8ls_J6z178/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rctIF9AF9sHPDhq3Glhg7ldQJcB1Q/photo.jpg?sz=128", "display_name": "ScM ", "link": "https://stackoverflow.com/users/12120007/scm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569564235, "creation_date": 1569425287, "last_edit_date": 1569564235, "question_id": 58101873, "link": "https://stackoverflow.com/questions/58101873/how-to-fix-the-error-type-13-on-my-vlookup", "title": "How to fix the Error type 13 on my VLOOKUP?", "body": "<p>I Have This VBA code on Excel. When I execute it I have this error \"Erreur 13: Incompatibilit\u00e9 de type\".</p>\n\n<p>Vlookup is applying in between 2 workbooks.</p>\n\n<p><code>Range(\"A2:232\")</code> contains date type and <code>Cells(i,Lcol-4)</code> too</p>\n\n<p>Please Help.</p>\n\n<p>This is my code</p>\n\n<pre><code>    If Application.Vlookup(Cells(i,Lcol-4), Workbooks(\"V_TAUX.xlsx\").Sheets(1).Range(\"A2:232\"),1,False) = Cells(i,Lcol-4) Then\n        Instruction...\n        Instruction....\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 3, "creation_date": 1569423680, "post_id": 58101335, "comment_id": 102594307, "body": "I Think you might read <a href=\"https://stackoverflow.com/a/20016258/11167163\">this</a>, once you tried it if it still doesn&#39;t work please <a href=\"https://stackoverflow.com/posts/58101335/edit\">edit</a> your issue."}, {"owner": {"reputation": 477, "user_id": 4173159, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/71e04ea5b3feee9ed30ee45abb54a7f5?s=128&d=identicon&r=PG&f=1", "display_name": "Blingers", "link": "https://stackoverflow.com/users/4173159/blingers"}, "edited": false, "score": 0, "creation_date": 1569423698, "post_id": 58101335, "comment_id": 102594325, "body": "How are you populating the cells in code? Using cells(x,y)= value?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1569423940, "post_id": 58101335, "comment_id": 102594487, "body": "In the spirit of IT... <i>Have you tried turning it off and back on again?</i>  This would actually work for your code, to set <code>=false</code> at the start of your code, then <code>=true</code> as the last step in your code."}, {"owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "reply_to_user": {"reputation": 477, "user_id": 4173159, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/71e04ea5b3feee9ed30ee45abb54a7f5?s=128&d=identicon&r=PG&f=1", "display_name": "Blingers", "link": "https://stackoverflow.com/users/4173159/blingers"}, "edited": false, "score": 0, "creation_date": 1569424024, "post_id": 58101335, "comment_id": 102594522, "body": "@Blingers I use this : myRow.Offset(0, 1).FormulaArray = variableThatContainsFormulaString"}, {"owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1569424153, "post_id": 58101335, "comment_id": 102594594, "body": "@Cyril i will try"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1569460145, "post_id": 58101335, "comment_id": 102606894, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/125449/protecting-cells-in-excel-but-allow-these-to-be-modified-by-vba-script\">Protecting cells in Excel but allow these to be modified by VBA script</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1569426272, "post_id": 58101612, "comment_id": 102595807, "body": "Would be nice if you add your <a href=\"https://stackoverflow.com/a/126032/11167163\">source</a>"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1569427468, "post_id": 58101612, "comment_id": 102596386, "body": "@Dorian, my actual source is my code templates. On their turn some of them are by myself and some by &quot;external&quot; code. But I mostly do not keep track of them."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 2, "last_activity_date": 1569424357, "creation_date": 1569424357, "answer_id": 58101612, "question_id": 58101335, "link": "https://stackoverflow.com/questions/58101335/how-to-lock-specific-cells-in-vba-but-leave-them-editable-by-code/58101612#58101612", "title": "How to lock specific cells in VBA but leave them editable by code", "body": "<p><code>Protect</code> the sheet with <code>UserInterfaceOnly</code> parameter:</p>\n\n<pre><code>MyWorksheet.Protect \"Password\", UserInterfaceOnly := True\n</code></pre>\n\n<p>where <code>MyWorksheet</code> is a valid reference of your worksheet object</p>\n"}, {"tags": [], "owner": {"reputation": 477, "user_id": 4173159, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/71e04ea5b3feee9ed30ee45abb54a7f5?s=128&d=identicon&r=PG&f=1", "display_name": "Blingers", "link": "https://stackoverflow.com/users/4173159/blingers"}, "is_accepted": false, "score": 1, "last_activity_date": 1569424628, "creation_date": 1569424628, "answer_id": 58101694, "question_id": 58101335, "link": "https://stackoverflow.com/questions/58101335/how-to-lock-specific-cells-in-vba-but-leave-them-editable-by-code/58101694#58101694", "title": "How to lock specific cells in VBA but leave them editable by code", "body": "<p>Try</p>\n\n<pre><code>ActiveSheet.Unprotect\nmyRow.Offset(0, 1).FormulaArray = variableThatContainsFormulaString \nActiveSheet.Protect\n</code></pre>\n\n<p>Obvs prob better replacing active sheet with your actual sheet but you get the idea.</p>\n\n<p>Looks like this has the available solutions though... <a href=\"https://stackoverflow.com/questions/125449/protecting-cells-in-excel-but-allow-these-to-be-modified-by-vba-script?rq=1\">Protecting cells in Excel but allow these to be modified by VBA script</a> </p>\n"}], "owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 58101612, "answer_count": 2, "score": 0, "last_activity_date": 1569424628, "creation_date": 1569423505, "question_id": 58101335, "link": "https://stackoverflow.com/questions/58101335/how-to-lock-specific-cells-in-vba-but-leave-them-editable-by-code", "title": "How to lock specific cells in VBA but leave them editable by code", "body": "<p>I have some cells that are filled by some formula created in VBA script.\nI want to make them not-editable (locked) by user input but let the script fill them with formulas.</p>\n\n<p>I tried by protecting worksheet with a password and then :    </p>\n\n<pre><code>Range.locked = True\n</code></pre>\n\n<p>But this didn't allow the code to edit the  cells..</p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1569423255, "post_id": 58101223, "comment_id": 102594032, "body": "What is that line supposed to be doing? Assigning a range, a value or a row number to tmpriskid? Whatever it&#39;s supposed to be doing the syntax is off."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569423409, "post_id": 58101223, "comment_id": 102594124, "body": "<code>riskTbl.Rows(i)</code> perhaps instead of <code>riskTbl.Row</code> (which returns a row number), but then you can&#39;t use <code>Range(&quot;Ref No. ID&quot;)</code> to refer to the heading. I might use <code>.Cells</code> here instead of <code>.Rows</code>."}, {"owner": {"reputation": 3, "user_id": 12112109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7644308fce7e82e80e5a7164a2194e2a?s=128&d=identicon&r=PG&f=1", "display_name": "MAfs", "link": "https://stackoverflow.com/users/12112109/mafs"}, "edited": false, "score": 0, "creation_date": 1569423650, "post_id": 58101223, "comment_id": 102594285, "body": "Hi, thanks for your prompt response. The line is supposed to store a temporary value (in this case a cell from a Table) and if the condition is met I want it to paste it as followed after the If function."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1569423782, "post_id": 58101223, "comment_id": 102594380, "body": "But which cell and how does it relate to <code>irowrisk</code>? And where do you set the value of those 4 variables in the If line?"}, {"owner": {"reputation": 3, "user_id": 12112109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7644308fce7e82e80e5a7164a2194e2a?s=128&d=identicon&r=PG&f=1", "display_name": "MAfs", "link": "https://stackoverflow.com/users/12112109/mafs"}, "edited": false, "score": 0, "creation_date": 1569424503, "post_id": 58101223, "comment_id": 102594797, "body": "Apologies for my understanding, this is my first code I&#39;ve written so I&#39;m very noobish when it comes to writing code. BigBen - I tried riskTbl.Rows(i), I didn&#39;t get an error but nothing happened, no output. SJR - I guess it doesn&#39;t relate to irowrisk now that I think about it? I also haven&#39;t set values to the 4 variables - another problem"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1569425235, "post_id": 58101223, "comment_id": 102595226, "body": "Add <code>Option Explicit</code> to the to of the module. <a href=\"http://www.rubberduckvba.com/\" rel=\"nofollow noreferrer\">Rubberduck</a> is picking up 38 code quality issues in that procedure alone, including undeclared variables, unused variables, unassigned variables, variables used by never assigned, row numbers declared <code>As Integer</code>, an implicit <code>ActiveWorkbook</code> reference, ...this code needs a lot of love!"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1569433774, "creation_date": 1569433774, "answer_id": 58103995, "question_id": 58101223, "link": "https://stackoverflow.com/questions/58101223/run-time-error-424-object-required-unsure-what-ive-written-wrong-in-this-co/58103995#58103995", "title": "Run-time error &#39;424&#39; Object required - Unsure what I&#39;ve written wrong in this code?", "body": "<blockquote>\n<pre><code>Sheets(\"Geotechnical Risk Register\").Select\n</code></pre>\n</blockquote>\n\n<p>This is where problems begin. Where is this worksheet? If it's in <em>whatever workbook happens to be active</em>, then there's run-time error 9 \"subscript out of range\" waiting to remind you that <em>whatever workbook happens to be active</em> may not necessarily have a worksheet by that name.</p>\n\n<p>If the sheet is in the same workbook that hosts your VBA code, then you <em>don't</em> want \"whatever workbook is currently active\", but <code>ThisWorkbook</code> - this would already be better:</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Geotechnical Risk Register\").Select\n</code></pre>\n\n<p>But, you don't <em>need</em> to <code>.Select</code> anything. Consider:</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Geotechnical Risk Register\")\n</code></pre>\n\n<p>Much better: now we can make member calls against that specific sheet, and we <em>know</em> we're working against the right sheet.</p>\n\n<p>Except, if the sheet exists in <code>ThisWorkbook</code> at compile-time, then it's completely redundant.</p>\n\n<p>Select the sheet module in the VBE's <em>Project Explorer</em> toolwindow (Ctrl+R), then bring up its <em>properties</em> (F4). At the top of the properties list is a <code>(Name)</code> property that's currently probably something like <code>Sheet42</code> - change that to something more meaningful, say, <code>GeotechRiskRegisterSheet</code>. Now you have a global-scope (project-scope, actually) object variable named <code>GeotechRiskRegisterSheet</code> that you can use anywhere in your VBA project to refer to <em>that particular sheet</em>.</p>\n\n<p>The rest of this answer assumes you've done that. If the sheet isn't in <code>ThisWorkbook</code>, then stick to declaring a local <code>Worksheet</code> variable for it, and pulling the <code>Worksheet</code> object reference from the <code>Workbook.Worksheets</code> collection <em>of the workbook you mean to work with</em>.</p>\n\n<blockquote>\n<pre><code>Set assetTbl = Application.Range(\"M002_\")\n</code></pre>\n</blockquote>\n\n<p>That's assigning to a variable that appears to want to be a local variable, but isn't declared anywhere in the local scope. <code>Application.Range</code> is only slightly better than just <code>Range</code>, and only one level of indirection away from the most-explicit <code>ActiveSheet.Range</code> - but then again, you <em>don't</em> mean to work off <em>whatever the ActiveSheet is</em>, and while tables <em>do</em> defined named ranges and named ranges <em>can</em> be accessed with the <code>Range</code> property, this would be much clearer and absolutely unambiguous:</p>\n\n<pre><code>Dim assetTbl As ListObject\nSet assetTbl = GeotechRiskRegisterSheet.ListObjects(\"M002_\")\n</code></pre>\n\n<p>Same applies to the other two:</p>\n\n<blockquote>\n<pre><code>Set riskTbl = Application.Range(\"geotechRisks\") 'GRR\nSet compiledTbl = Application.Range(\"CompiledM002\") 'Output for M002\n</code></pre>\n</blockquote>\n\n<p>Go with:</p>\n\n<pre><code>Dim riskTbl As ListObject\nSet riskTbl = GeotechRisksSheet.ListObjects(\"geotechRisks\")\n\nDim compiledTbl As ListObject\nSet compiledTbl = CompiledSheet.ListObjects(\"CompiledM002\")\n</code></pre>\n\n<p>And then we start looping:</p>\n\n<blockquote>\n<pre><code>For iRowRisk = 1 To riskTbl.Rows.Count 'loop through risks\n</code></pre>\n</blockquote>\n\n<p>If <code>riskTbl</code> is just another <code>Range</code>, then that works. If <code>riskTbl</code> is a <code>ListObject</code>, we can do simpler &amp; faster:</p>\n\n<pre><code>Dim currentRow As ListRow\nFor Each currentRow In riskTbl.ListRows\n</code></pre>\n\n<p>And then we get to the run-time error you're asking about:</p>\n\n<blockquote>\n<pre><code>tmpRiskID = riskTbl.Row.Range(\"Ref No. ID\") 'Temporary risk as it gets overridden\n</code></pre>\n</blockquote>\n\n<p>That's error 424 \"object required\", because <code>riskTbl.Row</code> is a <code>Long</code> integer value: it doesn't have a <code>Range</code> member, so you can't do <code>Range.Row.Range</code> like this. If you're iterating a plain <code>Range</code> with that <code>For iRowRisk</code> loop, then you want that to look something like:</p>\n\n<pre><code>tmpRiskID = riskTbl.Cells(iRowRisk, 12).Value\n</code></pre>\n\n<p>Where <code>12</code> is a hard-coded column index referring to the \"Ref No. ID\" column. Not ideal, is it? Compare to leveraging the <code>ListObject</code> API:</p>\n\n<pre><code>Dim refIDColumn As Long\nrefIDColumn = riskTbl.ListColumns(\"Ref No. ID\").Index\n\ntmpRiskID = currentRow.Range.Cells(ColumnIndex:=refIDColumn).Value\n</code></pre>\n\n<p>If you define the <code>refIDColumn</code> variable outside the loop, every iteration can reuse its value, and as long as the header caption remains \"Ref No. ID\", the column can be anywhere the user wants it - whereas with a hard-coded column index, if the user inserts a new column, the code breaks.</p>\n\n<blockquote>\n<pre><code>    'if assets chainage match risk iRowRisk (4 conditions)\n    If (en &gt; c1 And en &lt; c2) Or (st &gt; c1 And en &lt; c2) Or (st &gt; c1 And st &lt; c2) Or (st &lt; c1 And en &gt; c2) Then\n</code></pre>\n</blockquote>\n\n<p>I'm hoping you have declared and assigned these variables in your actual code - otherwise this conditional expression can't be evaluated reliably, since none of these identifiers have a value. Consider using meaningful names that convey usage intent: <code>en</code>, <code>st</code>, <code>c1</code>, and <code>c2</code> mean absolutely nothing to anyone that isn't extremely familiar with the thought process of whoever wrote that code. In any case, make sure the top of the module says <code>Option Explicit</code> somewhere.</p>\n\n<blockquote>\n<pre><code>        'copy asset row\n        assetTbl.Rows(iRowAsset).Copy\n        'paste row in compiled\n        compiledTbl.Rows(xlEndRow).PasteSpecial xlPasteValues\n        'paste risk id in last column of that row\n        compiledTbl.Cells(xlEndRow, ColumnH).Value = tmpRiskID\n</code></pre>\n</blockquote>\n\n<p>I'm not convinced you actually need to involve the clipboard here. Again, consider leveraging the <code>ListObject</code> API - this should work (untested):</p>\n\n<pre><code>    With compiledTbl.ListRows.Add\n        .Range.Value = currentRow.Range.Value\n        .Range.Cells(ColumnIndex:=compiledRiskIdColumn).Value = tmpRiskID\n    End With\n</code></pre>\n\n<p>Where <code>compiledRiskIdColumn</code> would be declared and assigned before the loop body:</p>\n\n<pre><code>Dim compiledRiskIdColumn As Long\ncompiledRiskIdColumn = compieldTbl.ListColumns(\"Risk ID\").Index '&lt;~ verify column title\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12112109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7644308fce7e82e80e5a7164a2194e2a?s=128&d=identicon&r=PG&f=1", "display_name": "MAfs", "link": "https://stackoverflow.com/users/12112109/mafs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 58103995, "answer_count": 1, "score": 0, "last_activity_date": 1569433774, "creation_date": 1569423141, "last_edit_date": 1569423273, "question_id": 58101223, "link": "https://stackoverflow.com/questions/58101223/run-time-error-424-object-required-unsure-what-ive-written-wrong-in-this-co", "title": "Run-time error &#39;424&#39; Object required - Unsure what I&#39;ve written wrong in this code?", "body": "<pre><code>Sub automated_gr_lookup()\n    Dim st As Long\n    Dim en As Long\n    Dim c1 As Long\n    Dim c2 As Long\n    Dim iRowAsset As Integer\n    Dim table As Range\n    Dim tmpRiskID As Variant\n\n    Sheets(\"Geotechnical Risk Register\").Select\n\n    Application.ScreenUpdating = False\n\n    Set assetTbl = Application.Range(\"M002_\") 'Asset table = DES M002\n    Set riskTbl = Application.Range(\"geotechRisks\") 'GRR\n    Set compiledTbl = Application.Range(\"CompiledM002\") 'Output for M002\n\n\n    For iRowRisk = 1 To riskTbl.Rows.Count 'loop through risks\n        tmpRiskID = riskTbl.Row.Range(\"Ref No. ID\") 'Temporary risk as it gets overridden\n\n\n        'if assets chainage match risk iRowRisk (4 conditions)\n        If (en &gt; c1 And en &lt; c2) Or (st &gt; c1 And en &lt; c2) Or (st &gt; c1 And st &lt; c2) Or (st &lt; c1 And en &gt; c2) Then\n            'copy asset row\n            assetTbl.Rows(iRowAsset).Copy\n            'paste row in compiled\n            compiledTbl.Rows(xlEndRow).PasteSpecial xlPasteValues\n            'paste risk id in last column of that row\n            compiledTbl.Cells(xlEndRow, ColumnH).Value = tmpRiskID\n        End If\n    Next iRowRisk\n\nEnd Sub\n</code></pre>\n\n<p>I'm getting a <code>runtime error 424</code> on the line <code>tmpRiskID = riskTbl.Row.Range(\"Ref No. ID\")</code> and unsure why? I'm currently trying to assign it to a table heading.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1569423104, "post_id": 58101162, "comment_id": 102593930, "body": "Is asking to save the changes from the new created e-mail you mean?"}], "answers": [{"tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": false, "score": 0, "last_activity_date": 1569426139, "creation_date": 1569426139, "answer_id": 58102118, "question_id": 58101162, "link": "https://stackoverflow.com/questions/58101162/is-there-a-way-to-prevent-outlook-from-asking-about-whether-or-not-to-save-chang/58102118#58102118", "title": "Is there a way to prevent Outlook from asking about whether or not to save changes after opening it with Excel VBA?", "body": "<p>I think that you can use <code>oldiscard</code></p>\n\n<pre><code>Sub mail()\nDim objOutlook As Object\nDim objMail As Object\n\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objMail = objOutlook.CreateItem(0)\n\nWith objMail\n   .To = \"Yourname@Yourdomain.com\"\n   .Subject = \"My Subject\"\n   .Body = \"My message.\"\n   .Display        'This creates and opens the Email. The user has to manually click the send button in Outlook afterwards\nEnd With\n\nIf Msg(\"Do you rwant to close this mail?\" &amp; vbCrLf, vbYesNo) = vbYes Then objMail.Close oldiscard\nEnd Sub\n</code></pre>\n\n<p>This code will ask you if you want to close your email, if yes it will close without asking you if you want to save change. \nA good workaround would be to put <code>oldiscard</code> once you trigger the outlook button close, for it you will have to use <code>Inspector</code>. </p>\n\n<p>You might have to follow this tutorial and adapt it : <a href=\"https://office-watch.com/2015/code-close-all-open-outlook-email-messages-without-saving/\" rel=\"nofollow noreferrer\">See the tutorial here</a></p>\n"}], "owner": {"reputation": 96, "user_id": 11049699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68bd890fddbbc8d46d19da87cac7f7a?s=128&d=identicon&r=PG&f=1", "display_name": "R.H.", "link": "https://stackoverflow.com/users/11049699/r-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574650939, "creation_date": 1569422949, "last_edit_date": 1574650939, "question_id": 58101162, "link": "https://stackoverflow.com/questions/58101162/is-there-a-way-to-prevent-outlook-from-asking-about-whether-or-not-to-save-chang", "title": "Is there a way to prevent Outlook from asking about whether or not to save changes after opening it with Excel VBA?", "body": "<p>The following Excel 2016 VBA code does open Outlook:</p>\n\n<pre><code>Sub mail()\n    Dim objOutlook As Object\n    Dim objMail As Object\n\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n    Set objMail = objOutlook.CreateItem(0)\n\n    With objMail\n       .To = \"Yourname@Yourdomain.com\"\n       .Subject = \"My Subject\"\n       .Body = \"My message.\" \n       .Display        'This creates and opens the Email. The user has to manually click the send button in Outlook afterwards\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Now, the user has the valid option to immediately close Outlook.<br>\nHowever in this case, Outlook opens a pop-up window about whether or not to save changes.</p>\n\n<p>Is there a way to prevent Outlook from opening this pop-up alert window by some Excel VBA code?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1569422555, "post_id": 58100928, "comment_id": 102593613, "body": "When recording macros, typically it generates way too much code if you plan on re-using (but it&#39;s a great starting point!).  I recommend looking in to how to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using <code>.Select</code>/<code>.Activate</code></a>, and also learning how to use loops, set dynamic ranges, etc. which will help you shorten the code.  Also, if your code does a bunch of different things, look to splitting it in to multiple subroutines/functions, and perhaps passing values through to a sub/function."}, {"owner": {"reputation": 3777, "user_id": 3072350, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UzWpH.jpg?s=128&g=1", "display_name": "Chris Catignani", "link": "https://stackoverflow.com/users/3072350/chris-catignani"}, "edited": false, "score": 0, "creation_date": 1569422697, "post_id": 58100928, "comment_id": 102593700, "body": "What are you using to record the macros? NotePad++ is feature rich and can run multiple macros."}, {"owner": {"reputation": 11, "user_id": 9692006, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213906812217069/picture?type=large", "display_name": "Christopher J Rode", "link": "https://stackoverflow.com/users/9692006/christopher-j-rode"}, "edited": false, "score": 0, "creation_date": 1569423686, "post_id": 58100928, "comment_id": 102594313, "body": "im using excel. We have these files that are first off text files that need to be opened and then formatted into excel to prepare to put into a report. The other is already excel but has hyerlinks and formatting along with info we don&#39;t need, which needs filtered out to run the report. All of our divisions aren&#39;t on the same system yet unfortunately so this is part of the job for an unknown amount of time"}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 1, "last_activity_date": 1569422536, "creation_date": 1569422536, "answer_id": 58101013, "question_id": 58100928, "link": "https://stackoverflow.com/questions/58100928/multiple-macros-to-prevent-single-recorded-macro-from-being-too-large/58101013#58101013", "title": "Multiple macros to prevent single recorded macro from being too large", "body": "<p>Without getting too technical, you can record many macros and then create a new <code>subroutine</code> to run them sequentially like:</p>\n\n<pre><code>Sub MySumToRunMacros()\n    Call Macro1\n    Call Macro2\n    Call Macro3\nEnd Sub\n</code></pre>\n\n<p>When you run that subroutine it will first run <code>macro1</code> and then <code>macro2</code> and then <code>macro3</code> and then exit.</p>\n\n<p>What I would recommend though is that you learn how to format your workbook/files by writing the macro/vba yourself. Formatting is pretty easy to do through VBA and you can start with the code that you already generated. </p>\n"}], "owner": {"reputation": 11, "user_id": 9692006, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213906812217069/picture?type=large", "display_name": "Christopher J Rode", "link": "https://stackoverflow.com/users/9692006/christopher-j-rode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574144566, "creation_date": 1569422268, "last_edit_date": 1574144566, "question_id": 58100928, "link": "https://stackoverflow.com/questions/58100928/multiple-macros-to-prevent-single-recorded-macro-from-being-too-large", "title": "Multiple macros to prevent single recorded macro from being too large", "body": "<p>I'm trying to record a macro that will format the files I have such as filtering, sorting, fill, gridlines and removing hyperlinks to place that data into another file.</p>\n\n<p>The macro was too large. I am wondering about two things.</p>\n\n<ol>\n<li>Can I record multiple small macros and do each part individually?</li>\n<li>Is there something else I can use to format my file and then place in into Excel?</li>\n</ol>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1348, "user_id": 1706744, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0717846543e029be011ad8580eeabc6b?s=128&d=identicon&r=PG", "display_name": "mankowitz", "link": "https://stackoverflow.com/users/1706744/mankowitz"}, "edited": false, "score": 0, "creation_date": 1569423004, "post_id": 58100869, "comment_id": 102593868, "body": "It&#39;s not clear exactly what you are trying to do and in what platform. Please specify what format your data is in, how you want to make trendlines, how you intend to graph them, etc."}, {"owner": {"reputation": 1, "user_id": 12119752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8642c225e9e0ee735f761fb9383cfa2?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Rivard", "link": "https://stackoverflow.com/users/12119752/nathan-rivard"}, "reply_to_user": {"reputation": 1348, "user_id": 1706744, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0717846543e029be011ad8580eeabc6b?s=128&d=identicon&r=PG", "display_name": "mankowitz", "link": "https://stackoverflow.com/users/1706744/mankowitz"}, "edited": false, "score": 0, "creation_date": 1569424238, "post_id": 58100869, "comment_id": 102594636, "body": "So I have temperature data that is logged alongside multiple thermal sensors. These are measurements taken every couple of seconds and I want to to take the data as the temperature is heating/cooling and create a trendline off of that slope and put it into a cell for every thermal sensor"}, {"owner": {"reputation": 1348, "user_id": 1706744, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0717846543e029be011ad8580eeabc6b?s=128&d=identicon&r=PG", "display_name": "mankowitz", "link": "https://stackoverflow.com/users/1706744/mankowitz"}, "edited": false, "score": 0, "creation_date": 1569424948, "post_id": 58100869, "comment_id": 102595065, "body": "OK, but also tell us what platform the data is in, and how you plan to create trendlines. Is this data in microsoft excel? free text? How do you anticipate manipulating that data? Are you loading it into python?"}, {"owner": {"reputation": 1, "user_id": 12119752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8642c225e9e0ee735f761fb9383cfa2?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Rivard", "link": "https://stackoverflow.com/users/12119752/nathan-rivard"}, "reply_to_user": {"reputation": 1348, "user_id": 1706744, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0717846543e029be011ad8580eeabc6b?s=128&d=identicon&r=PG", "display_name": "mankowitz", "link": "https://stackoverflow.com/users/1706744/mankowitz"}, "edited": false, "score": 0, "creation_date": 1569426106, "post_id": 58100869, "comment_id": 102595719, "body": "Excel. I would like to be able to select the data that I would like trend lines from and paste it into specified cells"}, {"owner": {"reputation": 1348, "user_id": 1706744, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0717846543e029be011ad8580eeabc6b?s=128&d=identicon&r=PG", "display_name": "mankowitz", "link": "https://stackoverflow.com/users/1706744/mankowitz"}, "edited": false, "score": 0, "creation_date": 1569619613, "post_id": 58100869, "comment_id": 102669176, "body": "I personally don&#39;t know the answer to your question. However, if you want to get a better response, you should add the tag [excel] to the question and add all this information to the question body. As it stands, it would be difficult for an excel expert to find this."}], "owner": {"reputation": 1, "user_id": 12119752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8642c225e9e0ee735f761fb9383cfa2?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Rivard", "link": "https://stackoverflow.com/users/12119752/nathan-rivard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569478054, "creation_date": 1569422093, "last_edit_date": 1569478054, "question_id": 58100869, "link": "https://stackoverflow.com/questions/58100869/extracting-trendlines-from-given-data-sets-using-macros", "title": "Extracting Trendlines from given data sets using macros", "body": "<p>I am having to create 4200 trendlines equations in both linear form and polynomial form from a given set of data that I convert into a graph. Once I create the graph is there a way I can automatically grab both forms of trendlines for every data set on the graph and paste it without too much effort?</p>\n\n<p>I have limited knowledge of macros, a bit more knowledge of python and its ability to automate.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1569422414, "post_id": 58100804, "comment_id": 102593533, "body": "See the screenshot in <a href=\"https://stackoverflow.com/a/32997154/9245853\">this answer</a>. <code>Columns</code> returns a <code>Range</code>, and <code>_Default</code> is the default member. Hopefully someone like Mathieu Guindon can provide a more thorough answer. His article <a href=\"https://rubberduckvba.wordpress.com/2018/03/15/vba-trap-default-members/\" rel=\"nofollow noreferrer\">here</a> about default members is a good read."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1569429999, "post_id": 58100804, "comment_id": 102597451, "body": "@BigBen thanks for linking to that article... I&#39;ve updated it (code blocks were broken, and the huge warning about Rubberduck losing custom attributes is now gone, since that is no longer a problem)."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1569430231, "post_id": 58101500, "comment_id": 102597551, "body": "Great answer - this is why I deferred to you in my original comment. Great read and thorough. Thanks for taking the time to lay it out."}, {"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1570196878, "post_id": 58101500, "comment_id": 102848178, "body": "Wow, thanks Mathieu for this lesson and sorry for my delayed reading and approval!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1570198338, "post_id": 58101500, "comment_id": 102848917, "body": "@6diegodiego9 you&#39;re welcome! FYI <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> inspections can warn about everything this answer is about, <a href=\"http://rubberduckvba.com/Inspections/List\" rel=\"nofollow noreferrer\">and more</a> - star us on GitHub if you like! (I manage this OSS project)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1569424780, "last_edit_date": 1569424780, "creation_date": 1569424015, "answer_id": 58101500, "question_id": 58100804, "link": "https://stackoverflow.com/questions/58100804/worksheet-columns-property-asks-me-for-a-rowindex/58101500#58101500", "title": "Worksheet.Columns property asks me for a RowIndex?", "body": "<blockquote>\n  <p>The Worksheet.Columns property only accepts the index (column) number as far as I can see in the documentation.</p>\n</blockquote>\n\n<p>Nowhere in the documentation does it say the <code>Columns</code> property takes a parameter, and indeed, it would be wrong to mention that, because it doesn't have any:</p>\n\n<p><img src=\"https://i.stack.imgur.com/xpLPg.png\" alt=\"Worksheet.Columns definition in Object Browser\"></p>\n\n<p>Like <code>Worksheet.Rows</code>, <code>Worksheet.Columns</code> yields a <code>Range</code> object. So when you \"parameterize\" it, what's really happening is this:</p>\n\n<pre><code>Set foo = ws.Columns.[_Default](value)\n</code></pre>\n\n<p>Any argument you provide, get interpreted as arguments to an implicit default member call against the <code>Range</code> object that was <em>returned</em> by the call to <code>Columns</code>.</p>\n\n<p>You may have read somewhere that the default member of a <code>Range</code> is its <code>Value</code> - and that is not true. The default member of a <code>Range</code> is a hidden property named <code>[_Default]</code> (square brackets are required in VBA if you want to invoke it explicitly, because no legal VBA identifier can begin with an underscore), that takes two optional parameters:</p>\n\n<p><img src=\"https://i.stack.imgur.com/DLMTG.png\" alt=\"Range._Default hidden property in Object Browser\"></p>\n\n<p>When you read (\"get\") this default property without providing any arguments, this default property <em>does</em> get you the <code>Range.Value</code> (i.e. a single <code>Variant</code> value for a single cell, or a 2D <code>Variant</code> array for multiple cells). When you assign to this default property, you <em>are</em> assigning the <code>Range.Value</code>.</p>\n\n<p>But when any arguments are provided when reading (\"get\") this default property, what you get is a call to the very standard <code>Range.Item</code> indexer property:</p>\n\n<p><img src=\"https://i.stack.imgur.com/SZBKQ.png\" alt=\"Range.Item definition in the object browser\"></p>\n\n<p>So what <code>Columns</code> does, is simply take your input range, and yield a <code>Range</code> object laid out in such a way that it can be accessed using a <code>RowIndex</code> argument - we can prove this using named arguments, which show that this code is illegal:</p>\n\n<pre><code>?Sheet1.Range(\"A1:C1\").Columns.Item(ColumnIndex:=2).Address\n&gt;&gt; \"wrong number of arguments\"\n</code></pre>\n\n<p>As is this equivalent code:</p>\n\n<pre><code>?Sheet1.Range(\"A1:C1\").Columns(ColumnIndex:=2).Address\n&gt;&gt; \"error 1004\"\n</code></pre>\n\n<p>Note that the <code>_Default</code> property yields a <code>Variant</code>, so the above <code>.Address</code> member call can only be resolved at run-time (and you don't get any intellisense for it, and the compiler will not flinch at any typo, even with <code>Option Explicit</code> specified - you <em>will</em> get error 438 at run-time though).</p>\n\n<p>Best stick to safe early-bound land, and pull the returned object reference into a local variable:</p>\n\n<pre><code>Dim foo As Range\nSet foo = ws.Columns(1)\n\nDebug.Print foo.Address '&lt;~ early-bound w/intellisense &amp; compile-time validation\n</code></pre>\n\n<hr>\n\n<p>TL;DR: You're being prompted for a <code>RowIndex</code> argument because you <em>are</em> making a call (albeit an <em>implicit</em> one) to a hidden <code>_Default</code> property that accepts a <code>RowIndex</code> argument.</p>\n"}], "owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 58101500, "answer_count": 1, "score": 2, "last_activity_date": 1569424780, "creation_date": 1569421877, "last_edit_date": 1569424621, "question_id": 58100804, "link": "https://stackoverflow.com/questions/58100804/worksheet-columns-property-asks-me-for-a-rowindex", "title": "Worksheet.Columns property asks me for a RowIndex?", "body": "<p>If I write this in the VBA editor:</p>\n\n<pre><code>Dim ws As Worksheet: set ws = ActiveSheet\nws.Columns(\n</code></pre>\n\n<p><em>IntelliSense</em> shows me a seemingly unrelated tooltip:</p>\n\n<blockquote>\n  <p>_Default(<strong>[RowIndex]</strong>, [ColumnIndex])</p>\n</blockquote>\n\n<p>The <code>Worksheet.Columns</code> property only accepts the index (column) number as far as I can see in the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.columns\" rel=\"nofollow noreferrer\">documentation</a>.</p>\n\n<p>So why am I asked for a <code>RowIndex</code>? Why does it refers to <code>_Default</code> (and what is it)?</p>\n"}, {"tags": ["excel", "xml", "vba"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1569499204, "post_id": 58100781, "comment_id": 102621783, "body": "Please edit your post and add the entire XML response."}, {"owner": {"reputation": 146, "user_id": 6465553, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209742376705641/picture?type=large", "display_name": "viper941", "link": "https://stackoverflow.com/users/6465553/viper941"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1569519236, "post_id": 58100781, "comment_id": 102632636, "body": "That is the entire response as far as I am able to determine. As I stated above the normal usage is a internal page the product ID&#39;s are submitted and the table is generated on that page based on the results of the query. If I run the query standalone in a browser the page source above is what is produced. If the query is run through excel the same data with the source tags is what is produced in a single cell."}], "owner": {"reputation": 146, "user_id": 6465553, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209742376705641/picture?type=large", "display_name": "viper941", "link": "https://stackoverflow.com/users/6465553/viper941"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569482894, "creation_date": 1569421802, "last_edit_date": 1569482894, "question_id": 58100781, "link": "https://stackoverflow.com/questions/58100781/importing-xml-table-of-results-from-a-query-url", "title": "Importing XML Table of results from a query URL", "body": "<p>I have several web pages on our work Intranet that are used for basic queries. We query by product ID and the results are displayed on the page as a table, dynamically adjusted to the size of the results.</p>\n\n<p>If I try to import the query directly I do get a response. I am importing by using:</p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:= _\n    \"URL;https://picture-us.MASKED.com/imaging_orders/list_data?utf8=%E2%9C%93&amp;work_order_enum=LEGACY_WORK_ORDER&amp;tab=1&amp;asin=MASKED&amp;warehouse=SDF8&amp;commit_asin=Search&amp;utf8=%E2%9C%93&amp;work_order_enum=LEGACY_WORK_ORDER&amp;tab=1&amp;asin=MASKED&amp;warehouse=SDF8&amp;commit_asin=Search\" _\n    , Destination:=Range(\"$A$1\"))\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .WebSelectionType = xlAllTables\n    .WebFormatting = xlWebFormattingNone\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = False\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<p>My results are the following all in one cell (MASKED to hide confidential data):</p>\n\n<pre><code>&lt;tr&gt;\n    &lt;td style=\"white-space: nowrap;\"&gt;\n    &lt;input type=\"checkbox\" name=\"selectedOrders[]\" id=\"selectedOrders_\"   value=\"10040859069\" /&gt;\n    &lt;/td&gt;\n    &lt;td&gt;2019-06-25 14:06:53&lt;/td&gt;\n    &lt;td&gt;MASKED&lt;/td&gt;\n    &lt;td&gt;MASKED&lt;/td&gt;    \n    &lt;td&gt;COMPLETE&lt;/td&gt;\n    &lt;td&gt;&lt;button onclick=\"toggleEvents(this)\" class=\"toggleEventButton\" type=\"button\"&gt;Show&lt;/button&gt;&lt;br /&gt;\n    &lt;div style=\"display:none;\" id=\"10040859069\" class=\"imagingOrderEvents\"&gt;\n    &lt;table&gt;\n      &lt;thead&gt; \n        &lt;tr&gt;\n          &lt;th&gt;Date&lt;/th&gt;\n          &lt;th&gt;New Status&lt;/th&gt;\n          &lt;th&gt;User Id&lt;/th&gt;\n          &lt;th&gt;Module&lt;/th&gt;\n          &lt;th&gt;Change Reason&lt;/th&gt;\n         &lt;/tr&gt;\n       &lt;/thead&gt; \n       &lt;tbody&gt; \n      &lt;/tbody&gt;\n    &lt;/table&gt;\n    &lt;/div&gt;\n    &lt;/td&gt;\n    &lt;td&gt;10040859069&lt;/td&gt;\n  &lt;/tr&gt;&lt;tr&gt;\n    &lt;td style=\"white-space: nowrap;\"&gt;\n    &lt;input type=\"checkbox\" name=\"selectedOrders[]\" id=\"selectedOrders_\" value=\"10043881826\" /&gt;\n    &lt;/td&gt;\n    &lt;td&gt;2019-08-20 16:36:09&lt;/td&gt;\n    &lt;td&gt;MASKED&lt;/td&gt;\n    &lt;td&gt;MASKED&lt;/td&gt;    \n    &lt;td&gt;COMPLETE&lt;/td&gt;\n    &lt;td&gt;&lt;button onclick=\"toggleEvents(this)\" class=\"toggleEventButton\"   type=\"button\"&gt;Show&lt;/button&gt;&lt;br /&gt;\n    &lt;div style=\"display:none;\" id=\"10043881826\" class=\"imagingOrderEvents\"&gt;\n    &lt;table&gt;\n      &lt;thead&gt; \n        &lt;tr&gt;\n          &lt;th&gt;Date&lt;/th&gt;\n          &lt;th&gt;New Status&lt;/th&gt;\n          &lt;th&gt;User Id&lt;/th&gt;\n          &lt;th&gt;Module&lt;/th&gt;\n          &lt;th&gt;Change Reason&lt;/th&gt;\n         &lt;/tr&gt;\n       &lt;/thead&gt; \n       &lt;tbody&gt; \n      &lt;/tbody&gt;\n    &lt;/table&gt;\n    &lt;/div&gt;\n    &lt;/td&gt;\n    &lt;td&gt;10043881826&lt;/td&gt;\n    &lt;/tr&gt;\n</code></pre>\n\n<p>Ideally I would like to be able to import the table data into individual cells. I don't actually need them to have any header information, as I only need to extract the data results and utilize that piece of information in other code.</p>\n\n<p>Edit added page source info from url:</p>\n\n<pre><code>    &lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;root&gt;\n&lt;status&gt;\n    &lt;code&gt;OK&lt;/code&gt;\n    &lt;description&gt;OK&lt;/description&gt;\n&lt;/status&gt;\n&lt;table_body&gt;\n&lt;![CDATA[\n  &lt;tr&gt;\n  &lt;td style=\"white-space: nowrap;\"&gt;\n  &lt;input type=\"checkbox\" name=\"selectedOrders[]\" id=\"selectedOrders_\" value=\"10044295826\" /&gt;\n  &lt;/td&gt;\n  &lt;td&gt;2019-08-27 07:08:18&lt;/td&gt;\n  &lt;td&gt;ZZUL4SMRCB&lt;/td&gt;\n  &lt;td&gt;MASKED_PHOTO1&lt;/td&gt;    \n  &lt;td&gt;READY&lt;/td&gt;\n  &lt;td&gt;&lt;button onclick=\"toggleEvents(this)\" class=\"toggleEventButton\" type=\"button\"&gt;Show&lt;/button&gt;&lt;br /&gt;\n  &lt;div style=\"display:none;\" id=\"10044295826\" class=\"imagingOrderEvents\"&gt;\n  &lt;table&gt;\n    &lt;thead&gt; \n      &lt;tr&gt;\n        &lt;th&gt;Date&lt;/th&gt;\n        &lt;th&gt;New Status&lt;/th&gt;\n        &lt;th&gt;User Id&lt;/th&gt;\n        &lt;th&gt;Module&lt;/th&gt;\n        &lt;th&gt;Change Reason&lt;/th&gt;\n       &lt;/tr&gt;\n     &lt;/thead&gt; \n     &lt;tbody&gt; \n    &lt;/tbody&gt;\n  &lt;/table&gt;\n  &lt;/div&gt;\n  &lt;/td&gt;\n  &lt;td&gt;10044295826&lt;/td&gt;\n&lt;/tr&gt;\n]]&gt;\n&lt;/table_body&gt;\n&lt;last_page /&gt;\n&lt;/root&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12119476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb0082a6f0bb5b5d104d0144a0d6da00?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisC", "link": "https://stackoverflow.com/users/12119476/chrisc"}, "edited": false, "score": 1, "creation_date": 1569421469, "post_id": 58100434, "comment_id": 102592935, "body": "Thank you so much that did it!  I changed around the &#39;activesheet...&#39; and &#39;Sheets(pin)&#39; etc to how I needed it but it worked perfectly."}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 0, "last_activity_date": 1569420746, "creation_date": 1569420746, "answer_id": 58100434, "question_id": 58100095, "link": "https://stackoverflow.com/questions/58100095/vlookup-using-inputbox-to-determine-table-array-location/58100434#58100434", "title": "VLookup - Using InputBox to Determine Table Array Location", "body": "<p>This should meet your requirements:</p>\n\n<pre><code>Sub Vlookup()\n\nDim pin As Variant\npin = InputBox(\"Enter Worksheet to insert\", \"PIN\")\nIf pin = \"\" Then Exit Sub\n\nSheets(pin).Range(\"E2\").Value2 = _\nApplication.WorksheetFunction.Vlookup(Sheets(pin).Range(\"A2\").Value2, _\nActiveSheet.Range(\"A1:X200\"), 5, False)\n\nEnd Sub\n</code></pre>\n\n<p>However there are some crucial things missing from your code, especially input validation. Your code does not check the user's input. So, if a user enters something else than a sheet name or simply mistypes your code will break. A simple solution would be using an error handler. A more elegant solution would be using a <code>UserForm</code> instead of an <code>InputBox</code>. On the <code>UserForm</code> you could have a dropdown list that shows all the worksheet names and lets the user select it.</p>\n"}], "owner": {"reputation": 13, "user_id": 12119476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb0082a6f0bb5b5d104d0144a0d6da00?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisC", "link": "https://stackoverflow.com/users/12119476/chrisc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 58100434, "answer_count": 1, "score": 1, "last_activity_date": 1569420746, "creation_date": 1569419758, "last_edit_date": 1569420147, "question_id": 58100095, "link": "https://stackoverflow.com/questions/58100095/vlookup-using-inputbox-to-determine-table-array-location", "title": "VLookup - Using InputBox to Determine Table Array Location", "body": "<p>I have a spreadsheet with lots of tabs each one associated with a certain date.</p>\n\n<p>I want a macro to pull out data from a column 'Theme' from <code>sheet1</code> and place it in <code>sheet2</code>.</p>\n\n<p><code>Sheet1</code> is determined by an input box which is completed by the user.</p>\n\n<p>For example the user will type <code>9th September</code> to take the data from one sheet to another.</p>\n\n<p>I have created the code and it works using <code>sheet1</code> and <code>sheet2</code> however I would like it slightly adapted as below:</p>\n\n<ul>\n<li>Sheet1 = current active sheet (<code>ActiveSheet</code> doesn't seem to be working)</li>\n<li>Sheet2 = This will be generated by the Input Box (\"pin\" in the code)</li>\n</ul>\n\n<hr>\n\n<pre><code>Sub Vlookup()\n\nDim pin As Variant\npin = VBA.InputBox(\"Enter Worksheet to lookup\", \"PIN\")\nIf (pin = \"\") Then Exit Sub\n\n[Sheet2!E2] = [VLOOKUP(Sheet2!A2, Sheet1!A1:X200, 5, FALSE)]\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1569419747, "post_id": 58099907, "comment_id": 102591877, "body": "If you test in Word&#39;s UI (Ctrl+H) do you get the same result? Are you sure the hyphen is truly a hyphen and not a non-breaking hyphen or an optional hyphen? (One will always force both sides of the hyphen to stay together on a line, not break at the end of a line; the other will only display if hyphenation is active and the word breaks at the end of a line.) If you copy the term then paste it into the Find dialog&#39;s &quot;Find what&quot; box, does Find/Replace then work?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1569425461, "post_id": 58099907, "comment_id": 102595357, "body": "Are you sure the word is in your <code>Selection</code> when you run this macro?"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1569433887, "post_id": 58099907, "comment_id": 102599141, "body": "Testing with your code I found no issues replacing words that contained hyphens. I did however have issues replacing a word with a &quot;&quot; blank string. It ignored the replace in those cases but did properly format the word based on the Font format change. Change the .Replacement.Text = &quot;&quot; to = &quot; &quot; to see if you can replace with a single space.  I think there is something flaky going on with this function."}], "owner": {"reputation": 13, "user_id": 11196880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adf1db94590fd31ca1cbef4cf3b3c1d?s=128&d=identicon&r=PG&f=1", "display_name": "S Farrell", "link": "https://stackoverflow.com/users/11196880/s-farrell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569419514, "creation_date": 1569419222, "last_edit_date": 1569419514, "question_id": 58099907, "link": "https://stackoverflow.com/questions/58099907/macro-is-not-picking-up-hyphens-within-text", "title": "Macro is not picking up hyphens within text", "body": "<p>Having a bit of an error with a macro that was working earlier today. We have a macro that searches a word document for certain words, and changes the font type when it detects them. For some reason, we added a new word/phrase, that contains a hyphen, for example this-word. There is no space either side of the hyphen, and I can't work out why it wont detect. Below is an example of the code.</p>\n\n<pre><code>       With Selection.Find\n        .Text = \"hyphenated-word\"\n        .Replacement.Text = \"\"\n        .Replacement.Font.Name = \"Whitney Bold\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .MatchWholeWord = True\n   End With\n   Selection.Find.Execute Replace:=wdReplaceAll\n</code></pre>\n\n<p>For all intents and purposes, the code itself works with other words, such as \"your\" etc, but with this it doesn't. Is there a rule im missing?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1569419333, "post_id": 58099903, "comment_id": 102591634, "body": "Are you asking how to determine the <code>4</code> programmatically? <code>FullSeriesCollection</code> has a <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.fullseriescollection.count\" rel=\"nofollow noreferrer\"><code>Count</code></a> property."}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569419815, "post_id": 58099903, "comment_id": 102591925, "body": "As @BigBen said, replace <code>4</code> with <code>ActiveChart.SeriesCollection.Count</code>"}], "answers": [{"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": false, "score": 1, "last_activity_date": 1569420188, "creation_date": 1569420188, "answer_id": 58100231, "question_id": 58099903, "link": "https://stackoverflow.com/questions/58099903/in-a-line-chart-how-do-i-change-the-last-series-in-the-active-chart-to-secondar/58100231#58100231", "title": "In a line chart, how do I change the last series in the Active Chart to secondary axis?", "body": "<p>As BigBen suggested, you can use the Count property to refer to the last series.  Accordingly, your macro can be re-written as follows...</p>\n\n<pre><code>Sub Macro1()\n\n    With ActiveChart\n        With .FullSeriesCollection(.FullSeriesCollection.Count)\n            .ChartType = xlArea\n            .AxisGroup = 2\n        End With\n    End With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12119440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/321eeae9dcf11701847c8a1f06b51fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Vedanta123", "link": "https://stackoverflow.com/users/12119440/vedanta123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569420188, "creation_date": 1569419212, "last_edit_date": 1569419307, "question_id": 58099903, "link": "https://stackoverflow.com/questions/58099903/in-a-line-chart-how-do-i-change-the-last-series-in-the-active-chart-to-secondar", "title": "In a line chart, how do I change the last series in the Active Chart to secondary axis?", "body": "<p>Current code assumes 4 series</p>\n\n<pre><code>Sub Macro1() \n\n    ActiveChart.FullSeriesCollection(4).Select\n    ActiveChart.FullSeriesCollection(4).ChartType = xlArea\n    ActiveChart.FullSeriesCollection(4).AxisGroup = 2\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1569419207, "post_id": 58099871, "comment_id": 102591566, "body": "It&#39;s strongly recommended that you replace the email addresses in your post with fake stand-ins to avoid them getting inundated with spam from search crawlers."}, {"owner": {"reputation": 21449, "user_id": 1839439, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/agMKZ.png?s=128&g=1", "display_name": "Dharman", "link": "https://stackoverflow.com/users/1839439/dharman"}, "reply_to_user": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 1, "creation_date": 1569419277, "post_id": 58099871, "comment_id": 102591601, "body": "@TylerH They are fake. pierwszy=first, drugi=second"}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "reply_to_user": {"reputation": 21449, "user_id": 1839439, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/agMKZ.png?s=128&g=1", "display_name": "Dharman", "link": "https://stackoverflow.com/users/1839439/dharman"}, "edited": false, "score": 0, "creation_date": 1569419777, "post_id": 58099871, "comment_id": 102591897, "body": "@Dharman You don&#39;t think someone has registered those email addresses with Google? :-) When I say fake stand-ins I mean things that would not deliverable as an email address. This would also serve the purpose of not getting flagged by SmokeDetector as a bad string."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569421067, "post_id": 58099871, "comment_id": 102592712, "body": "Please use the Tool in the site&#39;s editor to insert pictures that can be integrated into the question. Links to outside sources are disallowed - all information relevant to a question needs to be in the question, itself. Outside links can become invalid, making the question not useful for future site users."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1569427639, "post_id": 58099871, "comment_id": 102596456, "body": "Have you tried making a rule that links to vba code as opposed to initializing during startup? You can setup a new rule with the only requirement being &quot;on this computer only&quot; to &quot;run a script&quot;. The script would take a MailItem as the passed variable and you can trigger the code based on this mail item. I can give an example if you&#39;d like."}, {"owner": {"reputation": 11, "user_id": 12119208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0af3168c0f22c65459f02131855a2265?s=128&d=identicon&r=PG&f=1", "display_name": "micek2323", "link": "https://stackoverflow.com/users/12119208/micek2323"}, "edited": false, "score": 0, "creation_date": 1569441410, "post_id": 58099871, "comment_id": 102602247, "body": "I would be very grateful"}], "answers": [{"comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1569535648, "post_id": 58122732, "comment_id": 102638957, "body": "This trips many <code>Sub exportToExcel(item As Object)</code> rather than <code>Sub exportToExcel(item As MailItem)</code>."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1569538110, "post_id": 58122732, "comment_id": 102639468, "body": "Are you referring to mistakenly sending something besides a MailItem to this script?  If using the method I indicate with the rules engine, the only scripts that will appear in the list to run will be scripts that accept MailItem as an object"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1569541811, "post_id": 58122732, "comment_id": 102640088, "body": "I stand corrected. Was tripped myself by the ` If item.Class = olMail Then`."}, {"owner": {"reputation": 11, "user_id": 12119208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0af3168c0f22c65459f02131855a2265?s=128&d=identicon&r=PG&f=1", "display_name": "micek2323", "link": "https://stackoverflow.com/users/12119208/micek2323"}, "edited": false, "score": 0, "creation_date": 1569832098, "post_id": 58122732, "comment_id": 102709836, "body": "Thank you for your help. I did everything what you said but it still doesn&#39;t work for two accounts :|"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1569856482, "post_id": 58122732, "comment_id": 102722618, "body": "Does the code trigger at all? Did you set up the rule for BOTH accounts?"}, {"owner": {"reputation": 11, "user_id": 12119208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0af3168c0f22c65459f02131855a2265?s=128&d=identicon&r=PG&f=1", "display_name": "micek2323", "link": "https://stackoverflow.com/users/12119208/micek2323"}, "edited": false, "score": 0, "creation_date": 1569926018, "post_id": 58122732, "comment_id": 102745636, "body": "Yes, I set up the rule for both accounts and still code works for only 1."}], "tags": [], "owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1569522386, "creation_date": 1569522386, "answer_id": 58122732, "question_id": 58099871, "link": "https://stackoverflow.com/questions/58099871/auto-export-e-mails-from-outlook-to-excel/58122732#58122732", "title": "Auto export e-mails from Outlook to Excel", "body": "<p>Let me preface this by saying - not sure how rules work for multiple accounts. You may need to create the rule for BOTH accounts but they can both reference the same script.</p>\n\n<p>I've updated your code to be a public <code>Sub</code> vs <code>Private Sub</code> and placed it in a module so that it can be referenced by the rules engine.</p>\n\n<p><a href=\"https://i.stack.imgur.com/VnYlM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VnYlM.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now, once we have the code in place (scripts run by Rules engine typically inherently pass the email as a MailItem to the sub and ByVal was causing issues with recognizing the script as one to be run from a MailItem so i updated it to <code>Item as MailItem</code>). </p>\n\n<p>We next create a new rule using the rules engine. If you see this simplistic interface, click on Advanced Options. That will allow us to apply to rule to all emails.  In the advanced options window, do not check any box for <code>Which conditions do you want to check?</code> simply click Next. It will confirm you want to add this rule for ALL EMAILS which we do.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CvaR9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CvaR9.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Vi3vY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vi3vY.png\" alt=\"enter image description here\"></a></p>\n\n<p>After selecting <code>run a script</code> we can click on <code>a script</code> to indicate which script we want to run. I set it to the exportToExcel script in Module(Project)1</p>\n\n<p><a href=\"https://i.stack.imgur.com/E9mkS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E9mkS.png\" alt=\"enter image description here\"></a></p>\n\n<p>Click Finish and test it out.</p>\n\n<pre><code>Sub exportToExcel(item As MailItem)\n    Dim objMail As Outlook.MailItem\n    Dim strExcelFile As String\n    Dim objExcelApp As Excel.Application\n    Dim objExcelWorkBook As Excel.Workbook\n    Dim objExcelWorkSheet As Excel.Worksheet\n    Dim nNextEmptyRow As Integer\n    Dim strColumnB As String\n    Dim strColumnC As String\n    Dim strColumnD As String\n    Dim strColumnE As String\n\n    If item.Class = olMail Then\n       Set objMail = item\n    End If\n\n    'Specify the Excel file which you want to auto export the email list\n    'You can change it as per your case\n    strExcelFile = \"C:\\Users\\karol\\Documents\\test.xlsx\"\n\n    'Get Access to the Excel file\n    On Error Resume Next\n    Set objExcelApp = GetObject(, \"Excel.Application\")\n    If Error &lt;&gt; 0 Then\n       Set objExcelApp = CreateObject(\"Excel.Application\")\n    End If\n    Set objExcelWorkBook = objExcelApp.Workbooks.Open(strExcelFile)\n    Set objExcelWorkSheet = objExcelWorkBook.Sheets(\"Arkusz1\")\n\n    'Get the next empty row in the Excel worksheet\n    nNextEmptyRow = objExcelWorkSheet.Range(\"B\" &amp; objExcelWorkSheet.Rows.count).End(xlUp).Row + 1\n\n    'Specify the corresponding values in the different columns\n    strColumnB = objMail.SenderName\n    strColumnC = objMail.SenderEmailAddress\n    strColumnD = objMail.Subject\n    strColumnE = objMail.ReceivedTime\n    strColumnF = objMail.Body\n    strColumnG = objMail.To\n\n    'Add the vaules into the columns\n    objExcelWorkSheet.Range(\"A\" &amp; nNextEmptyRow) = nNextEmptyRow - 1\n    objExcelWorkSheet.Range(\"B\" &amp; nNextEmptyRow) = strColumnB\n    objExcelWorkSheet.Range(\"C\" &amp; nNextEmptyRow) = strColumnC\n    objExcelWorkSheet.Range(\"D\" &amp; nNextEmptyRow) = strColumnD\n    objExcelWorkSheet.Range(\"E\" &amp; nNextEmptyRow) = strColumnE\n    objExcelWorkSheet.Range(\"F\" &amp; nNextEmptyRow) = strColumnF\n    objExcelWorkSheet.Range(\"G\" &amp; nNextEmptyRow) = strColumnG\n\n    'Fit the columns from A to E\n    objExcelWorkSheet.Columns(\"A:G\").AutoFit\n\n    'Save the changes and close the Excel file\n    objExcelWorkBook.Close SaveChanges:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1570195053, "creation_date": 1570195053, "answer_id": 58237228, "question_id": 58099871, "link": "https://stackoverflow.com/questions/58099871/auto-export-e-mails-from-outlook-to-excel/58237228#58237228", "title": "Auto export e-mails from Outlook to Excel", "body": "<p>You can monitor multiple folders with ItemAdd.</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents objMailspierwszy As Items\nPublic WithEvents objMailsdrugi As Items\n\nPrivate Sub Application_Startup()\n\n    Const pierwszy = \"pierwszy@somewhere.com\"\n    Const drugi = \"drugi@somewhere.com\"\n\n    Dim OutAcc As Account\n\n    For Each OutAcc In Session.Accounts\n\n        Debug.Print \"OutAcc.DisplayName: \" &amp; OutAcc.DisplayName\n        Debug.Print \"OutAcc.DeliveryStore: \" &amp; OutAcc.DeliveryStore\n\n        If OutAcc.DisplayName = pierwszy Then\n\n            Debug.Print \"OutAcc.DisplayName: \" &amp; OutAcc.DisplayName\n\n            Set objMailspierwszy = OutAcc.DeliveryStore.GetDefaultFolder(olFolderInbox).Items\n            Debug.Print \"Listener on \" &amp; objMailspierwszy.Parent &amp; \" of DeliveryStore \" &amp; OutAcc.DeliveryStore\n\n        End If\n\n        If OutAcc.DisplayName = drugi Then\n\n            Debug.Print \"OutAcc.DisplayName: \" &amp; OutAcc.DisplayName\n\n            Set objMailsdrugi = OutAcc.DeliveryStore.GetDefaultFolder(olFolderInbox).Items\n            Debug.Print \"Listener on \" &amp; objMailspierwszy.Parent &amp; \" of DeliveryStore \" &amp; OutAcc.DeliveryStore\n\n        End If\n\n    Next\n\nEnd Sub\n\nPrivate Sub objMailspierwszy_ItemAdd(ByVal Item As Object)\n'...\nEnd Sub\n\nPrivate Sub objMailsdrug_ItemAdd(ByVal Item As Object)\n'...\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12119208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0af3168c0f22c65459f02131855a2265?s=128&d=identicon&r=PG&f=1", "display_name": "micek2323", "link": "https://stackoverflow.com/users/12119208/micek2323"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1570195053, "creation_date": 1569419129, "last_edit_date": 1569421077, "question_id": 58099871, "link": "https://stackoverflow.com/questions/58099871/auto-export-e-mails-from-outlook-to-excel", "title": "Auto export e-mails from Outlook to Excel", "body": "<p>I've found in the internet and modified a bit a piece of code:</p>\n\n<pre><code>Public WithEvents objMails As Outlook.Items \n\nPrivate Sub Application_Startup() \nConst pierwszy = \"pierwszy@gmail.com\" \nConst drugi = \"drugi@gmail.com\" \nDim OutAcc As Account \nDebug.Print \"Startup\" \n    For Each OutAcc In Outlook.Application.Session.Accounts \n        If (OutAcc.DisplayName = pierwszy) Then \n            Set objMails = OutAcc.DeliveryStore.GetDefaultFolder(olFolderInbox).Items \n            Exit For \n        End If \n        If (OutAcc.DisplayName = drugi) Then \n            Set objMails = OutAcc.DeliveryStore.GetDefaultFolder(olFolderInbox).Items \n            Exit For \n        End If \n    Next \nEnd Sub \n\n\nPrivate Sub objMails_ItemAdd(ByVal Item As Object) \n    Dim objMail As Outlook.MailItem \n    Dim strExcelFile As String \n    Dim objExcelApp As Excel.Application \n    Dim objExcelWorkBook As Excel.Workbook \n    Dim objExcelWorkSheet As Excel.Worksheet \n    Dim nNextEmptyRow As Integer \n    Dim strColumnB As String \n    Dim strColumnC As String \n    Dim strColumnD As String \n    Dim strColumnE As String \n\n    If Item.Class = olMail Then \n       Set objMail = Item \n    End If \n\n    'Specify the Excel file which you want to auto export the email list \n    'You can change it as per your case \n    strExcelFile = \"C:\\Users\\karol\\Documents\\test.xlsx\" \n\n    'Get Access to the Excel file \n    On Error Resume Next \n    Set objExcelApp = GetObject(, \"Excel.Application\") \n    If Error &lt;&gt; 0 Then \n       Set objExcelApp = CreateObject(\"Excel.Application\") \n    End If \n    Set objExcelWorkBook = objExcelApp.Workbooks.Open(strExcelFile) \n    Set objExcelWorkSheet = objExcelWorkBook.Sheets(\"Arkusz1\") \n\n    'Get the next empty row in the Excel worksheet \n    nNextEmptyRow = objExcelWorkSheet.Range(\"B\" &amp; objExcelWorkSheet.Rows.Count).End(xlUp).Row + 1 \n\n    'Specify the corresponding values in the different columns \n    strColumnB = objMail.SenderName \n    strColumnC = objMail.SenderEmailAddress \n    strColumnD = objMail.Subject \n    strColumnE = objMail.ReceivedTime \n    strColumnF = objMail.Body \n    strColumnG = objMail.To \n\n    'Add the vaules into the columns \n    objExcelWorkSheet.Range(\"A\" &amp; nNextEmptyRow) = nNextEmptyRow - 1 \n    objExcelWorkSheet.Range(\"B\" &amp; nNextEmptyRow) = strColumnB \n    objExcelWorkSheet.Range(\"C\" &amp; nNextEmptyRow) = strColumnC \n    objExcelWorkSheet.Range(\"D\" &amp; nNextEmptyRow) = strColumnD \n    objExcelWorkSheet.Range(\"E\" &amp; nNextEmptyRow) = strColumnE \n    objExcelWorkSheet.Range(\"F\" &amp; nNextEmptyRow) = strColumnF \n    objExcelWorkSheet.Range(\"G\" &amp; nNextEmptyRow) = strColumnG \n\n    'Fit the columns from A to E \n    objExcelWorkSheet.Columns(\"A:G\").AutoFit \n\n    'Save the changes and close the Excel file \n    objExcelWorkBook.Close SaveChanges:=True \n\nEnd Sub\n</code></pre>\n\n<p>This code works fine, when in Outlook application I am logged in at one mailbox (one e-mail). I've faced a problem when I am trying to automatically export emails from two mailboxes (two accounts with different email addresses on which I am logged in to the Outlook application) - look at the picture:</p>\n\n<p><a href=\"https://ibb.co/mXWZJsw\" rel=\"nofollow noreferrer\">https://ibb.co/mXWZJsw</a></p>\n\n<p>I tried to solve this problem by using If statements in the Application_Startup () procedure (as seen in the code above). This approach, unfortunately, does not work. I also noticed that, for example, when the first email arrives at the account \"pierwszy@gmail.com\", then until the application is closed, emails will be exported to Excel only from this account \"pierwszy@gmail.com\" and not exported from the account \"drugi@gmail.com\". However, when the first e-mail arrives at the account \"drugi@gmail.com\", then emails will be exported from the seccond e-mail \"drugi@gmail.com\" until application is closed.</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "xlsm"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 1, "creation_date": 1569418140, "post_id": 58099427, "comment_id": 102590892, "body": "Please note that SO is not a free code writing platform, you should at least make an effort to try and solve your problem yourself and we&#39;ll be here to help you with problems along the way."}, {"owner": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 1, "creation_date": 1569418607, "post_id": 58099427, "comment_id": 102591185, "body": "In addition to what M. Schalk said, when you possibly edit your question with code that you have tried with, also show a few examples of the data cells contents and how the text to be extracted can be identified."}, {"owner": {"reputation": 1, "user_id": 12119187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e06b663f68444368eca07e9360ee0b?s=128&d=identicon&r=PG&f=1", "display_name": "NoScreenNames", "link": "https://stackoverflow.com/users/12119187/noscreennames"}, "edited": false, "score": 0, "creation_date": 1569420129, "post_id": 58099427, "comment_id": 102592139, "body": "&quot;Please note that SO is not a free code writing platform, you should at least make an effort .....&quot;  My mistake. I think maybe I have tried the wrong site then. I haven&#39;t tried code on this as I genuinely don&#39;t know how to get the result I want. I know how to do a loop, I can use Left/Mid/Right etc, even seen other formulas than can extract. So I have no examples as i don&#39;t know where to start.  Thanks for the feedback and direction though, appreciated."}, {"owner": {"reputation": 1, "user_id": 12119187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e06b663f68444368eca07e9360ee0b?s=128&d=identicon&r=PG&f=1", "display_name": "NoScreenNames", "link": "https://stackoverflow.com/users/12119187/noscreennames"}, "edited": false, "score": 0, "creation_date": 1569420194, "post_id": 58099427, "comment_id": 102592191, "body": "&quot;....also show a few examples of the data cells contents and how the text to be extracted can be identified.&quot;  Sorry I tried to do this in the original post, I guess it is not clear. Extracted data is the date and time of the st occurrence of Sales. I attached an image with an example.  Thanks for the feedback and direction though, appreciated."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1569423415, "post_id": 58099427, "comment_id": 102594130, "body": "No need for VBA, you can do what you want with a formula -- <a href=\"https://support.office.com/en-us/article/FIND-FINDB-functions-C7912941-AF2A-4BDF-A553-D0D89B0A0628\" rel=\"nofollow noreferrer\"><code>Find</code></a> &quot;` - <code>&quot; (space - dash - space) then get everything to the [</code>Left`](<a href=\"https://support.office.com/en-us/article/LEFT-LEFTB-functions-9203D2D2-7960-479B-84C6-1EA52B99640C\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>) of it."}], "answers": [{"comments": [{"owner": {"reputation": 1214, "user_id": 2524708, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/32AwD.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2524708/daniel"}, "edited": false, "score": 0, "creation_date": 1569504563, "post_id": 58117425, "comment_id": 102624681, "body": "Welcome @bosco_yip, thanks for answering! In the future, make use of SO&#39;s formatting features just as numbered lists and code formatting (tip: format code and references with <code>backticks</code>, using the same key as tilda). In addition to correct answers, SO also values explanations for how a solution works. Given the complexity of your answer, an explanation for <code>LEFT</code>, <code>CHAR</code>, etc. wouldn&#39;t be expected; however, a brief explanation of how you&#39;re using <code>AGGREGATE</code> and <code>FILTERXML</code> would. Good luck and hope to see much more of you here!"}], "tags": [], "owner": {"reputation": 2814, "user_id": 12125181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d1dd8c08836a0f30f03a66adddc2c3?s=128&d=identicon&r=PG", "display_name": "bosco_yip", "link": "https://stackoverflow.com/users/12125181/bosco-yip"}, "is_accepted": false, "score": 1, "last_activity_date": 1569505049, "last_edit_date": 1569505049, "creation_date": 1569503012, "answer_id": 58117425, "question_id": 58099427, "link": "https://stackoverflow.com/questions/58099427/how-to-extract-the-first-occurrence-of-a-word-date-from-a-particular-line/58117425#58117425", "title": "How to extract the first occurrence of a word (date) from a particular line?", "body": "<ol>\n<li><p>Assume your data put in <code>B3</code> and <code>B4</code></p></li>\n<li><p>In <code>C3</code>, formula copied down:</p></li>\n</ol>\n\n<p><code>=AGGREGATE(15,6,0+LEFT(FILTERXML(\"&lt;a&gt;&lt;b&gt;\"&amp;SUBSTITUTE(SUBSTITUTE(B3,CHAR(10),\"&lt;/b&gt;&lt;b&gt;\"),\"-Sales\",\"&lt;r/&gt;\")&amp;\"&lt;/b&gt;&lt;/a&gt;\",\"//b[r]\"),19),1)</code></p>\n\n<ol start=\"3\">\n<li>Then, custom cell format to: <code>dd/mm/yyyy hh:mm:ss</code></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 12119187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e06b663f68444368eca07e9360ee0b?s=128&d=identicon&r=PG&f=1", "display_name": "NoScreenNames", "link": "https://stackoverflow.com/users/12119187/noscreennames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1581566423, "creation_date": 1569417692, "last_edit_date": 1581566423, "question_id": 58099427, "link": "https://stackoverflow.com/questions/58099427/how-to-extract-the-first-occurrence-of-a-word-date-from-a-particular-line", "title": "How to extract the first occurrence of a word (date) from a particular line?", "body": "<p>I would like to loop through a column and extract the date and time from the first occurrence of a sales comment to the neighbouring cell.</p>\n\n<p>There could be a variable amount of lines in the cell and multiple entries from Sales, I need the first response date/time.</p>\n\n<p>Inside the cell the lines will always start with date and time, then name, then department, then comment. The cell then has a line break (if that's what you call it when you Alt return in a cell), then the next entry will begin.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cIMzt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cIMzt.jpg\" alt=\"Example Image\"></a></p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1569416177, "post_id": 58098843, "comment_id": 102589692, "body": "First of all you might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. \u2022 Then please tell which one is line 6 (everyone counts different). Please tell which code throws the error."}, {"owner": {"reputation": 21, "user_id": 8707816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02797a7a09cd9c85e98c7637e273b280?s=128&d=identicon&r=PG&f=1", "display_name": "Paula Hansen", "link": "https://stackoverflow.com/users/8707816/paula-hansen"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1569422198, "post_id": 58098843, "comment_id": 102593401, "body": "Sheets(&quot;Payment Ref&quot;).Range(&quot;b2&quot;).Select"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8707816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02797a7a09cd9c85e98c7637e273b280?s=128&d=identicon&r=PG&f=1", "display_name": "Paula Hansen", "link": "https://stackoverflow.com/users/8707816/paula-hansen"}, "edited": false, "score": 0, "creation_date": 1569425964, "post_id": 58099029, "comment_id": 102595637, "body": "HI.  Now I get a compile error Data Member not found.  I am working on MAC so as I said the coding may be slightly different.  The error is on this line sh.Range(&quot;K5&quot;).Copy asnd range is highlighted so guessing on MAC it has to be worded differently.  I know this works on PC but coding for working on MAC it doesn&#39;t seem to like it."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1569417228, "last_edit_date": 1569417228, "creation_date": 1569416381, "answer_id": 58099029, "question_id": 58098843, "link": "https://stackoverflow.com/questions/58098843/mac-vba-trying-to-cut-one-cell-from-each-worksheet-and-paste-in-another-sheet-in/58099029#58099029", "title": "MAC VBA Trying to cut one cell from each worksheet and paste in another sheet in next empty cell", "body": "<p>Avoid <code>.Select</code> and <code>.Activate</code> (see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>) and reference a worksheet for all your ranges (eg using <code>With</code>).</p>\n\n<p>Also you need to find the last used cell everytime you paste. A good way to find the last used cell in a column is:</p>\n\n<pre><code>Cells(Rows.Count, \"B\").End(xlUp) 'last used cell in column B\n</code></pre>\n\n<p>So the following should work for you</p>\n\n<pre><code>Dim wsDestination As Worksheet\nSet wsDestination = ThisWorkbook.Worksheets(\"Payment Ref\")\n\nFor Each sh In ThisWorkbook.Worksheets    \n    sh.Range(\"K5\").Copy\n\n    With wsDestination.Cells(wsDestination.Rows.Count, \"B\").End(xlUp).Offset(RowOffset:=1)\n        .PasteSpecial Paste:=xlPasteFormats\n        .PasteSpecial Paste:=xlPasteValues\n    End With\nNext sh\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1569416718, "post_id": 58099041, "comment_id": 102590054, "body": "Feel free to downvote, but please also let me know your suggestions on improving my answer, no way to learn otherwise."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1569416823, "post_id": 58099041, "comment_id": 102590117, "body": "Not my dv, but are you sure you wanted to paste on <code>sh</code>? Doesn&#39;t look like that&#39;s what OP wanted."}, {"owner": {"reputation": 21, "user_id": 8707816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02797a7a09cd9c85e98c7637e273b280?s=128&d=identicon&r=PG&f=1", "display_name": "Paula Hansen", "link": "https://stackoverflow.com/users/8707816/paula-hansen"}, "edited": false, "score": 0, "creation_date": 1569422419, "post_id": 58099041, "comment_id": 102593539, "body": "Thanks all.  I&#39;ll try suggestions and let you know how it goes.  Thanks for the .select tip"}, {"owner": {"reputation": 21, "user_id": 8707816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02797a7a09cd9c85e98c7637e273b280?s=128&d=identicon&r=PG&f=1", "display_name": "Paula Hansen", "link": "https://stackoverflow.com/users/8707816/paula-hansen"}, "edited": false, "score": 0, "creation_date": 1569426085, "post_id": 58099041, "comment_id": 102595707, "body": "Hi.  Also tried this and I get an error on this line: sh.Range(&quot;K5&quot;).Copy Sheets(&quot;Payment Ref&quot;).Cells(Rows.Count, 2).End(xlUp).Offset(1, 0) .  with Range highlighted - compile error data member not found.  As I said I am working on MAC so maybe the code is slightly different."}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": false, "score": -1, "last_activity_date": 1569417171, "last_edit_date": 1569417171, "creation_date": 1569416425, "answer_id": 58099041, "question_id": 58098843, "link": "https://stackoverflow.com/questions/58098843/mac-vba-trying-to-cut-one-cell-from-each-worksheet-and-paste-in-another-sheet-in/58099041#58099041", "title": "MAC VBA Trying to cut one cell from each worksheet and paste in another sheet in next empty cell", "body": "<p>You should avoid using <code>.Select</code> in general, as linked in the comments. This is most likely the cause for your error. Also, if you perform this code on more than 1 or 2 worksheets (depending on if <code>B2</code> already has a value) the procedure will keep putting the values in cell <code>B3</code>. I'd suggest the following changes:</p>\n\n<pre><code>For Each sh In ThisWorkbook.Worksheets\n    sh.Range(\"K5\").Copy\n    Sheets(\"Payment Ref\").Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteFormats\n    Sheets(\"Payment Ref\").Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\nNext sh\n</code></pre>\n\n<p>I think this should work just as well:</p>\n\n<pre><code>For Each sh In ThisWorkbook.Worksheets\n    sh.Range(\"K5\").Copy Sheets(\"Payment Ref\").Cells(Rows.Count, 2).End(xlUp).Offset(1, 0)\nNext sh\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8707816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02797a7a09cd9c85e98c7637e273b280?s=128&d=identicon&r=PG&f=1", "display_name": "Paula Hansen", "link": "https://stackoverflow.com/users/8707816/paula-hansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1581926698, "creation_date": 1569415830, "last_edit_date": 1581926698, "question_id": 58098843, "link": "https://stackoverflow.com/questions/58098843/mac-vba-trying-to-cut-one-cell-from-each-worksheet-and-paste-in-another-sheet-in", "title": "MAC VBA Trying to cut one cell from each worksheet and paste in another sheet in next empty cell", "body": "<p>I am trying to go through each worksheet in the active workbook in which the sheets are created as part of a macro that is working.  The names can be different each time, so I can't just do a lookup.  I want to take one piece of information (same cell on each worksheet) and paste it into the next empty cell in a column on another sheet.  </p>\n\n<p>At line 6 I get the error subscript out of range error 9.  I've checked the naming of the sheet I am pasting to and it is correct.  No extra spaces.</p>\n\n<p>It's driving me nuts.  Can you help?</p>\n\n<p>ps I am working on this to run on a MAC which I normally don't do, so maybe I have the code slightly wrong.</p>\n\n<pre><code>For Each sh In ThisWorkbook.Worksheets\nDoEvents\n\n    sh.Activate\n    Range(\"K5\").Select\n    Selection.Copy\n    Sheets(\"Payment Ref\").Range(\"b2\").Select\n    If Range(\"b2\") = \"\" Then\n    Range(\"b2\").PasteSpecial Paste:=xlPasteFormats\n    Range(\"b2\").PasteSpecial Paste:=xlPasteValues\n     Else\n    Range(\"b2\").Offset(1, 0).PasteSpecial xlPasteFormats\n    Range(\"b2\").Offset(1, 0).PasteSpecial xlPasteValues\n    End If\n\n\nNext sh\n</code></pre>\n\n<p>At the end of the run the Payment Ref Spreadsheet should have a column filled with invoice numbers from the invoice sheets created in the previous macro section.  This works perfectly.</p>\n"}, {"tags": ["excel", "vba", "google-sheets-macros"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569420875, "post_id": 58098800, "comment_id": 102592599, "body": "Please edit the question to include the errors and the lines that cause them."}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1569420863, "creation_date": 1569420863, "answer_id": 58100476, "question_id": 58098800, "link": "https://stackoverflow.com/questions/58098800/emulate-simple-vba-macro-to-be-compatible-with-google-sheets/58100476#58100476", "title": "Emulate simple VBA macro to be compatible with Google Sheets", "body": "<p>You only have one minor issue. </p>\n\n<p>In the first statement, you're getting the <code>spreadsheet</code> object, but you need the <code>sheet</code> object. So <code>getSheets()[0]</code> will get you the first worksheet.</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>function SELECTIE() {\n  var ss = SpreadsheetApp.getActive().getSheets()[0];\n  var cVal = ss.getRange('A16').getValue();\n  ss.getRange('D1:T' + cVal).activate();\n}\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 11950331, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAcuQ9mew9B3S-CSIDj_InuuR7J47WRX5sBVk2S=k-s128", "display_name": "Richa", "link": "https://stackoverflow.com/users/11950331/richa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 58100476, "answer_count": 1, "score": 2, "last_activity_date": 1569420863, "creation_date": 1569415719, "last_edit_date": 1569416249, "question_id": 58098800, "link": "https://stackoverflow.com/questions/58098800/emulate-simple-vba-macro-to-be-compatible-with-google-sheets", "title": "Emulate simple VBA macro to be compatible with Google Sheets", "body": "<p>How can I convert this simple VBA to Google Sheets?</p>\n\n<pre><code>Sub SELECT()\n\nDim Cval As Variant\nCval = Sheet4.Range(\"A16\").Value\nSheet4.Range(\"D1:T\" &amp; Cval).Select\n\nEnd Sub\n</code></pre>\n\n<p>I keep getting errors while trying to use this macro in Google Sheets and I cannot find the issue.</p>\n\n<p>The code I'm currently working on in Google Sheets:</p>\n\n<pre><code>function SELECTIE() {\n  var spreadsheet = SpreadsheetApp.getActive();\n  var Cval = spreadsheet.getRange(\"A16\").Value\n  spreadsheet.getRange(\"D1:T\" &amp; Cval).activate();\n};\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 14, "user_id": 10379082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/291f9439d0c06b2549ac372c487230cf?s=128&d=identicon&r=PG&f=1", "display_name": "Neelavathy", "link": "https://stackoverflow.com/users/10379082/neelavathy"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569419775, "post_id": 58099820, "comment_id": 102591894, "body": "Yes,i am new to stackoverflow,I do not know to tage it,,so thought this code would help him"}], "tags": [], "owner": {"reputation": 14, "user_id": 10379082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/291f9439d0c06b2549ac372c487230cf?s=128&d=identicon&r=PG&f=1", "display_name": "Neelavathy", "link": "https://stackoverflow.com/users/10379082/neelavathy"}, "is_accepted": false, "score": -1, "last_activity_date": 1569419061, "last_edit_date": 1569419061, "creation_date": 1569418981, "answer_id": 58099820, "question_id": 58098785, "link": "https://stackoverflow.com/questions/58098785/vba-code-to-add-comment-only-after-the-initial-cell-value-is-changed/58099820#58099820", "title": "VBA Code to add comment only AFTER the INITIAL cell value is changed?", "body": "<p>Copy and create the same table in same sheet, have it hidden ,</p>\n\n<pre><code>Sub CopyCurrentTable()\n\n    Application.ScreenUpdating = False\n    With shtMapping\n        .Range(\"E4:G1000\").ClearContents 'which value to which value you are copying\n        .Range(\"B4:D\" &amp; GetLastRow(shtMapping, \"B\", 4)).Copy ' starting postion\n        .Range(\"E4\").PasteSpecial xlPasteAll \n        Application.CutCopyMode = False\n    End With\n\nEnd Sub\nSub LogAuditTrail()\n\n    Dim colOld As Collection\n    Dim colNew As Collection\n    Dim objNew As ClsMapping\n    Dim objOld As ClsMapping\n    Set colOld = getMappingData(\"E\")\n    Set colNew = getMappingData(\"B\")\n    Dim sTS As String\n\n    sTS = Format(Now, \"dd-mmm-yyy hh:mm:ss\")\n\n    For Each objNew In colNew\n        'Detect Items Changed\n        If ItemIsInCollection(colOld, objNew.getKey) Then\n            Set objOld = colOld(objNew.getKey)\n            If objNew.isDifferent(objOld) Then\n                Call PlotToAudit(objNew, objOld, sTS, \"Change\")\n            End If\n        Else\n            'Detect Items Added\n            Set objOld = New ClsMapping\n            Call PlotToAudit(objNew, objOld, sTS, \"New\")\n        End If\n    Next objNew\n\n    'Detect Items removed\n    For Each objOld In colOld\n        If Not ItemIsInCollection(colNew, objOld.getKey) Then\n            Set objNew = New ClsMapping\n            Call PlotToAudit(objNew, objOld, sTS, \"Removed\")\n        End If\n    Next objOld\n\nEnd Sub\n\nSub PlotToAudit(obj1 As ClsMapping, obj2 As ClsMapping, sTS As String, sType As String)\n\n    Dim lRow As Long\n    lRow = shtAudit.Range(\"B1048576\").End(xlUp).Row\n\n    If lRow = 3 Then\n        lRow = 5\n    ElseIf lRow = 1048576 Then\n        MsgBox \"Audit sheet is full. Contact Support.\" &amp; vbNewLine &amp; \"No audit trail will be saved\", vbCritical, \"ERROR\"\n        Exit Sub\n    Else\n        lRow = lRow + 1\n    End If\n\n    With shtAudit\n        .Unprotect g_sPassword\n        .Range(\"B\" &amp; lRow).value = Application.UserName &amp; \"(\" &amp; Environ(\"USERNAME\") &amp; \")\"\n        .Range(\"C\" &amp; lRow).value = sTS\n        .Range(\"D\" &amp; lRow).value = sType\n\n        Select Case sType\n            Case \"Removed\"\n                .Range(\"E\" &amp; lRow).value = \"\"\n                .Range(\"F\" &amp; lRow).value = \"\"\n                .Range(\"G\" &amp; lRow).value = \"\"\n                .Range(\"H\" &amp; lRow).value = obj2.FundCode\n                .Range(\"I\" &amp; lRow).value = obj2.Subs\n                .Range(\"J\" &amp; lRow).value = obj2.Reds\n            Case \"New\"\n                .Range(\"E\" &amp; lRow).value = obj1.FundCode\n                .Range(\"F\" &amp; lRow).value = obj1.Subs\n                .Range(\"G\" &amp; lRow).value = obj1.Reds\n                .Range(\"H\" &amp; lRow).value = \"\"\n                .Range(\"I\" &amp; lRow).value = \"\"\n                .Range(\"J\" &amp; lRow).value = \"\"\n            Case \"Change\"\n                .Range(\"E\" &amp; lRow).value = obj1.FundCode\n                .Range(\"F\" &amp; lRow).value = obj1.Subs\n                .Range(\"G\" &amp; lRow).value = obj1.Reds\n                .Range(\"H\" &amp; lRow).value = obj2.FundCode\n                .Range(\"I\" &amp; lRow).value = obj2.Subs\n                .Range(\"J\" &amp; lRow).value = obj2.Reds\n        End Select\n        With .Range(\"B\" &amp; lRow &amp; \":J\" &amp; lRow)\n            .Interior.Color = vbWhite\n            .Borders.LineStyle = xlContinuou\n        End With\n        .Protect g_sPassword\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 12119004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31669530cb23549bd152b1f6c0326bd0?s=128&d=identicon&r=PG&f=1", "display_name": "OnTheHunt", "link": "https://stackoverflow.com/users/12119004/onthehunt"}, "edited": false, "score": 0, "creation_date": 1569428164, "post_id": 58100479, "comment_id": 102596666, "body": "The code did not work. I think the part that needs to be changed is the &quot;nothing&quot;. What&#39;s the correct way of saying &quot;If the cells contain initial values, do nothing, if they are changed then add comment&quot;?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 9, "user_id": 12119004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31669530cb23549bd152b1f6c0326bd0?s=128&d=identicon&r=PG&f=1", "display_name": "OnTheHunt", "link": "https://stackoverflow.com/users/12119004/onthehunt"}, "edited": false, "score": 0, "creation_date": 1569475483, "post_id": 58100479, "comment_id": 102610007, "body": "what does &quot;not work&quot; actually mean? I tested it and it worked as per your question requirements."}, {"owner": {"reputation": 9, "user_id": 12119004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31669530cb23549bd152b1f6c0326bd0?s=128&d=identicon&r=PG&f=1", "display_name": "OnTheHunt", "link": "https://stackoverflow.com/users/12119004/onthehunt"}, "edited": false, "score": 0, "creation_date": 1569502174, "post_id": 58100479, "comment_id": 102623348, "body": "On my userform, when i click &quot;submit&quot; the information is stored on the respective cells. I do not want the comment to show at this point. I only want the comment to show if the user edits/change the information that was stored after hitting submit from the userform."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1569420867, "creation_date": 1569420867, "answer_id": 58100479, "question_id": 58098785, "link": "https://stackoverflow.com/questions/58098785/vba-code-to-add-comment-only-after-the-initial-cell-value-is-changed/58100479#58100479", "title": "VBA Code to add comment only AFTER the INITIAL cell value is changed?", "body": "<p>you can use a <em>helper</em> array to temporary store all of current cell comments and get the sensitive text out of the last recorded comment to compare with current cell content</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim singleCell As Range\n\n    Dim commentsArray As Variant 'array to hold all singleCell comments\n    Dim oldText As String ' string to hold last comment sensitive content\n\n    If Target.Cells.CountLarge &gt; 1000 Then Exit Sub\n\n\n    For Each singleCell In Target\n\n        If singleCell.Comment Is Nothing Then\n            singleCell.AddComment Now &amp; \" - \" &amp; singleCell.Value &amp; \" - \" &amp; Environ(\"UserName\")\n        Else\n\n            commentsArray = Split(singleCell.Comment.Text, vbNewLine) ' fill the array with current singleCell comments\n            oldText = CStr(Split(commentsArray(UBound(commentsArray)), \" - \")(1)) ' extract last recorded comment sensitive text\n\n            'update comment if current cell value differs from last recorded comment sensitive text\n            If oldText &lt;&gt; CStr(singleCell.Value2) Then _\n                singleCell.Comment.Text _\n                vbNewLine &amp; Now &amp; \" - \" &amp; singleCell.Value &amp; \" - \" &amp; Environ(\"UserName\") _\n                , Len(singleCell.Comment.Text) + 1 _\n                , False\n\n        End If\n\n        singleCell.Comment.Shape.TextFrame.AutoSize = True\n\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 12119004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31669530cb23549bd152b1f6c0326bd0?s=128&d=identicon&r=PG&f=1", "display_name": "OnTheHunt", "link": "https://stackoverflow.com/users/12119004/onthehunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1569420867, "creation_date": 1569415665, "last_edit_date": 1569416290, "question_id": 58098785, "link": "https://stackoverflow.com/questions/58098785/vba-code-to-add-comment-only-after-the-initial-cell-value-is-changed", "title": "VBA Code to add comment only AFTER the INITIAL cell value is changed?", "body": "<p>I have a data entry form that let's users enter the data into specific cells. What i want is a way to track changes to the cell values. When the data entered initially through the entry form, i don't want that information to be tracked. However, if the user tries to change/edit the data that was entered then i want to add a comment to show the initial value and the amended one as well. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n   Dim singlecell As Range\n\n    If Target.Cells.CountLarge &gt; 1000 Then Exit Sub\n\n    For Each singlecell In Target\n\n        If singlecell.Comment Is Nothing Then\n            singlecell.AddComment Now &amp; \" - \" &amp; singlecell.Value &amp; \" - \" &amp; Environ(\"UserName\")\n        Else\n            singlecell.Comment.Text _\n                vbNewLine &amp; Now &amp; \" - \" &amp; singlecell.Value &amp; \" - \" &amp; Environ(\"UserName\") _\n                , Len(singlecell.Comment.Text) + 1 _\n                , False\n\n        End If\n\n        singlecell.Comment.Shape.TextFrame.AutoSize = True\n\n    Next singlecell\n\nEnd Sub\n</code></pre>\n\n<p>The code i tried adds a comment when the information from the entry form is submitted. However I don't need the comment to show just yet, I only want it when the user changes the initial cell value.</p>\n"}, {"tags": ["vba", "templates", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569416493, "post_id": 58098339, "comment_id": 102589897, "body": "Your problem description is unclear... <b>Where</b> (in what module) is the macro? <code>Document_Open</code> <i>must</i> be in the <code>ThisDocument</code> module. Otherwise, use <code>Sub AutoOpen</code>. I do not know what you mean by &quot;...change the document template on my created template.&quot; But what happens if you double-click the template with the macro to create a new document based on that template, save it, then re-open?"}, {"owner": {"reputation": 1, "user_id": 12118985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a41dd2c17899722552fbcdfc622d4b6?s=128&d=identicon&r=PG&f=1", "display_name": "ukzrsuwy5p", "link": "https://stackoverflow.com/users/12118985/ukzrsuwy5p"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569421949, "post_id": 58098339, "comment_id": 102593240, "body": "Document_Open  in the ThisDocument. In case if i double-click the template with the macro to create a new document based on that template, save it, then re-open then macro does not work."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569422760, "post_id": 58098339, "comment_id": 102593743, "body": "Go into <code>ThisDocument</code>. Select all the lines of the macro and click the &quot;Comment&quot; button (puts a <code>&#39;</code> in front of them). Go to the drop-down at the top-left of the code window and select <code>Document</code>. Go to the drop-down next to it, at the right, and select <code>Open</code>. This will write the code stub for you, with the correct syntax. Put in your test <code>MsgBox</code> and test again."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569422804, "post_id": 58098339, "comment_id": 102593759, "body": "Note: don&#39;t forget to use the <code>@</code> symbol to ensure people get notifications when you answer in comments. For example: @cindymeister"}, {"owner": {"reputation": 1, "user_id": 12118985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a41dd2c17899722552fbcdfc622d4b6?s=128&d=identicon&r=PG&f=1", "display_name": "ukzrsuwy5p", "link": "https://stackoverflow.com/users/12118985/ukzrsuwy5p"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569483820, "post_id": 58098339, "comment_id": 102613606, "body": "@cindymeister What&#39;s this Document tab? In the macro editing window? In the main window the Word? Did you manage to repeat my situation? Did the macro work?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569504963, "post_id": 58098339, "comment_id": 102624918, "body": "You said in a comment that you have <code>Document_Open</code> in the <code>ThisDocument</code> code module. So select/display that code module - thus, you&#39;re in the &quot;macro editing window&quot;. Comment out that macro. Use the <b><i>dropdown boxes</i></b> at the top of the window to first select <code>Document</code> from the list on the left; then <code>Open</code> from the list on the right."}], "owner": {"reputation": 1, "user_id": 12118985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a41dd2c17899722552fbcdfc622d4b6?s=128&d=identicon&r=PG&f=1", "display_name": "ukzrsuwy5p", "link": "https://stackoverflow.com/users/12118985/ukzrsuwy5p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569416327, "creation_date": 1569414337, "last_edit_date": 1569416327, "question_id": 58098339, "link": "https://stackoverflow.com/questions/58098339/document-open-does-not-work-in-word-2007-template", "title": "Document_Open does not work in Word 2007 template", "body": "<p>For employees to work, I need to put some functionality into the Document_Open macro. I want to put this macro in a template (.dot) and place it on the network. Office 2007 is installed on most machines, and I'm testing on it.</p>\n\n<p>I create a document, insert the macro code, save it as a template (.dot). I use the following macro code as a test:</p>\n\n<pre><code>Sub Document_Open()\nMsgBox \"ABC\" \nEnd Sub\n</code></pre>\n\n<p>Next, I create a document (.doc) and change the document template on my created template. I allow the execution of macros, the macro work. I save and close the document, when I reopen the document and enable macros, our macro does not work. What the problem is I can\u2019t understand. Thank! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "edited": false, "score": 2, "creation_date": 1569414588, "post_id": 58098328, "comment_id": 102588658, "body": "You can record a macro while doing this action manually with selecting the <code>B1</code> cell, jumping down the entire range by pressing <code>shift+ctrl+(down)</code>, cutting, jumping down to the last record in the <code>A</code> column and pasting. Then open the macro and parameterize the code to also work for other columns, to check if any first row in a column holds data, etc..."}, {"owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "edited": false, "score": 2, "creation_date": 1569414666, "post_id": 58098328, "comment_id": 102588721, "body": "Also, Stack Overflow will not write code for you from scratch; show that you&#39;ve done some preliminary work and ask about a specific point where the code fails. Please <a href=\"https://stackoverflow.com/tour\">take the tour</a> to learn more about the SO-format."}], "answers": [{"tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": false, "score": 0, "last_activity_date": 1569415397, "creation_date": 1569415397, "answer_id": 58098707, "question_id": 58098328, "link": "https://stackoverflow.com/questions/58098328/need-excel-vba-to-copy-columm-b-c-d-to-the-column-a/58098707#58098707", "title": "Need Excel VBA to copy columm B, C, D... to the column A", "body": "<p>I'd suggest the following code:</p>\n\n<pre><code>Sub consolidateColumns()\n\nDim lr As Long, lr2 As Long\n\nWith ActiveSheet 'Replace with the worksheet you need, avoid using ActiveSheet\n    lr = .Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 2 To 3 'Adjust the 3 to however many columns you need\n        lr2 = .Cells(Rows.Count, i).End(xlUp).Row\n        .Range(.Cells(1, i), .Cells(lr2, i)).Cut .Cells(lr + 1, 1)\n        lr = lr + lr2\n    Next i\nEnd With\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>To make it shorter, but harder to read at first you could also use the following code:</p>\n\n<pre><code>Sub consolidateColumns()\n\nWith ActiveSheet 'Replace with the worksheet you need, avoid using ActiveSheet\n    For i = 2 To 3 'Adjust the 3 to however many columns you need\n        .Range(.Cells(1, i), .Cells(.Cells(Rows.Count, i).End(xlUp).Row, i)).Cut .Cells(.Cells(Rows.Count, 1).End(xlUp).Row + 1, 1)\n    Next i\nEnd With\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 323, "user_id": 12089232, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfPL0FhSRKDbRwRWWDzMUtNrVlMgKovxcm8ZNZ=k-s128", "display_name": "Dhirendra Kumar", "link": "https://stackoverflow.com/users/12089232/dhirendra-kumar"}, "is_accepted": true, "score": 0, "last_activity_date": 1569415505, "creation_date": 1569415505, "answer_id": 58098734, "question_id": 58098328, "link": "https://stackoverflow.com/questions/58098328/need-excel-vba-to-copy-columm-b-c-d-to-the-column-a/58098734#58098734", "title": "Need Excel VBA to copy columm B, C, D... to the column A", "body": "<p>Use following code to achieve it:</p>\n\n<pre><code>Sub Collate()\nDim Pos As Long, Col As Integer, TotCols As Integer\n\nTotCols = Range(\"A1\").End(xlToRight).Column\n\nFor Col = 2 To TotCols\n    Pos = Range(\"A1\").End(xlDown).Row + 1 'To get the last available row\n    Range(Cells(1, Col), Cells(1, Col).End(xlDown)).Copy Range(\"A\" &amp; Pos)\n\n    'To remove data from columns\n    Range(Cells(1, Col), Cells(1, Col).End(xlDown)).Clear\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12118946, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCzvCeg1dpeD9Xzm5Z4_wkMl3UQ-NKmlBFQna79=k-s128", "display_name": "Nhan Nguyen", "link": "https://stackoverflow.com/users/12118946/nhan-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "closed_date": 1569416898, "accepted_answer_id": 58098734, "answer_count": 2, "score": -3, "last_activity_date": 1569415505, "creation_date": 1569414303, "last_edit_date": 1569415111, "question_id": 58098328, "link": "https://stackoverflow.com/questions/58098328/need-excel-vba-to-copy-columm-b-c-d-to-the-column-a", "closed_reason": "Needs more focus", "title": "Need Excel VBA to copy columm B, C, D... to the column A", "body": "<p>I have problem that I need your help. I need code VBA to copy column B,C...\nto the column A, attached image. Can someone give me a solution?</p>\n\n<p><a href=\"https://i.stack.imgur.com/wkOEF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wkOEF.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1569414481, "post_id": 58098288, "comment_id": 102588592, "body": "You could do this using an array formula using <code>match</code> and <code>row</code>  Something like this, using E and F as columns <code>IF(NOT(ISERROR(MATCH($F$1:$F$6,$E$1:$E$6,0))),ROW($E$1:$E$6)&zwnj;&#8203;)</code>  gives you an array of the row numbers where F is found in E"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1569414568, "post_id": 58098288, "comment_id": 102588642, "body": "Could you specify your inputs and desired outputs? If a signal exists in column A and B you want it returned in column C, is that correct?"}, {"owner": {"reputation": 5, "user_id": 10225132, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NCq5l_xiydk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qHiMUi6iXPlXn6lbRM-Hyyqay1UQ/mo/photo.jpg?sz=128", "display_name": "Sam Shang", "link": "https://stackoverflow.com/users/10225132/sam-shang"}, "edited": false, "score": 0, "creation_date": 1569416629, "post_id": 58098288, "comment_id": 102589983, "body": "Thanks you guys for quick reply. Nathan, I am trying your method now, feedback to you in a bit. M. Schalk , my desire output will be the the same signal seen in both column A and B for each cell. Note that each cell have multiple signals.(see the pic for more details)"}, {"owner": {"reputation": 5, "user_id": 10225132, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NCq5l_xiydk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qHiMUi6iXPlXn6lbRM-Hyyqay1UQ/mo/photo.jpg?sz=128", "display_name": "Sam Shang", "link": "https://stackoverflow.com/users/10225132/sam-shang"}, "edited": false, "score": 0, "creation_date": 1569417622, "post_id": 58098288, "comment_id": 102590608, "body": "Hi Nathan, you formula seem to return row number, which is not what I am looking for. E,g, in the first cell, it contains signal (A, E,F), Database column B have (A,B,C D) four rows. The common signal is A, I would like signal A return in another column (should be same row number with (A,E,F). Thanks"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1569433168, "post_id": 58098288, "comment_id": 102598861, "body": "@SamShang yes, it&#39;s not an answer, it&#39;s where to start.  Then you can use &#39;offset&#39; maybe or something else to use the row numbers."}, {"owner": {"reputation": 336, "user_id": 7078182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f6946b5a191af0780e74a38af91e?s=128&d=identicon&r=PG", "display_name": "Roger H.", "link": "https://stackoverflow.com/users/7078182/roger-h"}, "edited": false, "score": 0, "creation_date": 1569607683, "post_id": 58098288, "comment_id": 102665518, "body": "@Sam Shang: You may have to modify the first cell reference if your cells have extra spaces: TRIM(A1) ...  TRIM(B1)  -else it will have errors."}], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 7078182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f6946b5a191af0780e74a38af91e?s=128&d=identicon&r=PG", "display_name": "Roger H.", "link": "https://stackoverflow.com/users/7078182/roger-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1569607172, "creation_date": 1569607172, "answer_id": 58139436, "question_id": 58098288, "link": "https://stackoverflow.com/questions/58098288/search-and-return-in-excel-vba-or-formula/58139436#58139436", "title": "Search and return in Excel VBA or Formula", "body": "<p>I found your problem to be interesting (and a bit challenging). Put this formula in the \"Return\" Column and copy down as needed. It will support up to seven characters in Column A.You can edit it manually if Column A exceeds this amount in the formula:</p>\n\n<p>=IFERROR(IF(SEARCH(B1,A1,1)>0,B1,\"\")&amp;IF(COUNTIF(B2:B$100,MID(A1,1,1))>0,MID(A1,1,1),\"\")&amp;IF(COUNTIF(B2:B$100,MID(A1,2,1))>0,MID(A1,2,1),\"\")&amp;IF(COUNTIF(B2:B$100,MID(A1,3,1))>0,MID(A1,3,1),\"\")&amp;IF(COUNTIF(B2:B$100,MID(A1,4,1))>0,MID(A1,4,1),\"\")&amp;IF(COUNTIF(B2:B$100,MID(A1,5,1))>0,MID(A1,5,1),\"\")&amp;IF(COUNTIF(B2:B$100,MID(A1,6,1))>0,MID(A1,6,1),\"\")&amp;IF(COUNTIF(B2:B$100,MID(A1,7,1))>0,MID(A1,7,1),\"\"),\"\")</p>\n"}], "owner": {"reputation": 5, "user_id": 10225132, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NCq5l_xiydk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qHiMUi6iXPlXn6lbRM-Hyyqay1UQ/mo/photo.jpg?sz=128", "display_name": "Sam Shang", "link": "https://stackoverflow.com/users/10225132/sam-shang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569607172, "creation_date": 1569414174, "last_edit_date": 1569424852, "question_id": 58098288, "link": "https://stackoverflow.com/questions/58098288/search-and-return-in-excel-vba-or-formula", "title": "Search and return in Excel VBA or Formula", "body": "<p>I am looking for returning anything that is in Bin column as shown in the picture. Basically, in the first column, it may or may not contain some signals that are in Column B. I would like to return any signals in column B as a new column and ignore any signals that are not in Column B.\nAny idea, what is the best way? Formula or VBA. Just to be clear, column 3 is what I want to output.\n<a href=\"https://i.stack.imgur.com/tlWVV.jpg\" rel=\"nofollow noreferrer\">Search and return signals</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1569412703, "post_id": 58097752, "comment_id": 102587536, "body": "Sounds like either <code>ThisWorkbook</code> doesn&#39;t have a sheet named &quot;Total usage&quot;, or <code>wb</code> doesn&#39;t have a sheet named &quot;Substances List 2019&quot;. Check for trailing spaces, typos, etc."}, {"owner": {"reputation": 83, "user_id": 10543998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b4a6dea15c4d55c424c8d8ad1166f8?s=128&d=identicon&r=PG&f=1", "display_name": "Meliodus123", "link": "https://stackoverflow.com/users/10543998/meliodus123"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569413986, "post_id": 58097752, "comment_id": 102588280, "body": "Yeah, that was weird, I copy pasted both of the names of the sheets and I guess one of them was wrong because it is working now. Thank you!"}, {"owner": {"reputation": 83, "user_id": 10543998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b4a6dea15c4d55c424c8d8ad1166f8?s=128&d=identicon&r=PG&f=1", "display_name": "Meliodus123", "link": "https://stackoverflow.com/users/10543998/meliodus123"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569415673, "post_id": 58097752, "comment_id": 102589380, "body": "I lied @BigBen am getting the same error, I don&#39;t know why, even after copy pasting."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569415746, "post_id": 58097752, "comment_id": 102589426, "body": "What line throws the error?"}, {"owner": {"reputation": 83, "user_id": 10543998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b4a6dea15c4d55c424c8d8ad1166f8?s=128&d=identicon&r=PG&f=1", "display_name": "Meliodus123", "link": "https://stackoverflow.com/users/10543998/meliodus123"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569415829, "post_id": 58097752, "comment_id": 102589471, "body": "The &quot;ThisWorkbook.Sheets(&quot;Total usage&quot;).Cells(2, 5).Value = _            wb.Sheets(&quot;Substances List 2019&quot;).Cells(rng.Row, 2).Value&quot; , but I have double checked that total usage and substances list 2019 are the right names."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569415982, "post_id": 58097752, "comment_id": 102589569, "body": "Ok so try to eliminate potential problems. You can use the worksheet codename instead of <code>ThisWorkbook.Sheets(&quot;Total usage&quot;)</code>. You can find the codename in the VB editor - there&#39;s the list of sheets in the top left corner. If you still get the error after that, then <code>&quot;Substances List 2019&quot;</code> is not the name of the sheet in <code>wb</code>."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1569416212, "post_id": 58097752, "comment_id": 102589712, "body": "@BigBen - yup - my mistake, I read it as <code>ActiveWorkbook</code> in my mind. Comment removed."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1569416319, "post_id": 58097752, "comment_id": 102589783, "body": "@CLR makes sense - original comment removed as well."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1569423368, "post_id": 58097752, "comment_id": 102594102, "body": "I too think first BigBen comment should address the cause. Try substituting <code>ThisWorkbook.Sheets(&quot;Total usage&quot;).Cells(2, 5).Value = _            wb.Sheets(&quot;Substances List 2019&quot;).Cells(rng.Row, 2).Value </code> with <code>ThisWorkbook.Sheets(&quot;Total usage&quot;).Cells(2, 5).Value =1</code> and see if the problem lies in &quot;Substances List 2019&quot; field. If its doesn&#39;t throw any error it must reside in <code>wb.Sheets(&quot;Substances List 2019&quot;).Cells(rng.Row, 2).Value</code>"}], "owner": {"reputation": 83, "user_id": 10543998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b4a6dea15c4d55c424c8d8ad1166f8?s=128&d=identicon&r=PG&f=1", "display_name": "Meliodus123", "link": "https://stackoverflow.com/users/10543998/meliodus123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569412475, "creation_date": 1569412475, "question_id": 58097752, "link": "https://stackoverflow.com/questions/58097752/getting-subscript-our-range", "title": "Getting subscript our range", "body": "<p>I am trying to make a find a number in another workbook then copy column 2 of the corresponding row into cell (B5) of the original document. The code itself runs but I keep getting a run time error subscript out of range. </p>\n\n<pre><code>Sub findsomething()\n\nDim rng As Range\nDim account As String\nDim rownumber As Long\nDim dehyp As Long\nDim wb As Workbook\n\naccount = Replace(Range(\"A5\").Value, \"-\", \"\")\nSet wb = Workbooks.Open( _\n  \"L:\\PRS\\CEPA\\Chemicals Management Plan\\!Overviews and Summaries\\\" &amp; _\n  \"List-of-substances-in-the-third-phase-of-CMP-(2016-2021).xlsx\")\n\nSet rng = wb.Sheets(\"Substances List 2019\").Columns(1).Find(What:=account, _\n    LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, _\n    SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\nIf Not rng Is Nothing Then\n    ThisWorkbook.Sheets(\"Total usage\").Cells(2, 5).Value = _\n           wb.Sheets(\"Substances List 2019\").Cells(rng.Row, 2).Value\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I have looked through other stack over flow queries and it says vsubscript does not recognize excel constants, which I can not understand. So if any one could offer any solutions or an explanation to tell me how to fix the code, ti would be much appreciated!</p>\n"}, {"tags": ["vba", "outlook", "attachment"], "answers": [{"tags": [], "owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "is_accepted": true, "score": 0, "last_activity_date": 1569431935, "creation_date": 1569431935, "answer_id": 58103577, "question_id": 58097583, "link": "https://stackoverflow.com/questions/58097583/how-do-i-add-date-to-attachment-name/58103577#58103577", "title": "How do I add date to attachment name?", "body": "<p>Updated your code below to append the date BEFORE the display file name.  We do this by using DATEADD and adding -1 days to the recieved date and FORMATting the datetime value into a date value with \"-\"s instead of \"/\"s.</p>\n\n<p>If you're looking to add it AFTER the filename but before the extension, we'll need to parse to filename.</p>\n\n<pre><code>Public Sub SaveAutoAttach(item As Outlook.MailItem)\n\nDim object_attachment As Outlook.Attachment\n\nDim saveFolder As String\n' Folder location when I want to save my file\nsaveFolder = \"\\\\gbhxxxx\\Groups\\Shared\\EBS\\Post Go-Live\\Auto MT940 download Test\"\n\n\n    For Each object_attachment In item.Attachments\n' Criteria to save .940 files only\n\n    If InStr(object_attachment.DisplayName, \"UKAutoMT940\") Then\n\n       object_attachment.SaveAsFile saveFolder &amp; \"\\\" &amp; Format(DateAdd(\"d\", -1, item.ReceivedTime), \"dd-mm-yyyy\") &amp; \"_\" &amp; object_attachment.DisplayName\n    End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12118730, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xskiOrwNfzg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezSCOiXJGDqdIdi9FNcnvniUTpcg/photo.jpg?sz=128", "display_name": "Raj Das", "link": "https://stackoverflow.com/users/12118730/raj-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 58103577, "answer_count": 1, "score": 0, "last_activity_date": 1572816592, "creation_date": 1569411781, "last_edit_date": 1572816592, "question_id": 58097583, "link": "https://stackoverflow.com/questions/58097583/how-do-i-add-date-to-attachment-name", "title": "How do I add date to attachment name?", "body": "<p>My VBA code downloads attachments from emails to my local drive. I would like to rename the attachments to include the date. The date should be the day before the email was received.</p>\n\n<pre><code>Public Sub SaveAutoAttach(item As Outlook.MailItem)\n\nDim object_attachment As Outlook.Attachment\n\nDim saveFolder As String\n' Folder location when I want to save my file\nsaveFolder = \"\\\\gbhxxxx\\Groups\\Shared\\EBS\\Post Go-Live\\Auto MT940 download Test\"\n\nFor Each object_attachment In item.Attachments\n\n    ' Criteria to save .940 files only\n    If InStr(object_attachment.DisplayName, \"UKAutoMT940\") Then\n        object_attachment.SaveAsFile saveFolder &amp; \"\\\" &amp; object_attachment.DisplayName\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1569417264, "post_id": 58097271, "comment_id": 102590374, "body": "It looks like you&#39;re using late-bound Word and <b>not</b> using Option Explicit, which means you&#39;ve got empty variables that you don&#39;t know are empty because you think they are Word constants :) Without a reference to the Word library, you&#39;ll need to declare and assign any needed constants such as <code>wdSectionBreakNextPage</code>. Otherwise, they&#39;re empty variants."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569420052, "post_id": 58097271, "comment_id": 102592084, "body": "Could you please provide screen shots of the actual result and the required result? Please make sure the display of non-printing characters is enabled. Then we can be sure what it is you want. I <i>think</i> I understand it from the text (see my edits), but it&#39;s not certain... You&#39;re not getting any errors, is that correct?"}, {"owner": {"reputation": 5, "user_id": 12118630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c117b634153652be5a1624d3d46696?s=128&d=identicon&r=PG&f=1", "display_name": "DrG", "link": "https://stackoverflow.com/users/12118630/drg"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1569496023, "post_id": 58097271, "comment_id": 102620034, "body": "@DavidZemens unfortunately i have referenced it correctly :("}, {"owner": {"reputation": 5, "user_id": 12118630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c117b634153652be5a1624d3d46696?s=128&d=identicon&r=PG&f=1", "display_name": "DrG", "link": "https://stackoverflow.com/users/12118630/drg"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569496561, "post_id": 58097271, "comment_id": 102620323, "body": "@CindyMeister Sorry im new to stack and new to VBA in general Hopfully you can see the results in my edits"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569497102, "post_id": 58097271, "comment_id": 102620610, "body": "And which part(s) of these two pages are being pasted as pictures from Excel? Then entire page&#39;s content?"}, {"owner": {"reputation": 5, "user_id": 12118630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c117b634153652be5a1624d3d46696?s=128&d=identicon&r=PG&f=1", "display_name": "DrG", "link": "https://stackoverflow.com/users/12118630/drg"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569497224, "post_id": 58097271, "comment_id": 102620692, "body": "@CindyMeister yes all of it"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1569498832, "post_id": 58097271, "comment_id": 102621594, "body": "The entire contents of the word doc is an <i>image</i> of text copied from Excel? Two questions: why not just use Word natively as a text editor? If you insist on using Excel, can you export as PDF? The latter seems functionally equivalent if not a bit superior to the current screenshots-in-docx format."}, {"owner": {"reputation": 5, "user_id": 12118630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c117b634153652be5a1624d3d46696?s=128&d=identicon&r=PG&f=1", "display_name": "DrG", "link": "https://stackoverflow.com/users/12118630/drg"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1569507910, "post_id": 58097271, "comment_id": 102626875, "body": "@DavidZemens the material would be sensitive and thus a password would be used to secure the document so it can be sent over email in regulations of GDPR"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1569508272, "post_id": 58097271, "comment_id": 102627142, "body": "You can secure PDF and DOCX/M with password. So I still don&#39;t understand why the need to use Excel as an intermediary."}, {"owner": {"reputation": 5, "user_id": 12118630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c117b634153652be5a1624d3d46696?s=128&d=identicon&r=PG&f=1", "display_name": "DrG", "link": "https://stackoverflow.com/users/12118630/drg"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1569511563, "post_id": 58097271, "comment_id": 102628991, "body": "@DavidZemens i did not build the system  and thus just adding to it , previously however i believe the company i work for used excel as a basic database before and just kept the system to then automate pension emails"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 12118630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c117b634153652be5a1624d3d46696?s=128&d=identicon&r=PG&f=1", "display_name": "DrG", "link": "https://stackoverflow.com/users/12118630/drg"}, "edited": false, "score": 0, "creation_date": 1569595186, "post_id": 58118206, "comment_id": 102659995, "body": "Dim docRange as Object &#39;Word.Range Set docRange = wd.Content - what do these lines do? and then why i would then need to reassign the object to paste the second section of the page"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1569599588, "last_edit_date": 1569599588, "creation_date": 1569505372, "answer_id": 58118206, "question_id": 58097271, "link": "https://stackoverflow.com/questions/58097271/save-pictures-of-excel-cells-into-a-word-document/58118206#58118206", "title": "Save pictures of Excel cells into a Word document", "body": "<p>It's difficult for me to test what you're doing, but logically I believe the following should work, although there may be one problem (keep reading)...</p>\n\n<p>Notice how this code uses a Word <code>Range</code> object as the target for new content. After pasting it's uncertain whether <code>docRange</code> will be before the pasted content, or contain the pasted content. If it contains the pasted content, the code should work. If it's before the pasted content, then next picture will come in before the first one. In that case, <em>repeat</em> the line <code>Set docRange = wd.Content</code> immediately after <code>docRange.Paste</code>.</p>\n\n<pre><code>    Set wd = wdApp.Documents.Add  ' create a new document\n    Dim docRange as Object 'Word.Range\n    Set docRange = wd.Content\n    wdApp.Visible = True\n    'change sheet and range below\n    ActiveSheet.Range(\"a1:z43\").CopyPicture xlPrinter\n    docRange.Paste\n    'Go to the end\n    docRange.Collapse 0 'wdCollapseEnd\n    docRange.InsertBreak Type:=wdSectionBreakNextPage\n    ActiveSheet.Range(\"a43:z76\").CopyPicture xlPicture\n    docRange.Paste\n</code></pre>\n\n<p>In response to an inquiry in comments about how the code works in detail:</p>\n\n<pre><code>Dim docRange as Object 'Word.Range\n</code></pre>\n\n<p>Declares an object variable to hold the part of the document the code works with. Because the code in the question, running from Excel, apparently uses <em>late-binding</em> (no reference to the Word object library) it's declared as an <code>Object</code>. </p>\n\n<p>If early-binding were being used (the code project has a reference to the Word libraray) then declaring it <code>As Word.Range</code> would be preferable. I include the Word object data type (<code>Word.Range</code>) for the sake of completeness and to make it possible to research the object and its properties in the Help.</p>\n\n<pre><code>Set docRange = wd.Content\n</code></pre>\n\n<p>This <em>instantiates</em> the <code>Word.Range</code> object to contain the entire main body of the document (<code>wd</code> being instantiated in the code in the question to the target Word document).</p>\n\n<p>After pasting, <code>docRange</code> still refers to the entire content of the document, including what was pasted. If the section break and second paste action were to be executed immediately, this would <em>delete</em> the content of the range. (Think of it like selecting text in Word, then typing: what was selected is replaced by what is typed. In order to avoid this, one presses the right arrow key before typing so that the new content follows what was selected.)</p>\n\n<p>For this reason, the range is \"collapsed\" (like pressing the arrow key). Then the section break is inserted and the next paste action is executed.</p>\n"}], "owner": {"reputation": 5, "user_id": 12118630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c117b634153652be5a1624d3d46696?s=128&d=identicon&r=PG&f=1", "display_name": "DrG", "link": "https://stackoverflow.com/users/12118630/drg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 58118206, "answer_count": 1, "score": 0, "last_activity_date": 1574440666, "creation_date": 1569410652, "last_edit_date": 1574440666, "question_id": 58097271, "link": "https://stackoverflow.com/questions/58097271/save-pictures-of-excel-cells-into-a-word-document", "title": "Save pictures of Excel cells into a Word document", "body": "<p>My code pastes a picture of the cells.</p>\n\n<p>It should then paste the other cells which don't fit on the first page.</p>\n\n<p>The picture of the 'second page' does not paste.</p>\n\n<pre><code>Dim wdApp As Object\nDim wd As Object\nDim sFil As String\n\nOn Error Resume Next\nSet wdApp = GetObject(, \"Word.Application\")\n\nIf Err.Number &lt;&gt; 0 Then Set wdApp = CreateObject(\"Word.Application\")\n\nOn Error GoTo 0\nSet wd = wdApp.Documents.Add  ' create a new document\nwdApp.Visible = True\n'change sheet and range below\nActiveSheet.Range(\"a1:z43\").CopyPicture xlPrinter\nwd.Range.Paste\nwdApp.ActiveDocument.Range(0, 0).InsertBreak Type:=wdSectionBreakNextPage\nwdApp.ActiveDocument.Sections (2)\nActiveSheet.Range(\"a43:z76\").CopyPicture xlPicture\nwd.Range.Paste\n\n'wd.SaveAs Filename:=\"I:\\'Files\\RKG-COMMS\\\" &amp; URNa &amp; \" - \" &amp; URNb &amp; \".doc\"\n'wd.Close\n'wd.Quit\n</code></pre>\n\n<p>Here is the result - only the first page<br>\n<a href=\"https://i.stack.imgur.com/kCa3b.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kCa3b.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is the second page which should be pasted<br>\n<a href=\"https://i.stack.imgur.com/Rh8tS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rh8tS.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1569410748, "post_id": 58096978, "comment_id": 102586559, "body": "Please update your question with your <code>HTML</code> code. It is illegible in comments"}, {"owner": {"reputation": 1, "user_id": 12117925, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3OoxGP6zcNdL884yD965UNL-Xh-xcskR3juCf=k-s128", "display_name": "Zohaib Afroze", "link": "https://stackoverflow.com/users/12117925/zohaib-afroze"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1569411369, "post_id": 58096978, "comment_id": 102586865, "body": "HTML Is added in the question now. Please help me as soon as possible"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1569411447, "post_id": 58096978, "comment_id": 102586904, "body": "Duplicate <a href=\"https://stackoverflow.com/questions/58096264/how-to-get-data-from-span\" title=\"how to get data from span\">stackoverflow.com/questions/58096264/how-to-get-data-from-sp&zwnj;&#8203;an</a> asked within 30 minutes"}, {"owner": {"reputation": 1, "user_id": 12117925, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3OoxGP6zcNdL884yD965UNL-Xh-xcskR3juCf=k-s128", "display_name": "Zohaib Afroze", "link": "https://stackoverflow.com/users/12117925/zohaib-afroze"}, "edited": false, "score": 0, "creation_date": 1569411552, "post_id": 58096978, "comment_id": 102586959, "body": "The answer to that thread in incomplete as the questioner ran away."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1569411670, "post_id": 58096978, "comment_id": 102587042, "body": "@ZohaibAfroze your question is not a question, Doesn&#39;t work is not a question. Please  read <a href=\"https://stackoverflow.com/help/how-to-ask\">this</a> and edit your question."}, {"owner": {"reputation": 1, "user_id": 12117925, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3OoxGP6zcNdL884yD965UNL-Xh-xcskR3juCf=k-s128", "display_name": "Zohaib Afroze", "link": "https://stackoverflow.com/users/12117925/zohaib-afroze"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1569411900, "post_id": 58096978, "comment_id": 102587156, "body": "I tried my best to improve the question. @Damian please help me."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1569412204, "post_id": 58096978, "comment_id": 102587303, "body": "The class name in your code doesn&#39;t match the class name in your HTML."}, {"owner": {"reputation": 1, "user_id": 12117925, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3OoxGP6zcNdL884yD965UNL-Xh-xcskR3juCf=k-s128", "display_name": "Zohaib Afroze", "link": "https://stackoverflow.com/users/12117925/zohaib-afroze"}, "edited": false, "score": 0, "creation_date": 1569412466, "post_id": 58096978, "comment_id": 102587424, "body": "Please share the proper VBA code by inserting the proper class name with me so that I can check if it works."}], "answers": [{"tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": false, "score": 0, "last_activity_date": 1569415749, "last_edit_date": 1569415749, "creation_date": 1569415314, "answer_id": 58098672, "question_id": 58096978, "link": "https://stackoverflow.com/questions/58096978/vba-code-not-working-and-returning-blank-value-in-excel/58098672#58098672", "title": "VBA Code Not Working And returning blank Value in excel", "body": "<p>There is no such thing as <code>.getElementByTagName</code>. The method you're looking for is <code>.getElementsByTagName()</code> and it returns a collection of elements. </p>\n\n<p>Also this:</p>\n\n<pre><code>DOC.getElementByTagName(\"span\").Item(0).innerText.getElementByClassName(\"pdp -Product - Title\").Item(0).innerText \n</code></pre>\n\n<p>makes no sense even if the method you were using was the right one, because the <code>.innerText</code> property of an HTML element will return a string and not another HTML element from which you can get elements by class name.</p>\n\n<p>To access the <code>i-th</code> element of the collection of <code>&lt;span&gt;&lt;/span&gt;</code> elements you would have to do it like so:</p>\n\n<pre><code>DOC.getElementsByTagName(\"span\")(i-1) 'indexing starts from 0\n</code></pre>\n\n<p>To get this element's inner text you use the corresponding property of that element:</p>\n\n<pre><code>DOC.getElementsByTagName(\"span\")(i-1).innerText\n</code></pre>\n\n<p>If you want your reference to be more specific you can even do this:</p>\n\n<pre><code>DOC.getElementById(\"module_product_title_1\").getElementsByTagName(\"span\")(i-1).innerText\n</code></pre>\n\n<p>Which means that, you first find the unique element whose ID is <code>module_product_title_1</code> and then you \"search\" that element for any <code>&lt;span&gt;&lt;/span&gt;</code> elements and get access to the <code>i-th</code> of these elements.</p>\n"}], "owner": {"reputation": 1, "user_id": 12117925, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3OoxGP6zcNdL884yD965UNL-Xh-xcskR3juCf=k-s128", "display_name": "Zohaib Afroze", "link": "https://stackoverflow.com/users/12117925/zohaib-afroze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1569415749, "creation_date": 1569409527, "last_edit_date": 1569411870, "question_id": 58096978, "link": "https://stackoverflow.com/questions/58096978/vba-code-not-working-and-returning-blank-value-in-excel", "title": "VBA Code Not Working And returning blank Value in excel", "body": "<p>HTML Code From which I want to fetch span data into my Excel workbook   </p>\n\n<pre><code>&lt;div id=\"module_product_title_1\" class=\"pdp-block module\"&gt;\n&lt;div class=\"pdp-product-title\"&gt;\n&lt;div class=\"pdp-mod-product-badge-wrapper\"&gt;\n&lt;img src=\"laz-img-cdn.alicdn.com/tfs/\u2026\" class=\"pdp-mod-product-badge\" alt=\"badge\"&gt;\n&lt;span class=\"pdp-mod-product-badge-title\" data-spm-anchor-id=\"a2a0e.pdp.0.i0.5b4b476dTBie86\"&gt;Bosch WAW32560GC - Front Load Automatic Washing Machine - 9Kg\n&lt;/span&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt; \n</code></pre>\n\n<p>VBA Code That I am using to perform the action</p>\n\n<pre><code>For i = Sr To Er\nDoEvents\nMSXML.Open \"GET\", Sheet1.Range(\"A\" &amp; i).Value\nMSXML.send\nDoEvents\nlr = i\nDOC.body.innerHTML = MSXML.responseText\nOn Error Resume Next\nSheet2.Range(\"A\" &amp; lr).Value = DOC.getElementByTagName(\"span\").Item(0).innerText.getElementByClassName(\"pdp -Product - Title\").Item(0).innerText\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "spacing", "paragraph"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1569408881, "post_id": 58096604, "comment_id": 102585572, "body": "What is the problem?  Can you show us a section of the document where the problem appears?"}, {"owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1569409948, "post_id": 58096604, "comment_id": 102586152, "body": "<a href=\"https://failiem.lv/u/75wymqr9\" rel=\"nofollow noreferrer\">failiem.lv/u/75wymqr9</a> before bold text I want more free space, but not additional blank line"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1569410450, "post_id": 58096604, "comment_id": 102586415, "body": "You need to show paragaph marking for us to understand the image you posted.  However I suspect you have an extraneous TypeParagraph.  Try using F* to step through the code whilst the document is displayed to see where the mistake is."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569416997, "post_id": 58096604, "comment_id": 102590217, "body": "To use Word optimally, this kind of formatting should be part of a <i>style</i>. Define styles for the formatting required in the document, then apply them as needed. That will make for much more compact and faster code and reduce problems with memory issues. If the formatting later needs to be adjusted, it&#39;s simply a matter of changing the style definition - the formatting will then adjust throughout the document."}], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "is_accepted": true, "score": 1, "last_activity_date": 1569480252, "last_edit_date": 1569480252, "creation_date": 1569412343, "answer_id": 58097720, "question_id": 58096604, "link": "https://stackoverflow.com/questions/58096604/how-to-add-spacing-before-first-line-of-paragraph-in-vba/58097720#58097720", "title": "How to add spacing before first line of paragraph in VBA?", "body": "<p>Swapped two lines of code </p>\n\n<pre><code>.TypeText VBA.vbNewLine\n</code></pre>\n\n<p>and</p>\n\n<pre><code>.ParagraphFormat.SpaceBefore = 0\n</code></pre>\n\n<p>Seems that it is important to place .ParagraphFormat after .TypeParagraph or VBA.vbNewLine then it started to work as I wanted.</p>\n\n<pre><code>With Wapp\n    With .Selection\n        .TypeParagraph\n        'Add line spacing\n        .ParagraphFormat.SpaceBefore = 0\n        .ParagraphFormat.SpaceAfter = 0\n        .TypeText St1\n        .TypeParagraph\n        'Starts spacing\n        .ParagraphFormat.SpaceBefore = 6\n        .BoldRun\n        'Centers text\n        .ParagraphFormat.Alignment = 1\n        .TypeText St2\n        .BoldRun\n        .TypeText VBA.vbNewLine\n        'Ends spacing\n        .ParagraphFormat.SpaceBefore = 0\n        .TypeText St3\n        .TypeText VBA.vbNewLine\n        .ParagraphFormat.Alignment = 1\n    End With\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569416869, "post_id": 58097775, "comment_id": 102590151, "body": "Indentation is not what the OP is looking for."}, {"owner": {"reputation": 323, "user_id": 12089232, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfPL0FhSRKDbRwRWWDzMUtNrVlMgKovxcm8ZNZ=k-s128", "display_name": "Dhirendra Kumar", "link": "https://stackoverflow.com/users/12089232/dhirendra-kumar"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569480597, "post_id": 58097775, "comment_id": 102611993, "body": "Oh... I might not understand it well. can the screenshot of desired output be shared. It will help to solve the specific problem."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569488130, "post_id": 58097775, "comment_id": 102615761, "body": "Look at the Answer posted by the person who asked the question to understand what was wanted (different spacing <i>between</i> paragraphs)."}], "tags": [], "owner": {"reputation": 323, "user_id": 12089232, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfPL0FhSRKDbRwRWWDzMUtNrVlMgKovxcm8ZNZ=k-s128", "display_name": "Dhirendra Kumar", "link": "https://stackoverflow.com/users/12089232/dhirendra-kumar"}, "is_accepted": false, "score": -1, "last_activity_date": 1569412550, "creation_date": 1569412550, "answer_id": 58097775, "question_id": 58096604, "link": "https://stackoverflow.com/questions/58096604/how-to-add-spacing-before-first-line-of-paragraph-in-vba/58097775#58097775", "title": "How to add spacing before first line of paragraph in VBA?", "body": "<p>You can use following line to create first line indent of 1 inch (72 points) for the current paragraph:</p>\n\n<pre><code>.ParagraphFormat.FirstLineIndent = Application.InchesToPoints(1)\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 58097720, "answer_count": 2, "score": 0, "last_activity_date": 1569480252, "creation_date": 1569408199, "last_edit_date": 1569416829, "question_id": 58096604, "link": "https://stackoverflow.com/questions/58096604/how-to-add-spacing-before-first-line-of-paragraph-in-vba", "title": "How to add spacing before first line of paragraph in VBA?", "body": "<p>I'm trying to add spacing before one paragraph in word document that is being automatically generated. I only need spacing before first line of that particular paragraph. Problem is in next line after first blank line.</p>\n\n<pre><code>With Wapp\n    With .Selection\n        .TypeParagraph\n        'Add line spacing\n        .ParagraphFormat.SpaceBefore = 0\n        .ParagraphFormat.SpaceAfter = 0\n        .TypeText St1\n        .TypeParagraph\n\n        .ParagraphFormat.SpaceBefore = 36\n        .BoldRun\n        'Centers text\n        .ParagraphFormat.Alignment = 1\n        .TypeText St2\n        .BoldRun\n        .ParagraphFormat.SpaceBefore = 0\n\n        .TypeText VBA.vbNewLine\n        .TypeText St3\n        .TypeText VBA.vbNewLine\n        .ParagraphFormat.Alignment = 1\n    End With\nEnd With\n</code></pre>\n"}, {"tags": ["python", "excel", "vba", "jupyter-notebook"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1569418745, "post_id": 58096291, "comment_id": 102591266, "body": "why wouldn&#39;t you use python to add it to the file? And does it have to be an existing workbook or can you generate it on the fly with a given name?"}, {"owner": {"reputation": 7, "user_id": 12096213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c8c6c3d8f81584a7be589f0fb83d6a?s=128&d=identicon&r=PG&f=1", "display_name": "user54083", "link": "https://stackoverflow.com/users/12096213/user54083"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1569420036, "post_id": 58096291, "comment_id": 102592075, "body": "It would be an existing workbook. I wouldn&#39;t use python to add this in because I already  have other data on the spreadsheet and would like to have it all working from excel level only without need of opening python."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1569420405, "post_id": 58096291, "comment_id": 102592324, "body": "why doesn&#39;t your python script (that you call) write the df to your workbook?"}, {"owner": {"reputation": 7, "user_id": 12096213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c8c6c3d8f81584a7be589f0fb83d6a?s=128&d=identicon&r=PG&f=1", "display_name": "user54083", "link": "https://stackoverflow.com/users/12096213/user54083"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1569421247, "post_id": 58096291, "comment_id": 102592808, "body": "It does when I run it on jupyter or spyder, but I would like to run it from excel level if possible"}], "answers": [{"tags": [], "owner": {"reputation": 194, "user_id": 11791039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08fc81fc5d56929d15c44f3906129a87?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Morawiec", "link": "https://stackoverflow.com/users/11791039/jan-morawiec"}, "is_accepted": false, "score": 0, "last_activity_date": 1569427458, "creation_date": 1569427458, "answer_id": 58102473, "question_id": 58096291, "link": "https://stackoverflow.com/questions/58096291/retrieving-pandas-dataframe-from-open-excel-file-level/58102473#58102473", "title": "Retrieving pandas dataframe from open excel file level", "body": "<p>Have a look at this library: <a href=\"https://www.xlwings.org/\" rel=\"nofollow noreferrer\">https://www.xlwings.org/</a>. It allows you to call python from VBA in a very intuitive manner as described in the documentation <a href=\"https://docs.xlwings.org/en/stable/vba.html#\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 7, "user_id": 12096213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c8c6c3d8f81584a7be589f0fb83d6a?s=128&d=identicon&r=PG&f=1", "display_name": "user54083", "link": "https://stackoverflow.com/users/12096213/user54083"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569427458, "creation_date": 1569407144, "last_edit_date": 1569408836, "question_id": 58096291, "link": "https://stackoverflow.com/questions/58096291/retrieving-pandas-dataframe-from-open-excel-file-level", "title": "Retrieving pandas dataframe from open excel file level", "body": "<p>I would like to use a VBA macro in an excel spreadsheet that pastes specific dataframe from my jupyter notebook into this spreadheet. </p>\n\n<p>I tried what was suggested in other thread but the code doesn't say how to specify a df that I need.</p>\n\n<p>This is what I used </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub DataFrameImport()\n  'RUN PYTHON TO EXPORT DATA FRAME\n  Shell \"C:\\pathTo\\python.exe fullpathOfPythonScript.py\", vbNormalFocus\n\n  'CLEAR EXISTING CONTENT\n  ThisWorkbook.Worksheets(5).Cells.Clear\n\n  'COPY AND PASTE TO WORKBOOK\n  Workbooks(\"PythonExport\").Worksheets(1).Cells.Copy\n  ThisWorkbook.Worksheets(5).Range(\"A1\").Select\n  ThisWorkbook.Worksheets(5).Paste\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 1, "creation_date": 1569407665, "post_id": 58096283, "comment_id": 102584952, "body": "To explain a Bit more you can say that <code>i Mod 5 = 0</code> (Modulo) would be true only each time i is a multiple of 5"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1569409766, "post_id": 58096283, "comment_id": 102586061, "body": "Note that you can jump to rows <code>10, 15, 20, 25 \u2026</code> using <code>Step 5</code> in the loop and hide the next 4 rows <i>at once</i>, which should be much faster than hiding rows one-by-one. See <a href=\"https://stackoverflow.com/a/58097011/3219613\">my answer</a>."}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 1, "last_activity_date": 1569407114, "creation_date": 1569407114, "answer_id": 58096283, "question_id": 58096220, "link": "https://stackoverflow.com/questions/58096220/hide-4-in-every-5-rows/58096283#58096283", "title": "Hide 4 in every 5 rows", "body": "<p>Try this:</p>\n\n<pre><code>Dim lngLR As Long\nlngLR = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\nFor i = 10 To lngLR\n    If i Mod 5 &lt;&gt; 0 Then ActiveSheet.Rows(i).EntireRow.Hidden = True\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 4, "last_activity_date": 1569411420, "last_edit_date": 1569411420, "creation_date": 1569409707, "answer_id": 58097011, "question_id": 58096220, "link": "https://stackoverflow.com/questions/58096220/hide-4-in-every-5-rows/58097011#58097011", "title": "Hide 4 in every 5 rows", "body": "<p>I recommend the following using <code>Step 5</code> in the <code>For</code> loop which should be faster than calculating the modulo for each <code>i</code>.  And then hide the following 4 rows at once instead of one-by-one.</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ActiveSheet 'better define your sheet: ThisWorkbook.Worksheets(\"Sheet1\")\n\nDim LastRow As Long\nLastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\nDim iRow As Long\nFor iRow = 10 To LastRow Step 5 'means 10, 15, 20, 25 \u2026\n    ws.Rows(iRow + 1).Resize(RowSize:=4).EntireRow.Hidden = True\nNext iRow\n</code></pre>\n\n<p>If you want to take better care of the last used row (don't hide any empty rows after <code>LastRow</code> use the following instead:</p>\n\n<pre><code>For iRow = 10 To LastRow - 1 Step 5 'means 10, 15, 20, 25 \u2026\n    If iRow + 5 &gt; LastRow Then\n        ws.Rows(iRow + 1).Resize(RowSize:=LastRow - iRow).EntireRow.Hidden = True\n    Else\n        ws.Rows(iRow + 1).Resize(RowSize:=4).EntireRow.Hidden = True\n    End If\nNext iRow\n</code></pre>\n\n<p>or even shorter (using <code>IIf</code>)</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ActiveSheet 'better define your sheet: ThisWorkbook.Worksheets(\"Sheet1\")\n\nDim LastRow As Long\nLastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\nConst NthRow As Long = 5 'show only every Nth row\n\nDim iRow As Long\nFor iRow = 10 To LastRow - 1 Step NthRow 'means 10, 15, 20, 25 \u2026\n    ws.Rows(iRow + 1).Resize(RowSize:=IIf(iRow + NthRow &gt; LastRow, LastRow - iRow, NthRow - 1)).EntireRow.Hidden = True\nNext iRow\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12073119, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-joBDYGpzDi0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfkIqTs_h78qhDd9lpZ4rNHThCSaQ/photo.jpg?sz=128", "display_name": "Aaron Morris", "link": "https://stackoverflow.com/users/12073119/aaron-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58096283, "answer_count": 2, "score": 1, "last_activity_date": 1569411420, "creation_date": 1569406914, "last_edit_date": 1569409078, "question_id": 58096220, "link": "https://stackoverflow.com/questions/58096220/hide-4-in-every-5-rows", "title": "Hide 4 in every 5 rows", "body": "<p>Starting from row 10, which I need to keep unhidden, I need to hide the next 4 rows and repeat that pattern until the last row containing data</p>\n\n<p>ie. keep row 10, 15, 20, 25 and so on, potentially up to around row 300</p>\n\n<p>This is to fit in a larger VBA macro within Excel so i dont need an entire Sub () just the middle section.</p>\n\n<p>I think I need to find lastrow\ncount rows from row 10 to last row\nSelect row 10\nthen skip row,\nhide next 4 \nloop... \nFor loop assume but I don't really know where to start</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 1, "creation_date": 1569406841, "post_id": 58096064, "comment_id": 102584496, "body": "SO is not a free code writing platform, please show some of the attempts you&#39;ve made to solve your problem. Also try to specify what exactly it is you&#39;re trying to achieve, I&#39;m having a hard time understanding what your code is supposed to do."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1569407907, "post_id": 58096064, "comment_id": 102585077, "body": "@looopa are the lists in an userform ?"}, {"owner": {"reputation": 3, "user_id": 12063581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbfb98ac1f23a4c88ca3f619c032067?s=128&d=identicon&r=PG&f=1", "display_name": "looopa", "link": "https://stackoverflow.com/users/12063581/looopa"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1569408316, "post_id": 58096064, "comment_id": 102585290, "body": "@Dorian it is not, it is just 200 rows of names in a column on another worksheet"}, {"owner": {"reputation": 3, "user_id": 12063581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbfb98ac1f23a4c88ca3f619c032067?s=128&d=identicon&r=PG&f=1", "display_name": "looopa", "link": "https://stackoverflow.com/users/12063581/looopa"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1569408510, "post_id": 58096064, "comment_id": 102585391, "body": "@M.Schalk Thanks for the suggestions, I tried a few things but I&#39;m quite a beginner so I figured they&#39;re probably wrong anyway and the easiest way to ask the question was to keep it open ended.. I&#39;m working on improving the qn"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1569409347, "post_id": 58096064, "comment_id": 102585815, "body": "where does the drop down get its names from?"}, {"owner": {"reputation": 3, "user_id": 12063581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbfb98ac1f23a4c88ca3f619c032067?s=128&d=identicon&r=PG&f=1", "display_name": "looopa", "link": "https://stackoverflow.com/users/12063581/looopa"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1569409728, "post_id": 58096064, "comment_id": 102586045, "body": "@HarassedDad from a column of values in another sheet. This solution doesnt necessarily have to involve a drop down list"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1569411243, "post_id": 58096064, "comment_id": 102586796, "body": "Loop trough names and copy paste in each loop."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1569413184, "post_id": 58096064, "comment_id": 102587790, "body": "To start to improve your code, read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1569417753, "creation_date": 1569417753, "answer_id": 58099450, "question_id": 58096064, "link": "https://stackoverflow.com/questions/58096064/loop-through-list-and-run-code-for-every-item-vba/58099450#58099450", "title": "Loop through list and run code for every item (VBA)", "body": "<p>This will take each name in a range and put it into a cell sequentially - you will need to edit to put your sheetnames and ranges in</p>\n\n<pre><code>Sub LoopThroughNames()\ndim RangeWithNames as range\n'define list of names - needs editing\nset RangeWithNames = Worksheets(\"othersheetname\").Range(\"range with names\")\ndim TargetCell as range\nset TargetCell = worksheets(\"Sheet with calcs\").Range(\"A1\") 'top sheet, cell A1 edit as needed\ndim r as range\nfor each r in RangeWithNames\n      targetcell= r  'assign name into A1\n'do your stuff\nnext r\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12063581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbfb98ac1f23a4c88ca3f619c032067?s=128&d=identicon&r=PG&f=1", "display_name": "looopa", "link": "https://stackoverflow.com/users/12063581/looopa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569417753, "creation_date": 1569406447, "last_edit_date": 1569409654, "question_id": 58096064, "link": "https://stackoverflow.com/questions/58096064/loop-through-list-and-run-code-for-every-item-vba", "title": "Loop through list and run code for every item (VBA)", "body": "<p>I have a list of names, and some code that I would like to run for every single name. \nWhat I'm starting with is this: </p>\n\n<pre><code>Dim cell As Range\nFor Each cell In Worksheets(\"Reference\").Range(\"b2:b237\")\n[rest of my code here]\nNext cell\n</code></pre>\n\n<p>The issue is, what I'm actually trying to do is: </p>\n\n<p>Step 1) Select a name from a drop down list in cell A1</p>\n\n<p>Step 2) There are a bunch of other cells with formulas that reference A1</p>\n\n<p>Step 3) Run code </p>\n\n<p>Step 4) Select next name from drop down list in A1, repeat Steps 2 &amp; 3, until end of list. </p>\n\n<p><strong><em>Edit: I found something on an old thread that seems to work for what I'm doing:</em></strong></p>\n\n<pre><code>Sub Macro1()\n    Sheets(\"Sheet2\").Activate\n    Range(\"A1\").Select\n\nDo While True\n    If Selection.Value = \"\" Then\n        Exit Do\n    Else\n        Selection.Copy\n        Sheets(\"Sheet1\").Activate\n        Range(\"A1\").Activate\n        ActiveSheet.Paste\n\n        [rest of my code]\n\n        Sheets(\"Sheet2\").Activate\n        Selection.Offset(1, 0).Select\n\n    End If\nLoop\nEnd Sub\n</code></pre>\n\n<p>This should do the job, but if anyone has a more efficient way rather than copying and pasting each value from the list to the cell, that would be very helpful too! </p>\n\n<p>Thank you. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 0, "creation_date": 1569405491, "post_id": 58095553, "comment_id": 102583796, "body": "I haven&#39;t got time for a full answer at the moment, but you might want to do some research on FileSystemObject. That may well get you closer to what you want to do."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1569406377, "post_id": 58095553, "comment_id": 102584250, "body": "Can you elaborate what your code currently does and where it fails or where you have difficulties. It is unclear to me what you&#39;re asking"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 0, "creation_date": 1569406378, "post_id": 58095553, "comment_id": 102584251, "body": "Yes, in addition to @Dave, you can use the <code>.files</code> collection and on each <code>.file</code> look at the <code>.type</code> or the extension.  There is also a way with ADO to I believe that may help"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3937218"}, "edited": false, "score": 0, "creation_date": 1569407320, "post_id": 58095553, "comment_id": 102584736, "body": "Thanks for the comments. Currently the code iterates through file names starting with ones that contain &quot;0&quot; in the name, i.e. &quot;Test0&quot;, this is the immediate issue in that once it does not detect this file, I get a compiler error when in reality I want it to move to the next iteration of i. I&#39;ld prefer not to use this method since if the folder contains only the following file; &quot;Test55&quot; the code will have to iterate 54 times until the file is matched. I hope this makes sence."}], "owner": {"user_type": "does_not_exist", "display_name": "user3937218"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569404619, "creation_date": 1569404571, "last_edit_date": 1569404619, "question_id": 58095553, "link": "https://stackoverflow.com/questions/58095553/how-to-look-up-files-txt-in-a-folder-import-delimited-data-from-file-into-ex", "title": "How to look up files (.txt) in a folder, import delimited data from file into excel, then move txt file to archive?", "body": "<p>I've got a folder that will be populated by files with common characters but with a single digit variance, i.e. Test 34, or Test 40. The folder can be empty or contain 50 files.</p>\n\n<p>I'm trying to write code that can:</p>\n\n<ol>\n<li>go to folder check if folfer is empty, if not</li>\n<li>take each text file and import space delimited data into excel (ideally based on date of file modification in folder - haven't gotten that far yet.)</li>\n<li>Move files to archive folder (may cause me issues if file name already exists in archive)</li>\n<li>if folder empty, exit/end sub</li>\n</ol>\n\n<p>I've tried various methods, however my VBA knowledge isn't great. Below is a version of my code that has been spliced with various code from stackoverflow</p>\n\n<pre><code>Sub ImportFiles()\nDim eRow As String\nDim fileName As String\nDim rowNumber As String\nDim outputSheet As String\nDim sheetName As String\nDim folder As String\nDim strPath As Variant\nDim i As Integer\nDim fCount As Long\n\nfolder = \"U:\\Projects\\Raw data\\\"\noutputSheet = \"Dataset\"\n\n    fCount = UBound(Filter(Split(CreateObject(\"WScript.Shell\").Exec(\"CMD /C DIR \"\"\" &amp; folder &amp; \"*.*\"\" /S /B /A:-D\").StdOut.ReadAll, vbCrLf), \".\")) + 1\n\n    'MsgBox Format(fCount, \"#,00\") &amp; \" files were found.\"\n\n\n\n    If Dir(folder &amp; \"*.*\") = \"\" Then\n        MsgBox \"The folder doesn't contain (visible) files\"\n        MsgBox \"Bye Bye!!\"\n        Exit Sub\n    Else\n        'MsgBox \"The folder does contain (visible) files\"\n\n        For i = 0 To 11\n            fileName = folder &amp; \"Test\" &amp; i &amp; \".txt\"\n                'If Dir(fileName) = \"\" Then     \n            eRow = Sheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\n            With Sheets(outputSheet).QueryTables.Add(Connection:=\"TEXT;\" + fileName, Destination:=Sheets(outputSheet).Range(\"$A$\" + eRow))\n                .FieldNames = True\n                .RowNumbers = False\n                .FillAdjacentFormulas = False\n                .PreserveFormatting = True\n                .RefreshOnFileOpen = False\n                .RefreshStyle = xlInsertDeleteCells\n                .SavePassword = False\n                .SaveData = True\n                .AdjustColumnWidth = True\n                .RefreshPeriod = 0\n                .TextFilePromptOnRefresh = False\n                .TextFilePlatform = 850\n                .TextFileStartRow = 1\n                .TextFileParseType = xlDelimited\n                .TextFileTextQualifier = xlTextQualifierDoubleQuote\n                .TextFileConsecutiveDelimiter = False\n                .TextFileTabDelimiter = True\n                .TextFileSemicolonDelimiter = False\n                .TextFileCommaDelimiter = False\n                .TextFileSpaceDelimiter = True\n                .TextFileTrailingMinusNumbers = True\n                .Refresh BackgroundQuery:=False\n\n            End With\n\n                    Dim wb_conection As WorkbookConnection\n                    For Each wb_Connection In ActiveWorkbook.Connections\n                    If InStr(fileName, wb_Connection.Name) &gt; 0 Then\n                    wb_Connection.Delete\n                    End If\n                    Next wb_Connection                \n        Next i    \n    End If\n\n    MsgBox (\"Done\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 2, "creation_date": 1569404541, "post_id": 58095434, "comment_id": 102583265, "body": "Can you show some of your attempts to solve this?"}, {"owner": {"reputation": 17, "user_id": 11064864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a95e1dd9cb333d77ca933d01612a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Lasore", "link": "https://stackoverflow.com/users/11064864/doug-lasore"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1569406739, "post_id": 58095434, "comment_id": 102584442, "body": "yes sure, this is the formula i tried in cell B8:  =SUBSTITUTE(SUBSTITUTE(A2,INDEX(C2:C4,1),INDEX(D2:D4,1)),IND&zwnj;&#8203;EX(C2:C4,2),INDEX(D2&zwnj;&#8203;:D4,2))"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1569406995, "post_id": 58095434, "comment_id": 102584569, "body": "@DougLasore What&#39;s wrong with that? Seems to work?"}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1569407272, "post_id": 58095434, "comment_id": 102584714, "body": "@Tom I think the issue is with the 3rd input: <code>blunt yellowish darkblue red</code> is being replaced with <code>blunt color 2ish darkblue red</code>"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1569407388, "post_id": 58095434, "comment_id": 102584776, "body": "@JustynaMK I tried @DougLasore formula and it returned the 3rd value as <code>blunt yellowish darkblue color 3</code>"}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1569407458, "post_id": 58095434, "comment_id": 102584830, "body": "@Tom Might be that you didn&#39;t lock the ranges, i.e. you used <code>=SUBSTITUTE(SUBSTITUTE(A4,INDEX(C4:C6,1),INDEX(D4:D6,1)),IND&zwnj;&#8203;EX(C4:C6,2),INDEX(D4&zwnj;&#8203;:D6,2))</code> instead of <code>=SUBSTITUTE(SUBSTITUTE(A4,INDEX($C$2:$C$4,1),INDEX($D$2:$D$4&zwnj;&#8203;,1)),INDEX($C$2:$C$4&zwnj;&#8203;,2),INDEX($D$2:$D$4,&zwnj;&#8203;2))</code>"}, {"owner": {"reputation": 17, "user_id": 11064864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a95e1dd9cb333d77ca933d01612a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Lasore", "link": "https://stackoverflow.com/users/11064864/doug-lasore"}, "edited": false, "score": 0, "creation_date": 1569407530, "post_id": 58095434, "comment_id": 102584879, "body": "here are the results i got: B8 = <a href=\"https://imgur.com/ORUoSd7\" rel=\"nofollow noreferrer\">imgur.com/ORUoSd7</a> B9 = <a href=\"https://imgur.com/D3FBvIG\" rel=\"nofollow noreferrer\">imgur.com/D3FBvIG</a> B10 =<a href=\"https://imgur.com/SX0MI5a\" rel=\"nofollow noreferrer\">imgur.com/SX0MI5a</a> B11 = <a href=\"https://imgur.com/qIKzGXA\" rel=\"nofollow noreferrer\">imgur.com/qIKzGXA</a>  you can see it works for B8 and B9, but it does not work for B10 &amp; B11. i am not sure why.. maybe because the word is not at the beginning of the cell (i.e. &quot;red&quot; is at the end)"}, {"owner": {"reputation": 17, "user_id": 11064864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a95e1dd9cb333d77ca933d01612a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Lasore", "link": "https://stackoverflow.com/users/11064864/doug-lasore"}, "edited": false, "score": 0, "creation_date": 1569407578, "post_id": 58095434, "comment_id": 102584905, "body": "i did try to lock the ranges with $, and i also tried to give a name to range , but i got same results, it works on some cells but not on all"}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1569407647, "post_id": 58095434, "comment_id": 102584945, "body": "@DougLasore thanks for the screenshots, this is useful. It looks like you didn&#39;t include a case for <code>red</code> in your formula, you only have two substitutes (for <code>green</code> and <code>yellow</code>) - <code>=SUBSTITUTE(SUBSTITUTE(A2,&quot;green&quot;,&quot;color 1&quot;),&quot;yellow&quot;,&quot;color 2&quot;)</code>"}, {"owner": {"reputation": 17, "user_id": 11064864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a95e1dd9cb333d77ca933d01612a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Lasore", "link": "https://stackoverflow.com/users/11064864/doug-lasore"}, "edited": false, "score": 0, "creation_date": 1569408133, "post_id": 58095434, "comment_id": 102585188, "body": "hi all, thanks a lot for helping me with this. i realize what my issue is.   I am actually trying to find a good working Excel formulat that can be aplied for this whole range, not just 3 colors; i might have 50 colors there for instance: <a href=\"https://imgur.com/Kmjejqf\" rel=\"nofollow noreferrer\">imgur.com/Kmjejqf</a>  I&#39;ve put together the excel sheet to be more helpful if anyone is interested : <a href=\"https://www.dropbox.com/s/wccf1fdtf9i0izm/stackoverflow%20excel%20template%20substitute.xlsx?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/wccf1fdtf9i0izm/&hellip;</a>"}, {"owner": {"reputation": 17, "user_id": 11064864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a95e1dd9cb333d77ca933d01612a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Lasore", "link": "https://stackoverflow.com/users/11064864/doug-lasore"}, "edited": false, "score": 0, "creation_date": 1569408389, "post_id": 58095434, "comment_id": 102585325, "body": "Just updated the excel sheet to include the full range, this makes more sense now: <a href=\"https://imgur.com/DpO5Q22\" rel=\"nofollow noreferrer\">imgur.com/DpO5Q22</a> . please re-download the excel sheet if you got the first version."}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1569408488, "post_id": 58095434, "comment_id": 102585375, "body": "It looks like the answer provided by shrivallabha.redij is working, give it a try."}, {"owner": {"reputation": 17, "user_id": 11064864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a95e1dd9cb333d77ca933d01612a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Lasore", "link": "https://stackoverflow.com/users/11064864/doug-lasore"}, "edited": false, "score": 0, "creation_date": 1569408679, "post_id": 58095434, "comment_id": 102585468, "body": "yes, all good, the solution provided by shrivallabha.redij is great and working!"}], "answers": [{"comments": [{"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1569408219, "post_id": 58096544, "comment_id": 102585240, "body": "+1 Very nice approach. I like that it doesn&#39;t convert <code>yellowish</code> to <code>color 2ish</code> as in the original formula."}, {"owner": {"reputation": 17, "user_id": 11064864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a95e1dd9cb333d77ca933d01612a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Lasore", "link": "https://stackoverflow.com/users/11064864/doug-lasore"}, "edited": false, "score": 0, "creation_date": 1569409325, "post_id": 58096544, "comment_id": 102585804, "body": "@shrivallabha.redij just wondering if you ever tried this: if i try to add the substitution matrix in another sheet (Sheet 2), the formula does not work. So... is it a requirement to have the substitution matrix in the same sheet with the formula? just wondering, thanks"}, {"owner": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "edited": false, "score": 0, "creation_date": 1569410620, "post_id": 58096544, "comment_id": 102586484, "body": "a very nice answer especially it does not require CSE! would you mind briefly explain the use of LOOKUP in this case or point out a direction to understand how you used it? much appreciated!"}, {"owner": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "edited": false, "score": 0, "creation_date": 1569412037, "post_id": 58096544, "comment_id": 102587218, "body": "I think I just worked it out! It should be safe to replace <code>2^15</code> with <code>LEN(A2)</code> if I understand your use of LOOKUP correctly. :)"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 17, "user_id": 11064864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a95e1dd9cb333d77ca933d01612a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Lasore", "link": "https://stackoverflow.com/users/11064864/doug-lasore"}, "edited": false, "score": 0, "creation_date": 1569480906, "post_id": 58096544, "comment_id": 102612136, "body": "@DougLasore it should still work. I do not see any issue if you have it on second sheet. e.g. <code>=SUBSTITUTE(A2,LOOKUP(2^15,SEARCH(&quot; &quot;&amp;Sheet2!$A$2:$A$4&amp;&quot; &quot;,&quot; &quot;&amp;A2&amp;&quot; &quot;,1),Sheet2!$A$2:$A$4),LOOKUP(2^15,SEARCH(&quot; &quot;&amp;Sheet2!$A$2:$A$4&amp;&quot; &quot;,&quot; &quot;&amp;A2&amp;&quot; &quot;,1),Sheet2!$B$2:$B$4))</code> just the same way."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "edited": false, "score": 0, "creation_date": 1569481158, "post_id": 58096544, "comment_id": 102612261, "body": "@TerryW You understood it correctly! 2^15 represents 32768 which is more than the number of characters a cell can hold 32767. I saw the LOOKUP construct by Aladin Akyurek on MrExcel."}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": true, "score": 3, "last_activity_date": 1569408011, "creation_date": 1569408011, "answer_id": 58096544, "question_id": 58095434, "link": "https://stackoverflow.com/questions/58095434/excel-formula-to-replace-value-based-on-corresponding-table/58096544#58096544", "title": "Excel formula to replace value based on corresponding table", "body": "<p>For one color replacement, you can try below formula.</p>\n\n<p>Setup:</p>\n\n<p><code>A2</code> holds input value.</p>\n\n<p>Range <code>E2:F4</code> contains the substitution matrix</p>\n\n<p>Formula:</p>\n\n<pre><code>=SUBSTITUTE(A2,LOOKUP(2^15,SEARCH(\" \"&amp;$E$2:$E$4&amp;\" \",\" \"&amp;A2&amp;\" \",1),$E$2:$E$4),LOOKUP(2^15,SEARCH(\" \"&amp;$E$2:$E$4&amp;\" \",\" \"&amp;A2&amp;\" \",1),$F$2:$F$4))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1569412667, "creation_date": 1569412667, "answer_id": 58097812, "question_id": 58095434, "link": "https://stackoverflow.com/questions/58095434/excel-formula-to-replace-value-based-on-corresponding-table/58097812#58097812", "title": "Excel formula to replace value based on corresponding table", "body": "<p>The following <strong>array formula</strong> will also return the desired result.</p>\n\n<pre><code>{=SUBSTITUTE(\" \"&amp;A2:A4&amp;\" \",\" \"&amp;C2:C4&amp;\" \",\" \"&amp;D2:D4&amp;\" \")}\n</code></pre>\n\n<p>Highlight <code>B2:B4</code>, enter this formula in formula bar and press <strong>Ctrl+Shift+Enter</strong> to confirm.</p>\n"}], "owner": {"reputation": 17, "user_id": 11064864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a95e1dd9cb333d77ca933d01612a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Lasore", "link": "https://stackoverflow.com/users/11064864/doug-lasore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "accepted_answer_id": 58096544, "answer_count": 2, "score": 0, "last_activity_date": 1569412667, "creation_date": 1569404124, "last_edit_date": 1569405896, "question_id": 58095434, "link": "https://stackoverflow.com/questions/58095434/excel-formula-to-replace-value-based-on-corresponding-table", "title": "Excel formula to replace value based on corresponding table", "body": "<p>I am trying to find a solution to my problem in Excel. </p>\n\n<p>I have a \"Input values\" table that has different values on each row, text / content that includes different colors.</p>\n\n<p><a href=\"https://i.stack.imgur.com/70cMc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/70cMc.png\" alt=\"enter image description here\"></a></p>\n\n<p>I also have a \"Corresponding values\" table: for specific colors, i have a corresponding value in column D.</p>\n\n<p>I am trying to get to a solution in Excel that can give me the results in \"Output values\" table. Ideally the excel formula for each row would give me the results found in output values table.</p>\n\n<p>i.e. \"green\" would be replaced with \"color 1\", so the final result is \"color 1 and dark\" .</p>\n\n<p>I have tried a few ways with substitute and index formulas but without success; it only worked for the first 1-2 rows of the input values table.</p>\n\n<p>Ideally, it'd be great if the formula would work without VBA code. </p>\n\n<p>Thank you so much!</p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": false, "score": 0, "last_activity_date": 1569424117, "creation_date": 1569424117, "answer_id": 58101531, "question_id": 58095151, "link": "https://stackoverflow.com/questions/58095151/copy-and-paste-from-excel-to-power-point-in-excel-table-format-keep-source-for/58101531#58101531", "title": "Copy and paste from Excel to Power Point in excel table format (&quot;keep source formatting&quot;)", "body": "<p>Sorry, but OLE objects have to be formatted in the source program, not the host. You'll have to make the changes in Excel, then paste to PowerPoint.</p>\n"}], "owner": {"reputation": 1, "user_id": 11988261, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G08YV.jpg?s=128&g=1", "display_name": "ChristineAnita", "link": "https://stackoverflow.com/users/11988261/christineanita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569424117, "creation_date": 1569403220, "last_edit_date": 1569407569, "question_id": 58095151, "link": "https://stackoverflow.com/questions/58095151/copy-and-paste-from-excel-to-power-point-in-excel-table-format-keep-source-for", "title": "Copy and paste from Excel to Power Point in excel table format (&quot;keep source formatting&quot;)", "body": "<p>I would like to copy and paste from excel to PowerPoint keeping the excel table format. The table also should be copied to a specific place in powerpoint with a specific font size.<br>\nI found out how to copy as a picture. However problem is that you cannot modify the picture later and add a sentence or so. \nI use Microsoft 2007 ;(. I think that is part of the problem. I can only paste it as an \"OLEObject\". </p>\n\n<pre><code>Dim oPPT As PowerPoint.Application\n\nDim ppTextbox As PowerPoint.Shape\nDim ppPlaceholder As PowerPoint.PlaceholderFormat\n\nDim FirstSlide As PowerPoint.Slide\nDim oSlide As PowerPoint.Slide\nDim LastSlide As PowerPoint.Slide\n\n'Open PowerPoint\n\nSet oPPT = New PowerPoint.Application\noPPT.Visible = True\noPPT.Presentations.Open \n\"P:\\Automotive\\JDIE_Automotive\\For Sales\\QuoteLayout\\automaticallygenerated.pptm\" \n\n'copy and paste from excel to PowerPoint\n\n    Worksheets(\"SalesOutput1\").Range(\"A1:I6\").Copy \n       oSlide.Shapes.PasteSpecial ppPasteOLEObject\n             With oSlide.Shapes(oSlide.Shapes.Count)\n            .LockAspectRatio = msoTrue\n            .Left = 43\n            .Top = 470\n            .Height = 80\n      End With\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1569403669, "post_id": 58095135, "comment_id": 102582747, "body": "Note to OP: you could use <code>Cells</code> which is a bit neater <code>If Cells(r, &quot;D&quot;).Value = Cells(r - 1, &quot;D&quot;).Value Then</code> etc."}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1569403908, "post_id": 58095135, "comment_id": 102582888, "body": "@SJR I also would&#39;ve used <code>Cells</code> in this case."}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 4, "last_activity_date": 1569403138, "creation_date": 1569403138, "answer_id": 58095135, "question_id": 58095076, "link": "https://stackoverflow.com/questions/58095076/vba-loops-to-replace-multible-if-statements/58095135#58095135", "title": "VBA loops to replace multible if statements", "body": "<p>Try this <code>For</code> loop:</p>\n\n<pre><code>For i = 5 To 150\n    If Range(\"D\" &amp; i) = Range(\"D\" &amp; (i-1)) Then\n       Range(\"C\"&amp; i) = DateAdd(\"w\", Range(\"I\" &amp; (i-1)), Range(\"C\" &amp; (i-1)))\n    Else\n       Range(\"C\" &amp; i) = Range(\"C2\")\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 2696834, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fdaa905f92bc0af908c5049e55beba2b?s=128&d=identicon&r=PG&f=1", "display_name": "Badvoc", "link": "https://stackoverflow.com/users/2696834/badvoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 58095135, "answer_count": 1, "score": 0, "last_activity_date": 1569403323, "creation_date": 1569402932, "last_edit_date": 1569403323, "question_id": 58095076, "link": "https://stackoverflow.com/questions/58095076/vba-loops-to-replace-multible-if-statements", "title": "VBA loops to replace multible if statements", "body": "<p>I have an Excel worksheet with a repetitive <code>If</code> statement in VBA in a <code>Worksheet_Change</code> sub</p>\n\n<pre><code>If Range(\"D5\") = Range(\"D4\") Then\n   Range(\"c5\") = DateAdd(\"w\", Range(\"i4\"), Range(\"c4\"))\nElse\n   Range(\"c5\") = Range(c2\")\nEnd If    \nIf Range(\"D6\") = Range(\"D5\") Then\n   Range(\"c6\") = DateAdd(\"w\", Range(\"i5\"), Range(\"c5\"))\nElse\n   Range(\"c6\") = Range(c2\")\nEnd If\n</code></pre>\n\n<p>it will repeat from <code>D5</code> to <code>D150</code> my question is can I rewrite this in a loop instead of repeating the if statement 145 times?</p>\n\n<p>Im not to good when it comes to loops</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 1, "creation_date": 1569401866, "post_id": 58094516, "comment_id": 102581746, "body": "Do You have any code?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1569402206, "post_id": 58094516, "comment_id": 102581927, "body": "Have you checked that the file is accessible via the path that is listed in References? Did your antivirus quarantine it by any chance?"}, {"owner": {"reputation": 119, "user_id": 8120501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21509ec678d1d307ab129c4051392dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Sorin", "link": "https://stackoverflow.com/users/8120501/bogdan-sorin"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1569403801, "post_id": 58094516, "comment_id": 102582829, "body": "@GSerg Yes I tried by path, and its not in quarantine. If i try to add it from another path works fine."}, {"owner": {"reputation": 119, "user_id": 8120501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21509ec678d1d307ab129c4051392dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Sorin", "link": "https://stackoverflow.com/users/8120501/bogdan-sorin"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 1, "creation_date": 1569405206, "post_id": 58094516, "comment_id": 102583616, "body": "@Teamothy its not a code problem."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569418726, "post_id": 58094516, "comment_id": 102591252, "body": "Sounds like there may be some kind of corruption, somewhere, based on &quot; if I change the VBA template name will load it successfully in the References&quot;. Does this template contain anything required for your work but code? Try using the VBA Editor&#39;s File/Export to write all the contents to *bas, *.cls, etc. files (these will be in clear text). Close Word. Rename the old template. Start Word in Safe Mode (hold down Ctrl) so that you get a guaranteed &quot;clean&quot; Normal.dot(m). Save this as template to the required file name. In the VBA Editor import all the exported files. Save and close. Test."}], "owner": {"reputation": 119, "user_id": 8120501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21509ec678d1d307ab129c4051392dcc?s=128&d=identicon&r=PG&f=1", "display_name": "Bogdan Sorin", "link": "https://stackoverflow.com/users/8120501/bogdan-sorin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569401684, "creation_date": 1569401076, "last_edit_date": 1569401684, "question_id": 58094516, "link": "https://stackoverflow.com/questions/58094516/vba-cant-add-reference-to-the-specified-word-template", "title": "VBA Can&#39;t add reference to the specified Word template", "body": "<p>On my development machine, I began getting an error when attempting to\nset a reference within a Word VBA module to another Word template. The\nerror was:\n<strong>Can't add a reference to the specified file.</strong>\nWhen I open the VBA module go to references tab I see this Word Template having <strong>\"Missing\"</strong> tag in the list.</p>\n\n<p>The template I was trying to set a reference to was one I have been\nusing for few years without a problem.</p>\n\n<p>I reinstalled MS Office, cleaned the registry of all references to the Template but nothing.</p>\n\n<p>I found an workaround but is not suitable for solution.\nIf I open the Word template and than open the VBA module where I use it the reference will not be marked as missing.\nAlso if I change the VBA template name will load it successfully in the References.</p>\n\n<p>Can someone give me a hand with this weird behavior? I have 2 days trying to find a solution.\nThanks</p>\n"}, {"tags": ["excel", "vba", "google-maps", "web-crawler", "extract"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1569401443, "post_id": 58094490, "comment_id": 102581512, "body": "Here you will find an overview about the <a href=\"https://developers.google.com/maps/documentation\" rel=\"nofollow noreferrer\">Google Maps APIs</a> that are available. I recommend to use an API which is much more reliable than web-crawling. The API might look more difficult in the beginning but the web-crawler would need to be fixed in future everytime Google changes their output on Maps."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1569402454, "creation_date": 1569402454, "answer_id": 58094937, "question_id": 58094490, "link": "https://stackoverflow.com/questions/58094490/how-to-crawl-googlemaps-from-vba-excel/58094937#58094937", "title": "How to crawl Googlemaps from VBA Excel?", "body": "<p>This is not how I would go about it and API is definitely preferable though not via GoogleMaps unless you are building an application where you can also embed the required map. </p>\n\n<p>You need a proper page load wait, a wait for the element to be present, quit the application at the end, and use a different selector strategy. You also want to implement some logic to extract the post code from address (I am not sure what view you were getting. I used a test value of <code>Enterome</code>):</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim t As Date, gm As New InternetExplorer\n    Const MAX_WAIT_SEC As Long = 10\n\n    If Target.Row = Range(\"nom\").Row And Target.Column = Range(\"nom\").Column Then\n\n        gm.Visible = True\n        gm.navigate \"https://www.google.fr/maps/@43.3082377,5.4259519,17z?q=\" &amp; Range(\"nom\").Value\n\n        While gm.Busy Or gm.readyState &lt;&gt; 4: DoEvents: Wend\n\n        Dim elem As Object\n\n        t = Timer\n        Do\n            On Error Resume Next\n            Set elem = gm.document.querySelector(\".section-info-text\")\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While elem Is Nothing\n\n        If Not elem Is Nothing Then\n            MsgBox Trim$(elem.innerText)\n            'Implement logic to extract post code\n        End If\n        gm.Quit\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12117716, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157533731922248/picture?type=large", "display_name": "Joy", "link": "https://stackoverflow.com/users/12117716/joy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1569402454, "creation_date": 1569400975, "last_edit_date": 1569401241, "question_id": 58094490, "link": "https://stackoverflow.com/questions/58094490/how-to-crawl-googlemaps-from-vba-excel", "title": "How to crawl Googlemaps from VBA Excel?", "body": "<p>As a real beginner in coding, I am looking for some help around here ! </p>\n\n<p>I would like to extract data from GoogleMaps: let's say, Zip code, from a company input in a cell in excel, through VBA.</p>\n\n<p>As I started coding, I met difficulties at the string level as I can't target the accurate tag (here, I think, but thats the point, span) and effectively extract the zip code on the address line on Googlemaps HTML page : </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Row = Range(\"nom\").Row And _\n    Target.Column = Range(\"nom\").Column Then\n     Dim GM As New InternetExplorer\n     GM.Visible = True\n     GM.navigate \"https://www.google.fr/maps/@43.3082377,5.4259519,17z?q=\" &amp; Range(\"nom\").Value\n     Do\n     DoEvents\n     Loop Until GM.readyState = READYSTATE_COMPLETE\n     Dim doc As HTMLDocument\n     Set doc = GM.document\n     Dim sSPAN As String\n     sSPAN = Trim(doc.getElementsByTagName(\"span\")(4).innerText)\n     MsgBox sSPAN\n\n    End If\nEnd Sub\n</code></pre>\n\n<p>Line 13 displays the following errors : </p>\n\n<blockquote>\n  <p>Run Titre Error 91 : object variable or with block variable not set</p>\n</blockquote>\n\n<p>as I can't select the accurate block. </p>\n\n<p>Following this, I have two questions: </p>\n\n<ol>\n<li>Is it effectively possible to extract data from Google Maps ? (Through VBA or an opensource Google API, extracting from Google sheet (10000-lines excel) </li>\n<li>Has someone ever facde this kind of difficulty ? How can I select the accurate block on Googlemaps HTML page?</li>\n</ol>\n"}, {"tags": ["excel", "vba", "date", "calendar"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1569400184, "post_id": 58094261, "comment_id": 102580786, "body": "You are only taking the day you are in, instead you need to use <code>If Month(cell) = Month(Date) then</code> that way you pick up the month."}, {"owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1569400474, "post_id": 58094261, "comment_id": 102580928, "body": "Something like :      <code>If cell.Value = Month(Date) Then       cell.Interior.Color = &#39;Color     End If</code>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1569400614, "post_id": 58094261, "comment_id": 102580996, "body": "No, because <code>cell.value</code> is the date, not  the month... you need to use the <code>Month()</code> for both comparisions. Look at the answer below."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "edited": false, "score": 0, "creation_date": 1569400785, "post_id": 58094377, "comment_id": 102581117, "body": "Okay, it worked, thanks a lot. One last question, to color also the current day?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "edited": false, "score": 0, "creation_date": 1569400945, "post_id": 58094377, "comment_id": 102581204, "body": "@Lomoo put the one you had with <code>If</code> and checking the month a <code>ElseIf</code>"}, {"owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "edited": false, "score": 0, "creation_date": 1569401156, "post_id": 58094377, "comment_id": 102581323, "body": "Ok, i forgot also an option to color saturdays and sundays, is that possible?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1569401220, "post_id": 58094377, "comment_id": 102581364, "body": "Which one overrides, today or saturday and sunday?"}, {"owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "edited": false, "score": 0, "creation_date": 1569401345, "post_id": 58094377, "comment_id": 102581446, "body": "All three of them."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1569401416, "post_id": 58094377, "comment_id": 102581489, "body": "So if today is saturday, which colour needs to be shown? Because I believe you want today in a colour, saturdays and sundays in a different colour and the rest of the month in a different colour. So which one is it?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1569401574, "post_id": 58094377, "comment_id": 102581587, "body": "Anyhow, thinking that the If statement goes line by line and will stop when the comparision is true, what you need to know is that <code>Format(cell, &quot;dddd&quot;) = &quot;Saturday&quot;</code> or sunday will do the trick, now use it with your logic."}, {"owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "edited": false, "score": 0, "creation_date": 1569401586, "post_id": 58094377, "comment_id": 102581593, "body": "Ok sorry, i didn&#39;t understand.  If today is saturday then color as a today cell, so yellow. If today isn&#39;t Saturday/Sunday, color in RGB(170,170,170)"}, {"owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1569402139, "post_id": 58094377, "comment_id": 102581884, "body": "@Damian I didn&#39;t understand this logic well :(  What should i do?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1569402198, "post_id": 58094377, "comment_id": 102581922, "body": "<code>If Format(cell, &quot;dddd&quot;) = &quot;Saturday&quot; or Format(cell, &quot;dddd&quot;) = &quot;Sunday&quot; Then</code>"}, {"owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "edited": false, "score": 0, "creation_date": 1569402254, "post_id": 58094377, "comment_id": 102581954, "body": "And those &quot;dddd&quot;  what do they mean?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "edited": false, "score": 2, "creation_date": 1569402349, "post_id": 58094377, "comment_id": 102582004, "body": "@Lomoo go to Excel and cell formating, you can toy there and try what it does. Supose you have 25/09/2019, &quot;dd&quot; = 25, &quot;ddd&quot; = short name for the day, &quot;dddd&quot; = full name of the day. Same with month &quot;mm&quot;, &quot;mmm&quot;, &quot;mmmm&quot;  you can format a date however you need"}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 2, "last_activity_date": 1569400513, "creation_date": 1569400513, "answer_id": 58094377, "question_id": 58094261, "link": "https://stackoverflow.com/questions/58094261/how-to-automatically-color-cells-of-the-current-month-in-calendar/58094377#58094377", "title": "How to automatically color cells of the current month in calendar", "body": "<p>This replacement should work for what you're requesting:</p>\n\n<pre><code>If Month(CDate(cell.Value)) = Month(Date) Then\n  cell.Interior.Color = RGB(255, 255, 91)\nElse\n  cell.Interior.Color = RGB(255, 150, 0)\nEnd If\n</code></pre>\n\n<p>Note that you don't need two separate <code>IF</code> statements for this.</p>\n"}, {"comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1569400807, "post_id": 58094423, "comment_id": 102581132, "body": "This is totally unnecessary  Plutian, you have the <code>Month()</code> which is much shorter and clean."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1569400964, "post_id": 58094423, "comment_id": 102581213, "body": "That is indeed a cleaner way to do it, and gives the same result. I&#39;ll update my answer. I forgot about the <code>Month()</code> since I was more concerned about getting my point across about doing this with conditional formatting."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1569401249, "post_id": 58094423, "comment_id": 102581389, "body": "Whilst CF is volatile, I think I would still prefer it over a more static cell color through VBA. =)"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1569401866, "post_id": 58094423, "comment_id": 102581747, "body": "@JvdV agreed, if anything it should be considerably faster, negating the need to trigger a macro on every workbook open or change."}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": false, "score": 4, "last_activity_date": 1569849447, "last_edit_date": 1569849447, "creation_date": 1569400698, "answer_id": 58094423, "question_id": 58094261, "link": "https://stackoverflow.com/questions/58094261/how-to-automatically-color-cells-of-the-current-month-in-calendar/58094423#58094423", "title": "How to automatically color cells of the current month in calendar", "body": "<p>This can be done a lot easier with conditional formatting. Apply this formula to the range where your dates are in:</p>\n\n<pre><code>=MONTH(A1)=MONTH(NOW())\n</code></pre>\n\n<p>This will highlight every cell within that range which has a date within the current month. Make sure to change \"A1\" to the first cell within that range. Or if you want the entire row highlighted, enter <code>$*Column*1</code> instead, where <code>*Column*</code> is the column your dates are in. Then apply to your entire sheet.</p>\n\n<p><strong>EDIT</strong> As I still believe in this answer more than the VBA option I'll also answer the questions in the comments on that answer:</p>\n\n<p>Todays date can be highlighted with the formula:</p>\n\n<pre><code>=A1=TODAY()\n</code></pre>\n\n<p><strong>EDIT 2</strong>\n<a href=\"https://stackoverflow.com/questions/58096027/workday-returns-unexpected-value-on-blank-cells?noredirect=1#comment102584602_58096027\">After some trouble and learning on my part</a> the best formula to highlight the weekend days is as so:</p>\n\n<pre><code>=IF(CELL(\"format\",A1)=\"D1\",WEEKDAY(A1,2)&gt;5,FALSE)\n</code></pre>\n\n<p>With thanks to @shrivallabha.redij and @Foxfire And Burns And Burns</p>\n"}], "owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 58094377, "answer_count": 2, "score": 3, "last_activity_date": 1569849447, "creation_date": 1569400097, "question_id": 58094261, "link": "https://stackoverflow.com/questions/58094261/how-to-automatically-color-cells-of-the-current-month-in-calendar", "title": "How to automatically color cells of the current month in calendar", "body": "<p>i have a calendar in Excel which continues until July 2020. What i would like to have in my worksheet is an automatic coloration of all cells of the \"current month\" every time i open the workbook.</p>\n\n<p>I did already the \"current day auto-coloration\"\nThis is the code : </p>\n\n<pre><code>Public Sub FormattaCalendario()\n\n  Dim LColCount As Long\n  Dim cell As Variant\n\n  ultimoGiorno = DateSerial(Year(Date), Month(Date), 0)\n  primoGiorno = ultimoGiorno - Day(ultimoGiorno) + 1\n\n  LColCount = Cells(TrovaInizioProgetti(activeCell) - 1, \n  Columns.Count).End(xlToLeft).Column\n\n  For Each cell In Range(Cells(TrovaInizioProgetti(activeCell) - 1, 11), \n  Cells(TrovaInizioProgetti(activeCell) - 1, LColCount))\n\n    If cell.Value = Date Then\n      cell.Interior.Color = RGB(255, 255, 91)\n    End If\n\n    If CDate(cell.Value) &lt;&gt; Date Then\n      cell.Interior.Color = RGB(255, 150, 0)\n    End If\n\n  Next\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 323, "user_id": 12089232, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfPL0FhSRKDbRwRWWDzMUtNrVlMgKovxcm8ZNZ=k-s128", "display_name": "Dhirendra Kumar", "link": "https://stackoverflow.com/users/12089232/dhirendra-kumar"}, "edited": false, "score": 0, "creation_date": 1569406571, "post_id": 58094219, "comment_id": 102584341, "body": "So what is the challenge that you are facing? Store your currently login user location (Row Number) at some place and use it to update your data in the datasheet. If any specific code is not working we may help..."}, {"owner": {"reputation": 23, "user_id": 6801997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb85b0d2aa83ce6cc1a71bdba095191?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6801997/coder"}, "reply_to_user": {"reputation": 323, "user_id": 12089232, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfPL0FhSRKDbRwRWWDzMUtNrVlMgKovxcm8ZNZ=k-s128", "display_name": "Dhirendra Kumar", "link": "https://stackoverflow.com/users/12089232/dhirendra-kumar"}, "edited": false, "score": 0, "creation_date": 1569408305, "post_id": 58094219, "comment_id": 102585287, "body": "hi @DhirendraKumar,  i would like to have that lets say the username admin is log in . then the destination sheet will gonna be populated by the data which is on the data sheet. so the password from data sheet will be on destination sheet and the security question1, 2, 3 and answer will be on populated on the destination sheet as well."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 6801997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb85b0d2aa83ce6cc1a71bdba095191?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6801997/coder"}, "is_accepted": false, "score": 0, "last_activity_date": 1569493924, "last_edit_date": 1569493924, "creation_date": 1569493506, "answer_id": 58114740, "question_id": 58094219, "link": "https://stackoverflow.com/questions/58094219/how-to-copy-the-data-of-a-user-that-is-currently-login-from-a-data-sheet-to-dest/58114740#58114740", "title": "how to copy the data of a user that is currently login from a data sheet to destination sheet", "body": "<p>I was able to achieved the output that i want. What i did is just create a new sheet then get the data from the data sheet that is equal to a username who log in. And then paste it the new sheet. After that i just equal the cells from the new sheet to the destination sheet.</p>\n\n<p>Admin = Data Sheet</p>\n\n<p>Profile = Destination Sheet</p>\n\n<p>Consolidated = New Sheet </p>\n\n<p>Here is the Code:</p>\n\n<pre><code>Sub Transfer_Consolidated()\n\npath = \"Admin\"\n\nsql = \"\"\nsql = sql &amp; \"Select [Username], [Password], '', [Security Question 1], \n[Answer 1], [Security Question 2], [Answer 2], [Security Question 3], \n[Answer \n3]\"\nsql = sql &amp; \"From [Admin$C26:K54]\"\nsql = sql &amp; \"Where [Username] = '\" &amp; Sheet1.Range(\"userName\").Value &amp; \"'\"\n\nSheet = \"Consolidated\" '(New Sheet)\n\nLastRow = ThisWorkbook.Sheets(\"Admin\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nScrape path, sql, Sheet\n\nCall Transfer_Profile\n\nEnd Sub\n\nSub Transfer_Profile()\n\n\n Sheets(\"Profile\").Range(\"E14\").Value = _\n \"=Consolidated!B2\"\n\n Sheets(\"Profile\").Range(\"E17\").Value = _\n \"=Consolidated!D2\"\n\n Sheets(\"Profile\").Range(\"E18\").Value = _\n \"=Consolidated!E2\"\n\n Sheets(\"Profile\").Range(\"E19\").Value = _\n \"=Consolidated!F2\"\n\n Sheets(\"Profile\").Range(\"E20\").Value = _\n \"=Consolidated!G2\"\n\n Sheets(\"Profile\").Range(\"E21\").Value = _\n \"=Consolidated!H2\" '\n\n Sheets(\"Profile\").Range(\"E21\").Value = _\n \"=Consolidated!H2\"\n\n Sheets(\"Profile\").Range(\"E22\").Value = _\n \"=Consolidated!I2\"\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6801997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb85b0d2aa83ce6cc1a71bdba095191?s=128&d=identicon&r=PG&f=1", "display_name": "coder", "link": "https://stackoverflow.com/users/6801997/coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569493924, "creation_date": 1569399973, "last_edit_date": 1569405715, "question_id": 58094219, "link": "https://stackoverflow.com/questions/58094219/how-to-copy-the-data-of-a-user-that-is-currently-login-from-a-data-sheet-to-dest", "title": "how to copy the data of a user that is currently login from a data sheet to destination sheet", "body": "<p>I would like to get the data of the user that is currently login from a data sheet to a destination sheet. </p>\n\n<p>Here is the code that i worked on for login:</p>\n\n<pre><code>Option Explicit\n\nFunction GetUserName() As String\n    GetUserName = ThisWorkbook.Sheets(\"Login\").Range(\"userName\").Value\nEnd Function\n\nFunction GetPassword() As String\n    GetPassword = ThisWorkbook.Sheets(\"Login\").Range(\"passWord\").Value\nEnd Function\n\nFunction IsValidUser(u As String, p As String) As Boolean\n    Dim vu As Variant\n    Set vu = ThisWorkbook.Sheets(\"Admin\").Range(\"listOfUsers\").Find(u)\n    If Not vu Is Nothing And ThisWorkbook.Sheets(\"Admin\").Cells(vu.Row, \nvu.Column + 1).Value = p Then IsValidUser = True Else IsValidUser = False\n    Set vu = Nothing\nEnd Function\n\nFunction IsLockedUser(u As String) As Boolean\n    Dim vu As Variant\n    Set vu = ThisWorkbook.Sheets(\"Admin\").Range(\"listOfUsers\").Find(u)\n    If Not vu Is Nothing And ThisWorkbook.Sheets(\"Admin\").Cells(vu.Row, \nvu.Column + 2).Value = 0 Then IsLockedUser = True Else IsLockedUser = False\n    Set vu = Nothing\nEnd Function\n\nFunction GetNoOfAttempt() As Integer\n    GetNoOfAttempt = ThisWorkbook.Sheets(\"Login\").Range(\"noOfAttempt\").Value\nEnd Function\n\nSub SetNoOfAttempt(a As Integer)\n    ThisWorkbook.Sheets(\"Login\").Range(\"noOfAttempt\").Value = a\nEnd Sub\n\nSub Login()\n    On Error GoTo err\n    Dim totAttempt As Integer\n    totAttempt = GetNoOfAttempt\n\n    If IsValidUser(GetUserName, GetPassword) Then\n        If IsLockedUser(GetUserName) = False Then\n        ThisWorkbook.Sheets(\"Input\").Activate\n    Else\n        LockUser GetUserName\n        MsgBox GetMessage(\"userLocked\"), vbExclamation, \"Locked\"\n    End If\nElse\n    SetNoOfAttempt totAttempt - 1\n    If GetNoOfAttempt &gt; 0 Then\n        MsgBox GetMessage(\"msgLoginFailed\"), vbExclamation, \"Failed\"\n    Else\n        MsgBox GetMessage(\"maxAttempt\"), vbExclamation, \"Failed\"\n    End If\nEnd If\nExit Sub\nerr:\nMsgBox err.Description, vbExclamation, \"Error\"\nEnd Sub\n\n\nSub LockUser(u As String)\nDim vu As Variant\nSet vu = ThisWorkbook.Sheets(\"Admin\").Range(\"listOfUsers\").Find(u)\nIf Not vu Is Nothing Then ThisWorkbook.Sheets(\"Admin\").Cells(vu.Row, vu.Column + 2).Value = 0\nSet vu = Nothing\nEnd Sub\n</code></pre>\n\n<p>Here are the sheeets that i am using:</p>\n\n<p>Data Sheet\n<a href=\"https://i.stack.imgur.com/bSSj6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bSSj6.png\" alt=\"Sheet1\"></a></p>\n\n<p>Destination Sheet\n<a href=\"https://i.stack.imgur.com/UIVD4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UIVD4.png\" alt=\"Sheet2\"></a></p>\n\n<p>The purpose of this one is for update. So if the user want to change something to their data they can easily update in the destination sheet. then the save button should automatically update their data on the data sheet.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 3, "user_id": 12114905, "user_type": "registered", "profile_image": "https://graph.facebook.com/2532895220101537/picture?type=large", "display_name": "Bjorn Zonneveld", "link": "https://stackoverflow.com/users/12114905/bjorn-zonneveld"}, "reply_to_user": {"reputation": 1968, "user_id": 7393973, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/527fd7a80369379d54890cf7021d093b?s=128&d=identicon&r=PG&f=1", "display_name": "user7393973", "link": "https://stackoverflow.com/users/7393973/user7393973"}, "edited": false, "score": 0, "creation_date": 1569399421, "post_id": 58093718, "comment_id": 102580398, "body": "I made a button inside the sheet and the macro runs when clicked so it is Always selected. Do you mean the last cell that is used? D210"}], "answers": [{"comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 3, "user_id": 12114905, "user_type": "registered", "profile_image": "https://graph.facebook.com/2532895220101537/picture?type=large", "display_name": "Bjorn Zonneveld", "link": "https://stackoverflow.com/users/12114905/bjorn-zonneveld"}, "edited": false, "score": 0, "creation_date": 1569399940, "post_id": 58094064, "comment_id": 102580677, "body": "You&#39;re welcome. Consider accepting my answer if your issue is now resolved. Also <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this might be a useful read to you</a> for this and future projects."}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": true, "score": 1, "last_activity_date": 1569399390, "creation_date": 1569399390, "answer_id": 58094064, "question_id": 58093718, "link": "https://stackoverflow.com/questions/58093718/i-get-an-error-when-trying-to-copy-worksheet-to-email/58094064#58094064", "title": "I get an error when trying to copy worksheet to email", "body": "<p>There is an issue with the following line:</p>\n\n<pre><code>sh.Range(\"A1:D200\" &amp; lr).Select\n</code></pre>\n\n<p>What happens is you fill the end of the range in (D200) and then add the value of lastrow to that end range. Say lastrow is 50, excel will then see the range that you set as \"D200\" &amp; \"50\" making it \"D20050\" which is obviously not what you want. Amend the line like so:</p>\n\n<pre><code>sh.Range(\"A1:D\" &amp; lr).Select\n</code></pre>\n\n<p>Which gives you the range of \"A1:D\" &amp; \"50\", making it \"A1:D50\" which is the correct output.</p>\n"}], "owner": {"reputation": 3, "user_id": 12114905, "user_type": "registered", "profile_image": "https://graph.facebook.com/2532895220101537/picture?type=large", "display_name": "Bjorn Zonneveld", "link": "https://stackoverflow.com/users/12114905/bjorn-zonneveld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 58094064, "answer_count": 1, "score": 0, "last_activity_date": 1569399390, "creation_date": 1569398008, "last_edit_date": 1569398854, "question_id": 58093718, "link": "https://stackoverflow.com/questions/58093718/i-get-an-error-when-trying-to-copy-worksheet-to-email", "title": "I get an error when trying to copy worksheet to email", "body": "<p>I am trying to automate copying and sending emails. However I get an error on line (<code>sh.Range(\"A1:D200\" &amp; lr).Select</code>) if I change the <strong>200</strong> to <strong>50</strong> it works but with 200 it does not work. The error I get is <code>1004 out of range</code>.</p>\n\n<pre><code>Option Explicit\n\nSub Send_Email_With_snapshotDyka()\nDim sh As Worksheet\nSet sh = ThisWorkbook.Sheets(\"Dyka PVC\")\n\nDim lr As Integer\nlr = sh.Range(\"A\" &amp; Application.Rows.Count).End(xlUp).Row\n\nsh.Range(\"A1:D200\" &amp; lr).Select\n\nWith Selection.Parent.MailEnvelope.Item\n    .to = sh.Range(\"H3\").Value\n    .Subject = sh.Range(\"H4\").Value\n    .send\n\nEnd With\n\nMsgBox \"done\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "internet-explorer", "web-scraping", "automation"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12117171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bfb8a65b62043d50957db69cd22d2d3?s=128&d=identicon&r=PG&f=1", "display_name": "Jahid Hossain", "link": "https://stackoverflow.com/users/12117171/jahid-hossain"}, "edited": false, "score": 0, "creation_date": 1569494698, "post_id": 58093367, "comment_id": 102619353, "body": "I am new ... so would you please provide full code for me. I didn&#39;t understand where I actually need to do changes?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 12117171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bfb8a65b62043d50957db69cd22d2d3?s=128&d=identicon&r=PG&f=1", "display_name": "Jahid Hossain", "link": "https://stackoverflow.com/users/12117171/jahid-hossain"}, "edited": false, "score": 0, "creation_date": 1569498877, "post_id": 58093367, "comment_id": 102621617, "body": "Please see edit and let me know if that is clearer."}, {"owner": {"reputation": 11, "user_id": 12117171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bfb8a65b62043d50957db69cd22d2d3?s=128&d=identicon&r=PG&f=1", "display_name": "Jahid Hossain", "link": "https://stackoverflow.com/users/12117171/jahid-hossain"}, "edited": false, "score": 0, "creation_date": 1569754552, "post_id": 58093367, "comment_id": 102692067, "body": "No it didn&#39;t work ..would you please tell me what is the code for mouseover on menu and click in vba?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 12117171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bfb8a65b62043d50957db69cd22d2d3?s=128&d=identicon&r=PG&f=1", "display_name": "Jahid Hossain", "link": "https://stackoverflow.com/users/12117171/jahid-hossain"}, "edited": false, "score": 0, "creation_date": 1569754624, "post_id": 58093367, "comment_id": 102692077, "body": "I suggest updating the question with all the relevant details and what you are trying to achieve."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1569498866, "last_edit_date": 1569498866, "creation_date": 1569396874, "answer_id": 58093367, "question_id": 58093215, "link": "https://stackoverflow.com/questions/58093215/how-to-select-drop-down-menu-in-vba/58093367#58093367", "title": "How to Select Drop Down Menu in VBA", "body": "<p>Instead of this code:</p>\n\n<pre><code>For Each ele In doc.getElementByclassName(\"ddsubmenustyle\")(0).getElementByTagName(\"a\")\n    If InStr(ele.href, \"/tenderer/MyTenders.jsp\") &gt; 0 Then doc.navigate ele.href: Exit For\nNext ele\n</code></pre>\n\n<p>You can replace those lines with using an <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Attribute_selectors\" rel=\"nofollow noreferrer\">attribute = value</a> css selector with contains operator or even ends with operator i.e.</p>\n\n<pre><code>ie.document.querySelector(\"[href$='MyTenders.jsp']\").click\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12117171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bfb8a65b62043d50957db69cd22d2d3?s=128&d=identicon&r=PG&f=1", "display_name": "Jahid Hossain", "link": "https://stackoverflow.com/users/12117171/jahid-hossain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1569498866, "creation_date": 1569396370, "last_edit_date": 1569396955, "question_id": 58093215, "link": "https://stackoverflow.com/questions/58093215/how-to-select-drop-down-menu-in-vba", "title": "How to Select Drop Down Menu in VBA", "body": "<p>Here is my VBA code I am new with this. Several time I tried to access to drop down menu 'My Tender' under Tabheader menu 'Tender' but I couldn't do it. I don't understand where I need to do correction for this...</p>\n\n<pre><code>Sub Test()\n    Dim IE As InternetExplorer\n    Dim doc As HTMLDocument\n    Dim ele As HTMLElementCollection\n\n\n    Set IE = New InternetExplorer\n    IE.Visible = True\n\n    IE.navigate \"https://www.eprocure.gov.bd\"\n\n    Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE\n        DoEvents\n    Loop\n\n    Set doc = IE.document\n\n    doc.getElementById(\"txtEmailId\").Value = \"******\"\n    doc.getElementById(\"txtPassword\").Value = \"******\"\n    doc.getElementById(\"btnLogin\").Click\n\n\n\n    For Each ele In doc.getElementByclassName(\"ddsubmenustyle\")(0).getElementByTagName(\"a\")\n        If InStr(ele.href, \"/tenderer/MyTenders.jsp\") &gt; 0 Then doc.navigate ele.href: Exit For\n    Next ele\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Here is my HTML Code where I want to get my access ....</p>\n\n<hr>\n\n<pre><code>                &lt;ul&gt;\n\n                    &lt;li&gt;&lt;a title=\"Home\" href=\"/Index.jsp\" id=\"headTabHomePage\"&gt;&lt;img alt=\"Home\" src=\"/resources/images/Dashboard/HomeIcn.png\"&gt;Home&lt;/a&gt;&lt;/li&gt;\n\n\n                    &lt;li&gt;&lt;a title=\"Message Box\" href=\"/resources/common/InboxMessage.jsp\" id=\"headTabMsgBox\"&gt;&lt;img alt=\"Message Box\" src=\"/resources/images/Dashboard/msgBoxIcn.png\"&gt;Message Box&lt;/a&gt;&lt;/li&gt;\n                    &lt;li&gt;&lt;a title=\"APP\" href=\"#\" rel=\"submenu-configuration\" id=\"headTabApp\" class=\"\"&gt;&lt;img alt=\"APP\" src=\"/resources/images/Dashboard/AppIcn_1.png\"&gt;APP&lt;/a&gt;&lt;/li&gt;\n                    &lt;li&gt;&lt;a title=\"Tender\" href=\"#\" rel=\"ddsubmenu2\" id=\"headTabTender\" **class=\"selected\"&gt;&lt;img alt=\"Tender\" src=\"/resources/images/Dashboard/tenderIcn.png\"&gt;Tender&lt;/a&gt;&lt;/li&gt;\n                    &lt;li&gt;**&lt;a title=\"Doc. Library\" href=\"#\" rel=\"docMenu\" id=\"headTabDocLib\" class=\"\"&gt;&lt;img alt=\"Doc. Library\" src=\"/resources/images/Dashboard/DocLib.gif\"&gt;Doc. Library&lt;/a&gt;&lt;/li&gt;\n\n\n                &lt;/ul&gt;\n</code></pre>\n\n<hr>\n\n<pre><code>                &lt;ul&gt;\n\n                &lt;li&gt;&lt;a href=\"/tenderer/TenderWatchList.jsp\"&gt;Watch List&lt;/a&gt;&lt;/li&gt;\n                **&lt;li&gt;&lt;a href=\"/tenderer/MyTenders.jsp\"&gt;My Tenders&lt;/a&gt;&lt;/li&gt;**\n                &lt;li&gt;&lt;a href=\"/tenderer/RestrictedTenders.jsp\"&gt;Limited Tenders&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a href=\"/resources/common/AllTenders.jsp?h=f\"&gt;All Tenders&lt;/a&gt;&lt;/li&gt;\n\n                &lt;li&gt;&lt;a href=\"/tenderer/JvcaList.jsp\"&gt;Propose JVCA&lt;/a&gt;&lt;/li&gt;\n\n                     &lt;/ul&gt;\n</code></pre>\n\n<hr>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1569401889, "post_id": 58092783, "comment_id": 102581759, "body": "It&#39;s not clear how your posted code relates to your question."}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1569424193, "creation_date": 1569424193, "answer_id": 58101562, "question_id": 58092783, "link": "https://stackoverflow.com/questions/58092783/replace-input-box-with-looping-function/58101562#58101562", "title": "Replace Input box with Looping function", "body": "<p>I guess you'er after something like this:</p>\n\n<pre><code>Sub Button112_Click()\n\n    Dim lastRow As Long, i As Long\n\n    With Worksheets(\"mySheetName\")'change mySheetName to suit your needs\n\n        lastRow = .Cells(Rows.Count, 15).End(xlUp).Row\n        For i = 1 To lastRow\n            If .Cells(i, 15).Value2 = \"Yes\" Then\n                ThisWorkbook.Sheets(\"Template\").Copy After:=Worksheets(Sheets.Count)\n                ActiveSheet.Name = .Cells(i, 3).Value2\n                Range(\"$D$3\").Value = .Cells(i, 3).Value2\n            End If\n        Next\n\n    End With\n\n    .... \n    rest of your code\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11080014, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_j3f30fbh4w/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQP1I5w7PjPpIL5LwwO7SwrsI57zCw/mo/photo.jpg?sz=128", "display_name": "Tommy Li", "link": "https://stackoverflow.com/users/11080014/tommy-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 58101562, "answer_count": 1, "score": 0, "last_activity_date": 1569424193, "creation_date": 1569394938, "last_edit_date": 1569400028, "question_id": 58092783, "link": "https://stackoverflow.com/questions/58092783/replace-input-box-with-looping-function", "title": "Replace Input box with Looping function", "body": "<p>So I'd like to create a looping function - where<br>\nIf the response in Column O is 'Yes' input the value in Column C as the 'new name' of the copied sheet\nLoop until Column O is blank</p>\n\n<p>I know I have to remove the Inputbox(\"Enter the name for the copied worksheet\")<br>\nHowever I'm not sure what to put after newname as the looping function</p>\n\n<pre><code>Sub Button112_Click()\n\nDim newName As String\n\nOn Error Resume Next\nnewName = InputBox(\"Enter the name for the copied worksheet\")\nIf newName &lt;&gt; \"\" Then\n\n\n    ThisWorkbook.Sheets(\"Template\").Copy After:=Worksheets(Sheets.Count)\n    On Error Resume Next\n    ActiveSheet.Name = newName\n    Range(\"$D$3\").Value = newName\nEnd If\n\nDim n As Name\nFor Each n In ActiveWorkbook.Names\nn.Visible = True\nNext n\n\nDim numrow\nnumrow = Range(\"F16\").Value\n\nIf IsNumeric(numrow) Then\n\nFor i = 1 To numrow\n\nCall INRW\n\nNext i\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I've tried something similar to this, but with no success</p>\n\n<pre><code>   lastRow = .Cells(Rows.Count, 15).End(xlUp).Row\n        For i = 1 To lastRow\n        If .Cells(i, 15).Value2 = \"Yes\" Then CopySheetAndRename (.Cells(i, 3).Value2)\n        Next i\n    End With\n\n    End Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569393669, "post_id": 58092462, "comment_id": 102577566, "body": "Which line is highlighted when error appears?"}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569393980, "post_id": 58092462, "comment_id": 102577702, "body": "this one <code>temps = html.getElementsByClassName(&quot;high&quot;)(0).innerText</code>"}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1569398009, "post_id": 58093185, "comment_id": 102579662, "body": "I already referenced <code>Microsoft Scripting Runtime</code> but im still getting <code>variable not defined</code> on this line <code>Set json = JsonConverter.ParseJson(jsonSource)</code>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1569399869, "post_id": 58093185, "comment_id": 102580644, "body": "Did you add the code from the link to a standard module named JsonConverter?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1569400319, "post_id": 58093185, "comment_id": 102580859, "body": "Also, remove the top line from the code you copy across <i>Attribute VB_Name = &quot;JsonConverter&quot;</i>"}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1569470190, "post_id": 58093185, "comment_id": 102608676, "body": "Its working now but it errors out on the third loop <code>subscript out of range</code> on this part <code>results(r, 1) = datePart</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1569474222, "post_id": 58093185, "comment_id": 102609616, "body": "I just ran it twice without a problem. If it happens again you need to inspect the value of  json.count. I do notice that currently @ 06:05 GMT yesterday&#39;s date has only Hist Avg on the web page and thus code currently therefore returns nothing for that date."}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1569479594, "post_id": 58093185, "comment_id": 102611535, "body": "Did you tried to run it on a loop with different dates?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1569479621, "post_id": 58093185, "comment_id": 102611545, "body": "Nope as the question didn&#39;t ask for that. The code gets all the dates and temps as currently listed for your given url. That page appears to update. Unless you mean a loop of all dates on that page - in which case, yes"}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1569479825, "post_id": 58093185, "comment_id": 102611640, "body": "Sorry I mean different links"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 1, "creation_date": 1569479894, "post_id": 58093185, "comment_id": 102611673, "body": ":-) Nope. Question didn&#39;t ask for that. I have no idea what those other links would be. You could open a new question and I would be happy to have a look but please include the new links and be sure to indicate where the code is falling over and what you suspect is the problem."}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1569480262, "post_id": 58093185, "comment_id": 102611826, "body": "Ill post another question. The links would be from the same site but just different places (ie. Chicago, Denver, etc. Thanks"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1569480297, "post_id": 58093185, "comment_id": 102611848, "body": "No worries. Drop me a link to the new question and I will have a look and see if we can work out what is going on."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1569401013, "last_edit_date": 1569401013, "creation_date": 1569396273, "answer_id": 58093185, "question_id": 58092462, "link": "https://stackoverflow.com/questions/58092462/get-web-page-data-through-class-name/58093185#58093185", "title": "get web page data through class name", "body": "<p>You need an User-Agent header. I would also extract the json string from one of the script tags (I use regex for this) and use that as source. I add in a date comparison to work out if it is a forecast or actual value. I read the json string into json object using json library and loop the resultant collection storing items of interest in an array for faster writing out to sheet at end.</p>\n\n<p><strong>json library:</strong></p>\n\n<p>I use jsonconverter.bas. Download raw code from <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas\" rel=\"nofollow noreferrer\">here</a> and add to standard module called jsonConverter . You then need to go VBE > Tools > References > Add reference to Microsoft Scripting Runtime.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetWeatherListings()\n\n    Dim s As String, re As Object, ws As Worksheet\n\n    Set re = CreateObject(\"vbscript.regexp\")\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.accuweather.com/en/us/chicago/60608/september-weather/348308\", False\n       ' .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .setRequestHeader \"User-Agent\", \"Mozilla/5.0\"\n        .send\n        s = .responsetext\n    End With\n\n    Dim results(), r As Long, jsonSource As String, json As Object, item As Object\n\n    jsonSource = GetString(re, s, \"dailyForecast = (.*?\\])\")\n\n    If jsonSource = \"No match\" Then Exit Sub\n\n    Set json = JsonConverter.ParseJson(jsonSource)\n\n    ReDim results(1 To json.count, 1 To 4) 'date, datetime,  day &gt; dActual, night &gt; dActual\n\n    Dim dateTime() As String, datePart As String, forecast As Boolean\n\n    For Each item In json\n        r = r + 1\n        dateTime = Split(item(\"dateTime\"), \"T\")\n        datePart = dateTime(LBound(dateTime))\n        forecast = CDate(datePart) &gt;= Date\n        results(r, 1) = datePart\n        results(r, 2) = item(\"dateTime\")\n        results(r, 3) = IIf(forecast, item(\"day\")(\"dTemp\"), item(\"day\")(\"dActual\"))\n        results(r, 4) = IIf(forecast, item(\"night\")(\"dTemp\"), item(\"night\")(\"dActual\"))\n    Next\n\n    Dim headers()\n\n    headers = Array(\"Date\", \"DateTime\", \"Day temp\", \"Night temp\")\n\n    With ws\n        .Cells(1, 1).Resize(1, UBound(headers) + 1) = headers\n        .Cells(2, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\n    End With\nEnd Sub\n\nPublic Function GetString(ByVal re As Object, ByVal inputString As String, ByVal pattern As String) As String\n    Dim matches As Object\n\n    With re\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = True\n        .pattern = pattern\n        If .Test(inputString) Then\n            Set matches = .Execute(inputString)\n            GetString = matches(0).SubMatches(0)\n            Exit Function\n        End If\n    End With\n    GetString = \"No match\"\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>Sample of end of output:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/EioXC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EioXC.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 58093185, "answer_count": 1, "score": 1, "last_activity_date": 1569401013, "creation_date": 1569393538, "last_edit_date": 1569399583, "question_id": 58092462, "link": "https://stackoverflow.com/questions/58092462/get-web-page-data-through-class-name", "title": "get web page data through class name", "body": "<p>I need to get the dates and temp from a weather website and record it on  cells but I am getting a <code>object variable or with block variable not set</code> error.</p>\n\n<p>I tried to data from web in excel but I think the website is protected or something because I keep getting \"under maintenance\" page when trying to load the page from excel. I got the codes below from a tutorial but I can't make it work.</p>\n\n<pre><code>Sub record()\n\n    Dim request As Object\n    Dim response As String\n    Dim html As New HTMLDocument\n    Dim websie As String\n    Dim temps As Variant\n\n    'provide link\n    'website = \"https://finance.yahoo.com/quote/EURUSD=X?p=EURUSD=X\"\n    website = \"https://www.accuweather.com/en/us/chicago/60608/september-weather/348308\"\n\n    'create the object that will make the webpage request\n    Set request = CreateObject(\"MSXML2.XMLHTTP\")\n\n    'go to the link\n    request.Open \"GET\", website, False\n\n    'send request for webpage\n    request.send\n\n    'get web response data to variable\n    response = StrConv(request.responseBody, vbUnicode)\n\n    'put webpage to an html object\n    html.body.innerHTML = response\n\n    'get temperature from specified element\n    'temps = html.getElementsByClassName(\"Trsdu(0.3s) Fw(b) Fz(36px) Mb(-4px) D(ib)\")(0).innerText\n    temps = html.getElementsByClassName(\"high\")(0).innerText\n\n\n     Sheets(\"record\").Range(\"A1\") = temps\n\nEnd Sub\n</code></pre>\n\n<p>Sample lines from the website:</p>\n\n<pre><code>&lt;a class=\"monthly-daypanel is-past\"&gt;\n   &lt;div class=\"date\"&gt;2&lt;/div&gt;\n   &lt;div class=\"icon-container\"...&lt;/div&gt;\n   &lt;div class=\"temp\"&gt;\n      &lt;div class=\"high\"&gt;83&lt;/div&gt;\n      &lt;div class=\"low\"&gt;83&lt;/div&gt;\n   &lt;/div&gt;\n&lt;/a&gt;\n</code></pre>\n\n<p>I want to get the <code>date</code>, <code>high</code> and <code>low</code>.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 2, "creation_date": 1569389066, "post_id": 58091465, "comment_id": 102575828, "body": "Hello, first of all try to avoid .Select <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?rq=1\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 17, "user_id": 12112903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb73713df3e5fcc546547a2ce0e79cc?s=128&d=identicon&r=PG&f=1", "display_name": "Roguen", "link": "https://stackoverflow.com/users/12112903/roguen"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569389915, "post_id": 58091465, "comment_id": 102576108, "body": "Hi Teamothy,   Kindly suggest me with some changes in my code. I am a beginner."}, {"owner": {"reputation": 773, "user_id": 11158132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/836d70ae291879b732a8bc21190f10a9?s=128&d=identicon&r=PG&f=1", "display_name": "JLCH", "link": "https://stackoverflow.com/users/11158132/jlch"}, "edited": false, "score": 0, "creation_date": 1569390490, "post_id": 58091465, "comment_id": 102576292, "body": "Hello Roguen and welcome to SO. I&#39;m sorry, but your question is not very clear. Can you edit it so we understand what you try to achieve ? eg. Are you trying to select each non-empty cell in B:B and sum it in C1 ? Are you familiar with defining variables at the beginning of your macro ?"}, {"owner": {"reputation": 17, "user_id": 12112903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb73713df3e5fcc546547a2ce0e79cc?s=128&d=identicon&r=PG&f=1", "display_name": "Roguen", "link": "https://stackoverflow.com/users/12112903/roguen"}, "edited": false, "score": 0, "creation_date": 1569391318, "post_id": 58091465, "comment_id": 102576613, "body": "Hi I have added a snapshot. In this case i would like to have the sum in B2 cell (I.e) B3 to B6 cells are summed in B2. If i change the number of rows present in the column B the code takes only the B3 to B6 but i need to sum from B3 to Non empty cell which may be B7"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 12112903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb73713df3e5fcc546547a2ce0e79cc?s=128&d=identicon&r=PG&f=1", "display_name": "Roguen", "link": "https://stackoverflow.com/users/12112903/roguen"}, "edited": false, "score": 0, "creation_date": 1569392772, "post_id": 58092131, "comment_id": 102577163, "body": "Hi It is working but in my case i would like to sum only the first set of non empty cells and return the value in B2. After getting i will take the value to new sheet. Then i will replace the old values with different row number."}], "tags": [], "owner": {"reputation": 323, "user_id": 12089232, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfPL0FhSRKDbRwRWWDzMUtNrVlMgKovxcm8ZNZ=k-s128", "display_name": "Dhirendra Kumar", "link": "https://stackoverflow.com/users/12089232/dhirendra-kumar"}, "is_accepted": true, "score": 0, "last_activity_date": 1569393489, "last_edit_date": 1569393489, "creation_date": 1569392016, "answer_id": 58092131, "question_id": 58091465, "link": "https://stackoverflow.com/questions/58091465/select-range-instead-of-specific-cell-value-with-vba/58092131#58092131", "title": "Select range instead of specific cell value with VBA", "body": "<p>To get the sum of all the non empty cells in Column \"B\" and return it to Column \"B2\" as I can understand with the image, following is the code which help you:</p>\n\n<pre><code>Range(\"B2\").FormulaR1C1 = \"=Sum(R3C:R\" &amp; ActiveSheet.UsedRange.Rows.Count + 1 &amp; \"C)\"\n</code></pre>\n\n<p>You may use following code to get the sum of till first empty cell:</p>\n\n<pre><code>Range(\"B2\").FormulaR1C1 = \"=Sum(R3C:R\" &amp; Range(\"B3\").End(xlDown).Row &amp; \"C)\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 12112903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb73713df3e5fcc546547a2ce0e79cc?s=128&d=identicon&r=PG&f=1", "display_name": "Roguen", "link": "https://stackoverflow.com/users/12112903/roguen"}, "edited": false, "score": 0, "creation_date": 1569395088, "post_id": 58092395, "comment_id": 102578231, "body": "Great. In my case Column will Have a set of unique values. I m calculating the set of non empty values and pasting it in the B2. Then i will take down the values corresponding to A2 and B2 to new sheet. Then i will replace the old value with new set of values i.e i will delete the entire column which i have summed. the proceeding value will come to B3 correspondingly"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1569393265, "creation_date": 1569393265, "answer_id": 58092395, "question_id": 58091465, "link": "https://stackoverflow.com/questions/58091465/select-range-instead-of-specific-cell-value-with-vba/58092395#58092395", "title": "Select range instead of specific cell value with VBA", "body": "<p>use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.specialcells\" rel=\"nofollow noreferrer\"><code>SpecialCells</code></a> method of <code>Range</code> object to get not empty cells in a given range</p>\n\n<p>then use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.areas\" rel=\"nofollow noreferrer\"><code>Areas</code></a> property of <code>Range</code> object to loop through each group of consecutive not empty cells</p>\n\n<pre><code>Option Explicit\n\nSub SumThem()\n    Dim c As Range\n\n    For Each c In Intersect(ActiveSheet.UsedRange, Columns(2)).Offset(1).SpecialCells(xlCellTypeConstants).Areas ' loop through each \"area\" (i.e.: group of consecutive cells with \"constant\" values) of column B from row 2 downwards\n        c.Resize(1).Offset(-1, 0).Formula = \"=+SUM(\" &amp; c.Address &amp; \")\" ' place the sum of current \"area\" in the cell right above it\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 12112903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb73713df3e5fcc546547a2ce0e79cc?s=128&d=identicon&r=PG&f=1", "display_name": "Roguen", "link": "https://stackoverflow.com/users/12112903/roguen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 58092131, "answer_count": 2, "score": -2, "last_activity_date": 1569393494, "creation_date": 1569387801, "last_edit_date": 1569393494, "question_id": 58091465, "link": "https://stackoverflow.com/questions/58091465/select-range-instead-of-specific-cell-value-with-vba", "title": "Select range instead of specific cell value with VBA", "body": "<p>I got little project in VBA and stuck on below topic</p>\n\n<p><a href=\"https://i.stack.imgur.com/Kv8Ya.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kv8Ya.png\" alt=\"enter image description here\"></a></p>\n\n<p>I need to Sum selected range in first empty cell in B column. I tried a small macro in which it sums the same row which mentioned in the vba.</p>\n\n<p>This is what I've found and try to use</p>\n\n<pre><code>Sub Macro9()\n   '\n   ' Macro9 Macro\n   '\n   '\n    Range(\"A3\").Select\n    Selection.Copy\n    Range(\"A2\").Select\n    ActiveSheet.Paste\n    Range(\"B2\").Select\n    Application.CutCopyMode = False\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = \"=+SUM(R[1]C:R[3]C)\"\n    Range(\"B2\").Select\n    Selection.Copy\n    Range(\"B3\").Select\n    Selection.End(xlToRight).Select\n    Range(\"S2\").Select\n    Range(Selection, Selection.End(xlToLeft)).Select\n    ActiveSheet.Paste\n    Selection.End(xlToLeft).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Windows(\"Final.xlsx\").Activate\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False\n    Range(\"A6\").Select\n    Windows(\"copy.xlsm\").Activate\n    Rows(\"2:2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlUp\n    Selection.End(xlToLeft).Select\nEnd Sub\n</code></pre>\n\n<p>I tried to searched for last non-empty cell in selected range so it won't search the whole column</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1569391643, "post_id": 58091177, "comment_id": 102576738, "body": "Yes, there is a relatively simple way to do this. However, SO is not a free coding service (and certainly is a not a paid one!). You will get a better response if you show what coding you have tried already, and explain how these results different from what you want/expect."}, {"owner": {"reputation": 15, "user_id": 12113527, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa10LBo4AeAdnpHY1HbFk73nsy1rqPVAmmQPDklg=k-s128", "display_name": "Vasishta", "link": "https://stackoverflow.com/users/12113527/vasishta"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1569394242, "post_id": 58091177, "comment_id": 102577829, "body": "As I said I am inexperienced with VB. Please help me!"}, {"owner": {"reputation": 5744, "user_id": 722393, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dc974b4440cea2f89bd99c0cb0b75da1?s=128&d=identicon&r=PG", "display_name": "InteXX", "link": "https://stackoverflow.com/users/722393/intexx"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1569397197, "post_id": 58091177, "comment_id": 102579261, "body": "As @AJD indicated, you&#39;ll get a better response if you show what coding you have tried already, and explain how these results are different from what you want/expect. You&#39;ll also want to describe what research you&#39;ve done so far. An advanced knowledge of VB.NET isn&#39;t required for this information."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1569478319, "post_id": 58091177, "comment_id": 102611033, "body": "You might benefit from reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and  <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12113527, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa10LBo4AeAdnpHY1HbFk73nsy1rqPVAmmQPDklg=k-s128", "display_name": "Vasishta", "link": "https://stackoverflow.com/users/12113527/vasishta"}, "edited": false, "score": 0, "creation_date": 1569491076, "post_id": 58110766, "comment_id": 102617462, "body": "Thanks a lot! I am using it!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15, "user_id": 12113527, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa10LBo4AeAdnpHY1HbFk73nsy1rqPVAmmQPDklg=k-s128", "display_name": "Vasishta", "link": "https://stackoverflow.com/users/12113527/vasishta"}, "edited": false, "score": 1, "creation_date": 1569509562, "post_id": 58110766, "comment_id": 102627940, "body": "@Vasishta If this answered your question please upvote/mark it as solved: <a href=\"https://meta.stackexchange.com/a/5235\">Accepting Answers: How does it work?</a>"}, {"owner": {"reputation": 15, "user_id": 12113527, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa10LBo4AeAdnpHY1HbFk73nsy1rqPVAmmQPDklg=k-s128", "display_name": "Vasishta", "link": "https://stackoverflow.com/users/12113527/vasishta"}, "edited": false, "score": 0, "creation_date": 1569561552, "post_id": 58110766, "comment_id": 102643776, "body": "In the output file ROW headings are missing."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15, "user_id": 12113527, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa10LBo4AeAdnpHY1HbFk73nsy1rqPVAmmQPDklg=k-s128", "display_name": "Vasishta", "link": "https://stackoverflow.com/users/12113527/vasishta"}, "edited": false, "score": 0, "creation_date": 1569563971, "post_id": 58110766, "comment_id": 102644470, "body": "That wasn&#39;t part of the original question. Please ask a new question for that and show what you have tried to accomplish that. This is not a free code writing service."}, {"owner": {"reputation": 15, "user_id": 12113527, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa10LBo4AeAdnpHY1HbFk73nsy1rqPVAmmQPDklg=k-s128", "display_name": "Vasishta", "link": "https://stackoverflow.com/users/12113527/vasishta"}, "edited": false, "score": 0, "creation_date": 1569566304, "post_id": 58110766, "comment_id": 102645331, "body": "Once again thanks for helping me. Refer my question and output, wherein I requested ROW headings."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15, "user_id": 12113527, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa10LBo4AeAdnpHY1HbFk73nsy1rqPVAmmQPDklg=k-s128", "display_name": "Vasishta", "link": "https://stackoverflow.com/users/12113527/vasishta"}, "edited": false, "score": 0, "creation_date": 1569567822, "post_id": 58110766, "comment_id": 102646038, "body": "Well in your first example there is no header. Then you mix up <code>,</code> and <code>;</code> in your example so it is pretty much unclear what you actually want to do. Anyway this answer shows how you would do it in principle and you should be able to improve it yourself. Again this is no code writing service where you can put your requests and get a code for free. But we can help you to accomplish your task if you show your effort and what you have tried. So please try to add the headers yourself and if you get stuck or errors ask a question to what you have tried."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1569479349, "creation_date": 1569479349, "answer_id": 58110766, "question_id": 58091177, "link": "https://stackoverflow.com/questions/58091177/convert-excel-row-to-a-single-text-file/58110766#58110766", "title": "Convert Excel row to a single text file", "body": "<p>You just need to ajust the output part a bit how you generate each line:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub WriteToTextFile()\n    Dim ws As Worksheet\n    Set ws = ActiveSheet 'better by its name: ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim LastCol As Long\n    LastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column\n\n    Open \"C:\\Users\\Admin\\Desktop\\123.txt\" For Output As #1\n\n    Dim iRow As Long\n    For iRow = 2 To LastRow\n        Dim OutputLine As String\n\n        Dim iCol As Long\n        For iCol = 1 To LastCol\n            If iCol = 1 Then 'first column (is different)\n                OutputLine = ws.Cells(iRow, iCol).Text\n            Else 'append other columns\n                OutputLine = OutputLine &amp; \",\" &amp; ws.Cells(1, iCol).Text &amp; \": \" &amp; ws.Cells(iRow, iCol).Text\n            End If\n        Next iCol\n        'Debug.Print OutputLine\n        Print #1, OutputLine 'output the full line to the text file\n    Next iRow\n\n    Close #1\n    Shell \"notepad.exe \"\"C:\\Users\\Admin\\Desktop\\123.txt\"\"\", vbNormalFocus\nEnd Sub\n</code></pre>\n\n<p>This will output</p>\n\n<pre><code>97,ID2: 12,ID3: 47\n08,ID2: 09,ID3: 54\n17,ID2: 46,ID3: 07\n</code></pre>\n\n<p>if the source data was\n<a href=\"https://i.stack.imgur.com/PZZGO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PZZGO.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 15, "user_id": 12113527, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAa10LBo4AeAdnpHY1HbFk73nsy1rqPVAmmQPDklg=k-s128", "display_name": "Vasishta", "link": "https://stackoverflow.com/users/12113527/vasishta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 58110766, "answer_count": 1, "score": -1, "last_activity_date": 1569479349, "creation_date": 1569385834, "last_edit_date": 1569478113, "question_id": 58091177, "link": "https://stackoverflow.com/questions/58091177/convert-excel-row-to-a-single-text-file", "title": "Convert Excel row to a single text file", "body": "<p>I need to generate a text file for an Excel spreadsheet. However, the number of columns and rows is unknown in advance, and the format needs to be fairly specific. For example, given the following Excel format:</p>\n\n<pre>\nID1 | ID2 |ID3\n97  | 12  | 47\n08  | 09  | 54\n17  | 46  | 07\n</pre>\n\n<p>The output text file (single text file) would read as follows: </p>\n\n<pre>\n97,ID2:12;ID3:47\n08,ID2:09;ID3:54\n17,ID2:46;ID3:07\n</pre>\n\n<p>Is there a simple way to do this using VBA?</p>\n\n<p>Presently I tried below a macro:</p>\n\n<pre><code>Sub WriteToTextFile()\n    Dim iLastRow As Long\n    Dim iLastCol As Long\n    iLastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    iLastCol = Cells(1, Columns.Count).End(xlToLeft).Column\n    Open \"C:\\Users\\Admin\\Desktop\\123.txt\" For Output As #1\n    For i = 1 To iLastRow\n        For j = 1 To iLastCol\n            If j &lt;&gt; iLastCol Then\n                Print #1, \"ID1: \"; Cells(i, j),\n            Else\n                Print #1, \"ID2: \"; Cells(i, j)\n            End If\n        Next j\n    Next i\n    Close #1\n    Shell \"notepad.exe \"\"C:\\Users\\Admin\\Desktop\\123.txt\", vbNormalFocus\nEnd Sub\n</code></pre>\n\n<p>By using the above macro, I will get the output as mentioned below:</p>\n\n<pre><code>ID1: Col1     ID1: Col2     ID1: Col3     ID4: Col4\nID1:  1234567890            ID1: AJAY     ID1:  70      ID4:  72 \nID1:  1234567890            ID1: AJAY     ID1:  71      ID4:  73 \nID1:  1234567890            ID1: AJAY     ID1:  72      ID4:  74 \n</code></pre>\n\n<p>But I need output as stated below:</p>\n\n<pre><code>Col1,Col2,Col3,Col4\n1234567890,ID2: AJAY,ID3: 70,ID4: 72 \n1234567890,ID2: AJAY,ID3: 71,ID4: 73\n</code></pre>\n\n<p>Please help me!</p>\n"}, {"tags": ["vba", "forms", "ms-access"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1569387583, "post_id": 58091048, "comment_id": 102575422, "body": "If you declare <code>Form1 As Form</code>, and then use it without assigning that variable any reference, you <i>are</i> referring to an invalid object reference and that will always raise error 91. Access forms are document modules, like Worksheet modules in Excel: they&#39;re owned by Access, not VBA: they have very little in common with userforms, other than &quot;form&quot; as part of the name."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1569387763, "post_id": 58091048, "comment_id": 102575469, "body": "<code>Me</code> refers to the <i>current object</i>, you can&#39;t use it <i>outside the form</i> to refer to that form."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1569530253, "post_id": 58091048, "comment_id": 102637325, "body": "Why do you need to open a second form? Why do you need 2 values from second form? Why is data not just entered on first form? Is second form UNBOUND?"}, {"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1569548309, "post_id": 58091048, "comment_id": 102641160, "body": "My first form opens an Excel file I will use to load data into my database.  Before I load the data I need the user to enter the Company name and the File Date on <code>Form1</code> that will loaded into every record of the database along with data obtained from the Excel spreadsheet."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1569615432, "post_id": 58091048, "comment_id": 102667968, "body": "Still doesn&#39;t explain why the two values can&#39;t be input on first form."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1569430877, "post_id": 58091893, "comment_id": 102597891, "body": "After executing <code>DoCmd.OpenForm &quot;Form1&quot;, acNormal, , , , acDialog</code> I tried to use <code>Forms!Form1!fieldname</code> but received the error message <code>Microsoft Access cannot find the form Form1</code>.  Any hints on the problem?  Thanks so much for your quick response."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1569435920, "post_id": 58091893, "comment_id": 102599998, "body": "Okay, <code>Form1</code> is actual name of form and the form opens? Did you use your field name in place of <code>fieldname</code>? Edit your question to show revised code."}, {"owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1569517152, "post_id": 58091893, "comment_id": 102631661, "body": "I have updated the code as you suggested @june7.  Any suggestions?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "edited": false, "score": 0, "creation_date": 1569529756, "post_id": 58091893, "comment_id": 102637132, "body": "See revised answer."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 1, "last_activity_date": 1569530134, "last_edit_date": 1569530134, "creation_date": 1569390701, "answer_id": 58091893, "question_id": 58091048, "link": "https://stackoverflow.com/questions/58091048/form-in-access-object-not-defined-error/58091893#58091893", "title": "Form in Access &quot;Object not Defined&quot; Error", "body": "<p>Not necessary to use form object variable just to open a form. Simply reference form name - as in successful third attempt. Then if calling form needs to reference form it opened, use Forms collection.</p>\n\n<p><code>Forms!Form1.controlname</code></p>\n\n<p>or</p>\n\n<p><code>Forms!Form1!fieldname</code></p>\n\n<p><code>Me</code> qualifier references object code is behind.</p>\n\n<p>However, <code>acDialog</code> suspends code execution until called form closes. Therefore, when first form code resumes, second form has been closed and cannot be found. Code behind second form should reference first to push values back to first form. Alternative would be to set global variables or TempVars that can then be referred to by any procedure.</p>\n"}], "owner": {"reputation": 77, "user_id": 10274618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4f574fa2d7adbcc35d69dbb9082ac6d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiser Otto", "link": "https://stackoverflow.com/users/10274618/kaiser-otto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1569530134, "creation_date": 1569384738, "last_edit_date": 1569448615, "question_id": 58091048, "link": "https://stackoverflow.com/questions/58091048/form-in-access-object-not-defined-error", "title": "Form in Access &quot;Object not Defined&quot; Error", "body": "<p>I have programmed user forms in Word and Project without problems but I am having problems loading Form1 in MS Access. It gives me this error:</p>\n\n<blockquote>\n  <p>Object variable or With block not set</p>\n</blockquote>\n\n<p>The form does launch when I use <code>DoCmd.OpenForm \"Form1\", acNormal, , , , acDialog</code>.</p>\n\n<p>I now understand that <code>Load Form1</code> does not work in MS Access.  So I must use <code>DoCmd.OpenForm...</code></p>\n\n<p>But I am still having problems accessing the data entered on the form.</p>\n\n<p>My form has two entry fields:  <code>frm_Company and frm_Date</code>,  Below is the code.  </p>\n\n<pre><code>Dim str_Company as String 'variable to capture result for form input\nDim date_Forecast as String 'variable to capture result of form input\n\n\nDoCmd.OpenForm \"Form1\", acNormal, , , , acDialog\n\nstr_Company = Forms!Form1!frm_Company\ndate_Forecast = Forms!Form1!frm_Date\n</code></pre>\n\n<p>When the code is executed Form1 launches, the user enters the data for the two field and presses a \"Close Form\" button.  When VBA tries to execute the last two lines I get the error:</p>\n\n<blockquote>\n  <p>Microsoft cannot find the referenced form Form1</p>\n</blockquote>\n\n<p>Thanks for your assistance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2699, "user_id": 4190941, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pjSzj.jpg?s=128&g=1", "display_name": "NickyTheWrench", "link": "https://stackoverflow.com/users/4190941/nickythewrench"}, "edited": false, "score": 0, "creation_date": 1569382853, "post_id": 58090820, "comment_id": 102574433, "body": "Have you tried using Microsoft Powerapps? Check it out if you haven\u2019t it\u2019s really cool :-)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1569382881, "post_id": 58090820, "comment_id": 102574442, "body": "Unless you&#39;ve displayed the form in <code>vbModeless</code> (the default is <code>vbModal</code>), you will likely not be able to interact with the worksheet i.e., like <code>Select</code> or <code>Activate</code>. Also, <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">your code should usually not need to rely on those methods</a>. Almost never. So you should learn how to avoid those methods, and refactor accordingly. Cheers."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1569383025, "post_id": 58090820, "comment_id": 102574475, "body": "Also, <code>Rows(rowselect, Cells)</code> this looks like possibly invalid syntax. <code>Cells</code> refers to the entire worksheet -- every single cell, all of them, at once. <code>Rows(&lt;integer&gt;, &lt;every cell on the worksheet&gt;)</code> seems like it would fail. You just use <code>Rows(rowselect)</code>. But, note the caveat in my comment above, you probably still cannot <code>Select</code> on that."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1569383182, "post_id": 58090820, "comment_id": 102574513, "body": "Also worth noting: <code>vbModeless</code> allows the user to interact with the environment while the form is displayed. This is disabled by default (<code>vbModal</code>) probably at least in part because allowing the user to modify the environment introduces a much greater risk that the user will alter the environment in a way that causes some runtime error. So, unless you&#39;re prepared to handle that additional complexity, it will be best to avoid using <code>Select</code>."}, {"owner": {"reputation": 1, "user_id": 12111061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nqXvbYP-644/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwiN87fmqZBiG8bMvmSuw1-eqSPg/photo.jpg?sz=128", "display_name": "Hen Molina", "link": "https://stackoverflow.com/users/12111061/hen-molina"}, "edited": false, "score": 0, "creation_date": 1569398846, "post_id": 58090820, "comment_id": 102580108, "body": "Guys Im only using VBA in excel, Can you help me on this one. I also set command button for it to update in one click then error happen on rows.select"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1569400314, "post_id": 58090820, "comment_id": 102580856, "body": "@HenMolina I would suggest you to <code>debug.print &amp; &quot;Cells : &quot;  &amp; Cells &amp; &quot; r : &quot; &amp; r</code>  the error might be there"}, {"owner": {"reputation": 1, "user_id": 12111061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nqXvbYP-644/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwiN87fmqZBiG8bMvmSuw1-eqSPg/photo.jpg?sz=128", "display_name": "Hen Molina", "link": "https://stackoverflow.com/users/12111061/hen-molina"}, "edited": false, "score": 0, "creation_date": 1569400637, "post_id": 58090820, "comment_id": 102581013, "body": "Where should I put that sir Dorian? I just started vba in excel so Im so confused using new lines"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1569401040, "post_id": 58090820, "comment_id": 102581255, "body": "@HenMolina Just before <code>rows(r,cells).select</code> If you don&#39;t have imediate windows you can use <code>msgBox &amp; &quot;Cells : &quot; &amp; Cells &amp; &quot; r : &quot; &amp; r</code> instead, it will populate a windows with the value of cells and r"}, {"owner": {"reputation": 1, "user_id": 12111061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nqXvbYP-644/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwiN87fmqZBiG8bMvmSuw1-eqSPg/photo.jpg?sz=128", "display_name": "Hen Molina", "link": "https://stackoverflow.com/users/12111061/hen-molina"}, "edited": false, "score": 0, "creation_date": 1569402293, "post_id": 58090820, "comment_id": 102581971, "body": "Run time error 7 Out of Memory sir"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1569402816, "post_id": 58090820, "comment_id": 102582307, "body": "@henmolina <code>msgBox  &quot;Cells : &quot; &amp; Cells &amp; &quot; r : &quot; &amp; r</code> idid a typo try this"}], "owner": {"reputation": 1, "user_id": 12111061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nqXvbYP-644/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwiN87fmqZBiG8bMvmSuw1-eqSPg/photo.jpg?sz=128", "display_name": "Hen Molina", "link": "https://stackoverflow.com/users/12111061/hen-molina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569399623, "creation_date": 1569382530, "last_edit_date": 1569399623, "question_id": 58090820, "link": "https://stackoverflow.com/questions/58090820/user-form-updating-adding-deleting-and-resetting", "title": "User form (Updating,Adding, Deleting and Resetting)", "body": "<p>Hi Im having a problem on Updating and Deleting the data on my Worksheet. Using VBA Excel user form I always got a problem on Application defined object defined error.</p>\n\n<p>I tried Rows select method but I cant get the output that I needed. </p>\n\n<pre><code>Private Sub cmdUpdate_Click()\n\nIf Me.cmbAssetTag.Value = \"\" Then\n\nMsgBox \"Asset Tag Can Not be Blank!!!\", vbExclamation, \"Asset Tag\"\n\nExit Sub\n\nEnd If\n\nAssetTag = Me.cmbAssetTag.Value\n\nSheets(\"Assets\").Select\n\nDim r As Single\n\nDim msg As String\n\nDim ans As String\n\nr = Me.cmbAssetTag.Value\n\nRows(r, Cells).Select\n\nCells(r, 2) = Me.txtName.Text\n\nCells(r, 3) = Me.txtManager.Text\n\nCells(r, 4) = Me.txtDepartment.Text\n\nCells(r, 5) = Me.txtAction.Text\n\nCells(r, 6) = Me.txtTemplate.Text\n\nCells(r, 7) = Me.txtModel.Text\n\nCells(r, 8) = Me.txtReason.Text\n\nCells(r, 9) = Me.txtDate.Text\n\nCells(r, 10) = Me.txtUpdatedBy.Text\n\nmsg = \"Asset Tag\" &amp; rowselect &amp; \"  Successfully Updated...Continue?\"\n\nUnload Me\n\nans = MsgBox(msg, vbYesNo, \"Update\")\n\nIf ans = vbYes Then\n\nUserForm1.Show\n\nElse\n\nSheets(\"Assets\").Select\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The actual result should replaced the data on the sheet with the replaced input</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569417612, "post_id": 58090768, "comment_id": 102590598, "body": "It&#39;s not clear how this is a programming question, although it is tagged [vba], but the descriptive text and the reason for the behavior is more &quot;end-user&quot;. Two people have already voted to close it for that reason. If it is programming, then it needs to include some code (attempt) or something that makes that clear to stop the CVs and keep it from being &quot;too broad&quot;."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569418221, "post_id": 58090768, "comment_id": 102590929, "body": "The reason behind what you&#39;re seeing is that these headings are (almost certainly) all formatted with Word&#39;s built-in Heading styles. When you copy/paste (or use <code>Range.FormattedText</code>) to transfer between documents the default behavior is to apply the same style formatting to all text formatted with the same style name. This includes the numbering assigned to the Heading styles in the target document, in your case."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569418253, "post_id": 58090768, "comment_id": 102590948, "body": "Your only way around this would start with applying a different style to the headings coming in from the other document."}, {"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569428772, "post_id": 58090768, "comment_id": 102596920, "body": "As I&#39;ve added in the question, <code>Selection.PasteAndFormat (wdFormatOriginalFormatting)</code> seems to be a solution but it&#39;s only applicable to headings without lists in their bodies. Programatically, how would I go about applying different styles while preserving the same formatting (don&#39;t need the full code, just a lead)?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569506904, "post_id": 58090768, "comment_id": 102626227, "body": "Difficult to explain... See answer."}], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "edited": false, "score": 0, "creation_date": 1569552308, "post_id": 58118770, "comment_id": 102641840, "body": "Thanks for the snippet, I&#39;ll then be applying this to all the headings that are found within a document before copying them."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1569507247, "creation_date": 1569507247, "answer_id": 58118770, "question_id": 58090768, "link": "https://stackoverflow.com/questions/58090768/how-to-paste-headings-into-a-list-without-having-the-lists-initial-headings-nu/58118770#58118770", "title": "How to paste headings into a list without having the list&#39;s initial headings&#39; numbering shifted", "body": "<p>As far as I know, there's no way to copy a style which could then be modified. But it is possible to create a new style that bases on another, then modify the new one to be slightly different (i.e. remove the numbering).</p>\n\n<p>The following code snippet </p>\n\n<ol>\n<li>declares and instantiates two <code>Style</code> objects: one for the Heading 1 style, the other a new style.</li>\n<li>The <code>BaseStyle</code> property for the new style is then set to the Heading 1 style, meaning it picks up all of the base style's properties. </li>\n<li>Then it is unlinked from the numbering by setting its <code>ListTemplate</code> to <code>Nothing</code></li>\n</ol>\n\n<p>When I copy/paste this to a document where Heading 1 is numbered this text is not numbered, but otherwise looks the same. It can also be picked up in a TOC (a TOC can also be modified to <em>not</em> pick it up, if that's the desired behavior).</p>\n\n<pre><code>Sub CopyStyleAndUnlinkNumbering()\n    Dim sH1 As Word.style\n    Dim sH1Copy As Word.style\n\n    Set sH1 = ActiveDocument.styles(WdBuiltinStyle.wdStyleHeading1)\n    Set sH1Copy = ActiveDocument.styles.Add(\"Heading 1 Copy\", Word.WdStyleType.wdStyleTypeParagraph)\n    sH1Copy.BaseStyle = sH1\n    sH1Copy.LinkToListTemplate ListTemplate:=Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 154, "user_id": 10116116, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--s2Di8yOU90/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7osNJiMq-mIQKfBiXKipsocgio4DA/mo/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/10116116/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 58118770, "answer_count": 1, "score": 0, "last_activity_date": 1582095956, "creation_date": 1569382091, "last_edit_date": 1582095956, "question_id": 58090768, "link": "https://stackoverflow.com/questions/58090768/how-to-paste-headings-into-a-list-without-having-the-lists-initial-headings-nu", "title": "How to paste headings into a list without having the list&#39;s initial headings&#39; numbering shifted", "body": "<p>In my testing, copying and pasting text with headings that aren't part of a numbered list into another word file that does have a numbered list causes word to automatically integrate the pasted headings as new \"elements\" of the list. As such, it creates additional numbering (in addition to the numbering it might've had before) for each of those headings and shifts the numbering of the subsequent initial headings.</p>\n\n<p>Copied Text:\n<a href=\"https://i.stack.imgur.com/EyMiL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EyMiL.png\" alt=\"To be Copied Text\"></a>\nBefore Paste:\n<a href=\"https://i.stack.imgur.com/57zso.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/57zso.png\" alt=\"Text before paste\"></a>\nAfter Paste:\n<a href=\"https://i.stack.imgur.com/7YgHy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7YgHy.png\" alt=\"After paste\"></a>\nIs there a way not to have those initial headings shifted while still maintaining this list structure?</p>\n\n<p>I did think of the method:\n<code>ConvertNumbersToText</code></p>\n\n<p>That would prevent word from automatically numbering everything for me that comes near that list. But is there another solution? I would rather not use it because I do not know how to turn back on \"automatic numbering\".</p>\n\n<p><strong>[Edit 1]:</strong>\nAnother solution that worked was pasting and formatting with the recovery type below:\n<code>wdFormatOriginalFormatting</code></p>\n\n<p>However, this fix would fail whenever I would be pasting headings that have lists in it. Instead, when copying headings with lists inside of their bodies, pasting normally (<code>Selection.Paste</code>) doesn't shift the numbering or create any new numbering for the pasted lists.</p>\n"}, {"tags": ["vba", "sap"], "comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569389255, "post_id": 58090671, "comment_id": 102575896, "body": "Have You tried just put your code or part where msg pop up in <code>On Error Resume Next</code> and <code>On Error GoTo 0</code> ?"}, {"owner": {"reputation": 65, "user_id": 11986618, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDvAA2xtB1MCIauafvs-nVEC_0e25NpupivCiGw=k-s128", "display_name": "JiaHao Wang", "link": "https://stackoverflow.com/users/11986618/jiahao-wang"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569393467, "post_id": 58090671, "comment_id": 102577464, "body": "It is more like this Error window does not open up most of the time, but if it does, is there any way to check for the existence of this window using <code>if else</code> by this code <code>session.findById(&quot;wnd[2]&quot;)</code>"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569393866, "post_id": 58090671, "comment_id": 102577658, "body": "I understand, but have You tried  <code>On Error</code> to avoid that if it pops up? I&#39;m just asking from my VBA SAP experience. If You want to know the ID of this window You need to record macro in SAP and counting that this error appears :P"}, {"owner": {"reputation": 65, "user_id": 11986618, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDvAA2xtB1MCIauafvs-nVEC_0e25NpupivCiGw=k-s128", "display_name": "JiaHao Wang", "link": "https://stackoverflow.com/users/11986618/jiahao-wang"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569395654, "post_id": 58090671, "comment_id": 102578509, "body": "i do not know how to use <code>On Error</code>,i tried <code>On Error GoTo errHandler</code> and <code>Resume Next</code> but the code will run the next line instead of restart code and go on to the next row of information to input from excel. If u understand where im coming from."}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569396056, "post_id": 58090671, "comment_id": 102578695, "body": "Just put <code>On Error Resume Next</code> in the begining of your code and <code>On Error GoTo 0</code> in the end. If You wanna go back try   <code>errhandler: On Error Resume Next On Error GoTo errhandler</code>"}, {"owner": {"reputation": 65, "user_id": 11986618, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDvAA2xtB1MCIauafvs-nVEC_0e25NpupivCiGw=k-s128", "display_name": "JiaHao Wang", "link": "https://stackoverflow.com/users/11986618/jiahao-wang"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569396357, "post_id": 58090671, "comment_id": 102578842, "body": "So i can put the <code>On Error</code> codes outside the loop?"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569396395, "post_id": 58090671, "comment_id": 102578858, "body": "I think yes, also it would be easier if You post your code :)"}, {"owner": {"reputation": 65, "user_id": 11986618, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDvAA2xtB1MCIauafvs-nVEC_0e25NpupivCiGw=k-s128", "display_name": "JiaHao Wang", "link": "https://stackoverflow.com/users/11986618/jiahao-wang"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569396454, "post_id": 58090671, "comment_id": 102578876, "body": "Can you answer the question with a code example so i can get a cleaer image of how it can be done? Thanks"}, {"owner": {"reputation": 65, "user_id": 11986618, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDvAA2xtB1MCIauafvs-nVEC_0e25NpupivCiGw=k-s128", "display_name": "JiaHao Wang", "link": "https://stackoverflow.com/users/11986618/jiahao-wang"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569396605, "post_id": 58090671, "comment_id": 102578955, "body": "Okay let me edit my post"}], "answers": [{"comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569404251, "post_id": 58093323, "comment_id": 102583087, "body": "@JiaHao Wang, have You checked anything?"}], "tags": [], "owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "is_accepted": false, "score": 0, "last_activity_date": 1569397395, "last_edit_date": 1569397395, "creation_date": 1569396704, "answer_id": 58093323, "question_id": 58090671, "link": "https://stackoverflow.com/questions/58090671/sap-gui-scripting-pop-up-message/58093323#58093323", "title": "SAP GUI Scripting pop up message", "body": "<p>My main idea was:</p>\n\n<pre><code>Sub SAPcode()\n\nerrhandler:\n    On Error Resume Next\n\n    On Error GoTo errhandler\n\n    'your code\n\n    On Error GoTo 0\n\nEnd Sub\n</code></pre>\n\n<p>With your code probly it should looks like this:</p>\n\n<pre><code>Sub SAPcode()\n\nDim i As Integer\n\nIf Not IsObject(Aplication) Then\n    Set SapGuiAuto = GetObject(\"SAPGUI\")\n    Set Aplication = SapGuiAuto.GetScriptingEngine\nEnd If\nIf Not IsObject(Connection) Then\n    Set Connection = Aplication.Children(0)\nEnd If\nIf Not IsObject(session) Then\n    Set session = Connection.Children(0)\nEnd If\nIf IsObject(WScript) Then\n    WScript.ConnectionObject session, \"on\"\n    WScript.ConnectionObject Aplication, \"on\"\nEnd If\n\ni = 0\nj = 1\nWith session\n    .findById(\"wnd[0]\").maximize\n    .findById(\"wnd[0]/tbar[0]/okcd\").Text = \"MIGO\"\n    .findById(\"wnd[0]\").sendVKey 0\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_HEADER:SAPLMIGO:0101/subSUB_HEADER:SAPLMIGO:0100/tabsTS_GOHEAD/tabpOK_GOHEAD_GENERAL/ssubSUB_TS_GOHEAD_GENERAL:SAPLMIGO:0112/txtGOHEAD-BKTXT\").Text = Cells(1, 8)\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-MAKTX[1,0]\").Text = Cells(7, 2)\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/txtGOITEM-ERFMG[4,0]\").Text = Cells(7, 4)\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-LGOBE[6,0]\").Text = \"BORD\"\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-NAME1[12,0]\").Text = \"2S98\"\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-UMLGOBE[27,0]\").Text = \"DMDV\"\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-UMBAR[32,0]\").Text = \"CATNEW\"\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-UMBAR[32,0]\").SetFocus\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-UMBAR[32,0]\").caretPosition = 6\n    .findById(\"wnd[0]\").sendVKey 0\n\n    While Cells(8 + i, 1).Value &lt;&gt; \"\"\n    errhandler:\n        On Error Resume Next\n        On Error GoTo errhandler  \n\n.findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-MAKTX[1,1]\").Text = Cells(8 + i, 2)\n                        .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/txtGOITEM-ERFMG[4,1]\").Text = Cells(8 + i, 4)\n                        .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-LGOBE[6,1]\").Text = \"BORD\"\n                        .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-NAME1[12,1]\").Text = \"2S98\"\n                        .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-UMLGOBE[27,1]\").Text = \"DMDV\"\n                        .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-UMBAR[32,1]\").Text = \"CATNEW\"\n\n                        .findById(\"wnd[0]\").sendVKey 0\n                        .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM\").verticalScrollbar.Position = j\n\n                    .findById(\"wnd[0]\").sendVKey 0\n\n                    i = i + 1\n                    j = j + 1\n                    On Error GoTo 0\n                Wend\n            End With\n\n\n\n        End Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 11986618, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDvAA2xtB1MCIauafvs-nVEC_0e25NpupivCiGw=k-s128", "display_name": "JiaHao Wang", "link": "https://stackoverflow.com/users/11986618/jiahao-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569397395, "creation_date": 1569381317, "last_edit_date": 1569396701, "question_id": 58090671, "link": "https://stackoverflow.com/questions/58090671/sap-gui-scripting-pop-up-message", "title": "SAP GUI Scripting pop up message", "body": "<p>I am seeing this error pop up message which i do not know about it's <code>findbyId</code>, may i know how can i get its <code>findById</code>? Also im using VBA to do scripting for SAP, how can i <code>catch</code> the <code>findById</code> and do some actions if i found it? I know that there are <code>sbar</code> error messages but it is not the one that im having problem with. Below is a picture of the pop up error message.<a href=\"https://i.stack.imgur.com/Lfatt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lfatt.png\" alt=\"enter image description here\"></a></p>\n\n<p>Edit:</p>\n\n<pre><code>Sub Migo()\n\nDim i As Integer\n\nIf Not IsObject(Aplication) Then\n    Set SapGuiAuto = GetObject(\"SAPGUI\")\n    Set Aplication = SapGuiAuto.GetScriptingEngine\nEnd If\nIf Not IsObject(Connection) Then\n    Set Connection = Aplication.Children(0)\nEnd If\nIf Not IsObject(session) Then\n    Set session = Connection.Children(0)\nEnd If\nIf IsObject(WScript) Then\n    WScript.ConnectionObject session, \"on\"\n    WScript.ConnectionObject Aplication, \"on\"\nEnd If\n\ni = 0\nj = 1\nWith session\n    .findById(\"wnd[0]\").maximize\n    .findById(\"wnd[0]/tbar[0]/okcd\").Text = \"MIGO\"\n    .findById(\"wnd[0]\").sendVKey 0\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_HEADER:SAPLMIGO:0101/subSUB_HEADER:SAPLMIGO:0100/tabsTS_GOHEAD/tabpOK_GOHEAD_GENERAL/ssubSUB_TS_GOHEAD_GENERAL:SAPLMIGO:0112/txtGOHEAD-BKTXT\").Text = Cells(1, 8)\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-MAKTX[1,0]\").Text = Cells(7, 2)\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/txtGOITEM-ERFMG[4,0]\").Text = Cells(7, 4)\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-LGOBE[6,0]\").Text = \"BORD\"\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-NAME1[12,0]\").Text = \"2S98\"\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-UMLGOBE[27,0]\").Text = \"DMDV\"\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-UMBAR[32,0]\").Text = \"CATNEW\"\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-UMBAR[32,0]\").SetFocus\n    .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-UMBAR[32,0]\").caretPosition = 6\n    .findById(\"wnd[0]\").sendVKey 0\n    While Cells(8 + i, 1).Value &lt;&gt; \"\"\n        .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-MAKTX[1,1]\").Text = Cells(8 + i, 2)\n        .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/txtGOITEM-ERFMG[4,1]\").Text = Cells(8 + i, 4)\n        .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-LGOBE[6,1]\").Text = \"BORD\"\n        .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-NAME1[12,1]\").Text = \"2S98\"\n        .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-UMLGOBE[27,1]\").Text = \"DMDV\"\n        .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM/ctxtGOITEM-UMBAR[32,1]\").Text = \"CATNEW\"\n        .findById(\"wnd[0]\").sendVKey 0\n        .findById(\"wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0006/subSUB_ITEMLIST:SAPLMIGO:0200/tblSAPLMIGOTV_GOITEM\").verticalScrollbar.Position = j\n        .findById(\"wnd[0]\").sendVKey 0\n        i = i + 1\n        j = j + 1\n    Wend\nEnd With\nEnd Sub\n</code></pre>\n\n<p>So the error happens inside the <code>while</code> loop sometimes</p>\n"}, {"tags": ["arrays", "json", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569387565, "post_id": 58090617, "comment_id": 102575416, "body": "Distances is an array (and so converts to a collection) containing two arrays (each in turn converted to collections stored in the first collection).  So <code>distances(1)(1)</code> = 0, <code>distances(1)(2)</code> = 97641"}], "answers": [{"tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": false, "score": 0, "last_activity_date": 1569400008, "last_edit_date": 1569400008, "creation_date": 1569398104, "answer_id": 58093743, "question_id": 58090617, "link": "https://stackoverflow.com/questions/58090617/how-to-parse-and-address-a-json-matrix-array-in-excel-vba/58093743#58093743", "title": "How to parse and address a json matrix array in Excel-VBA?", "body": "<p>There's no reason to declare <code>jsonObj</code> as a dictionary and unless <code>Number</code> is a well defined <code>user-defined</code> type of some sort, I don't think declaring travelDist as <code>Number</code> will work. Use <code>Double</code> instead. And always use <code>Option Explicit</code> on the very top.</p>\n\n<p>Also the double quotes in the <code>JSON</code> string need to be escaped somehow. You can either double them:</p>\n\n<pre><code>jsonResults = \"{\"\"distances\"\":[[0,97641],[97415,0]],\"\"times\"\":[[0,4189],[4183,0]],\"\"weights\"\":[[0.0,5653.726],[5644.176,0.0]],\"\"info\"\":{\"\"copyrights\"\":[\"\"GraphHopper\"\",\"\"OpenStreetMap contributors\"\"]}}\"\n</code></pre>\n\n<p>or replace them with single quotes:</p>\n\n<pre><code>jsonResults = \"{'distances':[[0,97641],[97415,0]],'times':[[0,4189],[4183,0]],'weights':[[0.0,5653.726],[5644.176,0.0]],'info':{'copyrights':['GraphHopper','OpenStreetMap contributors']}}\"\n</code></pre>\n\n<p>or you can just store the string in a cell in one of your worksheets and load it from there:</p>\n\n<pre><code>Dim sht As Worksheet\nSet sht = ThisWorkbook.Worksheets(\"Name of your Worksheet\")\nSet jsonObj = JsonConverter.ParseJson(sht.Range(\"A1\"))\n</code></pre>\n\n<p>Visualizing the <code>JSON</code> structure might help you understand it better:</p>\n\n<p><a href=\"https://i.stack.imgur.com/l15Aw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l15Aw.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>So basically what you need to do is access the <code>2nd item</code>, of the <code>1st item</code>, of the <code>distances</code> array/collection, keeping in mind that the <code>1st item</code> of the <code>distances</code> array is also an array/collection itself.</p>\n\n<p>The way to do this would be the following:</p>\n\n<pre><code>Option Explicit\n\nSub test()\nDim jsonObj As Object\nDim jsonResults As String\nDim travelDist As Double\n\njsonResults = \"{\"\"distances\"\":[[0,97641],[97415,0]],\"\"times\"\":[[0,4189],[4183,0]],\"\"weights\"\":[[0.0,5653.726],[5644.176,0.0]],\"\"info\"\":{\"\"copyrights\"\":[\"\"GraphHopper\"\",\"\"OpenStreetMap contributors\"\"]}}\"\nSet jsonObj = JsonConverter.ParseJson(jsonResults)\n\ntravelDist = jsonObj(\"distances\")(1)(2)\nDebug.Print travelDist 'the result is printed in the immediate window\nEnd Sub\n</code></pre>\n\n<p>Finally, I assume that since you've used this before, you know you need to add <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">this JSON parser</a> to your project, as well as a reference to <code>Microsoft Scripting Runtime</code> (VBE>Tools>References>...)</p>\n"}], "owner": {"reputation": 1, "user_id": 12116351, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAnWTO4B7vFNWRg7vNo34IDuWaLW5sTsX_UXJ_j=k-s128", "display_name": "Mark Dvorchak", "link": "https://stackoverflow.com/users/12116351/mark-dvorchak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569400008, "creation_date": 1569380922, "last_edit_date": 1569396119, "question_id": 58090617, "link": "https://stackoverflow.com/questions/58090617/how-to-parse-and-address-a-json-matrix-array-in-excel-vba", "title": "How to parse and address a json matrix array in Excel-VBA?", "body": "<p>I need to parse JSON text to a JSON object in Excel-VBA. The JSON text includes a matrix/array.  Then I need to address it (set a VBA variable to the value).</p>\n\n<p>My code had been working parsing a nested/keyed JSON text with \"JsonConverter.parseJSON\" method.  But I do not know how to address new array object (or technically if the \"parse\" is working correctly.</p>\n\n<pre><code>Dim jsonResults As String\nDim jsonObj As Dictionary\nSet travelDist As Number\n\nSet jsonResults = '{\"distances\":[[0,97641],[97415,0]],\"times\":[[0,4189],[4183,0]],\"weights\":[[0.0,5653.726],[5644.176,0.0]],\"info\":{\"copyrights\":[\"GraphHopper\",\"OpenStreetMap contributors\"]}}'\n\nSet jsonObj = JsonConverter.ParseJson(jsonResults) \\This worked with the old JSON text keyed value structure.\n\ntravelDist = VBA.Val(jsonObj.Item(\"distances\")(1)) \\This DOESN'T work. It worked with Keyed Object Values.  The goal is to set travelDist to in this example, 97641.\n</code></pre>\n\n<p>The current code seems to have a type mismatch.</p>\n\n<p>The goal is to set a VBA variable to 97641. Please let me know how to include required files/definitions etc. if the solution is including additional types or methods.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569379421, "post_id": 58090280, "comment_id": 102573831, "body": "It looks like <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.queries\" rel=\"nofollow noreferrer\"><code>Queries</code></a> was added to the object model in 2016."}, {"owner": {"reputation": 1, "user_id": 12111476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5qf_jFcgycY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0sjn1jZg5UEClpaK8iJP2gj7s_g/photo.jpg?sz=128", "display_name": "SPL", "link": "https://stackoverflow.com/users/12111476/spl"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569381071, "post_id": 58090280, "comment_id": 102574116, "body": "So power query add-in does not support Queries object model? I&#39;m really new to the SQL side of things for Excel and am finding this so frustrating."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1569381474, "post_id": 58090280, "comment_id": 102574184, "body": "The add-in is separate from the actual Excel object model. There may be an alternative but I&#39;m not sure (can&#39;t test as I have a later version of Excel)."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1569382483, "post_id": 58090280, "comment_id": 102574353, "body": "You may be able to access your Queries through the <code>Workbook.Connections</code> collection.  <a href=\"https://www.excelguru.ca/blog/2014/10/22/refresh-power-query-with-vba/\" rel=\"nofollow noreferrer\">This might give you some clues</a>"}], "owner": {"reputation": 1, "user_id": 12111476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5qf_jFcgycY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc0sjn1jZg5UEClpaK8iJP2gj7s_g/photo.jpg?sz=128", "display_name": "SPL", "link": "https://stackoverflow.com/users/12111476/spl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569377676, "creation_date": 1569377676, "question_id": 58090280, "link": "https://stackoverflow.com/questions/58090280/excel-2013-with-power-query-add-in-vba-does-not-seem-to-support-query-syntax", "title": "Excel 2013 with Power Query Add-in, VBA does not seem to support query syntax", "body": "<p>Sorry my second post on the same subject. I have some code written in VBA using Excel 2016 that I need to migrate to support at least Excel 2013. </p>\n\n<p>I posted to ask if anyone has ideas on how to migrate the code - whilst waiting for a response on that, I tried to install Power Query add-in, which was done successfully, but the VBA code is still throwing a 438 run-time error.</p>\n\n<p>The Power Query add-in appears enabled by default - I check in File -> Options -> COM Add-ins, and power query is checked. </p>\n\n<p>The code I'm running is this: </p>\n\n<pre><code>For i = 1 To ActiveWorkbook.Queries.Count\n    If ActiveWorkbook.Queries.Item(i).Name = itemToMatch Then\n        ActiveWorkbook.Queries.Item(i).Delete\n    End If\nNext\n\nActiveWorkbook.Queries.Add Name:=itemToMatch, Formula:=Formula\n\nEnd Sub\n</code></pre>\n\n<p>It throws an error at ActiveWorkbook.Queries.Count, which should be a valid format? </p>\n\n<p>Thank you in advance again. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1732, "user_id": 11982798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99629abfd4d6ce4b3702d84cf1a1eef0?s=128&d=identicon&r=PG&f=1", "display_name": "user11982798", "link": "https://stackoverflow.com/users/11982798/user11982798"}, "edited": false, "score": 0, "creation_date": 1569392319, "post_id": 58090104, "comment_id": 102576988, "body": "I think this (Set y = .Range(.Range(&quot;A2&quot;), .Range(&quot;A2&quot;).End(xlDown))) will give you range from A2 to first blank in column A."}], "answers": [{"comments": [{"owner": {"reputation": 1732, "user_id": 11982798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99629abfd4d6ce4b3702d84cf1a1eef0?s=128&d=identicon&r=PG&f=1", "display_name": "user11982798", "link": "https://stackoverflow.com/users/11982798/user11982798"}, "edited": false, "score": 0, "creation_date": 1569543909, "post_id": 58090334, "comment_id": 102640424, "body": "I appreciate you with your contribution, but I think Set y = Range(&quot;A2&quot;).End(xlDown) will stop before the last blank cell in column A. Here we are same, to learn more for the better."}, {"owner": {"reputation": 1732, "user_id": 11982798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99629abfd4d6ce4b3702d84cf1a1eef0?s=128&d=identicon&r=PG&f=1", "display_name": "user11982798", "link": "https://stackoverflow.com/users/11982798/user11982798"}, "edited": false, "score": 0, "creation_date": 1569545027, "post_id": 58090334, "comment_id": 102640608, "body": "this to find the last row: ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Row"}], "tags": [], "owner": {"reputation": 37, "user_id": 5187198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rf3gQ.png?s=128&g=1", "display_name": "Jalex", "link": "https://stackoverflow.com/users/5187198/jalex"}, "is_accepted": false, "score": -1, "last_activity_date": 1569378149, "creation_date": 1569378149, "answer_id": 58090334, "question_id": 58090104, "link": "https://stackoverflow.com/questions/58090104/copy-and-paste-vba-skip-blanks-no-header/58090334#58090334", "title": "Copy and Paste VBA - Skip Blanks, No header", "body": "<p>I think the problem might be with your range creation.  Try:</p>\n\n<pre><code>Dim wsSource As Worksheet\nDim weTarget As Worksheet\nDim y As Range\n\nSet wsSource = Workbooks(\"Book1.csv\").Worksheets(\"Book1\")\nSet weTarget = Workbooks(\"Book2.csv\").Worksheets(\"Book2\")\n\nWith wsSource\n  Set y = Range(\"A2\").End(xlDown)\n    y.SpecialCells(xlCellTypeConstants).Copy\nEnd With\n\nweTarget.Range(\"C2\").PasteSpecial xlPasteValues\n\nApplication.CutCopyMode = False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1732, "user_id": 11982798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99629abfd4d6ce4b3702d84cf1a1eef0?s=128&d=identicon&r=PG&f=1", "display_name": "user11982798", "link": "https://stackoverflow.com/users/11982798/user11982798"}, "edited": false, "score": 0, "creation_date": 1569395259, "post_id": 58090732, "comment_id": 102578309, "body": "if many blank cell, this will stop in first blank cell, I think, may be you must loop several times"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 1732, "user_id": 11982798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99629abfd4d6ce4b3702d84cf1a1eef0?s=128&d=identicon&r=PG&f=1", "display_name": "user11982798", "link": "https://stackoverflow.com/users/11982798/user11982798"}, "edited": false, "score": 0, "creation_date": 1569395609, "post_id": 58090732, "comment_id": 102578482, "body": "@user11982798 if you test it you will find it copies all non-blanl calles to a contiguous range"}, {"owner": {"reputation": 1732, "user_id": 11982798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99629abfd4d6ce4b3702d84cf1a1eef0?s=128&d=identicon&r=PG&f=1", "display_name": "user11982798", "link": "https://stackoverflow.com/users/11982798/user11982798"}, "edited": false, "score": 0, "creation_date": 1569395784, "post_id": 58090732, "comment_id": 102578560, "body": "So you take it from bottom? OK I understand"}, {"owner": {"reputation": 13, "user_id": 11928411, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gb3GIiKbk0E/AAAAAAAAAAI/AAAAAAAAAAc/Y-kP4osX5m0/photo.jpg?sz=128", "display_name": "Crystal", "link": "https://stackoverflow.com/users/11928411/crystal"}, "edited": false, "score": 0, "creation_date": 1569425750, "post_id": 58090732, "comment_id": 102595524, "body": "Is there any way I can keep the blank when transferring? @chrisneilsen"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 13, "user_id": 11928411, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gb3GIiKbk0E/AAAAAAAAAAI/AAAAAAAAAAc/Y-kP4osX5m0/photo.jpg?sz=128", "display_name": "Crystal", "link": "https://stackoverflow.com/users/11928411/crystal"}, "edited": false, "score": 0, "creation_date": 1569439356, "post_id": 58090732, "comment_id": 102601419, "body": "@crystal if you don&#39;t want to skip the blanks don&#39;t use <code>SpecialCells</code> , ie just <code>y.Copy</code>"}, {"owner": {"reputation": 13, "user_id": 11928411, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gb3GIiKbk0E/AAAAAAAAAAI/AAAAAAAAAAc/Y-kP4osX5m0/photo.jpg?sz=128", "display_name": "Crystal", "link": "https://stackoverflow.com/users/11928411/crystal"}, "edited": false, "score": 0, "creation_date": 1569459874, "post_id": 58090732, "comment_id": 102606848, "body": "@chrisneilsen why does it always start at A2 even when I change the range to C2"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 13, "user_id": 11928411, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gb3GIiKbk0E/AAAAAAAAAAI/AAAAAAAAAAc/Y-kP4osX5m0/photo.jpg?sz=128", "display_name": "Crystal", "link": "https://stackoverflow.com/users/11928411/crystal"}, "edited": false, "score": 0, "creation_date": 1569461740, "post_id": 58090732, "comment_id": 102607149, "body": "@Crystal <i>What</i> did you change to <code>C2</code>?  Maybe you want <code>Set y = .Range(.Range(&quot;C2&quot;), .Cells(.Rows.Count, 3).End(xlUp))</code>  (note the <code>3</code>)"}, {"owner": {"reputation": 13, "user_id": 11928411, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gb3GIiKbk0E/AAAAAAAAAAI/AAAAAAAAAAc/Y-kP4osX5m0/photo.jpg?sz=128", "display_name": "Crystal", "link": "https://stackoverflow.com/users/11928411/crystal"}, "edited": false, "score": 0, "creation_date": 1569463714, "post_id": 58090732, "comment_id": 102607512, "body": "@chrisneilsen I see thank you so much for the help!"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 13, "user_id": 11928411, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gb3GIiKbk0E/AAAAAAAAAAI/AAAAAAAAAAc/Y-kP4osX5m0/photo.jpg?sz=128", "display_name": "Crystal", "link": "https://stackoverflow.com/users/11928411/crystal"}, "edited": false, "score": 0, "creation_date": 1569464856, "post_id": 58090732, "comment_id": 102607711, "body": "@Crystal happy to help.  Since you are new here, please <a href=\"https://stackoverflow.com/help/someone-answers\">read this</a>"}, {"owner": {"reputation": 1732, "user_id": 11982798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99629abfd4d6ce4b3702d84cf1a1eef0?s=128&d=identicon&r=PG&f=1", "display_name": "user11982798", "link": "https://stackoverflow.com/users/11982798/user11982798"}, "edited": false, "score": 0, "creation_date": 1569545686, "post_id": 58090732, "comment_id": 102640735, "body": "crystal, this to get the last row and column without must refer to A2: .Application.ActiveCell.SpecialCells(xlLastCell) as cell or .Cells..ActiveCell.SpecialCells(xlLastCell), also as cell, with this cell you can get your last row and last column."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1569381838, "creation_date": 1569381838, "answer_id": 58090732, "question_id": 58090104, "link": "https://stackoverflow.com/questions/58090104/copy-and-paste-vba-skip-blanks-no-header/58090732#58090732", "title": "Copy and Paste VBA - Skip Blanks, No header", "body": "<p>Your issue is that</p>\n\n<pre><code>Set y = .Range(.Range(\"A2\"), .Range(\"A2\").End(xlDown))\n</code></pre>\n\n<p>sets <code>y</code> to the range from <code>A2</code> down to the cell above <em>first</em> blank cell <sup>Note 1</sup></p>\n\n<p>hange that to use <code>End(XlUp)</code> from the bottom of the sheet</p>\n\n<pre><code>Set y = .Range(.Range(\"A2\"), .Cells(.Rows.Count, 1).End(xlUp)) ' .Range(\"A2\").End(xlDown))\n</code></pre>\n\n<p><Sub>Note 1.  stritcly speaking, what is copied will depend on if cell <code>A3</code> is blank.</Sub></p>\n"}], "owner": {"reputation": 13, "user_id": 11928411, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Gb3GIiKbk0E/AAAAAAAAAAI/AAAAAAAAAAc/Y-kP4osX5m0/photo.jpg?sz=128", "display_name": "Crystal", "link": "https://stackoverflow.com/users/11928411/crystal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 58090732, "answer_count": 2, "score": 1, "last_activity_date": 1569437440, "creation_date": 1569375963, "last_edit_date": 1569437440, "question_id": 58090104, "link": "https://stackoverflow.com/questions/58090104/copy-and-paste-vba-skip-blanks-no-header", "title": "Copy and Paste VBA - Skip Blanks, No header", "body": "<p>I want to move data from one workbook to another for mapping. I don't need the header and want to skip blanks.</p>\n\n<p>I can get it to skip blanks but then it copies the columns beside it. \nI can also get it to copy and paste only the column but it doesn't skip the blanks. So I just need a way for it to do column A only, no header, and keep it blank on the new sheet.</p>\n\n<p>I've tried Skip blanks in the Paste special and it doesn't work.</p>\n\n<pre><code>Sub NewCopyandPaste()\n\n    Dim wsSource As Worksheet\n    Dim weTarget As Worksheet\n    Dim y As Range\n\n    Set wsSource = Workbooks(\"Book1.csv\").Worksheets(\"Book1\")\n    Set weTarget = Workbooks(\"Book2.csv\").Worksheets(\"Book2\")\n\n    With wsSource\n        Set y = .Range(.Range(\"A2\"), .Range(\"A2\").End(xlDown))\n        y.SpecialCells(xlCellTypeConstants).Copy\n    End With\n\n    weTarget.Range(\"C2\").PasteSpecial xlPasteValues\n\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4790558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abd844f5e0d2d946175e015e3b3a554?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4790558/jason"}, "edited": false, "score": 0, "creation_date": 1570009271, "post_id": 58089365, "comment_id": 102776040, "body": "I have a part that doesn&#39;t exist on the pivot table and it will get stuck and print false for all file names thereafter. Once one part number didn&#39;t exist, it printed false on every single item for it&#39;s filename after that. Any suggestions on how to fix that? Basically, the part number exists on the primary sheet but not on the pivotal table on the other sheet because it has no file associated. My logical test references the primary table part number and pivotal table part number."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 5, "user_id": 4790558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abd844f5e0d2d946175e015e3b3a554?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4790558/jason"}, "edited": false, "score": 0, "creation_date": 1570046489, "post_id": 58089365, "comment_id": 102795108, "body": "I don&#39;t understand. The pivot table (in the middle of my screenshot) is based on the data table (on the left in my screenshot). Any part number in the data table will show in the pivot table. What is YOUR pivot table based on? Maybe you need to point it to the real data."}, {"owner": {"reputation": 5, "user_id": 4790558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abd844f5e0d2d946175e015e3b3a554?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4790558/jason"}, "edited": false, "score": 0, "creation_date": 1570050935, "post_id": 58089365, "comment_id": 102796652, "body": "Sorry let me clarify a little better. I have three separate sheets. I&#39;m now trying to use a simple if statement on my primary sheet that reference back to the textjoin table. Essentially this if statement is checking the if the part numbers match then carry over the file names. I have a case where the part number exists on the primary sheet but does not exist in the textjoin table once one case is found like this everything after that will come out to be false. =IF([@punctuatedPartNumber]=Table7[@PunctuatedPartNumber],Ta&zwnj;&#8203;ble7[@[Combined Files]])"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 5, "user_id": 4790558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abd844f5e0d2d946175e015e3b3a554?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4790558/jason"}, "edited": false, "score": 0, "creation_date": 1570051239, "post_id": 58089365, "comment_id": 102796743, "body": "Why do you use an IF statement to return the combined files? That ties you to the exact row and the other table may not have the data in that exact row. You could use a Vlookup instead and wrap an IfError around it."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1569368863, "last_edit_date": 1569368863, "creation_date": 1569368494, "answer_id": 58089365, "question_id": 58089235, "link": "https://stackoverflow.com/questions/58089235/combining-and-merging-similar-part-numbers-with-filename/58089365#58089365", "title": "Combining and Merging Similar Part Numbers with filename", "body": "<p>Does it have to be in one cell with commas in between? With a few clicks you can create a pivot table with part number and file name in the rows area. This will group the data by the part number.</p>\n\n<p>You can use a formula if you have a list of unique part numbers. The formula in H2 uses TextJoin like this:</p>\n\n<pre><code>=TEXTJOIN(\", \",TRUE,IF(Table1[part]=G2,Table1[file],\"\"))\n</code></pre>\n\n<p>Copy down.</p>\n\n<p>This is an array formula and unless you have an Excel version with the new Dynamic Array formulas, you need to confirm it with Ctrl+Shift+Enter.</p>\n\n<p><a href=\"https://i.stack.imgur.com/TOyCG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TOyCG.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5, "user_id": 4790558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abd844f5e0d2d946175e015e3b3a554?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4790558/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 58089365, "answer_count": 1, "score": 0, "last_activity_date": 1569401097, "creation_date": 1569367159, "last_edit_date": 1569401097, "question_id": 58089235, "link": "https://stackoverflow.com/questions/58089235/combining-and-merging-similar-part-numbers-with-filename", "title": "Combining and Merging Similar Part Numbers with filename", "body": "<p>I'm trying to combine all the same part numbers on excel, in order to have one part number, but reference the filenames. However, when there is more than one file, I need to separate them by a comma. </p>\n\n<p>Most of the vlookup and merging I have tried only pulls one item. And when I merge the part numbers I lose some filenames.Attached is the file showing the punctuated part number and file name. Some punctuated part numbers show up more than once while others only show up once. For every duplicate part number the filename is different as it contains a different view of the product.</p>\n\n<p><img src=\"https://i.stack.imgur.com/L5CxR.jpg\" alt=\"screenshot\"></p>\n"}, {"tags": ["vba", "ms-word", "userform", "xmlnode"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1569364382, "post_id": 58088710, "comment_id": 102571095, "body": "Ah no, missed that this is in Word.  Does your debug.print cName correct print out all the expected contacts?"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1569365357, "post_id": 58088710, "comment_id": 102571321, "body": "Also, I would add in a debug.print indicating the actual top/left positions of your controls to ensure its actually iterating through the x/y correctly.  Since all of your controls are of the same size, they will sit on top of one another and not appear to be visible."}, {"owner": {"reputation": 11, "user_id": 8594013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8aa45cbc4b0a7e251becfa00c800eb9?s=128&d=identicon&r=PG&f=1", "display_name": "hlock", "link": "https://stackoverflow.com/users/8594013/hlock"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1569365635, "post_id": 58088710, "comment_id": 102571398, "body": "I do have a debug.print for the contact name to make sure that the code is running through all of the names.  However, the only name printing is the only one that shows on the form."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1569420574, "post_id": 58088710, "comment_id": 102592425, "body": "The code has <code>Set coll = nameCollection</code> but it doesn&#39;t use <code>coll</code>, it uses <code>nameCollection</code>: <code>For Each cName In nameCollection</code> - the name of the function, which isn&#39;t going to work. Try using <code>For Each cName In coll</code>    `"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8594013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8aa45cbc4b0a7e251becfa00c800eb9?s=128&d=identicon&r=PG&f=1", "display_name": "hlock", "link": "https://stackoverflow.com/users/8594013/hlock"}, "is_accepted": false, "score": 0, "last_activity_date": 1569511500, "creation_date": 1569511500, "answer_id": 58120081, "question_id": 58088710, "link": "https://stackoverflow.com/questions/58088710/alphabetize-control-on-word-userform/58120081#58120081", "title": "Alphabetize control on word userform", "body": "<p>Finally figured it out.  Just had to put the statements in the correct order.  Thank you Mike and Cindy for your help.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nOn Error GoTo Err_UserForm_Initialize\n\nSet objNode = ActiveDocument.CustomXMLParts.SelectByNamespace(\"http://schemas.rlicorp.net/ContentManagement.Claims\").Item(1).DocumentElement\n\nIf objNode.SelectSingleNode(\"/ns0:Claim[1]/ns0:Contacts[1]\") Is Nothing Then\n    Exit Sub\nEnd If\n\nDim ctlTo As Control\nDim ctlCc As Control\nDim ctlName As Control\nDim ctlAddress1 As Control\nDim ctlAddress2 As Control\nDim ctlCity As Control\nDim ctlState As Control\nDim ctlZIP As Control\nDim ctlRole As Control\nDim cName As Variant\nDim tempname As String\nDim coll As Collection\n\nSet objNode = ActiveDocument.CustomXMLParts.SelectByNamespace(\"http://schemas.rlicorp.net/ContentManagement.Claims\").Item(1).DocumentElement\nnAddresses = 0\n\nSet coll = nameCollection\n\nFor Each cName In coll\n\n\nFor i = 1 To Int(objNode.SelectSingleNode(\"/ns0:Claim[1]/ns0:Contacts[1]\").ChildNodes.Count)\n    Set objNode1 = objNode.SelectSingleNode(\"/ns0:Claim[1]/ns0:Contacts[1]\").ChildNodes(i)\n\n\n                If Not (objNode1.SelectSingleNode(\"ns0:Name[1]\") Is Nothing) Then\n                tempname = objNode1.SelectSingleNode(\"ns0:Name[1]\").Text\n                End If\n\n                If cName = tempname Then\n                Debug.Print cName\n\n        If (Not (objNode1.SelectSingleNode(\"ns0:Address1[1]\") Is Nothing)) Or _\n    (Not (objNode1.SelectSingleNode(\"ns0:Name[1]\") Is Nothing)) Then\n    nAddresses = nAddresses + 1\n\n                Set ctlTo = fraSelectContact.Controls.Add(\"Forms.Checkbox.1\", \"chkTo\" &amp; nAddresses)\n                ctlTo.Left = lblTo.Left\n                ctlTo.Top = lblTo.Top + 20 + (nAddresses - 1) * 30\n\n                Set ctlCc = fraSelectContact.Controls.Add(\"Forms.Checkbox.1\", \"chkCc\" &amp; nAddresses)\n                ctlCc.Left = lblCc.Left\n                ctlCc.Top = lblCc.Top + 20 + (nAddresses - 1) * 30\n\n                Set ctlName = fraSelectContact.Controls.Add(\"Forms.TextBox.1\", \"txtName\" &amp; nAddresses)\n                ctlName.Left = lblName.Left\n                ctlName.Top = lblName.Top + 20 + (nAddresses - 1) * 30\n                ctlName.Width = 130\n\n                ctlName.Text = cName\n\n                Set ctlAddress1 = fraSelectContact.Controls.Add(\"Forms.TextBox.1\", \"txtAddress1_\" &amp; nAddresses)\n                ctlAddress1.Left = lblAddress1.Left\n                ctlAddress1.Top = lblAddress1.Top + 20 + (nAddresses - 1) * 30\n                Debug.Print ctlAddress1.Top\n                ctlAddress1.Width = 170\n                If Not (objNode1.SelectSingleNode(\"ns0:Employer[1]\") Is Nothing) Then\n                    ctlAddress1.Text = objNode1.SelectSingleNode(\"ns0:Employer[1]\").Text &amp; \";\"\n                End If\n                If Not (objNode1.SelectSingleNode(\"ns0:Address1[1]\") Is Nothing) Then\n                    ctlAddress1.Text = ctlAddress1.Text &amp; objNode1.SelectSingleNode(\"ns0:Address1[1]\").Text\n                End If\n\n                Set ctlAddress2 = fraSelectContact.Controls.Add(\"Forms.TextBox.1\", \"txtAddress2_\" &amp; nAddresses)\n                ctlAddress2.Left = lblAddress2.Left\n                ctlAddress2.Top = lblAddress2.Top + 20 + (nAddresses - 1) * 30\n                ctlAddress2.Width = 160\n                If Not (objNode1.SelectSingleNode(\"ns0:Address2[1]\") Is Nothing) Then\n                    ctlAddress2.Text = objNode1.SelectSingleNode(\"ns0:Address2[1]\").Text\n                End If\n\n                Set ctlCity = fraSelectContact.Controls.Add(\"Forms.TextBox.1\", \"txtCity\" &amp; nAddresses)\n                ctlCity.Left = lblCity.Left\n                ctlCity.Top = lblCity.Top + 20 + (nAddresses - 1) * 30\n                ctlCity.Width = 60\n                If Not (objNode1.SelectSingleNode(\"ns0:City[1]\") Is Nothing) Then\n                    ctlCity.Text = objNode1.SelectSingleNode(\"ns0:City[1]\").Text\n                End If\n\n                Set ctlState = fraSelectContact.Controls.Add(\"Forms.TextBox.1\", \"txtState\" &amp; nAddresses)\n                ctlState.Left = lblState.Left\n                ctlState.Top = lblState.Top + 20 + (nAddresses - 1) * 30\n                ctlState.Width = 30\n                If Not (objNode1.SelectSingleNode(\"ns0:State[1]\") Is Nothing) Then\n                    ctlState.Text = objNode1.SelectSingleNode(\"ns0:State[1]\").Text\n                End If\n\n                Set ctlZIP = fraSelectContact.Controls.Add(\"Forms.TextBox.1\", \"txtZIP\" &amp; nAddresses)\n                ctlZIP.Left = lblZIP.Left\n                ctlZIP.Top = lblZIP.Top + 20 + (nAddresses - 1) * 30\n                ctlZIP.Width = 50\n                If Not (objNode1.SelectSingleNode(\"ns0:Zip[1]\") Is Nothing) Then\n                    ctlZIP.Text = objNode1.SelectSingleNode(\"ns0:Zip[1]\").Text\n                End If\n\n            End If\n            End If\n            Next i\n    Next cName\n\nExit_UserForm_Initialize:\nExit Sub\n\nErr_UserForm_Initialize:\nMsgBox Err.Number &amp; \" _ \" &amp; Err.Description &amp; vbCrLf &amp; \"Contact claimcenterhelp@rlicorp.com\"\nResume Exit_UserForm_Initialize\n\nEnd Sub\n\nFunction nameCollection() As Collection\n\nDim coll As Collection\nSet coll = New Collection\n\nSet objNode = ActiveDocument.CustomXMLParts.SelectByNamespace(\"http://schemas.rlicorp.net/ContentManagement.Claims\").Item(1).DocumentElement\n\nFor i = 1 To Int(objNode.SelectSingleNode(\"/ns0:Claim[1]/ns0:Contacts[1]\").ChildNodes.Count)\n    Set objNode1 = objNode.SelectSingleNode(\"/ns0:Claim[1]/ns0:Contacts[1]\").ChildNodes(i)\n\n    If Not (objNode1.SelectSingleNode(\"ns0:Name[1]\") Is Nothing) Then\n        coll.Add Item:=objNode1.SelectSingleNode(\"ns0:Name[1]\").Text\n    End If\n\nNext i\n\n'For x = 1 To coll.Count\n'Debug.Print coll(x)\n'Next x\n\nQuickSort coll, 1, coll.Count\n\nSet nameCollection = coll\n\nEnd Function\n\nSub QuickSort(coll As Collection, first As Long, last As Long)\n\n  Dim vCentreVal As Variant, vTemp As Variant\n\n  Dim lTempLow As Long\n  Dim lTempHi As Long\n  lTempLow = first\n  lTempHi = last\n\n  vCentreVal = coll((first + last) \\ 2)\n  Do While lTempLow &lt;= lTempHi\n\n    Do While coll(lTempLow) &lt; vCentreVal And lTempLow &lt; last\n      lTempLow = lTempLow + 1\n    Loop\n\n    Do While vCentreVal &lt; coll(lTempHi) And lTempHi &gt; first\n      lTempHi = lTempHi - 1\n    Loop\n\n    If lTempLow &lt;= lTempHi Then\n\n      ' Swap values\n      vTemp = coll(lTempLow)\n\n      coll.Add coll(lTempHi), After:=lTempLow\n      coll.Remove lTempLow\n\n      coll.Add vTemp, Before:=lTempHi\n      coll.Remove lTempHi + 1\n\n      ' Move to next positions\n      lTempLow = lTempLow + 1\n      lTempHi = lTempHi - 1\n\n    End If\n\n  Loop\n\n  If first &lt; lTempHi Then QuickSort coll, first, lTempHi\n  If lTempLow &lt; last Then QuickSort coll, lTempLow, last\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8594013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8aa45cbc4b0a7e251becfa00c800eb9?s=128&d=identicon&r=PG&f=1", "display_name": "hlock", "link": "https://stackoverflow.com/users/8594013/hlock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569511500, "creation_date": 1569362780, "last_edit_date": 1569420193, "question_id": 58088710, "link": "https://stackoverflow.com/questions/58088710/alphabetize-control-on-word-userform", "title": "Alphabetize control on word userform", "body": "<p>I posted this previously.  However, since then, I've been able to figure out an alphabetized collection.  I deleted the post since it was a mess.  </p>\n\n<p>I want to alphabetize the userform controls as they are placed on the form.  I've got the collection alphabetized, however, I am struggling on the order of the code.  The way that it is right now, only the first row is added.</p>\n\n<p>This is how it should look:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vMzbd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vMzbd.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nOn Error GoTo Err_UserForm_Initialize\n\nSet objNode = ActiveDocument.CustomXMLParts.SelectByNamespace(\"http://schemas.rlicorp.net/ContentManagement.Claims\").Item(1).DocumentElement\n\nIf objNode.SelectSingleNode(\"/ns0:Claim[1]/ns0:Contacts[1]\") Is Nothing Then\n    Exit Sub\nEnd If\n\nDim ctlTo As Control\nDim ctlCc As Control\nDim ctlName As Control\nDim ctlTempName As Control\nDim ctlAddress1 As Control\nDim ctlAddress2 As Control\nDim ctlCity As Control\nDim ctlState As Control\nDim ctlZIP As Control\nDim ctlRole As Control\nDim cName As Variant\nDim tempname As String\nDim coll As Collection\nDim i As Long\nDim nAddresses As Integer\n\nSet objNode = ActiveDocument.CustomXMLParts.SelectByNamespace(\"http://schemas.rlicorp.net/ContentManagement.Claims\").Item(1).DocumentElement\n\nnAddresses = 0\n\nSet coll = nameCollection\n\nFor i = 1 To Int(objNode.SelectSingleNode(\"/ns0:Claim[1]/ns0:Contacts[1]\").ChildNodes.Count)\n    Set objNode1 = objNode.SelectSingleNode(\"/ns0:Claim[1]/ns0:Contacts[1]\").ChildNodes(i)\n\n    If (Not (objNode1.SelectSingleNode(\"ns0:Address1[1]\") Is Nothing)) Or _\n    (Not (objNode1.SelectSingleNode(\"ns0:Name[1]\") Is Nothing)) Then\n        nAddresses = nAddresses + 1\n\n        For Each cName In nameCollection\n\n            If Not (objNode1.SelectSingleNode(\"ns0:Name[1]\") Is Nothing) Then\n                tempname = objNode1.SelectSingleNode(\"ns0:Name[1]\").Text\n            End If\n\n            If cName &lt;&gt; tempname Then Exit For\n            Debug.Print cName\n\n            Set ctlTo = fraSelectContact.Controls.Add(\"Forms.Checkbox.1\", \"chkTo\" &amp; nAddresses)\n            ctlTo.Left = lblTo.Left\n            ctlTo.Top = lblTo.Top + 20 + (nAddresses - 1) * 30\n\n            Set ctlCc = fraSelectContact.Controls.Add(\"Forms.Checkbox.1\", \"chkCc\" &amp; nAddresses)\n            ctlCc.Left = lblCc.Left\n            ctlCc.Top = lblCc.Top + 20 + (nAddresses - 1) * 30\n\n            Set ctlName = fraSelectContact.Controls.Add(\"Forms.TextBox.1\", \"txtName\" &amp; nAddresses)\n            ctlName.Left = lblName.Left\n            ctlName.Top = lblName.Top + 20 + (nAddresses - 1) * 30\n            ctlName.Width = 130\n            ctlName.Text = cName\n\n            Set ctlAddress1 = fraSelectContact.Controls.Add(\"Forms.TextBox.1\", \"txtAddress1_\" &amp; nAddresses)\n            ctlAddress1.Left = lblAddress1.Left\n            ctlAddress1.Top = lblAddress1.Top + 20 + (nAddresses - 1) * 30\n            ctlAddress1.Width = 170\n            If Not (objNode1.SelectSingleNode(\"ns0:Employer[1]\") Is Nothing) Then\n                ctlAddress1.Text = objNode1.SelectSingleNode(\"ns0:Employer[1]\").Text &amp; \";\"\n            End If\n            If Not (objNode1.SelectSingleNode(\"ns0:Address1[1]\") Is Nothing) Then\n                ctlAddress1.Text = ctlAddress1.Text &amp; objNode1.SelectSingleNode(\"ns0:Address1[1]\").Text\n            End If\n\n            Set ctlAddress2 = fraSelectContact.Controls.Add(\"Forms.TextBox.1\", \"txtAddress2_\" &amp; nAddresses)\n            ctlAddress2.Left = lblAddress2.Left\n            ctlAddress2.Top = lblAddress2.Top + 20 + (nAddresses - 1) * 30\n            ctlAddress2.Width = 160\n            If Not (objNode1.SelectSingleNode(\"ns0:Address2[1]\") Is Nothing) Then\n                ctlAddress2.Text = objNode1.SelectSingleNode(\"ns0:Address2[1]\").Text\n            End If\n\n            Set ctlCity = fraSelectContact.Controls.Add(\"Forms.TextBox.1\", \"txtCity\" &amp; nAddresses)\n            ctlCity.Left = lblCity.Left\n            ctlCity.Top = lblCity.Top + 20 + (nAddresses - 1) * 30\n            ctlCity.Width = 60\n            If Not (objNode1.SelectSingleNode(\"ns0:City[1]\") Is Nothing) Then\n                ctlCity.Text = objNode1.SelectSingleNode(\"ns0:City[1]\").Text\n            End If\n\n            Set ctlState = fraSelectContact.Controls.Add(\"Forms.TextBox.1\", \"txtState\" &amp; nAddresses)\n            ctlState.Left = lblState.Left\n            ctlState.Top = lblState.Top + 20 + (nAddresses - 1) * 30\n            ctlState.Width = 30\n            If Not (objNode1.SelectSingleNode(\"ns0:State[1]\") Is Nothing) Then\n                ctlState.Text = objNode1.SelectSingleNode(\"ns0:State[1]\").Text\n            End If\n\n            Set ctlZIP = fraSelectContact.Controls.Add(\"Forms.TextBox.1\", \"txtZIP\" &amp; nAddresses)\n            ctlZIP.Left = lblZIP.Left\n            ctlZIP.Top = lblZIP.Top + 20 + (nAddresses - 1) * 30\n            ctlZIP.Width = 50\n            If Not (objNode1.SelectSingleNode(\"ns0:Zip[1]\") Is Nothing) Then\n                ctlZIP.Text = objNode1.SelectSingleNode(\"ns0:Zip[1]\").Text\n            End If\n\n        Next cName\n    End If\nNext i\n\nExit_UserForm_Initialize:\nExit Sub\n\nErr_UserForm_Initialize:\nMsgBox Err.Number &amp; \" _ \" &amp; Err.Description &amp; vbCrLf &amp; \"Contact claimcenterhelp@rlicorp.com\"\nResume Exit_UserForm_Initialize\n\nEnd Sub\n\nunction nameCollection() As Collection\n\nDim coll As Collection\nSet coll = New Collection\n\nSet objNode = ActiveDocument.CustomXMLParts.SelectByNamespace(\"http://schemas.rlicorp.net/ContentManagement.Claims\").Item(1).DocumentElement\n\nFor i = 1 To Int(objNode.SelectSingleNode(\"/ns0:Claim[1]/ns0:Contacts[1]\").ChildNodes.Count)\n    Set objNode1 = objNode.SelectSingleNode(\"/ns0:Claim[1]/ns0:Contacts[1]\").ChildNodes(i)\n\n    If Not (objNode1.SelectSingleNode(\"ns0:Name[1]\") Is Nothing) Then\n        coll.Add Item:=objNode1.SelectSingleNode(\"ns0:Name[1]\").Text\n    End If\n\nNext i\n\nQuickSort coll, 1, coll.Count\n\nSet nameCollection = coll\n\nEnd Function\nSub QuickSort(coll As Collection, first As Long, last As Long)\n\nDim vCentreVal As Variant, vTemp As Variant\nDim lTempLow As Long\nDim lTempHi As Long\n\nlTempLow = first\nlTempHi = last\n\nvCentreVal = coll((first + last) \\ 2)\n\nDo While lTempLow &lt;= lTempHi\n\nDo While coll(lTempLow) &lt; vCentreVal And lTempLow &lt; last\n    lTempLow = lTempLow + 1\nLoop\n\nDo While vCentreVal &lt; coll(lTempHi) And lTempHi &gt; first\n    lTempHi = lTempHi - 1\nLoop\n\nIf lTempLow &lt;= lTempHi Then\n    vTemp = coll(lTempLow)\n\n    coll.Add coll(lTempHi), After:=lTempLow\n    coll.Remove lTempLow\n\n    coll.Add vTemp, Before:=lTempHi\n    coll.Remove lTempHi + 1\n\n    lTempLow = lTempLow + 1\n    lTempHi = lTempHi - 1\n\nEnd If\n\nLoop\n\nIf first &lt; lTempHi Then QuickSort coll, first, lTempHi\nIf lTempLow &lt; last Then QuickSort coll, lTempLow, last\n\nEnd Sub\n</code></pre>\n\n<p>I don't get any errors when I run this, but this is what the form ends up looking liked:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qrM13.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qrM13.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the shortened version of the XML</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt; \n- &lt;Claim xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n  &lt;ID&gt;00989876&lt;/ID&gt; \n  &lt;Description&gt;General Liability&lt;/Description&gt; \n  &lt;ContractID&gt;A78656789&lt;/ContractID&gt; \n+ &lt;Contract&gt;\n- &lt;Contacts&gt;\n- &lt;ClaimContact&gt;\n  &lt;Name&gt;John Doe&lt;/Name&gt; \n  &lt;Address1&gt;PO Box 712&lt;/Address1&gt; \n  &lt;City&gt;Jacksonville&lt;/City&gt; \n  &lt;State&gt;FL&lt;/State&gt; \n  &lt;Zip&gt;98631&lt;/Zip&gt; \n  &lt;/ClaimContact&gt;\n- &lt;ClaimContact&gt;\n  &lt;Name&gt;Alton Carpeting&lt;/Name&gt; \n  &lt;Address1&gt;4567 Watchworks Ave&lt;/Address1&gt; \n &lt;City&gt;Detroit&lt;/City&gt; \n  &lt;State&gt;MI&lt;/State&gt; \n  &lt;Zip&gt;98631&lt;/Zip&gt; \n  &lt;/ClaimContact&gt;\n+ &lt;ClaimContact&gt;\n+ &lt;ClaimContact&gt;\n  &lt;/Contacts&gt;\n  &lt;ClaimUser /&gt; \n  &lt;/Claim&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "edited": false, "score": 0, "creation_date": 1569379696, "post_id": 58088695, "comment_id": 102573887, "body": "I think you mean <code>Highlight A6:G19</code> or <code>Highlight relevant range of cells</code> then apply the three rules."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "edited": false, "score": 0, "creation_date": 1569388738, "post_id": 58088695, "comment_id": 102575736, "body": "No, I meant what I wrote. With a relative reference in the formula it is more important where the active cell is when the format is defined.  The missing bit is rather &quot;The format can then be applied to other ranges.&quot; - In any case, I edited my answer."}, {"owner": {"reputation": 11, "user_id": 6683215, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XU-nXt_thDw/AAAAAAAAAAI/AAAAAAAAFSs/76iGvX73DbE/photo.jpg?sz=128", "display_name": "John H", "link": "https://stackoverflow.com/users/6683215/john-h"}, "edited": false, "score": 0, "creation_date": 1569450401, "post_id": 58088695, "comment_id": 102605147, "body": "You&#39;re amazing, teylyn! Thank you! I resorted to filtering each code our to its column and then apply color code based on the date on that column for the code. This solution is so much better! Thanks a million!"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1569388925, "last_edit_date": 1569388925, "creation_date": 1569362671, "answer_id": 58088695, "question_id": 58088592, "link": "https://stackoverflow.com/questions/58088592/use-conditional-formatting-to-highlight-dates-based-on-two-columns-data/58088695#58088695", "title": "Use Conditional Formatting to Highlight dates based on Two Columns data", "body": "<p>Try Vlookup in the conditional formatting formula. Compare the result of the VLookup with the letter. With cell A6 selected, use this formula</p>\n\n<ul>\n<li>brown rule <code>=Vlookup(A6,$K$6:$L$19,2,0)=\"A\"</code></li>\n<li>blue rule <code>=Vlookup(A6,$K$6:$L$19,2,0)=\"B\"</code></li>\n<li>green rule <code>=Vlookup(A6,$K$6:$L$19,2,0)=\"C\"</code></li>\n</ul>\n\n<p>Edit after comment: You can highlight all cells that you want to format, but make sure that A6 is the active cell. Or you can select just cell A6, create the formats, and then apply the format to the other cells, using either the \"Applies to\" field in the Conditional Formatting Rules Manager, or by copying A6 and using Paste Special > Formats to copy only the format to other cells.</p>\n\n<p>I prefer the second method. It's faster. </p>\n"}], "owner": {"reputation": 11, "user_id": 6683215, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XU-nXt_thDw/AAAAAAAAAAI/AAAAAAAAFSs/76iGvX73DbE/photo.jpg?sz=128", "display_name": "John H", "link": "https://stackoverflow.com/users/6683215/john-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 58088695, "answer_count": 1, "score": 0, "last_activity_date": 1569400873, "creation_date": 1569361928, "last_edit_date": 1569400873, "question_id": 58088592, "link": "https://stackoverflow.com/questions/58088592/use-conditional-formatting-to-highlight-dates-based-on-two-columns-data", "title": "Use Conditional Formatting to Highlight dates based on Two Columns data", "body": "<p>I'm trying to do something like the image below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/PQQm8.jpg\" alt=\"Example of highlighting dates based on date and code\">\nI have a list of dates and code and for each date on the list, I would like to highlight the calendar/date that matches the list of date and the highlight color is based on the code associated with the date. </p>\n\n<p>Using this formula, </p>\n\n<p><code>=MATCH(A6,$K$6:$K$19,0)</code></p>\n\n<p>in the Conditional Rule Manager will work on just getting the dates colored on the Calendar. </p>\n\n<p>I have tried playing around with the AND statement like so:</p>\n\n<p><code>=AND(MATCH(A6,$K$6:$K$19,0),$L$6=\"A\")</code> </p>\n\n<p>in the formula. This would work if all I'm looking at is the static column L6 but that's not what I'm trying to do. I don't know how to check the date and the associated code. How do I go about matching up <code>K6</code> to <code>L6, K7</code> to <code>L7</code>, and so on?</p>\n"}, {"tags": ["vba", "rules", "disable"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 13456564, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/0888f797b3737ecd7181dbd88a72b95c?s=128&d=identicon&r=PG", "display_name": "user13456564", "link": "https://stackoverflow.com/users/13456564/user13456564"}, "is_accepted": false, "score": 0, "last_activity_date": 1588449377, "creation_date": 1588449377, "answer_id": 61565462, "question_id": 58088482, "link": "https://stackoverflow.com/questions/58088482/outlook-365-macro-to-disable-all-rules/61565462#61565462", "title": "Outlook 365 Macro to Disable All Rules", "body": "<p>I had this problem. I think it was caused by certain rules that were no longer supported by Outlook and were highlighted in red in the Rules menu of Outlook. I deleted them and the runtime error  went away.</p>\n"}], "owner": {"reputation": 1, "user_id": 12001193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1bb9a59ff13bf763eaad3a3127b0cff?s=128&d=identicon&r=PG&f=1", "display_name": "JDennistound", "link": "https://stackoverflow.com/users/12001193/jdennistound"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1588449377, "creation_date": 1569361198, "last_edit_date": 1569367338, "question_id": 58088482, "link": "https://stackoverflow.com/questions/58088482/outlook-365-macro-to-disable-all-rules", "title": "Outlook 365 Macro to Disable All Rules", "body": "<p>I'm getting an error in Outlook macro (Visual Basic) for the following line:\nSet colRules = Application.Session.DefaultStore.GetRules</p>\n\n<p>in the code snippet below that disables all of my outlook rules through this macro. \"Runtime Error: The error I'm getting is \"one or more rules is in conflict. You must resolve the conflict before rules can be saved.\"</p>\n\n<pre><code>Sub DisableAllRules()\nDim colRules As Outlook.Rules\nDim oRule As Outlook.Rule\nDim count As Integer\nDim ruleList As String\n'On Error Resume Next\n\n'Get Rules from Session.DefaultStore object\nSet colRules = Application.Session.DefaultStore.GetRules\n\n' iterate all the rules\nFor Each oRule In colRules\noRule.Enabled = False\ncount = count + 1\nruleList = ruleList &amp; vbCrLf &amp; count &amp; \". \" &amp; oRule.Name\nNext\n\ncolRules.Save\n\n'tell the user what you did\nruleList = \"These rules were enabled: \" &amp; vbCrLf &amp; ruleList\nMsgBox ruleList, vbInformation, \"Macro: DisableAllRules\"\n\nSet colRules = Nothing\nSet oRule = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "automation"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1569361263, "post_id": 58088472, "comment_id": 102570279, "body": "I will ask you the same question I asked you <a href=\"https://superuser.com/questions/1485897/how-to-convert-indent-level-to-subtotal-formula-with-a-macro\">here</a>: Could you please clarify the desired outcome and how you would get to it?"}, {"owner": {"reputation": 3127, "user_id": 2066079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jm7vU.png?s=128&g=1", "display_name": "dberm22", "link": "https://stackoverflow.com/users/2066079/dberm22"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1569361417, "post_id": 58088472, "comment_id": 102570323, "body": "@cybernetic.nomad And I edited the other post to do so. It seems pretty clear to me. Not sure how much clearer I can make it."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 1, "creation_date": 1569362033, "post_id": 58088472, "comment_id": 102570495, "body": "So basically if nextRow indent value &gt;  currentRow value sum all price values until a row indent value &lt;= currentRow value? Otherwise if currentRow indentvalue = nextRow indentvalue calculated value should be that rows price. Also providing a copyable example data set would be helpful for testing purposes."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1569367010, "post_id": 58088472, "comment_id": 102571712, "body": "(1) Is column 1 as you show it (N periods then N)?  (2) It does not really matter but I do not understand the advantage of <code>SUBTOTAL(9, Range)</code> over <code>SUM(Range)</code>."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1569369935, "post_id": 58088472, "comment_id": 102572220, "body": "(1) For row 8, I would expect the range to be C9:C18.  (2) For row 20, the formula gives the value in column 3.  This is not true for rows 2, 8, 9 and 19.  Am I missing something?"}, {"owner": {"reputation": 3127, "user_id": 2066079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jm7vU.png?s=128&g=1", "display_name": "dberm22", "link": "https://stackoverflow.com/users/2066079/dberm22"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1569415764, "post_id": 58088472, "comment_id": 102589437, "body": "@Mike That&#39;s the idea of it, I&#39;m just not sure how to execute it"}, {"owner": {"reputation": 3127, "user_id": 2066079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jm7vU.png?s=128&g=1", "display_name": "dberm22", "link": "https://stackoverflow.com/users/2066079/dberm22"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1569416021, "post_id": 58088472, "comment_id": 102589591, "body": "@TonyDallimore Subtotal allows me to get higher level roll-ups. Sum would include both the piece parts and roll-ups in the summation. For Row 8, you are correct, I made a typo. For Row 20, there is only 1 piece part in the assembly, so yes - the roll-up would be the same as the row below it."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1569428025, "post_id": 58088472, "comment_id": 102596615, "body": "I cannot get Subtotal to work as you expect and the documentation says.  In all my experiments, it gives the same results as Sum; that is, it double counts sub-totals.  In your image, the formulae are text strings.  Please convert them to Excel formulae and see if they give the expected answer on your system.  I am using Office 365."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1569429031, "post_id": 58088472, "comment_id": 102597048, "body": "Example 1: In D20, I have <code>=SUBTOTAL(9,C21:C21)</code>  which has a value of 1,512.00 as expected. In D19, I have <code>=SUBTOTAL(9,C20:C22)</code> which has a value of 3,068.88 which is 1,512.00 more than expected."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1569429054, "post_id": 58088472, "comment_id": 102597060, "body": "Example 2: In D2, I have <code>=SUBTOTAL(9,C3:C22)</code> which has a value of 66,956.52.  <code>=SUM(C3:C7)+SUM(C10:C18)+SUM(C21:C21)</code> has a value of 47,172.28 which matches C2."}, {"owner": {"reputation": 3127, "user_id": 2066079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jm7vU.png?s=128&g=1", "display_name": "dberm22", "link": "https://stackoverflow.com/users/2066079/dberm22"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1569429269, "post_id": 58088472, "comment_id": 102597147, "body": "@TonyDallimore I actually generated column C with the formula in column D. You are seeing the result of the formula. It works as expected."}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1569528956, "creation_date": 1569528956, "answer_id": 58124152, "question_id": 58088472, "link": "https://stackoverflow.com/questions/58088472/how-to-convert-indent-level-to-subtotal-formula-with-a-macro/58124152#58124152", "title": "How to convert &quot;indent level&quot; to SUBTOTAL formula with a macro?", "body": "<p>I have produced the formulae you want (I think) but those formulae do not evaluate to the values you want.  Perhaps you can see an error I am overlooking.  Perhaps function <code>SUBTOTAL</code> is affected by a switch I do not know about.  But, first an introduction to what I have created.</p>\n\n<p>I needed some test data so created a worksheet containing the important columns from your example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GoBif.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GoBif.png\" alt=\"Test data from your example\"></a></p>\n\n<p>Column B and the column headings are not relevant.  I have carefully checked and as far as I can see columns A and C match your example.</p>\n\n<p>You say you have over 100 sheets but do not say if they are all in one workbook or spread over several workbooks.  I have assumed several workbooks.  You probably only have one assembly per worksheet but, just in case, I have duplicated my copy of your assembly so I have several per worksheet.  I duplicated the worksheet so I have two per workbook.  I then created two copies of the workbook.  The result is I have three data workbooks each with two worksheets to be processed.  I have created other worksheets in a different format so I can check that worksheets not to be processed are ignored.</p>\n\n<p>I did not want to copy the macros to every data workbook so I have another workbook which is macro-enabled to hold my macros.  I have all four workbooks in a single folder.  I assume this is not an issue for you.  If you cannot move all your workbooks to a single folder, you will have to describe your folder structure so I can decide how to handle it.</p>\n\n<p>To match my system, you will need to create a macro-enabled workbook.  That workbook must have a worksheet named \u201cWshts\u201d.</p>\n\n<p>I generally spread my macro over several modules.  I describe my modules but you can place all the code in a single module if you prefer.</p>\n\n<p>Module \u201cModGlobal\u201d contains column and row constants plus two routines from my library which I used in the macros I wrote for you:</p>\n\n<pre><code>Option Explicit\n\n' Columns and first data row of worksheet \"Wshts\" of this workbook\nPublic Const ColWshtWbk As Long = 1\nPublic Const ColWshtWSht As Long = 2\nPublic Const RowWshtDataFirst As Long = 2\n\n' Columns and first data row of a assembly worksheet\nPublic Const ColPartIndent As Long = 1\nPublic Const ColPartAmt As Long = 3\nPublic Const ColPartFormula As Long = 4\nPublic Const RowPartDataFirst As Long = 2\nPublic Function ColNumToCode(ByVal ColNum As Long) As String\n\n  ' Convert an Excel column number to the equivalent code. For example 1 to \"A\".\n\n  Dim ColCode As String\n  Dim PartNum As Long\n\n  ' 3Feb12  Adapted to handle three character codes.\n  ' ??????  Renamed from ColCode to create a more helpful name\n\n  If ColNum = 0 Then\n    ColNumToCode = \"0\"\n  Else\n    ColCode = \"\"\n    Do While ColNum &gt; 0\n      PartNum = (ColNum - 1) Mod 26\n      ColCode = Chr(65 + PartNum) &amp; ColCode\n      ColNum = (ColNum - PartNum - 1) \\ 26\n    Loop\n  End If\n\n  ColNumToCode = ColCode\n\nEnd Function\nPublic Function PadL(ByVal Str As String, ByVal PadLen As Long, _\n                     Optional ByVal PadChr As String = \" \") As String\n\n  ' Pad Str with leading PadChr to give a total length of PadLen\n  ' If the length of Str exceeds PadLen, Str will not be truncated\n\n  '   Sep15 Coded\n  ' 20Dec15 Added code so overlength strings are not truncated\n  ' 10Jun16 Added PadChr so could pad with characters other than space\n\n  If Len(Str) &gt;= PadLen Then\n    ' Do not truncate over length strings\n    PadL = Str\n  Else\n    PadL = Right$(String(PadLen, PadChr) &amp; Str, PadLen)\n  End If\n\nEnd Function\n</code></pre>\n\n<p>The worksheet \u201cWshts\u201d must contain a list of the worksheets to be processed.  Module \u201cModListWshts\u201d contains this code:</p>\n\n<pre><code>Option Explicit\nSub ListWshts()\n\n  ' Build list of workbooks and worksheets to be processed by macro GenFormulae\n\n  Dim FileName As String\n  Dim InxWsht As Long\n  Dim PathName As String\n  Dim RowWsht As Long\n  Dim WBk As Workbook\n  Dim WshtWsht As Worksheet\n\n  Application.ScreenUpdating = False\n\n  Set WshtWsht = ThisWorkbook.Worksheets(\"Wshts\")\n  With WshtWsht\n    .Cells.EntireRow.Delete\n    .Cells(1, ColWshtWbk).Value = \"Workbook\"\n    .Cells(1, ColWshtWSht).Value = \"Worksheet\"\n    .Rows(1).Font.Bold = True\n  End With\n  RowWsht = 2\n\n  PathName = ThisWorkbook.Path &amp; \"\\\"\n\n  FileName = Dir$(PathName &amp; \"*.xls*\", vbNormal)\n  Do While FileName &lt;&gt; \"\"\n    If FileName &lt;&gt; ThisWorkbook.Name Then\n      'Debug.Print FileName\n      Set WBk = Workbooks.Open(PathName &amp; FileName, False, True)\n      With WBk\n        For InxWsht = 1 To .Worksheets.Count\n          'Debug.Print \"  \" &amp; .Worksheets(InxWsht).Name\n          WshtWsht.Cells(RowWsht, ColWshtWbk).Value = FileName\n          WshtWsht.Cells(RowWsht, ColWshtWSht).Value = .Worksheets(InxWsht).Name\n          RowWsht = RowWsht + 1\n        Next\n        .Close\n      End With\n    End If\n    FileName = Dir$\n  Loop\n\n  WshtWsht.Columns.AutoFit\n\n  Application.ScreenUpdating = False\n\nEnd Sub\n</code></pre>\n\n<p>This macro locates all the workbooks in the folder and creates a list of workbooks and their worksheets.  I deleted the rows for the worksheets I did not want processed to create:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iCVzh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iCVzh.png\" alt=\"List of worksheets to be processed\"></a></p>\n\n<p>If you run macro <code>ListWshts</code>, you will have over 100 rows in your version on this workbook.  I decided that six was enough for a test.  Delete any rows for worksheets that are not to be processed.  There are more sophisticated methods of creating a list like this but I do not know enough about your workbooks to identify a more suitable method.</p>\n\n<p>Finally, module \u201cGenGenFormulae\u201d contains:</p>\n\n<pre><code>Option Explicit\nSub GenFormulae()\n\n  ' Workbooks and worksheets to be processed are listed in worksheet Wshts.\n  ' Generate a formula for each row of each worksheet to be processed.\n\n  Dim FileNameCrnt As String\n  Dim FileNameLast As String\n  Dim InxWsht As Long\n  Dim LevelCrnt As Long\n  Dim LevelLast As Long\n  Dim OpenLevelStart(0 To 999)      ' Allow for more levels than could possibly exist\n                                    ' to avoid worrying about array overflow\n  Dim PathName As String\n  Dim RowPartCrnt As Long\n  Dim RowPartLast As Long\n  Dim RowWshtCrnt As Long\n  Dim RowWshtLast As Long\n  Dim WBk As Workbook\n  Dim WshtPart As Worksheet\n  Dim WshtWsht As Worksheet\n\n  Application.ScreenUpdating = False\n\n  Set WshtWsht = ThisWorkbook.Worksheets(\"Wshts\")\n  RowWshtLast = WshtWsht.Cells(Rows.Count, ColWshtWbk).End(xlUp).Row\n\n  PathName = ThisWorkbook.Path &amp; \"\\\"\n  FileNameLast = \"\"\n\n  For RowWshtCrnt = RowWshtDataFirst To RowWshtLast\n    Application.StatusBar = \"Worksheet \" &amp; RowWshtCrnt - 1 &amp; \" of \" &amp; RowWshtLast - 1\n    FileNameCrnt = WshtWsht.Cells(RowWshtCrnt, ColWshtWbk).Value\n\n    If FileNameCrnt &lt;&gt; FileNameLast Then\n      ' New workbook\n      If FileNameLast &lt;&gt; \"\" Then\n        ' Have an open workbook\n        WBk.Close SaveChanges:=True\n        Set WBk = Nothing\n      End If\n      FileNameLast = FileNameCrnt\n      Debug.Print \"Workbook \" &amp; FileNameCrnt\n      Set WBk = Workbooks.Open(PathName &amp; FileNameCrnt)\n    End If\n\n    ' Reference worksheet within open workbook\n    With WBk\n      Set WshtPart = .Worksheets(WshtWsht.Cells(RowWshtCrnt, ColWshtWSht).Value)\n    End With\n\n    ' Process worksheet\n    With WshtPart\n      RowPartLast = .Cells(Rows.Count, ColPartIndent).End(xlUp).Row\n      Debug.Print \"  Worksheet \" &amp; .Name &amp; \" (\" &amp; RowWshtCrnt - 1 &amp; _\n                  \" of \" &amp; RowWshtLast - 1 &amp; \" in total) which has \" &amp; _\n                  RowPartLast - 1 &amp; \" rows.\"\n\n      ' Process Row RowPartDataFirst which has no previous row.\n      RowPartCrnt = RowPartDataFirst\n      LevelLast = CLng(Replace(.Cells(RowPartCrnt, ColPartIndent).Value, \".\", \"\"))\n      Debug.Assert LevelLast = 0   ' First data row must be level 0\n\n      ' Unless overridden by the next row, the formula for the\n      ' current row is a copy of the amount from the current row\n      .Cells(RowPartCrnt, ColPartFormula).Value = _\n                                        \"=\" &amp; ColNumToCode(ColPartAmt) &amp; RowPartCrnt\n      'Debug.Print \"    Row \" &amp; CStr(RowPartCrnt) &amp; \", Level \" &amp; LevelCrnt\n\n      For RowPartCrnt = RowPartDataFirst + 1 To RowPartLast\n\n        ' For each row create the default formula, decide if the previous\n        ' row requires a non-default formula and if any earlier sub-total\n        ' formulae were terminated by this row\n\n        If RowPartCrnt Mod 100 = 0 Then\n          ' Display progress every 100 rows\n          Application.StatusBar = \"Worksheet \" &amp; RowWshtCrnt - 1 &amp; \" of \" &amp; RowWshtLast - 1 &amp; _\n                                  \".  Row \" &amp; RowPartCrnt - 1 &amp; \" of \" &amp; RowPartLast - 1\n        End If\n\n        LevelCrnt = CLng(Replace(.Cells(RowPartCrnt, ColPartIndent).Value, \".\", \"\"))\n\n        ' Unless overridden by the next row, the formula for the\n        ' current row is a copy of the amount from the current row\n        .Cells(RowPartCrnt, ColPartFormula).Value = _\n                                        \"=\" &amp; ColNumToCode(ColPartAmt) &amp; RowPartCrnt\n        'Debug.Print \"    Row \" &amp; RowPartCrnt &amp; \", Level \" &amp; LevelCrnt;\n        If LevelCrnt = LevelLast Then\n          ' This row at same level as last.\n          ' No earlier row affected by this row\n          'Debug.Assert False\n          'Debug.Print    ' Finish diagnostic line containing row and level\n        ElseIf LevelCrnt = LevelLast + 1 Then\n          ' This row is immediate child of last row.\n          ' Formula for previous row is at level LevelLast\n          ' with the range starting on current row\n          ' Store range start until range end found\n          'Debug.Assert False\n          OpenLevelStart(LevelLast) = RowPartCrnt\n          'Debug.Print \"   Start of level \" &amp; LevelLast &amp; \" subtotal\"\n        ElseIf LevelLast &gt; LevelCrnt Then\n          ' This row is at a lower level than last row.\n          ' Levels LevelLast-1 to LevelCrnt ended on last row.\n          'Debug.Assert False\n          'Debug.Print\n          Do While LevelLast &gt; LevelCrnt\n            LevelLast = LevelLast - 1\n            'Debug.Print Space(6) &amp; \"Level \" &amp; LevelLast &amp; \" subtotal on row \" &amp; _\n                        OpenLevelStart(LevelLast) - 1 &amp; \" with range \" &amp; _\n                        OpenLevelStart(LevelLast) &amp; \" to \" &amp; RowPartCrnt - 1\n            .Cells(OpenLevelStart(LevelLast) - 1, ColPartFormula).Value = _\n                             \"=SUBTOTAL(9,\" &amp; ColNumToCode(ColPartAmt) &amp; _\n                             OpenLevelStart(LevelLast) &amp; \":\" &amp; _\n                             ColNumToCode(ColPartAmt) &amp; RowPartCrnt - 1 &amp; \")\"\n          Loop\n        Else\n          ' No code for this combination of current and last level\n          Debug.Assert False\n        End If\n        LevelLast = LevelCrnt\n      Next RowPartCrnt\n    End With\n    Set WshtPart = Nothing  ' This worksheet finished\n  Next RowWshtCrnt\n\n  WBk.Close SaveChanges:=True\n  Set WBk = Nothing\n\n  Application.ScreenUpdating = False\n\nEnd Sub\n</code></pre>\n\n<p>Run macro <code>GenFormulae</code>.  It opens workbooks as necessary and processes every worksheet listed in worksheet \u201cWshts\u201d.  It writes formulae to column D.  It does not change columns A to C so you can rerun the macro if you wish.  The macro does some limited data checking but, in general, it just stops if it does not like what it finds.  The macro uses the status bar and the Immediate Window to indicate progress.  With my six, small worksheets it only takes a few seconds.  I infer that you will fix these worksheets and then not need this macro again.  If this is a recurring task, you may need a better progress indicator.</p>\n\n<p>This is one of the worksheets in formula mode after I have run <code>GenFormulae</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8FFea.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8FFea.png\" alt=\"Result of macro in Formula mode\"></a></p>\n\n<p>This appears to contain the formulae you want.  However, in data mode, the worksheet is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/686qB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/686qB.png\" alt=\"Result of macro in Data mode\"></a></p>\n\n<p>As you can see, the values are not as you want.  As I said at the top, perhaps you can see why.</p>\n"}], "owner": {"reputation": 3127, "user_id": 2066079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jm7vU.png?s=128&g=1", "display_name": "dberm22", "link": "https://stackoverflow.com/users/2066079/dberm22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1569528956, "creation_date": 1569361154, "last_edit_date": 1569400895, "question_id": 58088472, "link": "https://stackoverflow.com/questions/58088472/how-to-convert-indent-level-to-subtotal-formula-with-a-macro", "title": "How to convert &quot;indent level&quot; to SUBTOTAL formula with a macro?", "body": "<p>I've been given over 100 excel sheets, each with multiple thousands of entries that look like the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5pfil.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5pfil.png\" alt=\"enter image description here\"></a></p>\n\n<p>*NOTE: Just the first 3 columns are in the file. I want to either modify the third column, or add the 4th as shown above.</p>\n\n<p>I need to edit these files, delete certain rows, and the total roll-up prices need to be correct. Unfortunately, column C is hardcoded with the values. <strong>How do I convert the \"Price\" column to use the subtotal function as in the rightmost column? i.e. auto-generate column D given the first 3 columns.</strong> I do not want to go through each file line by line.  </p>\n\n<p>I have the indent level, which should theoretically make this easy, but I've never really worked with macros before. I'm not sure how this would be accomplished with just formulas, but I suppose it could be done.</p>\n\n<p>I can either modify column C or create an additional column, D.</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 2, "creation_date": 1569360301, "post_id": 58088275, "comment_id": 102570003, "body": "What is the value of <code>finalrow</code>? If it is less than 6, the loop will not be executed. Also it is best to be explicit about what sheet you&#39;re working with. Using Cells and Range without explicitly specifying the sheet to use opens you up to unexpected results."}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1569360671, "post_id": 58088275, "comment_id": 102570104, "body": "Did you mean <code>finalrow =Sheets(&quot;Sheet1&quot;).Range(&quot;A12000&quot;).Row</code> or <code>finalrow = 12000</code>? The way you have it,  <code>finalrow</code> is being set to a value of 1."}, {"owner": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 0, "creation_date": 1569360742, "post_id": 58088275, "comment_id": 102570126, "body": "Final row in this dump of data is 403. There will usually be at least 400 rows every time I go to run this."}, {"owner": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 0, "creation_date": 1569360978, "post_id": 58088275, "comment_id": 102570200, "body": "Miles, My brain is still not working right on this.  It&#39;s been a while since I&#39;ve written VBA in excel.  If I want to use &quot;End(xlUp)&quot; to find my last row, am I using the correct syntax.  What should I have there to get my final row to, in this case be equal to row 403?"}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1569361355, "post_id": 58088275, "comment_id": 102570301, "body": "I just don&#39;t understand where the <code>A12000</code> comes in? Why not try something dynamic, like this:  <code>finalrow = sht.Cells(sht.Rows.Count, &quot;A&quot;).End(xlUp).Row</code>"}, {"owner": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 0, "creation_date": 1569362488, "post_id": 58088275, "comment_id": 102570610, "body": "I could use that, just being lazy.  I&#39;m still not getting my loop to move to the next row when searching.  It pulls the first row with purchases in it then never moves beyond that row."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1569363721, "post_id": 58088275, "comment_id": 102570931, "body": "Is Sheet1 active when you run the macro?"}, {"owner": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 0, "creation_date": 1569363790, "post_id": 58088275, "comment_id": 102570948, "body": "So, everyone has been asking about &quot;Finalrow&quot;.  No matter what I change it to, the loop only finds the first value and never continues the search in column A for the variable I&#39;m looking for.  THIS IS Where I&#39;m stuck.  I can change final row to everyone&#39;s suggestion and my problem still remains.                                     The question I need to resolve is why the loop never looks to the next row after the first row it looks at which is row 6 ."}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1569364116, "post_id": 58088275, "comment_id": 102571040, "body": "And everyone is explaining that if your code finds the <code>finalrow</code> with a value of  1.  If you are looping from 6 to 1, your loop will end after 1 iteration."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1569364225, "post_id": 58088275, "comment_id": 102571064, "body": "Step through your code. You&#39;re the only one who can see your data - we are in the dark. And answer the very first question please."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 0, "creation_date": 1569363438, "post_id": 58088730, "comment_id": 102570853, "body": "It&#39;s nice everyone is talking about the final row issue, Its just I don&#39;t see what that has to do with my loop problem.  My loop only works on the first instance of the variable I&#39;m searching for and never finds another.  There are about 100 purchases I need to strip out to another worksheet.  So, why does the loop not move beyond the first instance it finds.  I have changed the final row several times to use everyone&#39;s suggestion there.  It still does not solve my problem."}, {"owner": {"reputation": 113, "user_id": 11053389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cb53c6eaf76dfe18ff9d4b3a3ed3548?s=128&d=identicon&r=PG&f=1", "display_name": "Starshine", "link": "https://stackoverflow.com/users/11053389/starshine"}, "reply_to_user": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 1, "creation_date": 1569364050, "post_id": 58088730, "comment_id": 102571022, "body": "@ErikOtterholt - The first time the For loop is encountered, &quot;i&quot; is explicitly set to 6.  Once the Next line is hit, it compares &quot;i&quot; to &quot;finalrow&quot;.  If &quot;finalrow&quot; is 6 or less, it leaves the loop.  Easiest way to test this would be to change the For line to &quot;i = 6 to 10&quot;.  If it gets past 6, then your definition of &quot;finalrow&quot; is the problem."}, {"owner": {"reputation": 1732, "user_id": 11982798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99629abfd4d6ce4b3702d84cf1a1eef0?s=128&d=identicon&r=PG&f=1", "display_name": "user11982798", "link": "https://stackoverflow.com/users/11982798/user11982798"}, "edited": false, "score": 0, "creation_date": 1569415424, "post_id": 58088730, "comment_id": 102589220, "body": "First, you just use purchase to compare. The second you must check your cells content in column a, please try to trim them and make them to be upper case"}, {"owner": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 0, "creation_date": 1569431021, "post_id": 58088730, "comment_id": 102597953, "body": "Oh, I&#39;m so tired, It&#39;s funny how lack of sleep makes you miss the obvious. I was using break points on my code and my instances of Purchases were several rows apart. I would only hit F5 3 or 4 times which never took me to the next row of data. My code worked from the start. I feel so stupid. Trying to troubleshoot something and not recognizing my error in not letting the code get to the next row. Oh, I need sleep.  Thanks everyone"}], "tags": [], "owner": {"reputation": 113, "user_id": 11053389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cb53c6eaf76dfe18ff9d4b3a3ed3548?s=128&d=identicon&r=PG&f=1", "display_name": "Starshine", "link": "https://stackoverflow.com/users/11053389/starshine"}, "is_accepted": false, "score": 1, "last_activity_date": 1569362910, "creation_date": 1569362910, "answer_id": 58088730, "question_id": 58088275, "link": "https://stackoverflow.com/questions/58088275/excel-vba-loop-not-moving-to-next-row/58088730#58088730", "title": "Excel VBA loop not moving to next row", "body": "<p>Check the value being assigned to finalrow.</p>\n\n<p>Without having your file available, this is difficult to diagnose.  I'm unable to find any obvious errors in your code, so I'll go based on experience.</p>\n\n<p>There are quite a few ways to determine what the final row of a spreadsheet is.  You're using my favorite, but it has a couple pitfalls:</p>\n\n<ol>\n<li>Column A could be blank.  I usually encounter this when using data pasted from another sheet or an SQL query, but this would be project specific.</li>\n<li>Column A could extend beyond 12000 rows.  I usually encounter this when I've populated column A with a formula and \"autofilled\" too far down.  \"End(xlUp)\" would then go to \"A1\".</li>\n</ol>\n\n<p>To (usually) get around either of these issues, I always use the max possible row as a starting point; A65563 for Office 2010 or earlier, or A1048576 for anything after that.  It doesn't take any longer to process, and gets more consistent results.</p>\n"}], "owner": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569400975, "creation_date": 1569359916, "last_edit_date": 1569400975, "question_id": 58088275, "link": "https://stackoverflow.com/questions/58088275/excel-vba-loop-not-moving-to-next-row", "title": "Excel VBA loop not moving to next row", "body": "<p>I'm so stuck.  I can't figure why I can't get this simple loop to work and I still need to expand once I've got part 1 complete.  My loop won't move to next i to continue search.</p>\n\n<pre><code>Sub TryThis()\n\nDim Purch As String\nDim Sales As String\nDim finalrow As Integer\nDim i As Integer\n\nPurch = \"PURCHASES\"\nSales = \"SALES\"\n\nfinalrow = Sheets(\"Sheet1\").Range(\"A12000\").End(xlUp).Row\n\nFor i = 6 To finalrow\nIf Cells(i, 1) = Purch Then\n  Range(Cells(i, 1), Cells(i, 7)).Copy\n  Sheets(\"Sheet2\").Activate\n  Range(\"A300\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n  Sheets(\"Sheet1\").Activate\nEnd If\n\nNext i\n\nRange(\"A1\").Select\n\n\nEnd Sub\n</code></pre>\n\n<p>I'm running on empty so I know I'm missing something simple.  In the end, what I'm trying to do is loop through rows and if the row, column A has \"Purchases\", or \"Sales\", copy that row to sheet 2.  </p>\n\n<p>Ideally, I'd like to have sales show in column C in sheet 2 and purchases in column b, but I'll deal with that later,  just trying to get going and must be thinking so hard I'm missing the simple answer.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1569360359, "post_id": 58088219, "comment_id": 102570017, "body": "what line errors?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1569360673, "post_id": 58088219, "comment_id": 102570105, "body": "Does FILE include the file extension?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1569361450, "post_id": 58088219, "comment_id": 102570335, "body": "Also, why are you opening it again?"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1569389686, "post_id": 58088219, "comment_id": 102576024, "body": "Do they have that FILE in that workbook path?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569423507, "post_id": 58088219, "comment_id": 102594186, "body": "Also check out ThisWorkbook vs ActiveWorkbook"}], "owner": {"reputation": 1, "user_id": 12115548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77da920ca0253c44ec83eca7554791e9?s=128&d=identicon&r=PG&f=1", "display_name": "tim32894", "link": "https://stackoverflow.com/users/12115548/tim32894"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569389750, "creation_date": 1569359610, "last_edit_date": 1569389750, "question_id": 58088219, "link": "https://stackoverflow.com/questions/58088219/run-time-error-1004-error-when-another-users-runs-macro", "title": "Run Time Error 1004 - Error When Another Users Runs Macro", "body": "<p>I've built out an Excel macro that will pull information from files on a network drive at work.  It'll condense it into this spreadsheet and use it for some tasks.  When I run it there are no issues and it works exactly as I intend.  However when I had two users test it they had the error described above which prevented the macro from running.</p>\n\n<p>I've looked online and nothing seems to help it.  I've modified the pathing so it would be local and had a user test it locally and they received the same error.  We have the same version of Excel and our permissions aren't different in terms of files or anything.</p>\n\n<p>The error specified this code as the issue:</p>\n\n<pre><code>NameMAS = \"=Master!R2C1:R\" &amp; MASCTA &amp; \"C4\"\nActiveWorkbook.Names.Add Name:=\"Master\", RefersToR1C1:=NameMAS\nActiveWorkbook.Names.Add Name:=\"MasterID\", RefersToR1C1:=MASID\n\nWorkbooks.Open (ActiveWorkbook.path &amp; \"\\\" &amp; FILE)\nWindows(FILE).Activate\n  Cells.Select\n  Selection.Copy \n\nWorkbooks.Open (ActiveWorkbook.path &amp; \"\\\" &amp; FILE) \n</code></pre>\n\n<p>Any assistance would be immensely appreciated as I am completely at a loss as to what to here since I can't test it locally.</p>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1569358804, "post_id": 58088029, "comment_id": 102569540, "body": "You don&#39;t have the 2nd H in the range"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1569358838, "post_id": 58088029, "comment_id": 102569545, "body": "Also, you can use <code>offset</code> from <code>H1</code> instead of using <code>N</code> or offset <code>N</code>"}, {"owner": {"reputation": 89, "user_id": 9730643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad80f61dee66e6efdfd9fb49469e02cf?s=128&d=identicon&r=PG&f=1", "display_name": "user9730643", "link": "https://stackoverflow.com/users/9730643/user9730643"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1569359133, "post_id": 58088029, "comment_id": 102569660, "body": "@Nathan_Sav I changed the range to be Range(&quot;H1:&quot; &amp; &quot;H&quot; &amp; N) however now i am getting error 438 Object doesnt support this property or method"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1569359198, "post_id": 58088029, "comment_id": 102569688, "body": "<code>range(&quot;h1:h&quot; &amp; n)</code> I would have tried.  Which line is the error on, just to be sure.  There are some arguments to <code>.address</code> too"}, {"owner": {"reputation": 89, "user_id": 9730643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad80f61dee66e6efdfd9fb49469e02cf?s=128&d=identicon&r=PG&f=1", "display_name": "user9730643", "link": "https://stackoverflow.com/users/9730643/user9730643"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1569359307, "post_id": 58088029, "comment_id": 102569723, "body": "@Nathan_Sav the error is on the following line &quot;Worksheets(&quot;Global&quot;).OLEObjects(&quot;ComboBox3&quot;).Object.ListFil&zwnj;&#8203;lRange = Worksheets(&quot;Regions-Offices&quot;).Range(&quot;H1:H&quot; &amp; N).Address&quot;. Also evenb with Address removed error 438 is still there"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1569360002, "post_id": 58088029, "comment_id": 102569928, "body": "The worksheet name isn&#39;t evaluated in the return of <code>address</code> so <code>&#39;Regions-Offices&#39;!H1:H&quot; &amp; N</code>"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1569360134, "last_edit_date": 1569360134, "creation_date": 1569359692, "answer_id": 58088237, "question_id": 58088029, "link": "https://stackoverflow.com/questions/58088029/vba-listfillrange-populate-using-dynamic-range-from-different-sheet/58088237#58088237", "title": "VBA ListFillRange populate using dynamic range from different sheet", "body": "<p>The worksheet name isn't evaluated in the return of address so </p>\n\n<p><code>\"'Regions-Offices'!H1:H\" &amp; N</code> </p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1569394631, "creation_date": 1569394631, "answer_id": 58092723, "question_id": 58088029, "link": "https://stackoverflow.com/questions/58088029/vba-listfillrange-populate-using-dynamic-range-from-different-sheet/58092723#58092723", "title": "VBA ListFillRange populate using dynamic range from different sheet", "body": "<p>use <code>External</code> parameter of <code>Address</code> property:</p>\n\n<pre><code>Worksheets(\"Global\").OLEObjects(\"ComboBox3\").ListFillRange = Worksheets(\"Regions-Offices\").Range(\"H1:H\" &amp; N).Address(, , , True)\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 9730643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad80f61dee66e6efdfd9fb49469e02cf?s=128&d=identicon&r=PG&f=1", "display_name": "user9730643", "link": "https://stackoverflow.com/users/9730643/user9730643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 58092723, "answer_count": 2, "score": 0, "last_activity_date": 1569394631, "creation_date": 1569358624, "last_edit_date": 1569359531, "question_id": 58088029, "link": "https://stackoverflow.com/questions/58088029/vba-listfillrange-populate-using-dynamic-range-from-different-sheet", "title": "VBA ListFillRange populate using dynamic range from different sheet", "body": "<p>I am trying to populate a combobox drop down list when a different combobox \"combobox2\" is clicked. I am receiving the error Runt time error 438 Object doesnt support this property or method. I am also sources the listfillrange values from a seperate worksheet. I have included my code below.</p>\n\n<pre><code>Private Sub ComboBox2_Click()\n\n     Dim N As Long\n\n     N = Worksheets(\"Regions-Offices\").Cells(1, 8).End(xlDown).Row\n\n     ActiveSheet.Cells(1, 2).Value = N\n\n     Worksheets(\"Global\").OLEObjects(\"ComboBox3\").Object.ListFillRange = Worksheets(\"Regions-Offices\").Range(\"H1:\" &amp; N).Address\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1569357461, "post_id": 58087776, "comment_id": 102569071, "body": "You never assign anything to <code>PutTogetherURL</code>, i.e. <code>PutTogetherURL = URL</code>, so <code>PutTogetherURL</code> returns a blank string."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1569358018, "post_id": 58087863, "comment_id": 102569286, "body": "I&#39;ll just leave this here: <a href=\"http://rubberduckvba.com/Inspections/Details/NonReturningFunction\" rel=\"nofollow noreferrer\">rubberduckvba.com/Inspections/Details/NonReturningFunction</a> =)"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 4, "last_activity_date": 1569357807, "creation_date": 1569357807, "answer_id": 58087863, "question_id": 58087776, "link": "https://stackoverflow.com/questions/58087776/vba-call-function-not-returning-value/58087863#58087863", "title": "VBA call function not returning value", "body": "<p><code>PutTogetherURL</code> is returning a blank string.</p>\n\n<pre><code>Function PutTogetherURL(StartDate As String) As String\n\n    Dim URL As String\n    URL = \"Yahoo\" &amp; StartDate &amp; \".com\"\n\n    Debug.Print URL\n\n    PutTogetherURL = URL ' return concatenated URL\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12115482, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAYmJ4a6h_2nx1vldkQW2pdSgMWp_RbTKde4qC8pQ=k-s128", "display_name": "craigG", "link": "https://stackoverflow.com/users/12115482/craigg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569357807, "creation_date": 1569357389, "question_id": 58087776, "link": "https://stackoverflow.com/questions/58087776/vba-call-function-not-returning-value", "title": "VBA call function not returning value", "body": "<p>I'm calling a function to add dates to a complicated URL String to make it variable.  The debug in the function PutTogetherURL() prints the correct URL however the debug for URL(4) does not.  I know i'm missing something stupid easy I just can't figure out what.  Any advice appreciated.</p>\n\n<pre><code>Sub PullStuff()\n\nDim response As String\n\nDim URL(1 To 13) As Variant, BoB\nDim PullDate As Date\n\nPullDate = Sheets(\"EOD\").Range(\"M5\")\n\nBoB = 11\n\nURL(1) = \"google.com\"\nURL(2) = \"Yahoo.com\"\nURL(3) = \"Amazon.com\"\n\nURL(4) = PutTogetherURL(Format(PullDate, \"yyyy-mm-dd\"))\n\nEnd Sub\n\n\nFunction PutTogetherURL(StartDate As String) As String\n\nDim URL As String\n\nURL = \"Yahoo\" &amp; StartDate &amp; \".com\"\n\nDebug.Print URL\n\nExit Function\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "split"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1569356964, "post_id": 58087412, "comment_id": 102568878, "body": "what is happening that isn&#39;t right?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1569357309, "post_id": 58087412, "comment_id": 102569012, "body": "If you&#39;re looking for any basic &lt;tag&gt;, you can do a loop from <code>i = 1 to len()</code> and when you find the desired split points, take from the last split point to the current i and append it to a pre-dimensioned array.  application.transpose the array back to your sheet (may need to redim array to your max content)."}, {"owner": {"reputation": 23, "user_id": 4663117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3bcbac34e2d519594245d1c7be8467?s=128&d=identicon&r=PG&f=1", "display_name": "Marrone", "link": "https://stackoverflow.com/users/4663117/marrone"}, "edited": false, "score": 0, "creation_date": 1569357597, "post_id": 58087412, "comment_id": 102569127, "body": "Hey Nathan, thanks for your answer. Well, my code simply splits the selected cells based on few limited tags, and I need it to function with any HTML tag (so anything between &lt; and &gt;. Also, I want it to actually list those tags in the report sheet, like all the remaining text, an not deleting them, as the function does. I&#39;ve included a link with a sample file I would like to achieve. Thanks"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1569357806, "post_id": 58087412, "comment_id": 102569203, "body": "@Marrone in few cases will anyone download a link from this site.  Please edit your post to either provide screen shots of data, or excerpts."}, {"owner": {"reputation": 23, "user_id": 4663117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3bcbac34e2d519594245d1c7be8467?s=128&d=identicon&r=PG&f=1", "display_name": "Marrone", "link": "https://stackoverflow.com/users/4663117/marrone"}, "edited": false, "score": 0, "creation_date": 1569360059, "post_id": 58087412, "comment_id": 102569942, "body": "Thanks Cyril, I just edited my post. :)"}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1569358107, "post_id": 58087900, "comment_id": 102569313, "body": "deleted my answer as this cuts things down to a much simpler use of <code>split(s,&quot;&lt;&quot;)</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1569358223, "post_id": 58087900, "comment_id": 102569347, "body": "This is only a basic appraoach not sure how it would work on nested, say <code>&lt;table&gt;&lt;tr&gt;&lt;td&gt;test&lt;&#47;td&gt;&lt;&#47;tr&gt;&lt;&#47;table&gt;</code>"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 2, "last_activity_date": 1569358426, "last_edit_date": 1569358426, "creation_date": 1569357974, "answer_id": 58087900, "question_id": 58087412, "link": "https://stackoverflow.com/questions/58087412/break-html-tags-and-text-of-a-single-cell-in-multiple-rows/58087900#58087900", "title": "Break HTML tags and text of a single cell in multiple rows", "body": "<p>Would split based on <code>\"&lt;\"</code> not suit your needs, then split on the <code>\"&gt;\"</code> of the result, something like so.    </p>\n\n<pre><code>Sub test()\n\n    Dim s As String\n    Dim s1() As String\n    Dim v As Variant\n\n    s = \"&lt;td&gt;test one&lt;/td&gt;&lt;b&gt;test two&lt;/b&gt;\"\n\n    s1 = Split(s, \"&lt;\")\n\n    For Each v In s1        \n        If Len(v) &gt; 0 And Right(v, 1) &lt;&gt; \"&gt;\" Then        \n            Debug.Print Split(v, \"&gt;\")(1)        \n        End If        \n    Next v        \n\nEnd Sub\n\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4663117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b3bcbac34e2d519594245d1c7be8467?s=128&d=identicon&r=PG&f=1", "display_name": "Marrone", "link": "https://stackoverflow.com/users/4663117/marrone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569389770, "creation_date": 1569355359, "last_edit_date": 1569389770, "question_id": 58087412, "link": "https://stackoverflow.com/questions/58087412/break-html-tags-and-text-of-a-single-cell-in-multiple-rows", "title": "Break HTML tags and text of a single cell in multiple rows", "body": "<p>I am trying to come up with a function that returns each HTML tags and text strings of few selected cells into individual rows of a new Sheet so that I can edit the text rows and then paste everything back to the selected cell.</p>\n\n<p>I have this code, but unfortunately, it is way too basic for my task.</p>\n\n<pre><code>Sub SplitCell ()\n    Dim txt As String\n    Dim i As Integer\n    Dim fullname As Variant\n\n    txt = ActiveCell.Value\n    fullname = Split(txt, \"&lt;p&gt;; &lt;b&gt;; &lt;i&gt;; &lt;/p&gt;; &lt;/b&gt;; &lt;/i&gt;;\")\n        For i = 0 To UBound(fullname)\n        Cells(1, i + 1).Value = fullname(i)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Here's a link to a sample worksheet to give you a better idea of what I would like to achieve.</p>\n\n<p>Sample Sheet </p>\n\n<p><img src=\"https://i.stack.imgur.com/OqKGD.jpg\" alt=\"Sample Sheet\"></p>\n\n<p>Expected result</p>\n\n<p><img src=\"https://i.stack.imgur.com/84ZI6.jpg\" alt=\"Expected Result\"></p>\n\n<p>Thanks,</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1569355670, "post_id": 58087305, "comment_id": 102568428, "body": "Several ways to do this. You could run a loop and prompt for a sheet name with <code>InputBox</code>, and validate the input before you continue. Or you could bring prompt the user to pick a <code>Range</code> on any sheet with <code>Application.InputBox</code> (with the <code>Type</code> argument set to require a <code>Range</code> - see documentation), and use the <code>Parent</code> property of that <code>Range</code> object to get the <code>Worksheet</code> they picked. Or you could pop a <code>UserForm</code> dialog that lists all sheets in a <code>ListBox</code>, and have the user check/select the sheets they want to copy from. Have you tried anything to actually prompt the user for a sheet?"}, {"owner": {"reputation": 2238, "user_id": 2780300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf0f8fbffb43125296bc27d421fe383c?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2780300/kevin"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569356487, "post_id": 58087305, "comment_id": 102568694, "body": "I like the ListBox idea mentioned by @MathieuGuindon"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2238, "user_id": 2780300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf0f8fbffb43125296bc27d421fe383c?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2780300/kevin"}, "edited": false, "score": 0, "creation_date": 1569356927, "post_id": 58087305, "comment_id": 102568866, "body": "@Kevin I&#39;d personally go with that, albeit with <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">a more OOP approach</a> ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 2238, "user_id": 2780300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf0f8fbffb43125296bc27d421fe383c?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2780300/kevin"}, "is_accepted": false, "score": 0, "last_activity_date": 1569410705, "creation_date": 1569410705, "answer_id": 58097292, "question_id": 58087305, "link": "https://stackoverflow.com/questions/58087305/how-to-prompt-user-to-select-multiple-sheet-to-copy/58097292#58097292", "title": "How to prompt user to select multiple sheet to copy", "body": "<p>As an example of how to do this with a list box use the following steps:</p>\n\n<p>I. Create a user form</p>\n\n<p>II. Add a list box and set the following properties</p>\n\n<pre><code>Liststyle =fmliststyleoption,\nmultiselect=fmmultiselectmulti\n</code></pre>\n\n<p>III. Add an initialize event and use code similar below to fill</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim name As String\n\nFor x = 2 To Sheets.Count\n   name = Sheets(x).name\n   ListBoxSheets.AddItem name\nNext\n</code></pre>\n\n<p>End Sub</p>\n\n<p><a href=\"https://i.stack.imgur.com/771bC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/771bC.png\" alt=\"Checked list box to select sheets\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 12115310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W29KajIuWW4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdAuFrrT0jLiGL1N4fj7femKpPwNA/photo.jpg?sz=128", "display_name": "Mitchell Sanders", "link": "https://stackoverflow.com/users/12115310/mitchell-sanders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1569410705, "creation_date": 1569354775, "last_edit_date": 1569355406, "question_id": 58087305, "link": "https://stackoverflow.com/questions/58087305/how-to-prompt-user-to-select-multiple-sheet-to-copy", "title": "How to prompt user to select multiple sheet to copy", "body": "<p>I have code that takes multiple worksheets and copies data onto a \"Combined\" sheet.  How can I insert a prompt so that the user can select which sheets to copy?  Here is my current code:</p>\n\n<pre><code>Sub Combine()\n\nDim J As Integer\n\nOn Error Resume Next\n\n     Sheets(1).Select\n     Worksheets.Add ' add a sheet in first place\n     Sheets(1).Name = \"Combined\"\n     Sheets(3).Activate\n     Range(\"A1:A2\").EntireRow.Select\n     Selection.Copy Destination:=Sheets(1).Range(\"A1\")\n\n     For J = 3 To Sheets.Count - 3 ' from sheet 2 to fourth from last sheet\n          Sheets(J).Activate ' make the sheet active\n          Range(\"A3\").Select\n          Selection.CurrentRegion.Select ' select all cells in this sheets\n          Selection.Offset(2, 0).Resize(Selection.Rows.Count - 2).Select\n          Selection.Copy Destination:=Sheets(1).Range(\"A65536\").End(xlUp)(2)\n     Next\n\n     Sheets(1).Select\n     Cells.Select\n     Cells.EntireColumn.AutoFit\n\nOn Error GoTo 0\n\nEnd Sub\n</code></pre>\n\n<p>I want the user to select the sheets rather than selecting all the sheets.</p>\n"}, {"tags": ["vba", "ms-access", "append"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1569528568, "post_id": 58087104, "comment_id": 102636690, "body": "Use dot instead of ! (bang) to reference textboxes and you will get intellisense popup tips as you type: <code>Me.GRDate</code>."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1569528906, "post_id": 58087104, "comment_id": 102636839, "body": "Also Criteria2 has no value. It is not getting anything from textbox. What event is code in?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10177803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df44d2f4faa2e38928ee69758202d3c9?s=128&d=identicon&r=PG&f=1", "display_name": "Lowendz113", "link": "https://stackoverflow.com/users/10177803/lowendz113"}, "edited": false, "score": 0, "creation_date": 1569499220, "post_id": 58087833, "comment_id": 102621794, "body": "well, that changed it stuff, but didn&#39;t quite work.   That gave me a result of &quot;##&quot; for criteria2"}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1569357676, "creation_date": 1569357676, "answer_id": 58087833, "question_id": 58087104, "link": "https://stackoverflow.com/questions/58087104/append-to-table-using-unbound-textbox/58087833#58087833", "title": "Append to table using unbound textbox", "body": "<p>Date/time type field requires # delimiter for parameters. Text type use apostrophe (or doubled quote), numbers none. Try:</p>\n\n<pre><code>StrSQL = \"Insert Into [*Master Records - 2 - GRs] ([GR Value], [GR Date]) \" &amp; _\n           Values(\" &amp; Criteria1 &amp; \", #\" &amp; Criteria2 &amp; \"#)\"\n</code></pre>\n\n<p>Strongly advise not to use spaces nor punctuation/special characters in naming convention.</p>\n"}], "owner": {"reputation": 25, "user_id": 10177803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df44d2f4faa2e38928ee69758202d3c9?s=128&d=identicon&r=PG&f=1", "display_name": "Lowendz113", "link": "https://stackoverflow.com/users/10177803/lowendz113"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594449104, "creation_date": 1569353754, "last_edit_date": 1594449104, "question_id": 58087104, "link": "https://stackoverflow.com/questions/58087104/append-to-table-using-unbound-textbox", "title": "Append to table using unbound textbox", "body": "<p>I am trying to append two data points to a table using unbound textboxes. I can get one to populate properly, but the other one is coming over blank.</p>\n\n<p>For this example the Criteria1 = 1 and Criteria2 = 9/24/19</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim StrSQL As String\nDim db As DAO.Database\nDim qdf As DAO.QueryDef\nSet db = Application.CurrentDb\n\nSet qdf = db.QueryDefs(\"3 - GRUpload\")\nDim Criteria1 As String\nDim Criteria2 As String\n\nCriteria1 = Me!GRValue\nCriterial2 = Me!GRDate\n\nStrSQL = \"Insert Into [*Master Records - 2 - GRs] ([GR Value], [GR Date]) Values(\" &amp; Criteria1 &amp; \", \" &amp; Criteria2 &amp; \")\"\n\nqdf.SQL = StrSQL\n</code></pre>\n\n<p>I attached a picture of the resulting query, but this is SQL if that's more helpful:   </p>\n\n<pre><code>INSERT INTO [*Master Records - 2 - GRs] ([GR Value], [GR Date])\nSelect 1 As Exp1, Criteria2 AS Expr2;\n</code></pre>\n\n<p>I have tried several variations of the code, including:</p>\n\n<pre><code>Values(\"\"\" &amp; Criteria1 &amp; \"\"\", \"\"\" &amp; Criteria2 &amp; \"\"\")\"\n</code></pre>\n\n<p>Which results in:</p>\n\n<pre><code>INSERT INTO [*Master Records - 2 - GRs] ([GR Value], [GR Date])\nSelect \"1\" As Exp1, \"\" AS Expr2;\n</code></pre>\n\n<p>So I'm at a loss... Could one of you point me in the right direction? </p>\n\n<p>Thank you! </p>\n"}]