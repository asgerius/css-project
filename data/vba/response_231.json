[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1560384578, "post_id": 56571711, "comment_id": 99722257, "body": "I deleted my answer as you say the code you provided was not its entirety. plus there were extra steps you were taking to help speed up your macro ie. turning off auto calcs. etc.. Once you update your question with the full code we can help further"}, {"owner": {"reputation": 15, "user_id": 11156190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f285afdb54eff9b422bc4301115f00f1?s=128&d=identicon&r=PG&f=1", "display_name": "Valantic", "link": "https://stackoverflow.com/users/11156190/valantic"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1560384723, "post_id": 56571711, "comment_id": 99722277, "body": "There was a lot more to this macro than just this code snippet (also involves refreshing external queries and pivot tables, copying/pasting data). I didn&#39;t want to showcase irrelevant code as I&#39;ve narrowed it down to this block of code being the culprit."}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1560399344, "post_id": 56571711, "comment_id": 99724744, "body": "Check how long it takes when an automatic calculation is restored: <code>Application.Calculation = xlCalculationAutomatic</code>. Loading data into an array and working on array data instead of cells would speed up but it isn&#39;t the case of 20 minutes, so the problem is somewhere else."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11156190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f285afdb54eff9b422bc4301115f00f1?s=128&d=identicon&r=PG&f=1", "display_name": "Valantic", "link": "https://stackoverflow.com/users/11156190/valantic"}, "edited": false, "score": 0, "creation_date": 1560471804, "post_id": 56573408, "comment_id": 99757513, "body": "Thank you for your suggestion Tim. I was able to drastically increase the speed by executing the formatting on the unioned range variables whenever i mod 500 = 0, then setting them equal to Nothing. It loops through the 40K rows in less than 10 seconds."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 15, "user_id": 11156190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f285afdb54eff9b422bc4301115f00f1?s=128&d=identicon&r=PG&f=1", "display_name": "Valantic", "link": "https://stackoverflow.com/users/11156190/valantic"}, "edited": false, "score": 0, "creation_date": 1560472249, "post_id": 56573408, "comment_id": 99757594, "body": "Good idea - I did wonder how large those ranges were getting but had not thought to batch the updates and reset them periodically."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1560474742, "last_edit_date": 1560474742, "creation_date": 1560400360, "answer_id": 56573408, "question_id": 56571711, "link": "https://stackoverflow.com/questions/56571711/increase-speed-of-formatting-macro-using-union/56573408#56573408", "title": "Increase Speed of Formatting Macro Using Union()", "body": "<p>Cell-by-cell reading of data is typically slower than loading to an array and reading from there. </p>\n\n<pre><code>Dim FinalRowReport As Long\nDim i As Long\nDim rangeFormat As Range\nDim rangeBold As Range\nDim rangeColor As Range\nDim data\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nFinalRowReport = Cells(Rows.Count, 1).End(xlUp).Row\ndata = Cells(1, 2).Resize(FinalRowReport).Value \n\nFor i = 4 To FinalRowReport\n    If data(i, 1) = data(i - 1, 1) Then\n        BuildRange rangeColor, Range(Cells(i, 1), Cells(i, 12))\n    End If\n    If Right(data(i, 1).Value, 5) = \"Total\" Then\n        BuildRange rangeFormat, Range(Cells(i, 1), Cells(i, 19))\n        BuildRange rangeBold = Range(Cells(i, 20), Cells(i, 23))     \n    End If\nNext i\n\nrangeColor.Font.Color = RGB(255, 255, 255)\nrangeFormat.Interior.Color = RGB(217, 217, 217)\nrangeFormat.Font.Color = RGB(217, 217, 217)\nrangeBold.Interior.Color = RGB(217, 217, 217)\nrangeBold.Font.Bold = True\n'...\n'...\n\n'utility sub for building a range\nSub BuildRange(ByRef rngTot As Range, rngAdd as range)\n    if rngTot is nothing then\n        set rngTot = rngAdd\n    else\n        set rngTot = application.union(rngTot, rngAdd)\n    end if\n\nend sub\n</code></pre>\n\n<p><strong>EDIT</strong> - a little testing based on Valantic's comment about batching the range building every so often.  It makes more difference than I'd expected.</p>\n\n<p>Test Code:</p>\n\n<pre><code>Sub TTT()\n    Const N_COMMIT = 500 '&lt;&lt; \"commit\" and reset the range every this many unions\n    Dim i As Long, t, c, rng As Range, n As Long\n\n    Columns(1).Interior.ColorIndex = xlNone\n\n    t = Timer\n    For i = 1 To 2000# Step 1\n\n        BuildRange rng, Cells(i * 2, 1)\n        n = n + 1\n\n        If n &gt;= N_COMMIT Then\n            rng.Interior.Color = vbRed\n            Set rng = Nothing\n            n = 0\n        End If\n\n        If i Mod 250 = 0 Then Debug.Print i, Timer - t\n    Next i\n\n    If Not rng Is Nothing Then rng.Interior.Color = vbRed\n\nEnd Sub\n</code></pre>\n\n<p><strong>Results</strong>: total time taken depends on commit frequency, with 25 (in my tests) being the \"sweet spot\" in terms of performance.  Note this plot is <strong>log scale</strong> on the y-axis (Time in secs)</p>\n\n<p><a href=\"https://i.stack.imgur.com/818v7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/818v7.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 15, "user_id": 11156190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f285afdb54eff9b422bc4301115f00f1?s=128&d=identicon&r=PG&f=1", "display_name": "Valantic", "link": "https://stackoverflow.com/users/11156190/valantic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 56573408, "answer_count": 1, "score": 0, "last_activity_date": 1560474742, "creation_date": 1560383596, "last_edit_date": 1560385063, "question_id": 56571711, "link": "https://stackoverflow.com/questions/56571711/increase-speed-of-formatting-macro-using-union", "title": "Increase Speed of Formatting Macro Using Union()", "body": "<p>I'm writing a formatting macro for a report, but what I've come up with is not running nearly as quickly as I'd like. Any help or suggestions to increase speed would be greatly appreciated. </p>\n\n<p>My thought when putting together the below code was that if I iterate through each row, and determine the ranges that need to have formatting applied to them merging into a single range using union(), and then apply the format at the end, it would be faster than applying the format for each row individually. I'm not sure this is the case, considering how long this code took to run for about 40k rows. </p>\n\n<pre><code>Dim FinalRowReport As Long\nDim i As Long\nDim rangeFormat As Range\nDim rangeBold As Range\nDim rangeColor As Range\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nFinalRowReport = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 4 To FinalRowReport\n    If Cells(i, 2) = Cells(i - 1, 2) Then\n        If rangeColor Is Nothing Then\n            Set rangeColor = Range(Cells(i, 1), Cells(i, 12))\n        Else\n            Set rangeColor = Union(rangeColor, Range(Cells(i, 1), Cells(i, 12)))\n        End If\n    End If\n    If Right(Cells(i, 2).Value, 5) = \"Total\" Then\n        If rangeFormat Is Nothing Then\n            Set rangeFormat = Range(Cells(i, 1), Cells(i, 19))\n            Set rangeBold = Range(Cells(i, 20), Cells(i, 23))\n        Else\n            Set rangeFormat = Union(rangeFormat, Range(Cells(i, 1), Cells(i, 23)))\n            Set rangeBold = Union(rangeBold, Range(Cells(i, 20), Cells(i, 23)))\n        End If\n    End If\nNext i\n\nrangeColor.Font.Color = RGB(255, 255, 255)\nrangeFormat.Interior.Color = RGB(217, 217, 217)\nrangeFormat.Font.Color = RGB(217, 217, 217)\nrangeBold.Interior.Color = RGB(217, 217, 217)\nrangeBold.Font.Bold = True\nWith rangeFormat.Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .Weight = xlThick\nEnd With\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n</code></pre>\n\n<p>The code does work - it's just extremely long, maybe like 20 minutes. Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "file"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560378006, "post_id": 56571021, "comment_id": 99720972, "body": "<code>ActiveWorkbook.SaveAs FileName:=myPath &amp; &quot;\\&quot; &amp; ActiveSheet.Name &amp; &quot;.xlsx&quot;</code>."}, {"owner": {"reputation": 1, "user_id": 11639336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b83d1a35f34ec95ca7a6ed7ea5f9eb?s=128&d=identicon&r=PG&f=1", "display_name": "HelpMeWithThisSHEET", "link": "https://stackoverflow.com/users/11639336/helpmewiththissheet"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560378658, "post_id": 56571021, "comment_id": 99721133, "body": "Thanks so much for the quick help. I tried your advice,and I get this error, though: &quot;Compile error: Expected: expression&quot;"}, {"owner": {"reputation": 1, "user_id": 11639336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b83d1a35f34ec95ca7a6ed7ea5f9eb?s=128&d=identicon&r=PG&f=1", "display_name": "HelpMeWithThisSHEET", "link": "https://stackoverflow.com/users/11639336/helpmewiththissheet"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560378678, "post_id": 56571021, "comment_id": 99721141, "body": "Sub Splitbook() MyPath = ThisWorkbook.Path For Each sht In ThisWorkbook.Sheets sht.Copy ActiveSheet.Cells.Copy ActiveSheet.Cells.PasteSpecial Paste:=xlPasteValues ActiveSheet.Cells.PasteSpecial Paste:=xlPasteFormats ActiveWorkbook.SaveAs Filename =:MyPath &amp; &quot;\\&quot; &amp; ActiveSheet.Name &amp; &quot;.xlsx&quot; ActiveWorkbook.Close savechanges:=False Next sht End Sub"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1560378874, "post_id": 56571021, "comment_id": 99721195, "body": "<i>Update your question</i> if you need to add code - code in comments is difficult to read."}, {"owner": {"reputation": 1, "user_id": 11639336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b83d1a35f34ec95ca7a6ed7ea5f9eb?s=128&d=identicon&r=PG&f=1", "display_name": "HelpMeWithThisSHEET", "link": "https://stackoverflow.com/users/11639336/helpmewiththissheet"}, "edited": false, "score": 0, "creation_date": 1560379295, "post_id": 56571021, "comment_id": 99721277, "body": "Fair point. I tried his suggestion, but it didn&#39;t work. The edited line in question looked like this:                                                                ActiveWorkbook.SaveAs Filename =:MyPath &amp; &quot;\\&quot; &amp; ActiveSheet.Name &amp; &quot;.xlsx&quot;"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1560379944, "post_id": 56571021, "comment_id": 99721408, "body": "The VBE places your cursor straight on the problem in your error. <code>Filename =:MyPath</code> should be <code>Filename:=MyPath</code>. More specifically, <code>:=</code> instead of <code>=:</code>."}, {"owner": {"reputation": 1, "user_id": 11639336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b83d1a35f34ec95ca7a6ed7ea5f9eb?s=128&d=identicon&r=PG&f=1", "display_name": "HelpMeWithThisSHEET", "link": "https://stackoverflow.com/users/11639336/helpmewiththissheet"}, "edited": false, "score": 0, "creation_date": 1560380437, "post_id": 56571021, "comment_id": 99721516, "body": "First time using VBA. Thanks for the help everyone!"}], "owner": {"reputation": 1, "user_id": 11639336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b83d1a35f34ec95ca7a6ed7ea5f9eb?s=128&d=identicon&r=PG&f=1", "display_name": "HelpMeWithThisSHEET", "link": "https://stackoverflow.com/users/11639336/helpmewiththissheet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562542648, "creation_date": 1560377510, "last_edit_date": 1562542648, "question_id": 56571021, "link": "https://stackoverflow.com/questions/56571021/splitting-workbook-into-multiple-files-by-sheet-how-do-i-get-the-saved-workbook", "title": "Splitting workbook into multiple files by sheet: how do I get the saved workbook name to be the sheet title?", "body": "<p>I am trying to create a macro that splits a given workbook into multiple files that are saved to the same folder with the titles=current sheet names. I currently have it working, but the saved titles come out as \"Book67\", \"Book68\", \"Book69\", etc. and not the sheet title.</p>\n\n<p>Already tried various types of object titles for Worksheet Name (fourth line from the bottom) but to no avail. I that's still where I think the problem is.</p>\n\n<pre><code>Sub Splitbook()\nMyPath = ThisWorkbook.Path\nFor Each sht In ThisWorkbook.Sheets\nsht.Copy\nActiveSheet.Cells.Copy\nActiveSheet.Cells.PasteSpecial Paste:=xlPasteValues\nActiveSheet.Cells.PasteSpecial Paste:=xlPasteFormats\nActiveWorkbook.SaveAs\nFilename = MyPath &amp; \"/\" &amp; \"Worksheet.Name\" &amp; \".xlsx\"\nActiveWorkbook.Close savechanges:=False\nNext sht\nEnd Sub\n</code></pre>\n\n<p>No error messages. Expected results listed above</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1560376026, "post_id": 56570621, "comment_id": 99720463, "body": "If you&#39;ve got <code>Dim semanas(1 to 4)...</code>, then lRow can&#39;t be more then 5, otherwise <code>semanas(i - 1)</code> will throw that error. What are you actually trying to do?"}, {"owner": {"reputation": 526, "user_id": 11054439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27604a9c671e93fd6dfeff5670fbd370?s=128&d=identicon&r=PG&f=1", "display_name": "jvargas", "link": "https://stackoverflow.com/users/11054439/jvargas"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560376305, "post_id": 56570621, "comment_id": 99720544, "body": "That is correct, I did not notice it. like i said, it was made by somebody else... how could I set that value acording to the amount of rows with information?"}, {"owner": {"reputation": 655, "user_id": 3097981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6776097221ad67f371357aaf72cbc775?s=128&d=identicon&r=PG&f=1", "display_name": "Hila DG", "link": "https://stackoverflow.com/users/3097981/hila-dg"}, "edited": false, "score": 0, "creation_date": 1560382069, "post_id": 56570621, "comment_id": 99721838, "body": "Change the code to Dim semanas(1 To 5) As Integer - or any other number that you wish... And since you&#39;re new to this, lookup arrays in VBA <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/declaring-arrays\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/concepts/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1560382174, "creation_date": 1560382174, "answer_id": 56571573, "question_id": 56570621, "link": "https://stackoverflow.com/questions/56570621/how-to-keep-counting-after-4-rows/56571573#56571573", "title": "How to keep counting after 4 rows?", "body": "<p>You can resize your array according to <code>lRow</code>:</p>\n\n<pre><code>    Dim lRow As Long\n    Dim semanas() As Long\n\n    lRow = DatosOmnia.Cells(Rows.Count, 1).End(xlUp).Row\n    ReDim semanas(1 to lRow-1)\n</code></pre>\n\n<p>Typically <code>Long</code> is preferable to <code>Integer</code> - it doesn't \"cost\" more, and it's safer if your data grows larger</p>\n"}], "owner": {"reputation": 526, "user_id": 11054439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27604a9c671e93fd6dfeff5670fbd370?s=128&d=identicon&r=PG&f=1", "display_name": "jvargas", "link": "https://stackoverflow.com/users/11054439/jvargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 56571573, "answer_count": 1, "score": 0, "last_activity_date": 1560407608, "creation_date": 1560375003, "last_edit_date": 1560407608, "question_id": 56570621, "link": "https://stackoverflow.com/questions/56570621/how-to-keep-counting-after-4-rows", "title": "How to keep counting after 4 rows?", "body": "<p>I was provided with some code that a guy who is not longer available did. say you have a table with five columns.  the first four columns get filled with a query that works fine, then there is this piece of code that completes the fifth column. When I run it it gets me \"Subscript out of range (Error 9)\" when it goes for the fifth row and below. The 1,2,3 and 4 work ok. Any help would be great! The error is highlighted on the line above the fisrt \"for\" </p>\n\n<pre><code>    Function HorasSemana() As Double\n        Dim sumaHoras As Double\n        Dim lRow As Integer\n        Dim semanas(1 To 4) As Integer\n\n        lRow = DatosOmnia.Cells(Rows.Count, 1).End(xlUp).Row\n\n        For i = 2 To lRow\n            semanas(i - 1) = WorksheetFunction.WeekNum(DatosOmnia.Cells(i, \"C\"), vbMonday)\n            'MsgBox WorksheetFunction.WeekNum(DatosOmnia.Cells(i, \"C\"), vbMonday)\n        Next i\n\n        'lRow toma el valor con respecto a la hoja \"Horas Semanales\"\n        lRow = Worksheets(\"Horas Semanales\").Cells(Rows.Count, 1).End(xlUp).Row\n        For i = 1 To sizeOf(semanas) '(UBound(semanas, 1) - LBound(semanas, 1) + 1)\n            sumaHoras = 0\n            For j = 2 To lRow\n                If WorksheetFunction.WeekNum(Worksheets(\"Horas Semanales\").Cells(j, \"B\"), vbMonday) = semanas(i) Then\n                    sumaHoras = sumaHoras + Worksheets(\"Horas Semanales\").Cells(j, \"C\").Value\n                    DatosOmnia.Cells(i + 1, \"F\") = sumaHoras\n                End If\n            Next j\n        Next i\n        HorasSemana = sumaHoras\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9825302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFHEf.jpg?s=128&g=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/9825302/sarah"}, "edited": false, "score": 0, "creation_date": 1560379598, "post_id": 56571047, "comment_id": 99721337, "body": "I do step through and watch those variables, and the values are what I listed above. I watch UseCalc.Value cycle through all of the PV values and watch LastCell get to the value of 0.01 (albeit in scientific notation). In the excel sheet, I can watch this happen as I do it. The problem is that the &quot;do until&quot; doesn&#39;t stop at PV2 where everything looks golden, it continues on to PV3. Am I misunderstanding the Do Until purpose? When the &quot;until&quot; is met, does it not end the loop?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 35, "user_id": 9825302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFHEf.jpg?s=128&g=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/9825302/sarah"}, "edited": false, "score": 0, "creation_date": 1560387457, "post_id": 56571047, "comment_id": 99722700, "body": "@Sarah the entire code block within the loop is executed. The <code>Do Until</code> doesn&#39;t stop at <code>UseCalc = PV2</code>, even if that satisfies the condition of <code>&gt;=-1</code> and <code>&lt;=1</code>."}, {"owner": {"reputation": 35, "user_id": 9825302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFHEf.jpg?s=128&g=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/9825302/sarah"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560388169, "post_id": 56571047, "comment_id": 99722817, "body": "@BigBen Ah, that explains it! Would an If Then statement be better suited?  I wanted to avoid writing an unnecessarily long argument, but if it&#39;s necessary then it&#39;s necessary. Or is there a better way?"}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 0, "last_activity_date": 1560377703, "creation_date": 1560377703, "answer_id": 56571047, "question_id": 56570513, "link": "https://stackoverflow.com/questions/56570513/do-until-cell-value-between-1-and-1/56571047#56571047", "title": "Do until cell value between -1 and 1", "body": "<p>At the end of the loop scope, your <code>LastCell</code> value is based upon <code>PV3</code>, not <code>PV2</code>. Step through your macro and check the values of <code>UseCalc</code> (<code>UseCalc.Value</code>), <code>PV3</code> and <code>LastCell</code> (<code>LastCell.Value</code>).</p>\n\n<p>In addition, you do not change the values of <code>PV1</code>, <code>PV2</code> or <code>PV3</code> during the loop, so each loop will have exactly the same effect. With nothing changing, your loop condition won't trigger.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 9825302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFHEf.jpg?s=128&g=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/9825302/sarah"}, "edited": false, "score": 0, "creation_date": 1560429635, "post_id": 56573825, "comment_id": 99739157, "body": "Thanks, this works perfectly! I appreciate everyone&#39;s help!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1560403460, "creation_date": 1560403460, "answer_id": 56573825, "question_id": 56570513, "link": "https://stackoverflow.com/questions/56570513/do-until-cell-value-between-1-and-1/56573825#56573825", "title": "Do until cell value between -1 and 1", "body": "<p>You can do something like this:</p>\n\n<pre><code>Dim LastCell As Range, UseCalc As Range\nDim arrPV(1 to 3) As Double, x as long\n\nSet LastCell = Destination.Offset(9, 12).End(xlDown)\nSet UseCalc = Destination.Offset(9, 12)\n\narrPV(1) = Destination.Offset(0, 12) '2440754.76\narrPV(2) = Destination.Offset(1, 12) '2400379.97\narrPV(3) = Destination.Offset(2, 12) '2429942.76\n\nfor x = 1 to ubound(arrPV)\n    UseCalc.Value = arrPV(x)\n    If LastCell.Value &gt;= -1 And LastCell.Value &lt;= 1 then exit for\nnext x\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9825302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFHEf.jpg?s=128&g=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/9825302/sarah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56573825, "answer_count": 2, "score": 0, "last_activity_date": 1560403460, "creation_date": 1560374417, "last_edit_date": 1560378090, "question_id": 56570513, "link": "https://stackoverflow.com/questions/56570513/do-until-cell-value-between-1-and-1", "title": "Do until cell value between -1 and 1", "body": "<p>Me again... Working on the same project with a different problem!</p>\n\n<p>I have 3 values (calculations but I just need the resulting value), only 1 of which I need to insert into the FIRST cell of my amortization schedule. When the value is inserted, the LAST cell should then equal 0 or close to it.</p>\n\n<p>Currently, my loop just goes forever and ever until the end of eternity.</p>\n\n<pre><code>Dim LastCell As Range: Set LastCell = Destination.Offset(9, 12).End(xlDown) 'Last cell of\n'the amort schedule, should be 0 or close to it at end of term. Destination is a named cell,\n'I'm getting better at avoiding ActiveCell!\n\nDim PV1 As Double: PV1 = Destination.Offset(0, 12) '2440754.76\nDim PV2 As Double: PV2 = Destination.Offset(1, 12) '2400379.97 This is the value in my \n'current scenario that I need, but it may not always be the case\nDim PV3 As Double: PV3 = Destination.Offset(2, 12) '2429942.76\n\nDim UseCalc As Range: Set UseCalc = Destination.Offset(9, 12) 'First cell of the amort schedule\n\nDo Until (LastCell.Value &gt;= -1 And LastCell.Value &lt;= 1)\n    UseCalc = PV1\n    UseCalc = PV2 'When it gets to this point, I can see the value in LastCell\n    'becomes 1.0000000000001839362E-02 which SHOULD trip the between -1 and 1 threshold,\n    'but I'm sure something in the variables I'm setting are going wacky\n    UseCalc = PV3\nLoop\n</code></pre>\n\n<p>I assume the combination of variables I'm using is not correct and this is why it's not tripping the \"Do Until\", but I've tried every sensible combo I can think of. Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1560385631, "post_id": 56570440, "comment_id": 99722431, "body": "Do the order of the columns matter?"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1560386083, "post_id": 56570440, "comment_id": 99722487, "body": "This is not a code writting service.  If you have already wrote some code than share it with us and we will help you to improve it but don&#39;t expect anyone to do your job for you."}, {"owner": {"reputation": 58, "user_id": 8549323, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aQoRQKBkTTY/AAAAAAAAAAI/AAAAAAAAAA8/Z4_2WNR_z-M/photo.jpg?sz=128", "display_name": "mjohnson", "link": "https://stackoverflow.com/users/8549323/mjohnson"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1560388160, "post_id": 56570440, "comment_id": 99722814, "body": "@Skin, the order doesn&#39;t matter."}, {"owner": {"reputation": 58, "user_id": 8549323, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aQoRQKBkTTY/AAAAAAAAAAI/AAAAAAAAAA8/Z4_2WNR_z-M/photo.jpg?sz=128", "display_name": "mjohnson", "link": "https://stackoverflow.com/users/8549323/mjohnson"}, "edited": false, "score": 0, "creation_date": 1560388931, "post_id": 56570440, "comment_id": 99722965, "body": "I didn&#39;t include the other code as it really wasn&#39;t relevant and includes some confidential items. The solution that preceded my question was using VBScript.RegExp and a pattern to insert the &quot;|&quot; into the data source."}], "answers": [{"comments": [{"owner": {"reputation": 58, "user_id": 8549323, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aQoRQKBkTTY/AAAAAAAAAAI/AAAAAAAAAA8/Z4_2WNR_z-M/photo.jpg?sz=128", "display_name": "mjohnson", "link": "https://stackoverflow.com/users/8549323/mjohnson"}, "edited": false, "score": 0, "creation_date": 1560388783, "post_id": 56571990, "comment_id": 99722940, "body": "Thank you @Ahmed-AU! That totally helps! I was trying to come up with a solution that looped through each of the column table names on each line, and using a &quot;Mid&quot; to try and figure out where it was and where it ended, and was having a tough time getting started on the problem."}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 0, "last_activity_date": 1560387440, "last_edit_date": 1560387440, "creation_date": 1560386498, "answer_id": 56571990, "question_id": 56570440, "link": "https://stackoverflow.com/questions/56570440/split-a-delimited-list-based-on-variable-ending-characters-into-specific-columns/56571990#56571990", "title": "Split a delimited list based on variable ending characters into specific columns", "body": "<p>since headers are fixed, it can simply be tried out like this (the Row &amp; Column of the Source &amp; destination data may be changed to your requirement)</p>\n\n<p><a href=\"https://i.stack.imgur.com/whajM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/whajM.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\nSub test()\nDim Ws As Worksheet, SrcLastrow As Long, TrgRow As Long, Rw As Long\nDim Headers As Variant, xLine As Variant\nDim i As Long, j As Long\nSet Ws = ThisWorkbook.ActiveSheet\n'Column A assumed to have the texts\nSrcLastrow = Ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nTrgRow = 2\nHeaders = Array(\"A\", \"QS\", \"J[a]\", \"J\", \"CS\", \"V\")\n\nFor Rw = 1 To SrcLastrow\nxLine = Split(Ws.Cells(Rw, 1).Value, \"|\")\n    For i = 0 To UBound(xLine)\n    For j = 0 To UBound(Headers)\n    xLine(i) = Trim(xLine(i))\n        If Right(xLine(i), Len(Headers(j))) = Headers(j) Then\n        Ws.Range(\"D\" &amp; TrgRow).Offset(0, j).Value = Replace(xLine(i), Headers(j), \"\") ' The output data table was assumed to be at Column D \n        End If\n    Next j\n    Next i\nTrgRow = TrgRow + 1\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 58, "user_id": 8549323, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aQoRQKBkTTY/AAAAAAAAAAI/AAAAAAAAAA8/Z4_2WNR_z-M/photo.jpg?sz=128", "display_name": "mjohnson", "link": "https://stackoverflow.com/users/8549323/mjohnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 56571990, "answer_count": 1, "score": -1, "last_activity_date": 1560387440, "creation_date": 1560374058, "question_id": 56570440, "link": "https://stackoverflow.com/questions/56570440/split-a-delimited-list-based-on-variable-ending-characters-into-specific-columns", "title": "Split a delimited list based on variable ending characters into specific columns", "body": "<p>I have managed to get to a point with a data set where i have a list of items delimited with a \"|\" symbol. I am now trying to separate each item in the list into the corresponding column, however the identifier of the column is a bit of text at the end of each value of variable length.</p>\n\n<p>Example Data (all in one column):</p>\n\n<pre><code>Column A   \n40.00A|24.00QS|8.00J[a]\n40.00A|12.00J|8.00J[a]\n20.00A|4.00V\n30.00A|12.00CS|8.00QS\n</code></pre>\n\n<p>Desired Outcome:</p>\n\n<hr>\n\n<pre><code>+-------+-------+------+-------+-------+------+\n|   A   |  QS   | J[a] |   J   |  CS   |  V   |\n+-------+-------+------+-------+-------+------+\n| 40.00 | 23.00 | 8.00 |       |       |      |\n| 40.00 |       | 8.00 | 12.00 |       |      |\n| 20.00 |       |      |       |       | 4.00 |\n| 30.00 |  8.00 |      |       | 12.00 |      |\n+-------+-------+------+-------+-------+------+\n</code></pre>\n\n<p>The number of trailing characters that define columns is fixed to 6 (A,QS,J[a],J,CS &amp; V), so I know at the beginning how many columns I will need. </p>\n\n<p>I have some ideas on how to do it directly through formulas, but it would require me to split out the items into individual columns by the delimiter, then use some sort of if statement on some additional columns. Would prefer to avoid the helper column issue. Also, looked at the following link, but it doesn't solve the solution, as it assumes the value matches the column heading (I can correct that, but I feel like there is a faster VBA solution here):\n<a href=\"https://stackoverflow.com/questions/48260670/how-to-split-single-column-with-unequal-values-to-multiple-columns-sorted-acco\">How to split single column (with unequal values) to multiple columns sorted according to values from the original single column?</a></p>\n\n<p>I have been reading about Regular Expressions, and i suspect there is a solution there, but I can't quite figure out how to sort the result.</p>\n\n<p>Once i have this data setup, it is a small task to unpivot it and get the data in a proper tabular format using Power Query.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "sharepoint", "data-entry"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1560374851, "post_id": 56570429, "comment_id": 99720095, "body": "For the online version you`ll have to create an <a href=\"https://docs.microsoft.com/en-us/office/dev/add-ins/overview/office-add-ins\" rel=\"nofollow noreferrer\">Office AddIn</a>. I recommend <a href=\"https://www.microsoft.com/en-us/garage/profiles/script-lab/\" rel=\"nofollow noreferrer\">Script Lab</a> as a starting point, helps a lot. However Sharepoint files can be sync locally with One Drive too... so you can still use the actual excel file."}, {"owner": {"reputation": 1, "user_id": 11639151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1888c965e5b48e4fc898142a5720979b?s=128&d=identicon&r=PG&f=1", "display_name": "Donovan", "link": "https://stackoverflow.com/users/11639151/donovan"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1560375831, "post_id": 56570429, "comment_id": 99720414, "body": "Thanks for responding!  Do you mean that I&#39;d use an Office AddIn to replace the functionality of the VBA code, or that the Office AddIn would enable the use of VBA in Excel Online?"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1560377780, "post_id": 56570429, "comment_id": 99720919, "body": "To replace the functionality while working online (can also be used offline)."}, {"owner": {"reputation": 1, "user_id": 11639151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1888c965e5b48e4fc898142a5720979b?s=128&d=identicon&r=PG&f=1", "display_name": "Donovan", "link": "https://stackoverflow.com/users/11639151/donovan"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1560457141, "post_id": 56570429, "comment_id": 99753860, "body": "This looks like a great solution!  Unfortunately, our administrator has disabled Office 365 add-ins.  I was able to go through the Script Lab tutorial on the online version of Script Lab &amp; this would definitely work, but I think I have to go a different route."}], "owner": {"reputation": 1, "user_id": 11639151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1888c965e5b48e4fc898142a5720979b?s=128&d=identicon&r=PG&f=1", "display_name": "Donovan", "link": "https://stackoverflow.com/users/11639151/donovan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 523, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560373984, "creation_date": 1560373984, "question_id": 56570429, "link": "https://stackoverflow.com/questions/56570429/excel-data-entry-form-with-vba-how-to-use-on-sharepoint", "title": "Excel data entry form with VBA, how to use on Sharepoint?", "body": "<p>I currently have an Excel file with a data entry form- a formatted sheet with vba to provide combo boxes, validate data types &amp; form completeness, and then load the entered data to another sheet.  I'd like to put this on Sharepoint for my team to use, but Sharepoint disables VBA.  I'd prefer that they be able to enter data online rather than downloading the Excel file and re-uploading.  Any advice on how to do this?  It's preferred if I don't have to start from scratch, but suggestions on the easiest way to implement this are also welcome.  </p>\n\n<p>Specifically, this is a savings tracker for a procurement group.  I'd like my team members to individually be able to enter negotiation data once complete: project name, supplier, baseline costs, negotiated value, effective date, etc.  Some fields have a list of allowed inputs- most are short lists, but the supplier list is quite long.  Their data would then be stored in a single table that I can build reports with in Power BI.  My team is not particularly tech-savvy.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1560374000, "post_id": 56570412, "comment_id": 99719851, "body": "If you&#39;ve deactivated the sheet, it&#39;s no longer the <code>ActiveSheet</code>. Change <code>ActiveSheet</code> to the sheet the pivot table is actually on."}, {"owner": {"reputation": 27, "user_id": 11639166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f64f1eef50a6b150567bf38b8a82cf?s=128&d=identicon&r=PG&f=1", "display_name": "osugirl7", "link": "https://stackoverflow.com/users/11639166/osugirl7"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560374338, "post_id": 56570412, "comment_id": 99719957, "body": "Thanks BigBen, how do I call out the sheet? I&#39;m pretty new to vba and mostly use macros."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 27, "user_id": 11639166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f64f1eef50a6b150567bf38b8a82cf?s=128&d=identicon&r=PG&f=1", "display_name": "osugirl7", "link": "https://stackoverflow.com/users/11639166/osugirl7"}, "edited": false, "score": 0, "creation_date": 1560375273, "post_id": 56570523, "comment_id": 99720230, "body": "Glad to help out!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1560374458, "creation_date": 1560374458, "answer_id": 56570523, "question_id": 56570412, "link": "https://stackoverflow.com/questions/56570412/vba-code-that-clears-filter-on-pivot-table-on-exit-of-worksheet/56570523#56570523", "title": "VBA code that clears filter on pivot table on exit of worksheet", "body": "<p>If you've deactivated the sheet, then it's no longer the <code>ActiveSheet</code>. Change <code>ActiveSheet</code> to <code>ThisWorkbook.Worksheets(\"yoursheetname\")</code> to reference the worksheet the pivot table in question is on.</p>\n\n<p>Another option is a bit simpler:</p>\n\n<pre><code>Private Sub Worksheet_deactivate()\n\n    Me.PivotTables(\"PivotTable1\").PivotFields( _\n        \"[DIM Material Master].[Material Group].[Material Group]\").ClearAllFilters\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11639166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f64f1eef50a6b150567bf38b8a82cf?s=128&d=identicon&r=PG&f=1", "display_name": "osugirl7", "link": "https://stackoverflow.com/users/11639166/osugirl7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 56570523, "answer_count": 1, "score": 1, "last_activity_date": 1560430757, "creation_date": 1560373867, "last_edit_date": 1560373922, "question_id": 56570412, "link": "https://stackoverflow.com/questions/56570412/vba-code-that-clears-filter-on-pivot-table-on-exit-of-worksheet", "title": "VBA code that clears filter on pivot table on exit of worksheet", "body": "<p>I'm trying to clear a pivot table filter on exit of that sheet.</p>\n\n<p>I've googled and found nothing that works or is similar to what I'm trying to do.</p>\n\n<pre><code>Private Sub Worksheet_deactivate()\n\n    Call ClearFilter\n\nEnd Sub\n\nSub ClearFilter()\n\n' ClearFilter Macro\n\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields( _\n        \"[DIM Material Master].[Material Group].[Material Group]\").ClearAllFilters\nEnd Sub\n</code></pre>\n\n<p>When I run it I get a Run-time error 1004, Unable to get the PivotTables property of the Worksheet class.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1560372885, "post_id": 56570203, "comment_id": 99719498, "body": "use <code>End</code> button on keyboard maybe?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 4, "creation_date": 1560374599, "post_id": 56570203, "comment_id": 99720038, "body": "Sort records DESCENDING or code in VBA <code>Docmd.GoToRecord , , acLast</code>"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1560414723, "post_id": 56570203, "comment_id": 99730838, "body": "<i>So I have to scroll down to see newly inserted rows.</i> Which means, that the cursor should <i>not</i> stay ..."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 2, "creation_date": 1560446567, "post_id": 56570203, "comment_id": 99749261, "body": "Save the ID of the last record in the form before you import data. After the import, use the Form.Recordset.FindFirst method to find the saved ID. Your cursor will be just before the new data."}], "owner": {"reputation": 11, "user_id": 9285592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e0eec1209f9dab6837e8673c12e987b?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9285592/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594636291, "creation_date": 1560372741, "last_edit_date": 1594636291, "question_id": 56570203, "link": "https://stackoverflow.com/questions/56570203/keeping-the-cursor-to-stay-there-after-inserting-a-value-in-access-form", "title": "Keeping the cursor to stay there, after inserting a value in Access form", "body": "<p>How can I keep the cursor in the current position after inserting data into the form using Macro access Please. \nI have a program with tables and forms. I can also import data from excel into access. From the Drop down menu, I can also insert thousand records. But the cursor position goes to the top. So I have to scroll down to see newly inserted rows. </p>\n\n<p>Appreciated for any suggestion.</p>\n"}, {"tags": ["html", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "is_accepted": true, "score": 0, "last_activity_date": 1561476070, "last_edit_date": 1561476070, "creation_date": 1560885866, "answer_id": 56655764, "question_id": 56569839, "link": "https://stackoverflow.com/questions/56569839/how-to-correctly-copy-and-paste-info-charts-tables-etc-from-a-webpage-to-excel/56655764#56655764", "title": "How to correctly copy and paste info (charts,tables etc) from a webpage to excel via vba", "body": "<pre><code>    Sheets(\"Sheet4\").Select\n    Range(\"A1:Z100\") = \"\"\n    Range(\"A1:Z100\").Select\n    Selection.ClearContents\n    Application.Wait DateAdd(\"s\", 2, Now) '//Loads\n\n\n\n    IE.ExecWB 17, 0 '//select all from webpage\n    IE.ExecWB 12, 2 '//Copy Selection\n\n\n\n    Application.DisplayAlerts = False  '//Doesnt display alerts\n    ActiveSheet.Paste\n\n\n    Sheets(\"Sheet4\").Select '//Selects sheet 4 again\n    Range(\"A3:Q32\").Select\n    Selection.Copy\n\n        'Creates a new sheet after &amp; pastes content into it, formats\n\n        Sheets.Add After:=ActiveSheet\n        ActiveSheet.Paste\n        Selection.Columns.AutoFit\n        Selection.rows.AutoFit\n</code></pre>\n\n<p>This code allowed me to copy and paste the data from the web page the way it's formatted on the web page</p>\n"}], "owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 56655764, "answer_count": 1, "score": 0, "last_activity_date": 1561476070, "creation_date": 1560370936, "last_edit_date": 1560410295, "question_id": 56569839, "link": "https://stackoverflow.com/questions/56569839/how-to-correctly-copy-and-paste-info-charts-tables-etc-from-a-webpage-to-excel", "title": "How to correctly copy and paste info (charts,tables etc) from a webpage to excel via vba", "body": "<p>I have a table on a webpage that I am trying to copy and paste into excel, correctly formatted. It comes out all of it in one column, no matter what I try to do to fix it.</p>\n\n<p>I am able to copy it and paste it, it's just super incorrectly formatted. please help.</p>\n\n<pre><code> a lot of stuff before this....\n\n\n lastrow = ws.Cells(ws.rows.Count, \"A\").End(xlUp).Row\n   ' lastrow = ws.Range(\"A1\").End(xlUp).Row\n    i = i + 1\n\nFor i = 3 To lastrow\n        Set svalue1 = .getElementbyID(\"provideANumber\")\n            svalue1.Value = ws.Cells(i, 1).Value\n\n    For Each eInput In .getElementsbyTagName(\"input\")\n            If eInput.getAttribute(\"value\") = \"ENTERit\" Then\n                eInput.Click\n\n    Exit For\n\n            End If\nNext\n\n             IE.Visible = True\nExit For\nNext i\n</code></pre>\n\n<p>more stuff in between.....</p>\n\n<p>'Copy and Paste Results into Excel</p>\n\n<pre><code>    Sheets(\"Sheet4\").Select\n    Range(\"A1:Z50\") = \"\"\n    Range(\"A1:Z150\").Select\n\n    Application.Wait DateAdd(\"s\", 10, Now)\n\n\n    IE.ExecWB 17, 0 '//select all\n    IE.ExecWB 12, 2 '//Copy Selection\n    ActiveSheet.PasteSpecial Format:=\"Text\", link:=False, displayasicon:=False\n\n\n\n    Range(\"A1:Z100\").Select\n</code></pre>\n\n<p>I expect it to show up similiarly to how it looks on the website, however, it shows up all together in one column (and not even legible)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1560370744, "post_id": 56569781, "comment_id": 99718697, "body": "Why not <code>=SUMPRODUCT(COUNTIF(A:A,B1:B20))</code>"}, {"owner": {"reputation": 11, "user_id": 11627355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4796039966e3500cb636ba96b51ddd?s=128&d=identicon&r=PG&f=1", "display_name": "angoulvm", "link": "https://stackoverflow.com/users/11627355/angoulvm"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1560371712, "post_id": 56569781, "comment_id": 99719084, "body": "@ScottCraner you&#39;re a lifesaver! Thank you! Is there a way to use formulas in VBA?"}, {"owner": {"reputation": 155, "user_id": 9941645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9371e128fc5994758c1ff3c12620e848?s=128&d=identicon&r=PG&f=1", "display_name": "SadMrFrown", "link": "https://stackoverflow.com/users/9941645/sadmrfrown"}, "edited": false, "score": 1, "creation_date": 1560371883, "post_id": 56569781, "comment_id": 99719131, "body": "@angoulvm yes <code>.Formula</code> property of range. eg <code>Application.ThisWorkbook.Sheets(1).Range(&quot;C1&quot;).Formula = &quot;=SUMPRODUCT(COUNTIF(A:A,B1:B20))&quot; </code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1560372016, "post_id": 56569781, "comment_id": 99719170, "body": "Or if you mean get the result in VBA: <code>tot = Sheet1.Evaluate(&quot;SUMPRODUCT(COUNTIF(A:A,B1:B20))&quot;)</code>"}, {"owner": {"reputation": 11, "user_id": 11627355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4796039966e3500cb636ba96b51ddd?s=128&d=identicon&r=PG&f=1", "display_name": "angoulvm", "link": "https://stackoverflow.com/users/11627355/angoulvm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1560372402, "post_id": 56569781, "comment_id": 99719319, "body": "@TimWilliams That&#39;s what I was looking for, but when I use that I get a syntax error. I&#39;ve got <code>Dim X as Integer     X = Sheet1.Evaluate(&quot;SUMPRODUCT(COUNTIF(&quot;G:G&quot;,&quot;X1:X44&quot;))&quot;) </code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1560372487, "post_id": 56569781, "comment_id": 99719360, "body": "You added <code>&quot;</code> that are not in @TimWilliams code."}, {"owner": {"reputation": 11, "user_id": 11627355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4796039966e3500cb636ba96b51ddd?s=128&d=identicon&r=PG&f=1", "display_name": "angoulvm", "link": "https://stackoverflow.com/users/11627355/angoulvm"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1560372653, "post_id": 56569781, "comment_id": 99719408, "body": "@ScottCraner my bad! thanks again!"}], "answers": [{"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1560375916, "last_edit_date": 1560375916, "creation_date": 1560373382, "answer_id": 56570323, "question_id": 56569781, "link": "https://stackoverflow.com/questions/56569781/count-cells-that-have-criteria-matching-one-cell-in-a-range/56570323#56570323", "title": "Count cells that have criteria matching one cell in a range", "body": "<p>You've got several good answers in the comments. Here's a User Defined function that I think should perform pretty fast. I might test it against Scott's answer but I think it performs pretty fast.</p>\n\n<pre><code>Function CountFaster(rng1 As Range, rng2 As Range) As Long\nDim qRng() As Variant\n\nSet rng1 = Intersect(rng1, rng1.Worksheet.UsedRange)\nSet rng2 = Intersect(rng2, rng1.Worksheet.UsedRange)\n\nqRng = rng1\n\nDim e As Variant\n\n'Fast way to loop through a range by setting to variant\nFor Each e In qRng\n    If Not IsError(Application.Match(e, rng2, 0)) Then\n        CountFaster = CountFaster + 1\n    End If\nNext\n\n\nEnd Function\n</code></pre>\n\n<p><strong>Update</strong> that will come as a surprise to no one, my UDF got crushed by Scott Cramer's comment. For every 100k cells, mine took about 6 seconds, his 1. I guess that's what happens when you race a guy with 50 times higher or a rating than you... Anyway, if anyone wants the macro file to do their own timing, <a href=\"https://1drv.ms/x/s!AiO7_3PtXmZ9gfwJBETmXkqxl8Oyfw\" rel=\"nofollow noreferrer\">it's here</a></p>\n"}], "owner": {"reputation": 11, "user_id": 11627355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4796039966e3500cb636ba96b51ddd?s=128&d=identicon&r=PG&f=1", "display_name": "angoulvm", "link": "https://stackoverflow.com/users/11627355/angoulvm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560410299, "creation_date": 1560370669, "last_edit_date": 1560410299, "question_id": 56569781, "link": "https://stackoverflow.com/questions/56569781/count-cells-that-have-criteria-matching-one-cell-in-a-range", "title": "Count cells that have criteria matching one cell in a range", "body": "<p>I have two columns of zip codes. I would like to count how many zip codes in column A are also listed in column B.</p>\n\n<p>Up until now I used a <code>=COUNTIF</code> expression, and entered in all the zip codes from column B, but it took forever to put them all in manually, and I'd like to write it in VBA. </p>\n\n<p>My current expression:</p>\n\n<pre><code>=SUM(COUNTIFS(A2:A2000,{\"45390\",\"45401\",\"45402\",\"45403\",\"45404\",\"45405\",\"45406\",\"45409\",\"45410\",\"45412\",etc etc })\n</code></pre>\n\n<p>I'm not really sure where to start though. I could use the VBA countif, but from what I can tell I would have to input all the zip codes manually again, and I'd like to just compare it to all the codes in the range.</p>\n\n<pre><code>Sum(COUNTIF(A:A,{\"\"45390\"\",\"\"45401\"\", etc etc}))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 3, "creation_date": 1560370007, "post_id": 56569600, "comment_id": 99718389, "body": "You should avoid using <code>Selection</code> and <code>.Select</code> ... However without seeing how you integrate this macro into another one, we can&#39;t help you."}, {"owner": {"reputation": 11, "user_id": 11633717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc27a15e8e22bd30771be3806222cefd?s=128&d=identicon&r=PG&f=1", "display_name": "usuario_estudo", "link": "https://stackoverflow.com/users/11633717/usuario-estudo"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 1, "creation_date": 1560370472, "post_id": 56569600, "comment_id": 99718588, "body": "I rewrote the code without using Selection and .Select and it worked. Thank you"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1560373686, "post_id": 56569600, "comment_id": 99719771, "body": "This is one Macro, you would have to be clear about &quot;merge&quot; and what you are doing."}], "owner": {"reputation": 11, "user_id": 11633717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc27a15e8e22bd30771be3806222cefd?s=128&d=identicon&r=PG&f=1", "display_name": "usuario_estudo", "link": "https://stackoverflow.com/users/11633717/usuario-estudo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560370345, "creation_date": 1560369701, "last_edit_date": 1560370345, "question_id": 56569600, "link": "https://stackoverflow.com/questions/56569600/why-the-macro-works-separately-and-when-you-merge-it-with-another-macro-does-not", "title": "Why the macro works separately and when you merge it with another macro does not work?", "body": "<p>When I execute the macro separately it works, but when I merge with another macro it does not work.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub test()\n    Dim z As Integer\n    Sheets(\"transp\").Rows(\"2:2\").Select\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove   \n  For z = 1 To 110\n    Sheets(\"transp\").Cells(2, z).Value = \"VAR_\" &amp; Sheets(\"transp\").Cells(1, z).Value &amp; \"_\" &amp; Sheets(\"input\").Cells(1, 4).Value\n  Next z\n    Sheets(\"transp\").Rows(\"1:1\").Select\n    Selection.Delete Shift:=xlUp\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 3, "last_activity_date": 1560370282, "creation_date": 1560370282, "answer_id": 56569705, "question_id": 56569481, "link": "https://stackoverflow.com/questions/56569481/excel-vba-loop-through-a-directory-of-msg-files/56569705#56569705", "title": "Excel VBA: Loop Through a Directory of .msg files", "body": "<p>This will loop through every file in a directory that is a .msg file\nHaven't used the OpenSharedItem so you may need direct &amp; \"\\\" &amp; myfile in place of just myfile. I do not recommend using ActiveWorkbook.Path, but maybe you have no other way, like asking the user to select the folder in FolderPicker?</p>\n\n<pre><code>direct = ActiveWorkbook.Path\nmyfile = Dir(direct, \"*.msg\")  'sets myfile equal to the first file name\nDo While myfile &lt;&gt; \"\"        'loops until there are no more files in the directory\n        Set mailDoc = olApp.Session.OpenSharedItem(myfile)\n        Sheets(\"sheet1\").Range(\"a1\").Offset(i) = mailDoc.SentOn\n        Sheets(\"sheet1\").Range(\"a1\").Offset(i, 1) = mailDoc.Sender\n        Sheets(\"sheet1\").Range(\"a1\").Offset(i, 2) = mailDoc.Subject\n        mailDoc.Close False\n        i = i + 1\n\n     myfile = Dir            \n\nLoop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 169, "user_id": 7173617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-IHiaBiyQH-Q/AAAAAAAAAAI/AAAAAAAAAGA/OHVb8rV56eM/photo.jpg?sz=128", "display_name": "Owais Arshad", "link": "https://stackoverflow.com/users/7173617/owais-arshad"}, "edited": false, "score": 0, "creation_date": 1560371311, "post_id": 56569820, "comment_id": 99718924, "body": "Worked perfectly. I modified this line:  Set mailDoc = olApp.Session.OpenSharedItem(nam) to  Set mailDoc = olApp.Session.OpenSharedItem(ActiveWorkbook.Path &amp; &quot;\\&quot; &amp; nam)"}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "reply_to_user": {"reputation": 169, "user_id": 7173617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-IHiaBiyQH-Q/AAAAAAAAAAI/AAAAAAAAAGA/OHVb8rV56eM/photo.jpg?sz=128", "display_name": "Owais Arshad", "link": "https://stackoverflow.com/users/7173617/owais-arshad"}, "edited": false, "score": 0, "creation_date": 1560372417, "post_id": 56569820, "comment_id": 99719327, "body": "Thank you. I have amended the answer."}], "tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": false, "score": 2, "last_activity_date": 1560372402, "last_edit_date": 1560372402, "creation_date": 1560370871, "answer_id": 56569820, "question_id": 56569481, "link": "https://stackoverflow.com/questions/56569481/excel-vba-loop-through-a-directory-of-msg-files/56569820#56569820", "title": "Excel VBA: Loop Through a Directory of .msg files", "body": "<p>You do this using the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dir-function\" rel=\"nofollow noreferrer\"><code>Dir</code></a> function. An example of how to use it is found <a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">here</a>. For your case this is the correct code:</p>\n\n<pre><code>Option Explicit\n\nSub getMsgData()\n\n\n    Dim olApp As Outlook.Application\n    Set olApp = CreateObject(\"Outlook.Application\")\n\n    Dim mailDoc As Outlook.MailItem\n    Dim i As Long\n    i = 1\n\n    Dim nam As String\n    nam = Dir(ActiveWorkbook.Path &amp; \"\\*.msg\")\n    Do While nam &lt;&gt; \"\"\n        Set mailDoc = olApp.Session.OpenSharedItem(ActiveWorkbook.Path &amp; \"\\\" &amp; nam)\n        Sheets(\"sheet1\").Range(\"a1\").Offset(i) = mailDoc.SentOn\n        Sheets(\"sheet1\").Range(\"a1\").Offset(i, 1) = mailDoc.Sender\n        Sheets(\"sheet1\").Range(\"a1\").Offset(i, 2) = mailDoc.Subject\n        mailDoc.Close False\n        i = i + 1\n        nam = Dir\n    Loop\n\n    olApp.Quit\n\n    Set mailDoc = Nothing\n    Set olApp = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 7173617, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-IHiaBiyQH-Q/AAAAAAAAAAI/AAAAAAAAAGA/OHVb8rV56eM/photo.jpg?sz=128", "display_name": "Owais Arshad", "link": "https://stackoverflow.com/users/7173617/owais-arshad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 56569705, "answer_count": 2, "score": 0, "last_activity_date": 1560372402, "creation_date": 1560369083, "last_edit_date": 1560372086, "question_id": 56569481, "link": "https://stackoverflow.com/questions/56569481/excel-vba-loop-through-a-directory-of-msg-files", "title": "Excel VBA: Loop Through a Directory of .msg files", "body": "<p>I have an excel workbook which I am using to loop through a bunch of .msg files in a folder to extract the 'sent on', 'sender' and 'subject' fields. I can extract the information but only by expressly referencing the name of the files (in this case test and test2). How do I loop through all the .msg files in the directory and extract the relevant info? This is what I have so far:</p>\n\n<pre><code>Option Explicit\n\nSub getMsgData()\n\n\n    Dim olApp As Outlook.Application\n    Set olApp = CreateObject(\"Outlook.Application\")\n\n    Dim mailDoc As Outlook.MailItem\n    Dim i As Long\n    i = 1\n\n    Dim nam As Variant\n    For Each nam In Array(\"test.msg\", \"test2.msg\")\n        Set mailDoc = olApp.Session.OpenSharedItem(ActiveWorkbook.Path &amp; \"\\\" &amp; nam)\n        Sheets(\"sheet1\").Range(\"a1\").Offset(i) = mailDoc.SentOn\n        Sheets(\"sheet1\").Range(\"a1\").Offset(i, 1) = mailDoc.Sender\n        Sheets(\"sheet1\").Range(\"a1\").Offset(i, 2) = mailDoc.Subject\n        mailDoc.Close False\n        i = i + 1\n    Next nam\n\n    olApp.Quit\n\n    Set mailDoc = Nothing\n    Set olApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2759, "user_id": 368034, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b216ecbf6b41d27afc67e33f60d9af0c?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Martins", "link": "https://stackoverflow.com/users/368034/carlos-martins"}, "edited": false, "score": 0, "creation_date": 1560369917, "post_id": 56569341, "comment_id": 99718354, "body": "What did you try?"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1560368988, "creation_date": 1560368988, "answer_id": 56569460, "question_id": 56569341, "link": "https://stackoverflow.com/questions/56569341/program-command-button-to-run-formula-on-column/56569460#56569460", "title": "Program Command Button to Run Formula on Column", "body": "<p>Use Evaluate:</p>\n\n<pre><code>Sub kkjkk()\n    [B5:B24] = [B5:B24/B2]\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11638864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/399040dd7f10a64cb1a83a062ebcdb52?s=128&d=identicon&r=PG&f=1", "display_name": "Throwaway12345", "link": "https://stackoverflow.com/users/11638864/throwaway12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1560368988, "creation_date": 1560368536, "question_id": 56569341, "link": "https://stackoverflow.com/questions/56569341/program-command-button-to-run-formula-on-column", "title": "Program Command Button to Run Formula on Column", "body": "<p>I need help coming up with the vba coding to develop a button that will convert the number of questions a student answered correctly into a percentage out of the number of questions that were on the test.  It is a spreadsheet with two columns (A &amp; B) with the number of questions to be entered into B2.  The students names are in A5:A24 and the number of questions they got correct will be from B5:B24.  </p>\n\n<p>For printing purposes, the spreadsheet needs to stay in two columns, which is why I am looking to come up with a button that will divide B5:B24 by B2 and then convert that into a percentage for each of the students in A5:A24, and put that answer back in B5:B24.  Is this possible?</p>\n"}, {"tags": ["html", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11633383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f62b34b7be5ee0a56c0f87ea68a4c00d?s=128&d=identicon&r=PG", "display_name": "Lucas Chaves Leite", "link": "https://stackoverflow.com/users/11633383/lucas-chaves-leite"}, "edited": false, "score": 0, "creation_date": 1560371380, "post_id": 56569677, "comment_id": 99718958, "body": "Robert, it did&#39;t work as well. It kind of refreshed the web page. <code>Set SubmitButton = IE.document.getElementsByClassName(&quot;button2&quot;)(0)             SubmitButton.Click</code>"}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "reply_to_user": {"reputation": 1, "user_id": 11633383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f62b34b7be5ee0a56c0f87ea68a4c00d?s=128&d=identicon&r=PG", "display_name": "Lucas Chaves Leite", "link": "https://stackoverflow.com/users/11633383/lucas-chaves-leite"}, "edited": false, "score": 0, "creation_date": 1560373390, "post_id": 56569677, "comment_id": 99719681, "body": "I tried looking at the <a href=\"https://sitenet.serasa.com.br/Logon/autentica\" rel=\"nofollow noreferrer\">website</a> and couldn&#39;t find <code>button2</code> class or a button with &quot;Consultar&quot;. Is it a different site than the one listed above? Also, does the code above get the correct button? You can check in your object browser."}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "reply_to_user": {"reputation": 1, "user_id": 11633383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f62b34b7be5ee0a56c0f87ea68a4c00d?s=128&d=identicon&r=PG", "display_name": "Lucas Chaves Leite", "link": "https://stackoverflow.com/users/11633383/lucas-chaves-leite"}, "edited": false, "score": 0, "creation_date": 1560373666, "post_id": 56569677, "comment_id": 99719762, "body": "Two additional things, the example you gave has <code>id=&quot;Link&quot;</code>, have you tried using <code>IE.document.getElementById()</code>? Also looks like there is an <code>onClick</code> event in the HTML; you could run <code>IE.Document.parentWindow.execScript Code:=&quot;mojarra.jsfcljs(document.getElementById(&#39;form&#39;),{&#39;Lin&zwnj;&#8203;k&#39;:&#39;Link&#39;},&#39;&#39;);retur&zwnj;&#8203;n false&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 11633383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f62b34b7be5ee0a56c0f87ea68a4c00d?s=128&d=identicon&r=PG", "display_name": "Lucas Chaves Leite", "link": "https://stackoverflow.com/users/11633383/lucas-chaves-leite"}, "edited": false, "score": 0, "creation_date": 1560421606, "post_id": 56569677, "comment_id": 99734670, "body": "Robert, you couldn&#39;t find a button &quot;Consultar&quot; because it&#39;s a step after the log in page, which i can&#39;t tell you log in account and password because it is corporate."}, {"owner": {"reputation": 1, "user_id": 11633383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f62b34b7be5ee0a56c0f87ea68a4c00d?s=128&d=identicon&r=PG", "display_name": "Lucas Chaves Leite", "link": "https://stackoverflow.com/users/11633383/lucas-chaves-leite"}, "edited": false, "score": 0, "creation_date": 1560421857, "post_id": 56569677, "comment_id": 99734801, "body": "I have tried using the id = &quot;Link&quot; but it also refreshed the page. About this event <code>onClick</code> i ran the code as you said and i got the message: &quot;Could not complete operation. Error: 80020101&quot;. I&#39;m thankful for your help! Do you have any other suggestion, please?"}, {"owner": {"reputation": 1, "user_id": 11633383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f62b34b7be5ee0a56c0f87ea68a4c00d?s=128&d=identicon&r=PG", "display_name": "Lucas Chaves Leite", "link": "https://stackoverflow.com/users/11633383/lucas-chaves-leite"}, "edited": false, "score": 0, "creation_date": 1560422590, "post_id": 56569677, "comment_id": 99735221, "body": "Robert, i used <code>Set div = IE.document.getElementById(&quot;Link&quot;)             div.FireEvent &quot;onclick&quot;</code> and it also refreshed the page. Do you think that could be something wrong with the website? but when i click using the mouse it works! damn..."}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "reply_to_user": {"reputation": 1, "user_id": 11633383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f62b34b7be5ee0a56c0f87ea68a4c00d?s=128&d=identicon&r=PG", "display_name": "Lucas Chaves Leite", "link": "https://stackoverflow.com/users/11633383/lucas-chaves-leite"}, "edited": false, "score": 0, "creation_date": 1560439258, "post_id": 56569677, "comment_id": 99745555, "body": "There is also an <code>onmousedown</code> event in the example above, looks like that triggers a script as well. Try to first trigger that then trigger the next. Other than that, it&#39;s hard to tell without looking at the webpage."}, {"owner": {"reputation": 1, "user_id": 11633383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f62b34b7be5ee0a56c0f87ea68a4c00d?s=128&d=identicon&r=PG", "display_name": "Lucas Chaves Leite", "link": "https://stackoverflow.com/users/11633383/lucas-chaves-leite"}, "edited": false, "score": 0, "creation_date": 1560517454, "post_id": 56569677, "comment_id": 99773513, "body": "how do i do that? with <code>onmousedown</code>"}], "tags": [], "owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "is_accepted": false, "score": 0, "last_activity_date": 1560370133, "creation_date": 1560370133, "answer_id": 56569677, "question_id": 56569299, "link": "https://stackoverflow.com/questions/56569299/excel-vba-cant-click-on-button-at-ie-html/56569677#56569677", "title": "Excel VBA can&#39;t &quot;click&quot; on button at IE HTML", "body": "<p>In Javascript, the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByClassName\" rel=\"nofollow noreferrer\"><code>getElementsByClassName</code></a> function returns an array-like object of all child elements which have all of the given class names. So if you want to reference it try setting it to the first element which should be indexed at 0.</p>\n\n<p>I didn't test this, but your code should look something like this:\n<code>Set SubmitButton = IE.document.getElementsByClassName(\"button2\")(0)</code></p>\n"}], "owner": {"reputation": 1, "user_id": 11633383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f62b34b7be5ee0a56c0f87ea68a4c00d?s=128&d=identicon&r=PG", "display_name": "Lucas Chaves Leite", "link": "https://stackoverflow.com/users/11633383/lucas-chaves-leite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 490, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560408779, "creation_date": 1560368362, "last_edit_date": 1560408779, "question_id": 56569299, "link": "https://stackoverflow.com/questions/56569299/excel-vba-cant-click-on-button-at-ie-html", "title": "Excel VBA can&#39;t &quot;click&quot; on button at IE HTML", "body": "<p>I use a macro to perform a search on a website. However, I can not press the \"Consultar\" button through the macro.</p>\n\n<p>In Portuguese \"Consultar\" means Browse.</p>\n\n<p>The source code portion of the page for the button I need to trigger is as follows:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;td style=\"border: none;\"&gt;\n  &lt;a\n    id=\"Link\"\n    href=\"#\"\n    onmousedown=\"$('#table-consultar').hide(); mostrarBarra();\"\n    style=\"margin-right:5px\"\n    type=\"button\"\n    onclick=\"mojarra.jsfcljs(document.getElementById('form'),{'Link':'Link'},'');return false\"\n    class=\"button2\"\n    &gt;\n    &lt;span&gt;Consultar&lt;/span&gt;\n  &lt;/a&gt;\n&lt;/td&gt;\n</code></pre>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;div\n  class=\"box boxBlue\"\n  style=\"padding:10px !important; width: 760px !important; height: 48px\"\n&gt;\n  &lt;table style=\"margin: 0px; border: none;\" id=\"table-consultar\"&gt;\n    &lt;tr&gt;\n      &lt;td style=\"border: none; text-align: justify;\"&gt;\n        &lt;div style=\"float:left\"&gt;*&lt;/div&gt;\n        &lt;div style=\"width: 650px; float:left\"&gt;\n          Para mais praticidade, armazenamos as OP\u00c7\u00d5ES ADICIONAIS que voc\u00ea\n          seleciona e iremos traz\u00ea-las pr\u00e9-selecionadas em suas consultas. Se\n          desejar, basta retirar a sele\u00e7\u00e3o e esta n\u00e3o ser\u00e1 mais exibida. Estas\n          op\u00e7\u00f5es est\u00e3o sujeitas \u00e0 cobran\u00e7a adicional, consulte seu&lt;strong&gt;\n            contrato.&lt;/strong\n          &gt;\n        &lt;/div&gt;\n      &lt;/td&gt;\n\n      &lt;td style=\"border: none;\"&gt;\n        &lt;a\n          id=\"Link\"\n          href=\"#\"\n          onmousedown=\"$('#table-consultar').hide(); mostrarBarra();\"\n          style=\"margin-right:5px\"\n          type=\"button\"\n          onclick=\"mojarra.jsfcljs(document.getElementById('form'),{'Link':'Link'},'');return false\"\n          class=\"button2\"\n          &gt;&lt;span&gt;Consultar&lt;/span&gt;&lt;/a\n        &gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n\n  &lt;div\n    id=\"barraDeProgresso\"\n    align=\"left\"\n    style=\"width: 100%; text-align: center; display: none\"\n  &gt;\n    &lt;div style=\"margin-top: 5px;\"&gt;\n      &lt;strong&gt;Aguarde!&lt;/strong&gt;Sua consulta est\u00e1 sendo realizada.&lt;br /&gt;\n      &lt;img\n        id=\"imagem\"\n        src=\"https://sitenet.serasa.com.br/elementos_estrutura/transacional/application/concentre/images/ajax-loader.gif\"\n      /&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Below is the macro code I use:</p>\n\n<pre><code>Sub Serasa_data(Tipo_doc As String, Num_doc As String)\n\n'IE\nDim IE As SHDocVw.InternetExplorer\nDim htmlDoc As MSHTML.HTMLDocument 'Microsoft HTML Object Library\nDim htmlInput As MSHTML.HTMLInputElement\nDim htmlColl As MSHTML.IHTMLElementCollection\nDim SubmitButton As Object\n\n'TO COPY DATA\nDim rng As Range\nDim tbl As Object\nDim rw As Object\nDim cl As Object\nDim tabno As Long\nDim nextrow As Long\nDim i As Long\nDim j As Integer\n\n'INPUT\nDim login As String\nDim password As String\n\nWorksheets(\"Par\u00e2metros\").Select\nlogin = Range(\"log_serasa\")\npassword = Range(\"sen_serasa\")\n\nSet IE = New SHDocVw.InternetExplorer\nIE.Visible = True\nIE.navigate \"https://sitenet.serasa.com.br/Logon/autentica\"\n\nDo While IE.ReadyState &lt;&gt; 4 Or IE.Busy\n     Application.Wait Now + #12:00:02 AM#\nLoop\n\nDo While IE.document.ReadyState &lt;&gt; \"complete\"\n    Application.Wait Now + #12:00:02 AM#\nLoop\n\nWith IE.document\nSet htmlDoc = IE.document\n\n.getElementsByName(\"LOGON\")(0).Value = login\n.getElementsByName(\"SENHA\")(0).Value = password\n.all(\"acessar\").Click\n\nDo While IE.ReadyState &lt;&gt; 4 Or IE.Busy\n    Application.Wait Now + #12:00:02 AM#\nLoop\n\nDo While IE.document.ReadyState &lt;&gt; \"complete\"\n    Application.Wait Now + #12:00:02 AM#\nLoop\n\n.getElementById(\"tipoDocumentoCnpj\").Checked = True\n\n.getElementById(\"cpfCnpjId\").Value = Num_doc\n\n.getElementsByClassName(\"button2\").Click\n\nFor Each tbl In htmlDoc.getElementsByTagName(\"table\")\n        tabno = tabno + 1\n        nextrow = nextrow + 1\n        Set rng = Planilha6.Range(\"B\" &amp; nextrow)\n        rng.Offset(, -1) = \"Table \" &amp; tabno\n        For Each rw In tbl.Rows\n            For Each cl In rw.Cells\n                rng.Value = cl.outerText\n                Set rng = rng.Offset(, 1)\n                i = i + 1\n            Next cl\n            nextrow = nextrow + 1\n            Set rng = rng.Offset(1, -i)\n            i = 0\n        Next rw\n    Next tbl\nEnd If\n\nIE.Quit\nEnd With\n\nWorksheets(\"Main\").Select\nEnd Sub\n</code></pre>\n\n<p>But using the command <code>.getElementsByClassName (\" button2 \").Click</code> is not working.</p>\n\n<p>I've also tried using the codes below and neither worked:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set SubmitButton = IE.document.all.Item(\"Consultar\")\nSubmitButton.Focus\nsubmit.Children(0).Click\nSubmitButton.FireEvent \"onclick\"\n</code></pre>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set SubmitButton = IE.document.getElementsByClassName(\"button2\")\nSubmitButton.FireEvent (\"onchange\")\nSubmitButton.Click\n</code></pre>\n\n<p>Can someone help me how would I trigger this \"Consultar\" button?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 2, "creation_date": 1560368211, "post_id": 56569079, "comment_id": 99717596, "body": "It would be nice to know the initial values of X1 and Y1 before entering this code fragment.  Also, please include some sample data and expected results. Since X1 &amp; Y1 are used in the above to govern the updates, then some other var, say InitX1, might be needed, which could be set the first time into the above code after DoWhile // If firsttime then InitX1 = ...  and set not firsttime."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1560411158, "post_id": 56569079, "comment_id": 99728972, "body": "<i>&quot;Once the data changes in the table, the variable will change values.&quot;</i>  What variable will supposedly change?  The values assigned to variables ODN and CDN come from the fields&#39; Value properties, like <code>ODN = Rec(&quot;OpenDayNumber&quot;).Value</code> and so they will not change due to the recordset edit.  You are NOT assigning ODN and CDN to be the Field objects themselves.  (That would require a <code>Set</code> keyword.)  As far as I can tell, X1 will already be set equal to the value of ODN which was retrieved <b>before</b> changes to the recordset, so X1 will end up with the original value of ODN. What am I missing?"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 1, "creation_date": 1560411271, "post_id": 56569079, "comment_id": 99729036, "body": "BTW, what are the extra commas in both <code>if</code> statements?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1560414909, "post_id": 56569079, "comment_id": 99730942, "body": "@CPerkins is right. You are not writing English but code, and it couldn&#39;t compile as is."}], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594715874, "creation_date": 1560367380, "last_edit_date": 1594715874, "question_id": 56569079, "link": "https://stackoverflow.com/questions/56569079/capturing-a-table-value-in-a-temp-variable-that-wont-change", "title": "Capturing a table value in a temp variable that won&#39;t change", "body": "<p>So, let's say I have something like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Do While Rec.EOF = False\n    'Capture the temp numbers right when you get to the new record, because the table values can change\n    ODN = Rec(\"OpenDayNumber\")\n    CDN = Rec(\"CloseDayNumber\")\n\n    If Rec(\"OpenDayNumber\") &gt;= X1 and =&lt; Y1, then\n        'If the next record starts during the current one but ends after the current one...\n        If Rec(\"CloseDayNumber\") &gt; Y1, then\n            'Just set the OpenDayNumber of the following record to the CloseDayNumber of the current one\n            ' so it doesn't double-count any days\n            Rec.Edit\n            Rec(\"OpenDayNumber\") = Y1\n            Rec.Update\n        else\n            'Ignore Rec (X + 1), it occurred entirely during Rec X.  Set its TotalPendDays to 0.\n            Rec.Edit\n            Rec(\"OpenDayNumber\") = Rec(\"CloseDayNumber\")\n            Rec.Update\n        end if\n    else\n        'its a legit new pend, and should be counted in its entirety\n    end if  \n\n\n    X1 = ODN\n    Y1 = CDN    \n    rec.MoveNext\n\nLoop  \n</code></pre>\n\n<p>How could I make X1 and Y1 capture the values of ODN and CDN respectively?  Once the data changes in the table, the variable will change values.  Well, <code>Rec(\"CloseDayNumber\")</code> doesn't ever change, but <code>Rec(\"OpenDayNumber\")</code> can change.  I want X1 to equal the value of ODN prior to any changes being made.</p>\n"}, {"tags": ["excel", "vba", "duplicates"], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560368776, "post_id": 56569172, "comment_id": 99717837, "body": "I tried to use <code>Set r = IIf(r Is Nothing, .Range(&quot;E&quot; &amp; i), Union(r, .Range(&quot;E&quot; &amp; i)))</code> which I thought I had seen used elsewhere but got an invalid call error - if anyone has any thoughts, would be pleased to hear them."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1560370529, "post_id": 56569172, "comment_id": 99718611, "body": "Could do something slightly different, use a string to build up the range to delete, i.e. <code>strDel = strDel  &amp; &quot;,E&quot; &amp; i</code>, then at the end <code>Sheets(&quot;Sheet1&quot;).Range(right(strDel, len(strDel) - 1)).clearcontents</code> ."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1560367769, "creation_date": 1560367769, "answer_id": 56569172, "question_id": 56569009, "link": "https://stackoverflow.com/questions/56569009/delete-duplicate-values-but-leaves-the-rows/56569172#56569172", "title": "Delete duplicate values but leaves the rows", "body": "<p>I think the easiest way round this is to store all the cells to be cleared before clearing any, as this effects the COUNTIF, and do it all in one go at the end.</p>\n\n<pre><code>Sub x()\n\nDim lastRow As Long, i As Long, r As Range\n\nApplication.ScreenUpdating = False\n\nWith Sheets(\"Sheet1\")\n    lastRow = .Cells(.Rows.Count, \"E\").End(xlUp).Row\n    For i = lastRow To 1 Step -1\n        If Application.CountIf(.Range(\"E1:E\" &amp; lastRow), .Range(\"E\" &amp; i)) &gt; 1 Then\n            If r Is Nothing Then\n                Set r = .Range(\"E\" &amp; i)\n            Else\n                Set r = Union(r, .Range(\"E\" &amp; i))\n            End If\n        End If\n    Next i\nEnd With\n\nIf Not r Is Nothing Then r.ClearContents\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1560370807, "creation_date": 1560370807, "answer_id": 56569806, "question_id": 56569009, "link": "https://stackoverflow.com/questions/56569009/delete-duplicate-values-but-leaves-the-rows/56569806#56569806", "title": "Delete duplicate values but leaves the rows", "body": "<p>I'd use a dictionary object to collect the cells that need to be cleared:</p>\n\n<pre><code>Option Explicit\n'Set Reference to Microsoft Scripting Runtime\nSub deDup()\n    Dim wsSrc As Worksheet, rSrc As Range, C As Range\n    Dim Dict As Dictionary, colRng As Collection\n    Dim rDel As Range\n    Dim v As Variant, w As Variant\n    Dim sKey As String\n\n'Set worksheet/range for the column to filter on\nSet wsSrc = Worksheets(\"sheet2\")\nWith wsSrc\n    Set rSrc = .Range(.Cells(2, 5), .Cells(.Rows.Count, 5).End(xlUp))\nEnd With\n\nSet Dict = New Dictionary\n    Dict.CompareMode = TextCompare\n\nFor Each C In rSrc\n    sKey = C.Value2\n    If Not Dict.Exists(sKey) Then\n        Set colRng = New Collection\n        colRng.Add C\n        Dict.Add Key:=sKey, Item:=colRng\n    Else\n        Dict(sKey).Add C\n    End If\nNext C\n\nFor Each v In Dict.Keys\n    If Dict(v).Count &gt; 1 Then\n        For Each w In Dict(v)\n            If rDel Is Nothing Then\n                Set rDel = w\n            Else\n                Set rDel = Union(rDel, w)\n            End If\n        Next w\n    End If\nNext v\n\nrDel.Clear\n\nEnd Sub\n</code></pre>\n\n<p>If this runs too slowly because your data is very large, you can </p>\n\n<ul>\n<li>turn off <code>ScreenUpdating</code>, <code>Events</code> and set <code>Calculation</code> to <code>manual</code></li>\n<li>or read the data into a VBA array and iterate through the data that way.</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 11638696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa08de5c8d056d8e66fd09497c31d03b?s=128&d=identicon&r=PG&f=1", "display_name": "Custm-1", "link": "https://stackoverflow.com/users/11638696/custm-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565103768, "creation_date": 1560367119, "last_edit_date": 1560410304, "question_id": 56569009, "link": "https://stackoverflow.com/questions/56569009/delete-duplicate-values-but-leaves-the-rows", "title": "Delete duplicate values but leaves the rows", "body": "<p>Trying to crate a macro to clear ALL the duplicate values in a column but leaves the rows</p>\n\n<p>This one works, but it leaves the first duplicate. I just want anything in that column duplicate to be cleared.</p>\n\n<pre><code>    Dim lastRow As Long, i As Long\n    Application.ScreenUpdating = False\n        With Sheets(\"Sheet1\")\n            lastRow = .Cells(.Rows.Count, \"E\").End(xlUp).Row\n            For i = lastRow To 1 Step -1\n                If Application.CountIf(.Range(\"E1:E\" &amp; lastRow), .Range(\"E\" &amp; i)) &gt; 1 Then\n                .Range(\"E\" &amp; i).ClearContents\n                End If\n            Next i\n        End With\n    Application.ScreenUpdating = True\n</code></pre>\n\n<p>Here is my original spreedsheet:</p>\n\n<p><img src=\"https://i.stack.imgur.com/RO7Tf.jpg\" alt=\"enter image description here\"></p>\n\n<p>Here is what I need it to be:</p>\n\n<p><img src=\"https://i.stack.imgur.com/SYVub.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1560366889, "post_id": 56568930, "comment_id": 99717012, "body": "when you do <code>ReDim P(numrow) As Variant ReDim T(numrow) As Variant</code> it is clearing the array, get rid of these lines."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1560367011, "post_id": 56568930, "comment_id": 99717074, "body": "And remember that when bulk filling the row 3 on the sheet just became item (1,1) in the array. change your for to <code>For i = lbound(p,1) to ubound(p,1)</code> and the if: <code>If P(i,1) = 5 And T(i,1) = 100 Then</code> because the arrays are two dimensional even though they are single columns."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1560367106, "post_id": 56568930, "comment_id": 99717112, "body": "But I do not see why a simple countifs will not do this:  <code>countrow = Application.COUNTIFS(Range(&quot;A:A&quot;),5,Range(&quot;B:B&quot;),100)</code> and skip the whole array."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1560367477, "post_id": 56568930, "comment_id": 99717257, "body": "And I believe that <code>numrow = Rows(Rows.Count).End(xlUp).row</code> assumes column A, just in case your data moves and column A is no longer the deciding factor on number of columns."}], "owner": {"reputation": 1, "user_id": 11632835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6689fb64e223566f82728138661f3dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Power of Sunshine", "link": "https://stackoverflow.com/users/11632835/power-of-sunshine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1560366765, "creation_date": 1560366765, "question_id": 56568930, "link": "https://stackoverflow.com/questions/56568930/is-there-a-way-to-assign-an-array-of-values-in-a-column-to-one-variable", "title": "Is there a way to assign an array of values in a column to one variable?", "body": "<p>I am trying to assign all the values in a column to a variable, currently, it is not reading them in correctly. There are no compiling errors or runtime errors right now, just a logical error. Any insight would be very helpful please</p>\n\n<p>I have already tried creating them as objects, and using \"Set\".</p>\n\n<pre><code>Dim countrow As Integer\nDim P(), T() As Variant\nDim i As Integer\nDim numrow As Long\n\nnumrow = Rows(Rows.Count).End(xlUp).row\nP = Range(Cells(3, 1), Cells(numrow, 1)).Value\nT = Range(Cells(3, 2), Cells(numrow, 2)).Value\n\nReDim P(numrow) As Variant\nReDim T(numrow) As Variant\n\ncountrow = 0\n\nFor i = 3 To numrow - 1\n   If P(i) = 5 And T(i) = 100 Then\n      countrow = countrow + 1                       \n   End If\nNext i\n\nMsgBox (countrow)\n</code></pre>\n\n<p>I expect an output of 25, but the actual output is 0. Meaning it is not reading in the true value in each cell. I am trying to count how many rows satisfy both P=5 and T=100 in their cells.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 2, "last_activity_date": 1560366380, "creation_date": 1560366380, "answer_id": 56568863, "question_id": 56568742, "link": "https://stackoverflow.com/questions/56568742/vba-2nd-iteration-of-hitting-cancel-doesnt-leave-behind-an-empty-cell/56568863#56568863", "title": "VBA - 2nd+ Iteration of Hitting Cancel Doesn&#39;t Leave Behind an Empty Cell", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub InputNum()\n\n    Dim InputMsg As String  'shown message\n    Dim lotData As String   'input number\n\n    InputMsg = \"Scan in Lot #\"\n    Do\n        lotData = InputBox(InputMsg)        'ask user to enter lot number\n        If Len(lotData) = 0 Then Exit Sub   'pressed cancel, exit macro\n        If Len(lotData) = 3 Then Exit Do    'entered valid lot number, exit Do loop\n        InputMsg = \"Invalid Lot # Inputed. Must be 3 Characters.\" &amp; Chr(10) &amp; \"Scan in Lot #\"   'Because invalid lot number was entered, update shown message to include the error\n    Loop\n\n    'input number is put into current cell\n    ActiveCell.Value = lotData\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1560367119, "last_edit_date": 1560367119, "creation_date": 1560366560, "answer_id": 56568899, "question_id": 56568742, "link": "https://stackoverflow.com/questions/56568742/vba-2nd-iteration-of-hitting-cancel-doesnt-leave-behind-an-empty-cell/56568899#56568899", "title": "VBA - 2nd+ Iteration of Hitting Cancel Doesn&#39;t Leave Behind an Empty Cell", "body": "<p>With <code>vbCancel</code> you set <code>lotData</code> to \"\" but then exit the sub before setting the cell value. In the other case you call <code>InputNum</code> but then do not exit the sub, so it still runs the <code>ActiveCell.Value = lotData</code> line.</p>\n\n<pre><code>Sub InputNum()\n\n    'input number\n    Dim lotData As String\n\n    'requests an input number to be put in\n    lotData = InputBox(\"Scan in Lot #\")\n\n    'checks to ensure the number put in is 3 characters long\n    If Len(lotData) &lt;&gt; 3 Then\n        'error message\n        Result = MsgBox(\"Invalid Lot # Inputed. Must be 3 Characters. Try Again?\", vbOKCancel)\n        'if cancel is clicked, input number is made blank and sub is exited\n        If Result &lt;&gt; vbOK Then\n            ActiveCell.Value = \"\"\n        Else\n            InputNum\n        End If\n    Else\n        ActiveCell.Value = lotData\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 4188185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ee57426b1176903bb21aaf5db9eaba?s=128&d=identicon&r=PG&f=1", "display_name": "Luke Fairway", "link": "https://stackoverflow.com/users/4188185/luke-fairway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "accepted_answer_id": 56568899, "answer_count": 2, "score": 0, "last_activity_date": 1560367119, "creation_date": 1560365903, "last_edit_date": 1560365938, "question_id": 56568742, "link": "https://stackoverflow.com/questions/56568742/vba-2nd-iteration-of-hitting-cancel-doesnt-leave-behind-an-empty-cell", "title": "VBA - 2nd+ Iteration of Hitting Cancel Doesn&#39;t Leave Behind an Empty Cell", "body": "<p>I'm trying to code something that requests you to put in a certain lot #. If the number you put is not right, then a message box pops up saying to try again or cancel. If you hit try again, it simply loops back to the first question, whereas cancel makes the inputbox = \"\", and then proceeds to exit the sub, leaving behind an empty cell. The problem is that as of right now, one iteration of putting something in wrong and hitting cancel immediately works, and leaves behind an empty cell. However, if I put a number in, say 33333, click try again and now put 22222 (which is still wrong), and then click cancel this time because I want to get out of the loop, it exits the loop, but leaves behind the \"22222\" instead of leaving the cell blank.</p>\n\n<pre><code>Sub InputNum()\n\n    'input number\n    Dim lotData As String\n\n    'requests an input number to be put in\n    lotData = InputBox(\"Scan in Lot #\")\n\n    'checks to ensure the number put in is 3 characters long\n    If Len(lotData) &lt;&gt; 3 Then\n        'error message\n        Result = MsgBox(\"Invalid Lot # Inputed. Must be 3 Characters. Try Again?\", vbOKCancel)\n        'if cancel is clicked, input number is made blank and sub is exited\n        If Result = vbCancel Then\n            lotData = \"\"\n            Exit Sub\n        'if ok is clicked to try again, recurses to beginning of code again\n        Else\n            InputNum\n        End If\n    End If\n\n    'input number is put into current cell\n    ActiveCell.Value = lotData\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "excel.application"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1560369112, "post_id": 56568635, "comment_id": 99717997, "body": "First you do not assign the workbook and you need to make the Excel application <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.visible\" rel=\"nofollow noreferrer\">visible</a> else it runs in background. Also where is your error handling to catch errors? Please include full code block."}, {"owner": {"reputation": 41, "user_id": 6879637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8785ede0ed81c0249ff5e98746eb7aaa?s=128&d=identicon&r=PG&f=1", "display_name": "user6879637", "link": "https://stackoverflow.com/users/6879637/user6879637"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1560459053, "post_id": 56568635, "comment_id": 99754529, "body": "Today I had a new development, it seems like Filecopy and shell commands are also not executing on this database. and they don&#39;t even error out."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6879637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8785ede0ed81c0249ff5e98746eb7aaa?s=128&d=identicon&r=PG&f=1", "display_name": "user6879637", "link": "https://stackoverflow.com/users/6879637/user6879637"}, "edited": false, "score": 0, "creation_date": 1560366814, "post_id": 56568708, "comment_id": 99716973, "body": "I think that was what original piece of code was. The most surprizing part is the same code is working on a co-worker&#39;s machine, which is mind boggling and makes me think some switch got flipped somewhere when as part of some patch, but I can&#39;t locate it. And he and I have the refrences checked."}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1560412862, "post_id": 56568708, "comment_id": 99729830, "body": "maybe you have no permissions to access this file on your machine?"}, {"owner": {"reputation": 41, "user_id": 6879637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8785ede0ed81c0249ff5e98746eb7aaa?s=128&d=identicon&r=PG&f=1", "display_name": "user6879637", "link": "https://stackoverflow.com/users/6879637/user6879637"}, "edited": false, "score": 0, "creation_date": 1560449340, "post_id": 56568708, "comment_id": 99750494, "body": "Nope...The excel file and mdb file are in same locations. This code was actually working up until a few days ago."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1560365755, "creation_date": 1560365755, "answer_id": 56568708, "question_id": 56568635, "link": "https://stackoverflow.com/questions/56568635/ms-access-not-able-to-open-and-assign-excel-objects/56568708#56568708", "title": "MS Access not able to open and assign Excel objects", "body": "<p>Since you are using early binding, perhaps you are missing the reference to the Microsoft Excel Object library (<em><code>Tools &gt; References</code></em>), or perhaps this library has been rendered as <code>MISSING</code> as a result of opening your database in an earlier version of MS Access.</p>\n\n<p>Nevertheless, to avoid the reliance on references entirely and rule this out as a possible cause, you could try using late binding e.g.:</p>\n\n<pre><code>Dim XL As Object\nSet XL = CreateObject(\"Excel.Application\")\nXL.Workbooks.Open(ourPath)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 6879637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8785ede0ed81c0249ff5e98746eb7aaa?s=128&d=identicon&r=PG&f=1", "display_name": "user6879637", "link": "https://stackoverflow.com/users/6879637/user6879637"}, "is_accepted": false, "score": 0, "last_activity_date": 1569926002, "last_edit_date": 1569926002, "creation_date": 1569866139, "answer_id": 58172927, "question_id": 56568635, "link": "https://stackoverflow.com/questions/56568635/ms-access-not-able-to-open-and-assign-excel-objects/58172927#58172927", "title": "MS Access not able to open and assign Excel objects", "body": "<p>So what was happening was, the excel files had add-ins that were preventing for excel to be opened properly. The code worked like a charm as soon as those add-ins were disabled. </p>\n"}], "owner": {"reputation": 41, "user_id": 6879637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8785ede0ed81c0249ff5e98746eb7aaa?s=128&d=identicon&r=PG&f=1", "display_name": "user6879637", "link": "https://stackoverflow.com/users/6879637/user6879637"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594548825, "creation_date": 1560365425, "last_edit_date": 1594548825, "question_id": 56568635, "link": "https://stackoverflow.com/questions/56568635/ms-access-not-able-to-open-and-assign-excel-objects", "title": "MS Access not able to open and assign Excel objects", "body": "<p>Excel file won't open in MS Access. </p>\n\n<p>This piece of code was working until a few days ago. Now it's NOT erroring out and it's not creating any Excel objects.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim XL As Object\nSet XL = New Excel.Application\nXL.workbooks.Open(ourPath)\n</code></pre>\n\n<p>The Object assignment should work (the path is correct, I've checked it multiple times).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1560363714, "post_id": 56568240, "comment_id": 99715696, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\">Worksheet Change</a> doesn&#39;t fire when a formula recalculates. You need <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.calculate%28even%29\" rel=\"nofollow noreferrer\">Worksheet Calculate</a>."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11631451, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4O48guJA88c/AAAAAAAAAAI/AAAAAAAAETQ/HsVRJtoV_Bs/photo.jpg?sz=128", "display_name": "jjacker", "link": "https://stackoverflow.com/users/11631451/jjacker"}, "edited": false, "score": 0, "creation_date": 1560426428, "post_id": 56568509, "comment_id": 99737266, "body": "I&#39;ll check this out. Looks promising. Thank you! :)"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1560364771, "creation_date": 1560364771, "answer_id": 56568509, "question_id": 56568240, "link": "https://stackoverflow.com/questions/56568240/run-event-whenever-date-changes-in-a-cell-a1/56568509#56568509", "title": "Run event whenever date changes in a cell A1", "body": "<p>I would use <strong>B1</strong> as a \"memory\" cell.  Using BigBen's suggestion:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    Application.EnableEvents = False\n        If [B1] = \"\" Then\n            [B1] = [A1]\n        ElseIf [B1] &lt;&gt; [A1] Then\n            [B1] = [A1]\n            MsgBox \"Another day has come!\"\n        End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 11631451, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4O48guJA88c/AAAAAAAAAAI/AAAAAAAAETQ/HsVRJtoV_Bs/photo.jpg?sz=128", "display_name": "jjacker", "link": "https://stackoverflow.com/users/11631451/jjacker"}, "edited": false, "score": 0, "creation_date": 1560426464, "post_id": 56568907, "comment_id": 99737287, "body": "I&#39;ll have a look on this too. I&#39;ll just wait for the next day just to make sure. Thank you! :)"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "reply_to_user": {"reputation": 21, "user_id": 11631451, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4O48guJA88c/AAAAAAAAAAI/AAAAAAAAETQ/HsVRJtoV_Bs/photo.jpg?sz=128", "display_name": "jjacker", "link": "https://stackoverflow.com/users/11631451/jjacker"}, "edited": false, "score": 0, "creation_date": 1560439590, "post_id": 56568907, "comment_id": 99745759, "body": "@jjacker YW, You can also change the Time in Timeserial =&gt; TimeSerial(20, 10, 0) for 20:10:00 to test it. An advantage over the Calculate-method is that it runs at 00:00, The calculate method will run after a (forced) recalculation,"}], "tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1560366608, "creation_date": 1560366608, "answer_id": 56568907, "question_id": 56568240, "link": "https://stackoverflow.com/questions/56568240/run-event-whenever-date-changes-in-a-cell-a1/56568907#56568907", "title": "Run event whenever date changes in a cell A1", "body": "<p>Another possibility, use Application.ontime to run every day:</p>\n\n<pre><code>Public myBool As Boolean\nSub StartNextday()\n    If myBool Then MsgBox \"Another day has come!\"\n        Application.OnTime TimeSerial(0, 0, 0), \"StartNextday\"\n        myBool = True\nEnd Sub\nSub CloseNextday()\n        Application.OnTime TimeSerial(0, 0, 0), \"StartNextday\", , False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11631451, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4O48guJA88c/AAAAAAAAAAI/AAAAAAAAETQ/HsVRJtoV_Bs/photo.jpg?sz=128", "display_name": "jjacker", "link": "https://stackoverflow.com/users/11631451/jjacker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1560366608, "creation_date": 1560363662, "last_edit_date": 1560366415, "question_id": 56568240, "link": "https://stackoverflow.com/questions/56568240/run-event-whenever-date-changes-in-a-cell-a1", "title": "Run event whenever date changes in a cell A1", "body": "<p>Need your input on how to run an Event whenever the date on cell A1 changes. The current formula in cell A1 is =Today().</p>\n\n<p>This code doesn't work on me:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n  If Target.Address = \"$A$1\" Then\n\n    MsgBox \"Another day has come!\"\n\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>Ex. What will happen should be, if it's 11:59 PM (Jun 11, 2019) and goes to the next day, 12:00 AM (Jun 12, 2019) a procedure will automatically run. </p>\n\n<p>Thanks guys.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1560363701, "post_id": 56568142, "comment_id": 99715691, "body": "Why don&#39;t you just use a pivot table?"}, {"owner": {"reputation": 1, "user_id": 10326868, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gOK_0OIPXLs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP3jUSYznJW9_uhrWgSi5rKLJE5zw/mo/photo.jpg?sz=128", "display_name": "Leia", "link": "https://stackoverflow.com/users/10326868/leia"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560439838, "post_id": 56568142, "comment_id": 99745894, "body": "Thank you SJR.  But, I would like to figure out how to create the &quot;total&quot; summary without using a pivot table."}], "owner": {"reputation": 1, "user_id": 10326868, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gOK_0OIPXLs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP3jUSYznJW9_uhrWgSi5rKLJE5zw/mo/photo.jpg?sz=128", "display_name": "Leia", "link": "https://stackoverflow.com/users/10326868/leia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560364125, "creation_date": 1560363332, "last_edit_date": 1560364125, "question_id": 56568142, "link": "https://stackoverflow.com/questions/56568142/for-each-cell-in-range-total-next-column-cell", "title": "For each cell in range, total next column cell", "body": "<p>For each \"farm\" in column A; sum the values from column C (Count) for \"apple-1\" and \"apple-2\" in column B.   </p>\n\n<p>Looping thru searching and adding. No errors.  Math is occurring from the wrong cells.  </p>\n\n<p>Data</p>\n\n<p><a href=\"https://i.stack.imgur.com/3MyWx.png\" rel=\"nofollow noreferrer\">Data table</a></p>\n\n<pre><code>Sub find_2()\n\nDim apple_1 As Long, apple_2 As Long\nDim j As Integer\nDim total_aps As Long\n\nDim name As Range\nDim myrange As Range\n\nlast_row = ActiveSheet.Range(\"A\" &amp; Rows.count).End(xlUp).Row\n\nSet myrange = Range(\"A2:A17\" &amp; last_row)\n\nSheets(\"Sheet1\").Activate\n\nWith ActiveSheet\n\n    For j = 16 To last_row\n        For Each name In myrange\n              If .Cells(j, 2).Value = (\"apple-1\") Then\n                apple_1 = Sheet1.Cells(j, 3).Value\n              End If\n              If .Cells(j, 2).Value = (\"apple-2\") Then\n                apple_2 = Sheet1.Cells(j, 3).Value\n              End If\n\n    total_aps = apple_1 + apple_2 \n\n        .Cells(j, 6).Value = total_aps\n\n    Next\n\n    Next j\n\nEnd With\n\nEnd Sub\n\n=======================================================================\n\n\nExpected/Wanted results\n\nFarm       Total Count\n\nfarm-01    300\n\nfarm-02    30\n\nfarm-03    3\n\nfarm-04    3000\n</code></pre>\n\n<p>Actual results  (see Totals Count)\n<a href=\"https://i.stack.imgur.com/YmBkx.png\" rel=\"nofollow noreferrer\">Actual results</a></p>\n"}, {"tags": ["excel", "vba", "tabs"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 11638501, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/25050e8e3531cf2074d70a4418e34087?s=128&d=identicon&r=PG", "display_name": "user11638501", "link": "https://stackoverflow.com/users/11638501/user11638501"}, "is_accepted": false, "score": 1, "last_activity_date": 1560363825, "creation_date": 1560363825, "answer_id": 56568281, "question_id": 56568103, "link": "https://stackoverflow.com/questions/56568103/tracking-usage-by-tab-in-excel/56568281#56568281", "title": "Tracking usage by Tab in Excel", "body": "<p>This set of sub procedures in the ThisWorkbook code sheet should cover most scenarios.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n\n    Open ThisWorkbook.Path &amp; \"\\Usage.log\" For Append As #2\n    Print #2, Application.UserName, Now &amp; \" open\"\n    Print #2, Application.UserName, Now, ActiveSheet.Name &amp; \" activate\"\n    Close #2\n\nEnd Sub\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    Open ThisWorkbook.Path &amp; \"\\Usage.log\" For Append As #2\n    Print #2, Application.UserName, Now &amp; \" close\"\n    Close #2\n\nEnd Sub\n\nPrivate Sub Workbook_SheetActivate(ByVal Sh As Object)\n\n    Open ThisWorkbook.Path &amp; \"\\Usage.log\" For Append As #2\n    Print #2, Application.UserName, Now, Sh.Name &amp; \" activate\"\n    Close #2\n\nEnd Sub\n\nPrivate Sub Workbook_SheetDeactivate(ByVal Sh As Object)\n\n    Open ThisWorkbook.Path &amp; \"\\Usage.log\" For Append As #2\n    Print #2, Application.UserName, Now, Sh.Name &amp; \" deactivate\"\n    Close #2\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11638483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2339a1867833e7410329f6a050a464b0?s=128&d=identicon&r=PG&f=1", "display_name": "bwm6335", "link": "https://stackoverflow.com/users/11638483/bwm6335"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560410319, "creation_date": 1560363093, "last_edit_date": 1560410319, "question_id": 56568103, "link": "https://stackoverflow.com/questions/56568103/tracking-usage-by-tab-in-excel", "title": "Tracking usage by Tab in Excel", "body": "<p>I have added a usage log tracking function to many of my Excel files (VBA code below).  These currently show which user opens a specific file and when they are opened.  However, I am trying to gather additional information.  Specifically, I am looking for a way to record which tabs a user navigates to (in addition to the fact that they opened the file).  The primary goal of this is to eliminate work that results from creating exhibits on tabs that are not regularly referenced.  </p>\n\n<p>This is the code I am currently using to create a generic usage log to see who opens the file (and when);</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nOpen ThisWorkbook.Path &amp; \"\\Usage.log\" For Append As #2\n    Print #2, Application.UserName, Now\n    Close #2\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 759, "user_id": 2531336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ekcpj.png?s=128&g=1", "display_name": "thecarpy", "link": "https://stackoverflow.com/users/2531336/thecarpy"}, "edited": false, "score": 1, "creation_date": 1560368182, "post_id": 56568004, "comment_id": 99717580, "body": "You do not have to click on it. Look up <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ms757828(v%3Dvs.85)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/windows/desktop/&hellip;</a>&zwnj;&#8203;. You need to read the HTML page, not validate it, find the <code>a</code> tag with text() &quot;UFR Filing with Audited Financials&quot; and get its @href (the URL you need), then retrieve that document and so forth"}, {"owner": {"reputation": 53, "user_id": 5106668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1d73d6612c0293b88216f215189dd2c?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Fernandes", "link": "https://stackoverflow.com/users/5106668/marc-fernandes"}, "reply_to_user": {"reputation": 759, "user_id": 2531336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ekcpj.png?s=128&g=1", "display_name": "thecarpy", "link": "https://stackoverflow.com/users/2531336/thecarpy"}, "edited": false, "score": 0, "creation_date": 1560370298, "post_id": 56568004, "comment_id": 99718516, "body": "Thanks, this is pointing me in the right direction. I have it working through step 2 so far, will update as I go."}, {"owner": {"reputation": 53, "user_id": 5106668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1d73d6612c0293b88216f215189dd2c?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Fernandes", "link": "https://stackoverflow.com/users/5106668/marc-fernandes"}, "reply_to_user": {"reputation": 759, "user_id": 2531336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ekcpj.png?s=128&g=1", "display_name": "thecarpy", "link": "https://stackoverflow.com/users/2531336/thecarpy"}, "edited": false, "score": 0, "creation_date": 1560372294, "post_id": 56568004, "comment_id": 99719276, "body": "I have step 2 working but running into trouble with step 3. I need to find the row in &quot;Document Category&quot; that contains &quot;UFR Excel Template&quot; and pick the url in the same row. I was able to see that each url in the table is essentially &quot;<a href=\"https://ufr.osd.state.ma.us/WebAccess/documentviewact.asp?counter=#\" rel=\"nofollow noreferrer\">ufr.osd.state.ma.us/WebAccess/documentviewact.asp?counter=#</a>&zwnj;&#8203;&quot; with the # sign representing the row number in the table, starting at 0 for the first row. If I figure out which row number &quot;UFR Excel Template&quot; was in in the table, I could just use that - 1 to add to this url."}, {"owner": {"reputation": 759, "user_id": 2531336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ekcpj.png?s=128&g=1", "display_name": "thecarpy", "link": "https://stackoverflow.com/users/2531336/thecarpy"}, "edited": false, "score": 0, "creation_date": 1560513883, "post_id": 56568004, "comment_id": 99771570, "body": "In step 3 you need to use an xpath Axis, something along the lines of  <code>&#47;&#47;td[child::li eq &#39;UFR Excel Template&#39;]&#47;preceding-sibling::td&#47;a&#47;@href</code> See w3c.org for more info on this, or ask a new question: <a href=\"https://www.w3.org/TR/2017/REC-xpath-31-20170321/\" rel=\"nofollow noreferrer\">w3.org/TR/2017/REC-xpath-31-20170321</a>  You can use <a href=\"https://www.freeformatter.com/xpath-tester.html\" rel=\"nofollow noreferrer\">freeformatter.com/xpath-tester.html</a> to test HTML/XML against xpath expressions"}], "answers": [{"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 1, "last_activity_date": 1560396527, "last_edit_date": 1560396527, "creation_date": 1560395984, "answer_id": 56572936, "question_id": 56568004, "link": "https://stackoverflow.com/questions/56568004/need-excel-vba-to-navigate-website-and-download-specific-files/56572936#56572936", "title": "Need Excel VBA to navigate website and download specific files", "body": "<p>I have tried step 3 with some what lengthy way. but could not provide complete download code as (after one successful manual attempt) at present even manual download attempt causing  massage \"The File Could Not Be Retrieved\" (maybe server side constrain)</p>\n\n<p>Code only take you down to the cell containing <code>href</code> of the xlx file</p>\n\n<pre><code> Dim doc As HTMLDocument\n        Dim Tbl As HTMLTable, Cel As HTMLTableCell, Rw As HTMLTableRow, Col As HTMLTableCol\n        Set doc = IE.document\n\n        For Each ele In IE.document.getElementsByClassName(\"boxedContent\")\n            For Each Tbl In ele.getElementsByTagName(\"table\")\n               For Each Rw In Tbl.Rows\n                    For Each Cel In Rw.Cells\n                    'Debug.Print Cel.innerText\n                        If InStr(1, Cel.innerText, \"UFR Excel Template\") &gt; 0 Then\n                        Debug.Print Rw.Cells(2).innerText &amp; \" - \" &amp; Rw.Cells(2).innerHTML\n                        End If\n                    Next\n               Next Rw\n            Next Tbl\n        Next\n</code></pre>\n\n<p>Once the <code>href</code> is available <code>PtrSafe</code> Function or <code>WinHTTPrequest</code> or other methods could be used to download the file. Welcome and eager to learn some more efficient answers in this case from experts like @QHarr and others.</p>\n"}], "owner": {"reputation": 53, "user_id": 5106668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1d73d6612c0293b88216f215189dd2c?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Fernandes", "link": "https://stackoverflow.com/users/5106668/marc-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560439953, "creation_date": 1560362620, "last_edit_date": 1560439953, "question_id": 56568004, "link": "https://stackoverflow.com/questions/56568004/need-excel-vba-to-navigate-website-and-download-specific-files", "title": "Need Excel VBA to navigate website and download specific files", "body": "<p>Trying to understand how to interact with a website in a specific way. This is part of a larger code I'm working on that will loop through a list of ContractorIDs. What I need to do from here is the following:</p>\n\n<ol>\n<li><p>Navigate to this website: <a href=\"https://ufr.osd.state.ma.us/WebAccess/SearchDetails.asp?ContractorID=042786217&amp;FilingYear=2018&amp;nOrgPage=7&amp;Year=2018\" rel=\"nofollow noreferrer\">https://ufr.osd.state.ma.us/WebAccess/SearchDetails.asp?ContractorID=042786217&amp;FilingYear=2018&amp;nOrgPage=7&amp;Year=2018</a></p></li>\n<li><p>Find the link that says \"UFR Filing with Audited Financials\" and click on it. (if it's not there, end the sub)</p></li>\n<li><p>On the ensuing page, find the link that is identified under \"Document Category\" as \"UFR Excel Template\" and click on it. (in this case, the link says \"15-UFR18.xls\", however since there's no consistent link naming scheme, the correct link will always have to be identified by the label under \"Document Category\" as mentioned. If the link doesn't exist, exit sub.)</p></li>\n<li><p>On the ensuing page, click the \"Download\" link at the top and save the file under the following file path (which would be created at this time): C:\\Documents\\042786217\\2018.</p></li>\n</ol>\n\n<p>Edit: Code below gets me to the point where the download button is clicked, then I get the Open/Save/Cancel dialog box. Nearly there, just need to figure out how to save the file into a specific path.</p>\n\n<pre><code>Option Explicit\nSub UFRScraper()\n\n    If MsgBox(\"UFR Scraper will run now. Do you wish to continue?\", vbYesNo) = vbNo Then Exit Sub\n\n    Dim IE As Object\n    Dim objElement As Object\n    Dim objCollection As Object\n    Dim ele As Object\n    Dim tbl_Providers As ListObject: Set tbl_Providers = ThisWorkbook.Worksheets(\"tbl_ProviderList\").ListObjects(\"tbl_Providers\")\n    Dim FEIN As String: FEIN = \"\"\n    Dim FEINList As Range: Set FEINList = tbl_Providers.ListColumns(\"FEIN\").DataBodyRange\n    Dim ProviderName As String: ProviderName = \"\"\n    Dim ProviderNames As Range: Set ProviderNames = tbl_Providers.ListColumns(\"Provider Name\").DataBodyRange\n    Dim FiscalYear As String: FiscalYear = \"\"\n    Dim urlUFRDetails As String: urlUFRDetails = \"\"\n    Dim i As Integer\n\n    ' Create InternetExplorer Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    ' Show (True)/Hide (False) IE\n    IE.Visible = True\n\n    i = 1\n    For i = 1 To 3 'Limited to 3 during testing. Change when ready.\n        FEIN = FEINList(i, 1)\n        ProviderName = ProviderNames(i, 1)\n\n        urlUFRDetails = \"https://ufr.osd.state.ma.us/WebAccess/SearchDetails.asp?ContractorID=\" &amp; FEIN &amp; \"&amp;FilingYear=2018&amp;nOrgPage=1&amp;Year=2018\"\n\n        IE.Navigate urlUFRDetails\n\n        ' Wait while IE loading...\n        'IE ReadyState = 4 signifies the webpage has loaded (the first loop is set to avoid inadvertently skipping over the second loop)\n        Do While IE.ReadyState = 4: DoEvents: Loop   'Do While\n        Do Until IE.ReadyState = 4: DoEvents: Loop   'Do Until\n\n\n        'Step 2 is done here\n        Dim filingFound As Boolean: filingFound = False\n        For Each ele In IE.Document.getElementsByTagName(\"a\")\n            If ele.innerText = \"UFR Filing with Audited Financials\" Then\n                filingFound = True\n                IE.Navigate ele.href\n                Do While IE.ReadyState = 4: DoEvents: Loop   'Do While\n                Do Until IE.ReadyState = 4: DoEvents: Loop   'Do Until\n                Exit For\n            End If\n        Next ele\n\n        If filingFound = False Then\n            GoTo Skip\n        End If\n\n\n        'Step 3\n        Dim j As Integer: j = 0\n        Dim UFRFileFound As Boolean: UFRFileFound = False\n        For Each ele In IE.Document.getElementsByTagName(\"li\")\n            j = j + 1\n            If ele.innerText = \"UFR Excel Template\" Then\n                UFRFileFound = True\n                IE.Navigate \"https://ufr.osd.state.ma.us/WebAccess/documentviewact.asp?counter=\" &amp; j - 4\n                Do While IE.ReadyState = 4: DoEvents: Loop   'Do While\n                Do Until IE.ReadyState = 4: DoEvents: Loop   'Do Until\n                Exit For\n            End If\n        Next ele\n\n        If UFRFileFound = False Then\n            GoTo Skip\n        End If\n\n\n        'Step 4\n        IE.Document.getElementById(\"LinkButton2\").Click\n\n        '**Built in wait time to avoid accidentally overloading server with repeated quick requests during development and testing**\nSkip:\n        Application.Wait (Now + TimeValue(\"0:00:03\"))\n        MsgBox \"Loop \" &amp; i &amp; \" complete.\"\n\n    Next i\n\n    'Unload IE\n    IE.Quit\n    Set IE = Nothing\n    Set objElement = Nothing\n    Set objCollection = Nothing\n\n    MsgBox \"Process complete!\"\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560362429, "post_id": 56567952, "comment_id": 99715116, "body": "You want the <code>And</code> operator instead of <code>&amp;</code>."}, {"owner": {"reputation": 19, "user_id": 11610650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53093886c10f50da7e8569db2d07a2d3?s=128&d=identicon&r=PG&f=1", "display_name": "Frost10000", "link": "https://stackoverflow.com/users/11610650/frost10000"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560362592, "post_id": 56567952, "comment_id": 99715189, "body": "Thanks @BigBen, still getting the same error though. &quot;Method &#39;Range&#39; of object &#39;_Global&#39; failed&quot;"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1560362688, "post_id": 56567952, "comment_id": 99715227, "body": "What&#39;s actually <i>in</i> the cells? <code>IsEmpty</code> isn&#39;t not working. Something else is wrong :)"}, {"owner": {"reputation": 19, "user_id": 11610650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53093886c10f50da7e8569db2d07a2d3?s=128&d=identicon&r=PG&f=1", "display_name": "Frost10000", "link": "https://stackoverflow.com/users/11610650/frost10000"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560362765, "post_id": 56567952, "comment_id": 99715271, "body": "@DavidZemens The cells vary from column, between text and numeric values, most of them are text."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1560362771, "post_id": 56567952, "comment_id": 99715277, "body": "Note also that <code>Range(Cells(rowNumberValue, colNum)...</code> is <b>not</b> qualified to a particular worksheet, so it refers to whatever worksheet is <i>active</i> at runtime."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560362823, "post_id": 56567952, "comment_id": 99715298, "body": "Put a breakpoint on your <code>If</code> statement and then evaluate <code>Range(Cells(rowNumberValue, colNum)).Value</code> in the Immediate pane of the VBE. Might also check <code>Len(Range(Cells(rowNumberValue, colNum)).Value)</code> as well."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 19, "user_id": 11610650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53093886c10f50da7e8569db2d07a2d3?s=128&d=identicon&r=PG&f=1", "display_name": "Frost10000", "link": "https://stackoverflow.com/users/11610650/frost10000"}, "edited": false, "score": 1, "creation_date": 1560363417, "post_id": 56568056, "comment_id": 99715560, "body": "@Frost10000 it&#39;s best practice to qualify which Worksheet the <code>Cells</code> or <code>Range</code> are on. In your case it looks like that&#39;s <code>Worksheets(&quot;Sheet1&quot;)</code>. That&#39;s what a previous <a href=\"https://stackoverflow.com/questions/56567952/using-isempty-and-merging-empty-cells#comment99715277_56567952\">comment</a> was getting at."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1560364083, "post_id": 56568056, "comment_id": 99715840, "body": "@BigBen  <b>You are correct !</b>  The code will profit by using <b><i>With</i></b> in the proper place."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1560362878, "creation_date": 1560362878, "answer_id": 56568056, "question_id": 56567952, "link": "https://stackoverflow.com/questions/56567952/using-isempty-and-merging-empty-cells/56568056#56568056", "title": "Using IsEmpty and Merging empty cells", "body": "<p>Replace tests like:</p>\n\n<pre><code>IsEmpty(Range(Cells(rowNumberValue, colNum))) = True\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>Cells(rowNumberValue, colNum) = \"\"\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11610650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53093886c10f50da7e8569db2d07a2d3?s=128&d=identicon&r=PG&f=1", "display_name": "Frost10000", "link": "https://stackoverflow.com/users/11610650/frost10000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 56568056, "answer_count": 1, "score": 0, "last_activity_date": 1560363572, "creation_date": 1560362332, "last_edit_date": 1560363572, "question_id": 56567952, "link": "https://stackoverflow.com/questions/56567952/using-isempty-and-merging-empty-cells", "title": "Using IsEmpty and Merging empty cells", "body": "<p>I'm writing code that searches through a very large excel sheet with a lot of duplicates, I can easily sort the duplicates together as they all have 1 matching column, and ID column. The thing that I am stuck on is why IsEmpty isn't working for looking at the current cell and seeing if it's empty and if the next cell (the duplicate) has data. Then the cell with data would merge over into the cell that's empty.</p>\n\n<p>I've tried using Range as the argument as well as cells to no avail.</p>\n\n<pre><code>Private Sub CountDuplicates()\nDim i As Integer\n\n'The cell it will use to search\nDim idCheck As Range\n\n'The cell it will use to compare text\nDim currentCell As Range\n\n'This will be used to format the \"Changes\" column\nDim rowNumberValue As Integer, columnNumberValue As Integer, rowBelow As Integer\nplacement = 0\ncolNum = 3\n\nrowNumberValue = ActiveCell.Row\ncolumnNumberValue = ActiveCell.Column\nrowBelow = ActiveCell.Row + 1\n\n'Searches by ID column\nFor Each idCheck In Worksheets(\"Sheet1\").Range(\"B2:B1000\")\n\n   'This checks to find duplicate ID rows\n   If idCheck.Value = idCheck.Offset(-1, 0).Value Then\n\n         'Goes from each column starting from the ID column (H = 7th letter in alphabet and H is the last column)\n         For colNum = 3 To 7\n\n            'Checks to see if the cell has no value but the duplicate does\n            If IsEmpty(Range(Cells(rowNumberValue, colNum))) = True And IsEmpty(Range(Cells(rowNumberValue + 1, colNum))) = False Then\n               Range(Cells(rowNumberValue, colNum), Cells(rowBelow, colNum)).Merge\n</code></pre>\n\n<p>So ideally, if a row has one cell missing data, but the other row has it, then merge/copy the data into the cell with missing data.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1560361710, "post_id": 56567714, "comment_id": 99714785, "body": "Can you explain what you mean by &quot;doesn&#39;t work&quot;? Error code, for example?"}, {"owner": {"reputation": 7, "user_id": 9734089, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dennis", "link": "https://stackoverflow.com/users/9734089/dennis"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560361799, "post_id": 56567714, "comment_id": 99714821, "body": "The error I get is &quot;Run time error &#39;1004&#39;: Application-defined or object-defined error&quot;. Since the sub does what it is supposed to do when a single column or multiple contiguous columns are given as the range for the columns to be hidden, I assume that there is some syntax error that I am not aware of, meaning that in my scenario for some reason it is not posisble to give a range of multiple, non-contiguous columns."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560362101, "post_id": 56567714, "comment_id": 99714958, "body": "Hmmm. <code>Range(&quot;D:E, G:H&quot;).EntireColumn.Hidden = True</code> works just fine in a blank workbook. What is the sheet like? And you can hide those columns manually without any problem?"}, {"owner": {"reputation": 7, "user_id": 9734089, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dennis", "link": "https://stackoverflow.com/users/9734089/dennis"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560363092, "post_id": 56567714, "comment_id": 99715412, "body": "I tried that again without the loop and it did not work either (though it did before), so then I just restarted excel and now the code I posted above works... Restarting excel seems to have done it and now I feel stupid for asking that question. Thank you anyway for your help."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560363146, "post_id": 56567714, "comment_id": 99715435, "body": "Eh no need to feel stupid. After all, you weren&#39;t sure about the syntax. The important thing is that the question is resolved."}], "answers": [{"comments": [{"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1560367899, "post_id": 56568058, "comment_id": 99717455, "body": "Nice work.  Dennis, pay attention to the indenting and style of this post."}], "tags": [], "owner": {"reputation": 21, "user_id": 11638501, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/25050e8e3531cf2074d70a4418e34087?s=128&d=identicon&r=PG", "display_name": "user11638501", "link": "https://stackoverflow.com/users/11638501/user11638501"}, "is_accepted": false, "score": 1, "last_activity_date": 1560362893, "creation_date": 1560362893, "answer_id": 56568058, "question_id": 56567714, "link": "https://stackoverflow.com/questions/56567714/looping-though-worksheets-hiding-non-contiguous-columns/56568058#56568058", "title": "Looping though Worksheets - Hiding non-contiguous columns", "body": "<p>There is no need for your <code>Else</code> statement if you have made all relevant columns visible beforehand.</p>\n\n<pre><code>Option Explicit\n\nSub HideColumns()\n    Dim i As Integer\n    Dim x As Integer\n\n    i = Worksheets.Count\n\n    For x = 1 To i\n\n        Worksheets(x).Range(\"A:AX\").EntireColumn.Hidden = False\n\n        If InStr(1, Worksheets(x).Range(\"A1\").Value, \"keyword\", 1) &lt;&gt; 0 Then\n            Worksheets(x).Range(\"D:E, G:H\").EntireColumn.Hidden = True\n        End If\n\n    Next x\n\nEnd Sub\n</code></pre>\n\n<p>Other than that small problem, our code works as expected.</p>\n"}], "owner": {"reputation": 7, "user_id": 9734089, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dennis", "link": "https://stackoverflow.com/users/9734089/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560410335, "creation_date": 1560361355, "last_edit_date": 1560410335, "question_id": 56567714, "link": "https://stackoverflow.com/questions/56567714/looping-though-worksheets-hiding-non-contiguous-columns", "title": "Looping though Worksheets - Hiding non-contiguous columns", "body": "<p>In a workbook I want to loop through all worksheets and depending on a keyword in a certain cell of each worksheet, I'd like to hide some non-contiguous columns in the respective worksheet.\nI have no problems hiding a single column or multiple, contiguous columns but it does not work when I set multiple, non-contiguous columns as my range.</p>\n\n<pre><code>Sub HideColumns()\n    Dim i As Integer\n    Dim x As Integer\n\n    i = Worksheets.Count\n\n    For x = 1 To i \n        Worksheets(x).Range(\"A:AX\").EntireColumn.Hidden = False\n        If InStr(1, Worksheets(x).Range(\"A1\").Value, \"keyword\", 1) &lt;&gt; 0 Then\n            Worksheets(x).Range(\"D:E, G:H\").EntireColumn.Hidden = True\n        Else: Worksheets(x).Range(\"A:AX\").EntireColumn.Hidden = False\n        End If\n    Next x \nEnd Sub\n</code></pre>\n\n<p>Can anyone tell me why this does not work?</p>\n\n<p>A workaround would, of course, be to add all the columns separately but I'd prefer to do it in the shorter way and of course, I'd like to understand more about VBA. I am a beginner with VBA, by the way.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1560360567, "post_id": 56567484, "comment_id": 99714254, "body": "Only the last <code>TestFunction</code> actually uses the <code>With....End With</code> properly. But I imagine you actually want something like <code>Function TestFunction(ws as Worksheet)...</code> and then perhaps a <code>With ws...End With</code> inside <code>TestFunction</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1560360611, "post_id": 56567484, "comment_id": 99714274, "body": "That said, I highly recommend a read of the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/with-statement\" rel=\"nofollow noreferrer\">documentation</a>."}, {"owner": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560360638, "post_id": 56567484, "comment_id": 99714284, "body": "That makes sense, thanks a bunch for the response!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1560360709, "post_id": 56567484, "comment_id": 99714331, "body": "Also, I&#39;d read up on <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/calling-sub-and-function-procedures\" rel=\"nofollow noreferrer\">how to pass arguments to functions</a> (also google around)"}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 2, "last_activity_date": 1560360743, "creation_date": 1560360743, "answer_id": 56567582, "question_id": 56567484, "link": "https://stackoverflow.com/questions/56567484/with-statements-following-into-functions/56567582#56567582", "title": "With Statements Following Into Functions", "body": "<p>Most proper (building on @BigBen's very correct comment):</p>\n\n<pre><code>Sub TestCase()  \n    'Integer variable to catch the return of the function\n    Dim somVar as Integer\n\n    'Call the function, pass the worksheet. \n    somVar = TestFunction(ThisWorkbook.Worksheets(\"TestWorksheet\"))  \n\n    'Do something with the return\n    Debug.print somVar\nEnd Sub\n\nFunction TestFunction(ws as Worksheet) As Integer\n  Dim I As Integer  \n  I = ws.cells(1,1) \n\n  'Return the integer to the caller \n  TestFunction = I\nEnd function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 3, "last_activity_date": 1560360827, "creation_date": 1560360827, "answer_id": 56567600, "question_id": 56567484, "link": "https://stackoverflow.com/questions/56567484/with-statements-following-into-functions/56567600#56567600", "title": "With Statements Following Into Functions", "body": "<p>Unfortunately, <code>With</code> statements do not follow to called functions.  For that functionality, you'd need to pass an argument to the function.  Here's an example that replicates your provided psuedo-code in a valid manner:</p>\n\n<pre><code>Sub TestCase()\n\n    MsgBox TestFunction(ThisWorkbook.Worksheets(\"TestWorksheet\"))\n\nEnd Sub\n\nFunction TestFunction(ByRef ws As Worksheet) As Double\n\n    With ws\n        TestFunction = Val(.Cells(1, 1).Value)\n    End With\n\nEnd Function\n</code></pre>\n\n<p>Note that the Sub is calling the Function and passing the argument which is a worksheet object.  Then in the function you can use the <code>With</code> statement on the passed argument.</p>\n"}], "owner": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 56567600, "answer_count": 2, "score": 1, "last_activity_date": 1560360827, "creation_date": 1560360253, "question_id": 56567484, "link": "https://stackoverflow.com/questions/56567484/with-statements-following-into-functions", "title": "With Statements Following Into Functions", "body": "<p>I am in the middle of switching my code over from using .active and .select to something more reliable at the recommendation of the internet. I was wondering about the functionality of with statements, and if they follow into a created function. </p>\n\n<pre><code>'---Which way is more proper? \n'1.\nSub TestCase()\n  With ThisWorkbook.Worksheets(\"TestWorksheet\")\n    TestFunction()\n  End With\nEnd Sub\n\nFunction TestFunction()As Integer\n  Dim I As Integer\n  I = .cells(1,1)\nEnd function\n'--2.\nSub TestCase()\n  With ThisWorkbook.Worksheets(\"TestWorksheet\")\n    TestFunction()\n  End With\nEnd Sub\n\nFunction TestFunction()As Integer\n  Dim I As Integer\n  With ThisWorkbook.Worksheets(\"TestWorksheet\")\n    I = .cells(1,1)\n  End With \nEnd function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1560358675, "creation_date": 1560358675, "answer_id": 56567097, "question_id": 56566787, "link": "https://stackoverflow.com/questions/56566787/vba-prevent-text-overflow-for-cells-in-range/56567097#56567097", "title": "VBA Prevent Text Overflow for Cells in Range", "body": "<p>There are at least <strong>3</strong> ways:</p>\n\n<ol>\n<li>use VBA to widen the column</li>\n<li>use VBA to enable text wrap on the cells</li>\n<li>use VBA to place content to the immediate right of the cells in question</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": -1, "last_activity_date": 1561266851, "last_edit_date": 1561266851, "creation_date": 1560367423, "answer_id": 56569088, "question_id": 56566787, "link": "https://stackoverflow.com/questions/56566787/vba-prevent-text-overflow-for-cells-in-range/56569088#56569088", "title": "VBA Prevent Text Overflow for Cells in Range", "body": "<ol start=\"4\">\n<li>use VBA to put the horizontal alignment to xlFill</li>\n</ol>\n"}], "owner": {"reputation": 430, "user_id": 8322075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1525dfaae144b4cdc881a33c52e30abd?s=128&d=identicon&r=PG&f=1", "display_name": "taurus", "link": "https://stackoverflow.com/users/8322075/taurus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561266851, "creation_date": 1560357234, "question_id": 56566787, "link": "https://stackoverflow.com/questions/56566787/vba-prevent-text-overflow-for-cells-in-range", "title": "VBA Prevent Text Overflow for Cells in Range", "body": "<p>Is there a way to prevent text overflow for cells within a specified range using VBA? I haven't been able to find anything online relating to this problem.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1560356146, "post_id": 56566450, "comment_id": 99712303, "body": "You probably need something like <code>L_Found.Offset(1).formula = &quot;=sum(&quot; &amp; L_Found.address &amp; &quot;:&quot; &amp; R_Found.address &amp; &quot;)&quot;</code> The offset is the cell below L_Found."}, {"owner": {"reputation": 21, "user_id": 11476439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff33180e99cd47415ad4ae73252f7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne_Chen", "link": "https://stackoverflow.com/users/11476439/wayne-chen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560359641, "post_id": 56566450, "comment_id": 99713892, "body": "I can confirm the .address function fixes the problem of calling the variable within the formula. However, I still have trouble incrementing the found cell. Since the cell (L_Found and R_Found) are stored as range variables, the offset command does not work. I am actually trying to increment first and reassigning the range variable before referencing it in my sum formula. When I use offset, it actually increments the value of the cell itself, not the cell address."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560361164, "post_id": 56566450, "comment_id": 99714525, "body": "No, <code>Find</code> returns a <code>Range</code> object and <code>Offset</code> is one of its properties. <code>Range(&quot;A1&quot;).Offset(1)</code> is <code>Range(&quot;A2&quot;)</code>, the cell below, it does not add 1 to the value."}, {"owner": {"reputation": 21, "user_id": 11476439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff33180e99cd47415ad4ae73252f7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne_Chen", "link": "https://stackoverflow.com/users/11476439/wayne-chen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560365143, "post_id": 56566450, "comment_id": 99716278, "body": "Yes, my mistake. I don&#39; have much experience with obj. variables. Here is what I have right now. I feel like this should work, but it isn&#39;t.                               L_Found = L_Found.Offset(1, 0)     R_Found = R_Found.Offset(1, 0)                                              Range(&quot;E9&quot;).forumla = &quot;=sum(&quot; &amp; L_Found.Address &amp; &quot;:&quot; &amp; R_Found.Address &amp; &quot;)&quot;"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560365705, "post_id": 56566450, "comment_id": 99716507, "body": "You must always use <code>Set</code> when assigning object variables (as you have in your code above)."}, {"owner": {"reputation": 21, "user_id": 11476439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff33180e99cd47415ad4ae73252f7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne_Chen", "link": "https://stackoverflow.com/users/11476439/wayne-chen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560370677, "post_id": 56566450, "comment_id": 99718667, "body": "I have changed it to use &#39;&#39;&#39;SET&#39;&#39;&#39; but it is still giving me an error. I have updated the code above to reflect new changes."}, {"owner": {"reputation": 21, "user_id": 11476439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff33180e99cd47415ad4ae73252f7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne_Chen", "link": "https://stackoverflow.com/users/11476439/wayne-chen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560446470, "post_id": 56566450, "comment_id": 99749210, "body": "Hey @SJR, would love your feedback when you get the chance. Thanks."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560446564, "post_id": 56566450, "comment_id": 99749260, "body": "OK, which line errors and what is the error message?"}, {"owner": {"reputation": 21, "user_id": 11476439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff33180e99cd47415ad4ae73252f7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne_Chen", "link": "https://stackoverflow.com/users/11476439/wayne-chen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560447779, "post_id": 56566450, "comment_id": 99749821, "body": "From the code above, I am having trouble with this line: Range(&quot;E9&quot;) = &quot;=sum(&quot; &amp; L_Found.Address &amp; &quot;:&quot; &amp; R_Found.Address &amp; &quot;)&quot;. The error message that I get is as follows: Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560447902, "post_id": 56566450, "comment_id": 99749876, "body": "So what are the values of <code>L_Found.Address</code> and <code>R_Found.Address</code>?"}, {"owner": {"reputation": 21, "user_id": 11476439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff33180e99cd47415ad4ae73252f7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne_Chen", "link": "https://stackoverflow.com/users/11476439/wayne-chen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560448012, "post_id": 56566450, "comment_id": 99749919, "body": "I was hoping to extract the cell address of L_found and R_found and use it in the sum formula. They are defined as range objects so I am assuming I can&#39;t do it the same way as a non-object variable."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560448059, "post_id": 56566450, "comment_id": 99749941, "body": "What I mean is, what are the addresses? Set a breakpoint on that line and hover over the expressions and you should see the value."}, {"owner": {"reputation": 21, "user_id": 11476439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff33180e99cd47415ad4ae73252f7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne_Chen", "link": "https://stackoverflow.com/users/11476439/wayne-chen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560448385, "post_id": 56566450, "comment_id": 99750075, "body": "I am using L_Found.address(0,0) and R_Found.address(0,0) and it returns H9 and K9. Column H and column K will change depending on the user input but row 9 is fixed"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560448945, "post_id": 56566450, "comment_id": 99750312, "body": "It should be <code>Range(&quot;E9&quot;).formula....</code> but doubt that would cause an error and am rather mystified by that."}, {"owner": {"reputation": 21, "user_id": 11476439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff33180e99cd47415ad4ae73252f7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne_Chen", "link": "https://stackoverflow.com/users/11476439/wayne-chen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560449299, "post_id": 56566450, "comment_id": 99750476, "body": "Yes, I do have range(&quot;E9&quot;).formula. Now sure why it was missing form the code above. Do you have any suggestions?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560449366, "post_id": 56566450, "comment_id": 99750503, "body": "What happens if you try just this line <code>Range(&quot;E9&quot;).Formula = &quot;=sum(H9:K9)&quot;</code>?"}, {"owner": {"reputation": 21, "user_id": 11476439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff33180e99cd47415ad4ae73252f7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne_Chen", "link": "https://stackoverflow.com/users/11476439/wayne-chen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560450159, "post_id": 56566450, "comment_id": 99750879, "body": "Yes, but like I said, H9 and K9 are from the user. I need to store the date they specify, find it within a data range, offset it, and then convert it back to a form that can be referenced within the formula. I can&#39;t hard code it."}, {"owner": {"reputation": 21, "user_id": 11476439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff33180e99cd47415ad4ae73252f7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne_Chen", "link": "https://stackoverflow.com/users/11476439/wayne-chen"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560519865, "post_id": 56566450, "comment_id": 99774819, "body": "@SJR, I solved it. I misspelled .formula .... I know...."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560522084, "post_id": 56566450, "comment_id": 99775988, "body": "It&#39;s a bit irritating to find that you are not using code as posted."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11476439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff33180e99cd47415ad4ae73252f7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne_Chen", "link": "https://stackoverflow.com/users/11476439/wayne-chen"}, "edited": false, "score": 0, "creation_date": 1560363445, "post_id": 56567744, "comment_id": 99715570, "body": "I just tried this solution. VB Editor gives me a Run-time error 1004 - Method &#39;Range&#39; of Object&#39; _Global&quot; Failed error."}], "tags": [], "owner": {"reputation": 1, "user_id": 11638382, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b735dc3df99938b75aa1e7a4c20a08d1?s=128&d=identicon&r=PG", "display_name": "user11638382", "link": "https://stackoverflow.com/users/11638382/user11638382"}, "is_accepted": false, "score": 0, "last_activity_date": 1560361478, "creation_date": 1560361478, "answer_id": 56567744, "question_id": 56566450, "link": "https://stackoverflow.com/questions/56566450/how-to-reference-object-variable-in-vba-formula/56567744#56567744", "title": "How to Reference Object Variable in VBA Formula?", "body": "<p>You need a string that looks like a cell range reference. This can be generated with the Address property.</p>\n\n<p>You also need to offset the range that generates that address. Use the Offset function before retrieving the Address.</p>\n\n<pre><code>Range(\"E9\").forumla = _\n  \"=sum(\" &amp; Range(L_Found, R_Found).Offset(1, 0).Address(0, 0) &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11476439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff33180e99cd47415ad4ae73252f7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne_Chen", "link": "https://stackoverflow.com/users/11476439/wayne-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1560449242, "creation_date": 1560355957, "last_edit_date": 1560449242, "question_id": 56566450, "link": "https://stackoverflow.com/questions/56566450/how-to-reference-object-variable-in-vba-formula", "title": "How to Reference Object Variable in VBA Formula?", "body": "<p>I have a sub that gets the user input for 2 dates that acts as the lower and upper bound of a range defined as <code>DateRange</code>. I would like to find the cell address for the 2 dates, increment the cell reference by 1 row and use it to calculate the sum of all corresponding values that falls underneath the 2 dates found. </p>\n\n<p>I don't have much experience with object variable manipulation. Here is the problems I am having:</p>\n\n<ol>\n<li>Increment the <code>L_Range</code> and <code>R_Range</code> by 1 row </li>\n<li>Using <code>L_Found</code> and <code>R_Found</code> inside a formula for sum</li>\n</ol>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub CustomIntervals()\n    'User Input\n    Dim L_Bound As Date\n    Dim R_Bound As Date\n    'Contains Found Cell Reference for L_Bound and R_Bound\n    Dim L_Found As Range\n    Dim R_Found As Range\n    'Defining Range that will be Searched\n    Dim DateRange As Range\n\n    Set DateRange = Range(\"H8\", Range(\"H8\").End(xlToRight))\n\n    L_Bound = InputBox(\"Enter Lower Bound Date (mm/dd/yyyy)\", \"Custom Date\")\n    R_Bound = InputBox(\"Enter Upper Bound Date (mm/dd/yyyy)\", \"Custom Date\")\n\n    Range(\"H8\", Range(\"H8\").End(xlToRight)).NumberFormat = \"d-mmm\"\n\n    Set L_Found = DateRange.Find(L_Bound)\n    Set R_Found = DateRange.Find(R_Bound)\n\n    Set L_Found = L_Found.Offset(1, 0)\n    Set R_Found = R_Found.Offset(1, 0)\n\n    Range(\"E9\").Formula = \"=sum(\" &amp; L_Found.Address &amp; \":\" &amp; R_Found.Address &amp; \")\"\n    Range(\"E9\").Select\n    ActiveCell.AutoFill Destination:=Range(\"E9:E15\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1560355393, "post_id": 56566207, "comment_id": 99711913, "body": "Not sure what you&#39;re doing, but it should be <code>Set tempCell = cell</code> without the Select."}, {"owner": {"reputation": 9, "user_id": 10864148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-liIiu0_ovIc/AAAAAAAAAAI/AAAAAAAAAXc/5d0R_lQOVpI/photo.jpg?sz=128", "display_name": "misal patel", "link": "https://stackoverflow.com/users/10864148/misal-patel"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560355796, "post_id": 56566207, "comment_id": 99712119, "body": "I tried. Still the same error. I will add more comments to the code to make it clearer."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1560356218, "post_id": 56566207, "comment_id": 99712343, "body": "On the same line? You need to get rid of all the Selects."}, {"owner": {"reputation": 9, "user_id": 10864148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-liIiu0_ovIc/AAAAAAAAAAI/AAAAAAAAAXc/5d0R_lQOVpI/photo.jpg?sz=128", "display_name": "misal patel", "link": "https://stackoverflow.com/users/10864148/misal-patel"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560359419, "post_id": 56566207, "comment_id": 99713794, "body": "Ohhh I forgot to remove select from the bottom statement. This worked.  Removing select from   Set tempCell = cell.Select  and Set rgSearch1 = Range(tempCell, cell).Select  solved it."}], "owner": {"reputation": 9, "user_id": 10864148, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-liIiu0_ovIc/AAAAAAAAAAI/AAAAAAAAAXc/5d0R_lQOVpI/photo.jpg?sz=128", "display_name": "misal patel", "link": "https://stackoverflow.com/users/10864148/misal-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560357436, "creation_date": 1560355048, "last_edit_date": 1560357436, "question_id": 56566207, "link": "https://stackoverflow.com/questions/56566207/object-required-error-when-setting-range-from-two-cells", "title": "Object required error when setting range from two cells", "body": "<p>I am trying to convert a text file to Excel sheet. I have to remove some data elements and copy some data elements to several columns. To remove some data, I have to look for a certain String (RUN). After I have that address, I have to search for the next RUN. Inside those two String range, I have to search for another String (NET) and remove it. I have to do it throughout the datasheet since this is frequent. </p>\n\n<p>Here is the code I am trying to use.</p>\n\n<pre><code>Dim name As String: name = \"RUN\"\nDim secondName As String: secondName = \"NET\"\n\nDim rgSearch As Range\n' set the range to entire sheet\nSet rgSearch = Range(Cells.Address)\n\nDim rgSearch1 As Range\n\n\nDim cell As Range\n'search for first occurrence of RUN\nSet cell = rgSearch.Find(name)\nDim tempCell As Range\n\n\n' If not found then exit\nIf cell Is Nothing Then\n    Debug.Print \"Not found\"\n    Exit Sub\nEnd If\n\n' Store first cell address\nDim firstCellAddress As String, firstRow As Integer, secondRow As Integer\n'store address of first result\nfirstCellAddress = cell.Address\nsecondRow = cell.Row\n\n\nDo\n    'save range to another range for next iteration\n    Set tempCell = cell.Select\n    'row variables are for alternate solution I tried\n    firstRow = secondRow\n    Debug.Print \"Found: \" &amp; cell.Address\n    ' search for next instance\n    Set cell = rgSearch.FindNext(cell)\n    ,set next instance\n    secondRow = cell.Row\n\n    Set rgSearch1 = Range(tempCell, cell).Select\n\n\nLoop While firstCellAddress &lt;&gt; cell.Address\n</code></pre>\n\n<p>I have also tried using</p>\n\n<pre><code>Set rgSearch1 = Range(\"B\" &amp; firstRow + 1 &amp; \":B\" &amp; secondRow - 1).Select\n</code></pre>\n\n<p>instead of putting cells inside the range but I get the same result. That is why those firstRow, secondRow variables are there.</p>\n\n<p>With both ideas, I am getting Object Required error. Could someone please show me what I am doing wrong?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5990345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e6e29f0b24157726b83d91f1cf2606e?s=128&d=identicon&r=PG&f=1", "display_name": "pmgibs", "link": "https://stackoverflow.com/users/5990345/pmgibs"}, "edited": false, "score": 0, "creation_date": 1560434691, "post_id": 56571690, "comment_id": 99742547, "body": "Thanks Tim. But, I am getting a compiling error when I use the above code. I amended the names to fit my worksheet, but still doesn&#39;t work. I found a way that works using cell.forumla = Replace function though.  Thanks again for your help."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1560383307, "creation_date": 1560383307, "answer_id": 56571690, "question_id": 56566177, "link": "https://stackoverflow.com/questions/56566177/is-there-a-way-to-substitute-a-value-in-a-formula-using-a-userform/56571690#56571690", "title": "Is there a way to substitute a value in a formula using a UserForm?", "body": "<p>Your best approach would be to create sheet-scoped names which you then use in your formulas: your userform can then change the \"refersto\" values for those names to the user-supplied values.  </p>\n\n<p>Eg:</p>\n\n<pre><code>With ActiveSheet\n    .Names(\"FOO\").RefersTo = txtName1.Value\n    .Names(\"BAR\").RefersTo = txtName2.Value\nEnd With\n</code></pre>\n\n<p>On your sheet:</p>\n\n<pre><code>=FOO/BAR\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 5990345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e6e29f0b24157726b83d91f1cf2606e?s=128&d=identicon&r=PG&f=1", "display_name": "pmgibs", "link": "https://stackoverflow.com/users/5990345/pmgibs"}, "is_accepted": true, "score": 0, "last_activity_date": 1560434878, "creation_date": 1560434878, "answer_id": 56582377, "question_id": 56566177, "link": "https://stackoverflow.com/questions/56566177/is-there-a-way-to-substitute-a-value-in-a-formula-using-a-userform/56582377#56582377", "title": "Is there a way to substitute a value in a formula using a UserForm?", "body": "<p>Found this solution to my question:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim cell As Range\nFor Each cell In Range(\"I2:HM2\")\ncell.Formula = Replace(cell.Formula, \"100,\", TextBox4.Value + \",\")\ncell.Formula = Replace(cell.Formula, \"260000000000,\", TextBox5.Value + \",\")\nNext cell\nEnd Sub\n</code></pre>\n\n<p>I would need to repeat this format for all the values I would want to change per department.</p>\n"}], "owner": {"reputation": 37, "user_id": 5990345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e6e29f0b24157726b83d91f1cf2606e?s=128&d=identicon&r=PG&f=1", "display_name": "pmgibs", "link": "https://stackoverflow.com/users/5990345/pmgibs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 56582377, "answer_count": 2, "score": -1, "last_activity_date": 1560434878, "creation_date": 1560354932, "last_edit_date": 1560410406, "question_id": 56566177, "link": "https://stackoverflow.com/questions/56566177/is-there-a-way-to-substitute-a-value-in-a-formula-using-a-userform", "title": "Is there a way to substitute a value in a formula using a UserForm?", "body": "<p>I have a very long formula in columns I2:HM13 that contains values that need to change depending on what department uses the worksheet and these values may change over the course of the year. This formula repeats in all cells within the stated range with only the reference column/row changing. I would like to create a UserForm were the end user can input the values specific to their department in textboxes and click a commandbutton and the values in the textboxes get inserted into the formula.</p>\n\n<p>I have tried some find and replace codes, but nothing I have tried has work at all. Below is the formula I am trying to modify.</p>\n\n<p><code>=IF($H2=\"No\",\"\",IF(($B2-I$1)&lt;100,\"\",IF(((($B2-I$1)*$C2)*1000000)&lt;260000000000,\"\",IF(((I$1*$C2)*1000000)&lt;330000000000,\"\",IF(AND(($B2-I$1)&gt;=200,($B2-I$1)&lt;=800,((($B2-I$1)*$C2)*1000000)&gt;=620000000000,((($B2-I$1)*$C2)*1000000)&lt;=920000000000,I$1&gt;=375,I$1&lt;=420,((I$1*$C2)*1000000)&gt;=680000000000,((I$1*$C2)*1000000)&lt;=790000000000,$C2&gt;=1300,$C2&lt;=2100),1)))))</code></p>\n\n<p>The above is a small portion of the formula of interest. The values I am trying to changed based on the textbox inputs are all the values after the less than, less than or equal to, greater than, or greater than or equal to symbols.</p>\n\n<p>For example in textbox 1 the user inputs 150, 150 would then replace all \"100\" in the formula. If the user inputs 270000000000 in textbox 2, all the \"260000000000\" would be replaced with 270000000000.</p>\n"}, {"tags": ["excel", "vba", "lotusscript"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11637777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/900d560680f2b884e00b5edffbdaf184?s=128&d=identicon&r=PG", "display_name": "Joesse", "link": "https://stackoverflow.com/users/11637777/joesse"}, "edited": false, "score": 1, "creation_date": 1560410740, "post_id": 56566602, "comment_id": 99728752, "body": "Thank you, that was it. And leaving out trailing emtpy arguments works."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1560356576, "creation_date": 1560356576, "answer_id": 56566602, "question_id": 56566042, "link": "https://stackoverflow.com/questions/56566042/excel-runtime-error-unable-to-get-the-add-property-of-the-oleobjects-class/56566602#56566602", "title": "Excel Runtime Error &quot;Unable to get the add property of the OLEObjects class&quot;", "body": "<p>Don't pass an empty string if you mean to \"skip\" an optional parameter: the function is receiving the empty string and attempting to run with it.</p>\n\n<p>Instead, <em>skip</em> them - placeholder arguments would look like this:</p>\n\n<pre><code>Set oleObj = OLEObjs.Add(, tempdir + \"\\\" + pdfname, False, True, , , pdfname, , , , )\n</code></pre>\n\n<blockquote>\n  <p><em>Not sure if I might leave out trailing optional arguments.</em></p>\n</blockquote>\n\n<p>I don't know LotusScript, but it's worth a shot. This is legal in VBA, and exactly equivalent to the above:</p>\n\n<pre><code>Set oleObj = OLEObjs.Add(, tempdir + \"\\\" + pdfname, False, True, , , pdfname)\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11637777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/900d560680f2b884e00b5edffbdaf184?s=128&d=identicon&r=PG", "display_name": "Joesse", "link": "https://stackoverflow.com/users/11637777/joesse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 56566602, "answer_count": 1, "score": 3, "last_activity_date": 1560356576, "creation_date": 1560354436, "question_id": 56566042, "link": "https://stackoverflow.com/questions/56566042/excel-runtime-error-unable-to-get-the-add-property-of-the-oleobjects-class", "title": "Excel Runtime Error &quot;Unable to get the add property of the OLEObjects class&quot;", "body": "<p>I am creating a LotusScript script which creates an Excel file with embedded objects. But when I come to actually embed the PDF file I get \"Unable to get the Add property of the OLEObjects class\".\nUnfortunately Lotusscript can't deal with named arguments, so I have to hand over all arguments in the correct order. Not sure if I might leave out trailing optional arguments.</p>\n\n<pre><code>tempdir = \"c:\\data\\temp\"\npdfname = \"20140826-32051-1890459257-300-421425-GRF.pdf\"\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.Workbooks.Add\nSet xlsheet = xlApp.Workbooks(1).Worksheets(1)\nSet oleObjs = xlsheet.OLEObjects\nSet oleObj = OLEObjs.Add(\"\", tempdir + \"\\\" + pdfname, False, _\nTrue, \"\", \"\", pdfname, _\n\"\",\"\",\"\",\"\")\n'Arguments: ClassType, FileName, Link,\n'DisplayAsIcon, IconFileName, IconIndex, IconLabel,\n'Left, Top, Width, Height\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1560353844, "post_id": 56565737, "comment_id": 99711066, "body": "<code>Arr</code> is a 2 dimensional array, there is no automatic way to represent this as a string to show a user.  If you want a string you need to loop over the array (or <code>rs</code> directly) and build you own."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1560354573, "post_id": 56565737, "comment_id": 99711460, "body": "Also <code>Trazabilidad</code> should be <code>&quot;Trazabilidad&quot;</code>. Your <code>MsgBox</code> will have <code>0</code> for a title otherwise. Put <code>Option Explicit</code> at the top of the module, and declare every variable you&#39;re using."}, {"owner": {"reputation": 1, "user_id": 9997403, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-M_0-Rggq1UM/AAAAAAAAAAI/AAAAAAAAAfo/hdRLgcLUB9s/photo.jpg?sz=128", "display_name": "David Olvera", "link": "https://stackoverflow.com/users/9997403/david-olvera"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1560357380, "post_id": 56565737, "comment_id": 99712863, "body": "@AlexK. and what other options exist if it isn&#39;t a string? I&#39;m really new to VBA and don&#39;t know very well the lenguaje."}], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 6570713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SrIS2.jpg?s=128&g=1", "display_name": "Alvaro CC", "link": "https://stackoverflow.com/users/6570713/alvaro-cc"}, "is_accepted": false, "score": 1, "last_activity_date": 1560354775, "last_edit_date": 1560354775, "creation_date": 1560354720, "answer_id": 56566125, "question_id": 56565737, "link": "https://stackoverflow.com/questions/56565737/showing-a-database-extracted-array-in-a-message-box/56566125#56566125", "title": "Showing a database extracted array in a message box", "body": "<p><a href=\"https://stackoverflow.com/questions/56565737/showing-a-database-extracted-array-in-a-messagebox#comment99711066_56565737\">@Alex K. is right</a> saying a good solution is to loop over the recordset.</p>\n\n<p>But you may also find useful to copy the data to a sheet and then work over it using this code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>mysheet.Range(\"A2\").CopyFromRecordset rs\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9997403, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-M_0-Rggq1UM/AAAAAAAAAAI/AAAAAAAAAfo/hdRLgcLUB9s/photo.jpg?sz=128", "display_name": "David Olvera", "link": "https://stackoverflow.com/users/9997403/david-olvera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560368560, "creation_date": 1560353403, "last_edit_date": 1560368560, "question_id": 56565737, "link": "https://stackoverflow.com/questions/56565737/showing-a-database-extracted-array-in-a-message-box", "title": "Showing a database extracted array in a message box", "body": "<p>I need to show a group of records from an Access database in a message box or any form that is only for view without adding sheets to the workbook.</p>\n\n<p>The information is divided into 9 fields, and are up to 15 rows per entry. I've tried several forms of showing the information, but they don't work, or add another sheet to the workbook. The environment where the workbook is used is only for data and printing capture. Apparently, I already have covered the database connection, the only issue is the display of the information.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Srch_Click()\n Dim A As Object, rs As Object, sSQL As String, CN As String, Arr As Variant, FL As Long, txt As String, i As Long\n FL = tbFolio.Value - 1\n    Set A = CreateObject(\"ADODB.Connection\")\n    CN = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n        \"Data Source=S:\\Common\\Quality\\RASTREABILIDAD\\MAIN PROJECT\\PROYECTO KOREANO MX.accdb;\"\n    sSQL = \"SELECT * FROM Trazabilidad WHERE Folio = \" &amp; (FL) &amp; \";\"\n    A.Open CN\n    Set rs = A.Execute(sSQL)\n    Arr = rs.GetRows\n    MsgBox Arr, vbOKOnly, Trazabilidad\n\n    rs.Close\n    A.Close\nUnload Me\nEnd Sub\n</code></pre>\n\n<p>In the debugging, the highlighted section of the code is this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>MsgBox Arr, vbOKOnly, Trazabilidad\n</code></pre>\n\n<p>The error message is </p>\n\n<blockquote>\n  <p>\"Error '13': Type mismatch\"</p>\n</blockquote>\n\n<p>I've been breaking my mind over how to do it, and I would appreciate any help.\nThanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560353509, "post_id": 56565690, "comment_id": 99710869, "body": "Probably the <code>n+1</code> is throwing the error, because you&#39;ve let <code>n</code> have a maximum value of the <code>arr</code>&#39;s upper bound, so <code>arr(x, n+1)</code> is by definition out of range."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1560353635, "post_id": 56565690, "comment_id": 99710962, "body": "So I&#39;m guessing you have the original data in one order and then you want to fill another table with the same elements from the original in a different order?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560353808, "post_id": 56565690, "comment_id": 99711055, "body": "FWIW, row/column iteration like this seems unnecessary. Let me tinker on an alternative solution."}, {"owner": {"reputation": 235, "user_id": 5374245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fecb475bd50e5fe9c608cbba5bd767bf?s=128&d=identicon&r=PG&f=1", "display_name": "ChartProblems", "link": "https://stackoverflow.com/users/5374245/chartproblems"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560353907, "post_id": 56565690, "comment_id": 99711090, "body": "Hi. This macro is used in a larger context to transfer data from one workbook to another (It is sort of an update type sub). @David Zemens: I understand your point and would appreciate if you can suggest how to revise the macro."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560353998, "post_id": 56565690, "comment_id": 99711140, "body": "I&#39;ll leave it to @DavidZemens then, this is easy to  code with a dictionary indexing the position of every identifier inside the array."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 2, "last_activity_date": 1560356163, "last_edit_date": 1560356163, "creation_date": 1560354564, "answer_id": 56566078, "question_id": 56565690, "link": "https://stackoverflow.com/questions/56565690/printing-values-from-a-multidimensional-array/56566078#56566078", "title": "Printing values from a multidimensional array", "body": "<p>This should handle it, assuming unique labels in the first columns:</p>\n\n<pre><code>Dim data As Object\nDim r As Range\nDim thisName As String\nDim thisData As Range\nSet data = CreateObject(\"Scripting.Dictionary\")\n\n\nWith ThisWorkbook.Sheets(\"Sheet1\")\n    ' Store each row in our Dictionary with key=item name, value=row values\n    For Each r In .Range(\"ARRAY_DIM\").Rows\n        Set data(r.Cells(1).Value) = r.Resize(1, r.Columns.Count - 1).Offset(0, 1)\n    Next\nEnd With\n\nWith ThisWorkbook.Sheets(\"Sheet2\")\n    For Each r In .Range(\"OUTPUT\").Columns(1).Cells\n        thisName = r.Cells(1).Value\n        ' Check if thisName exists in our Dictionary\n        If data.Exists(thisName) Then\n            ' Dump the data into the row if it exists\n            Set thisData = data(thisName)\n            r.Offset(0, 1).Resize(1, thisData.Columns.Count).Value = thisData.Value\n        End If\n    Next\nEnd With\n</code></pre>\n\n<p>But I think that can be further simplified to a single loop:</p>\n\n<pre><code>Dim r As Range\nDim thisName As String\nDim thisData As Range\nDim outputRow As Variant\nDim outputRange as Range\nSet outputRange = ThisWorkbook.Sheets(\"Sheet2\").Range(\"OUTPUT\")\nWith ThisWorkbook.Sheets(\"Sheet1\").Range(\"ARRAY_DIM\")\n    For Each r In .Rows\n        thisName = r.Cells(1).Value\n        ' Check whether thisName exists in outputRange\n        outputRow = Application.Match(thisName, outputRange, False)\n        If Not IsError(outputRow) Then\n            ' Dump this row's Values to the outputRange\n            outputRange.Rows(outputRow).Value = r.Value\n        End If\n    Next\nEnd With\n</code></pre>\n\n<p>NB: Neither of the above approaches will <em>add</em> a new row if the <code>thisName</code> isn't found in the OUTPUT range.</p>\n"}], "owner": {"reputation": 235, "user_id": 5374245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fecb475bd50e5fe9c608cbba5bd767bf?s=128&d=identicon&r=PG&f=1", "display_name": "ChartProblems", "link": "https://stackoverflow.com/users/5374245/chartproblems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560356163, "creation_date": 1560353190, "question_id": 56565690, "link": "https://stackoverflow.com/questions/56565690/printing-values-from-a-multidimensional-array", "title": "Printing values from a multidimensional array", "body": "<p>I have a block of data which I define as a range (\"ARRAY_DIM\") in excel. The range includes a lot of data but also have many rows and columns with no data at all. Below is an example of the defined range. Please note that the number of data columns for each identifier varies which is why the ARRAY_DIM is defined with +100 columns (of which only few rows will contain data).</p>\n\n<pre><code>Banana  10  20  30  40  50  70\nParrot  5       1   4   30\nApple   3   3   5   6       20\nCar     10  20  30  40  30\nDonkey  4   12  3   0   4   5\nCoconut     10      4   0   1\n</code></pre>\n\n<p>I am inserting all of this data into an array such that I can loop through a list of relevant identifiers and then paste the data associated with the identifiers in the adjacent cells (same row). See below for a simplified example of identifiers (first column is a range defined as \"OUTPUT\") and where I intend to paste the relevant data for identifiers that are included in the array.</p>\n\n<pre><code>Banana  10  20  30  40  50  70\nSHARK \nApple   3   3   5   6       20\nAirplane\n</code></pre>\n\n<p>I am having troubles with accomplishing this task based on the code below. It works fine for the first row/identifier but then I get an error \"Subscript out of range\" at the .Cells output line. I would appreciate if someone can review the code and maybe point out any errors.</p>\n\n<pre><code>Sub test()\n\nDim arr As Variant\nDim cell As Range\n\nWith ThisWorkbook.Sheets(\"Sheet1\")\n    arr = .Range(\"ARRAY_DIM\")\nEnd With\n\nWith ThisWorkbook.Sheets(\"Sheet2\")\n    For Each cell In .Range(\"OUTPUT\")\n        For x = LBound(arr, 1) To UBound(arr, 1)\n            If arr(x, 1) = cell.Value Then\n                For n = LBound(arr, 1) To UBound(arr, 1)\n                    .Cells(cell.Row, n + 2) = arr(x, n + 1)\n                Next n\n            End If\n        Next x\n    Next cell\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1560352821, "post_id": 56565544, "comment_id": 99710450, "body": "Proper <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indentation</a> would show you you&#39;re missing a <code>Wend</code> for the second <code>While</code> loop."}, {"owner": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1560352961, "post_id": 56565544, "comment_id": 99710527, "body": "I messed up and forgot to copy that over originally. That is there in my code, am I calling the data correctly with .cells?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1560353125, "post_id": 56565544, "comment_id": 99710634, "body": "You&#39;re also missing a <code>Then</code> in <code>If (ChooseM = &quot;8&quot;)</code>."}, {"owner": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560353193, "post_id": 56565544, "comment_id": 99710682, "body": "Ah, thank you for your help! I just kept skipping over it."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1560355058, "post_id": 56565544, "comment_id": 99711738, "body": "Like @BigBen said, proper indentation will help reduce those kind of issues just like <code>Option Explicit</code> will help with other issues"}, {"owner": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "edited": false, "score": 0, "creation_date": 1560359785, "post_id": 56565544, "comment_id": 99713937, "body": "Yeah, I&#39;m new to vba and I usually indent after I finish the code, I guess that I should get into the habit of indenting as I go so that I don&#39;t have to worry about it at the end."}], "owner": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560352932, "creation_date": 1560352700, "last_edit_date": 1560352932, "question_id": 56565544, "link": "https://stackoverflow.com/questions/56565544/grabbing-data-from-workbook-with-compiler-error", "title": "Grabbing Data From Workbook With Compiler Error", "body": "<p>Compiler Error: End With Has No With. I know that this is wrong, and there is something in my code in where I am not calling it correctly that is making it mess up but I cannot find it. I'm just trying to grab information off of my sheet1 so that I can use it later on. </p>\n\n<pre><code>With ThisWorkbook.Sheets(\"Sheet1\")\n    While (Counter &lt;= 300) \n            Pcounter = .Cells(ACBoxCounter, 2)\n        If (Pcounter &lt;&gt; \"\") Then\n            ACounter = ACounter + 1\n        End If\n            ACBCounter = ACBCounter + 30\n    Wend\n\n    While (OverallACounter &lt; ACounter)\n    Set objStream = CreateObject(\"ADODB.Stream\")\n    objStream.Charset = \"iso-8859-1\"\n    objStream.Open\n\n\n    ExampleString = .Cells(Row2Counter + 22, 3)\n    ChooseM = Split(ExampleString, \"-\")(1)\n    If (ChooseM = \"8\") \n      M = \"II\"\n      P = 97\n      Label = .Cells(Row2Counter, 2)\n    ElseIf (ChooseM = \"13\") Then\n      Model = \"A II\"\n      P = 10\n      Label = \"A6_\" &amp; .Cells(Row2Counter, 2)\n    ElseIf (ChooseM = \"19\") Then\n      M = \"AC1I\"\n      P = 56\n      Label = \"A9_\" &amp; .Cells(Row2Counter, 2)\n    End If\n    OverallD = 0\n    Overall= 0\n    OverallB = 0\n    ChooseBoxType = Split(ExampleString, \"-\")(2)\n    If ((StrComp(ChooseB, \"1\") = 0) Or (StrComp(ChooseB, \"1M\") = 0)) Then\n      BoxInputT= \"1 Phase\"\n    ElseIf ((StrComp(ChooseB, \"2\") = 0) Or (StrComp(ChooseB, \"2M\") = 0))  Then\n      BoxInput= \"2\"\n    ElseIf ((StrComp(ChooseB ,\"3\") = 0) Or (StrComp(ChooseBo, \"3M\") = 0)) Then\n      BoxInput= \"3\"\n    End If\n objStream.WriteText (\"  &lt;\" &amp; .Cells(Row2Counter, 2).Text &amp; \"&gt;\" &amp; vbLf)\nWend\nEnd With\n</code></pre>\n\n<p>Compiler Error: End With Has No With</p>\n"}, {"tags": ["excel", "vba", "optimization"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1560353335, "post_id": 56565543, "comment_id": 99710763, "body": "Looks like your handler is re-entrant; <code>Application.EnableEvents = False</code> at the top, <code>Application.EnableEvents = True</code> at the bottom."}, {"owner": {"reputation": 5, "user_id": 11538652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366f5126237e2e163d1400acfe118cbd?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver495", "link": "https://stackoverflow.com/users/11538652/oliver495"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1560353554, "post_id": 56565543, "comment_id": 99710903, "body": "@MathieuGuindon What would that mean if it is re-entrant? My though behind this was that I turn the <code>Worksheet_Change</code> off while I run the other code that deletes the rows and once the rows are deleted the <code>Worksheet_Change</code> should work again. But maybe I made a thinking error..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1560354093, "post_id": 56565543, "comment_id": 99711196, "body": "Sorry I admittedly didn&#39;t read the whole wall of text.... basically without disabling worksheet events, a <code>Worksheet_Change</code> handler that modifies the sheet it&#39;s being triggered for, is going to recurse. If the recursion goes deeper than VBA can handle, expect Excel to outright crash: you <i>must</i> prevent re-firing the event from its handler... whether or not the recursion is related to the problem at hand."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1560362287, "post_id": 56565543, "comment_id": 99715044, "body": "You code doesn&#39;t check for changes in Col I, so you could add a block for that."}, {"owner": {"reputation": 5, "user_id": 11538652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366f5126237e2e163d1400acfe118cbd?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver495", "link": "https://stackoverflow.com/users/11538652/oliver495"}, "edited": false, "score": 0, "creation_date": 1560759106, "post_id": 56565543, "comment_id": 99826613, "body": "Sorry was out of office so I could work on the file. I am just thinking about to change the whole &#180;Worksheet_Change&#180; sub to a regular sub that can be activated with a button. Would that work? And if so how to I need to change the &#180;Intersect(Target, Me.Range(&quot;I2:I&quot; &amp; Me.Rows.Count))&#180; part?"}, {"owner": {"reputation": 5, "user_id": 11538652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366f5126237e2e163d1400acfe118cbd?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver495", "link": "https://stackoverflow.com/users/11538652/oliver495"}, "edited": false, "score": 0, "creation_date": 1560762336, "post_id": 56565543, "comment_id": 99828154, "body": "Found a way to stop the the error. Instead of &#180;Application.EnableEvents = True&#180; and &#180;Application.EnableEvents = False&#180; I used the solution described in this post <a href=\"https://stackoverflow.com/questions/43637435/how-to-unable-worksheet-change-from-excel-vba-if-macro-is-enabled/43637544\" title=\"how to unable worksheet change from excel vba if macro is enabled\">stackoverflow.com/questions/43637435/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1560365893, "creation_date": 1560365893, "answer_id": 56568739, "question_id": 56565543, "link": "https://stackoverflow.com/questions/56565543/excel-vba-optimizing-worksheet-change-function-to-avoid-not-enough-system-reso/56568739#56568739", "title": "Excel VBA: Optimizing Worksheet_Change function to avoid &quot;Not enough system resource to display completely&quot;", "body": "<p>You code doesn't check for changes in Col I, so you could add a block for that</p>\n\n<pre><code>'Code for column B\nDim AffectedRange As Range\nSet AffectedRange = Intersect(Target, Me.Range(\"I2:I\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange Is Nothing Then\n    Dim iCell As Range\n    For Each iCell In AffectedRange.Cells\n        Application.EnableEvents=false\n        'Note the Range is *relative* to EntireRow\n        iCell.EntireRow.range(\"B1:H1,J1:M1\").value = 1 'set an initial value\n        Application.EnableEvents=True\n        'Then trigger a change to set the formulas\n        iCell.EntireRow.range(\"B1:H1,J1:M1\").ClearContents\n    Next iCell\nEnd I\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11538652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366f5126237e2e163d1400acfe118cbd?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver495", "link": "https://stackoverflow.com/users/11538652/oliver495"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56568739, "answer_count": 1, "score": 0, "last_activity_date": 1560383072, "creation_date": 1560352699, "last_edit_date": 1560383072, "question_id": 56565543, "link": "https://stackoverflow.com/questions/56565543/excel-vba-optimizing-worksheet-change-function-to-avoid-not-enough-system-reso", "title": "Excel VBA: Optimizing Worksheet_Change function to avoid &quot;Not enough system resource to display completely&quot;", "body": "<p>First I need to say that I a beginner with VBA. I understand VBA basics and I already did some little projects but most of it involved a lot of googling.</p>\n\n<p>For the current issue, I could not find any useful tips online. Maybe it's because I created the code on my own. But see for yourself...</p>\n\n<p>I am trying to create a table with client data. The table contains the client number in <code>column \"I\"</code> which is being added by hand. The table should now pick up other client data such as domicile, age, etc automatically based on the client number from a static database that is in another tab. However, I want to have the possibility to manually overwrite the cells in my table that contain the client data from the database. But when I delete my manual entries the original data from the database should appear again. </p>\n\n<p>With the code below I was able to do this. When a cell is empty the code adds a <code>formula</code> to the cell that picks up the data from the database. However, I am able to overwrite the <code>formula</code> manually. When I delete my manual entry and the cell becomes empty again the <code>formula</code> appears again and picks up the data from the database. But I have two problems with the code below:</p>\n\n<ol>\n<li><p>The code seems to be too \"heavy\". For example, when I delete rows, I get an error message <code>\"Not enough system resource to display completely\"</code> which freezes the complete Excel file.</p></li>\n<li><p>When I add new client numbers in <code>column \"I\"</code> the code does not pick up the data from the database automatically. I need to trigger the <code>Worksheet_Change</code> for every single cell by choosing the cell and clicking <code>Delete</code></p></li>\n</ol>\n\n<p>So I am looking for a way to simplify my code so that:</p>\n\n<ol>\n<li><p>the error message does not occur again when I am deleting rows; </p></li>\n<li><p>when I add a new client number in <code>column \"I\"</code> the other cells in the same row should instantly pickup other client data from the database.</p></li>\n</ol>\n\n<p>I already tried the following but without success:</p>\n\n<ol>\n<li><p>To delete rows I created a code that does it automatically and I added <code>Application.EnableEvents = False</code> at the beginning of the code and <code>Application.EnableEvents = True</code> at the end with the intention to stop the <code>Worksheet_Change</code> while the rows are being deleted but it did not work and I still got an error.</p></li>\n<li><p>To trigger the <code>Worksheet_Change</code> I used the following code <code>Application.Run \"Sheet3.Worksheet_Change\", Range(\"A1:Z5000\")</code> and assigned it to a button but it did not work.</p></li>\n</ol>\n\n<p>So here is the existing code (note the code look longer than it is. The code for every column is the same, only the <code>formulas</code> is different that is being put into the cells are different):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n'Code for column B\nDim AffectedRange As Range\nSet AffectedRange = Intersect(Target, Me.Range(\"B2:B\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange Is Nothing Then\n    Dim iCell As Range\n    For Each iCell In AffectedRange.Cells\n\n            If iCell.Value = vbNullString Then\n            iCell.Formula = \"=IFERROR(IF($I\" &amp; iCell.Row &amp; \"=\"\"\"\",\"\"\"\",VLOOKUP($I\" &amp; iCell.Row &amp; \",'Raw Data'!$A$1:$AH$5000,4,FALSE)),\"\"N/A\"\")\"\n        End If\n    Next iCell\nEnd If\n\n'Code for column D\nDim AffectedRange1 As Range\nSet AffectedRange1 = Intersect(Target, Me.Range(\"D2:D\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange1 Is Nothing Then\n    Dim iCell1 As Range\n    For Each iCell1 In AffectedRange1.Cells\n\n            If iCell1.Value = vbNullString Then\n            iCell1.Formula = \"=IFERROR(IF($I\" &amp; iCell1.Row &amp; \"=\"\"\"\",\"\"\"\",IF(VLOOKUP($I\" &amp; iCell1.Row &amp; \",'Raw Data'!$A$1:$AH$5000,9,FALSE)=0,\"\"N/A\"\",VLOOKUP($I\" &amp; iCell1.Row &amp; \", 'Raw Data'!$A$1:$AH$5000,9,FALSE))),\"\"N/A\"\")\"\n        End If\n    Next iCell1\nEnd If\n\n'Code for column E\nDim AffectedRange2 As Range\nSet AffectedRange2 = Intersect(Target, Me.Range(\"E2:E\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange2 Is Nothing Then\n    Dim iCell2 As Range\n    For Each iCell2 In AffectedRange2.Cells\n\n            If iCell2.Value = vbNullString Then\n            iCell2.Formula = \"=IFERROR(IF($I\" &amp; iCell2.Row &amp; \"=\"\"\"\",\"\"\"\",IF(VLOOKUP($I\" &amp; iCell2.Row &amp; \",'Raw Data'!$A$1:$AH$5000,10,FALSE)=0,\"\"N/A\"\",VLOOKUP($I\" &amp; iCell2.Row &amp; \", 'Raw Data'!$A$1:$AH$5000,10,FALSE))),\"\"N/A\"\")\"\n        End If\n    Next iCell2\nEnd If\n\n'Code for column C\nDim AffectedRange4 As Range\nSet AffectedRange4 = Intersect(Target, Me.Range(\"C2:C\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange4 Is Nothing Then\n    Dim iCell4 As Range\n    For Each iCell4 In AffectedRange4.Cells\n\n            If iCell4.Value = vbNullString Then\n            iCell4.Formula = \"=IFERROR(IF($I\" &amp; iCell4.Row &amp; \"=\"\"\"\",\"\"\"\",IF(VLOOKUP($I\" &amp; iCell4.Row &amp; \",'Raw Data'!A$1:$AH$5000,22,FALSE)=0,\"\"N/A\"\",IF(VLOOKUP($I\" &amp; iCell4.Row &amp; \",'Raw Data'!A$1:$AH$5000,22,FALSE)&lt;0.49999,\"\"Prio 3\"\",IF(AND(VLOOKUP($I\" &amp; iCell4.Row &amp; \",'Raw Data'!A$1:$AH$5000,22,FALSE)&gt;0.49999,VLOOKUP($I\" &amp; iCell4.Row &amp; \",'Raw Data'!A$1:$AH$5000,22,FALSE)&lt;0.79999),\"\"Prio 2\"\",IF(VLOOKUP($I\" &amp; iCell4.Row &amp; \",'Raw Data'!A$1:$AH$5000,22,FALSE)&gt;0.79999,\"\"Prio 1\"\",\"\"N/A\"\"))))),\"\"N/A\"\")\"\n        End If\n    Next iCell4\nEnd If\n\n'Code for column H\nDim AffectedRange5 As Range\nSet AffectedRange5 = Intersect(Target, Me.Range(\"H2:H\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange5 Is Nothing Then\n    Dim iCell5 As Range\n    For Each iCell5 In AffectedRange5.Cells\n\n            If iCell5.Value = vbNullString Then\n            iCell5.Formula = \"=IFERROR(IF($I\" &amp; iCell5.Row &amp; \"=\"\"\"\",\"\"\"\",IF(VLOOKUP($I\" &amp; iCell5.Row &amp; \",'Raw Data'!$A$1:$AH$5000,11,FALSE)=0,\"\"N/A\"\",VLOOKUP($I\" &amp; iCell5.Row &amp; \", 'Raw Data'!$A$1:$AH$5000,11,FALSE))),\"\"N/A\"\")\"\n        End If\n    Next iCell5\nEnd If\n\n'Code for column F\nDim AffectedRange6 As Range\nSet AffectedRange6 = Intersect(Target, Me.Range(\"F2:F\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange6 Is Nothing Then\n    Dim iCell6 As Range\n    For Each iCell6 In AffectedRange6.Cells\n\n            If iCell6.Value = vbNullString Then\n            iCell6.Formula = \"=IFERROR(IF($I\" &amp; iCell6.Row &amp; \"=\"\"\"\",\"\"\"\",(IF(OR($D\" &amp; iCell6.Row &amp; \"=\"\"N/A\"\",$D\" &amp; iCell6.Row &amp; \"=\"\"\"\"),\"\"N/A\"\",IF(AND($H\" &amp; iCell6.Row &amp; \"=\"\"Espagne\"\",LEN($D\" &amp; iCell6.Row &amp; \")=5),VLOOKUP(LEFT($D\" &amp; iCell6.Row &amp; \",2),Regionslist!$A$1:$B$52,2,FALSE),IF(AND($H\" &amp; iCell6.Row &amp; \"=\"\"Espagne\"\",LEN($D\" &amp; iCell6.Row &amp; \")=4),VLOOKUP(\"\"0\"\"&amp;LEFT($D\" &amp; iCell6.Row &amp; \",1),Regionslist!$A$1:$B$52,2,FALSE),$H\" &amp; iCell6.Row &amp; \"))))),$H\" &amp; iCell6.Row &amp; \")\"\n        End If\n    Next iCell6\nEnd If\n\n'Code for column G\nDim AffectedRange7 As Range\nSet AffectedRange7 = Intersect(Target, Me.Range(\"G2:G\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange7 Is Nothing Then\n    Dim iCell7 As Range\n    For Each iCell7 In AffectedRange7.Cells\n\n            If iCell7.Value = vbNullString Then\n            iCell7.Formula = \"=IFERROR(IF($I\" &amp; iCell7.Row &amp; \"=\"\"\"\",\"\"\"\",VLOOKUP($F\" &amp; iCell7.Row &amp; \",Regionslist!$B$1:$C$52,2,FALSE)),$F\" &amp; iCell7.Row &amp; \")\"\n        End If\n    Next iCell7\nEnd If\n\n'Code for column J\nDim AffectedRange8 As Range\nSet AffectedRange8 = Intersect(Target, Me.Range(\"J2:J\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange8 Is Nothing Then\n    Dim iCell8 As Range\n    For Each iCell8 In AffectedRange8.Cells\n\n            If iCell8.Value = vbNullString Then\n            iCell8.Formula = \"=IFERROR(IF($I\" &amp; iCell8.Row &amp; \"=\"\"\"\",\"\"\"\",VLOOKUP($I\" &amp; iCell8.Row &amp; \",'Raw Data'!$A$1:$AH$5000,2,FALSE)),\"\"N/A\"\")\"\n        End If\n    Next iCell8\nEnd If\n\n'Code for column K\nDim AffectedRange9 As Range\nSet AffectedRange9 = Intersect(Target, Me.Range(\"K2:K\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange9 Is Nothing Then\n    Dim iCell9 As Range\n    For Each iCell9 In AffectedRange9.Cells\n\n            If iCell9.Value = vbNullString Then\n            iCell9.Formula = \"=IFERROR(IF($I\" &amp; iCell9.Row &amp; \"=\"\"\"\",\"\"\"\",IF(SUBSTITUTE(VLOOKUP($I\" &amp; iCell9.Row &amp; \",'Raw Data'!$A$1:$AH$5000,13,FALSE),\"\",\"\",\"\"\"\")&lt;&gt;\"\"\"\",SUBSTITUTE(VLOOKUP($I\" &amp; iCell9.Row &amp; \",'Raw Data'!$A$1:$AH$5000,13,FALSE),\"\",\"\",\"\"\"\"),\"\"N/A\"\")),\"\"N/A\"\")\"\n        End If\n    Next iCell9\nEnd If\n\n'Code for column L\nDim AffectedRange10 As Range\nSet AffectedRange10 = Intersect(Target, Me.Range(\"L2:L\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange10 Is Nothing Then\n    Dim iCell10 As Range\n    For Each iCell10 In AffectedRange10.Cells\n\n            If iCell10.Value = vbNullString Then\n            iCell10.Formula = \"=IFERROR(IF($I\" &amp; iCell10.Row &amp; \"=\"\"\"\",\"\"\"\",SUBSTITUTE(VLOOKUP($I\" &amp; iCell10.Row &amp; \",'Raw Data'!$A$1:$AH$5000,20,FALSE),\"\",\"\",\"\"\"\")),\"\"N/A\"\")\"\n        End If\n    Next iCell10\nEnd If\n\n'Code for column M\nDim AffectedRange11 As Range\nSet AffectedRange11 = Intersect(Target, Me.Range(\"M2:M\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange11 Is Nothing Then\n    Dim iCell11 As Range\n    For Each iCell11 In AffectedRange11.Cells\n\n            If iCell11.Value = vbNullString Then\n            iCell11.Formula = \"=IFERROR(IF($I\" &amp; iCell11.Row &amp; \"=\"\"\"\",\"\"\"\",VLOOKUP($I\" &amp; iCell11.Row &amp; \",'Raw Data'!$A$1:$AH$5000,22,FALSE)),\"\"N/A\"\")\"\n        End If\n    Next iCell11\nEnd If\n\n'Code for column N\nDim AffectedRange12 As Range\nSet AffectedRange12 = Intersect(Target, Me.Range(\"N2:N\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange12 Is Nothing Then\n    Dim iCell12 As Range\n    For Each iCell12 In AffectedRange12.Cells\n\n            If iCell12.Value = vbNullString Then\n            iCell12.Formula = \"=IFERROR(IF($I\" &amp; iCell12.Row &amp; \"=\"\"\"\",\"\"\"\",\"\"1.\"\"&amp;VLOOKUP($I\" &amp; iCell12.Row &amp; \",'Raw Data'!$A$1:$AH$5000,21,FALSE)),\"\"N/A\"\")\"\n        End If\n    Next iCell12\nEnd If\n\n'Code for column W\nDim AffectedRange13 As Range\nSet AffectedRange13 = Intersect(Target, Me.Range(\"W2:W\" &amp; Me.Rows.Count))\n\nIf Not AffectedRange13 Is Nothing Then\n    Dim iCell13 As Range\n    For Each iCell13 In AffectedRange13.Cells\n\n            If iCell13.Value = vbNullString Then\n            iCell13.Formula = \"=IF($I\" &amp; iCell13.Row &amp; \"=\"\"\"\",\"\"\"\",IFERROR(IF(VLOOKUP($I\" &amp; iCell13.Row &amp; \",'Raw Data'!$A$1:$AH$5000,1,FALSE)=$I\" &amp; iCell13.Row &amp; \",\"\"yes\"\",\"\"no\"\"),\"\"no\"\"))\"\n        End If\n    Next iCell13\nEnd If\nEnd sub\n</code></pre>\n\n<p>In advance many thanks for any kind of advice and help!</p>\n\n<p>Best regards,\nOliver</p>\n"}, {"tags": ["excel", "vba", "sorting"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1560352945, "post_id": 56565246, "comment_id": 99710516, "body": "You could use a custom sort: <code>Application.AddCustomList ListArray: SortArray</code>, where sort array has been created from the <code>abs(values)</code> in your list and is <a href=\"https://stackoverflow.com/questions/152319/vba-array-sort-function\">sorted</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "is_accepted": true, "score": 2, "last_activity_date": 1560353810, "creation_date": 1560353810, "answer_id": 56565863, "question_id": 56565246, "link": "https://stackoverflow.com/questions/56565246/sort-range-in-absolute-value/56565863#56565863", "title": "Sort Range in absolute value", "body": "<p>To do this in memory I would first load it to a single dimensional array.</p>\n\n<p>Then I would create a specific function that does your custom sort on the array.</p>\n\n<p>Once it's sorted, then simply set the value to that range from the sorted array.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Appel()\n\n    Dim TargetRange As Range\n    Set TargetRange = Range(\"D1\", Range(\"D\" &amp; Rows.Count).End(xlUp))\n\n    'This returns as single dim array from a Range column\n    Dim ColumnData As Variant\n    ColumnData = Application.Transpose(TargetRange.Value)\n\n    Dim SortedData As Variant\n    SortedData = SortAbsoluteDecending(ColumnData)\n\n    'Set value of range equal to the new sorted array.\n    TargetRange.Value = Application.Transpose(SortedData)\n\nEnd Sub\n</code></pre>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function SortAbsoluteDecending(SourceArray As Variant) As Variant\n\n    Dim OuterIndex As Long\n    For OuterIndex = LBound(SourceArray) To UBound(SourceArray) - 1\n\n        Dim InnerIndex As Long\n        For InnerIndex = OuterIndex + 1 To UBound(SourceArray)\n\n            If Abs(SourceArray(OuterIndex)) &lt; Abs(SourceArray(InnerIndex)) Then\n                Dim Temp As Variant\n                Temp = SourceArray(InnerIndex)\n                SourceArray(InnerIndex) = SourceArray(OuterIndex)\n                SourceArray(OuterIndex) = Temp\n            End If\n\n        Next InnerIndex\n    Next OuterIndex\n\n    SortAbsoluteDecending = SourceArray\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 540, "user_id": 11561158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bcfab384fc6e33996160df3ad56d2e5?s=128&d=identicon&r=PG&f=1", "display_name": "Hippolyte BRINGER", "link": "https://stackoverflow.com/users/11561158/hippolyte-bringer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 56565863, "answer_count": 1, "score": 1, "last_activity_date": 1606837321, "creation_date": 1560351779, "last_edit_date": 1560356731, "question_id": 56565246, "link": "https://stackoverflow.com/questions/56565246/sort-range-in-absolute-value", "title": "Sort Range in absolute value", "body": "<p>I would like to sort a range in absolute value but keep the sign of the number.</p>\n\n<p>I did a code that works fine, but I copy/paste values in another range and afterwards, I delete it.</p>\n\n<p>I would like not to copy/paste in my sheet but just do it in memory.</p>\n\n<p>How can I do that? </p>\n\n<p>My range:</p>\n\n<pre><code>-1\n2\n3\n-4\n4.5\n</code></pre>\n\n<p>The expected result :</p>\n\n<pre><code>4.5\n-4\n3\n2\n-1\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>Sub Appel()\n\n    For i = 1 To Range(\"D1\").End(xlDown).Row\n        Range(\"E\" &amp; i) = Abs(Range(\"D\" &amp; i).Value)\n    Next i\n\n    Range(\"E1\", Range(\"D1\").End(xlDown)).Sort Key1:=Range(\"E1\"), \n    Order1:=xlDescending, Header:=xlNo\n\n    Columns(\"E:E\").Delete\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560351535, "post_id": 56565141, "comment_id": 99709683, "body": "You could do this with a formula. Is there any reason you need VBA?"}, {"owner": {"reputation": 13, "user_id": 11637397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4833de48e0fa1735553a5d72b4815625?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/11637397/garrett"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560351938, "post_id": 56565141, "comment_id": 99709946, "body": "The data I will be using will be different every time. I have macros setup to perform other functions in organizing the spreadsheet as well. The individual I am creating this template for does not know excel at all so it would be easier for them to press a button and it be done automatically. I think it is more for consistency that I am wanting VBA."}], "answers": [{"tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": true, "score": 1, "last_activity_date": 1560353006, "creation_date": 1560353006, "answer_id": 56565635, "question_id": 56565141, "link": "https://stackoverflow.com/questions/56565141/is-there-a-vba-to-number-different-sets-of-data-using-autofill/56565635#56565635", "title": "Is there a VBA to number different sets of data using autofill", "body": "<p>Something like this might work for you:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub countSomething()\n\nDim ws As Worksheet: Set ws = ActiveWorkbook.Sheets(\"sheet name\")\nDim lrow As Long: lrow = ws.Cells(Rows.Count, \"B\").End(xlUp).Row 'get last row at the column that will always be populated\nDim R As Long, X As Long: X = 1\n\n\nFor R = 2 To lrow\n    If WorksheetFunction.CountA(ws.Cells(R, 1).Resize(1, 4)) = 0 Then 'empty row\n        X = 1\n    Else\n        ws.Cells(R, 1) = X\n        X = X + 1\n    End If\nNext R\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11637397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4833de48e0fa1735553a5d72b4815625?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/11637397/garrett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 56565635, "answer_count": 1, "score": 1, "last_activity_date": 1560353006, "creation_date": 1560351437, "last_edit_date": 1560351462, "question_id": 56565141, "link": "https://stackoverflow.com/questions/56565141/is-there-a-vba-to-number-different-sets-of-data-using-autofill", "title": "Is there a VBA to number different sets of data using autofill", "body": "<p>I am wanting to number sets of data that are separated by an empty row. I am thinking an autofill VBA would be what I am needing but cannot seem to find anything that fits specifically what I am looking to do. The issue I am running into is that the data will vary and will not always have the same exact number of rows in each sequence. Given that, I would like Column A (Count) to increase according to information being in Column C (Last Name) and start over when there is an empty row until the end of the sheet. I have put an example of what I am looking for as the end result below. Thank You!</p>\n\n<pre><code>Count   ID   Last Name First Name           \n1   344969  Test    Test\n2           Test    Test\n3   344971  Test    Test\n4           Test    Test\n5   344973  Test    Test\n6   344974  Test    Test\n7   344975  Test    Test\n8           Test    Test\n(Blank Row)         \n1           Test 2  Test 3\n2   200474  Test 2  Test 3\n3   200475  Test 2  Test 3\n4   200476  Test 2  Test 3\n5           Test 2  Test 3\n6   200478  Test 2  Test 3\n7   200479  Test 2  Test 3\n8           Test 2  Test 3\n9           Test 2  Test 3\n10  200482  Test 2  Test 3\n(Blank Row)         \n1   195959  Test 5  Test 6\n2   195960  Test 5  Test 6\n3   195961  Test 5  Test 6\n4   195962  Test 5  Test 6\n5   195963  Test 5  Test 6\n6   195964  Test 5  Test 6\n7   195965  Test 5  Test 6\n8   195966  Test 5  Test 6\n9   195967  Test 5  Test 6\n10  195968  Test 5  Test 6\n</code></pre>\n\n<p>I have tried conditional formatting with no luck. I have several other macros in place and would like to add one that performs this function.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 11595922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ff5f0abcc6a9e22b54df381f080164?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo_north", "link": "https://stackoverflow.com/users/11595922/tokyo-north"}, "edited": false, "score": 0, "creation_date": 1560353082, "post_id": 56565041, "comment_id": 99710600, "body": "Wouldn&#39;t <code>Application.EnableEvents = True</code> be placed above<code>If Not DataRng Is Nothing Then</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 105, "user_id": 11595922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ff5f0abcc6a9e22b54df381f080164?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo_north", "link": "https://stackoverflow.com/users/11595922/tokyo-north"}, "edited": false, "score": 1, "creation_date": 1560355070, "post_id": 56565041, "comment_id": 99711745, "body": "@tokyo_north by making it conditional, you are playing with fire. A recursing event will outright crash the host (Excel), not just raise a run-time error."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560356105, "post_id": 56565041, "comment_id": 99712277, "body": "That would activate the sub itself, as that piece of code changes cell values. You wouldn&#39;t want to do that, as mentioned by Mathieu"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": true, "score": 1, "last_activity_date": 1560351157, "creation_date": 1560351157, "answer_id": 56565041, "question_id": 56564864, "link": "https://stackoverflow.com/questions/56564864/detecting-worksheet-changes-after-ado-copyfromrecordset-event/56565041#56565041", "title": "Detecting Worksheet Changes AFTER Ado .CopyFromRecordSet event", "body": "<p>Any event that runs on changes risks activating itself. To prevent this from happening, disable events while running the sub using <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.enableevents\" rel=\"nofollow noreferrer\">EnableEvents</a></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As range)\nApplication.EnableEvents = False\nDim KeyCells As range\nSet KeyCells = range(\"Table:Environment\")\nIf Not Application.Intersect(KeyCells, range(Target.Address)) _\n       Is Nothing Then\n    range(\"CleanHeaders\").ClearContents\n    range(\"CleanDates\").ClearContents\n    Call SQL_Connect.connect\n    Call Data_Download.header_download\n    Call Data_Download.download_data\n    Call SQL_Connect.close_connection\nEnd If\nDim DataRng As range, roww As Long\nDim rng As range\nSet DataRng = Intersect(range(\"DataStart:Z10000\"), Target)\nIf Not DataRng Is Nothing Then\n    For Each rng In DataRng\n        roww = rng.Row\n        If Not rng.Value = \" \" Then\n        Cells(roww, \"AA\").Value = \"1\"\n        Else\n        Cells(roww, \"AA\").Value = \"0\"\n        End If\n        Next\n    End If\nOn Error GoTo 0\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 11595922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ff5f0abcc6a9e22b54df381f080164?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo_north", "link": "https://stackoverflow.com/users/11595922/tokyo-north"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 56565041, "answer_count": 1, "score": 0, "last_activity_date": 1560351157, "creation_date": 1560350566, "question_id": 56564864, "link": "https://stackoverflow.com/questions/56564864/detecting-worksheet-changes-after-ado-copyfromrecordset-event", "title": "Detecting Worksheet Changes AFTER Ado .CopyFromRecordSet event", "body": "<p>I have a worksheet that connects to a SQL DB using Ado and will upload the contents of the database into the excel sheet. I have that part working well. Now I want to check to see if a cell changes after the data has been inserted. Here is my code in the Worksheeet_Change so far.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As range)\nDim KeyCells As range\nSet KeyCells = range(\"Table:Environment\")\nIf Not Application.Intersect(KeyCells, range(Target.Address)) _\n       Is Nothing Then\n    range(\"CleanHeaders\").ClearContents\n    range(\"CleanDates\").ClearContents\n    Call SQL_Connect.connect\n    Call Data_Download.header_download\n    Call Data_Download.download_data\n    Call SQL_Connect.close_connection\nEnd If\nDim DataRng As range, roww As Long\nDim rng As range\nSet DataRng = Intersect(range(\"DataStart:Z10000\"), Target)\nIf Not DataRng Is Nothing Then\n    For Each rng In DataRng\n        roww = rng.Row\n        If Not rng.Value = \" \" Then\n        Cells(roww, \"AA\").Value = \"1\"\n        Else\n        Cells(roww, \"AA\").Value = \"0\"\n        End If\n        Next\n    End If\nOn Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>To give you a quick run down, here is what is going on in the code. The first part focuses on a specific box in the sheet. When it is changed, it calls a connection, downloads headers and data, then closes connection. Like I said, this part runs fine and I have no issues with it. The next part is my attempt to check for changes in these cells. The issue is, every time I clean a table or upload new data to it, it thinks it is a change and will put 1's in all rows. <strong>I want to detect these changes AFTER the data has been downloaded to the sheet. How would I go about fixing this to properly achieve this?</strong> Thanks in advance!</p>\n"}, {"tags": ["vba", "ms-access", "richtext"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560350758, "post_id": 56564770, "comment_id": 99709214, "body": "Untested, but I think the Rich Textbox control does not come with MS Office - it is a VB6 control &quot;Richtx32.ocx&quot; . You have to add reference to the ocx via references and then work with it."}, {"owner": {"reputation": 1, "user_id": 11637434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c6b3f94d1d334537dde0819b912a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Gfn1738", "link": "https://stackoverflow.com/users/11637434/gfn1738"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560354430, "post_id": 56564770, "comment_id": 99711368, "body": "I am looking through the references browser in the VBA window and do not see Richtx32.ocx  Is there somewhere else I should be looking?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560355628, "post_id": 56564770, "comment_id": 99712031, "body": "this may point you in the right direction, it might be under Tools &gt; Additional Controls, but I don&#39;t have it available to me either (these OCX files can usually be downloaded from MS if needed). See also <a href=\"https://stackoverflow.com/questions/39051237/insert-richtextbox-in-userform-excelvba\" title=\"insert richtextbox in userform excelvba\">stackoverflow.com/questions/39051237/&hellip;</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1560355650, "post_id": 56564770, "comment_id": 99712038, "body": "Or you may try using the InkEdit control (also Tools &gt; Additional Controls) but I have never used either of these."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1560358396, "post_id": 56564770, "comment_id": 99713282, "body": "Access has an inbuilt RichText control. @DavidZemens"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1560358485, "post_id": 56564770, "comment_id": 99713331, "body": "Analyze the rich text source, see e.g. <a href=\"https://stackoverflow.com/a/55525535/3820271\">stackoverflow.com/a/55525535/3820271</a> or <a href=\"https://stackoverflow.com/a/55772533/3820271\">stackoverflow.com/a/55772533/3820271</a> . You could try removing all <code>&lt;font&gt;</code> elements."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 2, "creation_date": 1560365559, "post_id": 56564770, "comment_id": 99716453, "body": "Example of VBA applying RTF: <code>Me.Textbox1 = &quot;&lt;div&gt;&lt;font face=Arial size=2&gt;ABC&lt;&#47;font&gt;&lt;&#47;div&gt;&quot;</code>."}], "owner": {"reputation": 1, "user_id": 11637434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50c6b3f94d1d334537dde0819b912a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Gfn1738", "link": "https://stackoverflow.com/users/11637434/gfn1738"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 848, "favorite_count": 0, "closed_date": 1560414994, "answer_count": 0, "score": 0, "last_activity_date": 1594715885, "creation_date": 1560350302, "last_edit_date": 1594715885, "question_id": 56564770, "link": "https://stackoverflow.com/questions/56564770/access-vba-formatting-font-and-text-size-in-textbox-with-rich-text-format", "closed_reason": "Duplicate", "title": "Access VBA formatting font and text size in textbox with Rich Text format", "body": "<p>I have an Access Database where users are pasting information into a textbox with Rich Text.  The information in this textbox is then being added to another form which is compiling all of the different text that has been pasted across users.  I would like to be able to format the Font to Arial size 10 AfterUpdate so that there is consistency across my main form which is compiling all of these records together.  Users will be pasting in text from many different sources and I cannot count on users to format text by themselves.  I am hoping to be able to automatically change all text to Arial size 10 programmatically to achieve consistency.</p>\n\n<p>I have attempted using some basic code through VBA to achieve the desired result, and have the code working when the textbox is set to Plain Text, but this project necessitates that the textbox be Rich Text.</p>\n\n<pre><code>Private Sub Textbox1_AfterUpdate()\n\n     Me.Textbox1.FontName = \"Arial\"\n     Me.Textbox1.FontSize = 10\n\nEnd Sub\n</code></pre>\n\n<p>This appears to be working correctly with Plain Text, but I am unsure if I am missing syntax etc. related to Rich Text, or if formatting Rich Text in this fashion is even possible.</p>\n"}, {"tags": ["html", "excel", "vba", "get"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560351523, "post_id": 56564769, "comment_id": 99709676, "body": "What value is lastRow?"}, {"owner": {"reputation": 658, "user_id": 2871502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SN4ok.png?s=128&g=1", "display_name": "Carter", "link": "https://stackoverflow.com/users/2871502/carter"}, "edited": false, "score": 3, "creation_date": 1560351708, "post_id": 56564769, "comment_id": 99709801, "body": "If I had to guess google is cutting you off after a certain amount of aggresive requests.  Therefore you need to be kinder and put in a pause in your program so you are not spamming requests in an almost DDoS way.  try this right before your For Loop&#39;s Next. Application.Wait (Now + TimeValue(&quot;0:00:6&quot;))  The application will pause after each loop for 6 seconds, you can vary that to see what they find acceptable."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 2, "creation_date": 1560351856, "post_id": 56564769, "comment_id": 99709889, "body": "Your initial <code>Set objHTTP = CreateObject</code> line is <b><i>inside</i></b> your loop, but your <code>= Nothing</code> line is <b><i>outside</i></b>. I&#39;m not sure (which is why this isn&#39;t an answer, just a comment) but perhaps you&#39;re creating too many Objects without flushing them out? Or, perhaps you only need to create it once by moving it before the <code>For I = 2...</code> line?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1560352097, "post_id": 56564769, "comment_id": 99710036, "body": "Consider <a href=\"http://www.rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenting</a> your code, to make it easier to see the block structures at a glance."}, {"owner": {"reputation": 3, "user_id": 11631104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0926b05d3544befbdda2612ac13753f9?s=128&d=identicon&r=PG&f=1", "display_name": "AntonioF", "link": "https://stackoverflow.com/users/11631104/antoniof"}, "reply_to_user": {"reputation": 658, "user_id": 2871502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SN4ok.png?s=128&g=1", "display_name": "Carter", "link": "https://stackoverflow.com/users/2871502/carter"}, "edited": false, "score": 0, "creation_date": 1560354267, "post_id": 56564769, "comment_id": 99711280, "body": "@Carter This worked and I was able to run over 100 at one time, thank you so much!"}, {"owner": {"reputation": 658, "user_id": 2871502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SN4ok.png?s=128&g=1", "display_name": "Carter", "link": "https://stackoverflow.com/users/2871502/carter"}, "edited": false, "score": 0, "creation_date": 1560356449, "post_id": 56564769, "comment_id": 99712442, "body": "@AntonioF Glad it helped.  Would you mind me rewriting it as an answer and accepting it?"}], "answers": [{"tags": [], "owner": {"reputation": 658, "user_id": 2871502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SN4ok.png?s=128&g=1", "display_name": "Carter", "link": "https://stackoverflow.com/users/2871502/carter"}, "is_accepted": true, "score": 0, "last_activity_date": 1560357603, "last_edit_date": 1560357603, "creation_date": 1560357216, "answer_id": 56566784, "question_id": 56564769, "link": "https://stackoverflow.com/questions/56564769/excel-macro-only-executing-to-60th-row-then-failing-while-making-get-requests/56566784#56566784", "title": "Excel macro only executing to ~60th row, then failing while making get requests", "body": "<p>The problem here turned out to be too many requests too quickly to google using the below GET request in a For loop:</p>\n\n<pre><code>With objHTTP\n.Open \"GET\", URL, False\n.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n.send\nhtmlDoc.body.innerHTML = .responseText\n\nEnd With\n</code></pre>\n\n<p>In order to make this code request at an acceptable pace to the server we are requesting from we add a pause in the loop.</p>\n\n<p>The easiest built in way to pause in VBA is with:</p>\n\n<pre><code>For I = 2 To lastRow\n... 'Lines omitted for clarity of purpose\n...\nApplication.Wait (Now + TimeValue(\"0:00:6\"))\nNext\n</code></pre>\n\n<p>The application will then wait until that time to continue executing (an unfortunate limitation with this method is 1 second is the minimum wait time, so smaller values would need a different solution, Application.Wait and examples that could create a smaller delay outlined <a href=\"https://www.myonlinetraininghub.com/pausing-or-delaying-vba-using-wait-sleep-or-a-loop\" rel=\"nofollow noreferrer\">Here</a>)</p>\n"}], "owner": {"reputation": 3, "user_id": 11631104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0926b05d3544befbdda2612ac13753f9?s=128&d=identicon&r=PG&f=1", "display_name": "AntonioF", "link": "https://stackoverflow.com/users/11631104/antoniof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 56566784, "answer_count": 1, "score": 0, "last_activity_date": 1592434137, "creation_date": 1560350302, "last_edit_date": 1592434137, "question_id": 56564769, "link": "https://stackoverflow.com/questions/56564769/excel-macro-only-executing-to-60th-row-then-failing-while-making-get-requests", "title": "Excel macro only executing to ~60th row, then failing while making get requests", "body": "<p>I modified code I found online to be able to find a ClassName on an HTML page and returns its text when doing a Google search. I need to do this for about 10,000 companies but when testing it with only 100 rows it works and then stops around ~60th row. After that I am unable to get any results and found the only way to resolve it is by waiting about an hour and then executing it again. I tested this on another computer and had the same results and issue. It doesn't have to do with what is in the ~60th row because I use a different set of 100 companies each test. Even changing the loop to i = 2 to 101 still causes it to have the same problem.</p>\n\n<p>Col A would have a company name such as: \"Buchart Horn\"</p>\n\n<p>Col B returns \"Architect in Baltimore, Maryland\"</p>\n\n<p>Col C would be blank (that's fine)</p>\n\n<p>Col D returns \"Baltimore, Maryland - Buchart Horn: Engineers, Architects and Planners\"</p>\n\n<p>I'm very new to VBA so any help would be appreciated. Thank you.</p>\n\n<pre><code>'References enabled: \n'Microsoft Internet Controls, Microsoft HTML Object Library\n\nSub GoogleSearch()\nDim URL As String\nDim objHTTP As Object\nDim htmlDoc As HTMLDocument\n\nSet htmlDoc = CreateObject(\"htmlfile\")\n\nDim objResults1 As Object\nDim objResults2 As Object\nDim objResults3 As Object\n\nOn Error Resume Next\n\nlastRow = Range(\"A\" &amp; Rows.count).End(xlUp).Row\n\nFor I = 2 To lastRow\n\nURL = \"https://www.google.com/search?q=\" &amp; Cells(I, 1)\n\nSet objHTTP = CreateObject(\"MSXML2.XMLHTTP\")\n\nWith objHTTP\n.Open \"GET\", URL, False\n.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n.send\nhtmlDoc.body.innerHTML = .responseText\n\nEnd With\n\nSet objResults1 = htmlDoc.getElementsByClassName(\"YhemCb\")\nSet objResults2 = htmlDoc.getElementsByClassName(\"wwUB2c kno-fb-ctx\")\nSet objResults3 = htmlDoc.getElementsByClassName(\"LC20lb\")\n\nCells(I, 2) = objResults1(0).innerText\nCells(I, 3) = objResults2(0).innerText\nCells(I, 4) = objResults3(0).innerText\n\nNext\n\nSet htmlDoc = Nothing\nSet objResults1 = Nothing\nSet objResults2 = Nothing\nSet objResults3 = Nothing\nSet objHTTP = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1560350663, "post_id": 56564735, "comment_id": 99709167, "body": "Does the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/copy-getfromclipboard-gettext-methods-dataobject-object-example\" rel=\"nofollow noreferrer\"><code>MSForms.DataObject</code></a> not work for your needs?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1560351285, "post_id": 56564735, "comment_id": 99709528, "body": "@K.D\u1d00\u1d20\u026as thanks, but unfortunately no. I just added a note to that effect based on the answer Vitaya posted a few minutes ago."}], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1560351253, "creation_date": 1560350175, "last_edit_date": 1560351253, "question_id": 56564735, "link": "https://stackoverflow.com/questions/56564735/is-it-possible-to-use-myservices-clipboardproxy-in-vba", "title": "Is it possible to use MyServices.ClipboardProxy in VBA?", "body": "<p>Is there a way to access the <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualbasic.myservices.clipboardproxy?view=netframework-4.8\" rel=\"nofollow noreferrer\"><code>ClipboardProxy</code> class</a> from VBA?</p>\n\n<p>Many classes can be instantiated via <code>CreateObject</code>, e.g.:</p>\n\n<pre><code>Set obj = CreateObject(\"Excel.Application\")\nSet obj = CreateObject(\"System.Collections.ArrayList\")\nSet obj = CreateObject(\"Scripting.Dictionary\")\n' etc.\n</code></pre>\n\n<p>I'm unable to figure out what the appropriate <em>ClassName</em> would be, or whether any DLL reference(s) need to be added in order to use this class in VBA.</p>\n\n<p><strong>NOTE</strong>: I'm aware of how to instantiate a <code>DataObject</code>, but this is not the same thing. (Related: The <code>ClipboardProxy.GetDataObject</code> returns a <code>DataObject</code>. But I'm looking specifically for the <code>ClipboardProxy</code> class, not the <code>IDataObject</code>).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1560349076, "post_id": 56564300, "comment_id": 99708222, "body": "add this before the line that errors: <code>newformula = Replace(newformula, Char(34), Char(34) &amp; Char(34))</code>  the quotes in the string need to be doubled."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1560349113, "post_id": 56564300, "comment_id": 99708238, "body": "You don&#39;t need a loop to <code>Replace</code>, you can just use <code>Range.Replace</code>."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 3, "creation_date": 1560349202, "post_id": 56564300, "comment_id": 99708289, "body": "Also, when you are declaring multiple variables on a single line, each of those variable should include the type individually. Otherwise, those variables without a type will be declared as <code>Variant</code>. So your line should be <code>Dim StudyYear As ListObject, SponsorYear As ListObject, Analythics As ListObject</code>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1560349888, "post_id": 56564300, "comment_id": 99708697, "body": "@ScottCraner no not if they are in a variable. They only need to be doubled if you hardcode a string with quotes in the code itself."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1560350149, "post_id": 56564300, "comment_id": 99708833, "body": "@nicolas Make sure that the formula is correct and the address does exist. Check <code>Debug.Print newformula</code> right before the error line and check if this contains the desired formula. Probably the <code>Estudios</code> for <code>currentyear</code> don&#39;t exist."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1560353676, "post_id": 56564300, "comment_id": 99710984, "body": "You set <code>currentyear = a&#241;oprevio + 1</code> but as far as I see you don&#39;t declare nor initialize <code>a&#241;oprevio</code>."}, {"owner": {"reputation": 1, "user_id": 11595602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-simDdnJBikg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd_Xz4cIcciQ8beaZXy3VfNy1_qqw/mo/photo.jpg?sz=128", "display_name": "Nicolas Sandrini", "link": "https://stackoverflow.com/users/11595602/nicolas-sandrini"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1560857132, "post_id": 56564300, "comment_id": 99865678, "body": "@P\u1d07\u029c genius! That&#39;s exactly what was happening. It wasn&#39;t a code problem, but excel couldn&#39;t find Estudios2020 because it didn&#39;t exist. It&#39;s a table that&#39;s named after adding the new sheet. Thanks so much!"}, {"owner": {"reputation": 1, "user_id": 11595602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-simDdnJBikg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd_Xz4cIcciQ8beaZXy3VfNy1_qqw/mo/photo.jpg?sz=128", "display_name": "Nicolas Sandrini", "link": "https://stackoverflow.com/users/11595602/nicolas-sandrini"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1560857266, "post_id": 56564300, "comment_id": 99865757, "body": "@FunThomas yes sorry, i have corrected it. The real variables are in spanish, I translated them just for this post."}], "owner": {"reputation": 1, "user_id": 11595602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-simDdnJBikg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd_Xz4cIcciQ8beaZXy3VfNy1_qqw/mo/photo.jpg?sz=128", "display_name": "Nicolas Sandrini", "link": "https://stackoverflow.com/users/11595602/nicolas-sandrini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560439497, "creation_date": 1560348886, "last_edit_date": 1560439497, "question_id": 56564300, "link": "https://stackoverflow.com/questions/56564300/run-time-error-1004-app-defined-or-object-defined-error-when-working-on-thiswork", "title": "Run time error 1004 App-defined or object-defined error When working on ThisWorkbook with .Formula", "body": "<p>I'm adding a new line to a table each time a new sheet is added to the workbook, that's why I write the code in <code>ThisWorkbook</code> - event <code>NewSheet</code>. In order to modify the formula that is automatically written in the new line to make it search the data in a new sheet, I loop through the columns and replace \"2013\" with the actual year (which is the new sheet name).<br>\nThe first time the code is run it goes perfectly. Then the second time it returns the error.<br>\nI have been looking in the forum for days but couldn't find the answer. I'm using Excel 2016.</p>\n\n<p>I have tried several things but really without theoretical knowledge.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Workbook_NewSheet(ByVal Sh As Object)\n    Stop\n    Dim lastfileStudyYear, lastfileSponsorYear, lastfileAnalythics As Long\n    Dim i, uformula, lastyear, currentyear, newformula\n    Dim StudyYear, SponsorYear, Analythics As ListObject\n    Set StudyYear = Worksheets(\"Datos KPI\").ListObjects(\"StudyvsYear\")\n    Set SponsorsA\u00f1o = Worksheets(\"Datos KPI\").ListObjects(\"SponsorsvsYear\")\n    Set Analythics = Worksheets(\"Datos KPI\").ListObjects(\"Analythics\")\n\n    lastfileStudyYear = StudyYear.Range.Rows.Count + 1\n    Worksheets(\"Datos KPI\").Rows(lastfileStudyYear).Insert\n\n    lastyear= Worksheets(\"Datos KPI\").Cells(lastfileStudyYear- 1, 1).Value\n    currentyear = lastyear + 1\n\n    Worksheets(\"Datos KPI\").Cells(lastfileStudyYear, 1).Value = currentyear \n\n    colStudyYear = StudyYear.DataBodyRange.Columns.Count\n\n    For i = 2 To colStudyYear \n        newformula = StudyYear.DataBodyRange.Cells(lastfileStudyYear- 1, i).Formula\n        newformula = Replace(newformula, \"2013\", currentyear)\n        StudyYear.DataBodyRange.Cells(lastfileStudyYear- 1, i).Formula = newformula '&lt;- HERE IS THE ERROR!!!!!!!!!!!!\n    Next\n</code></pre>\n\n<p>I expect the formula in the <code>Cell(lastfileStudyYear- 1, i)</code> to change from\n<code>=COUNTIF(Estudios2013[FA],\"x\")</code>\nto <code>=COUNTIF(Estudios2020[FA],\"x\")</code></p>\n\n<p>But the actual output is a ERROR.<br>\nMany thanks!</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 3021, "user_id": 11606193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DXr7w.jpg?s=128&g=1", "display_name": "Deepstop", "link": "https://stackoverflow.com/users/11606193/deepstop"}, "is_accepted": false, "score": 1, "last_activity_date": 1560348885, "creation_date": 1560348885, "answer_id": 56564299, "question_id": 56564064, "link": "https://stackoverflow.com/questions/56564064/ms-access-vba-on-dateadds-for-current-day/56564299#56564299", "title": "MS Access VBA on Dateadd&#39;s for current day", "body": "<p>This seems to work.</p>\n\n<pre><code>thisday = date()\n\ndateadd(\"d\",7-weekday(thisday, vbTuesday), thisday)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 142, "user_id": 6570713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SrIS2.jpg?s=128&g=1", "display_name": "Alvaro CC", "link": "https://stackoverflow.com/users/6570713/alvaro-cc"}, "is_accepted": true, "score": 1, "last_activity_date": 1560348994, "creation_date": 1560348994, "answer_id": 56564331, "question_id": 56564064, "link": "https://stackoverflow.com/questions/56564064/ms-access-vba-on-dateadds-for-current-day/56564331#56564331", "title": "MS Access VBA on Dateadd&#39;s for current day", "body": "<p>This should also work: </p>\n\n<p><code>\n DateAdd('d',(8-Weekday(Date(),4)) mod 7,Date())\n</code></p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1560349381, "creation_date": 1560349381, "answer_id": 56564458, "question_id": 56564064, "link": "https://stackoverflow.com/questions/56564064/ms-access-vba-on-dateadds-for-current-day/56564458#56564458", "title": "MS Access VBA on Dateadd&#39;s for current day", "body": "<p>If you do not need to use a 1 line solution, then a small function would be quite handy. It checks the current day with <code>Weekday()</code> and if it is <code>vbMonday</code> it returns it. If not, it gives the next Monday.</p>\n\n<pre><code>Public Function NextMonday(selectedDate As Date) As Date\n\n    Dim returnMonday As Date\n\n    If Weekday(selectedDate) = vbMonday Then\n        NextMonday = selectedDate\n    Else\n        NextMonday = selectedDate + 8 - Weekday(selectedDate, vbMonday)\n    End If\n\nEnd Function\n</code></pre>\n\n<p>And it works:</p>\n\n<pre><code>Sub TestMe()\n\n    'Monday:\n    Debug.Print NextMonday(DateSerial(2019, 6, 10))\n    Debug.Print NextMonday(DateSerial(2019, 6, 17))\n\n    'Not Monday:\n    Debug.Print NextMonday(DateSerial(2019, 6, 7))\n    Debug.Print NextMonday(DateSerial(2019, 6, 11))\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 56564331, "answer_count": 3, "score": 0, "last_activity_date": 1594715894, "creation_date": 1560348095, "last_edit_date": 1594715894, "question_id": 56564064, "link": "https://stackoverflow.com/questions/56564064/ms-access-vba-on-dateadds-for-current-day", "title": "MS Access VBA on Dateadd&#39;s for current day", "body": "<p>I've got a question on the dateadd statement I'm using. The idea is that a form pops up with the day of the week and you can select it to add a due date. \nIE: You select Monday and if it is Monday then it will give you a due day of Monday but if it's Tuesday then the following Monday will be used for your due date.</p>\n\n<p>The issue is that if it's Monday and you select Monday it is giving you the following Monday as a due date and not that current day.</p>\n\n<p>Here is the statement I'm using...</p>\n\n<pre><code> DateAdd('d',8-Weekday(Date(),4),Date())\n</code></pre>\n\n<p>I'm not sure how to make this correction since this seems correct to me. \nAny help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "office365"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560349369, "post_id": 56564044, "comment_id": 99708393, "body": "First of all test if macros run at all. Add a test <code>Sub</code> into that file and let it throw a message box for example <code>MsgBox &quot;I run!&quot;</code> and run the procedure. If you don&#39;t see the box there is a macro security issue. If you see the box there is issue with your file or code."}, {"owner": {"reputation": 31, "user_id": 5616290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ba5b0b370760900b54fae192aa01a0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uddama", "link": "https://stackoverflow.com/users/5616290/mahesh-uddama"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560350154, "post_id": 56564044, "comment_id": 99708840, "body": "Macros run, if the source file of macros opened. which happened automatically before. now it become manual."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5616290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ba5b0b370760900b54fae192aa01a0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uddama", "link": "https://stackoverflow.com/users/5616290/mahesh-uddama"}, "edited": false, "score": 0, "creation_date": 1560361020, "post_id": 56566875, "comment_id": 99714468, "body": "added some screen shots, confirms the macros are fine and executable when the source file is opened. but previously if the source file is not opened, first it opens in background and execute. seems it loose some level of permission with the update"}], "tags": [], "owner": {"reputation": 142, "user_id": 6570713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SrIS2.jpg?s=128&g=1", "display_name": "Alvaro CC", "link": "https://stackoverflow.com/users/6570713/alvaro-cc"}, "is_accepted": false, "score": 0, "last_activity_date": 1560357654, "creation_date": 1560357654, "answer_id": 56566875, "question_id": 56564044, "link": "https://stackoverflow.com/questions/56564044/macros-from-another-workbook-stopped-working-after-office-update/56566875#56566875", "title": "Macros from another workbook stopped working after office update", "body": "<p>Well , I would start by checking whether \"open\" macros works  in \"master.xlsm\" something like this:</p>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/V2v9V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V2v9V.png\" alt=\"Thisworkbook_open\"></a></p>\n\n<hr>\n\n<p>This will not probably fix your problem , but could show some light on where the problem is</p>\n\n<p>Also posting here some of the code in master.xlsm would help </p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 5616290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ba5b0b370760900b54fae192aa01a0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uddama", "link": "https://stackoverflow.com/users/5616290/mahesh-uddama"}, "edited": false, "score": 0, "creation_date": 1560414501, "post_id": 56574302, "comment_id": 99730711, "body": "no,  normal workbooks are not  macro enabled, so i cannot place vba codes there. custom toolbar tries directly to access macros. keep remember that it worked before for more than 2 years."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 31, "user_id": 5616290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ba5b0b370760900b54fae192aa01a0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uddama", "link": "https://stackoverflow.com/users/5616290/mahesh-uddama"}, "edited": false, "score": 0, "creation_date": 1560414964, "post_id": 56574302, "comment_id": 99730969, "body": "If your code runs from a custom toolbar you should consider placing it into the PERSONAL.XLSB to make that working: See <a href=\"https://support.office.com/en-us/article/copy-your-macros-to-a-personal-macro-workbook-aa439b90-f836-4381-97f0-6e4c3f5ee566?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">Copy your macros to a Personal Macro Workbook</a> \u2022 I assume you had the <code>master.xlsm</code> auto loading on Excel&#39;s start in your previous installation without rememering that."}, {"owner": {"reputation": 31, "user_id": 5616290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ba5b0b370760900b54fae192aa01a0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uddama", "link": "https://stackoverflow.com/users/5616290/mahesh-uddama"}, "edited": false, "score": 0, "creation_date": 1560417620, "post_id": 56574302, "comment_id": 99732403, "body": "this approach to make sure macros visible to all workbooks every open excel, i get that. in this way i cannot export the custom toolbar and work in a different pc as it needs to manually transfer all macro to the new pc and place in roaming folder and change all custom toolbar macro path to new user&#39;s roaming folder. this was the reason the master file was in c:\\master folder so all users of this toolbar and macro could adopt it easily."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 31, "user_id": 5616290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ba5b0b370760900b54fae192aa01a0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uddama", "link": "https://stackoverflow.com/users/5616290/mahesh-uddama"}, "edited": false, "score": 0, "creation_date": 1560497905, "post_id": 56574302, "comment_id": 99763944, "body": "@MaheshUddama then you should probably create an add-in or use <a href=\"https://stackoverflow.com/questions/8850836/how-to-add-a-custom-ribbon-tab-using-vba\">this thechnique</a>"}, {"owner": {"reputation": 31, "user_id": 5616290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ba5b0b370760900b54fae192aa01a0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uddama", "link": "https://stackoverflow.com/users/5616290/mahesh-uddama"}, "edited": false, "score": 0, "creation_date": 1560509858, "post_id": 56574302, "comment_id": 99769611, "body": "in a worst case i will try, right now im expecting to find a fix for the difference made in a recent update, probably a security exception, registry edit or policy change. because it worked for long time even with office 365 starting from office 2013."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1560406197, "creation_date": 1560406197, "answer_id": 56574302, "question_id": 56564044, "link": "https://stackoverflow.com/questions/56564044/macros-from-another-workbook-stopped-working-after-office-update/56574302#56574302", "title": "Macros from another workbook stopped working after office update", "body": "<p>Well you can only run a macro in <code>master.xlsm</code> when it is opened. If it is closed you cannot run the macro in it, you need to open it first. Eg use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbooks.open\" rel=\"nofollow noreferrer\">Workbooks.Open method</a> to open it first.</p>\n\n<pre><code>Dim MasterWb As Workbook\n\nOn Error Resume Next 'test if master.xlsm is already open\nSet MasterWb = Workbooks(\"master.xlsm\")\nOn Error Goto 0\n\nIf MasterWb Is Nothing Then 'if it was closed open/run/close it\n    Set MasterWb = Workbooks.Open(\"C:\\Main\\master.xlsm\")\n    Application.Run \"master.xlsm!macro1\"\n    MasterWb.Close SaveChanges:=False\nElse 'if it was already opened just run macro and don't close it (or you might loose changes that were already made)\n    Application.Run \"master.xlsm!macro1\"\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5616290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ba5b0b370760900b54fae192aa01a0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uddama", "link": "https://stackoverflow.com/users/5616290/mahesh-uddama"}, "is_accepted": true, "score": 1, "last_activity_date": 1562275426, "creation_date": 1562275426, "answer_id": 56894333, "question_id": 56564044, "link": "https://stackoverflow.com/questions/56564044/macros-from-another-workbook-stopped-working-after-office-update/56894333#56894333", "title": "Macros from another workbook stopped working after office update", "body": "<p>after all Microsoft accepted that this is an issue in Office 365 Monthly and Monthly (targeted) channels, and they have fixed it already in Monthly targeted channel and waiting for the Monthly channel fix.\napparently semi annual and annual channels were not affected by this issue in the first place because of they bring the most stable updates from Monthly channels to the semi annual and annual channels. \ni think its good to choose semi annual or annual update channel if you are small business and not eagerly waiting for every single update immediately every month. </p>\n\n<p>Answer\n<a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_win10-mso_o365b/macros-from-another-workbook-stopped-working-after/9779bd5f-e858-4213-9ea6-95597e867a07?messageId=4d2e3ce7-350d-4bfd-82b2-f54c8654016e&amp;page=1\" rel=\"nofollow noreferrer\">https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_win10-mso_o365b/macros-from-another-workbook-stopped-working-after/9779bd5f-e858-4213-9ea6-95597e867a07?messageId=4d2e3ce7-350d-4bfd-82b2-f54c8654016e&amp;page=1</a></p>\n\n<p>Overview of update channels\n<a href=\"https://docs.microsoft.com/en-us/deployoffice/overview-of-update-channels-for-office-365-proplus#visual-representation-of-the-update-channels-for-office-365-proplus\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/deployoffice/overview-of-update-channels-for-office-365-proplus#visual-representation-of-the-update-channels-for-office-365-proplus</a></p>\n"}], "owner": {"reputation": 31, "user_id": 5616290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32ba5b0b370760900b54fae192aa01a0?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uddama", "link": "https://stackoverflow.com/users/5616290/mahesh-uddama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1810, "favorite_count": 0, "accepted_answer_id": 56894333, "answer_count": 3, "score": 1, "last_activity_date": 1562275426, "creation_date": 1560348030, "last_edit_date": 1560360881, "question_id": 56564044, "link": "https://stackoverflow.com/questions/56564044/macros-from-another-workbook-stopped-working-after-office-update", "title": "Macros from another workbook stopped working after office update", "body": "<p>I have a excel workbook with macros (master.xlsm) and these macros can be accessed by other workbooks via custom toolbar in excel. \npreviously when a normal workbook opens and access one of these macros in the custom toolbar, </p>\n\n<ol>\n<li>if master.xlsm not opened yet, then it opens in the background and execute the macro to the normal workbook</li>\n<li>if master.xlsm already opened, then execute macro directly to the normal workbook. </li>\n</ol>\n\n<p>now with a recent office 365 update, method (1) is blocked. therefore i have to manually open the master.xlsm to execute the macros. </p>\n\n<p>now in (1) it shows, </p>\n\n<p>[cannot run the macro \"C:\\Main\\master.xlsm'!macro1\" macro may be not avaiable or all macros may be disabled]</p>\n\n<p>Tried in a different PC, with windows 10 upto date and office 365 upto date. it works, and the built version of office 365 in the working pc is MSO(16.0.11328....) and the faulty pc is MSO(16.0.11727....)\nthis can be an obvious reason, but both versions office 365 is upto date. </p>\n\n<p>both PCs have same macro security levels and master.xlsm location has added as a trusted location in excel trust center locations. </p>\n\n<p>also an update ago faulty PC also worked so all files and settings are identical.</p>\n\n<p>my question has excel vba security criteria changed? or how to solve without downgrading office built version. </p>\n\n<p>below image 1 when master.xlsm not opened so it gives the error\nimage 2 when master.xlsm is opened so it execute macro and insert text to the book1.xlsx</p>\n\n<p><a href=\"https://i.stack.imgur.com/OP0OO.png\" rel=\"nofollow noreferrer\">when master xlsm not opened</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/TpV6O.png\" rel=\"nofollow noreferrer\">when master xlsm is opened</a></p>\n"}, {"tags": ["html", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1560352709, "post_id": 56565298, "comment_id": 99710376, "body": "It&#39;s saying error 438 (object doesn&#39;t support this property or method) on the While .Busy line right before t= Timer"}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1560352798, "post_id": 56565298, "comment_id": 99710436, "body": "Also, I commented out that line to see the issue, but I sitll have this same issue where it is looping through over and over"}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1560354059, "post_id": 56565298, "comment_id": 99711176, "body": "Ok my old code works if i do it piece by piece, however yours works if I just press continue"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1560354407, "post_id": 56565298, "comment_id": 99711349, "body": "It is method of internet explorer so should not complain. Did you just add in your url?"}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1560432407, "post_id": 56565298, "comment_id": 99740946, "body": "Yes, the stop command works. However, if I individually loop through the program, it loops and loops and loops till it works. If I just press play- the program works"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1560435066, "post_id": 56565298, "comment_id": 99742786, "body": "That is how it is supposed to run. It means it is working properly. It loops until the required element is present. Removed the need for pressing f8."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1560351934, "creation_date": 1560351934, "answer_id": 56565298, "question_id": 56564013, "link": "https://stackoverflow.com/questions/56564013/search-a-webpage-and-click-on-a-button/56565298#56565298", "title": "Search a webpage and click on a button", "body": "<p>Try adding a timed loop for element to be present, proper page load waits and also using querySelector to remove your current loop and simply target the attribute value of input element</p>\n\n<pre><code>Option Explicit\n\n'VBE &gt; Tools &gt; References: Microsoft Internet Controls\nPublic Sub ClickElement()\n    Dim ie As Object, elems As Object, t As Date\n    Const MAX_WAIT_SEC As Long = 10\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    With ie\n        .Visible = True\n        .Navigate2 \"url\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document.forms(\"signinginn\")\n            .User.Value = \"username\"\n            .Password.Value = \"password\"\n            .document.forms(0).submit\n        End With\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        t = Timer\n        Do\n            On Error Resume Next\n            Set elems = .document.querySelectorAll(\"input[value=Start]\")\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While elems Is Nothing\n        If Not elems Is Nothing Then\n            elems.item(0).Click\n        Else\n            Exit Sub\n        End If\n        'Other code\n        Stop   '&lt;=Delete me later\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 56565298, "answer_count": 1, "score": 1, "last_activity_date": 1565074778, "creation_date": 1560347959, "last_edit_date": 1565074778, "question_id": 56564013, "link": "https://stackoverflow.com/questions/56564013/search-a-webpage-and-click-on-a-button", "title": "Search a webpage and click on a button", "body": "<p>I am trying to use VBA on a webpage. I figured out how to log on and submit my username and password.</p>\n\n<p>I need to click 3 buttons. They appear once the previous button has been clicked. I have my if statements, which do work if I go through the code piece by piece.</p>\n\n<p>It looks like it loops through each statement several times. It goes through the if then part, then to exit for, end if, next and goes back to the if statement without accomplishing the task. It does this several times until eventually it works.</p>\n\n<p>I have tried <code>.document.getElementsbyId</code> and all those related to that do not work.</p>\n\n<p>Maybe there is a way to search the document and get it to click the button?</p>\n\n<p>It seems its not working because its not true till eventually it is?</p>\n\n<pre><code>'Enters username and password &amp; submits\n\nWith .document.forms(\"signinginn\")\n    .User.Value = \"username\"\n    .Password.Value = \"password\"\n    .document.forms(0).submit\nEnd With\n\nApplication.Wait DateAdd(\"s\", 2, Now)\n\nWith IE.document\n    Set a = .getElementsbyTagName(\"input\") \n\n    For Each a In .getElementsbyTagName(\"input\")\n\n        If a.getAttribute(\"value\") = \"Start\" Then\n            a.Click\n            Exit For\n        End If\n\n    Next a\n</code></pre>\n\n<p>This code works if I play it part by part, but it goes through several times.</p>\n\n<p>Am I able to get it right the first time? The expected output of this code is to immediately click the button.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1560346737, "post_id": 56563555, "comment_id": 99706668, "body": "Don&#39;t you have this data on your worksheet? Because you can just <code>arr = Range(&quot;A1:E7&quot;).Value</code> and you get a 2D array like your sheet."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1560346925, "post_id": 56563555, "comment_id": 99706795, "body": "Note that in an array <code>arr(1 To 10, 1 To 5)</code> you can only <code>ReDim</code> the second parameter <code>1 To 5</code> but not the first one <code>1 To 10</code> without loosing the data. Therefore you cannot add &quot;rows&quot; but only &quot;columns&quot; to that array."}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1560351622, "post_id": 56563555, "comment_id": 99709751, "body": "If you are looking to use an identifier, you may want to look at using a collection or dictionary instead"}], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 2, "last_activity_date": 1560347210, "creation_date": 1560347210, "answer_id": 56563767, "question_id": 56563555, "link": "https://stackoverflow.com/questions/56563555/insert-range-of-values-into-a-multidimensional-array/56563767#56563767", "title": "Insert range of values into a multidimensional array", "body": "<p>You can fill an array from a range on your sheet like this:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim arr\n\n    With ThisWorkbook.Sheets(\"Data\")\n        arr = .Range(\"A1:E6\")\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>So a range like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bm66l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bm66l.png\" alt=\"Data\"></a></p>\n\n<p>Turns into a array like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5TC51.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5TC51.png\" alt=\"Array\"></a></p>\n\n<p>So you don't need to loop at all, which means faster  execution and cheaper to code.</p>\n"}], "owner": {"reputation": 235, "user_id": 5374245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fecb475bd50e5fe9c608cbba5bd767bf?s=128&d=identicon&r=PG&f=1", "display_name": "ChartProblems", "link": "https://stackoverflow.com/users/5374245/chartproblems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 56563767, "answer_count": 1, "score": 0, "last_activity_date": 1560347545, "creation_date": 1560346532, "last_edit_date": 1560347545, "question_id": 56563555, "link": "https://stackoverflow.com/questions/56563555/insert-range-of-values-into-a-multidimensional-array", "title": "Insert range of values into a multidimensional array", "body": "<p>I am trying to create a multidimensional array where the first column contains identifiers and the adjacent columns contains data relevant to that identifier. So for instance I would like to create an array with the following structure:</p>\n\n<pre><code>Banana  10  20  30  40\nCoconut 5   10  2   4\nApple   3   4   5   6\n</code></pre>\n\n<p>The construction of the array begins with the definition of the relevant identifiers. So for instance in the above that would be Banana, Coconut and Apple. The data I use to construct the array would have a layout as in the below:</p>\n\n<pre><code>Banana  10  20  30  40\nParrot  5   3   1   4\nApple   3   4   5   6\nCar     10  20  30  40\nDonkey  4   12  3   0\nCoconut 5   10  2   4\n</code></pre>\n\n<p>As such, I start out by defining the Banana, Coconut and Apple identifiers and then want to automatically populate my array based on a loop through of identifier name in the data (I have defined this as \"INPUT\"). However, I am unsure of how to correctly insert the adjacent data in my array every time there is a match of identifiers. I would much appreciate if someone can explain how I can do this based on the code below.</p>\n\n<pre><code>identifierArray = Array(\"Banana\", \"Coconut\", \"Apple\")\nNumElements = UBound(identifierArray) - LBound(identifierArray) + 1\n\nFor Each Element In identifierArray\n    ReDim Preserve arr(0 To NumElements, x)\n    arr(i, 0) = identifierArray(i)\n    i = i + 1\nNext Element\n\nFor Each cell In ws.Range(\"INPUT\")\n    For Each Element In identifierArray\n        If cell.Value = Element Then\n\n         [Need help here]\n\n        End If\n    Next Element\nNext cell\n</code></pre>\n\n<p>I don't need help with creating VLOOKUP or INDEX/MATCH solutions as that is not relevant to the above.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 689, "user_id": 4731063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RNPgT.png?s=128&g=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/4731063/pants"}, "edited": false, "score": 0, "creation_date": 1560346713, "post_id": 56563398, "comment_id": 99706653, "body": "Are you trying to run this before or after? You say after, but in your last sentence you say &quot;after 0.5 seconds that my form will be loaded and records will be displayed in the form controls.&quot; So are you trying to run something before, or after? Is this the initial Form?"}, {"owner": {"reputation": 258, "user_id": 6348445, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X6CAwCGEuIM/AAAAAAAAAAI/AAAAAAAAACY/ZmW2Kus0yoM/photo.jpg?sz=128", "display_name": "Ants", "link": "https://stackoverflow.com/users/6348445/ants"}, "reply_to_user": {"reputation": 689, "user_id": 4731063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RNPgT.png?s=128&g=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/4731063/pants"}, "edited": false, "score": 0, "creation_date": 1560347716, "post_id": 56563398, "comment_id": 99707300, "body": "@Pants I want call Module6.loadRecords when the form loads. The issue with that is that in my loadRecords sub I&#39;m looking for &quot;activeForm&quot; but there is no active form while the form loads... which is why I want to put the call to loadrecords to after the form loads... unless you know of a different way of calling activeForm ( I use this because in modules you need to specify which form you want to load records in)"}], "answers": [{"comments": [{"owner": {"reputation": 258, "user_id": 6348445, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X6CAwCGEuIM/AAAAAAAAAAI/AAAAAAAAACY/ZmW2Kus0yoM/photo.jpg?sz=128", "display_name": "Ants", "link": "https://stackoverflow.com/users/6348445/ants"}, "edited": false, "score": 0, "creation_date": 1560357312, "post_id": 56564263, "comment_id": 99712824, "body": "worked like a charm! I decided to go with your first suggestion. Thank you!"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1560348799, "creation_date": 1560348799, "answer_id": 56564263, "question_id": 56563398, "link": "https://stackoverflow.com/questions/56563398/how-to-run-vba-macro-after-an-access-form-has-loaded/56564263#56564263", "title": "How to run vba macro after an access form has loaded?", "body": "<p>Instead of depending on <code>Screen.ActiveForm</code>, you should simply pass the form reference to the function.</p>\n\n<pre><code>Private Sub Form_Load()\n    Call Module6.loadRecords(Me)\nEnd Sub\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Public Sub loadRecords(F As Access.Form)\n</code></pre>\n\n<hr>\n\n<p>If you really want to use <code>Screen.ActiveForm</code>, it works like this:</p>\n\n<pre><code>Private Sub Form_Load()\n    ' 1 ms is enough to de-couple the events\n    Me.TimerInterval = 1\nEnd Sub\n\nPrivate Sub Form_Timer()\n    ' Reset timer, always the first thing to do for single Timer events\n    Me.TimerInterval = 0\n\n    Call Module6.loadRecords\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 258, "user_id": 6348445, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X6CAwCGEuIM/AAAAAAAAAAI/AAAAAAAAACY/ZmW2Kus0yoM/photo.jpg?sz=128", "display_name": "Ants", "link": "https://stackoverflow.com/users/6348445/ants"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 0, "accepted_answer_id": 56564263, "answer_count": 1, "score": 0, "last_activity_date": 1594715907, "creation_date": 1560346032, "last_edit_date": 1594715907, "question_id": 56563398, "link": "https://stackoverflow.com/questions/56563398/how-to-run-vba-macro-after-an-access-form-has-loaded", "title": "How to run vba macro after an access form has loaded?", "body": "<p>When I call a sub in Form_Load, it gives me an error cause by Screen.ActiveForm. This is due to the form not being loaded yet.</p>\n\n<p>What sub/function can I use to run a macro once the form has loaded.</p>\n\n<ul>\n<li>I tried Form_Timer, it didn't do anything </li>\n<li>Form_Activate produces same error </li>\n<li>Form_after\u2026 they do not really seem to indicating anything after form load.</li>\n</ul>\n\n<p>Here is my code for Form_Timer:</p>\n\n<pre><code>Private Sub Form_Timer()\n    call Module6.loadRecords\n    Me.TimerInterval = 500\nEnd Sub\n</code></pre>\n\n<p>I was hoping that after 0.5 seconds that my form will be loaded and records will be display in the form controls.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 3, "creation_date": 1560345972, "post_id": 56563365, "comment_id": 99706167, "body": "What is <code>NumRows</code>?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1560346127, "post_id": 56563365, "comment_id": 99706275, "body": "Right before the <code>For</code> loop, set your <code>NumRows</code> variable (currently it&#39;s not set so your loop isn&#39;t looping anything). <code>NumRows = 10</code>. Then you should see some magic happening. I just guessed at <code>10</code> though so you&#39;ll need to set that to whatever makes sense for your sheet. Once that is working then you may want to figure out how to <a href=\"https://stackoverflow.com/questions/39470412/last-row-in-column-vba\">dynamically set <code>NumRows</code> to the last occupied row in one of these columns</a>."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 3, "last_activity_date": 1560347326, "last_edit_date": 1560347326, "creation_date": 1560346177, "answer_id": 56563437, "question_id": 56563365, "link": "https://stackoverflow.com/questions/56563365/how-to-loop-through-a-column-adding-values-from-a-second-column/56563437#56563437", "title": "How to loop through a column adding values from a second column?", "body": "<p>Make sure you always write <code>Option Explicit</code> on the top of the module. Thus, it will make sure that all the variables in the code are declared. In the code above it was not entering the loop, because <code>NumRows</code> was undeclared, thus with a value of <code>0</code>. Try this instead:</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\n    Dim i As Long\n    For i = 2 To 10\n        With Worksheets(1)\n            .Cells(i, 4).Value = WorksheetFunction.Sum(.Cells(i, 4).Value, .Cells(i, 5).Value)\n        End With\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 0, "last_activity_date": 1560346221, "creation_date": 1560346221, "answer_id": 56563452, "question_id": 56563365, "link": "https://stackoverflow.com/questions/56563365/how-to-loop-through-a-column-adding-values-from-a-second-column/56563452#56563452", "title": "How to loop through a column adding values from a second column?", "body": "<p>I don't think NumRows is populated, if the code is completely as in your question</p>\n\n<p>Try</p>\n\n<pre><code>Sub zeroAndAdd0_Click()\nDim i As Long, NumRows As Long, csum As Double\nDim c As Range\n\nWith Workbooks(REF).Sheets(REF)\n    NumRows = .Cells(.Rows.Count, \"D\").End(xlUp).Row 'last row in Col D\n    'For each is faster than For i when looping through a range\n    For Each c In Range(\"D2:D\" &amp; NumRows) \n        csum = c.Value + c.Offset(,1).Value 'Populate a variable with the sum of the two cells\n        c.Value = csum 'Populate the cell in col D with the sum\n        c.Offset(,1).Value = 0 'Set the other cell to 0\n    Next c\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Info in the commented out code</p>\n"}, {"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1560346337, "creation_date": 1560346337, "answer_id": 56563492, "question_id": 56563365, "link": "https://stackoverflow.com/questions/56563365/how-to-loop-through-a-column-adding-values-from-a-second-column/56563492#56563492", "title": "How to loop through a column adding values from a second column?", "body": "<p>This will work:</p>\n\n<pre><code>Sub zeroAndAdd0_Click()\n\n    For i = 2 To Cells(Rows.Count, 4).End(xlUp).Row\n\n        Cells(i, 4).Value = Cells(i, 4).Value + Cells(i, 5).Value\n        Cells(i, 5).Value = 0\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>It will do both of the job for you. no need to use <code>Worksheet Function</code></p>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 9194283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6f5747469dba4701518064bbfc9a63?s=128&d=identicon&r=PG&f=1", "display_name": "SoopahTree", "link": "https://stackoverflow.com/users/9194283/soopahtree"}, "is_accepted": false, "score": 0, "last_activity_date": 1560346374, "last_edit_date": 1560346374, "creation_date": 1560346344, "answer_id": 56563496, "question_id": 56563365, "link": "https://stackoverflow.com/questions/56563365/how-to-loop-through-a-column-adding-values-from-a-second-column/56563496#56563496", "title": "How to loop through a column adding values from a second column?", "body": "<p>You just need to define your NumRows variable (i.e. NumRows = Sheet1.Range(\"D\" &amp; Rows.Count).End(xlUp).Row), then finish off with converting the values in column E to 0. So something like:</p>\n\n<pre><code>Sub zeroAndAdd0_Click()\n\n    Dim NumRows, i As Long\n    NumRows = Sheet1.Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = 2 To NumRows\n        Cells(i, 4).Value = WorksheetFunction.Sum(Cells(i, 4).Value, Cells(i, 5).Value)\n        Cells(i, 5).Value = 0\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1560347707, "last_edit_date": 1560347707, "creation_date": 1560346834, "answer_id": 56563647, "question_id": 56563365, "link": "https://stackoverflow.com/questions/56563365/how-to-loop-through-a-column-adding-values-from-a-second-column/56563647#56563647", "title": "How to loop through a column adding values from a second column?", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub zeroAndAdd0_Click()\n\n    Dim NumRows As Long\n\n    'Change Sheet name\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        'NumRows take tha value of a fix number\n        NumRows = 10\n        'NumRows take the value of Column D last row\n        NumRows = .Cells(.Rows.Count, \"D\").End(xlUp).Row\n\n        .Range(.Cells(2, 4), .Cells(NumRows, 4)).Formula = \"=Sum(D2,E2)\"\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8042737"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1560348220, "creation_date": 1560345930, "last_edit_date": 1560348220, "question_id": 56563365, "link": "https://stackoverflow.com/questions/56563365/how-to-loop-through-a-column-adding-values-from-a-second-column", "title": "How to loop through a column adding values from a second column?", "body": "<p>I have two columns in a table, let's say a and b. The value of the cells in a, when the macro is implemented, will be a = a + b. After the addition is performed, all the values in column b will be set to 0.</p>\n\n<p>I've tried using a for loop to loop through every cell in the columns and adding the values but nothing happens.</p>\n\n<pre><code>Sub zeroAndAdd0_Click()\n\n    For i = 2 To NumRows\n        Cells(i, 4).Value = WorksheetFunction.Sum(Cells(i, 4).Value, Cells(i,5).Value)\n    Next i    \n\nEnd Sub\n</code></pre>\n\n<p>No error message occurs but nothing actually happens when I test it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560346503, "post_id": 56563281, "comment_id": 99706511, "body": "Actually you can just sort by column priority and rewrite the numbers <code>1\u2026n</code>. But it is unclear what happens if the user enters a priority that already exists in the list. Can you clarify?"}, {"owner": {"reputation": 81, "user_id": 10711720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd78c8a2a55ec52e0aca62217e044cb?s=128&d=identicon&r=PG&f=1", "display_name": "ROCA", "link": "https://stackoverflow.com/users/10711720/roca"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560347008, "post_id": 56563281, "comment_id": 99706856, "body": "If the user enters a priority that already exists, the priority that are lower don&#180;t change, the priority that are higher or equal than the new priority should move (add 1?). The ideal end result is a list of numbers ( 1 to 30), even if it is not in order (I&#180;ll rearrange later), but there cannot be repeated numbers or numbers missing."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560347360, "post_id": 56563281, "comment_id": 99707078, "body": "In that case it would be more complicated. You need to check if the new priority (eg <code>10</code>) already exists. If it exists subtract a very small number like <code>0.01</code> so you write <code>9.99</code> this way it will be sorted below the existing <code>10</code>. Then use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.sort\" rel=\"nofollow noreferrer\">Range.Sort method</a> to sort your data by priority. After that loop through priority column and write ascending numbers starting with <code>1</code>. So you will end up with ascending numbers without skips or doubles."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560347538, "post_id": 56563281, "comment_id": 99707182, "body": "Read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. You should steer clear from <code>Activate</code> as well"}, {"owner": {"reputation": 81, "user_id": 10711720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd78c8a2a55ec52e0aca62217e044cb?s=128&d=identicon&r=PG&f=1", "display_name": "ROCA", "link": "https://stackoverflow.com/users/10711720/roca"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560348548, "post_id": 56563281, "comment_id": 99707868, "body": "@P\u1d07\u029c has a good idea here, however, there are 2 lines that alwasy matches the new priority, the one that the user typed and the old one that was already there... anyway..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560348836, "post_id": 56563281, "comment_id": 99708073, "body": "@ROCA no that works. Look at my example below."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 10711720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd78c8a2a55ec52e0aca62217e044cb?s=128&d=identicon&r=PG&f=1", "display_name": "ROCA", "link": "https://stackoverflow.com/users/10711720/roca"}, "edited": false, "score": 0, "creation_date": 1560349160, "post_id": 56564274, "comment_id": 99708259, "body": "I like that! let me try and I&#180;ll get back to you"}, {"owner": {"reputation": 81, "user_id": 10711720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd78c8a2a55ec52e0aca62217e044cb?s=128&d=identicon&r=PG&f=1", "display_name": "ROCA", "link": "https://stackoverflow.com/users/10711720/roca"}, "edited": false, "score": 0, "creation_date": 1560356237, "post_id": 56564274, "comment_id": 99712350, "body": "I did not think about re ordering ascending and then re index the numbers, great @Peh , thanks."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1560348815, "creation_date": 1560348815, "answer_id": 56564274, "question_id": 56563281, "link": "https://stackoverflow.com/questions/56563281/prioritization-of-projects-vba/56564274#56564274", "title": "Prioritization of projects VBA", "body": "<p>Imagine the following data, where we want to change priority <code>3</code> into <code>10</code> (which already exists) so it shoult be sorted right before <code>10</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IDnD2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IDnD2.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then we use the following code:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()\n    ReOrder OldPriority:=3, NewPriority:=10\nEnd Sub\n\nPublic Sub ReOrder(OldPriority As Long, NewPriority As Long)\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Tabelle9\")\n\n    Dim MatchRow As Double\n    On Error Resume Next\n        MatchRow = Application.WorksheetFunction.Match(OldPriority, ws.Columns(\"A\"), 0)\n    On Error GoTo 0\n\n    If MatchRow = 0 Then\n        MsgBox \"The old priority number did not exist.\", vbCritical\n        Exit Sub\n    End If\n\n    'write new priorty\n    ws.Cells(MatchRow, \"A\").Value = NewPriority - 0.001 'subtract a small number so it will always sort before existing priorities\n\n    'sort by priortiy\n    With ws.Sort\n        .SortFields.Clear\n        .SortFields.Add2 Key:=ws.Range(\"A1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .SetRange ws.Range(\"A:B\") 'your data range\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n\n    'rewrite priority numbers ascending\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim iRow As Long\n    For iRow = 2 To LastRow\n        ws.Cells(iRow, \"A\") = iRow - 1\n    Next iRow\nEnd Sub\n</code></pre>\n\n<p>After the new priorirty was written and the data was sorted by priority it looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/E799S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E799S.png\" alt=\"enter image description here\"></a></p>\n\n<p>So we just need to rewrite the numbers and we end up here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JVly9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JVly9.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 81, "user_id": 10711720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd78c8a2a55ec52e0aca62217e044cb?s=128&d=identicon&r=PG&f=1", "display_name": "ROCA", "link": "https://stackoverflow.com/users/10711720/roca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56564274, "answer_count": 1, "score": 1, "last_activity_date": 1560348815, "creation_date": 1560345656, "question_id": 56563281, "link": "https://stackoverflow.com/questions/56563281/prioritization-of-projects-vba", "title": "Prioritization of projects VBA", "body": "<p>I have a list of 30 projects displayed in lines, I need to give the user the possibility to change the priority of projects on  VBA form.</p>\n\n<p>The form is fine, the user can look for the project he wants (by clicking on look for project), the Old priority is filled automatically and he is asked to type the new priority:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FRT5M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FRT5M.png\" alt=\"enter image description here\"></a></p>\n\n<p>By Clicking on OK, the new priority for that project should substitute the old priority for that project and it should re order everything on priority column.</p>\n\n<p>The code I have almost works, but it leaves a whole, in the example below, I change the project with priority 3 to priority 10, it changed the whole column, but it disappeared with project priority 3:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NeOhC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NeOhC.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the code I have:</p>\n\n<p>(It is really messy and I can\u00b4t figure out a way to make it work)</p>\n\n<pre><code>' After clicking on look for project , where cell focus in on the project he wants to change priority\n\nPrivate Sub CommandButton1_Click()\nDim old_priority As String\nDim CELL As Range\n\n\nActiveCell.Offset(0, -1).Select\nActiveCell.Value = new_priority.Text\n\nFor Each CELL In Range(\"b8:b36\")\n\n   If CELL.Value &gt;= new_priority.Text + 1 Then\n   CELL.Value = CELL.Value + 1\n   Else\n   End If\n\n\n   If CELL.Value = new_priority.Text Then\n   CELL.Value = CELL.Value + 1\n   Else\n   End If\n\nNext CELL\n\n   ThisWorkbook.Sheets(\"sheet5\").Range(\"c27\").Value = new_priority.Text\n\n\n    Cells.Find(What:=ThisWorkbook.Sheets(\"sheet5\").Range(\"b27\").Value, After:=ActiveCell, LookIn:=xlFormulas, _\n       LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n      MatchCase:=False, SearchFormat:=False).Activate\n    Prioridade.Text = ActiveCell.Offset(0, -1).Value\n    ActiveCell.Offset(0, -1).Select\n    ActiveCell.Value = new_priority.Text\n\n\n\n        Unload Me\n\nEnd sub\n</code></pre>\n\n<p>I am sure there is an easier way to loop throught the cells and re order the list.</p>\n"}, {"tags": ["excel", "vba", "object", "powerpivot"], "comments": [{"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 0, "creation_date": 1560422366, "post_id": 56562894, "comment_id": 99735089, "body": "I don&#39;t think it&#39;s possible. Why would you need that though? What are you trying to achieve?"}, {"owner": {"reputation": 432, "user_id": 2391873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9813e629bb4baf25e0eb9d250bd38722?s=128&d=identicon&r=PG", "display_name": "Ejaz Ahmed", "link": "https://stackoverflow.com/users/2391873/ejaz-ahmed"}, "reply_to_user": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "edited": false, "score": 0, "creation_date": 1561975049, "post_id": 56562894, "comment_id": 100219248, "body": "Some times I have to create/update many columns. And I need an automated way to add it to the data model. Like have a table with Table-Name, Column-Name and Formula, and a macro that updates formulas or creates columns in the respective Table."}], "owner": {"reputation": 432, "user_id": 2391873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9813e629bb4baf25e0eb9d250bd38722?s=128&d=identicon&r=PG", "display_name": "Ejaz Ahmed", "link": "https://stackoverflow.com/users/2391873/ejaz-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560345176, "creation_date": 1560344502, "question_id": 56562894, "link": "https://stackoverflow.com/questions/56562894/how-do-i-add-calculated-columns-to-a-table-in-the-powerpivot-data-model-using-vb", "title": "How do I add Calculated Columns to a table in the PowerPivot Data Model using VBA?", "body": "<p>I am aware that we can add/edit Measures to/in the Data Model from VBA using the ThisWorkbook.Model object. Is there a way to add Calculated Columns using VBA using the Model Object?</p>\n"}, {"tags": ["regex", "vba", "email", "outlook", "forwarding"], "comments": [{"owner": {"reputation": 76, "user_id": 3500666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22d56a79802cc40601f695096d750a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Ansu", "link": "https://stackoverflow.com/users/3500666/ansu"}, "edited": false, "score": 0, "creation_date": 1560345014, "post_id": 56562888, "comment_id": 99705526, "body": "what is the format of attachment .txt or pdf or something else"}, {"owner": {"reputation": 13, "user_id": 9014496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a0e33e4b1ce3ed7baaf29580a607af?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/9014496/niels"}, "reply_to_user": {"reputation": 76, "user_id": 3500666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22d56a79802cc40601f695096d750a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Ansu", "link": "https://stackoverflow.com/users/3500666/ansu"}, "edited": false, "score": 1, "creation_date": 1560415075, "post_id": 56562888, "comment_id": 99731021, "body": "The format of the attachment is .pdf"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9014496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a0e33e4b1ce3ed7baaf29580a607af?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/9014496/niels"}, "edited": false, "score": 0, "creation_date": 1560415627, "post_id": 56567902, "comment_id": 99731327, "body": "Ok, thanks for your answer.   Just to make sure - the short answer to my question is No then, right?"}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 13, "user_id": 9014496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a0e33e4b1ce3ed7baaf29580a607af?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/9014496/niels"}, "edited": false, "score": 0, "creation_date": 1560435583, "post_id": 56567902, "comment_id": 99743117, "body": "It&#39;s certainly possible, but you are definitely limited using VBA. A .NET COM add-in would give you more choices for using additional APIs to read various file contents. Although since Word can open .pdfs, you could use the Word Object Model to parse it."}, {"owner": {"reputation": 13, "user_id": 9014496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a0e33e4b1ce3ed7baaf29580a607af?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/9014496/niels"}, "edited": false, "score": 0, "creation_date": 1560770719, "post_id": 56567902, "comment_id": 99832472, "body": "In short, I am very new to VBA so forgive me if my questions are poor.  If the Word Object Model can open .pdfs and parse it -&gt; Do I need to download each .pdf-attachment (one mail at a time) to use the Word Object Model to parse the text?  Or is there a better way?  And can you by any chance help me with some code / pseudo-code?  Thank you for your great answers so far!"}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 13, "user_id": 9014496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a0e33e4b1ce3ed7baaf29580a607af?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/9014496/niels"}, "edited": false, "score": 0, "creation_date": 1560787191, "post_id": 56567902, "comment_id": 99841429, "body": "Yes you need to save the attachments to disk so you can open them with Word. If you have a specific question about using Word then please post a separate question if you cannot find the answer from your own research. There is plenty of documentation on how to use the Word Object Model, like here: <a href=\"https://docs.microsoft.com/en-ca/office/vba/api/overview/word\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-ca/office/vba/api/overview/word</a>. Otherwise, StackOverflow is not a code writing service"}, {"owner": {"reputation": 13, "user_id": 9014496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a0e33e4b1ce3ed7baaf29580a607af?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/9014496/niels"}, "edited": false, "score": 0, "creation_date": 1560945827, "post_id": 56567902, "comment_id": 99902232, "body": "Ok. Thank you very much for your help. I&#39;ll have a closer look at the Word Object Model."}], "tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": true, "score": 1, "last_activity_date": 1560362170, "creation_date": 1560362170, "answer_id": 56567902, "question_id": 56562888, "link": "https://stackoverflow.com/questions/56562888/forwarding-outlook-emails-based-on-specific-content-in-attachments/56567902#56567902", "title": "Forwarding Outlook emails based on specific content in attachments", "body": "<p>There's nothing in the Outlook Object Model specifically that will provide access to a file attachment's contents, aside from facilitating saving the attachment to disk. You will need to use additional APIs for each proprietary file content type that you want to parse. VBA does have the Open command that will let you read text files.</p>\n"}], "owner": {"reputation": 13, "user_id": 9014496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a0e33e4b1ce3ed7baaf29580a607af?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/9014496/niels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 2, "accepted_answer_id": 56567902, "answer_count": 1, "score": 1, "last_activity_date": 1560362170, "creation_date": 1560344483, "last_edit_date": 1560344589, "question_id": 56562888, "link": "https://stackoverflow.com/questions/56562888/forwarding-outlook-emails-based-on-specific-content-in-attachments", "title": "Forwarding Outlook emails based on specific content in attachments", "body": "<p>Creating a custom rule for forwarding emails based on the content of the attachments. I don't know how to use regex on the content of the attachments.</p>\n\n<p>See code - I think I only do the Regex for the content of the email not for the content of the attachments.</p>\n\n<pre><code>Option Explicit\nPublic Sub Forward(Item As Outlook.MailItem)\n    Dim M1 As MatchCollection\n    Dim M As Match\n    Dim Reg1 As Object\n    Dim myForward As Object\n\n    Set Reg1 = New RegExp\n\n    With Reg1\n        .Pattern = \"(Next year\\s*(\\w*)\\s*)\"\n        .Global = True\n    End With\n\n    If Reg1.Test(Item.Body) Then\n        Set M1 = Reg1.Execute(Item.Body)\n        For Each M In M1\n            Debug.Print M.SubMatches(0) ' Immediate Window\n\n            Item.Subject = Item.Subject &amp; \" - Next year\"\n            Item.HTMLBody = \"&lt;HTML&gt;&lt;BODY&gt;Assignments for next year. &lt;/BODY&gt;&lt;/HTML&gt;\" &amp; objForward.HTMLBody\n\n        Next\n    End If\n\n    Item.Save\n\n    Set myForward = Item.Forward\n    myForward.Recipients.Add \"a@aaa.aa\"\n    myForward.Display\nEnd Sub\n</code></pre>\n\n<p>I want the output to be:\n- Forward email\n   - New Subject: [Item.Subject] &amp; \" - Next year\"</p>\n\n<p>The emails to be forwarded:\n- Emails containing attachments which contains the text: \"Next year\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1560345478, "post_id": 56562835, "comment_id": 99705854, "body": "Have a read on <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/getabsolutepathname-method\" rel=\"nofollow noreferrer\">getabsolutepathname-method</a>. What&#39;s wrong with using the <code>Path</code> from workbook?"}, {"owner": {"reputation": 3, "user_id": 11636638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qUFzf.png?s=128&g=1", "display_name": "tharotk", "link": "https://stackoverflow.com/users/11636638/tharotk"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1560345920, "post_id": 56562835, "comment_id": 99706128, "body": "@FAB yes, I read already and I didn&#39;t get the full path. My folders A\\B\\C\\D\\E\\F is not shown."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1560347857, "post_id": 56562835, "comment_id": 99707396, "body": "<code>ThisWorkbook.Path</code>?"}, {"owner": {"reputation": 3, "user_id": 11636638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qUFzf.png?s=128&g=1", "display_name": "tharotk", "link": "https://stackoverflow.com/users/11636638/tharotk"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1560349133, "post_id": 56562835, "comment_id": 99708248, "body": "@JohnyL not that point, sir. In my case, I would like to get the path of my specific directory."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1560359324, "post_id": 56562835, "comment_id": 99713754, "body": "That method won&#39;t do what you want with the input of just a filename.  How are you inputting the filename?  If it is just some random filename that you are typing in, then you&#39;ll need to search the computer (or some designated folder) for that filename.  If you are inputting that data using some other method, then there might be a simpler way of getting the full path."}, {"owner": {"reputation": 3, "user_id": 11636638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qUFzf.png?s=128&g=1", "display_name": "tharotk", "link": "https://stackoverflow.com/users/11636638/tharotk"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1560418103, "post_id": 56562835, "comment_id": 99732664, "body": "@RonRosenfeld I was trying to put more path to let system know ,but it didn&#39;t come for the full path for example:  <code>FileName = fso.GetAbsolutePathName(&quot;C\\D\\E\\F\\cmdResources&quot;)</code>  The output is as below: ``` C:\\Users\\myName\\Documents\\C\\D\\E\\F\\cmdResources ``` That&#39;s mean I didn&#39;t get folder <code>\\A\\B</code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1560427952, "post_id": 56562835, "comment_id": 99738143, "body": "Again, that&#39;s not how that method works.  If I were trying to find the location of a particular file, I would Shell to the <code>CMD</code> window and use the <code>DIR</code> command with the <code>&#47;S</code> switch, and possibly wild cards.  Then extract the full path from the returned information.  Probably be faster than using the FSO."}, {"owner": {"reputation": 3, "user_id": 11636638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qUFzf.png?s=128&g=1", "display_name": "tharotk", "link": "https://stackoverflow.com/users/11636638/tharotk"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1560435508, "post_id": 56562835, "comment_id": 99743060, "body": "@RonRosenfeld I got it. However, thank you very much for you explanation."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11636638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qUFzf.png?s=128&g=1", "display_name": "tharotk", "link": "https://stackoverflow.com/users/11636638/tharotk"}, "edited": false, "score": 0, "creation_date": 1560417910, "post_id": 56571259, "comment_id": 99732564, "body": "Thanks for your codes, and I am trying to use them. Unfortunately, I got an error &quot;Permission denied&quot; so, I checked with FoName which shown as &quot;C:\\Users\\myName\\Documents\\My Music\\&quot;. Even I was trying to change the directory to &quot;C:\\Users\\myName\\Documents\\A&quot;, it still shown as error."}, {"owner": {"reputation": 431, "user_id": 10022961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc13a460ea398869555be94a75db513?s=128&d=identicon&r=PG", "display_name": "Abdallah El-Yaddak", "link": "https://stackoverflow.com/users/10022961/abdallah-el-yaddak"}, "reply_to_user": {"reputation": 3, "user_id": 11636638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qUFzf.png?s=128&g=1", "display_name": "tharotk", "link": "https://stackoverflow.com/users/11636638/tharotk"}, "edited": false, "score": 0, "creation_date": 1560419780, "post_id": 56571259, "comment_id": 99733633, "body": "Did you try it like this? <code>SearchInDirectory(&quot;cmdResources&quot;, &quot;C:\\Users\\myName\\Documents\\A&quot;, SearchMode:=xlFoldersOnly)</code> Which line is highlighted when the &quot;Permission denied&quot; error appears? And did you make sure you selected the right value for <code>SearchMode</code> parameter?"}, {"owner": {"reputation": 3, "user_id": 11636638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qUFzf.png?s=128&g=1", "display_name": "tharotk", "link": "https://stackoverflow.com/users/11636638/tharotk"}, "edited": false, "score": 0, "creation_date": 1560425752, "post_id": 56571259, "comment_id": 99736877, "body": "Perfect! Thank you very much."}], "tags": [], "owner": {"reputation": 431, "user_id": 10022961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc13a460ea398869555be94a75db513?s=128&d=identicon&r=PG", "display_name": "Abdallah El-Yaddak", "link": "https://stackoverflow.com/users/10022961/abdallah-el-yaddak"}, "is_accepted": true, "score": 0, "last_activity_date": 1560420280, "last_edit_date": 1560420280, "creation_date": 1560379473, "answer_id": 56571259, "question_id": 56562835, "link": "https://stackoverflow.com/questions/56562835/getabsolutepathname-problem-about-getting-the-wrong-path-directory-excel-vba/56571259#56571259", "title": "GetAbsolutePathName problem about getting the wrong path directory (Excel VBA)", "body": "<p>If you want VBA to \"search\" for a file/folder in a directory, I think you need to use something like this:</p>\n\n<pre><code>Option Explicit\nOption Compare Text\nPublic Enum xlSearchMode\n    xlFilesOnly = 0\n    xlFoldersOnly = 1\n    xlFilesAndFolders = 2\nEnd Enum\nFunction SearchInDirectory(FName As String, Optional FoName As String, Optional SearchMode As xlSearchMode = xlFilesOnly, Optional ExactMatch As Boolean = True) As Variant\n    'By Abdallah Khaled Ali El-Yaddak\n    'Returns an array of strings with files/folders matching what you are searching for.\n    'If nothing is found, it returns an array of one empty string element.\n    '-------------'\n    'FName (String): The file/folder to look for\n    '[FoName] (String): The directory to search in, if omitted, CurDir will be used.\n    '[SreachMode] (xlSearchMode): xlFilesOnly (default) = Look for files only | xlFoldersOnly = Look for folders only | xlFilesAndFolders = Look for both\n    '[Exactmatch] (Boolean): True (default) = Look only for this string (case insenstive) | False = Sreach for any files/folders that includes this string in their name\n    Dim FSO As Object, File As Object, Folder As Object, Fnames() As String, i As Long, SubNames As Variant, SubFolder As Object\n    If FoName = \"\" Then FoName = CurDir\n    If Right(FoName, 1) &lt;&gt; \"\\\" Then FoName = FoName &amp; \"\\\"\n    ReDim Fnames(1 To 1) As String\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set Folder = FSO.GetFolder(FoName)\n    If SearchMode = xlFilesOnly Or SearchMode = xlFilesAndFolders Then\n        For Each File In FSO.GetFolder(Folder).Files\n            If (ExactMatch And SubFolder.Name = FName) Or _\n                    (Not ExactMatch And SubFolder.Name Like \"*\" &amp; FName &amp; \"*\") Then\n                Fnames(UBound(Fnames)) = File.Path\n                ReDim Preserve Fnames(1 To UBound(Fnames) + 1)\n            End If\n        Next\n    End If\n    If SearchMode = xlFoldersOnly Or SearchMode = xlFilesAndFolders Then\n        For Each SubFolder In FSO.GetFolder(Folder).subFolders\n            If (ExactMatch And SubFolder.Name = FName) Or _\n                    (Not ExactMatch And SubFolder.Name Like \"*\" &amp; FName &amp; \"*\") Then\n                Fnames(UBound(Fnames)) = SubFolder.Path\n                ReDim Preserve Fnames(1 To UBound(Fnames) + 1)\n            End If\n        Next\n    End If\n    For Each SubFolder In FSO.GetFolder(Folder).subFolders\n        SubNames = SearchInDirectory(FName, SubFolder.Path, SearchMode, ExactMatch)\n        If SubNames(LBound(SubNames)) &lt;&gt; \"\" Then\n            For i = LBound(SubNames) To UBound(SubNames)\n                Fnames(UBound(Fnames)) = SubNames(i)\n                ReDim Preserve Fnames(1 To UBound(Fnames) + 1)\n            Next\n        End If\n    Next\n    If UBound(Fnames) &gt; 1 Then ReDim Preserve Fnames(1 To UBound(Fnames) - 1)\n    SearchInDirectory = Fnames\nEnd Function\n</code></pre>\n\n<p>To test, you need something like this:</p>\n\n<pre><code>Sub Test()\n    Dim a As Variant, i As Long\n    a = SearchInDirectory(\"cmdResources\", \"C:\\Users\\myName\\Documents\\A\", SearchMode:=xlFoldersOnly)\n    For i = LBound(a) To UBound(a)\n        Debug.Print a(i)\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong>Notes:</strong></p>\n\n<ol>\n<li>This solution doesn't work on MAC (tested only on windows)</li>\n<li>Searching will take longer for larger directories (The number of files/folders inside)</li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 11636638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qUFzf.png?s=128&g=1", "display_name": "tharotk", "link": "https://stackoverflow.com/users/11636638/tharotk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 56571259, "answer_count": 1, "score": 0, "last_activity_date": 1560420280, "creation_date": 1560344333, "last_edit_date": 1560345364, "question_id": 56562835, "link": "https://stackoverflow.com/questions/56562835/getabsolutepathname-problem-about-getting-the-wrong-path-directory-excel-vba", "title": "GetAbsolutePathName problem about getting the wrong path directory (Excel VBA)", "body": "<p>I expect to get the full path directory, but I got the short path from <code>GetAbsolutePathName</code> function. How can I get the full directory path?</p>\n\n<p>This is MS excel pro plus 2016. I put my basic coding below:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim FileName as String\nDim fso As Scripting.FileSystemObject\nSet fso = New Scripting.FileSystemObject\nFileName = fso.GetAbsolutePathName(\"cmdResources\")\n</code></pre>\n\n<p>Expect output is:</p>\n\n<blockquote>\n  <p>C:\\Users\\myName\\Documents\\A\\B\\C\\D\\E\\F\\cmdResources</p>\n</blockquote>\n\n<p>Actual output is:</p>\n\n<blockquote>\n  <p>C:\\Users\\myName\\Documents\\cmdResources</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1560345624, "post_id": 56562615, "comment_id": 99705947, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "edited": false, "score": 0, "creation_date": 1560344979, "post_id": 56562695, "comment_id": 99705496, "body": "Ah, I did not realize that select and activate were so disliked in this community. I guess I will end up having to rewrite some stuff. Thank you!"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "edited": false, "score": 0, "creation_date": 1560345246, "post_id": 56562695, "comment_id": 99705694, "body": "Not so much disliked by this community, it&#39;s just <i>very</i> prone to errors, slows down your code and is generally unnecessary. You&#39;re much better off without it! If my answer helped you, please don&#39;t forget to accept it by clicking on the check icon under the downvote buttton"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 1, "last_activity_date": 1560343916, "creation_date": 1560343916, "answer_id": 56562695, "question_id": 56562615, "link": "https://stackoverflow.com/questions/56562615/grabbing-data-from-different-sheets-using-select/56562695#56562695", "title": "Grabbing Data From Different Sheets Using .Select", "body": "<p>Don't use <code>Select</code> (or <code>Activate</code> for that matter), it's bad practise and leads to errors rather quickly.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">This thread</a> is a great help as to why and how you should avoid using it.</p>\n\n<p>There is no need to select a sheet before getting data from it. For example:</p>\n\n<pre><code>Sub test()\n'''\n'Bad practise:\n'''\nSheets(\"Sheet1\").Select\ni = Range(\"A1\")\n\n'''\n'Good practise\n'''\ni = Workbooks(\"Book1\").Sheets(\"Sheet1\").Range(\"A1\").Value\n\n'''\n'Better practise\n'''\nDim wb As Workbook\nDim sht As Worksheet\nDim i As String\n\nSet wb = Workbooks(\"Book1\")\nSet sht = wb.Sheets(\"Sheet1\")\n\nWith sht\n    i = .Range(\"A1\").Value\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "edited": false, "score": 0, "creation_date": 1560344906, "post_id": 56562979, "comment_id": 99705451, "body": "If I did this, would I still be able to call data the same way, or would I have to change how I grabbed the data? Ex: Cells(3,2).value for the value in that cell on that sheet."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "edited": false, "score": 0, "creation_date": 1560344988, "post_id": 56562979, "comment_id": 99705502, "body": "i you want grab data located in the same cells in different sheets you have to loop sheets and grab data."}, {"owner": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "edited": false, "score": 0, "creation_date": 1560345181, "post_id": 56562979, "comment_id": 99705648, "body": "Their difference cells in different sheets. Could I just do With ThisWorkbook.Worksheets(&quot;Sheet1&quot;) .Range(&quot;A1&quot;).value  End With With Thisworkbook.Worksheets(&quot;Sheet2&quot;) .Range(&quot;A2&quot;).value EndWith to get the data from two different cells in 2 different sheets?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "edited": false, "score": 0, "creation_date": 1560345545, "post_id": 56562979, "comment_id": 99705897, "body": "You question is totally unclear. There are a lot of ways to avoid <code>.Select</code>. Many people try to help you and you down vote all answer?"}, {"owner": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "edited": false, "score": 0, "creation_date": 1560345618, "post_id": 56562979, "comment_id": 99705942, "body": "I was not the one who downvoted your answer, I am the upvote that make it zero. Someone else was the one who downvoted you. Why would I downvote you then ask you questions?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "edited": false, "score": 0, "creation_date": 1560345748, "post_id": 56562979, "comment_id": 99706013, "body": "many answer delete due to down vote in this question. i have upload another answer. you could see it"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "edited": false, "score": 0, "creation_date": 1560346032, "post_id": 56562979, "comment_id": 99706213, "body": "@Hakon i have upload another solution"}, {"owner": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "edited": false, "score": 1, "creation_date": 1560346457, "post_id": 56562979, "comment_id": 99706476, "body": "Thank you, I am using your examples to fix my code as we speak."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1560345729, "last_edit_date": 1560345729, "creation_date": 1560344794, "answer_id": 56562979, "question_id": 56562615, "link": "https://stackoverflow.com/questions/56562615/grabbing-data-from-different-sheets-using-select/56562979#56562979", "title": "Grabbing Data From Different Sheets Using .Select", "body": "<p>With Statement:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    'Create a witrh statement with the Sheet name you want\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        'Refer to cell A1 (don t forget the \".\" before Range)\n        .Range(\"A1\").Value = \"\"\n        'Refer to cell A1 (don t forget the \".\" before Cells)\n        .Cells(1, 1).Value = \"\"\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Loop Worksheets:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim ws As Worksheet\n\n    'Loop Sheets\n    For Each ws In ThisWorkbook.Worksheets\n\n        With ws\n            'If sheet name is Sheet1 or Sheet3\n            If .Name = \"Sheet1\" Or .Name = \"Sheet3\" Then\n\n                'Refer to cell A1 (don t forget the \".\" before Range)\n                .Range(\"A1\").Value = 2\n                'Refer to cell A1 (don t forget the \".\" before Cells)\n                .Cells(1, 1).Value = 10\n            ElseIf .Name = \"Sheet2\" Then\n                'Refer to cell A1 (don t forget the \".\" before Range)\n                .Range(\"A1\").Value = 5\n                'Refer to cell A1 (don t forget the \".\" before Cells)\n                .Cells(1, 1).Value = 20\n\n            End If\n\n        End With\n\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p>Set Worksheet To Variable</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim ws1 As Worksheet, ws2 As Worksheet\n\n    With ThisWorkbook\n        Set ws1 = .Worksheets(\"Sheet1\")\n        Set ws2 = .Worksheets(\"Sheet2\")\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 11595462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd5f3a21f1ef8a12c98fb0fecf05d54f?s=128&d=identicon&r=PG&f=1", "display_name": "Hakon", "link": "https://stackoverflow.com/users/11595462/hakon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 56562979, "answer_count": 2, "score": 0, "last_activity_date": 1560345729, "creation_date": 1560343665, "question_id": 56562615, "link": "https://stackoverflow.com/questions/56562615/grabbing-data-from-different-sheets-using-select", "title": "Grabbing Data From Different Sheets Using .Select", "body": "<p>I must jump between different excel sheets to grab data for my VBA to output what I want. I've been using the Sheets(\"name\").Select function to jump between the sheets. Sometimes it works and lets me run the program, but other times I get a runtime error. I want this to work 100% of the time every time, and always get disheartened whenever it fails due to the select function. If anyone has any tips or recommendations I would love for you to share them! Any help would be greatly appreciated.</p>\n\n<pre><code>Sheets(\"Test\").Select\n</code></pre>\n\n<p>Run-time Error '1004': Select Method of Worksheet Class Failed</p>\n"}, {"tags": ["vba", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 11603571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b986d6e4df1af1315aadf8272f37b8?s=128&d=identicon&r=PG&f=1", "display_name": "bennyjim", "link": "https://stackoverflow.com/users/11603571/bennyjim"}, "edited": false, "score": 0, "creation_date": 1560346709, "post_id": 56563139, "comment_id": 99706649, "body": "Great, thank you very much! That pretty much works, but I had to amend <code>End(xlUp)</code> to <code>End(xlDown)</code> which seems to work.   Two quick questions for my understanding if you or someone can help:                                                                                                                                                        1: What does the &#39;A&#39; mean in <code>Range(&quot;A&quot; &amp;</code> - I can&#39;t seem to figure that out.  2: The second line under <code>Dim</code> starting with <code>rCount</code> - I felt inclined to write &#39;Set&#39; there, but it doesn&#39;t seem to work - is that not needed? Why?"}, {"owner": {"reputation": 116, "user_id": 9194283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6f5747469dba4701518064bbfc9a63?s=128&d=identicon&r=PG&f=1", "display_name": "SoopahTree", "link": "https://stackoverflow.com/users/9194283/soopahtree"}, "reply_to_user": {"reputation": 7, "user_id": 11603571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b986d6e4df1af1315aadf8272f37b8?s=128&d=identicon&r=PG&f=1", "display_name": "bennyjim", "link": "https://stackoverflow.com/users/11603571/bennyjim"}, "edited": false, "score": 0, "creation_date": 1560347962, "post_id": 56563139, "comment_id": 99707460, "body": "The &#39;A&#39; represents the first column of the worksheet. So if you use the same code, but change the &quot;A&quot; to a &quot;J&quot;, then it will count the rows in column J instead. Just using a placeholder for the example :)   The 2nd bit: Set is used to assign an object reference, while just using &quot;=&quot; assigns the value to the variable, which in this case, would be the value of &quot;number of rows&quot;."}, {"owner": {"reputation": 7, "user_id": 11603571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b986d6e4df1af1315aadf8272f37b8?s=128&d=identicon&r=PG&f=1", "display_name": "bennyjim", "link": "https://stackoverflow.com/users/11603571/bennyjim"}, "edited": false, "score": 0, "creation_date": 1560348370, "post_id": 56563139, "comment_id": 99707750, "body": "Ah perfect. All makes sense! Many thanks for your help!"}], "tags": [], "owner": {"reputation": 116, "user_id": 9194283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6f5747469dba4701518064bbfc9a63?s=128&d=identicon&r=PG&f=1", "display_name": "SoopahTree", "link": "https://stackoverflow.com/users/9194283/soopahtree"}, "is_accepted": true, "score": 0, "last_activity_date": 1560345190, "creation_date": 1560345190, "answer_id": 56563139, "question_id": 56562598, "link": "https://stackoverflow.com/questions/56562598/vba-script-to-insert-index-match-formula-with-dynamic-reference-arrays/56563139#56563139", "title": "VBA script to insert INDEX/MATCH formula with dynamic reference/arrays", "body": "<p>You can integrate variables into the formula, it becomes a bit tricky, and I imagine there are better ways to accomplish this, but it's the method I use when I need dynamic ranges in formulas in VBA. I'll provide an example below that should help:</p>\n\n<p>I'm assuming the J3 and H3 will remain the same, but the end of the range is what you expect to change. If this is not the case, let me know.</p>\n\n<p>You're essentially replacing the \"31\" in your range reference with \" &amp; [variable] &amp; \" (quotes included).</p>\n\n<p>EDIT: I use Sheet1 as an example for the row count; so just update that to whatever the applicable sheet &amp; range would be.</p>\n\n<pre><code>    Dim rCount As Long\n    rCount = Sheet1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Selection.Offset(0, 1) = \"=INDEX($J$3:$J$\" &amp; rCount &amp; \",MATCH(INDIRECT(\"\"RC[-2]\"\",0),$H$3:$H$\" &amp; rCount &amp; \",0))\"\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11603571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b986d6e4df1af1315aadf8272f37b8?s=128&d=identicon&r=PG&f=1", "display_name": "bennyjim", "link": "https://stackoverflow.com/users/11603571/bennyjim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 1, "accepted_answer_id": 56563139, "answer_count": 1, "score": 0, "last_activity_date": 1560345190, "creation_date": 1560343627, "question_id": 56562598, "link": "https://stackoverflow.com/questions/56562598/vba-script-to-insert-index-match-formula-with-dynamic-reference-arrays", "title": "VBA script to insert INDEX/MATCH formula with dynamic reference/arrays", "body": "<p>I'm looking to simply insert an INDEX/MATCH formula in the column next to an existing selection (this will be part of a larger Sub). The reference/look-up array in the formula needs to be dynamic.</p>\n\n<p>So far I've managed to successfully insert the formula. However, the reference/lookup-arrays have been manually input by me as I know the current Range (which is likely to change):</p>\n\n<p><code>Selection.Offset(0, 1) = \"=INDEX($J$3:$J$31,MATCH(INDIRECT(\"\"RC[-2]\"\",0),$H$3:$H$31,0))\"</code></p>\n\n<p>How can I amend the <code>$J$3:$J$31</code> and the <code>$H$3:$H$31</code> to update dynamically? I've had success separately with something like 'Range(\"J3\", Range(\"J3\").End(xlDown))', but I can't seem to work it into the code above.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "edited": false, "score": 1, "creation_date": 1560343320, "post_id": 56562451, "comment_id": 99704382, "body": "You could use a Message Box to show <code>Err.Description</code>."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 8799840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5614405d8d36388f027f25c83c4d78f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dozens", "link": "https://stackoverflow.com/users/8799840/dozens"}, "edited": false, "score": 0, "creation_date": 1560413284, "post_id": 56562518, "comment_id": 99730044, "body": "The Exit sub before Errorhandler was the bull&#39;s eye for me. Thanks"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 145, "user_id": 8799840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5614405d8d36388f027f25c83c4d78f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dozens", "link": "https://stackoverflow.com/users/8799840/dozens"}, "edited": false, "score": 0, "creation_date": 1560413476, "post_id": 56562518, "comment_id": 99730151, "body": "Glad to have helped!"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": true, "score": 0, "last_activity_date": 1560343372, "creation_date": 1560343372, "answer_id": 56562518, "question_id": 56562451, "link": "https://stackoverflow.com/questions/56562451/vba-goto-excel-error-message-in-error-handling-if/56562518#56562518", "title": "VBA - goto excel error message in error handling if", "body": "<p>The code you wrote now is error number specific. You could also write a general error handler</p>\n\n<pre><code>Sub test()\nOn error GoTo Errorhandler\n\n '''\n 'Code\n '''\n\nExit Sub\nErrorhandler:\nMSgbox \"Warning: fatal error occured.\" &amp; vbCr &amp; vbCr \"Error message:\" &amp; vbCr &amp; Err.Description, vbcritical, \"Error\"\nEnd Sub\n</code></pre>\n\n<p>This will, regardless of which error occured, display a message box warning the user of a fatal error followed by the error message as displayed in VBE.</p>\n\n<p>Of course, you could also specify the error code instead of making it general</p>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 8799840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5614405d8d36388f027f25c83c4d78f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dozens", "link": "https://stackoverflow.com/users/8799840/dozens"}, "edited": false, "score": 0, "creation_date": 1560348169, "post_id": 56563204, "comment_id": 99707620, "body": "I am getting error 0. I am using if loop and else ifs instead of &#39;Case is&#39;. Then I get the MsgBox as you typed and gives Error(0)."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 145, "user_id": 8799840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5614405d8d36388f027f25c83c4d78f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dozens", "link": "https://stackoverflow.com/users/8799840/dozens"}, "edited": false, "score": 0, "creation_date": 1560348362, "post_id": 56563204, "comment_id": 99707746, "body": "@Dozens - error number 0 means no error. Did you copy+paste my solution or you wrote something else? What exactly?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 145, "user_id": 8799840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5614405d8d36388f027f25c83c4d78f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dozens", "link": "https://stackoverflow.com/users/8799840/dozens"}, "edited": false, "score": 0, "creation_date": 1560348422, "post_id": 56563204, "comment_id": 99707783, "body": "The idea of the error handler is to write all your code in the place <code>Debug.Print 5 &#47; 0</code> of the code above."}, {"owner": {"reputation": 145, "user_id": 8799840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5614405d8d36388f027f25c83c4d78f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dozens", "link": "https://stackoverflow.com/users/8799840/dozens"}, "edited": false, "score": 0, "creation_date": 1560413062, "post_id": 56563204, "comment_id": 99729932, "body": "the thing was that there was missing &#39;Exit sub&#39; before Erroe handler"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 145, "user_id": 8799840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5614405d8d36388f027f25c83c4d78f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dozens", "link": "https://stackoverflow.com/users/8799840/dozens"}, "edited": false, "score": 0, "creation_date": 1560419069, "post_id": 56563204, "comment_id": 99733195, "body": "@Dozens - <code>Exit Sub</code> was in both the answers."}, {"owner": {"reputation": 145, "user_id": 8799840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5614405d8d36388f027f25c83c4d78f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dozens", "link": "https://stackoverflow.com/users/8799840/dozens"}, "edited": false, "score": 1, "creation_date": 1560428287, "post_id": 56563204, "comment_id": 99738343, "body": "Yes, Now I see. But I have not seen it at the time."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1560345772, "last_edit_date": 1560345772, "creation_date": 1560345395, "answer_id": 56563204, "question_id": 56562451, "link": "https://stackoverflow.com/questions/56562451/vba-goto-excel-error-message-in-error-handling-if/56563204#56563204", "title": "VBA - goto excel error message in error handling if", "body": "<p>This is a possible way to get custom errors with <code>Select Case:</code>. If the error is number 11 (Division by 0), then it gives a customized <code>MsgBox</code>. Othewise it gives a standard one with the <code>Err.Number</code> and <code>Err.Description</code>, based on the current language of the system (Mine is German):</p>\n\n<p><a href=\"https://i.stack.imgur.com/n22vT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n22vT.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code:</p>\n\n<pre><code>Sub TestMe()\n\n    On Error GoTo TestMe_Error\n\n    Debug.Print 5 / 0\n\n    On Error GoTo 0\n    Exit Sub\n\nTestMe_Error:\n\n    Select Case Err.Number\n    Case 11:\n        MsgBox \"Division by null is not allowed on this planet!\"\n    Case Else:\n        MsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure TestMe.\"\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>And if you need a multipurpose Error-Handler, this is the code:</p>\n\n<pre><code>Sub TestMe()\n\n    On Error GoTo TestMe_Error\n\n    Debug.Print 5 / 0\n\n    On Error GoTo 0\n    Exit Sub\n\nTestMe_Error:\n\n    MsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure TestMe.\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 8799840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5614405d8d36388f027f25c83c4d78f4?s=128&d=identicon&r=PG&f=1", "display_name": "Dozens", "link": "https://stackoverflow.com/users/8799840/dozens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 56562518, "answer_count": 2, "score": 0, "last_activity_date": 1560345772, "creation_date": 1560343159, "question_id": 56562451, "link": "https://stackoverflow.com/questions/56562451/vba-goto-excel-error-message-in-error-handling-if", "title": "VBA - goto excel error message in error handling if", "body": "<p>I wanted to write the error handling for vba, which after directing to the error handling will first check for a specific error and if there is no match, it will show the error message as according to Excel.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>On Error GoTo ErrorHandl\n\nErrorHandl:\nIf Err.Number = 13 Then\n  MsgBox \"Do that \u2026\", vbCritical\n  Exit Sub\nElse\n??????\n</code></pre>\n\n<p>What could I write in the place of questions marks, so that if error number is different than 13 then, excel will show me the other error that is currently occurring?</p>\n"}, {"tags": ["vba", "ms-access", "certificate-store"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 2, "creation_date": 1560343801, "post_id": 56562383, "comment_id": 99704690, "body": "This question is pretty broad. There are generally two approaches you can use in VBA: COM-based (CAPICOM, deprecated) and WinAPI-based (CryptoAPI, difficult). If admin rights are the problem, you can see <a href=\"https://stackoverflow.com/questions/37193356/registering-net-com-dlls-without-admin-rights-regasm\">Registering .Net COM DLLs without Admin rights / regasm</a>. I&#39;ve posted a script under there that automates registering COM DLLs on a per-user basis without needing admin rights."}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1560344616, "post_id": 56562383, "comment_id": 99705254, "body": "Thanks for the link. I was not aware that its possible to registering COM without admin rights. But anyway, this is not just about the admin rights. There are also a lot of deployment stuff which have to be changed in order to make this work. I can do this but only if it is absolutly nessesary. I would prefere the CryptoAPI approach to open the store, read the certificates and query their properties."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1560344937, "post_id": 56562383, "comment_id": 99705475, "body": "Well, as said, that&#39;s difficult. I don&#39;t have an example ready and am not going to write up one because it&#39;s pretty much outside of the scope of Stack Overflow. I can throw you <a href=\"https://docs.microsoft.com/en-us/windows/desktop/seccrypto/example-c-code-for-opening-certificate-stores\" rel=\"nofollow noreferrer\">this link</a>, but using it requires knowledge on how to translate C concepts and API function calls to VBA, which is a pretty advanced subject."}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1560345196, "post_id": 56562383, "comment_id": 99705659, "body": "Thanks. Ill try it. This will not be the first api-calls in my vba programs."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1560345956, "post_id": 56562383, "comment_id": 99706152, "body": "Ah, good luck, then. After opening the store using the previous link, you can use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/Wincrypt/nf-wincrypt-certenumcertificatesinstore\" rel=\"nofollow noreferrer\"><code>CertEnumCertificatesInStore</code></a> to enumerate the certificates. Don&#39;t forget to answer your own question if you succeed!"}], "owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560343527, "creation_date": 1560342907, "last_edit_date": 1560343527, "question_id": 56562383, "link": "https://stackoverflow.com/questions/56562383/how-to-access-the-x509store-in-vba", "title": "How to access the X509Store in vba?", "body": "<p>I created the following C# code:</p>\n\n<pre><code>        X509Store x509Store = null;\n        x509Store = new X509Store(StoreName.My, StoreLocation.CurrentUser);\n        x509Store.Open(OpenFlags.ReadOnly | OpenFlags.OpenExistingOnly);\n\n        Debug.WriteLine(\"Certificates!\");\n        foreach (X509Certificate2 certificate in x509Store.Certificates)\n        {\n            Debug.WriteLine(certificate.ToString());\n        }\n</code></pre>\n\n<p>This is just a proof of concept. I have to do the same thing in ms-access-vba.</p>\n\n<p>I could create a C#-assembly with a com-class to call the code out of vba but this is a lot of trouble because the registration of the com-object needs admin rights. So I want to avoid this.</p>\n\n<p>Is there a way to access the certificates directly out of vba (=without using C# at all)?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11636762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156112838652073/picture?type=large", "display_name": "FozzyBear", "link": "https://stackoverflow.com/users/11636762/fozzybear"}, "edited": false, "score": 0, "creation_date": 1560430412, "post_id": 56562898, "comment_id": 99739679, "body": "Thanks! All sorted now with a bit of tweaking."}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 0, "last_activity_date": 1560344513, "creation_date": 1560344513, "answer_id": 56562898, "question_id": 56562364, "link": "https://stackoverflow.com/questions/56562364/lookup-password-value/56562898#56562898", "title": "Lookup password value", "body": "<p>You will need to adapt this to your specific needs, but something like this should give you a start:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub testLookup()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"sheet name\")\nDim lRow As Long: lRow = ws.Cells(Rows.Count).End(xlUp).Row\n\nDim arrRecipients: arrRecipients = ws.Range(\"A1:B\" &amp; lRow) 'assume path in col A, password col B\n\nFor R = LBound(arrRecipients) To UBound(arrRecipients)\n    ActiveWorkbook.SaveAs FileName:=arrRecipients(R, 1), FileFormat:=xlOpenXMLWorkbook, Password:=arrRecipients(R, 2)\nNext R\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11636762, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156112838652073/picture?type=large", "display_name": "FozzyBear", "link": "https://stackoverflow.com/users/11636762/fozzybear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560410412, "creation_date": 1560342834, "last_edit_date": 1560410412, "question_id": 56562364, "link": "https://stackoverflow.com/questions/56562364/lookup-password-value", "title": "Lookup password value", "body": "<p>I have a macro set up to password protect a file that is created from the same macro. This works fine, but I want to use this when separate files are generated for different recipients, and the recipients should all have unique passwords. </p>\n\n<p>How would I look up the password value from a separate spreadsheet when saving the files via the macro?</p>\n\n<p>At the minute my code looks like this with a preset password (file path/name shortened for ease).</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:= \"filepath\\filename\" , FileFormat:= _xlOpenXMLWorkbook, Password:= \"Test\"\n</code></pre>\n\n<p>This works, but I want the password to be replaced by a value that is looked up from another spreadsheet. Any help would be appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9060895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151dfb06b7ccca04e24cd1f8de04d437?s=128&d=identicon&r=PG&f=1", "display_name": "Uzeyir Chalabi", "link": "https://stackoverflow.com/users/9060895/uzeyir-chalabi"}, "edited": false, "score": 0, "creation_date": 1560342663, "post_id": 56562243, "comment_id": 99703993, "body": "Thank You, that helped, Another question for you, where can I learn all this logic and code? I am trying to learn as I go and I am struggling and making a lot of mistakes"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 11, "user_id": 9060895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151dfb06b7ccca04e24cd1f8de04d437?s=128&d=identicon&r=PG&f=1", "display_name": "Uzeyir Chalabi", "link": "https://stackoverflow.com/users/9060895/uzeyir-chalabi"}, "edited": false, "score": 0, "creation_date": 1560342753, "post_id": 56562243, "comment_id": 99704042, "body": "<a href=\"https://bettersolutions.com/excel/cells-ranges/vba-intersect-union.htm\" rel=\"nofollow noreferrer\">bettersolutions.com/excel/cells-ranges/vba-intersect-union.h&zwnj;&#8203;tm</a> <a href=\"https://www.excel-easy.com/vba/examples/union-intersect.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/examples/union-intersect.html</a> and GOOGLE"}], "tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1560342477, "creation_date": 1560342477, "answer_id": 56562243, "question_id": 56562182, "link": "https://stackoverflow.com/questions/56562182/vba-if-a-specific-columns-and-rows-are-selected-type-mismatch-error/56562243#56562243", "title": "VBA if a specific columns and rows are selected, Type Mismatch error", "body": "<p>You will see that the keyword Target always returns the Range Object of the cell that fired the Worksheet_Change Event. So, armed with this knowledge we can now use the Intersect Method to take some action when/if  specified cell is changed. For example;</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"E12:L54787\")) Is Nothing Then\n        MsgBox \"Hello\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1560342717, "creation_date": 1560342717, "answer_id": 56562317, "question_id": 56562182, "link": "https://stackoverflow.com/questions/56562182/vba-if-a-specific-columns-and-rows-are-selected-type-mismatch-error/56562317#56562317", "title": "VBA if a specific columns and rows are selected, Type Mismatch error", "body": "<p>Write the code in the corresponding worksheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ITUir.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ITUir.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    If (Not Intersect(Target, Columns(\"E:L\")) Is Nothing) And _\n        (Not Intersect(Target, Rows(\"16:99999\")) Is Nothing) Then\n\n        Debug.Print Target.Address\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.selectionchange\" rel=\"nofollow noreferrer\">Selection.Change documentation</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.intersect\" rel=\"nofollow noreferrer\">Application.Intersect method documentation</a></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 9060895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151dfb06b7ccca04e24cd1f8de04d437?s=128&d=identicon&r=PG&f=1", "display_name": "Uzeyir Chalabi", "link": "https://stackoverflow.com/users/9060895/uzeyir-chalabi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1560343551, "creation_date": 1560342253, "last_edit_date": 1560343551, "question_id": 56562182, "link": "https://stackoverflow.com/questions/56562182/vba-if-a-specific-columns-and-rows-are-selected-type-mismatch-error", "title": "VBA if a specific columns and rows are selected, Type Mismatch error", "body": "<p>I am trying to write a code where sub activates when I select a specific column and specific row but gives me a type mismatch error on the following code:</p>\n\n<pre><code>If Selection.Worksheet.Columns(\"E:L\") And Selection.Worksheet.Rows(\"16:99999\") Then\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 56, "user_id": 11636555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/375e1f33423718043c9c68e3bfee1992?s=128&d=identicon&r=PG&f=1", "display_name": "Jan.Helbig", "link": "https://stackoverflow.com/users/11636555/jan-helbig"}, "edited": false, "score": 0, "creation_date": 1560433857, "post_id": 56562590, "comment_id": 99741929, "body": "The comboBox value is set correctly. After the end of the NotInList event procedure the selection moves forward by 1 record. The value in the originally selected record is saved correctly. If I select that record, everything is as expected.  I just do not know or understand why the selected record changes and how I could prevent the change."}], "tags": [], "owner": {"reputation": 100, "user_id": 3919757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae394ac1e62c9c3b9e469c23224f284?s=128&d=identicon&r=PG&f=1", "display_name": "Erin B", "link": "https://stackoverflow.com/users/3919757/erin-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1560343591, "creation_date": 1560343591, "answer_id": 56562590, "question_id": 56562025, "link": "https://stackoverflow.com/questions/56562025/multi-column-combo-boxs-not-in-list-event-causes-move-to-next-record-when-addin/56562590#56562590", "title": "Multi column combo box&#39;s Not In List Event causes move to next record when adding new entry", "body": "<p>Have you tried grabbing the row id after the insertion, then filtering on that manually? E.g. using the query for the multicolumn, and assuming the RayonID is a bound field in the combo box:</p>\n\n<pre><code>dim newItemNum as long\nnewItemNum = dlookup(\"RayonID\",\"MulticolumnQuery\",\"MunName='\" &amp; MunName &amp; \"'\")\nMe.combobox.Value =  newItemNum\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 11636555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/375e1f33423718043c9c68e3bfee1992?s=128&d=identicon&r=PG&f=1", "display_name": "Jan.Helbig", "link": "https://stackoverflow.com/users/11636555/jan-helbig"}, "is_accepted": false, "score": 0, "last_activity_date": 1560441105, "creation_date": 1560441105, "answer_id": 56584298, "question_id": 56562025, "link": "https://stackoverflow.com/questions/56562025/multi-column-combo-boxs-not-in-list-event-causes-move-to-next-record-when-addin/56584298#56584298", "title": "Multi column combo box&#39;s Not In List Event causes move to next record when adding new entry", "body": "<p>I found the problem: It had nothing to do with the multicolumn combo box after all. Although it was the first field on the form, it was the last tab stop and the forms Cycle property was set to \"All Records\". I entered new records by pressing tab, old ones I selected from the menu.\nSorry to all those that wasted a thought on this non-problem.</p>\n"}], "owner": {"reputation": 56, "user_id": 11636555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/375e1f33423718043c9c68e3bfee1992?s=128&d=identicon&r=PG&f=1", "display_name": "Jan.Helbig", "link": "https://stackoverflow.com/users/11636555/jan-helbig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594715919, "creation_date": 1560341775, "last_edit_date": 1594715919, "question_id": 56562025, "link": "https://stackoverflow.com/questions/56562025/multi-column-combo-boxs-not-in-list-event-causes-move-to-next-record-when-addin", "title": "Multi column combo box&#39;s Not In List Event causes move to next record when adding new entry", "body": "<p>I have a combo box with 4 columns (ID, Municipality, Rayon (= County), Oblast (= Province)). The data source comes from 3 linked tables (Municipality, Rayon, Oblast). When I get a NotInList Event and add the new Municipality Name and the Rayon ID to the Municipality table, the next record is selected (the focus moves to the next record) for no apparent reason. If I select an existing entry from the combo box, the current record stays as expected.</p>\n\n<p>My code works if I am only using the standard 2-column setup. If I combine Municipality, Rayon and Oblast into one entry and therefore have a 2 column list, I get the same problem. I have tried different approaches for handling the event that I found on the Web, but the problem remains. It is obvious that this has to do with the multicolumn setup, but I am still looking for a workaround.</p>\n\n<p>AddMunicipality is called from several different forms from the NotInList Event. AddMunicipalityQuestion gets a valid Rayon ID.</p>\n\n<pre><code>Public Sub AddMunicipality(newData As String, Response As Integer)\n    Dim newRayon As Integer\n    Dim newOblast As Integer\n\n    On Error GoTo Error_Handler\n\n    If AddMunicipalityQuestion(newData, newRayon) Then\n        DoCmd.SetWarnings False\n        DoCmd.RunSQL \"INSERT INTO tbl_Municipalities (MunName, Rayon) VALUES (\"\"\" &amp; newData &amp; \"\"\", \" &amp; newRayon &amp; \");\"\n        DoCmd.SetWarnings True\n        Response = acDataErrAdded\n    Else\n        MsgBox \"Please select a Municipality from the list.\", _\n        vbExclamation + vbOKOnly, \"Unknown Municipality\"\n        Response = acDataErrContinue\n    End If\n\nExit_Procedure:\n    DoCmd.SetWarnings True\n    Exit Sub\n\nError_Handler:\n      MsgBox Err.Number &amp; \", \" &amp; Err.Description, vbInformation, \"AddMunicipality()\"\n    Resume Exit_Procedure\nEnd Sub\n</code></pre>\n\n<p>The new municipality is added correctly, but for some reason the next record (or a new record) is getting the focus.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3836, "user_id": 3625036, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RFUSZ.png?s=128&g=1", "display_name": "ItamarG3", "link": "https://stackoverflow.com/users/3625036/itamarg3"}, "edited": false, "score": 0, "creation_date": 1560345120, "post_id": 56561763, "comment_id": 99705602, "body": "While this might work, an explanation should really accompany your answer."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 3836, "user_id": 3625036, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/RFUSZ.png?s=128&g=1", "display_name": "ItamarG3", "link": "https://stackoverflow.com/users/3625036/itamarg3"}, "edited": false, "score": 0, "creation_date": 1560346708, "post_id": 56561763, "comment_id": 99706647, "body": "@ItamarG3 Added explanation"}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 1, "last_activity_date": 1560346691, "last_edit_date": 1560346691, "creation_date": 1560340847, "answer_id": 56561763, "question_id": 56561722, "link": "https://stackoverflow.com/questions/56561722/loop-through-dataset-and-select-a-range-of-data/56561763#56561763", "title": "Loop through dataset and select a range of data", "body": "<p>Since we need to find row next to sought value, we can search for it from the bottom using <code>xlPrevious</code> direction. It will find last row with that value. Offsetting by one row down, we'll get the row we need.</p>\n\n<pre><code>Range(\"A:A\").Find(\"Portfolio_Number\", SearchDIrection:=xlPrevious).Offset(1).EntireRow.Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1560343773, "creation_date": 1560343773, "answer_id": 56562651, "question_id": 56561722, "link": "https://stackoverflow.com/questions/56561722/loop-through-dataset-and-select-a-range-of-data/56562651#56562651", "title": "Loop through dataset and select a range of data", "body": "<p>Try:</p>\n\n<pre><code>    Option Explicit\n\n    Sub test()\n\n        Dim LastRow As Long, i As Long, j As Long, StartPoint As Long\n        Dim strValue As String\n\n        strValue = \"\"\n        StartPoint = 2\n\n        'With statement refer to Sheet1. Change if needed\n        With ThisWorkbook.Worksheets(\"Sheet1\")\n\n            'Find Last row of column A in Sheet1\n            LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n            'Loop starting from row 2 to LastRow variale. Change Starting position if needed\n            For i = 2 To LastRow\n\n                If i &gt;= StartPoint Then\n\n                    strValue = .Range(\"A\" &amp; i).Value\n\n                    For j = i + 1 To LastRow\n\n                        If .Range(\"A\" &amp; j).Value &lt;&gt; strValue Then\n                            .Range(\"A\" &amp; j - 1 &amp; \":B\" &amp; j - 1).Select\n                            Exit For\n                        End If\n\n                    Next j\n\n                    StartPoint = j\n\n                End If\n\n            Next i\n\n        End With\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9380923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37f3232e241f5118304f50100fa013a?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9380923/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1560346691, "creation_date": 1560340671, "question_id": 56561722, "link": "https://stackoverflow.com/questions/56561722/loop-through-dataset-and-select-a-range-of-data", "title": "Loop through dataset and select a range of data", "body": "<p>I have a set of data with portfolio numbers in column A. I want to create a macro that loops through column A and stops and selects the data when a new de portfolio number appears. </p>\n\n<p>I have a example below.</p>\n\n<pre><code>Portfolio   Owner Name\n7000107510  Bravo Top B.V.\n7000107510  Bravo Top B.V.\n7000107510  Bravo Top B.V.\n7000107510  Bravo Top B.V.\n7000107510  Bravo Top B.V.\n7000107510  Bravo Top B.V.\n7000107510  Bravo Top B.V.\n7000108762  Beheermaatschappij J. de Vrind B.V.\n7000108762  Beheermaatschappij J. de Vrind B.V.\n7000108762  Beheermaatschappij J. de Vrind B.V.\n7000108762  Beheermaatschappij J. de Vrind B.V.\n7000108762  Beheermaatschappij J. de Vrind B.V.\n7000108762  Beheermaatschappij J. de Vrind B.V.\n7000108762  Beheermaatschappij J. de Vrind B.V.\n</code></pre>\n\n<p>So the loop selects 7000107510 and stops the loop when is sees a different number (in this case 7000108762). I then want to select the entire rows of data that contains portfolio number 7000107510 and the column next to it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1560339950, "post_id": 56561412, "comment_id": 99702295, "body": "Welcome to SO. You could use PivotTables to group your data by Model and Date, and then make an average with field TimeStamp to get the mean value."}, {"owner": {"reputation": 35, "user_id": 11636352, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XfPspffSLxA/AAAAAAAAAAI/AAAAAAAAADE/fIC5o-mpM2A/photo.jpg?sz=128", "display_name": "Anthony Lemaire", "link": "https://stackoverflow.com/users/11636352/anthony-lemaire"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1560341131, "post_id": 56561412, "comment_id": 99703020, "body": "Thank you! That could be one way to solve it, i like overcomplicating things :-)"}], "owner": {"reputation": 35, "user_id": 11636352, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XfPspffSLxA/AAAAAAAAAAI/AAAAAAAAADE/fIC5o-mpM2A/photo.jpg?sz=128", "display_name": "Anthony Lemaire", "link": "https://stackoverflow.com/users/11636352/anthony-lemaire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560340594, "creation_date": 1560339751, "last_edit_date": 1560340594, "question_id": 56561412, "link": "https://stackoverflow.com/questions/56561412/how-to-make-calculations-based-on-duplicate-values-in-different-columns", "title": "How to make calculations based on duplicate values in different columns", "body": "<p>I'm setting up a database concerning a certain production line.\nAt the end of the production line, a tracability picture is taken of each product, logging the serial number of the product and the timestamp of that picture. I'm trying to add a column with the mean value of the timestamps, if the date on which the picture was taken, and the model, are the same.</p>\n\n<p>Basically, I would like to group the data based on duplicates in the model AND date column, and make calculations (mean, dev) for the delta data for each group.</p>\n\n<p><a href=\"https://paste.pics/bc4a8d473a8df5e543ef980511c555ef\" rel=\"nofollow noreferrer\">https://paste.pics/bc4a8d473a8df5e543ef980511c555ef</a></p>\n\n<p>As you can see here, column B consists of the model nr, and column C is the date the stamp was made</p>\n\n<p>What I want to do is;\nIf a group of rows has the same value for MODEL, AND, the same value for DATE:<br>\nCalculate the mean of Column E for the data in that group of rows</p>\n\n<p>At this moment, I have no idea how to group the data. </p>\n\n<pre><code>dim Modelnrs as range\nDim DateStamp as range\nDim deltaStamp as range\n\nset modelnrs = range(\"B1\",range(\"B1\").end(xldown))\nSet datestamp = range(\"C1\",range(\"C1\").end(xldown))\nset deltastamp = range(\"E1\", range(\"E1\").end(xldown))\n\nfor each cl in modelnrs\nif cl.offset(1,0).value = cl.value AND cl.offset(1,1) = cl.offset(0,1)\nthen\ngroup.add cl.entirerow\n\n\n\n' with each group, calculate mean of column E for group\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 3, "creation_date": 1560339568, "post_id": 56561231, "comment_id": 99702071, "body": "I cannot decide why to close the question: Duplicate, too broad or unclear what you&#39;re asking. All reasons fit."}], "answers": [{"comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1560343826, "post_id": 56561759, "comment_id": 99704707, "body": "Hi @Error 1004: Why do you answer a question when the OP has issued the exact same question already and even accepted the answer?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1560344193, "post_id": 56561759, "comment_id": 99704953, "body": "@FunThomas honestly i did not read the comments or the votes to close the question. i have vote too. shall i delete the answer?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1560344401, "post_id": 56561759, "comment_id": 99705098, "body": "I don&#39;t mind..."}, {"owner": {"reputation": 29, "user_id": 11206962, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-is4deIwxozQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdjhwtJ-C62IMneX0NV39F9f-Nxyw/mo/photo.jpg?sz=128", "display_name": "Deepak L", "link": "https://stackoverflow.com/users/11206962/deepak-l"}, "edited": false, "score": 0, "creation_date": 1560756010, "post_id": 56561759, "comment_id": 99825197, "body": "It is very useful, Thanks"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1560340829, "creation_date": 1560340829, "answer_id": 56561759, "question_id": 56561231, "link": "https://stackoverflow.com/questions/56561231/macro-to-compare-two-columns-with-colour-and-get-the-data-of-the-column-which-ha/56561759#56561759", "title": "Macro to compare two columns with colour and get the data of the column which has Amber colour", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRow As Long, i As Long\n    Dim strValue As String\n\n    'With statement refer to Sheet1. Change if needed\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        'Find Last row of column AA in Sheet1\n        LastRow = .Cells(.Rows.Count, \"AA\").End(xlUp).Row\n\n        'Loop starting from row 1 to LastRow variale. Change Starting position if needed\n        For i = 1 To LastRow\n            'Check interior color. You may need to change RGB\n            If .Range(\"AA\" &amp; i).Interior.Color = RGB(255, 190, 0) Then\n                .Range(\"J\" &amp; i).Value = .Range(\"AA\" &amp; i).Value\n            Else\n                .Range(\"J\" &amp; i).Value = .Range(\"AB\" &amp; i).Value\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 11206962, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-is4deIwxozQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdjhwtJ-C62IMneX0NV39F9f-Nxyw/mo/photo.jpg?sz=128", "display_name": "Deepak L", "link": "https://stackoverflow.com/users/11206962/deepak-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "closed_date": 1560356059, "accepted_answer_id": 56561759, "answer_count": 1, "score": -6, "last_activity_date": 1560340829, "creation_date": 1560339174, "last_edit_date": 1560340102, "question_id": 56561231, "link": "https://stackoverflow.com/questions/56561231/macro-to-compare-two-columns-with-colour-and-get-the-data-of-the-column-which-ha", "closed_reason": "Duplicate", "title": "Macro to compare two columns with colour and get the data of the column which has Amber colour", "body": "<p>I have a list of values in two columns AA and AB columns which are filled with different colors, my formula should compare AA and AB column and find out which column have the Amber color and display the values of that column in J column</p>\n\n<p>I have tried to extract the value from AB and update it in the J column using excel formula but not able to build the macro, I am trying to compare AA and AB column with color and based on that extract the values.</p>\n\n<pre><code>=INDEX($1:$1048576,I11,28)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560339380, "post_id": 56561117, "comment_id": 99701959, "body": "As your reference table is only a single column, are you just checking the values in G exist in the table?"}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560339551, "post_id": 56561117, "comment_id": 99702059, "body": "yes, so i know which cells to consider"}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560340537, "post_id": 56561408, "comment_id": 99702641, "body": "If the file containing the lookup values is the one with the code you can just use <code>Set twb =thisworkbook</code>."}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1560340694, "post_id": 56561408, "comment_id": 99702742, "body": "It works great,is there any way to get rid of the file path for the current workbook?"}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1560340736, "post_id": 56561408, "comment_id": 99702770, "body": "Thanks a lot, i didnt notice the comment"}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1560347073, "post_id": 56561408, "comment_id": 99706896, "body": "Theres a problem with the code, its displaying not found in all cells"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1560349071, "post_id": 56561408, "comment_id": 99708220, "body": "Need more info. If you are running code repeatedly, you should clear the output cells first."}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1560349498, "post_id": 56561408, "comment_id": 99708453, "body": "i have i clear them everytime, could there be a problem with the match function"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1560349571, "post_id": 56561408, "comment_id": 99708491, "body": "The values in G must not be found in the table. Without knowing anything about your data, hard to provide more detail, but check for leading or trailing spaces."}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1560349667, "post_id": 56561408, "comment_id": 99708549, "body": "Is there anyway i can attach the excel sheets here"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1560349820, "post_id": 56561408, "comment_id": 99708649, "body": "Not files, but you can add screenshots to your question."}, {"owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1560350228, "post_id": 56561408, "comment_id": 99708885, "body": "attached 2 screenshots, Thanks for all the help"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "edited": false, "score": 0, "creation_date": 1560350552, "post_id": 56561408, "comment_id": 99709099, "body": "Afraid I can&#39;t really tell anything from them - try stepping through your code using F8 to see what&#39;s going on, and add a breakpoint on the not found section. Somewhere along the line it is not finding the values in the table - check your references as well."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1560341449, "last_edit_date": 1560341449, "creation_date": 1560339733, "answer_id": 56561408, "question_id": 56561117, "link": "https://stackoverflow.com/questions/56561117/using-vba-for-vlookup-from-a-different-file/56561408#56561408", "title": "Using vba for vlookup from a different file", "body": "<p>Try this. You'll need to adjust the workbook and sheet names to suit.</p>\n\n<p>Not sure what output you are expecting, I have just added a text message in the output cells in AA.</p>\n\n<pre><code>Sub y()\n\nDim rw As Long, x As Range, v As Variant\nDim extwbk As Workbook, twb As Workbook\n\nSet twb = ThisWorkbook 'file with lookup values (containing code)\nSet extwbk = Workbooks.Open(\"C:\\Users\\OUROBOROS\\Desktop\\30-5-19\\vba\\VBA\\1st phase stores.xlsx\") 'file with reference table\nSet x = extwbk.Worksheets(\"Sheet1\").Range(\"A2:A300\")\n\nFor rw = 2 To twb.Sheets(\"Sheet1\").Cells(Rows.Count, \"G\").End(xlUp).Row\n    v = Application.Match(twb.Sheets(\"Sheet1\").Cells(rw, \"G\").Value2, x, 0)\n    If IsNumeric(v) Then\n        twb.Sheets(\"Sheet1\").Cells(rw, \"AA\").Value = \"Found\" 'G is in the table\n    Else\n        twb.Sheets(\"Sheet1\").Cells(rw, \"AA\").Value = \"Not found\" ''G is NOT in the table\n    End If\nNext rw\n\nextwbk.Close savechanges:=False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 11582077, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OKEoacC-lG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re5XJb6t23q6KCwjz08CMMBvWhomQ/mo/photo.jpg?sz=128", "display_name": "Karthik Apadodharanan", "link": "https://stackoverflow.com/users/11582077/karthik-apadodharanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 56561408, "answer_count": 1, "score": 0, "last_activity_date": 1560350468, "creation_date": 1560338862, "last_edit_date": 1560350468, "question_id": 56561117, "link": "https://stackoverflow.com/questions/56561117/using-vba-for-vlookup-from-a-different-file", "title": "Using vba for vlookup from a different file", "body": "<p>I'm trying to write a code to use <code>vlookup</code> where the reference is another file. The reference table is from cell <code>a2</code> to <code>a300</code>. The lookup value is from cell <code>G2</code> to end of column. The <code>vlookup</code> is to be done in column <code>AA</code>.</p>\n\n<p>I found the code below on one of the solutions on this website, but have no idea how to change it to suit my file.</p>\n\n<pre><code>Sub SBEPlannerAdder()\nDim rw As Long, x As Range\nDim extwbk As Workbook, twb As Workbook\n\nSet twb = Workbooks.Open(\"C:\\Users\\OUROBOROS\\Desktop\\30-5-19\\vba\\VBA\\Gents_SW_May'19.xlsb\")\nSet extwbk = Workbooks.Open(\"C:\\Users\\OUROBOROS\\Desktop\\30-5-19\\vba\\VBA\\1st phase stores.xlsx\")\nSet x = extwbk.Worksheets(\"Sheet1\").Range(\"A1:C300\")\n\n\n    For rw = 2 To twb.Sheets(\"Sheet1\").Cells(Rows.Count, 25).End(xlUp).Row\n       twb.Sheets(\"Sheet1\").Cells(rw, 2) = Application.VLookup(twb.Sheets(\"Sheet1\").Cells(rw, 1).Value2, x, 2, False)\n    Next rw\n\nextwbk.Close savechanges:=False\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TZffs.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/cItpL.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11636212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9ebce35e09a0324a08b92f5026df2e?s=128&d=identicon&r=PG&f=1", "display_name": "Nomadz94", "link": "https://stackoverflow.com/users/11636212/nomadz94"}, "edited": false, "score": 0, "creation_date": 1560339204, "post_id": 56560630, "comment_id": 99701845, "body": "Thanks for replying. Doing this i still get &quot;Subscript out of range error&quot; at the &quot;With x.worksheets(&quot;L&#248;sninger&quot;) line. And also the code deleted everything else in my &quot;Tavleark1&quot; workbook and pasted the specific data into that range instead"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 5, "user_id": 11636212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9ebce35e09a0324a08b92f5026df2e?s=128&d=identicon&r=PG&f=1", "display_name": "Nomadz94", "link": "https://stackoverflow.com/users/11636212/nomadz94"}, "edited": false, "score": 0, "creation_date": 1560346172, "post_id": 56560630, "comment_id": 99706303, "body": "@Nomadz94 the error may be because of that german O, you might want to change it. And about the second question, check if y must be x and viceversa... I did as I thought reading your code."}, {"owner": {"reputation": 5, "user_id": 11636212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9ebce35e09a0324a08b92f5026df2e?s=128&d=identicon&r=PG&f=1", "display_name": "Nomadz94", "link": "https://stackoverflow.com/users/11636212/nomadz94"}, "edited": false, "score": 0, "creation_date": 1560409744, "post_id": 56560630, "comment_id": 99728224, "body": "Hey Damian, what do you mean specifically by y must be x? It&#39;s been quite some time since I&#39;ve last coded in VBA, so I&#39;m currently quite a novice. I will also try without the &quot;&#216;&quot;"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 5, "user_id": 11636212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9ebce35e09a0324a08b92f5026df2e?s=128&d=identicon&r=PG&f=1", "display_name": "Nomadz94", "link": "https://stackoverflow.com/users/11636212/nomadz94"}, "edited": false, "score": 0, "creation_date": 1560409995, "post_id": 56560630, "comment_id": 99728361, "body": "@Nomadz94 you are giviing your workbooks a reference one is <code>x</code> and the other one is <code>y</code> (I would use <code>Sourcewb</code> and <code>Destwb</code> for example) maybe I switched which one is to copy and paste from."}, {"owner": {"reputation": 5, "user_id": 11636212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9ebce35e09a0324a08b92f5026df2e?s=128&d=identicon&r=PG&f=1", "display_name": "Nomadz94", "link": "https://stackoverflow.com/users/11636212/nomadz94"}, "edited": false, "score": 0, "creation_date": 1560426102, "post_id": 56560630, "comment_id": 99737087, "body": "My bad - I realized the autofilter just filters the blanks out, and does not delete them. The problems seems to appear at x.worksheets(&quot;Losninger&quot;). Still giving me subscript out of range"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 5, "user_id": 11636212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9ebce35e09a0324a08b92f5026df2e?s=128&d=identicon&r=PG&f=1", "display_name": "Nomadz94", "link": "https://stackoverflow.com/users/11636212/nomadz94"}, "edited": false, "score": 0, "creation_date": 1560426303, "post_id": 56560630, "comment_id": 99737205, "body": "What problems? on <code>x.worksheets(&quot;Losninger&quot;)</code> the procedure only calculates the last row and pastes the <code>CopyRange</code>and then deletes it."}, {"owner": {"reputation": 5, "user_id": 11636212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9ebce35e09a0324a08b92f5026df2e?s=128&d=identicon&r=PG&f=1", "display_name": "Nomadz94", "link": "https://stackoverflow.com/users/11636212/nomadz94"}, "edited": false, "score": 0, "creation_date": 1560427032, "post_id": 56560630, "comment_id": 99737596, "body": "The problem is run time error 9, it can&#39;t seem to identify either workbook or worksheet."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 5, "user_id": 11636212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9ebce35e09a0324a08b92f5026df2e?s=128&d=identicon&r=PG&f=1", "display_name": "Nomadz94", "link": "https://stackoverflow.com/users/11636212/nomadz94"}, "edited": false, "score": 0, "creation_date": 1560433096, "post_id": 56560630, "comment_id": 99741436, "body": "@Nomadz94 you can debug the value for the workbook name and check if the worksheet exists or whatever, you can go through your code pressing F8, vba will execute line per line."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1560337384, "creation_date": 1560337384, "answer_id": 56560630, "question_id": 56560446, "link": "https://stackoverflow.com/questions/56560446/copying-looped-data-from-one-workbook-and-paste-to-another/56560630#56560630", "title": "Copying looped data from one workbook and paste to another", "body": "<p>You don't need to loop through each loop, a simple filter will do the trick:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim x As Workbook\n    Dim y As Workbook\n    Dim CopyRange As Range\n    Dim LastRow As Long\n\n    Set x = Workbooks.Open(\"C:\\Users\\u054939\\Desktop\\Diverse filer\\Safecard\\Safecardmaster.xlsm\")\n    Set y = Workbooks.Open(\"C:\\Users\\u054939\\Desktop\\Diverse filer\\Safecard\\Tavleark1.xlsm\")\n\n    'Look for the range to copy and set it\n    With y.Worksheets(\"Tabledisplay\")\n        .UsedRange.AutoFilter Field:=14, Criteria1:=\"Ja\"\n        LastRow = .Cells(.Rows.Count, 14).End(xlUp).Row\n        Set CopyRange = .Range(\"A2\", .Cells(LastRow, .UsedRange.Columns.Count)).SpecialCells(xlCellTypeVisible)\n        .AutoFilterMode = False\n    End With\n\n    'Paste it to the other sheet\n    With x.Worksheets(\"L\u00f8sninger\")\n        LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row + 1\n        CopyRange.Copy .Cells(LastRow, 1)\n    End With\n\n    'Delete the range from the original sheet\n    CopyRange.Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11636212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9ebce35e09a0324a08b92f5026df2e?s=128&d=identicon&r=PG&f=1", "display_name": "Nomadz94", "link": "https://stackoverflow.com/users/11636212/nomadz94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 56560630, "answer_count": 1, "score": 0, "last_activity_date": 1560458640, "creation_date": 1560336763, "last_edit_date": 1560458640, "question_id": 56560446, "link": "https://stackoverflow.com/questions/56560446/copying-looped-data-from-one-workbook-and-paste-to-another", "title": "Copying looped data from one workbook and paste to another", "body": "<p>I have written this code, and it works when doing it from one sheet to another. (Same workbook). But when i loop through the rows from workbook to workbook i get \"Run time error 9\" Subscript out of range.</p>\n\n<p>I've checked several times if the filenames are as stated in the code, and it doesn't seem to be the problem. Also if I in the first piece write y.sheets(\"Tavledisplay\") instead of worksheets(\"Tavledisplay\") the debugger tells me there's a problem there. Doing it the latter way, it sends 1 loop of data, and stops at <code>y.sheets(\"Tavledisplay\").Activate</code>.</p>\n\n<p>My code:</p>\n\n<pre><code>Dim x As Workbook\nDim y As Workbook\n\nSet x = Workbooks.Open(\"C:\\Users\\u054939\\Desktop\\Diverse filer\\Safecard\\Safecardmaster.xlsm\")\nSet y = Workbooks.Open(\"C:\\Users\\u054939\\Desktop\\Diverse filer\\Safecard\\Tavleark1.xlsm\")\n\n    a = Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 2 To a\n\n        If Worksheets(\"Tavledisplay\").Cells(i, 14).Value = \"Ja\" Then\n            Worksheets(\"Tavledisplay\").Rows(i).Select\n            Selection.Copy\n            x.Sheets(\"L\u00f8sninger\").Activate\n            b = Worksheets(\"L\u00f8sninger\").Cells(Rows.Count, 1).End(xlUp).Row\n            x.Sheets(\"L\u00f8sninger\").Cells(b + 1, 1).Select\n            ActiveSheet.Paste\n            y.Sheets(\"Tavledisplay\").Activate\n            Selection.ClearContents\n\n\n    End If\n\nNext i\n\nApplication.CutCopyMode = False\nx.Sheets(\"L\u00f8sninger\").Select\n</code></pre>\n\n<p>I expect the code to loop through all the given rows, where there is a \"Ja\" in column 14, and pasting them into my other workbook sheet \"L\u00f8sninger\" and deleting them from the other workbook.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1560335923, "creation_date": 1560335923, "answer_id": 56560176, "question_id": 56560000, "link": "https://stackoverflow.com/questions/56560000/get-used-range-in-listobject-table-column/56560176#56560176", "title": "Get used Range in ListObject Table Column", "body": "<p>Like this you will avoid any errors because you errors come from the <code>ActiveSheet</code> which may be different if the user interacts:</p>\n\n<pre><code>Dim Lastrow As Long 'don't use Integer is a Long cut to the integer\nDim rng As Range\n\nWith ThisWorkbook.Sheets(\"MySheet\") 'Change MySheet to your working sheet name\n    Lastrow = .Cells(.Rows.Count, 2).End(xlUp).Row\n    Set rng = .Range(\"B12:B\" &amp; Lastrow)\nEnd With\n</code></pre>\n\n<p>This way all your data will come from the sheet <code>MySheet</code> both the <code>LastRow</code> and the <code>rng</code>. You can notice I'm using a dot in front of <code>Cells</code>, <code>Rows.count</code> and <code>Range</code>. This means it's referencing the sheet on the line: <code>With ThisWorkbook.Sheets(\"MySheet\")</code></p>\n"}, {"comments": [{"owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "edited": false, "score": 0, "creation_date": 1560456735, "post_id": 56560244, "comment_id": 99753724, "body": "Tom, I think this selects even empty cells in column 2 of the table ?"}, {"owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "edited": false, "score": 0, "creation_date": 1560456814, "post_id": 56560244, "comment_id": 99753749, "body": "I am trying to pass your answer to a userform combobox list but doesnt seem to work"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "edited": false, "score": 0, "creation_date": 1560761011, "post_id": 56560244, "comment_id": 99827502, "body": "@JoannaMikalai Yes it will do - as would yours above. If you want non empty cells you could try using <code>set rng = tbl.ListColumns(2).DataBodyRange.SpecialCells(xlCellTypeCons&zwnj;&#8203;tants)</code> which depending on how your data is may omit the blank cells. How are you passing it to the <code>ComboBox.List</code>? It may be because you&#39;re passing the range object to it. Try using <code>ComboBox.List = rng.Value2</code> instead"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1560336689, "last_edit_date": 1560336689, "creation_date": 1560336132, "answer_id": 56560244, "question_id": 56560000, "link": "https://stackoverflow.com/questions/56560000/get-used-range-in-listobject-table-column/56560244#56560244", "title": "Get used Range in ListObject Table Column", "body": "<p>The following will select the range of your data in table column 2</p>\n\n<pre><code>Dim tbl as ListObject\nDim rng as Range\n\nset tbl = ActiveSheet.ListObjects(\"YourTableName\")\n\nset rng = tbl.ListColumns(2).DataBodyRange\n</code></pre>\n\n<p>There is a very comprehensive guide on how to select different parts of the <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">ListObject here</a></p>\n\n<pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551                                      Selecting Areas Of A Table With VBA                                     \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551                Select                \u2551                               VBA Coding                              \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Entire Table                         \u2551 ActiveSheet.ListObjects(\"Table1\").Range.Select                        \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Table Header Row                     \u2551 ActiveSheet.ListObjects(\"Table1\").HeaderRowRange.Select               \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Table Data                           \u2551 ActiveSheet.ListObjects(\"Table1\").DataBodyRange.Select                \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Third Column                         \u2551 ActiveSheet.ListObjects(\"Table1\").ListColumns(3).Range.Select         \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Third Column (Data Only)             \u2551 ActiveSheet.ListObjects(\"Table1\").ListColumns(3).DataBodyRange.Select \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Select Row 4 of Table Data           \u2551 ActiveSheet.ListObjects(\"Table1\").ListRows(4).Range.Select            \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Select 3rd Heading                   \u2551 ActiveSheet.ListObjects(\"Table1\").HeaderRowRange(3).Select            \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Select Data point in Row 3, Column 2 \u2551 ActiveSheet.ListObjects(\"Table1\").DataBodyRange(3,                    \u2551\n\u2551                                      \u2551   2).Select                                                           \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Subtotals                            \u2551 ActiveSheet.ListObjects(\"Table1\").TotalsRowRange.Select               \u2551\n\u2551                                      \u2551                                                                       \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1560336201, "creation_date": 1560336201, "answer_id": 56560260, "question_id": 56560000, "link": "https://stackoverflow.com/questions/56560000/get-used-range-in-listobject-table-column/56560260#56560260", "title": "Get used Range in ListObject Table Column", "body": "<pre><code>Sub F()\n    Dim tbl As ListObject\n    Dim col As ListColumn\n    Set tbl = ActiveSheet.ListObjects(\"Table1\")\n    Set col = tbl.ListColumns(2)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 104, "user_id": 6406135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f71cc10a2c550b7ede967efb11c1479?s=128&d=identicon&r=PG&f=1", "display_name": "robertocm", "link": "https://stackoverflow.com/users/6406135/robertocm"}, "is_accepted": false, "score": 0, "last_activity_date": 1614593977, "creation_date": 1614593977, "answer_id": 66420254, "question_id": 56560000, "link": "https://stackoverflow.com/questions/56560000/get-used-range-in-listobject-table-column/66420254#66420254", "title": "Get used Range in ListObject Table Column", "body": "<p>I'using this:</p>\n<pre><code>Dim lastrow as Long, tbl As ListObject\nWith Sheets(&quot;Sheet1&quot;)\n    Set tbl = .ListObjects(&quot;MyTable&quot;)\n    With tbl\n        'Siddharth Rout, Feb 2018\n        'http://www.siddharthrout.com/index.php/2018/02/10/find-last-row-and-last-column/\n        'https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\n        lastrow = .ListColumns(1).Range.Find(&quot;*&quot;, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n        .DataBodyRange(lastrow, 1).Resize(1, 3) = Array(Date, &quot;some text&quot;, &quot;some text&quot;)\n    End With\n    Set tbl = Nothing\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 911, "favorite_count": 0, "accepted_answer_id": 56560244, "answer_count": 4, "score": 0, "last_activity_date": 1614593977, "creation_date": 1560335375, "question_id": 56560000, "link": "https://stackoverflow.com/questions/56560000/get-used-range-in-listobject-table-column", "title": "Get used Range in ListObject Table Column", "body": "<p>I am using this code to get the used range in a <code>Listobject</code> table column but I was wondering if there is a better way of doing this with <code>Listobjects</code> as this code is prone to errors. </p>\n\n<pre><code>Dim Lastrow As Integer\nDim rng as Range\n\nLastrow = ActiveSheet.Cells(Rows.Count, 2).End(xlUp).Row\nSet rng = Range(\"B12:B\" &amp; Lastrow)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 1, "creation_date": 1560335750, "post_id": 56559947, "comment_id": 99699922, "body": "But something wrong, do you want create multiple ranges? or only last one?"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1560338314, "post_id": 56559947, "comment_id": 99701329, "body": "@PKen In your previous question I posted two different standalone subs each one approaching the problem in a different way depending on the desired outcome. You need to choose one of them and move on from there."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "edited": false, "score": 0, "creation_date": 1560338889, "post_id": 56561065, "comment_id": 99701666, "body": "that is great thanks! didn&#39;t realise I could set featuresRng to correspond to two columns and I hadn&#39;t used ReDim before, that is so useful thank you!"}, {"owner": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "edited": false, "score": 0, "creation_date": 1560339587, "post_id": 56561065, "comment_id": 99702084, "body": "how can I find the exact value?"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "edited": false, "score": 0, "creation_date": 1560342199, "post_id": 56561065, "comment_id": 99703727, "body": "this is exact value <code>rngArray(i, 2) = &quot;Language&quot;</code> this is like value <code>if instr(rngArray(i, 2), &quot;Language&quot;) &gt;0 then ...</code>"}, {"owner": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "edited": false, "score": 0, "creation_date": 1560350302, "post_id": 56561065, "comment_id": 99708930, "body": "amazing thanks, so does that mean that the string in quotation marks can only be one word? I am trying to have &quot;Report Management&quot; and get an object error?"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "edited": false, "score": 0, "creation_date": 1560360225, "post_id": 56561065, "comment_id": 99714125, "body": "it can be everithin you want. number string or string with wildcards"}, {"owner": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "edited": false, "score": 0, "creation_date": 1560418366, "post_id": 56561065, "comment_id": 99732812, "body": "I get an Application or Object Defined Error when I try and put in something like &quot;Search and Filter&quot; in instead of &quot;OSI&quot;? Are there any other values I should be changing?"}, {"owner": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "edited": false, "score": 0, "creation_date": 1560418950, "post_id": 56561065, "comment_id": 99733144, "body": "Also, how do I get the new range to select three cells in a row not just two?"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "edited": false, "score": 0, "creation_date": 1560420560, "post_id": 56561065, "comment_id": 99734088, "body": "create new question to understand that you do"}, {"owner": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "edited": false, "score": 0, "creation_date": 1560421084, "post_id": 56561065, "comment_id": 99734402, "body": "Hi @Dmitrij Holkin, yes I have, it is here: <a href=\"https://stackoverflow.com/questions/56578310/how-to-extend-named-range-with-vba-using-offset\" title=\"how to extend named range with vba using offset\">stackoverflow.com/questions/56578310/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1560338682, "creation_date": 1560338682, "answer_id": 56561065, "question_id": 56559947, "link": "https://stackoverflow.com/questions/56559947/create-a-range-based-on-criteria-in-two-columns/56561065#56561065", "title": "Create a range based on criteria in two columns", "body": "<p>Try this</p>\n\n<pre><code>Sub another()\n\nDim featuresRng As Range, NewArr As Variant\nDim rng As Range\nDim sht As Worksheet\nDim sRng As String\nDim i As Long\n\nSet sht = ThisWorkbook.Worksheets(\"Features\")\nSet featuresRng = sht.Range(sht.Range(\"B1\"), sht.Range(\"C\" &amp; sht.Rows.Count).End(xlUp))\nrngArray = featuresRng\nReDim NewArr(1 To 1)\ny = 1\nFor i = 1 To UBound(rngArray)\n    If rngArray(i, 2) = \"Language\" And rngArray(i, 1) = \"OSI\" Then\n        ReDim Preserve NewArr(1 To y)\n        NewArr(y) = featuresRng.Rows(i).Offset(0, 3).Address\n        y = y + 1\n\n    End If\nNext i\n\nsRng = Join(NewArr, Application.DecimalSeparator)\nThisWorkbook.Names.Add \"OSILAng\", sht.Range(sRng)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 11464166, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HsTz6PT7LlA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcUP1M_VlH6Kucm9O2Q7FSu6d1BgQ/mo/photo.jpg?sz=128", "display_name": "PKen", "link": "https://stackoverflow.com/users/11464166/pken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 56561065, "answer_count": 1, "score": 1, "last_activity_date": 1560338682, "creation_date": 1560335177, "last_edit_date": 1560335402, "question_id": 56559947, "link": "https://stackoverflow.com/questions/56559947/create-a-range-based-on-criteria-in-two-columns", "title": "Create a range based on criteria in two columns", "body": "<p>This relates to another question I recently posted, which @Stavros Jon kindly helped me with. </p>\n\n<p>I am trying to create a named range based on criteria in column B and column C. I want to create a range if column B contains the word \"OSI\" and column C contains the word \"Language\". </p>\n\n<p>I have tried editing my previous code, but I cannot get the syntax right and get an object error with the counter line.</p>\n\n<pre><code>Sub another()\n\n'Create Ranges:\n\nDim featuresRng As Range\nDim rng As Range\nDim sht As Worksheet\nDim counter As Long\nDim cell As Range\nSet sht = ThisWorkbook.Worksheets(\"Features\")\nSet featuresRng = sht.Range(sht.Range(\"C1\"), sht.Range(\"C\" &amp; sht.Rows.Count).End(xlUp)) 'dynamically set the range of features\nSet featuresRng2 = sht.Range(sht.Range(\"B1\"), sht.Range(\"B\" &amp; sht.Rows.Count).End(xlUp))\n\ncounter = 0 'this counter will help us avoid Union(Nothing, some range), which would give an error\n\nFor Each cell In featuresRng 'loop through the range of features\n    If featuresRng.cell.Value = \"Language\" And featuresRng2.cell.Value = \"OSI\" Then\n        counter = counter + 1\n        If counter = 1 Then\n            Set rng = sht.Range(cell.Offset(0, 1), cell.Offset(0, 3))\n        Else\n            Set rng = Union(rng, sht.Range(cell.Offset(0, 1), cell.Offset(0, 3))) 'build the range\n        End If\n    End If\nNext cell\nDebug.Print rng.Address\nThisWorkbook.Names.Add \"OSILAng\", rng\n\nEnd Sub\n</code></pre>\n\n<p>How can I edit my code to include these two criteria?</p>\n\n<p>Also, sometimes my text in column B will contain words in other cells, like \"Filter\" and \"Filter and Search\", I am also looking to make my range from the EXACT text in column C cells, not just 'contains this text. </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1, "user_id": 10649724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570342610789444ee5865a6fd5dcad0c?s=128&d=identicon&r=PG&f=1", "display_name": "Saikat Mitra ", "link": "https://stackoverflow.com/users/10649724/saikat-mitra"}, "edited": false, "score": 0, "creation_date": 1560339206, "post_id": 56559568, "comment_id": 99701848, "body": "Hi, pleade update on the request."}, {"owner": {"reputation": 1, "user_id": 10649724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570342610789444ee5865a6fd5dcad0c?s=128&d=identicon&r=PG&f=1", "display_name": "Saikat Mitra ", "link": "https://stackoverflow.com/users/10649724/saikat-mitra"}, "edited": false, "score": 0, "creation_date": 1560408111, "post_id": 56559568, "comment_id": 99727414, "body": "Hi all.. Please assist"}], "owner": {"reputation": 1, "user_id": 10649724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570342610789444ee5865a6fd5dcad0c?s=128&d=identicon&r=PG&f=1", "display_name": "Saikat Mitra ", "link": "https://stackoverflow.com/users/10649724/saikat-mitra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560333996, "creation_date": 1560333996, "question_id": 56559568, "link": "https://stackoverflow.com/questions/56559568/outlook-flaggedtasked-emails-response", "title": "Outlook Flagged(tasked) emails response", "body": "<p>Daily I receive tons of emails, maximum of which needs to be worked upon and some are follow up emails.\nI am using the flagged mode to track the important emails and replying them and simultaneously clearing the flags, and sometimes I forget hence I have to go to the sent item and search by email's subject line and take action accordingly.</p>\n\n<p>I am looking for a code which will help me in:-\n1.Macro will iterate through all the flagged emails in inbox.</p>\n\n<p>2.Then it will check the sent on time (received time of the email in inbox)</p>\n\n<p>3.Thereafter it will check the sent items whether the email has been replied (re: Subject) or forwarded (fw:subject) and with the senton time.</p>\n\n<p>4.If the sent time is more than > received time (of the flagged emails) then  <strong>msgbox</strong>:- <strong><em>Email has been replied</em></strong>\notherwise it will pop up a <strong>msgbox</strong>:- <strong><em>Email</strong> <strong>has not been replied, do you want to reply?,</em></strong> if yes, then it will reply the existing email with write function.</p>\n\n<p>I do have written a code,it is working but I am not getting any response, nor pop up emails nor any bug fixing pop ups.your response will be highly appreciated :-</p>\n\n<pre><code>Sub trial()\nOn Error Resume Next\nDim objfolder As Outlook.MAPIFolder\nDim objfolder2 As Outlook.MAPIFolder\nDim objfolder2 As Outlook.MAPIFolder\nDim objfolder1 As Outlook.MAPIFolder\nDim objns As Outlook.NameSpace`Dim objitem As Outlook.MailItem`\nDim objitem1 As Outlook.MailItem\nDim objvariant As Variant\nDim objvariant1 As Variant\nDim obsubject As Variant\n\nDim obsubject1 As Variant\n\nDim sendtime As Variant\n\nDim sendtime1 As Variant\nDim obfollowupmail As Outlook.MailItem\nDim strpromt As Variant\nDim nresponse As Integer\n\nSet objns = Outlook.GetNamespace(\"MAPI\")\n'declaring inbox\n\nSet objinbox = objns.GetDefaultFolder(olFolderInbox)\n'declaring sent\n\nSet objfolder1 = objns.GetDefaultFolder(olFolderSentMail)\nFor Each objitem In objinbox\n\nIf objinbox.DefaultItemType = olMailItem Then\nIf objitem.Class = olMail Then\nIf objitem = IsMarkedAsTask Then\n\n\nSet objvaraiant = objinbox.Items\nSet obsubject = LCase(objvariant.Subject)\nSet sendtime = objvariant.SentOn\n\n\n\nobsubject1 = \"re: &amp;subject\"\n\nFor Each obsubject1 In objfolder1\nSet objvariant1 = objfolder1.Items\nSet sendtime1 = obsubject1.SentOn\nIf sendtime1 &gt; sendtime Then\nMsgBox (\"Message has been replied for\" &amp; obsubject)\nElse\nstrpromt = \"you haven't received the reply of\" &amp; obsubject\nnresponse = MsgBox(vbYesNo + vbQuestion, \"Confirm to send a follow up email?\")\nIf nresponse = vbYes Then\nSet obfollowupmail = Application.CreateItem(olMailItem)\nWith obfollowupmail\n.Display\n\n\n\n\nSet objitem = Nothing\nSet obfolder = Nothing\nSet objinbox = Nothing\nSet objns = Nothing\n\nEnd With\nEnd If\nEnd If\n\nNext\n\n\nEnd If\nEnd If\nEnd If\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1560336665, "post_id": 56559804, "comment_id": 99700409, "body": "It&#39;s not an answer. Use <a href=\"https://stackoverflow.com/questions/56559512/for-loop-check-if-each-worksheet-contains-certain-color-if-yes-copy-and-paste#\">comment</a> for clarifications."}, {"owner": {"reputation": 51, "user_id": 9697042, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vGWgnsyRTCA/AAAAAAAAAAI/AAAAAAAAA34/GHXncS51m4o/photo.jpg?sz=128", "display_name": "p77u77n77k", "link": "https://stackoverflow.com/users/9697042/p77u77n77k"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1560345899, "post_id": 56559804, "comment_id": 99706109, "body": "I need to have 50 reputation to comment people posts, so that&#39;s why I&#39;ve posted &quot;Answer&quot;"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1560346488, "post_id": 56559804, "comment_id": 99706498, "body": "Then gain these 50 reputations \ud83d\ude09"}], "tags": [], "owner": {"reputation": 51, "user_id": 9697042, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vGWgnsyRTCA/AAAAAAAAAAI/AAAAAAAAA34/GHXncS51m4o/photo.jpg?sz=128", "display_name": "p77u77n77k", "link": "https://stackoverflow.com/users/9697042/p77u77n77k"}, "is_accepted": false, "score": -1, "last_activity_date": 1560334688, "creation_date": 1560334688, "answer_id": 56559804, "question_id": 56559512, "link": "https://stackoverflow.com/questions/56559512/check-if-each-worksheet-contains-certain-color-and-paste-into-target-worksheet/56559804#56559804", "title": "Check if each worksheet contains certain color and paste into target worksheet", "body": "<p>Do you need whole row to be \"yellow\" ? or there is allways one cell in each row ?.</p>\n\n<p>I'm asking what if A1 is yellow ,B1 is blue, C1 is red, D1 is yellow you want to copy from this row only A1 and D1 to Sheet \"ToDo\"- into A1 and B1 or copy/paste entire row?</p>\n\n<p>Have a great day</p>\n"}, {"tags": [], "owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "is_accepted": true, "score": 0, "last_activity_date": 1560348350, "last_edit_date": 1560348350, "creation_date": 1560347913, "answer_id": 56563999, "question_id": 56559512, "link": "https://stackoverflow.com/questions/56559512/check-if-each-worksheet-contains-certain-color-and-paste-into-target-worksheet/56563999#56563999", "title": "Check if each worksheet contains certain color and paste into target worksheet", "body": "<p>This runs through each cell in the usedrange of each worksheet.  If the interior color matches it copies all the values from that row, and puts it in the ToDo list worksheet.  If the row counter for the todo list hasn't changed after the loops were complete then \"no info obtained\" message will pop up.</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim oToDo As Worksheet\n    Set oToDo = Worksheets(\"ToDo\")\n    Dim oToDoRow As Long\n    oToDoRow = 2        ' Whatever row your \"todo\" data starts on\n\n    Dim oCell As Range\n    Dim oCurWS As Worksheet\n    Dim oPrevRow As String\n\n    For Each oCurWS In ThisWorkbook.Worksheets\n        If oCurWS.Name &lt;&gt; \"ToDo\" Then\n            For Each oCell In oCurWS.UsedRange\n                ' I used Interior Color you should be able to use colorindex in the same way\n                If oCell.Interior.Color = 65535 Then\n                    If oPrevRow &lt;&gt; oCurWS.Index &amp; \"_\" &amp; oCell.Row Then\n                        oToDo.Rows(oToDoRow).Value = oCurWS.Rows(oCell.Row).Value\n                        oPrevRow = oCurWS.Index &amp; \"_\" &amp; oCell.Row\n                        oToDoRow = oToDoRow + 1\n                    End If\n                End If\n            Next\n        End If\n    Next\n\n    ' Match oToDoRow with whatever is set as default at the top\n    If oToDoRow = 2 Then MsgBox \"No info obtained\"\n\nEnd Sub\n</code></pre>\n\n<p>Update to prevent row being listed multiple times if more than one cell in a row was highlighted.</p>\n"}], "owner": {"reputation": 3, "user_id": 11635918, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2rYhLEkIE-I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7e8hYRudCvSBZ4frcnJ8bQaxvCQ/mo/photo.jpg?sz=128", "display_name": "FHMC", "link": "https://stackoverflow.com/users/11635918/fhmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 56563999, "answer_count": 2, "score": 0, "last_activity_date": 1562944400, "creation_date": 1560333832, "last_edit_date": 1562944400, "question_id": 56559512, "link": "https://stackoverflow.com/questions/56559512/check-if-each-worksheet-contains-certain-color-and-paste-into-target-worksheet", "title": "Check if each worksheet contains certain color and paste into target worksheet", "body": "<p>For each worksheet in my workbook, I would like to:<br>\n- Check if rows contain cells with colour index -4142 (yellow)<br>\n- If yes, copy and paste row values into ToDo list.</p>\n\n<p>I have tried:<br>\n1) For Each loop, as indicated below.<br>\n2) Dim i As Long  </p>\n\n<pre><code>For i = 1 To ThisWorkbook.Worksheets.Count\nSet Sh1 = Worksheets(i)\n</code></pre>\n\n<pre><code>Sub Macro1()\n\nDim wrk As Workbook\nDim colCount As Integer\nDim ws As Worksheet\nDim Sh1 As Worksheet, Sh2 As Worksheet\nDim r As Range, r1 As Range, cell As Range\nDim iResponse As Integer\nDim LastRow As Long\n\niResponse = MsgBox(\"Do you want to COPY your 'Current List' (Hi-lighted rows) to the 'Select List' sheet?\", vbYesNoCancel + vbQuestion + vbDefaultButton3, \"Copy Selected Results To View In Select List\")\n\nSelect Case iResponse\n\nCase vbCancel\n    MsgBox \"Cancelled\", vbOKOnly + vbExclamation, \"Cancelled copy\"\n\nCase vbNo: 'do Nothing\n    MsgBox \"Doing nothing\", vbOKOnly + vbInformation, \"Doing nothing\"\n\nCase vbYes\n\nFor Each ws In ActiveWorkbook.Worksheets ' For each worksheet in workbook\n    Set Sh1 = Worksheets(ws.Index) ' Sh1 will be first, second, etc. worksheet\n    Set Sh2 = Worksheets(\"ToDo\")  ' sheet to copy to\n\n    Set wrk = ActiveWorkbook ' to get header as first row\n    colCount = Sh1.Cells(1, 255).End(xlToLeft).Column\n    With Sh2.Cells(1, 1).Resize(1, colCount)\n        .Value = Sh1.Cells(1, 1).Resize(1, colCount).Value\n        .Font.Bold = True\n    End With\n\n    Set r1 = Sh1.Range(Sh1.Cells(2, \"D\"), Sh1.Cells(Rows.Count, \"C\").End(xlUp))\n\n    For Each cell In r1\n        If cell.Interior.ColorIndex = 6 Then\n            If r Is Nothing Then\n                Set r = cell\n            Else\n                Set r = Union(r, cell)\n            End If\n        End If\n    Next\n\n    If Not r Is Nothing Then\n        LastRow = Sh2.Cells(Rows.Count, \"C\").End(xlUp).Row\n        With Sh2\n            r.EntireRow.Copy Destination:=.Range(\"A\" &amp; LastRow + 1)\n            .UsedRange.Offset(1).Interior.ColorIndex = -4142\n            Range(\"A1\").Select\n        End With\n\n    Else\n        MsgBox \"No info obtained\", vbExclamation, \"Nothing copied.\"\n\n    End If\n\n    Exit For ' Exit For loop\nNext ws ' Next worksheet\n\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>The expected output is:<br>\nIf Sheet 1 has 3 rows - row 1: yellow, row 2: green, row 3: yellow<br>\nand Sheet 2 has 2 rows - row 1: yellow, row 2: blue<br>\nthen ToDo sheet will show the values of Sheet 1 row 1, Sheet 1 row 3, Sheet 2 row 2</p>\n\n<p>Currently the output is \"No info obtained\" msg.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1560334611, "post_id": 56559495, "comment_id": 99699321, "body": "Can you describe your end goal a little bit with some sample data? You can most likely also avoid using .Select"}, {"owner": {"reputation": 55, "user_id": 10374637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0388bdf404df330e748c133a47e4046?s=128&d=identicon&r=PG&f=1", "display_name": "C.Fsh", "link": "https://stackoverflow.com/users/10374637/c-fsh"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1560335438, "post_id": 56559495, "comment_id": 99699766, "body": "@JvdV Some of the cells in the column could be John &amp; Karen Jane, Martin Edward &amp; Lauren, Paul, Fraser &amp; Sarah, and variants of. I basically just need to copy and paste the entire row, so that there are two rows wherever there is a &amp;, so the three examples would be copies, but Paul wouldn&#39;t be. Does that make a bit more sense?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1560335488, "post_id": 56559495, "comment_id": 99699794, "body": "Well, it&#39;s best to demonstrate your goal in your actual question. Screenshots, markdown sample data, expected output etc. Putting it in your comment is not very helpful"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1560335960, "post_id": 56559495, "comment_id": 99700032, "body": "Hard to know what you want to do without examples of data, before and after.  But code errors:  No reason for <code>On Error</code>.  <code>Resume</code> is only applicable in the setting of a trapped Error, so your insertrow never returns.  either include it inline, or make it a callable sub. Also you should not be using <code>Select</code> and <code>ActiveCell</code>.  Search SO for an article on how to avoid it."}, {"owner": {"reputation": 55, "user_id": 10374637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0388bdf404df330e748c133a47e4046?s=128&d=identicon&r=PG&f=1", "display_name": "C.Fsh", "link": "https://stackoverflow.com/users/10374637/c-fsh"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1560336378, "post_id": 56559495, "comment_id": 99700251, "body": "@RonRosenfeld Thanks for letting me know about screenshots, I&#39;ll make sure to use them if I have any other questions. I&#39;ve added a couple, a before and after of what I need, hope that helps"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1560336931, "post_id": 56559495, "comment_id": 99700542, "body": "You don&#39;t have iteration variable. Moreover, the loop must be from bottom to top."}], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 55, "user_id": 10374637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0388bdf404df330e748c133a47e4046?s=128&d=identicon&r=PG&f=1", "display_name": "C.Fsh", "link": "https://stackoverflow.com/users/10374637/c-fsh"}, "edited": false, "score": 0, "creation_date": 1560337374, "post_id": 56560550, "comment_id": 99700798, "body": "@C.Fsh Depending on the size of the database, you may want to turn off <code>ScreenUpdating</code> and set calculation to manual for speed issues."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1560337113, "creation_date": 1560337113, "answer_id": 56560550, "question_id": 56559495, "link": "https://stackoverflow.com/questions/56559495/insert-row-if-cell-contains/56560550#56560550", "title": "Insert Row if cell contains &quot;&amp;&quot;", "body": "<ul>\n<li>no Select, Activate, ActiveCell, etc</li>\n<li>no OnError</li>\n<li>no Resume</li>\n<li>iterate from bottom to top</li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\nSub dupAmps()\n    Dim WS As Worksheet, C As Range\n    Dim LR As Long\n    Dim I As Long\nSet WS = Worksheets(\"sheet1\")\nWith WS\n    LR = .Cells(.Rows.Count, 1).End(xlUp).Row\nEnd With\n\nFor I = LR To 2 Step -1\n    Set C = WS.Cells(I, 1)\n    If InStr(C, \"&amp;\") &gt; 0 Then\n        C.EntireRow.Insert shift:=xlDown\n        C.EntireRow.Copy C.Offset(-1, 0)\n    End If\nNext I\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10374637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0388bdf404df330e748c133a47e4046?s=128&d=identicon&r=PG&f=1", "display_name": "C.Fsh", "link": "https://stackoverflow.com/users/10374637/c-fsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 56560550, "answer_count": 1, "score": 0, "last_activity_date": 1560337113, "creation_date": 1560333790, "last_edit_date": 1592644375, "question_id": 56559495, "link": "https://stackoverflow.com/questions/56559495/insert-row-if-cell-contains", "title": "Insert Row if cell contains &quot;&amp;&quot;", "body": "<p>Probably something simple I've missed, but I need to run down a column, and copy-insert any rows that have a &quot;&amp;&quot; in the cell.</p>\n<p>I've managed to get it to here, but it's now just getting stuck on the very first cell with a &quot;&amp;&quot;, and won't move past it.</p>\n<pre><code>Dim ws As Worksheet\nSet ws = ThisWorkbook.Sheets(&quot;Working&quot;)\n\nDim rng As Range\n\nOn Error Resume Next\n\nws.Range(&quot;A2&quot;).Select\n\nDo Until ActiveCell.Offset(1, 0) = Empty\n    If InStr(ActiveCell, &quot;&amp;&quot;) &lt;&gt; 0 Then GoTo InsertRow Else\n    ActiveCell.Offset(1, 0).Select\nLoop\n\nInsertRow:\n    Set rng = ActiveCell.Rows\n    rng.Rows.Select\n    Selection.Copy\n    Selection.Insert Shift:=xlDown\n    ActiveCell.Offset(2, 0).Select\n    Resume Next\n</code></pre>\n<p>There could be blanks in the column, but I can edit that later, so long as the macro can actually run past the first cell, we'll be fine. There are no error messages, as it just sticks to the first cell that contains a &quot;&amp;&quot;.</p>\n<p><a href=\"https://i.stack.imgur.com/TOKDS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TOKDS.png\" alt=\"Before\" /></a></p>\n<p><a href=\"https://i.stack.imgur.com/Yjkt6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yjkt6.png\" alt=\"After\" /></a></p>\n<p>That's the before and after, the second image shows the rows being copied out.</p>\n"}, {"tags": ["excel", "vba", "function"], "answers": [{"comments": [{"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1560331794, "post_id": 56558850, "comment_id": 99697748, "body": "Yeah, otherwise you would need to get the cell.address to do the string representation of the range"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1560331939, "post_id": 56558850, "comment_id": 99697827, "body": "Yeah, but that would be a little... overkill? :D"}, {"owner": {"reputation": 51, "user_id": 10891895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sPFEZ.jpg?s=128&g=1", "display_name": "Ardnic", "link": "https://stackoverflow.com/users/10891895/ardnic"}, "edited": false, "score": 0, "creation_date": 1560332575, "post_id": 56558850, "comment_id": 99698218, "body": "Perfect, thank you! Now, as a last question: How to I determine to beginning and ending row of searchRngQue? .end(xlup/down) does not to the trick..."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1560332773, "post_id": 56558850, "comment_id": 99698332, "body": "<code>searchRngQue.Cells(1,1).Row</code> would be the first and <code>searchRngQue.Rows.Count</code> the last."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1560333860, "post_id": 56558850, "comment_id": 99698918, "body": "@Damian it certainly would but I just wanted to give the context for the OP to hopefully grasp the difference"}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 4, "last_activity_date": 1560331637, "creation_date": 1560331637, "answer_id": 56558850, "question_id": 56558787, "link": "https://stackoverflow.com/questions/56558787/build-in-excel-function-not-working-in-vba-code-what-is-my-mistake/56558850#56558850", "title": "Build-in Excel function not working in VBA code - What is my mistake?", "body": "<p>You meant to do this:</p>\n\n<pre><code>sumQue = Application.WorksheetFunction.Sum(.Range(.Cells(searchRngQue.End(xlUp).Row, 8), .Cells(searchRngQue.End(xlDown).Row, 8)))\n</code></pre>\n\n<p>When working with <code>Range(Cells(1,1), Cells(100,1))</code> you use a <code>,</code> as separator, not <code>:</code></p>\n"}], "owner": {"reputation": 51, "user_id": 10891895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sPFEZ.jpg?s=128&g=1", "display_name": "Ardnic", "link": "https://stackoverflow.com/users/10891895/ardnic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 56558850, "answer_count": 1, "score": 1, "last_activity_date": 1560331637, "creation_date": 1560331454, "question_id": 56558787, "link": "https://stackoverflow.com/questions/56558787/build-in-excel-function-not-working-in-vba-code-what-is-my-mistake", "title": "Build-in Excel function not working in VBA code - What is my mistake?", "body": "<p>I am trying to sum up all values of a predefined range of cells. However, that range has been defined by rows only (e.g. searchRngQue = Rows 5 to 10). I now tried the following to extract the row numbers from the range and add the relevant Column to define the exact cells from which the sum should be calculated.\nHowever the code gives me the Run-time Error 1004: \"Application-defined or object-defined error\"</p>\n\n<p>Another problem seems to be that the .End(xlUp/xlDown) methods are not returning the first/last row of the range. What should I use instead?\nCan anyone show me what I am missing?! Thanks a lot in advance!</p>\n\n<pre><code>sumQue = Application.WorksheetFunction.Sum(.Range(.Cells(searchRngQue.End(xlUp).Row, 8) &amp; \":\" &amp; .Cells(searchRngQue.End(xlDown).Row, 8)))\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 1, "creation_date": 1560339404, "post_id": 56558737, "comment_id": 99701970, "body": "Try cross join query maybe? It can provide quite same functionality"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1560363029, "post_id": 56558737, "comment_id": 99715380, "body": "A CROSSTAB is not appropriate nor do I see how a cross join would accomplish. A UNION can rearrange fields but limited to 50 SELECT lines. Only real option is a VBA procedure to run append actions. Open recordset object, loop through fields inside a loop of records. Why would you want all data in 1 field? If there are multiple records transformed, how will data retain association? Need a group identifier field."}, {"owner": {"reputation": 1, "user_id": 8598342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3369bd1e7746b814f30b2207bbda21cd?s=128&d=identicon&r=PG&f=1", "display_name": "Elbows", "link": "https://stackoverflow.com/users/8598342/elbows"}, "edited": false, "score": 0, "creation_date": 1560412733, "post_id": 56558737, "comment_id": 99729770, "body": "I need to link my results with a table to find references. The Union solution is the best solution. I have Unionised the first 40 fields (anything more states that it&#39;s too complex) then 41 to 80 and then Unionised these two Union Queries. I am assuming I will be able to then Union 81 to 120 and 121 to 160 ultimately up     to 255. Thanks for this. The vba is too complex for me I&#39;m afraid."}], "owner": {"reputation": 1, "user_id": 8598342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3369bd1e7746b814f30b2207bbda21cd?s=128&d=identicon&r=PG&f=1", "display_name": "Elbows", "link": "https://stackoverflow.com/users/8598342/elbows"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560362421, "creation_date": 1560331290, "last_edit_date": 1560362421, "question_id": 56558737, "link": "https://stackoverflow.com/questions/56558737/transform-access-row-into-access-field", "title": "Transform Access Row into Access Field", "body": "<p>I am trying to replicate the Transform paste from Excel using Access.</p>\n\n<p>I want to select my columns (varying amounts) in Excel.\nPaste them into an Access database Table1 row.\nThe table has 255 fields (in order to accommodate the varying number of columns)</p>\n\n<p>e.g.:<br>\nTitle, FirstName, Surname, Add1, Add2, Add3, Add4, Town, County, Postcode</p>\n\n<p>What I want is to transform this into a single field of Table2, e.g.:<br>\nTable2<br>\nField1<br>\nTitle<br>\nFirstName<br>\nSurname<br>\nAdd1<br>\nAdd2<br>\nAdd3<br>\nAdd4<br>\nTown<br>\nCounty<br>\nPostcode  </p>\n\n<p>I could achieve this by creating an append query for each of the 255 fields in Table1 but that seems ridiculous!</p>\n\n<p>Surely there is a function that could loop through the Table1 and paste them into Table2</p>\n\n<p>Is this at all possible? The easiest thing would be to \"Transform\" the data whilst still in the Excel file but I wanted to build this ability to aid the functionality of my Access process.</p>\n\n<p>I've tried to use a crosstab query but I am struggling to get the right results.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1560330726, "post_id": 56558466, "comment_id": 99697115, "body": "So what are you asking?"}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560332401, "post_id": 56558466, "comment_id": 99698105, "body": "I want to change Rng.Resize(, 18).Interior.ColorIndex = 20 to dynamic its not always 18 cells it might be 20 or 15 cells from the Grand total cell i find in column A"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1560333276, "post_id": 56558466, "comment_id": 99698606, "body": "So basically, &quot;Grand Total&quot; is the header of a row? You are searching for it and when you find it you want to assign to <code>rng</code> all the non-empty cells? In other words, is it the last used cell in the row &quot;Grand Total&quot; which determines the length of the range?"}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 1, "creation_date": 1560333572, "post_id": 56558466, "comment_id": 99698759, "body": "Yes for example I find grand total to cell A20 and i want to extent to the last use cell for example X20 but this is my problem its not always X20 it change"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1560334312, "post_id": 56558466, "comment_id": 99699180, "body": "Vaggelis in that case you will probably benefit from looking into the .End(xlToRight) property of the range. @SJR you will probably benefit from <a href=\"https://stackoverflow.blog/2018/04/26/stack-overflow-isnt-very-welcoming-its-time-for-that-to-change/\">stackoverflow.blog/2018/04/26/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1560335638, "post_id": 56559675, "comment_id": 99699870, "body": "It worked fine but if i want to go further and i want to delete all the rows below grand total row how to do it ?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1560336022, "post_id": 56559675, "comment_id": 99700064, "body": "<code>.Rows(Rng.Row + 1 &amp; &quot;:&quot; &amp; .Rows.Count).Delete</code>"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1560334317, "creation_date": 1560334317, "answer_id": 56559675, "question_id": 56558466, "link": "https://stackoverflow.com/questions/56558466/vba-dynamic-cell-range-resize/56559675#56559675", "title": "VBA dynamic cell range resize", "body": "<p>Use <code>.Cells(Rng.Row, .Columns.Count).End(xlToLeft)</code> to find the last used cell in the row where you found <code>Grand Total</code> and use that to color the range.</p>\n\n<pre><code>Set Rng = .FIND(What:=\"Grand Total\", LookAt:=xlWhole, LookIn:=xlValues)\nIf Not Rng Is Nothing Then\n    With Sheets(\"Report\")\n        .Range(Rng, .Cells(Rng.Row, .Columns.Count).End(xlToLeft)).Interior.ColorIndex = 20\n    End With\nElse\n    MsgBox \"Grand Total was not found.\"\nEnd If\n</code></pre>\n\n<p>Note that you need to check <code>If Not Rng Is Nothing Then</code> otherwise you will run into an error if <code>Grand Total</code> does not exist.</p>\n"}], "owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56559675, "answer_count": 1, "score": 0, "last_activity_date": 1560335015, "creation_date": 1560330421, "last_edit_date": 1560335015, "question_id": 56558466, "link": "https://stackoverflow.com/questions/56558466/vba-dynamic-cell-range-resize", "title": "VBA dynamic cell range resize", "body": "<p>I have written the following code and I want to format the <code>Grand Total</code> row. I want to make this dynamic because the cells of the grand total row change every month </p>\n\n<pre><code>Sub ReportData()\n\nApplication.ScreenUpdating = False\n\nDim Report As Worksheet\nSet Report = WBNew.Worksheets(\"Report\")\n\nReport.UsedRange.Copy\nWith Sheets(\"Report\").UsedRange\n     .PasteSpecial xlPasteFormats\n     .PasteSpecial xlPasteValues\n     .Columns(\"A:Q\").EntireColumn.Delete\n     Set Rng = .FIND(What:=\"Grand Total\", LookAt:=xlWhole, LookIn:=xlValues)\n     Rng.Resize(, 18).Interior.ColorIndex = 20\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>For example if I find \"Grand Total\" in cell A20, then I want to extent to the last used cell for example X20. But this is my problem it's not always X20 it changes.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1560331675, "post_id": 56558268, "comment_id": 99697685, "body": "Remove all <code>On Error \u2026</code> lines and check if any errors occur. Both lines hide all error messages if errors occur. But if you cannot see them you cannot fix them. That means if the email doesn&#39;t get sent you won&#39;t even notice it because there is no waring at all. You might benefit from reading <a href=\"https://excelmacromastery.com/vba-error-handling\" rel=\"nofollow noreferrer\">VBA Error Handling \u2013 A Complete Guide</a> \u2022 Your code reads like <i>&quot;Try to send an email with Outlook but if it goes wrong don&#39;t tell anyone, just act like everything was fine.&quot;</i>"}, {"owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560331905, "post_id": 56558268, "comment_id": 99697809, "body": "I commented that out... but its still the same. I thought it may of placed something in the outbox, or draft but nothing. I&#39;ll have a try at putting more error handling in to catch the error"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560332115, "post_id": 56558268, "comment_id": 99697945, "body": "If both <code>On Error \u2026</code> lines are not active and you don&#39;t get any errors, then the email should be sent or if Outlook is not configured properly stuck in the outbox. The code looks good to me. What server are you using to send the email? SMTP or Exchange? \u2022 If you have more than one mail account in Outlook make sure you check them all."}, {"owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1560333324, "post_id": 56558268, "comment_id": 99698634, "body": "I was thinking that maybe there is some security setting that I can enable on outlook - it&#39;s exchange. The company operate on very tight security, so maybe that could be a reason?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1560333528, "post_id": 56558268, "comment_id": 99698737, "body": "Check this <a href=\"https://stackoverflow.com/questions/6122747/send-email-from-excel-in-exchange-environment\" title=\"send email from excel in exchange environment\">stackoverflow.com/questions/6122747/&hellip;</a>"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1560382266, "post_id": 56558268, "comment_id": 99721871, "body": "Which  line is giving you the error?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1565783037, "post_id": 56558268, "comment_id": 101457720, "body": "This may be a security setting. This poster had to resort to Sendkeys. <a href=\"https://stackoverflow.com/questions/17883088/sending-mail-using-outlook-where-the-send-method-fails\" title=\"sending mail using outlook where the send method fails\">stackoverflow.com/questions/17883088/&hellip;</a>"}], "owner": {"reputation": 1379, "user_id": 1472266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/434b81c12788b8446089589357b6667b?s=128&d=identicon&r=PG", "display_name": "BCLtd", "link": "https://stackoverflow.com/users/1472266/bcltd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1591655412, "creation_date": 1560329810, "last_edit_date": 1591655412, "question_id": 56558268, "link": "https://stackoverflow.com/questions/56558268/send-mail-via-outlook-from-excel", "title": "Send Mail Via Outlook From Excel", "body": "<p>I am trying to send an email automatically in VBA Excel, however nothing sends. If I change from .Send to .Display it show the correct email and email/to correctly filled in.</p>\n\n<p>The code I am using is</p>\n\n<pre><code>Sub SendEmail()\n\n    Dim errorMsg As String\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n    On Error GoTo errHandle\n\n    With OutMail\n\n        .To = \"user@email.com\"\n        '.cc = cc\n        '.bcc = er.emailBcc\n        .subject = \"test\"\n        .htmlBody = \"test body\"\n\n        .Send   'or use .Display\n    End With\n\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n    SendEmailWithOutlook = True\n\nerrHandle:\n    errorMsg = \"Error sending mail via outlook: \" &amp; Err.Description &amp; vbCrLf\n\n    MsgBox errorMsg\n    SendEmailWithOutlook = False\n\nEnd Sub\n</code></pre>\n\n<p>I am receiving the following error</p>\n\n<blockquote>\n  <p>Error sending mail via outlook: Application-defined or object defined\n  error.</p>\n</blockquote>\n\n<p>Is there anything else I am missing for that to work and send the mail? (it works if I change from .send to .display.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1560332525, "post_id": 56558121, "comment_id": 99698183, "body": "Why is that an issue? It would usually just mean that the macro is not in the activeworkbook, or you have two Test_Macro macros available."}, {"owner": {"reputation": 1, "user_id": 11635638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c0d97e57d5015ee857ed7797b9540bc?s=128&d=identicon&r=PG&f=1", "display_name": "danb1202", "link": "https://stackoverflow.com/users/11635638/danb1202"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1560411972, "post_id": 56558121, "comment_id": 99729358, "body": "Hi Rory, sorry perhaps i hadnt worded that right. So the activeworkbook had been running fine for a long time, then seemingly randomly it would error saying the module cannot be found. By doing the above steps, it then worked again. Only 1 workbook, with 1 &quot;Test_Macro&quot;."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1560419087, "post_id": 56558121, "comment_id": 99733207, "body": "I&#39;ve never heard of that. What exactly are you doing when the error happens?"}, {"owner": {"reputation": 1, "user_id": 11635638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c0d97e57d5015ee857ed7797b9540bc?s=128&d=identicon&r=PG&f=1", "display_name": "danb1202", "link": "https://stackoverflow.com/users/11635638/danb1202"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1560422566, "post_id": 56558121, "comment_id": 99735210, "body": "nothing out of the ordinary! The macros arent exactly complicated either. The just auto run on open, refresh some data connections and update some formulas. Unfortunately now ive resolved it i cant get the exact error message. If i can ill keep this thread open and if/when it happens again ill take screenshots"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1560423887, "post_id": 56558121, "comment_id": 99735879, "body": "<b>How</b> do they auto run on open?"}, {"owner": {"reputation": 1, "user_id": 11635638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c0d97e57d5015ee857ed7797b9540bc?s=128&d=identicon&r=PG&f=1", "display_name": "danb1202", "link": "https://stackoverflow.com/users/11635638/danb1202"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1560502994, "post_id": 56558121, "comment_id": 99766185, "body": "name the macro auto_open"}, {"owner": {"reputation": 1, "user_id": 11635638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c0d97e57d5015ee857ed7797b9540bc?s=128&d=identicon&r=PG&f=1", "display_name": "danb1202", "link": "https://stackoverflow.com/users/11635638/danb1202"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1560503055, "post_id": 56558121, "comment_id": 99766218, "body": "sub auto_open() <i>some code</i> end sub"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1560507529, "post_id": 56558121, "comment_id": 99768497, "body": "So what&#39;s the actual error? I can&#39;t see that you would get anything like you described in your original post - unless you are using <code>Run</code> for some reason?"}], "owner": {"reputation": 1, "user_id": 11635638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c0d97e57d5015ee857ed7797b9540bc?s=128&d=identicon&r=PG&f=1", "display_name": "danb1202", "link": "https://stackoverflow.com/users/11635638/danb1202"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560329801, "creation_date": 1560329334, "last_edit_date": 1560329801, "question_id": 56558121, "link": "https://stackoverflow.com/questions/56558121/excel-losing-connection-to-vba-module", "title": "excel losing connection to vba module", "body": "<p>For the second time on 2 separate workbooks, excel appears to have lost its connection to the VBA module.</p>\n\n<p>When looking for the macro names, normally it would show as eg: \"Test_Macro\".</p>\n\n<p>In these instances, it then shows as \"Myworkbook.xlsm.module1!.Test_Macro\".</p>\n\n<p>To rectify this, Ive had to open a new session of excel, turn off macros in trust centre. Go back to the file that has an issue, change the name of the macro (none of the code), and save. Turn macros back on. Go back to the failing file, rename back to what it was before, and it works again.</p>\n\n<p>So whilst the fix is easy, im trying to find the route cause. Has anyone had this happen before, and if so, can they shed some light on this?!</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1560327645, "creation_date": 1560327645, "answer_id": 56557632, "question_id": 56557259, "link": "https://stackoverflow.com/questions/56557259/when-excel-loads-move-view-window-to-specific-cell/56557632#56557632", "title": "When Excel loads, move view window to specific cell", "body": "<p>Try using Select <code>TargetCell.Select</code></p>\n"}], "owner": {"reputation": 1831, "user_id": 5429320, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e02691284796e5cf261da5a449fdabec?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/5429320/ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 56557632, "answer_count": 1, "score": 1, "last_activity_date": 1560331958, "creation_date": 1560326324, "last_edit_date": 1560331958, "question_id": 56557259, "link": "https://stackoverflow.com/questions/56557259/when-excel-loads-move-view-window-to-specific-cell", "title": "When Excel loads, move view window to specific cell", "body": "<p>I have a excel worksheet with has a calendar. However, this calendar start from the beginning of the year. I am trying to set up a VBA script so that when the excel loads, it jumps to the column with holds today's day.</p>\n\n<p>I have go it to the point when I find the column as a numerical value, but cannot seem to get it to move to that column. </p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim Today As Date: Today = Date\nDim VarianceDate As String: VarianceDate = Today\nDim TargetCell As Range, TargetCol As Integer\n\nSet TargetCell = Rows(\"2\").Find(What:=CDate(VarianceDate), LookIn:=xlFormulas, LookAt:=xlPart)\nIf Not TargetCell Is Nothing Then TargetCol = TargetCell.Column\n\nDebug.Print TargetCol\n\nEnd Sub\n</code></pre>\n\n<p>This will print out 165. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1560328285, "post_id": 56557244, "comment_id": 99695780, "body": "From a quick glance, you are <b>way</b> better off using elseif statements instead of using nested if statements"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1560328366, "post_id": 56557244, "comment_id": 99695816, "body": "And read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560328439, "post_id": 56557244, "comment_id": 99695867, "body": "@TimStack exactely on point. I was looking to link to that article."}], "answers": [{"comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560328767, "post_id": 56557838, "comment_id": 99696030, "body": "The absence of a specified workbook and -sheet, and the reference to <code>ActiveSheet</code> also is an open door for errors"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560328813, "post_id": 56557838, "comment_id": 99696049, "body": "Agreed... but trying to take it a step at a time since the OP said he is new to coding"}, {"owner": {"reputation": 13, "user_id": 11593635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bdecbde189a8538dca4fd7b6c53147?s=128&d=identicon&r=PG&f=1", "display_name": "Turtle", "link": "https://stackoverflow.com/users/11593635/turtle"}, "edited": false, "score": 0, "creation_date": 1560329755, "post_id": 56557838, "comment_id": 99696570, "body": "Thanks very much @rohrl77 - As I just described elsewhere, for some reason when I remove &#39;Select&#39;, it results in a &quot;Run-time error 438: Object doesn&#39;t support this property or method&quot; - but both points are still really useful advice and much appreciated- many thanks! :)"}], "tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": true, "score": 0, "last_activity_date": 1560328372, "creation_date": 1560328372, "answer_id": 56557838, "question_id": 56557244, "link": "https://stackoverflow.com/questions/56557244/creating-a-loop-to-replace-multiple-nested-if-statements-when-dealing-with-group/56557838#56557838", "title": "Creating a loop to replace multiple nested if statements when dealing with groups of objects in Excel", "body": "<p>It's hard to tell what your code is doing from what you are providing, but there are several ways to make at least this part more efficient. </p>\n\n<p>The first is to use the <code>ElseIf</code> construct. This prevents you from having to do many nested if statements.</p>\n\n<p>Second, you want to avoid using <code>Select</code> whenever possible. </p>\n\n<p>Here is a sample of what you can do to refactor your code:</p>\n\n<pre><code>If Range(\"Link2\").Value = \"\" Then\n    ActiveSheet.Shapes.Range(Array(\"Group1\")).Copy\nElseIf Range(\"Link3\").Value = \"\" Then\n    ActiveSheet.Shapes.Range(Array(\"Group1\", \"Group2\")).Copy\nElseif ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560329144, "post_id": 56557987, "comment_id": 99696220, "body": "Try to help OP avoid using <code>Select</code>"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560329208, "post_id": 56557987, "comment_id": 99696266, "body": "But why you think OP want to avoid it? Maybe it want to select Shapes to see what is copying, and I make first Case to avoid it ))"}, {"owner": {"reputation": 13, "user_id": 11593635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bdecbde189a8538dca4fd7b6c53147?s=128&d=identicon&r=PG&f=1", "display_name": "Turtle", "link": "https://stackoverflow.com/users/11593635/turtle"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560329569, "post_id": 56557987, "comment_id": 99696468, "body": "The responses are coming in so quick, thanks so much for all the information and the ideas! @TimStack I don&#39;t know if this relates to some other bad practices, but removing &#39;select&#39; actually breaks this for me, I get a &quot;Run-time error &#39;438&#39; - Object doesn&#39;t support this property or method&quot;. I&#39;ll read through the link on avoiding select and incorporate it elsewhere when I can thanks."}, {"owner": {"reputation": 13, "user_id": 11593635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bdecbde189a8538dca4fd7b6c53147?s=128&d=identicon&r=PG&f=1", "display_name": "Turtle", "link": "https://stackoverflow.com/users/11593635/turtle"}, "edited": false, "score": 0, "creation_date": 1560329577, "post_id": 56557987, "comment_id": 99696473, "body": "@DmitrijHolkin Thanks very much, I&#39;ll give that a try and report back- I am enough of a newbie that I don&#39;t understand cases yet, but I&#39;ll have to read up :)"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560331162, "post_id": 56557987, "comment_id": 99697392, "body": "@DmitrijHolkin you don&#39;t need to use the dreaded <code>Select</code> to see that.."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 13, "user_id": 11593635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bdecbde189a8538dca4fd7b6c53147?s=128&d=identicon&r=PG&f=1", "display_name": "Turtle", "link": "https://stackoverflow.com/users/11593635/turtle"}, "edited": false, "score": 0, "creation_date": 1560331232, "post_id": 56557987, "comment_id": 99697429, "body": "@Turtle you have to replace the <code>Select</code> function, not remove the word. Using <code>Select</code> is bad practice and only necessary in a very rare set of cases, so try to avoid using it. Again, read <a href=\"https://stackoverflow.com/a/10718179/10540017\">this thread</a>"}, {"owner": {"reputation": 13, "user_id": 11593635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bdecbde189a8538dca4fd7b6c53147?s=128&d=identicon&r=PG&f=1", "display_name": "Turtle", "link": "https://stackoverflow.com/users/11593635/turtle"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560331725, "post_id": 56557987, "comment_id": 99697705, "body": "@TimStack Thanks Tim, I was literally just reading that thread when you responded :) Unfortunately for me it&#39;s really not working; I misphrased what I was trying to say previously but replacing &#39;select&#39; with &#39;copy&#39; doesn&#39;t work in this case for me. So for example [ ActiveSheet.Shapes.Range(Array(&quot;Group1&quot;)).Copy ] throws up an error. For some reason, having [             ActiveSheet.Shapes.Range(Array(&quot;Group1&quot;)).Select followed by Selection.Copy ] works. Any ideas why, is this likely to be tied to some other bad practice in the code?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560334908, "post_id": 56557987, "comment_id": 99699457, "body": "<a href=\"https://stackoverflow.com/a/42359976/10540017\">This answer</a> contains two alternatives for using <code>Select</code>, see if this helps you"}, {"owner": {"reputation": 13, "user_id": 11593635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bdecbde189a8538dca4fd7b6c53147?s=128&d=identicon&r=PG&f=1", "display_name": "Turtle", "link": "https://stackoverflow.com/users/11593635/turtle"}, "edited": false, "score": 0, "creation_date": 1560433452, "post_id": 56557987, "comment_id": 99741675, "body": "@DmitrijHolkin Just to follow up that I really appreciate your suggestion, however the need to type in a number didn&#39;t really fit in the given situation. It&#39;s super useful as a concrete example of how case can be used though- thanks very much :)"}, {"owner": {"reputation": 13, "user_id": 11593635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bdecbde189a8538dca4fd7b6c53147?s=128&d=identicon&r=PG&f=1", "display_name": "Turtle", "link": "https://stackoverflow.com/users/11593635/turtle"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560433638, "post_id": 56557987, "comment_id": 99741791, "body": "@TimStack Thanks for the link and the further ideas. Unfortunately I couldn&#39;t get it to work for me, the grouping looked promising however I was grouping things that had already been grouped I guess- I still received an error. I need to make some progress with more important functionality but will definitely revisit this when I have time. Thanks again :)"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1560440533, "post_id": 56557987, "comment_id": 99746310, "body": "Select case is useful in any situation, as you can do everithing you want for example check for boolean <code>Select Case True</code> and then <code>case Range(&quot;Links&quot;).Value = &quot;&quot; : ActiveSheet.Shapes.Range(Array(&quot;Group1&quot;)).Group.Copy</code>"}], "tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1560334932, "last_edit_date": 1560334932, "creation_date": 1560328877, "answer_id": 56557987, "question_id": 56557244, "link": "https://stackoverflow.com/questions/56557244/creating-a-loop-to-replace-multiple-nested-if-statements-when-dealing-with-group/56557987#56557987", "title": "Creating a loop to replace multiple nested if statements when dealing with groups of objects in Excel", "body": "<p>or just use Select Case</p>\n\n<pre><code>Application.ScreenUpdating = False\nSelect Case Range(\"Links\").Value\n        Case \"1\": ActiveSheet.Shapes.Range(Array(\"Group1\")).Group.Copy\n        Case \"2\": ActiveSheet.Shapes.Range(Array(\"Group1\", \"Group2\")).Group.Copy\n        Case \"3\": ActiveSheet.Shapes.Range(Array(\"Group1\", \"Group2\", \"Group3\")).Group.Copy\n        Case \"4\": ActiveSheet.Shapes.Range(Array(\"Group1\", \"Group2\", \"Group3\", \"Group4\")).Group.Copy\n        Case \"5\": ActiveSheet.Shapes.Range(Array(\"Group1\", \"Group2\", \"Group3\", \"Group4\", \"Group5\")).Group.Copy\n        Case \"6\": ActiveSheet.Shapes.Range(Array(\"Group1\", \"Group2\", \"Group3\", \"Group4\", \"Group5\", \"Group6\")).Group.Copy\n        Case Else: Application.CutCopyMode = False: GoTo Finale\n    End Select\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>where</p>\n\n<p><code>Range(\"Links\").Value</code> is only one cell where you type prefered number</p>\n"}], "owner": {"reputation": 13, "user_id": 11593635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50bdecbde189a8538dca4fd7b6c53147?s=128&d=identicon&r=PG&f=1", "display_name": "Turtle", "link": "https://stackoverflow.com/users/11593635/turtle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 56557838, "answer_count": 2, "score": 0, "last_activity_date": 1560334932, "creation_date": 1560326263, "question_id": 56557244, "link": "https://stackoverflow.com/questions/56557244/creating-a-loop-to-replace-multiple-nested-if-statements-when-dealing-with-group", "title": "Creating a loop to replace multiple nested if statements when dealing with groups of objects in Excel", "body": "<p>I'm not sure how to optimize the code attached below into some form of loop and am hoping someone would be able to illustrate how best to tackle this. </p>\n\n<p>Basically, I've inherited a spreadsheet with several VBA modules recorded from the macro recorder and/or written by someone inexperienced with VBA, and it's very slow to run. I've been going through and reducing a lot of redundant 'nested if' type sections into for loops in an attempt to optimize and speed things up, however I'm also very inexperienced and really not a coder myself as you can probably guess! </p>\n\n<pre><code>If Range(\"Link1\").Value = \"\" Then\n    Application.CutCopyMode = False\n\n    GoTo Finale:\nElse\n\nIf Range(\"Link2\").Value = \"\" Then\n    ActiveSheet.Shapes.Range(Array(\"Group1\")).Select\n    Selection.Copy\nElse\n\nIf Range(\"Link3\").Value = \"\" Then\n    ActiveSheet.Shapes.Range(Array(\"Group1\", \"Group2\")).Select\n    Selection.Copy\nElse\n\nIf Range(\"Link4\").Value = \"\" Then\n    ActiveSheet.Shapes.Range(Array(\"Group1\", \"Group2\", \"Group3\")).Select\n    Selection.Copy\nElse\n\nIf Range(\"Link5\").Value = \"\" Then\n    ActiveSheet.Shapes.Range(Array(\"Group1\", \"Group2\", \"Group3\", \"Group4\")).Select\n    Selection.Copy\nElse\n\nIf Range(\"Link6\").Value = \"\" Then\n    ActiveSheet.Shapes.Range(Array(\"Group1\", \"Group2\", \"Group3\", \"Group4\", \"Group5\")).Select\n    Selection.Copy\nElse\n\nIf Range(\"Link7\").Value = \"\" Then\n    ActiveSheet.Shapes.Range(Array(\"Group1\", \"Group2\", \"Group3\", \"Group4\", \"Group5\", \"Group6\")).Select\n    Selection.Copy\nElse\n\nIf Range(\"Link8\").Value = \"\" Then\n    ActiveSheet.Shapes.Range(Array(\"Group1\", \"Group2\", \"Group3\", \"Group4\", \"Group5\", \"Group6\", \"Group7\")).Select\n    Selection.Copy\nElse\n\n    ActiveSheet.Shapes.Range(Array(\"Group1\", \"Group2\", \"Group3\", \"Group4\", \"Group5\", \"Group6\", \"Group7\", \"Group8\")).Select\n    Selection.Copy\n\nEnd If\n\nEnd If\n\nEnd If\n\nEnd If\n\nEnd If\n\nEnd If\n\nEnd If\n\nEnd If\n</code></pre>\n\n<p>The code deals with copying 8 groups of 'things' (in this case, each containing text boxes and a graphic) and checks if a link has been populated, copying the previous groups when it finds an unpopulated link. The idea here is therefore that only populated groups are copied. </p>\n\n<p>A second question regarding all this is that when you have multiple if statements like this, is it actually meaningfully faster or more optimal to reduce such things into loops, or should I be looking elsewhere to further optimize the spreadsheet? Turning long passages of recursive code into minimal loops certainly feels good(!), but I don't know if that's really what actually needs to be done to improve speed and stability or if it actually has little meaningful impact.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 1, "creation_date": 1560326073, "post_id": 56557156, "comment_id": 99694689, "body": "Could you clarify what error you&#39;re getting?"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1560326100, "post_id": 56557156, "comment_id": 99694704, "body": "why you forget <code>X</code> ?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1560326326, "post_id": 56557156, "comment_id": 99694819, "body": "<code>Sub Main(numgen as Integer, letras as String, letra as String, celda as String)</code> you can declare again the variables in that line, delete all the <code>Dim numgen...</code> inside the procedure, they are already declared."}], "answers": [{"comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1560326628, "post_id": 56557276, "comment_id": 99694966, "body": "Tim, <code>letras</code> is already declared as parameter to call <code>Main</code> either he changes the type or declares a new variable for the array."}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 0, "last_activity_date": 1560326860, "last_edit_date": 1560326860, "creation_date": 1560326356, "answer_id": 56557276, "question_id": 56557156, "link": "https://stackoverflow.com/questions/56557156/got-a-problem-in-the-first-line-cant-fix-it/56557276#56557276", "title": "Got a problem in the first line, can&#39;t fix it", "body": "<p>Quite some errors in your code</p>\n\n<ol>\n<li>Remove <code>Dim numgen As Integer</code> (already declared in first line)</li>\n<li>You are populating one variable three times right after each other while it can be done in one row</li>\n<li>Remove <code>Dim letra As String</code> after you already populated the array</li>\n<li>Remove <code>Dim celda As String</code> (already declared in first line)</li>\n<li>Remove <code>Dim letras As String</code> in first line</li>\n<li>Avoid selecting or activating ranges</li>\n<li>For some reason you're populating a range with a formula that's just a one-word string</li>\n</ol>\n\n<p>should look something like:</p>\n\n<pre><code>Sub Main(numgen as Integer, letra as String, celda as String)\n    Dim letras(1 To 25) as String\n    Call coincidir\n    numgen = coincidir(\"Total general; A8:Z8; 0\") + 1 \n\n    ''' ommitted\n\n    letra = \"w\"\n    letras(numgen) = letra\n\n    celda = letra + \"8\"\n\n    Workbooks(REF).Sheets(REF).Range(\"celda\").Value= \"Comisi\u00f3n\"\nEnd Sub\n</code></pre>\n\n<p>Doing something along the lines of <code>Sub test(sheetname As String, Nr As Long)</code> is usually done when you're calling the sub and you want to pass values to it.<br>\nFor example:</p>\n\n<pre><code>Sub test()\n\ni = Range(\"A1\").Value\nstr = \"Sheet3\"\n\nanothersub sheetname:= str, Nr:= i\n\nEnd Sub\n\nSub anothersub(sheetname As String, Nr As Long)\n\nDim sht As Worksheet\n\nSet sht = Sheets(sheetname)\n\nFor i = 0 To Nr\n    MsgBox i\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>You're now declaring variables twice, which results in errors</p>\n"}], "owner": {"reputation": 1, "user_id": 11635374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1576a8ac9531d4310ccae5ffe71bf35?s=128&d=identicon&r=PG&f=1", "display_name": "Arny", "link": "https://stackoverflow.com/users/11635374/arny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560326860, "creation_date": 1560325948, "last_edit_date": 1560326059, "question_id": 56557156, "link": "https://stackoverflow.com/questions/56557156/got-a-problem-in-the-first-line-cant-fix-it", "title": "Got a problem in the first line, can&#39;t fix it", "body": "<p>I've got a porblem with the first line of my code, the thing is that i cant fix it for some reason.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Main(numgen as Integer, letras as String, letra as String, celda as String)\n    Call coincidir\n    Dim numgen As Integer\n    numgen = 0\n    numgen = coincidir(\"Total general; A8:Z8; 0\")\n    numgen = numgen + 1\n\n    Dim letras(1 To 25) As String\n\n    letras(1) = \"A\"\n    letras(2) = \"B\"\n    letras(3) = \"C\"\n    letras(4) = \"D\"\n    letras(5) = \"E\"\n    letras(6) = \"F\"\n    letras(7) = \"G\"\n    letras(8) = \"H\"\n    letras(9) = \"I\"\n    letras(10) = \"J\"\n    letras(11) = \"K\"\n    letras(12) = \"L\"\n    letras(13) = \"M\"\n    letras(14) = \"N\"\n    letras(15) = \"O\"\n    letras(16) = \"P\"\n    letras(17) = \"Q\"\n    letras(18) = \"R\"\n    letras(19) = \"S\"\n    letras(20) = \"T\"\n    letras(21) = \"U\"\n    letras(22) = \"V\"\n    letras(23) = \"W\"\n    letras(24) = \"Y\"\n    letras(25) = \"Z\"\n\n    Dim letra As String\n    letra = \"w\"\n    letras(numgen) = letra\n\n    Dim celda As String\n    celda = letra + \"8\"\n\n    Range(\"celda\").Select\n    ActiveCell.FormulaR1C1 = \"Comisi\u00f3n\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "32bit-64bit"], "comments": [{"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1560328098, "post_id": 56556993, "comment_id": 99695683, "body": "Are you sure that you get the error in line where you create the Outlook object? Which references did you select?"}, {"owner": {"reputation": 39, "user_id": 10346423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c39446895eee736cb94457f307c8645?s=128&d=identicon&r=PG&f=1", "display_name": "Simmo888", "link": "https://stackoverflow.com/users/10346423/simmo888"}, "reply_to_user": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1560328922, "post_id": 56556993, "comment_id": 99696112, "body": "I put the error trapping mode on to break in class module and it highlighted the line I mentioned. I wasn&#39;t entirely sure what references to select. The thread I read told me to investigate &quot;Missing&quot; references but I wasn&#39;t entirely sure what this meant. Can you shed any light on what references I should tick? or how I should find out what references to tick?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1560329053, "post_id": 56556993, "comment_id": 99696174, "body": "Go to the VBE&gt;Tools&gt;Refrences... if anything is missing, it will be immediately visible in the listbox and marked as &quot;MISSING:xxx&quot; where xxx is the missing refrence. I&#39;d suggest taking out the Microsoft Outlook refrence and trying it like that. Since you are using late binding, this might actually get in the way..."}, {"owner": {"reputation": 39, "user_id": 10346423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c39446895eee736cb94457f307c8645?s=128&d=identicon&r=PG&f=1", "display_name": "Simmo888", "link": "https://stackoverflow.com/users/10346423/simmo888"}, "edited": false, "score": 0, "creation_date": 1560329349, "post_id": 56556993, "comment_id": 99696344, "body": "There are no references labelled &quot;Missing&quot; in my list. I ticked &quot;Microsoft Outlook 16.0 Object Library&quot; ran the code and got the same error. I then unticked it, ran the code and still got the same error. I have just looked at the file path in my C drive that references outlook and it is and OLB file as opposed to an application. Could this have something to do with it? if so- how do I change?"}], "owner": {"reputation": 39, "user_id": 10346423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c39446895eee736cb94457f307c8645?s=128&d=identicon&r=PG&f=1", "display_name": "Simmo888", "link": "https://stackoverflow.com/users/10346423/simmo888"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560328285, "creation_date": 1560325332, "last_edit_date": 1560328285, "question_id": 56556993, "link": "https://stackoverflow.com/questions/56556993/vba-code-not-working-since-upgrading-excel-from-32bit-to-64bit-active-x-compone", "title": "VBA Code not working since upgrading excel from 32bit to 64bit. Active X component can&#39;t create object", "body": "<p>I recently upgraded my PC from windows 7 to windows 10. I have maintained using office 2016 throughout the process, however I am now using excel 64bit whereas previously my VBA code was written in 32bit. I am simply trying to automate an email using excel VBA:</p>\n\n<pre><code>Dim outlookapp As Object\nDim outlookmailitem As Object\n\nSet outlookapp = CreateObject(\"Outlook.Application\")\nSet outlookmailitem = outlookapp.createitem(0)\n</code></pre>\n\n<p>The code falls over at the line:</p>\n\n<pre><code>Set outlookapp = CreateObject(\"Outlook.Application\")\n</code></pre>\n\n<p>Where I receive an error:\nRun-time error '429': Active X can't create object.</p>\n\n<p>I have done some pretty extensive research and cannot find a solution to the error. I am led to believe that I need to alter my code slightly to be compatible with 64bit VBA but I am unaware of how to do so.</p>\n\n<p>I have tried:</p>\n\n<ul>\n<li>Using the early binding method (e.g. Dim outlookapp as Outlook.Application)</li>\n<li>Ticking certain references in the Tools>References section </li>\n<li>Checking the correct file path is located in the Registry section </li>\n</ul>\n\n<p>None of which have worked. I would ideally like to avoid uninstalling 64bit and reinstalling 32bit. Any ideas would be much appreciated. </p>\n"}, {"tags": ["excel", "vba", "csv", "validation", "converters"], "comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1560329195, "post_id": 56556924, "comment_id": 99696256, "body": "Have you seen this <a href=\"https://stackoverflow.com/questions/2524703/save-text-file-utf-8-encoded-with-vba\" title=\"save text file utf 8 encoded with vba\">stackoverflow.com/questions/2524703/&hellip;</a>?"}, {"owner": {"reputation": 11, "user_id": 11378989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6d38aef4cb6930b58a4b9e41947d52c?s=128&d=identicon&r=PG&f=1", "display_name": "mkc", "link": "https://stackoverflow.com/users/11378989/mkc"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1560331321, "post_id": 56556924, "comment_id": 99697479, "body": "Will generate with BOM futhermore I do not want to rewrite my macro in such a way to use <code>ADODB.Stream</code>"}], "owner": {"reputation": 11, "user_id": 11378989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6d38aef4cb6930b58a4b9e41947d52c?s=128&d=identicon&r=PG&f=1", "display_name": "mkc", "link": "https://stackoverflow.com/users/11378989/mkc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560328789, "creation_date": 1560325083, "last_edit_date": 1560328789, "question_id": 56556924, "link": "https://stackoverflow.com/questions/56556924/vba-macro-that-creates-three-csv-files", "title": "VBA Macro that creates three csv files", "body": "<p>I have the following VBA code that creates four files .csv csv.sha512 csv.sha256 and .csv.gz based on the excel table I have created. </p>\n\n<pre><code>Private Sub Export_Click()\n\nVersion = \"1.0\"\nMyFileName = ActiveWorkbook.Name\nMyFilePath = ActiveWorkbook.Path\nMyFileName = Replace(MyFileName, \".xls\", \".idl\")\nIdFiles = 1\nfileName = MyFilePath &amp; \"\\\" &amp; Cells(1, 3).Value &amp; \"_\" &amp; Format(Date, \"yyyymmdd\") &amp; \"_\" &amp; IdFiles &amp; \".csv\"\n\nSelectionOnly = False\nAppendData = False\ndelimeter = \"|\"\nApplication.ScreenUpdating = False\nOn Error GoTo EndMacro:\n\n\nIf SelectionOnly = True Then\n    With Selection\n        StartRow = 7\n        StartCol = 2\n        EndRow = .Cells(.Cells.Count).Row\n        EndCol = .Cells(.Cells.Count).Column\n    End With\nElse\n    With ActiveSheet.UsedRange\n        StartRow = 7\n        StartCol = 2\n        EndRow = .Cells(.Cells.Count).Row\n        EndCol = .Cells(.Cells.Count).Column\n    End With\nEnd If\n\nCountRow = EndRow - StartRow + 1\n\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFSOBlokada = CreateObject(\"Scripting.FileSystemObject\")\n\nIf objFSO.FileExists(fileName) Then\n    IsExistCSV = True\n\n\n    Do While IsExistCSV = True\n       fileName = MyFilePath &amp; \"\\\" &amp; Cells(1, 3).Value &amp; \"_\" &amp; Format(Date, \"yyyymmdd\") &amp; \"_\" &amp; IdFiles &amp; \".csv\"\n\n       If Not objFSO.FileExists(fileName) Then\n          IsExistCSV = False\n       End If\n       IdFiles = IdFiles + 1 \n    Loop\nEnd If\n\nSet objFile = objFSO.OpenTextFile(fileName, 2, True, -1)\nobjFile.Writeline Version &amp; delimeter &amp; CountRow\n\n    For RowNdx = StartRow To EndRow\n        WholeLine = \"\"\n        For ColNdx = StartCol To EndCol\n\n            If Cells(RowNdx, ColNdx).Value = \"\" Then\n                CellValue = \"\"\n            Else\n               CellValue = Cells(RowNdx, ColNdx).Value\n            End If\n\n\n            If ColNdx = EndCol Then\n                WholeLine = WholeLine &amp; CellValue\n            Else\n                WholeLine = WholeLine &amp; CellValue &amp; delimeter\n            End If\n        Next ColNdx\n        WholeLine = Left(WholeLine, Len(WholeLine) - Len(sep))\n        objFile.Writeline WholeLine\n    Next RowNdx\n\nEndMacro:\nOn Error GoTo 0\nApplication.ScreenUpdating = True\n\nobjFile.Close\n\n\n\nSet objFileBlokada = objFSOBlokada.OpenTextFile(fileName &amp; \".blokada\", 2, True, -1)\nobjFileBlokada.Close\n\n\nDim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\nDim waitOnReturn As Boolean: waitOnReturn = True\nDim windowStyle As Integer: windowStyle = 0\n\nshellcmd1 = \"cmd.exe /C certutil -hashfile \"\"\" &amp; fileName &amp; \"\"\" SHA512 | find /i /v \"\"sha512\"\" | find /i /v \"\"certutil\"\" &gt; \"\"\" &amp; fileName &amp; \".sha512\"\"\"\nwsh.Run shellcmd1, windowStyle, waitOnReturn\n\n\nshacmd256 = \"cmd.exe /C certutil -hashfile \"\"\" &amp; fileName &amp; \"\"\" SHA256 | find /i /v \"\"sha256\"\" | find /i /v \"\"certutil\"\" &gt; \"\"\" &amp; fileName &amp; \".sha256\"\"\"\n\n\nshellcmd2 = \"cmd /C \"\"\"\"c:\\Program Files\\7-Zip\\7z.exe\"\" a -w\"\"\" &amp; MyFilePath &amp; \"\"\" -tgzip \"\"\" &amp; fileName &amp; \".gz\"\" \" &amp; \"\"\"\" &amp; fileName &amp; \"\"\"\"\"\"\n\n\nEnd Sub\n</code></pre>\n\n<p>However files created are with BOM and with UCS2 encoding I need to have them with utf-8 encoding with <code>LF</code> as line end whereas now i have <code>crlf</code> as line end. How to fixt that?</p>\n\n<p>Futhermore I need to have utf-8 without BOM which is quite difficult to achieve.</p>\n\n<p>Any ideas how to even approach that? </p>\n"}, {"tags": ["mysql", "excel", "vba", "odbc"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1560329307, "post_id": 56556791, "comment_id": 99696326, "body": "<code>BETWEEN</code> can be done also as <code>date &gt;= StartDate AND date &lt;= EndDate</code>. would that work for you?"}, {"owner": {"reputation": 183, "user_id": 2434094, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bdae08917af96be3d6ad9d840e6e82ce?s=128&d=identicon&r=PG", "display_name": "RDK", "link": "https://stackoverflow.com/users/2434094/rdk"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1560340889, "post_id": 56556791, "comment_id": 99702878, "body": "I think that was one of the alternate code I tried.  I&#39;ll give it another try."}, {"owner": {"reputation": 183, "user_id": 2434094, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bdae08917af96be3d6ad9d840e6e82ce?s=128&d=identicon&r=PG", "display_name": "RDK", "link": "https://stackoverflow.com/users/2434094/rdk"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1560343658, "post_id": 56556791, "comment_id": 99704604, "body": "Typing errors in all cases!!!  I had Data-Type instead of Data_Type..  Both ways are working now.  As I said &quot;a really simple&quot; answer."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1560343937, "post_id": 56556791, "comment_id": 99704774, "body": "Glad it works for you, it was hard to point out to something that I couldn&#39;t see in your question (<code>Data-Type</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 2434094, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bdae08917af96be3d6ad9d840e6e82ce?s=128&d=identicon&r=PG", "display_name": "RDK", "link": "https://stackoverflow.com/users/2434094/rdk"}, "edited": false, "score": 0, "creation_date": 1560357377, "post_id": 56565515, "comment_id": 99712861, "body": "Thank you for t he lesson. I&#39;m a bit of a beginner at this and use the macros recorder to get me started.  I will study and learn from your comments. Thanks again."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1560352600, "creation_date": 1560352600, "answer_id": 56565515, "question_id": 56556791, "link": "https://stackoverflow.com/questions/56556791/excel-odbc-link-to-sql-query-for-results-between-to-dates/56565515#56565515", "title": "Excel ODBC link to SQL Query for results between to dates", "body": "<p>While you solved your situation, consider parameterization in your ODBC connection which is the preferred way of running SQL at application layer such as VBA. With parameterization you avoid the need to concatenate or punctuate and it is recommended in the general programming industry beyond VBA (e.g., Java, Python, PHP) or MariaDB (Oracle, SQL Server, Postgres). </p>\n\n<p>Below assumes you use ADO in Excel and runs late-binding on the module. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub RunSQL()   \n    Dim firstdate As Date, seconddate As Date\n    Dim sql as String, conn As Object, cmd As Object, rst As Object\n    Const adCmdText = 1, adParamInput = 1, adDate = 7\n\n    firstdate = DateValue(InputBox(\"Enter starting date (yyyy-mm-dd)\"))\n    seconddate = firstdate - 7\n\n    Set conn = CreateObject(\"ADODB.Connection\")\n    Set rst = CreateObject(\"ADODB.Recordset\")\n\n    conn.Open \"Driver={MySQL ODBC 5.3 Unicode Driver};host=hostname;\" _\n               &amp; \"database=databasename;UID=username;PWD=****\"\n\n    ' PREPARED STATEMENT (NO DATA)\n    sql = \"SELECT Date_Time, ChargerSt FROM `MyDBx`.`table` WHERE `DateTime` BETWEEN ? AND ?\"\n    ' CONFIGURE ADO COMMAND\n    Set cmd = CreateObject(\"ADODB.Command\")\n    With cmd\n        .ActiveConnection = conn\n        .CommandText = sql\n        .CommandType = adCmdText\n        ' BIND DATE VALUES\n        .Parameters.Append .CreateParameter(\"start_param\", adDate, adParamInput, , firstdate)\n        .Parameters.Append .CreateParameter(\"start_param\", adDate, adParamInput, , seconddate)\n        ' CREATE RECORDSET\n        Set rst = .Execute\n    End With\n\n    '... USE RECORDSET\n\n    rst.Close\n    Set rst = Nothing: Set cmd = Nothing: Set conn = Nothing    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 2434094, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bdae08917af96be3d6ad9d840e6e82ce?s=128&d=identicon&r=PG", "display_name": "RDK", "link": "https://stackoverflow.com/users/2434094/rdk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 56565515, "answer_count": 1, "score": 0, "last_activity_date": 1560410429, "creation_date": 1560324591, "last_edit_date": 1560410429, "question_id": 56556791, "link": "https://stackoverflow.com/questions/56556791/excel-odbc-link-to-sql-query-for-results-between-to-dates", "title": "Excel ODBC link to SQL Query for results between to dates", "body": "<p>I'm running Excel 2016 on a Windows 10 Pro computer.  I have set up an ODBC connection from Excel to an external MariaDB SQL database. My VBA macro is mostly working the way I want, but I'm having problems selecting records between two dates.  This SQL statement works:</p>\n\n<pre><code>SELECT Date_Time, ChargerSt FROM `MyDBx`.`table` WHERE (Date_Time&gt;{ts '2019-06-01 00:00:00'}) ORDER BY Date_Time;\n</code></pre>\n\n<p>However, I have not been able to get any combination of <code>WHERE</code> clauses using <code>BETWEEN date1 AND date2</code>; the above in combination with <code>Date_Time&lt;{ts '2019-06-11 00:00:00'}</code> to work. The format of <code>Date_Time</code> in the SQL database in <code>yyyy-mm-dd</code>.</p>\n\n<p>I'm inputting the dates like this:</p>\n\n<pre><code>firstdate = InputBox(\"Enter starting date (yyyy-mm-dd)\")\nseconddate = Format((DateValue(firstdate) - 7#), \"yyyy-mm-dd\")\n</code></pre>\n\n<p>and the VBA code for the SQL statement looks like this</p>\n\n<pre><code>\"SELECT Date_Time, ChargerSt FROM `MyDBx`.`table` \" _\n &amp; \"WHERE (Date_Time&gt;{ts '\" &amp; firstdate &amp; \" 00:00:00'})\" &amp; \" ORDER BY Date_Time\"\n</code></pre>\n\n<p>This is probably really simple and only displays my lack of experience with SQL, but I'm trying to do and learn.</p>\n"}, {"tags": ["vba", "sharepoint-online"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11491641, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207460409348921/picture?type=large", "display_name": "Nicola Bazinga Dragoni", "link": "https://stackoverflow.com/users/11491641/nicola-bazinga-dragoni"}, "edited": false, "score": 0, "creation_date": 1560326641, "post_id": 56556865, "comment_id": 99694971, "body": "Thank you Tim.  I will try this for sure.  &quot;Please note that the Kill function does not move the file to the trash bin.&quot; What are the implications of this?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 13, "user_id": 11491641, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207460409348921/picture?type=large", "display_name": "Nicola Bazinga Dragoni", "link": "https://stackoverflow.com/users/11491641/nicola-bazinga-dragoni"}, "edited": false, "score": 0, "creation_date": 1560326935, "post_id": 56556865, "comment_id": 99695088, "body": "It would mean irretrievable files, most likely"}, {"owner": {"reputation": 13, "user_id": 11491641, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207460409348921/picture?type=large", "display_name": "Nicola Bazinga Dragoni", "link": "https://stackoverflow.com/users/11491641/nicola-bazinga-dragoni"}, "edited": false, "score": 0, "creation_date": 1560328852, "post_id": 56556865, "comment_id": 99696069, "body": "Hi Tim, I tried what you suggested but without any luck.  I used the code you provided but I get &quot;error 53: file not found&quot;, despite the fact the file is there.  I am pretty sure the path is correct, since I copy and pasted the adress used to create the file in the first place."}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 1, "last_activity_date": 1560324853, "creation_date": 1560324853, "answer_id": 56556865, "question_id": 56556711, "link": "https://stackoverflow.com/questions/56556711/how-to-delete-a-excel-file-in-sharepoint-online-using-vba/56556865#56556865", "title": "How to delete a excel file in Sharepoint Online using VBA", "body": "<p>Something as the following code should work.</p>\n\n<p>Please note that the <a href=\"https://analystcave.com/vba-reference-functions/vba-file-functions/vba-kill-function/\" rel=\"nofollow noreferrer\"><code>Kill</code> function</a> does <a href=\"https://stackoverflow.com/questions/46451726/vba-delete-sharepoint-file-recycle-bin\">not move the file to the trash bin</a>. Use with care!</p>\n\n<pre><code>Sub RemoveSharePointFile()\n\nDim folder As String, file As String, fulladdress As String\n\nfolder = \"https://example.sharepoint.com/sites/test/\"\nfile = \"test.xls\" 'must include extension\n\nfulladdress = folder &amp; file\nKill fulladdress \n\nMsgBox \"File '\" &amp; file &amp; \"' was successfully deleted.\", vbInformation\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 12378147, "user_type": "registered", "profile_image": "https://graph.facebook.com/10221564970258427/picture?type=large", "display_name": "Joao Henrique Cavalcanti", "link": "https://stackoverflow.com/users/12378147/joao-henrique-cavalcanti"}, "is_accepted": false, "score": 0, "last_activity_date": 1573817089, "last_edit_date": 1573817089, "creation_date": 1573816677, "answer_id": 58875947, "question_id": 56556711, "link": "https://stackoverflow.com/questions/56556711/how-to-delete-a-excel-file-in-sharepoint-online-using-vba/58875947#58875947", "title": "How to delete a excel file in Sharepoint Online using VBA", "body": "<p>on cmd create a local folder point to sharepoint with \"net use\" (net use x:\\collaborate.yousite.com@SSL\\sites...) then</p>\n\n<p>delete the file from the local driver</p>\n\n<p>kill x:\\yourfile.pfd</p>\n"}], "owner": {"reputation": 13, "user_id": 11491641, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207460409348921/picture?type=large", "display_name": "Nicola Bazinga Dragoni", "link": "https://stackoverflow.com/users/11491641/nicola-bazinga-dragoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1624, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1573817089, "creation_date": 1560324258, "question_id": 56556711, "link": "https://stackoverflow.com/questions/56556711/how-to-delete-a-excel-file-in-sharepoint-online-using-vba", "title": "How to delete a excel file in Sharepoint Online using VBA", "body": "<p>As per title, I am trying to write code that deletes an excel file from a sharepoint online folder, using only vba.</p>\n\n<p>Since I am very new to VBA, I have no idea where to begin with</p>\n"}, {"tags": ["vba", "replace", "ms-word", "find"], "answers": [{"comments": [{"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1560792410, "post_id": 56633459, "comment_id": 99843492, "body": "@Ahmed_AU Hi @Ahmed. Thanks for your answer. It seems to work .The only thing is that the paragraph mark to be replaced have different font size to the texts. For example <code>Abc </code>has size 20 pt and the <code>para mark</code> has 10pt but sometimes the <code>para mark</code> has size 8.5 pt or something else. The issue is that when <code>q</code> is replaced with string, the font size of <code>Abc</code> is changed to the font size of the <code>paragraph mark</code>. Then how to replace the Paragraph mark without affect the style of the previous text? and hot to assing this <code>Para.Range.Characters(ln - 1)</code> to a variable? in order to set more options."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1560800361, "post_id": 56633459, "comment_id": 99846629, "body": "Edited answer. May please feedback."}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1560837443, "post_id": 56633459, "comment_id": 99855479, "body": "Hi Ahmed, it work this time, thanks so much. I have a final issue, if you have chance. Some lines for what I want to replace the <code>paragraph mark</code> with <code>string</code> begin with a number of one of more digits. These numbers at the begining have font size = 8pt and I want to preserve the font size of that numbers at the begining. Example: <code>4 this is a line</code>,<code>208 another line</code> Following your logic I think is like determine the number length to avoid change the format of them, but I don&#180;t know how to do it. Thanks for help"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1560859510, "post_id": 56633459, "comment_id": 99867081, "body": "Answer edited to keep leading digits of replacement string font size to 8"}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1560891580, "post_id": 56633459, "comment_id": 99883869, "body": "@AhmedU Hi Ahmed. Thanks for your help. I think the previous code you posted works better. This last doesn&#39;t seem to work. The numbers at the beginning of each paragraph are change in their font size to 20."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1560892227, "post_id": 56633459, "comment_id": 99884087, "body": "Though it worked according my understanding, may i rollback the latest edition?"}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1560892594, "post_id": 56633459, "comment_id": 99884229, "body": "@AhmedU I think that even the numbers&#39;s size are modified with your previous version, it seems to work better for my goal. Then, the previous version is better. Thank you"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 1, "last_activity_date": 1560899884, "last_edit_date": 1560899884, "creation_date": 1560781895, "answer_id": 56633459, "question_id": 56556117, "link": "https://stackoverflow.com/questions/56556117/replace-paragraph-mark-only-when-is-preceded-by-text-with-specific-font-size-ms/56633459#56633459", "title": "Replace paragraph mark only when is preceded by text with specific font size MS word", "body": "<p>It could simply done (without using <code>Find</code> method) like this </p>\n\n<pre><code>Sub ReplacePara()\nDim Para As Paragraph, Xstr As String, Rng As Range\nXstr = \"String to be added\"\nFor Each Para In ActiveDocument.Paragraphs\nln = Para.Range.Characters.Count\n    If ln &gt; 1 Then\n    If Para.Range.Characters(ln - 1).Font.Size = 20 Then\n    Para.Range.Text = Left(Para.Range.Text, ln - 1) &amp; Xstr\n    Set Rng = ActiveDocument.Range(Start:=Para.Range.Start, End:=Para.Range.Start + ln - 1 + Len(Xstr))\n    Rng.Font.Size = 20\n    End If\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>Tested to achieve what I understand as your requirement\nEdited to assign a Font size of preceding text (i.e 20) for added string. Font name, Bold, italics etc properties (gathered by <code>Para.Range.Characters(ln - 1).Font........</code> to a variable before replacement) could also be assigned to added text in same way.</p>\n"}], "owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 56633459, "answer_count": 1, "score": 1, "last_activity_date": 1560899884, "creation_date": 1560321963, "question_id": 56556117, "link": "https://stackoverflow.com/questions/56556117/replace-paragraph-mark-only-when-is-preceded-by-text-with-specific-font-size-ms", "title": "Replace paragraph mark only when is preceded by text with specific font size MS word", "body": "<p>I have a MS Word document (2016) containing text with different fonts like this</p>\n\n<p><strong>Abc.q</strong>    </p>\n\n<p>Defq</p>\n\n<p>// <code>Abc.</code> has font size = 20 pt and <code>q</code> that represents <code>paragraph mark</code> has font size=10 pt</p>\n\n<p>// <code>Def</code> has font size = 16 pt and <code>q</code> (paragraph mark) has font size=10 pt</p>\n\n<p>The <code>paragraph mark</code> is equivalent to <code>carriage return CR (^13)</code></p>\n\n<p>Then, how can I replace the <code>paragraph mark</code> with <code>string</code> but only for the texts that have font size = 20 pt, this is in this case only <code>Abc.</code> and result would be <strong>Abc.string</strong> using Advance Find/Replace or VBA?</p>\n\n<p>I tried:</p>\n\n<pre><code>Find: ^13 --&gt; with font 10pt\nReplace: string\n</code></pre>\n\n<p>But that replaces <code>paragraph mark</code> with <code>string</code> in all cases. I even tried creating a new style with font = 20.pt and in option <strong>Style for following paragraph</strong> I set <strong>q Normal</strong> (Where <code>q</code> represents paragraph mark).</p>\n\n<p>Thanks for any help. </p>\n"}, {"tags": ["vba", "list", "excel-2016"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1560322183, "post_id": 56556103, "comment_id": 99692792, "body": "Hello From France, welcome to StackOverflow, can you please add your code to your question? We can&#39;t help you without it."}, {"owner": {"reputation": 1, "user_id": 11635054, "user_type": "registered", "profile_image": "https://graph.facebook.com/685985671830862/picture?type=large", "display_name": "From France", "link": "https://stackoverflow.com/users/11635054/from-france"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1560332132, "post_id": 56556103, "comment_id": 99697957, "body": "Hello Damian, do you know if in VBA it&#39;s possible to active a filter before delete workbook names, it would be perfect. ____________________________________________________________&zwnj;&#8203;___________  Sheets(2).Copy After:=Sheets( 2) Sheets(2).Activate__________________________________________&zwnj;&#8203;__ Sheets(2).Shapes.Range(Array(&quot;Button&quot;)).Select______________&zwnj;&#8203;______ Selection.Delete____________________________________________&zwnj;&#8203;__  ActiveWorkbook.Names(&quot;A&quot;).Delete____________________________&zwnj;&#8203;___  ActiveWorkbook.Names(&quot;B&quot;).Delete____________________________&zwnj;&#8203;___"}, {"owner": {"reputation": 1, "user_id": 11635054, "user_type": "registered", "profile_image": "https://graph.facebook.com/685985671830862/picture?type=large", "display_name": "From France", "link": "https://stackoverflow.com/users/11635054/from-france"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1560332558, "post_id": 56556103, "comment_id": 99698206, "body": "I would like to apply a filter to select all lists of sheet 2 in order to delete their lists but save lists of my workbook which are used on the sheet 3."}], "owner": {"reputation": 1, "user_id": 11635054, "user_type": "registered", "profile_image": "https://graph.facebook.com/685985671830862/picture?type=large", "display_name": "From France", "link": "https://stackoverflow.com/users/11635054/from-france"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560322157, "creation_date": 1560321904, "last_edit_date": 1560322157, "question_id": 56556103, "link": "https://stackoverflow.com/questions/56556103/how-to-copy-several-times-a-page-without-her-list", "title": "How to copy several times a page without her list", "body": "<p>Firstly, I want to apologize for my bad English.</p>\n\n<p>Currently, I try to copy (several times) a page in my workbook(=\"classeur\" in french) with this code but it contains lists and they are multiplying each time I use the macro.\nDo you have an idea to avoid it please ?</p>\n\n<p>List for each copy:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KmWy6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KmWy6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks you for your time</p>\n"}, {"tags": ["excel", "vba", "decimal"], "comments": [{"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1560324734, "post_id": 56555980, "comment_id": 99693935, "body": "What is <code>Me.scrFoilMarkup</code> ?"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1560324914, "post_id": 56555980, "comment_id": 99694035, "body": "@DmitrijHolkin Added initializations on the post"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1560325046, "post_id": 56555980, "comment_id": 99694108, "body": "and what means <code>j</code> in your code?"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1560325121, "post_id": 56555980, "comment_id": 99694149, "body": "Sorry that is just to move to the next row for every loop iteration. Just adding bits of my code trying to keep the problem simple. Thought the first form was sufficient as it revolves around the <code>i</code> variable not being equal to the while condition"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1560325245, "post_id": 56555980, "comment_id": 99694230, "body": "So, what you want to get? Open Form, then scroll scrollbar and get chart inside form?"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1560325331, "post_id": 56555980, "comment_id": 99694279, "body": "@DmitrijHolkin I have another form that sets the parameters of the scrollbars. Then it is translated to the values of <code>Me.scrFoilMarkup</code> added an image of it in the main post to give an idea. This is why I need a robust way to convert the decimals"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1560325567, "post_id": 56555980, "comment_id": 99694399, "body": "A really difficult to understand without the file, as your <code>frmSettings.tbxFoilMarkupHigh.Value</code> always should equal to <code>Me.scrFoilMarkup.Max &#47; BigNum</code>"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1560325727, "post_id": 56555980, "comment_id": 99694498, "body": "Yes that is correct it should be always equal to it. Sadly I cannot send the file due to confidential calculations but I believe everything is correct until the loop portion of the code. Maybe i&#39;ll just find a workaround. Thank you for your time. It is hard to really give a full context as it gets complicated fast"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1560325867, "post_id": 56555980, "comment_id": 99694567, "body": "so just give some the values instead of variables and expected results for each."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1560326176, "post_id": 56555980, "comment_id": 99694743, "body": "Just check the first form of the post and any values plotted as a <code>Me.scrFoilMarkup.Max</code> and <code>Me.scrFoilMarkup.Max</code> should hold true once something goes wrong there is something wrong with the data type/decimal rounding off. It&#39;s arbitrary as long as the max portion is greater than the min one"}], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1560322828, "post_id": 56556202, "comment_id": 99693050, "body": "This has caused problems for my code though. The <code>i</code>&#39;s are supposed to be in a 0.05 intervals when the minimum is at 1.3 and the maximum is 1.8. What happens is it became in intervals of 0.1 probably due to the rounding off of the format. If there will be a several digit decimal I don&#39;t know what problems it may cause down the line. <a href=\"https://ibb.co/LpqC3Rb\" rel=\"nofollow noreferrer\">ibb.co/LpqC3Rb</a>"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1560323690, "post_id": 56556202, "comment_id": 99693426, "body": "Hold on let me check this out"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1560326846, "post_id": 56556202, "comment_id": 99695054, "body": "Just to clarify <code>Do While i &lt;= Mn &#47; BigNum</code> should be <code>Do While i &lt;= Mx &#47; BigNum</code> in this context but it still doesn&#39;t work it still treats <code>i</code> as greater than <code>Do While i &lt;= Mx &#47; BigNum</code> I guess it&#39;s safe to say it&#39;s not a data type issue. Perhaps it&#39;s really a very minor rounding off issue i&#39;ll just have to come up of a way to limit the number of decimal places I guess and use <code>Round</code> or the <code>Format</code> as mentioned here as well"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 0, "last_activity_date": 1560323260, "last_edit_date": 1560323260, "creation_date": 1560322310, "answer_id": 56556202, "question_id": 56555980, "link": "https://stackoverflow.com/questions/56555980/how-to-properly-compare-decimal-characters-in-vba-excel/56556202#56556202", "title": "How to properly compare decimal characters in VBA excel?", "body": "<p>Try to compare the variable and formula as the same data types and format</p>\n\n<pre><code>Dim i As Variant, BigNum As Long\n\nBigNum = 100000\n\ni = Format(Me.scrFoilMarkup.Min / BigNum, \"#.0\")\n\nDo While i &lt;= Format(Me.scrFoilMarkup.Min / BigNum, \"#.0\")\n    i = Format(i + ((Me.scrFoilMarkup.Max - Me.scrFoilMarkup.Min) / BigNum) / 10, \"#.0\")\nLoop\n</code></pre>\n\n<p><strong>Edit</strong><br>\nTo circumvent OP's decimal problem</p>\n\n<pre><code>Dim i As Variant, Mx As Variant, Mn As Variant\nDim BigNum As Long\n\nBigNum = 100000\n\nMn = Me.scrFoilMarkup.Min\nMx = Me.scrFoilMarkup.Max\n\ni = Mn / BigNum\n\nDo While i &lt;= Mn / BigNum\n    i = i + ((Mx - Mn) / BigNum) / 10\nLoop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1560323441, "post_id": 56556380, "comment_id": 99693312, "body": "I tried using this on <code>Do While i &lt;= CDbl(Me.scrFoilMarkup.Max &#47; BigNum)</code>, but still thinks <code>i</code> is greater than this value at 1.8=1.8"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1560323628, "post_id": 56556380, "comment_id": 99693394, "body": "If the decimal is a several digit decimal won&#39;t it cause problems for the code as it&#39;ll compare the rounded value?"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1560323761, "post_id": 56556380, "comment_id": 99693451, "body": "So then please attach your file, or explain what you trying to achieve"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1560324070, "post_id": 56556380, "comment_id": 99693621, "body": "Added more details in the post"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 1, "creation_date": 1560327284, "post_id": 56556380, "comment_id": 99695280, "body": "Yes I had round prior to making this post actually I removed it because for some reason my code glitched up and ran infinitely. I think I know why now. I only placed round here (in my code equivalent): <code>i = Round( i + ((sMax - sMin) &#47; BigNum) &#47; 10,2)</code> and only initially set a decimal place of <code>1</code>. Perhaps it should be on both: <code>Do While Round(i, 2) &lt;= Round(sVar, 2)</code>. But a decimal place of <code>2</code> is also questionable, I guess the only way is to find a way to limit the possible decimals so it won&#39;t glitch at some point"}], "tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1560326905, "last_edit_date": 1560326905, "creation_date": 1560322978, "answer_id": 56556380, "question_id": 56555980, "link": "https://stackoverflow.com/questions/56555980/how-to-properly-compare-decimal-characters-in-vba-excel/56556380#56556380", "title": "How to properly compare decimal characters in VBA excel?", "body": "<p>You should use <code>CDbl()</code></p>\n\n<pre><code>MyDouble = CDbl(Me.scrFoilMarkup.Min / BigNum) ' Convert result to a Double.\n</code></pre>\n\n<p>Or use <code>Round</code></p>\n\n<pre><code>MyDouble = Round((Me.scrFoilMarkup.Min / BigNum),2)\n</code></pre>\n\n<p>test</p>\n\n<pre><code>Sub Test()\n    sMax = 180000\n    sMin = 130000\n    BigNum = 100000\n    i = sMin / BigNum\n    j = 0\n    sVar = sMax / BigNum\n        Do While Round(i, 2) &lt;= Round(sVar, 2)\n            Debug.Print i\n                i = i + ((sMax - sMin) / BigNum) / 10\n                j = j + 1\n        Loop\nEnd Sub\n</code></pre>\n\n<p>Result</p>\n\n<p><a href=\"https://i.stack.imgur.com/yviS8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yviS8.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1560326905, "creation_date": 1560321413, "last_edit_date": 1560325396, "question_id": 56555980, "link": "https://stackoverflow.com/questions/56555980/how-to-properly-compare-decimal-characters-in-vba-excel", "title": "How to properly compare decimal characters in VBA excel?", "body": "<p>I am having trouble with my code because even if <code>(Me.scrFoilMarkup.Max / BigNum) = i</code>, (e.g. 1.8=1.8), the Boolean still returns <code>False</code>. Also the code ends at this point--meaning the program detected <code>i</code> to be greater than <code>Me.scrFoilMarkup.Max / BigNum</code> at 1.8=1.8. The reason for the BigNum--which is set to 100,000 in my case, is because the scrollbar of a userform is having issues storing decimal numbers so I convert it to an integer to prevent this problem.  </p>\n\n<p>In case it might be of any help, <code>i</code> is declared as a <code>Double</code> type</p>\n\n<pre><code>i = Me.scrFoilMarkup.Min / BigNum\nj=0\nDo While i &lt;= Me.scrFoilMarkup.Max / BigNum\n        ThisWorkbook.Worksheets(\"Simulation-Chart\").Cells(2 + j, 1) = i\n        i = i + ((Me.scrFoilMarkup.Max - Me.scrFoilMarkup.Min) / BigNum) / 10\n        j= j + 1\nLoop\n</code></pre>\n\n<p>Assuming <code>Me.scrFoilMarkup.Min / BigNum</code> = 1.3 and <code>Me.scrFoilMarkup.Max / BigNum</code> = 1.8, What I need to code to do is to know that <code>i</code> is indeed equal to <code>Me.scrFoilMarkup.Max / BigNum</code> then it should print the value of <code>i</code> in my spreadsheet as shown as below to be used as my chart's values.</p>\n\n<p><a href=\"https://i.stack.imgur.com/gvr30.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gvr30.png\" alt=\"enter image description here\"></a></p>\n\n<p>Other code in the initialization of the userform:</p>\n\n<pre><code>Me.scrFoilMarkup.Min = frmSettings.tbxFoilMarkupLow.Value * BigNum\nMe.scrFoilMarkup.Max = frmSettings.tbxFoilMarkupHigh.Value * BigNum\nMe.scrFoilMarkup.SmallChange = ((frmSettings.tbxFoilMarkupHigh.Value - frmSettings.tbxFoilMarkupLow.Value) / 40) * BigNum\nMe.scrFoilMarkup.LargeChange = ((frmSettings.tbxFoilMarkupHigh.Value - frmSettings.tbxFoilMarkupLow.Value) / 8) * BigNum\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/7rcvY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7rcvY.png\" alt=\"enter image description here\"></a></p>\n\n<p>Initial Parameters form:</p>\n\n<p><a href=\"https://i.stack.imgur.com/F24qq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F24qq.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 6570713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SrIS2.jpg?s=128&g=1", "display_name": "Alvaro CC", "link": "https://stackoverflow.com/users/6570713/alvaro-cc"}, "is_accepted": false, "score": 0, "last_activity_date": 1560322815, "creation_date": 1560322815, "answer_id": 56556332, "question_id": 56555913, "link": "https://stackoverflow.com/questions/56555913/exit-event-not-triggering-correctly-on-textboxes/56556332#56556332", "title": "Exit Event not triggering correctly on TextBoxes", "body": "<p>Could you try first deleting the \"Gateway\" textbox , and then insert it again in the form with another name like gateway2 ? </p>\n\n<p>then try something simple like \"msgbox('it worked')\" inside the sub </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11634943, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DvVse_vRv84/AAAAAAAAAAI/AAAAAAAAAGI/fQKR9hSXdwk/photo.jpg?sz=128", "display_name": "Portgas D. Ace", "link": "https://stackoverflow.com/users/11634943/portgas-d-ace"}, "is_accepted": true, "score": 0, "last_activity_date": 1560325071, "creation_date": 1560325071, "answer_id": 56556922, "question_id": 56555913, "link": "https://stackoverflow.com/questions/56555913/exit-event-not-triggering-correctly-on-textboxes/56556922#56556922", "title": "Exit Event not triggering correctly on TextBoxes", "body": "<p>So I figured it out. Here is the answer for all that stumble across the same issue.</p>\n\n<p>It seems that the exit events are only processed inside the same frame. If I exit this TextBox with my mouse to another TextBox inside the same frame it works. Only if I exit to another frame it doesn't. The exit event is however stored in that Frame and will be executed once the frame gets focus again. That's why I get the weird behavior of the script executing when jumping back into the frame.</p>\n\n<p>To work around this I now simply put the same checks to the frame exit event as well and that works just fine. Because those will be executed when you exit to another frame.\n(Yes that will have the consequence that the code will be executed a second time if the Frame gets focus again, but in this specific case that doesn't really hurt. In case you want to execute something more meaningful for such an event you should limit the check to just the frame exit event)</p>\n\n<p>Example:</p>\n\n<pre><code>Private Sub LAN_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n\nIf IsValidIP(AddHost.LANIP) = False Then AddHost.LANIP.BackColor = RGB(255, 0, 0) Else AddHost.LANIP.BackColor = RGB(255, 255, 255)\nIf IsValidIP(AddHost.LANSubnet) = False Then AddHost.LANSubnet.BackColor = RGB(255, 0, 0) Else AddHost.LANSubnet.BackColor = RGB(255, 255, 255)\nIf IsValidIP(AddHost.LANGW) = False Then AddHost.LANGW.BackColor = RGB(255, 0, 0) Else AddHost.LANGW.BackColor = RGB(255, 255, 255)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11634943, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DvVse_vRv84/AAAAAAAAAAI/AAAAAAAAAGI/fQKR9hSXdwk/photo.jpg?sz=128", "display_name": "Portgas D. Ace", "link": "https://stackoverflow.com/users/11634943/portgas-d-ace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 56556922, "answer_count": 2, "score": 0, "last_activity_date": 1560325071, "creation_date": 1560321131, "last_edit_date": 1560322308, "question_id": 56555913, "link": "https://stackoverflow.com/questions/56555913/exit-event-not-triggering-correctly-on-textboxes", "title": "Exit Event not triggering correctly on TextBoxes", "body": "<p>I have a question for a form I 'm creating at the moment. It's basically a simple form to enter Network data. I have an algorithm to check for valid IPs and want the Textboxes to turn red in case wrong stuff is entered. That works well for most of the textboxes, but for some it shows a weird behavior.</p>\n\n<p>Image of User Form:</p>\n\n<p><a href=\"https://i.stack.imgur.com/p9hNR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p9hNR.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm using the Exit Functions of the textboxes to do the check, so the boxes don't turn red immediately while you still enter things. Here is the code for that:</p>\n\n<pre><code>Private Sub LANGW_Exit(ByVal Cancel As MSForms.ReturnBoolean)\nIf IsValidIP(AddHost.LANGW) = False Then AddHost.LANGW.BackColor = RGB(255, 0, 0) Else AddHost.LANGW.BackColor = RGB(255, 255, 255)\nEnd Sub\n</code></pre>\n\n<p>Now to the issue. This code works fine for all textboxes except the last ones on each framed area. In this Case the Lan Gateway and Query/Retrieve. Those aren't triggered when I leave the textBox but rather when I come back to the same framed area after having exited the TextBox once.\nCan anyone come up with an explanation for this? I already looked through the Microsoft description of the exit event, but couldn't find anything.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560320221, "post_id": 56555683, "comment_id": 99692035, "body": "I don&#39;t know of a way of doing this (doesn&#39;t mean it does not exist) but I am thinking custom functions may help you. Do you do a lot of repetitive math? Writing a custom function could speed up your work flow"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1560321044, "post_id": 56555683, "comment_id": 99692353, "body": "<a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_other-mso_2013_release/how-to-use-math-autocorrect-in-excel/dadf030c-2ba3-4080-9383-3050705792cf\" rel=\"nofollow noreferrer\">Would this be helpfull?</a>."}, {"owner": {"reputation": 1, "user_id": 11634834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fa1d3a4166d2730e2499d43251c3340?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/11634834/benjamin"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1560322588, "post_id": 56555683, "comment_id": 99692956, "body": "@JvdV Thanks a lot, that sounds good. I&#39;ll work through it."}], "owner": {"reputation": 1, "user_id": 11634834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fa1d3a4166d2730e2499d43251c3340?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/11634834/benjamin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560320578, "creation_date": 1560319945, "last_edit_date": 1560320578, "question_id": 56555683, "link": "https://stackoverflow.com/questions/56555683/can-i-somehow-modify-the-math-autocorrect-list-in-excel-by-using-vba-code", "title": "Can I somehow modify the math autocorrect list in excel by using vba code?", "body": "<p>I want to access the math autocorrect list of Excel 2016, but I can't find an object with methods to do so.</p>\n\n<p>The reason is that I'm typing a lot of math stuff in Excel.\nThat's why I'd like to print all the math autocorrect entries in a list as a first step.\nThen modify this list for my needs, that is deleting a lot of the entries, because there are too much.\nThen write this list back in the math autocorrect list of Excel.</p>\n\n<p>I can access the standard autocorrect list by using application.autocorrect.\n But for the math autocorrect list I can't find an object.\nIn Word it's application.omathautocorrect, but that doesn't work in Excel.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 79, "user_id": 5275489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537dc7f88eb620c0c450f0e67c1caf7f?s=128&d=identicon&r=PG&f=1", "display_name": "SID", "link": "https://stackoverflow.com/users/5275489/sid"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1560319011, "post_id": 56555452, "comment_id": 99691634, "body": "There is an &quot;AA1&quot; Cell"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1560319426, "post_id": 56555452, "comment_id": 99691786, "body": "What&#39;s the value in <code>Row</code> when it fails? If it&#39;s just a number there&#39;s nothing in your posted code which would cause values to be copied from ColB"}, {"owner": {"reputation": 79, "user_id": 5275489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537dc7f88eb620c0c450f0e67c1caf7f?s=128&d=identicon&r=PG&f=1", "display_name": "SID", "link": "https://stackoverflow.com/users/5275489/sid"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1560319698, "post_id": 56555452, "comment_id": 99691871, "body": "value is 16. Thats what is happening tim:("}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560319759, "post_id": 56555452, "comment_id": 99691882, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1560319778, "post_id": 56555452, "comment_id": 99691895, "body": "Then there&#39;s something else not shown in your question which is responsible for that."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1560319838, "post_id": 56555452, "comment_id": 99691915, "body": "Try specifying a workbook too for the two ranges. It may be that the active workbook the code is referring to now does not have the values you are expecting"}, {"owner": {"reputation": 79, "user_id": 5275489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537dc7f88eb620c0c450f0e67c1caf7f?s=128&d=identicon&r=PG&f=1", "display_name": "SID", "link": "https://stackoverflow.com/users/5275489/sid"}, "edited": false, "score": 0, "creation_date": 1560320255, "post_id": 56555452, "comment_id": 99692045, "body": "Did No luck. Please help"}, {"owner": {"reputation": 79, "user_id": 5275489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537dc7f88eb620c0c450f0e67c1caf7f?s=128&d=identicon&r=PG&f=1", "display_name": "SID", "link": "https://stackoverflow.com/users/5275489/sid"}, "edited": false, "score": 0, "creation_date": 1560320534, "post_id": 56555452, "comment_id": 99692150, "body": "BC16:EV16. This is what is the range"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1560320899, "post_id": 56555452, "comment_id": 99692297, "body": "We can&#39;t help you without you showing us the full code. As @TimWilliams mentioned, something else in your code is causing the problem"}], "owner": {"reputation": 79, "user_id": 5275489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537dc7f88eb620c0c450f0e67c1caf7f?s=128&d=identicon&r=PG&f=1", "display_name": "SID", "link": "https://stackoverflow.com/users/5275489/sid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560319366, "creation_date": 1560318779, "last_edit_date": 1560319366, "question_id": 56555452, "link": "https://stackoverflow.com/questions/56555452/how-to-paste-values-in-vba-after-z-ie-aa-ab-etc", "title": "How to paste values in VBA after Z ie. AA, AB etc", "body": "<pre><code>Worksheets(\"Sheet1\").Range(\"BC\" &amp; Row &amp; \":EV\" &amp; Row).Copy _\n     Destination:=Worksheets(\"Sheet2\").Range(\"B\" &amp; Row)\nActiveCell.Offset(1, 0).Select\n</code></pre>\n\n<p>it is taking the values from Column B I want it from BC</p>\n\n<p>Please help</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11634599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/028ff3b28f7790d77c75c3f659601284?s=128&d=identicon&r=PG&f=1", "display_name": "Pratyaksh Agrawal", "link": "https://stackoverflow.com/users/11634599/pratyaksh-agrawal"}, "edited": false, "score": 0, "creation_date": 1560337445, "post_id": 56556742, "comment_id": 99700841, "body": "Hey JohnyL thanks for the reply.  This code throws an error at the criteria line.. My table is in The sheet named &quot;Data&quot;, the table itself is named &quot;Data&quot; as well, where as the conditions on which the filter is to be applied are in &quot;sheet1&quot;"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 13, "user_id": 11634599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/028ff3b28f7790d77c75c3f659601284?s=128&d=identicon&r=PG&f=1", "display_name": "Pratyaksh Agrawal", "link": "https://stackoverflow.com/users/11634599/pratyaksh-agrawal"}, "edited": false, "score": 0, "creation_date": 1560337915, "post_id": 56556742, "comment_id": 99701112, "body": "So, change names and all references to ranges at your will."}, {"owner": {"reputation": 13, "user_id": 11634599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/028ff3b28f7790d77c75c3f659601284?s=128&d=identicon&r=PG&f=1", "display_name": "Pratyaksh Agrawal", "link": "https://stackoverflow.com/users/11634599/pratyaksh-agrawal"}, "edited": false, "score": 0, "creation_date": 1560400801, "post_id": 56556742, "comment_id": 99725047, "body": "This code tells will filter data based on cells in the same worksheet right? If yes, how should I write .cells(,) to refer to cells from a different worksheet?"}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1560324447, "creation_date": 1560324447, "answer_id": 56556742, "question_id": 56554854, "link": "https://stackoverflow.com/questions/56554854/how-to-loop-through-excel-autofilter-where-a-criteria-refers-to-a-cell/56556742#56556742", "title": "How to loop through excel autofilter where a criteria refers to a cell", "body": "<pre><code>Sub FilterValues()\n\n    Dim iColumn As Integer\n    Dim rngData As Range\n    Dim wksCriterias As Worksheet\n\n    Set wksCriterias = Worksheets(\"Sheet1\")\n    Set rngData = Range(\"Data\")\n\n    With wksCriterias\n        For iColumn = 2 To 3\n            rngData.AutoFilter Field:=2, _\n                               Criteria1:=Array(CStr(.Cells(2, iColumn)), CStr(.Cells(3, iColumn))), _\n                               Operator:=xlFilterValues\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11634599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/028ff3b28f7790d77c75c3f659601284?s=128&d=identicon&r=PG&f=1", "display_name": "Pratyaksh Agrawal", "link": "https://stackoverflow.com/users/11634599/pratyaksh-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560324447, "creation_date": 1560315012, "last_edit_date": 1560320323, "question_id": 56554854, "link": "https://stackoverflow.com/questions/56554854/how-to-loop-through-excel-autofilter-where-a-criteria-refers-to-a-cell", "title": "How to loop through excel autofilter where a criteria refers to a cell", "body": "<p>I need to loop through an autofilter where I have X number of columns and the filter in each column will be as per a criteria specified in another sheet</p>\n\n<p>This is the working code and in this I have specified autofilters for 2 columns, in the actual data I have 50 columns and the criteria for field 2 depends on B2 and B3 in the worksheet named Shhet1, criteria for field 3 depends on C2 and C3 and so on uptil column 50</p>\n\n<pre><code>Sub Macro1()\n   Sheets(\"Data\").Select\n   ActiveSheet.Range(\"Data\").AutoFilter Field:=2, Criteria1:=Worksheets(\"Sheet1\").Range(\"B2\").Value &amp; Worksheets(\"Sheet1\").Range(\"B3\").Value\n   ActiveSheet.Range(\"Data\").AutoFilter Field:=3, Criteria1:=Worksheets(\"Sheet1\").Range(\"C2\").Value &amp; Worksheets(\"Sheet1\").Range(\"C3\").Value\nEnd Sub\n</code></pre>\n\n<p>I have tried the following code but the use of cells.value is incorrect.</p>\n\n<pre><code>Sub Macro2()\nDim i As Integer\n    Sheets(\"Data\").Select\nFor i = 2 To 3\nActiveSheet.Range(\"Data\").AutoFilter Field:=2, Criteria1:=Worksheets(\"Sheet1\").Cells(i, 2).Value &amp; Worksheets(\"Sheet1\").Cells(i, 3).Value\nNext i\nEnd sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop", "excel-formula"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1560312513, "post_id": 56554370, "comment_id": 99690058, "body": "You&#39;re looking for the <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office2000/aa164528(v=office.10)\" rel=\"nofollow noreferrer\"><code>Mod</code> operator</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7198786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96ffd34d124dedc282877756b0b4a01e?s=128&d=identicon&r=PG&f=1", "display_name": "famakki1", "link": "https://stackoverflow.com/users/7198786/famakki1"}, "edited": false, "score": 1, "creation_date": 1560312673, "post_id": 56554421, "comment_id": 99690081, "body": "Thanks ! Figured out another way as well: If (cell.Row / 2#) = Int(cell.Row / 2#) And cell.Value = &quot;S&quot; Then  But yours is more tidy :)"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 11, "user_id": 7198786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96ffd34d124dedc282877756b0b4a01e?s=128&d=identicon&r=PG&f=1", "display_name": "famakki1", "link": "https://stackoverflow.com/users/7198786/famakki1"}, "edited": false, "score": 0, "creation_date": 1560312899, "post_id": 56554421, "comment_id": 99690127, "body": "Using Mod will be shorter &amp; cleaner though."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1560327692, "post_id": 56554421, "comment_id": 99695479, "body": "Optimally, you should need two <code>If</code>s: first one would check the oddness, the second one would match a string."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1560344091, "post_id": 56554421, "comment_id": 99704877, "body": "@JohnyL ... Didn&#39;t quite understand what you meant here ? When we can do that in the same line, why put two if condition ?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1560344414, "post_id": 56554421, "comment_id": 99705108, "body": "Because <code>And</code> in VBA is <i>not</i> short-circuting in VBA (as opposed to <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/andalso-operator\" rel=\"nofollow noreferrer\">AndAlso</a> in VB.NET). This means that it doesn&#39;t matter if first condition is false - the second condition will be checked <i>anyway</i>. By separating these checks, you eliminate unnecessary checks."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1560344546, "post_id": 56554421, "comment_id": 99705207, "body": "Yes That&#39;s the Purpose of <code>And</code> to check for both conditions, and both conditions should be true to pass. Which is exactly what is required in this scenario. @JohnyL"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 1, "last_activity_date": 1560312873, "last_edit_date": 1560312873, "creation_date": 1560311425, "answer_id": 56554421, "question_id": 56554370, "link": "https://stackoverflow.com/questions/56554370/run-a-for-loop-only-if-current-row-is-odd/56554421#56554421", "title": "Run a For Loop only if current row is odd", "body": "<p>This will work:  <code>Mod</code> Function gives you the remainder. Use it as below. </p>\n\n<pre><code>Dim typecheck As Range\n\nSet typecheck = Range(\"B1:B60\") \n\nFor Each cell In typecheck\n\n    If cell.Value = \"S\" And Not cell.Row Mod 2 = 0 Then 'For Odd Row\n\n    cell.Offset(0, 1).Value = \"_status\"\n\n    End If\n\nNext\n</code></pre>\n\n<p>It will pass the if condition on a odd row only. For Even Rows just remove <code>Not</code> from if condition.</p>\n\n<p>We are checking the remainder after dividing the row number with 2, if <code>0</code> then it's an even row, if not then it's a odd row.</p>\n"}], "owner": {"reputation": 11, "user_id": 7198786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96ffd34d124dedc282877756b0b4a01e?s=128&d=identicon&r=PG&f=1", "display_name": "famakki1", "link": "https://stackoverflow.com/users/7198786/famakki1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560312873, "creation_date": 1560310893, "last_edit_date": 1560312430, "question_id": 56554370, "link": "https://stackoverflow.com/questions/56554370/run-a-for-loop-only-if-current-row-is-odd", "title": "Run a For Loop only if current row is odd", "body": "<p>I am trying to run a loop to create some data as shown. I am trying to run this simple loop but would only like for it run for odd rows or even rows. I have a few ideas how to do this but don't know how to put it to code.</p>\n\n<p>For example I am not sure if Excel VBA can handle something like: If Cell Value = S AND Row is Odd then...</p>\n\n<p>Another thing I thought maybe a \"Range\" can be defined as only odd or even values but no luck. Is this possible?</p>\n\n<pre><code>Dim typecheck As Range\n\nSet typecheck = Range(\"B1:B60\") 'set the range itself to odd/even? or no range at all? just individually?\n\nFor Each cell In typecheck\n\n    If cell.Value = \"S\" Then 'and odd row?\n\n    cell.Offset(0, 1).Value = \"_status\"\n\n    End If\n\nNext\n</code></pre>\n\n<p>Expect result is, the loop will go through rows 1-60 and will produce a result only if the cell in the range has a value of S and the row is an odd row.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1560333266, "post_id": 56556337, "comment_id": 99698603, "body": "Thank you for the solution.  I searched for things like &quot;ms-word reserved words&quot;, and found nothing.  I looked up <code>Sign</code> and found it listed as a method of the <code>Signature</code> object.  I changed the name in the <code>CustomDocumentProperties</code>, but I never changed it in the <code>Variables</code> list.  This has been driving me crazy for years!"}], "tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": true, "score": 2, "last_activity_date": 1560322822, "creation_date": 1560322822, "answer_id": 56556337, "question_id": 56553860, "link": "https://stackoverflow.com/questions/56553860/cannot-save-a-docm-file-after-assigning-a-value-to-a-particular-document-variab/56556337#56556337", "title": "Cannot save a .docm file after assigning a value to a particular document.variable", "body": "<p>The <code>Document.Variable \"sign\"</code> is used by Word to indicate that a valid digital signature has been applied to the code project.</p>\n\n<p>Choose a different name for your variable such as \"sigDate\"</p>\n"}], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2042, "favorite_count": 0, "accepted_answer_id": 56556337, "answer_count": 1, "score": 0, "last_activity_date": 1560435386, "creation_date": 1560306377, "last_edit_date": 1560435386, "question_id": 56553860, "link": "https://stackoverflow.com/questions/56553860/cannot-save-a-docm-file-after-assigning-a-value-to-a-particular-document-variab", "title": "Cannot save a .docm file after assigning a value to a particular document.variable", "body": "<p>I have a file with a macro that was originally created as a <code>.doc</code> file. If I try to save it as a <code>.docm</code> or <code>.dotm</code> file, it will not save.  No error message, but the file doesn't get saved.</p>\n\n<p>If I remove the module; or save it as a <code>.docx</code> file, it will save.</p>\n\n<p>If I </p>\n\n<ul>\n<li>open the <code>.docx</code> file</li>\n<li>import or copy/paste the previous macro into a regular module</li>\n<li>run the macro</li>\n</ul>\n\n<p>again, it cannot be saved as a <code>.docm</code></p>\n\n<p>If I remove the module, I can save it as a <code>.docm</code></p>\n\n<p>Or, even with the macro present and having been run, I can save it as a <code>.doc</code> file.</p>\n\n<p>So it seems there might be something in the macro that, after having run, creates a file that cannot be saved as a <code>.docm</code> but could still be saved as a <code>.doc</code> file.</p>\n\n<p>The macro examines some custom properties of the document that are manually entered.  It computes a variety of document variables which are used in fields throughout the document, and then updates those fields.</p>\n\n<p>By using breakpoints, It seems that when the code assigns a value to the <code>Document.Variable</code> <code>\"sign\"</code>, the document can no longer be saved.  That is a date field, but there are other date fields in the document that don't cause this problem.</p>\n\n<p>The code.text for the particular fields:</p>\n\n<pre><code>docvariable \"sign\" \\@ \"MMMM, yyyy\" \\*upper \\* MERGEFORMAT \ndocvariable \"sign\" \\@ \"d\" \\* OrdText \\*upper\\* MERGEFORMAT \n</code></pre>\n\n<p>The macro code (in a regular module):</p>\n\n<pre><code>Option Explicit\n\nSub Update()\n    Dim prop As DocumentProperty\n    Dim area As Double, rent As Double, start As Date, tend As Date, notice As Date, term As Long, Sign As Date\n    Dim annual As Double, annualcents As Double, monthly As Double, monthlycents As Long\n    Dim var As Variables\n\n'get Document Properties\nFor Each prop In ThisDocument.CustomDocumentProperties\n    If prop.Name = \"area\" Then area = prop.Value\n    If prop.Name = \"rent\" Then rent = prop.Value\n    If prop.Name = \"start\" Then start = Int(prop.Value)\n    If prop.Name = \"term\" Then term = prop.Value\n    If prop.Name = \"sigDate\" Then Sign = Int(prop.Value)\nNext prop\n\n    annual = area * rent\n    annualcents = 100 * (annual - Int(annual))\n    monthly = annual / 12\n    monthlycents = 100 * (monthly - Int(monthly))\n    tend = DateAdd(\"yyyy\", term, start)\n    tend = DateAdd(\"d\", -1, tend)\n    notice = DateAdd(\"m\", -4, tend)\n\nSet var = ThisDocument.Variables\n    var(\"area\").Value = area\n    var(\"rent\").Value = rent\n    var(\"start\").Value = start\n    var(\"term\").Value = term\n\n    'if this line is not run or\n    'if this document variable is deleted,\n    'the file will save as expected\n    var(\"sign\").Value = Sign\n\n\n    var(\"annual\").Value = annual\n    var(\"annualcents\").Value = annualcents\n    var(\"monthly\").Value = monthly\n    var(\"monthlycents\").Value = monthlycents\n    var(\"tend\").Value = tend\n    var(\"notice\").Value = notice\n\nThisDocument.Fields.Update\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1560310184, "post_id": 56553317, "comment_id": 99689635, "body": "if it is not absolutely required to unload <code>UserForm1</code> then why not use <code>UserForm1.TextBox2.Text = T.Address</code>  : <code>UserForm1.Hide</code> in Change event. And in Command button click <code>Range(TextBox2.Value).Value = TextValue1</code>"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1560366880, "post_id": 56553317, "comment_id": 99717008, "body": "To create a global variable, you must declare it in a normal module at its top like this <code>Public A as Range</code>. If you declare it in a sheet module or a userform, or a class, it will be restraint to that one only. Also , since A is a range , you must write <code>Set A = T</code>."}, {"owner": {"reputation": 11, "user_id": 4474359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b689900d5466b6f2f5efdbc8be0d2329?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Villegas", "link": "https://stackoverflow.com/users/4474359/diego-villegas"}, "edited": false, "score": 0, "creation_date": 1560641102, "post_id": 56553317, "comment_id": 99804152, "body": "Hello, thanks for your reply. I didn&#39;t know you could make use of UserForms without Unloading it. I still have a problem with the line <code>Range(TextBox2.Value).Value = TextValue1</code> The error 1004 is within the Range method with the object _Global.   I&#39;ve also tried tu creat the public variable A and set it to T.Address and in the command button use <code>Range(A).Value = TextValue1</code> or  <code>A.Value = TextValue1</code>  but none of them works"}], "owner": {"reputation": 11, "user_id": 4474359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b689900d5466b6f2f5efdbc8be0d2329?s=128&d=identicon&r=PG&f=1", "display_name": "Diego Villegas", "link": "https://stackoverflow.com/users/4474359/diego-villegas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560410434, "creation_date": 1560300487, "last_edit_date": 1560410434, "question_id": 56553317, "link": "https://stackoverflow.com/questions/56553317/using-cell-address-of-a-private-sub-inside-a-userform", "title": "Using cell address of a private sub inside a UserForm", "body": "<p>I am using a Private Sub Worksheet_Change to localize any change within a range of cells. After a change has been made and some requirements are fulfilled, I require a textbox so the user may or may not modify such changes. Inside this textbox I do not know how to refer to the original cell address used in the Private Sub. </p>\n\n<p>I have tried to use global variables but it does not work.</p>\n\n<pre><code>Global A as Range\n' Code for a specific worksheet \nPrivate Sub Worksheet_Change(ByVal T As Range)\nDim KeyCells As Range\nSet KeyCells = Range(\"Ag5:KL205\")\n     If Not Application.Intersect(KeyCells, Range(T.address)) Is Nothing Then\n\nA = T\n\n' Code for Conditions\n\nUnload UserForm1\nUserForm1.Show\nEnd\n\nEnd Sub\n\n---------------------------------------------------------------------------\n' Code inside UserForm1\nPrivate Sub CommandButton1_Click()\n\nIf OptionButton1.Value = True Then\n\nTextValue1 = TextBox1.Value\nA.Value = TextValue1\n</code></pre>\n\n<p>I want that inside that textbox, the cell to change is the one which activated the code in the Private Sub. I've tried using ActiveCell.Value, but the thing is that if the user presses \"enter\" the active cell for the text box is the one below. If the user presses \"right arrow\", the active cell is the one next to it. I've tried to specify the code to the specific action that the user might do, but I haven't had any luck in that either.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8666879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4374aec88c7fb40a1c118a88d7d0d20f?s=128&d=identicon&r=PG&f=1", "display_name": "scubydu671", "link": "https://stackoverflow.com/users/8666879/scubydu671"}, "edited": false, "score": 0, "creation_date": 1560378271, "post_id": 56555256, "comment_id": 99721040, "body": "Yes, that&#39;s right. Forms, in the context of being a subform of another form are controls, which would have &quot;Enabled&quot; and &quot;Locked&quot; as properties. Articles I read instructed to add &quot;.Form&quot; after the name of the subform control to define the subform control as a &quot;form&quot; type control. Your answer didn&#39;t have the &quot;.Form&quot;, after the name of the subform so I removed it from my code and it worked. Thank you."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 5, "user_id": 8666879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4374aec88c7fb40a1c118a88d7d0d20f?s=128&d=identicon&r=PG&f=1", "display_name": "scubydu671", "link": "https://stackoverflow.com/users/8666879/scubydu671"}, "edited": false, "score": 0, "creation_date": 1560379126, "post_id": 56555256, "comment_id": 99721242, "body": "It&#39;s because not setting property of form. And even for the Requery, it is not needed. Sometimes &quot;Form&quot; will be needed but not for the 3 lines in your code."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 1, "last_activity_date": 1560317666, "creation_date": 1560317666, "answer_id": 56555256, "question_id": 56553226, "link": "https://stackoverflow.com/questions/56553226/update-enabled-and-locked-properties-for-a-subform/56555256#56555256", "title": "Update &quot;Enabled&quot; and &quot;Locked&quot; properties for a subform", "body": "<p>As far as I can see, forms don't have Locked and Enabled properties, controls have them. Subform/Subreport container is a control and does have these properties. Recommend naming container different from the form it holds, such as ctrSapling. </p>\n\n<pre><code>Forms.frmData.ctrSapling.Enabled = True\nForms.frmData.ctrSapling.Locked = False\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8666879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4374aec88c7fb40a1c118a88d7d0d20f?s=128&d=identicon&r=PG&f=1", "display_name": "scubydu671", "link": "https://stackoverflow.com/users/8666879/scubydu671"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 56555256, "answer_count": 1, "score": 0, "last_activity_date": 1594715930, "creation_date": 1560299660, "last_edit_date": 1594715930, "question_id": 56553226, "link": "https://stackoverflow.com/questions/56553226/update-enabled-and-locked-properties-for-a-subform", "title": "Update &quot;Enabled&quot; and &quot;Locked&quot; properties for a subform", "body": "<p>I need to enable and unlock a subform when a record is inserted in the table behind the subform. The subform, \"sfrmSaplingCount\", is a subform of \"frmData\". I'm using a popup form to get the information from the user to create the record and also enabling and unlocking the subform. The subform is locked and disabled until it actually has a record for the user to interact with.</p>\n\n<pre><code>Private Sub cmdSaveSaplingCount_Click()\n\nDim strSQL As String  \n\nstrSQL = \"INSERT INTO tblNETN_MicroplotEventSaplingCount   \n(MicroplotEventID, TaxonID, SaplingCount, \nTaxonomicReferenceAuthority_IdentificationID, ProtectedStatusID) VALUES \n(\" &amp; Me.OpenArgs &amp; \", \" &amp; Me.cboTaxonID &amp; \", \" &amp; Me.SaplingCount &amp; \", \" &amp; \nintTR &amp; \", \" &amp; intPS &amp; \")\"\n\nCurrentDb.Execute strSQL, dbFailOnError\n\nForms.frmData.sfrmSaplingCount.Form.Requery\nForms.frmData.sfrmSaplingCount.Form.Enabled = True\nForms.frmData.sfrmSaplingCount.Form.Locked = False\nDoCmd.Close acForm, \"frmNewSaplingCount\"\n</code></pre>\n\n<p>\"Run-time error 2465: Application-defined or object-defined error\" is returned on the statements to enable or unlock the subform. </p>\n\n<p>The 2 statements giving me problems are:\n\"Forms.frmData.sfrmSaplingCount.Form.Enabled = True\" &amp;\n\"Forms.frmData.sfrmSaplingCount.Form.Locked = False\"</p>\n\n<p>Can you tell me what I'm doing wrong?</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1560298286, "post_id": 56553062, "comment_id": 99687613, "body": "The most important question is if you are 100%, undoubtedly sure that the webpage is <b>completely loaded</b> before you try to work with its elements?"}, {"owner": {"reputation": 21, "user_id": 11489816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfc2d86a142906c30e375772df4516d?s=128&d=identicon&r=PG&f=1", "display_name": "Breadhead", "link": "https://stackoverflow.com/users/11489816/breadhead"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1560300691, "post_id": 56553062, "comment_id": 99688007, "body": "I have a readystate complete loop built in that also has worked on other applications."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1560326902, "post_id": 56553062, "comment_id": 99695077, "body": "Can you provide the url?"}, {"owner": {"reputation": 21, "user_id": 11489816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfc2d86a142906c30e375772df4516d?s=128&d=identicon&r=PG&f=1", "display_name": "Breadhead", "link": "https://stackoverflow.com/users/11489816/breadhead"}, "edited": false, "score": 0, "creation_date": 1560380791, "post_id": 56553062, "comment_id": 99721589, "body": "<a href=\"https://www.tipranks.com/stocks/mmm/stock-analysis\" rel=\"nofollow noreferrer\">tipranks.com/stocks/mmm/stock-analysis</a> I am trying to pull the &quot;smart score&quot; rating, the large number in the upper left"}, {"owner": {"reputation": 21, "user_id": 11489816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfc2d86a142906c30e375772df4516d?s=128&d=identicon&r=PG&f=1", "display_name": "Breadhead", "link": "https://stackoverflow.com/users/11489816/breadhead"}, "edited": false, "score": 0, "creation_date": 1560442326, "post_id": 56553062, "comment_id": 99747251, "body": "Solved. The classname had an underscore, that was actually  2 underscores. __ vs _, hard to tell the difference. Nested getelementsbytagname did the trick."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 11489816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfc2d86a142906c30e375772df4516d?s=128&d=identicon&r=PG&f=1", "display_name": "Breadhead", "link": "https://stackoverflow.com/users/11489816/breadhead"}, "is_accepted": false, "score": 0, "last_activity_date": 1560442337, "creation_date": 1560442337, "answer_id": 56584642, "question_id": 56553062, "link": "https://stackoverflow.com/questions/56553062/how-to-pull-tspan-elements-from-html-code-in-vba-webscraping/56584642#56584642", "title": "How to pull &lt;tspan&gt; elements from HTML code in VBA webscraping", "body": "<p>Solved. The classname had an underscore, that was actually  2 underscores. __ vs _, hard to tell the difference. Nested getelementsbytagname did the trick.</p>\n"}, {"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": false, "score": 0, "last_activity_date": 1560453331, "creation_date": 1560453331, "answer_id": 56587213, "question_id": 56553062, "link": "https://stackoverflow.com/questions/56553062/how-to-pull-tspan-elements-from-html-code-in-vba-webscraping/56587213#56587213", "title": "How to pull &lt;tspan&gt; elements from HTML code in VBA webscraping", "body": "<p>Alternatively, you may also be able to use the querySelector method...</p>\n\n<pre><code>text = IE.document.querySelector(\"tspan[text-anchor='middle']\").innerText\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1561023910, "creation_date": 1561023910, "answer_id": 56683216, "question_id": 56553062, "link": "https://stackoverflow.com/questions/56553062/how-to-pull-tspan-elements-from-html-code-in-vba-webscraping/56683216#56683216", "title": "How to pull &lt;tspan&gt; elements from HTML code in VBA webscraping", "body": "<p>Here is a more direct and quicker way</p>\n\n<pre><code>Option Explicit\nPublic Sub GetData()\n    Dim ie As Object\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.tipranks.com/stocks/mmm/stock-analysis\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        Do 'could use timed loop here to handle infinite looping risk\n            Set elem = .document.querySelectorAll(\"tspan\")\n        Loop While elem.Length = 0\n        Debug.Print elem.item(0).innerText\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11489816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cfc2d86a142906c30e375772df4516d?s=128&d=identicon&r=PG&f=1", "display_name": "Breadhead", "link": "https://stackoverflow.com/users/11489816/breadhead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2804, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1591054155, "creation_date": 1560297849, "last_edit_date": 1560300830, "question_id": 56553062, "link": "https://stackoverflow.com/questions/56553062/how-to-pull-tspan-elements-from-html-code-in-vba-webscraping", "title": "How to pull &lt;tspan&gt; elements from HTML code in VBA webscraping", "body": "<p>I am trying to pull data from a webpage using HTML webscraping with VBA. I have been successful on other sites, but this one has the data within a line of code labeled tspan and I can't seem to get the data out of it. </p>\n\n<p>The HTML code looks like this (sorry for long code, not sure what is and isn't relevant):</p>\n\n<pre><code>&lt;div class=\"Classname\"&gt;\n    &lt;svg width =\"100%\" height=\"100%\" fill=\"code\" stroke=\"100%\" stroke=\"code\" viewBox=\"numbers\" class=\"undefined\"&gt;\n         &lt;polygon fill=\"transparent\" points=\"numbers\"&gt;&lt;/polygon?\n             &lt;text y=\"100\" dy=\"#s\"&gt;\n                &lt;tspan x=\"100\" text-anchor=\"middle\"&gt;1&lt;/tspan&gt;\n</code></pre>\n\n<p>The value I want is the 1 in the last line before . The code I am using to extract it after navigating to the correct webpage, etc, is:</p>\n\n<pre><code>Dim text As String\ntext=IE.document.GetElementsByClassname(\"Classname\")(0).GetElementsByTagname(\"tspan\")(0).innertext\n</code></pre>\n\n<p>I have also tried where the classname is \"undefined\" as it appears in the svg code line. I am getting error 91 either way. </p>\n\n<p>Edit: I have now tried nested GetElementsByTagName, still getting error</p>\n\n<pre><code>text=IE.document.GetElementsByClassname(\"C\")(0).GetElementsByTagname(\"svg\")(0).GetElementsByTagname(\"polygon\")(0).GetElementsByTagname(\"text\")(0).GetElementsByTagname(\"tspan\")(0).innertext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1560292818, "post_id": 56552455, "comment_id": 99686570, "body": "Use <code>match</code>. Are the dates in row 1 actual dates formatted to show mm/yy or have they been entered as text?"}, {"owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1560299965, "post_id": 56552455, "comment_id": 99687886, "body": "it&#39;s in dd/mm/yyyy but format to show like mm/yy"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1560332347, "post_id": 56552455, "comment_id": 99698080, "body": "Then simply something like <code>application.match(CLng(Date), Rows(1), 0)</code>"}, {"owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1560809548, "post_id": 56552455, "comment_id": 99849814, "body": "@Rory, So i put <code>Range(&quot;A2&quot;) = Application.Match(CLng(Date), Rows(1), 0)</code>  I get N/A..."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1560294524, "post_id": 56552611, "comment_id": 99686984, "body": "I think the easier way to do it is <code>=MATCH(A3,$1:$1,1)</code>, since the dates are in ascending order."}, {"owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "edited": false, "score": 0, "creation_date": 1560300887, "post_id": 56552611, "comment_id": 99688039, "body": "4/13/2019 is just an example. Need to go off of today&#39;s date 6/11/2019 (today&#39;s date should be baked into a formula). And returns 6, column F"}], "tags": [], "owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "is_accepted": false, "score": -2, "last_activity_date": 1560294154, "last_edit_date": 1560294154, "creation_date": 1560293622, "answer_id": 56552611, "question_id": 56552455, "link": "https://stackoverflow.com/questions/56552455/getting-current-date-and-return-as-integer/56552611#56552611", "title": "Getting Current Date and Return as Integer?", "body": "<p>I had to redo my answer after messing with the data. this is what i ended up with.</p>\n\n<p>On Row 1 I entered the dates as: 1/1/2019, 2/1/2019, 3/1/2019... and custom formatted the row to only show it as mm/yy.</p>\n\n<p>With the formula below I grab the month and year from the given date and convert it into the first of the month. I am very positive there is a better way to make it but my brain is fried for the day.</p>\n\n<p><code>=MATCH(NUMBERVALUE(TEXT(A3,\"mm\")&amp;\"/1/\"&amp;TEXT(A3,\"yy\")),$1:$1,0)</code></p>\n\n<p>Edit: (Edit formula to make it permanent on Row 1 [$1:$1])</p>\n\n<p>Assuming that the date 4/13/2019 is on Cell A3</p>\n\n<p><a href=\"https://i.stack.imgur.com/Sd8WD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Sd8WD.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "edited": false, "score": 0, "creation_date": 1560297566, "post_id": 56552997, "comment_id": 99687510, "body": "Can we use EOMONTH function for the dates?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "edited": false, "score": 0, "creation_date": 1560297722, "post_id": 56552997, "comment_id": 99687531, "body": "I suppose you could use <code>colDate = WorksheetFunction.EoMonth(InputDate, -1) + 1</code> instead of <code>colDate = InputDate - Day(InputDate) + 1</code>, but not really sure if it would really make much of a difference."}, {"owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "edited": false, "score": 0, "creation_date": 1560301103, "post_id": 56552997, "comment_id": 99688082, "body": "So with this the DateCol will return a value (integer)? So I can use it like this <code>For DateCol to DateCol + 6</code> basically range from today to 6 months out (6/19 ~ 1/20)"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "edited": false, "score": 0, "creation_date": 1560306456, "post_id": 56552997, "comment_id": 99688922, "body": "Yes that is correct. But it requires an argument, the date. <code>For i = DateCol(Date) To DateCol(Date) + 6</code>. Not only is <code>Date</code> a data type, it\u2019s also a VBA function that returns today\u2019s date, same as the worksheet function <code>Today()</code>."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": -1, "last_activity_date": 1560297526, "last_edit_date": 1560297526, "creation_date": 1560297124, "answer_id": 56552997, "question_id": 56552455, "link": "https://stackoverflow.com/questions/56552455/getting-current-date-and-return-as-integer/56552997#56552997", "title": "Getting Current Date and Return as Integer?", "body": "<p>It appears OP was looking for a VBA solution, so here is an alternative.</p>\n\n<p>I can think of a few completely different methods of accomplishing this within VBA. Your question isn't very clear of what you are wanting the end result to be, but it appears you are looking for a function that will return the column number - perhaps so you can use to pinpoint a range.</p>\n\n<pre><code>Function DateCol(ByVal InputDate As Date) As Long\n\n    Dim colDate As Date\n    colDate = InputDate - Day(InputDate) + 1\n\n    Dim srcRng As Range\n    Set srcRng = ThisWorkbook.Worksheets(\"Sheet1\").Rows(1)\n\n    DateCol = srcRng.Find(What:=colDate, LookAt:=xlWhole).Column\n\nEnd Function\n</code></pre>\n\n<p>You simply take an input date, subtract the days (and add 1 since the first day of the month isn't <code>0</code>). Then you take this new date and use the <code>.Find()</code> method to locate the range that contains your date on the worksheet, and finally the <code>.Column</code> property to get the number you are looking for.</p>\n\n<p>Here is a small sample usage:</p>\n\n<pre><code>Sub test()\n\n    ' Example Usage\n    Cells(10, DateCol(#6/11/2019#)).Value = \"Test\"\n\nEnd Sub\n</code></pre>\n\n<p>In the above test sub, the <code>DateCol()</code> function would have returned the value of <code>6</code> in your sample worksheet, making the result:</p>\n\n<pre><code>Cells(10, 6).Value = \"Test\"\n</code></pre>\n\n<hr>\n\n<p>Only issue is that this function doesn't contain any error handling. You will raise an error if the date is not found in <code>.Find()</code>, so ensure that you take this into consideration.</p>\n\n<p>Also, don't forget to change this line to use the true Worksheet:</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Sheet1\").Rows(1)\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 56552997, "answer_count": 2, "score": 1, "last_activity_date": 1560324072, "creation_date": 1560292362, "last_edit_date": 1560324072, "question_id": 56552455, "link": "https://stackoverflow.com/questions/56552455/getting-current-date-and-return-as-integer", "title": "Getting Current Date and Return as Integer?", "body": "<p>I have a date like this (mm/yy) in row 1<br>\n<code>A    B    C    D    E    F \n1/19 2/19 3/19 4/19 5/19 6/19 ...</code></p>\n\n<p>I want the VBA to recognize today's date and match it to current column and return as integer.<br>\nIgnoring the days (only matching month and year).  </p>\n\n<p>For example, if today is <strong>4/13/2019</strong>, it would be <strong>4</strong> (column D)</p>\n\n<p>I would need this in VBA because I will be using it to define a range:<br>\n<code>For today To x month</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1560388124, "post_id": 56552265, "comment_id": 99722811, "body": "Gideon could not understand question clearly as 1.you have given two sets of code. which one is to be modified? 2. What output you require. you said want to append last row only while file names are in first row only? May please provide sample desired output."}, {"owner": {"reputation": 39, "user_id": 11502082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d782fe1a38818f81bb4c22114fb45a7?s=128&d=identicon&r=PG&f=1", "display_name": "Gideon G", "link": "https://stackoverflow.com/users/11502082/gideon-g"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1560399247, "post_id": 56552265, "comment_id": 99724730, "body": "Hi @Ahamed AU, so i tried to modify 2nd code by adding the 1st code above after DO while....to be able to add the txt file name in the first column of the worksheet , FYI the filename is also found in the first row (5100) of the txt i.e.Z:******\\filename.txt  desired output ( Fixed width columns) e.g. row 5010 in sample data above would be;   filename 5010 Latitude 034.0564687&#176; N. Then any subsequent imports should append to the same worksheet with corresponding txt file names"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11502082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d782fe1a38818f81bb4c22114fb45a7?s=128&d=identicon&r=PG&f=1", "display_name": "Gideon G", "link": "https://stackoverflow.com/users/11502082/gideon-g"}, "edited": false, "score": 0, "creation_date": 1560637119, "post_id": 56606117, "comment_id": 99803517, "body": "Thanks @Ahamed AU, tested code and while it loops and gets the rows required, there are 3 issues with it;"}, {"owner": {"reputation": 39, "user_id": 11502082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d782fe1a38818f81bb4c22114fb45a7?s=128&d=identicon&r=PG&f=1", "display_name": "Gideon G", "link": "https://stackoverflow.com/users/11502082/gideon-g"}, "edited": false, "score": 0, "creation_date": 1560638479, "post_id": 56606117, "comment_id": 99803749, "body": "Thanks @Ahamed AU, tested code and while it loops and gets the rows required, there are 3 issues with it; 1) Column 1 is blank, txt filename is not imported 2) When i import new txt files, rows that exist in the worksheet gets over-written if identical TestNo. already exists in the worksheet. 3) When i select multiple txt files to import at the same, the last row (last TestNo.) in each file is omitted. Could it be because the filename as a unique identifier is not getting populated?"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 39, "user_id": 11502082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d782fe1a38818f81bb4c22114fb45a7?s=128&d=identicon&r=PG&f=1", "display_name": "Gideon G", "link": "https://stackoverflow.com/users/11502082/gideon-g"}, "edited": false, "score": 0, "creation_date": 1560641397, "post_id": 56606117, "comment_id": 99804182, "body": "@Gideon G I think you tested the code before editing (11 hrs ago). 1. The code edited for working with file name both with or without full path. 2. The code is designed to overwrite (starting from Row 7) . Editing again for appending. . 3. it is working OK with sample data."}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 0, "last_activity_date": 1560641596, "last_edit_date": 1560641596, "creation_date": 1560554622, "answer_id": 56606117, "question_id": 56552265, "link": "https://stackoverflow.com/questions/56552265/import-txt-files-onto-single-worksheet-and-add-filename-in-column-1/56606117#56606117", "title": "Import txt files onto single worksheet and add filename in column 1", "body": "<p>May try the Code below</p>\n\n<pre><code>Sub testNewFormat()\nDim Fno As Integer, Ln As String, Arr As Variant, RawArr As Variant\nDim TestNo As String, TestID As String, Wheel As String\nDim PrvTestNo As String, PrvTestID As String\nDim Rw As Long, FileNameLen As Integer\nDim Ws As Worksheet\nDim MyFile As Variant\nSet Ws = ThisWorkbook.ActiveSheet\n\nWith Application.FileDialog(msoFileDialogFilePicker)\n   .AllowMultiSelect = True\n   'Delete next line if file extention are not .sks\n   .Filters.Add \"SKS Files\", \"*.sks\", 1\n\n    If .Show &lt;&gt; -1 Then Exit Sub\n    Rw = 6\n   'Next line would append data in excel File instead of Overwriting\n   'Delete the line if want to overwrite Excel data\n    Rw = Ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For Each MyFile In .SelectedItems\n    Fno = FreeFile\n    Open MyFile For Input As #Fno\n\n    PrvTestID = \"\"\n    PrvTestNo = \"\"\n    TestID = \"\"\n    TestNo = \"\"\n    Wheel = \"\"\n\n        Do While Not EOF(Fno)    ' Loop until end of file.\n        Line Input #Fno, Ln    ' Read line into variable.\n        Arr = Split(Ln, \",\")\n           If UBound(Arr) = 1 And Trim(Arr(0)) = \"5100\" And InStr(1, UCase(Arr(1)), \".TXT\") &gt; 0 And InStr(1, Arr(1), \":\") &gt; 0 Then 'Test ID or FileNAme\n                'FileName with Full Path wiyhout extension (.Txt)\n                If InStr(1, UCase(Arr(1)), \".TXT\") &gt; InStr(1, Arr(1), \":\") Then\n                TestID = Mid(Arr(1), InStr(1, Arr(1), \":\") + 1, InStr(1, UCase(Arr(1)), \".TXT\") - InStr(1, Arr(1), \":\") - 1)\n                TestID = Trim(TestID)\n                End If\n                'FileName Stripped off Full Path And extension (.Txt)\n                If InStr(1, TestID, \"\\\") &gt; 0 Then\n                TestID = Right(TestID, Len(TestID) - InStrRev(TestID, \"\\\"))\n                End If\n\n                If PrvTestID &lt;&gt; TestID Then\n                Rw = Rw + 1\n                Ws.Cells(Rw, 1).Value = TestID\n                Ws.Cells(Rw, 2).Value = TestNo\n                PrvTestID = TestID\n                End If\n           End If\n\n            If UBound(Arr) &gt;= 2 Then\n              Select Case Trim(Arr(0))\n              Case \"5000\"        'TestNo\n              TestNo = Arr(2)\n                    If PrvTestNo &lt;&gt; TestNo Then\n                    If PrvTestNo &lt;&gt; \"\" Then Rw = Rw + 1\n                    Ws.Cells(Rw, 1).Value = TestID\n                    Ws.Cells(Rw, 2).Value = TestNo\n                    PrvTestNo = TestNo\n                    End If\n\n                Case \"5005\"  'Distance\n                Ws.Cells(Rw, 3).Value = Arr(2)\n                Case \"5006\"    'Start Hr\n                Ws.Cells(Rw, 4).Value = Arr(2)\n                Case \"5007\"    'Start min\n                Ws.Cells(Rw, 5).Value = Arr(2)\n                Case \"5008\"    'Wheel\n                Wheel = Arr(2)\n                Ws.Cells(Rw, 6).Value = Wheel\n                Case \"5009\"    'WetDry\n                Ws.Cells(Rw, 7).Value = Arr(2)\n                Case \"5010\"    'Lat\n                Ws.Cells(Rw, 14).Value = Arr(2)\n                Case \"5011\"   'Long\n                Ws.Cells(Rw, 15).Value = Arr(2)\n                Case \"6001\"    'Surface Temp\n                Ws.Cells(Rw, 13).Value = Arr(2)\n                End Select\n\n                If Wheel = \"Right\" Then\n                    Select Case Arr(0)\n                    Case \"6060\"          'SN Average\n                    Ws.Cells(Rw, 9).Value = Arr(2)\n                    Case \"6061\"          'SN Min\n                    Ws.Cells(Rw, 10).Value = Arr(2)\n                    Case \"6062\"          'SN MAx\n                    Ws.Cells(Rw, 11).Value = Arr(2)\n                    Case \"6063\"          'SN St Dev\n                    Ws.Cells(Rw, 12).Value = Arr(2)\n                    Case \"6064\"          'Speed Avg\n                    Ws.Cells(Rw, 8).Value = Arr(2)\n                    End Select\n                Else\n                    Select Case Arr(0)\n                    Case \"6080\"          'SN Average\n                    Ws.Cells(Rw, 9).Value = Arr(2)\n                    Case \"6081\"          'SN Min\n                    Ws.Cells(Rw, 10).Value = Arr(2)\n                    Case \"6082\"          'SN MAx\n                    Ws.Cells(Rw, 11).Value = Arr(2)\n                    Case \"6083\"          'SN St Dev\n                    Ws.Cells(Rw, 12).Value = Arr(2)\n                    Case \"6084\"          'Speed Avg\n                    Ws.Cells(Rw, 8).Value = Arr(2)\n                    End Select\n                End If\n            End If\n        Loop\nClose #Fno\n\nNext MyFile\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>the code edited for working with file name both with or without full path.</p>\n\n<p>Output from  sample data</p>\n\n<p><a href=\"https://i.stack.imgur.com/qfENc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qfENc.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 39, "user_id": 11502082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d782fe1a38818f81bb4c22114fb45a7?s=128&d=identicon&r=PG&f=1", "display_name": "Gideon G", "link": "https://stackoverflow.com/users/11502082/gideon-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 56606117, "answer_count": 1, "score": 0, "last_activity_date": 1560641596, "creation_date": 1560290891, "last_edit_date": 1560592054, "question_id": 56552265, "link": "https://stackoverflow.com/questions/56552265/import-txt-files-onto-single-worksheet-and-add-filename-in-column-1", "title": "Import txt files onto single worksheet and add filename in column 1", "body": "<p>I'm new in VBA coding, I recieve raw field data text files from survey equipment i would like arranged in a summary table in a new worksheet; i have a code to import multiple text files by appending each file into a single table, however the raw data files contain too many rows not required in the summary. Out of approximately 1000 rows output in each text file, only 16 are needed for my summary table. The data is arranged based on each test No, therefore 'ROWIDs' in 'column 2' are identical for the metrics reported. </p>\n\n<p>I would like help creating code to add txt filename without .txt during import, i.e 'Filename1'  on each row in column 1 for records imported from the specific txt file and to loop through the raw data sheet based on 'Column 1' as 'TestID' , 'Column 2' as 'ROWID' then copy values in the 'Column 4' into summary sheet, sample output below, \n- Also would like code to just append new imported txt files at the last row in the same worksheet. \n@Ahamed AU your help so far is greatly appreciated!!</p>\n\n<pre><code>5100,FILE NAME &amp; SYSTEM MODEL              : Z:\\FRICTION\\FRICTION_2019\\TESTING\\test_file\\filename1.txt  1295 PAVEMENT FRICTION TESTER (UNIVERSAL)\n5101,SOFTWARE VERSION                      : 1.0.6506.22298\n5101A,VCU SOFTWARE VERSION                 : 8000908.601.007a\n5102,TIME                       (hh:mm:ss) : 11:44:13\n5103,DATE                     (mm/dd/yyyy) : 01/22/2019\n5104,SYSTEM UNITS                          : US (ENGLISH)\n5105,TEST TYPE                             : STANDARD\n5106,TARGET SPEED                    (mph) : 40.0\n5107,TEST WHEEL                            : LEFT\n5108,TEST LUBRICANT                        : WET\n5109,DATA FILTER                           : 5 POINTS\n5110,CYCLE TYPE                            : MANUAL\n5111,CYCLE DWELL DISTANCE             (ft) : 528.0\n5112,WATER CONTROL                         : WATER OFF AFTER TEST\n5113,NOZZLE CONTROL                        : RAISE NOZZLE ON BACKUP\n5114,TIME PARAMETER - T1         (seconds) : 0.500\n5115,TIME PARAMETER - T2         (seconds) : 2.000\n5116,TIME PARAMETER - T3         (seconds) : 0.500\n5117,TIME PARAMETER - T4         (seconds) : 1.000\n5118,TIME PARAMETER - T5         (seconds) : 0.100\n5145,VEHICLE ENCODER SF         (in/pulse) : 0.47803\n5146,LEFT ENCODER SF            (in/pulse) : 0.50493\n5147,RIGHT ENCODER SF           (in/pulse) : 0.49165\n5148,ENCODER CAL LENGTH               (ft) : 1056.0\n5149,ENCODER CALIBRATION TIME   (hh:mm:ss) : 13:39:28\n5150,ENCODER CALIBRATION DATE (mm/dd/yyyy) : 01/09/2019\n5151,TRAILER WHEEL WEIGHT             (lb) : 1085.00\n5152,FORCE TRANSDUCERS                     : LEFT\n5153,LEFT TRACTION CAL VALUE          (lb) : 455.00\n5154,LEFT LOAD CAL VALUE              (lb) : 466.00\n5155,LEFT TRACTION GAIN          (lb/volt) : 500.607\n5156,LEFT TRACTION OFFSET             (lb) : -11.542\n5157,LEFT LOAD GAIN              (lb/volt) : 499.589\n5158,LEFT LOAD OFFSET                 (lb) : -23.584\n5159,RIGHT TRACTION CAL VALUE         (lb) : 450.00\n5160,RIGHT LOAD CAL VALUE             (lb) : 450.00\n5161,RIGHT TRACTION GAIN         (lb/volt) : 495.000\n5162,RIGHT TRACTION OFFSET            (lb) : 6.199\n5163,RIGHT LOAD GAIN             (lb/volt) : 495.000\n5164,RIGHT LOAD OFFSET                (lb) : 18.799\n5165,SYSTEM CALIBRATION TIME    (hh:mm:ss) : 11:38:03\n5166,SYSTEM CALIBRATION DATE  (mm/dd/yyyy) : 01/22/2019\n5167,SPEED RANGE TOLERANCE       (+/- mph) : 1.5\n5168,WATER DEPTH SETTING              (mm) : 0.5\n0000,=================================================================\n0000, Test Summary Values              , Value         , Units\n0000,-----------------------------------------------------------------\n5000, Test Number                      , 1             , \n5001, Route                            ,               , \n5002, Direction                        ,               , \n5003, Lane                             ,               , \n5004, Event                            ,               , \n5005, Test Start DMI                   , 0.00          , ft\n5006, Test Start Time (Hr)             , 11            , hr\n5007, Test Start Time (Min)            , 40            , minute\n5008, Test Wheel                       , Left          , \n5009, Test Wet/Dry                     , WET           , \n5010, Latitude                         , 034.0564687\u00b0 N, \n5011, Longitude                        , 084.3002236\u00b0 W, \n5012, Bearing                          , 179.9         , degrees\n6000, Air Temperature                  , -3.5          , f\n6001, Surface Temperature              , 55.6          , f\n6002, Left Tire Temperature            , not installed , f\n6003, Left Nozzle Water Temperature    , 0.0           , f\n6004, Right Tire Temperature           , not installed , f\n6005, Right Nozzle Water Temperature   , not installed , f\n\n5100,FILE NAME &amp; SYSTEM MODEL              : Filename2.txt 1295 PAVEMENT FRICTION TESTER (UNIVERSAL)\n5101,SOFTWARE VERSION                      : 1.0.6506.22298\n5101A,VCU SOFTWARE VERSION                 : 8000908.601.007a\n5102,TIME                       (hh:mm:ss) : 11:44:13\n5103,DATE                     (mm/dd/yyyy) : 01/22/2019\n5104,SYSTEM UNITS                          : US (ENGLISH)\n5105,TEST TYPE                             : STANDARD\n5106,TARGET SPEED                    (mph) : 40.0\n5107,TEST WHEEL                            : LEFT\n5108,TEST LUBRICANT                        : WET\n5109,DATA FILTER                           : 5 POINTS\n5110,CYCLE TYPE                            : MANUAL\n5111,CYCLE DWELL DISTANCE             (ft) : 528.0\n5112,WATER CONTROL                         : WATER OFF AFTER TEST\n5113,NOZZLE CONTROL                        : RAISE NOZZLE ON BACKUP\n5114,TIME PARAMETER - T1         (seconds) : 0.500\n5115,TIME PARAMETER - T2         (seconds) : 2.000\n5116,TIME PARAMETER - T3         (seconds) : 0.500\n5117,TIME PARAMETER - T4         (seconds) : 1.000\n5118,TIME PARAMETER - T5         (seconds) : 0.100\n5119,DMI UNITS                             : FEET\n5120,DMI COUNT DIRECTION                   : UP\n5121,DMI REFERENCE START              (ft) : 0.000\n5122,START MODE                            : START TEST BY PENDANT AT DMI START\n5123,START DISTANCE                   (ft) : 100.000\n5124,DISPLAY PARAMETER                     : SN AVERAGE\n5125,DISPLAY SETTING                       : TEST SAMPLES GRAPH\n5126,SUMMARY DATA STORAGE                  : ON\n5127,RAW DATA STORAGE                      : ON\n5128,PRINTING                              : OFF\n5129,PUMP SOURCE                           : LEFT PUMP = TANK 1   RIGHT PUMP = TANK 1\n5130,FLOW METER 1 GAIN          (gpm/volt) : 9.500\n5131,FLOW METER 1 OFFSET             (gpm) : 0.000\n5134,AIR TEMPERATURE GAIN         (f/volt) : 13.999\n5135,AIR TEMPERATURE OFFSET            (f) : 0.001\n5136,SURFACE TEMPERATURE GAIN     (f/volt) : 22.500\n5137,SURFACE TEMPERATURE OFFSET        (f) : -85.000\n5140,GPS INSTALLED                         : YES\n5141A,TANK1 TEMPERATURE GAIN      (f/volt) : 21.996\n5141B,TANK1 TEMPERATURE OFFSET         (f) : 0.001\n5145,VEHICLE ENCODER SF         (in/pulse) : 0.47803\n5146,LEFT ENCODER SF            (in/pulse) : 0.50493\n5147,RIGHT ENCODER SF           (in/pulse) : 0.49165\n5148,ENCODER CAL LENGTH               (ft) : 1056.0\n5149,ENCODER CALIBRATION TIME   (hh:mm:ss) : 13:39:28\n5150,ENCODER CALIBRATION DATE (mm/dd/yyyy) : 01/09/2019\n5151,TRAILER WHEEL WEIGHT             (lb) : 1085.00\n5152,FORCE TRANSDUCERS                     : LEFT\n5153,LEFT TRACTION CAL VALUE          (lb) : 455.00\n5154,LEFT LOAD CAL VALUE              (lb) : 466.00\n5155,LEFT TRACTION GAIN          (lb/volt) : 500.607\n5156,LEFT TRACTION OFFSET             (lb) : -11.542\n5157,LEFT LOAD GAIN              (lb/volt) : 499.589\n5158,LEFT LOAD OFFSET                 (lb) : -23.584\n5159,RIGHT TRACTION CAL VALUE         (lb) : 450.00\n5160,RIGHT LOAD CAL VALUE             (lb) : 450.00\n5161,RIGHT TRACTION GAIN         (lb/volt) : 495.000\n5162,RIGHT TRACTION OFFSET            (lb) : 6.199\n5163,RIGHT LOAD GAIN             (lb/volt) : 495.000\n5164,RIGHT LOAD OFFSET                (lb) : 18.799\n5165,SYSTEM CALIBRATION TIME    (hh:mm:ss) : 11:38:03\n5166,SYSTEM CALIBRATION DATE  (mm/dd/yyyy) : 01/22/2019\n5167,SPEED RANGE TOLERANCE       (+/- mph) : 1.5\n5168,WATER DEPTH SETTING              (mm) : 0.5\n0000,=================================================================\n0000, Test Summary Values              , Value         , Units\n0000,-----------------------------------------------------------------\n5000, Test Number                      , 2             , \n5001, Route                            ,               , \n5002, Direction                        ,               , \n5003, Lane                             ,               , \n5004, Event                            ,               , \n5005, Test Start DMI                   , 29.36         , ft\n5006, Test Start Time (Hr)             , 11            , hr\n5007, Test Start Time (Min)            , 41            , minute\n5008, Test Wheel                       , Left          , \n5009, Test Wet/Dry                     , WET           , \n5010, Latitude                         , 034.0511896\u00b0 N, \n5011, Longitude                        , 084.3033369\u00b0 W, \n5012, Bearing                          , 201.9         , degrees\n6000, Air Temperature                  , -1.6          , f\n6001, Surface Temperature              , 49.9          , f\n6002, Left Tire Temperature            , not installed , f\n6003, Left Nozzle Water Temperature    , 0.0           , f\n6004, Right Tire Temperature           , not installed , f\n6005, Right Nozzle Water Temperature   , not installed , f\n6006, Tank 1 Water Temperature         , 0.0           , f\n6007, Tank 2 Water Temperature         , not installed , f\n6008, Tank 1 Water Level               , 353.3         , gal\n6009, Tank 2 Water Level               , not installed , gal\n6010, Data Filter                      , 5             , points\n6011, Water Depth                      , 0.5           , mm\n6012, Sampling Rate                    , 100           , hz\n0000,-----------------------------------------------------------------\n0000, Right Wheel Peak Values          , Value         , Units\n0000,-----------------------------------------------------------------\n6020, Right Traction Force             , 0.00          , lb\n6021, Right Load Force                 , 0.00          , lb\n6022, Right Vehicle Speed              , 0.0           , mph\n6023, Right Test Wheel Speed           , 0.0           , mph\n6024, Right SN                         , 0.00          , friction\n6025, Right Percent Slip               , 0.0           , percent\n6026, Right Time to Peak Brake Coef    , 0.00          , seconds\n6027, Right Time to Wheel Lockup       , 0.00          , seconds\n6028, Right Flow Rate                  , 0.0           , gpm\n0000,-----------------------------------------------------------------\n0000, Left Wheel Peak Values           , Value         , Units\n0000,-----------------------------------------------------------------\n6040, Left  Traction Force             , 880.60        , lb\n6041, Left  Load Force                 , 959.17        , lb\n6042, Left  Vehicle Speed              , 40.5          , mph\n6043, Left  Test Wheel Speed           , 36.0          , mph\n6044, Left  SN                         , 91.81         , friction\n6045, Left  Percent Slip               , 11.2          , percent\n6046, Left  Time to Peak Brake Coef    , 0.62          , seconds\n6047, Left  Time to Wheel Lockup       , 0.76          , seconds\n6048, Left  Flow Rate                  , 29.1          , gpm\n0000,-----------------------------------------------------------------\n0000, Right Wheel SN Values            , Value         , Units\n0000,-----------------------------------------------------------------\n6060, Right SN Average                 , 0.0           , friction\n6061, Right SN Minimum                 , 0.0           , friction\n6062, Right SN Maximum                 , 0.0           , friction\n6063, Right SN Standard Deviation      , 0.0           , friction\n6064, Right SN Speed Average           , 0.0           , mph\n6065, Right SN Flow Average            , 0.0           , gpm\n0000,-----------------------------------------------------------------\n0000, Left Wheel SN Values             , Value         , Units\n0000,-----------------------------------------------------------------\n6080, Left  SN Average                 , 53.4          , friction\n6081, Left  SN Minimum                 , 51.5          , friction\n6082, Left  SN Maximum                 , 55.5          , friction\n6083, Left  SN Standard Deviation      , 0.9           , friction\n6084, Left  SN Speed Average           , 40.0          , mph\n6085, Left  SN Flow Average            , 28.8          , gpm\n0000,=================================================================\n0000,=================================================================\n0000, Test Summary Values              , Value         , Units\n0000,-----------------------------------------------------------------\n5000, Test Number                      , 3             , \n5001, Route                            ,               , \n5002, Direction                        ,               , \n5003, Lane                             ,               , \n5004, Event                            ,               , \n5005, Test Start DMI                   , 411.62        , ft\n5006, Test Start Time (Hr)             , 11            , hr\n5007, Test Start Time (Min)            , 41            , minute\n5008, Test Wheel                       , Left          , \n5009, Test Wet/Dry                     , WET           , \n5010, Latitude                         , 034.0501615\u00b0 N, \n5011, Longitude                        , 084.3038254\u00b0 W, \n5012, Bearing                          , 201.1         , degrees\n6000, Air Temperature                  , -1.5          , f\n6001, Surface Temperature              , 54.6          , f\n6002, Left Tire Temperature            , not installed , f\n6003, Left Nozzle Water Temperature    , 0.0           , f\n6004, Right Tire Temperature           , not installed , f\n6005, Right Nozzle Water Temperature   , not installed , f\n6006, Tank 1 Water Temperature         , 0.0           , f\n6007, Tank 2 Water Temperature         , not installed , f\n6008, Tank 1 Water Level               , 326.0         , gal\n6009, Tank 2 Water Level               , not installed , gal\n6010, Data Filter                      , 5             , points\n6011, Water Depth                      , 0.5           , mm\n6012, Sampling Rate                    , 100           , hz\n0000,-----------------------------------------------------------------\n0000, Right Wheel Peak Values          , Value         , Units\n0000,-----------------------------------------------------------------\n6020, Right Traction Force             , 0.00          , lb\n6021, Right Load Force                 , 0.00          , lb\n6022, Right Vehicle Speed              , 0.0           , mph\n6023, Right Test Wheel Speed           , 0.0           , mph\n6024, Right SN                         , 0.00          , friction\n6025, Right Percent Slip               , 0.0           , percent\n6026, Right Time to Peak Brake Coef    , 0.00          , seconds\n6027, Right Time to Wheel Lockup       , 0.00          , seconds\n6028, Right Flow Rate                  , 0.0           , gpm\n0000,-----------------------------------------------------------------\n0000, Left Wheel Peak Values           , Value         , Units\n0000,-----------------------------------------------------------------\n6040, Left  Traction Force             , 814.08        , lb\n6041, Left  Load Force                 , 907.37        , lb\n6042, Left  Vehicle Speed              , 41.8          , mph\n6043, Left  Test Wheel Speed           , 37.7          , mph\n6044, Left  SN                         , 89.72         , friction\n6045, Left  Percent Slip               , 9.9           , percent\n6046, Left  Time to Peak Brake Coef    , 0.54          , seconds\n6047, Left  Time to Wheel Lockup       , 0.71          , seconds\n6048, Left  Flow Rate                  , 30.0          , gpm\n0000,-----------------------------------------------------------------\n0000, Right Wheel SN Values            , Value         , Units\n0000,-----------------------------------------------------------------\n6060, Right SN Average                 , 0.0           , friction\n6061, Right SN Minimum                 , 0.0           , friction\n6062, Right SN Maximum                 , 0.0           , friction\n6063, Right SN Standard Deviation      , 0.0           , friction\n6064, Right SN Speed Average           , 0.0           , mph\n6065, Right SN Flow Average            , 0.0           , gpm\n0000,-----------------------------------------------------------------\n0000, Left Wheel SN Values             , Value         , Units\n0000,-----------------------------------------------------------------\n6080, Left  SN Average                 , 49.9          , friction\n6081, Left  SN Minimum                 , 48.4          , friction\n6082, Left  SN Maximum                 , 51.5          , friction\n6083, Left  SN Standard Deviation      , 0.7           , friction\n6084, Left  SN Speed Average           , 41.4          , mph\n6085, Left  SN Flow Average            , 29.5          , gpm\n0000,=================================================================\n</code></pre>\n\n<p>expected output summary table;\n<a href=\"https://i.stack.imgur.com/W0iqf.png\" rel=\"nofollow noreferrer\">expected output summary table</a></p>\n"}, {"tags": ["excel", "vba", "macos", "export-to-pdf"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1560300363, "post_id": 56552181, "comment_id": 99687953, "body": "<i>I&#39;m getting runtime error</i> What runtime error? What is the error message? It&#39;s on the screen right in front of you, but we can&#39;t see your screen from here. You have useful information that should be in your post. Please <a href=\"https://stackoverflow.com/posts/56552181/edit\">edit</a> to put it there. Thanks."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1560300458, "post_id": 56552181, "comment_id": 99687966, "body": "BTW, the problem is most likely that a Mac doesn&#39;t have a <code>C:</code> drive and doesn&#39;t use backslashes as path separators. Don&#39;t hard-code a Windows only path and filename, because that path won&#39;t work on non-Windows machines."}, {"owner": {"reputation": 11, "user_id": 11633526, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UWcnPNGaMRY/AAAAAAAAAAI/AAAAAAABui4/DUjde8PEtQ8/photo.jpg?sz=128", "display_name": "Serdar Serhatli", "link": "https://stackoverflow.com/users/11633526/serdar-serhatli"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1560345734, "post_id": 56552181, "comment_id": 99706006, "body": "Thanks Ken, I made a mistake, ofcourse thereis no C: on my mac. I used this code on to my windows PC, it&#39;s working. Above code is not working properly on my mac. When I click the Save button, it&#39;s printing the pdf not saving it."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 10909105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ba412da1862136a70c6231dbd039934?s=128&d=identicon&r=PG&f=1", "display_name": "Irish", "link": "https://stackoverflow.com/users/10909105/irish"}, "is_accepted": false, "score": 0, "last_activity_date": 1599129911, "creation_date": 1599129911, "answer_id": 63722008, "question_id": 56552181, "link": "https://stackoverflow.com/questions/56552181/how-to-make-excel-vba-export-as-pdf-on-mac-computer/63722008#63722008", "title": "How to make Excel VBA Export as PDF on MAC computer", "body": "<p>I am not sure if this request is still valid, but I found a solution on</p>\n<p><a href=\"http://www.rondebruin.nl/mac/mac005.htm\" rel=\"nofollow noreferrer\">http://www.rondebruin.nl/mac/mac005.htm</a></p>\n<p>It appears that the export to PDF parameters react differently on mac than on windows PC and you need a workaround that saves the PDF into the users Library folder, specificially  into the Office Library folder. The key function is this</p>\n<pre><code>    Function CreateFolderinMacOffice2016(NameFolder As String) As String\n    'Function to create folder if it not exists in the Microsoft Office Folder\n    'Ron de Bruin : 1-Feb-2019\n    Dim OfficeFolder As String\n    Dim PathToFolder As String\n    Dim TestStr As String\n\n    OfficeFolder = MacScript(&quot;return POSIX path of (path to desktop folder) as string&quot;)\n    OfficeFolder = Replace(OfficeFolder, &quot;/Desktop&quot;, &quot;&quot;) &amp; _\n        &quot;Library/Group Containers/UBF8T346G9.Office/&quot;\n\n    PathToFolder = OfficeFolder &amp; NameFolder\n\n    On Error Resume Next\n    TestStr = Dir(PathToFolder &amp; &quot;*&quot;, vbDirectory)\n    On Error GoTo 0\n    If TestStr = vbNullString Then\n        MkDir PathToFolder\n        'You can use this msgbox line for testing if you want\n        'MsgBox &quot;You find the new folder in this location :&quot; &amp; PathToFolder\n    End If\n    CreateFolderinMacOffice2016 = PathToFolder\nEnd Function\n</code></pre>\n<p>Creating a folder using this function and directly using the returning value as file path will make it work.</p>\n<p>All credits to Ron de Bruin, I just copied this to help out. Visit his page for further examples.</p>\n"}], "owner": {"reputation": 11, "user_id": 11633526, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UWcnPNGaMRY/AAAAAAAAAAI/AAAAAAABui4/DUjde8PEtQ8/photo.jpg?sz=128", "display_name": "Serdar Serhatli", "link": "https://stackoverflow.com/users/11633526/serdar-serhatli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1599129911, "creation_date": 1560290218, "last_edit_date": 1593586805, "question_id": 56552181, "link": "https://stackoverflow.com/questions/56552181/how-to-make-excel-vba-export-as-pdf-on-mac-computer", "title": "How to make Excel VBA Export as PDF on MAC computer", "body": "<p>I have a macro code for my Excel document. I want to export the active sheet as a PDF file to the specific folder. Same code working on my Windows PC, but it doesn't work on my MAC pc.When I click the Save button, it's printing the pdf instead save it. I want to save it. If anybody can help me I will be very glad.</p>\n\n<pre><code>Sub Save_NEWPORT_ESTIMATE()\n\nIf Range(\"G1\") = \"INVOICE\" Then\n\nLigneIS = Application.CountA(Sheets(\"Invoice summary\").Range(\"A:A\"))\nSheets(\"Invoice summary\").Range(\"A\" &amp; LigneIS + 1) = Now\nSheets(\"Invoice summary\").Range(\"B\" &amp; LigneIS + 1) = Sheets(\"NANTUCKET ESTIMATE\").Range(\"H8\")\nSheets(\"Invoice summary\").Range(\"C\" &amp; LigneIS + 1) = \"NANTUCKET\"\nSheets(\"Invoice summary\").Range(\"D\" &amp; LigneIS + 1) = Sheets(\"NANTUCKET ESTIMATE\").Range(\"A12\")\nSheets(\"Invoice summary\").Range(\"E\" &amp; LigneIS + 1) = Sheets(\"NANTUCKET ESTIMATE\").Range(\"M49\")\n\nElse\n    LigneIS = Application.CountA(Sheets(\"Invoice summary\").Range(\"A:A\"))\n    Sheets(\"Estimate summary\").Range(\"A\" &amp; LigneIS + 1) = Now\n    Sheets(\"Estimate summary\").Range(\"B\" &amp; LigneIS + 1) = \n    Sheets(\"NANTUCKET ESTIMATE\").Range(\"H8\")\n    Sheets(\"Estimate summary\").Range(\"C\" &amp; LigneIS + 1) = \"NANTUCKET\"\n    Sheets(\"Estimate summary\").Range(\"D\" &amp; LigneIS + 1) = \n    Sheets(\"NANTUCKET ESTIMATE\").Range(\"A12\")\n    Sheets(\"Estimate summary\").Range(\"E\" &amp; LigneIS + 1) = \n    Sheets(\"NANTUCKET ESTIMATE\").Range(\"M49\")\n\nEnd If\n    D1 = Format(Date, \"ddmmyy\")\n    Customer = Left(Range(\"A12\"), 6)\n    Job = Range(\"G12\")\n    Tipe = Range(\"G1\")\n    Model = Range(\"G18\")\n\nIf Tipe = \"INVOICE\" Then\nTipe2 = \"1 SALES INVOICES\"\nElse\nTipe2 = \"1 ESTIMATES\"\nEnd If\n\nLien = \"/Users/macbookpro/Desktop/INVOICE/\" &amp; Tipe2\n\nChDir \"/Users/macbookpro/Desktop/INVOICE/\" &amp; Tipe2\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    Lien &amp; \"\\\" &amp; D1 &amp; \" \" &amp; Model &amp; \"_\" &amp; Customer &amp; \"_\" &amp; Job &amp; \"_\" &amp; Tipe &amp; \".pdf\", Quality:= _\n    xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _\n    OpenAfterPublish:=True\n\nEnd Sub\n\nSub Save_NANTUCKET_ESTIMATE()\n\nIf Range(\"G1\") = \"INVOICE\" Then\nLigneIS = Application.CountA(Sheets(\"Invoice summary\").Range(\"A:A\"))\nSheets(\"Invoice summary\").Range(\"A\" &amp; LigneIS + 1) = Now\nSheets(\"Invoice summary\").Range(\"B\" &amp; LigneIS + 1) = Sheets(\"NANTUCKET ESTIMATE\").Range(\"H8\")\nSheets(\"Invoice summary\").Range(\"C\" &amp; LigneIS + 1) = \"NANTUCKET\"\nSheets(\"Invoice summary\").Range(\"D\" &amp; LigneIS + 1) = Sheets(\"NANTUCKET ESTIMATE\").Range(\"A12\")\nSheets(\"Invoice summary\").Range(\"E\" &amp; LigneIS + 1) = Sheets(\"NANTUCKET ESTIMATE\").Range(\"M49\")\nElse\nLigneIS = Application.CountA(Sheets(\"Invoice summary\").Range(\"A:A\"))\nSheets(\"Estimate summary\").Range(\"A\" &amp; LigneIS + 1) = Now\nSheets(\"Estimate summary\").Range(\"B\" &amp; LigneIS + 1) = Sheets(\"NANTUCKET ESTIMATE\").Range(\"H8\")\nSheets(\"Estimate summary\").Range(\"C\" &amp; LigneIS + 1) = \"NANTUCKET\"\nSheets(\"Estimate summary\").Range(\"D\" &amp; LigneIS + 1) = Sheets(\"NANTUCKET ESTIMATE\").Range(\"A12\")\nSheets(\"Estimate summary\").Range(\"E\" &amp; LigneIS + 1) = Sheets(\"NANTUCKET ESTIMATE\").Range(\"M49\")\nEnd If\n\nD1 = Format(Date, \"ddmmyy\")\nCustomer = Left(Range(\"A12\"), 6)\nJob = Range(\"G12\")\nTipe = Range(\"G1\")\nModel = Range(\"G18\")\nIf Tipe = \"INVOICE\" Then\nTipe2 = \"1 SALES INVOICES\"\nElse\nTipe2 = \"1 ESTIMATES\"\nEnd If\n\nLien = \"/Users/macbookpro/Desktop/INVOICE/\" &amp; Tipe2\n\nChDir \"/Users/macbookpro/Desktop/INVOICE/\" &amp; Tipe2\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    Lien &amp; \"\\\" &amp; D1 &amp; \" \" &amp; Model &amp; \"_\" &amp; Customer &amp; \"_\" &amp; Job &amp; \"_\" &amp; Tipe &amp; \".pdf\", Quality:= _\n    xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _\n    OpenAfterPublish:=True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1560292743, "creation_date": 1560292743, "answer_id": 56552500, "question_id": 56552163, "link": "https://stackoverflow.com/questions/56552163/how-to-loop-a-formula-in-different-cells-in-excel-vba/56552500#56552500", "title": "How to loop a formula in different cells in excel vba?", "body": "<p>As a UDF:</p>\n\n<pre><code>Function SumAll(addr As String)\n    Application.Volatile\n    Dim ws As Worksheet, tot\n    For Each ws In ThisWorkbook.Worksheets\n        If ws.Name &lt;&gt; \"Data\" Then tot = tot + ws.Range(addr).Value\n    Next ws\n    SumAll = tot\nEnd Function\n</code></pre>\n\n<p>Then (eg) in A6 you can enter:</p>\n\n<pre><code>=SumAll(\"K6\")\n</code></pre>\n\n<p>or better:</p>\n\n<pre><code>Function SumAll(c As Range)\n    Application.Volatile\n    Dim ws As Worksheet, tot\n    For Each ws In ThisWorkbook.Worksheets\n        If ws.Name &lt;&gt; \"Data\" Then tot = tot + ws.Range(c.Address(False, False)).Value\n    Next ws\n    SumAll = tot\nEnd Function\n</code></pre>\n\n<p>then you can us (eg)</p>\n\n<pre><code>=SumAll(K6)\n</code></pre>\n\n<p>and it will adjust as you drag down</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 11359448, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B__-rg2LNsk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reQNFHKG8LhgniUCTQpbs6sB0ZvOw/mo/photo.jpg?sz=128", "display_name": "Jules-Henri Revault", "link": "https://stackoverflow.com/users/11359448/jules-henri-revault"}, "edited": false, "score": 0, "creation_date": 1560417604, "post_id": 56552537, "comment_id": 99732389, "body": "Works perfectly, thanks! I have the same question but with the following formula: Abs(E7)/K7. I want to calculate this formula on each sheet, and then have the average on the main sheet(Data) say in cell A1 for example"}, {"owner": {"reputation": 155, "user_id": 9941645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9371e128fc5994758c1ff3c12620e848?s=128&d=identicon&r=PG&f=1", "display_name": "SadMrFrown", "link": "https://stackoverflow.com/users/9941645/sadmrfrown"}, "reply_to_user": {"reputation": 15, "user_id": 11359448, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B__-rg2LNsk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reQNFHKG8LhgniUCTQpbs6sB0ZvOw/mo/photo.jpg?sz=128", "display_name": "Jules-Henri Revault", "link": "https://stackoverflow.com/users/11359448/jules-henri-revault"}, "edited": false, "score": 0, "creation_date": 1560461818, "post_id": 56552537, "comment_id": 99755361, "body": "@Jules-HenriRevault I have added a few lines in answer above, let me know if that answers your question."}, {"owner": {"reputation": 15, "user_id": 11359448, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B__-rg2LNsk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reQNFHKG8LhgniUCTQpbs6sB0ZvOw/mo/photo.jpg?sz=128", "display_name": "Jules-Henri Revault", "link": "https://stackoverflow.com/users/11359448/jules-henri-revault"}, "edited": false, "score": 0, "creation_date": 1560524364, "post_id": 56552537, "comment_id": 99777316, "body": "It\u2019s exactly what I was looking for. Thank you very much for your help!"}, {"owner": {"reputation": 155, "user_id": 9941645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9371e128fc5994758c1ff3c12620e848?s=128&d=identicon&r=PG&f=1", "display_name": "SadMrFrown", "link": "https://stackoverflow.com/users/9941645/sadmrfrown"}, "reply_to_user": {"reputation": 15, "user_id": 11359448, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B__-rg2LNsk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reQNFHKG8LhgniUCTQpbs6sB0ZvOw/mo/photo.jpg?sz=128", "display_name": "Jules-Henri Revault", "link": "https://stackoverflow.com/users/11359448/jules-henri-revault"}, "edited": false, "score": 0, "creation_date": 1560526739, "post_id": 56552537, "comment_id": 99778600, "body": "No problem. Glad I could help."}], "tags": [], "owner": {"reputation": 155, "user_id": 9941645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9371e128fc5994758c1ff3c12620e848?s=128&d=identicon&r=PG&f=1", "display_name": "SadMrFrown", "link": "https://stackoverflow.com/users/9941645/sadmrfrown"}, "is_accepted": true, "score": 0, "last_activity_date": 1560461777, "last_edit_date": 1560461777, "creation_date": 1560293023, "answer_id": 56552537, "question_id": 56552163, "link": "https://stackoverflow.com/questions/56552163/how-to-loop-a-formula-in-different-cells-in-excel-vba/56552537#56552537", "title": "How to loop a formula in different cells in excel vba?", "body": "<p>You could also have it as a sub which concatenates a string and you can use the <code>.Formula</code> property to assign it to a range. Excel will automatically update the formula. </p>\n\n<p>For example if you wanted A1 in \"Test\" to display the sum of K6 in all those worksheets whose name is not data, A2 to display all those with K7 etc.The following would work:</p>\n\n<pre><code>Sub test()\nDim str1 As String, str2 As String\nDim ws As Worksheet, i As Integer, j As Integer\n\n\nj = 0\n\n'As data pertains to one spreadsheets name\n\ni = ThisWorkbook.Worksheets.Count - 1\n\nFor Each ws In ThisWorkbook.Worksheets\nIf ws.Name &lt;&gt; \"Data\" Then\n    j = j + 1\n    If i - j = 0 Then\n        str1 = \"'\" &amp; ws.Name &amp; \"'!K6 \"\n    Else\n        str1 = \"'\" &amp; ws.Name &amp; \"'!K6, \"\n    End If\n    str2 = str2 &amp; str1\nEnd If\nNext ws\n\nThisWorkbook.Worksheets(\"Test\").Range(\"A1:A7\").Formula = \"=sum(\" &amp; str2 &amp; \")\"\n\n\nEnd Sub\n</code></pre>\n\n<p>The added bonus being that you can track your formula through your worksheet if that is of interest. </p>\n\n<p>For your query below, modify the if function with str1 to:</p>\n\n<pre><code>    If i - j = 0 Then\n        str1 = \"abs('\" &amp; ws.Name &amp; \"'!E6)/('\" &amp; ws.Name &amp; \"'!K6) \"\n    Else\n        str1 = \"abs('\" &amp; ws.Name &amp; \"'!E6)/('\" &amp; ws.Name &amp; \"'!K6), \"\n    End If\n</code></pre>\n\n<p>The last line should also change:</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Data\").Range(\"A1:A7\").Formula = \"=average(\" &amp; str2 &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11359448, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B__-rg2LNsk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reQNFHKG8LhgniUCTQpbs6sB0ZvOw/mo/photo.jpg?sz=128", "display_name": "Jules-Henri Revault", "link": "https://stackoverflow.com/users/11359448/jules-henri-revault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 56552537, "answer_count": 2, "score": 0, "last_activity_date": 1560461777, "creation_date": 1560290048, "question_id": 56552163, "link": "https://stackoverflow.com/questions/56552163/how-to-loop-a-formula-in-different-cells-in-excel-vba", "title": "How to loop a formula in different cells in excel vba?", "body": "<p>I have a piece of code where I sum the cell \"K6\" from every sheet of the workbook appart the main one called \"Data\". However it is hard coded and I would like to be able to loop it. Either this or establishing a formula and than extending it. I think it will be easier to see what I'm talking about by looking at the code</p>\n\n<p>This is what I have already</p>\n\n<pre><code>`Sub SumSheets()\n\nDim ws As Worksheet\n\nFor Each ws In ThisWorkbook.Worksheets\n\nIf ws.Name &lt;&gt; \"Data\" Then\n\nSumTotal = SumTotal + ws.Range(\"K6\").Value\nSumTotal2 = SumTotal + ws.Range(\"K7\").Value\nSumTotal3 = SumTotal + ws.Range(\"K8\").Value\nSumTotal4 = SumTotal + ws.Range(\"K9\").Value\n\nEnd If\n\nNext\n\nSheets(\"Data\").Range(\"A6\").FormulaR1C1 = SumTotal\nSheets(\"Data\").Range(\"A7\").FormulaR1C1 = SumTotal2\nSheets(\"Data\").Range(\"A8\").FormulaR1C1 = SumTotal3\nSheets(\"Data\").Range(\"A9\").FormulaR1C1 = SumTotal4\n\nEnd Sub'\n</code></pre>\n\n<p>This piece of code works like I want it to, but it would be much easier if I could find a way to loop it. Or maybe establish SumTotal as a function and extend it like in regular excel.</p>\n\n<pre><code>Sub SumSheets()\n\nDim ws As Worksheet\nDim i As Integer\nDim j As Integer\n\nFor Each ws In ThisWorkbook.Worksheets\n\nIf ws.Name &lt;&gt; \"Data\" Then\n\nSumTotal = SumTotal + ws.Range(\"K6\").Value\nSumTotal2 = SumTotal + ws.Range(\"K7\").Value\nSumTotal3 = SumTotal + ws.Range(\"K8\").Value\nSumTotal4 = SumTotal + ws.Range(\"K9\").Value\n\nFor i = SumTotal To SumTotal4\nFor j= 6 To 10\n\nCells(j,1).Value = i\n\nNext j\nNext i\n\nEnd If\n\nNext\n\nEnd Sub'\n</code></pre>\n\n<p>The result with the For Loop I tried is that it only put the value of SumTotal4 in cells 6 through ten. I'm guessing it's because i haven't defined i well enough.</p>\n"}, {"tags": ["excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1560290162, "post_id": 56552095, "comment_id": 99685924, "body": "Does your stored procedure return any records?  If not then you don&#39;t need a recordset.  Might also help to mention which line produces the error."}, {"owner": {"reputation": 1163, "user_id": 4932683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4FJQ.jpg?s=128&g=1", "display_name": "cyberponk", "link": "https://stackoverflow.com/users/4932683/cyberponk"}, "edited": false, "score": 0, "creation_date": 1560291016, "post_id": 56552095, "comment_id": 99686147, "body": "Have you tried <code>unload rs</code> instead of <code>rs.Close</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 11573565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b57cb1b39cae86c051f832c989bcf5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Wolf", "link": "https://stackoverflow.com/users/11573565/joe-wolf"}, "is_accepted": true, "score": 0, "last_activity_date": 1560355400, "creation_date": 1560355400, "answer_id": 56566308, "question_id": 56552095, "link": "https://stackoverflow.com/questions/56552095/getting-error-operation-is-not-allowed-when-the-object-is-closed-error-lookin/56566308#56566308", "title": "Getting error &quot;operation is not allowed when the object is closed&quot; error. Looking for a solution", "body": "<p>I included record sets in the code despite there being no data imported into excel.  After Tim Williams (user:478884) pointed out that I did not require a record set.  I removed the rs and other unnecessary code.  Code now reads:</p>\n\n<pre><code>Sub ImportProForma()\n\nDim rs As ADODB.Recordset\nDim cnSQL As ADODB.Connection\nDim sqlCommand As ADODB.Command, PKprm As Object\n\nDim PK As Integer\nPK = Range(\"D3\").Value\n\nSheets(\"UpdateProForma\").Select\nSet cnSQL = New ADODB.Connection\ncnSQL.Open \"Provider=SQLOLEDB; Integrated Security = sspi; Initial Catalog = [Database]; Data Source = [Server]\"\n\nSet sqlCommand = New ADODB.Command\nsqlCommand.ActiveConnection = cnSQL\nsqlCommand.CommandType = adCmdStoredProc\nsqlCommand.CommandText = \"ImportNewEntry\"\n\nSet PKprm = sqlCommand.CreateParameter(\"PrimaryKey\", adInteger, adParamInput)\nPKprm.Value = PK\n\nsqlCommand.Parameters.Append PKprm\nsqlCommand.Parameters(\"PrimaryKey\") = PK\n\nsqlCommand.Execute\nCells.Range(\"D5:D55\").ClearContents\n\nEnd Sub\n</code></pre>\n\n<p>I do not clear the data in D3 for PK, I have a vba function that auto increments the Primary Key.</p>\n"}], "owner": {"reputation": 19, "user_id": 11573565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b57cb1b39cae86c051f832c989bcf5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Wolf", "link": "https://stackoverflow.com/users/11573565/joe-wolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 56566308, "answer_count": 1, "score": 0, "last_activity_date": 1560355400, "creation_date": 1560289652, "last_edit_date": 1560337922, "question_id": 56552095, "link": "https://stackoverflow.com/questions/56552095/getting-error-operation-is-not-allowed-when-the-object-is-closed-error-lookin", "title": "Getting error &quot;operation is not allowed when the object is closed&quot; error. Looking for a solution", "body": "<p>Every time I run my vba file, I get the run time error 3704, Operation is not allowed when the object is closed.  Trying to fix this error.</p>\n\n<p>Messed around with connection types and other parameter types, but to no avail.  The goal of the code is to be a front end means for business to enter data into a SQL database.  Business does not want to have to leave excel for this.  The stored proc called in the vba code inputs data into a SQL database. I've verified the stored proc works in SQL.  The goal of the vba code is to call the stored proc and import the data to the sql database.  I've done this with a test DB and one var.  Now I have 27.  Trying to find the error.</p>\n\n<p>There are 27 vars, I did not include all of them.  I verified they all pull the correct data from excel.  I have also had others verify that the params are the correct params in SQL.</p>\n\n<pre><code>Sub ImportProForma()\n\nDim rs As ADODB.Recordset\nDim cnSQL As ADODB.Connection\nDim sqlCommand As ADODB.Command, PKprm As Object\n\nDim PK As Integer\nPK = Range(\"D3\").Value\n\nSheets(\"UpdateProForma\").Select\nSet cnSQL = New ADODB.Connection\ncnSQL.Open \"Provider=SQLOLEDB; Integrated Security = sspi; Initial Catalog = [Database]; Data Source = [Server]\"\n\nSet sqlCommand = New ADODB.Command\nsqlCommand.ActiveConnection = cnSQL\nsqlCommand.CommandType = adCmdStoredProc\n\nsqlCommand.CommandText = \"ImportNewEntry\"\n\nSet PKprm = sqlCommand.CreateParameter(\"PrimaryKey\", adInteger, adParamInput)\nPKprm.Value = PK\n\nsqlCommand.Parameters.Append PKprm\nsqlCommand.Parameters(\"PrimaryKey\") = PK\n\n\nSet rs = New ADODB.Recordset\nrs.CursorType = adOpenStatic\nrs.LockType = adLockOptimistic\nrs.Open sqlCommand\n\nrs.Close\nSet rs = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The final goal of this project is to be able to import data to SQL without having to have business leave excel.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1560288611, "post_id": 56551889, "comment_id": 99685435, "body": "I would start by using the search bar at the top and typing in: VBA add columns.  Then try something and when you get stuck, then come back here and post."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1560288742, "creation_date": 1560288742, "answer_id": 56551936, "question_id": 56551889, "link": "https://stackoverflow.com/questions/56551889/excel-vba-to-insert-missing-columns-based-from-a-list/56551936#56551936", "title": "Excel VBA to insert missing columns based from a list?", "body": "<p>This should work - note that it checks for the case to match.  It also doesn't know if the columns are out of order, simply adds in a missing one.</p>\n\n<pre><code>Sub t()\nDim headers() As Variant\nheaders = Array(\"FName\", \"LName\", \"Email\", \"Country\", \"Gender\")\n\nDim i As Long\nFor i = LBound(headers) To UBound(headers)\n    If Cells(1, i + 1).Value &lt;&gt; headers(i) Then\n        Columns(i + 1).EntireColumn.Insert\n        Cells(1, i + 1).Value = headers(i)\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11633246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124729f88537f5747f7ca8a061c61c69?s=128&d=identicon&r=PG&f=1", "display_name": "alfador", "link": "https://stackoverflow.com/users/11633246/alfador"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 56551936, "answer_count": 1, "score": 1, "last_activity_date": 1560289230, "creation_date": 1560288489, "last_edit_date": 1560289230, "question_id": 56551889, "link": "https://stackoverflow.com/questions/56551889/excel-vba-to-insert-missing-columns-based-from-a-list", "title": "Excel VBA to insert missing columns based from a list?", "body": "<p>So I'm very new to excel VBA so I'm hoping anyone can assist. </p>\n\n<p>I have an array with a list of column headers:</p>\n\n<p>Array = (\"FName\", \"LName\", \"Email\", \"Country\", \"Gender\")</p>\n\n<p>And then I have an excel sheet which already contains columns with headers. I want to compare my array with the headers in the excel sheet and for any missing header it will insert a new column.</p>\n\n<p>So for example, if the sheet only has these columns:</p>\n\n<p>FName | LName | Gender</p>\n\n<p>Then after running the sub, it will insert new columns that were missing:</p>\n\n<p>FName | LName | Gender | Email | Country</p>\n\n<p>Any help on how I can perform this with a macro?</p>\n\n<p>Thank you so much for any assistance that you can provide.</p>\n"}, {"tags": ["excel", "vba", "footer"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11633372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9395ae6b6d598d372182ac72bdd8e49a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/11633372/adrian"}, "edited": false, "score": 0, "creation_date": 1560332399, "post_id": 56551872, "comment_id": 99698102, "body": "Hi, problem exists when you share the template to another user and computer who does not have access to the file path name."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 11, "user_id": 11633372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9395ae6b6d598d372182ac72bdd8e49a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/11633372/adrian"}, "edited": false, "score": 0, "creation_date": 1560342780, "post_id": 56551872, "comment_id": 99704057, "body": "@Adrian OK, I think I misunderstood the question. So you have several options, I think, but I&#39;ll update with what is probably the easiest."}, {"owner": {"reputation": 432, "user_id": 2391873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9813e629bb4baf25e0eb9d250bd38722?s=128&d=identicon&r=PG", "display_name": "Ejaz Ahmed", "link": "https://stackoverflow.com/users/2391873/ejaz-ahmed"}, "edited": false, "score": 0, "creation_date": 1591497745, "post_id": 56551872, "comment_id": 110077233, "body": "I see what you mean. How can we reuse this image on a different computer?"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": -1, "last_activity_date": 1560350312, "last_edit_date": 1592644375, "creation_date": 1560288369, "answer_id": 56551872, "question_id": 56551559, "link": "https://stackoverflow.com/questions/56551559/assign-image-for-footer-to-excel-file-and-not-an-external-path/56551872#56551872", "title": "Assign image for footer to excel file and not an external path", "body": "<p>I misunderstood the question originally, but leaving this answer in case it's useful for others in the future. For reference, I misunderstood the problem statement to be like:</p>\n<blockquote>\n<p>I'm worried that if I create Header/Footer images from local file paths, that those images won't render when I distribute the file to someone else.</p>\n</blockquote>\n<p>This is not how Header/Footer data works, here's a lengthy explanation.</p>\n<p>I tested by adding a picture from a file path, and then <strong>deleting the picture from that location</strong> (<code>&quot;c:\\debug\\Leftfooter.png&quot;</code>). In other words, no file exists at the original file path. This should be essentially the same case as a co-worker with different drive mappings or permissions, etc.</p>\n<p>Upon re-opening the file, the footer image is still visible to me, even though it no longer exists on my hard drive:</p>\n<p><a href=\"https://i.stack.imgur.com/pq9QM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pq9QM.png\" alt=\"enter image description here\" /></a></p>\n<h1>If the file no longer exists, how does the image persist in Excel Footer?</h1>\n<p>Now, the image file exists <strong>within the XLSX's .ZIP archive</strong> as <code>xl\\media\\picture1.png</code>. So the file has been incorporated as <em>part</em> of the Excel Workbook, and <strong>not</strong> as a reference to an external file object.</p>\n<p><a href=\"https://i.stack.imgur.com/OEKTB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OEKTB.png\" alt=\"enter image description here\" /></a></p>\n<p>I observe that upon querying <code>Sheet1.PageSetup.LeftFooterPicture.Filename</code>, the return value is now simply &quot;Leftfooter&quot; (the original filename, without the <em>path</em> qualifier).</p>\n<p>And digging a little deeper in to the underlying xml, the relationship appears to be mapped within the <code>xl\\drawings\\_rels\\vmlDrawing1.vml.rels</code> which is connected to the <code>xl\\worksheets\\sheet1.xml</code> by the `&quot;rID1&quot; Relationship Id.</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;\n&lt;Relationships xmlns=&quot;http://schemas.openxmlformats.org/package/2006/relationships&quot;&gt;\n    &lt;Relationship Id=&quot;rId1&quot; \n      Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/image&quot; \n      Target=&quot;../media/image1.png&quot;/&gt;\n</code></pre>\n\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": -1, "last_activity_date": 1560349818, "creation_date": 1560349818, "answer_id": 56564617, "question_id": 56551559, "link": "https://stackoverflow.com/questions/56551559/assign-image-for-footer-to-excel-file-and-not-an-external-path/56564617#56564617", "title": "Assign image for footer to excel file and not an external path", "body": "<p>You have several options instead of using local file paths:</p>\n\n<ol>\n<li>Host the images on a shared network drive to which all users can be expected to have access. In this case, you'll need to use the UNC path name and <em>not</em> the local drive mapping.</li>\n<li>Host the images on a publicly accessible website like imgur. This assumes the user will have internet access, but of course you could trap errors if needed. The syntax for adding an image this way is exactly the same, you just use the image URL for the <code>Filename</code> property.</li>\n</ol>\n\n<pre><code>    Sub f()\n    With Sheet1.PageSetup.LeftFooterPicture\n        .Filename = \"https://i.stack.imgur.com/wc4Ew.jpg\"\n    End With\n    Sheet1.PageSetup.LeftFooter = \"&amp;G\"\n    End Sub\n</code></pre>\n\n<ol start=\"3\">\n<li>A third alternative would be to use images embedded in the workbook, but this approach more complicated. </li>\n</ol>\n\n<p>I'd recommend against option #3 in favor of one of the easier options above, but if you're inclined to pursue it then this is what I think you need to do.</p>\n\n<ol>\n<li>Locate the picture within the workbook/worksheet (this shouldn't be too difficult, relying on its Name or other custom properties/metadata).</li>\n<li>Copy the picture to the Clipboard (e.g., <code>picture.Select: picture.Copy</code>.</li>\n<li>Dump the Clipboard contents to a location on the user's machine which is not as easy as it sounds, and will require some use of WinAPI calls (probably -- here is <a href=\"http://www.vbaexpress.com/forum/showthread.php?25275-Saving-Clipboard-data-as-picture\" rel=\"nofollow noreferrer\">an older and quite verbose way of doing this</a> and <a href=\"https://stackoverflow.com/questions/25333558/export-pictures-excel-vba\">here</a> is at least one easier, if not a little hacky way of doing this by exploing the <code>ChartObject</code> class). Further complexity abounds because you can't always assume write-access, presence/location of special folders, etc., and generally you also want to clean-up/remove the images afterwards so as to not clutter up the user's disk.</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 11633372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9395ae6b6d598d372182ac72bdd8e49a?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/11633372/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 351, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1560350312, "creation_date": 1560286583, "last_edit_date": 1560286760, "question_id": 56551559, "link": "https://stackoverflow.com/questions/56551559/assign-image-for-footer-to-excel-file-and-not-an-external-path", "title": "Assign image for footer to excel file and not an external path", "body": "<p>I am currently creating a template with a data validation to have a drop down with 5 different location name. On selection the appropriate address image is inserted into the excel footer. I plan to distribute the template but i need to save the images to the excel file because the current file path wont work for other users. </p>\n\n<p>any help much appreciated</p>\n\n<pre><code>ActiveSheet.PageSetup.LeftFooterPicture.Filename = _\n        \"X:\\Adrian\\19.0 Templates\\19.1 Test\\UK Footer address\"\n</code></pre>\n"}]