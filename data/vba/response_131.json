[{"tags": ["vba", "image", "excel", "userform"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1499904796, "post_id": 45068581, "comment_id": 77112017, "body": "I don&#39;t think you can create a thumbnail using VBA alone."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1499924770, "post_id": 45068581, "comment_id": 77117098, "body": "@TimWilliams. That&#39;s not the answer I&#39;m looking for :-(, but at least that the word (&#39;thumbnail&#39;) I was looking for ! Thx"}], "answers": [{"comments": [{"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1499959095, "post_id": 45076141, "comment_id": 77142137, "body": "Keep in mind that &quot;I would like to load a thumbnail ... to limit memory usage&quot; and eventually save a few ms on execution. I doubt loading the full-sized image then exporting to disk then importing again, all while adding/deleting sheets and dealing with multiple shapes would be more efficient."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1499963066, "post_id": 45076141, "comment_id": 77144919, "body": "@Tibo - if OP&#39;s collection of images is fixed then they only need to do this once.  If not then your point is well-made of course."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1499986008, "post_id": 45076141, "comment_id": 77156700, "body": "You&#39;re right. I totally forgot to mention that pictures are indeed downloaded (and saved on disk, only once in a while) then loaded dynamically (on user imput) and expected to change very frequently."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 2, "last_activity_date": 1499936812, "creation_date": 1499936812, "answer_id": 45076141, "question_id": 45068581, "link": "https://stackoverflow.com/questions/45068581/vba-create-a-thumbnail-on-loadpicture-in-a-userform/45076141#45076141", "title": "VBA - Create a thumbnail on Loadpicture() in a Userform", "body": "<p>There's a hack-y way around to do this - basically:</p>\n\n<ul>\n<li>create a temp <code>Worksheet</code></li>\n<li>create a shape and load the picture to it and resize the picture</li>\n<li>create a temp <code>Chart</code> and paste the re-sized picture onto it</li>\n<li>export the <code>Chart</code> to a temp file</li>\n<li>delete the temp <code>Worksheet</code></li>\n<li>load the temp file to the <code>UserForm</code></li>\n<li>delete the temp file</li>\n</ul>\n\n<p>It is a bit ghastly, but it works. You might want to consider using <code>Application.ScreenUpdating = False</code> whilst the code is running, but it is useful to step through the code below to see how it works.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub UserForm_Initialize()\n\n    ' size of thumbnail\n    Dim lngSide As Long\n    lngSide = 50\n\n    ' input jpg and temp file path\n    Dim strInPath As String\n    Dim strOutPath As String\n    strInPath = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\Capture.JPG\"\n    strOutPath = Environ(\"USERPROFILE\") &amp; \"\\Desktop\\temp.JPG\"\n\n    ' add a temp worksheet\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Sheets.Add\n\n    ' load picture to shape and RESIZE\n    Dim shp As Shape\n    Set shp = ws.Shapes.AddPicture(Filename:=strInPath, _\n        LinkToFile:=msoFalse, _\n        SaveWithDocument:=msoCTrue, _\n        Left:=20, _\n        Top:=20, _\n        Width:=lngSide, _\n        Height:=lngSide)\n\n    ' create a chart\n    Dim cht As Chart\n    Set cht = ws.Shapes.AddChart(xlColumnClustered, _\n        Width:=lngSide, _\n        Height:=lngSide).Chart\n\n    ' copy shape picture to chart and export to temp file\n    shp.Copy\n    cht.Paste\n    cht.Export Filename:=strOutPath, FilterName:=\"jpg\"\n\n    ' remove temp sheet (including shape and chart) with no alerts\n    Application.DisplayAlerts = False\n    ws.Delete\n    Application.DisplayAlerts = True\n\n    ' load resized temp picture to image control\n    With Me.Image1\n        .Height = lngSide\n        .Width = lngSide\n        .Picture = LoadPicture(strOutPath)\n    End With\n\n    ' delete the temp file\n    Kill strOutPath\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1360, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1499936812, "creation_date": 1499898796, "last_edit_date": 1499924648, "question_id": 45068581, "link": "https://stackoverflow.com/questions/45068581/vba-create-a-thumbnail-on-loadpicture-in-a-userform", "title": "VBA - Create a thumbnail on Loadpicture() in a Userform", "body": "<p>I'm loading pictures in multiple <code>Image</code> controls on a <code>Userform</code> using <code>Loadpicture()</code>, to create some kink of previews. (The user can then click on the <code>Image</code> to open the full size picture).</p>\n\n<p>Since the preview <code>Image</code> on the <code>Userform</code> are about 1cm tall, I would like to load a thumbnail (smaller file size versions) of the pictures to limit memory usage, while still keeping the full-sized (megapixels) source pictures on the hard drive.</p>\n\n<p>Is there a way to resize the picture imported at the loading event ?</p>\n\n<p>PS : I'm not trying to change the visible height/width of the picture since <code>PictureSizeMode</code> is set to <code>fmPictureSizeModeZoom</code>.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8298608, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q5O_cG9SmCI/AAAAAAAAAAI/AAAAAAAAANI/Ye2rx0uCCoo/photo.jpg?sz=128", "display_name": "KONRIK_TV", "link": "https://stackoverflow.com/users/8298608/konrik-tv"}, "edited": false, "score": 0, "creation_date": 1499897885, "post_id": 45068387, "comment_id": 77110090, "body": "I&#39;ll give it a shot! Thanks"}, {"owner": {"reputation": 82, "user_id": 8216801, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zkU5Mx0-xs8/AAAAAAAAAAI/AAAAAAAADB0/aiB7MFwApbg/photo.jpg?sz=128", "display_name": "MNF", "link": "https://stackoverflow.com/users/8216801/mnf"}, "edited": false, "score": 0, "creation_date": 1499898685, "post_id": 45068387, "comment_id": 77110337, "body": "Sorry for the typos."}], "tags": [], "owner": {"reputation": 82, "user_id": 8216801, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zkU5Mx0-xs8/AAAAAAAAAAI/AAAAAAAADB0/aiB7MFwApbg/photo.jpg?sz=128", "display_name": "MNF", "link": "https://stackoverflow.com/users/8216801/mnf"}, "is_accepted": false, "score": 1, "last_activity_date": 1499898667, "last_edit_date": 1499898667, "creation_date": 1499897806, "answer_id": 45068387, "question_id": 45068300, "link": "https://stackoverflow.com/questions/45068300/can-i-transpose-a-column-to-a-row-with-spaces-in-excel-vba/45068387#45068387", "title": "Can I transpose a column to a row WITH spaces in Excel VBA?", "body": "<p>I think you could split your solution in two phases: </p>\n\n<p>1st - keep doing the transpose as now;</p>\n\n<p>2nd - create a loop to move the content to the next row. Something like:</p>\n\n<pre><code>      for i = 1 to 8\n          range(\"C\" &amp; i).EntireRow.Insert\n          i = i + 1\n      next\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8298608, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q5O_cG9SmCI/AAAAAAAAAAI/AAAAAAAAANI/Ye2rx0uCCoo/photo.jpg?sz=128", "display_name": "KONRIK_TV", "link": "https://stackoverflow.com/users/8298608/konrik-tv"}, "edited": false, "score": 0, "creation_date": 1499899194, "post_id": 45068505, "comment_id": 77110501, "body": "Thank you!! Worked"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1499898406, "creation_date": 1499898406, "answer_id": 45068505, "question_id": 45068300, "link": "https://stackoverflow.com/questions/45068300/can-i-transpose-a-column-to-a-row-with-spaces-in-excel-vba/45068505#45068505", "title": "Can I transpose a column to a row WITH spaces in Excel VBA?", "body": "<p>Join them with a double delimiter then split on a single.</p>\n\n<pre><code>Sub CopyTransposed(rngSource As Range, rngTargetCell As Range)\n\n    Dim str As String, vals As Variant\n    str = Join(Application.Transpose(rngSource), \"||\")\n    vals = Split(str, \"|\")\n\n    rngTargetCell.Resize(1, UBound(vals) + 1) = vals\n\nEnd Sub\n\nSub Trans()\n\n    CopyTransposed [A1:A4], [C1]\n\nEnd Sub\n</code></pre>\n\n<p>Not sure if you always need this for rows into columns but you can use the same for columns into rows with an If statement of whether rngSource.Columns.Count > rngSource.Rows.Count.</p>\n"}], "owner": {"reputation": 13, "user_id": 8298608, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q5O_cG9SmCI/AAAAAAAAAAI/AAAAAAAAANI/Ye2rx0uCCoo/photo.jpg?sz=128", "display_name": "KONRIK_TV", "link": "https://stackoverflow.com/users/8298608/konrik-tv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 45068505, "answer_count": 2, "score": 1, "last_activity_date": 1499898667, "creation_date": 1499897367, "question_id": 45068300, "link": "https://stackoverflow.com/questions/45068300/can-i-transpose-a-column-to-a-row-with-spaces-in-excel-vba", "title": "Can I transpose a column to a row WITH spaces in Excel VBA?", "body": "<p>I currently have an excel project that I use to sort out large sections of data in order to import that data into a specific program. I currently use this section of code in one module and call it elsewhere in my other modules.</p>\n\n<pre><code>Sub CopyTransposed(rngSource As Range, rngTargetCell As Range)\n\n    rngTargetCell.Resize(rngSource.Columns.Count, rngSource.Rows.Count).Value = _\n\n    Application.WorksheetFunction.Transpose(rngSource)\n\nEnd Sub\n-------------------------------------------------------------------------------------------\nSub Trans()\n\n    CopyTransposed [A1:A4], [C1]\n\nEnd Sub\n</code></pre>\n\n<p>Now I just need to figure out how to add spaces inbetween each cell. So A1 copies to C1, A2 copies to C3, and so forth.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "user-defined-functions", "excel-2011", "vba"], "comments": [{"owner": {"reputation": 141, "user_id": 8200947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/vJXic.jpg?s=128&g=1", "display_name": "Devil07", "link": "https://stackoverflow.com/users/8200947/devil07"}, "edited": false, "score": 0, "creation_date": 1499897296, "post_id": 45068263, "comment_id": 77109865, "body": "Columns C and G are set to &quot;Number&quot;, if that makes a difference."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1499898375, "post_id": 45068263, "comment_id": 77110233, "body": "Look at your data.  Either the date in A14 is not a true date or there is time associated with it, or B14 has spaces or other non visible characters.  The code works for me, albeit it is a lot of work for something Excel will do with native formulas.  The error lays in the data either A14 or B14.  Retype those two cells and I bet it will work."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1499898503, "post_id": 45068263, "comment_id": 77110280, "body": "&quot;there is no combination of any numbers that comes out to 46.5&quot; - how about C11+C12+C13?"}, {"owner": {"reputation": 141, "user_id": 8200947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/vJXic.jpg?s=128&g=1", "display_name": "Devil07", "link": "https://stackoverflow.com/users/8200947/devil07"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499905589, "post_id": 45068263, "comment_id": 77112205, "body": "@YowE3K oops, good catch."}, {"owner": {"reputation": 141, "user_id": 8200947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/vJXic.jpg?s=128&g=1", "display_name": "Devil07", "link": "https://stackoverflow.com/users/8200947/devil07"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1499953144, "post_id": 45068263, "comment_id": 77137273, "body": "@ScottCraner thank you!, if this was in answer form I would have accepted your answer. It was as simple as that. I re-entered data in line 14 and it corrected the issue."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 8200947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/vJXic.jpg?s=128&g=1", "display_name": "Devil07", "link": "https://stackoverflow.com/users/8200947/devil07"}, "edited": false, "score": 0, "creation_date": 1499953475, "post_id": 45068424, "comment_id": 77137541, "body": "I didn&#39;t realize that my version of Excel had this SUMIFS, while it doest exactly answer my question about the error with the UDF, you answered it in the comments section to my question. You should get 2X points. This is a much better way to accomplish what I was doing, the reason I used the UDF is that I was already using it for textJoin (since my version of excel) did not have the textJoin functionality, so I just added the adding part to the end."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 141, "user_id": 8200947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/vJXic.jpg?s=128&g=1", "display_name": "Devil07", "link": "https://stackoverflow.com/users/8200947/devil07"}, "edited": false, "score": 0, "creation_date": 1499953703, "post_id": 45068424, "comment_id": 77137704, "body": "For this issue I would not use the UDF, and is why I put the &quot;answer&quot; in the comments and the best method here. I wanted to give you the answer but if other users find this, I want them to use the formula.  I wish I had been around on your earlier post regarding this, I would have steered you to this method days ago."}, {"owner": {"reputation": 141, "user_id": 8200947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/vJXic.jpg?s=128&g=1", "display_name": "Devil07", "link": "https://stackoverflow.com/users/8200947/devil07"}, "edited": false, "score": 0, "creation_date": 1499953833, "post_id": 45068424, "comment_id": 77137814, "body": "It would have saved me several hours of head aches, but I got some good experience out of it. This is a much more elegant solution."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1499898019, "creation_date": 1499898019, "answer_id": 45068424, "question_id": 45068263, "link": "https://stackoverflow.com/questions/45068263/why-is-this-udf-inconsistently-adding-numbers-properly/45068424#45068424", "title": "Why is this UDF inconsistently adding numbers properly?", "body": "<p>No need for the complicated UDF, use SUMIFS():</p>\n\n<pre><code>=SUMIFS(C:C,A:A,E2,B:B,F2)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/PRibZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PRibZ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 141, "user_id": 8200947, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/vJXic.jpg?s=128&g=1", "display_name": "Devil07", "link": "https://stackoverflow.com/users/8200947/devil07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 45068424, "answer_count": 1, "score": 0, "last_activity_date": 1499898019, "creation_date": 1499897156, "last_edit_date": 1531164843, "question_id": 45068263, "link": "https://stackoverflow.com/questions/45068263/why-is-this-udf-inconsistently-adding-numbers-properly", "title": "Why is this UDF inconsistently adding numbers properly?", "body": "<p>I can't figure out why this UDF is not adding numbers consistently. I color coded the output for illustrative purposes. It adds everything accurately, but for some reason it doesn't want to add the 4 numbers which should equal 64, but instead it outputs 46.5, but there is no combination of any numbers that comes out to 46.5.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mHf2h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mHf2h.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the UDF I'm using.</p>\n\n<pre><code>    Function TEXTJOINSUM(delim As String, skipblank As Boolean, arr)\nDim d As Long\nDim c As Long\nDim arr2()\nDim t As Long, y As Long\nt = -1\ny = -1\nIf TypeName(arr) = \"Range\" Then\n    arr2 = arr.Value\nElse\n    arr2 = arr\nEnd If\nOn Error Resume Next\nt = UBound(arr2, 2)\ny = UBound(arr2, 1)\nOn Error GoTo 0\n\nIf t &gt;= 0 And y &gt;= 0 Then\n    For c = LBound(arr2, 1) To UBound(arr2, 1)\n        For d = LBound(arr2, 1) To UBound(arr2, 2)\n            If arr2(c, d) &lt;&gt; \"\" Or Not skipblank Then\n                TEXTJOINSUM = TEXTJOINSUM &amp; arr2(c, d) &amp; delim\n            End If\n        Next d\n    Next c\nElse\n    For c = LBound(arr2) To UBound(arr2)\n        If arr2(c) &lt;&gt; \"\" Or Not skipblank Then\n            TEXTJOINSUM = TEXTJOINSUM &amp; arr2(c) &amp; delim\n        End If\n    Next c\nEnd If\n    TEXTJOINSUM = Left(TEXTJOINSUM, Len(TEXTJOINSUM) - Len(delim))\n    'add the below loop to add each number together\n    Dim total As Double\n    Dim txtPart\n    For Each txtPart In Split(TEXTJOINSUM, delim)\n        total = total + CDbl(txtPart)\n\n    Next txtPart\n    TEXTJOINSUM = total\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1499896182, "post_id": 45067788, "comment_id": 77109447, "body": "What is your intention with that and the next line, isn&#39;t it like picking something up and putting it back down?"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1499897290, "post_id": 45067788, "comment_id": 77109860, "body": "I have a table in my sheet, so that&#39;s rows are extending. I want my PivotTable and Pivot Chart, stay at the end of the table. My code in line <code>Sheets(&quot;sheet1&quot;).ChartObjects(&quot;InsuranceChart&quot;).Cut</code> encounter MS Excel problem, in Worksheet_Change subroutine while this macro and that line are working correctly in my created subroutines, and Pivot table and Pivot chart will moving to the end of the table and end corner of that programmatically, so I need this act done when User add a table line and change a value in the sheet."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1499913464, "post_id": 45067788, "comment_id": 77113999, "body": "Can you explain your entire process , maybe I can offer a better simpler solution to what you are trying to achieve. For instance, if this <code>Worksheet_Change</code> event is in &quot;sheet1&quot; code module, you can remove all places where you use in your code &quot;sheet1&quot;, since it&#39;s referenced as the <code>ActiveSheet</code> when using the ` Worksheet_Change<code>. Also, you have too many </code>Select`, which you don&#39;t really need."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1499932943, "post_id": 45067788, "comment_id": 77122003, "body": "@MGae2M have you tried my answer and code below ?"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1499959563, "post_id": 45067788, "comment_id": 77142492, "body": "I&#39;m at weekend and Saturday will go my office and try and check this code."}], "answers": [{"comments": [{"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1500107865, "post_id": 45070846, "comment_id": 77203557, "body": "A problem at <code>InsurChtObj.Left = PvtTbl.TableRange1.Left</code> so PivotChart been hide. I checked the Left value by <code>Msgbox</code> and compare with corporate value of PivobTable. Result is: 884565.76 value for PivotChart and 843.75 is value of PivotTable. Thus PivotChart been hide after running last line of macro code."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1500110910, "post_id": 45070846, "comment_id": 77204407, "body": "I asked a new <a href=\"https://stackoverflow.com/questions/45116548/whats-different-beetwin-left-property-in-chartobjects-and-tablerange\">question</a> about the related issue about your answer."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1500142502, "post_id": 45070846, "comment_id": 77213518, "body": "Thank you for <code>Application.EnableEvents = False</code> code. This helped me in many problems issue. And whats the reason of your recommendation for keeping only basics in the <code>Worksheet_Change()</code> event?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1500143168, "post_id": 45070846, "comment_id": 77213715, "body": "@MGae2M  I don&#39;t like to put code that is not related to Worksheet events in a Worksheet module. Also, if in the future, you would want to use this in another sheet, then already have 90% of the code ready for you."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1500146017, "post_id": 45070846, "comment_id": 77214538, "body": "Of course. Whats meaning of &quot;Related to Worksheet events&quot;? And when we say a code is related to WorkSheet event?"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1500146226, "post_id": 45070846, "comment_id": 77214602, "body": "Shai Rado, How is My answer?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 3, "last_activity_date": 1499915897, "creation_date": 1499915897, "answer_id": 45070846, "question_id": 45067788, "link": "https://stackoverflow.com/questions/45067788/change-event-procedure-for-moving-pivot-chart/45070846#45070846", "title": "_Change event procedure for moving Pivot Chart", "body": "<p>I would recommend to keep only the basic in the <code>Worksheet_Change</code> event, and have the rest of the logic, objects and code in a <code>Sub</code> in a regular module.</p>\n\n<p>In order to move the Pivot Chart, you can use the <code>Top</code> and <code>Left</code> properties of the <code>ChartObject</code>.</p>\n\n<p>More explanations inside the code as comments.</p>\n\n<p><strong><em>Worksheet_Change</em> Code (inside worksheet module)</strong></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nMovePivotTable Target.Parent ' call the reugular Sub and pass the Worksheet object\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p><strong><em>Sub MovePivotTable</em> (regular module)</strong></p>\n\n<pre><code>Option Explicit\n\nSub MovePivotTable(ws As Worksheet)\n\nDim PvtTbl As PivotTable\nDim TblReport As ListObject\nDim InsurChtObj As ChartObject\n\nWith ws\n    ' set the Pivot Table object\n    Set PvtTbl = .PivotTables(\"pvtReport\")\n\n    ' set the Table object (ListObject)\n    Set TblReport = .ListObjects(\"tblReport\")\n\n    ' set the Pivot Table Chart object\n    Set InsurChtObj = .ChartObjects(\"InsuranceChart\")\n\n    ' move the Pivot Table at the end of the Table Object\n    PvtTbl.TableRange2.Cut Destination:=.Cells(TblReport.Range.Rows.Count + 2, 13)\n\n    ' move the Pivot chart at the end of the Table\n    InsurChtObj.Top = PvtTbl.TableRange1.End(xlDown).Offset(2).Top ' go to the bottom of the Pivot-Table range + 2 more rows\n    InsurChtObj.Left = PvtTbl.TableRange1.Left\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "is_accepted": true, "score": 0, "last_activity_date": 1500145626, "creation_date": 1500145626, "answer_id": 45121810, "question_id": 45067788, "link": "https://stackoverflow.com/questions/45067788/change-event-procedure-for-moving-pivot-chart/45121810#45121810", "title": "_Change event procedure for moving Pivot Chart", "body": "<p>With thank of friends guidance, I reached to suitable answer specially for Right to Left sheet:</p>\n\n<p>Seems there were great different between <code>TableRange1.Left</code> and <code>ChartObject().Left</code> calculation.</p>\n\n<p>In fact <code>TableRange1.Left</code> related to sheets <code>Direction</code>, and <code>ChartObject().Left</code> is not related, and calculate from left side of sheet.</p>\n\n<p>The problem solved in code below with addition explanation after.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf ActiveSheet.Name = \"Sheet1\" Then\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    Dim ChartLeft, SheetWidth As Double\n\n    SheetWidth = Worksheets(\"sheet1\").Cells.Width\n\n    ChartLeft = SheetWidth - _\n    (Sheets(\"Sheet1\").ChartObjects(\"InsuranceChart\").Width + _\n    Sheets(\"Sheet1\").PivotTables(\"pvtReport\").TableRange1.Left)\n\n    Sheets(\"Sheet1\").ChartObjects(\"InsuranceChart\").Top = _\n    Sheets(\"Sheet1\").PivotTables(\"pvtReport\").TableRange1.End(xlDown).Offset(2).Top\n    Sheets(\"Sheet1\").ChartObjects(\"InsuranceChart\").Left = ChartLeft\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\nEnd If\n\nEnd Sub\n</code></pre>\n\n<h2>Explanation:</h2>\n\n<p>We used sheet's width to calculate distance between left side of PivotChart from Left corner of WorkSheet, in the Right to Left sheet; from distance of Right corner of Pivot Table to Right side of WorkSheet.</p>\n\n<p>Note that <code>TableRange1.Left</code> is distance of the Right corner of PivotTable from Right side of WorkSheet, (In Right to Left Worksheets directional) and <code>ChartObject().Left</code> is distance of Left corner of PivotChart from Left side of Worksheet (In both WorkSheets direction).</p>\n\n<p>And because of relation between PivotChart position and PivotTable, that we want PivotChart position is functioned to respective PivotTable, thus calculate Left side of PivotTable from Right side of that, and its <code>Width</code> and WorkSheets width, then assign this value to left corner of PivotChart by <code>ChartObject().Left</code> property of PivotChart.</p>\n"}], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 45121810, "answer_count": 2, "score": 1, "last_activity_date": 1500145626, "creation_date": 1499894801, "last_edit_date": 1531164843, "question_id": 45067788, "link": "https://stackoverflow.com/questions/45067788/change-event-procedure-for-moving-pivot-chart", "title": "_Change event procedure for moving Pivot Chart", "body": "<p>What is true with _Change sheet's event?\nI have bellow problem in _Change event procedure while this code works in other subroutines truly.</p>\n\n<p>This macro wrote for moving Pivot Chart.</p>\n\n<p>Microsoft Excel will close and encounter this error:\nMicrosoft Excel has encountered a problem and needs to close. We are sorry for the inconvenience. and will close.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nApplication.ScreenUpdating = False\nSheets(\"sheet1\").PivotTables(\"pvtReport\").TableRange2.Cut\nCells(Sheets(\"sheet1\").ListObjects(\"tblReport\").Range.Rows.Count + 2, 13).Select\nSheets(\"sheet1\").Paste\nActiveSheet.PivotTables(\"PvtReport\").PivotSelect \"\", xlDataAndLabel, True\nSelection.End(xlDown).Select\nCells(Selection.Row + 2, Selection.Column).Select\n\nSheets(\"sheet1\").ChartObjects(\"InsuranceChart\").Cut\nSheets(\"sheet1\").Paste\nEnd Sub\n</code></pre>\n\n<p>Please note that this code encounter error in <code>Sheets(\"sheet1\").ChartObjects(\"InsuranceChart\").Cut</code> line.</p>\n"}, {"tags": ["excel", "vba", "indexing", "duplicates", "formula"], "comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1499894153, "post_id": 45067479, "comment_id": 77108546, "body": "Store the Unique Values as an output of a Named Range(put the formula in there), and then do the repeating logic on the spreadsheet."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7402756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed569a0ccd6c553749bd153a0c12fda5?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Price", "link": "https://stackoverflow.com/users/7402756/thomas-price"}, "edited": false, "score": 0, "creation_date": 1499954134, "post_id": 45067889, "comment_id": 77138074, "body": "This. This is it. Thank you so much! I&#39;ve never used AGGREGATE before, good to know about it!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1499895332, "creation_date": 1499895332, "answer_id": 45067889, "question_id": 45067479, "link": "https://stackoverflow.com/questions/45067479/extracting-unique-values-from-a-range-but-repeating-each-value-x-times-before-n/45067889#45067889", "title": "Extracting unique values from a range, but repeating each value x times before next unique value", "body": "<p>Put this in B2 and copy down:</p>\n\n<pre><code>=IFERROR(INDEX(A:A,AGGREGATE(15,6,ROW($A$1:$A$6)/((COUNTIF($B$1:B1,$A$1:$A$6)&lt;5)*($A$1:$A$6&lt;&gt;\"\")),1)),\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/rUVjy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rUVjy.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 51, "user_id": 7402756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ed569a0ccd6c553749bd153a0c12fda5?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Price", "link": "https://stackoverflow.com/users/7402756/thomas-price"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 1, "accepted_answer_id": 45067889, "answer_count": 1, "score": 0, "last_activity_date": 1499895332, "creation_date": 1499893421, "question_id": 45067479, "link": "https://stackoverflow.com/questions/45067479/extracting-unique-values-from-a-range-but-repeating-each-value-x-times-before-n", "title": "Extracting unique values from a range, but repeating each value x times before next unique value", "body": "<p>I have a bit of a strange scenario. I am attempting to create a formula that, as the title suggests, that is supposed to extra unique values from a range (without blanks) but repeat them a set number (let's say 5) of times before returning the next unique value. For example, this is the A1:A6 (should be top to down but for the sake of space, I formatted like this):</p>\n\n<p><code>1,2,2,3,3,3</code></p>\n\n<p>What I want is a formula to drag them down to this on Column B.</p>\n\n<p><code>1,1,1,1,1,2,2,2,2,2,3,3,3,3,3</code></p>\n\n<p>As reference, the formula I'm currently using to return the unique values to repeat once, without blanks, is this:</p>\n\n<p><code>=INDEX(A1:A6, MATCH(0, IF(ISBLANK(A1:A6), 1, COUNTIF(B$1:$B1, A1:A6)), 0))</code></p>\n\n<p>Any suggestions? Many thanks in advance!</p>\n"}, {"tags": ["vba", "ms-access", "scope", "ms-access-2013", "subroutine"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1499894653, "post_id": 45067428, "comment_id": 77108792, "body": "Have you checked and made sure you have no controls with reserved names? When did the issue start - after you made a change or always? Any hints if you COMPILE ALL? You must have a subroutine with the name of one of your controls?"}, {"owner": {"reputation": 177, "user_id": 8250805, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/b25230fb2ab4e6c2cf426cffacfe2d52?s=128&d=identicon&r=PG&f=1", "display_name": "JohnSmithy1266", "link": "https://stackoverflow.com/users/8250805/johnsmithy1266"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1499895240, "post_id": 45067428, "comment_id": 77109087, "body": "@WayneG.Dunn When I compile the database it highlights a specific <code>Sub</code> and gives that error. Does that mean that that sub is causing the error?"}, {"owner": {"reputation": 177, "user_id": 8250805, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/b25230fb2ab4e6c2cf426cffacfe2d52?s=128&d=identicon&r=PG&f=1", "display_name": "JohnSmithy1266", "link": "https://stackoverflow.com/users/8250805/johnsmithy1266"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1499895325, "post_id": 45067428, "comment_id": 77109118, "body": "@WayneG.Dunn Is this error specifically caused when a <b><i>control</i></b> and a <b><i>subroutine</i></b> share a name? Or can other objects that share a name cause this issue?"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1499895851, "post_id": 45067428, "comment_id": 77109327, "body": "If you have a textbox named &quot;Hello&quot;, then you can&#39;t have a subroutine named &quot;Hello&quot; (in the same module). Open your form in design view and look for the name of the offending subroutine that gave the error. Change one or the other."}], "owner": {"reputation": 177, "user_id": 8250805, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/b25230fb2ab4e6c2cf426cffacfe2d52?s=128&d=identicon&r=PG&f=1", "display_name": "JohnSmithy1266", "link": "https://stackoverflow.com/users/8250805/johnsmithy1266"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 805, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499894266, "creation_date": 1499893220, "last_edit_date": 1499894266, "question_id": 45067428, "link": "https://stackoverflow.com/questions/45067428/ms-access-member-already-exists-in-an-object-module", "title": "Ms Access: member already exists in an object module", "body": "<p>I've looked at the other answers on here and they haven't helped me figure out what's going on. I need to clear this error from the On Current and On Load properties of the form. I get the concept behind the error - it means that somewhere in my code there is a name that is \"reserved\" in a sense, i.e. it is already being used for something else. But I can't find what's being shared!</p>\n\n<p>Update - it looks like the After_Update sub for one of my combo boxes is also producing this error. I'll add the code for this sub if asked to.</p>\n\n<p><strong>On Current Sub:</strong></p>\n\n<pre><code>Private Sub Form_Current()\n\n' This will be done when Form will be opened and when record will be changed / browsed\n\nOn Error Resume Next\n\n'load_vendor\n\nload_vendor2\n\nDoCmd.RefreshRecord\n\nTotals\n\nEnd Sub\n</code></pre>\n\n<p><strong>On Load Sub:</strong></p>\n\n<pre><code>Private Sub Form_Load()\n\n    CBQuote.RowSource = \"CBQuote(NotClosed)\"\n\n    Check1354.Value = 0\n\nCombo382.RowSource = \"SELECT [CBPrimeContact].[PrimeContactID], [CBPrimeContact].[Contact Name]\" &amp; _\n\" FROM CBPrimeContact\" &amp; _\n\" ORDER BY [CBPrimeContact].[Contact Name];\"\n\n\nCombo320.RowSource = \"SELECT [CBCompanyContact].[ContactID], [CBCompanyContact].[CompanyID], [CBCompanyContact].[Expr1]\" &amp; _\n\" FROM CBCompanyContact\" &amp; _\n\" ORDER BY [Expr1];\"\n\n\ncustomer_updates\n\n\n'Combo672.RowSource = \"SELECT [CBCompanyContact].[ContactID], [CBCompanyContact].[CompanyID], [CBCompanyContact].[Expr1]\" &amp; _\n\" FROM CBCompanyContact\" &amp; _\n\" ORDER BY [Expr1];\"\n\n    Me.CBQuote = Me.CBQuote.ItemData(0)\n\n    search_record\n\n\n    TabCtl952.Enabled = False\n\n    autofit_subform1    '6-23\n\n    update_ga\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1499893344, "post_id": 45067404, "comment_id": 77108165, "body": "You can do <code>Sheets(twomonthsago).Cells.PasteSpecial ...</code> too"}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1499893428, "post_id": 45067449, "comment_id": 77108208, "body": "Uh oh, got an &quot;Out of memory&quot; error after trying that."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1499893610, "post_id": 45067449, "comment_id": 77108289, "body": "Voila, that fixed it! Thanks a bunch. Congrats on breaking 50k btw."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1499893487, "last_edit_date": 1499893487, "creation_date": 1499893311, "answer_id": 45067449, "question_id": 45067404, "link": "https://stackoverflow.com/questions/45067404/running-into-error-1004-application-defined-or-object-defined-error-with-usi/45067449#45067449", "title": "Running into Error - 1004 &#39;Application Defined or Object Defined Error&#39; with using PasteValues", "body": "<p>Assign it directly.</p>\n\n<p>Replace these:</p>\n\n<pre><code>Sheets(twomonthsago).Cells.Copy\nSheets(twomonthsago).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>With Sheets(twomonthsago).UsedRange\n    .Value = .Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 45067449, "answer_count": 1, "score": 0, "last_activity_date": 1499893487, "creation_date": 1499893108, "question_id": 45067404, "link": "https://stackoverflow.com/questions/45067404/running-into-error-1004-application-defined-or-object-defined-error-with-usi", "title": "Running into Error - 1004 &#39;Application Defined or Object Defined Error&#39; with using PasteValues", "body": "<p>Running into error 1004 trying to copy and paste the cell values over themselves (to eliminate formulas and just get the values). Works fine when I record it on the sheet, alas it doesn't work when I implement it in my subroutine. Error occurs on the <code>PasteSpecial</code> line:</p>\n\n<pre><code>If i = ws_count Then\n    'ws_count - 2 allows us to place the new tab before the last sheet in the data file (admin)\n    Sheets(twomonthsago).Copy Before:=Sheets(ws_count - 2)\n    Sheets(twomonthsago &amp; \" (2)\").Name = lastmonth &amp; \" test\"\n    Sheets(twomonthsago).Cells.Copy\n    Sheets(twomonthsago).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\nEnd If\n</code></pre>\n\n<p>I've also tried directly selecting <code>Range(\"A1\")</code> before pasting, still getting the error. All my variables have valid strings assigned to them so that isn't the issue.</p>\n"}, {"tags": ["vba", "excel", "pivot-table", "formulas"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499893182, "post_id": 45067121, "comment_id": 77108085, "body": "Where&#39;s the <code>Reporting Date</code> coming from? <i>Make it</i> a field, and a pivot should work."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1499894144, "post_id": 45067121, "comment_id": 77108537, "body": "If you have Excel 2010, you have VBA. If you have VBA, you have adodb. If you have adodb, you can query the sheet itself. Also &quot;flexible&quot; is not really exact behavior. You need specific field calculations and you want design tips for pivots?"}, {"owner": {"reputation": 11, "user_id": 4272704, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZS-pt01WTHM/AAAAAAAAAAI/AAAAAAAAADI/YYckqBAcaCs/photo.jpg?sz=128", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4272704/kevin"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499945782, "post_id": 45067121, "comment_id": 77131153, "body": "@Mat&#39;sMug The Reporting Date is just a list of the last three years broken down by month.  I can create a reporting date based off of the Submitted date, but that doesn&#39;t work because a ticket can be opened in one month and closed in a completely different month. Or a ticket can be opened in 2010 and still open. If I create the reporting date it will only apply to that one row. Idk if that makes sense."}, {"owner": {"reputation": 11, "user_id": 4272704, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZS-pt01WTHM/AAAAAAAAAAI/AAAAAAAAADI/YYckqBAcaCs/photo.jpg?sz=128", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4272704/kevin"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1499946298, "post_id": 45067121, "comment_id": 77131531, "body": "@RikSportel Im going to look into adodb. By flexible I mean I would like the user to be able to filter the &quot;Data&quot; sheet and have the &quot;Summary&quot; sheet reflect what the users filtered."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1499951393, "post_id": 45067121, "comment_id": 77135851, "body": "@Kevin I wouldn&#39;t go into filtering data sheets.  Instead look into Pivot tables and Pivot charts. They come with their own filters, &quot;slicers&quot; and charting mechanisms and indeed - these are intended for this purpose. The <b>data is just data</b> and shouldn&#39;t be worked on by your end users. If anything that sheet should be hidden. You could add some formulas on it to calculate specific additional fields, but that&#39;s about it. You should use pivot tables and charts to summarize it - E.g. create a dashboard based on the data. From what you describe you don&#39;t even need VBA."}, {"owner": {"reputation": 11, "user_id": 4272704, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZS-pt01WTHM/AAAAAAAAAAI/AAAAAAAAADI/YYckqBAcaCs/photo.jpg?sz=128", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4272704/kevin"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1499953481, "post_id": 45067121, "comment_id": 77137545, "body": "@RikSportel Thanks for your reply, I was thinking pivot tables would be the way to go, but how do I say give me the count of priorities which submitted_on is before this arbitrary date, where multiple arbitrary dates need to be listed in the pivot table? The only thing I can think of is to add a column for each reporting date to the data sheet with a Boolean saying whether or not it is included in that Reporting Date (36 additional columns)"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1499954317, "post_id": 45067121, "comment_id": 77138234, "body": "Hmm yes, you could indeed use VBA for that, but again: If the user sets the date from and date to, they can just use a slicer you provide in the report.  That&#39;s the thing.  You could also create VBA to come up with a pre filtered data sheet and use that one as a pivot cache - In that case the dates before and after your arbitrary dates will not be available for your end user. However - these are design questions and not something specific I can script on forehand. It all depends on how you want the behavior to be, exactly."}, {"owner": {"reputation": 11, "user_id": 4272704, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZS-pt01WTHM/AAAAAAAAAAI/AAAAAAAAADI/YYckqBAcaCs/photo.jpg?sz=128", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4272704/kevin"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1499956311, "post_id": 45067121, "comment_id": 77139853, "body": "@RikSportel I think slicing would work well for the part where the user can  filter, such as showing the pivot table results for particular person it was assigned to, but the pivot table&#39;s reporting date is whats difficult.   How can I list the <b>arbitrary report dates</b> as row labels in the pivot table, if an individual data row can be included in multiple report dates.  In other words, the arbitrary report dates are completely independent from the data, and I think anything in the pivot table needs to be in the data right?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1500035704, "post_id": 45067121, "comment_id": 77177235, "body": "Hi @Kevin - I&#39;m still not completely clear on what you mean with these dates.  What you would normally do is load the data you want to summarize in some way (e.g. have sheet &quot;data&quot; or &quot;source&quot;).  From what I understand this data needs to be filtered based on the dates you want. After that you create a pivot on your &quot;summary&quot; sheet, which is based on this &quot;data&quot; sheet and that the users can slice n dice as much as they want.  Am I correct when I say that you basically only want VBA to alter your &quot;data&quot; sheet (or <code>pivotcache</code>) based on these arbitrary dates?"}], "owner": {"reputation": 11, "user_id": 4272704, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZS-pt01WTHM/AAAAAAAAAAI/AAAAAAAAADI/YYckqBAcaCs/photo.jpg?sz=128", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4272704/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499892015, "creation_date": 1499892015, "question_id": 45067121, "link": "https://stackoverflow.com/questions/45067121/use-excel-and-vba-pivot-tables-to-summarize-data-before-and-after-dates", "title": "Use excel and vba pivot tables to summarize data before and after dates", "body": "<p>I have an excel document that is an dumped output of all service tickets(with statuses, assigned to, submitted by...etc) from our ticket tracking software. There is one row per ticket. </p>\n\n<p>I am trying to make a flexible report generator in vba that will allow me to take in the ticket dump and output a report which will have a copy of the data in one sheet, a summary in another sheet, and a line graph in another sheet. </p>\n\n<p>I feel like a pivot table is the perfect approach for this, the only problem is in the summary.</p>\n\n<p>The data from the ticket dump looks something like this:  </p>\n\n<pre><code>| Submitted_On | Priority |       Title       |    Status    |   Closed_On    |\n   10/10/2016        1           Ticket 1           New      \n   10/11/2016        1           Ticket 2          Fixed         11/10/2016\n   10/12/2016        3           Ticket 3         Rejected        11/9/2016\n   10/15/2016        1           Ticket 4        In Review      \n</code></pre>\n\n<p>The problem is the way I want the summary to look. Basically the summary should show all tickets that were opened and closed at the first of every month at exactly midnight within the past three years. In other words, if this report was a time machine, at that exact time X would be open and Y would be closed. Furthermore, The summary table should break that down by priority. </p>\n\n<p>The hard part is that these simulated report dates (first of every month within the last 3 years) are extraneous values and are not within each data row. </p>\n\n<p>So the report would be like this:</p>\n\n<pre><code>                  |        Open        |       Closed       |\n| Reporting Date  |  P1  |  P2  |  P3  |  P1  |  P2  |  P3  |\n    1-Oct-2016       6     10      0      3      2      0   \n    1-Nov-2016       4     10      0      5      2      0   \n    1-Dec-2016       6      3      0      5      9      0   \n</code></pre>\n\n<p>Basically the formula for the Open section would be something like:\n  <code>priority=1 AND Submitted_On&lt;Reporting Date  AND (Closed_On&gt;Reporting Date OR Closed_On=\"\")</code></p>\n\n<p>and the formula for the closed section would be something like:\n  <code>priority=1 AND Submitted_On&lt;Reporting Date  AND Closed_On&lt;Reporting Date</code></p>\n\n<p>It would be needed where I can filter the data so that its only coming assigned to x or only with these statuses...etc. which is why I don't think a regular sheet with formulas would work.</p>\n\n<p>I thought pivot tables would work but <code>Reporting Date</code> isn't a field. </p>\n\n<p>Do you have any advice as to what I can do to make this report work and be very flexible as far as filtering goes?</p>\n\n<p>Thank you!</p>\n\n<p>P.S. I am using excel 2010, so I do not have access to queries</p>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1499892808, "post_id": 45067116, "comment_id": 77107891, "body": "SO isn&#39;t a tutorial site. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}], "answers": [{"tags": [], "owner": {"reputation": 7432, "user_id": 6074376, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/y0n8W.jpg?s=128&g=1", "display_name": "Joris Schellekens", "link": "https://stackoverflow.com/users/6074376/joris-schellekens"}, "is_accepted": false, "score": 0, "last_activity_date": 1499945611, "creation_date": 1499945611, "answer_id": 45079409, "question_id": 45067116, "link": "https://stackoverflow.com/questions/45067116/import-pdf-into-specific-worksheet/45079409#45079409", "title": "Import pdf into specific worksheet", "body": "<p>If you can waver the limitation of using only VBA, you could use iText (combined with Apache POI). iText is more than capable of extracting the text from a pdf file, and the apache POI library allows you to generate Office documents (such as excel workbooks).</p>\n"}], "owner": {"reputation": 1, "user_id": 8298301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/196079a8e7b873479809e528af9a3489?s=128&d=identicon&r=PG&f=1", "display_name": "Jorian", "link": "https://stackoverflow.com/users/8298301/jorian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1499945611, "creation_date": 1499891996, "question_id": 45067116, "link": "https://stackoverflow.com/questions/45067116/import-pdf-into-specific-worksheet", "title": "Import pdf into specific worksheet", "body": "<p>There are lots of topics about this item, but I wasn't able to find an answer to my question. I want to select a pdf file and import all the text from this file into a specific sheet, let's call it sheet2. Please note this is a new pdf file every day, so it cannot come from a specific location, but the file has to be selected every day.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1499891952, "post_id": 45067072, "comment_id": 77107487, "body": "Step through your code and make sure that <code>A</code> equals what you think it should."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499892033, "post_id": 45067072, "comment_id": 77107531, "body": "^^ and even ensure it has no leading / trailing spaces."}, {"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1499892151, "post_id": 45067072, "comment_id": 77107584, "body": "A does equal what I want it to equal."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499892386, "post_id": 45067072, "comment_id": 77107667, "body": "Place a line saying <code>Debug.Print cel.Column &amp; &quot;|&quot; &amp; cel.Value &amp; &quot;|A0_&quot; &amp; A &amp; &quot;|&quot;</code> just after <code>For Each cel In iRng</code> and see what is written to the immediate window - ensure that one of the lines written is showing the same values in both the <code>cel.Value</code> part and the <code>A0_&quot; &amp; A</code> part."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499892535, "post_id": 45067072, "comment_id": 77107748, "body": "BTW - Not related to your problem (as far as I can see) but you should declare <code>Rng1</code>, <code>Rng2</code> and <code>Rng3</code> to be <code>Range</code> instead of <code>Variant</code>, and you should use <code>dataws.Columns.Count</code> instead of just <code>Columns.Count</code>."}, {"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1499892665, "post_id": 45067072, "comment_id": 77107812, "body": "Added the line and Formula, FormulaArray, FormulaLocal, FormulaR1C1 remain the same. Also I have Rng1, Rng2, Rng3 declared as Range not Variant and in my workbook A is equal to a value for example say 1"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1499892790, "post_id": 45067072, "comment_id": 77107873, "body": "What was written to the Immediate Window?  Was the line <code>2|A0_1|A0_1</code> written?  (And you have <code>Dim Rng1, Rng2, Rng3, NewRng As Range</code> which is equivalent to <code>Dim Rng1 As Variant, Rng2 As Variant, Rng3 As Variant, NewRng As Range</code> - <code>Variant</code> is the default data type if you don&#39;t specify anything.)"}, {"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1499893147, "post_id": 45067072, "comment_id": 77108063, "body": "Ok so stepping through the code the first time 1|Depth|A0_2| appears and then stepping when it goes back to the Debug.Print cel.Column &amp; &quot;|&quot; &amp; cel.Value &amp; &quot;|A0_&quot; &amp; A &amp; &quot;|&quot; and I step through a second time 2|A0_ 1|A0_2| appears."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1499893255, "post_id": 45067072, "comment_id": 77108128, "body": "Keep stepping through, if <code>A</code> is <code>2</code> you should hopefully get to a line saying <code>9|A0_2|A0_2|</code>.  Once that is printed, I would expect your code to go to the <code>Set Rng1 = cel.EntireColumn.Find(What:=&quot;&quot;, LookIn:=xlValues, lookat:=xlPart)</code> line."}], "owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499891804, "creation_date": 1499891804, "question_id": 45067072, "link": "https://stackoverflow.com/questions/45067072/if-cel-val-a0-a-then", "title": "If cel.Val = &quot;A0_&quot; &amp; A Then", "body": "<p>I have an excel workbook where I want to find the cell that contains \"A0_\" &amp; A where A is the value from another worksheet. The end goal is to copy the column with \"A0_\" &amp; A to another sheet titled. Here is my code so far.</p>\n\n<pre><code>Sub Copy_A()\n\nDim A As String\nDim iRng As Range\nDim cel As Range\nDim dataws As Worksheet\nDim Rng1, Rng2, Rng3, NewRng As Range\n\nSet dataws = Worksheets(\"Data Importation Sheet\")\n\nSet iRng = dataws.Range(dataws.Cells(1, 1), dataws.Cells(1, dataws.Cells(1, Columns.Count).End(xlToLeft).Column))\n\nA = Worksheets(\"Information Sheet\").Range(\"E12\").Value\n\nFor Each cel In iRng\nIf cel.Value = \"A0_\" &amp; A Then\n    Set Rng1 = cel.EntireColumn.Find(What:=\"\", LookIn:=xlValues, lookat:=xlPart)\n    Debug.Print Rng1.FormulaR1C1\n    Set Rng2 = dataws.Cells(Rng1.Row - 1, Rng1.Column + 1)\n    Debug.Print Rng2.FormulaR1C1\n    Set Rng3 = Cells(cel.Row + 1, cel.Column)\n    Debug.Print Rng3.FormulaR1C1\nEnd If\nNext cel\n\nWith dataws\nSet NewRng = .Range(Rng3.Address &amp; \":\" &amp; Rng1.Address)\nDebug.Print NewRng.Address\nNewRng.Select\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>For some reason the code does not recognize \"A0_\" &amp; A when it reaches that cell. The code goes through each column but does not execute setting the ranges. Any tips/help would be greatly appreciated! Here is a picture of my workbook to give you a better idea of what is happening \n<a href=\"https://i.stack.imgur.com/fAWey.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fAWey.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "pdf", "printing", "screen", "clipboard"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1499891905, "post_id": 45066975, "comment_id": 77107466, "body": "Does the code run on a machine with a MS-Office install? How about dumping clipboard contents into an Excel file, and then saving it as a PDF?"}, {"owner": {"reputation": 55, "user_id": 7379863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddb2cb596b7b6318081694603b647a2?s=128&d=identicon&r=PG&f=1", "display_name": "MikeA", "link": "https://stackoverflow.com/users/7379863/mikea"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1500047510, "post_id": 45066975, "comment_id": 77185384, "body": "No, Office is not installed on this machine."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1500047551, "post_id": 45066975, "comment_id": 77185411, "body": "So what&#39;s your VBA host?"}, {"owner": {"reputation": 55, "user_id": 7379863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddb2cb596b7b6318081694603b647a2?s=128&d=identicon&r=PG&f=1", "display_name": "MikeA", "link": "https://stackoverflow.com/users/7379863/mikea"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1500047682, "post_id": 45066975, "comment_id": 77185496, "body": "I have been able to get code to grab the screen print and using Shell with MSPaint output a jpeg file.   I&#39;ve been looking online for a way to use the TaskID of the instance of MSPaint to make Paint print the file (while it is open) to a PDF using an installed PDF printer. I have yet to find that information. Anyone privy to a way to do this?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1500048940, "post_id": 45066975, "comment_id": 77186196, "body": "Again, you&#39;re saying &quot;VBA is what I have&quot;, but also &quot;Office is not installed on this machine&quot;, so <i>what is your VBA host application</i>?"}, {"owner": {"reputation": 55, "user_id": 7379863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddb2cb596b7b6318081694603b647a2?s=128&d=identicon&r=PG&f=1", "display_name": "MikeA", "link": "https://stackoverflow.com/users/7379863/mikea"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1500052697, "post_id": 45066975, "comment_id": 77188326, "body": "If you read my original post you will see that the host application is Rockwell Software&#39;s FactoryTalk View Site Edition. It has VBA as the scripting engine."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1500052766, "post_id": 45066975, "comment_id": 77188368, "body": "Oh, sorry I missed that. Well, good luck!"}, {"owner": {"reputation": 55, "user_id": 7379863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddb2cb596b7b6318081694603b647a2?s=128&d=identicon&r=PG&f=1", "display_name": "MikeA", "link": "https://stackoverflow.com/users/7379863/mikea"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1500053223, "post_id": 45066975, "comment_id": 77188610, "body": "Not something I have in abundance obviously!"}], "owner": {"reputation": 55, "user_id": 7379863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddb2cb596b7b6318081694603b647a2?s=128&d=identicon&r=PG&f=1", "display_name": "MikeA", "link": "https://stackoverflow.com/users/7379863/mikea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499891456, "creation_date": 1499891456, "question_id": 45066975, "link": "https://stackoverflow.com/questions/45066975/another-vba-conundrum-how-to-save-the-clipboard-contents-as-a-pdf-file", "title": "Another VBA Conundrum - How to save the Clipboard Contents as a PDF File", "body": "<p>I've searched the web and stackoverflow for help on the task I'm facing and have found answers to some, but one is being a bit more problematic.</p>\n\n<p>And before I get, \"don't use VBA, use 'XYZ'\", let me say that I'm not at liberty to dictate what is used. There is an existing Rockwell Software FactoryTalk View SE system in place and VBA is what I have. End of that story! :D</p>\n\n<p>So what I've been asked to look into is the following. From a screen in the Factory Talk View a button would trigger a screen print and of that or a second (preferred) screen. In the event of the second screen option the button would open the second screen, take the screen print, then close the screen. In both cases the screen print would be sitting in the clipboard. This part I think I've found a solution for.</p>\n\n<p>The saving the clipboard content to a PDF file is where I'm having no luck finding help or examples. How would the content of the clipboard be saved to a generic location as a PDF file?</p>\n\n<p>As always, any and all relevant help is greatly appreciated.</p>\n\n<p>Thanks,\nMike</p>\n"}, {"tags": ["arrays", "vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1499891574, "post_id": 45066915, "comment_id": 77107310, "body": "(Unrelated to your question) Does <code>Range(&quot;D&quot; &amp; Row).Value</code> work in VBScript?  I would have thought you would need to specify the Excel <code>Application</code> object that you are using in order to get to the <code>Range</code> property."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1499893065, "post_id": 45066915, "comment_id": 77108026, "body": "How do you set the bounds of the <code>Serv</code> array?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1499895119, "post_id": 45066915, "comment_id": 77109031, "body": "Note that your question has nothing to do with duplicates in the array; rather it is how to find the first index of a given element within an array."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499948273, "post_id": 45066915, "comment_id": 77132987, "body": "<code>YowE3K</code> - Yes, that works. Excel <code>Application</code> object was specified, but due to the length of the program, it needs to be assumed that all necessary objects were created. <code>Zev Spitz</code> - No, <code>Serv(j)</code> is an array of data from IBM PCOMM and <code>Row</code> refers to a row in Excel. The array data is being entered into the spreadsheet. My question still has to do with finding duplicates in an array and then removing them...or not allowing them into the array after the first one is found. As for setting the bounds, there aren&#39;t any. The array stops receiving data when search criteria is met."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1499966212, "post_id": 45066915, "comment_id": 77146735, "body": "Notifying other commenters about your comment (the author of a question or an answer is always notified) is done using the <code>@</code> syntax, like so: @Lou. You can only explicitly notify one person within your comment."}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499951989, "post_id": 45067150, "comment_id": 77136346, "body": "&quot;Presumably, you are defining the bounds of the <code>Serv</code> array&quot;...I get it now. You mean <code>Dim Serv(200) As String</code>? Yes, I&#39;m setting the bounds higher than the amount of rows I&#39;m collecting from. I&#39;ve ran into that issue not knowing ahead of time how many rows I will be searching. Please see my reply to Brian. How would I call <code>IndexOf</code> to send the <code>enumerable</code> and <code>toFind</code>? That seems to be the issue I&#39;m facing with using a function to sort an array."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499976064, "post_id": 45067150, "comment_id": 77152310, "body": "@Lou This answer is now complete. It includes how to write values from the array/collection/ArrayList into Excel. I would strongly suggest that you clarify whether you are working with VBA (which has typed variables and <code>Collection</code>) or VBScript (which has neither)."}], "tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 1, "last_activity_date": 1506016778, "last_edit_date": 1506016778, "creation_date": 1499892107, "answer_id": 45067150, "question_id": 45066915, "link": "https://stackoverflow.com/questions/45066915/how-to-delete-duplicate-elements-from-vbscript-vba-array-to-use-in-drop-down-box/45067150#45067150", "title": "How to delete duplicate elements from VBscript/VBA array to use in drop down box in Excel", "body": "<p>If I understand correctly, your code has to do the following:</p>\n\n<ol>\n<li>Generate a collection with an arbitrary number of elements, from a string</li>\n<li>Store the elements in the cells of an Excel worksheet</li>\n<li>Get another collection with only the unique elements</li>\n</ol>\n\n<hr>\n\n<h3>1. Generate a collection with an arbitrary number of elements</h3>\n\n<p>The most basic technique is to use <code>Redim Preserve</code> to continuously resize the array:</p>\n\n<pre><code>Dim arr(), j\nj = 0\nDo\n    Redim Preserve arr(j)\n    arr(j) = Mid(MHIScreen, ServLoc, 6)\n    ServLoc = ServLoc + 320\n    j = j + 1\nLoop Until SMonth &gt; EMonth\n</code></pre>\n\n<p>However, if you are using VBA, then a <code>Collection</code> object is the natural choice here, because you don't have to worry about extending the size of the array:</p>\n\n<pre><code>Dim col As New Collection\nDo\n    col.Add Mid(MHIScreen, ServLoc, 6)\n    ServLoc = ServLoc + 320\nLoop Until SMonth &gt; EMonth\n</code></pre>\n\n<p>If you are using VBScript, then I would suggest using a .NET <a href=\"https://msdn.microsoft.com/en-us/library/system.collections.arraylist%28v=vs.113%29.aspx\" rel=\"nofollow noreferrer\"><code>ArrayList</code></a> in the same way (<a href=\"http://www.robvanderwoude.com/vbstech_data_arraylist.php\" rel=\"nofollow noreferrer\">besides its many other benefits</a>):</p>\n\n<pre><code>Dim al\nSet al = CreateObject(\"System.Collections.ArrayList\")\nDo\n    al.Add Mid(MHIScreen, ServLoc, 6)\n    ServLoc = ServLoc + 320\nLoop Until SMonth &gt; EMonth\n</code></pre>\n\n<p>NB. In your <a href=\"https://stackoverflow.com/questions/45066915/how-to-delete-duplicate-elements-from-vbscript-vba-array-to-use-in-drop-down-box/45067150#comment77136346_45067150\">comment</a>, you mentioned sorting the array. One of the benefits of <code>ArrayList</code> over <code>Collection</code> is that it has built-in sorting, via the <a href=\"https://msdn.microsoft.com/en-us/library/8k6e334t(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>Sort</code> method</a>. If sorting the values is also a goal, I would use an <code>ArrayList</code> even in VBA.</p>\n\n<hr>\n\n<h3>2. Store the elements in the cells of an Excel worksheet</h3>\n\n<p>If you're using an array, you can simply set the <code>Value</code> property of an appropriately sized range. For an array:</p>\n\n<pre><code>'app is a variable referring to the Excel Application instance\nDim rng\nSet rng = app.Workbooks(\"MyWorkbook\").Worksheets(\"MyWorksheet\").Range(\"D4\").Resize(UBound(arr) + 1, 1)\nrng.Value = xlApp.WorksheetFunction.Transpose(arr)\n</code></pre>\n\n<p>For a collection or an ArrayList, you have to iterate and write the values by hand. A collection's first index is <code>1</code>:</p>\n\n<pre><code>Dim rng As Range, i As Integer\nSet rng = ActiveSheet.Range(\"A1\")\nFor i = 1 To col.Count\n    rng.Value = col.Item(i)\n    Set rng = rng.Offset(1)\nNext\n</code></pre>\n\n<p>while an ArrayList's first index is <code>0</code>:</p>\n\n<pre><code>Dim rng, i\nSet rng = Application.Workbooks(\"MyWorkbook\").Worksheets(\"MyWorksheet\").Range(\"D4\")\nFor i = 0 To al.Count -1\n    rng.Value = al.Item(i)\n    Set rng = rng.Offset(1)\nNext\n</code></pre>\n\n<hr>\n\n<h3>3. Get another collection with only the unique elements</h3>\n\n<p>You can use a <a href=\"https://msdn.microsoft.com/en-us/library/x4k5wbx4(v=vs.84).aspx\" rel=\"nofollow noreferrer\">Scripting.Dictionary</a> for this purpose:</p>\n\n<pre><code>Dim dict, x\nSet dict  = CreateObject(\"Scripting.Dictionary\")\nFor Each x In arr 'can be used equally well with a Collection or an ArrayList\n    dict(x) = 1 '1 is a dummy value\nNext\n\n'prints the keys of the dictionary, which are unique\nFor Each x In dict.Keys\n    Debug.Print x\nNext\n</code></pre>\n\n<hr>\n\n<p>The code in your <a href=\"https://stackoverflow.com/a/45089286/111794\">answer</a> can be simplified as follows:</p>\n\n<ol>\n<li>As long as you use the default <code>Item</code> property, there is no need to check if the key already exists in the dictionary. Only if you use the <code>Add</code> method will you have a problem when adding an existing key.</li>\n<li>You can iterate over the keys in the dictionary directly; you don't need a second array:</li>\n</ol>\n\n<p>Like so:</p>\n\n<pre><code>Dim objDictionary, strItem\nSet objDictionary = CreateObject(\"Scripting.Dictionary\")\nFor Each strItem In Serv\n    objDictionary(strItem) = 1\nNext\nFor Each strItem In objDictionary.Keys\n    Sheet1.RHICodes.AddItem strItem\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499951554, "post_id": 45067755, "comment_id": 77135986, "body": "Ok...assuming <code>data()</code> is referring to <code>Serv(i)</code>, is there a specific way to send the data? I added your code, then added <code>Call RemoveDupsAndSort(Serv(i))</code> to see if it would work and I get an error message saying <code>Type mismatch: array or user-defined type expected</code>. When I have <code>Call RemoveDupsAndSort(Serv(i) As String)</code>, it highlights &quot;As&quot; and I get <code>Expected: list separator or )</code>. What am I doing wrong?"}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "reply_to_user": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499951730, "post_id": 45067755, "comment_id": 77136138, "body": "Just pass &#39;Serv&#39; to the function."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499952257, "post_id": 45067755, "comment_id": 77136567, "body": "I still receive the same type mismatch error. It stops at the opening line for the function that <code>Serv(i)</code> is in and gives the mismatch error. Nothing ever gets put into <code>Serv(i)</code>."}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "reply_to_user": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499952761, "post_id": 45067755, "comment_id": 77136991, "body": "@Lou I modified my example to hopefully show you how to call the function."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499953677, "post_id": 45067755, "comment_id": 77137685, "body": "There must be something I&#39;m doing wrong. Now it&#39;s highlighting <code>Serv</code> in your modified code and still giving the type mismatch. I have <code>Dim Serv(200) As String</code>. Should that be <code>Dim Serv(200) As Array</code>? Never mind...no such thing. Not sure how my array could be a type mismatch."}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "reply_to_user": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499954179, "post_id": 45067755, "comment_id": 77138116, "body": "@Lou &#39;Dim Serv(200) As String&#39; should be perfect.  I am not sure what the issue could be."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499957335, "post_id": 45067755, "comment_id": 77140696, "body": "I decided to take all the code out of your function and place it where I was calling the function instead of actually calling it, then changed all <code>data()</code> to <code>Serv()</code>. Now, this is giving me the type mismatch error: <code>c.Add Serv(g), Serv(g)</code>. Any ideas? I&#39;ve worked with regular variables, but arrays are fairly new to me. I know how they work, but passing their contents to some other entity is beyond me at this point. I hope to learn something out of this."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499957472, "post_id": 45067755, "comment_id": 77140795, "body": "It seems <code>g</code> never increments in the <code>For...Next</code> loop. It&#39;s showing 0. That, and <code>Serv(g)</code> is empty."}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "reply_to_user": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499959373, "post_id": 45067755, "comment_id": 77142345, "body": "Verify that Serv has the data you expect when your Do Loop finishes."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499963771, "post_id": 45067755, "comment_id": 77145304, "body": "Ok...I tried that. I added <code>MsgBox Serv(10)</code> at the end of the loop and I was able to pull up one of the service codes, so there is data in the array. I&#39;m just not sure how to get it out of the array for sorting. I haven&#39;t found anything on the internet close to what I need to do. You and Zev are helping, but I&#39;m not able to see the results. You got me close to a solution, but I&#39;m still unsure why I can&#39;t sort through the array."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1499964477, "post_id": 45067755, "comment_id": 77145720, "body": "I think I found the error. I stepped through each line in Excel and it <code>Set c = New Collection</code>, it set <code>g</code> to 0, which is the <code>LBound</code> of my array, then, after going to <code>For h = 1 To c.Count</code>, it goes straight to <code>If h - 1 = c.Count Then c.Add Serv(g), Serv(g)</code>. Seeing as the <code>For</code> loop sets <code>h = 1</code> in the first round, not sure why it skipped over the code within, but <code>c.Count</code> is 0 and <code>h - 1</code> is also 0...that&#39;s why it goes to <code>c.Add Serv(g), Serv(g)</code> and errors out. Now, if I only knew enough about this process to fix it..."}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": false, "score": 1, "last_activity_date": 1499952707, "last_edit_date": 1499952707, "creation_date": 1499894672, "answer_id": 45067755, "question_id": 45066915, "link": "https://stackoverflow.com/questions/45066915/how-to-delete-duplicate-elements-from-vbscript-vba-array-to-use-in-drop-down-box/45067755#45067755", "title": "How to delete duplicate elements from VBscript/VBA array to use in drop down box in Excel", "body": "<p>Assuming you have an array of string containing your output, the following code will produce your desired result:</p>\n\n<pre><code>Public Function TestRemoveDupsAndSort()\n\n   'all your preceding code has been removed for clarity\n\n   Do\n      Serv(j) = Mid(MHIScreen, ServLoc, 6)\n      Range(\"D\" &amp; Row).Value = Serv(j)\n      ServLoc = ServLoc + 320\n      j = j + 1\n      Row = Row + 1\n   Loop Until SMonth &gt; EMonth\n\n   result = RemoveDupsAndSort(Serv)\nEnd Function\n\n\n\nPublic Function RemoveDupsAndSort(data() As String) As String()\n   On Error Resume Next\n\n   Dim i As Integer\n   Dim j As Integer\n   Dim c As Collection\n   Dim d() As String\n\n   'sort and remove dups\n   Set c = New Collection\n\n   For i = LBound(data) To UBound(data)\n      For j = 1 To c.Count\n         If data(i) &lt; c(j) Then\n            c.Add data(i), data(i), j\n         End If\n      Next\n\n      If j - 1 = c.Count Then c.Add data(i), data(i)\n   Next\n\n   'convert from a collection back to an array\n   ReDim d(0 To c.Count - 1)\n\n   For i = 0 To c.Count - 1\n      d(i) = c(i + 1)\n   Next\n\n   RemoveDupsAndSort= d\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1499979828, "post_id": 45089286, "comment_id": 77154254, "body": "Why do you need to check if <code>objDictionary.Exists(strItem)</code>? Don&#39;t use <code>Add</code>; rather use the default property: <code>objDictionary(strItem) = strItem</code>."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1499979916, "post_id": 45089286, "comment_id": 77154292, "body": "Also, you don&#39;t need a second array for this; you can iterate over the dictionary&#39;s keys directly: <code>For Each strItem In objDictionary.Items: Sheet1.RHICodes.AddItem strItem: Next</code>"}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1500296382, "post_id": 45089286, "comment_id": 77258604, "body": "@Zev Spitz I copied the code from the URL below.  It had some of the elements of your <code>Scripting.Dictionary</code> example, but I needed to change a few variables to suit my needs.  I ran it once and it did exactly what I needed.  I can play around with your suggestions once I&#39;m finished with the rest of the project as I have a lot more to develop.  Thanks for all your advice.  It is greatly appreciated. <a href=\"https://blogs.technet.microsoft.com/heyscriptingguy/2006/10/27/how-can-i-delete-duplicate-items-from-an-array/\" rel=\"nofollow noreferrer\">blogs.technet.microsoft.com/heyscriptingguy/2006/10/27/&hellip;</a>"}], "tags": [], "owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "is_accepted": true, "score": 0, "last_activity_date": 1499973431, "creation_date": 1499973431, "answer_id": 45089286, "question_id": 45066915, "link": "https://stackoverflow.com/questions/45066915/how-to-delete-duplicate-elements-from-vbscript-vba-array-to-use-in-drop-down-box/45089286#45089286", "title": "How to delete duplicate elements from VBscript/VBA array to use in drop down box in Excel", "body": "<p>Thanks to those who reached out to help me. With their combined efforts, and a little extra research on what they were trying to tell me, I have came up with a solution that works.</p>\n\n<pre><code>Dim objDictionary, strItem, intItems, p, strKey, CodeList\nSet objDictionary = CreateObject(\"Scripting.Dictionary\")\n\nFor Each strItem In Serv\n    If Not objDictionary.Exists(strItem) Then\n        objDictionary.Add strItem, strItem\n    End If\nNext\n\nintItems = objDictionary.Count - 1\nReDim arrItems(intItems)\np = 0\n\nFor Each strKey In objDictionary.Keys\n    arrItems(p) = strKey\n    p = p + 1\nNext\n\nFor Each strItem In arrItems\n    With Sheet1.RHICodes\n        .AddItem strItem\n    End With\nNext\n</code></pre>\n\n<p>This now takes all of the service codes that I collected from IBM PCOMM, enters them into an array, uses the <code>Scripting.Dictionary</code> to sort them, then create another array with only the options I want with no duplicates and enters them into a drop down box.</p>\n"}], "owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 835, "favorite_count": 0, "accepted_answer_id": 45089286, "answer_count": 3, "score": 0, "last_activity_date": 1506016778, "creation_date": 1499891177, "question_id": 45066915, "link": "https://stackoverflow.com/questions/45066915/how-to-delete-duplicate-elements-from-vbscript-vba-array-to-use-in-drop-down-box", "title": "How to delete duplicate elements from VBscript/VBA array to use in drop down box in Excel", "body": "<p>I'm finding a lot of articles close to mine, but not quite what I'm looking for. I'm working with the IBM Personal Communications emulator to gather patient history data. There can be several pages of claims on the patient history, so the service codes used later in the program need to be gathered and saved in an array. Once duplicates are removed, the remaining codes will be stored in a drop down box.</p>\n\n<pre><code>' Copies entire current history screen\nMHIScreen = objUNET.autECLPS.GetText(3, 1, 1680)\n\n' Location of the place of service code header\nPOSLoc = InStr(MHIScreen, \"PS  SVC\")\n\n' Location of service code\nServLoc = POSLoc + 3\n\n' Used for array index\nj = 1\nRow = 4\n\nDo\n    Serv(j) = Mid(MHIScreen, ServLoc, 6)\n    Range(\"D\" &amp; Row).Value = Serv(j)\n    ServLoc = ServLoc + 320\n    j = j + 1\n    Row = Row + 1\nLoop Until SMonth &gt; EMonth\n</code></pre>\n\n<p>The output of this could look like this:</p>\n\n<pre><code>12345\n12345\n23456\n12345\n34567\n34567\n12345\n98765\n</code></pre>\n\n<p>The desired result would be to filter through the duplicates and end up with this:</p>\n\n<pre><code>12345\n23456\n34567\n98765\n</code></pre>\n\n<p>These would the be put into a drop down box for the user to choose from. I wanted to see where in the element one particular code would be located, but when I add the following line of code, I get 0 because j is already higher than the index of the last code and <code>Serv(j)</code> is empty:</p>\n\n<pre><code>Result = InStr(Serv(j), \"34567\")\n</code></pre>\n\n<p>Is there anyone who can guide me to a solution?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499891123, "post_id": 45066852, "comment_id": 77107069, "body": "Have you tried to record a macro in Word to see how Word does it?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499896665, "post_id": 45066852, "comment_id": 77109620, "body": "FWIW - I was feeling bored, so just spent about a minute and googled for solutions to this within stackoverflow.com.  Although I didn&#39;t find one single page that answered both of your questions, I found <a href=\"https://stackoverflow.com/q/8729424/6535336\">this one</a> which shows how to change alignment, and <a href=\"https://stackoverflow.com/q/6330330/6535336\">this one</a> which shows how to change direction.  (I ignored the search results pointing to <a href=\"https://msdn.microsoft.com/VBA/Word-VBA/articles/paragraphformat-object-word\" rel=\"nofollow noreferrer\">MSDN</a> that I found by googling the question title, as that seemed too easy.)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8298214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b49577913463292a3d059b13838875?s=128&d=identicon&r=PG&f=1", "display_name": "AliM", "link": "https://stackoverflow.com/users/8298214/alim"}, "is_accepted": false, "score": 0, "last_activity_date": 1499891609, "last_edit_date": 1499891609, "creation_date": 1499891189, "answer_id": 45066918, "question_id": 45066852, "link": "https://stackoverflow.com/questions/45066852/how-to-change-text-alignment-and-direction-in-word-document-using-vba-macro/45066918#45066918", "title": "How to change text alignment and direction in Word document using VBA macro?", "body": "<pre><code>Set objWord = CreateObject(\"Word.Application\")\nSet obj = objWord.Documents.Open(\"path\\to\\file\")\n\nDim par\nDim myParas\nSet myParas = obj.Paragraphs\n\nFor i = 1 To myParas.Count '''Iterate over all paragraphs\nSet par =myParas(i)\npar.ReadingOrder = xlRTwdReadingOrderRtl '''set text direction(aka Reading Order)\npar.Range.ParagraphFormat.Alignment = 3\nNext\n\nobj.save\nobj.close\n</code></pre>\n\n<p>Also you can run it from cmd with cscript.exe</p>\n"}], "owner": {"reputation": 1, "user_id": 8298214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b49577913463292a3d059b13838875?s=128&d=identicon&r=PG&f=1", "display_name": "AliM", "link": "https://stackoverflow.com/users/8298214/alim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1099, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1499891609, "creation_date": 1499890919, "last_edit_date": 1499891569, "question_id": 45066852, "link": "https://stackoverflow.com/questions/45066852/how-to-change-text-alignment-and-direction-in-word-document-using-vba-macro", "title": "How to change text alignment and direction in Word document using VBA macro?", "body": "<p>I was searching for paragraph text direction changing using macro for Word doc and I got nothing.</p>\n\n<p>I just found solution for Excel cells:\n<a href=\"http://software-solutions-online.com/excel-vba-reading-order/\" rel=\"nofollow noreferrer\">http://software-solutions-online.com/excel-vba-reading-order/</a></p>\n"}, {"tags": ["forms", "ms-access", "vba"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1499890455, "post_id": 45066467, "comment_id": 77106771, "body": "You are making it <i>way</i> too complicated. Browse for a tutorial: &quot;Beginning with Microsoft Access&quot; or similar and look up the very basics: Filtering a bound form."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1499890494, "post_id": 45066467, "comment_id": 77106790, "body": "Start by decompiling the database: <a href=\"https://stackoverflow.com/documentation/ms-access/8207/how-to-troubleshoot-access-crashes/26371/decompile-database#t=20170712201408237706\">stackoverflow.com/documentation/ms-access/8207/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 530036, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/00cc278bcd95dfe8f60e637b52585db7?s=128&d=identicon&r=PG", "display_name": "BB ON", "link": "https://stackoverflow.com/users/530036/bb-on"}, "is_accepted": false, "score": 0, "last_activity_date": 1500039200, "creation_date": 1500039200, "answer_id": 45104345, "question_id": 45066467, "link": "https://stackoverflow.com/questions/45066467/access-form-fields-permanently-broken-after-recordset-close/45104345#45104345", "title": "Access -- Form fields permanently broken after Recordset.close", "body": "<p>This solved the problem but does not provide me with any insight. </p>\n\n<p>Under <code>Form Design Tools &gt; Design &gt; Tools &gt; Add Existing Fields</code> I dragged and dropped a second copy of each of the problem fields onto the form then immediately deleted it. When the form was reloaded, everything worked properly. </p>\n"}], "owner": {"reputation": 251, "user_id": 530036, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/00cc278bcd95dfe8f60e637b52585db7?s=128&d=identicon&r=PG", "display_name": "BB ON", "link": "https://stackoverflow.com/users/530036/bb-on"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500039200, "creation_date": 1499889383, "question_id": 45066467, "link": "https://stackoverflow.com/questions/45066467/access-form-fields-permanently-broken-after-recordset-close", "title": "Access -- Form fields permanently broken after Recordset.close", "body": "<p>I have a form with several text and combo boxes bound to records of a table, which we'll call \"Foo\". </p>\n\n<p>\"Foo\" is a filtered down copy of a larger table \"Bar\". This was done to allow reversible edits to Foo, which would be merged back into Bar when the user was finished editing</p>\n\n<p>My implementation of reverting a specific record back to Bar's copy worked but caused <a href=\"https://stackoverflow.com/questions/7965455/access-vba-run-time-error-3197\">Run-time error '3197'</a> when form's recordset was modified any time after.</p>\n\n<p>To workaround this I thought of closing my form's recordset, running my query, then reopening it, so that there wouldn't be any fights over usage. I put <code>Me.recordset.close</code> before running the revert query, but this caused the bound fields in my form to permanently break: </p>\n\n<p><a href=\"https://i.stack.imgur.com/fv8mH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fv8mH.png\" alt=\"enter image description here\"></a></p>\n\n<p>This persists even when closing the form, and even when closing Access. The listbox in the form which shows the table data works fine, as does the primaryID field and the query, so I don't understand what the problem is. This event is triggered by a button press, so why would the recordset not be restored when the form is reloaded?</p>\n\n<p>How can I fix this without reverting to an earlier version of the Access file? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1499889107, "post_id": 45066378, "comment_id": 77106095, "body": "Where is the loop where you iterate through the sheets?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1499889489, "post_id": 45066378, "comment_id": 77106288, "body": "Is it the <code>data_piece</code> variable you want to hold all of those concatenated values, or is it whatever the output to <code>write_event(data_piece)</code> is that should hold them all. Like... is it your <code>msgbox()</code> that you expecting all the concatenated stuff or some other place that isn&#39;t shown here in this snippet?"}, {"owner": {"reputation": 7, "user_id": 7998675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48d72035271c4c2fac240ec9976a5d9?s=128&d=identicon&r=PG&f=1", "display_name": "LiCarroll", "link": "https://stackoverflow.com/users/7998675/licarroll"}, "edited": false, "score": 0, "creation_date": 1499889577, "post_id": 45066378, "comment_id": 77106328, "body": "The loop where I iterate between sheets is not shown"}, {"owner": {"reputation": 7, "user_id": 7998675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48d72035271c4c2fac240ec9976a5d9?s=128&d=identicon&r=PG&f=1", "display_name": "LiCarroll", "link": "https://stackoverflow.com/users/7998675/licarroll"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1499889703, "post_id": 45066378, "comment_id": 77106389, "body": "@JNevill I use data_piece to initially store all these concatenated data and I run that through MsgBox just for debugging purposes. MsgBox will not be part of the fnished program. I send data_piece to another sub that handles the writing of all these concantenated strings to another sheet."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1499889706, "post_id": 45066378, "comment_id": 77106391, "body": "Well we would need to see that to help.  as your code is written it only effects the active sheet and if you are using <code>.Activate</code> to achieve this, it is the slow method and can be improved."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1499889828, "post_id": 45066378, "comment_id": 77106456, "body": "So each time you iterate a cell you set your <code>data_piece</code> back to empty. Then you fill it again with the new cell values. It&#39;s fine for debugging, but unless you capture the previous value (the value in the current loop) to some other variable or place in your sheet then it will be lost as soon as the next iteration hits."}, {"owner": {"reputation": 7, "user_id": 7998675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48d72035271c4c2fac240ec9976a5d9?s=128&d=identicon&r=PG&f=1", "display_name": "LiCarroll", "link": "https://stackoverflow.com/users/7998675/licarroll"}, "edited": false, "score": 0, "creation_date": 1499889939, "post_id": 45066378, "comment_id": 77106519, "body": "The sub where I write the data isnt the problem. The problem is in this code block, as MsgBox is not displaying what I want it to. Ive been debugging with msgbox because I need to make sure Im sending the correct info to my write_event sub"}, {"owner": {"reputation": 7, "user_id": 7998675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48d72035271c4c2fac240ec9976a5d9?s=128&d=identicon&r=PG&f=1", "display_name": "LiCarroll", "link": "https://stackoverflow.com/users/7998675/licarroll"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1499890021, "post_id": 45066378, "comment_id": 77106563, "body": "@JNevill which is why I send it to write_event(data_piece). That subroutine handles the storing of my information on another sheet."}, {"owner": {"reputation": 7, "user_id": 7998675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48d72035271c4c2fac240ec9976a5d9?s=128&d=identicon&r=PG&f=1", "display_name": "LiCarroll", "link": "https://stackoverflow.com/users/7998675/licarroll"}, "edited": false, "score": 0, "creation_date": 1499890142, "post_id": 45066378, "comment_id": 77106614, "body": "I believe the problem lies in how I am attempting to grab the bits of information related to my current cell."}, {"owner": {"reputation": 908, "user_id": 2322977, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/49c196ad6e4365c8f219c89030597728?s=128&d=identicon&r=PG", "display_name": "ainwood", "link": "https://stackoverflow.com/users/2322977/ainwood"}, "edited": false, "score": 0, "creation_date": 1499890182, "post_id": 45066378, "comment_id": 77106634, "body": "Try using <code>Debug.Print cell.address &amp; &quot;: &quot; &amp; cell.value</code> to help you work out whether it is looking at the correct cell or not."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1499890414, "post_id": 45066378, "comment_id": 77106752, "body": "Which is my point. Your message box doesn&#39;t know what&#39;s already been stored. It only knows what&#39;s in that <code>data_piece</code> variable. If you are expecting to see everything that&#39;s been stored in your other sheet previous to the cell you are currently on then you are mistaken."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1499890976, "post_id": 45066378, "comment_id": 77107008, "body": "It would help to see a small example of your data and expected outcome.  It is hard to interpret what is going wrong without background."}, {"owner": {"reputation": 7, "user_id": 7998675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48d72035271c4c2fac240ec9976a5d9?s=128&d=identicon&r=PG&f=1", "display_name": "LiCarroll", "link": "https://stackoverflow.com/users/7998675/licarroll"}, "edited": false, "score": 0, "creation_date": 1499891456, "post_id": 45066378, "comment_id": 77107240, "body": "Ive fixed it. Thanks for you help. I ended up hardcoding the row each cell should reference. A backhanded way of fixing the problem, but at least it works."}], "owner": {"reputation": 7, "user_id": 7998675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f48d72035271c4c2fac240ec9976a5d9?s=128&d=identicon&r=PG&f=1", "display_name": "LiCarroll", "link": "https://stackoverflow.com/users/7998675/licarroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542611000, "creation_date": 1499888989, "last_edit_date": 1542611000, "question_id": 45066378, "link": "https://stackoverflow.com/questions/45066378/issue-with-string-concatenation-vba", "title": "Issue with string concatenation - VBA", "body": "<p>I am writing a Sub that goes through 3 different worksheets and goes through a specific row in each of them (same row on each sheet) and if the cell does not equal 0 it collects some information about that cell. The three worksheets are large tables with dates of the month on the y-axis, and then different meters that we receive data from on the x-axis. Once my program finds a cell with a value that is not 0, it needs to grab information about its meter and what location its in. So I have this.</p>\n\n<pre><code>For Each cell In rng\n    If cell.Value &lt;&gt; 0 Then\n        data_piece = \"\"\n        data_piece = Cells(cell.row - (day + 4), cell.Column) &amp; \", \" &amp; \nCells(cell.row - (day + 1)) &amp; \", \" &amp; cell.Text\n        MsgBox data_piece\n        Call write_event(data_piece)\n    End If\n\nNext cell\n</code></pre>\n\n<p>For the first piece of data it finds it works perfect, and displays something to the affect of \"Peace 20\", Tank 1 to MSO, 500\" but for every data point remaining on that sheet it wont display the first two bits of information. e.g: \",,500\". When my program moves to the next sheet, it will display the first piece of data it finds perfectly, but then wont work for the rest of them on that sheet.</p>\n\n<p>I'm stuck. Why this doesn't work?</p>\n"}, {"tags": ["excel", "vba", "runtime", "transpose"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1499892353, "creation_date": 1499892353, "answer_id": 45067231, "question_id": 45066184, "link": "https://stackoverflow.com/questions/45066184/run-time-error-1004-cant-insert-new-cells-because-it-would-push-non-empty-new-c/45067231#45067231", "title": "Run time error 1004 Can&#39;t insert new cells because it would push non empty new cells off the end of the worksheet", "body": "<p>Try it as,</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n    Dim wsm As Worksheet, i As Long, v As Long, vals As Variant\n\n    Set wsm = Worksheets(\"Master\")\n    If LCase(wsm.Range(\"E3\")) &lt;&gt; \"all agents\" Then\n        v = Application.Subtotal(103, wsm.Range(\"F9:F33\"))\n        If CBool(v) Then\n            ReDim vals(1 To 1, 1 To v + 2)\n            vals(1, 1) = wsm.Range(\"E3\").Value\n            vals(1, 2) = wsm.Range(\"H3\").Value\n            For i = 1 To v\n                vals(1, i + 2) = wsm.Range(\"F9:F33\").SpecialCells(xlCellTypeVisible)(i)\n            Next i\n\n            With Worksheets(\"All\").ListObjects(\"Table24\")\n                .ListRows.Add AlwaysInsert:=False\n                .DataBodyRange.Cells(.DataBodyRange.Rows.Count, 1).Resize(1, UBound(vals, 2)) = vals\n            End With\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8216426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f9669b2496a603bdef7e1aca6da9a3c?s=128&d=identicon&r=PG&f=1", "display_name": "Yujinlove", "link": "https://stackoverflow.com/users/8216426/yujinlove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499892353, "creation_date": 1499888221, "question_id": 45066184, "link": "https://stackoverflow.com/questions/45066184/run-time-error-1004-cant-insert-new-cells-because-it-would-push-non-empty-new-c", "title": "Run time error 1004 Can&#39;t insert new cells because it would push non empty new cells off the end of the worksheet", "body": "<p>I have a VBA that was working perfectly fine until I saved it and opened it again, ran it, and started getting the error.</p>\n\n<p>I'm copying data from Sheets(\"Master\") and transposing this data into Sheets(\"All\"). The problem is that I'm transposing it into a table(identified as a list object) and adding a new row before the paste happens. However, for some reason, it'll transpose in odd areas of the sheet. Sometimes at the place it needs to, sometimes at the very last row on Excel. Because of this, I'll get the Run time 1004 error and I have to go in and find this random cells with data. Because this will not be used by me but is a template workbook, I need to make sure it works smoothly. </p>\n\n<p>Here is the code I am using</p>\n\n<pre><code>If Sheets(\"Master\").Range(\"E3\") &lt;&gt; \"All Agents\" Then\n\nSheets(\"All\").ListObjects(\"Table24\").ListRows.Add\n    Sheets(\"Master\").Range(\"E3\").Copy\n    Sheets(\"All\").Cells(Sheets(\"All\").Range(\"A1\").ListObject.DataBodyRange.Rows.Count + 1, 1).PasteSpecial (xlPasteValues)\n    Sheets(\"Master\").Range(\"H3\").Copy\n    Sheets(\"All\").Cells(Sheets(\"All\").Range(\"B1\").ListObject.DataBodyRange.Rows.Count + 1, 2).PasteSpecial (xlPasteValues)\n    Sheets(\"Master\").Range(\"F9:F33\").SpecialCells(xlCellTypeVisible).Copy\n    Sheets(\"All\").Cells(Sheets(\"All\").ListObject.DataBodyRange.End(xlDown).Row, 3).PasteSpecial xlPasteValues, Transpose:=True\n</code></pre>\n"}, {"tags": ["excel", "vba", "delete-row"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1499887235, "post_id": 45065696, "comment_id": 77105147, "body": "You need to run our loops <b>backwards</b> that is from the bottom up."}, {"owner": {"reputation": 6233, "user_id": 5741073, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1uZeL.jpg?s=128&g=1", "display_name": "TomServo", "link": "https://stackoverflow.com/users/5741073/tomservo"}, "edited": false, "score": 0, "creation_date": 1499887587, "post_id": 45065696, "comment_id": 77105327, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23523945/delete-entire-rows-based-on-cell-values\">Delete Entire Rows Based on Cell Values</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1499888385, "post_id": 45065917, "comment_id": 77105711, "body": "This will still skip rows. If row 17 is deleted then row 18 shifts up to becomes row 17 but you still iterate i so the next loop examines the new row 18, not the new row 17. Put <code>i=i+1</code> into an <code>else</code> when you do not delete a row. (and hope there actually <b>is</b> an <code>end</code> or it will run forever)"}], "tags": [], "owner": {"reputation": 669, "user_id": 6754179, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2646872bfa0b8caf0db917b9afde5920?s=128&d=identicon&r=PG&f=1", "display_name": "ERT", "link": "https://stackoverflow.com/users/6754179/ert"}, "is_accepted": false, "score": 0, "last_activity_date": 1499887215, "creation_date": 1499887215, "answer_id": 45065917, "question_id": 45065696, "link": "https://stackoverflow.com/questions/45065696/delete-row-based-on-cell-contents/45065917#45065917", "title": "Delete Row Based on Cell Contents", "body": "<p>Try this variation of your first code:</p>\n\n<pre><code>Sub DeleteRowMacro1()\n    Dim i As Integer\n    i = 11\n\n    Do\n        Cells(i, 17).Activate\n        If IsEmpty(ActiveCell.Value) Then\n            ActiveCell.EntireRow.Delete\n        End If\n        If ActiveCell.Value = \"END\" Then\n            Exit Do\n        End If\n\n       i = i + 1\n    Loop \n    Range(\"A1:K2\").Select\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1499888000, "post_id": 45066015, "comment_id": 77105542, "body": "If it is best practice to avoid select, etc then parent worksheets should be referenced."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1499888117, "post_id": 45066015, "comment_id": 77105601, "body": "I think <code>end</code> is supposed to be at the bottom of the rows to be examined. The above code might kick out of the loop at the first (bottom) row. I don&#39;t think you need the <code>end</code> examination at all since it should proceed to row 11 from bottom to top."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1499888541, "post_id": 45066015, "comment_id": 77105784, "body": "@Jeeped - Ah, good point about the reference to the worksheet. I edited the code.  Also, yeah didn&#39;t think about the <code>END</code> part. OP - If the <code>END</code> in the worksheet was just a trigger at the last row, you can comment out/delete the first <code>If</code> block.  It&#39;s not clear from your post if you have &quot;END&quot; there as a helper for your macro, or not.  Also, you may need to check for Blanks or <code>.Cell(...).Value = &quot;0&quot;</code> instead of just <code>... = 0</code>."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1499888442, "last_edit_date": 1499888442, "creation_date": 1499887533, "answer_id": 45066015, "question_id": 45065696, "link": "https://stackoverflow.com/questions/45065696/delete-row-based-on-cell-contents/45066015#45066015", "title": "Delete Row Based on Cell Contents", "body": "<p>First, it's best practice to <a href=\"https://stackoverflow.com/questions/10714251/\">avoid using <code>.Select</code>/<code>.Activate</code></a>.  That can cause some confusion and tricky writing when doing loops/macros in general.</p>\n\n<p>Second, it's also best to avoid <code>GoTo</code>.</p>\n\n<p>This macro will start at the last row in column Q, and make its way toward row 11.  If the value of a cell is <code>0</code>, it'll delete the row.  If the value is <code>END</code>, it selects your range and exits the <code>For</code> loop, and then exits the sub.</p>\n\n<pre><code>Sub delRows()\nDim lastRow As Long, i As Long\nDim ws as Worksheet\nSet ws = Worksheets(\"Sheet1\") ' CHANGE THIS AS NECESSARY\nlastRow = ws.Cells(ws.Rows.Count, 17).End(xlUp).Row\n\nFor i = lastRow To 11 Step -1\n    If ws.Cells(i, 17).Value = \"END\" Then\n        ws.Range(\"A1:K2\").Select\n        Exit For\n    End If\n\n    If ws.Cells(i, 17).Value = 0 or ws.Cells(i, 17).Value = \"0\" Then\n        ws.Cells(i, 17).EntireRow.Delete\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1499887900, "creation_date": 1499887900, "answer_id": 45066108, "question_id": 45065696, "link": "https://stackoverflow.com/questions/45065696/delete-row-based-on-cell-contents/45066108#45066108", "title": "Delete Row Based on Cell Contents", "body": "<p>Try it as,</p>\n\n<pre><code>Option Explicit\n\nSub DeleteRowMacro3()\n    Dim rwend As Variant\n    With Worksheets(\"Sheet5\")\n        If .AutoFilterMode Then .AutoFilterMode = False\n        rwend = Application.Match(\"end\", .Range(.Cells(11, \"Q\"), .Cells(.Rows.Count, \"Q\")), 0)\n        If Not IsError(rwend) Then\n            With .Range(.Cells(10, \"Q\"), .Cells(rwend + 10, \"Q\"))\n                .AutoFilter Field:=1, Criteria1:=0, Operator:=xlOr, Criteria2:=vbNullString\n                With .Resize(.Rows.Count - 1, 1).Offset(1, 0)\n                    If CBool(Application.Subtotal(103, .Cells)) Then\n                        .SpecialCells(xlCellTypeVisible).EntireRow.Delete\n                    End If\n                End With\n            End With\n        End If\n        .Activate\n        .Range(\"A1:K2\").Select\n        If .AutoFilterMode Then .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n\n<p>I wasn't sure if you were looking specifically for zeroes or zero value so I included blank cells as well as numerical zeroes.</p>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 10862482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b8bf0ff117495d6d326222f6c4cb94a?s=128&d=identicon&r=PG", "display_name": "umdjb", "link": "https://stackoverflow.com/users/10862482/umdjb"}, "is_accepted": false, "score": 0, "last_activity_date": 1547376496, "creation_date": 1547376496, "answer_id": 54168105, "question_id": 45065696, "link": "https://stackoverflow.com/questions/45065696/delete-row-based-on-cell-contents/54168105#54168105", "title": "Delete Row Based on Cell Contents", "body": "<p>Try this simpler, and faster version. It will locate all of the cells you want to delete, store them in a range object, and then delete them all at once at the end. </p>\n\n<pre><code>Public Sub DeleteRowsWithRange()\n\n    Dim rngLoop As Range\n    Dim rngMyRange As Range\n\n        For Each rngLoop In Columns(\"Q\").Cells\n\n        If rngLoop.Value = \"END\" Then\n            Exit For\n        ElseIf rngLoop.Value = 0 Then\n            If rngMyRange Is Nothing Then\n                Set rngMyRange = rngLoop.EntireRow\n            Else\n                Set rngMyRange = Union(rngMyRange, rngLoop.EntireRow)\n            End If\n        End If\n\n        Next rngLoop\n\n        If Not rngMyRange Is Nothing Then rngMyRange.Delete xlShiftUp\n\n        Range(\"A1\").Activate\n\n        Set rngLoop = Nothing\n        Set rngMyRange = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8297354, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3vLvcbLZMSg/AAAAAAAAAAI/AAAAAAAAATg/-cZjBpxin_Q/photo.jpg?sz=128", "display_name": "Bridget Tharp", "link": "https://stackoverflow.com/users/8297354/bridget-tharp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5884, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1555376817, "creation_date": 1499886365, "last_edit_date": 1555376817, "question_id": 45065696, "link": "https://stackoverflow.com/questions/45065696/delete-row-based-on-cell-contents", "title": "Delete Row Based on Cell Contents", "body": "<p>I'm trying to check the contents of the cells in column Q and delete the rows that have a 0 in that column.</p>\n\n<p>The macro should start checking in column Q at cell Q11 and stop when it encounters the cell containing the text \"END\". When finished it should select the cell at the upper left corner of the spreadsheet, which would normally be A1, but I have a merged cell there, so it's A1:K2. </p>\n\n<p>Here are my two most recent versions of the macro:</p>\n\n<pre><code>'My second to last attempt\n\nSub DeleteRowMacro1()\n    Dim i As Integer\n    i = 11\n\n    Do\n        Cells(i, 17).Activate\n\n        If ActiveCell.Value = 0 Then\n            ActiveCell.EntireRow.Delete\n        End If\n\n       i = i + 1\n    Loop Until ActiveCell.Value = \"END\"\n    Range(\"A1:K2\").Select\nEnd Sub\n\n\n\n\n'My last attempt\n\nSub DeleteRowMacro2()\n    Dim i As Integer\n        i = 11\n        GoTo Filter\nFilter:\n        Cells(i, 17).Activate\n        If ActiveCell.Value = \"END\" Then GoTo EndingCondition\n        If ActiveCell.Value = \"\" Then GoTo KeepCondition\n        If ActiveCell.Value = 0 Then GoTo DeleteCondition\n        If ActiveCell.Value &gt; 0 Then GoTo KeepCondition\n\nEndingCondition:\n        Range(\"A1:K2\").Select\nKeepCondition:\n        i = i + 1\n        GoTo Filter\nDeleteCondition:\n        ActiveCell.EntireRow.Delete\n        i = i + 1\n        GoTo Filter\n\nEnd Sub\n</code></pre>\n\n<p><strong>What DeleteRowMacro1() Does:</strong></p>\n\n<p>It leaves the row if there is text or a number greater than 0 in column Q, but it deletes the rows with cells with a 0 AND blank cells. I want to keep the rows with the blank cells. </p>\n\n<p>This macro seems to be incapable of checking the 450 or so cells between the Q11 and the cell with \"END\" in one run. It only deletes about half of the rows it should each time. The first 10 or so rows are always done correctly, but then it appears to randomly choose rows with a zero or a blank in column Q to delete.</p>\n\n<p>If I run the macro 7 or 8 times, it will eventually delete all of the rows with a 0 and the ones that are blank too. I would like it to completely do it's job in one run and not delete the rows with blank cells.</p>\n\n<p><strong>What DeleteRowMacro2() Does:</strong></p>\n\n<p>It never stops at \"END\".</p>\n\n<p>I have to run it 7 or 8 times to completely get rid of all of the rows with a 0 in column Q. It also appears to randomly check cells for deletion (and once again besides the first 10 or so). </p>\n\n<p>Because it never ends when I run it, the area of my screen where the spreadsheet is turns black and all I can see there is the green selected cell box flickering up and down at random locations in the Q column until it gets to a row number in the 32,000s. After that my screen returns to show the normal white spreadsheet and a box appears that says Run-time error '6': Overflow. </p>\n\n<p><em>Please note: After I click \"End\" on the error box I can see that the macro worked as described above.</em></p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 11, "user_id": 8172081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345984bc575d6ae553276d185e8633d3?s=128&d=identicon&r=PG&f=1", "display_name": "Jzvier", "link": "https://stackoverflow.com/users/8172081/jzvier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2664, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1500483333, "creation_date": 1499885121, "last_edit_date": 1500483333, "question_id": 45065391, "link": "https://stackoverflow.com/questions/45065391/vba-populate-listbox-in-userform-with-data-from-table-using-value-from-cell-in", "title": "VBA - Populate listbox in userform with data from table using value from cell in other sheet", "body": "<p>I have an excel file with three sheets. Sheet1 has a combobox (A1) and a cell (B1) that open an userform (that has a listbox) when is clicked (only when the combobox has a value). Sheet2 has a list of names of people (10 in total, from here the combobox get the list). Sheet3 has a table with 3 columns: Name, Place, Phone, in here the names are the same from sheet2, but because of the column Place and Phone, some values are repeated in name, ex: </p>\n\n<ol>\n<li>John, House, 312323 </li>\n<li>John, Work, 123142</li>\n</ol>\n\n<p>What i'm trying to do is to populate the listbox with the data from Sheet3 using the value from the combobox from Sheet1, ex: select Jonh in the combobox and click in the cell to open the userform, the opened userform shows the listbox with data of john (the same i use in first example).</p>\n\n<p>Using <code>Range(Cells(Selection.Row, 1).Address).Value</code> i can get the value from the combobox in the same row of the cell that active the userform, but i don't know how to populate the listbox.</p>\n\n<p>Edit: using this code i was able to do the trick</p>\n\n<pre><code>Dim LR As Long\nDim r As Long\nDim i As Long\n    ListBoxEmails.Clear\n    With Sheets(\"MaeProv\") 'sheet3\n        LR = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row 'Range column A Sheet3\n        For r = 2 To LR\n            If .Cells(r, 1).Value = Range(Cells(Selection.Row, 1).Address).Value Then \n                ListBoxData.AddItem .Cells(r, 2).Value 'populate listbox with data from column B and C of the same row of data (using data validation in cell A1 of sheet1 with list of names in sheet2)\n                ListBoxData.List(i, 1) = .Cells(r, 3).Value\n                i = i + 1\n            End If\n        Next r\n    End With\n</code></pre>\n"}, {"tags": ["database", "vba", "excel", "ms-office"], "comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 1, "creation_date": 1499884079, "post_id": 45065023, "comment_id": 77103407, "body": "The best way is to import that big data into data model of a new workbook and then you can insert a pivot table based on tables in the data model with the help of PowerPivot Add-in and you may then also utilize the power of dax functions. And since this new workbook will contain all your data in the data model, the file size of this workbook will be reasonable as well."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1499884282, "post_id": 45065023, "comment_id": 77103520, "body": "This question doesn&#39;t seem to fit the guidelines for the community (see: <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>). That said, this sounds more like either a database problem, or a modeling problem. I am not very well versed in databases or their structures so I cant speak to that end. On the modeling end though you have a few solutions. You can learn about VBA Arrays, Dictionaries, Classes, etc and (over time) develop a solution that will be efficient, dynamic, and scalable. On the other hand, you can look for performance improvements within PivotTables, Calculations, etc."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499884400, "post_id": 45065023, "comment_id": 77103593, "body": "A note on using VBA to do modeling: in my own work I worked on a project where I aggregated, modeled, and analyzed 670MB of data that spread over two years. The capability is there, but you just need to hunt down the skills to use that capability."}, {"owner": {"reputation": 67, "user_id": 8070231, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f13411cbe237bcf9563f415b807b7b0f?s=128&d=identicon&r=PG&f=1", "display_name": "mxhryvo", "link": "https://stackoverflow.com/users/8070231/mxhryvo"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1499887249, "post_id": 45065023, "comment_id": 77105154, "body": "@sktneer but all the data in one workbook would probably make the whole excel sheet too slow. So it would work, but the performance wouldnt fit for daily use of the workbook."}, {"owner": {"reputation": 67, "user_id": 8070231, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f13411cbe237bcf9563f415b807b7b0f?s=128&d=identicon&r=PG&f=1", "display_name": "mxhryvo", "link": "https://stackoverflow.com/users/8070231/mxhryvo"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1499889866, "post_id": 45065023, "comment_id": 77106482, "body": "@sktneer: I now know what you meant to do with powerPivot but I want to analyse the data row for row and not want to have a sum or average for the columns. So I would have to transpose all data sets. But I want to have averages for the financial data of the last years for every stock seperately. Not averages for every year about all the stocks at once."}], "owner": {"reputation": 67, "user_id": 8070231, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f13411cbe237bcf9563f415b807b7b0f?s=128&d=identicon&r=PG&f=1", "display_name": "mxhryvo", "link": "https://stackoverflow.com/users/8070231/mxhryvo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499887382, "creation_date": 1499883781, "last_edit_date": 1499887382, "question_id": 45065023, "link": "https://stackoverflow.com/questions/45065023/how-to-analyze-big-excel-data-fast", "title": "How to analyze big excel data fast?", "body": "<p>I have an excel database with many tables(over 40+) that all have annual financial data for over 10k stocks.\nThey all look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JGS4o.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JGS4o.jpg\" alt=\"Like This\"></a></p>\n\n<p>This excel file has over 100MB of data because every data set has over 10.000 rows with like 50 columns (for 50years in the past).</p>\n\n<p>Now I want to calculate averages and other key figures for every stock and every data set (for example 5 Year average profit). So I need some of the data of last years for every stock and calculate an average.</p>\n\n<p><a href=\"https://i.stack.imgur.com/SIDje.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SIDje.jpg\" alt=\"basic example of analysis table\"></a></p>\n\n<p>The problem is that the excel query function isn't doing well with such mass of data and doing the same averages every table is too much work. Especially if next year 2018 is added as a column and I have to change everything again. However the averages should update if I change something in the data source.</p>\n"}, {"tags": ["excel", "function", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1499889191, "post_id": 45064859, "comment_id": 77106144, "body": "Your problem statement is a bit unclear. You stated there are two columns, but you&#39;re only showing one. Who/How is selecting the range of the customer IDs? Are you wanting the function to count the number of repeats for a single ID? Is the second column a part of what the function looks at?"}, {"owner": {"reputation": 1, "user_id": 8297626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7baa10bb2af4dc9daed9ac148fd17edc?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Dowd", "link": "https://stackoverflow.com/users/8297626/sam-dowd"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1499947468, "post_id": 45064859, "comment_id": 77132388, "body": "Thanks for your reply, let me clear it up. The matching column to the one I showed is all 4&#39;s. Each of these customer IDs has 4 plans in force. I want to the function to tell me that the number of unique customer ID&#39;s which have 4 plans is equal to 3. (06U0547, 06U5166 &amp; 06U4990 are the only unique values in the IDs column, and there are 3 of them). So I want the function to say &quot;for some n # of count of plans in force, look at IDs in ID column with that number of plans in force. For n=4 plans in force there are 9 ID matches, but only 3 of them are unique IDs, so return 3."}], "answers": [{"tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": false, "score": 0, "last_activity_date": 1499961656, "creation_date": 1499961656, "answer_id": 45085848, "question_id": 45064859, "link": "https://stackoverflow.com/questions/45064859/how-to-write-an-excel-function-to-count-the-number-of-unique-records-in-a-specif/45085848#45085848", "title": "How to write an Excel function to count the number of unique records in a specific range of cells", "body": "<p>Try this vba code which uses a <code>worksheet_change</code> event,</p>\n\n<pre><code>Private Sub worksheet_change(ByVal target As Range)\nIf target.Address = \"$C$1\" And Range(\"C1\").Value &lt;&gt; \"\" And IsNumeric(Range(\"C1\").Value) Then\n    Range(\"D1:E20\").ClearContents\n    Dim i As Long, j As Long, k As Long\n    k = 1\n    i = Range(\"C1\").Value\n    For j = 1 To Cells(Rows.Count, 1).End(xlUp).Row\n        If Range(\"B\" &amp; j).Value = i Then\n            Range(\"D\" &amp; k).Value = Range(\"A\" &amp; j).Value2\n            Range(\"E\" &amp; k).Value = Range(\"B\" &amp; j).Value2\n            k = k + 1\n        End If\n    Next j\n    Range(\"D1:E\" &amp; j).RemoveDuplicates Columns:=Array(1, 2), Header:=xlNo\n    Range(\"F1\") = Application.WorksheetFunction.CountA(Columns(4))\nEnd If\nEnd Sub\n</code></pre>\n\n<p>If your data is in columns A and B, enter 4 or 5 in the cell <code>C1</code>. The macro detects changes to the cell <code>C1</code> and removes the duplicates of the data range in columns D and E. It then tell you the unique counts in Cell <code>F1</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/KBbAc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KBbAc.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/wxLzl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wxLzl.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 8297626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7baa10bb2af4dc9daed9ac148fd17edc?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Dowd", "link": "https://stackoverflow.com/users/8297626/sam-dowd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499961656, "creation_date": 1499883170, "last_edit_date": 1531161705, "question_id": 45064859, "link": "https://stackoverflow.com/questions/45064859/how-to-write-an-excel-function-to-count-the-number-of-unique-records-in-a-specif", "title": "How to write an Excel function to count the number of unique records in a specific range of cells", "body": "<p>I have two columns, one with customer ID numbers and the other with count of plans. Customer ID has letters and numbers in it while count of plans is a nonzero integer.</p>\n\n<p>I need a function that first: specifies a range of customer IDs that correspond with a specific plan count (ex. all customer IDs which have a corresponding plan count of 4)</p>\n\n<p>and then second: counts the number of unique customer IDs for that plan count.</p>\n\n<p>So for example for these IDs with count of plans all equal to 4: </p>\n\n<pre><code>06U0547\n06U0547\n06U0547\n06U5166\n06U5166\n06U5166\n06U4990\n06U4990\n06U4990\n06U4777\n06U4777\n</code></pre>\n\n<p>with matching column</p>\n\n<pre><code>4\n4\n4\n4\n4\n4\n4\n4\n4\n5\n5\n</code></pre>\n\n<p>I want Excel to say \"ok, let's only look at these 9 customer IDs with count of plans equal to 4, and then count the unique numbers. Which would be 3 unique numbers.\" So the function should return \"3\". This should work for any n, so for n=5 the function should return \"1\", because there is only 1 unique customer ID for the plan count of 5.</p>\n\n<p>How should I write this? I looked up unique value functions on here but none of them work for me, and I can't find any function on selecting the range. I'm just an intern I don't know much if anything about VBA.</p>\n\n<p>Any help is much appreciated, thank you so much!</p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 89, "user_id": 8094270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1484414001633062/picture?type=large", "display_name": "Philippe Ma", "link": "https://stackoverflow.com/users/8094270/philippe-ma"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1499882945, "post_id": 45064739, "comment_id": 77102811, "body": "Still came up with the same error message."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1499883215, "post_id": 45064739, "comment_id": 77102978, "body": "sorry - my mistake: Scott has it"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 8094270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1484414001633062/picture?type=large", "display_name": "Philippe Ma", "link": "https://stackoverflow.com/users/8094270/philippe-ma"}, "edited": false, "score": 0, "creation_date": 1499884094, "post_id": 45064813, "comment_id": 77103417, "body": "Still came up with the same error message, but thanks for correcting the parts."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 89, "user_id": 8094270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1484414001633062/picture?type=large", "display_name": "Philippe Ma", "link": "https://stackoverflow.com/users/8094270/philippe-ma"}, "edited": false, "score": 0, "creation_date": 1499884178, "post_id": 45064813, "comment_id": 77103462, "body": "Then the error is not with the code you are showing.  I get it to work without issue. @PhilippeMa  make sure you did not declare a variable <code>Date</code>"}, {"owner": {"reputation": 89, "user_id": 8094270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1484414001633062/picture?type=large", "display_name": "Philippe Ma", "link": "https://stackoverflow.com/users/8094270/philippe-ma"}, "edited": false, "score": 0, "creation_date": 1499884382, "post_id": 45064813, "comment_id": 77103580, "body": "That is all my code and I do not have a variable set as Date. However, your      Date is showing up blue and mine are not."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 89, "user_id": 8094270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1484414001633062/picture?type=large", "display_name": "Philippe Ma", "link": "https://stackoverflow.com/users/8094270/philippe-ma"}, "edited": false, "score": 0, "creation_date": 1499884454, "post_id": 45064813, "comment_id": 77103641, "body": "It only shows blue here, not in my vbe.  If this is all where are you assigning a value to the variable <code>Last</code>?"}, {"owner": {"reputation": 89, "user_id": 8094270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1484414001633062/picture?type=large", "display_name": "Philippe Ma", "link": "https://stackoverflow.com/users/8094270/philippe-ma"}, "edited": false, "score": 0, "creation_date": 1499884514, "post_id": 45064813, "comment_id": 77103680, "body": "Oh that was in a separate macro let me add that part."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 89, "user_id": 8094270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1484414001633062/picture?type=large", "display_name": "Philippe Ma", "link": "https://stackoverflow.com/users/8094270/philippe-ma"}, "edited": false, "score": 0, "creation_date": 1499884794, "post_id": 45064813, "comment_id": 77103831, "body": "I get no error with either code.  Is the error the same on the same line or different?"}, {"owner": {"reputation": 89, "user_id": 8094270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1484414001633062/picture?type=large", "display_name": "Philippe Ma", "link": "https://stackoverflow.com/users/8094270/philippe-ma"}, "edited": false, "score": 0, "creation_date": 1499884884, "post_id": 45064813, "comment_id": 77103882, "body": "It says complie error: expected arrary. It highlights month on the line &quot;Montho = Month(Date)&quot;."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 89, "user_id": 8094270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1484414001633062/picture?type=large", "display_name": "Philippe Ma", "link": "https://stackoverflow.com/users/8094270/philippe-ma"}, "edited": false, "score": 0, "creation_date": 1499884928, "post_id": 45064813, "comment_id": 77103916, "body": "Did you change the variable name to something but <code>Month</code> like I did.  I changed it to <code>Montho</code>"}, {"owner": {"reputation": 89, "user_id": 8094270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1484414001633062/picture?type=large", "display_name": "Philippe Ma", "link": "https://stackoverflow.com/users/8094270/philippe-ma"}, "edited": false, "score": 0, "creation_date": 1499885029, "post_id": 45064813, "comment_id": 77103967, "body": "oh you guessed it. I didn&#39;t change all the variables to match. Thanks it works now."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1499884798, "last_edit_date": 1499884798, "creation_date": 1499883032, "answer_id": 45064813, "question_id": 45064739, "link": "https://stackoverflow.com/questions/45064739/roundup-current-date-to-either-15th-or-end-of-the-month/45064813#45064813", "title": "ROUNDUP current date to either 15th or end of the month", "body": "<p>Use <code>Date</code> instead of <code>Today</code>.</p>\n\n<p>Do not use the same name as functions, excel gets messed up.</p>\n\n<p>vba does not have <code>EoMonth</code> it is part of Application.WorksheetFunction.  It also returns a date or double not an integer.  You will need to get the <code>Day</code>:</p>\n\n<pre><code>Dim Today As Integer\nDim Montho As Integer\nDim Yearo As Integer\nDim Lday As Integer\nDim last As Integer\nlast = Cells(Rows.Count, \"A\").End(xlUp).Row\nToday = Day(Date)\nMontho = Month(Date)\nYearo = Year(Date)\nLday = Day(Application.WorksheetFunction.EoMonth(Date, 0))\n\n\nIf Today &lt;= 15 Then\n    Range(\"B2:B\" &amp; Last).Value = Montho &amp; \"/15/\" &amp; Yearo\nEnd If\nIf Today &gt; 15 Then\n    Range(\"B2:B\" &amp; Last).Value = Montho &amp; \"/\" &amp; Lday &amp; \"/\" &amp; Yearo\nEnd If\n</code></pre>\n\n<hr>\n\n<p>The above code returns a string that looks like a date.  To return a true date use this:</p>\n\n<pre><code>Dim Today As Integer\nDim Montho As Integer\nDim Yearo As Integer\nDim last As Integer\nlast = Cells(Rows.Count, \"A\").End(xlUp).Row\nToday = Day(Date)\nMontho = Month(Date)\nYearo = Year(Date)\n\n\nRange(\"B2:B\" &amp; Last).NumberFormat = \"mm/dd/yyyy\"\nIf Today &lt;= 15 Then\n    Range(\"B2:B\" &amp; Last).Value = DateSerial(Yearo, Montho, 15)    \nEnd If\nIf Today &gt; 15 Then\n    Range(\"B2:B\" &amp; 4).Value = Application.WorksheetFunction.EoMonth(Date, 0)\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1499884283, "creation_date": 1499884283, "answer_id": 45065171, "question_id": 45064739, "link": "https://stackoverflow.com/questions/45064739/roundup-current-date-to-either-15th-or-end-of-the-month/45065171#45065171", "title": "ROUNDUP current date to either 15th or end of the month", "body": "<p>Try,</p>\n\n<pre><code>Range(\"B2:B\" &amp; Last).Value = dateserial(year(date), month(date)-(day(date)&gt;15), 15 * abs(day(date)&lt;=15)) \n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 8094270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1484414001633062/picture?type=large", "display_name": "Philippe Ma", "link": "https://stackoverflow.com/users/8094270/philippe-ma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 45064813, "answer_count": 2, "score": 3, "last_activity_date": 1499884798, "creation_date": 1499882697, "last_edit_date": 1499884546, "question_id": 45064739, "link": "https://stackoverflow.com/questions/45064739/roundup-current-date-to-either-15th-or-end-of-the-month", "title": "ROUNDUP current date to either 15th or end of the month", "body": "<p>I am getting an \"expected array\" error on Today = Day(Today()). I have no idea what is wrong.</p>\n\n<pre><code>Dim Thisday As Integer\nDim Montho As Integer\nDim Yearo As Integer\nDim Lday As Integer\nDim last as Integer\nlast = Cells(Rows.Count, \"A\").End(xlUp).Row\nThisday = Day(date)\nMontho = Month(date)\nYearo = Year(date)\nLday = Day(Application.WorksheetFunction.EoMonth(Date, -1))\n</code></pre>\n\n<p>Then Column B in excel gets populated with the same date, either the 15th or the last day.</p>\n\n<pre><code>If Thisday &lt;= 15 Then\nRange(\"B2:B\" &amp; Last).Value = Montho &amp; \"/15/\" &amp; Yearo\nEnd If\nIf Thisday &gt; 15 Then\nRange(\"B2:B\" &amp; Last).Value = Montho &amp; \"/\" &amp; Lday &amp; \"/\" &amp; Yearo\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Also not every month ends on the 30th, so how do get the Lday should return the as day of the month.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1499882496, "post_id": 45064251, "comment_id": 77102573, "body": "What do you think you are getting with this line: <code>List1 = Selection</code>?"}, {"owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 1, "creation_date": 1499882688, "post_id": 45064251, "comment_id": 77102679, "body": "Use <code>msgbox List1</code> after your <code>List1 = Selection</code> line.  As a beginner, <code>msgbox</code> is your friend... you can print to the screen while the program is running.  Also, learn to use the debugger... it&#39;ll let you know what your variables are doing and how your logic is flowing.  I&#39;d suspect that List1 doesn&#39;t have a proper range in it."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499884508, "post_id": 45064251, "comment_id": 77103669, "body": "One step beyond <code>msgbox</code> are the <code>Immediate</code>, <code>Locals</code> and <code>Watch</code> windows. They are vital to efficient debugging."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499887601, "post_id": 45064251, "comment_id": 77105333, "body": "Prefer <code>Debug.Print</code> and <code>Debug.Assert</code> calls over sprinkled <code>MsgBox</code> calls..."}, {"owner": {"reputation": 11, "user_id": 8297362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22193945b412cfd3981778eb26c4ec98?s=128&d=identicon&r=PG&f=1", "display_name": "gbs6146", "link": "https://stackoverflow.com/users/8297362/gbs6146"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1499888043, "post_id": 45064251, "comment_id": 77105564, "body": "@ScottCraner I was defining List1 as the current selection when starting the sub. Because I want it to start at different positions. This workbook has a ton of data that I&#39;m still adding to and after each addition I have to manually change the drop down list and copy paste to another sheet. After running and hitting debug and highlighting List1 it is showing the value in the selected cell which also shows if i put <code>msgbox List1</code> after that line."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8297362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22193945b412cfd3981778eb26c4ec98?s=128&d=identicon&r=PG&f=1", "display_name": "gbs6146", "link": "https://stackoverflow.com/users/8297362/gbs6146"}, "edited": false, "score": 0, "creation_date": 1499888820, "post_id": 45066117, "comment_id": 77105917, "body": "So my confusion here is like I said that this needs to start at different positions. Even if define <code>List1 = Range(&quot;C168&quot;)</code> (the currently selected cell), I&#39;m getting the same error. EDIT: Is it possible I&#39;m running into an error because I want the range to be the values contained in the drop down list in C168? How would I go about defining that?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 8297362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22193945b412cfd3981778eb26c4ec98?s=128&d=identicon&r=PG&f=1", "display_name": "gbs6146", "link": "https://stackoverflow.com/users/8297362/gbs6146"}, "edited": false, "score": 0, "creation_date": 1499889289, "post_id": 45066117, "comment_id": 77106186, "body": "<code>List1 = Range(&quot;C168&quot;)</code> and then <code>Evaluate(ActiveSheet.Range(List1)</code> assumes <code>Range(&quot;C168&quot;)</code> contains a valid range address. What is <code>List1</code> supposed to be anyway?"}, {"owner": {"reputation": 11, "user_id": 8297362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22193945b412cfd3981778eb26c4ec98?s=128&d=identicon&r=PG&f=1", "display_name": "gbs6146", "link": "https://stackoverflow.com/users/8297362/gbs6146"}, "edited": false, "score": 0, "creation_date": 1499889649, "post_id": 45066117, "comment_id": 77106362, "body": "<code>List1</code> is just the variable that I set trying to contain the values of the drop down list. Pretty much each cell in C has this drop down list of strings that then change the values in the adjacent cells in D. I was pretty much trying to copy <a href=\"https://stackoverflow.com/questions/36398323/iterate-through-vba-dropdown-list\">this post</a> of iterating through a drop down list."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 8297362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22193945b412cfd3981778eb26c4ec98?s=128&d=identicon&r=PG&f=1", "display_name": "gbs6146", "link": "https://stackoverflow.com/users/8297362/gbs6146"}, "edited": false, "score": 0, "creation_date": 1499889695, "post_id": 45066117, "comment_id": 77106384, "body": "@gbs6146 to be clear: <b>your code wants List1 to contain a valid range address</b>, not a list of things, not strings, not anything but a range address (or named range)."}, {"owner": {"reputation": 11, "user_id": 8297362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22193945b412cfd3981778eb26c4ec98?s=128&d=identicon&r=PG&f=1", "display_name": "gbs6146", "link": "https://stackoverflow.com/users/8297362/gbs6146"}, "edited": false, "score": 0, "creation_date": 1499890030, "post_id": 45066117, "comment_id": 77106568, "body": "OK, how can I fix that, or what should I be trying to make it to get it to recognize the other strings within the drop down? I need it to iterate through each string in the list and then copy the data in the adjacent column? I&#39;m sorry, like I said, I&#39;m extremely new to VBA."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 8297362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22193945b412cfd3981778eb26c4ec98?s=128&d=identicon&r=PG&f=1", "display_name": "gbs6146", "link": "https://stackoverflow.com/users/8297362/gbs6146"}, "edited": false, "score": 0, "creation_date": 1499890423, "post_id": 45066117, "comment_id": 77106757, "body": "@gbs6146 edited, see if that works for you - I&#39;m not 100% sure exactly what you&#39;re trying to do, there&#39;s too much <code>Select</code> and <code>Activate</code> and <code>Copy</code> / <code>Paste</code> going on to clearly visualize what that code is supposed to be doing / working with."}, {"owner": {"reputation": 11, "user_id": 8297362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22193945b412cfd3981778eb26c4ec98?s=128&d=identicon&r=PG&f=1", "display_name": "gbs6146", "link": "https://stackoverflow.com/users/8297362/gbs6146"}, "edited": false, "score": 0, "creation_date": 1499891198, "post_id": 45066117, "comment_id": 77107109, "body": "Same error. I know there&#39;s a lot going on, I tried to explain myself in writing at the beginning of the OP. I just edited it again for more clarity hopefully. I was trying to write a code that I could start at the beginning of each addition of new data so that it didn&#39;t have to copy paste the entire sheet each time but it&#39;s looking like that&#39;s causing problems. (p.s. thank you for trying to help I know it&#39;s like pulling teeth since I have little idea what I&#39;m doing)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1506016951, "last_edit_date": 1506016951, "creation_date": 1499887942, "answer_id": 45066117, "question_id": 45064251, "link": "https://stackoverflow.com/questions/45064251/vba-runtime-error-1004-application-defined-or-object-defined-error-when-settin/45066117#45066117", "title": "VBA Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d when setting Range in macro", "body": "<p>Your code assumes <code>List1</code> contains a valid range address, and thus that the active cell on that <code>\"Sample Data Summary\"</code> worksheet, contains a valid range address.</p>\n\n<p>Apparently that isn't <em>always</em> the case. Search for more details on the <strong>On Error statement</strong> for ideas about how you could go about handling that situation.</p>\n\n<p>You need to read up on <a href=\"https://stackoverflow.com/q/10714251/1188513\">How to avoid using Select in Excel VBA macros</a>, and know that <a href=\"https://stackoverflow.com/q/45019541/1188513\">clipboard operations in a tight loop</a> is pretty much the single slowest thing you can do in Excel-VBA.</p>\n\n<hr>\n\n<p>Seems you want something like this:</p>\n\n<pre><code>Set Range1 = Evaluate(Selection.Validation.Formula1)\n</code></pre>\n\n<p>Your code blows up on <code>Range(List1)</code> because <code>List1</code> does not contain a valid range address.</p>\n"}], "owner": {"reputation": 11, "user_id": 8297362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22193945b412cfd3981778eb26c4ec98?s=128&d=identicon&r=PG&f=1", "display_name": "gbs6146", "link": "https://stackoverflow.com/users/8297362/gbs6146"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1960, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506016951, "creation_date": 1499880913, "last_edit_date": 1499891055, "question_id": 45064251, "link": "https://stackoverflow.com/questions/45064251/vba-runtime-error-1004-application-defined-or-object-defined-error-when-settin", "title": "VBA Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d when setting Range in macro", "body": "<p>I'm going to preface this by saying that I am very new to VBA and this is my first project with it however, I'm trying quite hard because otherwise it is manual copy paste ~200 times.</p>\n\n<p>Unfortunately, for a first project it has been difficult. </p>\n\n<p>EDITED FOR CLARITY (HOPEFULLY): The main idea is that I need to start at the beginning of a drop down list, copy the first string listed, then paste that string down the column. This changes the numerical data adjacent to the right. I then want to select this newly changed numerical data and copy and paste it to a different sheet in the same workbook in the first blank space in column F. I then want the code to iterate through the drop down list and do this for all 51 strings in the drop down. However it needs to paste offset by 3 columns for each iteration to copy the data to the correct column in the other sheet.</p>\n\n<p>Here is my code thus far</p>\n\n<pre><code>Option Explicit\n\nSub PtComp()\n'\n' PtComp Macro\n'\n\n'\nDim List1 As String\nDim Range1 As Range\nDim Line1 As Range\nDim i As Integer\nDim Begin As Range\n\n\nActiveWorkbook.Sheets(\"Sample Data Summary\").Activate\nList1 = Selection\nSet Range1 = Evaluate(ActiveSheet.Range(List1).Validation.Formula1)\nFor Each Line1 In Range1\n    Selection.Copy\n    ActiveSheet.Range(Selection, Selection.End(xlDown)).Select\n    ActiveSheet.Paste\n    ActiveCell.Offset(0, 1).Select\n    ActiveSheet.Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    ActiveSheet.Selection.Copy\n    ActiveWorkbook.Sheets(\"Pt Comparison\").Activate\n    Begin = ActiveSheet.Range(\"F1\").End(xlDown).Offset(-1, 0)\n    For i = 0 To 148 Step 3\n    Begin.Offset(0, i).Select\n    ActiveSheet.PasteSpecial Paste:=xlPasteValues\n    Next i\n    Next Line1\n\nEnd Sub\n</code></pre>\n\n<p>It is highlighting this line</p>\n\n<pre><code>Set Range1 = Evaluate(ActiveSheet.Range(List1).Validation.Formula1)\n</code></pre>\n\n<p>Any help would be greatly appreciated. Sorry if my code is trash, like I said, first timer hoping to get better.</p>\n\n<p>EDIT: Also, I looked back at older questions with the same error and thought that it was maybe because it wasn't clear what worksheet I was trying to define the range in, hence why my code is full of 'ActiveSheet' but still no luck.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1499878178, "post_id": 45063361, "comment_id": 77100124, "body": "By &quot;Recent Date&quot; do you mean the closest date to the day you run this macro? Also, you&#39;re currently just looking for the text &quot;Reading Date:&quot;, instead of the actual closest date -- is that where you&#39;re having trouble?  In the data you posted, I assume you want to copy the data from the November 2016 group?"}, {"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1499878410, "post_id": 45063361, "comment_id": 77100267, "body": "Yes I want to find the date closest to todays date. I was trying to find reading date because I know that is constant and then offset to find the actual date. In this case I would want to copy the depth values for the November 2016 group."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1499878879, "post_id": 45063361, "comment_id": 77100498, "body": "Why are you iterating through the columns with <code>i</code>? This should just return a single column, right? Not multiple?"}, {"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1499879024, "post_id": 45063361, "comment_id": 77100575, "body": "Because I know that the most recent date will fall either in column 1, 8, or 15 (in this case). I am going through each of these columns to find the most recent date... If there is a better way to get the most recent date let me know. I am not very experienced with vba so there is probably a more efficient way to complete this task"}, {"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1499879872, "post_id": 45063361, "comment_id": 77101006, "body": "@BruceWayne Do I need to use an array?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1499880086, "post_id": 45063361, "comment_id": 77101118, "body": "You could. I&#39;m working on an answer though, without needing an Array."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1499881275, "post_id": 45064190, "comment_id": 77101827, "body": "I will work with this code for a bit but the text &quot;Reading Date&quot; won&#39;t always be located in Row 38. It depends on the depth reading. Depth could be 20, 30, 10, etc."}, {"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1499881759, "post_id": 45064190, "comment_id": 77102121, "body": "My dataset wont always be from row 2 - 35 either. It could be larger or smaller"}, {"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1499881940, "post_id": 45064190, "comment_id": 77102239, "body": "As well the Reading Date could vary in different rows on the worksheet, for one data set it could be row 20 and for the next data set it could be row 21"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1499881996, "post_id": 45064190, "comment_id": 77102272, "body": "@hdk857 - Are those all the variables? ...can I assume that the data would start on row 2 though?"}, {"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1499882168, "post_id": 45064190, "comment_id": 77102373, "body": "Yes you can assume the data will always start in row 2. But the amount of depth values can vary, therefore causing the reading date to be in a different cell. I will upload another picture for reference"}, {"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1499882338, "post_id": 45064190, "comment_id": 77102483, "body": "I have updated the image within my question for reference"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1499882644, "post_id": 45064190, "comment_id": 77102653, "body": "@hdk857 - Thanks! One final thing - can I assume that the Depths WILL start in Column A, and be separated by 6 columns until the next one? Or is it possible that you may add a new column, or one group has an additional column other groups don&#39;t?"}, {"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1499882773, "post_id": 45064190, "comment_id": 77102713, "body": "Depth will always start in column A and there will always be separated by 6 columns!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1499883776, "post_id": 45064190, "comment_id": 77103249, "body": "@hdk857 - Okay, I edited the code. It should work for you now.  Again, it&#39;s going to paste in &quot;Hidden&quot; column A, without a header."}, {"owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "edited": false, "score": 0, "creation_date": 1499976500, "post_id": 45064190, "comment_id": 77152516, "body": "is there a way for me to check if all imported data sets contain the exact same depth values as specified in the most up-to-date data set?"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1499883750, "last_edit_date": 1499883750, "creation_date": 1499880684, "answer_id": 45064190, "question_id": 45063361, "link": "https://stackoverflow.com/questions/45063361/find-newest-reading-date-and-copy-depth-column-to-new-sheet/45064190#45064190", "title": "Find newest reading date and copy depth column to new sheet", "body": "<pre><code>Sub Copy_depth_Updated()\nDim dataWS As Worksheet, hiddenWS As Worksheet\nDim tempDate As String, mostRecentDate As String\nDim datesRng As Range, recentCol As Range, headerRng As Range, dateRow As Range, cel As Range\n\nSet dataWS = Worksheets(\"Data Information Sheet\")\nSet hiddenWS = Worksheets(\"Hidden\")\n\nSet headerRng = dataWS.Range(dataWS.Cells(1, 1), dataWS.Cells(1, dataWS.Cells(1, Columns.Count).End(xlToLeft).Column))\n'headerRng.Select\n\nFor Each cel In headerRng\n    If cel.Value = \"Depth\" Then\n        Set dateRow = cel.EntireColumn.Find(what:=\"Reading Date:\", LookIn:=xlValues, lookat:=xlPart)\n        Set datesRng = dataWS.Cells(dateRow.Row + 1, dateRow.Column)\n        'datesRng.Select\n\n        ' Find the most recent date\n        tempDate = Left(datesRng, 10)\n        If tempDate &gt; mostRecentDate Then\n            mostRecentDate = tempDate\n            Set recentCol = datesRng\n        End If\n    End If\nNext cel\n\nDim copyRng As Range\nWith dataWS\n    Set copyRng = .Range(.Cells(2, recentCol.Column), .Cells(.Cells(2, recentCol.Column).End(xlDown).Row, recentCol.Column))\nEnd With\n\nhiddenWS.Range(hiddenWS.Cells(2, 1), hiddenWS.Cells(copyRng.Rows(copyRng.Rows.Count).Row, 1)).Value = copyRng.Value\n\nEnd Sub\n</code></pre>\n\n<p>It's a little verbose, but should work.  It will look for the columns with \"Depth\", and then look at that column's date. This should allow you to add/remove columns in the groups so it's a little more dynamic.</p>\n\n<p>Let me know if this needs tweaking or anything.</p>\n"}], "owner": {"reputation": 81, "user_id": 8094573, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9c6352200443c5d6174faedae0bb90e2?s=128&d=identicon&r=PG&f=1", "display_name": "hdk857", "link": "https://stackoverflow.com/users/8094573/hdk857"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 45064190, "answer_count": 1, "score": 0, "last_activity_date": 1499883750, "creation_date": 1499877704, "last_edit_date": 1499882320, "question_id": 45063361, "link": "https://stackoverflow.com/questions/45063361/find-newest-reading-date-and-copy-depth-column-to-new-sheet", "title": "Find newest reading date and copy depth column to new sheet", "body": "<p>I have an excel workbook where data has been imported by the user. See image.\n<a href=\"https://i.stack.imgur.com/hKBwx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hKBwx.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to find the most recent date and copy the depth values at the corresponding date (most recent) to a separate sheet called \"Hidden\" My issue is that the number of data sets imported is dependent on how many data sets the user imports therefore it is dynamic. As well the cell where the Reading Date is located is dynamic depending on how many values there are for depth (wont always be 17.5) </p>\n\n<p>Here is some code I have been working with</p>\n\n<pre><code>Sub Copy_Depth1()\n\nDim i As Integer\nDim j As Integer\n\nj = 1\ni = 1\n\nDo Until j = Sheets(\"Hidden\").Range(\"B2\").Value 'I count how many times data has been imported to this sheet in this cell in this specific case j is 3\n\nWith Sheets(\"Data Importation Sheet\")\nSet Cell2 = .Columns(i).Find(What:=\"Reading Date:\", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlDown, MatchCase:=False, SearchFormat:=False)\nSet Cell3 = Cell2.Offset(1, 0)\nDebug.Print Cell3.FormulaR1C1\nEnd With\n\ni = i + 7\nj = j + 1\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Any tips/help would be greatly appreciated! Thanks in advance!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4319, "user_id": 2027237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6457db0676be7f14f63e0f45aec333d?s=128&d=identicon&r=PG", "display_name": "anneb", "link": "https://stackoverflow.com/users/2027237/anneb"}, "edited": false, "score": 0, "creation_date": 1499877570, "post_id": 45063179, "comment_id": 77099811, "body": "are the tables in a database? If so, you can probably write a single sql query to get what you need. Maybe you can provide some sample data?"}, {"owner": {"reputation": 1, "user_id": 8297127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6453527704a6809ecf4b044a1897d69f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Funk", "link": "https://stackoverflow.com/users/8297127/tom-funk"}, "reply_to_user": {"reputation": 4319, "user_id": 2027237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6457db0676be7f14f63e0f45aec333d?s=128&d=identicon&r=PG", "display_name": "anneb", "link": "https://stackoverflow.com/users/2027237/anneb"}, "edited": false, "score": 0, "creation_date": 1499891472, "post_id": 45063179, "comment_id": 77107255, "body": "yes, that are all in a single Database. how would i Link data?"}], "answers": [{"tags": [], "owner": {"reputation": 4319, "user_id": 2027237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6457db0676be7f14f63e0f45aec333d?s=128&d=identicon&r=PG", "display_name": "anneb", "link": "https://stackoverflow.com/users/2027237/anneb"}, "is_accepted": false, "score": 0, "last_activity_date": 1499930640, "last_edit_date": 1499930640, "creation_date": 1499929387, "answer_id": 45073582, "question_id": 45063179, "link": "https://stackoverflow.com/questions/45063179/vba-access-emailing/45073582#45073582", "title": "VBA - Access emailing", "body": "<p>You did not provide sample data. I assume by 'emails' you mean email addresses. </p>\n\n<p>Let's say the table with mail addresses is called 'accounts'. It is not clear why there are 5 other tables. Let's assume they are called a, b, c, d and e. The information in these tables is stored in field 'info'. You did not provide information on the type of database (access, mysql, postgres, oracle, ms-sql), so I am going to use as generic SQL as possible. Let's assume the id field in accounts is called 'id' and the corresponding field in the other tables is called 'accountid'. (<strong>Edit:</strong>)Let's assume the other tables do not all reference all 1000 accounts.</p>\n\n<pre><code>select accounts.email, a.info, b.info, c.info, d.info, e.info\n from accounts left join a on accounts.id=a.accountid \n   left join b on accounts.id=b.accountid\n    left join c on and accounts.id=c.accountid \n     left join d on account.id=d.accountid \n      left join e on account.id=e.accountid;\n</code></pre>\n\n<p>Note that for some accounts some of the info fields may be empty (NULL) if the corresponding table does not have a row referencing the account.</p>\n"}], "owner": {"reputation": 1, "user_id": 8297127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6453527704a6809ecf4b044a1897d69f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Funk", "link": "https://stackoverflow.com/users/8297127/tom-funk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499930640, "creation_date": 1499877046, "question_id": 45063179, "link": "https://stackoverflow.com/questions/45063179/vba-access-emailing", "title": "VBA - Access emailing", "body": "<p>I have a table of 1000 emails with unique identifiers and 5 other tables with matching unique identifiers. I am trying to email attachments from the first table the attachments from the remaining 5 table. one issue is that all information is store on the 5 tables. is there code I can write to \"automate\" the emailing without having to write thousands lines of code? </p>\n"}, {"tags": ["vba", "outlook", "calendar"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1499880871, "creation_date": 1499880871, "answer_id": 45064241, "question_id": 45063155, "link": "https://stackoverflow.com/questions/45063155/changing-one-appointment-in-a-series-in-vba/45064241#45064241", "title": "Changing one appointment in a series in VBA", "body": "<p>Firstly, you code that calls Sort does nothing - you call Sort on a temporary object (implicit variable created by the compiler) that you never use. <br>\nSecondly, you need to set the <code>IncludeRecurrences</code> property, and ten restrict the collection (see <a href=\"https://msdn.microsoft.com/VBA/Outlook-VBA/articles/items-includerecurrences-property-outlook\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/VBA/Outlook-VBA/articles/items-includerecurrences-property-outlook</a>)</p>\n\n<pre><code>    dim oItems = oAppointments.Items\n    oItems.Sort (\"[Start]\")\n    oItems.Restrict(\"[Start] &gt; '01-01-2017' AND (\"[Start] &lt; '01-07-2017'  \")\n    For Each oAppointmentItem In oItems\n      ...\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 2433954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa2069538a2cd9cf0711f44112ce761a?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/2433954/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 1, "accepted_answer_id": 45064241, "answer_count": 1, "score": 0, "last_activity_date": 1593043290, "creation_date": 1499876966, "last_edit_date": 1593043290, "question_id": 45063155, "link": "https://stackoverflow.com/questions/45063155/changing-one-appointment-in-a-series-in-vba", "title": "Changing one appointment in a series in VBA", "body": "<p>How do I find a SERIES of APPOINTMENTS in My Outlook Calendar and how to change it? </p>\n\n<p>I use the following code to find and change a single appointment/meeting. </p>\n\n<pre><code>Private Sub ChangeAppointment(SearchDate As String, SearchApptSubject As String)        \n\n    'SearchDate = \"7/12/2017\"\n    'SearchApptSubject = \"Leave Office!\"\n\n    Dim oOL As New Outlook.Application\n    Dim oNS As Outlook.NameSpace\n    Dim oAppointments As Object\n    Dim oAppointmentItem As Outlook.AppointmentItem\n    Dim ItemDate As String\n    Dim strSubject As String, strBody As String\n\n    Set oNS = oOL.GetNamespace(\"MAPI\")\n    Set oAppointments = oNS.GetDefaultFolder(olFolderCalendar)\n\n    For Each oAppointmentItem In oAppointments.Items\n\n        ItemDate = Format(oAppointmentItem.Start, \"mm/dd/yy\")\n        ItemSubject = oAppointmentItem.Subject\n\n        If SearchDate = ItemDate And SearchApptSubject = ItemSubject Then 'Check all events on current date.\n\n            oAppointmentItem.Start = cdate(\"7/12/2017 6:00 PM\")\n            oAppointmentItem.END = cdate(\"7/12/2017 6:01 PM\")\n            oAppointmentItem.Subject = 'Time to go home!'                \n            oAppointmentItem.Save  \n\n            Exit For\n\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>But when trying to find appointments that are part of a series the code won't find it. I would like to know how to find appointments in a series AND how to change just one appointment in that series. Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1499877706, "post_id": 45063045, "comment_id": 77099881, "body": "Probably easier to use Cells <code>Sheets(&quot;sheet name&quot;).Cells(row, col).value = Me.txtDATA.Text</code> where <code>row</code> and <code>col</code> are variables (in the case of D, col=4)."}, {"owner": {"reputation": 146, "user_id": 6465553, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209742376705641/picture?type=large", "display_name": "viper941", "link": "https://stackoverflow.com/users/6465553/viper941"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1499879129, "post_id": 45063045, "comment_id": 77100615, "body": "This worked. But I don&#39;t see the check mark to mark this answered."}, {"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1499891559, "post_id": 45063045, "comment_id": 77107303, "body": "there is not check mark to the comments"}], "owner": {"reputation": 146, "user_id": 6465553, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209742376705641/picture?type=large", "display_name": "viper941", "link": "https://stackoverflow.com/users/6465553/viper941"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499876614, "creation_date": 1499876614, "last_edit_date": 1531164843, "question_id": 45063045, "link": "https://stackoverflow.com/questions/45063045/link-form-objects-to-dynamic-column-locations", "title": "Link form objects to dynamic column locations", "body": "<p>The basic description of what I am working with.</p>\n\n<p>A user downloads an excel form with a range of data. The column headers can go as far out to column BD.</p>\n\n<p>Despite the number of columns the user only needs to edit up to 12 of those columns.</p>\n\n<p>The solution was to create a form, the user fills in the data and clicks a submit button, the form puts the data into the appropriate columns, and time lost from the user manually scrolling and clicking back and forth is regained.</p>\n\n<p>A recent update, out of my control, has made the column heading location dynamic. So while the count and data entered remains the same the location is no longer fixed.</p>\n\n<p>I am familiar with using find to locate the header and determine the column number by the active cell it finds it in. I am unfamiliar how to use that column number in place of the letter in my line of code that updates the current data.</p>\n\n<p>I currently use:</p>\n\n<pre><code>Sheets(\"sheet name\").Range(\"D\" &amp; Row).value = Me.txtDATA.Text\n</code></pre>\n\n<p>In this line 'Row' is a earlier determined value.</p>\n\n<p>If column \"D\" moves to column \"G\" then using find will tell me that the location is column 7. I can then assign that number to a variable. What I don't know is how to use that variable to replace \"D\" in that line of code. </p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 5, "last_activity_date": 1499876602, "creation_date": 1499876602, "answer_id": 45063042, "question_id": 45062990, "link": "https://stackoverflow.com/questions/45062990/programmatically-assign-getpivotdata-formula-to-a-cell/45063042#45063042", "title": "Programmatically assign GetPivotData formula to a cell", "body": "<p>VBA normal format is American English.</p>\n\n<p>so either:</p>\n\n<p>Change the <code>;</code> to <code>,</code>:</p>\n\n<pre><code>Selection.Formula = \"=GETPIVOTDATA(\"\"Value\"\",$M$26,\"\"M\"\",1,\"\"Y\"\",1396)\"\n</code></pre>\n\n<p>Or use <code>.FormulaLocal</code>:</p>\n\n<pre><code>Selection.FormulaLocal = \"=GETPIVOTDATA(\"\"Value\"\";$M$26;\"\"M\"\";1;\"\"Y\"\";1396)\"\n</code></pre>\n"}], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "accepted_answer_id": 45063042, "answer_count": 1, "score": 1, "last_activity_date": 1582446511, "creation_date": 1499876396, "last_edit_date": 1582446511, "question_id": 45062990, "link": "https://stackoverflow.com/questions/45062990/programmatically-assign-getpivotdata-formula-to-a-cell", "title": "Programmatically assign GetPivotData formula to a cell", "body": "<p>Run-time error '1004':</p>\n\n<p>Application-defined or Object-defined error</p>\n\n<p>I want set a cell formula with the code below:</p>\n\n<pre><code>Selection.Formula = \"=GETPIVOTDATA(\"\"Value\"\";$M$26;\"\"M\"\";1;\"\"Y\"\";1396)\"\n</code></pre>\n\n<p>Above formula works in the sheet correctly as bellow:</p>\n\n<pre><code>=GETPIVOTDATA(\"Value\";$M$26;\"M\";1;\"Y\";1396)\n</code></pre>\n\n<p>but when I try to assign to appropriate cell with macro, above error shown.</p>\n\n<p>How can I assign this formula to cells, by VBA macro?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499877259, "post_id": 45062822, "comment_id": 77099640, "body": "Can you provide your code in full? It looks like you have removed some where you are actually writing the data to the sheet. Without seeing the code though, and if you already have it in reverse alphabetical order you could just load your collection into a new collection (reversed order) before processing. Something like <code>For each Item in Collection : NewCollection.Add Item : Next</code> (this is a really simplified example of course)."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1499878486, "post_id": 45062822, "comment_id": 77100304, "body": "I think you can achieve that using the optional parameters <code>After</code> or <code>Before</code> when you Add the subfolders."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1499887814, "post_id": 45062822, "comment_id": 77105452, "body": "The fastest way to list all folders and subfolders would be by using the <code>cmd</code> interface <code>dir</code> function.  There are a lot of ways you can format the output, using simple switches in the command.  Experiment in the CMD window until you get the output you want, and then use the <code>WshShell.Run</code> method to run it."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1499890976, "post_id": 45062822, "comment_id": 77107007, "body": "Provide an example of exactly how you want your output formatted."}, {"owner": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499931436, "post_id": 45062822, "comment_id": 77121014, "body": "@BrandonBarney Thanks to everyone who&#39;s replied. Looking over the code - which as I said I simply &quot;stole&quot; from an earlier thread - I get the impression that the basic problem is that there&#39;s no hierarchization. That is, the code as is writes each level of subdirectories to the sheet separately, rather than writing each subdirectory, then its subdirectories (if any), then that subdirectory&#39;s subdirectories, and so on. (Sorry for using &quot;directory&quot; instead of &quot;folder&quot; for those who might prefer the latter.)  I&#39;m now looking for a way to queue all levels of subdirectories of each subdirectory, in"}, {"owner": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1499931594, "post_id": 45062822, "comment_id": 77121117, "body": "@RonRosenfeld To answer your question, I&#39;d like for the output to the sheet to look like the results of a <code>tree</code> command."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499945217, "post_id": 45062822, "comment_id": 77130754, "body": "@Lestrad The real problem, if I understand correctly, is how you are getting the items out of the queue. While my approach solves the problem in a different way, you could accomplish the task (organized alphabetically) by looping through your queue in the opposite direction. The problem here though is, since you copied and pasted the code, you need to get to a point of understanding the <i>what</i> and <i>why</i> of the code, so you can become comfortable in modifying it."}], "answers": [{"comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499889613, "post_id": 45064802, "comment_id": 77106347, "body": "I tested this on one of my org&#39;s network directories where the output was ~ 265,000 x 17 and it took 63 minutes so, if you are mapping a complex directory, this will be time consuming. There are process improvements that could be made (the use of DoEvents), but that will come down to how you are using this."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1499897724, "post_id": 45064802, "comment_id": 77110031, "body": "That seems like a long time.  I can list the 617,000 entries on my C: drive in well under one minute."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1499903318, "post_id": 45064802, "comment_id": 77111634, "body": "@Ron Rosenfeld complexity/network connection makes a difference. A C: connection will undoubtedly be faster than doing it over a network. I don&#39;t have any directories on my c drive I can use to test it that way though."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1499903429, "post_id": 45064802, "comment_id": 77111655, "body": "And if you mean list the 617k entries on your drove using this code then that would further the idea that it is a network issue in this case. Filling the array with the &quot;CleanOutput&#39; bit may play a role as well."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1499906398, "post_id": 45064802, "comment_id": 77112376, "body": "I would agree with that.  I have a process that I run frequently on a mapped drive that resides on my NAS.  A fraction of the number of files.  On that particular drive, on that particular network, the <code>CMD - dir</code> method finished reading the directory about 10-20 times faster than using the <code>FileSystemObject</code>.  On a directly attached drive, barely noticeable; but on the NAS drive, the time difference is on the order of 25 sec vs 7-8 minutes."}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 0, "last_activity_date": 1499883001, "creation_date": 1499883001, "answer_id": 45064802, "question_id": 45062822, "link": "https://stackoverflow.com/questions/45062822/loop-through-all-subfolders-vba-queue-method/45064802#45064802", "title": "Loop Through All Subfolders - VBA - Queue method", "body": "<p>I know you are using a non-recursion method, but admittedly I wanted to try my hand at using recursion to solve the task (particularly for anyone who may need this in the future).</p>\n\n<p>Note: I am not certain that the Scripting.FileSystem Folders/Files collections are always alphabetical so I am assuming they are in this case, but I <em>could</em> be mistaken. </p>\n\n<p>From brief tests I am not noticing any kind of performance issue with recursion though, depending on the directory size, there certainly could be one.</p>\n\n<p>Finally, the 'CleanOutput' argument in the main Function is used to determine if hierarchy relationships are displayed in the output.</p>\n\n<h2>Method Used to Test/Output</h2>\n\n<pre><code>Sub Test()\n    Dim fso As Scripting.FileSystemObject\n    Set fso = New Scripting.FileSystemObject\n\n    Dim Folder As Scripting.Folder\n    Set Folder = fso.GetFolder(\"C:\")\n\n    Dim Test As Variant\n    Test = GetDirectoryFromScriptingFolder(Folder, True)\n\n    ActiveSheet.Range(\"A1\").Resize(UBound(Test, 1), UBound(Test, 2)).value = Test\nEnd Sub\n</code></pre>\n\n<h2>Main Function</h2>\n\n<pre><code>Private Function GetDirectoryFromScriptingFolder(ByVal InputFolder As Scripting.Folder, Optional CleanOutput As Boolean = False) As Variant\n    ' Uses recursion to return an organized hierarchy that represents files/folders in the input directory\n    Dim CurrentRow As Long\n    CurrentRow = 1\n\n    Dim CurrentColumn As Long\n    CurrentColumn = 1\n\n    Dim OutputDirectory As Variant\n    ReDim OutputDirectory(1 To GetDirectoryLength(InputFolder), 1 To GetDirectoryDepth(InputFolder))\n\n    WriteFolderHierarchy InputFolder, OutputDirectory, CurrentRow, CurrentColumn, CleanOutput\n\n    ' Adjust current column so that files in the parent directory are properly indented\n    WriteFileHierarchy InputFolder, OutputDirectory, CurrentRow, CurrentColumn + 1, CleanOutput\n\n    GetDirectoryFromScriptingFolder = OutputDirectory\nEnd Function\n</code></pre>\n\n<h2>Functions Used in Recursion</h2>\n\n<pre><code>Private Sub WriteFolderHierarchy(ByVal InputFolder As Scripting.Folder, ByRef InputHierarchy As Variant, ByRef CurrentRow As Long, ByVal CurrentColumn As Long, ByVal CleanOutput As Boolean)\n    If Not IsArray(InputHierarchy) Then Exit Sub\n\n    InputHierarchy(CurrentRow, CurrentColumn) = InputFolder.Name\n    CurrentRow = CurrentRow + 1\n\n    Dim StartRow As Long\n    Dim SubFolder As Folder\n    For Each SubFolder In InputFolder.SubFolders\n        ' Use recursion to write the files/folders of each subfolder to the directory\n        StartRow = CurrentRow\n        WriteFolderHierarchy SubFolder, InputHierarchy, CurrentRow, CurrentColumn + 1, CleanOutput\n        WriteFileHierarchy SubFolder, InputHierarchy, CurrentRow, CurrentColumn + 2, CleanOutput\n\n        If CleanOutput Then\n            For StartRow = StartRow To CurrentRow\n                InputHierarchy(StartRow, CurrentColumn) = \"||\"\n            Next\n        End If\n    Next\nEnd Sub\n\nPrivate Sub WriteFileHierarchy(ByVal InputFolder As Scripting.Folder, ByRef InputHierarchy As Variant, ByRef CurrentRow As Long, ByVal CurrentColumn As Long, ByVal CleanOutput As Boolean)\n    If Not IsArray(InputHierarchy) Then Exit Sub\n\n    Dim SubFile As File\n    For Each SubFile In InputFolder.Files\n        ' Write the Files to the Hierarchy\n        InputHierarchy(CurrentRow, CurrentColumn) = SubFile.Name\n        If CleanOutput Then InputHierarchy(CurrentRow, CurrentColumn - 1) = \"--\"\n        CurrentRow = CurrentRow + 1\n    Next\nEnd Sub\n</code></pre>\n\n<h2>Helper Functions (Depth and Length)</h2>\n\n<pre><code>Private Function GetDirectoryLength(ByVal InputFolder As Scripting.Folder) As Long\n    Dim TotalLength As Long\n\n    ' Include a base of 1 to account for the input folder\n    TotalLength = 1 + InputFolder.Files.Count\n\n    Dim SubFolder As Scripting.Folder\n    For Each SubFolder In InputFolder.SubFolders\n        ' Add 1 to the total to account for the subfolder.\n        TotalLength = TotalLength + GetDirectoryLength(SubFolder)\n    Next\n\n    GetDirectoryLength = TotalLength\nEnd Function\n\nPrivate Function GetDirectoryDepth(ByVal InputFolder As Scripting.Folder) As Long\n    Dim TotalDepth As Long\n\n    Dim SubFolder As Scripting.Folder\n    Dim MaxDepth As Long\n    Dim NewDepth As Long\n    For Each SubFolder In InputFolder.SubFolders\n        NewDepth = GetDirectoryDepth(SubFolder)\n\n        If NewDepth &gt; MaxDepth Then\n            MaxDepth = NewDepth\n        End If\n    Next\n\n    If MaxDepth = 0 Then MaxDepth = 1\n\n    ' Add 1 for the Parent Directory\n    GetDirectoryDepth = MaxDepth + 2\nEnd Function\n</code></pre>\n\n<p>What is essentially happening is this:</p>\n\n<ul>\n<li>We take an input Folder and determine the dimensions of the hierarchy\nfor that file</li>\n<li>Next, we define an output array using those dimensions.</li>\n<li>Using a row counter and column counter, we allow the recursion functions to write their recursive results directly to the hierarchy</li>\n<li>This hierarchy is returned, and the main routine puts this straight to the sheet</li>\n</ul>\n\n<h2>Next Steps that You Could Take</h2>\n\n<p>I noticed a few things doing this</p>\n\n<ul>\n<li>There is no information other than the file name, which, depending on\nthe application, may make the method useless  </li>\n<li>All files are included\nin the output, not just <em>important</em> ones (non-important files being\ntemp, hidden, etc.)</li>\n<li>Even with the <code>CleanOutput</code> option there isn't an easy way of diagramming the relationships between parents and children.</li>\n</ul>\n\n<p>Overall though this should suffice, depending on your needs. You can make adjustments as needed. If you have questions, just ask :).</p>\n"}, {"comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499945102, "post_id": 45077943, "comment_id": 77130646, "body": "Rosenfield Admittedly what I am about to suggest is over my level of expertise and experience, but couldnt we go one step further by using VBA to write a shell script, or a batch file. If I am not mistaken, both would allow for hiding of the CMD window."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499945328, "post_id": 45077943, "comment_id": 77130844, "body": "@BrandonBarney I haven&#39;t experimented with that.  But for single line commands such as we have here, what would be the advantage?"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499945907, "post_id": 45077943, "comment_id": 77131243, "body": "It is more of a &#39;we could do it to go one step further&#39; over an &#39;this would be more ideal&#39;. Really, it would just prevent users from getting concerned if they see a CMD window pop up and run a command. Beyond that though, no real advantage at all (and depending on the application/environment it could be a disadvantage)."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499946028, "post_id": 45077943, "comment_id": 77131316, "body": "Since the <code>Run</code> method can be used and will hide the CMD window, I don&#39;t see any real advantage.  Not writing to the file system is a potential advantage of piping the output of the command directly to a VBA variable, but a batch file would have to be written to the file system anyway."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499946096, "post_id": 45077943, "comment_id": 77131371, "body": "@BrandonBarney And there are methods of hiding the CMD window using Windows API calls, even when using the WSH.Exec method, but I haven&#39;t looked at that as I&#39;ve not had the requirement."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499946493, "post_id": 45077943, "comment_id": 77131689, "body": "My mistake, I completely misread your line about how one could use <code>WSH.Exec</code> and, for some reason, thought your current approach wasnt hiding the CMD window. Ignore me."}, {"owner": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1500124652, "post_id": 45077943, "comment_id": 77208145, "body": "I fell back on the recursive method and was able to get what I wanted (I can post the code if someone wants it) - but it remains to be seen how it will perform on a root drive with a big, deep tree structure."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1500124798, "post_id": 45077943, "comment_id": 77208187, "body": "@Lestrad I would guess that if performance time is an issue, the tree command as I showed will work much faster."}, {"owner": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1500530120, "post_id": 45077943, "comment_id": 77378779, "body": "@RonRosenfeld I tried this and it works. I&#39;d have never thought of using the vertical-line character like that. And it&#39;s very fast. The problem is that I want to be able to click on the cell and open the corresponding folder. For that, might I be able to adapt your approach, but using the <code>dir</code>command? Anyway thanks!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1500549036, "post_id": 45077943, "comment_id": 77391772, "body": "@Lestrad I must have missed the requirement for clickable links in your original question.  You wrote you wanted it to look like the output of the <code>Tree</code> command, so that is what this shows. I&#39;m not at my working computer, so really cannot advise the best way to add clickable links and still have your desired output format.  i&#39;ll take a look later."}, {"owner": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1500567101, "post_id": 45077943, "comment_id": 77406360, "body": "@RonRosenfeld I have to apologize - I didn&#39;t in fact mention that I wanted clickable links, or even that I wanted the entire path of each folder and subfolder. Making a clickable link is easy enough - I have a little macro that creates and then Follows a link from a path. As I say, I was able to get a tree-like display, but it&#39;s rather slow. I&#39;m working on adapting your approach using <code>dir</code> instead of <code>tree</code>."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1500664976, "post_id": 45077943, "comment_id": 77456593, "body": "@Lestrad Interesting problem.  I edited my response to provide an answer that creates links and might be useful."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1501164295, "post_id": 45077943, "comment_id": 77667567, "body": "@Lestrad <b>You keep adding specifications that were not in your original post</b>. I suggest, as a first step to figure out how to do what you want, that you open a CMD window, and experiment with the <code>dir</code> command until you get the arguments that will produce the output you require.  And <code>dir &#47;?</code> will bring up a help page to explain the arguments (or use a Google search). (Had you done so, you would not even have tried the arguments you did).  You will also need to understand the code in order to modify it. See Chip Pearson&#39;s <a href=\"http://www.cpearson.com/Excel/Classes.aspx\" rel=\"nofollow noreferrer\">Introduction to Classes</a>"}, {"owner": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1501165123, "post_id": 45077943, "comment_id": 77668250, "body": "@RonRosenfeld I adapted your solution and tried it and it works incredibly fast compared to the approach I was using. My only question: how to get it to display files as well? (In my current approach I pop up a dialogue which sets a Boolean variable corresponding to &quot;Show files too&quot;/&quot;Show folders only&quot;.) I tried changing the <code>sDIRargs</code> constant for the command-line switches to &quot; /O-S /S&quot; instead of  &quot;/AD-S-L-H /S&quot;, but it still shows only the folders. Any help would be appreciated as I&#39;m not sure I really understand all your code yet. But anyway thanks and Bravo!"}, {"owner": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1501166464, "post_id": 45077943, "comment_id": 77669371, "body": "@RonRosenfeld Thanks and sorry. The help file &quot;/?&quot; for the <code>dir</code> command isn&#39;t the simplest thing in the world to figure out, but please don&#39;t think I didn&#39;t study it. I&#39;ll look for a bit more user-friendly guide. Thanks very much for the link, since I clearly need to study that too."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1501238651, "post_id": 45077943, "comment_id": 77703387, "body": "@Lestrad <i>thoughts</i>: Listing Files you may run over the row limit of an  excel sheet; why reproduce the File Explorer in Excel?; to get layout, might be easier to use the <code>Tree</code> command with the <code>show files</code> option, and reconstruct the full path in code."}, {"owner": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1501266780, "post_id": 45077943, "comment_id": 77721948, "body": "@RonRosenfeld  Thanks. I&#39;m now implementing a second array-dictionary for the filenames. We&#39;ll see how it goes. Then I want to write in a time counter to write the time in the sheet at the start and at the end, in both approaches, to have an accurate idea of how fast your approach really is. Not sure what you mean about <code>Tree</code> and showing files; need to look into it."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1501270507, "post_id": 45077943, "comment_id": 77723878, "body": "@Lestrad With regard to the dictionary of files, you could make that a property of the cTree object; then it would be tied to the relevant folder."}, {"owner": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1501499305, "post_id": 45077943, "comment_id": 77788940, "body": "@RonRosenfeld That&#39;s what I ended up doing. I just added a FileName property to cTree. Then I changed the Filters to exclude everything <b>but</b> the lines with the Folder name and the file names. Then I added code to figure out if the current item being read is a file or a folder while populating the dictionary. Then when creating the hyperlinks I increased the Level property by 1 to indent the filenames under each folder, and also changed the font color of the filenames. So far it&#39;s working fine - thanks to you. Now I need to try to implement the same thing using <code>tree</code>..."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1501500574, "post_id": 45077943, "comment_id": 77789856, "body": "@Lestrad If you have it working using <code>dir</code>, why bother with <code>Tree</code>?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1501502104, "post_id": 45077943, "comment_id": 77791015, "body": "@Lestrad BTW, I used <code>&#47;A-S-L-H &#47;S</code> for the <code>dir</code> args; developed the folder list by looking for the <code>Directory of ...</code> strings, and detected files of that folder because, in the listing below it, there was no <code>&lt;DIR&gt;</code> entry.  I figured the levels as originally; made a dictionary of file names as a property of the folder, and indented one extra when printing. If you like, I can add that to my answer."}, {"owner": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1501597196, "post_id": 45077943, "comment_id": 77841987, "body": "@RonRosenfeld Yes; I&#39;d love to see that if it&#39;s no trouble. The way I did it was to just loop through the lines in the array V until I hit &quot;:\\&quot; and assign the corresponding line to a Cur(rent)Folder variable.  Meanwhile I added code to write the starting and ending time to a text file. It&#39;s <b>fast</b>. My <code>dir</code> switches are <code>&#47;a &#47;on &#47;S &#47;n</code>. I&#39;ll try your and see what it does."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1501601323, "post_id": 45077943, "comment_id": 77844845, "body": "@Lestrad I&#39;ll edit my post with the modified code (and a new screenshot) later today. It actually takes longer to add the hyperlinks than to run the <code>dir</code> command."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "edited": false, "score": 0, "creation_date": 1501604847, "post_id": 45077943, "comment_id": 77847073, "body": "@Lestrad Modified code posted.  And could you please mark my response as the <b>Answer</b>.  Thanks."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1501613685, "last_edit_date": 1592644375, "creation_date": 1499941567, "answer_id": 45077943, "question_id": 45062822, "link": "https://stackoverflow.com/questions/45062822/loop-through-all-subfolders-vba-queue-method/45077943#45077943", "title": "Loop Through All Subfolders - VBA - Queue method", "body": "<p><em>I'd like for the output to the sheet to look like the results of a tree command</em></p>\n<p>Seems to me the simplest would be to just use the <code>Tree</code> command.</p>\n<p>Here is one way, but the details could certainly be changed:</p>\n<ul>\n<li>Execute a Tree command on the base folder</li>\n<li>Write the output to some text file (location and name specified in the code)</li>\n<li>Open the file as a text file in Excel</li>\n<li>Split into columns on the vertical bar (Unicode character 9474) that the Tree command uses to differentiate levels</li>\n<li>I use the <code>WSH.Run</code> method as that allows the <code>CMD</code> window to be easily hidden\n<ul>\n<li>One could use the <code>WSH.Exec</code> method to pipe the output directly to a VBA variable, but it is much harder to hide the <code>CMD</code> window (meaning, in another application, I've not been able to) :-)</li>\n</ul>\n</li>\n</ul>\n<p>One could also Import the text file into the same workbook instead of opening a new file.  I will leave that exercise to you if you choose to do it.</p>\n<pre><code>Option Explicit\n'set referennce to Windows Script Host Object Model\nSub DirTree()\n    Dim sBaseFolder As String, sTempFile As String\n    Dim WSH As WshShell\n    Dim sCMD As String\n    Dim lErrCode As Long\n    \n\n'Many ways to set starting point\nsBaseFolder = Environ(&quot;HOMEDRIVE&quot;) &amp; &quot;\\&quot;\nsTempFile = Environ(&quot;TEMP&quot;) &amp; &quot;\\Tree.txt&quot;\n\n'Command line\nsCMD = &quot;CMD /c tree &quot;&quot;&quot; &amp; sBaseFolder &amp; &quot;&quot;&quot; &gt; &quot;&quot;&quot; &amp; sTempFile &amp; &quot;&quot;&quot;&quot;\n\nSet WSH = New WshShell\nlErrCode = WSH.Run(sCMD, xlHidden, True)\n\nIf Not lErrCode = 0 Then\n    MsgBox &quot;Error in execution: Code - &quot; &amp; lErrCode\nElse\n    'Open the file\n    Workbooks.OpenText Filename:=sTempFile, Origin:=xlMSDOS, _\n        StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _\n        ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False, Comma:=False _\n        , Space:=False, Other:=True, OtherChar:=ChrW(&amp;H2502), _\n        FieldInfo:=Array(Array(1, 1), Array(2, 1))\nEnd If\n    \nEnd Sub\n</code></pre>\n<p>Here is a screenshot of the beginning of the output when run on my <code>C:</code> drive</p>\n<p><a href=\"https://i.stack.imgur.com/k4FJn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k4FJn.png\" alt=\"enter image description here\" /></a></p>\n<p><strong>EDIT:</strong>  Since you now mention that you want the links to be clickable, an approach using <code>dir</code> would probably be simpler, especially since you can provide arguments to the <code>dir</code> command that will result in full paths being returned.</p>\n<p>I used a class module so as to have a User Defined Object, which would have the necessary information; and a dictionary of these objects after appropriate filtering.</p>\n<p>I chose to display merely the folder name in the cell, but the the screen tip will show the full path.</p>\n<p>Note the References that need to be set (in the code).  Also note that the class module must be renamed: <em>cTree</em></p>\n<p><strong>EDIT 2:</strong> The Regular and Class modules were edited to allow for optional listing of the files. Note that the macro now has an argument, so it must be called from another macro or from the immediate window, to include the argument.  (The argument could also be obtained from an Input box, user form, etc, but I did it this way for now because it is simpler.</p>\n<p>I did not add hyperlinks for the files, thinking it would get confusing as different programs and dialogs (other than the file explorer) would be opening depending on the extension.</p>\n<h2>Class Module</h2>\n<hr />\n<pre><code>Option Explicit\n'Rename Class Module:  cTree\n\nPrivate pFullPath As String\nPrivate pFolderName As String\nPrivate pLevel As Long\nPrivate pFile As String\nPrivate pFiles As Dictionary\n\nPublic Property Get FullPath() As String\n    FullPath = pFullPath\nEnd Property\nPublic Property Let FullPath(Value As String)\n    pFullPath = Value\nEnd Property\n\nPublic Property Get FolderName() As String\n    FolderName = pFolderName\nEnd Property\nPublic Property Let FolderName(Value As String)\n    pFolderName = Value\nEnd Property\n\nPublic Property Get Level() As Long\n    Level = pLevel\nEnd Property\nPublic Property Let Level(Value As Long)\n    pLevel = Value\nEnd Property\n\nPublic Property Get Files() As Dictionary\n    Set Files = pFiles\nEnd Property\nPublic Function ADDfile(Value As String)\n    pFiles.Add Value, Value\nEnd Function\nPrivate Sub Class_Initialize()\n    Set pFiles = New Dictionary\n    pFiles.CompareMode = TextCompare\nEnd Sub\n</code></pre>\n<hr />\n<h2>Regular Module</h2>\n<hr />\n<pre><code>Option Explicit\n'Set reference to Windows Script Host Object Model\n'                 Microsoft Scripting Runtime\n\nSub GetDirList(bInclFiles As Boolean)\n    Const sDIRargs As String = &quot; /A-S-L-H /S&quot;\n    \n    Dim sBaseFolder As String, sTempFile As String\n    Dim WSH As WshShell\n    Dim sCMD As String\n    Dim lErrCode As Long\n    \n    Dim FSO As FileSystemObject, TS As TextStream\n    Dim S As String, sFN As String\n    Dim V As Variant, W As Variant\n    Dim I As Long\n    \n    Dim lMaxLevel As Long\n    Dim lMinLevel As Long\n    \n    Dim dctTrees As Dictionary, cT As cTree\n    Dim wsRes As Worksheet\n    Dim vRes As Variant, rRes As Range\n    \n'Add worksheet if needed\nOn Error Resume Next\nSet wsRes = Worksheets(&quot;TreeLink&quot;)\n    If Err.Number = 9 Then\n        Set wsRes = Worksheets.Add\n        wsRes.Name = &quot;TreeLink&quot;\n    End If\nOn Error GoTo 0\nSet rRes = wsRes.Cells(1, 1)\n\n    \n'Many ways to set starting point\nsBaseFolder = Environ(&quot;HOMEDRIVE&quot;) &amp; &quot;\\&quot;\nsTempFile = Environ(&quot;TEMP&quot;) &amp; &quot;\\DirList.txt&quot;\n\n'CommandLine\nsCMD = &quot;CMD /c dir &quot;&quot;&quot; &amp; sBaseFolder &amp; &quot;&quot;&quot;&quot; &amp; sDIRargs &amp; &quot; &gt; &quot; &amp; sTempFile\n\nSet WSH = New WshShell\nlErrCode = WSH.Run(sCMD, xlHidden, True)\n\nIf Not lErrCode = 0 Then\n    MsgBox &quot;Error in execution: Code - &quot; &amp; lErrCode\n    Stop\n    \nElse\n    'Read in the relevant data\n    Set dctTrees = New Dictionary\n    Set FSO = New FileSystemObject\n    Set TS = FSO.OpenTextFile(sTempFile, ForReading, False, TristateUseDefault)\n    lMaxLevel = 0\n    \n    V = Split(TS.ReadAll, vbCrLf)\n    \n    For I = 0 To UBound(V)\n        Do Until V(I) Like &quot; Directory of *&quot;\n            If I = UBound(V) Then Exit For\n            I = I + 1\n        Loop\n        Set cT = New cTree\n            S = Mid(V(I), 15)\n            \n            'Can exclude certain directories at this point\n            'To exclude all that start with a dot:\n            If Not S Like &quot;*\\.*&quot; Then\n            \n            With cT\n                .FullPath = S\n                .FolderName = Right(S, Len(S) - InStrRev(S, &quot;\\&quot;))\n                .Level = Len(S) - Len(Replace(S, &quot;\\&quot;, &quot;&quot;))\n                \n                lMaxLevel = IIf(lMaxLevel &gt; .Level, lMaxLevel, .Level)\n                \n                dctTrees.Add Key:=S, Item:=cT\n                \n                I = I + 1\n                \n                'Only run for file list\n                If bInclFiles = True Then\n                Do\n                    sFN = V(I)\n                    If Not sFN Like &quot;*&lt;DIR&gt;*&quot; _\n                            And sFN &lt;&gt; &quot;&quot; Then\n                        'add the files\n                        dctTrees(S).ADDfile Mid(sFN, 40)\n                    End If\n                    I = I + 1\n                Loop Until V(I) Like &quot;*# File(s)*&quot;\n                End If\n                \n            End With\n            \n            End If 'End of directory exclusion &quot;if&quot; statement\n            \n    Next I\n    \n    lMinLevel = dctTrees(dctTrees.Keys(0)).Level\n    \n    I = 0\n    With rRes.Resize(columnsize:=lMaxLevel + 1).EntireColumn\n        .Clear\n        .HorizontalAlignment = xlLeft\n    End With\n    \n    Application.ScreenUpdating = False\n    \n    For Each V In dctTrees.Keys\n        Set cT = dctTrees(V)\n        With cT\n            I = I + 1\n            rRes.Worksheet.Hyperlinks.Add _\n                Anchor:=rRes(I, .Level - lMinLevel + 1), _\n                Address:=&quot;File:///&quot; &amp; .FullPath, _\n                ScreenTip:=.FullPath, _\n                TextToDisplay:=.FolderName\n                \n            For Each W In .Files.Keys\n                I = I + 1\n                rRes(I, .Level - lMinLevel + 2) = W\n            Next W\n        \n        End With\n    Next V\n    \n    Application.ScreenUpdating = True\n    \nEnd If\nEnd Sub\n</code></pre>\n<hr />\n<h2>Results without File Listing</h2>\n<p><a href=\"https://i.stack.imgur.com/n1tiz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n1tiz.png\" alt=\"enter image description here\" /></a></p>\n<h2>Results with File Listing</h2>\n<p><a href=\"https://i.stack.imgur.com/kbMOS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kbMOS.png\" alt=\"enter image description here\" /></a></p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1500433343, "creation_date": 1500433343, "answer_id": 45180241, "question_id": 45062822, "link": "https://stackoverflow.com/questions/45062822/loop-through-all-subfolders-vba-queue-method/45180241#45180241", "title": "Loop Through All Subfolders - VBA - Queue method", "body": "<p>I don't think LIFO or FIFO matters, just take a look at this idea.</p>\n\n<pre><code>Sub GetFilesInFolder(SourceFolderName As String)\n\n'--- For Example:Folder Name= \"D:\\Folder Name\\\"\n\nDim FSO As Scripting.FileSystemObject\nDim SourceFolder As Scripting.folder, SubFolder As Scripting.folder\nDim FileItem As Scripting.File\n\nSet FSO = New Scripting.FileSystemObject\nSet SourceFolder = FSO.GetFolder(SourceFolderName)\n\n'--- This is for displaying, whereever you want can be configured\n\nr = 14\nFor Each FileItem In SourceFolder.Files\n    Cells(r, 2).Formula = r - 13\n    Cells(r, 3).Formula = FileItem.Name\n    Cells(r, 4).Formula = FileItem.Path\n    Cells(r, 5).Formula = FileItem.Size\n    Cells(r, 6).Formula = FileItem.Type\n    Cells(r, 7).Formula = FileItem.DateLastModified\n    Cells(r, 8).Formula = \"=HYPERLINK(\"\"\" &amp; FileItem.Path &amp; \"\"\",\"\"\" &amp; \"Click Here to Open\" &amp; \"\"\")\"\n\n    r = r + 1   ' next row number\nNext FileItem\n\nSet FileItem = Nothing\nSet SourceFolder = Nothing\nSet FSO = Nothing\n</code></pre>\n\n<p>End Sub</p>\n\n<p>ii) User wants to get the list of all files inside a folder as well as Sub-folders\nCopy and Paste the below Code and this will list down the list of all the files inside the folder as well as sub-folders. If there are other files which are there in some other Sub-folders then it will list down all files from each and Every Folders and Sub-folders.</p>\n\n<pre><code>Sub GetFilesInFolder(SourceFolderName As String, Subfolders As Boolean)\n\n'--- For Example:Folder Name= \"D:\\Folder Name\\\" and Flag as Yes or No\n\nDim FSO As Scripting.FileSystemObject\nDim SourceFolder As Scripting.folder, SubFolder As Scripting.folder\nDim FileItem As Scripting.File\n'Dim r As Long\n    Set FSO = New Scripting.FileSystemObject\n    Set SourceFolder = FSO.GetFolder(SourceFolderName)\n\n    '--- This is for displaying, whereever you want can be configured\n\n    r = 14\n    For Each FileItem In SourceFolder.Files\n        Cells(r, 2).Formula = r - 13\n        Cells(r, 3).Formula = FileItem.Name\n        Cells(r, 4).Formula = FileItem.Path\n        Cells(r, 5).Formula = FileItem.Size\n        Cells(r, 6).Formula = FileItem.Type\n        Cells(r, 7).Formula = FileItem.DateLastModified\n        Cells(r, 8).Formula = \"=HYPERLINK(\"\"\" &amp; FileItem.Path &amp; \"\"\",\"\"\" &amp; \"Click Here to Open\" &amp; \"\"\")\"\n\n        r = r + 1   ' next row number\n    Next FileItem\n\n    '--- This is the Function to go each and Every Folder and get the Files. This is a Nested-Function Calling.\n\n    If Subfolders = True Then\n        For Each SubFolder In SourceFolder.Subfolders\n            ListFilesInFolder SubFolder.Path, True\n        Next SubFolder\n    End If\n\n    Set FileItem = Nothing\n    Set SourceFolder = Nothing\n    Set FSO = Nothing\nEnd Sub\n</code></pre>\n\n<p>File Manager using Excel Macro in Excel Workbook</p>\n\n<p>I have created one File Manager using the above Code. It basically fetches the list of Files from Folders and Sub-folders and list them. It fetches other details of the files as well like File Size, Last modified, path of the File, Type of the File and a hyperlink to open the file directly from the excel by clicking on that.\nIt looks something like below:</p>\n\n<p>Here is the link to download the full Workbook.</p>\n\n<p><a href=\"http://learnexcelmacro.com/wp/2011/11/how-to-get-list-of-all-files-in-a-folder-and-sub-folders/\" rel=\"nofollow noreferrer\">http://learnexcelmacro.com/wp/2011/11/how-to-get-list-of-all-files-in-a-folder-and-sub-folders/</a></p>\n\n<p>Click on the button that is named 'Download Now'.</p>\n"}], "owner": {"reputation": 3, "user_id": 3699898, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462845794/picture?type=large", "display_name": "Lestrad", "link": "https://stackoverflow.com/users/3699898/lestrad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1008, "favorite_count": 0, "accepted_answer_id": 45077943, "answer_count": 3, "score": 0, "last_activity_date": 1501613685, "creation_date": 1499875779, "last_edit_date": 1500960553, "question_id": 45062822, "link": "https://stackoverflow.com/questions/45062822/loop-through-all-subfolders-vba-queue-method", "title": "Loop Through All Subfolders - VBA - Queue method", "body": "<p>I've made use of Cor_blimey's queue method to write all the folders and subfolders of a drive to an excel sheet, as follows:</p>\n\n<pre><code>Public Sub NonRecursiveMethod()\n    Dim fso, oFolder, oSubfolder, oFile, queue As Collection\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set queue = New Collection\n    queue.Add fso.GetFolder(\"your folder path variable\") 'obviously replace\n\n    Do While queue.Count &gt; 0\n        Set oFolder = queue(queue.count)\n        queue.Remove(queue.count) 'dequeue\n        '...insert any folder processing code here...'\n       '*...(Here I write the name of the folder to the excel sheet)*.\n        For Each oSubfolder In oFolder.SubFolders\n            queue.Add oSubfolder 'enqueue\n        Next oSubfolder\n        For Each oFile In oFolder.Files\n       '...insert any file processing code here...\n       Next oFile\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>I've tried the \"LIFO\" version (as above) and the \"FIFO\" version, but neither of them produces a standard alphabetical listing. The above version lists the drive in exact reverse alphabetical order, and the \"FIFO\" version produces a list in normal alphabetical order, but it lists only the first-level folders, then starts again and lists all the second-level folders, again in alphabetical order, then the third level of folders, again starting over from \"A\", etc. As a result, the subfolders are not listed under their parent folder.</p>\n\n<p>Does anyone know what I can do to get a standard tree structure, in alphabetical order by folder and subfolder name?</p>\n\n<p>TIA</p>\n\n<p>Les</p>\n\n<p>Update: for some reason I can't manage to show all the comments on this thread or write a new comment. But I wanted to thank everybody, in particular @Rosenfeld, and say that I'm eager to try the solution using <code>dir</code> but am currently swamped with work. I'll report back in a few days when I get a chance to stumble around.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1499877438, "post_id": 45062641, "comment_id": 77099734, "body": "see my answer and code below"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5678728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fbb23cb2fe2e0452866680468887a8?s=128&d=identicon&r=PG&f=1", "display_name": "Jackie Ann", "link": "https://stackoverflow.com/users/5678728/jackie-ann"}, "edited": false, "score": 0, "creation_date": 1499878617, "post_id": 45063074, "comment_id": 77100379, "body": "Thanks! That helps!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1499876696, "creation_date": 1499876696, "answer_id": 45063074, "question_id": 45062641, "link": "https://stackoverflow.com/questions/45062641/vba-automate-selected-series-last-data-point-labelling-in-combo-chart-with-seri/45063074#45063074", "title": "VBA: automate selected series last data point labelling in combo chart with series and stacked area", "body": "<p>To achieve this add an <code>If</code> criteria to check <code>If MySeries.Type = xlLine Then</code>.</p>\n\n<p><strong><em>Full Code</em></strong>:</p>\n\n<pre><code>Option Explicit\n\nSub LastDataLables()\n\nDim oChart As ChartObject\nDim MySeries As Series\n\nFor Each oChart In ActiveSheet.ChartObjects\n    For Each MySeries In oChart.Chart.SeriesCollection\n\n        If MySeries.Type = xlLine Then ' &lt;-- check if series type is xlline\n            'Clear ExistingData Labels\n            MySeries.ApplyDataLabels (xlDataLabelsShowNone)\n            MySeries.Points(MySeries.Points.Count - 1).ApplyDataLabels\n\n            With MySeries.DataLabels\n                .Font.Size = 12\n                '.Position = xlLabelPositionRight\n                .NumberFormat = \"0.00%\"\n            End With\n        End If\n    Next MySeries\nNext oChart\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5678728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fbb23cb2fe2e0452866680468887a8?s=128&d=identicon&r=PG&f=1", "display_name": "Jackie Ann", "link": "https://stackoverflow.com/users/5678728/jackie-ann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "accepted_answer_id": 45063074, "answer_count": 1, "score": 1, "last_activity_date": 1499876696, "creation_date": 1499875259, "last_edit_date": 1531164843, "question_id": 45062641, "link": "https://stackoverflow.com/questions/45062641/vba-automate-selected-series-last-data-point-labelling-in-combo-chart-with-seri", "title": "VBA: automate selected series last data point labelling in combo chart with series and stacked area", "body": "<p>I would like to add last point data labels to some selected series. I have a combo figure with \"line\" and \"stacked area\". I would like to only show last point data label for the \"line\" series, but not \"stacked area\", how can I do this in VBA?</p>\n\n<p>I have been able to build a button-click macro to generate data label, but it will generate data label for all series (I don't want it for \"stacked area\"). See my code below. Can someone enlighten me how to do it please? The reason I'm looping through charts is because I have two charts. The time series are plotted using name ranges for potential update.</p>\n\n<p>Any helpful comments greatly appreciated! If you need further clarification I can provide my excel file (It doesn't seem to give me option to attach it here).</p>\n\n<p>Thanks.</p>\n\n<blockquote>\n<pre><code> Sub LastDataLables()\n\n     Dim oChart As ChartObject\n     Dim MySeries As Series\n\n     For Each oChart In ActiveSheet.ChartObjects\n       For Each MySeries In oChart.Chart.SeriesCollection\n\n           'Clear ExistingData Labels\n            MySeries.ApplyDataLabels (xlDataLabelsShowNone)\n\n            MySeries.Points(MySeries.Points.Count - 1).ApplyDataLabels\n\n         With MySeries.DataLabels\n           .Font.Size = 12\n          '.Position = xlLabelPositionRight   \n           .NumberFormat = \"0.00%\"\n         End With\n\n       Next MySeries\n      Next oChart\n End Sub\n</code></pre>\n</blockquote>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1499877080, "post_id": 45062692, "comment_id": 77099555, "body": "This is a good approach.  Otherwise, you will be stuck updating DSNs on all client machines.  It is possible to have that done through group policy updates... but this can lead to you relying on a lot of stuff that&#39;s probably outside your wheelhouse."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1499883712, "post_id": 45062692, "comment_id": 77103223, "body": "Don&#39;t forget the option to use a file DSN, which creates the same &quot;DSN-less&quot; connection, but can be created and implemented through the GUI. Might be easier for some users."}], "tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": false, "score": 2, "last_activity_date": 1499875401, "creation_date": 1499875401, "answer_id": 45062692, "question_id": 45062419, "link": "https://stackoverflow.com/questions/45062419/connect-an-ms-access-file-to-sql-server/45062692#45062692", "title": "Connect an MS Access File to SQL Server", "body": "<p>The best way is to use a DSN-less connection - have a read here <a href=\"https://support.microsoft.com/en-us/help/892490/how-to-create-a-dsn-less-connection-to-sql-server-for-linked-tables-in\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/892490/how-to-create-a-dsn-less-connection-to-sql-server-for-linked-tables-in</a></p>\n"}], "owner": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499875401, "creation_date": 1499874617, "question_id": 45062419, "link": "https://stackoverflow.com/questions/45062419/connect-an-ms-access-file-to-sql-server", "title": "Connect an MS Access File to SQL Server", "body": "<p>I need to create a linked table in my MS Access file that is linked to a SQL Server back end.  The file is shared on a network.  Is it possible to create the connection so that it works on any machine that the Access file is run on or do I need to set up a connection on each machine?  </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1499875611, "post_id": 45062329, "comment_id": 77098758, "body": "You need to substitute the value of <code>strCons</code> into the query, not just its name; right now, it is just text that does not mean anything to the database. But then just substituting it is a bad idea because it will leave you vulnerable to SQL injection. So, you should use a parameterised query."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1499875712, "post_id": 45062329, "comment_id": 77098815, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/16568461/is-it-possible-to-pass-parameters-programmatically-in-a-microsoft-access-update\">Is it possible to pass parameters programmatically in a Microsoft Access update query?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1499890760, "creation_date": 1499890760, "answer_id": 45066802, "question_id": 45062329, "link": "https://stackoverflow.com/questions/45062329/how-to-substitute-a-variable-into-an-openrecordset-query/45066802#45066802", "title": "How to substitute a variable into an OpenRecordSet query", "body": "<p>You can use:</p>\n\n<pre><code>Set rs = CurrentDb.OpenRecordset(\"SELECT Member.HomeEmail FROM Member INNER JOIN MemberRole ON Member.MemberID = MemberRole.MemberID WHERE (((MemberRole.AreaID)=\" &amp; strCons &amp; \") AND ((MemberRole.RoleID)=1) AND ((MemberRole.FinishDate) Is Null)) ORDER BY Member.Surname\")\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7409894, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/03bb208b6faa44d0d6b4809582f49bed?s=128&d=identicon&r=PG", "display_name": "Rain Check", "link": "https://stackoverflow.com/users/7409894/rain-check"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 45066802, "answer_count": 1, "score": -1, "last_activity_date": 1594639541, "creation_date": 1499874419, "last_edit_date": 1594639541, "question_id": 45062329, "link": "https://stackoverflow.com/questions/45062329/how-to-substitute-a-variable-into-an-openrecordset-query", "title": "How to substitute a variable into an OpenRecordSet query", "body": "<p>I am almost there:</p>\n\n<p>The variable <strong>strCons</strong> contains a number and I would like to add this to the SQL. When I do this like below, I get this run-time error:</p>\n\n<blockquote>\n  <p>3061 Too few parameters. Expected 1.</p>\n</blockquote>\n\n<p>When I replace <code>strCons</code> with a number it works. Tried to find out why with no luck.</p>\n\n<p><code>Set rs = CurrentDb.OpenRecordset(\"SELECT Member.HomeEmail FROM Member INNER JOIN MemberRole ON Member.MemberID = MemberRole.MemberID WHERE (((MemberRole.AreaID)= strCons) AND ((MemberRole.RoleID)=1) AND ((MemberRole.FinishDate) Is Null)) ORDER BY Member.Surname\")</code></p>\n\n<p><code>strEmailTD = rs.Fields(0).Value\nrs.Close</code></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8296224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b278d7ea644813cdba3fb9f55417497?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/8296224/anonymous"}, "edited": false, "score": 0, "creation_date": 1499880006, "post_id": 45062649, "comment_id": 77101071, "body": "Thank You, I don&#39;t know why I didn&#39;t think of putting the record set to find match in an If statement. However, just looking for the EmployeeID to match will come up with all the trainings that each employee does (depending on department an employee could have to do 25-45 different trainings), which is why in the sql I had I compared it to also the TrainingID, I assume I can just add that to the FindFirst with an AND statement?"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1499875286, "creation_date": 1499875286, "answer_id": 45062649, "question_id": 45062147, "link": "https://stackoverflow.com/questions/45062147/access-command-to-record-new-records-from-listbox-if-not-existing-already/45062649#45062649", "title": "Access command to record new records from listbox if not existing already", "body": "<p>This can easily be achieved with a recordset. Read into them here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197799.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff197799.aspx</a></p>\n\n<p>The following code is an example, you will need to do a little refining:</p>\n\n<pre><code>Private Sub cmdDocument_Click()\nDim Q As QueryDef, DB As Database\nDim Criteria As Variant\nDim ctl As Control\nDim Itm As Variant\nDim rs As DAO.Recordset\n\nSet ctl = Me![lstEmployeeNames]\n'Set the recordset, and move last to load the entire set\nSet rs = CurrentDb.OpenRecordset(\"tblTraining\")\nrs.MoveLast\nrs.Edit\nFor Each Itm In ctl.ItemsSelected\n    'Look for the current employee\n    rs.FindFirst \"EmployeeID = &amp;Chr(32) &amp; ctl.ItemData(Itm) &amp; Chr(32)\"\n    If Not rs.NoMatch Then\n        If Len(Criteria) = 0 Then\n            Criteria = Chr(32) &amp; ctl.ItemData(Itm) &amp; Chr(32)\n        Else\n            Criteria = Criteria &amp; \",\" &amp; Chr(32) &amp; ctl.ItemData(Itm) &amp; Chr(32)\n        End If\n    Else\n        rs.AddNew\n        rs.Fields(\"EmployeeID\") = ctl.ItemData(Itm)\n        rs.Fields(\"Date Completed\") = txtDate\n        rs.Fields(\"TrainingID\") = cboTraining\n        rs.Update\n    End If\nNext Itm\nIf Len(Criteria) = 0 Then\n    Itm = MsgBox(\"You must select Employee Name(s) in the List!\", 0, \"No Selection Made\")\n    Exit Sub\nEnd If\n\nSet DB = CurrentDb()\nSet Q = DB.QueryDefs(\"qRecord_CleanUp\")\nQ.SQL = \"Update tblTraining Set [Date Completed] = Forms![frmTraining]![sfrmTraining].Form![txtDate]  WHERE (((tblTraining.EmployeeID) IN (\" &amp; Criteria &amp; \")) AND ((tblTraining.TrainingID)=Forms![frmTraining]![sfrmTraining].Form![cboTraining]));\"\nQ.Close\n\nDoCmd.OpenQuery \"qRecord_CleanUp\"\n\nEnd Sub\n</code></pre>\n\n<p>I'm using your existing code for found records, it would be better (and not that hard) to also use a recordset for them. Also, your \"if noone is selected\" code will now trigger sometimes when it's not needed. </p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1499882419, "creation_date": 1499882419, "answer_id": 45064671, "question_id": 45062147, "link": "https://stackoverflow.com/questions/45062147/access-command-to-record-new-records-from-listbox-if-not-existing-already/45064671#45064671", "title": "Access command to record new records from listbox if not existing already", "body": "<p>This is a database design issue and not programming one. You should not need any append or update queries. An MS Access form should handle that data functionality, namely edit/add/delete actions through GUI. </p>\n\n<p>Consider the following setup:</p>\n\n<ol>\n<li>Add a new join table like <em>EmployeeTrainings</em> with foreign key IDs for related tables,  <em>Employees</em> and <em>Trainings</em> that maintains a one-to-many relationship with both of them. Also add training session level details like <em>DateCompleted</em> in this table.</li>\n<li>Create a single or multiple-item form whose recordsource is this new table.</li>\n<li>Add listboxes or comboboxes on form whose control sources are <em>EmployeeID</em> and <em>TrainingID</em>.</li>\n</ol>\n\n<p>From there, on this form the user can navigate to a new or existing record, selecting the needed <em>Employee</em> and <em>Training</em> from listboxes. If needing to update, search or navigate to that record and edit on form. If needing to add, go to empty row (for continuous form) or page (for single form) and begin entering needed data. This way you also maintain a history of trainings and not continuously update the same employee rows. Querying of course is simply by joining tables on related IDs.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 8296224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b278d7ea644813cdba3fb9f55417497?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/8296224/anonymous"}, "is_accepted": false, "score": 0, "last_activity_date": 1499956966, "creation_date": 1499956966, "answer_id": 45083994, "question_id": 45062147, "link": "https://stackoverflow.com/questions/45062147/access-command-to-record-new-records-from-listbox-if-not-existing-already/45083994#45083994", "title": "Access command to record new records from listbox if not existing already", "body": "<p>After messing around with for a while I got it work, this is the final code</p>\n\n<pre><code>Private Sub cmdDocument_Click()\nDim Q As QueryDef, DB As Database\nDim Criteria As Variant\nDim ctl As Control\nDim Itm As Variant\nDim rs As DAO.Recordset\n\nSet ctl = Me![lstEmployeeNames]\n\nSet rs = CurrentDb.OpenRecordset(\"tblTraining\", dbOpenDynaset)\nrs.MoveLast\nrs.Edit\nFor Each Itm In ctl.ItemsSelected\n    If Len(Criteria) = 0 Then\n        Criteria = Chr(32) &amp; ctl.ItemData(Itm) &amp; Chr(32)\n    Else\n        Criteria = Criteria &amp; \",\" &amp; Chr(32) &amp; ctl.ItemData(Itm) &amp; Chr(32)\n    End If\n    If Len(Criteria) = 0 Then\n        Itm = MsgBox(\"You must select Employee Name(s) in the List!\", 0, \"No Selection Made\")\n        Exit Sub\n    End If\n\n    rs.FindFirst \"[EmployeeID] = \" &amp; ctl.ItemData(Itm) &amp; \" And [TrainingID] = \" &amp; Me![cboTraining]\n\n        If Not rs.NoMatch Then\n            Set DB = CurrentDb()\n            Set Q = DB.QueryDefs(\"qRecord_CleanUp\")\n            Q.SQL = \"Update tblTraining Set [Date Completed] = Forms![frmTraining]![sfrmTraining].Form![txtDate]  WHERE (((tblTraining.EmployeeID) IN (\" &amp; Criteria &amp; \")) AND ((tblTraining.TrainingID)=Forms![frmTraining]![sfrmTraining].Form![cboTraining]));\"\n            Q.Close\n        Else\n            rs.AddNew\n            rs.Fields(\"EmployeeID\") = ctl.ItemData(Itm)\n            rs.Fields(\"Date Completed\") = txtDate\n            rs.Fields(\"TrainingID\") = cboTraining\n            rs.Fields(\"Department\") = txtDepartment\n            rs.Update\n        End If\nNext Itm\n\nDoCmd.SetWarnings (False)\nDoCmd.OpenQuery \"qRecord_CleanUp\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8296224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b278d7ea644813cdba3fb9f55417497?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/8296224/anonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 45062649, "answer_count": 3, "score": 0, "last_activity_date": 1499956966, "creation_date": 1499873906, "last_edit_date": 1499878901, "question_id": 45062147, "link": "https://stackoverflow.com/questions/45062147/access-command-to-record-new-records-from-listbox-if-not-existing-already", "title": "Access command to record new records from listbox if not existing already", "body": "<p>I am working with MS Access 2013 at my work and have been asked to set up a database that can keep track of employee training. Currently I have a form that they can choose the department and which training they are doing, along with the current date. Based on the department they are able to choose from a listbox the employees that are present for that training session. </p>\n\n<p>I have been able to use an update query to update the current records of the employees training <em>Date Completed</em> using this code</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdDocument_Click()\n    Dim Q As QueryDef, DB As Database\n    Dim Criteria As Variant\n    Dim ctl As Control\n    Dim Itm As Variant\n\n    Set ctl = Me![lstEmployeeNames]\n\n    For Each Itm In ctl.ItemsSelected\n        If Len(Criteria) = 0 Then\n            Criteria = Chr(32) &amp; ctl.ItemData(Itm) &amp; Chr(32)\n        Else\n            Criteria = Criteria &amp; \",\" &amp; Chr(32) &amp; ctl.ItemData(Itm) &amp; Chr(32)\n        End If\n    Next Itm\n\n    If Len(Criteria) = 0 Then\n        Itm = MsgBox(\"You must select Employee Name(s) in the List!\", 0, _\n                     \"No Selection Made\")\n        Exit Sub\n    End If\n\n    Set DB = CurrentDb()\n    Set Q = DB.QueryDefs(\"qRecord_CleanUp\")\n    Q.SQL = \"UPDATE tblTraining Set [Date Completed] = \" _ \n            &amp; \" Forms![frmTraining]![sfrmTraining].Form![txtDate] \" _\n            &amp; \" WHERE (((tblTraining.EmployeeID) IN (\" &amp; Criteria &amp; \"))\" _\n            &amp; \" AND ((tblTraining.TrainingID)=\" _\n            &amp; \"      Forms![frmTraining]![sfrmTraining].Form![cboTraining]));\"\n    Q.Close\n\n    DoCmd.OpenQuery \"qRecord_CleanUp\"\n\nEnd Sub\n</code></pre>\n\n<p>However the issue is that I can't add new records. I can update current records if the employee already has done the training in the past, but if it is the employees first training I haven't been able to figure out how to add a new record for that individual employee. I have tried to come up with an append query to accomplish this but haven't been able to get it to work quite right with the listbox of employees (bound to <em>EmployeeID</em>).</p>\n\n<p>If anyone could help I would greatly appreciate it. Thank you in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1499873638, "post_id": 45061900, "comment_id": 77097380, "body": "In general, the problem seems doable with a simple <code>INDEX(MATCH)</code> or <code>VLOOKUP</code>. Not in general, show what you have done so far to help further."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1499881763, "post_id": 45061900, "comment_id": 77102124, "body": "Where is the ID&lt;&gt;Name relationship stored?"}, {"owner": {"reputation": 1, "user_id": 8296756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/516d004fd6c287925b607158a9f8f7eb?s=128&d=identicon&r=PG&f=1", "display_name": "LLimaye", "link": "https://stackoverflow.com/users/8296756/llimaye"}, "edited": false, "score": 0, "creation_date": 1499965435, "post_id": 45061900, "comment_id": 77146274, "body": "I ended up adopting VLOOKUP into my code in VBA and it worked well. Thanks for the suggestion. I really appreciate it!"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 8082282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62c4228d74e84d419007bd9f9faf6d90?s=128&d=identicon&r=PG&f=1", "display_name": "micha\u0142 kudanowski", "link": "https://stackoverflow.com/users/8082282/micha%c5%82-kudanowski"}, "is_accepted": false, "score": 0, "last_activity_date": 1499873760, "creation_date": 1499873760, "answer_id": 45062096, "question_id": 45061900, "link": "https://stackoverflow.com/questions/45061900/indexing-in-excel-vba/45062096#45062096", "title": "Indexing in Excel VBA", "body": "<p>Best way is to use built-in function. It seems like \"HLOOKUP\" will work for you.</p>\n"}], "owner": {"reputation": 1, "user_id": 8296756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/516d004fd6c287925b607158a9f8f7eb?s=128&d=identicon&r=PG&f=1", "display_name": "LLimaye", "link": "https://stackoverflow.com/users/8296756/llimaye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499888034, "creation_date": 1499873220, "last_edit_date": 1531164843, "question_id": 45061900, "link": "https://stackoverflow.com/questions/45061900/indexing-in-excel-vba", "title": "Indexing in Excel VBA", "body": "<p>For an internship this Summer, I have found myself using Excel VBA on a regular basis. I've had to self teach to get by, so I am not especially proficient and have ran into an issue with my latest assignment. </p>\n\n<p>I basically have a report where in Sheet1 column B I have a series of ID numbers varying in length. These numbers correspond to a name. I would like my macro to read the number and give me the corresponding name on Sheet2 in the same cell, but my problem is I have about 200,000 rows of values. I have to imagine using loops is wildly inefficient if not impossible because of how long it would take to run. </p>\n\n<p>Is there a faster, more efficient way to do this?</p>\n"}, {"tags": ["vba", "excel", "loops", "excel-charts"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1499874518, "post_id": 45061837, "comment_id": 77097987, "body": "Try <code>.XValues = p.Range(p.Range(&quot;a3&quot;), p.Range(&quot;a3&quot;).End(xlDown))</code> so that all ranges are qualified with a sheet."}, {"owner": {"reputation": 49, "user_id": 8267408, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2256dc6c873e257711943b16a35d287?s=128&d=identicon&r=PG&f=1", "display_name": "mrod", "link": "https://stackoverflow.com/users/8267408/mrod"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1499875108, "post_id": 45061837, "comment_id": 77098421, "body": "That&#39;s perfect; it worked. However, now I am having the issue that c(1) on loop for series i=1 is being deleted and overwritten by c(1) on loop for series i=2. Any suggestions?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1499875447, "post_id": 45061837, "comment_id": 77098657, "body": "Neither your XValues or Values change in each iteration of the loop - is that right?"}, {"owner": {"reputation": 49, "user_id": 8267408, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2256dc6c873e257711943b16a35d287?s=128&d=identicon&r=PG&f=1", "display_name": "mrod", "link": "https://stackoverflow.com/users/8267408/mrod"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1499875509, "post_id": 45061837, "comment_id": 77098702, "body": "Scratch that,  the issue is that the Xvalues are reading in as XValues and Values for both series"}, {"owner": {"reputation": 49, "user_id": 8267408, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2256dc6c873e257711943b16a35d287?s=128&d=identicon&r=PG&f=1", "display_name": "mrod", "link": "https://stackoverflow.com/users/8267408/mrod"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1499875592, "post_id": 45061837, "comment_id": 77098745, "body": "XValues are constant, Values should pass in i=1 or i=2 to c(1) depending on series collection, where they will reference separate columns. I have also qualified the c(1) ranges with a p. address as you have suggested earlier"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1499875775, "post_id": 45061837, "comment_id": 77098852, "body": "Problem solved?"}, {"owner": {"reputation": 49, "user_id": 8267408, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2256dc6c873e257711943b16a35d287?s=128&d=identicon&r=PG&f=1", "display_name": "mrod", "link": "https://stackoverflow.com/users/8267408/mrod"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1499876107, "post_id": 45061837, "comment_id": 77099045, "body": "not quite, XValues are still reading in as XValue and Values when Values should change based on column Cells(3, 1 + i), from range c(1)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1499876390, "post_id": 45061837, "comment_id": 77099193, "body": "I think I referred to that in my second comment. I can&#39;t remember chart syntax, but Values is always c(1) in your code."}, {"owner": {"reputation": 49, "user_id": 8267408, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2256dc6c873e257711943b16a35d287?s=128&d=identicon&r=PG&f=1", "display_name": "mrod", "link": "https://stackoverflow.com/users/8267408/mrod"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1499876887, "post_id": 45061837, "comment_id": 77099461, "body": "yes, there is simply something wrong with my syntax, which I cannot figure out for what I&#39;m trying to do. Though you did solve my original problem where the sheet wasn&#39;t being properly qualified. I could write it with less loops but it won&#39;t be as concise. I ultimately wanted to nest it in another for loop, something like: x = 1 to 3 for ChartObjects(&quot;Chart &quot; &amp; x) .Values = c(x) to reference each chart. Relatively new to VBA so unsure why the &#39;i&#39; value for the series is not passing into c(1) to reference two different columns"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1499877185, "post_id": 45061837, "comment_id": 77099604, "body": "Don&#39;t you need something like <code>.Values = c(i)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1499879197, "creation_date": 1499879197, "answer_id": 45063792, "question_id": 45061837, "link": "https://stackoverflow.com/questions/45061837/vba-loop-updating-series-in-chart-using-data-from-another-sheet/45063792#45063792", "title": "VBA loop updating series in chart using data from another sheet", "body": "<p>Try replacing your line:</p>\n\n<pre><code>.XValues = p.Range(Range(\"a3\"), Range(\"a3\").End(xlDown))\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>.XValues = \"=\" &amp; p.Range(p.Range(\"a3\"), p.Range(\"a3\").End(xlDown)).Address(False, False, xlA1, xlExternal)\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8267408, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2256dc6c873e257711943b16a35d287?s=128&d=identicon&r=PG&f=1", "display_name": "mrod", "link": "https://stackoverflow.com/users/8267408/mrod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 564, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1499879197, "creation_date": 1499873055, "last_edit_date": 1499874284, "question_id": 45061837, "link": "https://stackoverflow.com/questions/45061837/vba-loop-updating-series-in-chart-using-data-from-another-sheet", "title": "VBA loop updating series in chart using data from another sheet", "body": "<p>In sheets(\"Cost\"), there is an error commented in the code below. Once the error is resolved, I plan to put a 'c(x)' counter to loop through each chart</p>\n\n<p>Run-time error '1004':\nMethod 'Range' of object '_Worksheet' failed </p>\n\n<p>I think the error has something to do with how I am referencing the other sheet</p>\n\n<pre><code>Dim p As Worksheet, cost As Worksheet\nSet cost = Workbooks(\"dashboard.xlsm\").Worksheets(\"Cost\")\nSet p = Workbooks(\"dashboard.xlsm\").Worksheets(\"p\")\n\nDim c(1 To 3) As Variant\n\np.Activate\n'[c(x)] denotes ranges for each chart object\n'modified by counter [i], denoting ranges for each series\nSet c(1) = p.Range(Cells(3, 1 + i), Cells(3, 1 + i).End(xlDown))\nSet c(2) = p.Range(Cells(3, 4 + i), Cells(3, 4 + i).End(xlDown))\nSet c(3) = p.Range(Cells(3, 8 + i), Cells(3, 8 + i).End(xlDown))\n\ncost.Activate\nFor i = 1 To 2\n    With ActiveSheet.ChartObjects(\"Chart 1\").Chart.SeriesCollection(i)\n    'all charts follow same time series\n    .XValues = p.Range(Range(\"a3\"), Range(\"a3\").End(xlDown)) '**error here**\n    .Values = c(1)\n    End With\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 7463843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80d410c1245cc1bcca1a0eca65bba589?s=128&d=identicon&r=PG&f=1", "display_name": "PaulDragoonM", "link": "https://stackoverflow.com/users/7463843/pauldragoonm"}, "is_accepted": false, "score": 0, "last_activity_date": 1499885145, "last_edit_date": 1499885145, "creation_date": 1499878100, "answer_id": 45063468, "question_id": 45061794, "link": "https://stackoverflow.com/questions/45061794/switching-between-macros-located-in-different-workbooks/45063468#45063468", "title": "Switching between macros located in different workbooks", "body": "<p>I notice that after executing <code>Workbook.Close</code>, the VBA stops executing. Therefore, you should be careful of codes placed after the Workbook.Close. </p>\n\n<p>You may consider transfer the <code>Workbook.Close</code> method to 1.xlsm. Perform any actions before you execute the <code>Workbook.Close</code> method.</p>\n\n<p>I modified the codes as follows.</p>\n\n<p><strong>1.xlsm</strong>\nModule1</p>\n\n<pre><code>Option Explicit\n\nSub anotherMacro()\n    Dim path As String\n    Dim Fname As String\n    Dim macroName As String\n\n    With Application\n        path = .ThisWorkbook.path\n        Fname = .ThisWorkbook.Name\n\n        .Workbooks.Open (path &amp; \"\\a\" &amp; Fname)\n        .Run \"a1.xlsm!Module1.SecondMacro\"\n    End With\nEnd Sub\n\nSub WelcomeBack()\n    MsgBox \"Am I still here?\"\n\n    Application.ThisWorkbook.Activate\n        ' Activate 1.xlsm. This is optional, depending on your needs.\n\n    ' Add code here to perform any further actions.\n\n    Application.Workbooks(\"a1.xlsm\").Close\n        ' Close a1.xlsm. VBA stops here.\nEnd Sub\n</code></pre>\n\n<p><strong>a1.xlsm</strong>\nModule1</p>\n\n<pre><code>Option Explicit\n\nSub SecondMacro()\n    ' Add code here to perform any actions.\n\n    Application.Run \"1.xlsm!Module1.WelcomeBack\"\n        ' Go back to 1.xlsm\nEnd Sub\n</code></pre>\n\n<p>PS: Check out the difference between <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-activeworkbook-property-excel\" rel=\"nofollow noreferrer\"><code>Application.ActiveWorkbook</code></a> and <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-thisworkbook-property-excel\" rel=\"nofollow noreferrer\"><code>Application.ThisWorkbook</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1499881111, "creation_date": 1499881111, "answer_id": 45064299, "question_id": 45061794, "link": "https://stackoverflow.com/questions/45061794/switching-between-macros-located-in-different-workbooks/45064299#45064299", "title": "Switching between macros located in different workbooks", "body": "<p>If you put your VBA code in an XLAM file instead of an XLSM file, then you can add it as an Excel Add-In and it can then communicate with all workbooks simultaneously.</p>\n"}], "owner": {"reputation": 1, "user_id": 8296693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/358497fdff07ba332a61e99c3f33612a?s=128&d=identicon&r=PG&f=1", "display_name": "MickeyDorn", "link": "https://stackoverflow.com/users/8296693/mickeydorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499885145, "creation_date": 1499872930, "question_id": 45061794, "link": "https://stackoverflow.com/questions/45061794/switching-between-macros-located-in-different-workbooks", "title": "Switching between macros located in different workbooks", "body": "<p>Let's assume I have 2 different files: \"1\" and \"a1\".\nI want to open second one using macro from \"1\" and then run a code from \"a1\"</p>\n\n<p>So, in \"1\" I have following code:</p>\n\n<pre><code>Sub anotherMacro()\nDim path As String\nDim Fname As String\nDim macroName As String\n\npath = ActiveWorkbook.path\nFname = ActiveWorkbook.Name\n\nWorkbooks.Open (path &amp; \"\\a\" &amp; Fname)\nApplication.Run \"a1.xlsm!Module1.SecondMacro\"\nMsgBox \"Am I still here?\"\n\nEnd Sub\n</code></pre>\n\n<p>Second macro in file \"a1\" looks like that:</p>\n\n<pre><code>Sub SecondMacro()\nActiveWorkbook.Close\nEnd Sub\n</code></pre>\n\n<p>When I'm using Application.Run command, the msgbox is not being executed. The \"a1\" is getting opened, closed and then there is no further action.</p>\n\n<p>Is there a way to get back to \"1\" and display the msgbox?</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "ms-word"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1499872624, "post_id": 45061640, "comment_id": 77096623, "body": "Check your data, are there any errors/issues in the data itself?"}, {"owner": {"reputation": 13, "user_id": 6796888, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Zmh8x.jpg?s=128&g=1", "display_name": "alejandraux", "link": "https://stackoverflow.com/users/6796888/alejandraux"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1499929669, "post_id": 45061640, "comment_id": 77119777, "body": "I already checked  the data itself ann it has no errors. I would not be asking     here without checking my file first. @BruceWayne"}], "answers": [{"tags": [], "owner": {"reputation": 4147, "user_id": 6654077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa3deaf30afffe58c663f22106e4fe9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabien", "link": "https://stackoverflow.com/users/6654077/fabien"}, "is_accepted": false, "score": 0, "last_activity_date": 1499872825, "creation_date": 1499872825, "answer_id": 45061751, "question_id": 45061640, "link": "https://stackoverflow.com/questions/45061640/getting-a-div-0-error-when-doing-averageif/45061751#45061751", "title": "Getting A #DIV/0 Error When Doing &quot;AVERAGEIF&quot;", "body": "<p>An average is a sum and a division. </p>\n\n<p>What you get is a division by zero error, indicating that one of your data set is empty. In such cases, you cannot perform an average or you will try to divide by zero.</p>\n"}], "owner": {"reputation": 13, "user_id": 6796888, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Zmh8x.jpg?s=128&g=1", "display_name": "alejandraux", "link": "https://stackoverflow.com/users/6796888/alejandraux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 455, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1499872825, "creation_date": 1499872526, "question_id": 45061640, "link": "https://stackoverflow.com/questions/45061640/getting-a-div-0-error-when-doing-averageif", "title": "Getting A #DIV/0 Error When Doing &quot;AVERAGEIF&quot;", "body": "<p>So, I have a code here that performs AVERAGEIF but I always get a #DIV/0 error. I don't know what seems  to be wrong here. I hope someone  could help.  </p>\n\n<pre><code>     Dim aveif1\n     Dim aveif2\n     Dim aveval\n     Dim totalave As Variant\n     Dim colAve\n     Dim aveSource As Range\n     Dim aveCheck As Range\n     Dim lCol \n\n     lCol = 19\n     colAve = lCol + 1\n\n\n\n    For aveif1 = 3 To ColBanner\n\n        aveval = CStr(Cells(1, aveif1).Value)\n\n       For aveif2 = 3 To RowBanner\n\n            With Sheets(\"Rescaled Scores\")\n\n             totalave = Application.AverageIf(Columns(colAve), \"Smartphone\", Columns(aveif2))\n\n            End With\n\n        colAve = colAve + 1\n        Cells(aveif2, aveif1).Value = totalave\n        Columns.AutoFit\n\n       Next aveif2\n\n\n\n    Next aveif1\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2250, "user_id": 1923086, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/6CM1f.jpg?s=128&g=1", "display_name": "JahKnows", "link": "https://stackoverflow.com/users/1923086/jahknows"}, "edited": false, "score": 0, "creation_date": 1499872456, "post_id": 45061507, "comment_id": 77096486, "body": "Please provide images of the worksheets such that we can better understand their structure. This is indeed a doable task and is well suited for VBA."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1499872598, "post_id": 45061507, "comment_id": 77096604, "body": "<a href=\"https://stackoverflow.com/questions/10714251/\">Don&#39;t use <code>.Select</code>/<code>.Activate</code></a>.  Instead, use worksheet variables to do it.  Also, when you do that second <code>.Copy</code>, it is &quot;overwriting&quot; your first <code>.Copy</code>, effectively negating the need for that first line.  Also, on your Sheet7, I assume you don&#39;t want to overwrite the data each time, but instead add the blocks of data from the other sheets to below the newely copied info?"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1499873323, "post_id": 45061507, "comment_id": 77097160, "body": "how can you copy the same range A2:J15 from all 6 sheets to the 7th sheet? Doing this would just make the 7th sheet to have the 6th sheets data"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8296657, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rhNSQQjuidU/AAAAAAAAAAI/AAAAAAAAACI/q3CqlAWJHjk/photo.jpg?sz=128", "display_name": "Jay Sterling", "link": "https://stackoverflow.com/users/8296657/jay-sterling"}, "edited": false, "score": 0, "creation_date": 1499931303, "post_id": 45061866, "comment_id": 77120929, "body": "Hi @Kiralancer , I tried this code that you have suggested,  I get a error which says that &#39;subscript out of range&#39; - Sub sbCopyRangeToAnotherSheet()      Sheets(&quot;Source 1&quot;).Range(&quot;A1:J15&quot;).Copy Sheets(&quot;7&quot;).Range(&quot;A1&quot;)"}, {"owner": {"reputation": 51, "user_id": 1714921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bfba16e62f58ce6b61d59a384cd766a?s=128&d=identicon&r=PG", "display_name": "Kiralancer", "link": "https://stackoverflow.com/users/1714921/kiralancer"}, "reply_to_user": {"reputation": 19, "user_id": 8296657, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rhNSQQjuidU/AAAAAAAAAAI/AAAAAAAAACI/q3CqlAWJHjk/photo.jpg?sz=128", "display_name": "Jay Sterling", "link": "https://stackoverflow.com/users/8296657/jay-sterling"}, "edited": false, "score": 0, "creation_date": 1500246355, "post_id": 45061866, "comment_id": 77237472, "body": "What are the sheet names and ranges. The above ranges were just derived from yours."}], "tags": [], "owner": {"reputation": 51, "user_id": 1714921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bfba16e62f58ce6b61d59a384cd766a?s=128&d=identicon&r=PG", "display_name": "Kiralancer", "link": "https://stackoverflow.com/users/1714921/kiralancer"}, "is_accepted": false, "score": 1, "last_activity_date": 1499873131, "creation_date": 1499873131, "answer_id": 45061866, "question_id": 45061507, "link": "https://stackoverflow.com/questions/45061507/copy-range-from-multiple-sheets-rather-than-just-one-sheet/45061866#45061866", "title": "Copy range from multiple sheets rather than just one sheet", "body": "<p>As sugguested in the comments:</p>\n\n<pre><code>Sub sbCopyRangeToAnotherSheet()\n     Sheets(\"Source1\").Range(\"A1:B10\").Copy Sheets(\"7\").Range(\"A1\")\n     Sheets(\"Source2\").Range(\"A1:B10\").Copy Sheets(\"7\").Range(\"A1\").end(xlDown).offset(1,0)\n     Sheets(\"Source3\").Range(\"A1:B10\").Copy Sheets(\"7\").Range(\"A1\").end(xlDown).offset(1,0)\n     Sheets(\"Source4\").Range(\"A1:B10\").Copy Sheets(\"7\").Range(\"A1\").end(xlDown).offset(1,0)\n     Sheets(\"Source5\").Range(\"A1:B10\").Copy Sheets(\"7\").Range(\"A1\").end(xlDown).offset(1,0)\n     Sheets(\"Source6\").Range(\"A1:B10\").Copy Sheets(\"7\").Range(\"A1\").end(xlDown).offset(1,0)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 8296657, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rhNSQQjuidU/AAAAAAAAAAI/AAAAAAAAACI/q3CqlAWJHjk/photo.jpg?sz=128", "display_name": "Jay Sterling", "link": "https://stackoverflow.com/users/8296657/jay-sterling"}, "edited": false, "score": 0, "creation_date": 1499931875, "post_id": 45062037, "comment_id": 77121296, "body": "Thanks @Kieran,  This worked for me!!  Very Much appreciated,  Jay"}], "tags": [], "owner": {"reputation": 173, "user_id": 8271065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e104b70d6a9a88ef873ee3be028cab68?s=128&d=identicon&r=PG&f=1", "display_name": "qz_99", "link": "https://stackoverflow.com/users/8271065/qz-99"}, "is_accepted": true, "score": 1, "last_activity_date": 1499873586, "creation_date": 1499873586, "answer_id": 45062037, "question_id": 45061507, "link": "https://stackoverflow.com/questions/45061507/copy-range-from-multiple-sheets-rather-than-just-one-sheet/45062037#45062037", "title": "Copy range from multiple sheets rather than just one sheet", "body": "<p>Your problem is coming from your attempt to copy two items directly after each other. The second copy call is overwriting the data you copied in the first call.</p>\n\n<pre><code>Sheets(\"Source1\").Range(\"A1:B10\").Copy\nSheets(\"Destination\").Activate\nRange(\"A1:B10\").Select\nActiveSheet.Paste\n\nSheets(\"Source2\").Range(\"&lt;your new range here&gt;\").Copy\nSheets(\"Destination\").Activate\nRange(\"&lt;your new range here&gt;\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>The code above should explain what I mean albeit not the most efficient way. A more effective way would be to use:</p>\n\n<pre><code>Sheets(\"Source1\").Range(\"A1:B10\").Copy Destination:=Sheets(\"Destination\").Range(\"A1:B10\")\n\nSheets(\"Source2\").Range(\"A1:B10\").Copy Destination:=Sheets(\"Destination\").Range(\"&lt;range&gt;\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 8296657, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rhNSQQjuidU/AAAAAAAAAAI/AAAAAAAAACI/q3CqlAWJHjk/photo.jpg?sz=128", "display_name": "Jay Sterling", "link": "https://stackoverflow.com/users/8296657/jay-sterling"}, "edited": false, "score": 0, "creation_date": 1499931569, "post_id": 45070566, "comment_id": 77121096, "body": "Hi @idktho  I get the same error where it says &quot;subscript out of range&quot; for;  Sheets(&quot;Source&quot; &amp; i).Range(&quot;A1:J15&quot;).Copy Sheets(&quot;Destination&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Offset(1)  The only thing i have changed is the range."}, {"owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "reply_to_user": {"reputation": 19, "user_id": 8296657, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rhNSQQjuidU/AAAAAAAAAAI/AAAAAAAAACI/q3CqlAWJHjk/photo.jpg?sz=128", "display_name": "Jay Sterling", "link": "https://stackoverflow.com/users/8296657/jay-sterling"}, "edited": false, "score": 0, "creation_date": 1499932499, "post_id": 45070566, "comment_id": 77121702, "body": "Hi @JaySterling , please check that the sheets name are correct and it exists, and it is the active workbook (close other workbooks just in case if you have it open). Also, is there a spacing between &quot;Source&quot; and &quot;1&quot; ?"}], "tags": [], "owner": {"reputation": 109, "user_id": 8059184, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69c1f1925d38278d7333bc380951b038?s=128&d=identicon&r=PG&f=1", "display_name": "idktho", "link": "https://stackoverflow.com/users/8059184/idktho"}, "is_accepted": false, "score": 0, "last_activity_date": 1499913626, "creation_date": 1499913626, "answer_id": 45070566, "question_id": 45061507, "link": "https://stackoverflow.com/questions/45061507/copy-range-from-multiple-sheets-rather-than-just-one-sheet/45070566#45070566", "title": "Copy range from multiple sheets rather than just one sheet", "body": "<p>Assuming that you want to paste the data by rows (and not overwrite it), and your sheets are named Source1 to Source6, then the following should work: </p>\n\n<pre><code>Sub testSO()\n\nFor i = 1 To 6\n    Sheets(\"Source\" &amp; i).Range(\"A1:B10\").Copy Sheets(\"Destination\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8296657, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rhNSQQjuidU/AAAAAAAAAAI/AAAAAAAAACI/q3CqlAWJHjk/photo.jpg?sz=128", "display_name": "Jay Sterling", "link": "https://stackoverflow.com/users/8296657/jay-sterling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 45062037, "answer_count": 3, "score": 0, "last_activity_date": 1499913626, "creation_date": 1499872168, "last_edit_date": 1592644375, "question_id": 45061507, "link": "https://stackoverflow.com/questions/45061507/copy-range-from-multiple-sheets-rather-than-just-one-sheet", "title": "Copy range from multiple sheets rather than just one sheet", "body": "<h1>Background</h1>\n<p>I have a workbook with 7 sheets but only 6 with data. All of these 7 sheets have the same structure/headings, it's just that the last sheet (sheet 7) is blank.</p>\n<p>I want to write a code that will copy the contents of sheets 1-6 in the range of A2:J15 into the sheet 7 worksheet.  I currently have a code that I have been using to test and see if it works but the code I have only copies and pastes from one worksheet only (see below). Any suggestions?</p>\n<p>In the below, I have two sheets where I want the data to come from and the destination sheet where I want the data to go:</p>\n<pre><code>Sub sbCopyRangeToAnotherSheet()\nSheets(&quot;Source1&quot;).Range(&quot;A1:B10&quot;).Copy\nSheets(&quot;Source2&quot;).Range(&quot;A1:B10&quot;).Copy\nSheets(&quot;Destination&quot;).Activate\nRange(&quot;A1:B10&quot;).Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "formula", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1499872667, "post_id": 45061492, "comment_id": 77096655, "body": "This looks like GSA data. Are the receivers restricted to US destinations or could they be international? Suggest you use <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a> <a href=\"https://stackoverflow.com/questions/tagged/regex\">regex</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1499872766, "post_id": 45061492, "comment_id": 77096744, "body": "Have you looked at the data closely? There may be zero-length space characters hiding within which can be used for TextToColumns."}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1499873457, "post_id": 45061492, "comment_id": 77097254, "body": "is there any format that you have observed common with all the addresses?"}, {"owner": {"reputation": 113, "user_id": 7038457, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/1195591493820028/picture?type=large", "display_name": "Alex Imperiale", "link": "https://stackoverflow.com/users/7038457/alex-imperiale"}, "edited": false, "score": 0, "creation_date": 1499874419, "post_id": 45061492, "comment_id": 77097918, "body": "What is a zero-length space character and what should I be looking for? @jeeped"}, {"owner": {"reputation": 113, "user_id": 7038457, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/1195591493820028/picture?type=large", "display_name": "Alex Imperiale", "link": "https://stackoverflow.com/users/7038457/alex-imperiale"}, "reply_to_user": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1499874466, "post_id": 45061492, "comment_id": 77097944, "body": "unfortunately I have not been able to find anything common within these addresses @GowthamShiva"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1499874795, "post_id": 45061492, "comment_id": 77098192, "body": "In S2 put <code>=unicode(mid(q$2, row(1:1), 1))</code> and fill down. This returns the unicode for each character. Look for numbers that are not 32 (conventional space), not 48 to 57 (numbers) and not 65 to 90 (uppercase letters). If you cannot find any then your task is impossible without a cross-lookup based on zip code."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 7038457, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/1195591493820028/picture?type=large", "display_name": "Alex Imperiale", "link": "https://stackoverflow.com/users/7038457/alex-imperiale"}, "edited": false, "score": 0, "creation_date": 1499877208, "post_id": 45062978, "comment_id": 77099614, "body": "This is fantastic and works great.  Thank you for your help on this."}], "tags": [], "owner": {"reputation": 2583, "user_id": 2908576, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/yhWY7.jpg?s=128&g=1", "display_name": "HaveSpacesuit", "link": "https://stackoverflow.com/users/2908576/havespacesuit"}, "is_accepted": true, "score": 0, "last_activity_date": 1499876343, "creation_date": 1499876343, "answer_id": 45062978, "question_id": 45061492, "link": "https://stackoverflow.com/questions/45061492/excel-column-separation/45062978#45062978", "title": "Excel Column Separation", "body": "<p>I can't help with separating the street address and city (unless you are lucky and there are zero-width spaces in your data, as mentioned in the comments). But we can get your states and zip codes by adapting the formulas in <a href=\"https://stackoverflow.com/a/18617720/2908576\">this answer</a>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/58rGP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/58rGP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Helper column:</p>\n\n<pre><code>=LEFT(A2,FIND(\"@\",SUBSTITUTE(A2,\" \",\"@\",(LEN(A2)-LEN(SUBSTITUTE(A2,\" \",\"\")))/LEN(\" \")))-1)\n</code></pre>\n\n<p>Street Address + City:</p>\n\n<pre><code>=LEFT(B2,LEN(B2)-2)\n</code></pre>\n\n<p>State:</p>\n\n<pre><code>=RIGHT(B2,2)\n</code></pre>\n\n<p>Zip Helper:</p>\n\n<pre><code>=TRIM(RIGHT(SUBSTITUTE(A2,\" \",REPT(\" \",LEN(A2))),LEN(A2)))\n</code></pre>\n\n<p>Zip:</p>\n\n<pre><code>=IF(LEN(E2)&gt;5,LEFT(E2,5)&amp;\"-\"&amp;RIGHT(E2,LEN(E2)-5),E2)\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7038457, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/1195591493820028/picture?type=large", "display_name": "Alex Imperiale", "link": "https://stackoverflow.com/users/7038457/alex-imperiale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 45062978, "answer_count": 1, "score": 0, "last_activity_date": 1499876343, "creation_date": 1499872109, "last_edit_date": 1531161705, "question_id": 45061492, "link": "https://stackoverflow.com/questions/45061492/excel-column-separation", "title": "Excel Column Separation", "body": "<p>I have an Excel challenge that has been giving me issues.  If you see attached I was able to successfully separate the \"senders address\" column into an address, state, city, zip format.  The problem I am having is the \"receivers address\" column.  I tried using the text to columns feature but the spacing throws off the data drastically.</p>\n\n<p>Does anyone know a better solution on how to potentially separate the receivers address column into the address, city, state, and zip format?</p>\n\n<p>See example here.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pbUdD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pbUdD.png\" alt=\"Excel Sheet Image\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 414, "user_id": 5070050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ccc9680bd5da85e8475b251367d3c9e?s=128&d=identicon&r=PG&f=1", "display_name": "sbk", "link": "https://stackoverflow.com/users/5070050/sbk"}, "edited": false, "score": 0, "creation_date": 1499921511, "post_id": 45061683, "comment_id": 77115832, "body": "I have to use the same formula which I mentioned above. It&#39;s about extracting first 6 digits and then comparing with current date. Could you please check how to put that formula in Data validation field?"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 414, "user_id": 5070050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ccc9680bd5da85e8475b251367d3c9e?s=128&d=identicon&r=PG&f=1", "display_name": "sbk", "link": "https://stackoverflow.com/users/5070050/sbk"}, "edited": false, "score": 0, "creation_date": 1499950510, "post_id": 45061683, "comment_id": 77135000, "body": "@sbk:  modified my answer."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1499950466, "last_edit_date": 1499950466, "creation_date": 1499872631, "answer_id": 45061683, "question_id": 45061438, "link": "https://stackoverflow.com/questions/45061438/restricting-the-text-to-be-entered-in-a-cell-with-custom-formula-data-validatio/45061683#45061683", "title": "Restricting the text to be entered in a cell with Custom Formula (Data Validation)", "body": "<p>The code would be like this.</p>\n\n<pre><code>If Range(\"h10\") &gt;= Format(Date, \"yymmdd\") Then\n</code></pre>\n\n<p>If the cell of validation is b1 cell,  the validation formula is bellow.</p>\n\n<pre><code>=B1&gt;=TEXT(TODAY(),\"yymmdd\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 414, "user_id": 5070050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ccc9680bd5da85e8475b251367d3c9e?s=128&d=identicon&r=PG&f=1", "display_name": "sbk", "link": "https://stackoverflow.com/users/5070050/sbk"}, "edited": false, "score": 0, "creation_date": 1499921505, "post_id": 45061991, "comment_id": 77115827, "body": "I have to use the same formula which I mentioned above. It&#39;s about extracting first 6 digits and then comparing with current date. Could you please check how to put that formula in Data validation field?"}], "tags": [], "owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "is_accepted": false, "score": 0, "last_activity_date": 1499873476, "creation_date": 1499873476, "answer_id": 45061991, "question_id": 45061438, "link": "https://stackoverflow.com/questions/45061438/restricting-the-text-to-be-entered-in-a-cell-with-custom-formula-data-validatio/45061991#45061991", "title": "Restricting the text to be entered in a cell with Custom Formula (Data Validation)", "body": "<p>you will have to put today() in a cell, and do the data validation for Date with refrence to >= to that cell. Inside data validation.</p>\n"}, {"comments": [{"owner": {"reputation": 414, "user_id": 5070050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ccc9680bd5da85e8475b251367d3c9e?s=128&d=identicon&r=PG&f=1", "display_name": "sbk", "link": "https://stackoverflow.com/users/5070050/sbk"}, "edited": false, "score": 0, "creation_date": 1499884536, "post_id": 45062175, "comment_id": 77103692, "body": "<code>CLng(Left(Range(&quot;H10&quot;).Value, 6)) &gt;= CLng(Right(Year(Date), 2) &amp; Format(Now, &quot;MMDD&quot;))</code> If I wanted to use this code, What modification I need to make to get it worked in Custom Formula?"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 414, "user_id": 5070050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ccc9680bd5da85e8475b251367d3c9e?s=128&d=identicon&r=PG&f=1", "display_name": "sbk", "link": "https://stackoverflow.com/users/5070050/sbk"}, "edited": false, "score": 0, "creation_date": 1499940199, "post_id": 45062175, "comment_id": 77127214, "body": "@sbk  You want to compare the date entered always with today&#39;s date?"}, {"owner": {"reputation": 414, "user_id": 5070050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ccc9680bd5da85e8475b251367d3c9e?s=128&d=identicon&r=PG&f=1", "display_name": "sbk", "link": "https://stackoverflow.com/users/5070050/sbk"}, "edited": false, "score": 0, "creation_date": 1499940969, "post_id": 45062175, "comment_id": 77127833, "body": "first I need to extract first 6 characters and then I have to compare it with the current date."}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 414, "user_id": 5070050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ccc9680bd5da85e8475b251367d3c9e?s=128&d=identicon&r=PG&f=1", "display_name": "sbk", "link": "https://stackoverflow.com/users/5070050/sbk"}, "edited": false, "score": 0, "creation_date": 1499942074, "post_id": 45062175, "comment_id": 77128632, "body": "first 6? what is the full length string then? how lengthier it is?"}, {"owner": {"reputation": 414, "user_id": 5070050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ccc9680bd5da85e8475b251367d3c9e?s=128&d=identicon&r=PG&f=1", "display_name": "sbk", "link": "https://stackoverflow.com/users/5070050/sbk"}, "edited": false, "score": 0, "creation_date": 1499942445, "post_id": 45062175, "comment_id": 77128891, "body": "The string is a combination of date and two more parameters that are alpha numeric. The string may be of length 20."}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 414, "user_id": 5070050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ccc9680bd5da85e8475b251367d3c9e?s=128&d=identicon&r=PG&f=1", "display_name": "sbk", "link": "https://stackoverflow.com/users/5070050/sbk"}, "edited": false, "score": 0, "creation_date": 1499944074, "post_id": 45062175, "comment_id": 77129912, "body": "<code>=(DATEVALUE(TEXT(LEFT(H10,6),&quot;mm&#47;dd&#47;yy&quot;))&gt;=DATEVALUE(TEXT(TO&zwnj;&#8203;DAY(),&quot;mm&#47;dd&#47;yy&quot;)))</code>  try this"}], "tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": false, "score": 0, "last_activity_date": 1499873988, "creation_date": 1499873988, "answer_id": 45062175, "question_id": 45061438, "link": "https://stackoverflow.com/questions/45061438/restricting-the-text-to-be-entered-in-a-cell-with-custom-formula-data-validatio/45062175#45062175", "title": "Restricting the text to be entered in a cell with Custom Formula (Data Validation)", "body": "<p>Try this custom formula in data validation. </p>\n\n<pre><code>=(DATEVALUE(TEXT(B1,\"mm/dd/yy\"))&gt;=DATEVALUE(TEXT($A$1,\"mm/dd/yy\")))\n</code></pre>\n\n<p>The above formula is to apply data validation in <code>Column B</code> when the date <code>170712</code> is in cell <code>A1</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/2poe3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2poe3.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 414, "user_id": 5070050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1ccc9680bd5da85e8475b251367d3c9e?s=128&d=identicon&r=PG&f=1", "display_name": "sbk", "link": "https://stackoverflow.com/users/5070050/sbk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1499950466, "creation_date": 1499871987, "last_edit_date": 1499884764, "question_id": 45061438, "link": "https://stackoverflow.com/questions/45061438/restricting-the-text-to-be-entered-in-a-cell-with-custom-formula-data-validatio", "title": "Restricting the text to be entered in a cell with Custom Formula (Data Validation)", "body": "<p>I've a string in a Cell which contains a date in <code>YYMMDD</code> format in it's first 6 characters. I want to restrict the user to enter only the value which is greater than or equal to current date.</p>\n\n<p><code>170712</code> should be allowed as it's greater than or equal to current date <code>170712</code>.</p>\n\n<p>With VBA, the following formula is working fine:</p>\n\n<pre><code>CLng(Left(Range(\"H10\").Value, 6)) &gt;= CLng(Right(Year(Date), 2) &amp; Format(Now, \"MMDD\"))\n</code></pre>\n\n<p>The same formula is not working when put it custom formula under data validation !</p>\n\n<p>How should I put this in Data Validation Custom Formula Field in excel so I can restrict user the way I mentioned above?</p>\n"}, {"tags": ["excel", "vba", "checkbox", "userform"], "comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1499871881, "post_id": 45061353, "comment_id": 77096017, "body": "does the checkbox not stay check when you check it?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1499872076, "post_id": 45061353, "comment_id": 77096173, "body": "are you unloading the form or something? checkboxes stay checked by default... what are we missing?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499873311, "post_id": 45061876, "comment_id": 77097155, "body": "Meh. Could be right, could be wrong. Nobody can tell. Question isn&#39;t answerable as it stands - why even bother?"}, {"owner": {"reputation": 483, "user_id": 4974739, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/AiKVP.jpg?s=128&g=1", "display_name": "Drew Bennett", "link": "https://stackoverflow.com/users/4974739/drew-bennett"}, "edited": false, "score": 0, "creation_date": 1499875229, "post_id": 45061876, "comment_id": 77098528, "body": "Where would this be located?"}], "tags": [], "owner": {"reputation": 1, "user_id": 5149655, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cEx2Lalrl0/AAAAAAAAAAI/AAAAAAAAEgI/LULL54IljAI/photo.jpg?sz=128", "display_name": "matt", "link": "https://stackoverflow.com/users/5149655/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1499873148, "creation_date": 1499873148, "answer_id": 45061876, "question_id": 45061353, "link": "https://stackoverflow.com/questions/45061353/keep-check-box-checked-userform/45061876#45061876", "title": "Keep Check box Checked Userform", "body": "<p>Make sure you don't have an \"Unload Me\" or \"Unload Userform#\" before you are trying to call the modules. This will reset the userform to the default. </p>\n\n<p>You can also change the default (check/unchecked) for each checkbox. While building the userform, click on the checkbox, and in theproperties window, select if you want it to be set as true or false as the default. </p>\n"}, {"tags": [], "owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "is_accepted": true, "score": 3, "last_activity_date": 1499914035, "last_edit_date": 1499914035, "creation_date": 1499912953, "answer_id": 45070479, "question_id": 45061353, "link": "https://stackoverflow.com/questions/45061353/keep-check-box-checked-userform/45070479#45070479", "title": "Keep Check box Checked Userform", "body": "<p>As long as the spreadsheet remains open, <code>Me.Hide</code> instead of <code>Unload Me</code> will do the trick, but once closed, the spreadsheet won't be able to remember the settings any more.</p>\n\n<p>If you want the spreadsheet to remember the settings, even if it's closed, the selection settings need to be captured somewhere.</p>\n\n<p>Let's say we created a sheet named \"chkboxVal\". We can then store the data there through <code>Ok_Click</code> event/procedure, and get the data back through the <code>UserForm_Initialize()</code> section.</p>\n\n<p>The code will look like this:</p>\n\n<pre><code>Private Sub Ok_Click()\n    Dim ctrl As Control, i As Integer\n    For Each ctrl In UserForm1.Controls\n       If TypeName(ctrl) = \"CheckBox\" Then\n           i = i + 1\n           Sheets(\"chkboxVal\").Cells(i, 1) = ctrl.Value\n       End If\n    Next\n    Unload Me\nEnd Sub\nPrivate Sub UserForm_Initialize()\n    Dim ctrl As Control, i As Integer\n    For Each ctrl In UserForm1.Controls\n       If TypeName(ctrl) = \"CheckBox\" Then\n           i = i + 1\n           ctrl.Value = Sheets(\"chkboxVal\").Cells(i, 1)\n       End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>You might also want hide the \"chkboxVal\" sheet in a way that users aren't able to unhide it. If so, just add this line in the module.</p>\n\n<pre><code>Sheets(\"chkboxVal\").Visible = xlVeryHidden\n</code></pre>\n"}], "owner": {"reputation": 483, "user_id": 4974739, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/AiKVP.jpg?s=128&g=1", "display_name": "Drew Bennett", "link": "https://stackoverflow.com/users/4974739/drew-bennett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2210, "favorite_count": 0, "accepted_answer_id": 45070479, "answer_count": 2, "score": 0, "last_activity_date": 1554221405, "creation_date": 1499871740, "question_id": 45061353, "link": "https://stackoverflow.com/questions/45061353/keep-check-box-checked-userform", "title": "Keep Check box Checked Userform", "body": "<p>Currently, I have created a user form with three check boxes. These check boxes activate modules I have created. When I check the box in the user form I want the box to stay checked or unchecked. Any thoughts?</p>\n"}, {"tags": ["vba", "excel", "powerdesigner"], "answers": [{"tags": [], "owner": {"reputation": 3059, "user_id": 202367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca76b7b553fb6ccdf4982024c82200f3?s=128&d=identicon&r=PG", "display_name": "pascal", "link": "https://stackoverflow.com/users/202367/pascal"}, "is_accepted": false, "score": 0, "last_activity_date": 1499891630, "creation_date": 1499891630, "answer_id": 45067032, "question_id": 45061240, "link": "https://stackoverflow.com/questions/45061240/powerdesigner-vb-vba-how-to-set-default-table-mapping-for-excel-source-2-target/45067032#45067032", "title": "powerdesigner vb/vba how to set default table mapping for excel source 2 target extract", "body": "<p>Not exactly the same objects, as I started playing with Conceptual Models. Two sources, and one target, all with entities named Entity_1, Entity_2, with the mappings set as excepted by the wizard.</p>\n\n<p>Not exactly the same code, as I started playing with VBScript...</p>\n\n<p>But it seems I was able to change the default mapping, just by setting the DefaultMapping attribute:</p>\n\n<pre><code>option explicit\ndim myname\nmyname = \"ENTITY_1\"\nDim obj : Set obj = ActiveModel.FindChildByCode(myname, cls_Entity)\noutput \"default: \" &amp; obj.defaultmapping\ndim cm,changed\nchanged = false\nFor Each cm In obj.Mappings\n   output cm\n   if cm &lt;&gt; obj.defaultmapping and not changed then\n      output \"set to \" &amp; cm\n      changed = true\n      set obj.defaultmapping=cm\n   end if\nNext\noutput \"default: \" &amp; obj.defaultmapping\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 3120960, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0ce3f47a6ea412a8591b0d158c2252f2?s=128&d=identicon&r=PG&f=1", "display_name": "user3120960", "link": "https://stackoverflow.com/users/3120960/user3120960"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499891630, "creation_date": 1499871485, "last_edit_date": 1531164843, "question_id": 45061240, "link": "https://stackoverflow.com/questions/45061240/powerdesigner-vb-vba-how-to-set-default-table-mapping-for-excel-source-2-target", "title": "powerdesigner vb/vba how to set default table mapping for excel source 2 target extract", "body": "<p>I'm working on a script to extract source to target data from powerdesigner 16. I have a table that is sourced from multiple mappings in powerdesigner MAPPING_1, MAPPING_2, ETC.  I can't figure out how to set the default mapping with vba code.  I'm currently access the mappings with the code below.  It will access the default mapping that was active when I last saved my data model.  If anyone has insight on how to do this I would be very greatful.</p>\n\n<p>Thanks</p>\n\n<pre><code>'\n' get the table\n'   Dim mytable, col, cm\n    mytable = 'CUSTOMER_STAGING'\n    Dim obj As PdCommon.IdentifiedObject\n    Set obj = baseModel.FindChildByCode(mytable, cls_Table)\n\n    For Each col In obj.Columns\n       For Each cm In col.Mappings\n       Next\n    next\n</code></pre>\n"}, {"tags": ["excel", "powerpoint", "vba"], "owner": {"reputation": 159, "user_id": 5179321, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ec2c077f8c8bcb3d8313897477a568c?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/5179321/gaus-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499871768, "creation_date": 1499871343, "last_edit_date": 1531164843, "question_id": 45061185, "link": "https://stackoverflow.com/questions/45061185/activex-component-cant-create-object-vba", "title": "ActiveX component can&#39;t create object VBA", "body": "<p>I am getting an error while converting PPT to PDF as\" ActiveX component can't create object VBA\"</p>\n\n<pre><code>    Dim PPT As PowerPoint.Application\n    Dim newslide As PowerPoint.SlideRange\n    Dim slideCtr As Integer\n    Dim tb As PowerPoint.Shape\n    Set PPT = CreateObject(\"PowerPoint.Application\")\n    PPT.Visible = True\n    PPT.Presentations.Open\"C:\\Users\\GShaikh\\Desktop\\ProcessCoach certificate template.pptx\"\n    Range(\"F8\").Activate  'This cell had a date formatted as a date\n    slideCtr = 1\n\n    Set tb = PPT.ActivePresentation.Slides(slideCtr).Shapes(\"Text Box 4\")\n    tb.TextFrame.TextRange.Characters.Text = Format(ActiveCell.Value, \"m/d/yyyy\")\n\n    'Error is here\n    ActivePresentation.ExportAsFixedFormat ActivePresentation.Path &amp; _\n \"\\\" &amp; ActivePresentation.Name &amp; _\n \".pdf\", ppFixedFormatTypePDF, ppFixedFormatIntentPrint\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499871393, "post_id": 45061082, "comment_id": 77095643, "body": "This would be easily resolved through smart use of excel formulas. Something like <code>=IfError(IfError(Vlookup(Value, Table1, Column, False), Vlookup(Value, Table1, Column, False)), &quot;-&quot;)</code> Something like this would check <code>Table1</code> for the item, if not found it would check <code>Table2</code> if it isnt found there then it returns &quot;-&quot; (which is just intended to replace the <code>#N&#47;A</code>."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 1714921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bfba16e62f58ce6b61d59a384cd766a?s=128&d=identicon&r=PG", "display_name": "Kiralancer", "link": "https://stackoverflow.com/users/1714921/kiralancer"}, "is_accepted": false, "score": 0, "last_activity_date": 1499872641, "creation_date": 1499872641, "answer_id": 45061688, "question_id": 45061082, "link": "https://stackoverflow.com/questions/45061082/excel-vba-dynamic-lookup-two-columns-enter-data-in-either-and-return-value/45061688#45061688", "title": "EXCEL VBA : Dynamic Lookup - Two columns, enter data in either and return value for the other", "body": "<p>I agree with Brandon. This can be solved with smart use of formula. But, I would like to suggest Index Match combination. Since, the table contains 2 columns only and vlookup will only get the left most column as the look up.</p>\n\n<p>=IFERROR(INDEX(PROD_FORMATA, MATCH(, PROD_FOMRATB, )),INDEX(PROD_FORMATB, MATCH(, PROD_FOMRATA, )))</p>\n\n<p>Match will return a number depending on the location of the table\nIndex on the other hand will return the value in the range given the number.</p>\n\n<pre><code>| A          | B       |\n| ---------- | ------- |\n| Ball       | Sports  |\n| Pen        | Writing |\n| Cookie     | Food    |\n| Pencil     | Writing |\n| Test       | Object  |\n</code></pre>\n\n<p>=MATCH(\"TEST\",A1:A5,0)<br>\nreturns 5</p>\n\n<p>=INDEX(B1:B5,5)<br>\nreturns \"Object\"</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6527305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5jODG.jpg?s=128&g=1", "display_name": "KISS Excel VBA", "link": "https://stackoverflow.com/users/6527305/kiss-excel-vba"}, "is_accepted": false, "score": 0, "last_activity_date": 1499873158, "creation_date": 1499873158, "answer_id": 45061879, "question_id": 45061082, "link": "https://stackoverflow.com/questions/45061082/excel-vba-dynamic-lookup-two-columns-enter-data-in-either-and-return-value/45061879#45061879", "title": "EXCEL VBA : Dynamic Lookup - Two columns, enter data in either and return value for the other", "body": "<p>Try this on the code of the sheet (not a module)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    On Error Resume Next\n\n    If Target.Column = 1 Then\n        Range(Target.Address).Offset(0, 1).Value = Application.WorksheetFunction.VLookup(Range(Target.Address), Sheet1.Range(\"E1:F20\"), 2, False)\n    Else\n    End If\n\n    If Target.Column = 2 Then\n        Range(Target.Address).Offset(0, -1).Value = Application.WorksheetFunction.VLookup(Range(Target.Address), Sheet1.Range(\"F1:G20\"), 2, False)\n    Else\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>you ll need to have your 2 vlookup tables E1:F20 and F1:G20 (columns E and G are the same, but we need G because vlookup looks at the leftmost column of our data)</p>\n"}], "owner": {"reputation": 21, "user_id": 6077819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74e905bb47188d0a707da4001c1c7b0c?s=128&d=identicon&r=PG&f=1", "display_name": "user6077819", "link": "https://stackoverflow.com/users/6077819/user6077819"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 305, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1499873158, "creation_date": 1499871120, "question_id": 45061082, "link": "https://stackoverflow.com/questions/45061082/excel-vba-dynamic-lookup-two-columns-enter-data-in-either-and-return-value", "title": "EXCEL VBA : Dynamic Lookup - Two columns, enter data in either and return value for the other", "body": "<p>I would like to create a \"lookup\" spreadsheet whereby I would have two columns (let's say, Prod_Format_A and Prod_Format_B). These would be two versions of a product identifier. I would like the user to be able to enter either format A or format B and have the other one returned...</p>\n\n<p>So if I enter a format A code, I should get back a format B code. \nIf I enter a format B code, I should get back a format A code.</p>\n\n<p>What's the easiest way to go about this? Obviously I would have a separate lookup table to resolve against. </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1499871460, "post_id": 45061076, "comment_id": 77095694, "body": "Add a line underneath like <code>Sheet2.Range(&quot;B4&quot;).NumberFormat = &quot;$#,##0.00&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 8278746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48202190d56ccd338a05bf2e8e3ea98d?s=128&d=identicon&r=PG&f=1", "display_name": "Maximuuuuuus", "link": "https://stackoverflow.com/users/8278746/maximuuuuuus"}, "is_accepted": false, "score": 1, "last_activity_date": 1499871654, "creation_date": 1499871654, "answer_id": 45061312, "question_id": 45061076, "link": "https://stackoverflow.com/questions/45061076/vba-paste-calculated-value-as-date-or-currency/45061312#45061312", "title": "VBA Paste Calculated Value as Date or Currency", "body": "<pre><code>Sub FormatDate()\n\nSelection.NumberFormat = \"dd/mm/yyyy\"\n\nEnd sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1499872033, "creation_date": 1499872033, "answer_id": 45061464, "question_id": 45061076, "link": "https://stackoverflow.com/questions/45061076/vba-paste-calculated-value-as-date-or-currency/45061464#45061464", "title": "VBA Paste Calculated Value as Date or Currency", "body": "<p>Use a Copy then PasteSpecial once for multiplication and again for formatting.</p>\n\n<pre><code>With Sheet2\n    .Range(\"B4\") = 12\n    .Range(\"B3\").Copy\n    .Range(\"B4\").PasteSpecial Paste:=xlPasteValues, Operation:=xlMultiply\n    .Range(\"B4\").PasteSpecial Paste:=xlPasteFormats\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7696753, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6eaa15793ae29d031aed1b899c083214?s=128&d=identicon&r=PG&f=1", "display_name": "JKnight", "link": "https://stackoverflow.com/users/7696753/jknight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1499872033, "creation_date": 1499871107, "last_edit_date": 1499871340, "question_id": 45061076, "link": "https://stackoverflow.com/questions/45061076/vba-paste-calculated-value-as-date-or-currency", "title": "VBA Paste Calculated Value as Date or Currency", "body": "<p>I am using the following vba code to calculate a number from another cell, but when the result is posted in cell B4, it doesn't show a dollar sign currency. I cannot set a range because this is set up to fall on the next available line. I also have a similar calculation that I need shown as a date but it shows as a numerical value.</p>\n\n<p>Sheet2.Range(\"B4\") = Sheet2.Range(\"B3\") * 12</p>\n"}, {"tags": ["excel", "pdf", "vba"], "comments": [{"owner": {"reputation": 6048, "user_id": 766786, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/5uuw5.jpg?s=128&g=1", "display_name": "Amedee Van Gasse", "link": "https://stackoverflow.com/users/766786/amedee-van-gasse"}, "edited": false, "score": 0, "creation_date": 1499946970, "post_id": 45061012, "comment_id": 77132035, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/25168679/vba-code-for-retrieving-pdf-data-with-adobe-acrobat-reader\">VBA Code for Retrieving PDF Data with Adobe Acrobat Reader</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7432, "user_id": 6074376, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/y0n8W.jpg?s=128&g=1", "display_name": "Joris Schellekens", "link": "https://stackoverflow.com/users/6074376/joris-schellekens"}, "is_accepted": false, "score": 3, "last_activity_date": 1499871271, "creation_date": 1499871271, "answer_id": 45061152, "question_id": 45061012, "link": "https://stackoverflow.com/questions/45061012/not-able-to-copy-text-from-pdf-to-excel-using-vba/45061152#45061152", "title": "Not able to copy text from pdf to excel using vba", "body": "<p>Consider using iText. It allows you to read a pdf document (from a file, a generic inputstream, byte[]), and has methods to enable text extraction. With some tweaking you can easily extract the locations of the text as well.</p>\n"}, {"comments": [{"owner": {"reputation": 1519, "user_id": 6156384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BZAmr.png?s=128&g=1", "display_name": "Samuel Huylebroeck", "link": "https://stackoverflow.com/users/6156384/samuel-huylebroeck"}, "edited": false, "score": 0, "creation_date": 1499940126, "post_id": 45061535, "comment_id": 77127167, "body": "#tehcnicallywhatwasaskedfor"}], "tags": [], "owner": {"reputation": 7432, "user_id": 6074376, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/y0n8W.jpg?s=128&g=1", "display_name": "Joris Schellekens", "link": "https://stackoverflow.com/users/6074376/joris-schellekens"}, "is_accepted": false, "score": 7, "last_activity_date": 1499872236, "creation_date": 1499872236, "answer_id": 45061535, "question_id": 45061012, "link": "https://stackoverflow.com/questions/45061012/not-able-to-copy-text-from-pdf-to-excel-using-vba/45061535#45061535", "title": "Not able to copy text from pdf to excel using vba", "body": "<p>Or, if you insist on doing it the current way, here's a java implementation:</p>\n\n<pre><code>Desktop.getDesktop().open(new File(\"C:\\\\Users\\\\Joris Schellekens\\\\Desktop\\\\pdfs\\\\30.pdf\"));\nThread.sleep(5000);\n\nRobot robot = new Robot();\nrobot.delay(1000);\n\n// press CTRL+A\nrobot.keyPress(KeyEvent.VK_CONTROL);\nrobot.keyPress(VK_A);\nrobot.keyRelease(VK_A);\nrobot.keyRelease(KeyEvent.VK_CONTROL);\n\n// press CTRL+C\nrobot.keyPress(KeyEvent.VK_CONTROL);\nrobot.keyPress(VK_C);\nrobot.keyRelease(VK_C);\nrobot.keyRelease(KeyEvent.VK_CONTROL);\n\n// open empty file\nRuntime.getRuntime().exec(\"notepad.exe\");\nThread.sleep(5000);\n\n// press CTRL+V\nrobot.keyPress(KeyEvent.VK_CONTROL);\nrobot.keyPress(VK_V);\nrobot.keyRelease(VK_V);\nrobot.keyRelease(KeyEvent.VK_CONTROL);\n</code></pre>\n\n<p>For performance reasons, I'd time how long it takes to open the document, and how long it takes to open notepad. That way you're not wasting precious milliseconds waiting.</p>\n"}], "owner": {"reputation": 11, "user_id": 5160176, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153261683272771/picture?type=large", "display_name": "Subrat Pathak", "link": "https://stackoverflow.com/users/5160176/subrat-pathak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1499933157, "creation_date": 1499870935, "last_edit_date": 1531164843, "question_id": 45061012, "link": "https://stackoverflow.com/questions/45061012/not-able-to-copy-text-from-pdf-to-excel-using-vba", "title": "Not able to copy text from pdf to excel using vba", "body": "<p>I have a PID drawing (not a scanned copy) in pdf. The pdf has layers of text, object, instrument lines etc. I can see the layers. My objective is to copy the text part and process it as per requirement. However, i am not able to copy any of the text through normal code. Is there a way to do it? Currently, I am using a simple code of opening the pdf and then sending keys <kbd>ctrl+a</kbd> and <kbd>ctrl+c</kbd>.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1499928419, "post_id": 45060953, "comment_id": 77119028, "body": "The simplest way is to set each field&#39;s Indexed property to &quot;Yes (No Duplicates). This way an error message-box is thrown if a value exists. The second approach is through VBA by cancelling the form&#39;s auto-update and handling it manually using a Save button, once validation is successful."}, {"owner": {"reputation": 101, "user_id": 6561329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/780240f3035d55abbaca4318d2c00994?s=128&d=identicon&r=PG&f=1", "display_name": "PolDBQ", "link": "https://stackoverflow.com/users/6561329/poldbq"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1500045950, "post_id": 45060953, "comment_id": 77184411, "body": "That would not work here because two of the three fields can be the same, but not all of the three fields can be the same."}], "owner": {"reputation": 101, "user_id": 6561329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/780240f3035d55abbaca4318d2c00994?s=128&d=identicon&r=PG&f=1", "display_name": "PolDBQ", "link": "https://stackoverflow.com/users/6561329/poldbq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499888514, "creation_date": 1499870800, "last_edit_date": 1499888514, "question_id": 45060953, "link": "https://stackoverflow.com/questions/45060953/delete-a-duplicate-record-on-save-button-of-a-form-in-access", "title": "Delete a duplicate Record on Save Button of a Form in Access", "body": "<p>I am trying to set up a small table and form in Access for some purpose. The table has Four Columns (ID, Name, Date, Amount). The form has all of the table's fields with a save button at the end. Right now it allows for entry of duplicate entries (same Name, Date, Amount). I want to make sure when someone uses the form to make an entry, they can't enter the same Name, Date and Amount twice. So is there a way when someone saves a new record to check if the record exists and then prevent (delete) duplicate entry? I am thinking of some kind of an event that when someone clicks on the Save button. Any code that can do that helps. I have no experience in VB so any help is appreciated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1499869209, "post_id": 45060081, "comment_id": 77093904, "body": "what do you mean by, <code>but neither are working for me</code>?  do they error or not produce the output desired?"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1499869417, "creation_date": 1499869417, "answer_id": 45060388, "question_id": 45060081, "link": "https://stackoverflow.com/questions/45060081/number-stored-as-text-to-number-with-vba/45060388#45060388", "title": "Number stored as text to number with VBA", "body": "<p>What is wrong with something like this:</p>\n\n<pre><code>Public Sub TestMe()\n\n    With Selection\n        .NumberFormat = \"0.00\"\n        .Value = .Value\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 7487154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d1b067104de8cd06a7b7fc97acb9d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Apra", "link": "https://stackoverflow.com/users/7487154/mario-apra"}, "is_accepted": false, "score": 0, "last_activity_date": 1499869738, "creation_date": 1499869738, "answer_id": 45060532, "question_id": 45060081, "link": "https://stackoverflow.com/questions/45060081/number-stored-as-text-to-number-with-vba/45060532#45060532", "title": "Number stored as text to number with VBA", "body": "<p>You can convert them with this:</p>\n\n<pre><code>Function text_to_number(txt As String) As Double\n    text_to_number = txt * 1.0\nEnd Function\n</code></pre>\n\n<p>So, first of all, you need to convert them, and after this, copy to another place.\nSomething like this:</p>\n\n<pre><code>Sub copy_and_paste()\n    Dim numbers(30) As Double\n\n\n    'Copping from range A1:A30\n    For i = 1 To 30\n        numbers(i) = text_to_number(Cells(i, 1).Value)\n    Next i\n\n    'Pasting tn B1:B30\n    For i = i To 30\n        Cells(i, 2).Value = numbers(i)\n    Next i\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499869738, "creation_date": 1499868649, "last_edit_date": 1531164843, "question_id": 45060081, "link": "https://stackoverflow.com/questions/45060081/number-stored-as-text-to-number-with-vba", "title": "Number stored as text to number with VBA", "body": "<p>I have some columns that have cells that are \"Number stored as text\", which is causing problems with other code that is trying to copy one range to another\n<code>rng1.Copy Destination:=rng2</code></p>\n\n<p>The destination range (<code>rng2</code>) is blank. Not had this issue with any other data, just when these \"Number stored as text\" are there, so I need to, via VBA, be able to convert them to number.</p>\n\n<p>Looking around there seems to be two methods for this, but neither are working for me...</p>\n\n<p>TextToColumnns:</p>\n\n<pre><code>rng1.Select\nSelection.TextToColumns Destination:=Range(rng1), DataType:=xlDelimited\n</code></pre>\n\n<p>Value = value:</p>\n\n<pre><code>Range(rng1).Select\n    With Selection\n        .NumberFormat = \"General\"\n        .Value = .Value\n    End With\n</code></pre>\n\n<p>Other ways I have discovered are 100+ lines of code long which surely cannot be right??</p>\n\n<p>What is the best way to achieve this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1499869134, "post_id": 45060080, "comment_id": 77093855, "body": "Do you know if it freezes and crashes completely? It&#39;s possible (probable) that with such a large set, it does freeze but the code still is running.  Also, try adding <code>Application.ScreenUpdating = False</code> and <code>Application.Calculation = xlCalculationManual</code> to the top (then turn to <code>True</code> and <code>XlCalculationAutomatic</code> at the very end."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1499869669, "post_id": 45060080, "comment_id": 77094259, "body": "Immediately after the first for statement, add Application.Statusbar = i so you can see what it is doing. At the end add application.Statusbar = False to clear the statusbar."}, {"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "edited": false, "score": 0, "creation_date": 1499869823, "post_id": 45060080, "comment_id": 77094394, "body": "Thanks Batman, err...Bruce. I have ScreenUpdating set to False and I just added in the xlCalculation. I cannot use CTRL+ALT+PAUSE or CTRL+PAUSE to pause it or CTRL+ALT+BREAK or CTRL+BREAK to break it. I&#39;m not sure if that means it&#39;s completely not responding. I let it run for 5 hours yesterday, and it was still running. Not sure if that&#39;s demonstrative of it freezing/crashing, but I would think that it could crunch through the numbers in 5 hours..."}, {"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1499869981, "post_id": 45060080, "comment_id": 77094522, "body": "@jkpieterse, I added in the StatusBar and set it to i. It hits 10 and then stops."}, {"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1499871194, "post_id": 45060080, "comment_id": 77095475, "body": "@jkpieterse, I tried it again and it got to 11 and then stopped..."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1499871273, "post_id": 45060080, "comment_id": 77095547, "body": "<b>A)</b> Until you get it working, comment out <code>Application.ScreenUpdating = False</code> - that just makes it more difficult to figure out what&#39;s going on. It&#39;s fantastic to have <i>once your code works correctly</i>. <b>B)</b> Have you stepped through your code in the debugger to see what it&#39;s hanging on? Since it seems to hang on the 11th iteration, use F5 to quickly get through the first 10 loops, then F8 to go line by line until you see where it stops responding."}, {"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "edited": false, "score": 1, "creation_date": 1499871947, "post_id": 45060080, "comment_id": 77096063, "body": "Ok! It seems to be running! Thank you everyone. However... New issue: It&#39;s running at about one line per second. For 83110 lines, it will take roughly 23 hours to process. Any ideas on how to expedite this?"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1499872459, "post_id": 45060080, "comment_id": 77096490, "body": "It will be many times quicker if you <a href=\"https://stackoverflow.com/questions/29607270/assigning-range-to-array-in-vba\">read all the data into an array first</a>, and do array operations, then write back to the sheet."}, {"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1499873208, "post_id": 45060080, "comment_id": 77097090, "body": "@Wolfie I&#39;ll check it out. I haven&#39;t used Arrays yet, so this is new territory for me. I guess I have some reading ahead of me... Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "edited": false, "score": 0, "creation_date": 1499878756, "post_id": 45062276, "comment_id": 77100441, "body": "Way way waaaaaaaay faster. Arrays are clearly some magical, untiring steed of incredible haste, that whisked through my data at a speed that would make The Flash envious. I have a lot to learn, but thank you very much for pointing me in the right direction and helping me work through this!"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "edited": false, "score": 0, "creation_date": 1499888112, "post_id": 45062276, "comment_id": 77105598, "body": "It&#39;s because you&#39;re not reading and writing from/to the Excel document constantly :) consider marking this as accepted if it answers your issue :)"}, {"owner": {"reputation": 454, "user_id": 7437280, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154153054901080/picture?type=large", "display_name": "Daniel McCracken", "link": "https://stackoverflow.com/users/7437280/daniel-mccracken"}, "edited": false, "score": 0, "creation_date": 1499891986, "post_id": 45062276, "comment_id": 77107509, "body": "The inner &quot;IDSearch&quot; loop is totally pointless and makes the procedure exponentially slower. Replace that loop with &quot;IDSearch = i + 1&quot; (still putting it just above the If statement) and it does the exact same thing in &lt;1 second."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 454, "user_id": 7437280, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154153054901080/picture?type=large", "display_name": "Daniel McCracken", "link": "https://stackoverflow.com/users/7437280/daniel-mccracken"}, "edited": false, "score": 0, "creation_date": 1499894047, "post_id": 45062276, "comment_id": 77108483, "body": "Except, @DanielMcCracken, that it currently allows for conditional matches when <code>IDSearch</code> is not equal to <code>i + 1</code>, so you&#39;ve defined different logic there?"}, {"owner": {"reputation": 454, "user_id": 7437280, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154153054901080/picture?type=large", "display_name": "Daniel McCracken", "link": "https://stackoverflow.com/users/7437280/daniel-mccracken"}, "edited": false, "score": 0, "creation_date": 1499894369, "post_id": 45062276, "comment_id": 77108662, "body": "Oh I was assuming that the data was already sorted by LoanID and period, so that the &quot;match&quot; (if it existed) would always be in the next row. But I just realized that&#39;s not in the original post. My bad! Either way, that&#39;d be the way to do it: sort the source data first, then read it into the array, and you can avoid the inner loop. Sorting barely adds any time to the procedure compared to adding a few billion additional loops."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1499894453, "post_id": 45062276, "comment_id": 77108692, "body": "It may not be practical to re-sort the data I guess, or you could sort it <i>once it&#39;s in the array</i> if that was useful. Depends on the data really :)"}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": false, "score": 0, "last_activity_date": 1499894641, "last_edit_date": 1592644375, "creation_date": 1499874288, "answer_id": 45062276, "question_id": 45060080, "link": "https://stackoverflow.com/questions/45060080/excel-vba-macro-combing-through-80-000-rows-of-data-taking-23-hours-to-complete/45062276#45062276", "title": "Excel VBA Macro combing through 80,000+ rows of data taking 23 hours to complete", "body": "<h3>Edit:</h3>\n<p>I just noticed that you do in fact change the column index for the write operations. Still, take into account the below advice on using arrays and separate your logic back out and it should work!</p>\n<hr />\n<p>As suggested, you should look at reading to an array to speed up operations. To make that conversion a lot easier (and possibly speed up your code anyway), try using <code>And</code> and <code>Or</code> to combine the logical statements and reduce the number of <code>If</code>s. This version is <strong>nearly</strong> equivalent, and ideas could be used in your code:</p>\n<pre><code>For i = CurrentRow To 83111 Step 1\n    For IDSearch = i + 1 To 83111 Step 1\n        If RawData.Cells(IDSearch, 4).Value = RawData.Cells(i, 4).Value And RawData.Cells(IDSearch, 1).Value = RawData.Cells(i, 1).Value + 1 Then\n            If     (RawData.Cells(i, 5) = &quot;CURRENT&quot; And RawData.Cells(IDSearch, 5) = &quot;1-23&quot;) _\n                Or (RawData.Cells(i, 5) = &quot;1-23&quot; And RawData.Cells(IDSearch, 5) = &quot;24-59&quot;) _ \n                Or (RawData.Cells(i, 5) = &quot;24-59&quot; And RawData.Cells(IDSearch, 5) = &quot;60-90&quot;) _ \n                Or (RawData.Cells(i, 5) = &quot;60-90&quot; And RawData.Cells(IDSearch, 5) = &quot;90+&quot;) Then\n                    RawData.Cells(IDSearch, 7) = RawData.Cells(IDSearch, 6)\n            End If\n        End If\n    Next IDSearch\nNext I\n</code></pre>\n<p>Then working with arrays should look something like this:</p>\n<pre><code>Dim arr() As Variant\narr = RawData.Range(&quot;A&quot; &amp; CurrentRow &amp; &quot;:G&quot; &amp; 83111).Value\nFor i = LBound(arr,1) To UBound(arr,1)\n    For IDSearch = i + 1 To UBound(arr,1)\n        If arr(IDSearch, 4) = arr(i, 4) And arr(IDSearch, 1) = arr(i, 1) + 1 Then\n            If     (arr(i, 5) = &quot;CURRENT&quot; And arr(IDSearch, 5) = &quot;1-23&quot;) _\n                Or (arr(i, 5) = &quot;1-23&quot; And arr(IDSearch, 5) = &quot;24-59&quot;) _ \n                Or (arr(i, 5) = &quot;24-59&quot; And arr(IDSearch, 5) = &quot;60-90&quot;) _ \n                Or (arr(i, 5) = &quot;60-90&quot; And arr(IDSearch, 5) = &quot;90+&quot;) Then\n                    arr(IDSearch, 7) = arr(IDSearch, 6)\n            End If\n        End If\n    Next IDSearch\nNext i\nRawData.Range(&quot;A&quot; &amp; CurrentRow &amp; &quot;:G&quot; &amp; 83111).Value = arr\n</code></pre>\n<p>There is no need for <code>ScreenUpdating</code> fiddles as the screen only updates right at the end anyway, with the single read and single write operations being the thing which makes this method quick.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "edited": false, "score": 0, "creation_date": 1500928192, "post_id": 45068286, "comment_id": 77541368, "body": "Thanks a lot Daniel. I&#39;m excited to give it a try and compare it. I agree that Tables are the way to go, so I should start incorporating them in my Macro files as well. Thanks again!"}], "tags": [], "owner": {"reputation": 454, "user_id": 7437280, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154153054901080/picture?type=large", "display_name": "Daniel McCracken", "link": "https://stackoverflow.com/users/7437280/daniel-mccracken"}, "is_accepted": false, "score": 0, "last_activity_date": 1499897289, "creation_date": 1499897289, "answer_id": 45068286, "question_id": 45060080, "link": "https://stackoverflow.com/questions/45060080/excel-vba-macro-combing-through-80-000-rows-of-data-taking-23-hours-to-complete/45068286#45068286", "title": "Excel VBA Macro combing through 80,000+ rows of data taking 23 hours to complete", "body": "<p>There are a couple of different ways to approach this. One is similar to Wolfie's (reads data into an array + loops through), another one uses regular worksheet formulas.</p>\n\n<p>First, you'll want to turn your data into a Table (go to Insert -> Table) and give it/your columns descriptive names (you can name a table after creating it by clicking the \"Design\" tab and looking at the top left, there's a little place to enter a name). That by itself will make your code (and any formulas on the source data sheet) a lot more readable + easier to maintain. With a table, you won't have to worry about modifying your macro if you add/delete/move columns in your source data.</p>\n\n<p>(It looks like your data is already basically in a tabular format, so creating a table shouldn't present an issue. But if it does, just copy the source data onto another sheet and make the table there.)</p>\n\n<p>Then you're going to want to sort your table by Loan ID and period. Working with sorted data is often <em>significantly</em> faster than working with unsorted data,\n definitely in this case and also in <a href=\"http://www.exceluser.com/blog/727/excels-fastest-lookup-methods-the-tested-results.html\" rel=\"nofollow noreferrer\">many other cases</a>. Here's what your table should look like at this point:</p>\n\n<p><img src=\"https://i.imgur.com/Kj3ZYt2.png\" alt=\"img\"></p>\n\n<p>Then you've got a couple of alternatives. One starts the same as Wolfie's by reading the data into an array, but because the data is sorted, any \"match\" you find will always be 1 row away, and you avoid looping through the data multiple times. In my testing, this version averaged ~1.5 seconds with a 100k row table.</p>\n\n<p>The other works similarly, but uses worksheet formulas. It's a bit slower (averaged ~5 seconds with a 100k row table) but I find it a bit easier to work with if you ever need to make modifications. </p>\n\n<p>Either way, here's what it'll look like afterwards:</p>\n\n<p><img src=\"https://i.imgur.com/pYMwMel.png\" alt=\"img\"></p>\n\n<pre><code>Sub calculateLoanStatus()\n\n    Application.ScreenUpdating = False\n\n    Dim startTimeSetup As Double, endTimeSetup As Double\n    Dim startTimeArr As Double, endTimeArr As Double\n    Dim startTimeForm As Double, endTimeForm As Double\n\n    'Sort data in table by loan ID and period\n    startTimeSetup = Timer\n    Dim loanTbl As ListObject\n    Set loanTbl = ThisWorkbook.Sheets(\"Raw Data\").ListObjects(\"LoanTable\")\n    Call sortColumn(loanTbl, \"Period\", xlAscending)\n    Call sortColumn(loanTbl, \"Loan ID\", xlAscending)\n    endTimeSetup = Timer - startTimeSetup\n\n    'Option 1: Use helper method to copy data into array + paste it back to the table\n    'Faster, but slightly more difficult to maintain\n    startTimeArr = Timer\n    Call versionOne(loanTbl)\n    endTimeArr = Timer - startTimeArr + endTimeSetup\n\n    'Option 2: Use helper method to create formulas + copy the results to each column\n    'Slower, but slightly easier to maintain\n    startTimeForm = Timer\n    Call versionTwo(loanTbl, \"Current to 1-23\", \"Current\", \"1 to 23\")\n    Call versionTwo(loanTbl, \"1-23 to 24-59\", \"1 to 23\", \"24 to 59\")\n    Call versionTwo(loanTbl, \"24-59 to 60-90\", \"24 to 59\", \"60 to 90\")\n    Call versionTwo(loanTbl, \"60-90 to 90+\", \"60 to 90\", \"90+\")\n    With loanTbl.DataBodyRange\n        .Copy\n        .PasteSpecial xlPasteValues\n        Application.CutCopyMode = False\n    End With\n    endTimeForm = Timer - startTimeForm + endTimeSetup\n\n    'End\n    Application.ScreenUpdating = True\n    MsgBox \"Array version: \" &amp; endTimeArr &amp; vbNewLine &amp; \"Formula version: \" &amp; endTimeForm\n\nEnd Sub\nSub versionOne(tbl As ListObject)\n'Read data from a sorted table (tbl) into an array and calculate values\n\n    Dim arr() As Variant\n    Dim i As Long\n    Dim nextRow As Long\n    Dim startCol As Long\n    Dim periodCol As Long, loanIDCol As Long, statusCol As Long, amountCol As Long\n    Dim resultCol1 As Long, resultCol2 As Long, resultCol3 As Long, resultCol4 As Long\n\n    startCol = tbl.ListColumns(1).Range.Column\n    periodCol = startCol + tbl.ListColumns(\"Period\").Range.Column - 1\n    loanIDCol = startCol + tbl.ListColumns(\"Loan ID\").Range.Column - 1\n    statusCol = startCol + tbl.ListColumns(\"Status\").Range.Column - 1\n    amountCol = startCol + tbl.ListColumns(\"Amount Owed\").Range.Column - 1\n    resultCol1 = startCol + tbl.ListColumns(\"Current to 1-23\").Range.Column - 1\n    resultCol2 = startCol + tbl.ListColumns(\"1-23 To 24-59\").Range.Column - 1\n    resultCol3 = startCol + tbl.ListColumns(\"24-59 To 60-90\").Range.Column - 1\n    resultCol4 = startCol + tbl.ListColumns(\"60-90 To 90+\").Range.Column - 1\n\n    arr = tbl.DataBodyRange.Value\n\n    For i = LBound(arr, 1) To UBound(arr, 1) - 1\n        nextRow = i + 1\n        arr(nextRow, resultCol1) = \"\"\n        arr(nextRow, resultCol2) = \"\"\n        arr(nextRow, resultCol3) = \"\"\n        arr(nextRow, resultCol4) = \"\"\n        If arr(nextRow, loanIDCol) = arr(i, loanIDCol) And arr(nextRow, periodCol) = arr(i, periodCol) + 1 Then\n            If (arr(i, statusCol) = \"Current\" And arr(nextRow, statusCol) = \"1 to 23\") Then\n                arr(nextRow, resultCol1) = arr(nextRow, amountCol)\n            ElseIf (arr(i, statusCol) = \"1 to 23\" And arr(nextRow, statusCol) = \"24 to 59\") Then\n                arr(nextRow, resultCol2) = arr(nextRow, amountCol)\n            ElseIf (arr(i, statusCol) = \"24 to 59\" And arr(nextRow, statusCol) = \"60 to 90\") Then\n                arr(nextRow, resultCol3) = arr(nextRow, amountCol)\n            ElseIf (arr(i, statusCol) = \"60 to 90\" And arr(nextRow, statusCol) = \"90+\") Then\n                arr(nextRow, resultCol4) = arr(nextRow, amountCol)\n            End If\n        End If\n    Next i\n\n    tbl.DataBodyRange.Value = arr\n\nEnd Sub\nSub versionTwo(tbl As ListObject, shiftCol As String, oldStatus As String, newStatus As String)\n'Add formula to a column (shiftCol) in a table (tbl)\n'Use loan account's status in the prior (oldStatus) and current (newStatus) months to whether to add value\n'If desired, copy the results of the formula in place (copyText)\n\n    Dim refCol As Long\n    Dim periodDist As Long\n    Dim loanIDDist As Long\n    Dim statusDist As Long\n    Dim formulaText As String\n\n    'Determine the distance between your reference column and each value column\n    refCol = tbl.ListColumns(shiftCol).Range.Column\n    periodDist = tbl.ListColumns(\"Period\").Range.Column - refCol\n    loanIDDist = tbl.ListColumns(\"Loan ID\").Range.Column - refCol\n    statusDist = tbl.ListColumns(\"Status\").Range.Column - refCol\n\n    'Make formula and add it to the column\n    formulaText = \"=IF(AND(R[-1]C[\" &amp; periodDist &amp; \"]=[@Period]-1,R[-1]C[\" &amp; loanIDDist &amp; \"]=[@[Loan ID]],\" &amp; _\n                  \"R[-1]C[\" &amp; statusDist &amp; \"]=\"\"\" &amp; oldStatus &amp; \"\"\",[@Status]=\"\"\" &amp; newStatus &amp; \"\"\"),[@[Amount Owed]],\"\"\"\")\"\n\n    tbl.ListColumns(shiftCol).DataBodyRange.FormulaR1C1 = formulaText\n\nEnd Sub\nSub sortColumn(tbl As ListObject, toSort As String, sOrder As Variant)\n'Sorts column (toSort) in a table (tbl) in a given order (sOrder)\n\n    With tbl.Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=tbl.ListColumns(toSort).Range, _\n                SortOn:=xlSortOnValues, _\n                Order:=sOrder, _\n                DataOption:=xlSortNormal\n        .Apply\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8296212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Uj4v.jpg?s=128&g=1", "display_name": "Joehnny_Tarr", "link": "https://stackoverflow.com/users/8296212/joehnny-tarr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 464, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499897289, "creation_date": 1499868648, "last_edit_date": 1499872453, "question_id": 45060080, "link": "https://stackoverflow.com/questions/45060080/excel-vba-macro-combing-through-80-000-rows-of-data-taking-23-hours-to-complete", "title": "Excel VBA Macro combing through 80,000+ rows of data taking 23 hours to complete", "body": "<p>I'm new here and just got into Excel VBA coding. </p>\n\n<p>I'm having an issue with a snippet of code I ran. I have multiple columns to show the status of a loan payment. </p>\n\n<ul>\n<li>Column 1 shows the numerical value of the year (i.e. Jan = 1, Feb = 2, etc.).</li>\n<li>Column 4 shows the ID number of the contract. </li>\n<li>Column 5 shows the status of the loan payment (CURRENT = currently paid, 1-23 = 1 to 23 days delinquent, 24-59 = 24 to 59 days delinquent, etc.).</li>\n<li>Column 6 shows the amount of $$$'s owed.</li>\n</ul>\n\n<p>My goal: </p>\n\n<ol>\n<li>Have the code use the ID and search for ID numbers in the list below it. </li>\n<li>Then, if there is a match in ID, it checks if the months are sequential (i.e. if the month of the ID in the current row matches the ID in the loop row and if the month is one above the current row, so if it finds a match for the ID in January, it will look for the same ID in February). </li>\n<li>Then, it will check Column 5 to see if the account transitioned into delinquency from the previous month (i.e. if the Delinquency was CURRENT in January and then went into the 1-23 days delinquent bucket in February).</li>\n<li>Finally, if all of these are true (the ID's match up, the month is sequential, and the delinquency shifted) it will drop the amount owed into a Column related to the delinquency shift (Columns 7-9).</li>\n</ol>\n\n<p>My issue: I am running this with a statusbar update to check if it's running. It's going at about 1 iteration of i per second. At 83,110 rows of data, I calculate this to take about 23 hours. HOLY SMOKES! Is there any way to expedite this?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Sub DecipherDPD()\n\nDim i As Long, CurrentRow As Long, IDSearch As Long\nDim RawData As Worksheet\nDim CollectionsWB As Workbook\n\nSet CollectionsWB = ThisWorkbook\n\nSet RawData = CollectionsWB.Worksheets(\"RAW DATA\")\n\nCurrentRow = 2\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nFor i = CurrentRow To 83111 Step 1\n    For IDSearch = i + 1 To 83111 Step 1\n        If RawData.Cells(IDSearch, 4) = RawData.Cells(i, 4) Then\n            If RawData.Cells(IDSearch, 1).Value = RawData.Cells(i, 1).Value + 1 Then\n                If RawData.Cells(i, 5) = \"CURRENT\" Then\n                    If RawData.Cells(IDSearch, 5) = \"1-23\" Then\n                        RawData.Cells(IDSearch, 7) = RawData.Cells(IDSearch, 6)\n                    End If\n                End If\n            End If\n            If RawData.Cells(IDSearch, 1).Value = RawData.Cells(i, 1).Value + 1 Then\n                If RawData.Cells(i, 5) = \"1-23\" Then\n                    If RawData.Cells(IDSearch, 5) = \"24-59\" Then\n                        RawData.Cells(IDSearch, 8) = RawData.Cells(IDSearch, 6)\n                    End If\n                End If\n            End If\n            If RawData.Cells(IDSearch, 1).Value = RawData.Cells(i, 1).Value + 1 Then\n                If RawData.Cells(i, 5) = \"24-59\" Then\n                    If RawData.Cells(IDSearch, 5) = \"60-90\" Then\n                        RawData.Cells(IDSearch, 9) = RawData.Cells(IDSearch, 6)\n                    End If\n                End If\n            End If\n            If RawData.Cells(IDSearch, 1).Value = RawData.Cells(i, 1).Value + 1 Then\n                If RawData.Cells(i, 5) = \"60-90\" Then\n                    If RawData.Cells(IDSearch, 5) = \"90+\" Then\n                        RawData.Cells(IDSearch, 9) = RawData.Cells(IDSearch, 6)\n                    End If\n                End If\n            End If\n        End If\n    Next IDSearch\nNext i\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated! Thank you!\n-Joe</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1499869308, "post_id": 45060041, "comment_id": 77093988, "body": "I&#39;m guessing that the unwanted commas are on the right of each line. These represent empty columns that Excel <i>thinks</i> are being used and must be included in the export. Isolate the area that you want to export or write a loop that generates the CSV independently."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8265972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1dd791addfe57bd2714cbd940f4d07?s=128&d=identicon&r=PG&f=1", "display_name": "Sean McAuley", "link": "https://stackoverflow.com/users/8265972/sean-mcauley"}, "edited": false, "score": 0, "creation_date": 1499869110, "post_id": 45060162, "comment_id": 77093830, "body": "This removed all commas rather than only the unneeded ones"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 1, "user_id": 8265972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1dd791addfe57bd2714cbd940f4d07?s=128&d=identicon&r=PG&f=1", "display_name": "Sean McAuley", "link": "https://stackoverflow.com/users/8265972/sean-mcauley"}, "edited": false, "score": 0, "creation_date": 1499870684, "post_id": 45060162, "comment_id": 77095065, "body": "The reason you are getting those extra commas is most likely because there are cells at the end of your data that have spaces in them. Before saving the file you will want to process the data and strip out the cells that have the spaces in them."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 1, "user_id": 8265972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1dd791addfe57bd2714cbd940f4d07?s=128&d=identicon&r=PG&f=1", "display_name": "Sean McAuley", "link": "https://stackoverflow.com/users/8265972/sean-mcauley"}, "edited": false, "score": 0, "creation_date": 1499871233, "post_id": 45060162, "comment_id": 77095513, "body": "You may also want to look into how to save just a certain range of cells to the CSV file, but either way, you are going to have to have some code that can detect where the end of the data is."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499890897, "post_id": 45060162, "comment_id": 77106969, "body": "The extra commas aren&#39;t caused by cells with spaces in them.  Excel tries to guess how many columns are being written out, and then inserts the necessary commas to pad the output to that number of columns.  So the fact that there is something in cell <code>D2</code> makes Excel decide to also write out cell <code>D1</code> even though it is empty."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1499868863, "creation_date": 1499868863, "answer_id": 45060162, "question_id": 45060041, "link": "https://stackoverflow.com/questions/45060041/excel-vba-macro-removing-unwanted-commas-from-txt-file/45060162#45060162", "title": "Excel VBA/Macro removing unwanted commas from .txt file", "body": "<p>Try saving it in text format instead?</p>\n\n<p><code>FileFormat:=xlText</code></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8265972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1dd791addfe57bd2714cbd940f4d07?s=128&d=identicon&r=PG&f=1", "display_name": "Sean McAuley", "link": "https://stackoverflow.com/users/8265972/sean-mcauley"}, "edited": false, "score": 0, "creation_date": 1499954636, "post_id": 45067177, "comment_id": 77138500, "body": "I tested both these and neither method works, first piece of code just gives same output &amp; second piece removes every comma."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1499892181, "creation_date": 1499892181, "answer_id": 45067177, "question_id": 45060041, "link": "https://stackoverflow.com/questions/45060041/excel-vba-macro-removing-unwanted-commas-from-txt-file/45067177#45067177", "title": "Excel VBA/Macro removing unwanted commas from .txt file", "body": "<p>You can copy just the used range (not tested):</p>\n\n<pre><code>ThisWorkbook.Worksheets(wsName).UsedRange.CurrentRegion.Copy\nWith Workbooks.Add\n    .Sheets(1).Paste\n    .SaveAs csvFiles(i), FileFormat:=xlCSV\n    .Close False\nEnd With\n</code></pre>\n\n<p>or paste the values without formatting (also not tested):</p>\n\n<pre><code>ThisWorkbook.Worksheets(wsName).UsedRange.Copy\nWith Workbooks.Add\n    ActiveCell.PasteSpecial xlPasteValues\n    .SaveAs csvFiles(i), FileFormat:=xlCSV\n    .Close False\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8265972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d1dd791addfe57bd2714cbd940f4d07?s=128&d=identicon&r=PG&f=1", "display_name": "Sean McAuley", "link": "https://stackoverflow.com/users/8265972/sean-mcauley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 835, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499892181, "creation_date": 1499868531, "last_edit_date": 1499890431, "question_id": 45060041, "link": "https://stackoverflow.com/questions/45060041/excel-vba-macro-removing-unwanted-commas-from-txt-file", "title": "Excel VBA/Macro removing unwanted commas from .txt file", "body": "<p>I've written a macro/piece of code in excel vba to send the current worksheet to a specific email in .txt format but when I receive the email there are several unneeded commas listed in the file I'm just trying to possibly find a piece of code that will remove these extra commas when the file is sent over in the email. I currently have another macro created which opens and reads the file and removes the unwanted commas but i am having to save the email attachment first whereas I'd like to just receive the clean .txt file directly to my email.</p>\n\n<p>The current .txt file I am receiving looks like;</p>\n\n<pre><code>S99,2602,7/12/2017,\n10405,PUSH NUT PLAIN 1/4,2.000,EACH\nWVC424,CORD 2.2MM E/S CHESTNUT,3.800,MTR\n,,,\n</code></pre>\n\n<p>whereas I need it to look like;</p>\n\n<pre><code>S99,2602,7/12/2017\n10405,PUSH NUT PLAIN 1/4,2.000,EACH\nWVC424,CORD 2.2MM E/S CHESTNUT,3.800,MTR\n</code></pre>\n\n<p>For It to be read into our system.</p>\n\n<pre><code>Sub EmailAsCSV()\n'\n' EmailAsCSV Macro\n'\n Dim csvFiles(1 To 3) As String, i As Integer\n    Dim wsName As Variant\n    Dim OutApp As Object, OutMail As Object\n\n\n\n\n    i = 0\n    For Each wsName In Array(\"Sheet1\")     'sheet names to be emailed - CHANGE THE SHEET NAMES\n        i = i + 1\n        csvFiles(i) = ThisWorkbook.Path &amp; \"\\\" &amp; wsName &amp; \".txt\"\n        ThisWorkbook.Worksheets(wsName).Copy\n        ActiveWorkbook.SaveAs csvFiles(i), FileFormat:=xlCSV\n        ActiveWorkbook.Close False\n    Next\n\n\n    'Email the .csv files\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    With OutMail\n        .To = ThisWorkbook.Worksheets(\"Sheet2\").Range(\"E1\").Value     'cell containing email address - CHANGE THE SHEET NAME AND CELL\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Order\"\n        .Body = \"This email contains 1 file attachment with an order.\"\n        .Attachments.Add csvFiles(1)\n\n        .Send\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\n    'Delete the .csv files\n\n    Kill csvFiles(1)\n\n'\nEnd Sub\n\nSub test()\n    Dim fn As String, txt As String\n    fn = Application.GetOpenFilename(\"TextFiles,*.txt\")\n    If fn = \"\" Then Exit Sub\n    txt = CreateObject(\"Scripting.FileSystemObject\").OpenTextFile(fn).ReadAll\n    With CreateObject(\"VBScript.RegExp\")\n        .Global = True: .MultiLine = True\n        .Pattern = \",+$\"\n        Open Replace(fn, \".txt\", \"_Clean.txt\") For Output As #1\n            Print #1, .Replace(txt, \"\")\n        Close #1\n    End With\nEnd Sub\n</code></pre>\n\n<p>The code I have currently got is listed above.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1499868073, "post_id": 45059828, "comment_id": 77093019, "body": "What is the code within the Workbook_Open sub procedure?"}, {"owner": {"reputation": 1, "user_id": 5149655, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cEx2Lalrl0/AAAAAAAAAAI/AAAAAAAAEgI/LULL54IljAI/photo.jpg?sz=128", "display_name": "matt", "link": "https://stackoverflow.com/users/5149655/matt"}, "edited": false, "score": 0, "creation_date": 1499868766, "post_id": 45059828, "comment_id": 77093554, "body": "There is no code in it."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1499881196, "post_id": 45059828, "comment_id": 77101778, "body": "@matt - you realize that sharing an Excel file with an active connection in it is not a good idea?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5149655, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cEx2Lalrl0/AAAAAAAAAAI/AAAAAAAAEgI/LULL54IljAI/photo.jpg?sz=128", "display_name": "matt", "link": "https://stackoverflow.com/users/5149655/matt"}, "edited": false, "score": 0, "creation_date": 1499868875, "post_id": 45060021, "comment_id": 77093624, "body": "That didn&#39;t do anything."}, {"owner": {"reputation": 31, "user_id": 7487154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d1b067104de8cd06a7b7fc97acb9d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Apra", "link": "https://stackoverflow.com/users/7487154/mario-apra"}, "reply_to_user": {"reputation": 1, "user_id": 5149655, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cEx2Lalrl0/AAAAAAAAAAI/AAAAAAAAEgI/LULL54IljAI/photo.jpg?sz=128", "display_name": "matt", "link": "https://stackoverflow.com/users/5149655/matt"}, "edited": false, "score": 0, "creation_date": 1499870075, "post_id": 45060021, "comment_id": 77094605, "body": "@matt What excel version is this? Did you installed this recently?"}, {"owner": {"reputation": 1, "user_id": 5149655, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cEx2Lalrl0/AAAAAAAAAAI/AAAAAAAAEgI/LULL54IljAI/photo.jpg?sz=128", "display_name": "matt", "link": "https://stackoverflow.com/users/5149655/matt"}, "edited": false, "score": 0, "creation_date": 1499871534, "post_id": 45060021, "comment_id": 77095756, "body": "2016. I just got the computer about 2 months ago, but it was used, so I am not sure when it was installed."}], "tags": [], "owner": {"reputation": 31, "user_id": 7487154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d1b067104de8cd06a7b7fc97acb9d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Apra", "link": "https://stackoverflow.com/users/7487154/mario-apra"}, "is_accepted": false, "score": 1, "last_activity_date": 1499868470, "creation_date": 1499868470, "answer_id": 45060021, "question_id": 45059828, "link": "https://stackoverflow.com/questions/45059828/cant-scroll-when-opening-excel/45060021#45060021", "title": "Can&#39;t scroll when opening excel", "body": "<p>You can 'force' the scroll area to be all the sheet.</p>\n\n<pre><code>Sub fix_scroll_area()\n    ThisWorkbook.ActiveSheet.ScrollArea = \"\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5149655, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cEx2Lalrl0/AAAAAAAAAAI/AAAAAAAAEgI/LULL54IljAI/photo.jpg?sz=128", "display_name": "matt", "link": "https://stackoverflow.com/users/5149655/matt"}, "edited": false, "score": 0, "creation_date": 1499869351, "post_id": 45060096, "comment_id": 77094024, "body": "The scroll bar is there and I can click on it to scroll, but the scroll wheel won&#39;t work. The wheel works in other applications and other Excel documents, just not this one."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 5149655, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cEx2Lalrl0/AAAAAAAAAAI/AAAAAAAAEgI/LULL54IljAI/photo.jpg?sz=128", "display_name": "matt", "link": "https://stackoverflow.com/users/5149655/matt"}, "edited": false, "score": 0, "creation_date": 1499869513, "post_id": 45060096, "comment_id": 77094153, "body": "@matt - are you sure that there is no VBA in your worksheet? Like even in the <code>Sheet</code> and the <code>ThisWorkbook</code>? It sounds like you have something."}, {"owner": {"reputation": 1, "user_id": 5149655, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cEx2Lalrl0/AAAAAAAAAAI/AAAAAAAAEgI/LULL54IljAI/photo.jpg?sz=128", "display_name": "matt", "link": "https://stackoverflow.com/users/5149655/matt"}, "edited": false, "score": 0, "creation_date": 1499869640, "post_id": 45060096, "comment_id": 77094243, "body": "I went and saved it as a xlsx workbook, and the same problem is in the xlsx workbook. Absolutely no code."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 5149655, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cEx2Lalrl0/AAAAAAAAAAI/AAAAAAAAEgI/LULL54IljAI/photo.jpg?sz=128", "display_name": "matt", "link": "https://stackoverflow.com/users/5149655/matt"}, "edited": false, "score": 0, "creation_date": 1499869742, "post_id": 45060096, "comment_id": 77094326, "body": "@matt - checked this -&gt; <a href=\"https://excelribbon.tips.net/T011838_Scroll_Wheel_Doesnt_Work_when_Editing.html\" rel=\"nofollow noreferrer\">excelribbon.tips.net/&hellip;</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1499869121, "last_edit_date": 1499869121, "creation_date": 1499868679, "answer_id": 45060096, "question_id": 45059828, "link": "https://stackoverflow.com/questions/45059828/cant-scroll-when-opening-excel/45060096#45060096", "title": "Can&#39;t scroll when opening excel", "body": "<p>In general, the scroll area could be set to something without using macros.\nThe simplest solution is to go to the properties of the VB Editor and to delete whatever stays at the ScrollArea place (see the white arrow):</p>\n\n<p><a href=\"https://i.stack.imgur.com/rr6Ej.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rr6Ej.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If it is not this, then feel free to run this:</p>\n\n<pre><code>Sub TestMe\n    With ActiveWindow \n        .DisplayHorizontalScrollBar = True \n        .DisplayVerticalScrollBar = True \n    End With \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11307586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed431d4a5fa94f8d30034a57b8f9e2a?s=128&d=identicon&r=PG", "display_name": "farzad", "link": "https://stackoverflow.com/users/11307586/farzad"}, "is_accepted": false, "score": 0, "last_activity_date": 1554317539, "creation_date": 1554317539, "answer_id": 55502360, "question_id": 45059828, "link": "https://stackoverflow.com/questions/45059828/cant-scroll-when-opening-excel/55502360#55502360", "title": "Can&#39;t scroll when opening excel", "body": "<p>I had the same problem, I just maximized the window that contains the code and this fixed the problem</p>\n"}], "owner": {"reputation": 1, "user_id": 5149655, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2cEx2Lalrl0/AAAAAAAAAAI/AAAAAAAAEgI/LULL54IljAI/photo.jpg?sz=128", "display_name": "matt", "link": "https://stackoverflow.com/users/5149655/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1554317539, "creation_date": 1499867989, "last_edit_date": 1499881236, "question_id": 45059828, "link": "https://stackoverflow.com/questions/45059828/cant-scroll-when-opening-excel", "title": "Can&#39;t scroll when opening excel", "body": "<p>I have a blank document with some macros that is used to create other documents. However, when I open the blank one, I cannot scroll up or down the screen unless I click out of Excel and click back in, or double click into a cell and then exit it. </p>\n\n<p>I have tried application.enableevents=True, application.screenupdating=True, application.enableanimations=True, but none of them seem to work. Any ideas on how to fix it?</p>\n\n<p>When I saved the document as a standard .xlsx, the issue still was there. Couldn't scroll unless i selected a different window and came back to Excel, or double clicked into a cell. </p>\n\n<p>The scroll bars are still there and they work, but not the scroll wheel. The wheel works in other Excel documents, just not this one. </p>\n\n<p>Here is the document to see if you can figure it out (It is not a good idea to share files with active connections in them). Try to make a video of the problem or to describe it better.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1499870317, "post_id": 45060641, "comment_id": 77094774, "body": "Wah. So extraneous parens aren&#39;t just superfluous, they&#39;re <i>actively harmful</i>! #TIL"}, {"owner": {"reputation": 137, "user_id": 5490262, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/a8103968738f874f15ea8a4364ea7125?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cal", "link": "https://stackoverflow.com/users/5490262/j-cal"}, "edited": false, "score": 0, "creation_date": 1499870794, "post_id": 45060641, "comment_id": 77095156, "body": "Thank you for the reply, Erik! I removed the quotes and it works perfectly, thank you! I&#39;m not sure what OLE automation is, how would you recommend I call a MsgBox instead?  Also, I have <code>xlApp.Visible = True</code> right after I copy in the data from Access and run the Excel sub. This has been working to bring up the actual spreadsheet. I put <code>xlApp.UserControl = True</code> both before and after the <code>xlApp.Run &quot;autoGraph&quot;</code>, but the issue still persists and does not seem to affect anything."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 137, "user_id": 5490262, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/a8103968738f874f15ea8a4364ea7125?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cal", "link": "https://stackoverflow.com/users/5490262/j-cal"}, "edited": false, "score": 0, "creation_date": 1499871027, "post_id": 45060641, "comment_id": 77095339, "body": "@J.Cal parentheses, not quotes. the quotes are <i>required</i>."}, {"owner": {"reputation": 137, "user_id": 5490262, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/a8103968738f874f15ea8a4364ea7125?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cal", "link": "https://stackoverflow.com/users/5490262/j-cal"}, "edited": false, "score": 0, "creation_date": 1499871474, "post_id": 45060641, "comment_id": 77095713, "body": "Sorry, that&#39;s what I meant! typo"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1499871476, "post_id": 45060641, "comment_id": 77095714, "body": "If it works I think he got it right. I will remove the MsgBox part from my answer, I got that to work with another Access application once, but as said, bad plan. The harmful parentheses are because Application.Run actually adds its own parentheses, e.g. <code>Application.Run(&quot;MyFunction&quot;, &quot;Arg1&quot;)</code> will run <code>MyFunction(&quot;Arg1&quot;)</code> and return its return value. Thus <code>Application.Run &quot;autoGraph()&quot;</code> should actually run <code>autoGraph()()</code> and apparently Excel thinks that&#39;s fine and just a double invocation operator or something"}, {"owner": {"reputation": 137, "user_id": 5490262, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/a8103968738f874f15ea8a4364ea7125?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cal", "link": "https://stackoverflow.com/users/5490262/j-cal"}, "edited": false, "score": 0, "creation_date": 1499872238, "post_id": 45060641, "comment_id": 77096301, "body": "Thank you for the explanation, that&#39;s good to know for the future! In regards to the message box, I realized a stupid error I made, I just moved <code>xlApp.Visible = True</code> up a few lines to before the <code>xlApp.Run &quot;autoGraph&quot;</code> line which solved it"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1499871545, "last_edit_date": 1499871545, "creation_date": 1499870021, "answer_id": 45060641, "question_id": 45059782, "link": "https://stackoverflow.com/questions/45059782/ms-access-excel-msgbox-appearing-twice/45060641#45060641", "title": "MS Access -&gt; Excel MsgBox appearing twice", "body": "<p>You shouldn't add parentheses here: </p>\n\n<p><code>xlApp.Run \"autoGraph()\"</code></p>\n\n<p>In Access it just generates a runtime error when you add parentheses with <code>Application.Run</code>, in Excel it apparently runs it twice. </p>\n\n<p>Remove them, and it will be fixed.</p>\n"}], "owner": {"reputation": 137, "user_id": 5490262, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/a8103968738f874f15ea8a4364ea7125?s=128&d=identicon&r=PG&f=1", "display_name": "J. Cal", "link": "https://stackoverflow.com/users/5490262/j-cal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 45060641, "answer_count": 1, "score": 1, "last_activity_date": 1594650997, "creation_date": 1499867884, "last_edit_date": 1594650997, "question_id": 45059782, "link": "https://stackoverflow.com/questions/45059782/ms-access-excel-msgbox-appearing-twice", "title": "MS Access -&gt; Excel MsgBox appearing twice", "body": "<p>I am writing an module in Access 2016 that opens an Excel spreadsheet, copies data into an Excel table, then runs a sub stored in the Excel file that displays a message box, then generates a graph (or at least, it should!).</p>\n\n<p>This is the Access code:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nSub QueryExportMod()\n\n'variable initilizations and definitions ---------------------------------------------------------------------------------------\n\n\n\nDim db As DAO.Database\nSet db = CurrentDb\n\nDim totalFindingsQuery As String\nDim breakdownFindingsQuery As String\ntotalFindingsQuery = 'SQL text\nbreakdownFindingsQuery = 'SQL text\n\nDim tempQ1 As DAO.QueryDef\nDim tempQ2 As DAO.QueryDef\nSet tempQ1 = db.CreateQueryDef(\"tempQ1\", totalFindingsQuery)\nSet tempQ2 = db.CreateQueryDef(\"tempQ2\", breakdownFindingsQuery)\n\nDim rs1 As Recordset\nDim rs2 As Recordset\nSet rs1 = db.OpenRecordset(\"tempQ1\")\nSet rs2 = db.OpenRecordset(\"tempQ2\")\n\nDim xlApp As Excel.Application\nDim wb As Excel.Workbook\nDim ws As Excel.Worksheet\nSet xlApp = New Excel.Application\nSet wb = xlApp.Workbooks.Open(CurrentProject.Path &amp; \"\\ExportExcelTest.xlsm\")\nSet ws = wb.Worksheets(\"Sheet1\")\n\nDim table As ListObject\nSet table = ws.ListObjects(\"Table1\")\n\n\n\n'Modifying files and data ------------------------------------------------------------------------------------------------------\n\n\nws.ListObjects(\"Table1\").DataBodyRange.Rows.Delete\n\nws.Range(\"A2\") = \"Total Findings\"\nws.Range(\"B2\").CopyFromRecordset rs1\nws.Range(\"A3\").CopyFromRecordset rs2\n\n'Call autoGraph, the Excel sub\nxlApp.Run \"autoGraph()\"\n\nxlApp.Visible = True\n\nSet xlApp = Nothing\nSet wb = Nothing\nSet ws = Nothing\n\nDoCmd.DeleteObject acQuery, \"tempQ1\"\nDoCmd.DeleteObject acQuery, \"tempQ2\"\n\nEnd Sub\n\n'to be able to run the sub from a macro\nFunction KGQueryExportCall()\nCall QueryExportMod\nEnd Function\n</code></pre>\n\n<p>And here is the Excel sub:</p>\n\n<pre><code>Sub autoGraph()\n\n'AppActivate Application.Caption\nMsgBox \" &lt;message&gt; \"\n\nDim tb1Range As Range\nSet tb1Range = ActiveSheet.Range(\"Table1\")\n\nRange(\"Table1\").Select\nActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\nActiveChart.SetSourceData Source:=Range(\"Table1\")\n\n\nEnd Sub\n</code></pre>\n\n<p>When I run the Access sub <code>QueryExportMod</code>, the message box is generated (another problem I have is that it is always behind other windows. Does anyone know how to force it to the current window, the one on top? I tried <code>AppActivate Application.Caption</code> but it broke my code), and when I press \"OK\" on the message box, the same exact message box will reappear. Once I press \"OK\" on this duplicate, then the Excel spreadsheet will open and everything else works fine. How can I get rid of this duplicate?</p>\n\n<p>Thanks for your help</p>\n\n<p><strong>EDIT:</strong> I put added two DeBug lines in the Excel sub, like so:</p>\n\n<pre><code>DeBug.Print(\"1\")\nMsgBox \" &lt;message&gt; \"\nDeBug.Print(\"2\")\n</code></pre>\n\n<p>and ended up getting</p>\n\n<p><code>1\n2\n1\n2</code> in the immediate window <strong>when I ran the Access module</strong>, so I know now that the Excel sub is being run twice, but I still cannot figure out what is causing it to do that. When I run the Excel module right from inside Excel, <strong>I only get</strong> </p>\n\n<p><code>1\n2</code></p>\n\n<p>I believe it may have to do with the actual application opening twice? when I run without the message box lines, I see a stutter, like a window opens then closes almost immediately, then reopens again</p>\n"}, {"tags": ["excel", "vba", "email", "smtp"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1501999589, "post_id": 45059250, "comment_id": 78018521, "body": "firewall ?? <a href=\"https://stackoverflow.com/questions/33522051/trouble-sending-email-to-office-365?rq=1\" title=\"trouble sending email to office 365\">stackoverflow.com/questions/33522051/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 1687492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255761bbfe581930b85ea2cffed90e67?s=128&d=identicon&r=PG", "display_name": "spacechase0", "link": "https://stackoverflow.com/users/1687492/spacechase0"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1502305549, "post_id": 45059250, "comment_id": 78157040, "body": "No, sadly. I ended up just writing something new in C# and presenting that to my supervisor."}], "owner": {"reputation": 1, "user_id": 1687492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/255761bbfe581930b85ea2cffed90e67?s=128&d=identicon&r=PG", "display_name": "spacechase0", "link": "https://stackoverflow.com/users/1687492/spacechase0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1599, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499866536, "creation_date": 1499866536, "question_id": 45059250, "link": "https://stackoverflow.com/questions/45059250/transport-failed-to-connect-to-server-when-sending-mail-from-excel-through-off", "title": "&quot;Transport failed to connect to server&quot; when sending mail from Excel through Office 365", "body": "<p>I'm trying to change an old excel form to send email through an Office 365 account instead of GMail, but almost everything I do gives me a <code>The transport failed to connect to the server</code> error.</p>\n\n<p>Here is the relevant code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set CDO_Mail = CreateObject(\"CDO.Message\")\nOn Error GoTo Error_Handling\n\nConst cdoSendUsingPickup = 1                'Send message using the local SMTP service pickup directory.\nConst cdoSendUsingPort = 2                  'Send the message using the network (SMTP over the network).\n\nConst cdoAnonymous = 0                      'Do not authenticate\nConst cdoBasic = 1                          'basic (clear-text) authentication\nConst cdoNTLM = 2                           'NTLM\n\nSet CDO_Config = CreateObject(\"CDO.Configuration\")\nCDO_Config.Load -1\n\nSet SMTP_Config = CDO_Config.Fields '\n\nWith SMTP_Config\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = cdoSendUsingPort\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"smtp.office365.com\"\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpauthenticate\") = cdoNTLM\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 25\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/sendusername\") = strFrom\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/sendpassword\") = emailFromPassword\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpconnectiontimeout\") = 60\n    .Item(\"http://schemas.microsoft.com/cdo/configuration/smtpusessl\") = True\n    .Update\nEnd With\n\nWith CDO_Mail\n    Set .Configuration = CDO_Config\nEnd With\n\nCDO_Mail.Subject = strSubject\nCDO_Mail.From = strFrom\nCDO_Mail.To = strTo\nCDO_Mail.HTMLBody = strBody\nCDO_Mail.CC = strCc\nCDO_Mail.BCC = strBcc\nCDO_Mail.Send\n\nError_Handling:\nIf Err.Description &lt;&gt; \"\" Then\nMsgBox (Err.Description)\n</code></pre>\n\n<p>I've tried everything relevant that I can think of (and then some):</p>\n\n<ul>\n<li><code>smtp.office365.com</code> and <code>pod51010.office365.com</code> for the server</li>\n<li>Ports 25, 465, 587</li>\n<li>Toggling SSL</li>\n<li>Removing the connection timeout</li>\n<li>Changing the send using method</li>\n<li>Changing the authentication method</li>\n</ul>\n\n<p>Most all cases give me the error mentioned earlier. Some hang indefinitely (such as using port 25).</p>\n\n<p>Turning SSL off does let a connection through on port 587. Even if we were okay with this, it gives a different error. <code>The server rejected the sender address. The server response was: 530 5.7.57 SMTP; Client was not authenticated to send anonymous mail during MAIL FROM [...outlook.com]</code> However, I've already verified the credentials are correct. From what I've read this means I can't send mail with SSL off? So that isn't an option anyways.</p>\n\n<p>I'm using Excel 2010.</p>\n\n<p>Am I missing something, or is this not doable for some reason?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2250, "user_id": 1923086, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/6CM1f.jpg?s=128&g=1", "display_name": "JahKnows", "link": "https://stackoverflow.com/users/1923086/jahknows"}, "edited": false, "score": 0, "creation_date": 1499866077, "post_id": 45058869, "comment_id": 77091466, "body": "Can you provide pictures of Sheet1 and Sheet2."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1499866110, "post_id": 45058869, "comment_id": 77091500, "body": "Why not fix the data before matching?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1499867168, "post_id": 45058869, "comment_id": 77092303, "body": "Please look up code indentation."}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499866227, "post_id": 45059045, "comment_id": 77091569, "body": "THis is an formula , Could you tell me how i could do in VBA ?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499866259, "post_id": 45059045, "comment_id": 77091596, "body": "and how i could have this line of code with in the above code."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499866334, "post_id": 45059045, "comment_id": 77091653, "body": "@Mikz <code>Mid</code> is also vba.  It is used the same way, but the third criteria in vba is optional."}, {"owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "edited": false, "score": 0, "creation_date": 1499866362, "post_id": 45059045, "comment_id": 77091665, "body": "can you please share your sheet picture?i will help you on this"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1499866383, "post_id": 45059045, "comment_id": 77091682, "body": "@ScottCraner I could then just include this in my above code and it works ?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499866422, "post_id": 45059045, "comment_id": 77091710, "body": "@ Karthick Anbazhagan ya sure, i will do it"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499867714, "post_id": 45059045, "comment_id": 77092753, "body": "@KarthickAnbazhagan I have updated the post with Images"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499870292, "post_id": 45059045, "comment_id": 77094759, "body": "@KarthickAnbazhagan I am not getting any result now"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499870346, "post_id": 45059045, "comment_id": 77094792, "body": "@KarthickAnbazhagan but there are no error in the code ,"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499929721, "post_id": 45059045, "comment_id": 77119825, "body": "@KarthickAnbazhagan is this code, working with you fine   ?"}, {"owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "edited": false, "score": 0, "creation_date": 1499929988, "post_id": 45059045, "comment_id": 77119997, "body": "in your sheet you have fixed Label for Range that is why you are not getting results, try to debug using immediate window,msgbox ."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "edited": false, "score": 0, "creation_date": 1499935478, "post_id": 45059045, "comment_id": 77123765, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/149088/discussion-between-mikz-and-karthick-anbazhagan\">continue this discussion in chat</a>."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499943851, "post_id": 45059045, "comment_id": 77129745, "body": "@KarthickAnbazhagan I am sorry, could you Please join now  ? may be i Need your help to figure it out. what is wrong"}], "tags": [], "owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "is_accepted": false, "score": 1, "last_activity_date": 1499877072, "last_edit_date": 1499877072, "creation_date": 1499866073, "answer_id": 45059045, "question_id": 45058869, "link": "https://stackoverflow.com/questions/45058869/error-in-finding-the-matched-id/45059045#45059045", "title": "Error in finding the matched ID", "body": "<p>Try this</p>\n\n<pre><code>Sub match()\n    Dim sh1 As Worksheet, sh2 As Worksheet\n    Dim cell As Range, cell2 As Range, lstcl As Variant, lstcl2 As Variant, rgFnd As Variant\n    Dim n As Double, ID As String\n    Set sh1 = ThisWorkbook.sheets(\"S\")\n    Set sh2 = ThisWorkbook.sheets(\"P\")\n    ID = \"4\"\n    lstcl = sh1.Range(\"N10000\").End(xlUp).Row\n    lstcl2 = sh2.Range(\"L10000\").End(xlUp).Row\n    'comparing columns N and L in both sheets\n    For Each cell In sh2.Range(\"L5:L\" &amp; lstcl2)\n        For n = 5 To lstcl\n            a = Left(sh1.Range(\"N\" &amp; n), 8)\n            If cell = a Then\n                'the cell in column M next to the matching cell is equal to the 4xxxxxxx number\n                cell.Offset(0, 1) = a\n                'the next cell in column N is equal to the A2C number in column A\n                cell.Offset(0, 2) = cell.Offset(0, -11)\n            End If\n        Next\n    Next\n    'test that each cell in the first sheet corresponds to the located results in the second sheet _\n    'and pastes back the A2C number, using the Range.Find function\n    For Each cell2 In sh1.Range(\"N5:N\" &amp; lstcl)\n        If Left(cell2, 1) = ID Then\n            Set rgFnd = sh2.Range(\"M5:M\" &amp; lstcl2).Find(cell2.Value)\n            If Not rgFnd Is Nothing Then\n                cell2.Offset(0, 1) = sh2.Range(rgFnd.Address).Offset(0, 1)\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499877072, "creation_date": 1499865644, "last_edit_date": 1499867687, "question_id": 45058869, "link": "https://stackoverflow.com/questions/45058869/error-in-finding-the-matched-id", "title": "Error in finding the matched ID", "body": "<p>I have two Sheets sheet1, sheet2 </p>\n\n<p>With sheet1 i have id which always starts with 4, I look for this ID in sheet2, and pul the corresponding names and copy back to sheet1. </p>\n\n<p>The ID is always 8 Digit Long. </p>\n\n<p>during this , I have an Special case, where an ID has some Special charachters and charachters. eg: 41017734_dr_bad ; the code Fails in this case. I doesnot recognise the first 8 and Fails to paste in the another sheet. </p>\n\n<p>Could someone suggest how to overcome this? \nI have an idea we could use whilcard and also strlen function. But struck how to use in code. </p>\n\n<pre><code>Sub match()\nDim sh1 As Worksheet, sh2 As Worksheet\nDim cell As Range, cell2 As Range, lstcl As Variant, lstcl2 As Variant, rgFnd As Variant\nDim n As Double, ID As String\nSet sh1 = ThisWorkbook.Sheets(\"S\")\nSet sh2 = ThisWorkbook.Sheets(\"P\")\nID = \"4\"\nlstcl = sh1.Range(\"N10000\").End(xlUp).Row\nlstcl2 = sh2.Range(\"L10000\").End(xlUp).Row\n'comparing columns N and L in both sheets\nFor Each cell In sh2.Range(\"L5:L\" &amp; lstcl2)\nFor n = 5 To lstcl\nIf cell = sh1.Range(\"N\" &amp; n) Then\n'the cell in column M next to the matching cell is equal to the 4xxxxxxx number\ncell.Offset(0, 1) = sh1.Range(\"N\" &amp; n)\n'the next cell in column N is equal to the A2C number in column A\ncell.Offset(0, 2) = cell.Offset(0, -11)\nEnd If\nNext\nNext\n'test that each cell in the first sheet corresponds to the located results in the second sheet _\n'and pastes back the A2C number, using the Range.Find function\nFor Each cell2 In sh1.Range(\"N5:N\" &amp; lstcl)\nIf Left(cell2, 1) = ID Then\nSet rgFnd = sh2.Range(\"M5:M\" &amp; lstcl2).Find(cell2.Value)\nIf Not rgFnd Is Nothing Then\ncell2.Offset(0, 1) = sh2.Range(rgFnd.Address).Offset(0, 1)\nEnd If\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/M5Xtx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M5Xtx.png\" alt=\"this is how my ID Looks in sht1 in column N. It has ID with both B2C and ID starting with 4 (column N).\"></a>\n<a href=\"https://i.stack.imgur.com/7O1gJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7O1gJ.png\" alt=\"This is how the ID in sheet2 Looks like, with one column containing ID with B2C (column A) and another column contianining id with 4 (column L) \"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ejf2o.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ejf2o.png\" alt=\"The result Looks like this, I look into the ID in column N and match them with column L in sheet2 which contains 4, and then i pull the corresponding ID from sheet2 and paste it to the next column. I have highlighted the spl condition as red, because if we notice the number is same, because of the charachters at the end, it is not recognized. I want to check for the first 8 Digit and if they match , then it should be able to do it as per the code below. It would be great, if we could add a line in my code and could get the result.\"></a></p>\n"}, {"tags": ["excel", "comments", "vba"], "comments": [{"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1499867229, "post_id": 45058850, "comment_id": 77092354, "body": "Try to <code>Activate</code> <code>selectedSheet</code> every time you set a new one."}, {"owner": {"reputation": 404, "user_id": 5247192, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-XESaam5JJI8/AAAAAAAAAAI/AAAAAAAAADc/symL3XOVoQg/photo.jpg?sz=128", "display_name": "\u0218tefan Blaga", "link": "https://stackoverflow.com/users/5247192/%c8%98tefan-blaga"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1499868203, "post_id": 45058850, "comment_id": 77093129, "body": "I did. No succes :("}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1499889897, "post_id": 45058850, "comment_id": 77106498, "body": "Another idea, maybe it&#39;s problem with <code>amplitude</code>? Sorry for not checking this, but I can&#39;t access my computer atm."}, {"owner": {"reputation": 404, "user_id": 5247192, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-XESaam5JJI8/AAAAAAAAAAI/AAAAAAAAADc/symL3XOVoQg/photo.jpg?sz=128", "display_name": "\u0218tefan Blaga", "link": "https://stackoverflow.com/users/5247192/%c8%98tefan-blaga"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1499934253, "post_id": 45058850, "comment_id": 77122925, "body": "No, the amplitude is fine. The value exists. At the memont when the error pop-up the value is -15."}, {"owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "edited": false, "score": 0, "creation_date": 1500474507, "post_id": 45058850, "comment_id": 77354418, "body": "Did you check if your &#39;another sheet&#39; is protected? Your code should work for commented and uncommented sheets. If it&#39;s not protected, please provide more info on your calls/selection of sheets."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1500503278, "post_id": 45058850, "comment_id": 77371221, "body": "@\u0218tefanBlaga I edited the question to include what I believe is an MCVE.  Hopefully that will focus people&#39;s attention on the actual issue rather than anything else that they might think is affecting things.  Feel free to rollback to the previous version of the question if you don&#39;t like the MCVE being added."}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 5247192, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-XESaam5JJI8/AAAAAAAAAAI/AAAAAAAAADc/symL3XOVoQg/photo.jpg?sz=128", "display_name": "\u0218tefan Blaga", "link": "https://stackoverflow.com/users/5247192/%c8%98tefan-blaga"}, "edited": false, "score": 0, "creation_date": 1500992293, "post_id": 45199304, "comment_id": 77573842, "body": "I activate the sheet and after that select the range like this: Set rng = selectedSheet.Cells(1, columnIndex) rng.Select                                            No succes!"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "reply_to_user": {"reputation": 404, "user_id": 5247192, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-XESaam5JJI8/AAAAAAAAAAI/AAAAAAAAADc/symL3XOVoQg/photo.jpg?sz=128", "display_name": "\u0218tefan Blaga", "link": "https://stackoverflow.com/users/5247192/%c8%98tefan-blaga"}, "edited": false, "score": 0, "creation_date": 1501003762, "post_id": 45199304, "comment_id": 77582096, "body": "This doesn&#39;t select sheet. Try <code>selectedSheet.Select</code>."}, {"owner": {"reputation": 404, "user_id": 5247192, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-XESaam5JJI8/AAAAAAAAAAI/AAAAAAAAADc/symL3XOVoQg/photo.jpg?sz=128", "display_name": "\u0218tefan Blaga", "link": "https://stackoverflow.com/users/5247192/%c8%98tefan-blaga"}, "edited": false, "score": 0, "creation_date": 1501063736, "post_id": 45199304, "comment_id": 77609345, "body": "This works! Selecting the entire sheet and not only the range works"}], "tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": true, "score": 3, "last_activity_date": 1500492025, "creation_date": 1500492025, "answer_id": 45199304, "question_id": 45058850, "link": "https://stackoverflow.com/questions/45058850/addcomment-on-multiple-sheets-vba-excel/45199304#45199304", "title": "AddComment on multiple sheets vba Excel", "body": "<p>I found a workaround, but still don't know why this problem even happens. For some reason error occurs when you have more then one worksheet selected. The solution is... To select one sheet before adding comments with <code>someSheet.Select</code>. At the end of macro you can try to select all previously selected sheets again if needed.</p>\n"}, {"comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1500905961, "post_id": 45200969, "comment_id": 77528331, "body": "Answer to the aside: The statements don&#39;t do the same thing. One creates a new comment, the other updates a comment when it already exists. The OP is using <code>.AddComment</code> and <code>.Comment.Text</code> for those different reasons."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1500928445, "post_id": 45200969, "comment_id": 77541506, "body": "Did you try the code stated? Prior to the calling delete the comment and then call the routine needed"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 1, "last_activity_date": 1500498555, "last_edit_date": 1500498555, "creation_date": 1500498253, "answer_id": 45200969, "question_id": 45058850, "link": "https://stackoverflow.com/questions/45058850/addcomment-on-multiple-sheets-vba-excel/45200969#45200969", "title": "AddComment on multiple sheets vba Excel", "body": "<p>I had the same problem while trying to get a comments function to work so instead of trying to figure it out per scenario, I decided to do a general one; call as needed.</p>\n\n<pre><code>Sub General_Functions_Comments(InCell As Range, TxtComment As String, Optional IsMergedAnalyzed As Boolean)\nDim IsComment As Comment\nDim RangeFixedMerged As Range\n    If InCell.MergeCells = False Or IsMergedAnalyzed = True Then ' 3. If InCell.MergeCells = False\n    With InCell\n    Set IsComment = .Comment\n    If IsComment Is Nothing Then ' 1. If Iscomment Is Nothing\n    .AddComment.Text Text:=TxtComment\n    .Comment.Shape.TextFrame.AutoSize = True\n    .Comment.Visible = False\n    Else ' 1. If Iscomment Is Nothing\n    If InStr(.Comment.Text, TxtComment) Then ' 2. If InStr(.Comment.Text, TxtComment)\n    Else ' 2. If InStr(.Comment.Text, TxtComment)\n    .Comment.Text .Comment.Text &amp; Chr(10) &amp; TxtComment\n    .Comment.Shape.TextFrame.AutoSize = True\n    .Comment.Visible = False\n    End If ' 2. If InStr(.Comment.Text, TxtComment)\n    End If ' 1. If Iscomment Is Nothing\n    End With\n    Else ' 3. If InCell.MergeCells = False\n    Set RangeFixedMerged = InCell.Cells(1, 1)\n    Call General_Functions_Comments(RangeFixedMerged, TxtComment, True)\n    Set RangeFixedMerged = Nothing\n    End If ' 3. If InCell.MergeCells = False\nEnd Sub\n</code></pre>\n\n<p>In your code</p>\n\n<pre><code>If standardReportFilePath &lt;&gt; \"\" Then 'not using the Standard Report Evalution algorithm\n                        If VerifyStandardReportFile(selectedSheet.Name, selectedSheet.Cells(1, columnIndex).Value, wbk, amplitude, missingCrashes) = True Then\n                                selectedSheet.Cells(1, columnIndex).Interior.ColorIndex = 36 ' color the crash cell with yellow\n                                Set Rng = selectedSheet.Cells(1, columnIndex)\n                                If Rng.Comment Is Nothing Then\n                                Call General_Functions_Comments(Rng, \"In Standard Report this crash starts to deploy from \" &amp; CStr(amplitude) &amp; \" amplitude\", True)\n                                Else: Call General_Functions_Comments(Rng, \"In Standard Report this crash starts to deploy from \" &amp; CStr(amplitude) &amp; \" amplitude\", True)\n                                End If\n                            End If\n                        End If\n                    End If\n                End If\n</code></pre>\n\n<p>*Aside question, why to set an if, else statement if both will do the same?</p>\n"}, {"tags": [], "owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "is_accepted": false, "score": 3, "last_activity_date": 1500542356, "creation_date": 1500542356, "answer_id": 45210504, "question_id": 45058850, "link": "https://stackoverflow.com/questions/45058850/addcomment-on-multiple-sheets-vba-excel/45210504#45210504", "title": "AddComment on multiple sheets vba Excel", "body": "<p>What I do understand - thanks to Yoweks comment - is:\nYou are looping through all the selected sheets, check something, set comments (giving you the problems, because it does'nt work with more than one selected sheet) and want the previosly selected sheets to be selected afterwards.</p>\n\n<p>You can save the previosly selected sheet in a variable, select one of them, run your code and then select all previosly selected sheets again. PLease try the following code:</p>\n\n<pre><code>Sub Comments()\nDim WsArr As Sheets, WS As Worksheet, ColIdx As Long\nColIdx = 7\nSet WsArr = ActiveWorkbook.Windows(1).SelectedSheets\n    WsArr(1).Select\n    For Each WS In WsArr\n        '*** your logic\n        Set Rng = WS.Cells(1, ColIdx)\n        If Rng.Comment Is Nothing Then\n            Rng.AddComment \"In Standard Report this crash starts to deploy from \" &amp; CStr(amplitude) &amp; \" amplitude\"\n        Else\n            Rng.Comment.Text \"Changed T\"\n        End If\n    Next WS\n    WsArr.Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "is_accepted": false, "score": 1, "last_activity_date": 1500640586, "creation_date": 1500640586, "answer_id": 45237885, "question_id": 45058850, "link": "https://stackoverflow.com/questions/45058850/addcomment-on-multiple-sheets-vba-excel/45237885#45237885", "title": "AddComment on multiple sheets vba Excel", "body": "<p>I remember generally similar case (I could not do something from code), trying hard to solve it and finally I found that...  </p>\n\n<p>Note that if you have multiple sheets selected, \"New comment\" button on the ribbon is <strong>inactive</strong>, so you just can't do it from code if you cannot do it manually.<br>\nWhy? - don't ask me. I see a nice workaround above, which seems to be the only way to achieve what you need.</p>\n"}, {"tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": false, "score": 2, "last_activity_date": 1500906260, "last_edit_date": 1500906260, "creation_date": 1500905665, "answer_id": 45282872, "question_id": 45058850, "link": "https://stackoverflow.com/questions/45058850/addcomment-on-multiple-sheets-vba-excel/45282872#45282872", "title": "AddComment on multiple sheets vba Excel", "body": "<p>From the <a href=\"https://support.office.com/en-gb/article/Add-a-comment-bdcc9f5d-38e2-45b4-9a92-0b2b5c7bf6f8\" rel=\"nofollow noreferrer\">Excel documentation</a> </p>\n\n<blockquote>\n  <p>You can add notes to <strong>individual cells</strong> by using comments</p>\n</blockquote>\n\n<p>You can see in the 'Review' tab within Excel that, when you select multiple sheets, you cannot create a comment. I assume this is to do with Excel's internals determining which cell should have a comment assigned to it. </p>\n\n<hr>\n\n<p>Here is a function which you can call to assign a comment to a given cell, even if you have multiple sheets selected.</p>\n\n<p><strong>This sub also removes the need to test if a comment already exists</strong>, simply pass a new comment to a cell which already has one. </p>\n\n<pre><code>Sub UpdateComment(Rng As Range, Cmnt As String)\n    Application.ScreenUpdating = False\n    ' Get currently selected sheets\n    Dim mySheets As Sheets: Set mySheets = ThisWorkbook.Windows(1).SelectedSheets\n    ' Set current selection to just one sheet: this is where error is avoided\n    ThisWorkbook.Sheets(1).Select\n    ' Set Comment, new if doesn't exist or changed if it does\n    If Rng.Comment Is Nothing Then\n        Rng.AddComment Cmnt\n    Else\n        Rng.Comment.Text Cmnt\n    End If\n    ' Tidy up: re-select sheets &amp; enable screen updating\n    mySheets.Select\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Use it like so in your code:</p>\n\n<pre><code>' ... your previous code\nSet rng = selectedSheet.Cells(1, columnIndex)\nUpdateComment rng, \"In standard report this crash starts to deploy from ...\" \n</code></pre>\n\n<p>To loop over all selected sheets</p>\n\n<pre><code>Dim sh As Worksheet\nFor Each sh In ThisWorkbook.Windows(1).SelectedSheets\n    Set rng = sh.Cells(1, columnIndex)\n    UpdateComment rng, \"In standard report this crash starts to deploy from ...\"\nNext sh\n</code></pre>\n"}], "owner": {"reputation": 404, "user_id": 5247192, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-XESaam5JJI8/AAAAAAAAAAI/AAAAAAAAADc/symL3XOVoQg/photo.jpg?sz=128", "display_name": "\u0218tefan Blaga", "link": "https://stackoverflow.com/users/5247192/%c8%98tefan-blaga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 695, "favorite_count": 0, "accepted_answer_id": 45199304, "answer_count": 5, "score": 6, "last_activity_date": 1500906260, "creation_date": 1499865588, "last_edit_date": 1531164843, "question_id": 45058850, "link": "https://stackoverflow.com/questions/45058850/addcomment-on-multiple-sheets-vba-excel", "title": "AddComment on multiple sheets vba Excel", "body": "<p>The AddComment syntax works on first selected sheet in workbook, but for the next one gives me this error: Error 1004 \"Application-defined or Object-defined error\". I do not know why crashes if multiple sheets were selected and works only for the first selected one. Does anyone have some idea? </p>\n\n<pre><code> If selectedSheet.Cells(7, columnIndex).value &lt;&gt; 100 Then\n           selectedSheet.Cells(7, columnIndex).Interior.ColorIndex = 3\n\n           If standardReportFilePath &lt;&gt; \"\" Then 'not using the Standard Report Evalution algorithm\n                        If VerifyStandardReportFile(selectedSheet.Name, selectedSheet.Cells(1, columnIndex).value, wbk, amplitude, missingCrashes) = True Then\n                                selectedSheet.Cells(1, columnIndex).Interior.ColorIndex = 36 ' color the crash cell with yellow\n                                Set rng = selectedSheet.Cells(1, columnIndex)\n                                If rng.Comment Is Nothing Then\n                                    **rng.AddComment \"In Standard Report this crash starts to deploy from \" &amp; CStr(amplitude) &amp; \" amplitude\"**\n                                Else\n                                    rng.Comment.Text \"In Standard Report this crash starts to deploy from \" &amp; CStr(amplitude) &amp; \" amplitude\"\n                                End If\n                            End If\n                        End If\n                    End If\n                End If\n</code></pre>\n\n<p>An alternate set of code that shows the problem.  (Run this with three blank worksheets in a new workbook.):</p>\n\n<pre><code>Sub test()\n    Dim ws As Worksheet\n    Dim Rng As Range\n\n    'Running code with a single sheet selected\n    Worksheets(\"Sheet1\").Select\n\n    'Code that shows issue - this will work\n    Set ws = Worksheets(\"Sheet2\")\n    Set Rng = ws.Cells(1, 1)\n    If Rng.Comment Is Nothing Then\n        Rng.AddComment \"xxx\"\n    End If\n\n    'Get rid of comment again\n    Rng.Comment.Delete\n\n    'Running code with multiple sheets selected\n    Worksheets(Array(\"Sheet1\", \"Sheet2\", \"Sheet3\")).Select\n\n    'Code that shows issue - will crash on the \"AddComment\"\n    Set ws = Worksheets(\"Sheet2\")\n    Set Rng = ws.Cells(1, 1)\n    If Rng.Comment Is Nothing Then\n        Rng.AddComment \"xxx\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 1, "creation_date": 1499866321, "post_id": 45058621, "comment_id": 77091643, "body": "Hi, Went through your code and tried at my end, and is performing without any error. What is exactly the requirement. not able to understand."}, {"owner": {"reputation": 1, "user_id": 8295952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/046b01ca360ab89ec45ca71f4a086444?s=128&d=identicon&r=PG&f=1", "display_name": "Stalkeris", "link": "https://stackoverflow.com/users/8295952/stalkeris"}, "reply_to_user": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 0, "creation_date": 1499923083, "post_id": 45058621, "comment_id": 77116470, "body": "Hi, I just need to group all values in &quot;grafikas&quot; sheet  that are got from for cicle for."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1502026068, "post_id": 45058621, "comment_id": 78024937, "body": "You will get better and more answers if you are more specific and explain in detail what you want to accomplish. Your explanation &quot;group all values in &quot;grafikas&quot; sheet that are got from for cicle for&quot; does not make much sense."}], "owner": {"reputation": 1, "user_id": 8295952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/046b01ca360ab89ec45ca71f4a086444?s=128&d=identicon&r=PG&f=1", "display_name": "Stalkeris", "link": "https://stackoverflow.com/users/8295952/stalkeris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502019576, "creation_date": 1499865015, "last_edit_date": 1502019576, "question_id": 45058621, "link": "https://stackoverflow.com/questions/45058621/how-to-group-all-values-in-a-for-loop-and-print-grouped-value-to-another-sheet", "title": "How to group all values in a For loop and print grouped value to another sheet", "body": "<p>I need help with excel vba programing, I need to group values in a For loop and print grouped list to other sheet, here is my code </p>\n\n<pre><code>Dim grafikas As Worksheet\nDim akcijos As Worksheet\nDim x As Integer\nDim prekeskodas As Long\nDim lastrow As Integer\nDim laikas As Date\nDim ats As String\n\n\nSet grafikas = Sheets(\"GRAFIKAS\")\nSet akcijos = Sheets(\"AKCIJOS\")\n\nlastrow = akcijos.Cells(Rows.Count, 1).End(xlUp).Row\npaskeil = grafikas.Cells(Rows.Count, 1).End(xlUp).Row\n\nprekeskodas = grafikas.Range(\"B48\").Value\n\nlaikas = grafikas.Range(\"F1\").Value\nlaikas2 = grafikas.Range(\"CK1\").Value\n\nFor x = 2 To lastrow\n    If akcijos.Cells(x, 4) = prekeskodas And akcijos.Cells(x, 8) &gt;= laikas Then\n       ats = akcijos.Cells(x, 3)\n       Sheets(\"grafikas\").Range(\"C7\") = ats\n       Debug.Print akcijos.Cells(x, 3)\n    End If\nNext x\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1499865109, "post_id": 45058536, "comment_id": 77090681, "body": "How do you know it&#39;s not the correct action? Do you get an error? What does it say? It&#39;s not clear if you&#39;re asking whether your VBA is correct or simply how to run it."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7409894, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/03bb208b6faa44d0d6b4809582f49bed?s=128&d=identicon&r=PG", "display_name": "Rain Check", "link": "https://stackoverflow.com/users/7409894/rain-check"}, "edited": false, "score": 0, "creation_date": 1499872892, "post_id": 45058871, "comment_id": 77096844, "body": "Thanks Gustav got it all most"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1499865652, "creation_date": 1499865652, "answer_id": 45058871, "question_id": 45058536, "link": "https://stackoverflow.com/questions/45058536/ms-access-vba-run-query/45058871#45058871", "title": "MS Access VBA run query", "body": "<p>Assign you <em>SQL</em> to a variable, and use this when opening a recordset:</p>\n\n<pre><code>Dim rs As DAO.Recordset\nDim HomeEmail As String\n\nSet rs = CurrentDb.OpenRecordset(SQL) ' Your SQL.\nHomeEmail = rs.Fields(0).Value\nrs.Close\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7409894, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/03bb208b6faa44d0d6b4809582f49bed?s=128&d=identicon&r=PG", "display_name": "Rain Check", "link": "https://stackoverflow.com/users/7409894/rain-check"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1481, "favorite_count": 0, "accepted_answer_id": 45058871, "answer_count": 1, "score": -1, "last_activity_date": 1594650993, "creation_date": 1499864816, "last_edit_date": 1594650993, "question_id": 45058536, "link": "https://stackoverflow.com/questions/45058536/ms-access-vba-run-query", "title": "MS Access VBA run query", "body": "<p>I would like to extract the <code>Member.HomeEmail</code> and store it in <code>strEmail</code>, and if more mail address are found separate them using <code>;</code> like\n<code>1@mail.com; 2@mail.com; 3@mail.com</code>, so that I can use the result in Outlook as <code>strBCC = strEmail</code></p>\n\n<pre><code>Private Sub Command610_Click()\n    Dim strEmail\n\n    SELECT Member.HomeEmail\n    FROM Member INNER JOIN MemberRole ON Member.MemberID = MemberRole.MemberID\n    WHERE (((MemberRole.RoleID)=1) AND ((Member.ConstituencyPrefix)=\"DF\") AND ((MemberRole.FinishDate) Is Null))\n    ORDER BY Member.Surname;\nEnd Sub\n</code></pre>\n\n<p>Help is more then welcome. I don't really know how to run a query in VBA; I tried <code>DoCmd.RunSQL strSQL</code>, but it's not the correct action.</p>\n\n<p>I am almost there:</p>\n\n<p>The variable strCons contains a number and I would like to add this to the SQL when I do this like below I get a run-time error '3061' Too few parameters. Expexted 1. Tried to find out why with no luck.</p>\n\n<p>Dim rs As DAO.Recordset Dim strEmailTD As String</p>\n\n<p>Set rs = CurrentDb.OpenRecordset(\"SELECT Member.HomeEmail FROM Member INNER JOIN MemberRole ON Member.MemberID = MemberRole.MemberID WHERE ((<strong>(MemberRole.AreaID)= strCons)</strong> AND ((MemberRole.RoleID)=1) AND ((MemberRole.FinishDate) Is Null)) ORDER BY Member.Surname\") strEmailTD = rs.Fields(0).Value rs.Close</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "edited": false, "score": 0, "creation_date": 1499864582, "post_id": 45058307, "comment_id": 77090247, "body": "Which two work?"}, {"owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "reply_to_user": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "edited": false, "score": 0, "creation_date": 1499864764, "post_id": 45058307, "comment_id": 77090407, "body": "@Busse the way it is now, <code>Check0</code> does not work."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1499864843, "post_id": 45058307, "comment_id": 77090469, "body": "What do you mean &#39;does not work&#39;  ?"}, {"owner": {"reputation": 823, "user_id": 7746454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95207c62ad1aed75ade3f53fb7216308?s=128&d=identicon&r=PG&f=1", "display_name": "Busse", "link": "https://stackoverflow.com/users/7746454/busse"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1499864921, "post_id": 45058307, "comment_id": 77090532, "body": "Just checking to make sure it&#39;s written as intended. The <code>Check0</code> will only get hit if it meets the prior <code>If</code> Criteria: <code>If Check = &quot;a&quot; Or Check = &quot;b&quot; Or Check = &quot;c&quot; Or Check = &quot;d&quot; Then</code>.  OR if it is a Boolean value set to <code>True</code>. Is this intended? Where do you apply the value of <code>True</code> or <code>False</code> to <code>Check0</code>?  And as @RobinMackenzie mentioned, please make sure you update your original question with <i>HOW</i> it does not work.  Does it error, does it not get a value assigned to it, etc."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1499865031, "post_id": 45058307, "comment_id": 77090625, "body": "If <code>Check</code> is not a, b, c or d then you then look at <code>Check0</code> but only set the value of <code>Check0</code> if <code>Check</code> is a, b, c or d. This is a problem."}], "answers": [{"tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": true, "score": 1, "last_activity_date": 1499866146, "creation_date": 1499866146, "answer_id": 45059070, "question_id": 45058307, "link": "https://stackoverflow.com/questions/45058307/trying-to-join-3-statements-together-in-a-select-case/45059070#45059070", "title": "trying to join 3 statements together in a select case", "body": "<p>The issue is that your <code>Check0</code> variable is not initialised when you check it. It would be best to first do all your three checks and only then perform the <code>If...ElseIf...</code>.</p>\n\n<p>Secondly, this expression is using the wrong parts of the input string:</p>\n\n<pre><code>val = \"S-\" &amp; Left(aCell, Len(aCell) - 10) &amp; \"-\" &amp; Mid(aCell, 4, Len(aCell) - 9)\n</code></pre>\n\n<p>I don't really understand why you use <code>Len(aCell) - something</code>, since it is known that the length is 13. Certainly <code>Left(aCell, Len(aCell) - 13)</code> is quite useless, as it will be the empty string.</p>\n\n<p>Here is a correction with some other optimisations (<code>pos</code> is a <code>Long</code>):</p>\n\n<pre><code>    Case 13\n        Check = InStr(\"abcd\", Mid(aCell, 5, 1))\n        Check0 = IsNumeric(Mid(aCell, 2, 8))\n        Check3 = IsNumeric(Left(aCell, 3))\n        pos = IIf(Check3, 1, _\n              IIf(Check, 2, _\n              IIf(Check0, 3, 0)))\n        val = IIf(pos, \"S-\" &amp; Mid(aCell, pos, 3) &amp; \"-\" &amp; Mid(aCell, pos+3, 4), \"??\")\n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 45059070, "answer_count": 1, "score": 0, "last_activity_date": 1499866146, "creation_date": 1499864227, "last_edit_date": 1499865927, "question_id": 45058307, "link": "https://stackoverflow.com/questions/45058307/trying-to-join-3-statements-together-in-a-select-case", "title": "trying to join 3 statements together in a select case", "body": "<p>I am trying to join these 3 statements together. I can get two to work but not the third.</p>\n\n<p><em>Check</em> is looking to see if the 5th character = a,b,c,d.</p>\n\n<p><em>Check0</em> is looking to see if characterS 2-9 are all numbers.</p>\n\n<p><em>Check3</em> is looking to see if the first 3 characters are numbers.</p>\n\n<p>Desired effect</p>\n\n<p><em>Before</em> >            <strong>After</strong></p>\n\n<p>Check 0 <em>e01730101.pdf</em> > <strong>S-173-0101</strong></p>\n\n<p>Check3 <em>173d00510.pdf</em> > <strong>S-173-D005</strong></p>\n\n<p>Check <em>e173d0061.pdf</em> > <strong>S-173-D006</strong></p>\n\n<p>Right now Check0 is not working. When I run the code it seems to skip my Case 13 Check0 statement. Anyway i can write this so the 3 checks are not conflicting each other?</p>\n\n<pre><code>Option Explicit\n\nSub Convert()\nApplication.ScreenUpdating = False\n\nDim rng As Range, aCell As Range\nDim val As String, Check, Check0, Check3\nDim LastRow As Long\nLastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSet rng = Range(\"A2:A\" &amp; LastRow)\n\nFor Each aCell In rng.Cells\nSelect Case Len(aCell)\n   'Case 12 left out\n    Case 13\n        Check = Mid(aCell, 5, Len(aCell) - 12)\n        If Check = \"a\" Or Check = \"b\" Or Check = \"c\" Or Check = \"d\" Then 'Existing Standard\n        val = \"S-\" &amp; Left(aCell, Len(aCell) - 13) &amp; Mid(aCell, 2, Len(aCell) - 10) &amp; \"-\" &amp; Mid(aCell, 5, Len(aCell) - 9)\n\n            Check0 = IsNumeric(Mid(aCell, 2, Len(aCell) - 5)) '|||PROBLEM|||\n            ElseIf Check0 = True Then 'Existing Three Line Diagrams\n            val = \"S-\" &amp; Left(aCell, Len(aCell) - 10) &amp; \"-\" &amp; Mid(aCell, 4, Len(aCell) - 9)\n            End If\n\n                Check3 = IsNumeric(Left(aCell, 3))\n                If Check3 = True Then 'Standard after page 9\n                val = \"S-\" &amp; Mid(aCell, 1, Len(aCell) - 10) &amp; \"-\" &amp; Mid(aCell, 4, Len(aCell) - 9)\n                End If\n        Check = \"\"\n        Check0 = \"\"\n        Check3 = \"\"\n   'Case 14 left out\n    Case Else 'All other pages\n        val = \"_Mod \" &amp; Left(aCell, Len(aCell) - 4)\nEnd Select\n\nval = UCase(val)\n\nval = val &amp; \" \" &amp; aCell.Offset(, 2) &amp; aCell.Offset(, 3)\n\naCell.Offset(, 1).Value = val\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1499864137, "post_id": 45058195, "comment_id": 77089891, "body": "You&#39;ve missed <code>THEN</code> at the end of the <code>If Range(...</code> line.  You may want to add <code>Application.EnableEvents=False</code> at the start of the procedure and <code>Application.EnableEvents=True</code> at the end as you&#39;re adding 1377 values to the sheet and the Change event will fire for each one."}, {"owner": {"reputation": 31, "user_id": 5648454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce3c88665bcbda45acaf2b113db56808?s=128&d=identicon&r=PG&f=1", "display_name": "user456", "link": "https://stackoverflow.com/users/5648454/user456"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1499864224, "post_id": 45058195, "comment_id": 77089958, "body": "I did add THEN but it still doesnot work"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1499864296, "post_id": 45058195, "comment_id": 77090010, "body": "Is <code>C3</code> formatted as text?  If not it will read the cell as 619 which doesn&#39;t match your condition."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1499864483, "post_id": 45058195, "comment_id": 77090171, "body": "If C3 is a number formated as <code>0000</code> (leading zero) then use <code>If Range(&quot;C3&quot;).Text =&quot;0619&quot; Then</code>. Also <code>Application.EnableEvents=False</code> and <code>Application.EnableEvents=True</code> as mentioned earlier."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1499864800, "post_id": 45058195, "comment_id": 77090435, "body": "Make sure your columns are wide enough if you use <code>Text</code> as @Jeeped suggests - too narrow and it will see <code>#</code> instead.  Maybe use <code>If Format(Range(&quot;C4&quot;), &quot;0000&quot;) = &quot;0619&quot; Then</code>, but might as well just check for <code>619</code> in that case."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1499865254, "post_id": 45058195, "comment_id": 77090792, "body": "btw, if you have made repeated attempts without disabling events then it is possible that your event handling is hooped. Try running <code>Application.EnableEvents=True</code> from the VBE&#39;s Immediate window."}], "answers": [{"tags": [], "owner": {"reputation": 9170, "user_id": 5039142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rm38D.png?s=128&g=1", "display_name": "G42", "link": "https://stackoverflow.com/users/5039142/g42"}, "is_accepted": false, "score": 1, "last_activity_date": 1499864449, "creation_date": 1499864449, "answer_id": 45058403, "question_id": 45058195, "link": "https://stackoverflow.com/questions/45058195/how-to-set-a-cell-value-depeinding-on-a-specefic-cell-value/45058403#45058403", "title": "How to set a cell value depeinding on a specefic cell value", "body": "<ul>\n<li><p>You are missing <code>Then</code> in the line with <code>If</code></p></li>\n<li><p>Comments in VBA are started with <code>'</code>, not <code>//</code> so this will not parse correctly.</p></li>\n<li><p><code>If Range(\"C3\")=\"0619\"</code> Bear in mind Excel will remove leading zeros from numbers. Only have leading zeros if you will be formatting the value as text.</p></li>\n<li><p>Edit: <code>If Range(\"C3\").Value</code> better than <code>If Range(\"C3\")</code></p></li>\n</ul>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n   'this selects the cell C3 and checks if the value if is 0619\n    If Range(\"C3\").Value = \"0619\" Then\n        Dim example As Range\n        Set example = Range(\"E3:AE53\")\n        example.Value = 0\n\n    End If\n'\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1499865009, "creation_date": 1499865009, "answer_id": 45058617, "question_id": 45058195, "link": "https://stackoverflow.com/questions/45058195/how-to-set-a-cell-value-depeinding-on-a-specefic-cell-value/45058617#45058617", "title": "How to set a cell value depeinding on a specefic cell value", "body": "<ul>\n<li>only perform the work if C3 is changed.</li>\n<li>if C3 is a number formatted as 0000 (leading zero) then use <code>If Range(\"C3\").Text =\"0619\" Then</code></li>\n<li>as mentioned in comments, disable events or your routine will try to run on top of itself when you change the values in the cells. </li>\n<li>event driven sub procedures should have error control</li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    if not intersect(target, range(\"C3\")) is nothing then\n        on error goto safe_exit\n        application.enableevents = false\n        select case range(\"C3\").text\n            case \"0619\"\n                Range(\"E3:AE53\") = 0\n            case else\n                'do nothing\n        end select\n    End if\nsafe_exit:\n    application.enableevents = true\nEnd Sub\n</code></pre>\n\n<p>I've changed your criteria check to a Select Case statement to make it easier to accommodate additional conditions.</p>\n"}], "owner": {"reputation": 31, "user_id": 5648454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce3c88665bcbda45acaf2b113db56808?s=128&d=identicon&r=PG&f=1", "display_name": "user456", "link": "https://stackoverflow.com/users/5648454/user456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1499871162, "creation_date": 1499863885, "last_edit_date": 1499871162, "question_id": 45058195, "link": "https://stackoverflow.com/questions/45058195/how-to-set-a-cell-value-depeinding-on-a-specefic-cell-value", "title": "How to set a cell value depeinding on a specefic cell value", "body": "<p>I am trying to automate the excel sheet by checking the value of a specific cell, and setting multiple columns with a value.</p>\n\n<p>For example if <code>A1</code> cell is \"2\" then I would like all the cells from <code>B2:D54</code> to be the value equal to 0. I have a code written but it looks like it is wrong.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    //this selects the cell C3 and checks if the value if is 0619\n    If Range(\"C3\")=\"0619\"\n        Dim example As Range\n        Set example =Range(\"E3:AE53\")\n        example.Value = 0\n    End if\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Edit</strong> - Added <code>Then</code>, but still not working.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    //this selects the cell C3 and checks if the value if is 0619\n    If Range(\"C3\")=\"0619\" Then\n        Dim example As Range\n        Set example =Range(\"E3:AE53\")\n        example.Value = 0\n    End if\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1499862236, "post_id": 45057614, "comment_id": 77088428, "body": "what code have you already tried?"}, {"owner": {"reputation": 3, "user_id": 6759973, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oBEcLUydCgo/AAAAAAAAAAI/AAAAAAAAAJs/AkRVvdF-iag/photo.jpg?sz=128", "display_name": "mahesh gujar", "link": "https://stackoverflow.com/users/6759973/mahesh-gujar"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1499862274, "post_id": 45057614, "comment_id": 77088461, "body": "<a href=\"https://stackoverflow.com/questions/30768072/fastest-way-to-remove-extra-spaces-more-than-1-from-a-large-range-of-cells-u\" title=\"fastest way to remove extra spaces more than 1 from a large range of cells u\">stackoverflow.com/questions/30768072/&hellip;</a>  These option i tried but not helpful for me.."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1499862497, "post_id": 45057614, "comment_id": 77088632, "body": "Edit your post to include <i>exactly</i> the code you&#39;ve tried and describe <i>exactly</i> what did and did not work and any error messages you may have received. Otherwise we&#39;re just guessing or feeling like a free code-writing service."}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1499863127, "post_id": 45057614, "comment_id": 77089099, "body": "The code you have provided only shows a message when there is no space found. Where is the <code>Else</code> part?"}, {"owner": {"reputation": 309, "user_id": 8201890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYB8I.png?s=128&g=1", "display_name": "MisterBic", "link": "https://stackoverflow.com/users/8201890/misterbic"}, "edited": false, "score": 0, "creation_date": 1499863173, "post_id": 45057614, "comment_id": 77089133, "body": "The lack of information makes it hard for us to help you. It also feels like you didn&#39;t put much research in your issue before posting the question"}, {"owner": {"reputation": 3, "user_id": 6759973, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oBEcLUydCgo/AAAAAAAAAAI/AAAAAAAAAJs/AkRVvdF-iag/photo.jpg?sz=128", "display_name": "mahesh gujar", "link": "https://stackoverflow.com/users/6759973/mahesh-gujar"}, "edited": false, "score": 0, "creation_date": 1499863233, "post_id": 45057614, "comment_id": 77089170, "body": "Not any specific code am trying..can any one has any code that they used to remove space so will try to overcome my problem.."}, {"owner": {"reputation": 3, "user_id": 6759973, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oBEcLUydCgo/AAAAAAAAAAI/AAAAAAAAAJs/AkRVvdF-iag/photo.jpg?sz=128", "display_name": "mahesh gujar", "link": "https://stackoverflow.com/users/6759973/mahesh-gujar"}, "reply_to_user": {"reputation": 309, "user_id": 8201890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYB8I.png?s=128&g=1", "display_name": "MisterBic", "link": "https://stackoverflow.com/users/8201890/misterbic"}, "edited": false, "score": 0, "creation_date": 1499863298, "post_id": 45057614, "comment_id": 77089216, "body": "@Antoine.D i did actually but that not helping with my problem so at the end i posted.."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6759973, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oBEcLUydCgo/AAAAAAAAAAI/AAAAAAAAAJs/AkRVvdF-iag/photo.jpg?sz=128", "display_name": "mahesh gujar", "link": "https://stackoverflow.com/users/6759973/mahesh-gujar"}, "edited": false, "score": 0, "creation_date": 1499863449, "post_id": 45057987, "comment_id": 77089333, "body": "Thanks for help. Can we apply the same for entire sheet? (after some modification)"}], "tags": [], "owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "is_accepted": true, "score": 1, "last_activity_date": 1499863965, "last_edit_date": 1499863965, "creation_date": 1499863282, "answer_id": 45057987, "question_id": 45057614, "link": "https://stackoverflow.com/questions/45057614/how-to-remove-extra-spaces-from-entire-excel-using-vba-code/45057987#45057987", "title": "How to remove extra spaces from entire excel using VBA code?", "body": "<p>the below code removes any spaces in the text in col A. Hope this is what you were looking for. Amend the code as necessary.\nI have done the changes so that it works for the entire sheet. accept the answer by clicking accept  if it resolves your requirement</p>\n\n<pre><code>   Sub teste()\n\n    Dim UsedRng As Range\n    Dim FirstRow As Long, LastRow As Long, FirstCol As Long, LastCol As Long\n\n    Set UsedRng = ActiveSheet.UsedRange\n\n    FRow = UsedRng(1).Row\n    FCol = UsedRng(1).Column\n    lRow = UsedRng(UsedRng.Cells.Count).Row\n    Lcol = UsedRng(UsedRng.Cells.Count).Column\n\nFor X = FRow To lRow\n\nFor Y = FCol To Lcol\n        temp = Cells(X, Y).Value\n        tempC = (Trim(temp))\n        Cells(X, Y).Value = tempC\n        Next Y\nNext X\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6759973, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oBEcLUydCgo/AAAAAAAAAAI/AAAAAAAAAJs/AkRVvdF-iag/photo.jpg?sz=128", "display_name": "mahesh gujar", "link": "https://stackoverflow.com/users/6759973/mahesh-gujar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "accepted_answer_id": 45057987, "answer_count": 1, "score": -1, "last_activity_date": 1499863965, "creation_date": 1499862187, "last_edit_date": 1499863051, "question_id": 45057614, "link": "https://stackoverflow.com/questions/45057614/how-to-remove-extra-spaces-from-entire-excel-using-vba-code", "title": "How to remove extra spaces from entire excel using VBA code?", "body": "<pre><code>Set r = Worksheets(\"Sheet1\").Columns(\"A\").Find(What:=\"  \")\n     If r Is Nothing Then\n            MsgBox \"done\"\n</code></pre>\n\n<p>\\\n       End If\nEnd Sub</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 2, "last_activity_date": 1499861996, "creation_date": 1499861996, "answer_id": 45057550, "question_id": 45057442, "link": "https://stackoverflow.com/questions/45057442/delete-sheet-contents-but-not-macro-button-excel-vba/45057550#45057550", "title": "Delete sheet contents but not macro button Excel Vba", "body": "<p>You can try something like this:</p>\n\n<pre><code>Option Explicit\n\nSub ClearCellsNotButton()\n\n    With Sheets(\"Sheet1\").UsedRange\n        .ClearFormats\n        .ClearContents\n        .ClearComments\n        .ClearHyperlinks\n        .ClearOutline\n        .ClearNotes\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "edited": false, "score": 0, "creation_date": 1499871391, "post_id": 45058003, "comment_id": 77095641, "body": "<code>ClearContents</code> will only delete the values in <code>Range</code>, excluding the formatting."}], "tags": [], "owner": {"reputation": 162, "user_id": 6679860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1286143004743762/picture?type=large", "display_name": "Krystian Koz\u0142owski", "link": "https://stackoverflow.com/users/6679860/krystian-koz%c5%82owski"}, "is_accepted": false, "score": 0, "last_activity_date": 1499863326, "creation_date": 1499863326, "answer_id": 45058003, "question_id": 45057442, "link": "https://stackoverflow.com/questions/45057442/delete-sheet-contents-but-not-macro-button-excel-vba/45058003#45058003", "title": "Delete sheet contents but not macro button Excel Vba", "body": "<pre><code>Sheets(\"Sheet1\").Cells.ClearContents\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 8062076, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9df175b835a65d555b9082ea585aae24?s=128&d=identicon&r=PG&f=1", "display_name": "dgard", "link": "https://stackoverflow.com/users/8062076/dgard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1202, "favorite_count": 0, "accepted_answer_id": 45057550, "answer_count": 2, "score": 1, "last_activity_date": 1499863326, "creation_date": 1499861705, "question_id": 45057442, "link": "https://stackoverflow.com/questions/45057442/delete-sheet-contents-but-not-macro-button-excel-vba", "title": "Delete sheet contents but not macro button Excel Vba", "body": "<p>How can I delete the contents of a sheet including formatting without deleting a macro button?</p>\n\n<p>I am currently deleting the sheet contents</p>\n\n<pre><code>sheets(\"Sheet\").UsedRange.Delete\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1499861706, "post_id": 45057378, "comment_id": 77087999, "body": "are AC6, AC16 variables? if so, how are they defined? if not, they need to be in quotes... and use a colon instead of a comma... where are you learning this code? it makes no sense"}, {"owner": {"reputation": 95, "user_id": 8114996, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10154594933403045/picture?type=large", "display_name": "Yoav Poni", "link": "https://stackoverflow.com/users/8114996/yoav-poni"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1499861759, "post_id": 45057378, "comment_id": 77088036, "body": "I&#39;m trying to pick it up as fast as I can..  I&#39;m more familiar with Python Syntax  and every loop, AC6,AC16 are changing because of randbetween() function"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1499862078, "post_id": 45057378, "comment_id": 77088306, "body": "a range definition needs to look more like this <code>Worksheets(&quot;Calculator&quot;).Range(&quot;AC6:AC16&quot;)</code>"}, {"owner": {"reputation": 95, "user_id": 8114996, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10154594933403045/picture?type=large", "display_name": "Yoav Poni", "link": "https://stackoverflow.com/users/8114996/yoav-poni"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1499862156, "post_id": 45057378, "comment_id": 77088367, "body": "Yeah, I changed it, and now I&#39;m at the Runtime Error, Subscript out of range.  would you know how I would be able to paste the data at a column one after the other?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1499862406, "post_id": 45057378, "comment_id": 77088570, "body": "changed it to what? are you expecting people to read your mind? update your post as you go so people can see what you did."}, {"owner": {"reputation": 95, "user_id": 8114996, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10154594933403045/picture?type=large", "display_name": "Yoav Poni", "link": "https://stackoverflow.com/users/8114996/yoav-poni"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1499862574, "post_id": 45057378, "comment_id": 77088694, "body": "Changed the code, with your recommendation&#39;s and changed the code above."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1499862624, "post_id": 45057378, "comment_id": 77088722, "body": "in this case &#39;subscript out of range&#39; typically means that there is no worksheet called &quot;Calculator&quot; in your workbook."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 8114996, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10154594933403045/picture?type=large", "display_name": "Yoav Poni", "link": "https://stackoverflow.com/users/8114996/yoav-poni"}, "edited": false, "score": 0, "creation_date": 1499863072, "post_id": 45057771, "comment_id": 77089059, "body": "Thank you..  In order for me to paste special should I just write PasteSpecial:= (after each worksheet)?? and then the social paste I want?"}, {"owner": {"reputation": 95, "user_id": 8114996, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10154594933403045/picture?type=large", "display_name": "Yoav Poni", "link": "https://stackoverflow.com/users/8114996/yoav-poni"}, "edited": false, "score": 0, "creation_date": 1499864003, "post_id": 45057771, "comment_id": 77089784, "body": "And the reason I have this loop, comes from the fact that every refresh, the excel page generate new numbers that make a different calculations.   That is why I wanted to Paste the SpecialValues, and after I run this 10 times the calculations will show up in the other sheet one column next to the other."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 95, "user_id": 8114996, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10154594933403045/picture?type=large", "display_name": "Yoav Poni", "link": "https://stackoverflow.com/users/8114996/yoav-poni"}, "edited": false, "score": 0, "creation_date": 1499866707, "post_id": 45057771, "comment_id": 77091956, "body": "@YoavPoni - I think I got what you want. See the edited answer."}, {"owner": {"reputation": 95, "user_id": 8114996, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10154594933403045/picture?type=large", "display_name": "Yoav Poni", "link": "https://stackoverflow.com/users/8114996/yoav-poni"}, "edited": false, "score": 0, "creation_date": 1499891931, "post_id": 45057771, "comment_id": 77107476, "body": "Thank you so much! @Vityata"}, {"owner": {"reputation": 95, "user_id": 8114996, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10154594933403045/picture?type=large", "display_name": "Yoav Poni", "link": "https://stackoverflow.com/users/8114996/yoav-poni"}, "edited": false, "score": 0, "creation_date": 1499961873, "post_id": 45057771, "comment_id": 77144176, "body": "is there a reason for the Excel file to go wrong when the I execute the Macro?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 95, "user_id": 8114996, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10154594933403045/picture?type=large", "display_name": "Yoav Poni", "link": "https://stackoverflow.com/users/8114996/yoav-poni"}, "edited": false, "score": 0, "creation_date": 1499962313, "post_id": 45057771, "comment_id": 77144467, "body": "@YoavPoni - idk, if it goes wrong there should be a reason for this... E.g. Worksheets are protected, there are other macros or anything else..."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1499865186, "last_edit_date": 1499865186, "creation_date": 1499862666, "answer_id": 45057771, "question_id": 45057378, "link": "https://stackoverflow.com/questions/45057378/for-loop-copy-and-paste-excel-vba/45057771#45057771", "title": "For Loop Copy and Paste Excel VBA", "body": "<p>I have tried the following:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Iterate()\n\n    Dim i As Long\n\n    For i = 1 To 10\n        Worksheets(1).Calculate\n        Worksheets(1).Range(\"AC6:AC16\").Copy Destination:=Worksheets(2).Range(\"A1:A10\")\n        Worksheets(1).Range(\"AT10:AT11\").Copy Destination:=Worksheets(2).Range(\"A11:A12\")\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>It works, just make sure that you rename the Worksheets(1) and (2) relevantly. In general, use <code>Function</code>, when you expect a value to be returned. For changes in a worksheet, use <code>Sub</code>.</p>\n\n<p>In general, what you wanted in the comments is to copy the values and to put them next to each other column. Here is how to get it:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Iterate()\n\n    Dim i As Long\n\n    For i = 1 To 10\n        With Worksheets(1)\n\n        Worksheets(2).Calculate\n\n        Worksheets(2).Range(\"AC6:AC16\").Copy\n        .Cells(1, i).PasteSpecial Paste:=xlPasteValues\n\n        Worksheets(2).Range(\"AT10:AT11\").Copy\n        .Cells(1, i + 10).PasteSpecial Paste:=xlPasteValues\n\n        Application.CutCopyMode = False\n        End With\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 8114996, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10154594933403045/picture?type=large", "display_name": "Yoav Poni", "link": "https://stackoverflow.com/users/8114996/yoav-poni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1348, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499865186, "creation_date": 1499861519, "last_edit_date": 1499862509, "question_id": 45057378, "link": "https://stackoverflow.com/questions/45057378/for-loop-copy-and-paste-excel-vba", "title": "For Loop Copy and Paste Excel VBA", "body": "<pre><code>Function Iterate()\nDim i As Integer\nFor i = 1 To 10\nWorksheets(\"Calculator\").Calculate\nWorksheets(\"Calculator\").Range(\"AC6:AC16\").Copy  Destination:=Sheets(\"Iterations\").Range(\"A1:A10\")\nWorksheets(\"Calculator\").Range(\"AT10:AT11\").Copy Destination:=Sheets(\"Iterationas\").Range(\"A11:A12\")\n                         Worksheets(\"Iterations\").Paste\n\nNext\n\nEnd Function\n</code></pre>\n\n<p>My Goal, is to run this loop as many times as I'll need, and after every single loop, I want excel to take the Range(\"cells\") and copy them to the \"Iterations\" worksheet.</p>\n\n<p>The data on Calculator is refreshed every loop, so new calculations appear. Once the new calculations appear, I want to paste it one next to the other (which I don't know how to do). </p>\n\n<p>For now, this gives me a runtime error Subscript it out of range</p>\n\n<p>Any advice? </p>\n"}, {"tags": ["vba", "ms-word", "copy", "rows"], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1499862415, "creation_date": 1499862415, "answer_id": 45057685, "question_id": 45057063, "link": "https://stackoverflow.com/questions/45057063/how-can-i-exchange-rows-in-word-for-all-tables/45057685#45057685", "title": "How can I exchange rows in Word for all tables?", "body": "<p>I've not done <s>a lot</s> any work in Word in ages, but give this a shot</p>\n\n<pre><code>Sub Sample() \n\n  Dim tbl As Table\n\n  For Each tbl in ActiveDocument.tables\n    tbl.Rows(12).Range.Copy\n    tbl.Rows(14).Range.Paste\n  Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8295548, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212855822846952/picture?type=large", "display_name": "Cenk Oran", "link": "https://stackoverflow.com/users/8295548/cenk-oran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593903829, "creation_date": 1499860631, "last_edit_date": 1593903829, "question_id": 45057063, "link": "https://stackoverflow.com/questions/45057063/how-can-i-exchange-rows-in-word-for-all-tables", "title": "How can I exchange rows in Word for all tables?", "body": "<p>I have 290 tables which have 14 rows for every table. I want to move row 12 to below row 13. Do you have any idea with macros?</p>\n\n<p>I tried copy it and delete duplicate ones, it works but I need it for 290 tables so I need a loop in VBA.</p>\n\n<pre><code>Sub Sample()\n    Dim tbl As Table\n    Set tbl = ActiveDocument.Tables(1)\n    tbl.Rows(12).Range.Copy\n    tbl.Rows(14).Range.Paste\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "powerpoint", "vba"], "answers": [{"comments": [{"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1499868940, "post_id": 45060118, "comment_id": 77093681, "body": "@A.S.H - I just realized your deleted answer is essentially the same.  Un-delete yours and I&#39;ll remove mine &amp; plus 1"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499921358, "post_id": 45060118, "comment_id": 77115788, "body": "Hi, never mind. I deleted my answer because I smelled some &quot;XY pattern&quot; in the question (see comments below my deleted answer). However I&#39;m glad to know that the OP found it helpful, for the least it takes them one step ahead. :)"}], "tags": [], "owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "is_accepted": false, "score": 1, "last_activity_date": 1499868723, "creation_date": 1499868723, "answer_id": 45060118, "question_id": 45056880, "link": "https://stackoverflow.com/questions/45056880/excel-vba-to-update-powerpoint-text-box/45060118#45060118", "title": "Excel VBA to update powerpoint text box", "body": "<p>Error is taking place on the <code>Set tb</code> line because you never initialize <code>newslide</code>, or at least you don't show it here.</p>\n\n<p>Assuming your text box is on slide one you can do something like the following (add before <code>Set tb</code>):</p>\n\n<pre><code>Set newslide = pres.Slides(1)\n</code></pre>\n\n<hr>\n\n<p>Also make sure the text box you want is actually \"TextBox1\".  By default the names usually have a space before the number like \"TextBox 1\".</p>\n\n<p>I tested your code with this change to verify it works.  Full code here:</p>\n\n<pre><code>Sub test()\n    Dim PPT As PowerPoint.Application\n    Dim pres As PowerPoint.Presentation\n    Dim newslide As PowerPoint.Slide\n    Dim slideCtr As Integer\n    Dim tb As PowerPoint.Shape\n\n    Set PPT = CreateObject(\"PowerPoint.Application\")\n    PPT.Visible = True\n    Set pres = PPT.Presentations.Open( _\n        \"C:\\Users\\GShaikh\\Desktop\\Process Coach certificate template.pptx\")\n    slideCtr = 1\n\n    Set newslide = pres.Slides(1)\n\n    Set tb = newslide.Shapes(\"TextBox1\")\n    tb.TextFrame2.TextRange.Characters.Text = \"OK\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 159, "user_id": 5179321, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ec2c077f8c8bcb3d8313897477a568c?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/5179321/gaus-shaikh"}, "edited": false, "score": 0, "creation_date": 1499871822, "post_id": 45061164, "comment_id": 77095971, "body": "Thanks. Its really helpful"}], "tags": [], "owner": {"reputation": 21, "user_id": 6527305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5jODG.jpg?s=128&g=1", "display_name": "KISS Excel VBA", "link": "https://stackoverflow.com/users/6527305/kiss-excel-vba"}, "is_accepted": false, "score": 1, "last_activity_date": 1499871296, "creation_date": 1499871296, "answer_id": 45061164, "question_id": 45056880, "link": "https://stackoverflow.com/questions/45056880/excel-vba-to-update-powerpoint-text-box/45061164#45061164", "title": "Excel VBA to update powerpoint text box", "body": "<p>Try:</p>\n\n<pre><code>    PPT.ActivePresentation.Slides(2).Shapes(\"TextBox1\").TextFrame.TextRange.Characters.Text = \"qwerty\"\n</code></pre>\n\n<p>To get the name of the shape just right (in an input box so that you can copy it), select it and run:</p>\n\n<pre><code>a = InputBox(\"The name of the selected shape is:\", \"Name of the Shape\", PPT.ActiveWindow.Selection.ShapeRange.Name)\n</code></pre>\n\n<p>to change it, while you have it selected, try:</p>\n\n<pre><code>PPT.ActiveWindow.Selection.ShapeRange.Name = \"TextBox2\"\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 159, "user_id": 5179321, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ec2c077f8c8bcb3d8313897477a568c?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/5179321/gaus-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7007, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1499871296, "creation_date": 1499860103, "last_edit_date": 1531164843, "question_id": 45056880, "link": "https://stackoverflow.com/questions/45056880/excel-vba-to-update-powerpoint-text-box", "title": "Excel VBA to update powerpoint text box", "body": "<p>With the help of below coding, I am able to open the powerpoint file but it is not updating the textbox.</p>\n\n<p>I am getting an error as \"Object variable or with block variable not set\". </p>\n\n<pre><code>Dim PPT As PowerPoint.Application\nDim pres As PowerPoint.Presentation\nDim newslide As PowerPoint.Slide\nDim slideCtr As Integer\nDim tb As PowerPoint.Shape\n\nSet PPT = CreateObject(\"PowerPoint.Application\")\nPPT.Visible = True\nSet pres = PPT.Presentations.Open( _\n    \"C:\\Users\\GShaikh\\Desktop\\Process Coach certificate template.pptx\")\nslideCtr = 1\nSet tb = newslide.Shapes(\"TextBox1\")\ntb.TextFrame2.TextRange.Characters.Text = \"OK\"\n</code></pre>\n"}, {"tags": ["ms-access", "ms-word", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1499860378, "post_id": 45056780, "comment_id": 77086904, "body": "Things to check: 1) if you open the query in datasheet view, is the text for the affected records shown correctly? 2) add <code>Debug.Print flds</code> after setting it, and check the output in the Direct window (Ctrl+G)."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1499860438, "post_id": 45056780, "comment_id": 77086955, "body": "And: what datatype is <code>flds</code>? Should be String"}, {"owner": {"reputation": 389, "user_id": 1625076, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fRfxc.png?s=128&g=1", "display_name": "dellair", "link": "https://stackoverflow.com/users/1625076/dellair"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1499945389, "post_id": 45056780, "comment_id": 77130893, "body": "The type of flds is string. I did the Debug.Print, and found that the string was truncated by &quot;Set results = qdf.OpenRecordset()&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 389, "user_id": 1625076, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fRfxc.png?s=128&g=1", "display_name": "dellair", "link": "https://stackoverflow.com/users/1625076/dellair"}, "edited": false, "score": 1, "creation_date": 1499951393, "post_id": 45057493, "comment_id": 77135852, "body": "Yes, I hit this bug &#39;Concatenated fields yield garbage in recordset&#39; <a href=\"http://allenbrowne.com/bug-16.html\" rel=\"nofollow noreferrer\">allenbrowne.com/bug-16.html</a>. It works with the &#39;union all StructureOnly table&#39; work around. Thank you very much!"}], "tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": true, "score": 1, "last_activity_date": 1499861831, "creation_date": 1499861831, "answer_id": 45057493, "question_id": 45056780, "link": "https://stackoverflow.com/questions/45056780/access-query-recordset-result-output-to-word-shows-special-characters/45057493#45057493", "title": "Access query recordset result output to word shows special characters", "body": "<p>I think they are being truncated or corrupted almost certainly to do with one of the reasons listed here : <a href=\"http://allenbrowne.com/ser-63.html\" rel=\"nofollow noreferrer\">http://allenbrowne.com/ser-63.html</a></p>\n\n<p>By definition if they are over 255 character long they will be interpreted as Memo or Long text (Same definition - Memo is the older name of the data type).</p>\n"}], "owner": {"reputation": 389, "user_id": 1625076, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fRfxc.png?s=128&g=1", "display_name": "dellair", "link": "https://stackoverflow.com/users/1625076/dellair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 45057493, "answer_count": 1, "score": 0, "last_activity_date": 1499861831, "creation_date": 1499859887, "question_id": 45056780, "link": "https://stackoverflow.com/questions/45056780/access-query-recordset-result-output-to-word-shows-special-characters", "title": "Access query recordset result output to word shows special characters", "body": "<p>Problem Description:\nI am using Microsoft Access Plus 2010, with below code to export the result of query to Word table. However, there are all kinds of special characters exported if the record is over 255 characters.</p>\n\n<p>Below are the query, VBA etc.</p>\n\n<p><strong>Query name</strong>: Qa</p>\n\n<p><strong>Query function</strong>: select field from Ta</p>\n\n<p><strong>VBA</strong>:</p>\n\n<pre><code>Dim qbf As QueryDef\nDim dabase As Database\nSet dabase = CurrentDb\nSet qdf = dbase.QueryDefs(Qa)\nDim results As Recordset\nDim flds As String\nSet results = qdf.OpenRecordset()\nWhile (Not results.EOF)\n    doc.addRecord results\n    results.MoveNext\nWend\nqdf.Close\n\nPublic Sub addRecord(pubRecordSet As Recordset)\nflds = pubRecordSet.Fields(\"fieldname\")\n    mTable.cell(1, 1).range.InsertAfter (flds)\n...\nEnd Sub\n</code></pre>\n\n<p>Where 'mTable' is a Word table object, 'fieldname' is the name of the field to be exported to Word Table.\nThis VBA in general works fine when the length of flds is less than 255, however, it throws a lot of special characters in the Table cell if the length exceeds 255.</p>\n\n<p>Example on special characters exported to Word table cell:</p>\n\n<pre><code> \u9000D\ue40c\u77bb\uaed9\u76bf  \u01ac\" \"  \u1b08\u0be9H\u0237\u2ad7 \u92e8D\uee58\u0add\uee73\u0add\uff68\u0be8\ue40c\u77bb\uaee5\u76bf\uf19c\u0bf2\u01ec\" \"T\u0cd5 \u016e\u0531 \u0fe8\u0e0b\u940cD\n</code></pre>\n\n<p>I checked the limitation of MS Access from <a href=\"http://www.databasezone.com/techdocs/acclimit.html\" rel=\"nofollow noreferrer\">link here</a>. It mentions the recordset of query is 1GB, which my data is way less (~255 characters). Any help is appreciated.</p>\n"}, {"tags": ["vba", "excel", "audio"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1499858426, "post_id": 45056115, "comment_id": 77085514, "body": "What line is the error? <code>(ByVal lpszName As String, _   ByVal hModule As Long, ByVal dwFlags As Long)</code> looks like you&#39;re missing one of the 3 args in this function ?"}, {"owner": {"reputation": 364, "user_id": 2258480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f90cbd7755932f6a59bce3c52051628a?s=128&d=identicon&r=PG&f=1", "display_name": "Kalaschnik", "link": "https://stackoverflow.com/users/2258480/kalaschnik"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1499859862, "post_id": 45056115, "comment_id": 77086505, "body": "@Nathan_Sav, I know I played a bit with sndPlaySound32(x,x,x). But actually I was coming from that file provided here:  <a href=\"https://stackoverflow.com/questions/9443801/how-to-play-a-wave-file-or-sound-file-using-vba\" title=\"how to play a wave file or sound file using vba\">stackoverflow.com/questions/9443801/&hellip;</a>  I only added the 64 bit condition in the beginning..."}], "answers": [{"comments": [{"owner": {"reputation": 364, "user_id": 2258480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f90cbd7755932f6a59bce3c52051628a?s=128&d=identicon&r=PG&f=1", "display_name": "Kalaschnik", "link": "https://stackoverflow.com/users/2258480/kalaschnik"}, "edited": false, "score": 0, "creation_date": 1499862264, "post_id": 45057019, "comment_id": 77088454, "body": "This works now. Just change the line chime.wav to chimes.wav otherwise it wont find the file. Thank you!"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 1, "last_activity_date": 1499862408, "last_edit_date": 1499862408, "creation_date": 1499860499, "answer_id": 45057019, "question_id": 45056115, "link": "https://stackoverflow.com/questions/45056115/play-sound-in-excel-depending-on-value-with-a-button/45057019#45057019", "title": "Play Sound in Excel depending on value with a button", "body": "<p>The error is caused because you are calling the function with 2 arguments when the function expects 3. If you want to call <code>sndPlaySound32</code> like this</p>\n\n<pre><code>sndPlaySound32 WhatSound, 0&amp;    ' Finally, play the sound.\n</code></pre>\n\n<p>Then you need you need to change the function signatures to have just the 2 arguments per the question you <a href=\"https://stackoverflow.com/questions/9443801/how-to-play-a-wave-file-or-sound-file-using-vba\">referenced</a> - like this:</p>\n\n<pre><code>#If VBA7 Then\nPublic Declare PtrSafe Function sndPlaySound32 Lib \"winmm.dll\" _\n  Alias \"sndPlaySoundA\" (ByVal lpszName As String, ByVal dwFlags As Long) As Long\n#Else\nPublic Declare Function sndPlaySound32 Lib \"winmm.dll\" _\n  Alias \"sndPlaySoundA\" (ByVal lpszName As String, ByVal dwFlags As Long) As Long\n#End If\n</code></pre>\n\n<p>So the full working code is:</p>\n\n<pre><code>Option Explicit\n\n#If VBA7 Then\nPublic Declare PtrSafe Function sndPlaySound32 Lib \"winmm.dll\" _\n  Alias \"sndPlaySoundA\" (ByVal lpszName As String, ByVal dwFlags As Long) As Long\n#Else\nPublic Declare Function sndPlaySound32 Lib \"winmm.dll\" _\n  Alias \"sndPlaySoundA\" (ByVal lpszName As String, ByVal dwFlags As Long) As Long\n#End If\n\nSub PlayTheSound(ByVal WhatSound As String)\n    If Dir(WhatSound, vbNormal) = \"\" Then\n        ' WhatSound is not a file. Get the file named by\n        ' WhatSound from the Windows\\Media directory.\n        WhatSound = Environ(\"SystemRoot\") &amp; \"\\Media\\\" &amp; WhatSound\n        If InStr(1, WhatSound, \".\") = 0 Then\n            ' if WhatSound does not have a .wav extension,\n            ' add one.\n            WhatSound = WhatSound &amp; \".wav\"\n        End If\n        If Dir(WhatSound, vbNormal) = vbNullString Then\n            Beep            ' Can't find the file. Do a simple Beep.\n            Exit Sub\n        End If\n    Else\n        ' WhatSound is a file. Use it.\n    End If\n\n    sndPlaySound32 WhatSound, 0&amp;    ' Finally, play the sound.\nEnd Sub\n\nSub PlayIt()\n    Select Case Range(\"A1\").Value\n        Case \"Hello\"\n            PlayTheSound \"chimes.wav\"\n            'PlayTheSound \"chime.wav\"\n        'Case \"World\"\n            'PlayTheSound \"chord.wav\"\n        'Case 1\n            'PlayTheSound \"tada.wav\"\n    End Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 364, "user_id": 2258480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f90cbd7755932f6a59bce3c52051628a?s=128&d=identicon&r=PG&f=1", "display_name": "Kalaschnik", "link": "https://stackoverflow.com/users/2258480/kalaschnik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1729, "favorite_count": 0, "accepted_answer_id": 45057019, "answer_count": 1, "score": 1, "last_activity_date": 1499862408, "creation_date": 1499858032, "last_edit_date": 1499858343, "question_id": 45056115, "link": "https://stackoverflow.com/questions/45056115/play-sound-in-excel-depending-on-value-with-a-button", "title": "Play Sound in Excel depending on value with a button", "body": "<p>VBA is not my strength, yet I would like to get a Excel sheet where A1 might contain the word \"Hello\" or \"World\" or the number 1, and depending on that content a sound file should be played when clicking a button that is next to it. The wav files are located in a specific subfolder where the excel file is.</p>\n\n<p>I\u2019m using Excel (64 bit) version. I was already checking this page:\n<a href=\"https://stackoverflow.com/questions/9443801/how-to-play-a-wave-file-or-sound-file-using-vba\">How to play a wave file or sound file using VBA</a></p>\n\n<p>And tried the following (64 bit compatible):</p>\n\n<pre><code>Option Explicit\n#If VBA7 Then\nPublic Declare PtrSafe Function sndPlaySound32 Lib \"winmm.dll\" _\n  Alias \"sndPlaySoundA\" (ByVal lpszName As String, _\n  ByVal hModule As Long, ByVal dwFlags As Long) As Long\n#Else\nPublic Declare Function sndPlaySound32 Lib \"winmm.dll\" _\n  Alias \"sndPlaySoundA\" (ByVal lpszName As String, _\n  ByVal hModule As Long, ByVal dwFlags As Long) As Long\n#End If\n\nSub PlayTheSound(ByVal WhatSound As String)\n    If Dir(WhatSound, vbNormal) = \"\" Then\n        ' WhatSound is not a file. Get the file named by\n        ' WhatSound from the Windows\\Media directory.\n        WhatSound = Environ(\"SystemRoot\") &amp; \"\\Media\\\" &amp; WhatSound\n        If InStr(1, WhatSound, \".\") = 0 Then\n            ' if WhatSound does not have a .wav extension,\n            ' add one.\n            WhatSound = WhatSound &amp; \".wav\"\n        End If\n        If Dir(WhatSound, vbNormal) = vbNullString Then\n            Beep            ' Can't find the file. Do a simple Beep.\n            Exit Sub\n        End If\n    Else\n        ' WhatSound is a file. Use it.\n    End If\n\n    sndPlaySound32 WhatSound, 0&amp;    ' Finally, play the sound.\nEnd Sub\n\nSub PlayIt()\n    Select Case Range(\"A1\").Value\n        Case \"Hello\"\n            PlayTheSound \"chimes.wav\"\n        Case \"World\"\n            PlayTheSound \"chord.wav\"\n        Case 1\n            PlayTheSound \"tada.wav\"\n    End Select\nEnd Sub\n</code></pre>\n\n<p>Yet, I get an error</p>\n\n<blockquote>\n  <p>Argument not optional</p>\n</blockquote>\n\n<p>Can anyone help me with that?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1499860022, "post_id": 45055996, "comment_id": 77086638, "body": "Please read this: <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> - and consider reducing the amount of code in your question to just the issue you are dealing with."}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1499860506, "post_id": 45055996, "comment_id": 77087017, "body": "@Robin Mackenzie, I have updated the code, I hope it is within the guidelines a little better now"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1499860598, "post_id": 45055996, "comment_id": 77087098, "body": "That&#39;s a lot more readable - I note you haven&#39;t assigned a value to <code>strFile</code> - are you missing something like <code>strFile = &quot;YourFile.foo&quot;</code> ?"}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1499860802, "post_id": 45055996, "comment_id": 77087249, "body": "@Robin Mackenzie The value is of strFile is picked up in the first sub routine as part of the Save As for the initial text file that is created but when it is picked up in the second routine it disappears..."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1499861653, "post_id": 45055996, "comment_id": 77087953, "body": "Maybe you want to be passing the <code>strFile</code> variable to <code>AltText_V2</code> i.e. <code>Sub AltText_V2(strFile As String)</code> and then get rid of the <code>Dim strFile As String</code> declaration."}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1499864509, "post_id": 45055996, "comment_id": 77090202, "body": "@Robin Mackenzie that makes sense, although do I need to change the call name as I get a compile error on the call when I try and execute this now..."}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "is_accepted": true, "score": 0, "last_activity_date": 1499866014, "creation_date": 1499866014, "answer_id": 45059020, "question_id": 45055996, "link": "https://stackoverflow.com/questions/45055996/path-file-access-error-runtime-75-vba/45059020#45059020", "title": "Path/File Access error Runtime 75 - VBA", "body": "<p>I have actually worked it out. I simply declared the variable outside of the sub routine and it worked a treat so it looked like this.</p>\n\n<pre><code> Option Explicit\n Dim strFile As String\n\n Public Sub OneRoutine()\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1107, "favorite_count": 0, "accepted_answer_id": 45059020, "answer_count": 1, "score": 0, "last_activity_date": 1499866014, "creation_date": 1499857718, "last_edit_date": 1499860435, "question_id": 45055996, "link": "https://stackoverflow.com/questions/45055996/path-file-access-error-runtime-75-vba", "title": "Path/File Access error Runtime 75 - VBA", "body": "<p>This is the continuation of a previous issue that I was helped with. I have attempted to combine 2 sub routines so that the text files which are created have the white spaces removed at the end. Looking at the code below I get a path file error on the line -\n     Open inFile For Input As #1</p>\n\n<p>Having debugged I can see that the file name stored in strFile disappears when the second routine is called. Can anyone see where my error is why it is doing this and help me fix it please? AltText_V2 is the second routine. I have updated the code to just include the part where the issue is</p>\n\n<pre><code> Option Explicit\n\n  Public Sub AltText_V2()\n  Dim inFile As String\n  Dim outFile As String\n  Dim data As String\n  Dim strFile As String\n\n  'Ensures that the file open directory is always the same\n  ChDir \"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\"\n\n 'inFile = Application.GetOpenFilename\n  inFile = strFile\n  Open inFile For Input As #1\n\n  outFile = inFile &amp; \".txt\"\n  Open outFile For Output As #2\n\n  Do Until EOF(1)\n  Line Input #1, data\n\n  If Trim(data) &lt;&gt; \"\" Then\n     Print #2, data\n  End If\n  Loop\n\n  Close #1\n  Close #2\n\n  Kill inFile\n  Name outFile As inFile\n\n  MsgBox \"File alteration completed!\"\n  End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1499857653, "post_id": 45055705, "comment_id": 77085002, "body": "Go trough the code with <code>F8</code> and look what it does."}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1499857768, "post_id": 45055705, "comment_id": 77085079, "body": "@UGP I know what it does, the Problem is just for the particular one row, the ID from the comment is not extracted"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1499857843, "post_id": 45055705, "comment_id": 77085133, "body": "With <code>F8</code> you can go trough the code line by line. Hover over the variable or add them to the watch window and you can see the values."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499857896, "post_id": 45055705, "comment_id": 77085165, "body": "<b>Code is working fine for me</b>. Insead of <code>Rows.Count</code> you could use <code>Cells(Rows.Count, &quot;H&quot;).End(xlUp).Row</code>, though this will not solve your problem."}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1499858116, "post_id": 45055705, "comment_id": 77085337, "body": "@UGP, Thank yu for the clue,  I found only in that, after the ID immedietly i have an comma ,  I believe,because of this it is not taking that ID alone."}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499858181, "post_id": 45055705, "comment_id": 77085365, "body": "@Mrig the code is working fine. But now i realised that i have comma end of the id and so, it dint extract the ID. Could you suggest how i can overcome this ?"}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499858407, "post_id": 45055705, "comment_id": 77085497, "body": "@Mrig in the comment it is like, Remarks ID is I2G34586200, good . because of , at the end it dint extract the ID from this particular row. How can I overcome this ?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1499858425, "post_id": 45055705, "comment_id": 77085512, "body": "Yes because of <code>&quot;I5G*?#&quot;</code> the <code>#</code> says it has to end on a number, with the comma it does not fufill the requirements. See <a href=\"https://msdn.microsoft.com/en-us/library/ee440632(v=office.12).aspx\" rel=\"nofollow noreferrer\">this</a> for more informations about wildcars."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499858696, "post_id": 45055705, "comment_id": 77085675, "body": "Is there any other scenario that could cause the condition to fail? If there are other scenarios as well then code can be made more generic fulfilling all requirements."}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499858796, "post_id": 45055705, "comment_id": 77085748, "body": "@Mrig i will make an keen Observation and let you know in couple of minutes"}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1499859201, "post_id": 45055705, "comment_id": 77086014, "body": "@Mrig, Just the , is the additional criteria. the rest are perfect ."}], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1499859788, "post_id": 45056640, "comment_id": 77086449, "body": "the code is not working Mrig. IT just extracted one ID from the sentence"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1499859854, "post_id": 45056640, "comment_id": 77086497, "body": "@Jenny - Its <code>i = 5 To Cells(Rows.Count, &quot;H&quot;).End(xlUp).Row</code> and not <code>i = 5 To 10</code>. I edited code now."}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1499860051, "post_id": 45056640, "comment_id": 77086659, "body": "the earlier code, was working in such a way that, anywhere in the column H it finds an ID it was etracting them to the column M. The Id were between the sentence or start of the sentence. The ID is 11 to 13 Digit Long. With this it was working fine. In one row, there is an ID which is 12 Digit Long and , after that. Because of this condition, it failed in this case."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1499860229, "post_id": 45056640, "comment_id": 77086792, "body": "@Jenny - 12 digit long id followed by a <code>,</code> makes length of id to 13 digit which should be true for <code>strLength &lt;= 13</code>, so should not be a problem. Else try <code>strLength &lt;= 14</code>"}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1499860274, "post_id": 45056640, "comment_id": 77086818, "body": "Thank you Mrig, ist working great. I dint notice the for Statement.sorry. but why does it take an ID something like this , I5Gxxxxxxx ? I dont want this from my comment. the ealier code was not recognising this"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1499860389, "post_id": 45056640, "comment_id": 77086912, "body": "@Jenny - You&#39;ll have to share <code>ID&#39;s</code> where its failing condition."}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1499860450, "post_id": 45056640, "comment_id": 77086969, "body": "Also, for some reason, I dint recognise this ID as well I5G1115630100"}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1499860510, "post_id": 45056640, "comment_id": 77087023, "body": "you want me to post an Image of it  ? for failing condition ?"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1499860586, "post_id": 45056640, "comment_id": 77087082, "body": "@Jenny - Will be better."}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1499860950, "post_id": 45056640, "comment_id": 77087362, "body": "the comment is like I5Gxxxxxxx Remark - Mandatory, and in the result i got   I5Gxxxxxxx, Which i dont Need to have."}, {"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1499860987, "post_id": 45056640, "comment_id": 77087388, "body": "@ the rest are perfect. No issues now. Just this has failed"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1499861205, "post_id": 45056640, "comment_id": 77087572, "body": "@Jenny - <code>I5Gxxxxxxx</code> works well for me. See image I&#39;ve added in answer."}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 0, "last_activity_date": 1499861294, "last_edit_date": 1499861294, "creation_date": 1499859490, "answer_id": 45056640, "question_id": 45055705, "link": "https://stackoverflow.com/questions/45055705/error-in-extracting-id-from-sentence-to-another/45056640#45056640", "title": "Error in extracting id from sentence to another", "body": "<blockquote>\n  <p>Just the , is the additional criteria. the rest are perfect</p>\n</blockquote>\n\n<p>Below code should handle <code>,</code> at the end of <code>ID 's</code> assuming that there is just one trailing <code>,</code> after <code>ID 's</code></p>\n\n<pre><code>Sub Cmt()\n    Dim strLength As Integer\n    Dim AllWords, Item\n    Dim i As Long\n    For i = 5 To Cells(Rows.Count, \"H\").End(xlUp).Row\n        AllWords = Split(Cells(i, 8).Value, \" \")\n        For Each Item In AllWords\n            strLength = Len(Item)\n            If strLength &gt; 0 And strLength &lt;= 13 And Item Like \"I5G*?#\" Then\n                Cells(i, 13) = Item\n            ElseIf strLength &gt; 0 And strLength &lt;= 14 And Item Like \"I5G*?#,\" Then\n                Cells(i, 13) = Left(Item, strLength - 1)\n            End If\n        Next\n    Next i\nEnd Sub\n</code></pre>\n\n<p>See image for reference.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hhXSf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hhXSf.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 45056640, "answer_count": 1, "score": 0, "last_activity_date": 1499861294, "creation_date": 1499856946, "question_id": 45055705, "link": "https://stackoverflow.com/questions/45055705/error-in-extracting-id-from-sentence-to-another", "title": "Error in extracting id from sentence to another", "body": "<p>I have an sheet with a column H which contains comments. </p>\n\n<p>I am using the below code, to extract my ID from the comment. </p>\n\n<p>This is successfuly working in almost all the cases. </p>\n\n<p>I dont know, why for a particular row, the extraction is not working.</p>\n\n<p>Could anyone have a look at my code and suggest where i am going wrong. </p>\n\n<p>I have attached an Image which Shows the similar result. </p>\n\n<p><a href=\"https://i.stack.imgur.com/ZsEnq.png\" rel=\"nofollow noreferrer\">I have added some samples, if you find in row 3,in this particular case, I am not able to extract the ID from Comment.</a></p>\n\n<p>Anylead with this would be helpful .</p>\n\n<p>Below is my code. </p>\n\n<pre><code>Sub Cmt()\nDim strLength As Integer\nDim i As Long\nFor i = 5 To Rows.Count\nDim AllWords As Variant\nAllWords = Split(Cells(i, 8).Value, \" \")\nFor Each Item In AllWords\nstrLength = Len(Item)\nIf strLength &gt; 0 And strLength &lt;= 13 And Item Like \"I5G*?#\" Then\nCells(i, 13) = Item\nEnd If\nNext\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8269703, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zYigKXYCkMc/AAAAAAAAAAI/AAAAAAAAAHM/X3MaLgOBWUY/photo.jpg?sz=128", "display_name": "ekta SINGH", "link": "https://stackoverflow.com/users/8269703/ekta-singh"}, "edited": false, "score": 0, "creation_date": 1500023661, "post_id": 45056795, "comment_id": 77169834, "body": "Thank you so much. It was very helpful"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1499859928, "creation_date": 1499859928, "answer_id": 45056795, "question_id": 45055519, "link": "https://stackoverflow.com/questions/45055519/dynamic-conditions-related-to-radio-buttons-in-excel/45056795#45056795", "title": "Dynamic conditions related to radio buttons in excel", "body": "<p><strong>Use a named range</strong></p>\n\n<p>1 -Select the target cell (i.e. <code>A103</code>) and give it a name in the \"Name Box\" on the top-left of the screen. Suppose you chose the name \"MyTargetName\"</p>\n\n<p>2- Make the control to move with cells.</p>\n\n<pre><code>Right-click the control --&gt; Format control --&gt; Properties --&gt; Move but dont size with cells\n</code></pre>\n\n<p>3- In VBA code, refer to the target cell by its name instead of its address:</p>\n\n<pre><code>Sub OptionButton21_Click()\n  Range(\"MyTargetName\") = \" Not Applicable \"\nEnd Sub\n</code></pre>\n\n<p>This will make the referenced target shift correctly, along with the control, whenever new rows are inserted.</p>\n"}], "owner": {"reputation": 3, "user_id": 8269703, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zYigKXYCkMc/AAAAAAAAAAI/AAAAAAAAAHM/X3MaLgOBWUY/photo.jpg?sz=128", "display_name": "ekta SINGH", "link": "https://stackoverflow.com/users/8269703/ekta-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "accepted_answer_id": 45056795, "answer_count": 1, "score": 0, "last_activity_date": 1499859928, "creation_date": 1499856380, "last_edit_date": 1499859222, "question_id": 45055519, "link": "https://stackoverflow.com/questions/45055519/dynamic-conditions-related-to-radio-buttons-in-excel", "title": "Dynamic conditions related to radio buttons in excel", "body": "<p>How to make the conditions of radio button dynamic? for eg. if i have one radio button \"yes\" in A100 and the condition related to it is appearing in A103. And,  if i am inserting the row i want both(button and its value) to get shifted accordingly . </p>\n\n<pre><code>Sub OptionButton21_Click()\n  Range(\"A103\") = \" Not Applicable \"\nEnd Sub\nSub DynamicRange()\n  'Best used when only your target data is on the worksheet\n\n  'Refresh UsedRange (get rid of \"Ghost\" cells)\n   Worksheets(\"Sheet1\").UsedRange\n\n  'Select UsedRange\n  Worksheets(\"Sheet1\").UsedRange.Select\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "db2", "odbc", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3404, "user_id": 2181188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7JwZP.jpg?s=128&g=1", "display_name": "Fandango68", "link": "https://stackoverflow.com/users/2181188/fandango68"}, "is_accepted": false, "score": 0, "last_activity_date": 1530235733, "creation_date": 1530235733, "answer_id": 51093123, "question_id": 45055397, "link": "https://stackoverflow.com/questions/45055397/vba-to-ouput-odbc-connection-to-a-new-worksheet/51093123#51093123", "title": "VBA to ouput odbc connection to a new worksheet", "body": "<p>Run a macro recording of you creating a new worksheet (not workbook yet!), and attaching it to some data from your database/data source. You will end up with something like this...</p>\n\n<pre><code>With ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n    \"ODBC;DSN=xxx;Description=xxxx;UID=xxxx;;APP=Microsoft Office 2016;WSID=xxxx;DATABASE=xxxx;LANGUAGE=us_english\" _\n    , Destination:=Range(\"$A$1\")).QueryTable\n    .CommandType = 0\n    .CommandText = Array(\"SELECT * FROM dbo.myTable\"\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .PreserveColumnInfo = True\n    .ListObject.DisplayName = \"Table_Query_from_SPOT\"\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<p>This should get you the data into either a new or existing worksheet on your current workbook.</p>\n\n<p>Now use something like this to copy/move the data or table into a new workbook...</p>\n\n<pre><code>Sub Sample()\n    Dim wbI As Workbook, wbO As Workbook\n    Dim wsI As Worksheet, wsO As Worksheet\n\n    '~~&gt; Source/Input Workbook\n    Set wbI = ThisWorkbook\n    '~~&gt; Set the relevant sheet from where you want to copy\n    Set wsI = wbI.Sheets(\"Sheet1\")\n\n    '~~&gt; Destination/Output Workbook\n    Set wbO = Workbooks.Add\n\n    With wbO\n        '~~&gt; Set the relevant sheet to where you want to paste\n        Set wsO = wbO.Sheets(\"Sheet1\")\n\n        '~~&gt;. Save the file\n        .SaveAs Filename:=\"C:\\Book2.xls\", FileFormat:=56\n\n        '~~&gt; Copy the range\n        wsI.Range(\"A1:B10\").Copy\n\n        '~~&gt; Paste it in say Cell A1. Change as applicable\n        wsO.Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7679277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f6f3fe6883558976396d4934cc2255a?s=128&d=identicon&r=PG&f=1", "display_name": "dmol", "link": "https://stackoverflow.com/users/7679277/dmol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 446, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530235733, "creation_date": 1499856034, "last_edit_date": 1531164843, "question_id": 45055397, "link": "https://stackoverflow.com/questions/45055397/vba-to-ouput-odbc-connection-to-a-new-worksheet", "title": "VBA to ouput odbc connection to a new worksheet", "body": "<p>I'm working on some vba that will vary an odbc connection string based on selected report and filters in a workbook.  The core of the vba works absolutely fine but now I want to do the following:</p>\n\n<ol>\n<li>Create a new worksheet </li>\n<li>Run the odbc connection (called \"ODBC_RUN_REPORT\" and output the results to a new table in the new worksheet (from cell A2)</li>\n<li>Move the worksheet to a new workbook for saving</li>\n</ol>\n\n<p>My vba is average average at best, so I'm fine with points 1 &amp; 3 but can't figure out part 2 and would appreciate some help.</p>\n\n<p>Here is the code of the vba that works perfectly well when a table already exists, which is linked to the connection string:</p>\n\n<pre><code>Sub ODBC_RUN_REPORT()\n\nThisWorkbook.Activate\nDim jdeSystem As String\nDim jdecorelib As String\nDim jdeUDClib As String\nDim jdeGSClib As String\nDim jdeIBANlib As String\nDim jdeQUERYlib As String\n\nDim odbcConnection As odbcConnection\nDim connection_string As String\n\nDim commandtext1 As String\nDim commandtext2 As String\nDim commandtext3 As String\nDim commandtext4 As String\nDim commandtext5 As String\nDim commandtext6 As String\nDim commandtext7 As String\nDim commandtext8 As String\nDim commandtext9 As String\nDim commandtext10 As String\n\njdeSystem = Range(\"NR_CONSTR_ENV\").Text\njdecorelib = Range(\"NR_CONSTR_CORE_LIB\").Text\njdeUDClib = Range(\"NR_CONSTR_UDC_LIB\").Text\njdeGSClib = Range(\"NR_CONSTR_GSC_LIB\").Text\njdeIBANlib = Range(\"NR_CONSTR_IBAN_LIB\").Text\njdeQUERYlib = Range(\"NR_CONSTR_QUERY_LIB\").Text\n\nconnection_string = \"ODBC;DRIVER={Client Access ODBC Driver (32-bit)};CONNTYPE=2;TRANSLATE=1;NAM=1;QRYSTGLMT=-1;PKG=QGPL/DEFAULT(IBM),2,0,1,0,512;LANGUAGEID=ENU;DFTPKGLIB=QGPL;DBQ=\" + jdecorelib + \" \" + jdeUDClib + \" \" + jdeGSClib + \" \" + jdeIBANlib + \" \" + jdeQUERYlib + \";SYSTEM=\" + jdeSystem + \";\"\n\ncommandtext1 = Range(\"NR_CMD_TXTQ1\").Text\ncommandtext2 = Range(\"NR_CMD_TXTQ2\").Text\ncommandtext3 = Range(\"NR_CMD_TXTQ3\").Text\ncommandtext4 = Range(\"NR_CMD_TXTQ4\").Text\ncommandtext5 = Range(\"NR_CMD_TXTQ5\").Text\ncommandtext6 = Range(\"NR_CMD_TXTQ6\").Text\ncommandtext7 = Range(\"NR_CMD_TXTQ7\").Text\ncommandtext8 = Range(\"NR_CMD_TXTQ8\").Text\ncommandtext9 = Range(\"NR_CMD_TXTQ9\").Text\ncommandtext10 = Range(\"NR_CMD_TXTQ10\").Text\n\nSet odbcConnection = ThisWorkbook.Connections(\"ODBC_RUN_REPORT\").odbcConnection\nodbcConnection.Connection = connection_string\nodbcConnection.CommandText = commandtext1 + commandtext2 + commandtext3 + commandtext4 + commandtext5 + commandtext6 + commandtext7 + commandtext8 + commandtext9 + commandtext10\n\nodbcConnection.Refresh\n</code></pre>\n\n<p>'NOTE - Everything below here is part of the vba code that works but it is not critical to keep for the version that will export to a new workbook.</p>\n\n<pre><code>Sheets(\"USER CONTROL\").Select\nRange(\"D14\").Select\n\nMsgBox \"Report Refresh Complete\"\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "ms-access", "environ"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1499856750, "post_id": 45055153, "comment_id": 77084444, "body": "What debugging have you done, what is the return of folderpath, filename etc what is the error if you get one?  It works for me, what is GetSignature"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1499857945, "post_id": 45055153, "comment_id": 77085204, "body": "<a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">How to debug VBA code</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499888811, "post_id": 45055153, "comment_id": 77105914, "body": "Are you trying to open the file as an Excel &quot;workbook&quot;?  Do you have an Excel <code>Application</code> object defined?"}], "owner": {"reputation": 125, "user_id": 6305016, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ff4741f6586e998b1466f4a42f50f4cb?s=128&d=identicon&r=PG&f=1", "display_name": "gcpreston", "link": "https://stackoverflow.com/users/6305016/gcpreston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499888735, "creation_date": 1499855330, "last_edit_date": 1499888735, "question_id": 45055153, "link": "https://stackoverflow.com/questions/45055153/open-specific-file-with-extension-htm-in-ms-access-with-vba", "title": "Open specific file with extension (.htm) in MS Access with VBA", "body": "<p>I am trying to open a file in Access. I am in the correct folder location but I am unaware of the file name. In this case I would like to open the file with the extension of .htm. I have seen an example of excel but this doesn't seem to work for me:</p>\n\n<pre><code>FolderPath = GetSignature(Environ(\"Userprofile\") &amp; \"\\AppData\\Roaming\\Microsoft\\Signatures\\\")\n\nFileName = Dir(FolderPath &amp; \"*.htm\")\n\nWhile FileName &lt;&gt; \"\"\n    Workbooks.Open FolderPath &amp; FileName\n    FileName = Dir()\nWend\n</code></pre>\n\n<p>Does anyone have any suggestions? Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8295058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73edd90fdc659199dbf2d6252968388f?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelNovice", "link": "https://stackoverflow.com/users/8295058/excelnovice"}, "edited": false, "score": 0, "creation_date": 1499858577, "post_id": 45055305, "comment_id": 77085600, "body": "Thank you for your answer! I&#39;m not sure, I edited my original post with (what I think is) a better explanation of what I want to produce."}, {"owner": {"reputation": 828, "user_id": 3463137, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d7aad3a48a041a71b2f1a731f2555190?s=128&d=identicon&r=PG&f=1", "display_name": "Doomenik", "link": "https://stackoverflow.com/users/3463137/doomenik"}, "reply_to_user": {"reputation": 11, "user_id": 8295058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73edd90fdc659199dbf2d6252968388f?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelNovice", "link": "https://stackoverflow.com/users/8295058/excelnovice"}, "edited": false, "score": 0, "creation_date": 1499858891, "post_id": 45055305, "comment_id": 77085812, "body": "Sry I don&#180;t understand what you want to achieve. Could you add an example like before and after input value."}], "tags": [], "owner": {"reputation": 828, "user_id": 3463137, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d7aad3a48a041a71b2f1a731f2555190?s=128&d=identicon&r=PG&f=1", "display_name": "Doomenik", "link": "https://stackoverflow.com/users/3463137/doomenik"}, "is_accepted": false, "score": 0, "last_activity_date": 1499909069, "last_edit_date": 1499909069, "creation_date": 1499855760, "answer_id": 45055305, "question_id": 45054983, "link": "https://stackoverflow.com/questions/45054983/hiding-or-displaying-columns-and-rows-inside-a-table-not-sheet-in-excel-using/45055305#45055305", "title": "Hiding or displaying columns and rows inside a table (not sheet) in excel using VBA nad input values of a text-based drop down list", "body": "<p>If you want to go trough colums and cells: </p>\n\n<pre><code>For Each col In Range(\"comparator_range\").Columns\n    Debug.Print \"column \" &amp; col.Address\n    For Each cel In col.Cells\n      Debug.Print \"  - cell \" &amp; cel.Address\n    Next cel\nNext col\n</code></pre>\n\n<p>So lets say your range is A1:C5\nThe first for each will run for each column that exists in this range mean A B C</p>\n\n<p>The second for each trough every cell inside of the colum, means A1-A5, B1-B5, C1-C5</p>\n\n<p>Hope this help you already, if you need more informations just tell it. </p>\n"}], "owner": {"reputation": 11, "user_id": 8295058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73edd90fdc659199dbf2d6252968388f?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelNovice", "link": "https://stackoverflow.com/users/8295058/excelnovice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1499909069, "creation_date": 1499854924, "last_edit_date": 1499858518, "question_id": 45054983, "link": "https://stackoverflow.com/questions/45054983/hiding-or-displaying-columns-and-rows-inside-a-table-not-sheet-in-excel-using", "title": "Hiding or displaying columns and rows inside a table (not sheet) in excel using VBA nad input values of a text-based drop down list", "body": "<p>I'm programming a table to display rows based on numeric values in one cell and text values in another (a drop down list). I completed the code for the rows, but can't seem to get my head around the columns.</p>\n\n<p>Edit: What I'm trying to do is display one or two of many columns depending on what input value I have in a dropdown. At the same time as the number of rows displayed are dependent on another cell. E.g. if I have three types of candy, one per column. And in the rows I display how many of said candies I eat per day. I want to display only one of the candies, for x days. How do I code this? The row-part I solved, the column - i need help.</p>\n\n<p>This is my current code, how should I go about solving my predicament?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nApplication.ScreenUpdating = False\n\n\n\nIf Not Intersect(Target, Range(\"Time_horizon\")) Is Nothing Then\n\nTH_row_update\n\nTH_column_update\n\nEnd If\n\nEnd Sub\n\nPublic Sub TH_row_update()\n\nDim cell As Range\n\n\n    For Each cell In Range(\"Time_horizon_Year\")\n        If cell.Value &gt;= ActiveSheet.Range(\"Time_Horizon\") Then\n            cell.EntireRow.Hidden = True\n        ElseIf cell.Value &lt;= ActiveSheet.Range(\"Time_Horizon\") Then\n            cell.EntireRow.Hidden = False\n            End If\n    Next cell\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n\nPublic Sub TH_column_update()\n\nDim cell As Range\n\n\n    For Each cell In Range(\"comparator_range\")\n        If cell.Value = ActiveSheet.Range(\"Combination_comparators\") Then\n            cell.EntireColumn.Hidden = True\n        ElseIf cell.Value &lt;= ActiveSheet.Range(\"Combination_comparators\") Then\n            cell.EntireColumn.Hidden = False\n            End If\n    Next cell\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1499855377, "creation_date": 1499855377, "answer_id": 45055172, "question_id": 45054857, "link": "https://stackoverflow.com/questions/45054857/run-time-error-1004-unable-to-set-line-style-property-of-border-class-in-vba/45055172#45055172", "title": "Run-time error &#39;1004&#39;: Unable to set line style property of border class in VBA", "body": "<p>Try like this:</p>\n\n<p><code>Activesheet.Range(\"A7:A\" &amp; LastRow).Borders.LineStyle = xlContinuous</code></p>\n\n<p>The error probably comes because you are not referring the <code>WorkSheet</code> of the range or because the worksheet is locked.</p>\n"}, {"comments": [{"owner": {"reputation": 3207, "user_id": 1915920, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6be77f4bfa373c33055ada8f3414ae09?s=128&d=identicon&r=PG", "display_name": "Andreas Covidiot", "link": "https://stackoverflow.com/users/1915920/andreas-covidiot"}, "edited": false, "score": 0, "creation_date": 1560422255, "post_id": 51878270, "comment_id": 99735022, "body": "should not be downvoted: it is a very general answer/fix for such problems, but could indeed be the solution"}], "tags": [], "owner": {"reputation": 31, "user_id": 10234612, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8e01813fe7364a6aac2bb2fd142638cf?s=128&d=identicon&r=PG", "display_name": "Thirupathi Reddy", "link": "https://stackoverflow.com/users/10234612/thirupathi-reddy"}, "is_accepted": false, "score": 2, "last_activity_date": 1534426136, "creation_date": 1534426136, "answer_id": 51878270, "question_id": 45054857, "link": "https://stackoverflow.com/questions/45054857/run-time-error-1004-unable-to-set-line-style-property-of-border-class-in-vba/51878270#51878270", "title": "Run-time error &#39;1004&#39;: Unable to set line style property of border class in VBA", "body": "<p>I have faced similar issue many times.\nAll the times the only problem was i needed to unlock the sheet.</p>\n\n<p>Can you check if your worksheets are protected or if your workbook is protected?\nIn that case you need to unlock the Worksheet/Workbook for your code to function properly.</p>\n"}], "owner": {"reputation": 11, "user_id": 3432879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5b794f70b23c8f821254af1dec91aef?s=128&d=identicon&r=PG&f=1", "display_name": "user3432879", "link": "https://stackoverflow.com/users/3432879/user3432879"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2621, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534426136, "creation_date": 1499854571, "last_edit_date": 1531164843, "question_id": 45054857, "link": "https://stackoverflow.com/questions/45054857/run-time-error-1004-unable-to-set-line-style-property-of-border-class-in-vba", "title": "Run-time error &#39;1004&#39;: Unable to set line style property of border class in VBA", "body": "<p>Run-time error '1004': Unable to set line style property of border class in VBA.</p>\n\n<p>while running code for setting the border of range then getting run time error and same code is running successfully on different system.</p>\n\n<p>The code is:</p>\n\n<pre><code>Range(\"A7:A\" &amp; LastRow).Borders.LineStyle = xlContinuous\n</code></pre>\n\n<p>Could you please help?  </p>\n"}, {"tags": ["sql-server", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1499856707, "post_id": 45054674, "comment_id": 77084410, "body": "If you link to the table from access - it will probably show up as an OLE Object."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1499860705, "post_id": 45054674, "comment_id": 77087177, "body": "Try <code>.CreateParameter(&quot;LongDescription&quot;, adVarBinary, adParamOutput)</code>"}, {"owner": {"reputation": 1, "user_id": 8259829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kAk0C.png?s=128&g=1", "display_name": "Kabethy", "link": "https://stackoverflow.com/users/8259829/kabethy"}, "edited": false, "score": 0, "creation_date": 1499863726, "post_id": 45054674, "comment_id": 77089555, "body": "Thanks Gord Thompson I tried adVarBinary =( same error"}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1499868581, "post_id": 45054674, "comment_id": 77093404, "body": "<code>.CreateParameter(&quot;LongDescription&quot;, adVarBinary, adParamOutput, 2147483646)</code> seems to work."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1499933413, "post_id": 45054674, "comment_id": 77122350, "body": "<b>DON&#39;T USE image</b>. It&#39;s deprecated for almost 10 years, the documentation is <i>very explicit about it</i>. Use <code>varbinary(max)</code>. The corresponding parameter type isn&#39;t <code>adBinary</code> either."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8259829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kAk0C.png?s=128&g=1", "display_name": "Kabethy", "link": "https://stackoverflow.com/users/8259829/kabethy"}, "is_accepted": false, "score": 0, "last_activity_date": 1499933212, "creation_date": 1499933212, "answer_id": 45074904, "question_id": 45054674, "link": "https://stackoverflow.com/questions/45054674/image-data-type-in-sql-equivalent-in-vba-to-be-use-in-adodb-createparameter/45074904#45074904", "title": "&quot;image data type&quot; in sql equivalent in vba to be use in ADODB CreateParameter", "body": "<p>Thanks for your answers I decided to do it this way:</p>\n\n<pre><code>Dim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\nrs.Open \"dbo.spselConvertImageTEST\", CurrentProject.Connection\n\nWith rs\n    .MoveFirst\n\n    Do While Not .EOF\n        Me.oleLongDescription = .Fields(\"LongDescription\")                               \n        .MoveNext\n    Loop\nEnd With    \n</code></pre>\n\n<p><strong>Gord Thompson</strong> thanks for your last suggestion too but unfortunately it did not work either I received the following error:</p>\n\n<p>Run-time error '-2147024882(8007000e)\nNo enough storage is available to complete this operation.</p>\n"}], "owner": {"reputation": 1, "user_id": 8259829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kAk0C.png?s=128&g=1", "display_name": "Kabethy", "link": "https://stackoverflow.com/users/8259829/kabethy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 323, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499933212, "creation_date": 1499854070, "question_id": 45054674, "link": "https://stackoverflow.com/questions/45054674/image-data-type-in-sql-equivalent-in-vba-to-be-use-in-adodb-createparameter", "title": "&quot;image data type&quot; in sql equivalent in vba to be use in ADODB CreateParameter", "body": "<p>I am trying to pass an \"image type data\" as a parameter (LongDescription(image,null) as declared in SQL) in my SQL stored procedure like this:</p>\n\n<pre><code>ALTER PROCEDURE [dbo].[spselConvertImageTEST] \n  @ReportedByCountry nvarchar(10) OUTPUT,\n  @ReportId nvarchar(10) OUTPUT,\n  @LongDescription image OUTPUT\n</code></pre>\n\n<p>And I am trying to receive it in access VBA like this:</p>\n\n<pre><code>Dim cmd As ADODB.Command\n\nSet cmd = New ADODB.Command\nWith cmd\n    .ActiveConnection = CurrentProject.Connection\n    .CommandText = \"dbo.spselConvertImageTEST\"\n    .CommandType = adCmdStoredProc\n    .CommandTimeout = 300\n    .Parameters.Append .CreateParameter(\"ReportedByCountry\", adVarChar, adParamOutput, 10)\n    .Parameters.Append .CreateParameter(\"ReportId\", adVarChar, adParamOutput, 10)\n    .Parameters.Append .CreateParameter(\"LongDescription\", adBinary, adParamOutput)\n    .Execute\nEnd With\n</code></pre>\n\n<p>When trying to create the third parameter I receive this error:</p>\n\n<p>Run-time error '3708'\nParameter object is improperly defined. Inconsistent or incomplete information was provided.</p>\n\n<p>Can anybody be so kind as to help me out here, please? </p>\n"}, {"tags": ["vba", "excel", "for-loop", "if-statement"], "answers": [{"tags": [], "owner": {"reputation": 162, "user_id": 6679860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1286143004743762/picture?type=large", "display_name": "Krystian Koz\u0142owski", "link": "https://stackoverflow.com/users/6679860/krystian-koz%c5%82owski"}, "is_accepted": true, "score": 1, "last_activity_date": 1499855057, "creation_date": 1499855057, "answer_id": 45055042, "question_id": 45053840, "link": "https://stackoverflow.com/questions/45053840/find-value-in-different-worksheet/45055042#45055042", "title": "Find value in different worksheet", "body": "<p>Try this:</p>\n\n<pre><code>Sub Last_Week()\n\n\nDim Sheet1 As Worksheet\nSet Sheet1 = Worksheets(\"Sheet1\")\n\nDim Sheet2 As Worksheet\nSet Sheet2 = Worksheets(\"Sheet2\")\n\nDim i As Integer\nFor i = 1 To 1500\n    'search cell A &amp; i from Sheet2 in column A in Sheet1\n    Set cell = Sheet1.Columns(\"A:A\").Find(Sheet2.Cells(i, 1).Value, LookIn:=xlValues)\n\n    If cell Is Nothing Then\n    'do it something\n    Else\n    'do it another thing\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 215, "user_id": 5244615, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ad068c341805464626762aee390d44b4?s=128&d=identicon&r=PG&f=1", "display_name": "Dullspark", "link": "https://stackoverflow.com/users/5244615/dullspark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 45055042, "answer_count": 1, "score": 0, "last_activity_date": 1499855057, "creation_date": 1499851930, "question_id": 45053840, "link": "https://stackoverflow.com/questions/45053840/find-value-in-different-worksheet", "title": "Find value in different worksheet", "body": "<p>I'm trying to write some code that will, for example, select the value in cell A2 in Sheet 2, compare it with the range A:A in Sheet 1, and if it finds the same value, it copies some values from that row in Sheet 1 and pastes them in Sheet 2. Then it looks at cell A3 in Sheet 2 and repeats the process. Then cell A4 in Sheet 2 etc.</p>\n\n<p>I'm lost from here on out. Any ideas?</p>\n\n<pre><code>Sub Last_Week()\n\nDim Sheet2 As Worksheet\nDim Sheet1 As Worksheet\n\nSet Sheet2 = ActiveSheet\nSet Sheet1 = ActiveSheet.Previous\n\nSheet1.Activate\n\nDim i As Integer\nFor i = 1 To 1500\n    Columns(\"A:A\").Select\n    Set cell = Selection.Find(What:=(ACTIVATE WS AND SELECT THE VALUE IN COLUMN A AND ROW I)\n\n    If cell Is Nothing Then\n'do it something\n\n    Else\n'do it another thing\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499860727, "post_id": 45053675, "comment_id": 77087190, "body": "This question is off-topic according to the SO guidelines: <a href=\"https://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a> . In order for us to help, we need to be able to see the code that is causing the issue."}, {"owner": {"reputation": 21, "user_id": 8052781, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155114071166041/picture?type=large", "display_name": "Bharath K. Reddy", "link": "https://stackoverflow.com/users/8052781/bharath-k-reddy"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1499861825, "post_id": 45053675, "comment_id": 77088086, "body": "My apologies - i am new here &amp; should have familiarized with guidelines before posting."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8052781, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155114071166041/picture?type=large", "display_name": "Bharath K. Reddy", "link": "https://stackoverflow.com/users/8052781/bharath-k-reddy"}, "edited": false, "score": 0, "creation_date": 1499859752, "post_id": 45053767, "comment_id": 77086428, "body": "Hi, I am not trying to prevent the excel from being saved. I am trying to get macro from being run from a sharepoint only and no where else."}, {"owner": {"reputation": 3556, "user_id": 5300473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/88eaa2b57410990d33dfa1b9330b77ae?s=128&d=identicon&r=PG", "display_name": "Spitzbueb", "link": "https://stackoverflow.com/users/5300473/spitzbueb"}, "reply_to_user": {"reputation": 21, "user_id": 8052781, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155114071166041/picture?type=large", "display_name": "Bharath K. Reddy", "link": "https://stackoverflow.com/users/8052781/bharath-k-reddy"}, "edited": false, "score": 0, "creation_date": 1499860650, "post_id": 45053767, "comment_id": 77087133, "body": "I edited my answer. I hope I understood what you wanted. I honestly don&#39;t know about Sharepoint but the Path of the Workbook should be an URL from Sharepoint so I think you can check that."}, {"owner": {"reputation": 21, "user_id": 8052781, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155114071166041/picture?type=large", "display_name": "Bharath K. Reddy", "link": "https://stackoverflow.com/users/8052781/bharath-k-reddy"}, "edited": false, "score": 0, "creation_date": 1499861788, "post_id": 45053767, "comment_id": 77088060, "body": "Thanks Wernerson - this answers my question. Much appreciated."}, {"owner": {"reputation": 3556, "user_id": 5300473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/88eaa2b57410990d33dfa1b9330b77ae?s=128&d=identicon&r=PG", "display_name": "Spitzbueb", "link": "https://stackoverflow.com/users/5300473/spitzbueb"}, "reply_to_user": {"reputation": 21, "user_id": 8052781, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155114071166041/picture?type=large", "display_name": "Bharath K. Reddy", "link": "https://stackoverflow.com/users/8052781/bharath-k-reddy"}, "edited": false, "score": 0, "creation_date": 1499862102, "post_id": 45053767, "comment_id": 77088325, "body": "Glad to help. Could you mark the answer as accepted so that others see it worked for you :)"}], "tags": [], "owner": {"reputation": 3556, "user_id": 5300473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/88eaa2b57410990d33dfa1b9330b77ae?s=128&d=identicon&r=PG", "display_name": "Spitzbueb", "link": "https://stackoverflow.com/users/5300473/spitzbueb"}, "is_accepted": true, "score": 0, "last_activity_date": 1499860564, "last_edit_date": 1499860564, "creation_date": 1499851729, "answer_id": 45053767, "question_id": 45053675, "link": "https://stackoverflow.com/questions/45053675/vba-excel-macros-run-only-from-a-location/45053767#45053767", "title": "VBA excel macros: Run only from a location", "body": "<p>You can there display an error message and set the <code>Cancel</code> parameter to true if someone wants to save it to another location.</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nIf Not ThisWorkbook.Path Like \"//sharepoint/path/*\" Then\n    MsgBox \"You can't save the excel\", vbCritical\n    Cancel = True\nEnd if\n\nEnd Sub\n</code></pre>\n\n<p>In the same way you can check in the Workbook_Open function if the Workbook is opened in a correct location:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nIf ThisWorkbook.Path Like \"//sharepoint/path/*\" Then\n    'Do things\nElse\n    'Error message and close\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8052781, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155114071166041/picture?type=large", "display_name": "Bharath K. Reddy", "link": "https://stackoverflow.com/users/8052781/bharath-k-reddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 45053767, "answer_count": 1, "score": 0, "last_activity_date": 1499889162, "creation_date": 1499851480, "last_edit_date": 1499889162, "question_id": 45053675, "link": "https://stackoverflow.com/questions/45053675/vba-excel-macros-run-only-from-a-location", "title": "VBA excel macros: Run only from a location", "body": "<p>I have a few Excel sheets with macros which I want any user to be able to run only from a particular location, in my case a particular sharepoint. \nShould a user \"SaveAs\" the Excel file to any alternative location - he should get an error message. </p>\n\n<p>I am looking for a VBA script to be put in these workbooks to allow me meet my objectives. </p>\n\n<p>Can someone help please?</p>\n"}, {"tags": ["vba", "excel", "with-statement", "select-case"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1499852136, "last_edit_date": 1499852136, "creation_date": 1499851439, "answer_id": 45053661, "question_id": 45053572, "link": "https://stackoverflow.com/questions/45053572/vba-select-case-is-multiple-criteria/45053661#45053661", "title": "VBA Select Case is multiple criteria", "body": "<p>This is a sample Select Case with multiple criteria:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Select Case True        \n        Case 1 = 1 And True \n            Debug.Print 1\n        Case True And 2 = 5\n            Debug.Print 2\n        Case True And 5 = 5 And 6 = 7\n            Debug.Print 3\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>In your case you should simply write your conditions instead of <code>1=1</code> or <code>True</code>. Like this: <code>Case Me.TextBox1.Value = \"Lottery\" and range(\"SalesChannel\").value = \"SMB\"</code> But leave <code>Select Case True</code> on the top.</p>\n"}], "owner": {"reputation": 264, "user_id": 4948368, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/UbYt4.jpg?s=128&g=1", "display_name": "Peter Mogford", "link": "https://stackoverflow.com/users/4948368/peter-mogford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5133, "favorite_count": 0, "accepted_answer_id": 45053661, "answer_count": 1, "score": 1, "last_activity_date": 1518801281, "creation_date": 1499851224, "last_edit_date": 1518801281, "question_id": 45053572, "link": "https://stackoverflow.com/questions/45053572/vba-select-case-is-multiple-criteria", "title": "VBA Select Case is multiple criteria", "body": "<p>I have the following piece of code and would like to modify it a bit. Basically with every <code>case is</code> i want to check a secondary criteria. For example <code>Case is = \"Lottery\"</code> i want to add on <code>AND range(\"SalesChannel\").value = \"SMB\"</code>. i would then like to replicate that for every case is using a different value (not SMB). can this be done?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nWith LoginPassword.TextBox1.Value\nSelect Case Me.TextBox1.Value\n    Case Is = \"Lottery\"\n        LoginPassword.Hide\n        SMB_Login\n        CalculateFinancials\n    Case Is = \"Charity\"\n        LoginPassword.Hide\n        DCS_Login\n        CalculateFinancials\n    Case Is = \"Curfew\"\n        LoginPassword.Hide\n        Campaign_Login\n        CalculateFinancials\n    Case Is = \"Europe\"\n        LoginPassword.Hide\n        Eureka_Login\n        CalculateFinancials\n    Case Is = \"Promo\"\n        LoginPassword.Hide\n        Promo_Login\n        CalculateFinancials\n    Case Is = \"Sundew\"\n        LoginPassword.Hide\n        Loyalty_Login\n        CalculateFinancials\n    Case Is = \"Casino\"\n        LoginPassword.Hide\n        MobilePricing.Hide\n        Range(\"Network\").ClearContents\n    Case Is = \"RedDevil\"\n        HardwareUpdateYesNo\n    Case Is = \"Provision\"\n        LoginPassword.Hide\n        MobilePricing.Hide\n        ProvisioningView\n    Case Else\n        MsgBox \"Password Incorrect!\", vbCritical + vbOKOnly, \"Login Failed!\"\n        TextBox1.Text = \"\"\n        TextBox1.SetFocus\nEnd Select\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 426, "user_id": 6805396, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1202317043165603/picture?type=large", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6805396/vlad"}, "edited": false, "score": 0, "creation_date": 1499851358, "post_id": 45053362, "comment_id": 77080475, "body": "Could you explain a little bit more definitely what IDs need to be equal? As far as I understood we could ignore 0 while comparing IDs, am I right?"}, {"owner": {"reputation": 582, "user_id": 7041246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6721154f2b19b914c7ee561af1db00d?s=128&d=identicon&r=PG&f=1", "display_name": "maxhob17", "link": "https://stackoverflow.com/users/7041246/maxhob17"}, "edited": false, "score": 0, "creation_date": 1499851369, "post_id": 45053362, "comment_id": 77080485, "body": "Hi Mikz, can you explain a bit more what you are expecting to happen when: 1) There is an extra zero in the ID of Sheet 2 and 2) There is a zero less in the ID of Sheet 2. Or is it that the copying functions is removing the zero&#39;s?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 426, "user_id": 6805396, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1202317043165603/picture?type=large", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6805396/vlad"}, "edited": false, "score": 0, "creation_date": 1499852132, "post_id": 45053362, "comment_id": 77081067, "body": "@Vlad the Id in the first column is the ID in sheet1, and ID in second column is ID in sheet2, I am looking for ID in sht1 to match with ID in sht2. in cases, where i have mentioned, they fail and i am not able to match the ID."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 582, "user_id": 7041246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6721154f2b19b914c7ee561af1db00d?s=128&d=identicon&r=PG&f=1", "display_name": "maxhob17", "link": "https://stackoverflow.com/users/7041246/maxhob17"}, "edited": false, "score": 0, "creation_date": 1499852260, "post_id": 45053362, "comment_id": 77081174, "body": "@maxhob17  No, the copying function is not recognising the Zeros. Eventhough the Zeros are less or more in my Sheets, considering the first 11 Digits it should match with each other, and row 4 and 5 are spl case, in this case, also, i want the ID to be matched and displayed in sheet3."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 582, "user_id": 7041246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6721154f2b19b914c7ee561af1db00d?s=128&d=identicon&r=PG&f=1", "display_name": "maxhob17", "link": "https://stackoverflow.com/users/7041246/maxhob17"}, "edited": false, "score": 0, "creation_date": 1499852433, "post_id": 45053362, "comment_id": 77081293, "body": "@maxhob17 is the Explanation clear. ?"}, {"owner": {"reputation": 426, "user_id": 6805396, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1202317043165603/picture?type=large", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6805396/vlad"}, "edited": false, "score": 0, "creation_date": 1499852454, "post_id": 45053362, "comment_id": 77081315, "body": "@Mikz But they are not the same. You said, &#39;In the second row there is an 0 less in my sheet2&#39;, &#39;in row 3 the ID has an 0 extra in sheet2&#39;. Do you want them to be equal, e.g. <code>B2C12861000</code> = <code>B2C128610000</code>?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 426, "user_id": 6805396, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1202317043165603/picture?type=large", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6805396/vlad"}, "edited": false, "score": 0, "creation_date": 1499852520, "post_id": 45053362, "comment_id": 77081367, "body": "@Vlad  ya, i want them to be equal. irespective of Zero at the end, they should  be equal"}, {"owner": {"reputation": 426, "user_id": 6805396, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1202317043165603/picture?type=large", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6805396/vlad"}, "edited": false, "score": 0, "creation_date": 1499852674, "post_id": 45053362, "comment_id": 77081484, "body": "May be you should to prepare data before matching. First I&#39;d split every cell for <code>,</code> and <code>;</code> to remove second codes in some cells, then remove zeros from remained IDs"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 426, "user_id": 6805396, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1202317043165603/picture?type=large", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6805396/vlad"}, "edited": false, "score": 0, "creation_date": 1499853489, "post_id": 45053362, "comment_id": 77082072, "body": "@Vlad you mean, i could use LEFT and prepare an data ? with 11 or 12 Digits ? and then Consider ?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499853516, "post_id": 45053362, "comment_id": 77082088, "body": "if so , could you suggest how i could use LEFt in VBA ?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 426, "user_id": 6805396, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1202317043165603/picture?type=large", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6805396/vlad"}, "edited": false, "score": 0, "creation_date": 1499853714, "post_id": 45053362, "comment_id": 77082242, "body": "@Vlad is there no other way i could add an line of code, in my existing code ?"}, {"owner": {"reputation": 426, "user_id": 6805396, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1202317043165603/picture?type=large", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6805396/vlad"}, "edited": false, "score": 0, "creation_date": 1499854131, "post_id": 45053362, "comment_id": 77082552, "body": "give me a minute"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 426, "user_id": 6805396, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1202317043165603/picture?type=large", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6805396/vlad"}, "edited": false, "score": 0, "creation_date": 1499854190, "post_id": 45053362, "comment_id": 77082585, "body": "@Vlad yeah, sure"}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499856172, "post_id": 45055169, "comment_id": 77084041, "body": "you have not mentioned a range or cell, how does it recognise ?"}, {"owner": {"reputation": 426, "user_id": 6805396, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1202317043165603/picture?type=large", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6805396/vlad"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499920868, "post_id": 45055169, "comment_id": 77115650, "body": "didn&#39;t get the question about range/cell"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499929130, "post_id": 45055169, "comment_id": 77119439, "body": "in the function clear, my question is we have not metioned anything like cell (i,11).value . how does the above code recognise where it should look for  ?"}, {"owner": {"reputation": 426, "user_id": 6805396, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1202317043165603/picture?type=large", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6805396/vlad"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1499954176, "post_id": 45055169, "comment_id": 77138113, "body": "1) The function gets a range and modifies each cell in the range. 2) Regarding the out of range error - it&#39;s difficult to debug it without knowing exact line and variables values. In my test sample it worked without errors."}], "tags": [], "owner": {"reputation": 426, "user_id": 6805396, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1202317043165603/picture?type=large", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6805396/vlad"}, "is_accepted": false, "score": 0, "last_activity_date": 1499855370, "creation_date": 1499855370, "answer_id": 45055169, "question_id": 45053362, "link": "https://stackoverflow.com/questions/45053362/error-in-finding-the-exact-match/45055169#45055169", "title": "Error in finding the exact match", "body": "<p>I would do something like that:</p>\n\n<pre><code>Sub clear(rng As Range)\n    For Each cell In rng.Cells\n        cell.Value = Split(cell.Value, \",\")(0)\n        cell.Value = Split(cell.Value, \";\")(0)\n        While Mid(cell.Value, Len(cell.Value)) = \"0\"\n            cell.Value = Mid(cell.Value, 1, Len(cell.Value) - 1)\n        Wend\n    Next cell\nEnd Sub\n\n\nSub lookup()\n    Dim lLastrow As Long\n    Dim rng As Range\n    Dim i As Long\n\n    ThisWorkbook.Sheets(\"S\").Select\n    lLastrow = ActiveSheet.Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row\n    Range(\"P5:P\" &amp; lLastrow).Copy Destination:=Sheets(\"Result_APQP\").Range(\"E5\")\n    Range(\"G5:G\" &amp; lLastrow).Copy Destination:=Sheets(\"Result_APQP\").Range(\"H5\")\n\n    Call clear(Sheets(\"Result\").UsedRange)\n    Call clear(Sheets(\"P\").UsedRange)\n\n    Sheets(\"Result\").Select\n    For i = 5 To lLastrow\n\n        Set rng = Sheets(\"P\").UsedRange.Find(Cells(i, 5).Value &amp; \"*\", LookAt:=xlWhole)\n        'If it is found put its value on the destination sheet\n        If Not rng Is Nothing Then\n            Cells(i, 6).Value = rng.Value\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Note than the clear() subprogramm modifies the original data.</p>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499855370, "creation_date": 1499850710, "question_id": 45053362, "link": "https://stackoverflow.com/questions/45053362/error-in-finding-the-exact-match", "title": "Error in finding the exact match", "body": "<p>I have three Sheets, Sh1 , Sh2, Sh3. Sh3 is my result sheet. </p>\n\n<p>I have copied Column N from Sh1 to Sh3 in column E.</p>\n\n<p>I consider column E of sheet3, then I compare the Column A of sheet2, If they match, then I will copy the result in sheet3 in column F. </p>\n\n<p>I am able to find the matching columns, but, I have few Special cases, which I am not able to sort out. </p>\n\n<p>I have explained them in the Image . </p>\n\n<pre><code>[![The Image Shows an example of how the ID Looks in column E of sht3][1]][1]\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/r1wP4.png\" rel=\"nofollow noreferrer\">![Here i have shown both structure of ID. The first row id is the same, and has no Problem ist finding the match. In the second row, there is an 0 less in my sheet2, and the code Fails to Display that, in row 3, the Id has an 0 extra in sheet2. in row 4, i have an id with other id, but in sheet2, i have the same id, with 0 extra, same in row 5 as well,\nThe ID are generally 11 to 13 Digit Long. ]<a href=\"https://i.stack.imgur.com/r1wP4.png\" rel=\"nofollow noreferrer\">1</a></a></p>\n\n<p>Could someone suggest how I could overcome this issue. Below is the code, I am using to copy the values from one sheet to another and looking for the values in another sheet.</p>\n\n<pre><code>Sub lookup()\nDim lLastrow As Long\nDim rng As Range\nDim i As Long\n\nThisWorkbook.Sheets(\"S\").Select\nlLastrow = ActiveSheet.Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row\nRange(\"P5:P\" &amp; lLastrow).Copy Destination:=Sheets(\"Result_APQP\").Range(\"E5\")\nRange(\"G5:G\" &amp; lLastrow).Copy Destination:=Sheets(\"Result_APQP\").Range(\"H5\")\n\nSheets(\"Result\").Select\nFor i = 5 To lLastrow\n\nSet rng = Sheets(\"P\").UsedRange.Find(Cells(i, 5).Value &amp; \"*\", LookAt:=xlWhole)\n'If it is found put its value on the destination sheet\nIf Not rng Is Nothing Then\nCells(i, 6).Value = rng.Value\n End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "edited": false, "score": 0, "creation_date": 1499850747, "post_id": 45052835, "comment_id": 77080016, "body": "can you share your code?"}, {"owner": {"reputation": 57, "user_id": 7267273, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/25b0eb783c88503aa6b60cd52ad37f56?s=128&d=identicon&r=PG&f=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/7267273/graham"}, "reply_to_user": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "edited": false, "score": 0, "creation_date": 1499852201, "post_id": 45052835, "comment_id": 77081125, "body": "Hi there I have added my code for you to look at"}, {"owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "edited": false, "score": 0, "creation_date": 1499852522, "post_id": 45052835, "comment_id": 77081369, "body": "in which line do you want to get dynamic value"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 7267273, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/25b0eb783c88503aa6b60cd52ad37f56?s=128&d=identicon&r=PG&f=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/7267273/graham"}, "edited": false, "score": 0, "creation_date": 1499854674, "post_id": 45054369, "comment_id": 77082907, "body": "Sorry no I haven&#39;t as I can not understand what it is doing or where I add it into my code. My apologies I am very new to VBA and am really on a steep learning curve here"}, {"owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "reply_to_user": {"reputation": 57, "user_id": 7267273, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/25b0eb783c88503aa6b60cd52ad37f56?s=128&d=identicon&r=PG&f=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/7267273/graham"}, "edited": false, "score": 0, "creation_date": 1499855409, "post_id": 45054369, "comment_id": 77083437, "body": "You are hard coded counter range as(&quot;b3&quot;). so you will not get (&quot;c3,d3,...&quot;) so change counter code as i mentioned and through loop increment it.."}], "tags": [], "owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "is_accepted": false, "score": 0, "last_activity_date": 1499854083, "last_edit_date": 1499854083, "creation_date": 1499853320, "answer_id": 45054369, "question_id": 45052835, "link": "https://stackoverflow.com/questions/45052835/vba-counter-that-takes-value-from-different-cell-on-each-loop/45054369#45054369", "title": "vba counter that takes value from different cell on each loop", "body": "<p>Try with this concept ...</p>\n\n<p>modify your code to </p>\n\n<pre><code>Dim k as Integer\n\nk=3;\n\ncounter =Range(Cells(3, k), Cells(3, k)).Value    // through this you will get dynamic counter value like B3,D3,E3.,,,,\n\nif(counter !=\"\")\n{\n//execute some code\n}\nk=k+1;\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 7267273, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/25b0eb783c88503aa6b60cd52ad37f56?s=128&d=identicon&r=PG&f=1", "display_name": "Graham", "link": "https://stackoverflow.com/users/7267273/graham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499855171, "creation_date": 1499849381, "last_edit_date": 1499855171, "question_id": 45052835, "link": "https://stackoverflow.com/questions/45052835/vba-counter-that-takes-value-from-different-cell-on-each-loop", "title": "vba counter that takes value from different cell on each loop", "body": "<p>I have solved this problem myself thanks to the people who offered help</p>\n\n<p>I have an if statement which relies on a counter, I am taking the value of the counter from cell \"B3\" and the code works fine as it is.\nHowever each time I loop through the program I need the counter to take it's value from a different cell.\nso for example loop 1 read value from \"B3\"\nloop 2 read value from \"C3\"\nnext \"D3\" and so on across the sheet\nkeep going until it reaches a an empty cell\nI have dim c as integer\nand for c= 2 to 26 to take me to the 26th column\nbut I am not sure how to get it to increment each time the loop starts. can anyone help with this? I can post the full code I am using at the moment if that will help the understanding of the question</p>\n\n<pre><code>Public Sub copyX()\nDim listofcells As Range\nDim currentname As String\nDim foundrow As Integer\nDim foundcolumn As Integer\nDim counter As Integer\nDim i As Integer\nDim c As Integer\n\nFor i = 2 To 26\n\n    Sheets(\"Availability\").Activate\n    counter = Range(\"b3\")\n    Sheets(\"Availability\").Range(\"a2\").Select\n    If Not Sheets(\"Availability\").Cells(2, i) = \"\" Then\n        Sheets(\"Availability\").Range(Cells(2, i), Cells(2, i).End(xlDown)).Select\n    Else\n        GoTo skip:  'If the column has no data then skip to next column\n    End If\n    Set listofcells = Selection\n\n    Sheets(\"allocation\").Activate\n    Range(\"a2\").Select\n\n\n    For Each singlecell In listofcells\n            If counter &gt; 0 Then\n            If singlecell = \"Available\" Then\n            foundcolumn = singlecell.Column 'record the column number where \"Available\" was found\n            currentname = Sheets(\"availability\").Range(\"A\" &amp; singlecell.Row) 'record the name of the person in the row where \"Available\" was found\n            Set foundName = Sheets(\"allocation\").Range(\"A:A\").Find(What:=currentname, LookIn:=xlValues) 'find the persons name in \"Allocation\" sheet\n            foundrow = foundName.Row\n            Sheets(\"allocation\").Cells(foundrow, foundcolumn) = \"X\" 'place yes in the same cell as it appeared in \"Availability\" sheet\n            counter = counter - 1\n            End If\n        End If\n\n    Next singlecell\n\nskip:\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I have come up with the following code which does go through the cells and get their value, the problem is I can not get a for next loop to work inside another for next loop.\nSet counterrange = Range(\"b3:Z3\")\n    For Each cell In counterrange\n    Next cell </p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499850763, "post_id": 45052698, "comment_id": 77080028, "body": "Tim&#39;s answer will fix the problem, but the reason <b>why</b> your code is failing is because your are performing the logical expression <code>FormulaR1C1 = &quot;=IF(RC[-1]=&quot;&quot;&quot;&quot;,RC[-2]*RC[-3],RC[-2]*RC[-3]*(1-RC[-1]))&quot;</code> which, because the variable <code>FormulaR1C1</code> has never been declared or assigned a value, is equivalent to <code>&quot;&quot; = &quot;=IF(RC[-1]=&quot;&quot;&quot;&quot;,RC[-2]*RC[-3],RC[-2]*RC[-3]*(1-RC[-1]))&quot;</code> which is obviously <code>False</code>, and then you are assigning that to the cell.  You can avoid these problems by using <code>Option Explicit</code> as the first line of each code module.  That would tell you that <code>FormulaR1C1</code> is undeclared."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "edited": false, "score": 0, "creation_date": 1499849541, "post_id": 45052779, "comment_id": 77079074, "body": "Thanks Tim, absolutely yes that makes sense. Has worked. Thank you"}], "tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": true, "score": 1, "last_activity_date": 1499849249, "creation_date": 1499849249, "answer_id": 45052779, "question_id": 45052698, "link": "https://stackoverflow.com/questions/45052698/formular1c1-reading-false/45052779#45052779", "title": "FormulaR1C1 reading False", "body": "<p>Don't do <code>ws.Cells(iRow, 14).Value = FormulaR1C1</code> because you're not setting a value, use <code>ws.Cells(iRow, 14).FormulaR1C1 =</code></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim iRow As Long\nDim ws As Worksheet\n\nSet ws = Worksheets(\"Primary Data\")\n\niRow = ws.Cells.Find(What:=\"*\", Searchorder:=xlRows, _\n    SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n\nws.Cells(iRow, 14).FormulaR1C1 = \"=IF(RC[-1]=\"\"\"\",RC[-2]*RC[-3],RC[-2]*RC[-3]*(1-RC[-1]))\"\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1499915025, "post_id": 45053141, "comment_id": 77114318, "body": "Dunno why I&#39;m feeling attracted these days to drop <code>Offset</code> and use notation like <code>IIf(Rng(,0) = &quot;&quot;, Rng(, -1) * Rng(, -2),... </code> ;)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499915208, "post_id": 45053141, "comment_id": 77114351, "body": "@A.S.H me too, that&#39;s why I&#39;ve added this solution ;)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499916029, "post_id": 45053141, "comment_id": 77114522, "body": "(may be a little chatty, TLDR) a lot of shortcuts in VBA code were dropped by &quot;common practice&quot; for sake of making it as compatible as possible to <code>VB.net</code>. Among them the <code>[ ]</code> notation, the implicit <code>.Value</code>, etc. That was at a time when everyone was thinking that VB.net <i>&quot;will definitely replace VB6 and VBA&quot;</i>. I have a big question mark on these motivations today..."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499916123, "post_id": 45053141, "comment_id": 77114539, "body": "just spent another 0.5 hour here <a href=\"https://stackoverflow.com/questions/45067788/change-event-procedure-for-moving-pivot-chart/45070846#45070846\" title=\"change event procedure for moving pivot chart\">stackoverflow.com/questions/45067788/&hellip;</a> , now I can go shave ;)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1499850198, "creation_date": 1499850198, "answer_id": 45053141, "question_id": 45052698, "link": "https://stackoverflow.com/questions/45052698/formular1c1-reading-false/45053141#45053141", "title": "FormulaR1C1 reading False", "body": "<p>Another option, which will work if the values in column \"K\", \"L\" and \"M\" already exist before running this code is:</p>\n\n<pre><code>Dim Rng As Range\n\nSet Rng = ws.Cells(iRow, 14)\nRng.Value = IIf(Rng.Offset(, -1) = \"\", _\n                    Rng.Offset(, -2) * Rng.Offset(, -3), _\n                    Rng.Offset(, -2) * Rng.Offset(, -3) * (1 - Rng.Offset(, -1)))\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 45052779, "answer_count": 2, "score": 0, "last_activity_date": 1499850198, "creation_date": 1499849082, "last_edit_date": 1499849299, "question_id": 45052698, "link": "https://stackoverflow.com/questions/45052698/formular1c1-reading-false", "title": "FormulaR1C1 reading False", "body": "<p>I have a userform in excel which is adding data to the last row of a table. in column 14 of the last row I am wanting excel to display the formula however it is always reading false. If I take out the lastrow and do this as a separate entity alone then this works perfectly.</p>\n\n<p>In the example it should be giving the answer 26.5 * 2 which should of course yield 53, not FALSE since RC[-1] is blank.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim iRow As Long\nDim ws As Worksheet\n\nSet ws = Worksheets(\"Primary Data\")\n\niRow = ws.Cells.Find(What:=\"*\", Searchorder:=xlRows, _\n    SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n\nws.Cells(iRow, 14).Value = FormulaR1C1 = \"=IF(RC[-1]=\"\"\"\",RC[-2]*RC[-3],RC[-2]*RC[-3]*(1-RC[-1]))\"\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone please help me with this conundrum.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499850726, "post_id": 45052866, "comment_id": 77079996, "body": "This looks really good but I currently get a Path/File access error - runtime 75 on the line &quot;Open inFile For Input As #1&quot; in the second routine? What have I done wrong? Plus, do I repeat the process shown above for Non My Pay final as well? I.e both text files?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499851201, "post_id": 45052866, "comment_id": 77080350, "body": "@Dyhouse, then close the file before calling it with the procedure. Thus, you may have to put <code>Call AltText_V2(strFile)</code> twice in your code. Make sure that each time time you close the <code>strFile</code> properly."}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499851770, "post_id": 45052866, "comment_id": 77080784, "body": "I have done exactly as suggested but I am getting the same error (path/file access error - runtime 75) on the same line (open infile for input as #1). I will edit my question so you can see the routine as it stands now"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499851894, "post_id": 45052866, "comment_id": 77080877, "body": "@Dyhouse - when you edit, remove all the useless stuf, and do it really a minimal question - e.g. all the ranges check and etc. Also remove the Paths selection and hardcode them - thus it would be easier to replicate."}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499852345, "post_id": 45052866, "comment_id": 77081234, "body": "Apologies, I was editing as you messaged, I&#39;m not entirely sure I understand when you say useless stuff? Would you mind editing my code so I have an idea going forward please? Same applies with the path selection....I am pretty new to VBA so I am still learning."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499852426, "post_id": 45052866, "comment_id": 77081288, "body": "@Dyhouse - I mean useless like <code>Set rCopy = Range(&quot;A1&quot;, Range(&quot;A1&quot;).End(xlDown))</code>, as far as they are not part of the initial problem. In general, read <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499852658, "post_id": 45052866, "comment_id": 77081464, "body": "Thank you for that I will do going forward. As it stands though, do you have any idea what is causing my issue?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499852764, "post_id": 45052866, "comment_id": 77081550, "body": "@Dyhouse - it can be plenty of things. But most probably, you are passing <code>strFile</code> to the procedure that does not exist. Put a <code>debug.print strFile</code> before and check whether it exists."}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499853448, "post_id": 45052866, "comment_id": 77082043, "body": "I can see that the file name is stored in strFile accurately in the initial sub routine but then is blank or (strFile=&quot;&quot;) when it comes to the second routine which has just been called. I have to admit, I am not sure how to rectify it?"}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499855079, "post_id": 45052866, "comment_id": 77083181, "body": "Do I need to declare the variable strFile differently? I am scouring this site trying to find an answer...."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499855194, "post_id": 45052866, "comment_id": 77083264, "body": "@Dyhouse - you need to declare it just once, however, you should give values to it two times. Once with the first file and once with the second file."}, {"owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499855669, "post_id": 45052866, "comment_id": 77083634, "body": "I believe that is what I have done though? Am I missing something in the second routine which the stored filename disappears?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "edited": false, "score": 0, "creation_date": 1499860586, "post_id": 45052866, "comment_id": 77087081, "body": "In your code you are calling <code>Call AltText_V2</code> without a parameter? You need parameter there. @Dyhouse"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1499849477, "creation_date": 1499849477, "answer_id": 45052866, "question_id": 45052617, "link": "https://stackoverflow.com/questions/45052617/combining-two-sub-routines-without-re-selecting-file/45052866#45052866", "title": "Combining two sub routines without re-selecting file", "body": "<p>In general, two routines is a better approach, you should simply pass the name of the file from the first routine to the second. Thus, it would work and you do not need for select. If it is one routine, it gets too long and messy. Try something like this:</p>\n\n<pre><code>'Option Explicit\n\nPublic Sub OneRoutine()\n    Dim strFile As String\n\n    '...rest of the code\n\n    MySaveFile = Format(Now(), \"DDMMYYYY\") &amp; \"MyPayFINALTest\" &amp; \".Txt\"\n    strFile = \"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\" &amp; MySaveFile\n    ActiveWorkbook.SaveAs (strFile), FileFormat:=xlTextWindows\n\n    Call AltText_V2(strFile)\n\n    'Close the new saved file\n    ActiveWorkbook.Close\n\n    '...rest of the code\n\nEnd Sub\n\nSub AltText_V2(strFile As String)\n\n    Dim inFile As String\n    Dim outFile As String\n    Dim data As String\n\n    'Ensures that the file open directory is always the same\n    ChDir \"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\"\n\n    inFile = strFile\n    Open inFile For Input As #1\n\n    '...rest of the code\n\nEnd Sub\n</code></pre>\n\n<p>Furthermore, the second routine becomes a bit more reuseable and independent and thus in general the code is robust. </p>\n"}, {"tags": [], "owner": {"reputation": 86, "user_id": 8237129, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1402768456438655/picture?type=large", "display_name": "Ond\u0159ej Michejda", "link": "https://stackoverflow.com/users/8237129/ond%c5%99ej-michejda"}, "is_accepted": false, "score": 0, "last_activity_date": 1499849685, "creation_date": 1499849685, "answer_id": 45052937, "question_id": 45052617, "link": "https://stackoverflow.com/questions/45052617/combining-two-sub-routines-without-re-selecting-file/45052937#45052937", "title": "Combining two sub routines without re-selecting file", "body": "<p>You can save filepath to global variable and then don't involve pop-up for select file.</p>\n"}], "owner": {"reputation": 93, "user_id": 8049163, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/O3KPJ.jpg?s=128&g=1", "display_name": "Dyhouse", "link": "https://stackoverflow.com/users/8049163/dyhouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 45052866, "answer_count": 2, "score": 1, "last_activity_date": 1499860212, "creation_date": 1499848835, "last_edit_date": 1499860212, "question_id": 45052617, "link": "https://stackoverflow.com/questions/45052617/combining-two-sub-routines-without-re-selecting-file", "title": "Combining two sub routines without re-selecting file", "body": "<p>I have written two sub routines which are both currently assigned to separate buttons in the main template workbook. They both work without errors and all is good but I would like to be able to combine them so that one button will execute the whole routine in one. Now I know a simple call could work here but that then requires the user to re-select files.</p>\n\n<p>So the first routine creates two appropriately named text files and then second routine removes all the blank rows (white space) that is created when the original text files are created but at the moment, the user is required to re-select the newly generated text file to execute. </p>\n\n<p>Is there a good, effective way to combine these without losing functionality? Without just calling the second routine?</p>\n\n<pre><code>     Option Explicit\n\n     Public Sub OneRoutine()\n\n     Dim strFile As String\n     Dim MyNewBook As String\n     Dim MySaveFile As String\n     Dim fileToOpen As Variant\n     Dim fileName As String\n     Dim sheetName As String\n     Dim rCopy As Range\n     Dim lastrow As Integer\n     Dim wb As Workbook\n\n\n     'Turn off display alerts\n     Application.DisplayAlerts = False\n     'Turn off screen updates\n     Application.ScreenUpdating = False\n\n     'Ensures that the file open directory is always the same\n     ChDir \"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\"\n\n     'Opens the folder to location to select txt file\n     fileToOpen = Application.GetOpenFilename(\"Text Files (*.txt), *.txt\")\n        If fileToOpen &lt;&gt; False Then\n        Workbooks.OpenText fileName:=fileToOpen, _\n        DataType:=xlDelimited, Tab:=True\n        End If\n     'Creates the file name based on txt file name\n    fileName = Mid(fileToOpen, InStrRev(fileToOpen, \"\\\") + 1)\n    'Creates the sheet name based on the active txt file\n    sheetName = Left(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - 4)\n\n    'Rename the original text file\n    ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\" \n     &amp; \"DNU_\" &amp; fileName)\n\n    'Save active file as...\n    ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment \n     Limited\\BACS File Original\\\" &amp; _\n    fileName &amp; \".CSV\"), FileFormat:=xlCSV\n\n    'Selects all data in column A and copies to clipboard\n    Set rCopy = Range(\"A1\", Range(\"A1\").End(xlDown))\n\n     'Open the original document where the BACS file is located\n    Workbooks.Open \"S:\\Accounts (New)\\Management Information (Analysis)\\Phil \n     Hanmore - Analysis\\bacs conversion calc.xlsx\"\n    'Selects the worksheet called \"Original\"\n    Sheets(\"Original\").Range(\"A:A\").ClearContents\n\n    'Paste selected values from previous sheet\n    rCopy.Copy\n    Sheets(\"Original\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\n    'This checks cells T5 and U5 on the \"Original\" tab. If either are false \n     then the macro will stop, if both are true it will continue on normally\n     If Range(\"T5\").Value = \"False\" Then\n       MsgBox \"An error has occured!\" &amp; vbNewLine &amp; \"Please speak to Phil \n    Hanson before continuing\", vbCritical\n        Exit Sub\n    End If\n\n    If Range(\"U5\").Value = \"False\" Then\n       MsgBox \"An error has occured!\" &amp; vbNewLine &amp; \"Please speak to Phil \n     Hanson before continuing\", vbCritical\n        Exit Sub\n    End If\n\n    'Saves the BACS Conversion Calculator\n    ActiveWorkbook.SaveAs \"S:\\Accounts (New)\\Management Information \n      (Analysis)\\Phil Hanmore - Analysis\\bacs conversion calc.xlsx\"\n\n     'Selects appropriate worksheet - Non-MyPayFINAL\n     Sheets(\"Non-MyPay FINAL\").Select\n\n    'Selects all data in column A and copies to clipboard\n    Range(\"A1\", Range(\"A1\").End(xlDown)).Select\n    Selection.Copy\n\n    'Add a new workbook\n    Workbooks.Add\n    'Paste selected values from previous sheet\n    Selection.PasteSpecial Paste:=xlPasteValues\n\n\n    'Build SaveAs file name (for CSV file)\n    MySaveFile = Format(Now(), \"DDMMYYYY\") &amp; \"NonMyPayFINALTest\" &amp; \".CSV\"\n    'Save template file as...(for CSV file)\n    ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\" \n     &amp; MySaveFile), FileFormat:=xlCSV\n\n     'Build SaveAs file name (for Txt file)\n    MySaveFile = Format(Now(), \"DDMMYYYY\") &amp; \"NonMyPayFINALTest\" &amp; \".Txt\"\n    strFile = \"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\" &amp; MySaveFile\n    ActiveWorkbook.SaveAs (strFile), FileFormat:=xlTextWindows\n    'Save template file as...(for Txt file)\n    'ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment \n    Limited\\\" &amp; MySaveFile), FileFormat:=xlTextWindows\n\n    'Close the new saved file\n     ActiveWorkbook.Close\n\n     Call AltText_V2\n\n\n\n    'Selects appropriate worksheet - MyPayFINAL\n    Sheets(\"MyPay FINAL\").Select\n\n    'Selects all data in column A and copies to clipboard\n    Range(\"A1\", Range(\"A1\").End(xlDown)).Select\n    Selection.Copy\n\n    'Add a new workbook\n    Workbooks.Add\n    'Paste selected values from previous sheet\n    Selection.PasteSpecial Paste:=xlPasteValues\n\n    'Build SaveAs file name (for CSV file)\n    MySaveFile = Format(Now(), \"DDMMYYYY\") &amp; \"MyPayFINALTest\" &amp; \".CSV\"\n    'Save template file as...(for CSV file)\n    ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\" \n     &amp; MySaveFile), FileFormat:=xlCSV\n\n    'Build SaveAs file name (for Txt file)\n    MySaveFile = Format(Now(), \"DDMMYYYY\") &amp; \"MyPayFINALTest\" &amp; \".Txt\"\n    strFile = \"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\" &amp; MySaveFile\n    ActiveWorkbook.SaveAs (strFile), FileFormat:=xlTextWindows\n    'Close the new saved file\n    ActiveWorkbook.Close\n\n    'Save template file as...(for Txt file)\n    'ActiveWorkbook.SaveAs (\"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment \n    Limited\\\" &amp; MySaveFile), FileFormat:=xlTextWindows\n    Call AltText_V2\n\n    'Close original source workbook (template)\n    Windows(\"bacs conversion calc.xlsx\").Close\n    'Close final workbook\n    ActiveWorkbook.Close savechanges:=True\n      'Deletes the original copy\n     Kill fileToOpen\n     'Displays message box\n      MsgBox \"Your file has been processed successfully!\", vbExclamation\n\n    'Calls the next subroutine\n    'Call AltText_V2\n\n   'Turn on display alerts\n    Application.DisplayAlerts = True\n    'Turn on screen updates\n    Application.ScreenUpdating = True\n\n     End Sub\n\n     Sub AltText_V2()\n      Dim inFile As String\n      Dim outFile As String\n      Dim data As String\n      Dim strFile As String\n\n     'Ensures that the file open directory is always the same\n      ChDir \"S:\\MERIT OUTPUTS FOLDER\\MSI Recruitment Limited\\\"\n\n     'inFile = Application.GetOpenFilename\n     inFile = strFile\n     Open inFile For Input As #1\n\n     outFile = inFile &amp; \".txt\"\n     Open outFile For Output As #2\n\n      Do Until EOF(1)\n      Line Input #1, data\n\n      If Trim(data) &lt;&gt; \"\" Then\n         Print #2, data\n      End If\n     Loop\n\n     Close #1\n     Close #2\n\n     Kill inFile\n     Name outFile As inFile\n\n     MsgBox \"File alteration completed!\"\n     End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1499848732, "post_id": 45052476, "comment_id": 77078567, "body": "what is the value and format you are getting now for <code>AbsentDays</code> ?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499848830, "post_id": 45052476, "comment_id": 77078621, "body": "It sounds like you might want to use <code>myString = myString &amp; Format(Cells(myRow, cell.Column), &quot;dd mmm&quot;) &amp; &quot;, &quot;</code> (if that cell contains a date)"}, {"owner": {"reputation": 1, "user_id": 8294413, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WXuFKozm5AY/AAAAAAAAAAI/AAAAAAAAAFs/Hzu47CHLLTY/photo.jpg?sz=128", "display_name": "Pratyush Kumar", "link": "https://stackoverflow.com/users/8294413/pratyush-kumar"}, "edited": false, "score": 0, "creation_date": 1499848959, "post_id": 45052476, "comment_id": 77078706, "body": "I am getting like this : 6/7/2017, 6/9/2017, 6/15/2017, 6/16/2017  , but I want to get like 7 june , 9 june...."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8294413, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WXuFKozm5AY/AAAAAAAAAAI/AAAAAAAAAFs/Hzu47CHLLTY/photo.jpg?sz=128", "display_name": "Pratyush Kumar", "link": "https://stackoverflow.com/users/8294413/pratyush-kumar"}, "edited": false, "score": 0, "creation_date": 1499849374, "post_id": 45052742, "comment_id": 77078953, "body": "I want to show it in excel rows. I am new in vba excel . can you type the full code."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499849427, "post_id": 45052742, "comment_id": 77078989, "body": "@YowE3K is he getting an array of dates ? I thought these were example he is getting one by one"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1499849682, "post_id": 45052742, "comment_id": 77079193, "body": "@YowE3K here you go, just for you :)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1499849668, "last_edit_date": 1499849668, "creation_date": 1499849184, "answer_id": 45052742, "question_id": 45052476, "link": "https://stackoverflow.com/questions/45052476/how-to-display-returned-mystring-value-as-date-in-vba/45052742#45052742", "title": "How to Display returned mystring value as date in VBA", "body": "<p>I am assuming that <code>AbsentDays</code> is a <code>String</code>, and you are getting <code>6/7/2017, 6/9/2017, 6/15/2017, 6/16/2017</code> as a <code>String</code> (and not a <code>Date</code>).</p>\n\n<p>Try the <code>String</code> conversion code below:</p>\n\n<pre><code>Dim AbsentDays  As String\nDim DatesArr As Variant\nDim i As Long\n\n' for my tests\nAbsentDays = \"6/7/2017, 6/9/2017, 6/15/2017, 6/16/2017\"\n\n' use the split to get the values in an array\nDatesArr = Split(AbsentDays, \",\")\nDim myDateformat As Variant\n\n' loop through array\nFor i = 0 To UBound(DatesArr)\n    If i = 0 Then ' first array element\n        myDateformat = Format(CDate(DatesArr(i)), \"dd mmm\")\n    Else ' 2nd array element and above\n        myDateformat = myDateformat &amp; \", \" &amp; Format(CDate(DatesArr(i)), \"dd mmm\")\n    End If\nNext i\n\nMsgBox myDateformat\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1499850279, "post_id": 45053087, "comment_id": 77079667, "body": "LOL, don&#39;t forget to remove the &quot;extra&quot; <code>&quot;, &quot;</code> at the end"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1499850303, "post_id": 45053087, "comment_id": 77079686, "body": "@ShaiRado The existing code already does that.  (<code>AbsentDays = Left(myString, Len(myString) - 2)</code>)"}, {"owner": {"reputation": 1, "user_id": 8294413, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WXuFKozm5AY/AAAAAAAAAAI/AAAAAAAAAFs/Hzu47CHLLTY/photo.jpg?sz=128", "display_name": "Pratyush Kumar", "link": "https://stackoverflow.com/users/8294413/pratyush-kumar"}, "edited": false, "score": 0, "creation_date": 1499851093, "post_id": 45053087, "comment_id": 77080271, "body": "can i send u the excel file. can you modify and help me"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 8294413, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WXuFKozm5AY/AAAAAAAAAAI/AAAAAAAAAFs/Hzu47CHLLTY/photo.jpg?sz=128", "display_name": "Pratyush Kumar", "link": "https://stackoverflow.com/users/8294413/pratyush-kumar"}, "edited": false, "score": 0, "creation_date": 1499851531, "post_id": 45053087, "comment_id": 77080605, "body": "@PratyushKumar If my suggested change didn&#39;t work, there&#39;s not much I can help with even if I had a copy of the file. (Especially as I am going to bed in 7 minutes). What is happening when you try my code change?  What is happening when you add Shai&#39;s code to your code?  (&quot;did not work&quot; doesn&#39;t help much in diagnosing what went wrong.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 8294413, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WXuFKozm5AY/AAAAAAAAAAI/AAAAAAAAAFs/Hzu47CHLLTY/photo.jpg?sz=128", "display_name": "Pratyush Kumar", "link": "https://stackoverflow.com/users/8294413/pratyush-kumar"}, "edited": false, "score": 0, "creation_date": 1499852301, "post_id": 45053087, "comment_id": 77081203, "body": "@PratyushKumar This might be a stupid question, but is <code>6&#47;15&#47;2017</code> a valid date in your country&#39;s date format?  (I&#39;m struggling to think how <code>Format(CDate(Cells(myRow, cell.Column)), &quot;dd mmm&quot;)</code> can leave the value looking like <code>6&#47;15&#47;2017</code>.)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1499850050, "creation_date": 1499850050, "answer_id": 45053087, "question_id": 45052476, "link": "https://stackoverflow.com/questions/45052476/how-to-display-returned-mystring-value-as-date-in-vba/45053087#45053087", "title": "How to Display returned mystring value as date in VBA", "body": "<p>Just because I like to keep changes to a minimum, I think you can simply change your line saying:</p>\n\n<pre><code>myString = myString &amp; Cells(myRow, cell.Column) &amp; \", \"\n</code></pre>\n\n<p>to be:</p>\n\n<pre><code>myString = myString &amp; Format(CDate(Cells(myRow, cell.Column)), \"dd mmm\") &amp; \", \"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8294413, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WXuFKozm5AY/AAAAAAAAAAI/AAAAAAAAAFs/Hzu47CHLLTY/photo.jpg?sz=128", "display_name": "Pratyush Kumar", "link": "https://stackoverflow.com/users/8294413/pratyush-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499851924, "creation_date": 1499848417, "last_edit_date": 1499851924, "question_id": 45052476, "link": "https://stackoverflow.com/questions/45052476/how-to-display-returned-mystring-value-as-date-in-vba", "title": "How to Display returned mystring value as date in VBA", "body": "<p>I have created a function to get absent days based on absence entries in my attendance sheet. </p>\n\n<p>My code is: </p>\n\n<pre><code>Dim cell As Range\nDim myString As String\n\n'Loop through all the cells in the range\nFor Each cell In myRange\n    'Check for value\n    If cell = \"A\" Then\n        myString = myString &amp; Cells(myRow, cell.Column) &amp; \", \"\n    End If\nNext cell\n\n'Return string\nIf Len(myString) &gt; 0 Then\n    AbsentDays = Left(myString, Len(myString) - 2)\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>I want to display the returned values displayed as <code>\"dd mmm\"</code>.</p>\n"}, {"tags": ["excel", "vba", "cells", "type-mismatch"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499848438, "post_id": 45052373, "comment_id": 77078395, "body": "Do you have any error values (<code>#N&#47;A</code> etc) in any of the cells?"}, {"owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "edited": false, "score": 0, "creation_date": 1499848597, "post_id": 45052373, "comment_id": 77078490, "body": "You are getting error because of any one of the cell value may be #N/A"}, {"owner": {"reputation": 111, "user_id": 4265632, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-b6vD6PaZQNI/AAAAAAAAAAI/AAAAAAAABGU/_XI8Fmnp_eA/photo.jpg?sz=128", "display_name": "Franklin Varghese", "link": "https://stackoverflow.com/users/4265632/franklin-varghese"}, "edited": false, "score": 0, "creation_date": 1499849790, "post_id": 45052373, "comment_id": 77079288, "body": "I had #DIV/0! in some cells. I cleared them and now it works fine"}, {"owner": {"reputation": 111, "user_id": 4265632, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-b6vD6PaZQNI/AAAAAAAAAAI/AAAAAAAABGU/_XI8Fmnp_eA/photo.jpg?sz=128", "display_name": "Franklin Varghese", "link": "https://stackoverflow.com/users/4265632/franklin-varghese"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499849907, "post_id": 45052373, "comment_id": 77079378, "body": "Thanks @YowE3K for your help"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1499848395, "post_id": 45052457, "comment_id": 77078366, "body": "<code>.Value</code> is the default property for a <code>Range</code> object, so your two lines are effectively identical."}, {"owner": {"reputation": 111, "user_id": 4265632, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-b6vD6PaZQNI/AAAAAAAAAAI/AAAAAAAABGU/_XI8Fmnp_eA/photo.jpg?sz=128", "display_name": "Franklin Varghese", "link": "https://stackoverflow.com/users/4265632/franklin-varghese"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499848492, "post_id": 45052457, "comment_id": 77078428, "body": "@YowE3K what should i use then"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 111, "user_id": 4265632, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-b6vD6PaZQNI/AAAAAAAAAAI/AAAAAAAABGU/_XI8Fmnp_eA/photo.jpg?sz=128", "display_name": "Franklin Varghese", "link": "https://stackoverflow.com/users/4265632/franklin-varghese"}, "edited": false, "score": 0, "creation_date": 1499848550, "post_id": 45052457, "comment_id": 77078462, "body": "@FranklinVarghese it depends on what is causing the error.  When it crashes, what is the value of <code>r</code> and <code>c</code>.  What is in the cell at that row / column?  If it is an error code, have a look at the answer just posted by sktneer."}], "tags": [], "owner": {"reputation": 163, "user_id": 7894839, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d8c550d37a74d8448d2e6e2e606c61eb?s=128&d=identicon&r=PG&f=1", "display_name": "Frame", "link": "https://stackoverflow.com/users/7894839/frame"}, "is_accepted": false, "score": -1, "last_activity_date": 1499848353, "creation_date": 1499848353, "answer_id": 45052457, "question_id": 45052373, "link": "https://stackoverflow.com/questions/45052373/error-in-excel-vba-code/45052457#45052457", "title": "Error in Excel VBA code", "body": "<p>Try:</p>\n\n<pre><code>If comp.Cells(r, c).Value = \"\" Then\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>If comp.Cells(r, c) = \"\" Then\n</code></pre>\n\n<p>it should work without a problem</p>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 1, "last_activity_date": 1499848542, "creation_date": 1499848542, "answer_id": 45052522, "question_id": 45052373, "link": "https://stackoverflow.com/questions/45052373/error-in-excel-vba-code/45052522#45052522", "title": "Error in Excel VBA code", "body": "<p>The cells you are checking may contain an error returned by a formula so add another condition to check if the cell doesn't contain an error and if not, proceed to check other conditions....</p>\n\n<pre><code>If Not IsError(comp.Cells(r, c)) Then\n    If comp.Cells(r, c) = \"\" Then\n        If (c + 1998) &gt; comp.Cells(r, 3) Then\n            empty_cells = empty_cells + 1\n            comp.Cells(r, c).Interior.ColorIndex = 13\n            'If comp.Cells(r, 1).Interior.ColorIndex = 1 Then sixten_comp = sixten_comp + 1\n        End If\n    End If\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 4265632, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-b6vD6PaZQNI/AAAAAAAAAAI/AAAAAAAABGU/_XI8Fmnp_eA/photo.jpg?sz=128", "display_name": "Franklin Varghese", "link": "https://stackoverflow.com/users/4265632/franklin-varghese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 45052522, "answer_count": 2, "score": 1, "last_activity_date": 1499848542, "creation_date": 1499848121, "question_id": 45052373, "link": "https://stackoverflow.com/questions/45052373/error-in-excel-vba-code", "title": "Error in Excel VBA code", "body": "<p>I am having a problem with my code, a compile error \"type mismatch\". Especially in the following line</p>\n\n<pre><code>If comp.Cells(r, c) = \"\" Then\n</code></pre>\n\n<p>i tried switching r and c with a number separately and it worked, but not together. Here's the full code </p>\n\n<pre><code>Sub missing_data()\n\nDim comp As Worksheet\nSet comp = Sheets(\"Compiled\")\nempty_cells = 0\nsixten_comp = 0\n    For r = 2 To 103\n\n        For c = 5 To 18\n           'searching for empty cells \n            If comp.Cells(r, c) = \"\" Then\n                If (c + 1998) &gt; comp.Cells(r, 3) Then\n                    empty_cells = empty_cells + 1\n                    comp.Cells(r, c).Interior.ColorIndex = 13\n\n                    'If comp.Cells(r, 1).Interior.ColorIndex = 1 Then sixten_comp = sixten_comp + 1\n\n                End If\n            End If\n\n        Next c\n\n    Next r\n\nMsgBox \"Number of total cells left is \" &amp; empty_cells\n'MsgBox \"Number of total cells left in 16 companies is \" &amp; sixten_comp\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vbscript", "catia"], "comments": [{"owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "edited": false, "score": 0, "creation_date": 1499855229, "post_id": 45052314, "comment_id": 77083291, "body": "What is the point of putting your documents in the array DocumentArrayNew ? You consume the document object right away and the array seems unnecessary. And, Document is an object, when you assign one to hash you should be using the &quot;Set&quot; keyword . Also, Colors cannot be assigned to Document objects. Typically you assign colors to products in an assembly or bodies in a Part."}, {"owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "edited": false, "score": 0, "creation_date": 1499855806, "post_id": 45052314, "comment_id": 77083748, "body": "The Document name does not necessarily match the part number or part name in an assembly.  Be careful with that. The main problem is when you search you are searching for somehing named &quot;hash&quot;. You need to fix that searh query string so that it includes the value of instance name you are searching for."}, {"owner": {"reputation": 143, "user_id": 4999039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b9028a52fa1dd8e24a1fc5f25d3f2c3?s=128&d=identicon&r=PG&f=1", "display_name": "Sherlock Homies", "link": "https://stackoverflow.com/users/4999039/sherlock-homies"}, "reply_to_user": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "edited": false, "score": 0, "creation_date": 1499856913, "post_id": 45052314, "comment_id": 77084549, "body": "first of all thank you! I guess thats exactly where my problem is. The instance names do not match the part names. Is there a way to change my search query so it only looks for instancenames?"}, {"owner": {"reputation": 143, "user_id": 4999039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b9028a52fa1dd8e24a1fc5f25d3f2c3?s=128&d=identicon&r=PG&f=1", "display_name": "Sherlock Homies", "link": "https://stackoverflow.com/users/4999039/sherlock-homies"}, "reply_to_user": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "edited": false, "score": 0, "creation_date": 1499859189, "post_id": 45052314, "comment_id": 77086010, "body": "i tried doing this :  hash = Left(DokumentArrayNew(n),len(DokumentArrayNew(n)-1)) and i get error type conflict!"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 4999039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b9028a52fa1dd8e24a1fc5f25d3f2c3?s=128&d=identicon&r=PG&f=1", "display_name": "Sherlock Homies", "link": "https://stackoverflow.com/users/4999039/sherlock-homies"}, "edited": false, "score": 0, "creation_date": 1499931126, "post_id": 45062903, "comment_id": 77120818, "body": "did but still nothing happens."}], "tags": [], "owner": {"reputation": 894, "user_id": 6591514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d491bd47cceefd875ac99174befa1720?s=128&d=identicon&r=PG&f=1", "display_name": "Quima", "link": "https://stackoverflow.com/users/6591514/quima"}, "is_accepted": true, "score": 1, "last_activity_date": 1499876092, "creation_date": 1499876092, "answer_id": 45062903, "question_id": 45052314, "link": "https://stackoverflow.com/questions/45052314/selecting-a-catia-part-in-a-for-loop/45062903#45062903", "title": "Selecting a Catia part in a for loop", "body": "<p>Your <code>Selection.Search</code> is searching for the word <code>\"Hash\"</code> and not what is inside the variable <code>hash</code></p>\n\n<p>Change your <code>Select Case</code> statements to this:</p>\n\n<pre><code>Set sel = catia.activedocument.selection\nsel.search \"Name =*\" &amp; hash &amp; \"*,all\"\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 4999039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b9028a52fa1dd8e24a1fc5f25d3f2c3?s=128&d=identicon&r=PG&f=1", "display_name": "Sherlock Homies", "link": "https://stackoverflow.com/users/4999039/sherlock-homies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2361, "favorite_count": 2, "accepted_answer_id": 45062903, "answer_count": 1, "score": 1, "last_activity_date": 1499876092, "creation_date": 1499847988, "last_edit_date": 1499861181, "question_id": 45052314, "link": "https://stackoverflow.com/questions/45052314/selecting-a-catia-part-in-a-for-loop", "title": "Selecting a Catia part in a for loop", "body": "<p>There is a small error in my <code>For</code> loop as it will not select the part that I want to color. I used a variable hash to put all the names of the document there and then tried the Catia function to color, but still got nothing!</p>\n\n<p>Below is a part fo the code.\nProblem zone is the <code>Select Case</code>. It wont actually select and color the part if found.</p>\n\n<p>UPDATE: now i know exactly where the problem is, it is inside case during selection of the part and coloring it. somehow it wont even select the part.</p>\n\n<pre><code>For n = 1 To DokAnzahl\n    Set Dokument = DokumentArray(n)\n\n    ReDim DokumentArrayNew(DokAnzahl)\n    DokumentArrayNew(n)  = CStr(Dokument.Name)\n\n    For j = 1 To UBound(arrNamen)\n        If arrNamenNew(j) = Left(DokumentArrayNew(n), Len(arrNamenNew(1))) Then\n            'MsgBox \"They are equal!\"\n            hash = DokumentArrayNew(n)\n            ColorCode(j) = arrFarben(j)\n            'MsgBox ColorCode(j) checked\n\n            m = j+1\n\n            Select Case ColorCode(j)\n                Case \"NEU\" 'rot\n                    Set sel = catia.activedocument.selection\n                    sel.search \"Name =hash,all\"\n                    sel.visproperties.setRealColor 240, 1, 1, 1\n                Case \"entf\u00e4llt\" 'Gelb\n                    Set sel = catia.activedocument.selection\n                    sel.search \"Name =hash,all\"\n                    sel.visproperties.setRealColor 240, 240, 16, 1\n                Case \"COP\" 'Gr\u00fcn\n                    Set sel = catia.activedocument.selection\n                    sel.search \"Name =hash,all\"\n                    sel.visproperties.setRealColor 30, 240, 60, 1\n                Case Else\n                    MsgBox \"no color info\"\n            End Select\n        End If\n    Next\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1499847983, "post_id": 45052185, "comment_id": 77078050, "body": "Try it like this and see if that works: If Val(broker(1, i)) &lt;&gt; Val(nhc(1, i)) Then deviance = True"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1499848149, "post_id": 45052185, "comment_id": 77078174, "body": "^^ and, better still, change the statement to be performed when the values aren&#39;t the same from <code>deviance = True</code> to <code>deviance = True : Exit For</code> - there is no point looking at all the rest of the values once you decide that one of them is not equal."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1499852977, "post_id": 45052185, "comment_id": 77081706, "body": "floating calculation problems?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1499855915, "post_id": 45052185, "comment_id": 77083843, "body": "Hopefully going to learn something here - in the function arguments how can you have a space: <code>source 1</code> and <code>source 2</code>?  Are they even used?"}, {"owner": {"reputation": 1001, "user_id": 5168024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7047705ce2829394a5c2c325d96eb0e?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilius", "link": "https://stackoverflow.com/users/5168024/nautilius"}, "edited": false, "score": 0, "creation_date": 1499858504, "post_id": 45052185, "comment_id": 77085562, "body": "I edited away the names of these two, there should not be spaces as you point out.   Unfortunately I cant use Val, this is because I also need to control the currency.  And in repect of the break line, I use this sheet to get an overview of which lines differs, but otherwise I see the thought behind the solution ;)."}, {"owner": {"reputation": 1001, "user_id": 5168024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7047705ce2829394a5c2c325d96eb0e?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilius", "link": "https://stackoverflow.com/users/5168024/nautilius"}, "edited": false, "score": 0, "creation_date": 1499869375, "post_id": 45052185, "comment_id": 77094040, "body": "I think I might have figured out why I get a deviation, and why it gets solved when I click it.  If I take the value where I get deviation, lets call it A, and subtract the number from my warehouse, lets call that B. The value should be #DIV/0!,  however  (A-B)/(A-B) = 1. Meaning that there is a difference between the two numbers, and that when I click A the format or something changes."}], "owner": {"reputation": 1001, "user_id": 5168024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7047705ce2829394a5c2c325d96eb0e?s=128&d=identicon&r=PG&f=1", "display_name": "Nautilius", "link": "https://stackoverflow.com/users/5168024/nautilius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499847962, "creation_date": 1499847652, "last_edit_date": 1499847962, "question_id": 45052185, "link": "https://stackoverflow.com/questions/45052185/my-excel-macro-does-not-automatically-recognize-all-numbers-that-are-equal", "title": "My excel macro does not automatically recognize all numbers that are equal", "body": "<p>I am trying to compare two different datasets, and have written an Excel macro to do so, for code see below. My problem is that when I paste numbers from the external data, and my macro compares it with the data in my warehouse, for some cells it does not recognize that they are equal and I get the message \"Deviance\". However if I click into these cells, and don't edit them just click into them and press enter the macro recognizes that they are equal, and returns \"OK\".</p>\n\n<p>Macro code:</p>\n\n<pre><code>Function compare(relevant, source 1, Source 2, n)\n\n deviance = False\n\n For i = 1 To n\n     If relevant(1, i) &lt;&gt; \"\" Then\n    If broker(1, i) &lt;&gt; nhc(1, i) Then deviance = True\nEnd If\n Next i\n\nIf deviance Then\n   compare = \"Deviance\"\n   Else\n   compare = \"OK\"\nEnd If \n</code></pre>\n\n<p>In Excel the system looks like below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/aLlnw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aLlnw.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vb.net", "vba"], "comments": [{"owner": {"reputation": 356, "user_id": 3736645, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9a8c3dc3ee6e3bee5dd71e0edd2fc673?s=128&d=identicon&r=PG&f=1", "display_name": "muffi", "link": "https://stackoverflow.com/users/3736645/muffi"}, "edited": false, "score": 0, "creation_date": 1499847436, "post_id": 45052034, "comment_id": 77077675, "body": "Maybe this question will help you <a href=\"https://stackoverflow.com/questions/82838/best-way-to-read-commandline-parameters-in-console-application\" title=\"best way to read commandline parameters in console application\">stackoverflow.com/questions/82838/&hellip;</a>"}, {"owner": {"reputation": 79, "user_id": 3979549, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b078a17284bc9b6d596db1511c184358?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3979549/rob"}, "reply_to_user": {"reputation": 356, "user_id": 3736645, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9a8c3dc3ee6e3bee5dd71e0edd2fc673?s=128&d=identicon&r=PG&f=1", "display_name": "muffi", "link": "https://stackoverflow.com/users/3736645/muffi"}, "edited": false, "score": 0, "creation_date": 1499851432, "post_id": 45052034, "comment_id": 77080526, "body": "Thanks for the link. Unfortunately it doesn&#39;t help me as the &quot;GetCommandLineArgs&quot; is always empty when the VB.NET program loads."}, {"owner": {"reputation": 356, "user_id": 3736645, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9a8c3dc3ee6e3bee5dd71e0edd2fc673?s=128&d=identicon&r=PG&f=1", "display_name": "muffi", "link": "https://stackoverflow.com/users/3736645/muffi"}, "edited": false, "score": 0, "creation_date": 1499851843, "post_id": 45052034, "comment_id": 77080843, "body": "If you use this like in the link above: <code>Sub Main(ByVal args() As String)</code> then you don&#39;t need anything you mentioned, you have the command line arguments in the string array args()!"}, {"owner": {"reputation": 79, "user_id": 3979549, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b078a17284bc9b6d596db1511c184358?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3979549/rob"}, "reply_to_user": {"reputation": 356, "user_id": 3736645, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/9a8c3dc3ee6e3bee5dd71e0edd2fc673?s=128&d=identicon&r=PG&f=1", "display_name": "muffi", "link": "https://stackoverflow.com/users/3736645/muffi"}, "edited": false, "score": 0, "creation_date": 1499865399, "post_id": 45052034, "comment_id": 77090927, "body": "It still returns nothing. Is there another / better way to achieve this?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1499868625, "post_id": 45052034, "comment_id": 77093435, "body": "So you have the source code for <code>HP_CheckForUpdates.exe</code>? I suggest first simply testing that program alone with command line arguments. Take VBA out of the equation and establish that you can recognise command line arguments in .Net (it works for everyone else). Don&#39;t try and tack a bunch of stuff together and think it&#39;ll work - unit test each piece individually. Start with <code>HP_CheckForUpdates.exe</code>"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 2594315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34ff699a6a3212691bc697002ea07ffa?s=128&d=identicon&r=PG", "display_name": "Ali Ashraf", "link": "https://stackoverflow.com/users/2594315/ali-ashraf"}, "edited": false, "score": 0, "creation_date": 1499937551, "post_id": 45059489, "comment_id": 77125213, "body": "You can test by placing both sender and receiver console app in same folder and run the sender, it will call the receiver and display the param it received from sender."}], "tags": [], "owner": {"reputation": 119, "user_id": 2594315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34ff699a6a3212691bc697002ea07ffa?s=128&d=identicon&r=PG", "display_name": "Ali Ashraf", "link": "https://stackoverflow.com/users/2594315/ali-ashraf"}, "is_accepted": false, "score": 0, "last_activity_date": 1499867155, "creation_date": 1499867155, "answer_id": 45059489, "question_id": 45052034, "link": "https://stackoverflow.com/questions/45052034/pass-information-from-vba-to-vb-net/45059489#45059489", "title": "Pass information from VBA to VB.NET", "body": "<p>Here is how you can send the command line params from one vb program to the other vb program</p>\n\n<p><strong>Sender module:</strong></p>\n\n<pre><code>Module Module_Sender\n\n    Sub Main()\n\n        Dim strCommand As String\n        strCommand = \"CommandReciever.exe\" + Space(1) + \" ali\"\n\n        Console.WriteLine(\"Sending shell command ... \")\n\n        Interaction.Shell(strCommand, AppWinStyle.NormalFocus)\n\n    End Sub\n\nEnd Module\n</code></pre>\n\n<p><strong>Receiver Module:</strong></p>\n\n<pre><code>Module Module_Reciever\n\n    Sub Main()\n        Dim args() As String = System.Environment.GetCommandLineArgs()\n\n        If (args.Length &gt; 0) Then\n            'display param And exit\n            Console.WriteLine(\"Program param = \" + args(1))\n            Console.WriteLine(\"press enter key to exit ...\")\n            Console.Read()\n            Return 'System.Environment.Exit(1);\n        Else\n            Console.WriteLine(\"Hey, Program id param expected ...\")\n        End If\n\n\n    End Sub\n\nEnd Module\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 3979549, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b078a17284bc9b6d596db1511c184358?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3979549/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499867155, "creation_date": 1499847196, "question_id": 45052034, "link": "https://stackoverflow.com/questions/45052034/pass-information-from-vba-to-vb-net", "title": "Pass information from VBA to VB.NET", "body": "<p>I'm trying to pass a string from a VBA application (running through MicroStation - CAD Draftiong Tool) to a VB.NET program but having some difficulty. I have found a couple of threads on here to do similar but mine doesn't seem to want to work.</p>\n\n<p>The VBA part of the issue is here. This code came from another Stackoverflow thread asking a similar question to what i am.</p>\n\n<pre><code>    Dim strProgramName As String\n    Dim strArgument As String\n\n    strProgramName = HPDIR &amp; \"Utilities\\HP_CheckForUpdates.exe\"\n    strArgument = \"/ver=\" &amp; vVersion(0)\n\n    Call Shell(\"\"\"\" &amp; strProgramName &amp; \"\"\" \"\"\" &amp; strArgument &amp; \"\"\"\", vbNormalFocus)\n</code></pre>\n\n<p>My issue is how can i get my VB.NET program to read the argument above?\nOn another thread i found \"Environemnt.GetCommandLineArgs\", but mine always returns \"System.String[]\"</p>\n\n<p>Essentially all i am trying to do is grab the string from VBA and display it in VB.NET. I am happy to hear of other / better ways to do it rather than arguments.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1499846503, "post_id": 45051776, "comment_id": 77077023, "body": "you need to share your <code>FirstMondayOfYear</code> function, what value are you getting for <code>StartDate</code> when running in debug mode ?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 4, "creation_date": 1499846615, "post_id": 45051776, "comment_id": 77077098, "body": "<code>StartDate</code> remains the same in the loop, unless im mistaken?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1499846616, "post_id": 45051776, "comment_id": 77077100, "body": "Also, where do you increment the value of <code>StartDate</code> inside the loop <code>Do While StartDate &lt; CurrentDate</code> ? don&#39;t you mean to add at the end <code>StartDate = StartDate +7</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1499847194, "post_id": 45051933, "comment_id": 77077492, "body": "I always add a break point at things like <code>wend</code> and <code>loop</code> when working, just in case :)"}], "tags": [], "owner": {"reputation": 285, "user_id": 5736199, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0622e2e2e2bdcc4d0ec0935171636704?s=128&d=identicon&r=PG&f=1", "display_name": "SBozhko", "link": "https://stackoverflow.com/users/5736199/sbozhko"}, "is_accepted": false, "score": 0, "last_activity_date": 1499846867, "creation_date": 1499846867, "answer_id": 45051933, "question_id": 45051776, "link": "https://stackoverflow.com/questions/45051776/excel-vba-do-while-loop-with-2-dates/45051933#45051933", "title": "EXCEL VBA - Do While loop with 2 dates", "body": "<p>After looking at this myself I realized I wasn't increasing the startdate hence the loop was infinite. Thanks to @Nathan_Sav for pointing this out in the comments too.</p>\n"}, {"comments": [{"owner": {"reputation": 285, "user_id": 5736199, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0622e2e2e2bdcc4d0ec0935171636704?s=128&d=identicon&r=PG&f=1", "display_name": "SBozhko", "link": "https://stackoverflow.com/users/5736199/sbozhko"}, "edited": false, "score": 0, "creation_date": 1499853429, "post_id": 45052266, "comment_id": 77082031, "body": "That&#39; a good idea ill keep this in mind as it definitely looks useful, but I use another function to get the start date so I don&#39;t particularly need to implement this right now"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1499847871, "creation_date": 1499847871, "answer_id": 45052266, "question_id": 45051776, "link": "https://stackoverflow.com/questions/45051776/excel-vba-do-while-loop-with-2-dates/45052266#45052266", "title": "EXCEL VBA - Do While loop with 2 dates", "body": "<p>If you decide you need to maintain the value of <code>StartDate</code> (e.g. to use later in the code), you could replace your loop with:</p>\n\n<pre><code>i = 0\nDo While StartDate + i * 7 &lt; CurrentDate\n    wsCRC.Cells(5, i + 12) = StartDate + i * 7\n    wsCRC.Cells(5, i + 12).EntireColumn.AutoFit\n    i = i + 1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 5736199, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0622e2e2e2bdcc4d0ec0935171636704?s=128&d=identicon&r=PG&f=1", "display_name": "SBozhko", "link": "https://stackoverflow.com/users/5736199/sbozhko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1394, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499847871, "creation_date": 1499846385, "last_edit_date": 1499846538, "question_id": 45051776, "link": "https://stackoverflow.com/questions/45051776/excel-vba-do-while-loop-with-2-dates", "title": "EXCEL VBA - Do While loop with 2 dates", "body": "<p>Working on populating a row in excel with dates between a start date and current date. The population is weekly and below is the function I have made. It works fine up until the point where it doesn't stop but continues to go infinitely until there is an overflow error hence my assumption is that CurrentDate is not working properly. </p>\n\n<p>The 2 dates used are <code>StartDate = 04/1/2016</code> and <code>CurrentDate = 12/07/2017</code>. </p>\n\n<p>Any help or suggestions would be greatly appreciated.</p>\n\n<pre><code>Public Function PopulateStartOfWeekDates()\n\n    Dim wsCRC As Worksheet\n    Set wsCRC = Worksheets(\"CRC\")\n\n    Dim StartDate As Date\n    Dim CurrentDate As Date\n    StartDate = FirstMondayOfYear()\n    CurrentDate = Date\n\n    Dim WeekOffset As Integer\n    Dim i As Integer\n    i = 12\n    WeekOffset = 0\n\n    Debug.Print StartDate\n    Debug.Print CurrentDate\n\n    Do While StartDate &lt; CurrentDate        \n        wsCRC.Cells(5, i) = StartDate + WeekOffset\n        wsCRC.Cells(5, i).EntireColumn.AutoFit\n        i = i + 1\n        WeekOffset = WeekOffset + 7                    \n    Loop\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "if-statement", "text", "range", "cells"], "comments": [{"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1499846056, "post_id": 45051596, "comment_id": 77076697, "body": "The code <code>If Cells(i, 1).value = &quot;text&quot; Then</code> should work. However, you should post some more code, as it is unclear what makes the code run. Is it manually executed, or should it run on Worksheet_Change, etc?"}, {"owner": {"reputation": 1, "user_id": 8294181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ceb26ae0cd94343d55998a745085aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sporre", "link": "https://stackoverflow.com/users/8294181/sporre"}, "edited": false, "score": 0, "creation_date": 1499847065, "post_id": 45051596, "comment_id": 77077405, "body": "Okay, so I&#39;ve got it to work when i activate the worksheet, however it doesn&#39;t work when a checkbox changes to false. The only difference is I have multple statements in the IF statement, as in :    If Cells(i, 1).value = &quot;text1&quot; or Cells(i, 1).value = &quot;text2&quot; then"}, {"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1499847243, "post_id": 45051596, "comment_id": 77077521, "body": "Try posting a bit more code. The error does not originate from the <code>If</code> statement you&#39;ve posted."}, {"owner": {"reputation": 1, "user_id": 8294181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ceb26ae0cd94343d55998a745085aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sporre", "link": "https://stackoverflow.com/users/8294181/sporre"}, "edited": false, "score": 0, "creation_date": 1499847727, "post_id": 45051596, "comment_id": 77077872, "body": "<code>Private Sub UT_Change() If UT.Value = True Then  &#39;do stuff  End If   ElseIf UT.Value = False Then            If Cells(1, counter).Value = &quot;text1&quot; Or Cells(1, counter).Value = &quot;text2&quot; Or Cells(1, counter).Value = &quot;text3&quot; Then            &#39;do stuff        End If   End If  End Sub</code> Sorry, cant seem to get the formatting right"}, {"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1499848081, "post_id": 45051596, "comment_id": 77078129, "body": "Try editing your original post, instead of posting it as a comment. You should also specify what <code>UT.Value</code> is."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1499849666, "post_id": 45051596, "comment_id": 77079177, "body": "Either you <code>counter</code> is not a number or it is &lt;=0. Check it with <code>Debug.Print counter</code>. Or at least tell us how it is defined and assigned?"}, {"owner": {"reputation": 1, "user_id": 8294181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ceb26ae0cd94343d55998a745085aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sporre", "link": "https://stackoverflow.com/users/8294181/sporre"}, "edited": false, "score": 0, "creation_date": 1499850076, "post_id": 45051596, "comment_id": 77079521, "body": "it is defined as DIm counter as Integer and assigned the value 1 as the UserForm is activated"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8294181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ceb26ae0cd94343d55998a745085aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sporre", "link": "https://stackoverflow.com/users/8294181/sporre"}, "edited": false, "score": 0, "creation_date": 1499846554, "post_id": 45051682, "comment_id": 77077064, "body": "When I try it i get an error message: &quot;Application-defined or object-defined error&quot;"}], "tags": [], "owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "is_accepted": false, "score": 1, "last_activity_date": 1499846687, "last_edit_date": 1499846687, "creation_date": 1499846132, "answer_id": 45051682, "question_id": 45051596, "link": "https://stackoverflow.com/questions/45051596/vba-excel-if-cellscounter-1-text-then/45051682#45051682", "title": "VBA excel, if Cells(counter,1)=&quot;text&quot; then", "body": "<p>This one will work</p>\n\n<pre><code>if (Trim(ThisWorkbook.Worksheets(\"Sheet1\").Cells(counter, 1).Value)=\"text\") Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 162, "user_id": 6679860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1286143004743762/picture?type=large", "display_name": "Krystian Koz\u0142owski", "link": "https://stackoverflow.com/users/6679860/krystian-koz%c5%82owski"}, "is_accepted": false, "score": 0, "last_activity_date": 1499848331, "last_edit_date": 1499848331, "creation_date": 1499847163, "answer_id": 45052027, "question_id": 45051596, "link": "https://stackoverflow.com/questions/45051596/vba-excel-if-cellscounter-1-text-then/45052027#45052027", "title": "VBA excel, if Cells(counter,1)=&quot;text&quot; then", "body": "<p>This should work:</p>\n\n<pre><code>If Worksheets(\"Name of your worksheet\").Cells(counter, 1).Value)=\"text\" Then\n    'execute some code\nEnd if\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8294181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ceb26ae0cd94343d55998a745085aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sporre", "link": "https://stackoverflow.com/users/8294181/sporre"}, "edited": false, "score": 0, "creation_date": 1499850001, "post_id": 45052921, "comment_id": 77079458, "body": "Still the same problem, it higlights the line with the Cells(1, counter).value=&quot;text1&quot; etc and gives me the same error message"}, {"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "reply_to_user": {"reputation": 1, "user_id": 8294181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ceb26ae0cd94343d55998a745085aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sporre", "link": "https://stackoverflow.com/users/8294181/sporre"}, "edited": false, "score": 0, "creation_date": 1499850769, "post_id": 45052921, "comment_id": 77080032, "body": "The issue might be your <code>Counter</code>. I have tried adding a simple check for its value, to the code. It does not handle all scenarios though."}, {"owner": {"reputation": 1, "user_id": 8294181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ceb26ae0cd94343d55998a745085aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sporre", "link": "https://stackoverflow.com/users/8294181/sporre"}, "edited": false, "score": 0, "creation_date": 1499851554, "post_id": 45052921, "comment_id": 77080621, "body": "Yeah, the problem was I tried to call for the counter in several different subs and it was not a public integer. Thanks for your help!"}], "tags": [], "owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "is_accepted": true, "score": 0, "last_activity_date": 1499850689, "last_edit_date": 1499850689, "creation_date": 1499849632, "answer_id": 45052921, "question_id": 45051596, "link": "https://stackoverflow.com/questions/45051596/vba-excel-if-cellscounter-1-text-then/45052921#45052921", "title": "VBA excel, if Cells(counter,1)=&quot;text&quot; then", "body": "<p>You cannot use <code>End If</code> and then follow up with and <code>ElseIf</code>. The first one ends the <code>If</code> statement entirely, meaning that the you would have to begin a new one. Based on you edit, I think your code should look something like this:</p>\n\n<pre><code>Private Sub CheckBox_Change()\n    If CheckBox.Value = True Then\n       'do stuff\n    ElseIf CheckBox.Value = False Then\n        If (Counter &lt; 1) Then\n            'Show an error if the counter is less than 1\n            MsgBox \"Error: Counter less than 1\", vbCritical\n        ElseIf Cells(1, counter).Value = \"text1\" Or Cells(1, counter).Value = \"text2\" Or Cells(1, counter).Value = \"text3\" Then\n           'do stuff\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8294181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ceb26ae0cd94343d55998a745085aa?s=128&d=identicon&r=PG&f=1", "display_name": "Sporre", "link": "https://stackoverflow.com/users/8294181/sporre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2826, "favorite_count": 0, "accepted_answer_id": 45052921, "answer_count": 3, "score": -1, "last_activity_date": 1499851622, "creation_date": 1499845843, "last_edit_date": 1499851622, "question_id": 45051596, "link": "https://stackoverflow.com/questions/45051596/vba-excel-if-cellscounter-1-text-then", "title": "VBA excel, if Cells(counter,1)=&quot;text&quot; then", "body": "<p>I'm trying to execute an if statement that only activates if a certain cell contains a specific text. The cell in question needs to be dynamically altered based on a integer that will change, so far ive tried multiple methods but nothing seems to work.</p>\n\n<pre><code>If Cells(counter, 1).text = \"text\" then\n\nIf Cells(counter, 1).value = \"text\" then\n\nIf Range(Cells(counter, 1)).text = \"text then\n\nIf Range(Cells(counter, 1)).value = \"text then\n</code></pre>\n\n<p>This seems like a simple procedure, does someone have a solution?</p>\n\n<p>Thanks, Sporre</p>\n\n<p>Edit:</p>\n\n<pre><code>Private Sub CheckBox_Change() \nIf CheckBox.Value = True Then \n   'do stuff \nEnd If \nElseIf CheckBox.Value = False Then \n    If Cells(1, counter).Value = \"text1\" Or Cells(1, counter).Value = \n    \"text2\" Or Cells(1, counter).Value = \"text3\" Then\n       'do stuff \n    End If \nEnd If \nEnd Sub\n</code></pre>\n\n<p>This is where i get the error message \"Application-definded or Object-defined error\".</p>\n\n<p>Edit 2:\nThe problem was I tried to call for the counter in several different subs and it was not a public integer. Thanks for your help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1499844728, "post_id": 45050979, "comment_id": 77075795, "body": "For your function, no. All arguments aren&#39;t optional. But if change your function to <code>Public Function kuc_1(Optional Mj, Optional R1, Optional R2, Optional S, Optional J1, Optional J2)</code> then you can omit all optional arguments."}, {"owner": {"reputation": 83, "user_id": 7007248, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ac6e03af8d011550936c37c52c31560?s=128&d=identicon&r=PG&f=1", "display_name": "user155754", "link": "https://stackoverflow.com/users/7007248/user155754"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1499845206, "post_id": 45050979, "comment_id": 77076107, "body": "Thanks, that&#39;s it"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1499997524, "post_id": 45050979, "comment_id": 77159521, "body": "declare types from arguments. And second tip, once optional is used, you can add only optionals for next arguments."}], "answers": [{"comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1499901860, "post_id": 45051358, "comment_id": 77111267, "body": "The call to <code>kuc_1(1;;2)</code> just doesn&#39;t work as either a spreadsheet function or VBA call."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1499922573, "post_id": 45051358, "comment_id": 77116246, "body": "@Enigmativity Why is that, it works at my end. Of course that depends on on how your code is set up. Can you post the code you ran and failed? Also the <code>;</code> may not be your default separator. I use <code>,</code> on my end."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1499922999, "post_id": 45051358, "comment_id": 77116428, "body": "How does it work for you? When I type <code>kuc_1(1;;2)</code> or <code>kuc_1(1,,2)</code> in a <code>Public Sub</code> method it is a syntax error."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1499923442, "post_id": 45051358, "comment_id": 77116585, "body": "@Enigmativity It is hard to say without seeing your <code>kuc_1</code> function. If you can post it, please do and comment the link for me to check."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1499923535, "post_id": 45051358, "comment_id": 77116618, "body": "I have created a <code>Public Sub Foo()</code> in the same file as your <code>Public Function kuc_1</code> and then, within <code>Foo</code>, I try to call <code>kuc_1(1;;2)</code> and <code>kuc_1(1,,2)</code> and neither work."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1499923580, "post_id": 45051358, "comment_id": 77116637, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/149068/discussion-between-l42-and-enigmativity\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 3, "last_activity_date": 1499988447, "last_edit_date": 1499988447, "creation_date": 1499845205, "answer_id": 45051358, "question_id": 45050979, "link": "https://stackoverflow.com/questions/45050979/excel-vba-call-function-without-passing-all-the-arguments/45051358#45051358", "title": "Excel VBA - call function without passing all the arguments", "body": "<p><strong>Making use of</strong> <code>Optional</code> <strong>keyword to declare optional arguments</strong></p>\n\n<p>To expound on my comment, you can assign <code>Optional Arguments</code> in a function like:</p>\n\n<pre><code>Public Function kuc_1(Optional Mj, Optional R1, _\n                      Optional R2, Optional S, _\n                      Optional J1, Optional J2)\n\n    '/* your codes here */\n\nEnd Function\n</code></pre>\n\n<p>To use the function, you can omit arguments you don't need like:</p>\n\n<pre><code>kuc_1(1;;2) '/* here you supply Mj and R2 and omit the rest of the arguments\n</code></pre>\n\n<p><sup><strong>Note:</strong> If your default separator is not semi-colon <code>;</code>, try using comma <code>,</code>. I used semi-colon since OP posted the sample usage using a semi-colon. In VBE though, you use comma <code>,</code>.</sup></p>\n\n<p><strong>Edit1:</strong> <em>I received a comment (and a down-vote for that matter) for not being clear on my post. It may be clear to OP but may not be to others who read it especially those not that familiar with VBA. So I'll try to make this as clear as possible. :)</em></p>\n\n<p><strong>Handling Optional Arguments</strong></p>\n\n<p>In above code, we simply declared the arguments optional. It doesn't end there because we need to handle <em>optional arguments</em> within our code. Although it is optional, we would need to make it clear how the code runs if the optional arguments are supplied or not.</p>\n\n<ul>\n<li><p><strong>Check if optional arguments are supplied</strong> - There are different ways to do this depending on the type of variable declared as <code>Optional</code>. For example, variables declared as <code>Variant</code> can be tested if supplied using <code>IsMissing</code> function. Consider below:</p>\n\n<pre><code>Private Function cRept(text As String, number As Integer, _\n                       Optional delimiter As Variant) As String\n\n    cRept = Join(Split(String$(number, \".\"), \".\"), delimiter &amp; text)\n    cRept = Mid(cRept, Len(delimiter) + 1)\n\nEnd Function\n</code></pre>\n\n<p>Take note of the <code>Optional</code> variable <code>delimiter</code>. This code as is will generate a <code>Type mismatch error</code> if you do not supply the 3rd argument <code>delimiter</code> even if it is <code>Optional</code>. To handle this, we will use <code>IsMissing</code>.</p>\n\n<pre><code>Private Function cRept(text As String, number As Integer, _\n                       Optional delimiter As Variant) As String\n\n    If IsMissing(delimiter) Then delimiter = \"\"\n    cRept = Join(Split(String$(number, \".\"), \".\"), delimiter &amp; text)\n    cRept = Mid(cRept, Len(delimiter) + 1)\n\nEnd Function\n</code></pre>\n\n<p>Above code will now execute even if you supply <code>delimiter</code> argument or not. Below are additional ways to check depending on what type of optional variable you have:</p>\n\n<pre><code>If a = \"\" Then a = \"#N/A\" '/* optional variable a declared as String */\nIf a = 0 Then a = 1 '/* optional variable a declared as Integer */\nIf a Is Nothing Then Set a = Application '/* optional variable a declared as Object */\n</code></pre></li>\n<li><p><strong>Set default value for optional arguments</strong> - You do this if you already know what to assign the optional argument in case it is not supplied. </p>\n\n<pre><code>Private Function cRept(text As String, number As Integer, _\n                       Optional delimiter As Variant = \"\") As String\n\n    'If IsMissing(delimiter) Then delimiter = \"\"\n    cRept = Join(Split(String$(number, \".\"), \".\"), delimiter &amp; text)\n    cRept = Mid(cRept, Len(delimiter) + 1)\n\nEnd Function\n</code></pre>\n\n<p>Above code will now run even if we omitted the check if it is supplied or not since we initialized the value of <code>delimiter</code> to <code>\"\"</code> when we call the function and that argument is not supplied.</p></li>\n<li><p><strong>Calling functions with optional arguments</strong> - Simplest is to omit the optional argument. Let us go back to OP's original function. Below is how we will call it in VBE and/or in Worksheet.</p>\n\n<pre><code>kuc_1(1, ,2) '/* supplying Mj and R2 only */\nkuc_1(, , , , ,4) '/* supplying last argument J2 only */\n</code></pre>\n\n<p>When you use it in VBA (run in VBE), you make use of the syntax <code>&lt;argument name&gt;:=</code> to supply specific argument among many optional arguments. So last example above, can be written:</p>\n\n<pre><code>kuc_1(J2:=4) '/* we specify what optional argument we are supplying */\n</code></pre></li>\n</ul>\n\n<p><sub><strong>Disclaimer:</strong> Function <code>cRept</code> above is for repeating a string just like the worksheet function <code>REPT</code>. The 3rd argument is really not necessary but used to demonstrate optional arguments.  </sub></p>\n"}], "owner": {"reputation": 83, "user_id": 7007248, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4ac6e03af8d011550936c37c52c31560?s=128&d=identicon&r=PG&f=1", "display_name": "user155754", "link": "https://stackoverflow.com/users/7007248/user155754"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1718, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1499988447, "creation_date": 1499844101, "last_edit_date": 1499988134, "question_id": 45050979, "link": "https://stackoverflow.com/questions/45050979/excel-vba-call-function-without-passing-all-the-arguments", "title": "Excel VBA - call function without passing all the arguments", "body": "<p>I have a public function</p>\n\n<pre><code>Public Function kuc_1(Mj, R1, R2, S, J1, J2)\n</code></pre>\n\n<p>Is it possible to call it without passing all the arguments,\nfor example:</p>\n\n<pre><code>kuc_1(1;5;5)\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error", "offset"], "comments": [{"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1499844152, "post_id": 45050836, "comment_id": 77075474, "body": "Instead of <code>For Each C In Diapozon.Rows</code> try <code>For Each C In Diapozon</code>"}, {"owner": {"reputation": 193, "user_id": 6708114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c64a0d2a3bb47eb608cde86fe5d2791?s=128&d=identicon&r=PG&f=1", "display_name": "maxim465", "link": "https://stackoverflow.com/users/6708114/maxim465"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1499844449, "post_id": 45050836, "comment_id": 77075647, "body": "@UGP , same result"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1499844904, "post_id": 45050836, "comment_id": 77075904, "body": "Strange, even if i use <code>.Rows</code> what is not working, i dont get the error and without <code>.Rows</code> it just works fine. And you are sure that the error is still in the same line?"}, {"owner": {"reputation": 193, "user_id": 6708114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c64a0d2a3bb47eb608cde86fe5d2791?s=128&d=identicon&r=PG&f=1", "display_name": "maxim465", "link": "https://stackoverflow.com/users/6708114/maxim465"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1499845304, "post_id": 45050836, "comment_id": 77076186, "body": "@UGP, yes , in the same line . And when i remove the condition (\u0421.Offset(0, -5).Value = 1) all works fine"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1499845449, "post_id": 45050836, "comment_id": 77076279, "body": "Try <code>Cells(C.Row, 16).Value</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1499850982, "creation_date": 1499850982, "answer_id": 45053476, "question_id": 45050836, "link": "https://stackoverflow.com/questions/45050836/using-offset-runtime-error-424-object-required/45053476#45053476", "title": "Using Offset (Runtime error 424 object required)", "body": "<p>This is something that works:</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\n    Dim k           As Long\n    Dim n           As Long\n    Dim C           As Range\n    Dim Diapozon    As Range\n\n    Set Diapozon = Range(\"A1:A10\")\n\n    k = 0\n    n = 0\n\n    For Each C In Diapozon.Rows\n\n        If C.Offset(0, 5).Value = 1 And C.Value = 1 Then\n            k = k + 1\n            If ThisWorkbook.Worksheets(\"Test\" &amp; k).Range(\"B10\").Value = 1 Then\n                n = n + 1\n            End If\n        End If\n\n    Next C\n    Debug.Print n\n\nEnd Sub\n</code></pre>\n\n<p>I have changed the Ranges, the Worksheet name and the <code>MsgBox</code> to a debug.print. Possible errors are that you do not have a <code>ListN</code> or something else...</p>\n"}], "owner": {"reputation": 193, "user_id": 6708114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c64a0d2a3bb47eb608cde86fe5d2791?s=128&d=identicon&r=PG&f=1", "display_name": "maxim465", "link": "https://stackoverflow.com/users/6708114/maxim465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 0, "accepted_answer_id": 45053476, "answer_count": 1, "score": 1, "last_activity_date": 1499850982, "creation_date": 1499843693, "last_edit_date": 1531164843, "question_id": 45050836, "link": "https://stackoverflow.com/questions/45050836/using-offset-runtime-error-424-object-required", "title": "Using Offset (Runtime error 424 object required)", "body": "<p>I want the program to look for \u201c1\u201d in column \u201cU34:U99\u201d  .And on the order number of  \u201c1\u201d checked the value in certain sheets .\nFor example : First  \u201c1\u201d  (\u041b\u0438\u0441\u04421),Second \u201c1\u201d   (\u041b\u0438\u0441\u04422) \u2026\nBut the error jumps out (Runtime error 424 object required) in line : \nIf \u0421.Offset(0, -5).Value = 1 And C.Value = 1 Then</p>\n\n<pre><code>    Sub \u043e\u0431\u0449\u0430()\n    '\u0434\u043b\u044f \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u0438\n\n    Dim k As Long, n As Long\n    Dim C As Range\n    Dim Diapozon As Range\n    Set Diapozon = Range(\"U34:U99\")\n    k = 0\n    n = 0\n    For Each C In Diapozon.Rows\n\n    If \u0421.Offset(0, -5).Value = 1 And C.Value = 1 Then\n    k = k + 1\n    If ThisWorkbook.Sheets(\"\u041b\u0438\u0441\u0442\" &amp; k &amp; \"\").Range(\"R100\").Value = 1 Then\n    n = n + 1\n    End If\n    End If\n\n    Next C\n    MsgBox n\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 1, "creation_date": 1499887489, "post_id": 45055508, "comment_id": 77105277, "body": "Use the <code>ThisProject</code> object instead of presuming that this code is running in the first project."}], "tags": [], "owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "is_accepted": true, "score": 0, "last_activity_date": 1499856345, "creation_date": 1499856345, "answer_id": 45055508, "question_id": 45050825, "link": "https://stackoverflow.com/questions/45050825/references-addfromfile-on-project-open/45055508#45055508", "title": "References.addfromfile on Project Open()", "body": "<p>Found the reason why it wasn't working. When I open the project it also opens another project for the resources. The <code>ActiveVBProject</code> is the resources project. I have fixed my issue by using the index of the project I wanted the references in.\n<code>Application.Projects(1).VBProject.References.AddFromFile (\"C:\\Program Files (x86)\\Microsoft Office\\root\\Office16\\PJCALEND.DLL\")</code></p>\n"}], "owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1141, "favorite_count": 0, "accepted_answer_id": 45055508, "answer_count": 1, "score": 0, "last_activity_date": 1593558279, "creation_date": 1499843656, "last_edit_date": 1593558279, "question_id": 45050825, "link": "https://stackoverflow.com/questions/45050825/references-addfromfile-on-project-open", "title": "References.addfromfile on Project Open()", "body": "<p>I'm trying to add references automatically.</p>\n\n<p>The code works if I run it manually but not on Project_Open()</p>\n\n<pre><code>Private Sub Project_Open(ByVal pj As Project)\n\n    Application.VBE.ActiveVBProject.References.AddFromFile (\"C:\\Program Files (x86)\\Microsoft Office\\root\\Office16\\PJCALEND.DLL\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "performance", "sorting", "formatting", "doevents"], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 2794327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36471432ab0c7779ea037601058ab197?s=128&d=identicon&r=PG&f=1", "display_name": "Arjeel", "link": "https://stackoverflow.com/users/2794327/arjeel"}, "is_accepted": true, "score": 1, "last_activity_date": 1504873368, "creation_date": 1504873368, "answer_id": 46116476, "question_id": 45050775, "link": "https://stackoverflow.com/questions/45050775/too-fast-executions-for-sorting-and-formatting-vba/46116476#46116476", "title": "Too fast executions for sorting and formatting? (VBA)", "body": "<p>Faced the same problem myself a few weeks back, I found the solution for it in some forum which sadly I don't remember. Credits go to unknown\nHowever, I have the code and it works fine:</p>\n\n<pre><code>Sub Sort()\n'Sorting code\nApplication.OnTime Now + TimeValue(a few seconds depending on your choice, pre), \" Color \"\nEnd Sub\n\n\nSub Color()\n'coloring code\nExit Sub\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 8219349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lnEEb.jpg?s=128&g=1", "display_name": "Smartskaft2", "link": "https://stackoverflow.com/users/8219349/smartskaft2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 46116476, "answer_count": 1, "score": 0, "last_activity_date": 1504873368, "creation_date": 1499843507, "question_id": 45050775, "link": "https://stackoverflow.com/questions/45050775/too-fast-executions-for-sorting-and-formatting-vba", "title": "Too fast executions for sorting and formatting? (VBA)", "body": "<p>I am in the end of my script formatting cells (mainly interior colors depending on cell value) and sorting the rows with regards to those cells' values. </p>\n\n<ul>\n<li>If I run the whole script in break mode (one line at a time) it executes the procedure perfectly.</li>\n<li>However, when I run the whole script from start to finish without pausing the formatting and sorting does not occur.</li>\n<li>I have two sub procedures, one for formatting and one for sorting. If I run these again seperately after the whole code is executed they do what they are supposed to do.</li>\n</ul>\n\n<p>The only reason I can think of is that the code is executed too fast for the amount of memory left and some commands become overwritten. I am but a VBA novice however, so please enlighten me if I am wrong.</p>\n\n<p>I have tried activating <code>ScreenUpdating</code>, as well as tried to place <code>DoEvents</code> both before and after the relevant part of the code.  </p>\n\n<p>What are your way of handling too fast code execution? Are there other ways other than <code>DoEvents</code> to free memory inside VBA code?</p>\n\n<hr>\n\n<p>My way of using <code>DoEvents</code> is to place <code>OpenForm = DoEvents</code> on a line where I think the local queue might need to be processed, or together with an If statement and <code>Mod</code> inside for loops.</p>\n\n<p>My sorting code looks like this (The variable <em>ws</em> is the worksheet):</p>\n\n<pre><code>'Sort rows\n    With ws.Range(\"AE2\").CurrentRegion\n            On Error Resume Next\n        .Sort.SortFields.Clear\n            On Error GoTo 0\n        .Cells.Sort Key1:=Range(ws.Cells(2, 33), ws.Cells(LastRow, 33)), Order1:=xlDescending, Orientation:=xlTopToBottom, Header:=xlYes\n    End With\n</code></pre>\n\n<p>My formatting code is too long and probably not relevant. But it is basically made up of If statements and interior coloring, eg.</p>\n\n<pre><code>If AbsVal &lt; 3 And AbsVal &gt;= 1 Then DiffCell.Interior.Color = vbRed\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy"], "comments": [{"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 1, "creation_date": 1499843904, "post_id": 45050759, "comment_id": 77075285, "body": "Check this out since this is answered a few times before <a href=\"https://stackoverflow.com/questions/23937262/excel-vba-copy-paste-values-only-xlpastevalues\" title=\"excel vba copy paste values only xlpastevalues\">stackoverflow.com/questions/23937262/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8293759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e09f548957ec34a5da458afc3ed081c?s=128&d=identicon&r=PG&f=1", "display_name": "T.Roustan", "link": "https://stackoverflow.com/users/8293759/t-roustan"}, "edited": false, "score": 0, "creation_date": 1499851803, "post_id": 45050894, "comment_id": 77080807, "body": "That&#39;s exactly what I needed ! thank you !"}], "tags": [], "owner": {"reputation": 162, "user_id": 6679860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1286143004743762/picture?type=large", "display_name": "Krystian Koz\u0142owski", "link": "https://stackoverflow.com/users/6679860/krystian-koz%c5%82owski"}, "is_accepted": false, "score": 1, "last_activity_date": 1499843844, "creation_date": 1499843844, "answer_id": 45050894, "question_id": 45050759, "link": "https://stackoverflow.com/questions/45050759/excel-2010-vba-macro-copying-pasting/45050894#45050894", "title": "Excel 2010 VBA Macro Copying/Pasting", "body": "<p>To copy &amp; paste only values you should use something like this in your code:</p>\n\n<pre><code>'copy range\nSheets(\"Sheet1\").Range(\"D1:D10\").Copy\n'paste only values \nSheets(\"Sheet2\").Range(\"A1\").PasteSpecial xlPasteValues\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8293759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e09f548957ec34a5da458afc3ed081c?s=128&d=identicon&r=PG&f=1", "display_name": "T.Roustan", "link": "https://stackoverflow.com/users/8293759/t-roustan"}, "edited": false, "score": 0, "creation_date": 1499851860, "post_id": 45051878, "comment_id": 77080854, "body": "Thanks for the knowledge"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1499846694, "creation_date": 1499846694, "answer_id": 45051878, "question_id": 45050759, "link": "https://stackoverflow.com/questions/45050759/excel-2010-vba-macro-copying-pasting/45051878#45051878", "title": "Excel 2010 VBA Macro Copying/Pasting", "body": "<p>If you are only trying to assign values of some cells to be the values of some other cells, and you don't want to copy formats, formulas, etc, just use the <code>.Value</code> property of the cells:</p>\n\n<pre><code>Sub sbCopyRangeToAnotherSheet()\n    Sheets(\"Sheet2\").Range(\"A1:A10\").Value = Sheets(\"Sheet1\").Range(\"D1:D10\").Value\nEnd Sub\n</code></pre>\n\n<p>This avoids all the issues inherent in using the clipboard as an intermediary in the transfer process.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 8278746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48202190d56ccd338a05bf2e8e3ea98d?s=128&d=identicon&r=PG&f=1", "display_name": "Maximuuuuuus", "link": "https://stackoverflow.com/users/8278746/maximuuuuuus"}, "is_accepted": false, "score": 0, "last_activity_date": 1499850309, "creation_date": 1499850309, "answer_id": 45053181, "question_id": 45050759, "link": "https://stackoverflow.com/questions/45050759/excel-2010-vba-macro-copying-pasting/45053181#45053181", "title": "Excel 2010 VBA Macro Copying/Pasting", "body": "<pre><code>Sheets.Range(\"D1:D10\").SpecialCells(xlCellTypeVisible).Copy Destination:=Sheet2.Range(\"A1\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8293759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e09f548957ec34a5da458afc3ed081c?s=128&d=identicon&r=PG&f=1", "display_name": "T.Roustan", "link": "https://stackoverflow.com/users/8293759/t-roustan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "closed_date": 1499852176, "answer_count": 3, "score": 0, "last_activity_date": 1499850309, "creation_date": 1499843430, "last_edit_date": 1499846474, "question_id": 45050759, "link": "https://stackoverflow.com/questions/45050759/excel-2010-vba-macro-copying-pasting", "closed_reason": "Duplicate", "title": "Excel 2010 VBA Macro Copying/Pasting", "body": "<p>I have this sheet where many cells have a numeric value (ex: 304 550.07) but that actually depend on the value of other cells in the same sheet. For example: \"D1 = C1+1\" is what can be seen in the 'Formula bar' and \"2\" is the actual numerical value of the D1 cell.</p>\n\n<p>I've looked up a way to copy the column I needed (D) and paste it on another sheet, here's the code (not mine):</p>\n\n<pre><code>Sub sbCopyRangeToAnotherSheet()\n'Method 1\nSheets(\"Sheet1\").Range(\"D1:D10\").Copy Destination:=Sheets(\"Sheet2\").Range(\"A1\")\n\n'Method 2\n'Copy the data\nSheets(\"Sheet1\").Range(\"D1:D10\").Copy\n'Activate the destination worksheet\nSheets(\"Sheet2\").Activate\n'Select the target range\nRange(\"A1\").Select\n'Paste in the target destination\nActiveSheet.Paste\nApplication.CutCopyMode = False\n\nEnd Sub   \n</code></pre>\n\n<p>So, these two methods work but only if the values of the cells are numerical (locked?) and not if they depend on the value of another cell.\nAs a result, when I try to copy the D column from 'Sheet1' to 'Sheet2', all I get is either:</p>\n\n<p>=#REF!</p>\n\n<p><strong>OR</strong></p>\n\n<p>the calculations that were defined in the Formula bar in 'Sheet1', which means that it takes the values of the depending cell for 'Sheet2'.</p>\n\n<p>All that to say that, I'm trying to find a way to copy the actual value that are written in the cell and not the calculations that lead to the result.</p>\n\n<p>PS: Really sorry for those bad explanations, first post tho ;)\nThanks.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 0, "last_activity_date": 1499845145, "creation_date": 1499845145, "answer_id": 45051335, "question_id": 45050732, "link": "https://stackoverflow.com/questions/45050732/count-the-value-x-in-vba/45051335#45051335", "title": "count the value &quot;x&quot; in vba", "body": "<p>Below code will display the <strong>message box</strong> for each sheet with count of <code>x</code>.</p>\n\n<pre><code>Sub breaking_count()\n    Const Area_x As String = \"$D$9:$I$9\"\n    Const Area_y As String = \"$K$9:$P$9\"\n    Dim Nr As Integer, Count_x As Integer, Col_Ind\n    Dim temp_Area As Range\n\n    For Nr = 4 To 1 Step -1\n        'With Worksheets(CStr(Nr))\n        With Worksheets(Nr)\n            If WorksheetFunction.CountIf(.Range(Area_y), \"*y*\") &gt; 0 Then\n                'find the index of \"y\" in Area_y\n                Col_Ind = WorksheetFunction.Match(\"y\", .Range(Area_y))\n                'Reset the range Area_y in temp_Area using offset\n                Set temp_Area = .Range(.Cells(9, 4).Offset(0, Col_Ind), .Cells(9, 9))\n                Count_x = Count_x + WorksheetFunction.CountIf(temp_Area, \"*x*\")\n            Else\n                Count_x = Count_x + WorksheetFunction.CountIf(.Range(Area_x), \"*x*\")\n            End If\n            MsgBox Worksheets(Nr).Name &amp; \" : \" &amp; Count_x\n            Count_x = 0\n        End With\n\n    Next\nEnd Sub\n</code></pre>\n\n<p>Let me know if anything is not clear.</p>\n"}], "owner": {"reputation": 3211, "user_id": 5068746, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bf27aa9347052506077eaf1ad68d0af5?s=128&d=identicon&r=PG&f=1", "display_name": "Ghost108", "link": "https://stackoverflow.com/users/5068746/ghost108"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 45051335, "answer_count": 1, "score": 0, "last_activity_date": 1499845145, "creation_date": 1499843312, "question_id": 45050732, "link": "https://stackoverflow.com/questions/45050732/count-the-value-x-in-vba", "title": "count the value &quot;x&quot; in vba", "body": "<p>i need a solution for the following situation:\nI have an Exel file with 4 sheets.\nthe structure of all sheets are the same, only the content is different.</p>\n\n<p>Explanation:</p>\n\n<ul>\n<li>The user have to set a \"x\" in the area D9:I9 (this \"x\" have to be count in all sheets. but there is an special situation:</li>\n<li>The user can set an \"y\" in the area K9:P9</li>\n</ul>\n\n<p>In that case should only count all \"x\" of this sheet after the \"y\" area</p>\n\n<p>Example:</p>\n\n<p>Sheet 1: D9:I9 (\"x\") = 6 \"x\"\n<a href=\"https://i.stack.imgur.com/HlLfa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HlLfa.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sheet 2: D9:I9 (\"x\") = 6 \"x\"\n<a href=\"https://i.stack.imgur.com/HlLfa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HlLfa.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sheet 3: D9:I9 (\"x\") = 6 \"x\" | M9 (\"y\")\n<a href=\"https://i.stack.imgur.com/oo00B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oo00B.png\" alt=\"enter image description here\"></a></p>\n\n<p>And in sheet 3 is the special situation.\nThe user has set 6 \"x\", but an \"y\" too.</p>\n\n<p>This means, that the \"x\" which are set before and in the same area like the \"y\" should not be counted.</p>\n\n<p>i have the following vba code, whichs count me all \"x\" but not wit this \"special situation\" (i don't know how)</p>\n\n<pre><code>Function breaking_count()\n\nConst Area_x As String = \"$D$9:$I$9\"\nConst Area_y As String = \"$K$9:$P$9\"\n\nDim Nr As Integer, Count_x As Integer\n\n\nFor Nr = 4 To 1 Step -1\n\n    With Worksheets(CStr(Nr))\n\n        If WorksheetFunction.CountIf(.Range(Area_y), \"*y*\") &gt; 0 Then Exit For\n        Count_x = Count_x + WorksheetFunction.CountIf(.Range(Area_x), \"*x*\")\n\n    End With\n\nNext\nEnd Function\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba", "database-schema"], "comments": [{"owner": {"reputation": 7849, "user_id": 7610456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5431d63c7d37a62d083ffc45c6fc599b?s=128&d=identicon&r=PG&f=1", "display_name": "sepupic", "link": "https://stackoverflow.com/users/7610456/sepupic"}, "edited": false, "score": 0, "creation_date": 1499846388, "post_id": 45050689, "comment_id": 77076929, "body": "&gt;&gt;&gt;How do redirect the user to the correct location based schema at log-in using Access VBA?&lt;&lt;&lt; It should be done not using VBA but by giving the right permissions. The users have to be granted the appropriate permissions on schema, not on the database. This way they will &quot;see&quot; only their schema and that is more important, they will be able to USE only the objects of their schema"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1499849854, "post_id": 45050689, "comment_id": 77079339, "body": "<code>;table=dbo.1PRD_Compliances</code> means you are using the schema <code>dbo</code> (the default schema). Just link to the tables from the appropriate schema instead."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1499851506, "post_id": 45050689, "comment_id": 77080580, "body": "See also <a href=\"https://stackoverflow.com/questions/3282665/possible-to-set-default-schema-from-connection-string\" title=\"possible to set default schema from connection string\">stackoverflow.com/questions/3282665/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 8288141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xqj5p.jpg?s=128&g=1", "display_name": "sybolt", "link": "https://stackoverflow.com/users/8288141/sybolt"}, "edited": false, "score": 0, "creation_date": 1500019277, "post_id": 45050689, "comment_id": 77167345, "body": "Andre, Thank you for your reply. The problem however is that some users have access to different schema&#39;s. When a users logs in with only access to one schema the users should be directed to the relevant schema, with multiple regions the user should be able to select the region and thereby directed to the corresponding schema."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8288141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xqj5p.jpg?s=128&g=1", "display_name": "sybolt", "link": "https://stackoverflow.com/users/8288141/sybolt"}, "edited": false, "score": 0, "creation_date": 1500019648, "post_id": 45052178, "comment_id": 77167534, "body": "Erik, thank you for your reply. the way you present the answer makes it seem quite easy to solve the problem. I will certainly have ago at this one!"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 1, "user_id": 8288141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xqj5p.jpg?s=128&g=1", "display_name": "sybolt", "link": "https://stackoverflow.com/users/8288141/sybolt"}, "edited": false, "score": 0, "creation_date": 1500057882, "post_id": 45052178, "comment_id": 77190917, "body": "If it works, please select my answer as the correct one, to show this problem has been solved"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1499848494, "last_edit_date": 1499848494, "creation_date": 1499847647, "answer_id": 45052178, "question_id": 45050689, "link": "https://stackoverflow.com/questions/45050689/how-do-i-use-vba-to-select-the-correct-database-schema/45052178#45052178", "title": "How do I use VBA to select the correct database schema", "body": "<p>I will only answer your first question, although you can use the same technique to achieve an answer to the others.</p>\n\n<p>You can alter the connection string through the <code>TableDef.Connect</code> property.</p>\n\n<pre><code>Public Sub AddNoSchema()\n    Dim db As DAO.Database\n    Set db = CurrentDb()\n    Dim tdf As Variant 'DAO.TableDef\n    For Each tdf In db.TableDefs\n        If tdf.Connect LIKE \"*SQL Server*\" Then\n            tdf.Connect = tdf.Connect &amp; \";SCHEMA=no\"\n            tdf.RefreshLink\n        End If\n    Next tdf\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8288141, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xqj5p.jpg?s=128&g=1", "display_name": "sybolt", "link": "https://stackoverflow.com/users/8288141/sybolt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594651009, "creation_date": 1499843184, "last_edit_date": 1594651009, "question_id": 45050689, "link": "https://stackoverflow.com/questions/45050689/how-do-i-use-vba-to-select-the-correct-database-schema", "title": "How do I use VBA to select the correct database schema", "body": "<p>I have created an Access 2010 database with linked tables on SQL-server.\nButtons on the main form call stored procedures that enable users to add data from their respective source files, mainly Excel tables. The development of stored procedures and triggers has been outsourced.</p>\n\n<p>The database has been rolled out in different locations/countries. \nTo improve performance and to prevent users from getting access to data from locations other than their own management has decided for an update of the database. The developing company has now come up with the following:\nThe database will be split into different schemas, each location will get his own schema. The selection of the schema will be based on the location of the user\u2019s region as defined in properties on ActiveDirectory. I can store this location in a public variable.</p>\n\n<p>To create the links to tables on SQL-server I have used the Access built-in wizard. A connection to a table is at the moment now described as something like:\nODBC;Description=NETWPROD;Driver=SQL Server;Server=CCMDB11,cc.acme.corp;Trusted connection=Yes;app=Microsoft Office 2010;Database=1PRD;table=dbo.1PRD_Compliances</p>\n\n<p>My questions to you is the following:</p>\n\n<p>Is it possible to add a property like  \u2018SCHEMA=no\u2019 in the tables description. And if yes, how do I add this using Access VBA.</p>\n\n<p>Or</p>\n\n<p>How do redirect the user to the correct location based schema at log-in using Access VBA?</p>\n\n<p>Or\nHow do I redirect the user to the correct views on SQL-server, the view having filtered the data on relevant location.</p>\n\n<p>Any help is greatly appreciated.</p>\n"}, {"tags": ["mysql", "arrays", "ms-access", "vba"], "comments": [{"owner": {"reputation": 242, "user_id": 6379460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30b54a852865103dd823cd63aedd7b8?s=128&d=identicon&r=PG&f=1", "display_name": "Sim", "link": "https://stackoverflow.com/users/6379460/sim"}, "edited": false, "score": 0, "creation_date": 1499842876, "post_id": 45050405, "comment_id": 77074643, "body": "What is the error you are getting?"}, {"owner": {"reputation": 47, "user_id": 5479140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b59052409aaa2314d943ee0f44a0126?s=128&d=identicon&r=PG&f=1", "display_name": "RAKH", "link": "https://stackoverflow.com/users/5479140/rakh"}, "reply_to_user": {"reputation": 242, "user_id": 6379460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30b54a852865103dd823cd63aedd7b8?s=128&d=identicon&r=PG&f=1", "display_name": "Sim", "link": "https://stackoverflow.com/users/6379460/sim"}, "edited": false, "score": 0, "creation_date": 1499843055, "post_id": 45050405, "comment_id": 77074756, "body": "Type mismatch on   <code>DataArr = XDATA.GetRows</code>"}, {"owner": {"reputation": 242, "user_id": 6379460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30b54a852865103dd823cd63aedd7b8?s=128&d=identicon&r=PG&f=1", "display_name": "Sim", "link": "https://stackoverflow.com/users/6379460/sim"}, "edited": false, "score": 0, "creation_date": 1499843404, "post_id": 45050405, "comment_id": 77074970, "body": "XDATA.GetRows ----- Copies multiple records from a Recordset object into a two-dimensional array and you are  trying to add the output into string. I guess this may be the issue"}, {"owner": {"reputation": 47, "user_id": 5479140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b59052409aaa2314d943ee0f44a0126?s=128&d=identicon&r=PG&f=1", "display_name": "RAKH", "link": "https://stackoverflow.com/users/5479140/rakh"}, "reply_to_user": {"reputation": 242, "user_id": 6379460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30b54a852865103dd823cd63aedd7b8?s=128&d=identicon&r=PG&f=1", "display_name": "Sim", "link": "https://stackoverflow.com/users/6379460/sim"}, "edited": false, "score": 0, "creation_date": 1499843634, "post_id": 45050405, "comment_id": 77075101, "body": "I there another way to add the records to the dynamic Array?"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5479140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b59052409aaa2314d943ee0f44a0126?s=128&d=identicon&r=PG&f=1", "display_name": "RAKH", "link": "https://stackoverflow.com/users/5479140/rakh"}, "edited": false, "score": 0, "creation_date": 1499845981, "post_id": 45051368, "comment_id": 77076650, "body": "I miss wrote PATTs instead of DataArr so instead of <code>For Each p In PATTs</code> it suppose to be <code>For Each p In DataArr </code>"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1499855657, "last_edit_date": 1499855657, "creation_date": 1499845228, "answer_id": 45051368, "question_id": 45050405, "link": "https://stackoverflow.com/questions/45050405/in-vba-fill-array-from-query-then-insert-the-data-into-table/45051368#45051368", "title": "In vba fill Array from QUery then insert the data into table", "body": "<p>Your code is mostly valid, but you are making some mistakes.\n<code>GetRows</code> returns a multi-dimensional array with rownumbers and fields. As such, you can't fit it into a string. You need to use an array of type variant.</p>\n\n<pre><code>Private Sub Refreash()\n    Dim DataArr() As Variant\n    Dim p As Variant\n    Dim sql As String\n    Dim XDATA As New ADODB.Recordset\n    Dim RDS As DAO.Recordset\n    Set RDS = db.OpenRecordset(\"tbl_dets\")\n\n    sql = \"SELECT DISTINCT NAME FROM Types_tbl WHERE NAME LIKE 'Rob%'\"\n    XDATA.Open sql, cnn, adOpenStatic\n\n    '''\n    '' HERE I WANT TO FILL DataArr FROM XDATA\n    '''\n    'Make sure XData fetches all records\n    XData.MoveLast\n    XData.MoveFirst\n    DataArr = XDATA.GetRows\n\n    XDATA.Close\n    For Each p In PATTs\n        sql = \"SELECT DISTINCT TID FROM Types_tbl WHERE NAME ='\" &amp; p &amp; \"'\"\n        XDATA .Open sql, cnn, adOpenStatic\n\n       Do Until XDATA.EOF\n       DoEvents \n           '''Inserting new records to tbl_dets\n           RDS.AddNew\n           RDS!Name = p\n           RDS!TID= XDATA!TID\n           RDS.Update\n           XDATA.MoveNext\n       Loop\n       XDATA.Close\n    Next\nEnd Sub\n</code></pre>\n\n<p>Note that there are some things I still don't understand about this sub, possibly because it is not finished, such as it not using DataArr anywhere after setting it and the use of both ADO and DAO (I'd prefer to only do DAO in this case).</p>\n"}], "owner": {"reputation": 47, "user_id": 5479140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b59052409aaa2314d943ee0f44a0126?s=128&d=identicon&r=PG&f=1", "display_name": "RAKH", "link": "https://stackoverflow.com/users/5479140/rakh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 855, "favorite_count": 2, "accepted_answer_id": 45051368, "answer_count": 1, "score": 1, "last_activity_date": 1594651001, "creation_date": 1499842299, "last_edit_date": 1594651001, "question_id": 45050405, "link": "https://stackoverflow.com/questions/45050405/in-vba-fill-array-from-query-then-insert-the-data-into-table", "title": "In vba fill Array from QUery then insert the data into table", "body": "<p>So I want to insert the result of a query into an array then I will loop over the array to insert new rows to a new table.\nHere is the code I've done:</p>\n\n<pre><code>Public cnn As New ADODB.Connection\nPublic db As DAO.Database\n\nPublic Sub SUD_Main()\n    Set db = Access.Application.CurrentDb\n    Set cnn = CurrentProject.Connection\n\n     Refreash    \nEnd Sub\n\nPrivate Sub Refreash()\nDim DataArr() As String\n    Dim p As Variant\n    Dim sql As String\n    Dim XDATA As New ADODB.Recordset\n    Dim RDS As DAO.Recordset\n    Set RDS = db.OpenRecordset(\"tbl_dets\")\n\n    sql = \"SELECT DISTINCT NAME FROM Types_tbl WHERE NAME LIKE 'Rob%'\"\n    XDATA.Open sql, cnn, adOpenStatic\n\n    '''\n    '' HERE I WANT TO FILL DataArr FROM XDATA\n    '''\n    DataArr = XDATA.GetRows\n\n    XDATA.Close\n    For Each p In DataArr\n        sql = \"SELECT DISTINCT TID FROM Types_tbl WHERE NAME ='\" &amp; p &amp; \"'\"\n        XDATA .Open sql, cnn, adOpenStatic\n\n       Do Until XDATA.EOF\n       DoEvents \n           '''Inserting new records to tbl_dets\n           RDS.AddNew\n           RDS!Name = p\n           RDS!TID= XDATA!TID\n           RDS.Update\n           XDATA.MoveNext\n       Loop\n       XDATA.Close\n    Next\nEnd Sub\n</code></pre>\n\n<p>So what I am missing? I thing that the error is in the Array but didn't know how to fix it. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1499842525, "post_id": 45050345, "comment_id": 77074432, "body": "To answer your question, yes it is absolutely possible."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499843047, "post_id": 45050496, "comment_id": 77074750, "body": "Hi Anton. Do you think you can make just the first part. selecting or list the name of the chosen from random. like in the picture from 8 choose 1?"}, {"owner": {"reputation": 733, "user_id": 7354553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RvbNV.jpg?s=128&g=1", "display_name": "TheOtherOne", "link": "https://stackoverflow.com/users/7354553/theotherone"}, "reply_to_user": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 1, "creation_date": 1499845712, "post_id": 45050496, "comment_id": 77076459, "body": "I think I can do that ^^ my vb is a bit rusty, but expect it to be done soon :)"}, {"owner": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499845840, "post_id": 45050496, "comment_id": 77076556, "body": "Very much appreciate. Thank you Anton. this is a big help for me."}, {"owner": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499850651, "post_id": 45050496, "comment_id": 77079942, "body": "Hi Anton. Thank you for your time. but I&#39;m afraid that this is only works by choosing 1. what if the Apple is now 100 so i need to get that 10% which is 10. i need to select 10 random names. this is cause to much edit on the macro. but anyway thank you for the help :D ."}, {"owner": {"reputation": 733, "user_id": 7354553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RvbNV.jpg?s=128&g=1", "display_name": "TheOtherOne", "link": "https://stackoverflow.com/users/7354553/theotherone"}, "reply_to_user": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499850994, "post_id": 45050496, "comment_id": 77080196, "body": "@P.Alvs So you basicly want an array with a set amount of random entries? I could do that ^^"}, {"owner": {"reputation": 733, "user_id": 7354553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RvbNV.jpg?s=128&g=1", "display_name": "TheOtherOne", "link": "https://stackoverflow.com/users/7354553/theotherone"}, "reply_to_user": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499853003, "post_id": 45050496, "comment_id": 77081725, "body": "No Problem ^^ Just give me a bit more time :P"}, {"owner": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499879841, "post_id": 45050496, "comment_id": 77100989, "body": "Thank you Anton very much appreciate."}, {"owner": {"reputation": 733, "user_id": 7354553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RvbNV.jpg?s=128&g=1", "display_name": "TheOtherOne", "link": "https://stackoverflow.com/users/7354553/theotherone"}, "reply_to_user": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499880098, "post_id": 45050496, "comment_id": 77101123, "body": "You&#39;ll have to wait a little longer, since working with arrays in vba is a real pain..."}, {"owner": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499887607, "post_id": 45050496, "comment_id": 77105339, "body": "Its Okay Anton I&#39;ll wait. I&#39;m always visit this waiting for your reply :D."}, {"owner": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499933531, "post_id": 45050496, "comment_id": 77122433, "body": "Hi Anton Thank you very much i will try this and let you know."}, {"owner": {"reputation": 733, "user_id": 7354553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RvbNV.jpg?s=128&g=1", "display_name": "TheOtherOne", "link": "https://stackoverflow.com/users/7354553/theotherone"}, "reply_to_user": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499934563, "post_id": 45050496, "comment_id": 77123134, "body": "Do that... Also you should probably close the topic so that others don&#39;t think a working answer is still missing..."}, {"owner": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499971370, "post_id": 45050496, "comment_id": 77149788, "body": "Hi. Anton. Yes It&#39;s totally working just fine thank you. but May I ask some of changes if possible. 1. rather than listing the pick number in the next column is that possible to just highlighted it to easily filter?. 2. good thing that its already getting the total amount of how many should i audit but i think its not getting the 10% of it. showing that it getting the 1/3 of the total number of search. other than this everything works fine. thank you."}, {"owner": {"reputation": 733, "user_id": 7354553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RvbNV.jpg?s=128&g=1", "display_name": "TheOtherOne", "link": "https://stackoverflow.com/users/7354553/theotherone"}, "reply_to_user": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499971475, "post_id": 45050496, "comment_id": 77149848, "body": "1. I&#39;ll try to do that, it should be doable... 2. You can customize the amount with the variables at the top... In my example it&#39;s at 0.3, but you can simply change it to 0.1"}, {"owner": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499972073, "post_id": 45050496, "comment_id": 77150197, "body": "Thank you so much Anton."}, {"owner": {"reputation": 733, "user_id": 7354553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RvbNV.jpg?s=128&g=1", "display_name": "TheOtherOne", "link": "https://stackoverflow.com/users/7354553/theotherone"}, "reply_to_user": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499973212, "post_id": 45050496, "comment_id": 77150877, "body": "Sooooo... I REALLY think this is all you should need ^^"}, {"owner": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499974760, "post_id": 45050496, "comment_id": 77151650, "body": "Wow this is what i wanted. thank you so much Anton. this is awesome. Thank you."}, {"owner": {"reputation": 733, "user_id": 7354553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RvbNV.jpg?s=128&g=1", "display_name": "TheOtherOne", "link": "https://stackoverflow.com/users/7354553/theotherone"}, "reply_to_user": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499975505, "post_id": 45050496, "comment_id": 77152046, "body": "@P.Alvs Seems like that&#39;s it than ^^ Whenever you have a new question feel free to ask me :P"}, {"owner": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499976391, "post_id": 45050496, "comment_id": 77152458, "body": "Yeah I will do that :D .. actually I already have 1 question but this is too much so its ok if this is impossible to make. the &quot;search&quot; thing. im wondering if theres like a command that show a popup box that i will just enter the name and automatically change search so i will not go to vba to manually change search &quot;Apple&quot;. But anyway this is perfect thank you."}, {"owner": {"reputation": 733, "user_id": 7354553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RvbNV.jpg?s=128&g=1", "display_name": "TheOtherOne", "link": "https://stackoverflow.com/users/7354553/theotherone"}, "reply_to_user": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1499978980, "post_id": 45050496, "comment_id": 77153831, "body": "Well, that&#39;s easy ^^"}, {"owner": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "edited": false, "score": 0, "creation_date": 1500556939, "post_id": 45050496, "comment_id": 77398154, "body": "Hi. Anton. I am using the Macro you made and it help me a lot. but now i realize that the popup box is not a great idea. can you help me make some changes with it? rather than typing the name to search in box, whenever i click the macro it will randomize and get the Apple and Banana highlighted so i just need to click once. sorry for my bad english."}], "tags": [], "owner": {"reputation": 733, "user_id": 7354553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RvbNV.jpg?s=128&g=1", "display_name": "TheOtherOne", "link": "https://stackoverflow.com/users/7354553/theotherone"}, "is_accepted": true, "score": 2, "last_activity_date": 1499979009, "last_edit_date": 1499979009, "creation_date": 1499842565, "answer_id": 45050496, "question_id": 45050345, "link": "https://stackoverflow.com/questions/45050345/ms-excel-randomly-pick-name-with-freedom-to-choose-how-many-to-select/45050496#45050496", "title": "MS Excel Randomly pick name with freedom to choose how many to select", "body": "<p>Using the usual excel functions this is indeed impossible...\nHowever, excel (and the other Microsoft office applications) run an underlying programming language: visual basic. That's the way to go :)</p>\n\n<p>Here's a makro, that selects a random field matching the search in the whole column.</p>\n\n<pre><code>Sub SelectRandomSearch()\n    'Declaring Variables\n    Dim y As Integer\n    Dim x As Integer\n    Dim startY As Integer\n    Dim lastY As Integer\n    Dim search As String\n    Dim hits As Integer\n    Dim random As Integer\n    Dim hitsArr() As Integer\n    Dim controlPart As Double\n    Dim controlsNum As Integer\n    Dim controlArr() As Integer\n\n    'Declaring Values\n    startY = 1        'lowest Y-Coordianate of the input column\n    x = 1             'X-Coordiante of the input column\n    controlPart = 0.1 'Fraction of the hits, that need to be controled\n\n    'Get search value\n    search = InputBox(\"Enter a search value\", \"Searching\", \"\")\n\n    'Getting Column Lenght and reset coloring\n    y = startY\n    Do Until IsEmpty(Cells(y, x).Value)\n        Cells(y, x).Select\n        With Selection.Interior\n            .Pattern = xlNone\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        End With\n        y = y + 1\n    Loop\n\n    'Getting number of search hits\n    lastY = y - 1\n    hits = WorksheetFunction.CountIf(Range(Cells(startY, x), Cells(lastY, x)), search)\n\n    'Fill hitsArr with row-numbers of hits\n    ReDim hitsArr(hits + 1)\n    hits = 1\n    For y = startY To lastY\n        If Cells(y, x) = search Then\n            hitsArr(hits) = y\n            hits = hits + 1\n        End If\n    Next y\n    hits = hits - 1\n\n    'Getting number of controlled Entries\n    controlsNum = WorksheetFunction.RoundUp(hits * controlPart, 0)\n\n    'Shuffle a part of hitsArr\n    ReDim controlArr(controlsNum + 1)\n    For y = 1 To controlsNum\n        random = ((hits - y + 1) * Rnd + y)\n        hitsArr(0) = hitsArr(y)\n        hitsArr(y) = hitsArr(random)\n        hitsArr(random) = hitsArr(0)\n    Next y\n\n    'Mark every hit that needs to be controlled\n    For y = 1 To controlsNum\n        Cells(hitsArr(y), x).Select\n        With Selection.Interior\n            .Color = 49407\n        End With\n    Next y\nEnd Sub\n</code></pre>\n\n<p>You probably need to change the makro slightly, but this basicly does all I can think of you could need :)</p>\n\n<p>I hope this helps!</p>\n\n<p>Now the makro marks the fields that need to be checkt like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Lrrj6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lrrj6.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 45, "user_id": 6266321, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/41177f06024899cfa5408d99aca38cd7?s=128&d=identicon&r=PG&f=1", "display_name": "P.Alvs", "link": "https://stackoverflow.com/users/6266321/p-alvs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 45050496, "answer_count": 1, "score": 2, "last_activity_date": 1499979009, "creation_date": 1499842074, "last_edit_date": 1531161705, "question_id": 45050345, "link": "https://stackoverflow.com/questions/45050345/ms-excel-randomly-pick-name-with-freedom-to-choose-how-many-to-select", "title": "MS Excel Randomly pick name with freedom to choose how many to select", "body": "<p>Everyone,</p>\n\n<p>I'm trying to automated my excel file to choose random data to check for audit. I want to make randomizer that I can input how many data to select. is that possible in excel? I put some screenshot below for better explanation. I hope you can help me.</p>\n\n<p><img src=\"https://i.stack.imgur.com/uZsA6.jpg\" alt=\"Link for the Image\"></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1499842269, "post_id": 45050271, "comment_id": 77074257, "body": "Nice , what time is it there now ?"}, {"owner": {"reputation": 13, "user_id": 8292542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9b914e9a40636d778e2545f46454073?s=128&d=identicon&r=PG&f=1", "display_name": "overflowing", "link": "https://stackoverflow.com/users/8292542/overflowing"}, "edited": false, "score": 1, "creation_date": 1499858257, "post_id": 45050271, "comment_id": 77085409, "body": "Thank you @A.S.H, that worked straight away. I really appreciate your help. Yes, I was using direct excel formulas before but combined with the other calculations I was performing for a large table of dynamic data being pulled from an API, it kept crashing the workbook."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1499841830, "creation_date": 1499841830, "answer_id": 45050271, "question_id": 45049378, "link": "https://stackoverflow.com/questions/45049378/averaging-each-column-of-a-dynamic-table-excel-vba/45050271#45050271", "title": "Averaging each column of a dynamic table Excel VBA", "body": "<p>You could use formulas directly in Excel, or you can reduce your VBA code to this:</p>\n\n<pre><code>Sub AVERAGES()\n  Dim lastCol As Long\n  lastCol = ThisWorkbook.Sheets(\"Sheet1\").Cells(2, Columns.Count).End(xlToLeft).Column\n\n  With ThisWorkbook.Sheets(\"Sheet3\").Range(\"B2\").Resize(1, lastCol - 1)\n    .Formula = \"=Average(Sheet1!B:B)\"\n    .value = .value\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8292542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9b914e9a40636d778e2545f46454073?s=128&d=identicon&r=PG&f=1", "display_name": "overflowing", "link": "https://stackoverflow.com/users/8292542/overflowing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "accepted_answer_id": 45050271, "answer_count": 1, "score": 1, "last_activity_date": 1499841830, "creation_date": 1499838559, "question_id": 45049378, "link": "https://stackoverflow.com/questions/45049378/averaging-each-column-of-a-dynamic-table-excel-vba", "title": "Averaging each column of a dynamic table Excel VBA", "body": "<p>I've just started learning VBA in the last two weeks so apologies if this is a basic oversight. </p>\n\n<p>I'm trying to find the average of <strong>each</strong> column in a dynamic table and then populate these values (the averages of each unique column) into a table of averages in Sheet3. All of the other posts I've found on averaging ranges refer to a specific range e.g.(\"A2:A23\") and would result in pasting one column's average multiple times as opposed to each column's average once. This is the code I have so far. Any feedback on where it could be improved is much appreciated. </p>\n\n<pre><code>Sub AVERAGES()\n\n\nSet s1 = ThisWorkbook.Sheets(\"Sheet1\")\nSet s3 = ThisWorkbook.Sheets(\"Sheet3\")\n\nj = 0\n\nDo While s1.Range(\"B2\").Offset(0, j).Value &lt;&gt; \"\"\n\n    i = 0\n\n    Do While s1.Range(\"B2\").Offset(i, j).Value &lt;&gt; \"\"\n\n    s1.Range(\"B2\").Offset(i, j).Select\n\n    i = i + 1\n\n  Loop\n\nAve = Application.WorksheetFunction.Average(s1.Range(Cells(2, j), s1.Range(Cells(2, j).Offset(i, j))))\n\ns3.Range(s3.Range(\"B2\"), s3.Range(\"B2\").Offset(0, j)).Value = Ave\n\nj = j + 1\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1499840372, "post_id": 45049371, "comment_id": 77073254, "body": "When posting long blocks of code please <b>use indenting</b>.  it&#39;s easier for us and for you to read your code."}], "answers": [{"tags": [], "owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "is_accepted": false, "score": 0, "last_activity_date": 1499839150, "creation_date": 1499839150, "answer_id": 45049533, "question_id": 45049371, "link": "https://stackoverflow.com/questions/45049371/reiterate-between-date-range-and-find-each-of-the-dates/45049533#45049533", "title": "REITERATE BETWEEN DATE RANGE AND FIND EACH OF THE DATES", "body": "<p>I would like to give you suggestion is that you use the Database for this, as users can apply on different date for a particular period.</p>\n\n<p>This will give you more options of Previous records, Edit the holiday planner, etc...</p>\n\n<p>If you are using the data base then you can play with the data and put conditions in much more easier way</p>\n\n<p>VBA + MS access will do the trick</p>\n"}], "owner": {"reputation": 3, "user_id": 4390460, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/zacbZ.png?s=128&g=1", "display_name": "KZMN", "link": "https://stackoverflow.com/users/4390460/kzmn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499839150, "creation_date": 1499838523, "question_id": 45049371, "link": "https://stackoverflow.com/questions/45049371/reiterate-between-date-range-and-find-each-of-the-dates", "title": "REITERATE BETWEEN DATE RANGE AND FIND EACH OF THE DATES", "body": "<p>I am trying to make a userform that can be used by staff to book holiday in advance to minimize overlapping holiday request.</p>\n\n<p>Basically now I am planning to generate a list of dates from entered start date and end date, then looping around the array, search for the dates one by one.</p>\n\n<p>Here is what I manage to scrap together but when I debug the error would be \"For without Next\"\n - so I tried to put \"Next i\" at line 71 but then the error come out as \"Next without for block\" :(</p>\n\n<p>2)I would like to lock have All Calendar Sheets (JAN-DEC) . Read something about locking and unlock using vba but nothing happened in my trial :(</p>\n\n<p>I really appreciate any points to learn and help.</p>\n\n<p>Thank You very much</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nDim i As Long\nDim strdate, enddate, rngedate As Date\nDim rCell As Range\nDim IReply As Long\nDim ws As Worksheet\nDim d As Date\nDim x As Integer\nDim OutRng As Range\nDim lastrow As Long\n\nstrdate = Me.tbDtF.Value\nenddate = Me.tbDtT.Value\nIf strdate = \"False\" Then Exit Sub  'Cancelled\nstrdate = Format(strdate, \"Short Date\")\nOn Error Resume Next\nIf enddate - strdate &lt;&gt; 0 Then 'generate list of date base on entry to buffer worksheet\nws = ThisWorkbook.Worksheets(\"Buffer\")\nWith ws\nlastrow = .Cells(.Rows.Count, 1).endxlup.Row\nEnd With\nws.Range(\"A1\").Value = strdate\nws.Range(\"B1\").Value = enddate\nSet OutRng = OutRng.Range(\"A1\")\n\nColIndex = 0\nFor i = strdate To enddate\nOutRng.Offset(ColIndex, 0) = i\nColIndex = ColIndex + 1\nNext\n\n'looping all date to find\nFor i = 1 To lastrow\nrngedate = Range(\"A\" &amp; i).Value\n ' If ws.Name = \"LIST\" Then Exit Sub  'to look for date in calendar sheets only\nSet rCell = Worksheets(UCase(Format(strdate, \"mmm\"))).Cells.Find(What:=CDate(rngedate), After:=Range(\"A1\"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\nIf Not rCell Is Nothing Then\nrCell.Offset(1, 0).Value = rCell.Offset(1, 0).Value + 1  'adding value 1 to the cell below found date\nrCell.Offset(2, 0).Value = rCell.Offset(2, 0).Value + \" \" + Me.tbUser.Value 'adding the username to the cell\n\nIf rCell.Offset(1, 0).Value &lt; 6 Then  'limit for ppl on leave per day is 5\nWith ThisWorkbook.Worksheets(\"LIST\") 'sending userform entry into worksheet \"list\"\ni = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n.Cells(i, 1).Value = Me.tbUser.Value\n.Cells(i, 2).Value = Me.tbDtF.Value\n.Cells(i, 3).Value = Me.tbDtT.Value\n.Cells(i, 5).Value = Me.tbRemarks.Value\nEnd With\n\nMsgBox \"Your leave booking is submitted\"\nElse: MsgBox \"Sorry, maximum people have applied for leave on\" &amp; rCell &amp; \"that date\"\nEnd If\n\n\nEnd If\nIf enddate - strdate = 0 Then\nSet rCell = Worksheets(UCase(Format(strdate, \"mmm\"))).Cells.Find(What:=CDate(rngedate), After:=Range(\"A1\"), LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n\nIf Not rCell Is Nothing Then\n'MsgBox \"Found at \" &amp; rngX.Address\nIf rCell.Offset(1, 0).Value &lt; 6 Then  'limit for ppl on leave per day is 5\nWith ThisWorkbook.Worksheets(\"LIST\") 'sending userform entry into worksheet \"list\"\ni = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n.Cells(i, 1).Value = Me.tbUser.Value\n.Cells(i, 2).Value = Me.tbDtF.Value\n.Cells(i, 3).Value = Me.tbDtT.Value\n.Cells(i, 5).Value = Me.tbRemarks.Value\nEnd With\nrCell.Offset(1, 0).Value = rCell.Offset(1, 0).Value + 1  'adding value 1 to the cell below found date\nrCell.Offset(2, 0).Value = rCell.Offset(2, 0).Value + \" \" + Me.tbUser.Value 'adding the username to the cell\nMsgBox \"Your leave booking is submitted\"\nElse: MsgBox \"Sorry, maximum people have applied for leave on\" &amp; rCell &amp; \"that date\"\nEnd If\nEnd If\nEnd If\nOn Error GoTo 0\nIf rCell Is Nothing Then\nlReply = MsgBox(\"Date cannot be found. Try Again\", vbYesNo)\nIf lReply = vbYes Then UserForm1.tbDtF.SetFocus\nIf lReply = vbNo Then UserForm1.Hide\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1499838569, "creation_date": 1499838569, "answer_id": 45049380, "question_id": 45049268, "link": "https://stackoverflow.com/questions/45049268/extract-one-line-of-content-in-cells/45049380#45049380", "title": "extract one line of content in cells", "body": "<p>Use this formula in any cell and it will show you the line's number:</p>\n\n<pre><code>=MATCH(\"MO;*\",Q:Q, 0)\n</code></pre>\n\n<p>If you want to dusplay it in another sheet, prefix the <code>Q:Q</code> with the sheet's name:</p>\n\n<pre><code> =MATCH(\"MO;*\", 'Sheet name'!Q:Q, 0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 8293507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e236a6634287e31247ac9798546c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/8293507/ana"}, "edited": false, "score": 0, "creation_date": 1499915704, "post_id": 45050377, "comment_id": 77114462, "body": "Instr helps me with the first step. How about I the beginning of the next line is uncertain. The only thing that I certain is there will be the first two letter of the next line is two Capital Letters. And I would like to extract the whole line starts with MO. I don&#39;t know is it possible to filter out any two capital letter. But anyway, thank you so much for your sincere help."}, {"owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "reply_to_user": {"reputation": 5, "user_id": 8293507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e236a6634287e31247ac9798546c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/8293507/ana"}, "edited": false, "score": 0, "creation_date": 1499927310, "post_id": 45050377, "comment_id": 77118351, "body": "You are telling 3rd row starting letter is not only &quot;AC&quot;, it will differ. i am right?"}, {"owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "reply_to_user": {"reputation": 5, "user_id": 8293507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e236a6634287e31247ac9798546c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/8293507/ana"}, "edited": false, "score": 0, "creation_date": 1499929176, "post_id": 45050377, "comment_id": 77119487, "body": "but &quot;MO&quot; should be in 2nd row?"}, {"owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "reply_to_user": {"reputation": 5, "user_id": 8293507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e236a6634287e31247ac9798546c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/8293507/ana"}, "edited": false, "score": 0, "creation_date": 1499931709, "post_id": 45050377, "comment_id": 77121181, "body": "Is number&#39;s digits are fixed ?"}, {"owner": {"reputation": 5, "user_id": 8293507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e236a6634287e31247ac9798546c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/8293507/ana"}, "edited": false, "score": 0, "creation_date": 1499995029, "post_id": 45050377, "comment_id": 77158972, "body": "No they are all uncertain"}, {"owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "reply_to_user": {"reputation": 5, "user_id": 8293507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e236a6634287e31247ac9798546c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/8293507/ana"}, "edited": false, "score": 0, "creation_date": 1500010416, "post_id": 45050377, "comment_id": 77162970, "body": "There is any minimum count  of digit?"}], "tags": [], "owner": {"reputation": 343, "user_id": 7324127, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a54b8306994f0ab4fdfe7df4c4ace510?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick Anbazhagan", "link": "https://stackoverflow.com/users/7324127/karthick-anbazhagan"}, "is_accepted": true, "score": 0, "last_activity_date": 1499842198, "creation_date": 1499842198, "answer_id": 45050377, "question_id": 45049268, "link": "https://stackoverflow.com/questions/45049268/extract-one-line-of-content-in-cells/45050377#45050377", "title": "extract one line of content in cells", "body": "<p>Try with this...</p>\n\n<pre><code>Sub example()\n\n\nDim y As Workbook\nDim Value As Variant\nDim cval As String\n\n\nSet y = ThisWorkbook\nlRow = y.Worksheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 1 To lRow\ncval = y.Worksheets(\"Sheet1\").Range(\"A\" &amp; i)\n\nIf cval Like \"*\" &amp; MO &amp; \"*\" Then\n\nPOS = InStr(cval, \"MO\")\n\nlpos = InStr(POS, cval, \"AC\")\n\ntmp = lpos - POS\n\nfmsg = Mid(cval, POS, tmp)\n\nMsgBox fmsg\n\nEnd If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8293507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e236a6634287e31247ac9798546c1cf?s=128&d=identicon&r=PG&f=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/8293507/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 45050377, "answer_count": 2, "score": 0, "last_activity_date": 1499842198, "creation_date": 1499838097, "last_edit_date": 1499838403, "question_id": 45049268, "link": "https://stackoverflow.com/questions/45049268/extract-one-line-of-content-in-cells", "title": "extract one line of content in cells", "body": "<p>I have one worksheet and I need to do some filtering and extraction.</p>\n\n<p>There may be multiple lines of data inside the cells under column Q.\nI need to extract the LINE whenever it starts with MO. </p>\n\n<p>Format of Column Q cell will be like this:</p>\n\n<pre><code>FM;DATE;CONTENT;NUMBER\nMO;DATE;CONTENT;NUMBER\nAC;DATE;CONTENT;NUMBER\n</code></pre>\n\n<p>e.g. MO;2017-06-01;Example;123.4</p>\n\n<p>To be specific, I would like to extract line: MO;DATE;CONTENT;NUMBER</p>\n\n<p>I do not know is it possible to do it with VBA since I am a new programmer.</p>\n\n<p>Thank you very much.</p>\n"}, {"tags": ["excel", "pivot", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1499875425, "creation_date": 1499875425, "answer_id": 45062701, "question_id": 45048762, "link": "https://stackoverflow.com/questions/45048762/how-do-i-dynamically-select-the-range-of-the-sheet/45062701#45062701", "title": "How do I dynamically select the range of the sheet", "body": "<p>code would be like this.  My version is 14.</p>\n\n<pre><code>Sub test()\n    Dim Ws As Worksheet, toWs As Worksheet\n    Dim Wb As Workbook\n    Dim pv As PivotTable, pvCache As PivotCache\n\n    Set Wb = ThisWorkbook\n    Set Ws = Sheets(1)\n    Set toWs = Sheets(2)\n\n        Set pvCache = Wb.PivotCaches.Create(xlDatabase, Ws.Range(\"a1\").CurrentRegion, xlPivotTableVersion14)\n        Set pv = pvCache.CreatePivotTable(TableDestination:=toWs.Range(\"f1\"))\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8293295"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499875425, "creation_date": 1499835520, "last_edit_date": 1531161705, "question_id": 45048762, "link": "https://stackoverflow.com/questions/45048762/how-do-i-dynamically-select-the-range-of-the-sheet", "title": "How do I dynamically select the range of the sheet", "body": "<p>The code that works on 2016 version selecting just the sheet name:</p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"Summary\").PivotTables(\"PivotTable8\").PivotCache.Create(SourceType:=xlDatabase,\n    SourceData:= _\n            \"Sheet1!R1C1:R29463CFI\", Version:=xlPivotTableVersion15).CreatePivotTable TableDestination:=\"Sheet2!R3C1\", TableName:=\"PivotTable1\", DefaultVersion:=6\n</code></pre>\n\n<p>In the below code I want the range for <code>sourcedata</code> to be fetched depending on the active cells of the sheet. In Excel 2016 the code works even if the entire sheet is selected but in Excel 2013, only if the range of active cells is provided does the code run.</p>\n\n<pre><code> ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"Sheet1!R1C1:R29463C165\", Version:=xlPivotTableVersion15).CreatePivotTable _\n    TableDestination:=\"Sheet2!R3C1\", TableName:=\"PivotTable1\", DefaultVersion _\n    :=xlPivotTableVersion15\n</code></pre>\n"}]