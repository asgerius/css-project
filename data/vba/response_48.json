[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1449703855, "post_id": 34190662, "comment_id": 56128387, "body": "right now I don&#39;t really get what you want... depending on the value in A1 you want to hide/unhide rows... so what do you need to know?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449704800, "post_id": 34190662, "comment_id": 56128741, "body": "You can only hide or unhide an entire row, not part of a row, if that&#39;s what you&#39;re asking."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449704916, "post_id": 34190662, "comment_id": 56128795, "body": "Is the sheet protected?"}], "answers": [{"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1449707924, "creation_date": 1449707924, "answer_id": 34191751, "question_id": 34190662, "link": "https://stackoverflow.com/questions/34190662/expand-hidden-row-within-a-range/34191751#34191751", "title": "Expand Hidden Row within a Range", "body": "<p>Your code seems to works fine, but can be reduced:<br></p>\n\n<hr>\n\n<p>For example:<br></p>\n\n<pre><code>Rows(\"20:70\").EntireRow.Hidden = True\nRows(\"12:17\").EntireRow.Hidden = True\nRows(\"70:70\").EntireRow.Hidden = True\n</code></pre>\n\n<p>Range <code>Rows(\"70:70\")</code> is a Part of Range <code>Rows(\"20:70\")</code>, so the part of code  <code>Rows(\"70:70\").EntireRow.Hidden = True</code> can be removed.</p>\n\n<hr>\n\n<p>another example is:</p>\n\n<pre><code>        Rows(\"20:69\").EntireRow.Hidden = True\n        Rows(\"1:19\").EntireRow.Hidden = False  \n        Rows(\"70:70\").EntireRow.Hidden = True\n</code></pre>\n\n<p><code>Rows(\"70:70\")</code> and <code>Rows(\"20:69\")</code> can be merged, so can be <code>Rows(\"20:70\")</code> instead of <code>Rows(\"20:69\")</code> and this part of code <code>Rows(\"70:70\").EntireRow.Hidden = True</code> can be removed.</p>\n\n<hr>\n\n<p><em>also</em>:<br></p>\n\n<ul>\n<li><p>it is not required to use <code>.EntireRow</code> when you work with <code>Rows</code>, is enough use <code>Rows(\"20:69\").Hidden = True</code></p></li>\n<li><p>You can use multiple range: <br>\n<code>Range(\"12:17\",\"70:70\").EntireRow.Hidden = True</code> <br>\ninstead of code below:<br>\n<code>Rows(\"12:17\").EntireRow.Hidden = True</code><br>\n<code>Rows(\"70:70\").EntireRow.Hidden = True</code></p></li>\n</ul>\n\n<p>so, with all that was described above and with using shorthand method of referencing Ranges, your code can looks like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n   If Target.Address = \"$A$1\" Then\n        If [A1].Value = \"Retail\" Then\n           [1:11].EntireRow.Hidden = 0\n           [12:17,20:70].EntireRow.Hidden = 1\n        ElseIf [A1].Value = \"Restaurant\" Then\n            [1:19].EntireRow.Hidden = 0\n            [20:70].EntireRow.Hidden = 1\n        ElseIf [A1].Value = \"Hospitality\" Then\n            [1:19].EntireRow.Hidden = 0\n            [20:70].EntireRow.Hidden = 1\n        ElseIf [A1].Value = \"Professional Service\" Then\n            [1:20].EntireRow.Hidden = 0\n            [20:70].EntireRow.Hidden = 1\n        ElseIf [A1].Value = \"Event\" Then\n            [1:19].EntireRow.Hidden = 0\n            [20:70].EntireRow.Hidden = 1\n        ElseIf [A1].Value = \"Mail/Telephone\" Then\n            [1:19,70:70].EntireRow.Hidden = 0\n            [20:69].EntireRow.Hidden = 1\n        ElseIf [A1].Value = \"Internet\" Then\n            [1:69].EntireRow.Hidden = 0\n            [20:20].EntireRow.Hidden = 1\n        ElseIf [A1].Value = \"Nonprofit\" Then\n            [1:19].EntireRow.Hidden = 0\n            [20:70].EntireRow.Hidden = 1\n        ElseIf [A9].Value = \"No\" Then\n            [11:18].EntireRow.Hidden = 0\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5660937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b4d4f8a2b6192d4d09d73a3bf65218f?s=128&d=identicon&r=PG&f=1", "display_name": "Mercantilex", "link": "https://stackoverflow.com/users/5660937/mercantilex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 534, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449707924, "creation_date": 1449702089, "question_id": 34190662, "link": "https://stackoverflow.com/questions/34190662/expand-hidden-row-within-a-range", "title": "Expand Hidden Row within a Range", "body": "<p>Hi I'm a complete beginner with coding.  I've put together a Hidden Sub Worksheet to hide rows within a list of qualification questions.  As Column A drop downs are selected certain rows need to be manipulated to hide/un-hide. I have attempted to have a rows with a predefined range to be manipulated however to avail.  I've attempted to use the Record Macro function creating a sub Macro that also does not work.  How do I make individual rows withing a predefined range hide/un-hide?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n   If Target.Address = \"$A$1\" Then\n        If Range(\"A1\").Value = \"Retail\" Then\n            Rows(\"1:11\").EntireRow.Hidden = False\n            Rows(\"20:70\").EntireRow.Hidden = True\n            Rows(\"12:17\").EntireRow.Hidden = True\n            Rows(\"70:70\").EntireRow.Hidden = True\n        ElseIf Range(\"A1\").Value = \"Restaurant\" Then\n            Rows(\"20:69\").EntireRow.Hidden = True\n            Rows(\"1:19\").EntireRow.Hidden = False\n            Rows(\"70:70\").EntireRow.Hidden = True\n        ElseIf Range(\"A1\").Value = \"Hospitality\" Then\n            Rows(\"20:69\").EntireRow.Hidden = True\n            Rows(\"1:19\").EntireRow.Hidden = False\n            Rows(\"70:70\").EntireRow.Hidden = True\n        ElseIf Range(\"A1\").Value = \"Professional Service\" Then\n            Rows(\"20:69\").EntireRow.Hidden = True\n            Rows(\"1:20\").EntireRow.Hidden = False\n            Rows(\"70:70\").EntireRow.Hidden = True\n        ElseIf Range(\"A1\").Value = \"Event\" Then\n            Rows(\"20:69\").EntireRow.Hidden = True\n            Rows(\"1:19\").EntireRow.Hidden = False\n            Rows(\"70:70\").EntireRow.Hidden = True\n        ElseIf Range(\"A1\").Value = \"Mail/Telephone\" Then\n            Rows(\"20:69\").EntireRow.Hidden = True\n            Rows(\"1:19\").EntireRow.Hidden = False\n            Rows(\"70:70\").EntireRow.Hidden = False\n        ElseIf Range(\"A1\").Value = \"Internet\" Then\n            Rows(\"1:69\").EntireRow.Hidden = False\n            Rows(\"20:20\").EntireRow.Hidden = True\n        ElseIf Range(\"A1\").Value = \"Nonprofit\" Then\n            Rows(\"20:69\").EntireRow.Hidden = True\n            Rows(\"1:19\").EntireRow.Hidden = False\n            Rows(\"70:70\").EntireRow.Hidden = True\n        ElseIf Range(\"A9\").Value = \"No\" Then\n            Call Macro3\n        End If\n    End If\nEnd Sub\n\n\nSub Macro3()\n'\n' Macro3 Macro\n'\n\n'\n    Rows(\"11:18\").Select\n    Selection.EntireRow.Hidden = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449701734, "post_id": 34190489, "comment_id": 56127533, "body": "Don&#39;t use R1C1 notation. Try <code>cells(row,column)</code>."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1449704354, "post_id": 34190489, "comment_id": 56128581, "body": "Since you are learning, <a href=\"http://stackoverflow.com/q/10714251/445425\">see this regarding Select</a>"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449701975, "post_id": 34190598, "comment_id": 56127648, "body": "@findwindow R1C1 is absolute same as <code>Cells(1,1)</code>, where as R[1]C[1] is relative it is the same as <code>offset(1,1)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1449702182, "post_id": 34190598, "comment_id": 56127722, "body": "@DirkReichel Thank you, there were two things wrong with that part."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1449702125, "last_edit_date": 1449702125, "creation_date": 1449701786, "answer_id": 34190598, "question_id": 34190489, "link": "https://stackoverflow.com/questions/34190489/vba-activecell-formular1c1-absolute-with-variable/34190598#34190598", "title": "VBA activecell.formulaR1C1 absolute with variable", "body": "<p>Try this:</p>\n\n<pre><code>Range(\"L\" &amp; i &amp; \":W\" &amp; i).FormulaR1c1 = \"=IF(R\" &amp; i &amp; \"C5 = R[\" &amp; k &amp; \"]C,R\" &amp; i &amp; \"C1,\"\" \"\")\"\n</code></pre>\n\n<p>With r1c1 there is no need of autofill.</p>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1449735335, "creation_date": 1449735335, "answer_id": 34196758, "question_id": 34190489, "link": "https://stackoverflow.com/questions/34190489/vba-activecell-formular1c1-absolute-with-variable/34196758#34196758", "title": "VBA activecell.formulaR1C1 absolute with variable", "body": "<p>It looks to me like you just need:</p>\n\n<pre><code>Range(\"L3:W\" &amp; iVal).FormulaR1C1 = \"=IF(RC5=R1C,RC1,\"\" \"\")\"\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5661471, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bbc630107393cdf2a394d94d4256b717?s=128&d=identicon&r=PG&f=1", "display_name": "MVZ", "link": "https://stackoverflow.com/users/5661471/mvz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4591, "favorite_count": 0, "accepted_answer_id": 34190598, "answer_count": 2, "score": 0, "last_activity_date": 1449735335, "creation_date": 1449701337, "question_id": 34190489, "link": "https://stackoverflow.com/questions/34190489/vba-activecell-formular1c1-absolute-with-variable", "title": "VBA activecell.formulaR1C1 absolute with variable", "body": "<p>I'm currently studying on my own vba so thanks in advance for taking the time to read this. \nI've researched a lot and got stuck with a vba error regarding the variables of my formula, the code is the following:</p>\n\n<pre><code>Dim i As Long\nDim j As Long\nDim k As Integer\nDim iVal As Byte\n\nWith ActiveSheet\n    iVal = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\n\nj = 2\nk = -1\n\nFor i = 3 To iVal\n\nj = j+1\nk = k-1\n\nRange(\"L3\").Select\nActiveCell.FormulaR1C1 = \"=IF(R\" &amp; i &amp; \"C5=R[\" &amp; k &amp; \"])\"\n'ActiveCell.FormulaR1C1 = \"=+IF(R3C5=R[-2]C,R3C1,\"\" \"\")\"\nSelection.AutoFill Destination:=Range(\"L\" &amp; i &amp; \": W\" &amp; i),      Type:=xlFillDefault\n</code></pre>\n\n<p>This is what I'm trying to do \"automatic\" with the For statement</p>\n\n<pre><code>Range(\"L3\").Select\nActiveCell.FormulaR1C1 = \"=+IF(R3C5=R[-2]C,R3C1,\"\" \"\")\"\nSelection.AutoFill Destination:=Range(\"L3:W3\"), Type:=xlFillDefault\n\nRange(\"L4\").Select\nActiveCell.FormulaR1C1 = \"=+IF(R4C5=R[-3]C,R4C1,\"\" \"\")\"\nSelection.AutoFill Destination:=Range(\"L4:W4\"), Type:=xlFillDefault\n\nRange(\"L5\").Select\nActiveCell.FormulaR1C1 = \"=+IF(R5C5=R[-4]C,R5C1,\"\" \"\")\"\nSelection.AutoFill Destination:=Range(\"L5:W5\"), Type:=xlFillDefault\nNext\n</code></pre>\n\n<p>I think I'm really close but must be a minor detail I'm missing, thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1449701508, "post_id": 34190473, "comment_id": 56127442, "body": "<code>Hope this isn&#39;t too much to ask.</code> Please see <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask a question</a>."}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 2653963, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ad1e5909a708250fd82b9c8fab5b01f5?s=128&d=identicon&r=PG", "display_name": "ruskind", "link": "https://stackoverflow.com/users/2653963/ruskind"}, "reply_to_user": {"reputation": 1, "user_id": 5661431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c81ff0f489f721b7b7607a874696416?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/5661431/sean"}, "edited": false, "score": 0, "creation_date": 1449772138, "post_id": 34192097, "comment_id": 56162586, "body": "Good. I&#39;m glad. if you accept the answer then it will help other who have a similar or the same problem..."}], "tags": [], "owner": {"reputation": 237, "user_id": 2653963, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ad1e5909a708250fd82b9c8fab5b01f5?s=128&d=identicon&r=PG", "display_name": "ruskind", "link": "https://stackoverflow.com/users/2653963/ruskind"}, "is_accepted": false, "score": 0, "last_activity_date": 1449710165, "creation_date": 1449710165, "answer_id": 34192097, "question_id": 34190473, "link": "https://stackoverflow.com/questions/34190473/excel-invoice-export-reorganzing-for-input-into-quickbooks/34192097#34192097", "title": "Excel - Invoice Export reorganzing for input into quickbooks", "body": "<p>I have written a VBA function which should do as you describe. The function checks every cell in the used range to see if it is not empty and below a header that contains 'line'. If the cell does contains this data, it takes the relevant data and puts it into a new sheet named <code>ws</code> temporarily. Once all the data is tranferred it deletes the original sheet and renames the the sheet to be the same as the original, giving the impression of a modified sheet. I haven't been able to test it extensively but it should work. The function is as follows:</p>\n\n<pre><code>    Function NormalizeData(shtnm As String)\n        Application.ScreenUpdating = False\n        Dim rowcount As Long\n        Dim colcount As Long\n        Dim colnum As Long\n        Dim rownum As Long\n        Dim tgtrow As Long\n        Sheets.Add.Name = \"ws\"\n        Dim ws As Worksheet\n        Set ws = Sheets(\"ws\")\n        ws.Cells(1, 1).Value = \"Quote No\"\n        ws.Cells(1, 2).Value = \"Delivery Date\"\n        ws.Cells(1, 3).Value = \"Patient\"\n        ws.Cells(1, 4).Value = \"Product\"\n        ws.Cells(1, 5).Value = \"Price\"\n        ws.Cells(1, 6).Value = \"Total\"\n        With Sheets(shtnm)\n        rowcount = .UsedRange.Rows.Count\n        colcount = .UsedRange.Columns.Count\n        For rownum = 2 To rowcount\n            For colnum = 1 To colcount\n                tgtrow = ws.UsedRange.Rows.Count + 1\n                If .Cells(1, colnum) Like \"*Line *\" And .Cells(rownum, colnum) &lt;&gt; \"\" Then\n                        ws.Cells(tgtrow, 1).Value = .Cells(rownum, 1).Value\n                        ws.Cells(tgtrow, 2).Value = .Cells(rownum, 2).Value\n                        ws.Cells(tgtrow, 3).Value = .Cells(rownum, 3).Value\n                        ws.Cells(tgtrow, 4).Value = .Cells(rownum, colnum).Value\n                        ws.Cells(tgtrow, 5).Value = .Cells(rownum, colnum + 1).Value\n                        ws.Cells(tgtrow, 6).Value = .Cells(rownum, colcount).Value\n                End If\n            Next colnum\n        Next rownum\n        .Delete\n        End With\n        ws.Name = shtnm\n        Application.ScreenUpdating = True\n    End Function\n</code></pre>\n\n<p>This is the sub to call the tranformation:</p>\n\n<pre><code>    Sub CallNormalise()\n        Application.DisplayAlerts = False\n        Call NormalizeData(\"Sheet1\")\n    End Sub\n</code></pre>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 1, "user_id": 5661431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c81ff0f489f721b7b7607a874696416?s=128&d=identicon&r=PG&f=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/5661431/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449710165, "creation_date": 1449701282, "last_edit_date": 1531164843, "question_id": 34190473, "link": "https://stackoverflow.com/questions/34190473/excel-invoice-export-reorganzing-for-input-into-quickbooks", "title": "Excel - Invoice Export reorganzing for input into quickbooks", "body": "<p>I have a excel sheet that is exported from our POS.  I need to reformat it to suitable input format for quickbooks.</p>\n\n<pre><code>Quote No    Delivery Date   Patient Line 1  Price 1 Line 2  Price 2 Line 3  Price 3 Line 4  Price 4 Line 5  Price 5 Line 6  Price 6 Line 7  Price 7 Line 8  Price 8 Line 9  Price 9 Line 10 Price 10    Line 11 Price 11    Line 12 Price 12    Line 13 Price 13    Line 14 Price 14    Line 15 Price 15    Line 16 Price 16    Line 17 Price 17    Line 18 Price 18    Line 19 Price 19    Line 20 Price 20    Line 21 Price 21    Line 22 Price 22    Line 23 Price 23    Line 24 Price 24    Total\n1234        10/10/15        ABC     p1l     $1.00   p2l      $1.00                                                  p1r     $1.00   p2r     $1.00                                                                                                                                                                                                                                                                                                                                               $4.00\n</code></pre>\n\n<p>What I need to happen is for each line and price to a be a new line for example</p>\n\n<pre><code>Quote No   Delivery Date    Patient     Product     Price     Total\n1234       10/10/15         ABC         P1L         $1.00     $4.00\n1234       10/10/15         ABC         P2L         $1.00     $4.00\n1234       10/10/15         ABC         P1R         $1.00     $4.00\n1234       10/10/15         ABC         P2R         $1.00     $4.00\n.....\n2222       10/15/15         YZD        ..............................\n</code></pre>\n\n<p>So for each product on the invoice I need a new row created with the customer information duplicated as well as the total.  </p>\n\n<p>There are 24 available slots for product/price combinations and many of them are often blank and there will be blank product/price combos between other filled product/price combos as the POS puts specific sales items in specific columns and not all sales contain all items. So for those blank spots we can't have a blank line created.</p>\n\n<p>Range of the columns are A:AZ</p>\n\n<p>It wouldn't contain more than a 1000 rows</p>\n\n<p>Hope this isn't too much to ask.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "sas", "vba"], "comments": [{"owner": {"reputation": 19, "user_id": 5636612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc97107e6b20ce8e8ec6c78f773dd176?s=128&d=identicon&r=PG&f=1", "display_name": "User9132", "link": "https://stackoverflow.com/users/5636612/user9132"}, "reply_to_user": {"reputation": 58518, "user_id": 1623007, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40931bddde219f1a9e4514d2f4cfa826?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1623007/joe"}, "edited": false, "score": 0, "creation_date": 1449701406, "post_id": 34190328, "comment_id": 56127402, "body": "Yes it is. Everything runs through excel."}, {"owner": {"reputation": 19, "user_id": 5636612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc97107e6b20ce8e8ec6c78f773dd176?s=128&d=identicon&r=PG&f=1", "display_name": "User9132", "link": "https://stackoverflow.com/users/5636612/user9132"}, "edited": false, "score": 0, "creation_date": 1449702200, "post_id": 34190328, "comment_id": 56127732, "body": "I did describe the code! But will edit"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1449702591, "post_id": 34190328, "comment_id": 56127895, "body": "still not enough, you say it always executes the success statement.....don&#39;t see that anywhere in the code you provided.  Some one can take a guess but that is all it will be as we don&#39;t know what your code is actually doing and you don&#39;t seem to want to put enough of it here for us to help you determine the cause.  Help us help you"}, {"owner": {"reputation": 19, "user_id": 5636612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc97107e6b20ce8e8ec6c78f773dd176?s=128&d=identicon&r=PG&f=1", "display_name": "User9132", "link": "https://stackoverflow.com/users/5636612/user9132"}, "edited": false, "score": 0, "creation_date": 1449703353, "post_id": 34190328, "comment_id": 56128201, "body": "sorry about that, I have added that section of code."}, {"owner": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1449717937, "post_id": 34190328, "comment_id": 56132488, "body": "There doesn&#39;t appear any conditional aspect to your SAS code so it will execute regardless."}, {"owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "edited": false, "score": 0, "creation_date": 1449751679, "post_id": 34190328, "comment_id": 56149221, "body": "Als Excel did not transform the olesas into OleSAS in <code>olesas.submit</code>, it looks as if it did not recognise it as being the same object as in <code>do while (OleSAS.busy = &quot;True&quot;)</code>, <i>or</i> your code does not compile."}], "owner": {"reputation": 19, "user_id": 5636612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc97107e6b20ce8e8ec6c78f773dd176?s=128&d=identicon&r=PG&f=1", "display_name": "User9132", "link": "https://stackoverflow.com/users/5636612/user9132"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449754006, "creation_date": 1449700589, "last_edit_date": 1531164843, "question_id": 34190328, "link": "https://stackoverflow.com/questions/34190328/pause-vba-while-sas-runs", "title": "Pause VBA while SAS runs", "body": "<p>I am calling SAS via a olesas steps in VBA. I have a field in my excel sheet that says either \"Successful\", \"processing\" or \"failed\".</p>\n\n<p>I have set sas to quit if any errors are encountered and to output \"successful\" as a last step (if it runs to completion with no errors).</p>\n\n<p>I am using a do while loop to check if SAS is still busy (olesas.busy = \"True\") to pause VBA while sas is running and then, if the block does not display successful, to change the block to \"failed\". This all seems to work fine, except that even if SAS has terminated, the last step still executes and changes the block to say \"successful\". Any ideas as to why this may be happening?</p>\n\n<pre><code>do while (OleSAS.busy = \"True\")\napplication.wait (now + TimeValue(\"0:00:02\"))\nLoop\nif sheet1.range(\"box\")=\"busy\" then sheet1.range(\"box\")=\"failed\"\n</code></pre>\n\n<p>I cannot share the rest of the code, but I have used an \"errabend\" statement to make sas quit if there is an error. I would have thought that the do while would keep everything paused until sas had finished and then only change to failed if the last sas step didnt complete. </p>\n\n<p>SAS code: </p>\n\n<pre><code>data _null_;\nfile new ;\nput 'Successful';\nrun;\n</code></pre>\n\n<p>VBA Call </p>\n\n<pre><code>olesas.submit (\"filename new DDE 'excel'|\" + workbookpath + \"\\[\" + workbookname + \"]\" + sheet1 + r1c1:r1c1' notab;\")\n</code></pre>\n"}, {"tags": ["excel", "vba", "user-defined-functions", "conditional-formatting", "udf"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1449710065, "creation_date": 1449710065, "answer_id": 34192084, "question_id": 34190313, "link": "https://stackoverflow.com/questions/34190313/vba-optimize-udf-cell-color-counter/34192084#34192084", "title": "VBA - Optimize UDF (Cell Color Counter)", "body": "<p>You can keep a count of the colored cells as you color them, then use that value, instead of counting the colored cells in a separate operation.</p>\n\n<pre><code>Sub DoColors()\n\n    Dim ref As Worksheet, e1 As Worksheet\n    Dim wkb As Workbook, pn1\n    Dim rw As Range, i As Long, j As Long, n As Long, v, v2, v3\n\n    Set wkb = ThisWorkbook\n    Set ref = wkb.Sheets(\"Reference\")\n    pn1 = ref.Range(\"E17\").Value\n\n    Set e1 = wkb.Sheets(pn1)\n\n    j = 2\n    n = 0\n    For i = 7 To 53\n\n        Set rw = e1.Rows(i)\n\n        v = rw.Cells(j).Value\n\n        If IsNumeric(v) And v &gt; 0 Then\n\n            v2 = rw.Cells(j + 8).Value\n            v3 = rw.Cells(j + 9).Value\n\n            If Abs(v - v2) / v2 &gt; 0.25 Or Abs(v - v3) / v3 &gt; 0.25 Then\n                rw.Cells(j).Interior.Color = RGB(252, 213, 181)\n                n = n + 1\n            End If\n\n        End If\n    Next i\n\n    'put n somewhere...\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 5855604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22d4f1540d0fb198056c989ab7e9c019?s=128&d=identicon&r=PG&f=1", "display_name": "Yury Suturin", "link": "https://stackoverflow.com/users/5855604/yury-suturin"}, "is_accepted": false, "score": 1, "last_activity_date": 1485146901, "creation_date": 1485146901, "answer_id": 41799404, "question_id": 34190313, "link": "https://stackoverflow.com/questions/34190313/vba-optimize-udf-cell-color-counter/41799404#41799404", "title": "VBA - Optimize UDF (Cell Color Counter)", "body": "<p>Your code is slow because you refer to Excel to check each cell in the range. The most efficient way would be to load the used range into VBA memory and working with those arrays - check this set of articles - it's extremely useful and well written <a href=\"https://fastexcel.wordpress.com/making-your-vba-udfs-efficient/\" rel=\"nofollow noreferrer\">https://fastexcel.wordpress.com/making-your-vba-udfs-efficient/</a> </p>\n\n<p>Also for faster calculation - you can calculate a range of the worksheet, no need to recalc all sheet.</p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 11, "user_id": 5661464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1c7d0a7ab09b529fede867c7b296a1?s=128&d=identicon&r=PG&f=1", "display_name": "eachanpe", "link": "https://stackoverflow.com/users/5661464/eachanpe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1485146901, "creation_date": 1449700512, "question_id": 34190313, "link": "https://stackoverflow.com/questions/34190313/vba-optimize-udf-cell-color-counter", "title": "VBA - Optimize UDF (Cell Color Counter)", "body": "<p>I have a workbook with a main control sheet and 40-50 different data sheets that are copy/paste valued into the file from an external source (each sheet has anywhere from 30 to 500 rows and 10 to 100 columns with data). </p>\n\n<p>The purpose of the workbook is to compare cells in various data sheet columns and highlight them if they fit a certain variance criteria; the highlighted cells on each data sheet are then counted and displayed on the main control sheet (using UDF formulas). </p>\n\n<p>After reading the cpearson site, I realized that counting highlighted cells was nearly impossible if you used traditional conditional formatting... but I only figured this out after I had already written the custom CF code in VBA for 40+ sheets (this was done so that formatting could be removed or applied with a macro button after the data sheets had been \"refreshed\" using copy/paste).</p>\n\n<p>So after a nice long cry, I essentially recreated conditional formatting (again in VBA) using looping to achieve my goal.</p>\n\n<hr>\n\n<p>Example criteria: 25% less than or greater than the cell value compared.</p>\n\n<p>Example Data Sheet:</p>\n\n<pre><code>[col 1] *** [col 2]\n2014 *****2015\n1 *********1.1\n3 **********3\n532 *******555\n323 *******46 &lt;&lt;&lt;this would Highlight\n42 *******-112 &lt;&lt;&lt;&lt;this would highlight\n\n(The highlighting would occur if cells in col 2 are either 25% greater or\n less than the cells in col 1 cell for the corresponding row.)\n\nasterisks are only used for the purpose of spacing the two columns in this example\n</code></pre>\n\n<p>Example code: </p>\n\n<pre><code>Dim ref As WorksheetDim wkb As Workbook\n\nSet wkb = ThisWorkbook\nSet ref = ThisWorkbook.Sheets(\"Reference\")\npn1 = ref.Range(\"E17\").Value\n\n\nWith wkb.Sheets(pn1)\n.Select\n\nSet e1 = wkb.Sheets(pn1)\n\n For i = 7 To 53\n j = 2\n k = j + 8\n\n\n    If e1.Cells(i, j).Value &gt; 0 And IsNumeric(e1.Cells(i, j).Value) = True _\n    Then If e1.Cells(i, j).Value &gt; 1.25 * e1.Cells(i, k).Value _\nOr e1.Cells(i, j).Value &lt; 0.75 * e1.Cells(i, k).Value _\n    Then e1.Cells(i, j).Interior.Color = RGB(252, 213, 181)\n\n\nIf e1.Cells(i, j).Value &lt; 0 And IsNumeric(e1.Cells(i, j).Value) = True _\n    Then If e1.Cells(i, j).Value &lt; 1.25 * e1.Cells(i, k).Value _\nOr e1.Cells(i, j).Value &gt; 0.75 * e1.Cells(i, k).Value _\n    Then e1.Cells(i, j).Interior.Color = RGB(252, 213, 181)\n\nNext i\n\n  ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n  For i = 7 To 53\n  j = 2\n  k = j + 9\n\n\nIf e1.Cells(i, j).Value &gt; 0 And IsNumeric(e1.Cells(i, j).Value) = True _\n    Then If e1.Cells(i, j).Value &gt; 1.25 * e1.Cells(i, k).Value _\nOr e1.Cells(i, j).Value &lt; 0.75 * e1.Cells(i, k).Value _\n    Then e1.Cells(i, j).Interior.Color = RGB(252, 213, 181)\n\n\nIf e1.Cells(i, j).Value &lt; 0 And IsNumeric(e1.Cells(i, j).Value) = True _\n    Then If e1.Cells(i, j).Value &lt; 1.25 * e1.Cells(i, k).Value _\nOr e1.Cells(i, j).Value &gt; 0.75 * e1.Cells(i, k).Value _\n    Then e1.Cells(i, j).Interior.Color = RGB(252, 213, 181)\n\nNext i\n\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>(There are often blank columns between populated data columns and hidden rows scattered throughout the sheets)</p>\n\n<p>I then created a UDF to fit my counting needs:</p>\n\n<pre><code>Function CountRed(MyRange As Range) As Integer                                       \n'Application.Volatile                                                          \nCountRed = 0                                                                    \nFor Each cell In MyRange                                                        \nIf Not cell.EntireRow.Hidden And cell.Interior.Color = RGB(252, 213, 181) \nCountRed = CountRed + 1                                                         \nEnd If                                                                          \nNext cell\nEnd Function\n</code></pre>\n\n<p>I have two main issues:</p>\n\n<ol>\n<li><p>When the conditional formatting is applied, the cell displaying the UDF formula (=CountRed[WkshtName]{Range:Range}) does not automatically update; this being the case even if \"application.volatile\" is active for the UDF and the workbook is set to automatic calculation.</p></li>\n<li><p>Speed.</p></li>\n</ol>\n\n<p>With these two conditions in mind (application.volatile and automatic calculation), the highlighted cell count number (output of the UDF formula) will only update if I click one of the UDF formula cells and press F9 (or I can click the formula bar and press enter), but the bigger problem is that my workbook times out for a solid 4-5 minutes while it updates ALL of the UDF formulas on my page (this is my assumption based on quicker processing times with less UDF formulas on the page or smaller range criteria used in the UDF formulas). *Turning off application.volatile and leaving automatic calculation on yields similar results.</p>\n\n<p>To combat this I have turned OFF both automatic calculation and application.volatile (this seemingly has no effect either way).</p>\n\n<p>I know this method will not allow for any type of automatic updating of the output UDF formula (highlighted cell count number), but the manual recalculation (F9 or formula \"enter\") of each UDF formula now only takes 5-10 seconds depending on the range size (it will also only update the cell you clicked on). </p>\n\n<p>My main hiccup here occurs when I try and include a click button macro that forces an update of the whole page to eliminate the need for updating each UDF formula cell (ex. ThisWorkbook.Worksheets(\"Reference\").Calculate), my calculation time then slows back down near the original updating times (3-4 minutes) and leaves me questioning if it is really that much faster after all.</p>\n\n<p>All of that leads me to ask...</p>\n\n<p>Is there was any way to optimize or speed up the looping/processing time of my custom UDF?</p>\n\n<p>Automatic updating would be icing on the cake, but if I have to force a manual recalculation then I would love for it to be as fast as possible.</p>\n\n<hr>\n\n<p>Please let me know if I need to clarify anything, or take screen shots of my workbook/code (I apologize in advance if my explanation is fairly convoluted; I have been using VBA for a limited time and am certainly still a novice).</p>\n\n<p>Note: I am using Excel 2007.</p>\n\n<p>THANK YOU IN ADVANCE !!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1449706108, "post_id": 34190238, "comment_id": 56129221, "body": "I can&#39;t find any documentation on <code>.Status_Text</code>. It doesn&#39;t seem to be a property of a worksheet object. When I try to run your code it doesn&#39;t work, failing on the line <code>With ActiveSheet.Status_Text</code> .with an error to message &quot;Object doesn&#39;t support this property or method&quot;. What version of Excel are you using? Perhaps this was just added in the most recent version."}, {"owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1449764334, "post_id": 34190238, "comment_id": 56158000, "body": "Excel 2010, tested in Excel 2013 as well. &quot;Status_Text&quot; is the name of a caption on the page. I can modify it using ActiveSheet.Status_Text, but not using the wsLoop.Status_Text"}, {"owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1449767602, "post_id": 34190238, "comment_id": 56160087, "body": "Status_Text is just the name associated with the caption box, so I&#39;m not surprised that nobody else has used that particular name. What I&#39;m confused about is why I can modify it using <code>ActiveSheet.Captionboxnamehere</code> but not <code>Worksheetvariablenamehere.Captionboxnamehere</code>"}, {"owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1449783842, "post_id": 34190238, "comment_id": 56168931, "body": "The label is only named in the spreadsheet itself, not in the project anywhere. It is a form control label with the title &quot;Status_Text&quot;. I am not using any COM add-ins other than one for Lync messenger (which I can disable without impacting the functionality of the code), and the only addins that I am using are Microsoft&#39;s Solver and an addin that I wrote containing a few commonly used macros (tile windows, add IFERROR to cells, etc.)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1449786480, "post_id": 34190238, "comment_id": 56170292, "body": "All makes sense now -- perhaps you can edit the question to include the crucial piece of information that <code>Status_Text</code> is the name of an ActiveX forms control."}], "answers": [{"comments": [{"owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "edited": false, "score": 0, "creation_date": 1449851286, "post_id": 34212874, "comment_id": 56200174, "body": "That worked perfectly! I confirmed both approaches worked, and wound up using the For-Next loop as it fit in a bit better with the rest of the module. I edited the question to clarify that it was a form control as well. Thanks so much for your help!"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 2, "last_activity_date": 1449789893, "last_edit_date": 1449789893, "creation_date": 1449786412, "answer_id": 34212874, "question_id": 34190238, "link": "https://stackoverflow.com/questions/34190238/avoiding-activate-with-activex-form-control/34212874#34212874", "title": "Avoiding .Activate with ActiveX Form Control", "body": "<p>Interesting question which seems to touch on some poorly-documented features of Excel VBA. It seems that maybe the expression <code>ActiveSheet.Status_Text</code> is operating as the <em>name</em> of the control, with the dot acting as a namespace qualifier, but that in <code>wsLoop.Status_Text</code> VBA is interpreting the dot as the method/property access operator and is correctly giving the error message that no such method or property exists. To reproduce the problem, I created a label named <code>Status_Text</code> on each sheet and then ran</p>\n\n<pre><code>Sub test1()\n    Dim ws As Worksheet\n    For Each ws In Worksheets\n        Debug.Print ws.Status_Text.Caption 'fails\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>It crashes with the error that you show. One workaround (although just <em>why</em> it works is mysterious) is to change the loop index from being a <code>Worksheet</code> to a <code>Variant</code>:</p>\n\n<pre><code>Sub test2()\n    Dim ws As Variant\n    For Each ws In Worksheets\n        Debug.Print ws.Status_Text.Caption 'succeeds\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>The odd thing about this last example is if you add the line <code>Debug.Print TypeName(ws)</code> in the for-each loop it prints <code>Worksheet</code> so <code>ws.Status_Text</code> works if <code>ws</code> is a variant which holds a worksheet but not if <code>ws</code> is actually a worksheet. The mystery is in some sense deepened but in another sense lessened when you step through this sub in the debugger, looking at the locals window. The type of <code>ws</code> in the loop is described as <code>Variant/Object/Sheet1</code> (in the first pass through the loop). The specific sheet seems to be part of the current subtype of the variable.</p>\n\n<p>Another workaround is to use a <code>For-Next</code> loop rather than a <code>For-Each</code>:</p>\n\n<pre><code>Sub test3()\n    Dim i As Long\n    For i = 1 To Worksheets.Count\n        Debug.Print Worksheets(i).Status_Text.Caption 'succeeds\n    Next i\nEnd Sub\n</code></pre>\n\n<p>You could use either of these approaches to get a reference to the label without having to activate the sheet. </p>\n"}], "owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 34212874, "answer_count": 1, "score": 3, "last_activity_date": 1449851106, "creation_date": 1449700179, "last_edit_date": 1531164843, "question_id": 34190238, "link": "https://stackoverflow.com/questions/34190238/avoiding-activate-with-activex-form-control", "title": "Avoiding .Activate with ActiveX Form Control", "body": "<p>I'm updating a macro that's used in lots of spreadsheets, and it's rather slow. While looking to speed it up, I noticed that at one point it goes through this loop:</p>\n\n<pre><code>For each wsLoop in ThisWorkbook.Worksheets\n        wsLoop.Activate\n        With ActiveSheet.Status_Text\n            If bStatus = True Then\n                .ForeColor = &amp;HC000&amp;\n                .Caption = \"ONLINE\"\n            Else\n                .ForeColor = &amp;HFF&amp;\n                .Caption = \"OFFLINE\"\n            End If\n        End With\nNext wsLoop\n</code></pre>\n\n<p>Where wsLoop is a worksheet, bStatus is a boolean and Status_Text is the name of an ActiveX label form control on each worksheet.\nI know using .Activate is bad practice and can slow things down, so I dropped the <code>wsLoop.Activate</code> and changed the next line to <code>With wsLoop.Status_Text</code>, but now I get a \"Method or data member not found\" error message.\nWhat's the proper way to do this? </p>\n"}, {"tags": ["excel", "vba", "search", "text"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449701034, "post_id": 34190214, "comment_id": 56127240, "body": "Hmm does every shape contain text?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449704898, "post_id": 34190214, "comment_id": 56128787, "body": "@findwindow <code>shp.TextFrame.Characters.Text</code> will cause an error for most shapes... without <code>On Error Resume Next</code> I&#39;m not sure how to run it without error-messages"}, {"owner": {"reputation": 133, "user_id": 5661399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C6WfC.jpg?s=128&g=1", "display_name": "Mattice Verhoeven", "link": "https://stackoverflow.com/users/5661399/mattice-verhoeven"}, "edited": false, "score": 0, "creation_date": 1449706096, "post_id": 34190214, "comment_id": 56129216, "body": "I have tried to change   shp.TextFrame.Characters.Text   to  shp.TextEffect.Text  and it didn&#39;t work"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 5661399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C6WfC.jpg?s=128&g=1", "display_name": "Mattice Verhoeven", "link": "https://stackoverflow.com/users/5661399/mattice-verhoeven"}, "edited": false, "score": 0, "creation_date": 1449704579, "post_id": 34190555, "comment_id": 56128658, "body": "I ran it, and it didn&#39;t seem to do anything noticeable. then I ran the original code, and the error was still there. Thank you for the suggestion"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 133, "user_id": 5661399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C6WfC.jpg?s=128&g=1", "display_name": "Mattice Verhoeven", "link": "https://stackoverflow.com/users/5661399/mattice-verhoeven"}, "edited": false, "score": 0, "creation_date": 1449704661, "post_id": 34190555, "comment_id": 56128689, "body": "@MatticeVerhoeven there should be a lot of text in the direct window of your VBA-window... the last output should be the &quot;finished&quot;... that tells us that there is a different problem..."}, {"owner": {"reputation": 133, "user_id": 5661399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C6WfC.jpg?s=128&g=1", "display_name": "Mattice Verhoeven", "link": "https://stackoverflow.com/users/5661399/mattice-verhoeven"}, "edited": false, "score": 0, "creation_date": 1449705666, "post_id": 34190555, "comment_id": 56129071, "body": "I&#39;m quite new to VBA sorry, I&#39;m not sure what the direct window is. Also, should I run just the code above, or include it into the original code?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 133, "user_id": 5661399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C6WfC.jpg?s=128&g=1", "display_name": "Mattice Verhoeven", "link": "https://stackoverflow.com/users/5661399/mattice-verhoeven"}, "edited": false, "score": 0, "creation_date": 1449706120, "post_id": 34190555, "comment_id": 56129226, "body": "@MatticeVerhoeven as an extra macro... inside the VBA-window go to &quot;View =&gt;&gt; Direct Window&quot; or just press Ctrl + G... pls try the new code as an extra macro (i still need to know if the error pops up and the last output before it crashes)..."}, {"owner": {"reputation": 133, "user_id": 5661399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C6WfC.jpg?s=128&g=1", "display_name": "Mattice Verhoeven", "link": "https://stackoverflow.com/users/5661399/mattice-verhoeven"}, "edited": false, "score": 0, "creation_date": 1449706456, "post_id": 34190555, "comment_id": 56129347, "body": "Yup I ran as an extra macro, there was a lot of text followed by &quot;finished&quot; in the direct window. Then I ran the original code again and got the same error."}, {"owner": {"reputation": 133, "user_id": 5661399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C6WfC.jpg?s=128&g=1", "display_name": "Mattice Verhoeven", "link": "https://stackoverflow.com/users/5661399/mattice-verhoeven"}, "edited": false, "score": 0, "creation_date": 1449706838, "post_id": 34190555, "comment_id": 56129469, "body": "it worked!! Thank you very much. Is there a way to make it not case sensitive though?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 133, "user_id": 5661399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C6WfC.jpg?s=128&g=1", "display_name": "Mattice Verhoeven", "link": "https://stackoverflow.com/users/5661399/mattice-verhoeven"}, "edited": false, "score": 0, "creation_date": 1449706971, "post_id": 34190555, "comment_id": 56129509, "body": "@MatticeVerhoeven i changed the <code>instr</code>-line to <code>If InStr(1, sTemp, sFind, 1) Then</code>... it now shout not be case sensitive anymore"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 133, "user_id": 5661399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C6WfC.jpg?s=128&g=1", "display_name": "Mattice Verhoeven", "link": "https://stackoverflow.com/users/5661399/mattice-verhoeven"}, "edited": false, "score": 0, "creation_date": 1449707202, "post_id": 34190555, "comment_id": 56129590, "body": "@MatticeVerhoeven still... you need to know it does a specific check... having a smart-art with lots of text, they won&#39;t be checked... if you find a situation where it doesnt find a match it should, just ask and i&#39;ll change the code so it does... (there are countless paths where the text could be and it isn&#39;t possible to check all in a simple way)"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 2, "last_activity_date": 1590391270, "last_edit_date": 1590391270, "creation_date": 1449701621, "answer_id": 34190555, "question_id": 34190214, "link": "https://stackoverflow.com/questions/34190214/search-for-text-in-shapes/34190555#34190555", "title": "Search for text in shapes", "body": "<p>This is NOT an answer (but too much for a comment)</p>\n\n<p>Please try this and check if the error still pops up:</p>\n\n<pre><code>Sub testForError()\n  Dim shp As Shape, i As Long\n  On Error Resume Next\n  For Each shp In ActiveSheet.Shapes\n    i = i + 1\n    Debug.Print i &amp; \" \" &amp; shp.Type\n    Debug.Print i &amp; \" \" &amp; shp.TextFrame.Characters.Text\n    Debug.Print i &amp; \" \" &amp; shp.TextFrame2.TextRange.Text\n  Next\n  Debug.Print \"finished\"\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong><br>\npls try it and tell me if errors pop up :)</p>\n\n<pre><code>Sub FindInShape1()\n  Dim shp As Shape\n  Dim sFind As String\n  Dim sTemp As String\n  sFind = InputBox(\"Search for?\")\n  If Trim(sFind) = \"\" Then MsgBox \"Nothing entered\": Exit Sub\n  On Error Resume Next\n  For Each shp In ActiveSheet.Shapes\n    Debug.Print shp.TopLeftCell.Address\n    sTemp = \"\"\n    sTemp = shp.TextFrame.Characters.Text\n    If Len(sTemp) Then\n      If InStr(1, sTemp, sFind, 1) Then\n        shp.Select\n        If MsgBox(shp.Name &amp; vbCrLf &amp; sTemp &amp; vbCrLf &amp; vbCrLf &amp; \"Do you want to continue?\", vbYesNo, \"Continue?\") &lt;&gt; vbYes Then Exit Sub\n      End If\n    End If\n  Next\n  MsgBox \"No more found\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1578696343, "post_id": 54130400, "comment_id": 105536435, "body": "That line of code is capturing a <code>String</code> with the text within the shape, not the object, so <code>Set</code> is not appropriate here."}], "tags": [], "owner": {"reputation": 1, "user_id": 10895649, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SKnEXcP2u0/AAAAAAAAAAI/AAAAAAAADqA/ldecpBNAKTw/photo.jpg?sz=128", "display_name": "Project PowerPoint Studios", "link": "https://stackoverflow.com/users/10895649/project-powerpoint-studios"}, "is_accepted": false, "score": 0, "last_activity_date": 1547129058, "creation_date": 1547129058, "answer_id": 54130400, "question_id": 34190214, "link": "https://stackoverflow.com/questions/34190214/search-for-text-in-shapes/54130400#54130400", "title": "Search for text in shapes", "body": "<p>You forget that you must put \"set\" before assigning any shape variable.</p>\n\n<pre><code>Set sTemp = shp.TextFrame.Characters.Text\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 5661399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C6WfC.jpg?s=128&g=1", "display_name": "Mattice Verhoeven", "link": "https://stackoverflow.com/users/5661399/mattice-verhoeven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8562, "favorite_count": 1, "accepted_answer_id": 34190555, "answer_count": 2, "score": 0, "last_activity_date": 1594189197, "creation_date": 1449700053, "last_edit_date": 1594189197, "question_id": 34190214, "link": "https://stackoverflow.com/questions/34190214/search-for-text-in-shapes", "title": "Search for text in shapes", "body": "<p>I want to search text in shapes on Excel and I found the following code in excel.tips.net</p>\n<pre><code>Sub FindInShape1()\n    Dim rStart As Range\n    Dim shp As Shape\n    Dim sFind As String\n    Dim sTemp As String\n    Dim Response\n\n    sFind = InputBox(&quot;Search for?&quot;)\n    If Trim(sFind) = &quot;&quot; Then\n        MsgBox &quot;Nothing entered&quot;\n        Exit Sub\n    End If\n    Set rStart = ActiveCell\n    For Each shp In ActiveSheet.Shapes\n        sTemp = shp.TextFrame.Characters.Text\n        If InStr(LCase(sTemp), LCase(sFind)) &lt;&gt; 0 Then\n            shp.Select\n            Response = MsgBox( _\n              prompt:=shp.Name &amp; vbCrLf &amp; _\n              sTemp &amp; vbCrLf &amp; vbCrLf &amp; _\n              &quot;Do you want to continue?&quot;, _\n              Buttons:=vbYesNo, Title:=&quot;Continue?&quot;)\n            If Response &lt;&gt; vbYes Then\n                Set rStart = Nothing\n                Exit Sub\n            End If\n        End If\n    Next\n    MsgBox &quot;No more found&quot;\n    rStart.Select\n    Set rStart = Nothing\nEnd Sub\n</code></pre>\n<p>It works if I search for a word that is in a shape near the top of the worksheet.\nHowever, the worksheet is quite large, and if I search for something in the middle or bottom, I get error;</p>\n<blockquote>\n<p>Run-time error '-2147024809 (80070057)': The specified Value is out of\nrange</p>\n</blockquote>\n<p>I can choose to debug, and doing so highlights the line of code</p>\n<pre><code>sTemp = shp.TextFrame.Characters.Text\n</code></pre>\n<p>I'm using Excel 2010.</p>\n<p>Thank you for your help,</p>\n<p>Mattice</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449699848, "post_id": 34190144, "comment_id": 56126674, "body": "Uhh you have multiple <code>)</code>s XD"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1449699978, "post_id": 34190144, "comment_id": 56126728, "body": "I believe the end of your <code>FROM</code> line will need a space."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1449700078, "post_id": 34190144, "comment_id": 56126777, "body": "You also have an extra <code>&#39;</code> in the <code>WHERE</code> line. By the <code>-01</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1449700222, "post_id": 34190144, "comment_id": 56126847, "body": "What is the value of strterm when it fails?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1449701198, "post_id": 34190144, "comment_id": 56127307, "body": "Use <code>strterm = Join(arrTerm, &quot;, &quot;)</code> instead of the For-Next loop."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1449701899, "post_id": 34190144, "comment_id": 56127607, "body": "If <code>term</code> field has non-numeric type, then use <code>strterm = &quot;&quot;&quot;&quot; &amp; Join(arrTerm, &quot;&quot;&quot;, &quot;&quot;&quot;) &amp; &quot;&quot;&quot;&quot;</code> to treat the elements as string values within the query."}], "owner": {"reputation": 11, "user_id": 5661439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c87462939a2de95fabba94950b1ec50?s=128&d=identicon&r=PG&f=1", "display_name": "sxklml", "link": "https://stackoverflow.com/users/5661439/sxklml"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1452, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449699808, "creation_date": 1449699740, "last_edit_date": 1531164843, "question_id": 34190144, "link": "https://stackoverflow.com/questions/34190144/vba-error-run-time-error-214721790080040e14-incorrect-syntax-near", "title": "VBA Error: Run-time error &#39;2147217900(80040e14)&#39;: incorrect syntax near &#39;)&#39;", "body": "<p><strong>Hi guys, who can help me on this error message, my code is here:</strong> </p>\n\n<pre><code>Sub rvt(ByVal make, ByVal model, ByVal ModelYear, ByVal mm, ByVal yy, ByRef arrTerm(), Optional ByVal Country = \"US\")\nDim strsql As String, strterm As String\nDim outcell As Range\n\nIf Country = \"US\" Then GDF = \"ALG\"\nIf Country = \"CA\" Then GDF = \"CBB\"\n\nstrterm = \"\"\nFor i = 1 To UBound(arrTerm)\n    If i &lt;&gt; UBound(arrTerm) Then strterm = strterm &amp; arrTerm(i) &amp; \", \"\n    If i = UBound(arrTerm) Then strterm = strterm &amp; arrTerm(i)\nNext\n\nstrsql = \"SELECT [\" &amp; GDF &amp; \"GuideResidNew_MMMY]\" &amp; _\n         \"FROM [ResidualValueForecast].[GDF].[\" &amp; GDF &amp; \"Guide_New_MMMY]\" &amp; _\n         \"WHERE RVI_Make='\" &amp; make &amp; \"' and RVI_Model='\" &amp; model &amp; \"' and modelyear='\" &amp; ModelYear &amp; \"' and guidedate='\" &amp; yy &amp; \"-\" &amp; mm &amp; \"-01' and term in (\" &amp; strterm &amp; \") \" &amp; _\n         \"ORDER by term\"\nSheets(\"DATA\").Range(\"RVT[\" &amp; GDF &amp; \"]\").ClearContents\nSet outcell = Sheets(\"DATA\").Range(\"RVT[\" &amp; GDF &amp; \"]\")\n\nCall SQLconn(strsql, \"ResidualValueForecast\", outcell)\nIf ok_SQL = False Then MsgBox \"No \" &amp; GDF &amp; \" Residuals found for \" &amp; make &amp; \"-\" &amp; model &amp; \"-\" &amp; ModelYear &amp; vbNewLine &amp; \"Please check the table in the server!\", vbInformation\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "answers": [{"comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1449702957, "post_id": 34190667, "comment_id": 56128066, "body": "You should also never assume that MAPIFolder.Items.Item(Items.Count) will give you the last message. The order is undetermined unless you explicitly sort the Items collection."}, {"owner": {"reputation": 203, "user_id": 5091964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1a1b03d8d2d49553eb7f7cc4a8b63536?s=128&d=identicon&r=PG&f=1", "display_name": "Menachem", "link": "https://stackoverflow.com/users/5091964/menachem"}, "edited": false, "score": 0, "creation_date": 1449706436, "post_id": 34190667, "comment_id": 56129339, "body": "Thank you Dmitry. When I added delays, it did not help. In my  application I cannot add a MSgBOX or other manual delays. It has to work automatically. Can you explain me or suggest code how I can detect that the message was saved in the Sent Items Folder. It is not so clear how would ItemAdd do the job. It seems to me that unless the macro is not completed or stopped, the system would never save the sent message in the Sent Items folder. Thank again for your help."}, {"owner": {"reputation": 203, "user_id": 5091964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1a1b03d8d2d49553eb7f7cc4a8b63536?s=128&d=identicon&r=PG&f=1", "display_name": "Menachem", "link": "https://stackoverflow.com/users/5091964/menachem"}, "edited": false, "score": 0, "creation_date": 1449706513, "post_id": 34190667, "comment_id": 56129362, "body": "Note that I nee to search and replac ea string on each message that I send."}, {"owner": {"reputation": 203, "user_id": 5091964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1a1b03d8d2d49553eb7f7cc4a8b63536?s=128&d=identicon&r=PG&f=1", "display_name": "Menachem", "link": "https://stackoverflow.com/users/5091964/menachem"}, "edited": false, "score": 0, "creation_date": 1449709299, "post_id": 34190667, "comment_id": 56130244, "body": "Niton, my previous email was meant primeraly for you.   Regarding Dmitry&#39;s comment: I noticed and tested that the MAPIFolder.Items.Item(Items.Count) is always based on the save date. The oldest one index is 1. The maximum cound index is allways the last one."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 203, "user_id": 5091964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1a1b03d8d2d49553eb7f7cc4a8b63536?s=128&d=identicon&r=PG&f=1", "display_name": "Menachem", "link": "https://stackoverflow.com/users/5091964/menachem"}, "edited": false, "score": 0, "creation_date": 1449714008, "post_id": 34190667, "comment_id": 56131548, "body": "@Menachem The index was opposite to yours, on my installation."}, {"owner": {"reputation": 203, "user_id": 5091964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1a1b03d8d2d49553eb7f7cc4a8b63536?s=128&d=identicon&r=PG&f=1", "display_name": "Menachem", "link": "https://stackoverflow.com/users/5091964/menachem"}, "edited": false, "score": 0, "creation_date": 1449717754, "post_id": 34190667, "comment_id": 56132453, "body": "Niton, the use of the ItemAdd event solved my problem. Thanks a lot!  Because I have several thousand emails in my Sent Items folder, I cannot sort. Any advice how to find the latest sent email?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 203, "user_id": 5091964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1a1b03d8d2d49553eb7f7cc4a8b63536?s=128&d=identicon&r=PG&f=1", "display_name": "Menachem", "link": "https://stackoverflow.com/users/5091964/menachem"}, "edited": false, "score": 0, "creation_date": 1449720441, "post_id": 34190667, "comment_id": 56133125, "body": "@Menachem first try searching <a href=\"http://stackoverflow.com/help/searching\">stackoverflow.com/help/searching</a> if not successful ask a new question."}, {"owner": {"reputation": 203, "user_id": 5091964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1a1b03d8d2d49553eb7f7cc4a8b63536?s=128&d=identicon&r=PG&f=1", "display_name": "Menachem", "link": "https://stackoverflow.com/users/5091964/menachem"}, "edited": false, "score": 0, "creation_date": 1450209230, "post_id": 34190667, "comment_id": 56338117, "body": "Dmitry is correct regarding the Item(Items.Count) order. Therefore I sorted the messages on date and made it work. I posted the final code. Thank you all for your help."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 2, "last_activity_date": 1449713607, "last_edit_date": 1495542804, "creation_date": 1449702107, "answer_id": 34190667, "question_id": 34190000, "link": "https://stackoverflow.com/questions/34190000/replace-a-string-in-a-sent-email/34190667#34190667", "title": "Replace a string in a sent email", "body": "<p>The delaying actions you take are enough for the send to complete. Without the delay the message is not yet in the Sent items folder.</p>\n\n<p>You could instead use ItemAdd with appropriate conditions in the code so it processes applicable messages.</p>\n\n<p>This will process the item most recently added to the Sent Items folder.</p>\n\n<p>Code for ThisOutlookSession</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents sItems As Items \n\nPrivate Sub Application_Startup() \n    Dim objNS As NameSpace \n    Set objNS = GetNamespace(\"MAPI\") \n    ' default local Sent Items folder\n    Set sItems = objNS.GetDefaultFolder(olFolderSentMail).Items \nEnd Sub\n\nPrivate Sub sItems_ItemAdd(ByVal item As Object) \n\n    If TypeName(item) = \"MailItem\" Then          \n          ' ******************\n          ' do something here with item\n          ' ******************\n           Debug.Print item.subject\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Source in case this untested code has typos.  <a href=\"https://stackoverflow.com/questions/11263483/how-do-i-trigger-a-macro-to-run-after-a-new-mail-is-received-in-outlook\">How do I trigger a macro to run after a new mail is received in Outlook?</a></p>\n"}, {"tags": [], "owner": {"reputation": 203, "user_id": 5091964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1a1b03d8d2d49553eb7f7cc4a8b63536?s=128&d=identicon&r=PG&f=1", "display_name": "Menachem", "link": "https://stackoverflow.com/users/5091964/menachem"}, "is_accepted": false, "score": 0, "last_activity_date": 1450209488, "creation_date": 1450209488, "answer_id": 34298277, "question_id": 34190000, "link": "https://stackoverflow.com/questions/34190000/replace-a-string-in-a-sent-email/34298277#34298277", "title": "Replace a string in a sent email", "body": "<p>Following the comments that I received I am posting the final code that I tested and works. It replaces a string in the last sent message (after being sent and saved).</p>\n\n<pre><code>Sub Replace_LSM_String()\n\nSet Folder = Application.Session.GetDefaultFolder(olFolderSentMail)\nSet Items = Folder.Items\nItems.sort \"[ReceivedTime]\", False\nSet oldestMessage = Items.GetLast\noldestMessage.HTMLBody = Replace(Items.GetLast.HTMLBody, \"old string\",_ \n\"new   string\")\nItems.GetLast.Save\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 5091964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1a1b03d8d2d49553eb7f7cc4a8b63536?s=128&d=identicon&r=PG&f=1", "display_name": "Menachem", "link": "https://stackoverflow.com/users/5091964/menachem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1592896545, "creation_date": 1449699236, "last_edit_date": 1592896545, "question_id": 34190000, "link": "https://stackoverflow.com/questions/34190000/replace-a-string-in-a-sent-email", "title": "Replace a string in a sent email", "body": "<p>The following code creates and sends a simple email. After the email is sent it replaces a string in the email body. </p>\n\n<p>My code works when I use the debugger\u2019s single-step feature to execute the code. It also works when I add a MsgBox instruction with a \u201cclick to continue\u201d button after the <code>objMsg.Send</code> instruction. It does not work when I execute the macro without interruption, but tells me that Outlook cannot save an email to the folder when a macro is running.</p>\n\n<pre><code>Sub CreateNewMessage()\n\n     objMsg As MailItem\n\n    Set objMsg = Application.CreateItem(olMailItem)\n\n     With objMsg\n      .To = \"mblasberg@inoxel.com\"\n      .subject = \"This is the subject\"\n      .BodyFormat = olFormatHTML\n      .Body = \"How are you doing?\"\n    End With\n    objMsg.Send\n\n  ' The following code replaces in the email body the string \"you\" with \"they\"\n\n  ' Because I could not find how to open the \"last sent\" email,\n  ' I used the \"Sent Items\" folder email count as as the pointer\n  ' to the last email.\n\n    Dim myNameSpace As Outlook.NameSpace\n    Dim myFolder As Outlook.Folder\n    Dim myItem As Object\n\n    Set myNameSpace = Application.GetNamespace(\"MAPI\")\n    Set myFolder = _\n        myNameSpace.GetDefaultFolder(olFolderSentMail)\n\n    Dim EmailCount As Integer\n\n    EmailCount = myFolder.Items.Count\n    Set myItem = myFolder.Items(EmailCount)\n    myItem.HTMLBody = replace(myItem.HTMLBody, \"you\", \"they\")\n    myItem.Save\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "call"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449699535, "post_id": 34189998, "comment_id": 56126530, "body": "<code>sheet named &quot;Summary_logic&quot; which opens a list of folders</code> Sheets cannot open folders and even if they can, don&#39;t see your code that accomplishes said act. In short, don&#39;t understand your question/problem."}], "answers": [{"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 1, "last_activity_date": 1449719737, "creation_date": 1449719737, "answer_id": 34193419, "question_id": 34189998, "link": "https://stackoverflow.com/questions/34189998/how-to-call-a-vba-script-in-a-vba-script-which-is-situated-in-other-folder/34193419#34193419", "title": "How to call a VBA script in a VBA script which is situated in other folder", "body": "<p>Try this line :</p>\n\n<pre><code>Application.Run \"'\" &amp; MyFolder &amp; \"\\\" &amp; MyFile &amp; \"'!\" &amp; \"processR1\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5641495, "user_type": "registered", "profile_image": "https://graph.facebook.com/1029780147043512/picture?type=large", "display_name": "Jagadish Vakati", "link": "https://stackoverflow.com/users/5641495/jagadish-vakati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449746213, "creation_date": 1449699223, "last_edit_date": 1449746213, "question_id": 34189998, "link": "https://stackoverflow.com/questions/34189998/how-to-call-a-vba-script-in-a-vba-script-which-is-situated-in-other-folder", "title": "How to call a VBA script in a VBA script which is situated in other folder", "body": "<p>I have a excel sheet named \"Summary_logic\" which opens a list of folders and each folder has a excel sheet with the VBA script in it. I want to call the VBA scripts (processR1) in each folder and copy the result into the Summary_logic sheet.</p>\n\n<pre><code>'My code is given below.\n\nPrivate Const test_pvt_1_name As String = \"TestPVT_Result_template\"\nPrivate Const pvt_1_range As String = \"G7:V1000\"\nPrivate Const pvt_1_range_testname As String = \"C7:C1000\" \n\nSub CleanTable()\n    clear_summary\n    delete_auxiliary_sheets\n    Sheets(\"Summary_logic\").Select\nEnd Sub\n\n' Deletes all the values in the specified range\nPrivate Sub clear_summary()\n    Sheets(\"Summary_logic\").Select\n    'PVT_R01, Sensitivity Range:\n    Range(pvt_1_range).Select\n    Selection.ClearContents\n    Range(pvt_1_range_testname).Select\n    Selection.ClearContents\n    MsgBox (\"Clear_Summary Executed\")\nEnd Sub\n\n' Delete all sheets except \"Summary\"\nPrivate Sub delete_auxiliary_sheets()\n\n   For Each wsht In Worksheets\n        If wsht.Name &lt;&gt; \"Summary_logic\" Then\n            Application.DisplayAlerts = False\n            Sheets(wsht.Name).Delete\n            Application.DisplayAlerts = True\n        End If\n   Next\n   MsgBox (\"delete_auxiliary_sheets Executed\")\nEnd Sub\n\n\nPrivate Sub open_files()\nDim MyFolder As String\nDim MyFile As String: MyFile = \"TestPVT_Result_template\" &amp; \".xlsm\"\nDim i As Integer\ni = 1\nMsgBox (\" Don't forget to enter the path of the PVT folders here\")\nMyFolder = \"C:\\Users\\venkatav\\Desktop\\vba practice\\new code\\PVT_2015_10_20\"     &amp; Application.PathSeparator &amp; Sheets(\"PVT_test_names1\").Range(\"A1\").Cells(i,     1).Value\nMsgBox (\" MyFolder is :\") &amp; MyFolder            'returns the folder name\nMyFile = Dir(MyFolder &amp; Application.PathSeparator &amp; MyFile)\nMsgBox (\" MyFile is :\") &amp; MyFile                'returns the     TESTPVT_R1_out.csv\n\n'Here I have to open the each .xlsm file and run the macro\nWorkbooks.Open Filename:=MyFolder &amp; \"\\\" &amp; MyFile\nMsgBox (\"Opened the first file in the first folder\")\n\n'Now have to call the macro\nMsgBox (\"Calling the macro\")\n\n 'Here I have to call the macro in other excel file.. need help here\n Call processR1\n\n'And then the results from the resultant process has to be copied to the summary_logic ranges\n\nEnd Sub\n\n'calls each macro from all the excel files and copies the data\n</code></pre>\n"}, {"tags": ["excel", "internet-explorer-11", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449698849, "post_id": 34189548, "comment_id": 56126175, "body": "try <code>IE.document.getElementById(&quot;ReportViewerControl_ctl04_ctl07&quot;&zwnj;&#8203;).Item(0) = 12345</code>"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1449699232, "post_id": 34189548, "comment_id": 56126379, "body": "<code>IE.document.getElementById(&quot;ReportViewerControl_ctl04_ctl07_&zwnj;&#8203;txtValue&quot;).value = &quot;12345&quot;</code>"}, {"owner": {"reputation": 63, "user_id": 5024211, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/O6i3Q.png?s=128&g=1", "display_name": "Developer_World", "link": "https://stackoverflow.com/users/5024211/developer-world"}, "edited": false, "score": 0, "creation_date": 1449756323, "post_id": 34189548, "comment_id": 56152219, "body": "I have another input box for date but the same thing I m using for date box. Its showing error &quot;Object doesnot support this property or method&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 5024211, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/O6i3Q.png?s=128&g=1", "display_name": "Developer_World", "link": "https://stackoverflow.com/users/5024211/developer-world"}, "is_accepted": false, "score": 0, "last_activity_date": 1472394585, "creation_date": 1472394585, "answer_id": 39192319, "question_id": 34189548, "link": "https://stackoverflow.com/questions/34189548/working-on-internet-explorer-form-in-vba/39192319#39192319", "title": "Working on Internet explorer form in vba", "body": "<pre><code>IE.Document.getElementById(\"ctl32_ctl04_ctl03_txtValue\").value = SDate\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5024211, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/O6i3Q.png?s=128&g=1", "display_name": "Developer_World", "link": "https://stackoverflow.com/users/5024211/developer-world"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 551, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472394585, "creation_date": 1449697376, "last_edit_date": 1531164843, "question_id": 34189548, "link": "https://stackoverflow.com/questions/34189548/working-on-internet-explorer-form-in-vba", "title": "Working on Internet explorer form in vba", "body": "<pre><code> &lt;/tr&gt;&lt;tr IsParameterRow=\"true\"&gt;\n&lt;td class=\"ParamLabelCell\"&gt;&lt;label for=\"ReportViewerControl_ctl04_ctl07_txtValue\"&gt;&lt;span&gt;Enter Number&lt;/span&gt;&lt;/label&gt;&lt;/td&gt;&lt;td class=\"ParamEntryCell\" style=\"padding-right:0px;\"&gt;&lt;div id=\"ReportViewerControl_ctl04_ctl07\"&gt;\n                                    &lt;input name=\"ReportViewerControl$ctl04$ctl07$txtValue\" type=\"text\" size=\"30\" id=\"ReportViewerControl_ctl04_ctl07_txtValue\" disabled=\"disabled\" class=\"DisabledTextBox\" /&gt;\n                                &lt;/div&gt;&lt;/td&gt;\n                            &lt;/tr&gt;\n</code></pre>\n\n<p>for the above HTML code I am unable to feed number in vba. please suggest.\nbelow is the VBA code for inputting data.</p>\n\n<pre><code>sub my()\nDim IE As Object\nDim objElement As Object\nDim objCollection As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.Navigate Link\nDo While IE.Busy\n    Application.Wait DateAdd(\"s\", 1, Now)\nLoop\nIE.document.getElementsById(\"ReportViewerControl_ctl04_ctl07_txtValue\") = 12345\nEnd Sub()\n\n\n\n\n&lt;td class=\"ParamLabelCell\"&gt;&lt;label for=\"ReportViewerControl_ctl04_ctl03_txtValue\"&gt;&lt;span&gt;Enter Start Date Here&lt;/span&gt;&lt;/label&gt;&lt;/td&gt;&lt;td class=\"ParamEntryCell\" style=\"padding-right:0px;\"&gt;&lt;div id=\"ReportViewerControl_ctl04_ctl03\"&gt;\n                                    &lt;div onactivate=\"event.cancelBubble=true;\" style=\"white-space:nowrap;\"&gt;\n                                        &lt;input name=\"ReportViewerControl$ctl04$ctl03$txtValue\" type=\"text\" value=\"11/29/2015\" size=\"28\" onchange=\"javascript:setTimeout('__doPostBack(\\'ReportViewerControl$ctl04$ctl03$txtValue\\',\\'\\')', 0)\" onkeypress=\"if (WebForm_TextBoxKeyHandler(event) == false) return false;\" id=\"ReportViewerControl_ctl04_ctl03_txtValue\" disabled=\"disabled\" class=\"DisabledTextBox\" /&gt;&amp;nbsp;&lt;input src=\"/ReportServer/Reserved.ReportViewerWebControl.axd?OpType=Resource&amp;Version=11.0.5058.0&amp;Name=Microsoft.Reporting.WebForms.calendar_disabled.gif\" name=\"ReportViewerControl$ctl04$ctl03$ddDropDownButton\" type=\"image\" id=\"ReportViewerControl_ctl04_ctl03_ddDropDownButton\" alt=\"Select a value\" title=\"Select a value\" style=\"cursor:pointer;\" disabled=\"disabled\" /&gt;\n                                    &lt;/div&gt;\n                                &lt;/div&gt;&lt;/td&gt;\n</code></pre>\n\n<p>I have another input box for date but the same thing I m using for date box. Its showing error \"Object doesnot support this property or method </p>\n\n<pre><code> IE.document.getElementById(\"ReportViewerControl_ctl04_ctl03\").Value = sdate\n</code></pre>\n\n<p>where sdate contain current date</p>\n"}, {"tags": ["forms", "excel", "loops", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1449696591, "post_id": 34189265, "comment_id": 56125003, "body": "Something like <a href=\"http://stackoverflow.com/questions/19624728/looping-through-specific-combo-boxes-array\">this</a>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1449696848, "post_id": 34189265, "comment_id": 56125148, "body": "Or <a href=\"http://stackoverflow.com/questions/3916857/access-vba-how-would-i-have-a-loop-in-vba-that-allows-me-to-loop-through-contr\">this</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1449703780, "post_id": 34190280, "comment_id": 56128359, "body": "Thank you, thankfully I had already named my controls in the fashion you mentioned., I had tried something similar but basically without the Me.Controls but that obviously didn&#39;t work."}], "tags": [], "owner": {"reputation": 414, "user_id": 5626367, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4a34e7e37e04e2cfc0322bc5225a5a76?s=128&d=identicon&r=PG&f=1", "display_name": "E. Monk", "link": "https://stackoverflow.com/users/5626367/e-monk"}, "is_accepted": true, "score": 2, "last_activity_date": 1449700622, "last_edit_date": 1449700622, "creation_date": 1449700348, "answer_id": 34190280, "question_id": 34189265, "link": "https://stackoverflow.com/questions/34189265/vb-is-it-possible-to-use-a-loop-to-control-multiple-form-controls/34190280#34190280", "title": "VB Is it possible to use a loop to control multiple form controls?", "body": "<p>Yes it is.</p>\n\n<p>Make sure each combobox is named the same, but with a corresponding integer at the end of each.  For example, the comboboxes should be named ComboBox1, ComboBox2, ComboBox3, ComboBox4, ComboBox5, and ComboBox6.</p>\n\n<pre><code>Private Sub Form_Initialize()\n    Dim Table As ListObject\n    Set Table = ThisWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\")\n    Dim Rows As Integer\n    Rows = Table.ListRows.Count\n    Dim i As Integer\n    Dim j As Integer\n\n    For j = 1 To 6\n        With Me.Controls(\"ComboBox\" &amp; j)\n            .Clear\n            .Value = Empty\n            For i = 1 To Rows\n                .AddItem Table.DataBodyRange(i, 1)\n            Next i\n        End With\n    Next j\n\nEnd Sub\n</code></pre>\n\n<p>This should work everytime and is very useful when creating userforms etc..</p>\n"}], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 34190280, "answer_count": 1, "score": 1, "last_activity_date": 1449700622, "creation_date": 1449696197, "last_edit_date": 1531161705, "question_id": 34189265, "link": "https://stackoverflow.com/questions/34189265/vb-is-it-possible-to-use-a-loop-to-control-multiple-form-controls", "title": "VB Is it possible to use a loop to control multiple form controls?", "body": "<p>I'm working in Excel 2010 and it's VB editor. I have a form with 6 comboboxes and when I initialize the form the same thing needs to happen for all 6 comboboxes. Currently I have to write the same lines of code for the various comboboxes as demonstrated below.</p>\n\n<pre><code>Private Sub Form_Initialize()\n    Dim Table As ListObject\n    Set Table = ThisWorkBook.Worksheets(\"Sheet1\").ListObjects(\"Table1\")\n    Dim Rows As Integer\n    Rows = Table.ListRows.Count\n    Dim i As Integer\n\n    With Me.ComboBox_1\n        .Clear\n        .Value = Empty\n        For i = 1 to Rows\n            .AddItem Table.DataBodyRange(i, 1)\n        Next i\n    End With\n\n    With Me.ComboBox_2\n        .Clear\n        .Value = Empty\n        for i = 1 to Rows\n            .AddItem Table.DataBodyRange(i, 1)\n        Next i\n     End With\n\n    'This repeats for another 4 comboboxes (ComboBox_3, ComboBox_4,\n    'ComboBox_5 and ComboBox_6)\n\n End Sub\n</code></pre>\n\n<p>It becomes very annoying to write the same code over and over again and becomes especially annoying when I want to alter the procedure for the comboboxes and have to update 5 others also.</p>\n\n<p>Is it possible to write a single code that loops for each combobox?</p>\n"}, {"tags": ["vb.net", "excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449699681, "post_id": 34189231, "comment_id": 56126590, "body": "<code>i have 1000 of students, so i want to create as many worksheets by the code as there are students</code> Pretty sure you can&#39;t have 1000 sheets XD"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1449702953, "post_id": 34189231, "comment_id": 56128063, "body": "@pnuts I guess if each sheet only holds &lt;10 bytes. I am on i7 with 16GB of ram and 30 sheets crawl my box down already XD"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1449704487, "post_id": 34189231, "comment_id": 56128628, "body": "why don&#39;t you just keep it on one sheet and filter the pivot table as required?"}, {"owner": {"reputation": 25, "user_id": 5319123, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d69e36ca506f3c30ae9531417df12630?s=128&d=identicon&r=PG&f=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/5319123/rocky"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1449756258, "post_id": 34189231, "comment_id": 56152182, "body": "@pnuts: what does it mean by limited by available memory (default) is one sheet? Does it mean, i can&#39;t create more than one sheet?"}, {"owner": {"reputation": 25, "user_id": 5319123, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d69e36ca506f3c30ae9531417df12630?s=128&d=identicon&r=PG&f=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/5319123/rocky"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1449756341, "post_id": 34189231, "comment_id": 56152239, "body": "@teylyn: You mean filter the Pivot tables based on students and sending an email to that student with data relevant to him? If yes, that&#39;s would be the best possible approach. how can i do that?"}, {"owner": {"reputation": 25, "user_id": 5319123, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d69e36ca506f3c30ae9531417df12630?s=128&d=identicon&r=PG&f=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/5319123/rocky"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1449758417, "post_id": 34189231, "comment_id": 56153790, "body": "@pnuts: so to create 1000 worksheets.. what should be the available memory?"}, {"owner": {"reputation": 25, "user_id": 5319123, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d69e36ca506f3c30ae9531417df12630?s=128&d=identicon&r=PG&f=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/5319123/rocky"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1449759668, "post_id": 34189231, "comment_id": 56154641, "body": "@pnuts: Around 1K-3K lines per student... but that can be minimized too..and around 10-15 columns"}, {"owner": {"reputation": 25, "user_id": 5319123, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d69e36ca506f3c30ae9531417df12630?s=128&d=identicon&r=PG&f=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/5319123/rocky"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1449760529, "post_id": 34189231, "comment_id": 56155248, "body": "@pnuts: what is the solution for that then? i can minimize the number of rows per student.or divide the students in multiple excel like 200 per excel? What change in the code should i make so that it create worksheets on its own with the available student name?"}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1449786687, "creation_date": 1449786687, "answer_id": 34212936, "question_id": 34189231, "link": "https://stackoverflow.com/questions/34189231/how-can-pivot-table-raw-data-be-divided-into-multiple-worksheets/34212936#34212936", "title": "How can pivot table/Raw data be divided into multiple worksheets", "body": "<p>Creating thousands of worksheets in order to email a subset of data to specific people would be an awful approach. Instead, use a Pivot Table to filter the data, then email the filtered data set.</p>\n\n<p>If you filter the pivot table by person, use VBA to loop through the list of people copy the pivot table to an email, send and loop. Depending on your data you may not even need a pivot table, just a report sheet where the content gets looked up based on the student name.</p>\n\n<p>I'm not going to write that code for you, though. You can find resources on pivot table specific VBA the web and any flavor of emailing content from Excel on <a href=\"http://www.rondebruin.nl/win/s1/outlook/mail.htm\" rel=\"nofollow\">Ron de Bruin's site.</a> </p>\n"}], "owner": {"reputation": 25, "user_id": 5319123, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d69e36ca506f3c30ae9531417df12630?s=128&d=identicon&r=PG&f=1", "display_name": "Rocky", "link": "https://stackoverflow.com/users/5319123/rocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449786687, "creation_date": 1449696078, "last_edit_date": 1531161705, "question_id": 34189231, "link": "https://stackoverflow.com/questions/34189231/how-can-pivot-table-raw-data-be-divided-into-multiple-worksheets", "title": "How can pivot table/Raw data be divided into multiple worksheets", "body": "<p>I need to divide the PT/Raw (In Millions) data into multiple worksheets (based on employees-Approx 1000). I  used the attached code and sample file for that macro which goes per my requirement. However, existing code doesn't create worksheets on it own, however i have 1000 of students, so i want to create as many worksheets by the code as there are students. As i am new to VB so really not sure which part to change. I got the code online to create worksheets, however not sure how to insert it in original file. Any help would be helpful. Below is the code to divide the raw data into already existing multiple worksheet:</p>\n\n<hr>\n\n<pre><code>Sub copyPasteData()\n\nDim strSourceSheet As String\nDim strDestinationSheet As String\nDim lastRow As Long\n\nstrSourceSheet = \"Data entry\"\n\nSheets(strSourceSheet).Visible = True\nSheets(strSourceSheet).Select\n\nRange(\"C2\").Select\nDo While ActiveCell.Value &lt;&gt; \"\"\n    strDestinationSheet = ActiveCell.Value\n    ActiveCell.Offset(0, -2).Resize(1, ActiveCell.CurrentRegion.Columns.Count).Select\n    Selection.Copy\n    Sheets(strDestinationSheet).Visible = True\n    Sheets(strDestinationSheet).Select\n    lastRow = LastRowInOneColumn(\"A\")\n    Cells(lastRow + 1, 1).Select\n    Selection.PasteSpecial xlPasteValues\n    Application.CutCopyMode = False\n    Sheets(strSourceSheet).Select\n    ActiveCell.Offset(0, 2).Select\n    ActiveCell.Offset(1, 0).Select\nLoop\nEnd Sub\n\n\nPublic Function LastRowInOneColumn(col)\n\nDim lastRow As Long\nWith ActiveSheet\nlastRow = .Cells(.Rows.Count, col).End(xlUp).Row\nEnd With\nLastRowInOneColumn = lastRow\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>below is the code to create multiple worksheets</p>\n\n<hr>\n\n<pre><code>Sub AddSheets()\n\n\nDim cell As Excel.Range\nDim wsWithSheetNames As Excel.Worksheet\nDim wbToAddSheetsTo As Excel.Workbook\n\nSet wsWithSheetNames = ActiveSheet\nSet wbToAddSheetsTo = ActiveWorkbook\n For Each cell In wsWithSheetNames.Range(\"A2:A5\")\n    With wbToAddSheetsTo\n      .Sheets.Add after:=.Sheets(.Sheets.Count)\n    On Error Resume Next\n    ActiveSheet.Name = cell.Value\n    If Err.Number = 1004 Then\n      Debug.Print cell.Value &amp; \" already used as a sheet name\"\n    End If\n    On Error GoTo 0\n  End With\n  Next cell\nEnd Sub\n</code></pre>\n\n<hr>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 2, "creation_date": 1449692852, "post_id": 34188316, "comment_id": 56123012, "body": "So what is not happening, you told us what you are trying to do but not what is actually happening and what the issue you are having is."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1449692957, "post_id": 34188316, "comment_id": 56123067, "body": "You&#39;re certainly getting the &quot;Object Required&quot; error. <code>sListBox</code> is a String, not an object.   Is this ListBox on a UserForm, or is it on the worksheet?"}, {"owner": {"reputation": 1, "user_id": 5660990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6ed67ade8ed25671ec3940c5e45218?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Harris", "link": "https://stackoverflow.com/users/5660990/andy-harris"}, "edited": false, "score": 0, "creation_date": 1449693507, "post_id": 34188316, "comment_id": 56123365, "body": "I get a msgbox that states invalid qualifier.  when i debug it highlights the first sListBox."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1449693591, "post_id": 34188316, "comment_id": 56123421, "body": "Yes, because a string doesn&#39;t have any properties or methods like <code>.List</code>.  You can do <code>Me.Controls(sListBox</code>).AddItem...`  if this code is called in the UserForm&#39;s module, etc., but I have better solution."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1449693707, "post_id": 34188316, "comment_id": 56123495, "body": "<code>Item</code> is also an undeclared variable, possibly a typo that should be <code>sItem</code>.  Using <code>Option Explicit</code> will help you avoid these errors in the future."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1449693742, "post_id": 34188316, "comment_id": 56123515, "body": "Now I am waiting for you to provide more detaila bout what you <i>expect</i> to happen. If possible, provide examples of the input, and the expected output. Do <b>not</b> put this in the comments, please revise your original question with the additional informations."}, {"owner": {"reputation": 1, "user_id": 5660990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6ed67ade8ed25671ec3940c5e45218?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Harris", "link": "https://stackoverflow.com/users/5660990/andy-harris"}, "edited": false, "score": 0, "creation_date": 1449694258, "post_id": 34188316, "comment_id": 56123778, "body": "Yes, Item was a typo.  Me.Controls() did exactly what i wanted it to."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5660990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6ed67ade8ed25671ec3940c5e45218?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Harris", "link": "https://stackoverflow.com/users/5660990/andy-harris"}, "edited": false, "score": 0, "creation_date": 1449849825, "post_id": 34188819, "comment_id": 56199191, "body": "I have not been able to get back to this project this week.  I&#39;ll look this code over some more next week and try to implement it.  I am a complete noob to VB and Structured text in general so I may have some questions pertaining to the changes you made, but I certainly appreciate your time."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1449694614, "creation_date": 1449694614, "answer_id": 34188819, "question_id": 34188316, "link": "https://stackoverflow.com/questions/34188316/vba-use-variable-in-place-of-property/34188819#34188819", "title": "VBA use variable in place of property", "body": "<p>This should take care of it, and has cleaned up the code. Instead of using clumsy <code>Do</code> loop until value is null string, just define a range object and then iterate over the range object's Cells.  Using a more object-oriented approach also means we can get rid of the unnecessary variables like <code>x</code>, <code>row_index</code> and <code>list_index</code>:</p>\n\n<p>Put this all in the UserForm's module:</p>\n\n<pre><code>Option Explicit\nPrivate Sub UserForm_Initialize()\n\n    'Example of populating this during the form's initialize event\n    Call RefreshItemList(\"Sheet3\", \"1\", \"ListBox1\")\n\nEnd Sub\n\nSub RefreshItemList(sSheet As String, sItem As String, sListBox As String)\nDim ws As Worksheet\nDim rng As Range    'Source range for the listbox control\nDim r As Range      'use thisto iterate over the \"rng\" Range\nDim lstBox As MSForms.ListBox\n\n'Assign your worksheet\nSet ws = ThisWorkbook.Sheets(sSheet)\n'Assign your range, modify as needed\nSet rng = ws.Range(\"A2\", ws.Range(\"A1\").End(xlDown))\n\n'Exit sub if the first value is empty\nIf rng.Cells(1).Value = \"\" Then Exit Sub\n\n'Get a handle on your ListBox control\nSet lstBox = Me.Controls(sListBox)\n\nWith lstBox\n    .Clear\n    .ColumnCount = 5  'Ensure enough columns exist in the listbox\n    .ColumnWidths = \"20;20;20;20;20\"  'Or, you can do this in the Designer. Modify as needed.\n    For Each r In rng.Cells\n        If r.Value2 = sItem Then\n           .AddItem r(1, 1).Value                    'Column A\n           .List(.ListCount - 1, 1) = r(1, 3).Value  'Column C\n           .List(.ListCount - 1, 2) = r(1, 4).Value  'Column D\n           .List(.ListCount - 1, 3) = r(1, 5).Value  'Column E\n           '.List(.ListCount - 1, 4) = r(1, 2).Value 'Column B  -- I used this for testing only\n           .List(.ListCount - 1, 4) = r(1, 12).Value 'Column N\n        End If\n    Next\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5660990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6ed67ade8ed25671ec3940c5e45218?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Harris", "link": "https://stackoverflow.com/users/5660990/andy-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1449694614, "creation_date": 1449692761, "last_edit_date": 1531164843, "question_id": 34188316, "link": "https://stackoverflow.com/questions/34188316/vba-use-variable-in-place-of-property", "title": "VBA use variable in place of property", "body": "<p>I am trying to create a Sub to populate a ListBox based upon the veriable handed into the sub when it's called upon. something like this:</p>\n\n<pre><code>Sub RefreshItemList(sSheet As String, sItem As String, sListBox As String)\n Dim ws As Worksheet\n   Set ws = ThisWorkbook.Sheets(sSheet)\n Dim x As String\n   x = \"a\"\n Dim Row_Index As Long\n   Row_Index = 1\n Dim List_Index As Integer\n   List_Index = 0\n\n   sListBox.Clear\n\n   Do Until x = \"\"\n      x = ws.Cells(Row_Index, 2).Value2\n      If x = Item Then\n         sListBox.AddItem (ws.Range(\"A\" &amp; Row_Index))\n         sListBox.List(List_Index, 1) = ws.Range(\"C\" &amp; Row_Index)\n         sListBox.List(List_Index, 2) = ws.Range(\"D\" &amp; Row_Index)\n         sListBox.List(List_Index, 3) = ws.Range(\"E\" &amp; Row_Index)\n         sListBox.List(List_Index, 4) = Round(ws.Range(\"N\" &amp; Row_Index), 3)\n\n         List_Index = List_Index + 1\n\n      End If\n\n     Row_Index = Row_Index + 1\n   Loop \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449691280, "post_id": 34187908, "comment_id": 56122098, "body": "Probably because a selection can&#39;t add a table?"}, {"owner": {"reputation": 65, "user_id": 4914518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b00d00c25b4735b83c521e81c8975f90?s=128&d=identicon&r=PG&f=1", "display_name": "OrionEllis", "link": "https://stackoverflow.com/users/4914518/orionellis"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449692164, "post_id": 34187908, "comment_id": 56122604, "body": "yeah, that didn&#39;t help."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449692210, "post_id": 34187908, "comment_id": 56122625, "body": "What did you try in place of select? Edit: you have been here long enough to know SO isn&#39;t a code service."}, {"owner": {"reputation": 65, "user_id": 4914518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b00d00c25b4735b83c521e81c8975f90?s=128&d=identicon&r=PG&f=1", "display_name": "OrionEllis", "link": "https://stackoverflow.com/users/4914518/orionellis"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449692558, "post_id": 34187908, "comment_id": 56122831, "body": "I tried recording a macro to get code and plug it in:"}, {"owner": {"reputation": 65, "user_id": 4914518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b00d00c25b4735b83c521e81c8975f90?s=128&d=identicon&r=PG&f=1", "display_name": "OrionEllis", "link": "https://stackoverflow.com/users/4914518/orionellis"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449692702, "post_id": 34187908, "comment_id": 56122924, "body": "ActiveDocument.Tables.Add Range:=Selection.Range, NumRows:=1, NumColumns:= _                 1, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:= _                 wdAutoFitFixed             With Selection.Tables(1)                 If .Style &lt;&gt; &quot;Table Grid&quot; Then                     .Style = &quot;Table Grid&quot;                 End If Did not work"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449692716, "post_id": 34187908, "comment_id": 56122932, "body": "Sigh. That&#39;s the downside of recording macros. Users rarely go back to study what it means. One learns far better by writing code from scratch XD Well, macros can&#39;t record a <code>for loop</code>. So you do know something. Please look into what <code>with</code> statements do."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449692753, "post_id": 34187908, "comment_id": 56122956, "body": "Please add code to OP not comments. Make it readable."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449693126, "post_id": 34187908, "comment_id": 56123164, "body": "Don&#39;t see where you added the new lines XD Are you doing it within or outside the loop?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449693567, "post_id": 34187908, "comment_id": 56123404, "body": "I can&#39;t even decipher what&#39;s selected XD Also, did you increment your loop? Guess 1 to 2 needs no increment?"}, {"owner": {"reputation": 65, "user_id": 4914518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b00d00c25b4735b83c521e81c8975f90?s=128&d=identicon&r=PG&f=1", "display_name": "OrionEllis", "link": "https://stackoverflow.com/users/4914518/orionellis"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449694377, "post_id": 34187908, "comment_id": 56123855, "body": "The loop goes from 1 to 2 so that I don&#39;t print 351 lines in the word doc - only two. I tried to add the activedocument code above just outside the .selection &quot;end with&quot; in the loop to no avail."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449694857, "post_id": 34187908, "comment_id": 56124092, "body": "I am not as familiar with word so I don&#39;t know what methods and properties it holds. Where you&#39;re putting it means it&#39;s qualified to <code>.Documents.Add</code> (a new word doc) if I follow correctly which one would think would hold a method for adding a table but you might want to doublecheck. It&#39;s still unclear to me what the selection inside the loop pertains to :/ I don&#39;t think it&#39;s the excel book as you believe... Basically, qualify your objects."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449695191, "post_id": 34187908, "comment_id": 56124260, "body": "Duh. If you can record a macro that reads <code>ActiveDocument.Tables.Add </code> of course it holds that method XD <code>Range:=Selection</code> Might want to replace selection with something concrete."}, {"owner": {"reputation": 65, "user_id": 4914518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b00d00c25b4735b83c521e81c8975f90?s=128&d=identicon&r=PG&f=1", "display_name": "OrionEllis", "link": "https://stackoverflow.com/users/4914518/orionellis"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449695848, "post_id": 34187908, "comment_id": 56124565, "body": "Thank you for all of your help.  I will look into this and post the solution once I have determined what that is."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449695994, "post_id": 34187908, "comment_id": 56124646, "body": "Sure. Seems JDB clarified most of my comments. Not sure if I agree with the select given that that defeats the purpose of setting objects but you might find it useful."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 4914518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b00d00c25b4735b83c521e81c8975f90?s=128&d=identicon&r=PG&f=1", "display_name": "OrionEllis", "link": "https://stackoverflow.com/users/4914518/orionellis"}, "edited": false, "score": 0, "creation_date": 1449696839, "post_id": 34189120, "comment_id": 56125140, "body": "Works perfectly. You made my day. Thank you for the VERY clear explanation. Especially &quot;Tables is a member of Document&quot; <code>Dim wdDoc As Word.Document Set wdDoc = wdApp.ActiveDocument</code>"}], "tags": [], "owner": {"reputation": 162, "user_id": 5652036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7f87fd1350795a2eace0da0bef35b7?s=128&d=identicon&r=PG&f=1", "display_name": "JDB_Dragon", "link": "https://stackoverflow.com/users/5652036/jdb-dragon"}, "is_accepted": true, "score": 3, "last_activity_date": 1449697503, "last_edit_date": 1449697503, "creation_date": 1449695721, "answer_id": 34189120, "question_id": 34187908, "link": "https://stackoverflow.com/questions/34187908/how-can-i-add-a-table-in-each-iteration-of-my-loop/34189120#34189120", "title": "How can I add a table in each iteration of my loop?", "body": "<p>You are getting object errors due to the fact that Selection does not have a method .Table\nTo get around this, you'll want to use the line:</p>\n\n<pre><code>Set newTable = wdApp.ActiveDocument.Tables.Add(SomeRange,1,1)\n</code></pre>\n\n<p>Tables is a member of Document, which you can retrieve using the section wdApp.ActiveDocument. \nHere, SomeRange needs to be defined for this to work properly.</p>\n\n<p>To try and get this code running, lets try and add a few variables to make this easier.\nBack where you declare your other variables add these:</p>\n\n<pre><code>Dim myRange As Word.Range\nDim wdDoc As Word.Document\nDim newTable As Word.Table\n</code></pre>\n\n<p>and before you enter your loop, AFTER you create the document add:</p>\n\n<pre><code>Set wdDoc = wdApp.ActiveDocument\n</code></pre>\n\n<p>Next, inside of your loop, but after your End With (.Selection) you could add:</p>\n\n<pre><code>Set myRange = wdDoc.Range(wdDoc.Content.End - 1, wdDoc.Content.End)\nSet newTable = wdDoc.Tables.Add(myRange, 1, 1)\nnewTable.Cell(1, 1).Range.Text = \"Hello\"\nSet myRange = wdDoc.Range(wdDoc.Content.End - 1, wdDoc.Content.End)\nmyRange.Select\n</code></pre>\n\n<p>Let's go through what this does.</p>\n\n<ul>\n<li>First, it sets out custom variable myRange to be the last character in the document. This allows us to place the Table underneath everything that's already been created,</li>\n<li>Next, it creates a table at this location, with the size 1x1.</li>\n<li>The value of the first cell in this table is set to \"Hello\"</li>\n<li>The next line then AGAIN sets the range to the bottom of the file, then selects it. This is neccessary because creating a table changes the selection to be inside of the new table. Skipping this line would have you then run the next iteration of the loop INSIDE of the table.</li>\n</ul>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 65, "user_id": 4914518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b00d00c25b4735b83c521e81c8975f90?s=128&d=identicon&r=PG&f=1", "display_name": "OrionEllis", "link": "https://stackoverflow.com/users/4914518/orionellis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 34189120, "answer_count": 1, "score": 1, "last_activity_date": 1449697503, "creation_date": 1449691151, "last_edit_date": 1449692770, "question_id": 34187908, "link": "https://stackoverflow.com/questions/34187908/how-can-i-add-a-table-in-each-iteration-of-my-loop", "title": "How can I add a table in each iteration of my loop?", "body": "<p>I am generating a word document from excel using VBA. I have a for loop that I would like to add a [1 row, 1 column, bordered] table to. This is an area where the user can put their comments inside a word document. When I try to add .table.add I have been getting different errors ranging from object errors. This is what I have so far:</p>\n\n<pre><code>Sub GenDocumentables()\n    Worksheets(\"checklist\").Activate\n    Dim wdApp As Word.Application\n    Set wdApp = New Word.Application\n    Dim saveName As String\n    Dim NumberOfCells As Integer\n    With wdApp\n        .Visible = True\n        .Activate\n        'Debug.Print .Version\n        .Documents.Add\n        With .Selection\n            .InsertBreak Type:=wdPageBreak\n            .ParagraphFormat.Alignment = wdAlignParagraphCenter\n            .BoldRun\n            .Font.Size = 13\n            .TypeText \"Documentable Items for \"\n            .TypeText Range(\"d4\").Value\n            .BoldRun\n            .TypeParagraph\n        End With\n        NumberOfCells = Range(\"a4\", Range(\"a3\").End(xlDown)).Count\n        For loopcounter = 1 To 2 ' NumberOfCells\n            With .Selection\n                .Font.Bold = False\n                .Style = wdStyleHeading3\n                .TypeText Range(\"a3\").Offset(loopcounter, 0).Value &amp; \" - \"\n                .TypeText Range(\"a3\").Offset(loopcounter, 4).Value\n                .TypeParagraph\n                .Font.Size = 10\n                .TypeText Range(\"a3\").Offset(loopcounter, 5).Value\n                .TypeParagraph\n                .Font.Italic = True\n                .TypeText \"&lt;&lt;Please enter your commentary here. Ensure all aspects of the check content are met&gt;&gt;\"\n                .TypeParagraph\n                '-------------------ADD TABLE HERE-------------------\n            End With\n        Next\n        Set myRange = ActiveDocument.Range(0, 0)\n        ActiveDocument.TablesOfContents.Add Range:=myRange, UseFields:=False, UseHeadingStyles:=True, LowerHeadingLevel:=3, UpperHeadingLevel:=1\n        With .Selection\n            .GoTo What:=wdGoToSection, Which:=wdGoToFirst\n            .InsertBreak Type:=wdPageBreak\n        End With\n        saveName = Environ(\"UserProfile\") &amp; \"\\Desktop\\My Word Doc_\" &amp; Format(Now, \"yyyy-mm-dd hh-mm-ss\") &amp; \".docx\"\n        .ActiveDocument.SaveAs2 saveName\n        '.ActiveDocument.Close\n        '.Quit\n    End With\n    MsgBox \"done!\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 3, "creation_date": 1449691250, "post_id": 34187768, "comment_id": 56122075, "body": "I assume when you delete it manually it deletes quickly and isn&#39;t causing excel to bog down doing a bunch of recalculations?"}, {"owner": {"reputation": 21, "user_id": 5660898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/251f4422b4f9c4a4f2a5bea50e5bfbcb?s=128&d=identicon&r=PG&f=1", "display_name": "HATZONICK", "link": "https://stackoverflow.com/users/5660898/hatzonick"}, "reply_to_user": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1449692066, "post_id": 34187768, "comment_id": 56122535, "body": "There are no calculations.  Actually when I try to delete directly in excel it takes a long time, too.  Maybe nothing I can do?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1449698501, "post_id": 34187768, "comment_id": 56125979, "body": "At least your <code>Workbooks(&quot;f.xlsx&quot;).Sheets(&quot;g&quot;).Columns(&quot;FD:FD&quot;).EntireColum&zwnj;&#8203;n.Delete</code> can be written as <code>Workbooks(&quot;f.xlsx&quot;).Sheets(&quot;g&quot;).Columns(160).Delete</code> and will do the same :P I don&#39;t know who started something useless like <code>Columns().EntireColumn</code> (every third post here shows obsolete coding like that)"}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "edited": false, "score": 0, "creation_date": 1449790957, "post_id": 34187768, "comment_id": 56172114, "body": "Did you try the answer I posted?"}], "answers": [{"comments": [{"owner": {"reputation": 2015, "user_id": 450750, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cbb8e820417cbdd69792b2e45c650285?s=128&d=identicon&r=PG", "display_name": "Baodad", "link": "https://stackoverflow.com/users/450750/baodad"}, "edited": false, "score": 0, "creation_date": 1449692157, "post_id": 34188140, "comment_id": 56122599, "body": "You need to clarify varCalcMode.  I assume that&#39;s a variable you use to store the calc mode before changing it, so you can change it back.  I believe you have the solution though: turning off auto calculation"}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "reply_to_user": {"reputation": 2015, "user_id": 450750, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cbb8e820417cbdd69792b2e45c650285?s=128&d=identicon&r=PG", "display_name": "Baodad", "link": "https://stackoverflow.com/users/450750/baodad"}, "edited": false, "score": 0, "creation_date": 1449692398, "post_id": 34188140, "comment_id": 56122748, "body": "Oops, yeah. edited it to have the right info. Application.Calculation = xlCalculationAutomatic"}], "tags": [], "owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "is_accepted": false, "score": 0, "last_activity_date": 1449692385, "last_edit_date": 1449692385, "creation_date": 1449692015, "answer_id": 34188140, "question_id": 34187768, "link": "https://stackoverflow.com/questions/34187768/deleting-column-using-vba-takes-a-huge-amount-of-time/34188140#34188140", "title": "Deleting column using vba takes a huge amount of time", "body": "<p>If it is slow manually also turn off calculation before running it, then turn it back on.</p>\n\n<pre><code>Sub Add_Delete()\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nWorkbooks(\"f.xlsx\").Sheets(\"g\").Columns(\"FD:FD\").EntireColumn.Delete\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>add screen updating back in also... ;-)</p>\n"}], "owner": {"reputation": 21, "user_id": 5660898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/251f4422b4f9c4a4f2a5bea50e5bfbcb?s=128&d=identicon&r=PG&f=1", "display_name": "HATZONICK", "link": "https://stackoverflow.com/users/5660898/hatzonick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 848, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1449692766, "creation_date": 1449690693, "last_edit_date": 1531161705, "question_id": 34187768, "link": "https://stackoverflow.com/questions/34187768/deleting-column-using-vba-takes-a-huge-amount-of-time", "title": "Deleting column using vba takes a huge amount of time", "body": "<p>Newbie here.</p>\n\n<p>I'm trying to delete a column using vba and it is taking a HUGE amount of time.  </p>\n\n<pre><code>Sub Add_Delete()\nApplication.ScreenUpdating = False\nWorkbooks(\"f.xlsx\").Sheets(\"g\").Columns(\"FD:FD\").EntireColumn.Delete\nEnd Sub\n</code></pre>\n\n<p>There are about 20,000 rows with a total of amount 230 columns. There are no calculations being performed. Just data</p>\n\n<p>What am I doing wrong?  Thanks in advance! </p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449691027, "post_id": 34187765, "comment_id": 56121927, "body": "Doesn&#39;t dictionary require two arguments (item and key)? Looks like you&#39;re only storing key?"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1449695784, "post_id": 34187765, "comment_id": 56124533, "body": "The syntax for a <code>Dictionary</code> isn&#39;t the same as for an <code>array</code> (which you have written). You add items to a Dictionary like so: <code>d.Add key, item</code> ( <a href=\"https://support.microsoft.com/en-us/kb/187234\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/187234</a>)."}, {"owner": {"reputation": 15, "user_id": 5651178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78016ddbbd761cbc6cf3998975df9a52?s=128&d=identicon&r=PG&f=1", "display_name": "ScoobyDoo2015", "link": "https://stackoverflow.com/users/5651178/scoobydoo2015"}, "edited": false, "score": 0, "creation_date": 1449696449, "post_id": 34187765, "comment_id": 56124910, "body": "I&#39;m trying to copy a sorted dictionary object to another dictionary object. How would you fix this line of code &#39;d(arrTemp(itX)) = dctList(arrTemp(itX))&#39;?"}, {"owner": {"reputation": 15, "user_id": 5651178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78016ddbbd761cbc6cf3998975df9a52?s=128&d=identicon&r=PG&f=1", "display_name": "ScoobyDoo2015", "link": "https://stackoverflow.com/users/5651178/scoobydoo2015"}, "edited": false, "score": 0, "creation_date": 1449701074, "post_id": 34187765, "comment_id": 56127257, "body": "I ended up using &#39;For Each key In dctList.Keys             d.Add key, dctList(key)         Next&#39; to copy the contents of one dictionary object to another. The keys are still not getting sorted. Any ideas?"}, {"owner": {"reputation": 15, "user_id": 5651178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78016ddbbd761cbc6cf3998975df9a52?s=128&d=identicon&r=PG&f=1", "display_name": "ScoobyDoo2015", "link": "https://stackoverflow.com/users/5651178/scoobydoo2015"}, "edited": false, "score": 0, "creation_date": 1449701153, "post_id": 34187765, "comment_id": 56127282, "body": "I updated my original code to reflect the changes that I made."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1449712219, "post_id": 34187765, "comment_id": 56131080, "body": "You&#39;ve bubble sorted an array of keys but your last loop is just duplicating the passed <code>dctList</code>. You need to loop through the sorted array: <code>For itx = 0 to Ubound(arrTemp)</code> and add each original <code>dctList</code> item by sorted array key: <code>d.Add arrTemp(itx), dctList(itx)</code>"}, {"owner": {"reputation": 15, "user_id": 5651178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78016ddbbd761cbc6cf3998975df9a52?s=128&d=identicon&r=PG&f=1", "display_name": "ScoobyDoo2015", "link": "https://stackoverflow.com/users/5651178/scoobydoo2015"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1449764097, "post_id": 34187765, "comment_id": 56157823, "body": "@Ambie I made the changes that you requested, but the function still does not sort. If you create a simple test case of string non-sorted keys, you&#39;ll see that not only does the function not sort, but it inserts an integer for each item in the key. I updated my original code with the changes you requested ."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1449777917, "post_id": 34187765, "comment_id": 56165572, "body": "Edit your question with 2 or 3 sanple values and I&#39;ll post an answer for you."}, {"owner": {"reputation": 15, "user_id": 5651178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78016ddbbd761cbc6cf3998975df9a52?s=128&d=identicon&r=PG&f=1", "display_name": "ScoobyDoo2015", "link": "https://stackoverflow.com/users/5651178/scoobydoo2015"}, "edited": false, "score": 0, "creation_date": 1449786286, "post_id": 34187765, "comment_id": 56170199, "body": "The following code populates a combobox with the unique values from a worksheet column; these items are stored in a dictionary object:: &#39;cbNames.Clear          Set d = CreateObject(&quot;Scripting.Dictionary&quot;)          With d         For Each rCell In ws.Range(&quot;C3&quot;, ws.Cells(Rows.Count, &quot;C&quot;).End(xlUp))             If Not .exists(rCell.Value) Then                 .Add rCell.Value, Nothing             End If         Next rCell                  Call funcSortDictByKeyAscending(d) &#39;This is where the keys should be sorted                  cbNames.List = .Keys     End With&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 0, "last_activity_date": 1449822767, "creation_date": 1449822767, "answer_id": 34219138, "question_id": 34187765, "link": "https://stackoverflow.com/questions/34187765/error-sorting-dictionary-by-ascending-key-value/34219138#34219138", "title": "Error sorting dictionary by ascending key value", "body": "<p>I'm not really sure why you're using a <code>Dicionary</code> for this task, but I've assumed it's required elsewhere in your project, so I've tried to dovetail mine into your existing code.</p>\n\n<p>If you are only putting sorted cells into a <code>ComboBox</code> then reading the cells into an array, removing duplicates and sorting that array, then populating the <code>ComboBox</code> would be simpler. There are plenty of examples of how to do each of these tasks on this site, so I won't reproduce them here.</p>\n\n<p>Here's the code for you:</p>\n\n<pre><code>Sub RunMe()\n    Dim ws As Worksheet\n    Dim rCell As Range\n    Dim dctItem As String\n    Dim dctArray() As String\n    Dim i As Integer\n    Dim d As Object\n    Dim v As Variant\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    'Code to poulate a few \"C\" cells\n    ws.Cells(3, \"C\").Resize(10).Value = Application.Transpose(Array(\"Z\", \"Y\", \"X\", \"W\", \"W\", \"E\", \"D\", \"C\", \"B\", \"A\"))\n    UserForm1.Show False\n\n    'Clear the combobox\n    UserForm1.cbNames.Clear\n\n    'Create the dictionary\n    Set d = CreateObject(\"Scripting.Dictionary\")\n    For Each rCell In ws.Range(\"C3\", ws.Cells(Rows.Count, \"C\").End(xlUp))\n        dctItem = CStr(rCell.Value2)\n        If Not d.Exists(dctItem) Then\n            d.Add dctItem, dctItem\n        End If\n    Next\n\n    'Convert the dictionary items to an array\n    Debug.Print \"PRE-SORT\"\n    ReDim dctArray(1 To d.Count)\n    i = 1\n    For Each v In d.Items\n        dctArray(i) = v\n        i = i + 1\n        Debug.Print v\n    Next\n\n    'Bubble sort the array\n    dctArray = BubbleSort(dctArray)\n\n    'Populate the dictionary and combobox\n    Debug.Print \"POST-SORT\"\n    Set d = CreateObject(\"Scripting.Dictionary\")\n    For i = LBound(dctArray) To UBound(dctArray)\n        d.Add dctArray(i), dctArray(i)\n        UserForm1.cbNames.AddItem dctArray(i)\n        Debug.Print dctArray(i)\n    Next\n\nEnd Sub\nPrivate Function BubbleSort(tempArray As Variant) As Variant\n    'Uses Microsoft's version: https://support.microsoft.com/en-us/kb/133135\n    Dim temp As Variant\n    Dim i As Integer\n    Dim noExchanges As Integer\n\n    ' Loop until no more \"exchanges\" are made.\n    Do\n        noExchanges = True\n\n        ' Loop through each element in the array.\n        For i = 1 To UBound(tempArray) - 1\n\n            ' If the element is greater than the element\n            ' following it, exchange the two elements.\n            If tempArray(i) &gt; tempArray(i + 1) Then\n                noExchanges = False\n                temp = tempArray(i)\n                tempArray(i) = tempArray(i + 1)\n                tempArray(i + 1) = temp\n            End If\n        Next i\n    Loop While Not (noExchanges)\n\n    BubbleSort = tempArray\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5651178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78016ddbbd761cbc6cf3998975df9a52?s=128&d=identicon&r=PG&f=1", "display_name": "ScoobyDoo2015", "link": "https://stackoverflow.com/users/5651178/scoobydoo2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 967, "favorite_count": 0, "accepted_answer_id": 34219138, "answer_count": 1, "score": 1, "last_activity_date": 1449822767, "creation_date": 1449690677, "last_edit_date": 1531164843, "question_id": 34187765, "link": "https://stackoverflow.com/questions/34187765/error-sorting-dictionary-by-ascending-key-value", "title": "Error sorting dictionary by ascending key value", "body": "<p>I have a userform that contains a combobox that's populated from the unique items in a worksheet column. I'm trying to sort the keys that represent the items in the combobox in ascending order using the below code, but I'm getting an \"Object variable or With block variable not set\" error:</p>\n\n<pre><code>Public Function funcSortKeysByLengthDesc(dctList As Object) As Object\nDim curKey As Variant\nDim key As Variant\nDim itX As Integer\nDim itY As Integer\nDim arrTemp() As Variant\nDim d As Object\n\n'Only sort if more than one item in the dict\nIf dctList.Count &gt; 1 Then\n\n    'Populate the array\n    ReDim arrTemp(dctList.Count)\n    itX = 0\n    For Each curKey In dctList\n        arrTemp(itX) = curKey\n        itX = itX + 1\n    Next\n\n    For itX = 0 To (dctList.Count - 2)\n        For itY = (itX + 1) To (dctList.Count - 1)\n            If arrTemp(itX) &gt; arrTemp(itY) Then\n                curKey = arrTemp(itY)\n                arrTemp(itY) = arrTemp(itX)\n                arrTemp(itX) = curKey\n            End If\n        Next\n    Next\n\n    'Create the new dictionary\n    Set d = CreateObject(\"Scripting.Dictionary\")\n\n    For itX = 0 To UBound(arrTemp)\n        d.Add arrTemp(itX), dctList(itX)\n    Next\n\n    Set funcSortKeysByLengthDesc = d\nElse\n    Set funcSortKeysByLengthDesc = dctList\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "global-variables", "userform"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1449689607, "post_id": 34187210, "comment_id": 56121138, "body": "Are the files open at the same time? The userform stays open when you want to use the stored value? If you close the userform, the value disappears from its global variable. If you close the excel file, all values disappear from all variables."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1449689659, "post_id": 34187210, "comment_id": 56121167, "body": "Also, you say worksheets, but I&#39;m pretty sure you mean workbooks. If yes, please edit the title and the question."}, {"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1449689845, "post_id": 34187210, "comment_id": 56121281, "body": "Yes its a &quot;Workbook&quot; sorry changed it. At first Userform will be Opened form there i am opening the second workbook."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1449696928, "post_id": 34187210, "comment_id": 56125184, "body": "Well, as long as your userform is open, you can reference the global variable. But you can also reference any field also, so no real need for a global variable. If you post your code, it will be easier to help."}, {"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1449698256, "post_id": 34187210, "comment_id": 56125867, "body": "I have added  the code which i have written inside the Userform, kindly check it out"}], "answers": [{"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 0, "last_activity_date": 1449738537, "creation_date": 1449738537, "answer_id": 34197675, "question_id": 34187210, "link": "https://stackoverflow.com/questions/34187210/how-to-use-the-userform-global-variable-value-in-different-workbook-using-vba/34197675#34197675", "title": "How to use the Userform Global Variable value in different Workbook using VBA", "body": "<p>It should be possible. Declare and initialize a variable in the workbook which contains the User Form, e.g. like this. </p>\n\n<pre><code>Option Explicit\n\nPublic EpcName As String\nPrivate m_theOtherWorkbook As Workbook\n\nPrivate Sub UserForm_Initialize()\n    On Error GoTo ErrInit\n\n    Set m_theOtherWorkbook = Workbooks(\"Power Plant EPC 1.xlsm\")\n\n    Exit Sub\n\nErrInit:\n    MsgBox \"Error in \" &amp; Me.Name &amp; \". UserForm_Initialize. \" &amp; Err.Description, vbCritical, \"Error\"\nEnd Sub\n</code></pre>\n\n<p>Then in the other workbook, class module ThisWorkbook, add e.g. a public property like this (could be just a public variable).</p>\n\n<pre><code>Option Explicit\n\nPrivate m_epcName As String\n\nPublic Property Get EpcName() As String\n    EpcName = m_epcName\nEnd Property\n\nPublic Property Let EpcName(ByVal vNewValue As String)\n    m_epcName = vNewValue\nEnd Property\n</code></pre>\n\n<p>And in the code of User form simply call the EpcName property of the other workbook (the other workbook must be opened of course). The property EpcName is now part of a new interface of the other workbook and it should work just fine. HTH</p>\n\n<pre><code> EpcName = \"Want to pass this String to other workbook\" ' Me.ComboBox2.Text\n\n If Not m_theOtherWorkbook Is Nothing Then _\n    m_theOtherWorkbook.EpcName = EpcName\n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1016, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449738537, "creation_date": 1449688756, "last_edit_date": 1449698171, "question_id": 34187210, "link": "https://stackoverflow.com/questions/34187210/how-to-use-the-userform-global-variable-value-in-different-workbook-using-vba", "title": "How to use the Userform Global Variable value in different Workbook using VBA", "body": "<p>I have maintained two excel workbooks in different folders, in the first excel i have created an Userform which has two comboboxes in it, i have declared an global variable \"EpcName\" in Userform and this global variable stores the second combobox selected value.\nNow my question is how can i use the value of Global variable from Userform to other workbook which is there in different folder.</p>\n\n<p>Workbook 1 path(Where i have created userform)\nC:\\Users\\inkapb\\AppData\\Local\\Temp\\EPC AutoTool\\Start Screen -UI\\UI.xlsm</p>\n\n<p>Workbook 2 path\nC:\\Users\\inkapb\\AppData\\Local\\Temp\\EPC AutoTool\\Projects\\Power Plant\\Power Plant EPC 1.xlsm</p>\n\n<p>Here is the code which i have written in the Userform</p>\n\n<pre><code> Public EpcName As String\n Private Sub CommandButton1_Click()\n\n Dim wb As Workbook\n Dim ws As Worksheet\n\n\n Set wb = Workbooks(\"UI.xlsm\")\n Set ws = wb.Worksheets(\"Sheet2\")\n\n  Dim qwerty As String\n Dim cf As Range\n\n\n\n EpcName = Me.ComboBox2.Text  'Want to pass this String to other workbook\n\n With ws\n.Activate\nWith .Range(\"C1:C10000\")\n\n  Set cf = .Find(what:=EpcName, _\n    lookat:=xlPart, searchorder:=xlByRows, searchdirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False)\n\n    If cf = \"\" Then\n MsgBox \"nothing\"\n Else\n Range(cf.Address).Select\n Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True\n\n End If\n\n    End With\n\n    End With\n\n End Sub\n</code></pre>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["arrays", "vba", "c1flexgrid", "msflexgrid", "vsflexgrid"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449688929, "post_id": 34187194, "comment_id": 56120760, "body": "Have you tried anything?  Please show any attempt in the original post.  SO generally is not a code for me site."}, {"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449689147, "post_id": 34187194, "comment_id": 56120861, "body": "Updated with the little I have, My post was generic because I have no idea where to go, hence coming to this site."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449689222, "post_id": 34187194, "comment_id": 56120917, "body": "You just want the ID number not the name in the array?"}, {"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449689446, "post_id": 34187194, "comment_id": 56121042, "body": "@ScottCraner correct, the name is just a reference the user uses to make their selection since the ID is meaningless to them. I&#39;ll likely evne hide the ID once this is working."}, {"owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449689597, "post_id": 34187194, "comment_id": 56121133, "body": "I was trying to take some code from another project I did that dumps the flex grid data into Excel using TextMatrix, so I thought I&#39;d have to do something that would offset the column to get the rihgt value, then textmatrix to dump out only where it&#39;s true."}], "answers": [{"tags": [], "owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "is_accepted": true, "score": 0, "last_activity_date": 1449769319, "last_edit_date": 1449769319, "creation_date": 1449768958, "answer_id": 34208291, "question_id": 34187194, "link": "https://stackoverflow.com/questions/34187194/vba-flexgrid-selected-rows-to-array/34208291#34208291", "title": "VBA FlexGrid selected rows to array", "body": "<p>I was able to accomplish this by adding a Boolean Column</p>\n\n<p>0 is false, and -1 is true</p>\n\n<p>Then I used this code to build an array that I can populate an SQL query with using the IN statement</p>\n\n<p>(i, 3) designates what column I want the value to come from</p>\n\n<pre><code>    Dim i As Integer\nDim test As String\n\nFor i = 0 To Main_Window.form_seg_carrier_grid.Rows - 1\n    If Main_Window.form_seg_carrier_grid.ValueMatrix(i, 0) = -1 Then\n        If test &lt;&gt; vbNullString Then test = test &amp; \", \"\n            test = test &amp; \"'\"\n            test = test &amp; Main_Window.form_seg_carrier_grid.ValueMatrix(i, 3)\n            test = test &amp; \"'\"\n    End If\nNext i\n</code></pre>\n\n<p>Output would be ( referencing original post )</p>\n\n<pre><code>'1','3'\n</code></pre>\n"}], "owner": {"reputation": 682, "user_id": 4407528, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1304370176/picture?type=large", "display_name": "Jeff Beagley", "link": "https://stackoverflow.com/users/4407528/jeff-beagley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 0, "accepted_answer_id": 34208291, "answer_count": 1, "score": 0, "last_activity_date": 1449769319, "creation_date": 1449688686, "last_edit_date": 1449769270, "question_id": 34187194, "link": "https://stackoverflow.com/questions/34187194/vba-flexgrid-selected-rows-to-array", "title": "VBA FlexGrid selected rows to array", "body": "<p>I have a Flexgrid (VSFlexGrid 8) with 3 columns</p>\n\n<p>grid name = Main_Window.form_seg_carrier_grid</p>\n\n<pre><code>Select | Name | ID\nx      | abc  | 1\n       | cdf  | 2\nx      | dfs  | 3\n</code></pre>\n\n<p>The select column is defined as a Boolean data type, and is left up to the user to select which rows are true/false.</p>\n\n<p>What I need is a way to take all rows that are true, and set the ID to an array.</p>\n\n<p>Currently the only thing I can get is to show me which row is selected, or if it's true/false which is a 0 for false, and -1 for true.</p>\n\n<p>The array can be built on a button click or on change.</p>\n\n<p>EDIT 1</p>\n\n<p>This is as far as I can get, this will fire off a msgbox ( quick way to test variables ) to show when it's being set to true</p>\n\n<pre><code>    Private Sub form_seg_carrier_grid_Click()\nDim test As String\n    test = Main_Window.form_seg_carrier_grid.Value\n        If test = -1 Then\n\n            MsgBox test\n\n        End If\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Edit 2</p>\n\n<p>I feel I'm close with something like this, just can't get it to do what I want..</p>\n\n<pre><code>Dim i As Integer\nDim test As String\n\nFor i = 0 To Main_Window.form_seg_carrier_grid.Rows - 1\n    If Main_Window.form_seg_carrier_grid.IsSelected(i) Then\n        If test &lt;&gt; vbNullString Then test = test &amp; \", \"\n            test = test &amp; \"'\"\n            test = test &amp; Main_Window.form_seg_carrier_grid.ValueMatrix(i, 1)\n            test = test &amp; \"'\"\n    End If\nNext i\n</code></pre>\n"}, {"tags": ["regex", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 6677, "user_id": 2282445, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/G3qze.jpg?s=128&g=1", "display_name": "Matt Williamson", "link": "https://stackoverflow.com/users/2282445/matt-williamson"}, "edited": false, "score": 0, "creation_date": 1450120227, "post_id": 34265391, "comment_id": 56291234, "body": "I really just want to have a template file in the drafts folder with the 3 items to replace. I&#39;d prefer to do it with a regex just because I&#39;m just learning them and want to start using them more because of the sheer power they give. I think I&#39;m going to have to break it up into 2 functions. One to find them and another to do the replace. I tried working with the regex replace function but it didn&#39;t do what I expected, which is to locate the expected text and replace it with new text as defined in the replace function as seen in this <a href=\"https://blog.udemy.com/vba-regex/\" rel=\"nofollow noreferrer\">example</a>"}, {"owner": {"reputation": 60, "user_id": 2815681, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d295ff23c9e5eb5d823998728024bf79?s=128&d=identicon&r=PG&f=1", "display_name": "user2815681", "link": "https://stackoverflow.com/users/2815681/user2815681"}, "reply_to_user": {"reputation": 6677, "user_id": 2282445, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/G3qze.jpg?s=128&g=1", "display_name": "Matt Williamson", "link": "https://stackoverflow.com/users/2282445/matt-williamson"}, "edited": false, "score": 0, "creation_date": 1450251432, "post_id": 34265391, "comment_id": 56354231, "body": "Oke I get that, if I have some time today i will look into it, I have an idea I can use this as well. I don&#39;t know if i can work with the regex replace function, the link doesn&#39;t and I don&#39;t know the function in detail. [link] (<a href=\"http://regexr.com/\" rel=\"nofollow noreferrer\">regexr.com</a>) is always really helpful in tweaking my regexes."}, {"owner": {"reputation": 6677, "user_id": 2282445, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/G3qze.jpg?s=128&g=1", "display_name": "Matt Williamson", "link": "https://stackoverflow.com/users/2282445/matt-williamson"}, "edited": false, "score": 0, "creation_date": 1450283086, "post_id": 34265391, "comment_id": 56376009, "body": "Ok, thanks. I&#39;m actually very close. I broke the find in the selected email into a separate function and the replace into another. I haven&#39;t had time to work on it today yet. I&#39;ll post the code when I get it. Thanks for the regex tester. I use <a href=\"http://www.regex101.com\" rel=\"nofollow noreferrer\">regex101</a>"}], "tags": [], "owner": {"reputation": 60, "user_id": 2815681, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d295ff23c9e5eb5d823998728024bf79?s=128&d=identicon&r=PG&f=1", "display_name": "user2815681", "link": "https://stackoverflow.com/users/2815681/user2815681"}, "is_accepted": false, "score": 1, "last_activity_date": 1450091045, "creation_date": 1450091045, "answer_id": 34265391, "question_id": 34186802, "link": "https://stackoverflow.com/questions/34186802/replace-regex-submatched-fields-with-extracts-from-email-body/34265391#34265391", "title": "Replace regex submatched fields with extracts from email body", "body": "<p>Is it possible to change from {} to {adress} so you can do a string replace?\n<a href=\"https://msdn.microsoft.com/en-us/library/bt3szac5%28v=vs.90%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/bt3szac5%28v=vs.90%29.aspx</a></p>\n\n<pre><code>String = Replace(title, \"something\", \"{adres}\")\n</code></pre>\n\n<p>It should be also possible to compile an entire email from vba so you can bypass the draft folder (that's a step i don't fully get)?</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff861332.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff861332.aspx</a></p>\n\n<pre><code>Sub CreateMail() \n\n Dim myItem As Object \n\n Set myItem = Application.CreateItem(olMailItem) \n\n myItem.Subject = \"Mail to myself\" \n\n myItem.Display \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 6677, "user_id": 2282445, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/G3qze.jpg?s=128&g=1", "display_name": "Matt Williamson", "link": "https://stackoverflow.com/users/2282445/matt-williamson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593517807, "creation_date": 1449687344, "last_edit_date": 1593517807, "question_id": 34186802, "link": "https://stackoverflow.com/questions/34186802/replace-regex-submatched-fields-with-extracts-from-email-body", "title": "Replace regex submatched fields with extracts from email body", "body": "<p>First, Here is exactly what I want to do. </p>\n\n<ol>\n<li>Open outlook if it isn't already</li>\n<li>highlite an email from the quickview pane</li>\n<li>Run VBA code from an icon on the ribbon</li>\n<li>The code will pick up 3 items from the currently selected email using regular expressions.</li>\n<li>The 3 items will be used to fill in a form in my drafts folder with a specific subject.</li>\n<li>The previous items will be used to replace fields in the form that are enclosed in braces <code>{}</code> or curly brackets, I've heard them called both.</li>\n<li>The email will pop up but wait for me to send it.</li>\n</ol>\n\n<p>Now, onto the code I've come up with so far. </p>\n\n<pre><code>Public Function GetIDsRegExp()\n\nDim olApp As Outlook.Application\nDim olMail As Outlook.MailItem\nSet olApp = New Outlook.Application\nDim objRegExp As RegExp\nDim sString As String\nDim sBody As String\nDim objMatch As Match\nDim colMatches As MatchCollection\n\nSet olMail = olApp.ActiveExplorer.Selection.Item(1)\n'Debug.Print olMail.Body\n    sString = olMail.Body\n\n    Set objRegExp = New RegExp\n\n    With objRegExp\n        .Pattern = \"(?:message|instrument)ID\\s+:(\\w+)\"\n        .IgnoreCase = True\n        .Global = True\n    End With\n\n    If (objRegExp.Test(sString) = True) Then\n\n        'Get the matches.\n         Set colMatches = objRegExp.Execute(sString)   ' Execute search.\n\n\n\n        For Each objMatch In colMatches   ' Iterate Matches collection.\n            Debug.Print objMatch.SubMatches(0)\n\n'      sBody = Replace(Template, \"{MessageID}\", objMatch.SubMatches(0))\n'      sBody = Replace(Template, \"{InstrumentID}\", objMatch.SubMatches(0))\n'      Debug.Print sBody\n\n        Next\n\n    End If\n\n    Template = FindTemplate()\n    Debug.Print Replace(Template, \"{Date}\", Now())\n\nEnd Function\n\nFunction FindTemplate()\n        Set objOutlook = GetObject(\"\", \"Outlook.Application\")\n        Set objDrafts = objOutlook.GetNamespace(\"MAPI\").GetDefaultFolder(16)\n        Set objItems = objDrafts.Items\n\n        For Each objDraft In objItems\n                If objDraft.Subject = \"Environment : Prod International Trade Error\" Then\n                        FindTemplate = objDraft.Body\n                        Exit Function\n                End If\n        Next\nEnd Function\n</code></pre>\n\n<p>When I debug.print the code, I get exactly what I want. Now, I need to replace fields enclosed by {} in the template with the right submatched extracts. I'm stuck on 5 and 6. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449684477, "post_id": 34185888, "comment_id": 56118108, "body": "Have you tried to qualify the cell? What does debug.print for sfile say? Might want to add <code>as object</code> after <code>dim FSO</code>. And usually you increment at end of loop."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1449685236, "post_id": 34185888, "comment_id": 56118607, "body": "you also need to move the creation of your FSO object out of your loop.  You only need to create this once instead of how you are doing it now, with each iteration of the loop."}], "answers": [{"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1449685077, "creation_date": 1449685077, "answer_id": 34186151, "question_id": 34185888, "link": "https://stackoverflow.com/questions/34185888/syntax-to-recognize-the-contents-of-a-cell-as-a-filename/34186151#34186151", "title": "Syntax to recognize the contents of a cell as a filename", "body": "<p>Try replacing this line:</p>\n\n<pre><code>FSO.CopyFile (sSFolder &amp; sFile), sDFolder\n</code></pre>\n\n<p>with this line:</p>\n\n<pre><code>FSO.CopyFile sSFolder &amp; sFile, sDFolder\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1449686300, "creation_date": 1449686300, "answer_id": 34186505, "question_id": 34185888, "link": "https://stackoverflow.com/questions/34185888/syntax-to-recognize-the-contents-of-a-cell-as-a-filename/34186505#34186505", "title": "Syntax to recognize the contents of a cell as a filename", "body": "<p><code>CopyFile</code> requires two <em>full</em> paths - both should include the file name</p>\n"}], "owner": {"reputation": 1, "user_id": 5660394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac92c170635e416910836a207687226e?s=128&d=identicon&r=PG&f=1", "display_name": "WJP", "link": "https://stackoverflow.com/users/5660394/wjp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1449693060, "creation_date": 1449684277, "last_edit_date": 1449693060, "question_id": 34185888, "link": "https://stackoverflow.com/questions/34185888/syntax-to-recognize-the-contents-of-a-cell-as-a-filename", "title": "Syntax to recognize the contents of a cell as a filename", "body": "<p>I have written an Excel macro to copy pdf files from a source folder to a destination folder. I am now trying to incorporate a Do Loop into the macro so I can move multiple files, each of which are identified in a separate cell. Also, the quantity of files to be moved will vary.</p>\n\n<p>When I use the command line</p>\n\n<pre><code>sFile = Range(\"G14\").Value &amp; \".pdf\"\n</code></pre>\n\n<p>it does copy the file listed in cell G14 to the destination folder. However, I am having no luck using the <code>Do Loop</code> and <code>sFiles = Cells (I,7)</code> to increment through the series of filenames that I want to move. The macro bombs out on the final step.</p>\n\n<p>Any suggestions would be appreciated.</p>\n\n<pre><code>Sub Copying_File()\n\nSheets(\"Sheet1\").Select\n    I = 8\n        Do\n            I = I + 1\n            If Cells(I, 7) = \"zzzz\" Then Cells(I, 8) = \"Transfer of Files Complete\"\n            If Cells(I, 7) = \"zzzz\" Then Exit Do\n'Declare Variables\n            Dim FSO\n            Dim sFile As String\n            Dim sSFolder As String\n            Dim sDFolder As String\n\n'This is Your File Name which you want to Copy\n            sFile = Cells(I, 7).Value &amp; \".pdf\"\n\n'Change to match the source folder path\n            sSFolder = \"I:\\PatschB\\ZZZ Source\\\"\n\n'Change to match the destination folder path\n            sDFolder = \"I:\\PatschB\\ZZZ Destination\\\"\n\n'Create Object\n            Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n\n'Copying File to Destination Folder\n            FSO.CopyFile (sSFolder &amp; sFile), sDFolder\n\n        Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1449683942, "post_id": 34185761, "comment_id": 56117778, "body": "Qualify your sheet/range?"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5520020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-PBDrhpbDmXM/AAAAAAAAAAI/AAAAAAAACcM/qr-X6m1Bdhc/photo.jpg?sz=128", "display_name": "Thomas Culbertson", "link": "https://stackoverflow.com/users/5520020/thomas-culbertson"}, "edited": false, "score": 0, "creation_date": 1449689554, "post_id": 34185845, "comment_id": 56121109, "body": "Thank you Tim. I think I see how to qualify the references now."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 83, "user_id": 5520020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-PBDrhpbDmXM/AAAAAAAAAAI/AAAAAAAACcM/qr-X6m1Bdhc/photo.jpg?sz=128", "display_name": "Thomas Culbertson", "link": "https://stackoverflow.com/users/5520020/thomas-culbertson"}, "edited": false, "score": 0, "creation_date": 1449696654, "post_id": 34185845, "comment_id": 56125044, "body": "No problem.  Also worth noting that wherever possible you should try to avoid using Select/Activate when working with sheets/ranges: relying on a particular sheet being active or a range selected makes you code difficult to debug as your project gets larger and you add more methods."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1449684117, "creation_date": 1449684117, "answer_id": 34185845, "question_id": 34185761, "link": "https://stackoverflow.com/questions/34185761/keep-a-sub-specific-to-the-intended-sheet/34185845#34185845", "title": "Keep a sub specific to the intended sheet", "body": "<pre><code>Sub RunEvery60seconds()\n    ThisWorkbook.Sheets(\"MySheet\").Range(\"A13\").End(xlDown).Offset(1, 0).Value = _\n                                                     Format(Now(), \"hh:mm:ss\")\n    Call Fetch         '&lt;&lt;&lt; qualify all sheet references here\n    Call OnTimeMacro   '&lt;&lt;&lt; ...and here\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5520020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-PBDrhpbDmXM/AAAAAAAAAAI/AAAAAAAACcM/qr-X6m1Bdhc/photo.jpg?sz=128", "display_name": "Thomas Culbertson", "link": "https://stackoverflow.com/users/5520020/thomas-culbertson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 34185845, "answer_count": 1, "score": 0, "last_activity_date": 1449684117, "creation_date": 1449683855, "last_edit_date": 1531161705, "question_id": 34185761, "link": "https://stackoverflow.com/questions/34185761/keep-a-sub-specific-to-the-intended-sheet", "title": "Keep a sub specific to the intended sheet", "body": "<p>The follownig Excel sub runs every minute for several hours. It works fine unless I switch to a different workbook. At that point it bombs on the third line down.\nHow do I keep it focused on the sheet it is intended for?</p>\n\n<pre><code>Sub RunEvery60seconds()\n          Range(\"A13\").End(xlDown).Select\n          ActiveCell.Offset(1, 0).Select\n          ActiveCell.Value = Format(Now(), \"hh:mm:ss\")\n          Call Fetch\n          Call OnTimeMacro\nEnd Sub\n</code></pre>\n\n<p>There is probabbly some simple syntax that I have overlooked. I would appreciate some help. Thanks</p>\n"}, {"tags": ["excel", "ms-access-2010", "vba"], "comments": [{"owner": {"reputation": 93, "user_id": 5637382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63248eea7e0030ce4661f8548da23e48?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Z.", "link": "https://stackoverflow.com/users/5637382/steve-z"}, "edited": false, "score": 0, "creation_date": 1449684747, "post_id": 34185647, "comment_id": 56118269, "body": "Update: I tested my code with a query on a local table, it works perfect. However, the problem came when the query is on a linked ODBC table."}], "owner": {"reputation": 93, "user_id": 5637382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63248eea7e0030ce4661f8548da23e48?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Z.", "link": "https://stackoverflow.com/users/5637382/steve-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449687127, "creation_date": 1449683508, "last_edit_date": 1531164843, "question_id": 34185647, "link": "https://stackoverflow.com/questions/34185647/excel-vba-run-existing-access-query-runtime-error", "title": "excel vba run existing access query runtime error", "body": "<p>Need help about the error. I'm trying to use excel VBA to run an existing ACCESS  query with parameters. I am getting Run-time error '-2147217911 (80040e90): Automation error. After setting up checking point and it seems like the problem comes the code \"rs.Open cmd\". Can anyone help me out? Thanks a lot.</p>\n\n<p>The code is as below:</p>\n\n<pre><code>Dim con As ADODB.Connection\nDim cmd As ADODB.Command\nDim prm As ADODB.Parameter\nDim rs As ADODB.Recordset\n\nSet con = CreateObject(\"ADODB.Connection\")\nSet cmd = CreateObject(\"ADODB.Command\")\n\nWith con\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .Open \"U:\\databases\\myaccessdatabase.mdb\"\nEnd With\n\nWith cmd\n    .activeconnection = con\n    .CommandText = \"myquery\"\n    .CommandType = adCmdStoredProc\n\n    .Parameters.Append cmd.CreateParameter(\"startdate\", adDBDate, adParamInput, , \"11/01/2015\")\n\n    .Parameters.Append cmd.CreateParameter(\"startdate\", adDBDate, adParamInput, , \"11/30/2015\")\n\nEnd With\n\n\n'run query and paste the result into the excel\nSet rs = CreateObject(\"ADODB.Recordset\")\nrs.Open cmd\nSheet1.Range(\"A1\").CopyFromRecordset rs\n\n '  The following is the code for write the log information into the VBA immediate window\n    Do Until rs.EOF\n       Debug.Print rs.Fields(\"ID\").Value\n      rs.MoveNext\n    Loop\n\n ' Close and release the sources from the system\n\nrs.Close\ncon.Close\n\nSet cmd = Nothing\nSet rs = Nothing\nSet prm = Nothing\nSet con = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sharepoint"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 3680803, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8f0124df588aa09bb16727605c936a81?s=128&d=identicon&r=PG&f=1", "display_name": "arooney88", "link": "https://stackoverflow.com/users/3680803/arooney88"}, "edited": false, "score": 0, "creation_date": 1449685942, "post_id": 34185816, "comment_id": 56119044, "body": "Wow. I read through the Workbook.Open help guide and totally didn&#39;t see the rest of the Notify explanation. Thanks!"}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 1, "last_activity_date": 1449684025, "creation_date": 1449684025, "answer_id": 34185816, "question_id": 34185196, "link": "https://stackoverflow.com/questions/34185196/how-to-bypass-sharepoint-read-only-alert-when-opening-an-excel-workbook-with-v/34185816#34185816", "title": "How to bypass SharePoint &quot;Read-Only&quot; alert when opening an Excel Workbook with VBA.", "body": "<p>Replace this line:</p>\n\n<pre><code>Workbooks.Open _\n    fileName:=\"http://Sharepoint.com/QA/FC%20QA%20Workshop/Databases/Dec/FC%20Spec%20Database.xlsm\", _\n    UpdateLinks:=3, ReadOnly:=False\n</code></pre>\n\n<p>With this line:</p>\n\n<pre><code>Workbooks.Open _\n    fileName:=\"http://Sharepoint.com/QA/FC%20QA%20Workshop/Databases/Dec/FC%20Spec%20Database.xlsm\", _\n    UpdateLinks:=3, ReadOnly:=False, Notify:=False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9659904, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/47e98d95c3ad158c5c139a74758c0a4d?s=128&d=identicon&r=PG", "display_name": "SteveB", "link": "https://stackoverflow.com/users/9659904/steveb"}, "is_accepted": false, "score": 0, "last_activity_date": 1523984038, "last_edit_date": 1523984038, "creation_date": 1523982851, "answer_id": 49883271, "question_id": 34185196, "link": "https://stackoverflow.com/questions/34185196/how-to-bypass-sharepoint-read-only-alert-when-opening-an-excel-workbook-with-v/49883271#49883271", "title": "How to bypass SharePoint &quot;Read-Only&quot; alert when opening an Excel Workbook with VBA.", "body": "<p>I created a WB, saved it Read-only to my desktop as Book1.  I tried the method as described above, but still got the popup.  I changed 'ReadOnly:=' from False to True and it worked. Try it yourself.</p>\n\n<pre><code>Sub Test()\nDim File1 As String\nFile1 = Environ(\"USERPROFILE\") + \"\\Desktop\\Book1.xlsx\"\nWorkbooks.Open Filename:=File1, ReadOnly:=True, Notify:=False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 3680803, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8f0124df588aa09bb16727605c936a81?s=128&d=identicon&r=PG&f=1", "display_name": "arooney88", "link": "https://stackoverflow.com/users/3680803/arooney88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8253, "favorite_count": 0, "accepted_answer_id": 34185816, "answer_count": 2, "score": 0, "last_activity_date": 1523984038, "creation_date": 1449682132, "question_id": 34185196, "link": "https://stackoverflow.com/questions/34185196/how-to-bypass-sharepoint-read-only-alert-when-opening-an-excel-workbook-with-v", "title": "How to bypass SharePoint &quot;Read-Only&quot; alert when opening an Excel Workbook with VBA.", "body": "<p>I'm trying to check if the workbook file below is already open in \"edit mode\" when the code tries to run. I'm trying to plan for when this will error out because someone else is already in the file. I need the <code>Workbook.Open</code> to open as <code>ReadOnly = False</code> because if nobody is in it, I need to be able to save after the update. </p>\n\n<p>The issue I'm having is that even with <code>DisplayAlerts = False</code> when the <code>Workbook.Open</code> line runs, I get an on screen prompt that says \"The File is locked for editing by (some user). Do you want to: View a read-only copy or save and edit a copy of the file.\" There is also a checkbox that says \"Receive a notification when the server file is available\". The <code>DisplayAlerts = False</code> doesn't seem to cancel the SharePoint prompt. Any ideas on why that wouldn't cancel the promt? \nI want to get to the point in the code where it tries to open in edit-mode, and can't, and then goes to <code>If Activeworkbook.Readonly Then</code> line and exits out of the sub. Right now it stops and waits for a selection on the SharePoint prompt. </p>\n\n<pre><code>Sub SendFCSpec()\n\nMsgBox (\"Please wait while your comments are sent to the database.\")\nActiveSheet.Unprotect Password:=\"BAS1\"\n'Turn Screen Updating and Alerts off\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n'Disable Macros on AutoOpen of the Excel Workbook\nApplication.AutomationSecurity = msoAutomationSecurityForceDisable\nWorkbooks.Open Filename:=\"http://Sharepoint.com/QA/FC%20QA%20Workshop/Databases/Dec/FC%20Spec%20Database.xlsm\", _\nUpdateLinks:=3, ReadOnly:=False\nIf ActiveWorkbook.ReadOnly Then\n    ActiveWorkbook.Close\n    MsgBox \"Another user has the database open. Unable to submit comments at this time.\"\n    Application.AutomationSecurity = msoAutomationSecurityLow\n    Exit Sub\nEnd If\nApplication.AutomationSecurity = msoAutomationSecurityLow\n\nActiveWorkbook.Save\nActiveWorkbook.Close\n\nActiveSheet.Select\nActiveSheet.Protect Password:=\"BAS1\", DrawingObjects:=True, Contents:=True, Scenarios:=True _\n    , AllowFormattingCells:=True, AllowFormattingColumns:=True, _\n    AllowFormattingRows:=True, AllowSorting:=True, AllowFiltering:=True\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nMsgBox (\"Comments have been saved to the Database. Thanks\")\nEnd Sub  \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1449682068, "post_id": 34185106, "comment_id": 56116601, "body": "Since you&#39;re declaring your arrays as variant, this isn&#39;t an issue but just fyi, you need to declare type for all variables. <code>dim x, y as integer</code> means only y is type int, x is variant."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449683458, "post_id": 34185106, "comment_id": 56117478, "body": "<code>Doc.getElementsByTagName(&quot;td&quot;)(2).innerText</code> will error out if there is not a 2nd element on the page for the tag &quot;td&quot;. You should error check for this so your code will run through."}], "owner": {"reputation": 250, "user_id": 5660376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1053175164a661279401647b22f16e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Kerem T", "link": "https://stackoverflow.com/users/5660376/kerem-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449681849, "creation_date": 1449681849, "question_id": 34185106, "link": "https://stackoverflow.com/questions/34185106/object-variable-or-with-block-variable-not-set-vba", "title": "object variable or with block variable not set vba", "body": "<p>So i tried out this code to scrape data from the website. It pulls data from sheet1 then navigates and searches for people. Then it gets certain html tag innertext. This is work time to time partly. Sometimes all 5 pages are successfully open but data is missing in sheet2 where i want to assign the search values and sometimes it gives the error above when it is done only navigating just 2 pages.\nVBA tells me error is in line:\nPhoneNumber(i) = Doc.getElementsByTagName(\"td\")(2).innerText\nHow can I successfully scrape all the needed information without a bug.</p>\n\n<pre><code>Sub PeopleFinders()\n\nDim i As Integer\nDim ie As Object\nDim firstname(1 To 5), lastname(1 To 5) As Variant\nDim mm(1 To 5), dd(1 To 5), yyyy(1 To 5) As Variant\nDim PhoneNumber(1 To 5) As Variant\nDim Address(1 To 5) As Variant\n\nFor i = 1 To 5\n    firstname(i) = Sheet1.Cells(i, 1).Value\n    lastname(i) = Sheet1.Cells(i, 2).Value\n    mm(i) = Sheet1.Cells(i, 3).Value\n    dd(i) = Sheet1.Cells(i, 4).Value\n    yyyy(i) = Sheet1.Cells(i, 5).Value\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    ie.Visible = True\n    ie.navigate (\"http://www.peoplefinders.com/peoplesearch/searchresults?search=People&amp;fn=\" &amp; firstname(i) &amp; \"&amp;mn=&amp;ln=\" &amp; lastname(i) &amp; \"&amp;city=&amp;state=&amp;age=&amp;dobmm=\" &amp; mm(i) &amp; \"&amp;dobdd=\" &amp; dd(i) &amp; \"&amp;doby=\" &amp; yyyy(i))\n\n    Do While ie.Busy: DoEvents: Loop\n    Dim Doc As HTMLDocument\n    Set Doc = ie.document\n\n    PhoneNumber(i) = Doc.getElementsByTagName(\"td\")(2).innerText\n    Address(i) = Doc.getElementsByTagName(\"td\")(1).innerText\n\n    Sheet5.Cells(i, 1).Value = PhoneNumber(i)\n    Sheet5.Cells(i, 2).Value = Address(i)\n\nNext\n\nSet ie = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "locking", "ado"], "answers": [{"comments": [{"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 1, "creation_date": 1449682375, "post_id": 34185059, "comment_id": 56116809, "body": "Thanks - but I&#39;m wondering why a read-only connection would affect the ability of another user to make changes. Surely that&#39;s what read-only means, right?  To add context: I am the sole designer of the document, and database connection are short, and only made via VBA. No-one connects to the DB and leaves it open. I have an Excel Workbook_Open event that loads data, then when the user makes changes short connections are made to write data. I just don&#39;t want someone to be prevented from writing because another user is in the process of loading the initial data (which takes a few seconds)."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1449682645, "post_id": 34185059, "comment_id": 56116954, "body": "Sorry, I totally misunderstood the question.  I thought it was simply about why a lock file is created for a read-only connection.  Please consider revising the question to clarify what you&#39;re really after.  Then I can delete this answer."}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1449682746, "post_id": 34185059, "comment_id": 56117016, "body": "Oh, your answer is very interesting - and appreciated! It does indeed address the question I asked. It was just an implied secondary question about whether there&#39;s anything else I can do to prevent the lock. I did not ask that originally because I wasn&#39;t sure if this behaviour was an error or not. I have now added the secondary question as a comment."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1449682985, "post_id": 34185059, "comment_id": 56117142, "body": "OK.  As best I recall, ADO connections permitting shared access were tricky.  But I can&#39;t offer details because I largely abandoned ADO in favor of DAO.  I still think you should revise the question to clarify your aims and maybe someone else can step in with the solution you need."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1449683267, "post_id": 34185059, "comment_id": 56117337, "body": "Hmm.  Do you get what you want with <code>.Mode=adModeShareDenyNone</code> or <code>.Mode=adModeRead+adModeShareDenyNone</code>?"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1449684015, "post_id": 34185059, "comment_id": 56117818, "body": "Thanks for the suggestions. Just tried them both, but the .ldb file still appears! Thanks anyway."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1449681675, "creation_date": 1449681675, "answer_id": 34185059, "question_id": 34184833, "link": "https://stackoverflow.com/questions/34184833/why-is-an-ado-connection-still-creating-an-ldb-lock-file-even-when-read-only/34185059#34185059", "title": "Why is an ADO connection still creating an &quot;ldb&quot; lock file even when read-only?", "body": "<p>The lock file records connections to the db file.  That information is important in a multi-user context.  Even if yours is the only connection and is intentionally read-only, Access still records that connection in the lock file.  It would be important in a situation where another used wanted to connect to the same db file in exclusive mode in order to make design changes --- they would not be allowed exclusive access while your connection is still active.</p>\n"}], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 0, "accepted_answer_id": 34185059, "answer_count": 1, "score": 5, "last_activity_date": 1531311902, "creation_date": 1449681024, "last_edit_date": 1531311902, "question_id": 34184833, "link": "https://stackoverflow.com/questions/34184833/why-is-an-ado-connection-still-creating-an-ldb-lock-file-even-when-read-only", "title": "Why is an ADO connection still creating an &quot;ldb&quot; lock file even when read-only?", "body": "<p>Quick question for you database experts. See the following code (VBA/ADO), called from Excel:</p>\n\n<pre><code>Dim DBPath As String, ConnStr As String\nDBPath = ThisWorkbook.Path &amp; Application.PathSeparator &amp; \"Database.mdb\"\nConnStr = \"Data Source=\" &amp; DBPath &amp; \";\" &amp; \"Jet OLEDB:Database Password=\" &amp; DBPass()\nDim cnn as ADODB.Connection\nSet cnn = New ADODB.Connection\nWith cnn\n    .Provider = CheckProvider(strPath:=DBPath) ' Separate function call. Ignore\n    .Mode = adModeRead\n    .Open ConnStr\nEnd With\nStop ' To inspect the directory...\n</code></pre>\n\n<p>It <em>should</em> open the database as read-only, given the \"adModeRead\" specification. However I have noticed that a lock file (Database.ldb) is still being created/deleted in the directory while the connection is active. Surely this goes contrary to the read-only command, which should mean that no data may be written, and therefore no file lock is needed.</p>\n\n<p>Can anyone explain what's happening here? Thanks.</p>\n\n<p>Edit: And a follow-up - if I wanted to open the connection as purely read-only without creating any lock file, is there any other method?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1449680794, "post_id": 34184530, "comment_id": 56115694, "body": "Why are you using <code>Substitute</code> rather than VBA&#39;s native <code>Replace</code> function?"}, {"owner": {"reputation": 1302, "user_id": 2204957, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ac5b40d37f3ac5e8ced309b203145048?s=128&d=identicon&r=PG", "display_name": "ajor", "link": "https://stackoverflow.com/users/2204957/ajor"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1449680965, "post_id": 34184530, "comment_id": 56115821, "body": "Honestly? Because I didn&#39;t know it existed ... I have looked in the past (prob years ago) and thought there wasn&#39;t a native function (which I did think was weird!).  That solves my problem, although I am still curious as to why <code>substitute</code> doesn&#39;t work..."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1449681234, "post_id": 34184530, "comment_id": 56116008, "body": "Is your text longer than 32767 characters? That&#39;s the limit for <code>Substitute</code>."}, {"owner": {"reputation": 1302, "user_id": 2204957, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ac5b40d37f3ac5e8ced309b203145048?s=128&d=identicon&r=PG", "display_name": "ajor", "link": "https://stackoverflow.com/users/2204957/ajor"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1449681281, "post_id": 34184530, "comment_id": 56116038, "body": "Ah - yes, it may well be. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "edited": false, "score": 0, "creation_date": 1449680436, "post_id": 34184567, "comment_id": 56115459, "body": "I agree, but tbodyEnd would be an Integer or Long."}, {"owner": {"reputation": 1302, "user_id": 2204957, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ac5b40d37f3ac5e8ced309b203145048?s=128&d=identicon&r=PG", "display_name": "ajor", "link": "https://stackoverflow.com/users/2204957/ajor"}, "edited": false, "score": 0, "creation_date": 1449680478, "post_id": 34184567, "comment_id": 56115489, "body": "Why would this be causing the issue? - That returns a number which is passed into the <code>mid()</code> function. I have tried returning the <code>tbody</code> and it is fine - why would this cause the <code>substitute</code> function not to work?"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1449680516, "post_id": 34184567, "comment_id": 56115511, "body": "Then you need to use <code>CStr()</code> in your method call: <code>tbody = Mid(outputHtml, tbodyStart, CStr(tbodyEnd + 8 - tbodyStart))</code>"}, {"owner": {"reputation": 1302, "user_id": 2204957, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ac5b40d37f3ac5e8ced309b203145048?s=128&d=identicon&r=PG", "display_name": "ajor", "link": "https://stackoverflow.com/users/2204957/ajor"}, "edited": false, "score": 0, "creation_date": 1449680564, "post_id": 34184567, "comment_id": 56115543, "body": "I have tried the suggestion of declaring <code>tbodyStart</code> and <code>tbodyEnd</code> and it has not helped."}, {"owner": {"reputation": 1302, "user_id": 2204957, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ac5b40d37f3ac5e8ced309b203145048?s=128&d=identicon&r=PG", "display_name": "ajor", "link": "https://stackoverflow.com/users/2204957/ajor"}, "edited": false, "score": 0, "creation_date": 1449680622, "post_id": 34184567, "comment_id": 56115587, "body": "As I have explained, the <code>mid()</code> function is operating fine and generating a string. It is the <code>substitute</code> function that is not working.."}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1449680644, "post_id": 34184567, "comment_id": 56115597, "body": "When I run it (after declaring all the missing variables), the problem is with <code>Mid</code>."}, {"owner": {"reputation": 1302, "user_id": 2204957, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ac5b40d37f3ac5e8ced309b203145048?s=128&d=identicon&r=PG", "display_name": "ajor", "link": "https://stackoverflow.com/users/2204957/ajor"}, "edited": false, "score": 0, "creation_date": 1449680690, "post_id": 34184567, "comment_id": 56115632, "body": "Hmm... My problem is still with <code>substitute</code>."}], "tags": [], "owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "is_accepted": false, "score": 1, "last_activity_date": 1449680251, "creation_date": 1449680251, "answer_id": 34184567, "question_id": 34184530, "link": "https://stackoverflow.com/questions/34184530/run-time-1004-error-with-substitute-function-in-vba/34184567#34184567", "title": "Run-time 1004 error with substitute function in VBA", "body": "<p>You have not declared your <code>tbodyEnd</code> variable.  Add this to your code:</p>\n\n<pre><code>Dim tbodyEnd As String\n</code></pre>\n\n<p>Note, you can enable the \"Option Explicit\" to avoid problems like this in the future.  There are two ways to do this:</p>\n\n<ol>\n<li>Add <code>Option Explicit</code> to the top of your module, or</li>\n<li>Go to \"Tools\" > \"Options\" and check \"Require Variable Declaration\" on the \"Editor\" tab.</li>\n</ol>\n\n<p>Doing either of these will result in a more-meaningful warning/error when you have not declared a variable.  It will provide you with the name of the variable, which is helpful.</p>\n"}], "owner": {"reputation": 1302, "user_id": 2204957, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ac5b40d37f3ac5e8ced309b203145048?s=128&d=identicon&r=PG", "display_name": "ajor", "link": "https://stackoverflow.com/users/2204957/ajor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449680251, "creation_date": 1449680122, "question_id": 34184530, "link": "https://stackoverflow.com/questions/34184530/run-time-1004-error-with-substitute-function-in-vba", "title": "Run-time 1004 error with substitute function in VBA", "body": "<p>Any idea why this code is producing a run-time 1004 error?</p>\n\n<pre><code>Dim outputHtml As String, tbody As String\n\noutputHtml = Right(htmlCode, Len(htmlCode) - InStr(htmlCode, \"&lt;div class=\"\"b-campaign-stat-data b-campaign-stat-data_type_custom\"\"&gt;\") + 1)\n\ntbodyStart = InStr(outputHtml, \"&lt;tbody\")\ntbodyEnd = InStr(outputHtml, \"&lt;/tbody&gt;\")\n\ntbody = Mid(outputHtml, tbodyStart, tbodyEnd + 8 - tbodyStart)\n\noutputHtml = WorksheetFunction.Substitute(outputHtml, tbody, \"g\")\n</code></pre>\n\n<p>it is the last line that is tripping it up. I've tried with <code>Application.Substitute</code> as well...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449680065, "post_id": 34184447, "comment_id": 56115218, "body": "<code>strResult = strResult &amp;amp; Mid(strSource, i, 1)</code> looks bad."}], "answers": [{"tags": [], "owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "is_accepted": true, "score": 1, "last_activity_date": 1449680040, "creation_date": 1449680040, "answer_id": 34184496, "question_id": 34184447, "link": "https://stackoverflow.com/questions/34184447/basic-syntax-error-in-visual-basic-excel/34184496#34184496", "title": "basic syntax error in visual basic excel", "body": "<p>You have <code>&amp;amp;</code> which is not valid syntax.  Change it to this:</p>\n\n<pre><code>strResult = strResult &amp; Mid(strSource, i, 1)\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 3130079, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nx8ri.jpg?s=128&g=1", "display_name": "Chelsea-fc", "link": "https://stackoverflow.com/users/3130079/chelsea-fc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 0, "accepted_answer_id": 34184496, "answer_count": 1, "score": 0, "last_activity_date": 1449680040, "creation_date": 1449679914, "last_edit_date": 1531161705, "question_id": 34184447, "link": "https://stackoverflow.com/questions/34184447/basic-syntax-error-in-visual-basic-excel", "title": "basic syntax error in visual basic excel", "body": "<p>I want to Remove Non-Alphanumeric Characters with this Macro. </p>\n\n<p>this simple program gives me a syntax error.</p>\n\n<p>I don't understand this error at all.</p>\n\n<pre><code>Sub CleanAll()\nDim rng As Range\nApplication.ScreenUpdating = False ' Turns off screen updating\nOn Error Resume Next ' Macro will continue if it encounters #N/A\n'Adjust \"Sheet1\" and Range in Line 6\nFor Each rng In Sheets(\"Sheet1\").Range(\"A2:A1629\").Cells\n    rng.Value = AlphaNumericOnly(rng.Value) ' Function call\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n\nFunction AlphaNumericOnly(strSource As String) As String\nDim i As Integer\nDim strResult As String\nOn Error Resume Next\nFor i = 1 To Len(strSource)\nSelect Case Asc(Mid(strSource, i, 1))\n'The numbers below match Char Codes to keep\n Case 48 To 57, 65 To 90, 97 To 122:\n    strResult = strResult &amp;amp; Mid(strSource, i, 1)\nEnd Select\nNext\nAlphaNumericOnly = strResult\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "visio"], "answers": [{"tags": [], "owner": {"reputation": 434, "user_id": 1780613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a5ee090a97a82cef9443b41c30489e?s=128&d=identicon&r=PG", "display_name": "David Parker", "link": "https://stackoverflow.com/users/1780613/david-parker"}, "is_accepted": true, "score": 1, "last_activity_date": 1449690319, "last_edit_date": 1449690319, "creation_date": 1449684932, "answer_id": 34186088, "question_id": 34184210, "link": "https://stackoverflow.com/questions/34184210/connect-visio-document-to-access-database/34186088#34186088", "title": "Connect Visio document to Access database", "body": "<p>This should do it:</p>\n\n<pre><code>strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n    \"User ID=Admin;\" &amp; _\n    \"Data Source=\" &amp; accessFileName &amp; \";\" &amp; _\n    \"Mode=Read;\" &amp; _\n    \"Extended Properties=\"\"\"\";\" &amp; _\n    \"Jet OLEDB:System database=\"\"\"\";\" &amp; _\n    \"Jet OLEDB:Engine Type=6;\" &amp; _\n    \"Jet OLEDB:Database Locking Mode=0;\"\nstrCommand = \"SELECT * FROM `tablename`\"\n</code></pre>\n\n<p>Note the single quotes around table name.</p>\n\n<p>Also, fyi, I have always found the following website very useful : <a href=\"https://connectionstrings.com/\" rel=\"nofollow\">ConnectionStrings</a></p>\n"}], "owner": {"reputation": 133, "user_id": 5262057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/11441638a613930fa7c4d45fd8fae70b?s=128&d=identicon&r=PG&f=1", "display_name": "silicon mode", "link": "https://stackoverflow.com/users/5262057/silicon-mode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 0, "accepted_answer_id": 34186088, "answer_count": 1, "score": 1, "last_activity_date": 1593542346, "creation_date": 1449679349, "last_edit_date": 1593542346, "question_id": 34184210, "link": "https://stackoverflow.com/questions/34184210/connect-visio-document-to-access-database", "title": "Connect Visio document to Access database", "body": "<p>I want to add an Access database to my Visio document. The MSN example shows the string to connect to an Excel document. What would I use to connect to an Access DB?</p>\n\n<p>I am Using:</p>\n\n<blockquote>\n  <p>Microsoft Visio 2013<br>\n  Microsoft Access 2013<br>\n  Microsoft Windows 7 Enterprise.</p>\n</blockquote>\n\n<p>DB location:</p>\n\n<blockquote>\n  <p>C:\\Users\\j.Smith\\Desktop\\access_file.mdb</p>\n</blockquote>\n\n<p>My script:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub AddDataRecordset_Example() \n\n    Dim strConnection As String \n    Dim strCommand As String \n    Dim strOfficePath As String \n    Dim vsoDataRecordset As Visio.DataRecordset \n\n    strOfficePath = Visio.Application.Path     \n    strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" _ \n                   &amp; \"User ID=Admin;\" _ \n                   &amp; \"Data Source=\" + strOfficePath + \"SAMPLES\\1033\\ORGDATA.XLS;\" _ \n                   &amp; \"Mode=Read;\" _ \n                   &amp; \"Extended Properties=\"\"HDR=YES;IMEX=1;MaxScanRows=0;Excel 12.0;\"\";\" _ \n                   &amp; \"Jet OLEDB:Engine Type=34;\" \n\n    strCommand = \"SELECT * FROM [Sheet1$]\" \n\n    Set vsoDataRecordset = ActiveDocument.DataRecordsets.Add(strConnection, strCommand, 0, \"Org Data\") \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "parsing", "file-io", "populate"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449683316, "post_id": 34184153, "comment_id": 56117369, "body": "You need to use <code>ReDim Preserve</code>"}], "answers": [{"tags": [], "owner": {"reputation": 803, "user_id": 4186108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/170ff81c1ed126d7c00aa6aea33fa3bb?s=128&d=identicon&r=PG&f=1", "display_name": "cboden", "link": "https://stackoverflow.com/users/4186108/cboden"}, "is_accepted": false, "score": 0, "last_activity_date": 1449689594, "creation_date": 1449689594, "answer_id": 34187480, "question_id": 34184153, "link": "https://stackoverflow.com/questions/34184153/data-file-not-being-read/34187480#34187480", "title": "Data file not being read", "body": "<p>replace </p>\n\n<pre><code>ReDim Data(N)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>ReDim Preserve Data(N)\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 5183434, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/88c0b0b5f569a06bddf503382976fc6d?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/5183434/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449689594, "creation_date": 1449679178, "last_edit_date": 1449680279, "question_id": 34184153, "link": "https://stackoverflow.com/questions/34184153/data-file-not-being-read", "title": "Data file not being read", "body": "<p>This is my code:</p>\n\n<pre><code>Open \"Data.txt\" For Input As #1\n\nN = 1\n\nWhile Not EOF(1)\n\n  ReDim DataName(N)\n  ReDim Data(N, Max_Time_Point)\n  ReDim line(N)\n\n  Input #1, line(N)\n  DataName(N) = Split(line(N))(0)\n  For j = 1 To Max_Time_Point\n      Data(N, j) = Split(line(N))(j)\n      Debug.Print \"data\", N, j, Data(N, j)\n  Next j\n  N = N + 1\nWend\n</code></pre>\n\n<p>And Data.txt looks like this</p>\n\n<pre><code>First 7 3 1 4 8\nSeconds 3 6 10 5 4\n...\n</code></pre>\n\n<p>My problem is that the debug statement prints out what I expect, that the data is filled into the matrix Data(). But when I exit the loop, Data() only has its last line populated (The last line of data, which for Data.txt just goes to line six). What is going on?</p>\n\n<p>EDIT: I think I've found the problem--I think it's the ReDim statement resetting all values to 0.</p>\n"}, {"tags": ["excel", "vba", "visual-studio-macros"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1449679064, "post_id": 34183993, "comment_id": 56114504, "body": "<code>While Len(Range(&quot;A&quot; &amp; CStr(LSearchRow)).Value) &gt; 0</code> Your loop is testing for something that can end before it reaches bottom of column?"}, {"owner": {"reputation": 1, "user_id": 5660142, "user_type": "registered", "profile_image": "https://graph.facebook.com/997055266999487/picture?type=large", "display_name": "Marcos Pereira", "link": "https://stackoverflow.com/users/5660142/marcos-pereira"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449764982, "post_id": 34183993, "comment_id": 56158425, "body": "findwindow, do you think that the line you state in your comment may be the source of the problem? I tested the version suggested by David Zemens, but his version also does not work when I have the W column sorted in crescent mode. Could you suggest a different approach to this macro?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449765345, "post_id": 34183993, "comment_id": 56158668, "body": "Try using a for loop that will iterate through the entire column?"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1449679443, "creation_date": 1449679443, "answer_id": 34184255, "question_id": 34183993, "link": "https://stackoverflow.com/questions/34183993/excel-vba-macros-does-not-find-matches/34184255#34184255", "title": "Excel VBA macros does not find matches", "body": "<p>This slightly modified version seems to work for me, even if data is not sorted.  You may have a problem with range qualfication, or if you are running it while Sheet2 is active it may not copy anything as expected, etc.</p>\n\n<pre><code>Sub procurarnegociacion()\n\nDim LSearchRow As Integer\nDim LCopyToRow As Integer\nDim source As Worksheet\nDim dest As Worksheet\n\nOn Error GoTo Err_Execute\n\nSet source = Worksheets(\"Sheet1\")   'Modify as needed\nSet dest = Worksheets(\"Sheet2\")     'Modify as needed\n\n'Start search in row 5\nLSearchRow = 5\n\n'Start copying data to row 3 in Sheet2 (row counter variable)\nLCopyToRow = 3\n\nWith source\n    While Len(.Range(\"A\" &amp; CStr(LSearchRow)).Value) &gt; 0\n\n        'If value in column W = 1, copy entire row to Sheet2\n        If .Range(\"W\" &amp; CStr(LSearchRow)).Value = \"5\" Then\n\n            'Select row in Sheet1 to copy\n            .Rows(LSearchRow).EntireRow.Copy _\n                 Destination:=dest.Rows(LCopyToRow)\n\n            'Move counter to next row\n            LCopyToRow = LCopyToRow + 1\n        End If\n\n        LSearchRow = LSearchRow + 1\n    Wend\n    'Position on cell A3\n    Application.CutCopyMode = False\n    .Range(\"A3\").Select\nEnd With\n\nMsgBox \"All data copied.\"\n\nExit Sub\n\nErr_Execute:\nMsgBox \"Error ocurred.\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5660142, "user_type": "registered", "profile_image": "https://graph.facebook.com/997055266999487/picture?type=large", "display_name": "Marcos Pereira", "link": "https://stackoverflow.com/users/5660142/marcos-pereira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449679443, "creation_date": 1449678640, "question_id": 34183993, "link": "https://stackoverflow.com/questions/34183993/excel-vba-macros-does-not-find-matches", "title": "Excel VBA macros does not find matches", "body": "<p>I have a macro set-up in a Excel workbook; its objective is:\n1. In Sheet1, to search a table for a specific value in a column.\n2. If that value is found, then it must copy the entire line to Sheet2.</p>\n\n<pre><code>Sub procurarnegociacion()\n\nDim LSearchRow As Integer\nDim LCopyToRow As Integer\n\nOn Error GoTo Err_Execute\n\n'Start search in row 5\nLSearchRow = 5\n\n'Start copying data to row 3 in Sheet2 (row counter variable)\nLCopyToRow = 3\n\nWhile Len(Range(\"A\" &amp; CStr(LSearchRow)).Value) &gt; 0\n\n    'If value in column W = 1, copy entire row to Sheet2\n    If Range(\"W\" &amp; CStr(LSearchRow)).Value = \"1\" Then\n\n        'Select row in Sheet1 to copy\n        Rows(CStr(LSearchRow) &amp; \":\" &amp; CStr(LSearchRow)).Select\n        Selection.Copy\n\n        'Paste row into Sheet2 in next row\n        Sheets(\"Sheet2\").Select\n        Rows(CStr(LCopyToRow) &amp; \":\" &amp; CStr(LCopyToRow)).Select\n        ActiveSheet.Paste\n\n        'Move counter to next row\n        LCopyToRow = LCopyToRow + 1\n\n        'Go back to Sheet1 to continue searching\n        Sheets(\"Sheet1\").Select\n\n    End If\n\n    LSearchRow = LSearchRow + 1\n\n\nWend\n\n'Position on cell A3\nApplication.CutCopyMode = False\nRange(\"A3\").Select\n\nMsgBox \"All data copied.\"\n\nExit Sub\n\nErr_Execute:\nMsgBox \"Error ocurred.\"\n\nEnd Sub\n</code></pre>\n\n<p>But here is the problem: imagine I search for value \"5\" and I only have 1-5 values in that column W.\nThe macro only works if I have all the 5's sorted out at the beginning of the table (descendent sort).\nIf I have the W column in crescent sort, with all the 1's first, then it does not copy any line to Sheet2. It gives the message All data copied.\", but then no line is copied on the Sheet2.</p>\n\n<p>Why is that?\nCan you help me with this matter?</p>\n"}, {"tags": ["excel", "vba", "validation", "dynamic", "range"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1449687745, "post_id": 34183812, "comment_id": 56120129, "body": "Did you select in your Data Validation to &quot;Ignore Blank&quot;? If this does not resolve you problem can you provide sample data for your <code>EmployeeDatabase!$G:$I</code> as it is not clear to me what your are doing counting non empty cells through 3 columns."}, {"owner": {"reputation": 111, "user_id": 5660083, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8d44403381356215896ae1fd0accb97e?s=128&d=identicon&r=PG&f=1", "display_name": "Rich", "link": "https://stackoverflow.com/users/5660083/rich"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1449761021, "post_id": 34183812, "comment_id": 56155577, "body": "Here is a file as an example of issue I encounter: <a href=\"https://drive.google.com/file/d/0ByUxX8rRDJttdFA1NGJpNUZDYms/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0ByUxX8rRDJttdFA1NGJpNUZDYms/&hellip;</a>  In this case, there are not extra spaces, but the combobox doesn&#39;t pick up all the data in the dynamic range even though the data validation directly next to it DOES pick up all the information."}], "owner": {"reputation": 111, "user_id": 5660083, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8d44403381356215896ae1fd0accb97e?s=128&d=identicon&r=PG&f=1", "display_name": "Rich", "link": "https://stackoverflow.com/users/5660083/rich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 362, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449678501, "creation_date": 1449678123, "last_edit_date": 1449678501, "question_id": 34183812, "link": "https://stackoverflow.com/questions/34183812/excel-data-validation-drop-down-list-has-trailing-blanks-on-a-dynamic-named-ran", "title": "Excel: Data Validation drop-down list has trailing blanks on a Dynamic Named Range", "body": "<p>I am trying to make a combobox inside a userform.  But to make things even simpler, I just picked a random cell and tried out a data validation on a dynamic range I made and named.</p>\n\n<p>For instance:\nName of Range = Test</p>\n\n<p>Random information in 3 Columns (G, H, and I)</p>\n\n<p>a   1   jef</p>\n\n<p>b   2   don</p>\n\n<p>c   3   tod</p>\n\n<p>d   4   albert</p>\n\n<p>When I go to data validation, select \"List\", and then input my range as:\nTest</p>\n\n<p>I get 11 trailing blanks in my drop-down list???  </p>\n\n<p>Here is my dynamic range formula that I named Test:\n=OFFSET(EmployeeDatabase!$G$3, 0, 0, COUNTA(EmployeeDatabase!$G:$I), 1)</p>\n\n<p>The combobox works the exact same as my data validation.  Both have those 11 trailing blanks?</p>\n\n<p>I have also tried:\n=OFFSET(EmployeeDatabase!$G$3, 0, 0, COUNTA(EmployeeDatabase!$G3:I500), 1)</p>\n\n<p>Same result.</p>\n\n<p>Does anyone see what I'm doing wrong?</p>\n\n<p>Edit: Also wanted to mention that the longer the list, the more trailing blanks that show up.</p>\n"}, {"tags": ["vba", "excel", "if-statement", "do-while"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1449677534, "post_id": 34183538, "comment_id": 56113366, "body": "One thing I see as a potential problem is the unqualified <code>Cells(x, &quot;D&quot;)</code> statement. Place the worksheet in front of it like this: <code>Sheets(&quot;Input Tool (Auction Team)&quot;).Cells(x,&quot;D&quot;)</code>, whatever <i>specific</i> sheet you want to refer to. Leaving it as makes it refer to whatever sheet is active at the time the code runs, which may not be want what you desire."}, {"owner": {"reputation": 21, "user_id": 5659746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da12750ba0155d282c92627f0bd770fc?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Anderson", "link": "https://stackoverflow.com/users/5659746/rob-anderson"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1449678889, "post_id": 34183538, "comment_id": 56114373, "body": "Awesome. That was it. Appreciate your help"}, {"owner": {"reputation": 1300, "user_id": 7602468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3XKX5.gif?s=128&g=1", "display_name": "p._phidot_", "link": "https://stackoverflow.com/users/7602468/p-phidot"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1532458673, "post_id": 34183538, "comment_id": 89980542, "body": "@Scott Holtzman kindly put the answer in the answer tab. So we can remove this Q from SO unanswered list. (:"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1300, "user_id": 7602468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3XKX5.gif?s=128&g=1", "display_name": "p._phidot_", "link": "https://stackoverflow.com/users/7602468/p-phidot"}, "edited": false, "score": 1, "creation_date": 1532468267, "post_id": 34183538, "comment_id": 89984850, "body": "@p._phidot_ - done"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1532468260, "creation_date": 1532468260, "answer_id": 51507894, "question_id": 34183538, "link": "https://stackoverflow.com/questions/34183538/do-while-loop-nested-with-if-statement-vba-only-prints-first-true-value-and-st/51507894#51507894", "title": "Do while loop nested with if statement vba only prints first &quot;TRUE&quot; value and stops", "body": "<p>Qualify the unqualified object references with their parent.</p>\n\n<p>For example, I see 'Cells(x, \"D\")'. Qualify that range to the parent worksheet like so:</p>\n\n<pre><code>Sheets(\"Input Tool (Auction Team)\").Cells(x,\"D\")\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5659746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da12750ba0155d282c92627f0bd770fc?s=128&d=identicon&r=PG&f=1", "display_name": "Rob Anderson", "link": "https://stackoverflow.com/users/5659746/rob-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1481, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1532468260, "creation_date": 1449677359, "question_id": 34183538, "link": "https://stackoverflow.com/questions/34183538/do-while-loop-nested-with-if-statement-vba-only-prints-first-true-value-and-st", "title": "Do while loop nested with if statement vba only prints first &quot;TRUE&quot; value and stops", "body": "<p>I am trying to create a Do While loop with an if statement in bedded within it. Depending on the TRUE/FALSE value of the If statement, it could either enter into another (sub) Do While loop or just loop around back to the first one and start all over again.</p>\n\n<p>My problem is that once the If statement returns a \"TRUE\" value, the macro executes the result but then stops the 1st overlying Do While loop that I want to continue. (Basically it does not generate another loop for x+1 once there is a TRUE value in the If Statement)</p>\n\n<p>Thank you ahead of time for your help</p>\n\n<pre><code>'x is row in input tab\nDim x As Integer\n'z is column in input tab\nDim z As Integer\n\nx = 9\nDo While x &lt; 59\nIf Sheets(\"Input Tool (Auction Team)\").Cells(x, \"C\") = \"N\" And Cells(x, \"D\") = \"Yes\" Then\n\n    'insert row and add values\n    Sheets(\"Round Results (Auction Team)\").Range(\"C13\").EntireRow.Insert\n    z = 5\n\n    Do While z &lt; 19\n\n    Sheets(\"Input Tool (Auction Team)\").Cells(x, z).Copy\n    Sheets(\"Round Results (Auction Team)\").Cells(13, z - 2).PasteSpecial Paste:=xlPasteValues\n    Sheets(\"Round Results (Auction Team)\").Cells(14, z - 2).Copy\n    Sheets(\"Round Results (Auction Team)\").Cells(13, z - 2).PasteSpecial Paste:=xlPasteFormats\n    Sheets(\"Round Results (Auction Team)\").Cells(14, 2).Copy Cells(13, 2)\n\n    z = z + 1\n\n    Loop                  \nElse \nEnd If\nx = x + 1\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sorting", "graphing"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1449683397, "post_id": 34182355, "comment_id": 56117427, "body": "Resize the array of data and fill in blank values where necessary, so that each series has the same number of data points. Probably not the easiest to implement, given Excel/VBA limitations of using Arrays.  Can you show the code for function <code>bubbleSortData</code>?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1449683525, "post_id": 34182355, "comment_id": 56117519, "body": "Alternatively, create it as a single series of data and apply the coloring format selectively to each data point. Again, probably not <i>easy</i> to do considering the sorting that needs to take place and ensuring they remain mapped to the right color. Using <code>Dictionary</code> or <code>Collection</code> in this case is probably better than arrays."}, {"owner": {"reputation": 432, "user_id": 4976543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKE0A.jpg?s=128&g=1", "display_name": "Branden Keck", "link": "https://stackoverflow.com/users/4976543/branden-keck"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1449683685, "post_id": 34182355, "comment_id": 56117630, "body": "@DavidZemens I added the code for the sort, but yes I think you are correct in that the options you listed are probably the only ones I have to go on.  Thank you for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 432, "user_id": 4976543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKE0A.jpg?s=128&g=1", "display_name": "Branden Keck", "link": "https://stackoverflow.com/users/4976543/branden-keck"}, "is_accepted": true, "score": 0, "last_activity_date": 1450291795, "creation_date": 1450291795, "answer_id": 34319840, "question_id": 34182355, "link": "https://stackoverflow.com/questions/34182355/excel-vba-create-a-clustered-column-chart-that-sorts-based-on-value-not-series/34319840#34319840", "title": "Excel VBA: Create a clustered column chart that sorts based on value not series?", "body": "<p>After a lot of searching, I found a combination of solutions that worked for me, mostly drawing information from this link: <a href=\"http://peltiertech.com/chart-with-a-dual-category-axis/\" rel=\"nofollow noreferrer\">http://peltiertech.com/chart-with-a-dual-category-axis/</a></p>\n\n<p>...As well as from a variety of StackOverflow posts indicating that doing this is impossible programmatically and must be done through the worksheet, which has worked for me.  I filled in worksheet cells like was done in the above link, except with visual basic.  Then, after the data was graphed, I hid the worksheet.  This works for me because the worksheets are cleared every time the user starts over with a new data set.  Here is my code:</p>\n\n<pre><code>Sub Distribution()\nDim runningTotal, seriesNumber, sheetName\n\nseriesNumber = 1\nrunningTotal = 2\n\ncurrDist = currDist + 1\nsheetName = \"DistData\" + CStr(currDist)\n\nActiveWorkbook.Sheets.Add\nActiveSheet.Move After:=Sheets(ActiveWorkbook.Sheets.count)\nActiveSheet.Name = sheetName\nActiveSheet.Visible = True\n\nFor j = 0 To UBound(chartLabels)\n    If IsEmpty(chartLabels(j)) Then Exit For\n    Erase xval\n    Erase yval\n    ReDim Preserve xval(0 To 0)\n    ReDim Preserve yval(0 To 0)\n    xval(0) = chartData(0, j, 0)\n    yval(0) = chartData(2, j, 0)\n\n    For i = 0 To UBound(chartData, 3) - 1\n        If Not IsEmpty(chartData(2, j, i + 1)) Then\n            ReDim Preserve xval(0 To i + 1)\n            ReDim Preserve yval(0 To i + 1)\n            xval(i + 1) = chartData(0, j, i + 1)\n            yval(i + 1) = chartData(2, j, i + 1)\n        End If\n    Next\n\n    Call bubblesortLosses(j, UBound(xval))\n\n    Sheets(sheetName).Select\n\n    Cells(1, seriesNumber + 2) = chartLabels(j)\n    Cells(runningTotal, 1) = chartLabels(j)\n\n    For k = 0 To UBound(xval)\n        Cells(runningTotal, 2) = xval(k)\n        Cells(runningTotal, seriesNumber + 2) = yval(k)\n        runningTotal = runningTotal + 1\n    Next\n\n    seriesNumber = seriesNumber + 1\n\nNext\n\nActiveWorkbook.Charts.Add\nActiveChart.ChartArea.Select\nWith ActiveChart\n    .ChartType = xlColumnStacked\n    .HasTitle = True\n    .ChartTitle.Text = \"Ordered Distribution Graph\"\n    .Axes(xlCategory).TickLabels.MultiLevel = True\n    .Axes(xlCategory).HasTitle = True\n    .Axes(xlCategory).AxisTitle.Characters.Text = \"Item\"\n    .Axes(xlCategory).CategoryType = xlCategoryScale\n    .Axes(xlValue).HasTitle = True\n    .Axes(xlValue).AxisTitle.Characters.Text = \"Total\"\n    .Legend.Position = xlLegendPositionBottom\nEnd With\n\nActiveSheet.Move After:=Sheets(ActiveWorkbook.Sheets.count)\nActiveSheet.Name = \"Distribution \" + CStr(currDist)\n\nActiveChart.ChartGroups(1).GapWidth = 10\nActiveChart.ChartGroups(1).Overlap = 100\n\nSheets(sheetName).Visible = False\nSheets(ActiveWorkbook.Sheets.count).Activate\n\nEnd Sub\n</code></pre>\n\n<p>The bubblesort subroutine is the same as was used in the question.  The final result for one of my test runs is here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MsQgf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MsQgf.png\" alt=\"enter image description here\"></a></p>\n\n<p>Item number is listed, but the category labels are cut out of the picture due to confidentiality.  They would read similar to \"Series 1\", \"Series 2\", and \"Series 3\"</p>\n"}], "owner": {"reputation": 432, "user_id": 4976543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKE0A.jpg?s=128&g=1", "display_name": "Branden Keck", "link": "https://stackoverflow.com/users/4976543/branden-keck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1511, "favorite_count": 0, "accepted_answer_id": 34319840, "answer_count": 1, "score": 0, "last_activity_date": 1450291795, "creation_date": 1449674189, "last_edit_date": 1449683580, "question_id": 34182355, "link": "https://stackoverflow.com/questions/34182355/excel-vba-create-a-clustered-column-chart-that-sorts-based-on-value-not-series", "title": "Excel VBA: Create a clustered column chart that sorts based on value not series?", "body": "<p>Here is my issue:  I have a user-specified number of data sets that I want to plot on a clustered column graph.  I am creating the chart in visual basic and I am adding the data sets as separate series, so that they are distinguishable by color and have different titles on the legend:</p>\n\n<pre><code>ActiveWorkbook.Charts.Add 'all of this just adds a new chart\nActiveChart.ChartArea.Select\nWith ActiveChart\n    .ChartType = xlColumnClustered\n    .HasTitle = True\n    .ChartTitle.Text = \"Ordered Distribution Graph\"\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Item\"\n    .Axes(xlCategory, xlPrimary).CategoryType = xlCategoryScale\n    .Axes(xlValue, xlPrimary).HasTitle = True\n    .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Total\"\n    .Legend.Position = xlLegendPositionBottom\nEnd With\n\nActiveSheet.Move After:=Sheets(ActiveWorkbook.Sheets.count)\nActiveSheet.Name = \"Distribution Chart\"\n\nFor j = 0 To UBound(chartLabels) 'here is where I handle the data based on global variables\n    If IsEmpty(chartLabels(j)) Then Exit For\n    Erase xval\n    Erase yval\n    ReDim Preserve xval(0 To 0)\n    ReDim Preserve yval(0 To 0)\n    xval(0) = chartData(0, j, 0)\n    yval(0) = chartData(2, j, 0)\n\n    For i = 0 To UBound(chartData, 3) - 1\n        If Not IsEmpty(chartData(2, j, i + 1)) Then\n            ReDim Preserve xval(0 To i + 1)\n            ReDim Preserve yval(0 To i + 1)\n            xval(i + 1) = chartData(0, j, i + 1)\n            yval(i + 1) = chartData(2, j, i + 1)\n        End If\n    Next\n\n    Call bubblesortData(j, UBound(xval)) 'separate sort function\n\n    ActiveChart.SeriesCollection.NewSeries 'plots each series\n    ActiveChart.SeriesCollection(j + 1).XValues = xval\n    ActiveChart.SeriesCollection(j + 1).Values = yval\n    ActiveChart.SeriesCollection(j + 1).Name = main.chartLabels(j)\n    ActiveChart.ChartGroups(1).GapWidth = 10\n    ActiveChart.ChartGroups(1).Overlap = -10\nNext\n\nSheets(ActiveWorkbook.Sheets.count).Activate\n</code></pre>\n\n<p>Currently, each set of data is sorted using the <strong>bubblesortData(setNumber, numberOfDataPoints)</strong> subroutine (xval and yval are global arrays):</p>\n\n<pre><code>Sub bubblesortLosses(b As Variant, tot As Variant)\nDim changed As Integer, temp As Variant\n\nDo\nchanged = 0\n    For i = 0 To tot - 1\n    If Not IsEmpty(xval(i)) Then\n        If yval(i) &gt; yval(i + 1) Then\n            temp = xval(i)\n            xval(i) = xval(i + 1)\n            xval(i + 1) = temp\n            temp = yval(i)\n            yval(i) = yval(i + 1)\n            yval(i + 1) = temp\n            changed = 1\n        End If\n    End If\n    Next\n\nLoop Until changed = 0\nEnd Sub\n</code></pre>\n\n<p>This is working fine, but results in something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2TDaO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2TDaO.png\" alt=\"ExampleChart\"></a></p>\n\n<p>Each set is ordered due to my sort, but I would like <strong>all</strong> of the data to be sorted based on y-axis value.  I cannot think of a way to accomplish this while also keeping the data separated by series.  Is there a way to display x-axis values based on corresponding y-axis value and not based on series position??</p>\n"}, {"tags": ["excel", "vba", "function", "excel-formula"], "comments": [{"owner": {"reputation": 533, "user_id": 2272319, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0740fa6f391d29c1fe797c22c6102c13?s=128&d=identicon&r=PG", "display_name": "Conjak", "link": "https://stackoverflow.com/users/2272319/conjak"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1449673251, "post_id": 34181446, "comment_id": 56110203, "body": "It was a hidden sheet! :) Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 533, "user_id": 2272319, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0740fa6f391d29c1fe797c22c6102c13?s=128&d=identicon&r=PG", "display_name": "Conjak", "link": "https://stackoverflow.com/users/2272319/conjak"}, "edited": false, "score": 0, "creation_date": 1449672950, "post_id": 34181669, "comment_id": 56109977, "body": "I got two  sheet&#39;s, 1st named: SegmentID (2), and the other named Sheet1, which is empty."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 533, "user_id": 2272319, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0740fa6f391d29c1fe797c22c6102c13?s=128&d=identicon&r=PG", "display_name": "Conjak", "link": "https://stackoverflow.com/users/2272319/conjak"}, "edited": false, "score": 0, "creation_date": 1449673075, "post_id": 34181669, "comment_id": 56110087, "body": "Do you have any add-ins? Or perhaps it&#39;s a hidden sheet?"}, {"owner": {"reputation": 533, "user_id": 2272319, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0740fa6f391d29c1fe797c22c6102c13?s=128&d=identicon&r=PG", "display_name": "Conjak", "link": "https://stackoverflow.com/users/2272319/conjak"}, "edited": false, "score": 0, "creation_date": 1449673271, "post_id": 34181669, "comment_id": 56110216, "body": "It was a hidden sheet! Thanks!"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1449672332, "creation_date": 1449672332, "answer_id": 34181669, "question_id": 34181446, "link": "https://stackoverflow.com/questions/34181446/how-to-found-custom-function-in-excel/34181669#34181669", "title": "How to found custom function in excel", "body": "<p>If you have more than 1 sheet in a workbook, and you want to reference a cell in another sheet - you have to use the sheet name too.</p>\n\n<p>So, if you wanted to add two cells together on different sheets, but they have thee same address - how will Excel know which sheet you mean?</p>\n\n<p><code>=A1+'Other Sheet'!A1</code></p>\n\n<p>This will add A1 on the active sheet, and A1 on the sheet called \"Other Sheet\"</p>\n\n<p>In your example, <code>Function!R15</code> refers to the cell R15 on the sheet called \"Function\".</p>\n\n<p>I imagine in that cell (R15) there is a formula of <code>=SUM(K15:P15)</code> which is why you're getting that upon evaluating.</p>\n"}], "owner": {"reputation": 533, "user_id": 2272319, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0740fa6f391d29c1fe797c22c6102c13?s=128&d=identicon&r=PG", "display_name": "Conjak", "link": "https://stackoverflow.com/users/2272319/conjak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449672332, "creation_date": 1449671725, "question_id": 34181446, "link": "https://stackoverflow.com/questions/34181446/how-to-found-custom-function-in-excel", "title": "How to found custom function in excel", "body": "<p>I dont know if its a custom function or custom formula or whatever. Honestly I dont know much about excel at all.</p>\n\n<p>I need to translate this formula/function to code, no biggie, I thought. But can't find it anywhere, I need to figure out the calculation.</p>\n\n<p><a href=\"https://i.stack.imgur.com/nXhx4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nXhx4.png\" alt=\"enter image description here\"></a></p>\n\n<p>At least I know </p>\n\n<pre><code>=\"Segment \"&amp;\n</code></pre>\n\n<p>Segment is a string, nothing weird and the ampersand concatenate the string with a function, but the:</p>\n\n<pre><code>Function!R15\n</code></pre>\n\n<p>I'm clueless here,</p>\n\n<p>And if I \"Step In\" I get</p>\n\n<pre><code>SUM(K15:P15)\n</code></pre>\n\n<p>Those cell's are empty btw.</p>\n\n<p>I'm starting to think that \"Function\" is a custom Visual Basic Function, but I'm  left clueless, here how to figure out the calculation.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 4, "creation_date": 1449671665, "post_id": 34181236, "comment_id": 56108916, "body": "Excel only allows 15 digits of precision for number values. You have more than that which is why you get the 0000 at the end. What does this numeric data represent? Do you actually intend to do calculations with it?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1449682318, "post_id": 34181236, "comment_id": 56116770, "body": "If you will frequently be performing mathematical operations in Excel on values that exceed Excel&#39;s limit of precision, search the Internet for <b>x-numbers</b> add-in.  It has many functions implemented for these values."}], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 1248624, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4317bd99883c1320a04a08d0b06e936e?s=128&d=identicon&r=PG", "display_name": "AG10", "link": "https://stackoverflow.com/users/1248624/ag10"}, "edited": false, "score": 0, "creation_date": 1449672031, "post_id": 34181336, "comment_id": 56109224, "body": "Hi, I changed the variable declarations and up until CovertToInteger = finalNumber, it seems like the message box is showing the converted string as double. But when I assign ConvertToInteger = finalNumber, I get failure to convert. I showed my edited code above."}, {"owner": {"reputation": 239, "user_id": 1248624, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4317bd99883c1320a04a08d0b06e936e?s=128&d=identicon&r=PG", "display_name": "AG10", "link": "https://stackoverflow.com/users/1248624/ag10"}, "edited": false, "score": 0, "creation_date": 1449672300, "post_id": 34181336, "comment_id": 56109433, "body": "I changed to Function ConvertToInteger (v1 as Variant) As Double and the code seems to work but I still get 0 not 1 at the end of the number."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 239, "user_id": 1248624, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4317bd99883c1320a04a08d0b06e936e?s=128&d=identicon&r=PG", "display_name": "AG10", "link": "https://stackoverflow.com/users/1248624/ag10"}, "edited": false, "score": 0, "creation_date": 1449672322, "post_id": 34181336, "comment_id": 56109455, "body": "Yes, I think that is due to limitations of Excel&#39;s data precision, as @Rory mentioned in comments."}, {"owner": {"reputation": 239, "user_id": 1248624, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4317bd99883c1320a04a08d0b06e936e?s=128&d=identicon&r=PG", "display_name": "AG10", "link": "https://stackoverflow.com/users/1248624/ag10"}, "edited": false, "score": 1, "creation_date": 1449680311, "post_id": 34181336, "comment_id": 56115377, "body": "Thank you so much for taking the time to clarify and explain the scenario for me. I am very grateful and appreciative of your time! I am still getting familiar with how to utilize VBA to make my spreadsheets more flexible and robust and learned from this question/your response."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 4, "last_activity_date": 1449682579, "last_edit_date": 1592644375, "creation_date": 1449671470, "answer_id": 34181336, "question_id": 34181236, "link": "https://stackoverflow.com/questions/34181236/cant-convert-string-to-an-integer-in-vba-or-by-excel-formulas-failure-to-conve/34181336#34181336", "title": "Can&#39;t convert string to an integer in VBA or by Excel formulas (failure to convert or wrong number even if string is all numeric)", "body": "<p>You can identify this error (overflow) in your error-handling block using the <code>Description</code> property of the intrinsic <code>Err</code> object:</p>\n<pre><code>100:\nMsgBox &quot;Failed to convert &quot;&quot;&quot; &amp; v1 &amp; &quot;&quot;&quot; to an integer.&quot; &amp; vbCrLf &amp; Err.Description, , &quot;Aborting - Failed Conversion&quot; \nEnd\n</code></pre>\n<p>As you have it implemented, the error-handler <em>works</em>, but does not display the useful information for debugging the problem.</p>\n<p>Once you have identified as a overflow error, note that the value <code>105501008962100001</code> exceeds the size allowed for Integer or Long data type. Declare it as a <code>Double</code> instead.</p>\n<pre><code>Dim tempArray As Variant\nDim arraySize As Double\narraySize = (Len(v1) - 1)\nReDim tempArray(arraySize)\n</code></pre>\n<p><strong>Note limitations in Excel of using large numbers.</strong> Your data may exceed this.</p>\n<h1>For handling very large numbers, see:</h1>\n<p><a href=\"https://stackoverflow.com/questions/1840661/handling-numbers-larger-than-long-in-vba\">Handling numbers larger than Long in VBA</a></p>\n<p>And subsequently:</p>\n<p><a href=\"http://tushar-mehta.com/misc_tutorials/project_euler/LargeNumberArithmetic.htm\" rel=\"nofollow noreferrer\">http://tushar-mehta.com/misc_tutorials/project_euler/LargeNumberArithmetic.htm</a></p>\n<p>Here is a simple example of adding two large numbers. You will be able to use the <code>cLarge</code> class to perform arithmetic operations against these &quot;numbers&quot; (which are actually strings). Your functions will need to change type declaration from <code>Long/Double</code> to <code>String</code>.</p>\n<p>In a standard module, do:</p>\n<pre><code>Sub foo()\nDim lrg As New cLarge\n\nMsgBox lrg.LargeAdd(&quot;105501008962100001&quot;, &quot;205501231962100003&quot;)\nEnd Sub\n</code></pre>\n<p>Create a class module named <code>cLarge</code> and in that module, put the following code:</p>\n<pre><code>'### Class module for adding very large (&gt; Decimal precision) values\n'    http://tushar-mehta.com/misc_tutorials/project_euler/LargeNumberArithmetic.htm\n'\n'    Modified by David Zemens, 9 December 2015\nOption Explicit\n\nPublic cDecMax As Variant, cDecMaxLen As Integer, cSqrDecMaxLen As Integer\nPrivate pVal As String\n\nPublic Sub Class_Initialize()\n    Static Initialized As Boolean\n    If Initialized Then Exit Sub\n    Initialized = True\n    cDecMax = _\n        CDec(Replace(&quot;79,228,162,514,264,337,593,543,950,335&quot;, &quot;,&quot;, &quot;&quot;))\n            'this is 2^96-1, the limit on Decimal precision data in Excel/VBA\n    cDecMaxLen = Len(cDecMax) - 1\n    cSqrDecMaxLen = cDecMaxLen \\ 2\nEnd Sub\n\n\nFunction Ceil(X As Single) As Long\n    If X &lt; 0 Then Ceil = Fix(X) Else Ceil = -Int(-X)\nEnd Function\n\nPrivate Function addByParts(ByVal Nbr1 As String, ByVal Nbr2 As String) _\n    As String\n    Dim NbrChunks As Integer\n    If Len(Nbr1) &gt; Len(Nbr2) Then _\n        Nbr2 = String(Len(Nbr1) - Len(Nbr2), &quot;0&quot;) &amp; Nbr2 _\n    Else _\n        Nbr1 = String(Len(Nbr2) - Len(Nbr1), &quot;0&quot;) &amp; Nbr1\n    NbrChunks = Ceil(Len(Nbr1) / cDecMaxLen)\n    Dim I As Integer, OverflowDigit As String, Rslt As String\n    OverflowDigit = &quot;0&quot;\n    For I = NbrChunks - 1 To 0 Step -1\n        Dim Nbr1Part As String\n        Nbr1Part = Mid(Nbr1, I * cDecMaxLen + 1, cDecMaxLen)\n        Rslt = CStr(CDec(Nbr1Part) _\n            + CDec(Mid(Nbr2, I * cDecMaxLen + 1, cDecMaxLen)) _\n            + CDec(OverflowDigit))\n        If Len(Rslt) &lt; Len(Nbr1Part) Then\n            Rslt = String(Len(Nbr1Part) - Len(Rslt), &quot;0&quot;) &amp; Rslt\n            OverflowDigit = &quot;0&quot;\n        ElseIf I = 0 Then\n        ElseIf Len(Rslt) &gt; Len(Nbr1Part) Then\n            OverflowDigit = Left(Rslt, 1): Rslt = Right(Rslt, Len(Rslt) - 1)\n        Else\n            OverflowDigit = &quot;0&quot;\n            End If\n        addByParts = Rslt &amp; addByParts\n        Next I\nEnd Function\n\nFunction LargeAdd(ByVal Nbr1 As String, ByVal Nbr2 As String) As String\n    'Initialize\n    If Len(Nbr1) &lt;= cDecMaxLen And Len(Nbr2) &lt;= cDecMaxLen Then\n        LargeAdd = CStr(CDec(Nbr1) + CDec(Nbr2))\n        Exit Function\n        End If\n    If Len(Nbr1) &gt; cDecMaxLen Then LargeAdd = addByParts(Nbr1, Nbr2) _\n    Else LargeAdd = addByParts(Nbr2, Nbr1)\nEnd Function\n</code></pre>\n<p>So, long story short, you can't actually <em>use</em> these &quot;numbers&quot; and you strictly cannot &quot;convert&quot; them to Integer/Long values. You need to use a custom class implementation to perform the maths against the string values.</p>\n"}], "owner": {"reputation": 239, "user_id": 1248624, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4317bd99883c1320a04a08d0b06e936e?s=128&d=identicon&r=PG", "display_name": "AG10", "link": "https://stackoverflow.com/users/1248624/ag10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 0, "accepted_answer_id": 34181336, "answer_count": 1, "score": 2, "last_activity_date": 1449682579, "creation_date": 1449671223, "last_edit_date": 1449672162, "question_id": 34181236, "link": "https://stackoverflow.com/questions/34181236/cant-convert-string-to-an-integer-in-vba-or-by-excel-formulas-failure-to-conve", "title": "Can&#39;t convert string to an integer in VBA or by Excel formulas (failure to convert or wrong number even if string is all numeric)", "body": "<p>I have a string inside a cell: 105501008962100001</p>\n\n<p>Cell A10 contains this text.</p>\n\n<p>When I run ISTEXT(A10) it returns TRUE.</p>\n\n<p>I used VALUE(A10) but it returned 105501008962100000</p>\n\n<p>When I multiply A10 * 1, I get 105501008962100000 as well.</p>\n\n<p>I have also created a VBA function to convert to integer but when I create checkpoints, it creates an error saying that there is a failure to convert to integer.</p>\n\n<p>I do not understand why I cannot convert this string inside this cell to an integer when it is composed entirely of numbers. This number is imported from a CSV file.</p>\n\n<pre><code>Function ConvertToInteger(v1 As Variant) As Integer\nOn Error GoTo 100:\n\n    'MsgBox Len(v1)\n\n    Dim tempArray As Variant\n    Dim arraySize As Integer\n    arraySize = (Len(v1) - 1)\n    ReDim tempArray(arraySize)\n\n    Dim tempText As String\n    Dim finalNumber As Integer\n    Dim i As Integer\n\n    For i = 1 To Len(v1)\n        tempArray(i - 1) = CStr(Mid(v1, i, 1))\n    Next\n\n    tempText = Join(tempArray, \"\")\n    tempText = CStr(tempText)\n\n    'MsgBox tempText\n\n     finalNumber = CInt(tempText)\n\n     MsgBox finalNumber\n\n    'ConvertToInteger = finalNumber\n\nExit Function\n100:\n    MsgBox \"Failed to convert \"\"\" &amp; v1 &amp; \"\"\" to an integer.\", , \"Aborting - Failed Conversion\"\n    End\nEnd Function\n</code></pre>\n\n<p>I made modifications to the code but still get the 0 at the end not 1 in the number:</p>\n\n<pre><code>Function ConvertToInteger(v1 As Variant) As Double\n\n    Dim tempArray As Variant\n    Dim arraySize As Double\n    arraySize = (Len(v1) - 1)\n    ReDim tempArray(arraySize)\n\n    Dim tempText As String\n    Dim finalNumber As Double\n    Dim i As Integer\n\n    For i = 1 To Len(v1)\n        tempArray(i - 1) = CStr(Mid(v1, i, 1))\n    Next\n\n    tempText = Join(tempArray, \"\")\n    tempText = CStr(tempText)\n\n    finalNumber = CDbl(tempText)\n\n    MsgBox finalNumber\n\n    'I get an error here when assigning finalNumber to ConvertToInteger\n    'ConvertToInteger = finalNumber\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "edited": false, "score": 0, "creation_date": 1449671191, "post_id": 34180922, "comment_id": 56108556, "body": "I also updated uRng to:     <code>Dim uRng As Range: Set uRng = Union(aRng, bRng, cRng, dRng, eRng, fRng)</code>  I try to access it as:      <code>MsgBox uRng2.Areas(1).Cells(2, 1)</code> or <code>MsgBox uRng2.Areas(2).Cells(2, 1)</code> or <code>MsgBox uRng2.Areas(3).Cells(2, 1)</code>  and it works fine.... anything after area 3 (which I figured there were 6 areas) causes the application defined error."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1449671750, "post_id": 34180922, "comment_id": 56108997, "body": "Do you just want an array of the values from those columns? If so, you don&#39;t want <code>Union</code>, you want <code>Index</code>."}, {"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1449672093, "post_id": 34180922, "comment_id": 56109275, "body": "Yes, @Rory, I am looking for an array with those values so that I can loop through it update a few of the values, add a column and then copy that array to a new sheet...  What would it look like using index?  I do not want to loop through the entire range and apply each cell to the array unless I truly have to."}], "answers": [{"comments": [{"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "edited": false, "score": 0, "creation_date": 1449672397, "post_id": 34181655, "comment_id": 56109517, "body": "So would I have an array for each of the ranges at the end of the function?  If so how can I make them one array?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "edited": false, "score": 0, "creation_date": 1449672586, "post_id": 34181655, "comment_id": 56109694, "body": "No - that produces <b>one</b> array (<code>v</code>) with the values you want. I was explaining how it is constructed."}, {"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "edited": false, "score": 0, "creation_date": 1449672696, "post_id": 34181655, "comment_id": 56109779, "body": "I ran it and noticed that... sorry for the extraneous question!  I suspect your solution is the correct one I am just confused as to how to get it to capture all the data.  I only get three of the column headers and then none of the data the array is empty after that... Here is the result:     <a href=\"http://imgur.com/12wYeNn\" rel=\"nofollow noreferrer\">Result Array</a>   There is definitely data in those columns."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "edited": false, "score": 1, "creation_date": 1449672790, "post_id": 34181655, "comment_id": 56109856, "body": "Did you qualify the range with the correct book/sheet in your actual code? (I just edited the answer to include that)"}, {"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "edited": false, "score": 0, "creation_date": 1449673088, "post_id": 34181655, "comment_id": 56110093, "body": "Thanks so much you are a lifesaver... I have marked this as the answer."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 3, "last_activity_date": 1449672837, "last_edit_date": 1449672837, "creation_date": 1449672300, "answer_id": 34181655, "question_id": 34180922, "link": "https://stackoverflow.com/questions/34180922/what-is-the-best-way-to-create-an-array-of-the-values-in-non-contiguous-ranges/34181655#34181655", "title": "What is the best way to create an array of the &quot;values&quot; in non-contiguous ranges in excel?", "body": "<p>Since you only want an array of the values, you can use <code>Index</code> with a couple of array arguments:</p>\n\n<pre><code>Dim v\nWith wbkFirstfile.Sheets(1).Range(\"H2:W\" &amp; lastRow)\nv = Application.Index(.Value2, .Worksheet.Evaluate(\"ROW(\" &amp; .Columns(1).Address &amp; \")-1\"), Array(1, 9, 10, 15, 16))\nEnd With\n</code></pre>\n\n<p>The <code>Evaluate</code> part creates an array of 'row' indices (from 1 to n) and the last array is the indices of the columns you want (relative to the range, so H is column 1).</p>\n"}], "owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 34181655, "answer_count": 1, "score": 2, "last_activity_date": 1449672837, "creation_date": 1449670333, "last_edit_date": 1531161705, "question_id": 34180922, "link": "https://stackoverflow.com/questions/34180922/what-is-the-best-way-to-create-an-array-of-the-values-in-non-contiguous-ranges", "title": "What is the best way to create an array of the &quot;values&quot; in non-contiguous ranges in excel?", "body": "<p>I have looked into the vba Union method but the example only shows how to apply a formula to these ranges.  Every time I try to copy these ranges into an array I end up with only some of the columns.  I am doing this:</p>\n\n<pre><code>Dim aRng As Range: Set aRng = wbkFirstfile.Sheets(1).Range(\"H2:H\" + CStr(lastRow))\nDim bRng As Range: Set bRng = wbkFirstfile.Sheets(1).Range(\"P2:P\" + CStr(lastRow))\nDim cRng As Range: Set cRng = wbkFirstfile.Sheets(1).Range(\"Q2:Q\" + CStr(lastRow))\nDim dRng As Range: Set dRng = wbkFirstfile.Sheets(1).Range(\"U2:U\" + CStr(lastRow))\nDim eRng As Range: Set eRng = wbkFirstfile.Sheets(1).Range(\"V2:V\" + CStr(lastRow))\nDim fRng As Range: Set fRng = wbkFirstfile.Sheets(1).Range(\"W2:W\" + CStr(lastRow))\nDim uRng As Range: Set uRng = Union(aRng, bRng, cRng)\nDim uRng2 As Range: Set uRng2 = Union(dRng, fRng)\n</code></pre>\n\n<p>This only works for 3 of the 6 columns even when I try to access it directly e.g. area(3).cells(r,c) etc... I get an application defined error.</p>\n\n<p><strong>UPDATE</strong><br>\nI also updated uRng to: </p>\n\n<pre><code>Dim uRng As Range: Set uRng = Union(aRng, bRng, cRng, dRng, eRng, fRng)\n</code></pre>\n\n<p>I try to access it as: </p>\n\n<pre><code>MsgBox uRng2.Areas(1).Cells(2, 1)  \n</code></pre>\n\n<p>or</p>\n\n<pre><code>MsgBox uRng2.Areas(2).Cells(2, 1)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>MsgBox uRng2.Areas(3).Cells(2, 1) \n</code></pre>\n\n<p>and it works fine.... anything after area 3 (which I figured there were 6 areas) causes the application defined error.</p>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["excel", "vba", "sendmail", "type-mismatch"], "comments": [{"owner": {"reputation": 2260, "user_id": 3434874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KemED.jpg?s=128&g=1", "display_name": "Blake Yarbrough", "link": "https://stackoverflow.com/users/3434874/blake-yarbrough"}, "edited": false, "score": 0, "creation_date": 1449671021, "post_id": 34180893, "comment_id": 56108435, "body": "The full code is always necessary. If you want help please post all the relevant information."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1449671831, "post_id": 34180893, "comment_id": 56109061, "body": "I think you need special treatment of non-textual content. Google hint:  <code>vba send mail with embedded image</code>"}], "answers": [{"tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": true, "score": 0, "last_activity_date": 1449683872, "last_edit_date": 1449683872, "creation_date": 1449683547, "answer_id": 34185654, "question_id": 34180893, "link": "https://stackoverflow.com/questions/34180893/how-to-combine-a-string-and-a-variant-of-the-body-of-an-email-in-vba/34185654#34185654", "title": "How to combine a string and a variant of the body of an email in vba", "body": "<p>You can convert the variant to string: CStr(variant variable name) or convert the string to variant CVar(string variable name)</p>\n\n<p>Either</p>\n\n<pre><code> finalbody = CVar(body1) &amp; body2\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>finalbody = body1 &amp; CStr(body2)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5659543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f4c3e6cf4f3f4e3a5172eb12ffab02?s=128&d=identicon&r=PG&f=1", "display_name": "Veg", "link": "https://stackoverflow.com/users/5659543/veg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 0, "accepted_answer_id": 34185654, "answer_count": 1, "score": -1, "last_activity_date": 1449683872, "creation_date": 1449670252, "last_edit_date": 1449671938, "question_id": 34180893, "link": "https://stackoverflow.com/questions/34180893/how-to-combine-a-string-and-a-variant-of-the-body-of-an-email-in-vba", "title": "How to combine a string and a variant of the body of an email in vba", "body": "<p>I have the following code and get a Mismatch 13 Error when debugging:</p>\n\n<p>finalbody = body1 &amp; body2</p>\n\n<pre><code>olMail.Body = finalbody\nolMail.Display\n</code></pre>\n\n<p>Where body1 is a string and body2 is a variant (data that is like an image in a spreadsheet).</p>\n\n<p>Can anyone help me solve this error in order to send an email? I know it doesn't show the full code but it isn't necessary I think.</p>\n"}, {"tags": ["vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1449670676, "post_id": 34180873, "comment_id": 56108214, "body": "<code>DoCmd.RunSQL</code> is for action SQL only (insert, delete, update). To return results you&#39;ll need a recordset or something similar."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1449670919, "post_id": 34180873, "comment_id": 56108378, "body": "I was just exploring a similar solution... but still can&#39;t get it to work quite right."}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1449670976, "post_id": 34180873, "comment_id": 56108410, "body": "Have you considered using the DLookup function?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1449671023, "post_id": 34180873, "comment_id": 56108438, "body": "I have considered the DLoopup function but since I need to join two tables to build the query I didn&#39;t think that would work. Please correct me if I&#39;m wrong on that account."}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1449671051, "post_id": 34180873, "comment_id": 56108455, "body": "you could use it twice"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1449671069, "post_id": 34180873, "comment_id": 56108476, "body": "once to get the ID and once to get the value you want"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1449671089, "post_id": 34180873, "comment_id": 56108484, "body": "am getting stuck on the <code>db.Execute</code> line. Any idea why that might be?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1449671147, "post_id": 34180873, "comment_id": 56108526, "body": "What does <code>Debug.Print sSQL1 &amp; iMandate &amp; sSQL2</code> show you?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1449671180, "post_id": 34180873, "comment_id": 56108549, "body": "@mielk do I need to change <code>rs</code> to be something other than recordset? <code>querydef</code> perhaps?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1449671294, "post_id": 34180873, "comment_id": 56108636, "body": "@HansUp I get the SQL String I need to run the query... it works fine if I just plug it into an empty new query... Actual result would be this: <code>SELECT tbl_Mandate_Type.BM_Included FROM tbl_Mandate_Type INNER JOIN tbl_MoPo_BM ON tbl_Mandate_Type.Mandate_Type_ID = tbl_MoPo_BM.MandateType_ID WHERE (((tbl_MoPo_BM.MoPo_BM_ID)=108));</code>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1449671417, "post_id": 34180873, "comment_id": 56108724, "body": "Then what did you mean when you said you are stuck at <code>db.Execute</code>?  Is there an error? Ack!  I think you need <code>OpenRecordset</code> instead of <code>Execute</code> there."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1449671501, "post_id": 34180873, "comment_id": 56108789, "body": "@hansup Sorry if that wasn&#39;t clear. The error is <code>Type Mismatch</code>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1449671545, "post_id": 34180873, "comment_id": 56108814, "body": "I just edited previous comment.  Does it work if you use <code>OpenRecordset</code>?"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1449671557, "post_id": 34180873, "comment_id": 56108828, "body": "I posted a way using DLookup to get what you want"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1449671625, "post_id": 34180873, "comment_id": 56108880, "body": "@HansUp no. I get the type mismatch if I run it using <code>recordset</code>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1449671702, "post_id": 34180873, "comment_id": 56108947, "body": "Declare the rs variable like this: <code>Dim rs As DAO.Recordset</code>  Does that eliminate the mismatch error?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1449671912, "post_id": 34180873, "comment_id": 56109121, "body": "@HansUp I just tested your solution as well. ALSO WORKS!"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1449671939, "post_id": 34180873, "comment_id": 56109143, "body": "Wish I could award solution points to both you and Magisch. Thank you for your help!"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 1, "creation_date": 1449817553, "post_id": 34180873, "comment_id": 56179981, "body": "For the second solution, please do <code>rs.close</code> too to avoid memory leaks or other shenanigans."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1449846191, "post_id": 34180873, "comment_id": 56196850, "body": "@Magisch updated per your comment. thanks"}], "answers": [{"comments": [{"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1449671696, "post_id": 34181331, "comment_id": 56108938, "body": "@rohrl77 the idea is (typos notwithstanding) to use the DLookup first to fetch the ID you INNER JOINed on, and then use that ID to fetch the proper value."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1449671858, "post_id": 34181331, "comment_id": 56109077, "body": "Awesome! It worked. Thank you... I&#39;ll post the final solution code above for future refrence"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1449671888, "post_id": 34181331, "comment_id": 56109106, "body": "@rohrl77 please also leave the error code above so people can reference the problem."}], "tags": [], "owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "is_accepted": true, "score": 4, "last_activity_date": 1449672200, "last_edit_date": 1449672200, "creation_date": 1449671459, "answer_id": 34181331, "question_id": 34180873, "link": "https://stackoverflow.com/questions/34180873/how-to-pass-a-sql-query-result-to-variable-with-vba-access/34181331#34181331", "title": "How to pass a SQL query result to variable with VBA Access", "body": "<p>You can use the <code>DLookup</code> function native to access for this. Since you have an <code>INNER JOIN</code> in your SQL, you will have to use it twice, but it'll still work.</p>\n\n<p>Use a temporary string variable to store the temporary output, like this:</p>\n\n<pre><code>Dim tmp as String\ntmp = Cstr(DLookup(\"tbl_MoPo_BM.MandateType_ID\",\"tbl_MoPo_BM\",\"tbl_MoPo_BM.MoPo_BM_ID = \" &amp; iMandate)) 'This is to fetch the ID you performed the inner join on\nHasBM = DLookup(\"tbl_Mandate_Type.BM_Included\",\"tbl_Mandate_Type\",\"Mandate_Type_ID =\" &amp; tmp) ' this is to get your value\n</code></pre>\n\n<p>Using your <code>DoCmd.RunSQL</code> will not suffice since its for action queries only (<code>INSERT</code>, <code>DELETE</code>, <code>UPDATE</code>) and incapable of returning the result.</p>\n\n<p>Alternatively, you can use a Recordset with your SQL query to fetch what you want, but thats more work and the DLookup is designed to exactly avoid doing that for single column return selects.</p>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11497, "favorite_count": 1, "accepted_answer_id": 34181331, "answer_count": 1, "score": 3, "last_activity_date": 1449846173, "creation_date": 1449670203, "last_edit_date": 1449846173, "question_id": 34180873, "link": "https://stackoverflow.com/questions/34180873/how-to-pass-a-sql-query-result-to-variable-with-vba-access", "title": "How to pass a SQL query result to variable with VBA Access", "body": "<p>I need to create a standalone function which checks whether a value is true or false. I have attempted to set up a SQL query that does this, but can't get the result to pass to the variable.</p>\n\n<p>The query will always return only one record.</p>\n\n<p>How can I pass the result of the SQL string as the returning value of the function?</p>\n\n<p>UPDATED</p>\n\n<pre><code>Private Function HasBM(iMandate As Variant) As Boolean\n'Returns boolean value for whether or not mandate has a benchmark\nDim sSQL1 As String\nDim sSQL2 As String\n\nDim db As Database\nDim rs As Recordset\n\nsSQL1 = \"SELECT tbl_Mandate_Type.BM_Included \" &amp; _\n        \"FROM tbl_Mandate_Type INNER JOIN tbl_MoPo_BM ON tbl_Mandate_Type.Mandate_Type_ID = tbl_MoPo_BM.MandateType_ID \" &amp; _\n        \"WHERE (((tbl_MoPo_BM.MoPo_BM_ID)=\"\n\nsSQL2 = \"));\"\n\nSet db = CurrentDb\nSet rs = db.Execute(sSQL1 &amp; iMandate &amp; sSQL2)\nHasBM = rs.Fields(0).Value\n\nEnd Function\n</code></pre>\n\n<p><strong>UPDATE 2: SOLUTION</strong></p>\n\n<p>Thanks for Magisch and HansUp I ended up getting two solutions that work:</p>\n\n<p><strong>DLOOKUP Solution</strong> by Magisch as I implemented it:</p>\n\n<pre><code>Private Function HasBM2(iMandate As Variant)\n'Returns boolean value for whether or not mandate has a benchmark\nDim tmp As String\n\ntmp = CStr(DLookup(\"tbl_MoPo_BM.MandateType_ID\", \"tbl_MoPo_BM\", \"tbl_MoPo_BM.MoPo_BM_ID = \" &amp; iMandate))\nHasBM2 = DLookup(\"tbl_Mandate_Type.BM_Included\", \"tbl_Mandate_Type\", \"Mandate_Type_ID =\" &amp; tmp)\n\nEnd Function\n</code></pre>\n\n<p><strong>Second Solution using recordset</strong> as HansUp helped create:</p>\n\n<pre><code>Private Function HasBM(iMandate As Variant) As Boolean\n'Returns boolean value for whether or not mandate has a benchmark\nDim sSQL1 As String\nDim sSQL2 As String\n\nDim db As Database\nDim rs As dao.Recordset\n\nsSQL1 = \"SELECT tbl_Mandate_Type.BM_Included \" &amp; _\n        \"FROM tbl_Mandate_Type INNER JOIN tbl_MoPo_BM ON tbl_Mandate_Type.Mandate_Type_ID = tbl_MoPo_BM.MandateType_ID \" &amp; _\n        \"WHERE (((tbl_MoPo_BM.MoPo_BM_ID)=\"\n\nsSQL2 = \"));\"\n\nSet db = CurrentDb\nSet rs = db.OpenRecordset(sSQL1 &amp; iMandate &amp; sSQL2)\nHasBM = rs.Fields(0).Value\n\nrs.close    \n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 5608775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9723c2e58be94fd79cfd21d7198eb791?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek Rzadca", "link": "https://stackoverflow.com/users/5608775/jacek-rzadca"}, "edited": false, "score": 0, "creation_date": 1449738250, "post_id": 34184450, "comment_id": 56140649, "body": "It worked! I am novice in VBA. At the begining I tried insert method, but I tought it can be used only with Selection.Range target. Anyway there is one little flaw in your code which I am currently trying to solve. I can only insert my table once into &quot;termsConditions&quot; content control. I am looking for code to clear/reset/delete/ conent (table in this case!! more tricky, than text) in the content control without removing it. This will allow me to replace one table in the content control with another. Could you help me?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 67, "user_id": 5608775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9723c2e58be94fd79cfd21d7198eb791?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek Rzadca", "link": "https://stackoverflow.com/users/5608775/jacek-rzadca"}, "edited": false, "score": 0, "creation_date": 1449764112, "post_id": 34184450, "comment_id": 56157832, "body": "Does the content control contain only the table, or other things as well? If only the table, make sure the content control&#39;s property &quot;Content control cannot be deleted&quot; is activated. Then you should be able to delete the entire ContentControl.Range without deleting the content control."}, {"owner": {"reputation": 67, "user_id": 5608775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9723c2e58be94fd79cfd21d7198eb791?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek Rzadca", "link": "https://stackoverflow.com/users/5608775/jacek-rzadca"}, "edited": false, "score": 0, "creation_date": 1449829418, "post_id": 34184450, "comment_id": 56186347, "body": "Yes it contained one table. I tried your solution. It did not work. I could not remove content when I already placed inside some table. It was protected from deleting too. I found another solution. Please see my answer below."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1449679923, "creation_date": 1449679923, "answer_id": 34184450, "question_id": 34180667, "link": "https://stackoverflow.com/questions/34180667/insert-table-from-builiding-block-in-specified-location-in-the-word-document/34184450#34184450", "title": "Insert Table from Builiding Block in specified location in the word document.", "body": "<p>I'm not sure what you mean by \"it is converted to Rich Text\"... </p>\n\n<p>The accepted way to insert a BuildingBlock is to use the BuildingBlock.Insert method to which you pass the target Range object. For example (based on your code sample):</p>\n\n<pre><code>Dim doc as Word.Document\nDim rngTarget as Word.Range\nSet doc = ActiveDocument\nSet rngTarget = doc.SelectContentControlsByTag(\"TermsConditions\").Item(1).Range \ndoc.AttachedTemplate.BuildingBlockTypes.Item(wdTypeTables).Categories.Item(\"Terms and and Conditions Translation\").BuildingBlocks.Item(\"Terms and Conditions Eng\").Insert rngTarget, true\n</code></pre>\n\n<p>Take a look at the example in the VBA Language Reference...</p>\n\n<p>Also, you should not use ThisDocument in your code, use ActiveDocument. (Even better, declare a Document object, assign ActiveDocument to it, then use that.)</p>\n"}, {"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1449843562, "post_id": 34221132, "comment_id": 56195194, "body": "Your code will execute more efficiently and be easier to read if you declare a variable for an object you re-use frequently and use that. For example: Dim ccTermConditions as Word.ContentControl : Set ccTermConditions = doc.SelectContentControlsByTag.Item(1) : If ccTermConditions.Range.Text &lt;&gt; ccTermConditions.PlaceholderText Then ccTermConditions.Range.Cut : End If    (Since new lines aren&#39;t possible in Comments the colons (:) indicate where there&#39;d be a new line in your code.)"}], "tags": [], "owner": {"reputation": 67, "user_id": 5608775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9723c2e58be94fd79cfd21d7198eb791?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek Rzadca", "link": "https://stackoverflow.com/users/5608775/jacek-rzadca"}, "is_accepted": false, "score": 1, "last_activity_date": 1449829985, "last_edit_date": 1449829985, "creation_date": 1449829166, "answer_id": 34221132, "question_id": 34180667, "link": "https://stackoverflow.com/questions/34180667/insert-table-from-builiding-block-in-specified-location-in-the-word-document/34221132#34221132", "title": "Insert Table from Builiding Block in specified location in the word document.", "body": "<p>Complete solution for my problem is:</p>\n\n<ol>\n<li>Solution proposed by Cindy Meister Replacing content inside content\ncontrol:</li>\n<li><p>To change content inside content control \"TermsConditions\"  I added following code:</p>\n\n<p>If doc.SelectContentControlsByTag(\"TermsConditions\").Item(1).Range.Text &lt;> doc.SelectContentControlsByTag(\"TermsConditions\").Item(1).PlaceholderText Then\ndoc.SelectContentControlsByTag(\"TermsConditions\").Item(1).Range.Cut\nElse\nEnd If</p></li>\n</ol>\n"}], "owner": {"reputation": 67, "user_id": 5608775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9723c2e58be94fd79cfd21d7198eb791?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek Rzadca", "link": "https://stackoverflow.com/users/5608775/jacek-rzadca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 34184450, "answer_count": 2, "score": 0, "last_activity_date": 1449829985, "creation_date": 1449669600, "last_edit_date": 1531164843, "question_id": 34180667, "link": "https://stackoverflow.com/questions/34180667/insert-table-from-builiding-block-in-specified-location-in-the-word-document", "title": "Insert Table from Builiding Block in specified location in the word document.", "body": "<p>I want to insert a table which is defined as building block. I placed a content control in specified location in the document and refer to it by \"selectcontetcontrolsbytag\". Unfortunetly when table is inserted to the conentcontrol, it is convertered to RichText. Here is my code:</p>\n\n<pre><code>ThisDocument.SelectContentControlsByTag(\"TermsConditions\").Item(1).Range = _\nActiveDocument.AttachedTemplate.BuildingBlockTypes.Item(wdTypeTables).Categories.Item(\"Terms and Conditions Translation\").BuildingBlocks.Item(\"Terms and Conditions Eng\")\n</code></pre>\n\n<p>Could you help me with proper code to insert building block in specified location. Also I would like this building block to be replaced by another, when user will select other item from userform, combobox etc. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5656307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96af7eea34e6994b2472fae98a77a390?s=128&d=identicon&r=PG&f=1", "display_name": "rstuart931", "link": "https://stackoverflow.com/users/5656307/rstuart931"}, "edited": false, "score": 0, "creation_date": 1449671524, "post_id": 34180939, "comment_id": 56108802, "body": "I tried your macro and I get a variable not defined error for the &quot;a&quot;"}, {"owner": {"reputation": 31, "user_id": 5656307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96af7eea34e6994b2472fae98a77a390?s=128&d=identicon&r=PG&f=1", "display_name": "rstuart931", "link": "https://stackoverflow.com/users/5656307/rstuart931"}, "edited": false, "score": 1, "creation_date": 1449672791, "post_id": 34180939, "comment_id": 56109857, "body": "I integrated your code as shown below. The formulas stop at the last entry in column A, but it&#39;s filling down the same data from row 2. It&#39;s not applying the formulas according to the value in column A in successive rows."}, {"owner": {"reputation": 31, "user_id": 5656307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96af7eea34e6994b2472fae98a77a390?s=128&d=identicon&r=PG&f=1", "display_name": "rstuart931", "link": "https://stackoverflow.com/users/5656307/rstuart931"}, "edited": false, "score": 0, "creation_date": 1449672967, "post_id": 34180939, "comment_id": 56109994, "body": "Sorry, I&#39;m not sure how to include code in the comment box."}, {"owner": {"reputation": 31, "user_id": 5656307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96af7eea34e6994b2472fae98a77a390?s=128&d=identicon&r=PG&f=1", "display_name": "rstuart931", "link": "https://stackoverflow.com/users/5656307/rstuart931"}, "edited": false, "score": 0, "creation_date": 1449677138, "post_id": 34180939, "comment_id": 56113110, "body": "Even with those changes, I get the same results. While the formulas fill down, they are only ever looking at A2 for the Match function. I need to find a way to increase the Cell A2 by 1 each time until the last entry in Column A is reached. I appreciate your help with this."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 31, "user_id": 5656307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96af7eea34e6994b2472fae98a77a390?s=128&d=identicon&r=PG&f=1", "display_name": "rstuart931", "link": "https://stackoverflow.com/users/5656307/rstuart931"}, "edited": false, "score": 0, "creation_date": 1449677203, "post_id": 34180939, "comment_id": 56113156, "body": "Please wait i will update the code and get back to you. Could you please update your question with the formula your using (not in VB format) from B to H column. If possible provide snap :)"}, {"owner": {"reputation": 31, "user_id": 5656307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96af7eea34e6994b2472fae98a77a390?s=128&d=identicon&r=PG&f=1", "display_name": "rstuart931", "link": "https://stackoverflow.com/users/5656307/rstuart931"}, "edited": false, "score": 0, "creation_date": 1449688119, "post_id": 34180939, "comment_id": 56120330, "body": "Your code did exactly what I asked for, the problem was with my code. I was placing values in Row 2 instead of formulas. Thank you for your help, I appreciate it."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 31, "user_id": 5656307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96af7eea34e6994b2472fae98a77a390?s=128&d=identicon&r=PG&f=1", "display_name": "rstuart931", "link": "https://stackoverflow.com/users/5656307/rstuart931"}, "edited": false, "score": 0, "creation_date": 1449719020, "post_id": 34180939, "comment_id": 56132751, "body": "Glad to know that my friend :)"}], "tags": [], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "is_accepted": true, "score": 0, "last_activity_date": 1449676416, "last_edit_date": 1449676416, "creation_date": 1449670371, "answer_id": 34180939, "question_id": 34180662, "link": "https://stackoverflow.com/questions/34180662/vba-code-to-fill-down-index-match-functions-in-7-adjacent-cells/34180939#34180939", "title": "VBA code to fill down index-match functions in 7 adjacent cells", "body": "<p>Use this macro after applying the formulas from B to H, hope this is what you expected.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>Private Sub cmdUpdateWBID_Att_Click()\r\n       Dim a As Integer\r\n       \r\n       With ActiveSheet\r\n         .Range(\"B2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"B:B\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\r\n         .Range(\"C2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"H:H\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\r\n         .Range(\"D2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"I:I\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\r\n         .Range(\"E2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"G:G\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\r\n         .Range(\"F2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"L:L\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\r\n         .Range(\"G2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"D:D\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\r\n         .Range(\"H2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"E:E\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\r\n      End With  \r\n\r\n       Range(\"A2\").Select\r\n       Selection.End(xlDown).Select\r\n       a = ActiveCell.Row\r\n       Range(\"B\" &amp; a &amp; \":H\" &amp; a).Select\r\n       Range(Selection, Selection.End(xlUp)).Select\r\n       Selection.FillDown\r\n   \r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5656307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96af7eea34e6994b2472fae98a77a390?s=128&d=identicon&r=PG&f=1", "display_name": "rstuart931", "link": "https://stackoverflow.com/users/5656307/rstuart931"}, "is_accepted": false, "score": 0, "last_activity_date": 1449687995, "last_edit_date": 1449687995, "creation_date": 1449687504, "answer_id": 34186840, "question_id": 34180662, "link": "https://stackoverflow.com/questions/34180662/vba-code-to-fill-down-index-match-functions-in-7-adjacent-cells/34186840#34186840", "title": "VBA code to fill down index-match functions in 7 adjacent cells", "body": "<p>The problem I was having using @Linga's code is that my code placed values in row 2 and his code filled down those values. I needed to place formulas in the row and then @Linga's code would have filled down just like I wanted. A colleague led me in the right direction with my code. The last few lines of code allowed me to remove the formulas from the cells and just leave the values. @Linga's answer did exactly what I asked. </p>\n\n<pre><code>Private Sub cmdUpdateWBID_Att_Click()\nDim a As Integer\nRange(\"B2\").Select\nActiveCell.FormulaR1C1 = _\n    \"=INDEX(Sheet2!C,MATCH(Sheet1!RC[-1],Sheet2!C[-1],0))\"\nRange(\"C2\").Select\nActiveCell.FormulaR1C1 = _\n    \"=INDEX(Sheet2!C[5],MATCH(Sheet1!RC[-2],Sheet2!C[-2],0))\"\nRange(\"D2\").Select\nActiveCell.FormulaR1C1 = _\n    \"=INDEX(Sheet2!C[5],MATCH(Sheet1!RC[-3],Sheet2!C[-3],0))\"\nRange(\"E2\").Select\nActiveCell.FormulaR1C1 = _\n    \"=INDEX(Sheet2!C[2],MATCH(Sheet1!RC[-4],Sheet2!C[-4],0))\"\nRange(\"F2\").Select\nActiveCell.FormulaR1C1 = _\n    \"=INDEX(Sheet2!C[6],MATCH(Sheet1!RC[-5],Sheet2!C[-5],0))\"\nRange(\"G2\").Select\nActiveCell.FormulaR1C1 = _\n    \"=INDEX(Sheet2!C[-3],MATCH(Sheet2!RC[-6],Sheet2!C[-6],0))\"\nRange(\"H2\").Select\nActiveCell.FormulaR1C1 = _\n    \"=INDEX(Sheet2!C[-3],MATCH(Sheet1!RC[-7],Sheet2!C[-7],0))\"\nRange(\"A2\").Select\nSelection.End(xlDown).Select\na = ActiveCell.Row\nRange(\"B\" &amp; a &amp; \":H\" &amp; a).Select\nRange(Selection, Selection.End(xlUp)).Select\nSelection.FillDown\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6226952, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/a59009d18e10c1917efa730f62932726?s=128&d=identicon&r=PG", "display_name": "David Bracken", "link": "https://stackoverflow.com/users/6226952/david-bracken"}, "is_accepted": false, "score": 0, "last_activity_date": 1461097638, "last_edit_date": 1461097638, "creation_date": 1461096971, "answer_id": 36728571, "question_id": 34180662, "link": "https://stackoverflow.com/questions/34180662/vba-code-to-fill-down-index-match-functions-in-7-adjacent-cells/36728571#36728571", "title": "VBA code to fill down index-match functions in 7 adjacent cells", "body": "<p>I do this exact thing on an import macro.  Here is a one of my lines.\nThis directly applies a formula in column <code>A</code> to a range in a single step.  It starts at <code>A2</code> because there is a header row and uses <code>TableRange.Rows.Count</code> to get the bottom of the table.  Get the bottom of yours however works best.</p>\n\n<pre><code>MaxRow = TableRange.Rows.Count\n' \"DATE\"\nRange(\"A2:A\" &amp; MaxRow).FormulaR1C1 = \"=IF(RC[4]=\"\"\"\",\"\"\"\",DATE(YEAR(RC[4]),MONTH(RC[4]),1))\"\n</code></pre>\n\n<p>To get your formula in \"RC\" format just record a macro of yourself entering it by hand.</p>\n"}], "owner": {"reputation": 31, "user_id": 5656307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96af7eea34e6994b2472fae98a77a390?s=128&d=identicon&r=PG&f=1", "display_name": "rstuart931", "link": "https://stackoverflow.com/users/5656307/rstuart931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2087, "favorite_count": 1, "accepted_answer_id": 34180939, "answer_count": 3, "score": 1, "last_activity_date": 1461097638, "creation_date": 1449669580, "last_edit_date": 1449678904, "question_id": 34180662, "link": "https://stackoverflow.com/questions/34180662/vba-code-to-fill-down-index-match-functions-in-7-adjacent-cells", "title": "VBA code to fill down index-match functions in 7 adjacent cells", "body": "<p>I am new to coding and need some assistance. I have created an update button in Excel 2013 that will use the value in column A to fill in values in columns B through H using Index and Match from another spreadsheet. The number of entries in column A will vary and the spreadsheet containing the values for columns B through H has over 6,000 rows and many columns.</p>\n\n<p>I want the code I've written to fill down through the last entry in column A. </p>\n\n<pre><code>Private Sub cmdUpdate_Click()\n    With ActiveSheet\n         .Range(\"B2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"B:B\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n         .Range(\"C2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"H:H\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n         .Range(\"D2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"I:I\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n         .Range(\"E2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"G:G\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n         .Range(\"F2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"L:L\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n         .Range(\"G2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"D:D\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n         .Range(\"H2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"E:E\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n    End With\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance for your help, I appreciate it.</p>\n\n<p>Update:\nI integrated the code from @Linga as follows. The formulas fill down through the last entry in column A, however it is only copying the data from row 2. It is ignoring the values in column A in successive rows.</p>\n\n<pre><code>Private Sub cmdUpdateWBID_Att_Click()\n       Dim a As String\n       a = ActiveCell.Row\n       With ActiveSheet\n         .Range(\"B2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"B:B\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n         .Range(\"C2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"H:H\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n         .Range(\"D2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"I:I\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n         .Range(\"E2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"G:G\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n         .Range(\"F2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"L:L\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n         .Range(\"G2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"D:D\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n         .Range(\"H2\") = Application.WorksheetFunction.Index(Sheets(\"Sheet2\").Range(\"E:E\"), Application.WorksheetFunction.Match(Sheets(\"Sheet1\").Range(\"A2\"), (Sheets(\"Sheet2\").Range(\"A:A\")), 0))\n       End With\n       Range(\"A2\").Select\n       Selection.End(xlDown).Select\n       Range(\"B\" &amp; a &amp; \":H\" &amp; a).Select\n       Range(Selection, Selection.End(xlUp)).Select\n       Selection.FillDown\n\nEnd Sub\n</code></pre>\n\n<p>Update:\nI wrote a VBA form of the Excel Index and Match formulas in cells B through H. The following formula sits in cell B;</p>\n\n<p>=INDEX(Sheet2!B:B,MATCH(Sheet1!A:A,Sheet2!A:A,0))</p>\n\n<p>A similar formula sits in cells C through H. I wanted to automate this with a button instead of writing 7 formulas and dragging them down. This is an action that I have been repeating a lot with very large datasets.</p>\n\n<p>Sorry, I don't have Snap.</p>\n"}, {"tags": ["string", "vba", "excel", "string-comparison"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449669535, "post_id": 34180403, "comment_id": 56107333, "body": "please embed your code into the post, instead of in a picture and we also cannot see what is underneath the <code>rowArray(4)-&quot;N&#47;A&quot;</code>, which could be important to solving the issue."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1449669686, "post_id": 34180403, "comment_id": 56107455, "body": "Have you tried <b><code>If CStr(rowArray(4)) &lt;&gt; CStr(&quot;N&#47;A&quot;) Then</code></b> ?"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449670191, "post_id": 34180403, "comment_id": 56107802, "body": "@ScottHoltzman i needed to send it as picture because of content of rowArray(4) variable. and rest of code is not much important, because issue is in condition"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1449670227, "post_id": 34180403, "comment_id": 56107835, "body": "Notepad++ is a pain for putting whitespace characters in - try using <code>Trim(rowArray(4))</code> and see if you get the same result"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1449670271, "post_id": 34180403, "comment_id": 56107873, "body": "@ManishChristian yes i tried that. rowArray variable is already dimed as string, but also i tried your hint and retype it with N/A string, but issue is same. VBA still thinks its different"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1449670355, "post_id": 34180403, "comment_id": 56107940, "body": "@MacroMan i have variable already trimed (whole array) and as you can see on little note above yellow debug pointer, content of rowArray(4) variable is string &quot;N/A&quot; and i comparing it to &quot;N/A&quot; string. No whitespace or something else here."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1449670531, "post_id": 34180403, "comment_id": 56108093, "body": "@Lubo\u0161Suk You can&#39;t trim a whole array in one go... so not sure what you&#39;ve done. But anyway, something like <code>Chr(13)</code> or <code>Chr(10)</code> won&#39;t actually show when you hover over the variable, so it will look like there is no whitespace. Just try it - what have you got to lose?"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1449670711, "post_id": 34180403, "comment_id": 56108233, "body": "@MacroMan sorry for my bad interpretation. I did not trimmed whole array in single line, but i looped whole array and trimmed each element. But it doesnt matter, i tried trim and issue is same (i made a little update in question)"}, {"owner": {"reputation": 388, "user_id": 863160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd769707e16a3e9ca3871ad8d490d0f?s=128&d=identicon&r=PG&f=1", "display_name": "Meet", "link": "https://stackoverflow.com/users/863160/meet"}, "edited": false, "score": 0, "creation_date": 1449671020, "post_id": 34180403, "comment_id": 56108433, "body": "I vaguely remember facing such issues in VBA. I just fixed it by using <code>InStr</code> in place of <code>=</code>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1449671160, "post_id": 34180403, "comment_id": 56108537, "body": "@Lubo\u0161Suk just to see if it&#39;s another character that can&#39;t be displayed - have you tried doing <code>?Len(rowArray(4))</code> in the immediate window and make sure you get <code>3</code> as the result?"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1449671376, "post_id": 34180403, "comment_id": 56108693, "body": "Something got messed up, as same line of code working for me. Can you tell us something more about <code>which is just CTRL+C and CTRL+V of working file</code>."}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1449671487, "post_id": 34180403, "comment_id": 56108776, "body": "@MacroMan you got the point, len is 4."}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1449671559, "post_id": 34180403, "comment_id": 56108830, "body": "@ManishChristian i have one big file generated by ansys and there i have some values which i wana load. And i take only this values and copy and paste them into another document. Original file can be loaded without problem, but file which i copied throwing this issue. But thanks to MacroMan i see issue with some invisible character"}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1449746236, "last_edit_date": 1449746236, "creation_date": 1449671658, "answer_id": 34181417, "question_id": 34180403, "link": "https://stackoverflow.com/questions/34180403/vba-string-comparison-failure/34181417#34181417", "title": "VBA string comparison failure", "body": "<p>Use the immediate window to test the contents of the variable:</p>\n\n<pre><code>For i = 1 To Len(rowArray(4)): Print Asc(Mid(rowArray(4), i, 1)): Next\n</code></pre>\n\n<p>This will print the ASCII value of each character in the string - you can use this to determine what the extra character(s) are causing the issue.</p>\n"}], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "accepted_answer_id": 34181417, "answer_count": 1, "score": 0, "last_activity_date": 1449746236, "creation_date": 1449668844, "last_edit_date": 1449670603, "question_id": 34180403, "link": "https://stackoverflow.com/questions/34180403/vba-string-comparison-failure", "title": "VBA string comparison failure", "body": "<p>i met interesting issue when im comparing two strings. Im reading data from file and everything works well. But then co-worker send me input file, which is just CTRL+C and CTRL+V of working file. And then miracle happend! VBA is so confused, that cant compare two simple strings and i fell of chair.</p>\n\n<p>If you take a look at image you can see that comparison passed if condition where are two same strings, but it should not. Im a bit confused how this can happen. </p>\n\n<p><a href=\"https://i.stack.imgur.com/6qHX7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6qHX7.png\" alt=\"enter image description here\"></a></p>\n\n<p>So met someone something like this? Im realy start thinking about something like machine revolution from Terminator. (files are both saved in notepad++ and there are no strange characters or something like that)</p>\n\n<p><strong>Progress update</strong><br>\nSo i tried hints from guys in comments below. and ended with something like this</p>\n\n<pre><code>If CStr(Trim(rowArray(4))) &lt;&gt; (CStr(\"N/A\")) Then\n</code></pre>\n\n<p>Contentent of rowArray(4) is still \"N/A\" string as on picture above and excel still thinks this strings arent same. I also saved file in pspad, netbeans, and normal notepad and issue is still same.</p>\n"}, {"tags": ["c++", "vba", "com"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1449668123, "post_id": 34180099, "comment_id": 56106412, "body": "Are you using 64 or 32 bit office?"}, {"owner": {"reputation": 77, "user_id": 5124151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48d7ddb9ce42450499893043513fe150?s=128&d=identicon&r=PG&f=1", "display_name": "TuDa", "link": "https://stackoverflow.com/users/5124151/tuda"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1449668516, "post_id": 34180099, "comment_id": 56106652, "body": "I use a 32 bit office."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1449668883, "post_id": 34180099, "comment_id": 56106904, "body": "Ugh, nice job minimizing the problem.  Never declare COM types twice, your VBA code must use the type library you created from your IDL so there can never be a mismatch.  Use the __uuidof keyword to avoid declaring guids twice."}, {"owner": {"reputation": 77, "user_id": 5124151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48d7ddb9ce42450499893043513fe150?s=128&d=identicon&r=PG&f=1", "display_name": "TuDa", "link": "https://stackoverflow.com/users/5124151/tuda"}, "edited": false, "score": 0, "creation_date": 1449735034, "post_id": 34180099, "comment_id": 56138838, "body": "I corrected the declaration of types but the problem is still here."}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1449935770, "post_id": 34180099, "comment_id": 56225480, "body": "I seem to recall reading somewhere that VB uses 8-byte alignment , while C++ uses 4-byte alignment by default. So the two do not agree on how to pack structures together in an array. Try adding a dummy Long member at the end of the structure, to pad it to a multiple of 8 bytes."}, {"owner": {"reputation": 77, "user_id": 5124151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48d7ddb9ce42450499893043513fe150?s=128&d=identicon&r=PG&f=1", "display_name": "TuDa", "link": "https://stackoverflow.com/users/5124151/tuda"}, "edited": false, "score": 0, "creation_date": 1450953722, "post_id": 34180099, "comment_id": 56644434, "body": "It&#39;s work fine if I declare structure only in C++. But I need to declare the structure on VBA and on C++ because we cannot take the COM structure on OS X :( And now, when I have the both declaration, it&#39;s crashed when I redim x of S2 on VBA and it&#39;s work fine if I don&#39;t redim. Do you have any idea why? I find any solution on the web..."}], "owner": {"reputation": 77, "user_id": 5124151, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48d7ddb9ce42450499893043513fe150?s=128&d=identicon&r=PG&f=1", "display_name": "TuDa", "link": "https://stackoverflow.com/users/5124151/tuda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 384, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449668723, "creation_date": 1449667949, "last_edit_date": 1449668723, "question_id": 34180099, "link": "https://stackoverflow.com/questions/34180099/com-safearray-memory-from-c-to-vba", "title": "COM SAFEARRAY memory from C++ to VBA", "body": "<p>I would like to create a SAFEARRAY of user defined type (UDT) in an UDT.\nI have one structure Data which contains the S structure. S is composed with S1 and S2.</p>\n\n<p>I need to create in c++ the array S of my Data object with the COM function.</p>\n\n<p>When I call my function from the VBA to create the array, the VBA crashes at the end of the function.\nIf I remove s7 from S, it works perfectly.</p>\n\n<p>I aligned my struct with 4 bytes.</p>\n\n<p>I don't find any help on this problem on the web.</p>\n\n<p>You can see the code here:</p>\n\n<ul>\n<li><p>VBA code:</p>\n\n<pre><code>#If VBA7 Then\n    Private Declare PtrSafe Function Cpp_Test2 Lib \"MYLIB.dll\" (i As Data) As Long\n#Else\n    Private Declare Function Cpp_Test2 Lib \"MYLIB.dll\" (i As Data) As Long\n#End If\n\nPublic Type S1\n    d1 As Double\n    S1 As String\n    S2 As String\n    d2 As Double\n    d3 As Double\n    i1 As Long\n    i2 As Long\n    d4 As Double\n    d5 As Double\n    s3 As String\n    s4 As String\n    s5 As String\n    s6 As String\n    d6 As Double\n    d7 As Double\n    d8 As Double\n    s7 As String\nEnd Type\n\nType S2\n    n As Long\n    x() As Double\n    y() As Double\nEnd Type\n\nType S\n    ms1 As S1\n    ms2 As S2\nEnd Type\n\nType Data\n    d As Double\n    n As Long\n    ms() As S\nEnd Type\n\nSub TestFunction()\n    Dim d As Data\n    MsgBox Cpp_Test2(d)\n    Stop\nEnd Sub\n</code></pre></li>\n<li><p>C++ code:</p></li>\n<li><p>idl file:</p>\n\n<pre><code>    typedef [uuid(C8166034-DF8D-460A-B38E-F9342694AABA)] struct S1\n    {\n        double d1;\n        BSTR s1;\n        BSTR s2;\n        double d2;\n        double d3;\n        int i1;\n        int i2;\n        double d4;\n        double d5;\n        BSTR s3; \n        BSTR s4; \n        BSTR s5; \n        BSTR s6;\n        double d6;\n        double d7;\n        double d8;\n        BSTR s7;\n    } S1;\n\n    typedef [uuid(539CF724-616E-46B6-8990-AD14F8190737)] struct S2\n    {\n        int n;\n        SAFEARRAY(double) x; //dbl\n        SAFEARRAY(double) y; //dbl\n    } S2;\n\n    typedef [uuid(0B689485-F347-4414-BF86-07926AC2526C)] struct S\n    {\n        S1 s1;\n        S2 s2;\n    } S;\n</code></pre></li>\n<li><p>cpp file:</p>\n\n<pre><code>const IID IID_S = { 0x0B689485, 0xF347,     0x4414{0xBF,0x86,0x07,0x92,0x6A,0xC2,0x52,0x6C\n                                      }\n};\n\nstruct Data\n{\n    double d;\n    int n;\n    SAFEARRAY *S;\n};\n\n__declspec(dllexport) int __stdcall  Cpp_Test2(Data *d)\n{\n    SAFEARRAYBOUND rgsabound[1];\n    rgsabound[0].lLbound = 0;\n    rgsabound[0].cElements = 5;\n    IRecordInfo* pRecInfo = NULL;\n    HRESULT hr = GetRecordInfoFromGuids(LIBID_MYLIB, 9, 9, 0, IID_S, &amp;pRecInfo);\n\n    if (pRecInfo)\n    {\n        d-&gt;S = SafeArrayCreateEx(VT_RECORD, 1, rgsabound, pRecInfo);\n        return 1;\n    }\n\n    return 0;\n}\n</code></pre></li>\n</ul>\n\n<p>I don't understand why it doesn't work.\nI have already used SafeArrayCreateEx without problem but here it seems there a memory problem.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1449668048, "post_id": 34179966, "comment_id": 56106366, "body": "One thing is to <code>Dim findvalue As Range</code>. Don&#39;t leave blank because that sets it to Variant, which may or may not be what you intended. Otherwise, what line does your code error on?"}, {"owner": {"reputation": 79, "user_id": 5650329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/021503ecae4265393b3ef05723fe7d24?s=128&d=identicon&r=PG&f=1", "display_name": "P.Costa", "link": "https://stackoverflow.com/users/5650329/p-costa"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449672389, "post_id": 34179966, "comment_id": 56109511, "body": "Thanks for the quick reply, the error apears in: &#39;disable adding Me.cmdAdd.Enabled = False Me.cmdEdit.Enabled = True"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1449673160, "creation_date": 1449673160, "answer_id": 34181987, "question_id": 34179966, "link": "https://stackoverflow.com/questions/34179966/error-424-object-needed-cant-seem-to-find-the-error/34181987#34181987", "title": "Error 424 Object needed - Cant seem to find the error", "body": "<p>Change </p>\n\n<pre><code>Me.cmdAdd.Enabled = False\nMe.cmdEdit.Enabled = True\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Me.Controls(\"cmdAdd\").Enabled = False\nMe.Controls(\"cmdEdit\").Enabled = True\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 5650329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/021503ecae4265393b3ef05723fe7d24?s=128&d=identicon&r=PG&f=1", "display_name": "P.Costa", "link": "https://stackoverflow.com/users/5650329/p-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 34181987, "answer_count": 1, "score": 2, "last_activity_date": 1488362014, "creation_date": 1449667540, "last_edit_date": 1488362014, "question_id": 34179966, "link": "https://stackoverflow.com/questions/34179966/error-424-object-needed-cant-seem-to-find-the-error", "title": "Error 424 Object needed - Cant seem to find the error", "body": "<p>i am farly new to VBa and am trying to learn by building or replicating existing vba sheets.\nIn this one, i am getting an error in the following code:</p>\n\n<pre><code>Private Sub lstLookup_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n'declare the variables\nDim cPayroll As String\nDim I As Integer\nDim findvalue\n'error block\nOn Error GoTo errHandler:\n'get the select value from the listbox\nFor I = 0 To lstLookup.ListCount - 1\n    If lstLookup.Selected(I) = True Then\n        cPayroll = lstLookup.List(I, 1)\n    End If\nNext I\n'find the payroll number\nSet findvalue = Sheet2.Range(\"F:F\").Find(What:=cPayroll, LookIn:=xlValues).Offset(0, -3)\n'add the database values to the userform\ncNum = 21\nFor X = 1 To cNum\n    Me.Controls(\"Reg\" &amp; X).Value = findvalue\n    Set findvalue = findvalue.Offset(0, 1)\nNext\n'disable adding\nMe.cmdAdd.Enabled = False\nMe.cmdEdit.Enabled = True\n'error block\nOn Error GoTo 0\nExit Sub\nerrHandler::\nMsgBox \"An Error has Occurred  \" &amp; vbCrLf &amp; \"The error number is:  \" _\n       &amp; Err.Number &amp; vbCrLf &amp; Err.Description &amp; vbCrLf &amp; _\n       \"Please notify the administrator\"\nEnd Sub\n</code></pre>\n\n<p>It is giving me the error :\" 424 Object required\"</p>\n\n<p>i cant seem to find the error</p>\n\n<p>Can someone help me?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4664667, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/985f5d026e249c93d6e3623a209dc891?s=128&d=identicon&r=PG&f=1", "display_name": "jumbli", "link": "https://stackoverflow.com/users/4664667/jumbli"}, "edited": false, "score": 0, "creation_date": 1449668418, "post_id": 34180184, "comment_id": 56106604, "body": "Thank you! But if C is &quot;5 P&quot; and I only want to count the LEFT how do I add the left to the range value?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 35, "user_id": 4664667, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/985f5d026e249c93d6e3623a209dc891?s=128&d=identicon&r=PG&f=1", "display_name": "jumbli", "link": "https://stackoverflow.com/users/4664667/jumbli"}, "edited": false, "score": 0, "creation_date": 1449669333, "post_id": 34180184, "comment_id": 56107208, "body": "@jumbli - my edited answer nows solves your issue completely, AFAICS."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1449669216, "last_edit_date": 1449669216, "creation_date": 1449668234, "answer_id": 34180184, "question_id": 34179888, "link": "https://stackoverflow.com/questions/34179888/check-for-duplicates-sum/34180184#34180184", "title": "Check for duplicates sum", "body": "<p>You can increment the value by wrapping the <code>Left</code> function (VBA version) around the cell value to get the value to increment by one and then use the space to extract the value to the right `\"P\" in your example, then bring them back together.</p>\n\n<p>See the code below. It will work for instances where the number increments above single digits and it also assumes there will always be a space after the number and before the text.</p>\n\n<pre><code>Sub check_duplicates()\n\nDim x As Long\nDim LastRow As Long\n\nLastRow = Range(\"L65536\").End(xlUp).Row\n\nFor x = LastRow To 1 Step -1\n\n    If Application.WorksheetFunction.CountIf(Range(\"L2:L\" &amp; x), Range(\"L\" &amp; x).Value) &gt; 1 Then\n\n           Dim y As Long, x As String\n           'increment left number by 1\n           y = Left(Range(\"C\" &amp; x).Value, InStr(1, Range(\"C\" &amp; x).Value, \" \") - 1) + 1\n           'extract text after space\n           x = Mid(Range(\"C\" &amp; x).Value, InStr(1, Range(\"C\" &amp; x).Value, \" \"))\n\n           Range(\"C\" &amp; x).Value = y &amp; x ' bring together and set the cell value to new incremented value\n\n    End If\n\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 220, "user_id": 3476534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48636cec4394d49f720005d104448a76?s=128&d=identicon&r=PG&f=1", "display_name": "user3476534", "link": "https://stackoverflow.com/users/3476534/user3476534"}, "is_accepted": false, "score": 0, "last_activity_date": 1449668349, "creation_date": 1449668349, "answer_id": 34180224, "question_id": 34179888, "link": "https://stackoverflow.com/questions/34179888/check-for-duplicates-sum/34180224#34180224", "title": "Check for duplicates sum", "body": "<p>Replace <code>Range(\"C\" &amp; x).Formula = \"=LEFT(x) + 1\"</code> with something like <code>Range(\"C\" &amp; x)=Range(\"C\" &amp; x) + 1</code>. Making the formula in C5=C5+1 would be circular and would cause an error. Alternatively, set a variable equal to range C5, add 1 to it, then set range C5 to this variable. I'm assuming column C is a set of integers here and not formulas.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4664667, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/985f5d026e249c93d6e3623a209dc891?s=128&d=identicon&r=PG&f=1", "display_name": "jumbli", "link": "https://stackoverflow.com/users/4664667/jumbli"}, "edited": false, "score": 0, "creation_date": 1449668571, "post_id": 34180283, "comment_id": 56106692, "body": "Thank you! But if C is &quot;5 P&quot; and I only want to count the LEFT how do I add the left to the range value?"}, {"owner": {"reputation": 516, "user_id": 5102865, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/71bf035de4fbcb43a6b9a1eb2d07c76e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Ryabov", "link": "https://stackoverflow.com/users/5102865/sergey-ryabov"}, "reply_to_user": {"reputation": 35, "user_id": 4664667, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/985f5d026e249c93d6e3623a209dc891?s=128&d=identicon&r=PG&f=1", "display_name": "jumbli", "link": "https://stackoverflow.com/users/4664667/jumbli"}, "edited": false, "score": 0, "creation_date": 1449669187, "post_id": 34180283, "comment_id": 56107122, "body": "@jumbli Just put <code>Range(&quot;C&quot; &amp; x) = Left(Range(&quot;C&quot; &amp; x), 1) + 1 &amp; Mid(Range(&quot;C&quot; &amp; x), 2)</code> then"}], "tags": [], "owner": {"reputation": 516, "user_id": 5102865, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/71bf035de4fbcb43a6b9a1eb2d07c76e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Ryabov", "link": "https://stackoverflow.com/users/5102865/sergey-ryabov"}, "is_accepted": true, "score": 0, "last_activity_date": 1449669929, "last_edit_date": 1449669929, "creation_date": 1449668518, "answer_id": 34180283, "question_id": 34179888, "link": "https://stackoverflow.com/questions/34179888/check-for-duplicates-sum/34180283#34180283", "title": "Check for duplicates sum", "body": "<p>That should solve your problem:</p>\n\n<pre><code>Sub check_duplicates()\n\nDim x As Long\nDim LastRow As Long\n\nLastRow = Range(\"L65536\").End(xlUp).Row\nFor x = LastRow To 1 Step -1\n    If Application.WorksheetFunction.CountIf(Range(\"L2:L\" &amp; x), Range(\"L\" &amp; x).Value) &gt; 1 Then\n        Range(\"C\" &amp; x) = Left(Range(\"C\" &amp; x), 1) + 1 &amp; Mid(Range(\"C\" &amp; x), 2)\n    End If\nNext x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4664667, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/985f5d026e249c93d6e3623a209dc891?s=128&d=identicon&r=PG&f=1", "display_name": "jumbli", "link": "https://stackoverflow.com/users/4664667/jumbli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 34180283, "answer_count": 3, "score": 0, "last_activity_date": 1462522511, "creation_date": 1449667300, "last_edit_date": 1531161705, "question_id": 34179888, "link": "https://stackoverflow.com/questions/34179888/check-for-duplicates-sum", "title": "Check for duplicates sum", "body": "<p>I want to check for duplicates in a column and my code is able to do so. But when it finds a duplicate in column L i want it to add \"+1\" to the integer in column c. So if \"L5 and L6\" are the same, I want \"C5\" to be \"C5+1\". But I have not been able to figure out how to do so. </p>\n\n<pre><code>Sub check_duplicates()\n    Dim x As Long\n    Dim LastRow As Long\n\n    LastRow = Range(\"L65536\").End(xlUp).Row\n    For x = LastRow To 1 Step -1\n        If Application.WorksheetFunction.CountIf(Range(\"L2:L\" &amp; x), Range(\"L\" &amp; x).Value) &gt; 1 Then\n               Range(\"C\" &amp; x).Formula = \"=LEFT(x) + 1\"\n        End If\n    Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "autofilter", "vba"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 5469176, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/031e28aeacbf16f3a78ece53dcc8f18b?s=128&d=identicon&r=PG&f=1", "display_name": "SFro", "link": "https://stackoverflow.com/users/5469176/sfro"}, "edited": false, "score": 1, "creation_date": 1449668122, "post_id": 34179994, "comment_id": 56106411, "body": "Worked like a charm thank you Scott! Figures it was something that simple, I tend to over complicate..."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1449667612, "creation_date": 1449667612, "answer_id": 34179994, "question_id": 34179861, "link": "https://stackoverflow.com/questions/34179861/removing-single-autofilter-from-list/34179994#34179994", "title": "Removing single autofilter from list", "body": "<p>To turn off a filter for a specific field leave the <code>Criteria1</code> argument blank.</p>\n\n<p><code>.Range(\"B17:D17\").AutoFilter field:=3</code></p>\n\n<p>For example, the following code takes the following steps:</p>\n\n<ol>\n<li>Filters the first column for the value <code>12</code></li>\n<li>Filters the second column for the value <code>14</code></li>\n<li>Takes the filter off the second column, so it's back to just <code>12</code> on the first column.</li>\n</ol>\n\n<p>Example Code:</p>\n\n<pre><code>Range(\"A1:D6\").AutoFilter 1, 12\nRange(\"A1:D6\").AutoFilter 2, 14\nRange(\"A1:D6\").AutoFilter 2\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 5469176, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/031e28aeacbf16f3a78ece53dcc8f18b?s=128&d=identicon&r=PG&f=1", "display_name": "SFro", "link": "https://stackoverflow.com/users/5469176/sfro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1116, "favorite_count": 0, "accepted_answer_id": 34179994, "answer_count": 1, "score": 0, "last_activity_date": 1449667612, "creation_date": 1449667192, "last_edit_date": 1531164843, "question_id": 34179861, "link": "https://stackoverflow.com/questions/34179861/removing-single-autofilter-from-list", "title": "Removing single autofilter from list", "body": "<p>I have a filtered list, and would like to roll back filter criteria depending on what is selected from the list box in cell C11. Because there are going to be multiple columns to filter, simply using .autofilter = false would not achieve the desired effect, as it would roll back all filters and not just for a given column. Is there a way to turn off a single columns filter? </p>\n\n<pre><code>If Target.Address = \"$C$11\" Then\n    If Range(\"C11\").Value = \"All\" Then\n        With Sheets(\"Provider Front End\")\n        .Range(\"B17:D17\").AutoFilter field:=3, Critieria1:= 'turn off this single field?\n    End With\nElse\n    With Sheets(\"Provider Front End\")\n        .Range(\"B17:D17\").AutoFilter\n        .Range(\"B17:D17\").AutoFilter field:=3, Criteria1:=Range(\"C11\").Value\n    End With\nEnd If\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1449667080, "post_id": 34179693, "comment_id": 56105773, "body": "Simply Unprotect the sheet in the beginning of the code, and then protect it again in the end. That said, VBA and Excel aren&#39;t very secure, and anyone with any knowledge of VBA can access it."}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "is_accepted": true, "score": 1, "last_activity_date": 1449668329, "last_edit_date": 1449668329, "creation_date": 1449667316, "answer_id": 34179895, "question_id": 34179693, "link": "https://stackoverflow.com/questions/34179693/my-macro-wont-run-if-linked-worksheet-is-protected/34179895#34179895", "title": "My macro wont run if linked worksheet is protected", "body": "<p>Try this:</p>\n\n<pre><code>    Sub PASSWORD_CHECK()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Sheets(\"Sheet1\") ' Change the name of the sheet which is locked\n    ws.Unprotect Password:=\"YourPassWord\" ' Type your password\n\n    Application.Worksheets(\"Front sheet\").Range(\"B24\").Formula = (\"=VLOOKUP(D4,Lock!R:T,1,FALSE)\")     ' looks up school name\n    Application.Worksheets(\"Front sheet\").Range(\"B25\").Formula = (\"=EXACT(B24, D4)\")                   ' validation of school name\n    Application.Worksheets(\"Front sheet\").Range(\"B26\").Formula = (\"=VLOOKUP(D4,Lock!R3:T106,3,FALSE)\") ' looks up password\n    Application.Worksheets(\"Front sheet\").Range(\"B27\").Formula = (\"=EXACT(B26,D6)\")                    ' validates password\n    Application.Worksheets(\"Front sheet\").Range(\"B29\").Formula = (\"=IF(AND(B25,B27),1,0)\")             ' checks to validate both school and pasword\n    Application.Worksheets(\"Front sheet\").Range(\"B32\").Formula = (\"=IF(B27=B25,1,0)\") ' Checks to see if password belongs to school\n\n\n     Dim A As String\n     Dim B As String\n     Dim C As Boolean\n     Dim D As String\n     Dim E As String\n     Dim F As Boolean\n\n        A = Worksheets(\"Staff Salaries\").Range(\"P3\")\n        B = Worksheets(\"Staff Salaries\").Range(\"N2\")\n        C = Worksheets(\"Front sheet\").Range(\"B29\")\n        D = Worksheets(\"Front sheet\").Range(\"D4\")\n        E = Worksheets(\"Front sheet\").Range(\"D6\")\n        F = Worksheets(\"Front sheet\").Range(\"B32\")\n\n     If C = \"TRUE\" And F = \"TRUE\" Then                   ' All OK\n\n            Worksheets(\"Staff Salaries\").Range(\"N2\") = D\n            Worksheets(\"Staff Salaries\").Range(\"P3\") = E\n        Else\n                           MsgBox (\"PASSWORD IS INCONSISTANT WITH USER\")\n    End If\n\n   ws.Protect Password:=\"YourPassWord\"  \n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 34179895, "answer_count": 1, "score": 1, "last_activity_date": 1449676639, "creation_date": 1449666654, "last_edit_date": 1449676639, "question_id": 34179693, "link": "https://stackoverflow.com/questions/34179693/my-macro-wont-run-if-linked-worksheet-is-protected", "title": "My macro wont run if linked worksheet is protected", "body": "<p>The purpose of this macro is to check that a username and password on the front sheet matches that of the password subscribed to a specif person to see if it matches, it then plants the username and password on the \"Staff Salaries\" sheet indefinitely. </p>\n\n<p>The trouble im having is to stop someone changing the username and password that's been planted I lock the cells as the sheet is protected anyway, this seems to stop the macro working as it says it cannot change the cells if they are locked.</p>\n\n<p>Is there an alternative i could use to prevent the clash?  </p>\n\n<pre><code>Sub PASSWORD_CHECK()\n\nApplication.Worksheets(\"Front sheet\").Range(\"B24\").Formula = (\"=VLOOKUP(D4,Lock!R:T,1,FALSE)\")     ' looks up school name\nApplication.Worksheets(\"Front sheet\").Range(\"B25\").Formula = (\"=EXACT(B24, D4)\")                   ' validation of school name\nApplication.Worksheets(\"Front sheet\").Range(\"B26\").Formula = (\"=VLOOKUP(D4,Lock!R3:T106,3,FALSE)\") ' looks up password\nApplication.Worksheets(\"Front sheet\").Range(\"B27\").Formula = (\"=EXACT(B26,D6)\")                    ' validates password\nApplication.Worksheets(\"Front sheet\").Range(\"B29\").Formula = (\"=IF(AND(B25,B27),1,0)\")             ' checks to validate both school and pasword\nApplication.Worksheets(\"Front sheet\").Range(\"B32\").Formula = (\"=IF(B27=B25,1,0)\") ' Checks to see if password belongs to school\n\n\n Dim A As String\n Dim B As String\n Dim C As Boolean\n Dim D As String\n Dim E As String\n Dim F As Boolean\n\n    A = Worksheets(\"Staff Salaries\").Range(\"P3\")\n    B = Worksheets(\"Staff Salaries\").Range(\"N2\")\n    C = Worksheets(\"Front sheet\").Range(\"B29\")\n    D = Worksheets(\"Front sheet\").Range(\"D4\")\n    E = Worksheets(\"Front sheet\").Range(\"D6\")\n    F = Worksheets(\"Front sheet\").Range(\"B32\")\n\n If C = \"TRUE\" And F = \"TRUE\" Then                   ' All OK\n\n        Worksheets(\"Staff Salaries\").Range(\"N2\") = D\n        Worksheets(\"Staff Salaries\").Range(\"P3\") = E\n    Else\n                       MsgBox (\"PASSWORD IS INCONSISTANT WITH USER\")\nEnd If\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5116968, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10202793545719164/picture?type=large", "display_name": "Payal Kumar", "link": "https://stackoverflow.com/users/5116968/payal-kumar"}, "edited": false, "score": 1, "creation_date": 1449830761, "post_id": 34180262, "comment_id": 56187199, "body": "I got the formula by simply putting the formulae and recording a macro.So i get them in the right format. Thank you for the help."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1449668449, "creation_date": 1449668449, "answer_id": 34180262, "question_id": 34179658, "link": "https://stackoverflow.com/questions/34179658/put-formula-with-if-statements-in-the-entire-columns/34180262#34180262", "title": "Put formula with if statements in the entire columns", "body": "<p>The issue here is the multiples <code>\"</code>, and you also have a different kind of these : <code>\u201c</code> which do not work!</p>\n\n<p>So replace the <code>\"</code> by <code>Chr(34)</code> like this :</p>\n\n<pre><code>Sub formula()\nRange(\"CO2:CO\").formula = \"=IF(OR(LEN($BN2)=0;$BN2=\" &amp; Chr(34) &amp; \"Not Performed\" &amp; Chr(34) &amp; _\n            \";LEN($BK2)=0;$BK2=\" &amp; Chr(34) &amp; \"Not Performed\" &amp; Chr(34) &amp; _\n            \";LEN($BL2)=0;$Q2=\" &amp; Chr(34) &amp; \"Not Performed\" &amp; Chr(34) &amp; _\n            \";LEN($BM2)=0);\" &amp; Chr(34) &amp; \"Yes\" &amp; Chr(34) &amp; \";\" &amp; Chr(34) &amp; _\n            \"No\" &amp; Chr(34) &amp; \")\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5116968, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10202793545719164/picture?type=large", "display_name": "Payal Kumar", "link": "https://stackoverflow.com/users/5116968/payal-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 34180262, "answer_count": 1, "score": 0, "last_activity_date": 1488361830, "creation_date": 1449666544, "last_edit_date": 1488361830, "question_id": 34179658, "link": "https://stackoverflow.com/questions/34179658/put-formula-with-if-statements-in-the-entire-columns", "title": "Put formula with if statements in the entire columns", "body": "<p>I have recorded a macro with the following formula, but it gives me an error in the second line. </p>\n\n<blockquote>\n  <p>Expected end of statement. </p>\n</blockquote>\n\n<p>I guess the issue is that its way to long. Please suggest how to make this work?</p>\n\n<p>Sub Macro1()</p>\n\n<pre><code>    Range(\"CG2\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=IF(RC69=\"\"High\"\",(IF(AND(RC4&lt;&gt;\"\"\"\",RC5&lt;&gt;\"\"\"\",RC6&lt;&gt;\"\"\"\",RC7&lt;&gt;\"\"\"\",RC8&lt;&gt;\"\"\"\",RC10&lt;&gt;\"\"\"\",RC11&lt;&gt;\"\"\"\",RC12&lt;&gt;\"\"\"\",RC13&lt;&gt;\"\"\"\",RC14&lt;&gt;\"\"\"\",RC16&lt;&gt;\"\"\"\",RC17&lt;&gt;\"\"\"\",RC18&lt;&gt;\"\"\"\",RC19&lt;&gt;\"\"\"\",RC20&lt;&gt;\"\"\"\",RC21&lt;&gt;\"\"\"\",RC22&lt;&gt;\"\"\"\",RC23&lt;&gt;\"\"\"\",RC24&lt;&gt;\"\"\"\",RC25&lt;&gt;\"\"\"\",RC26&lt;&gt;\"\"\"\",RC27&lt;&gt;\"\"\"\",RC28&lt;&gt;\"\"\"\",RC29&lt;&gt;\"\"\"\",RC30&lt;&gt;\"\"\"\",RC31&lt;&gt;\"\"\"\",RC32&lt;&gt;\"\"\"\",RC33&lt;&gt;\"\"\"\",RC34&lt;&gt;\"\"\"\",RC35&lt;&gt;\"\"\"\",RC36&lt;&gt;\"\"\"\",RC37&lt;&gt;\"\"\"\",RC38&lt;&gt;\"\"\"\",RC39&lt;&gt;\"\"\"\",RC40&lt;&gt;\"\"\"\",RC41&lt;&gt;\"\"\"\",RC42&lt;&gt;\"\"\"\",RC43&lt;&gt;\"\"\"\",RC44&lt;&gt;\"\"\"\",RC45&lt;&gt;\"\"\"\",RC46&lt;&gt;\"\"\"\"),\"\"No\"\",\"\"Yes\"\")),\" &amp; Chr(10) &amp; \"(IF(RC69=\"\"Medium\"\",(IF(AND(RC4&lt;&gt;\"\"\"\",RC5&lt;&gt;\"\"\"\",RC6&lt;&gt;\"\"\"\",RC7&lt;&gt;\"\"\"\",RC8&lt;&gt;\"\"\"\",RC10&lt;&gt;\"\"\"\",RC11&lt;&gt;\"\"\"\",RC12&lt;&gt;\"\"\"\",RC13&lt;&gt;\"\"\"\",RC14&lt;&gt;\"\"\"\",RC16&lt;&gt;\"\"\"\",RC17&lt;&gt;\"\"\"\",RC18&lt;&gt;\"\"\"\",RC19&lt;&gt;\"\"\"\",RC20&lt;&gt;\"\"\"\",RC21&lt;&gt;\"\"\"\",RC22&lt;&gt;\"\"\"\",RC23&lt;&gt;\"\"\"\",RC31&lt;&gt;\"\"\"\",RC32&lt;&gt;\"\"\"\",RC33&lt;&gt;\"\"\"\",RC34&lt;&gt;\"\"\"\",RC35&lt;&gt;\"\"\"\",RC36&lt;&gt;\"\"\"\",RC37&lt;&gt;\"\"\"\",RC38&lt;&gt;\"\"\"\",RC39&lt;&gt;\"\"\"\",RC40&lt;&gt;\"\"\"\",RC41&lt;&gt;\"\"\"\",RC42&lt;&gt;\"\"\"\",RC44&lt;&gt;\"\"\"\",RC45&lt;&gt;\"\"\"\",RC46&lt;&gt;\"\"\"\"),\"\"No\"\",\"\"Yes\"\")),\" &amp; Chr(10) &amp; \"(IF(AND(RC4&lt;&gt;\"\"\"\",RC5&lt;&gt;\"\"\"\",RC6&lt;&gt;\"\"\"\",RC7&lt;&gt;\"\"\"\",RC8&lt;&gt;\"\"\"\",RC10&lt;&gt;\"\"\"\",RC11&lt;&gt;\"\"\"\",RC12&lt;&gt;\"\"\"\"\n\"\"\",RC14&lt;&gt;\"\"\"\",RC16&lt;&gt;\"\"\"\",RC17&lt;&gt;\"\"\"\",RC18&lt;&gt;\"\"\"\",RC19&lt;&gt;\"\"\"\",RC20&lt;&gt;\"\"\"\",RC31&lt;&gt;\"\"\"\",RC32&lt;&gt;\"\"\"\",RC33&lt;&gt;\"\"\"\",RC34&lt;&gt;\"\"\"\",RC35&lt;&gt;\"\"\"\",RC36&lt;&gt;\"\"\"\",RC37&lt;&gt;\"\"\"\",RC38&lt;&gt;\"\"\"\",RC39&lt;&gt;\"\"\"\",RC41&lt;&gt;\"\"\"\",RC42&lt;&gt;\"\"\"\",RC45&lt;&gt;\"\"\"\",RC46&lt;&gt;\"\"\"\"),\"\"No\"\",\"\"Yes\"\")))))\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1449666912, "post_id": 34179411, "comment_id": 56105657, "body": "Think you&#39;ll have to use .Item(1) after .FullSeriesCollection, and then don&#39;t specify a number on  .FullSeriesCollection, like .FullSeriesCollection.Item(i)"}, {"owner": {"reputation": 11, "user_id": 5659144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92773a086688553c5d9a82d44fa2216d?s=128&d=identicon&r=PG&f=1", "display_name": "vir.2000", "link": "https://stackoverflow.com/users/5659144/vir-2000"}, "reply_to_user": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1449673918, "post_id": 34179411, "comment_id": 56110656, "body": "Thank you Alex 4336 for the advice."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5659144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92773a086688553c5d9a82d44fa2216d?s=128&d=identicon&r=PG&f=1", "display_name": "vir.2000", "link": "https://stackoverflow.com/users/5659144/vir-2000"}, "edited": false, "score": 0, "creation_date": 1449673964, "post_id": 34179956, "comment_id": 56110691, "body": "Thank you R3uK for your help on this matter and the clue to improve my coding. I used your code. It stops on line: Set cH = ws2.Shapes.AddChart2(201, xlColumnClustered) Error message: Run-time error 13: type mismatch However: Dim cH As Chart What could be wrong?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 11, "user_id": 5659144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92773a086688553c5d9a82d44fa2216d?s=128&d=identicon&r=PG&f=1", "display_name": "vir.2000", "link": "https://stackoverflow.com/users/5659144/vir-2000"}, "edited": false, "score": 0, "creation_date": 1449674483, "post_id": 34179956, "comment_id": 56111095, "body": "try to <code>dim Sh as Shape</code> and change <code>ch</code> to <code>sh</code> in the line, and then <code>set ch = sh.chart</code>, I seem to remember I already encountered that"}, {"owner": {"reputation": 11, "user_id": 5659144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92773a086688553c5d9a82d44fa2216d?s=128&d=identicon&r=PG&f=1", "display_name": "vir.2000", "link": "https://stackoverflow.com/users/5659144/vir-2000"}, "edited": false, "score": 0, "creation_date": 1449684710, "post_id": 34179956, "comment_id": 56118247, "body": "I\u2019m sorry to come again with my problem. When using the code with the data copied from the other sheet it stops exactly on the same line as before: .FullSeriesCollection.Item(2).ChartType = xlColumnClustered. However I tried again to use the table with the data added manually and the code runs OK. It creates the chart as expected. I presume that the Excel routine to build this type of chart is facing a problem of internal addressing procedures that are not present when the data is not coming from elsewhere. This is far from my basic knowledge. I hope you could help me. Thank you."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 11, "user_id": 5659144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92773a086688553c5d9a82d44fa2216d?s=128&d=identicon&r=PG&f=1", "display_name": "vir.2000", "link": "https://stackoverflow.com/users/5659144/vir-2000"}, "edited": false, "score": 0, "creation_date": 1449817217, "post_id": 34179956, "comment_id": 56179851, "body": "@vir.2000 : Strange indeed... I can&#39;t get my head around that... Have you tried to paste the data manually and define <code>Area</code> manually to test the last part of code? And what is the error that you have with the programmatic copy?"}, {"owner": {"reputation": 11, "user_id": 5659144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92773a086688553c5d9a82d44fa2216d?s=128&d=identicon&r=PG&f=1", "display_name": "vir.2000", "link": "https://stackoverflow.com/users/5659144/vir-2000"}, "edited": false, "score": 0, "creation_date": 1449840988, "post_id": 34179956, "comment_id": 56193540, "body": "Hi R3uK. The macro code stops at line: .FullSeriesCollection.Item(2).ChartType = xlColumnClustered with error 1004. The odd thing is that when creating exactly the same table with manual inputs, there is no error and the chart is built as expected. (I need to say more but the space do not allows)."}, {"owner": {"reputation": 11, "user_id": 5659144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92773a086688553c5d9a82d44fa2216d?s=128&d=identicon&r=PG&f=1", "display_name": "vir.2000", "link": "https://stackoverflow.com/users/5659144/vir-2000"}, "edited": false, "score": 0, "creation_date": 1449841186, "post_id": 34179956, "comment_id": 56193644, "body": "The error occurs when the data is transferred programmatically or manually by copy and paste. That is, when it comes from elseware. It runs OK only when the data is written by hand."}, {"owner": {"reputation": 11, "user_id": 5659144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92773a086688553c5d9a82d44fa2216d?s=128&d=identicon&r=PG&f=1", "display_name": "vir.2000", "link": "https://stackoverflow.com/users/5659144/vir-2000"}, "edited": false, "score": 0, "creation_date": 1449841202, "post_id": 34179956, "comment_id": 56193659, "body": "I made several tests with no result: using other sheets or modifying the cells formatting. I also tested building the chat in the sheet where the data is but coping it to different cells with no success. You may questioning: why do I not try to build the chart getting the data directly from the original cells? The reason is because I don\u2019t know how to use non adjacent columns to build the chart. The original table has columns from A to F and I want to skip column B. Nevertheless, the 1004 error is a mystery. Thank you for your assistance."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 11, "user_id": 5659144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92773a086688553c5d9a82d44fa2216d?s=128&d=identicon&r=PG&f=1", "display_name": "vir.2000", "link": "https://stackoverflow.com/users/5659144/vir-2000"}, "edited": false, "score": 0, "creation_date": 1449842464, "post_id": 34179956, "comment_id": 56194437, "body": "Do you have any formulas in your initial values? And you may create the graph from the initial source and then delete the serie that use column B, I don&#39;t how to this by heart but you may be able to find the source range in a property (use F2 in VBE to see Object Browser and fin the one) of the serie, so that you can choose which serie to delete! ;)"}, {"owner": {"reputation": 11, "user_id": 5659144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92773a086688553c5d9a82d44fa2216d?s=128&d=identicon&r=PG&f=1", "display_name": "vir.2000", "link": "https://stackoverflow.com/users/5659144/vir-2000"}, "edited": false, "score": 0, "creation_date": 1449925743, "post_id": 34179956, "comment_id": 56222405, "body": "I\u2019m lost in the object browser window. I still have much of VBA to learn. Back to the charts building problem, the data I\u2019m using does not include formulas. I\u2019m doing more experiments and notice that if I create a new table in a new workbook and a macro to build a chart, at first the code runs OK but stops with error 1004 on further modifications. The modifications consist in copping and pasting the table to some columns aside on the same sheet and modifying the range in the code accordingly..."}, {"owner": {"reputation": 11, "user_id": 5659144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92773a086688553c5d9a82d44fa2216d?s=128&d=identicon&r=PG&f=1", "display_name": "vir.2000", "link": "https://stackoverflow.com/users/5659144/vir-2000"}, "edited": false, "score": 0, "creation_date": 1449925795, "post_id": 34179956, "comment_id": 56222422, "body": "I insisted in this approach because the data I use in my application has been copied programmatically from other places. It seems that occurs some sort of a memory effect that upsets the application when the data that I use derive from other places. If it is so, then it is kept registered for ever once the problem persists after closing and reopening the application. Many thanks."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1449736467, "last_edit_date": 1449736467, "creation_date": 1449667510, "answer_id": 34179956, "question_id": 34179411, "link": "https://stackoverflow.com/questions/34179411/building-a-chart-with-imported-data-from-another-sheet-gives-error-1004/34179956#34179956", "title": "Building a chart with imported data from another sheet gives error 1004", "body": "<p>You need to use <code>.Item()</code> after <code>.FullSeriesCollection</code> and there is an easier method to calculate last row :</p>\n\n<pre><code>Sub MacroChart()\nDim n As Long, _\n    wS1 As Worksheet, _\n    ws2 As Worksheet, _\n    Area As String, _\n    cH As Chart, _\n    Sh as Shape\n    'Copy data from \"Sheet1\" to Sheet2\n    'Copying column by column because I read somewhere that it may solve the problem.\n    'Unfortunatly, not.\n    Set wS1 = Worksheets(\"Sheet1\")\n    Set ws2 = Worksheets(\"Sheet2\")\n    n = wS1.Range(\"A\" &amp; wS1.Rows.Count).End(xlUp).Row\n\n    'I need to skip column B\n    from1 = \"A3:A\" &amp; n\n    from2 = \"C3:C\" &amp; n\n    from3 = \"D3:D\" &amp; n\n    from4 = \"E3:E\" &amp; n\n    from5 = \"F3:F\" &amp; n\n\n    n = n - 2\n    to1 = \"A1:A\" &amp; n\n    to2 = \"B1:B\" &amp; n\n    to3 = \"C1:C\" &amp; n\n    to4 = \"D1:D\" &amp; n\n    to5 = \"E1:E\" &amp; n\n    'The current table will have 5 columns and 54 lines, all cells filled\n    With ws2\n        .Range(to1).Value = wS1.Range(from1).Value\n        .Range(to2).Value = wS1.Range(from2).Value\n        .Range(to3).Value = wS1.Range(from3).Value\n        .Range(to4).Value = wS1.Range(from4).Value\n        .Range(to5).Value = wS1.Range(from5).Value\n    End With\n    Area = \"$A$1:$E$\" &amp; n\n\n    'Creating the chart\n    'The code stops on line \"FullSeriesCollection(2).ChartType...\"\n    Set Sh = ws2.Shapes.AddChart2(201, xlColumnClustered)\n    Set cH = Sh.Chart\n    With cH\n        .SetSourceData Source:=w2.Range(Area)\n        .FullSeriesCollection.Item(1).ChartType = xlColumnClustered\n        .FullSeriesCollection.Item(1).AxisGroup = 1\n        .FullSeriesCollection.Item(2).ChartType = xlColumnClustered\n        .FullSeriesCollection.Item(2).AxisGroup = 1\n        .FullSeriesCollection.Item(3).ChartType = xlLine\n        .FullSeriesCollection.Item(3).AxisGroup = 1\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5659144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92773a086688553c5d9a82d44fa2216d?s=128&d=identicon&r=PG&f=1", "display_name": "vir.2000", "link": "https://stackoverflow.com/users/5659144/vir-2000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449736467, "creation_date": 1449665843, "last_edit_date": 1449666694, "question_id": 34179411, "link": "https://stackoverflow.com/questions/34179411/building-a-chart-with-imported-data-from-another-sheet-gives-error-1004", "title": "Building a chart with imported data from another sheet gives error 1004", "body": "<p>I have this macro to buil a chart that gets error 1004 when using a table in one sheet filled with data imported from a different sheet. It works fine when I use exactly the same table but created manually in the current sheet. This is my code. Can I have some help?</p>\n\n<pre><code>Sub MacroChart()\n    'Copy data from \"Sheet1\" to Sheet2\n    'Copying column by column because I read somewhere that it may solve the problem.\n    'Unfortunatly, not.\n    n = 3\n    While Worksheets(\"Sheet1\").Cells(n, 1) &lt;&gt; \"\"\n        n = n + 1\n    Wend\n    n = n - 1\n    'I need to skip column B\n    from1 = \"A3:A\" &amp; n\n    from2 = \"C3:C\" &amp; n\n    from3 = \"D3:D\" &amp; n\n    from4 = \"E3:E\" &amp; n\n    from5 = \"F3:F\" &amp; n\n    n = n - 2\n    to1 = \"A1:A\" &amp; n\n    to2 = \"B1:B\" &amp; n\n    to3 = \"C1:C\" &amp; n\n    to4 = \"D1:D\" &amp; n\n    to5 = \"E1:E\" &amp; n\n    'The current table will have 5 columns and 54 lines, all cells filled\n    With Worksheets(\"Sheet2\")\n        .Range(to1).Value = Worksheets(\"Sheet1\").Range(from1).Value\n        .Range(to2).Value = Worksheets(\"Sheet1\").Range(from2).Value\n        .Range(to3).Value = Worksheets(\"Sheet1\").Range(from3).Value\n        .Range(to4).Value = Worksheets(\"Sheet1\").Range(from4).Value\n        .Range(to5).Value = Worksheets(\"Sheet1\").Range(from5).Value\n    End With\n    area = \"$A$1:$E$\" &amp; n\n\n    'Creating the chart\n    'The code stops on line \"FullSeriesCollection(2).ChartType...\"\n    ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n    ActiveChart.SetSourceData Source:=Worksheets(\"Sheet2\").Range(area)\n    ActiveChart.FullSeriesCollection(1).ChartType = xlColumnClustered\n    ActiveChart.FullSeriesCollection(1).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(2).ChartType = xlColumnClustered\n    ActiveChart.FullSeriesCollection(2).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(3).ChartType = xlLine\n    ActiveChart.FullSeriesCollection(3).AxisGroup = 1\nEnd Sub\n</code></pre>\n"}, {"tags": ["database", "ms-access", "vba", "type-conversion"], "answers": [{"comments": [{"owner": {"reputation": 3329, "user_id": 466339, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/960652dda2d376483116e2fa230b5e32?s=128&d=identicon&r=PG", "display_name": "j4x", "link": "https://stackoverflow.com/users/466339/j4x"}, "edited": false, "score": 0, "creation_date": 1449672931, "post_id": 34179984, "comment_id": 56109961, "body": "Hello Gustav. Thanks for your answer. Unfortunately <code>Val()</code> is not what I am looking for neither is it a panacea. <code>Val()</code> only serves in conversions from <code>String</code> to number and is severely limited on localised numbers. In the end I don&#180;t have the original information, but a parsed one."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3329, "user_id": 466339, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/960652dda2d376483116e2fa230b5e32?s=128&d=identicon&r=PG", "display_name": "j4x", "link": "https://stackoverflow.com/users/466339/j4x"}, "edited": false, "score": 0, "creation_date": 1449675830, "post_id": 34179984, "comment_id": 56112116, "body": "I don&#39;t know &quot;what you are looking for&quot;. I have programmed in Access since version 1.0 and have never met this as an issue you could not easily work around, so I have the feeling that you are chasing ghosts. <code>Val</code> works for any integer/long which was what you mentioned. If you have decimals not having dot as decimal separator, use <code>CCur</code> or <code>CDbl</code>."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1449676089, "last_edit_date": 1449676089, "creation_date": 1449667597, "answer_id": 34179984, "question_id": 34179018, "link": "https://stackoverflow.com/questions/34179018/ms-access-vba-listbox-itemdata-underlying-data-type/34179984#34179984", "title": "MS-Access VBA Listbox.ItemData underlying data type", "body": "<p><em>List</em>- and <em>ComboBox</em> always returns a string.</p>\n\n<p>It's really no big deal. You will know the data type of the field of your recordset, so just convert if needed - like:</p>\n\n<pre><code>rs!Manufacturer.Value = Val(Me!myListbox.ItemData(Index))\n</code></pre>\n\n<p><strong>Addendum</strong></p>\n\n<p>If you wish to carry forward the data type, just do so by adding a column to the listbox you fill with <code>VarType</code> of the value when you fill the listbox.</p>\n\n<p>When reading a value from the listbox, also read the (hidden) column holding the data type, and have a function with a <code>Select .. Case</code> construct to convert the text value to the original data type.</p>\n"}], "owner": {"reputation": 3329, "user_id": 466339, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/960652dda2d376483116e2fa230b5e32?s=128&d=identicon&r=PG", "display_name": "j4x", "link": "https://stackoverflow.com/users/466339/j4x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 712, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449676089, "creation_date": 1449664667, "question_id": 34179018, "link": "https://stackoverflow.com/questions/34179018/ms-access-vba-listbox-itemdata-underlying-data-type", "title": "MS-Access VBA Listbox.ItemData underlying data type", "body": "<p>Please consider the tiny snippet below:</p>\n\n<pre><code> If rs!Manufacturer = myListbox.ItemData(Index) Then\n</code></pre>\n\n<p>And this two watches:</p>\n\n<pre><code>Watch :  rs!Manufacturer.Value            :  1    : Variant/Long\nWatch :  Me.myListbox.ItemData(Index)     : \"1\"   : Variant/String\n</code></pre>\n\n<p>Being <code>rs!Manufacturer.Value</code> an integer value from a table <code>myTable</code> retrieved by recordset <code>rs</code> and <code>Me.myListbox.ItemData(Index)</code> the exact same data but shown in a <code>ListBox</code> control in my form and retrieved from the very same table.</p>\n\n<p>It seems very clear that listbox is converting the original data type to a string representation of the original value and so, the comparison with the given values fail while I was expecting it to succeed...</p>\n\n<p><strong>So the question is: is there a (simple) way to retrieve data from my listbox with the original data type (in other words, the same data type as it is in my table)?</strong></p>\n\n<p>Many can point that I could easily convert the listbox value back to integer with <code>CInt()</code> or <code>CLng()</code> but it would make my code heavily bound to each specific situation while retrieving data in its original type, no matter which, would make code cleaner and still fully reliable.</p>\n\n<p>Ok, another idea would be converting the recordset value to <code>string</code> as well but from a C-programmer perspective it seems too painful to me, so I\u00b4d rather avoid it.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ms-access", "vba", "32bit-64bit"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1449667893, "creation_date": 1449667893, "answer_id": 34180074, "question_id": 34178312, "link": "https://stackoverflow.com/questions/34178312/mixing-access-64-bit-clients-with-access-32-bit-clients/34180074#34180074", "title": "Mixing Access 64-bit clients with Access 32-bit clients", "body": "<p>The <code>accdb</code> is the same, the only difference will be that if your code includes calls to the API, that code must adopt to the 32- or 64-bit environment using <code>PtrSafe</code>. Just Google/Bing on this if this is relevant for your application.</p>\n"}], "owner": {"reputation": 133, "user_id": 1401286, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f754444b21036c3a51bf8eb4fde12e59?s=128&d=identicon&r=PG", "display_name": "Andrew Richards", "link": "https://stackoverflow.com/users/1401286/andrew-richards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459421444, "creation_date": 1449662408, "last_edit_date": 1459421444, "question_id": 34178312, "link": "https://stackoverflow.com/questions/34178312/mixing-access-64-bit-clients-with-access-32-bit-clients", "title": "Mixing Access 64-bit clients with Access 32-bit clients", "body": "<p>We are building an Access database application. The data will also be stored in an Access file, although obviously we'll be be splitting front end and back end.</p>\n\n<p>The guy I'm working with has 64-bit Office 2013 installed on his Windows 7 PC, and requires it for the very large Excel files he's working with. Our database will essentially extract data from these spreadsheets and import it into various tables within the database.</p>\n\n<p>However, there are various other people who will need to use the database. They're all using 32-bit Office 2013. </p>\n\n<p>Will this cause a problem? Has anyone any experience of developing for a mixed environment like this? Can it even be done, or will the application developed on a 64-bit version of office fail to compile when on a 32-bit office PC?</p>\n"}, {"tags": ["vba", "checkbox", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 2717, "user_id": 124201, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/35a88253d5e049ac49a29afcf35ca762?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/124201/nick"}, "edited": false, "score": 0, "creation_date": 1449662617, "post_id": 34178279, "comment_id": 56103031, "body": "Thank you! I&#39;ve just updated to <code>.Value</code> but still get the same problem unfortunately (i.e. nothing happens when I check the checkboxes) - I&#39;m very keen to use radio buttons but couldn&#39;t figure out how to use them other than using an ActiveX control which won&#39;t let me change the layout of it (i.e. a radio buttons directly to the left) - I&#39;m editing someone else&#39;s form and it needs to look the same unfortunately."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 2717, "user_id": 124201, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/35a88253d5e049ac49a29afcf35ca762?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/124201/nick"}, "edited": false, "score": 1, "creation_date": 1449663235, "post_id": 34178279, "comment_id": 56103406, "body": "@Nick Do you  have other event handlers that manipulate the checkboxes? Are they initially enabled when you check them? Besides, you need to add a similar handler for each checkbox."}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "reply_to_user": {"reputation": 2717, "user_id": 124201, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/35a88253d5e049ac49a29afcf35ca762?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/124201/nick"}, "edited": false, "score": 1, "creation_date": 1449663491, "post_id": 34178279, "comment_id": 56103565, "body": "@Nick I have edited my answer. Your issue was caused by events cascade. I think it is a bug in VBA - you have <code>Click</code> events for your checkboxes (not <code>Change</code>) and they should not been triggered everytime the value of the control is changed, but unfortunately they are."}, {"owner": {"reputation": 2717, "user_id": 124201, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/35a88253d5e049ac49a29afcf35ca762?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/124201/nick"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1449664221, "post_id": 34178279, "comment_id": 56104004, "body": "Thanks both, @A.S.H no this is the only code I have: <a href=\"http://i.imgur.com/3ulLc5r.png\" rel=\"nofollow noreferrer\">i.imgur.com/3ulLc5r.png</a>"}, {"owner": {"reputation": 2717, "user_id": 124201, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/35a88253d5e049ac49a29afcf35ca762?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/124201/nick"}, "edited": false, "score": 0, "creation_date": 1449664226, "post_id": 34178279, "comment_id": 56104007, "body": "@mielk thank you, unfortunately I&#39;m still not getting anything when I click on the Checkboxes :("}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1449764235, "post_id": 34178279, "comment_id": 56157919, "body": "Downvote: not an answer since the OP specifically states he does not want to use ActiveX controls and the suggestion works only for ActiveX."}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 0, "last_activity_date": 1449663414, "last_edit_date": 1449663414, "creation_date": 1449662298, "answer_id": 34178279, "question_id": 34178236, "link": "https://stackoverflow.com/questions/34178236/word-how-to-uncheck-checkboxes/34178279#34178279", "title": "Word - how to uncheck checkboxes?", "body": "<p>The property you need is <code>Value</code>, not <code>Enabled</code>.\nThe purpose of property <code>Enabled</code> is to prevent a control from being changed by user.</p>\n\n<p>Additionaly, you need to prevent it from the events cascade. It means that when you change programatically the value of <code>Check2</code>, this will trigger <code>Private Sub Check2_Click()</code> and so on.</p>\n\n<p>In order to make it work you should change your code like that:</p>\n\n<pre><code>Private Sub Check1_Click()\n    If Check1.Value Then\n        Check1.Value = True\n        Check2.Value = False\n        Check3.Value = False\n        Check4.Value = False\n    End If\nEnd Sub\n</code></pre>\n\n<p>and similarly for the other check boxes.</p>\n\n<hr>\n\n<p>For your purpose <strong>radio buttons</strong> will be better choice. Radio buttons have built-in functionality to uncheck currently selected button if other one is checked.</p>\n"}, {"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1449676723, "creation_date": 1449676723, "answer_id": 34183306, "question_id": 34178236, "link": "https://stackoverflow.com/questions/34178236/word-how-to-uncheck-checkboxes/34183306#34183306", "title": "Word - how to uncheck checkboxes?", "body": "<p>If these are Content Controls, as you indicate, then they do not have a CLICK event. Nor can they be identified by VBA by their Title property. The code you show us is for ActiveX controls, which you say you don't want to use...</p>\n\n<p>Working with content control events is not as simple and intuitive as with ActiveX controls. Similar to form fields, Content Controls only have \"editing\" events that trigger on the user entering and exiting the content control. These events are available in the ThisDocument module, in the Document category. </p>\n\n<p>The same ContentControlOnExit event triggers for ALL content controls in the document, so you need a Select Case or If conditional to query the ContentControl argument in order to know which content control was exited.</p>\n\n<p>In order to address the other checkboxes you need to use the Document.SelectContentControlsByTitle (or ...ByTag) method which returns an array of all content controls with that title (or tag).</p>\n\n<p>If you really want to emulate a \"click\" event then you need to insert a Custom XML Part in the document with nodes linked to the content controls. When the user changes the state of the control the ContentControlBeforeStoreUpdate event will trigger, letting you take action. </p>\n"}], "owner": {"reputation": 2717, "user_id": 124201, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/35a88253d5e049ac49a29afcf35ca762?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/124201/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5023, "favorite_count": 0, "accepted_answer_id": 34183306, "answer_count": 2, "score": 0, "last_activity_date": 1449676723, "creation_date": 1449662151, "question_id": 34178236, "link": "https://stackoverflow.com/questions/34178236/word-how-to-uncheck-checkboxes", "title": "Word - how to uncheck checkboxes?", "body": "<p>I have 4 checkboxes but we need to restrict selection to just a single one, meaning if you check the first, the other 3 will go unchecked. I know we could use ActiveX radio buttons but we'd prefer to avoid ActiveX if possible, plus with check boxes we have more control over the layout.</p>\n\n<p>I've set the name of the checkbox appropriately to <code>Check1</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LKEE8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LKEE8.png\" alt=\"enter image description here\"></a></p>\n\n<p>And then I've put this very basic script into the Visual Basic section:</p>\n\n<p><code>Private Sub Check1_Click()\n    Check1.Enabled = True\n    Check2.Enabled = False\n    Check3.Enabled = False\n    Check4.Enabled = False\nEnd Sub</code></p>\n\n<p>But unfortunately checking the first box doesn't uncheck the next 3.</p>\n\n<p><a href=\"https://i.stack.imgur.com/gpzph.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gpzph.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any ideas please? Thank you!</p>\n"}, {"tags": ["vba", "excel", "grouping"], "comments": [{"owner": {"reputation": 8095, "user_id": 250725, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/T5rng.jpg?s=128&g=1", "display_name": "psubsee2003", "link": "https://stackoverflow.com/users/250725/psubsee2003"}, "edited": false, "score": 0, "creation_date": 1449663907, "post_id": 34177113, "comment_id": 56103776, "body": "<code>Any macro suggestions I&#39;ve seen on here haven&#39;t been helpful to me, I keep getting errors coming up so I don&#39;t know what the problem is. This is the one I tried.....</code> It would be very beneficial to getting an answer for you to explain why your example didn&#39;t work.  What errors did you get and on what line."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1449665144, "post_id": 34177113, "comment_id": 56104527, "body": "Or you could just use a Pivot Table (and code it if you must use VBA)"}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "is_accepted": true, "score": 1, "last_activity_date": 1449665101, "creation_date": 1449665101, "answer_id": 34179168, "question_id": 34177113, "link": "https://stackoverflow.com/questions/34177113/macro-to-group-data-by-month/34179168#34179168", "title": "Macro to group data by month", "body": "<p>I follow your image to write the code:\n<a href=\"https://i.stack.imgur.com/y9vwA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y9vwA.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>After the code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bsVCN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bsVCN.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code: </p>\n\n<pre><code>Sub TEST()\nDim lastrow As Long\n\nlastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n\n\nFor i = 6 To lastrow\n\nlastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For j = i + 1 To lastrow\n\n            If Range(\"A\" &amp; j) = Range(\"A\" &amp; i) And Range(\"C\" &amp; j) = Range(\"C\" &amp; i) Then\n\n                Range(\"B\" &amp; i) = Range(\"B\" &amp; i) &amp; \",\" &amp; \" \" &amp; Range(\"B\" &amp; j)\n                Range(\"E\" &amp; i) = Range(\"E\" &amp; i).Value + Range(\"E\" &amp; j).Value\n                Rows(j).EntireRow.Delete\n\n            End If\n\n    Next j\n\nNext i\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5658687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/953410fdbc59f76bf2b81b97cfe65314?s=128&d=identicon&r=PG&f=1", "display_name": "Aleks Dok", "link": "https://stackoverflow.com/users/5658687/aleks-dok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2028, "favorite_count": 0, "accepted_answer_id": 34179168, "answer_count": 1, "score": 0, "last_activity_date": 1494338136, "creation_date": 1449658839, "last_edit_date": 1494338136, "question_id": 34177113, "link": "https://stackoverflow.com/questions/34177113/macro-to-group-data-by-month", "title": "Macro to group data by month", "body": "<p>I'm trying to create a macro that will group data by month: for example, if there are 3 entries for February for client A, then it will consolidate the three entries into one and sum the amounts. </p>\n\n<p>I have:</p>\n\n<p>A: Client name</p>\n\n<p>B: Invoice number</p>\n\n<p>C: Billing month</p>\n\n<p>D: Currency</p>\n\n<p>E: Charge amount</p>\n\n<p>F: Invoice step</p>\n\n<p><img src=\"https://i.stack.imgur.com/ZWSVP.png\" alt=\"Column titles here\"></p>\n\n<p>What I am trying to do, is group the following into a single row, with the invoice amounts added up, and replace the three rows with just the one row. These entries are for a single client (so the grouping depends on the value in column A).</p>\n\n<p><img src=\"https://i.stack.imgur.com/WDpZI.png\" alt=\"Example of entries here\"></p>\n\n<p>EG. Client A has three entries for Jan, Client B has one, Client C has one. Then for February Client A has one, Client B has one and Client C has two. </p>\n\n<p>Any macro suggestions I've seen on here haven't been helpful to me, I keep getting errors coming up so I don't know what the problem is. This is the one I tried:</p>\n\n<pre><code>Sub Group()\n\nDim e As Range, a as Range\n\nSet e = Range(\"C6\")\nSet c = e.Offset(, 2)\n\nDo\nIf Evaluate(\"=month(\" &amp; e.Address &amp; \")\") &lt;&gt; Evaluate(\"=month(\" &amp; e(2).Address &amp; \")\") Then\n    e(2).Resize(2, 3).Insert\n    e(2).Offset(, 2) = \"=sum(\" &amp; Range(a, c.Offset(, 2)).Address &amp; \")\"\n    e(2).Offset(, 2).Font.Bold = 1\n    Set e = e.End(4)\n    Set c = e.Offset(, 2)\nElse\n    Set e = e(2)\nEnd If\nLoop Until e.End(4).Row = Rows.Count\n\ne(2).Offset(, 2) = \"=sum(\" &amp; Range(c, e.Offset(, 2)).Address &amp; \")\"\ne(2).Offset(, 2).Font.Bold = 1\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: Subtotals and pivot tables would not work - the raw data is pasted in (thousands of lines of entry, for 40+ clients and some have many invoices each month), the raw data is sorted using a macro, which is then pasted into other sheets. Pasting from the pivot would be more difficult. </p>\n"}, {"tags": ["excel", "replace", "excel-formula", "notepad++", "vba"], "comments": [{"owner": {"reputation": 122, "user_id": 5658510, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b9fb958badabbfc0703be03b40508f75?s=128&d=identicon&r=PG&f=1", "display_name": "A. Sang", "link": "https://stackoverflow.com/users/5658510/a-sang"}, "reply_to_user": {"reputation": 62965, "user_id": 3679490, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/70f98fb23b16862298ea208aedfd18ae?s=128&d=identicon&r=PG&f=1", "display_name": "vks", "link": "https://stackoverflow.com/users/3679490/vks"}, "edited": false, "score": 0, "creation_date": 1449728375, "post_id": 34176754, "comment_id": 56135804, "body": "2*3.5.6 is after &quot;.&quot;  &quot;2 and 5 and 6  number&quot; and after *3 is specific Quantity&quot;"}, {"owner": {"reputation": 122, "user_id": 5658510, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b9fb958badabbfc0703be03b40508f75?s=128&d=identicon&r=PG&f=1", "display_name": "A. Sang", "link": "https://stackoverflow.com/users/5658510/a-sang"}, "reply_to_user": {"reputation": 62965, "user_id": 3679490, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/70f98fb23b16862298ea208aedfd18ae?s=128&d=identicon&r=PG&f=1", "display_name": "vks", "link": "https://stackoverflow.com/users/3679490/vks"}, "edited": false, "score": 0, "creation_date": 1449728421, "post_id": 34176754, "comment_id": 56135820, "body": "and not * in the line default &quot;Quantity&quot; to &quot;1&quot; after &quot;.&quot; numbers"}], "owner": {"reputation": 122, "user_id": 5658510, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b9fb958badabbfc0703be03b40508f75?s=128&d=identicon&r=PG&f=1", "display_name": "A. Sang", "link": "https://stackoverflow.com/users/5658510/a-sang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449753440, "creation_date": 1449657762, "last_edit_date": 1531161705, "question_id": 34176754, "link": "https://stackoverflow.com/questions/34176754/notepad-find-and-replace-use-expression", "title": "Notepad++ find and replace use expression", "body": "<p>I have a text to from to result  i want .</p>\n\n<blockquote>\n  <p>`name.b1.2*3.5.6.b3.2.5.5*5</p>\n</blockquote>\n\n<p>To Result</p>\n\n<blockquote>\n  <p>name-b1-3-2-2-3</p>\n  \n  <p>name-b1-1-5-5-1</p>\n  \n  <p>name-b1-1-6-6-1</p>\n  \n  <p>name-b3-1-2-2-1</p>\n  \n  <p>name-b3-1-5-5-1</p>\n  \n  <p>name-b3-5-5-5-5</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>Text \".\" </p>\n  \n  <p>\"name\"== first word common and only input starting</p>\n  \n  <p>\".\"     == next start</p>\n  \n  <p>\"b1\"   == if start letter after \".\" common for \n                 till next start letter \".\" after</p>\n  \n  <p>\"2\"    == if \".\" after digit for $number for before letter see \"b1\" and \"b3\" </p>\n  \n  <p>\"*\" == if  *  after digit is \"digit\" if not * default is \"1\" </p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1449658250, "post_id": 34176670, "comment_id": 56100334, "body": "Your <code>If Code &lt; 0 &gt; 1 Or False Then</code> is wrong (it is valid syntax but probably don&#39;t do what you think it will). You have to repeat Code each time like in <code>&#204;f Code &lt; 0 Or Code &gt; 1 Or Code = False Then</code>. And why didn&#39;t you simply check Code angaist the good value like <code>If Code &lt;&gt; 1 Then</code>?"}, {"owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1449659828, "post_id": 34176670, "comment_id": 56101395, "body": "Vincent, what confuses me is whilst using the syntax If Code &lt; 0 &gt; 1 Or False Then  i had it working for a period of time until a deletion occurred and had to re do the code, i tried the &lt;&gt;1 but again it accepted any number put in?"}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1449659565, "post_id": 34177043, "comment_id": 56101230, "body": "You can also just hold the shift button whilst opening the workbook to disable any auto-open code from running."}, {"owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "edited": false, "score": 0, "creation_date": 1449660211, "post_id": 34177043, "comment_id": 56101620, "body": "@chris That works perfectly thank you. i know it is very basic although it isnt strictly being used as a security feature it is more of a tool to personalise the workbook as i plan to have different codes for different people which then trigger other macros off. i just needed to get the fundamental part correct, many thanks"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 2, "creation_date": 1449660577, "post_id": 34177043, "comment_id": 56101827, "body": "Matthew, you&#39;re welcome. A suggestion though: if you want different people to see different things, you could use the variable <code>Environ(&quot;UserName&quot;)</code>. For example <code>Select Case Environ(&quot;UserName&quot;) &#47; Case &quot;Matthew Bond&quot; &#47;     Msgbox &quot;Owner of this document&quot; &#47; Case &quot;Joe Bloggs&quot; &#47;     Msgbox &quot;Someone else&quot; &#47; End Select</code> (/ characters representing line breaks)"}], "tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": true, "score": 2, "last_activity_date": 1449658627, "creation_date": 1449658627, "answer_id": 34177043, "question_id": 34176670, "link": "https://stackoverflow.com/questions/34176670/adding-security-to-my-workbook-internally-using-vba/34177043#34177043", "title": "Adding security to my workbook internally using VBA", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim Code As Variant\n    Code = Application.InputBox(\"Enter School Code\", CancelCode)\n    If Not Code = 1 Then\n        MsgBox (\"Unrecognised Code\")\n        ThisWorkbook.Close SaveChanges:=False\n    End If\nEnd Sub\n</code></pre>\n\n<p>Just tested it and it works for me.</p>\n\n<p>I should add, however, that this is extremely low-level security, which could be bypassed by anyone with even rudimentary knowledge of VBA. You simply have to set <em>Application.EnableEvents = False</em> in another workbook (or in the VBA Immediate window) before opening up your workbook, and the Workbook_Open event will not run at all.</p>\n"}], "owner": {"reputation": 177, "user_id": 5603816, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/19687a658e8ecfcf83eff6ac884c50d1?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Bond", "link": "https://stackoverflow.com/users/5603816/matthew-bond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 34177043, "answer_count": 1, "score": 1, "last_activity_date": 1449658627, "creation_date": 1449657511, "last_edit_date": 1449657877, "question_id": 34176670, "link": "https://stackoverflow.com/questions/34176670/adding-security-to-my-workbook-internally-using-vba", "title": "Adding security to my workbook internally using VBA", "body": "<p>For testing purposes lets assume the code to unlock the workbook is 1.\nI want an input box to show up on opening, if the user puts in an incorrect code/Or selects cancel on the input box then the workbook closes.   </p>\n\n<pre><code>Private Sub Workbook_Open()\n\nActiveSheet.Range(\"A1\").Activate\n\n Code = Application.InputBox(\"Enter School Code\", CancelCode)\n\n    If Code &lt; 0 &gt; 1 Or False Then\n    Code = Int(1)\n        MsgBox (\"Unrecognised Code\")\n\nApplication.Workbooks(\"CODING.xlsm\").Close 'False\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>At the moment it appears but runs if any number is entered and also closes the input box and allows access if cancel is clicked.</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "edited": false, "score": 0, "creation_date": 1449682744, "post_id": 34175964, "comment_id": 56117015, "body": "The chunk of data you are seeing is around 250 bytes, which suggests that there a 255/256-byte limit might be in there somewhere. The VBA looks OK to me, so I wondered how you were displaying the data and whether for example you are using an EXCEL spreadsheet function that would truncate it, and whether you were doing that because you got an error in one of the mid() calls - the code worked here, except that the version posted on the web page you linked to is incorrect. The version in the spreadsheet uses instr to look for an HTML (td) end tag, but the web page version is looking for &quot;&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "edited": false, "score": 0, "creation_date": 1449682899, "post_id": 34175964, "comment_id": 56117100, "body": "BTW, AFAICS although the code does appear to work, I think it should probably be looking for a particular node in the HTML document and getting its value, rather than using instr and mid to do the same thing. But I&#39;m not going to attempt to fix it!"}], "answers": [{"tags": [], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "is_accepted": false, "score": 0, "last_activity_date": 1451470268, "creation_date": 1451470268, "answer_id": 34527365, "question_id": 34175964, "link": "https://stackoverflow.com/questions/34175964/todays-currency-exchange-rate-in-vba/34527365#34527365", "title": "Today&#39;s Currency Exchange Rate in VBA", "body": "<p>This <a href=\"https://desmondoshiwambo.wordpress.com/2014/06/27/how-to-get-the-current-exchange-rateconvert-currency-in-access-excel-and-vba-using-yahoo-finance/\" rel=\"nofollow\">code</a> works superb, it uses Yahoo as well, but is up to date with html parsing. </p>\n"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2469, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1451470268, "creation_date": 1449655549, "last_edit_date": 1531164843, "question_id": 34175964, "link": "https://stackoverflow.com/questions/34175964/todays-currency-exchange-rate-in-vba", "title": "Today&#39;s Currency Exchange Rate in VBA", "body": "<p>I am trying to convert a value to NOK(USD to NOK for instance), but I have trouble getting the whole html page to load. </p>\n\n<p>I am using the code found <a href=\"http://investexcel.net/foreign-exchange-rate-function-in-excel/\" rel=\"nofollow\">here</a> , but the the html i get in return display this </p>\n\n<pre><code>    \"&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\"&gt;\n&lt;html lang=\"en-US\"&gt;\n&lt;head&gt;\n&lt;title&gt;USDNOK=X: Summary for USD/NOK- Yahoo! Finance&lt;/title&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"&gt;&lt;met\n</code></pre>\n\n<p>So it is basically stripping the webpage, or rather is not waiting untill its done loading. The code in the link for getting webpage is this:</p>\n\n<pre><code>Function ExecuteWebRequest(ByVal url As String) As String\n\n\nDim oXHTTP As Object\n\nIf InStr(1, url, \"?\", 1) &lt;&gt; 0 Then\n    url = url &amp; \"&amp;cb=\" &amp; Timer() * 100\nElse\n    url = url &amp; \"?cb=\" &amp; Timer() * 100\nEnd If\n\nSet oXHTTP = CreateObject(\"MSXML2.XMLHTTP\")\noXHTTP.Open \"GET\", url, False\noXHTTP.send\nExecuteWebRequest = oXHTTP.responseText\nSet oXHTTP = Nothing\n\nEnd Function\n</code></pre>\n\n<p>Maybe there is a better way of getting todays exchange rate in vba.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1449676155, "creation_date": 1449676155, "answer_id": 34183099, "question_id": 34175257, "link": "https://stackoverflow.com/questions/34175257/word-2013-macro-reference-in-docx-file/34183099#34183099", "title": "Word 2013 - Macro Reference in .docx file", "body": "<p>You need to put the code in a \"normal\" module. This will require changing the calls to the ActiveX controls, which is a pain, but works.</p>\n\n<p>Assuming the ActiveX controls are managed on the document surface as InlineShapes a call would look like this:</p>\n\n<pre><code>Dim cbConfi as Object 'or as MsForms.ComboBox to get Intellisense\nSet cbConfi = ActiveDocument.InlineShapes([indexvalue]).OLEFormat.Object\ncbConfi.Width = 1\n</code></pre>\n\n<p>If you don't want to rely on the index value (position of the control in the InlineShapes collection) you can select the ActiveX control and assign a bookmark to it. Or you can loop the collection of ActiveX controls, check the Type and, if it's a OLE object, check whether the Class type is MSForms.Combobox and then via OLEFormat.Object.Name whether its the right one.</p>\n"}], "owner": {"reputation": 206, "user_id": 5471602, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c2795b529ce81c535fa998d0a519536a?s=128&d=identicon&r=PG&f=1", "display_name": "pmax1", "link": "https://stackoverflow.com/users/5471602/pmax1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 34183099, "answer_count": 1, "score": 0, "last_activity_date": 1449676155, "creation_date": 1449653683, "last_edit_date": 1449658071, "question_id": 34175257, "link": "https://stackoverflow.com/questions/34175257/word-2013-macro-reference-in-docx-file", "title": "Word 2013 - Macro Reference in .docx file", "body": "<p>I have a pretty large template (in terms of macros) and I've created a new module that is called when the user does a specified shortcut on the keyboard. \nThe Macro does nothing more but call \"ThisDocument.HideComboBoxes\". </p>\n\n<p>\"HideComboBoxes\" is a Sub in ThisDocument, which does the obvious: hide all combo boxes in the document. </p>\n\n<p>The code works fine as long as I'm working with the template. </p>\n\n<p>If I render a new document out of it (a docx file) the shortcut does not work anymore (which is kinda obvious because the ThisDocument is now empty for the document). </p>\n\n<p>How do I access the template's ThisDocument from within the document or how can I hide the combo boxes from within the docx? </p>\n\n<p>Here's the code for hiding the comboboxes in the template's ThisDocument:</p>\n\n<pre><code>Sub HideComboBoxes()\n Me.ComboBoxConfi.Width = 1\n Me.ComboBoxConfi.Height = 1\n Me.ComboBoxState.Width = 1\n Me.ComboBoxState.Height = 1\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1449653431, "post_id": 34174665, "comment_id": 56097113, "body": "I think this will be inherently slow since you have to use the <code>Characters</code> property but it may be faster to do one <code>Select Case Cells(x, 2).Characters(y, 1).Font.ColorIndex</code> rather than checking it twice per character."}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1449654207, "post_id": 34174665, "comment_id": 56097636, "body": "Won&#39;t this code count spaces aswell, since their ColorIndex is neither 5 nor 10 ? Don&#39;t know if that is intented or if your strings even contain spaces, just pointing it out."}, {"owner": {"reputation": 1, "user_id": 5642533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c38b46c3e1bc5723b907dffad1ae19?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/5642533/simon"}, "edited": false, "score": 0, "creation_date": 1449743531, "post_id": 34174665, "comment_id": 56144021, "body": "Could someone please help me with this?! I really need to get this running a lot faster. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5642533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c38b46c3e1bc5723b907dffad1ae19?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/5642533/simon"}, "edited": false, "score": 0, "creation_date": 1449685336, "post_id": 34176379, "comment_id": 56118668, "body": "Thanks for this. This is a lot faster, the main difference being the &quot;=1&quot; instead of &quot;&lt;&gt;5&quot; And &quot;&lt;&gt;10&quot;. However I think there are ways of doing this a lot, lot quicker. Could you please refer to <a href=\"http://stackoverflow.com/questions/32860792/count-keywords-within-phrases/32878493#32878493\">Count keywords within phrases</a> which does something very similar but in a fraction of the time. Thanks"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 1, "user_id": 5642533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c38b46c3e1bc5723b907dffad1ae19?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/5642533/simon"}, "edited": false, "score": 2, "creation_date": 1449805455, "post_id": 34176379, "comment_id": 56176067, "body": "@Simon Jeeped&#39;s code is writing to multiple characters at once - this code by Sergey has to iterate character by character (as per Rory&#39;s comment above). It if improved your response you should accept it as the answer rather than ask Sergey to look at another question."}], "tags": [], "owner": {"reputation": 516, "user_id": 5102865, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/71bf035de4fbcb43a6b9a1eb2d07c76e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Ryabov", "link": "https://stackoverflow.com/users/5102865/sergey-ryabov"}, "is_accepted": false, "score": 0, "last_activity_date": 1449657020, "last_edit_date": 1449657020, "creation_date": 1449656720, "answer_id": 34176379, "question_id": 34174665, "link": "https://stackoverflow.com/questions/34174665/counting-number-of-black-characters-in-a-sentence/34176379#34176379", "title": "Counting number of black characters in a sentence", "body": "<p>I managed to speed it up by 100+% using following code:</p>\n\n<pre><code>Dim x As Integer, Black As Integer, y As Integer\n\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\nApplication.Calculation = xlCalculationManual\n\nlr = Cells(Rows.Count, 2).End(xlUp).Row\n\nFor x = 2 To lr\n    Black = 0\n    For y = 1 To Len(Cells(x, 2))\n        If Cells(x, 2).Characters(y, 1).Font.ColorIndex = 1 Then\n            Black = Black + 1\n        End If\n\n    Next y\n    Cells(x, 3).FormulaR1C1 = \"=1-\" &amp; Black &amp; \"/LEN(RC[-1])\"\n\nNext x\n\ndoneBox = MsgBox(\"Done!\")\n\nApplication.ScreenUpdating = True\nApplication.DisplayStatusBar = True\nApplication.Calculation = xlCalculationAutomatic\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5642533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c38b46c3e1bc5723b907dffad1ae19?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/5642533/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1449685505, "creation_date": 1449652048, "last_edit_date": 1495542655, "question_id": 34174665, "link": "https://stackoverflow.com/questions/34174665/counting-number-of-black-characters-in-a-sentence", "title": "Counting number of black characters in a sentence", "body": "<p>I have a list of sentences, some of the characters in the sentences are colored green (colorindex = 10), some are colored blue (colorindex = 5) and some are colored black. I would like to calculate the proportion of each sentence which is colored either blue or green.</p>\n\n<p>I have written a macro which loops through each character in each sentence and determines what color it is, then spits out the proportion of non-black colored characters in that sentence. The problem is that this is very slow, I believe there are more advanced techniques which can be used in VBA such as storing information in an array then spitting it out as an array at the end. I'm not too sure, if someone could may me make this faster it would be much appreciated!</p>\n\n<p>The code in this query <a href=\"https://stackoverflow.com/questions/32860792/count-keywords-within-phrases/32878493#32878493\">Count keywords within phrases</a> does something very similar but in a fraction of the time.</p>\n\n<p>Here is what I have so far:\nThe sentences are in Range(\"B2:B1000\")</p>\n\n<pre><code>Dim x As Integer, Black As Integer, y As Integer\n\nx = 2\nDo Until Cells(x, 2) = \"\"\nBlack = 0\nFor y = 1 To Len(Cells(x, 2))\n    If Cells(x, 2).Characters(y, 1).Font.ColorIndex = 1 Then\n        Black = Black + 1\n    Else\n    End If\n\nNext y\nCells(x, 3).FormulaR1C1 = \"=1-\" &amp; Black &amp; \"/LEN(RC[-1])\"\n\nx = x + 1\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 1, "creation_date": 1449653568, "post_id": 34175122, "comment_id": 56097196, "body": "I think VBA has a built in CentimetersToPoints method, if you don&#39;t want to do the conversion."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1449653683, "post_id": 34175122, "comment_id": 56097272, "body": "Yes indeed, I wasn&#39;t sure that it was a built in function so I didn&#39;t included it, but I will correct this now! ;)"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 1, "creation_date": 1449653860, "post_id": 34175122, "comment_id": 56097386, "body": "I managed to find yet a different way to adjust the height... though not a code solution. Simply adjust the Margins in the Page Setup properties. This got me to where I needed to go. I&#39;ll accept your answer as the right one as I was asking for a code solution though."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1449653922, "post_id": 34175122, "comment_id": 56097440, "body": "@rohrl77 : Hehe! ;) Sure, no problem but I&#39;m still not sure that it will avoid your error... I haven&#39;t used charts in that depth for quite some time so I&#39;m not sure how the areas are placed by I know there is also the plotarea and the shape, is it possible that the shape is too small to handle such a &quot;big&quot; chartarea? But as you are in chart worksheet, I guess there isn&#39;t a shape..."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1449654094, "post_id": 34175122, "comment_id": 56097561, "body": "@rohrl77 : Just saw your comment, glad you found a solution! And thanks for accepting my answer! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1449653776, "last_edit_date": 1449653776, "creation_date": 1449653348, "answer_id": 34175122, "question_id": 34174349, "link": "https://stackoverflow.com/questions/34174349/how-to-resize-chart-sheets-in-excel/34175122#34175122", "title": "How to resize chart sheets in Excel", "body": "<p>The issue is that the input for <code>Height</code> and <code>Width</code> are in <strong>points</strong> and not in mm!</p>\n\n<p>Using <a href=\"http://www.asknumbers.com/CentimetersToPointsConversion.aspx\" rel=\"nofollow\">this converter</a> (1 Centimeter = 28.346... Points) or the built-in function <code>CentimetersToPoints</code> :</p>\n\n<pre><code>Sub qqq()\nDim x\n\nWith Chart6\n    .ChartArea.Height = 107.3\n    .ChartArea.Width = 167.5\n    .ChartArea.Height = CentimetersToPoints(3.79)\n    .ChartArea.Width = CentimetersToPoints(5.91)\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9049, "favorite_count": 0, "accepted_answer_id": 34175122, "answer_count": 1, "score": 3, "last_activity_date": 1503581363, "creation_date": 1449650939, "last_edit_date": 1449651130, "question_id": 34174349, "link": "https://stackoverflow.com/questions/34174349/how-to-resize-chart-sheets-in-excel", "title": "How to resize chart sheets in Excel", "body": "<p>To be clear, I'm not asking how to resize charts ON a worksheet, but how to resize Charts that ARE worksheets.</p>\n\n<p>I want to resize the chart to be 3.79cm high and 5.91 wide. </p>\n\n<p>Though I have done this in the past already, I'm currently at a loss of how I did it. I've been trying and playing around with the code below:</p>\n\n<pre><code>Sub qqq()\nDim x\n\nWith Chart6\n    .ChartArea.Height = 379.03\n    .ChartArea.Width = 591.03\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>When I try to run it I get \"Run Time Error 5\"</p>\n\n<p>What am I missing/not seeing?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 629, "user_id": 1233094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CHrua.png?s=128&g=1", "display_name": "playercharlie", "link": "https://stackoverflow.com/users/1233094/playercharlie"}, "reply_to_user": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 1, "creation_date": 1449645646, "post_id": 34172814, "comment_id": 56092557, "body": "I understand. I believe I still do have a right to ask the question, and have it answered as &#39;No&#39; without the downvote/judgement."}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 3, "creation_date": 1449645694, "post_id": 34172814, "comment_id": 56092589, "body": "Write a macro to spit out 30 workbooks - a simple search would tell you excel password protection can be broken in seconds"}, {"owner": {"reputation": 629, "user_id": 1233094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CHrua.png?s=128&g=1", "display_name": "playercharlie", "link": "https://stackoverflow.com/users/1233094/playercharlie"}, "reply_to_user": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1449645798, "post_id": 34172814, "comment_id": 56092658, "body": "Thank you. You can add that as an answer as well, I will accept it if there is no other answer."}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 1, "creation_date": 1449647351, "post_id": 34172814, "comment_id": 56093440, "body": "I agree with @StevenMartin, You should have a look at creating an MS Access Database and then you can use Macros in Access to Export the Specific Client data, when needed, to Excel. IF you do a quick Google Search for Excel vs Access you can see the benefits"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1449648522, "post_id": 34172814, "comment_id": 56094093, "body": "You do indeed have a right to ask questions ... but with every right comes a responsibility. You also have the responsibility not to ask how to break the law... and causing financial loss by breach of confidentiality is illegal. Respondents here not only can but should downvote or judge. If they give you the code to answer your question they may very well be as exposed to a civil action as you would be. Follow @StevenMartin&#39;s advice and run a macro to create 30 workbooks. And if my advice is worth anything, then make sure your employer can never link this post to you."}, {"owner": {"reputation": 629, "user_id": 1233094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CHrua.png?s=128&g=1", "display_name": "playercharlie", "link": "https://stackoverflow.com/users/1233094/playercharlie"}, "reply_to_user": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1449649923, "post_id": 34172814, "comment_id": 56094854, "body": "a) &quot;to ask how to break the law&quot; - I am not asking how to break the law, I am asking if this can be done reliably, without data breach. I am sure my employer will have no problems with this or any question, because data breach is exactly what I want to avoid as well.  b) &quot;Follow @StevenMartin&#39;s advice&quot; - It&#39;s what I am doing already, and I indicated it to him as well, that I would accept that as an answer. I am not comfortable with the tone of his first comment. It may not be painfully obvious to me that this cannot be done, as it is to you, but that is no reason to be rude."}], "answers": [{"tags": [], "owner": {"reputation": 629, "user_id": 1233094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CHrua.png?s=128&g=1", "display_name": "playercharlie", "link": "https://stackoverflow.com/users/1233094/playercharlie"}, "is_accepted": false, "score": -2, "last_activity_date": 1449650316, "creation_date": 1449650316, "answer_id": 34174173, "question_id": 34172814, "link": "https://stackoverflow.com/questions/34172814/how-do-i-selectively-share-data-with-clients-so-that-they-only-see-their-own-da/34174173#34174173", "title": "How do I selectively share data with clients, so that they only see their own data, and not of their competitors?", "body": "<p>Posting @StevenMartin 's answer from the comments above, as it seems to the way to go about it</p>\n\n<p>\"Write a macro to spit out 30 workbooks - a simple search would tell you excel password protection can be broken in seconds\"</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5656611"}, "is_accepted": true, "score": 0, "last_activity_date": 1449688235, "creation_date": 1449688235, "answer_id": 34187055, "question_id": 34172814, "link": "https://stackoverflow.com/questions/34172814/how-do-i-selectively-share-data-with-clients-so-that-they-only-see-their-own-da/34187055#34187055", "title": "How do I selectively share data with clients, so that they only see their own data, and not of their competitors?", "body": "<p>As Steven Martain said, there is NO SECURITY in Excel.  You can password-protect your Workbook, but the password can be broken in no time at all.  Instead split your file into several separate files.  Please see this link for an idea of how to do this.</p>\n\n<p><a href=\"http://www.rondebruin.nl/win/s3/win006.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/s3/win006.htm</a></p>\n\n<p>Then, simply email the different files to different recipients/clients/people.  See this link for an idea of how to do that.</p>\n\n<p><a href=\"http://www.rondebruin.nl/win/s1/outlook/amail6.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/s1/outlook/amail6.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 5268267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d20906c6863d8a3a5f0bf9ddb96ebd1?s=128&d=identicon&r=PG&f=1", "display_name": "evanglerm", "link": "https://stackoverflow.com/users/5268267/evanglerm"}, "is_accepted": false, "score": 0, "last_activity_date": 1488900786, "creation_date": 1488900786, "answer_id": 42652231, "question_id": 34172814, "link": "https://stackoverflow.com/questions/34172814/how-do-i-selectively-share-data-with-clients-so-that-they-only-see-their-own-da/42652231#42652231", "title": "How do I selectively share data with clients, so that they only see their own data, and not of their competitors?", "body": "<p>It is not possible to do it without coding/VB. However, you can use InstaRow ( check <a href=\"http://dataforsharing.com\" rel=\"nofollow noreferrer\">here</a>). Which is perfect tool for this problem. You can signup with email id ( and your clients). They will see exactly their portion. \nThey can even change data easily.  </p>\n"}], "owner": {"reputation": 629, "user_id": 1233094, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CHrua.png?s=128&g=1", "display_name": "playercharlie", "link": "https://stackoverflow.com/users/1233094/playercharlie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "accepted_answer_id": 34187055, "answer_count": 3, "score": -4, "last_activity_date": 1488900786, "creation_date": 1449645367, "question_id": 34172814, "link": "https://stackoverflow.com/questions/34172814/how-do-i-selectively-share-data-with-clients-so-that-they-only-see-their-own-da", "title": "How do I selectively share data with clients, so that they only see their own data, and not of their competitors?", "body": "<p>I have data like this in my Excel 2013 workbook</p>\n\n<p><strong>Table 1:</strong></p>\n\n<pre><code>       Col A         Col B          Col B\n1      Client 1      .....          123\n2      Client 1      .....          456\n3      Client 1      .....          99\n4      Client 2      .....          324\n5      Client 2      .....          989\n6      Client 3      .....          234\n7      Client 3      .....          23\n</code></pre>\n\n<p>I am using this Table 1 for a client specific report elsewhere in the excel. e.g.</p>\n\n<p><strong>Client Report: Client 1</strong></p>\n\n<pre><code>       Col A         Col B          Col C          Col D\n1      Client 1      123            456            99\n</code></pre>\n\n<p>The cell A1 in the report is a data validation dropdown containing the names of the Clients. I can change that dropdown to Client 2</p>\n\n<p><strong>Client Report: Client 2</strong></p>\n\n<pre><code>       Col A         Col B          Col C          Col D\n1      Client 2      324            989            \n</code></pre>\n\n<p><strong><em>What I want to be able to do is send out one file to all clients, which contains the Client Report, but each Client should only be able to see their own data.</em></strong> As a bonus, each client should also not be able to see which other clients are on the list (i.e. in the file that Client 1 receives, he/she should not have access to the numbers of Client 2 and Client 3, and as a bonus, should not even see the names Client 2 and Client 3)</p>\n\n<p>I have an option of creating these files manually, for each client. I am looking for a way to hide data in a file depending on which Client it is for, and thus sending out the same file to multiple clients (I have ~30 clients, so the manual process will be error prone and a pain). I don't want to create 30 separate files or sheets if I can help it. The ideal way would be to build a 'master' option, which gives me access to all data, but not to the client who I send this out to. However, <strong><em>data confidentiality is super critical</em></strong>, and if password protection in Excel Workbooks is questionable, then I would not want this option, and I will go back to manual :)</p>\n\n<p>Also, even though I am only looking for vanilla Excel solutions (I can't rely on my clients to have addons installed or install one just for the sake of this), if you do know of interesting ways to address this kind of a problem with addons, please do comment/answer.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5657754"}, "edited": false, "score": 0, "creation_date": 1449650221, "post_id": 34172923, "comment_id": 56095033, "body": "For me, I want to check weather my file contains paragraphs count in multiple of five. Will this give correct answers in every case? I mean can I use If s = Fix(s) then Will work for this? I think It should from your comment."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 1, "last_activity_date": 1449650313, "last_edit_date": 1449650313, "creation_date": 1449645778, "answer_id": 34172923, "question_id": 34172662, "link": "https://stackoverflow.com/questions/34172662/how-to-find-whether-value-is-integer/34172923#34172923", "title": "How to find whether value is integer", "body": "<p><code>If s = Fix(s)</code> is one way.</p>\n\n<p><code>Fix</code> strips off the fractional part.</p>\n\n<p>Another approach in your case would be to check if the base 5 modulus is zero prior to taking the division. Use <code>Mod</code> for that: <code>If s Mod 5 = 0</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1449648167, "post_id": 34173399, "comment_id": 56093878, "body": "Be careful: I think that <code>Int(s)</code> will round any fractional part. That&#39;s why I use <code>Fix(s)</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5657754"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1449648336, "post_id": 34173399, "comment_id": 56093976, "body": "Oh!!!. I will fix with Fix(s) then. I am completely novice. Will keep this in mind."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5657754"}, "is_accepted": false, "score": 1, "last_activity_date": 1449647430, "creation_date": 1449647430, "answer_id": 34173399, "question_id": 34172662, "link": "https://stackoverflow.com/questions/34172662/how-to-find-whether-value-is-integer/34173399#34173399", "title": "How to find whether value is integer", "body": "<p>While trying Rahul's answer, Found that This is simplest way.</p>\n\n<pre><code>If s = Int(s) Then\n</code></pre>\n\n<p>Tried for smaller file.\nI will check with larger files and tell.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5657754"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 927, "favorite_count": 0, "accepted_answer_id": 34172923, "answer_count": 2, "score": 1, "last_activity_date": 1459261583, "creation_date": 1449644833, "last_edit_date": 1459261583, "question_id": 34172662, "link": "https://stackoverflow.com/questions/34172662/how-to-find-whether-value-is-integer", "title": "How to find whether value is integer", "body": "<p>I want to perform some task based on some ifs</p>\n\n<p>my (uncomplete) code is</p>\n\n<pre><code>Sub checkif()\n    Dim s\n    With ActiveDocument.Range\n        s = Val(ActiveDocument.Paragraphs.Count)\n        s = s / 5\n            If s = Integer then\n                perform some task\n            Else\n                Exit Sub\n            End If\n     End With\nEnd Sub\n</code></pre>\n\n<p>I am completely new to VBA and there are so many answers. I have tried several.\none is</p>\n\n<pre><code>Sub checkif2()\n    Dim s\n    With ActiveDocument.Range\n        s = Val(ActiveDocument.Paragraphs.Count)\n        s = s / 5\n            If IsNumeric(s) Then\n            MsgBox \"is integer\"\n            Else\n            MsgBox \"not integer\"\n                Exit Sub\n            End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>This always give integer.</p>\n\n<p>checked another one</p>\n\n<pre><code>Sub checkif2()\n    Dim s\n    With ActiveDocument.Range\n        s = Val(ActiveDocument.Paragraphs.Count)\n        s = s / 5\n            If TypeName(s) = \"Integer\" Then\n            MsgBox \"is integer\"\n            Else\n            MsgBox \"not integer\"\n                Exit Sub\n            End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>Always give not integer.\nIs there any method for Word VBA?</p>\n"}, {"tags": ["vba", "excel", "email"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 1559232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de804efcdc8a2f9d2ed1224f2bd1607e?s=128&d=identicon&r=PG", "display_name": "jasmine", "link": "https://stackoverflow.com/users/1559232/jasmine"}, "edited": false, "score": 0, "creation_date": 1449650350, "post_id": 34173989, "comment_id": 56095102, "body": "Thank you for your reply :) i have input the code and i did receive emails for different products i have input in my spreadsheet. But the thing is, i didn&#39;t receive the e-mail for example: printers&#39; shipment due date are overdue (note: i can have several printers which are overdue). I only received 1 row of the overdue date printer. Can you solve this for me?"}, {"owner": {"reputation": 3, "user_id": 1559232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de804efcdc8a2f9d2ed1224f2bd1607e?s=128&d=identicon&r=PG", "display_name": "jasmine", "link": "https://stackoverflow.com/users/1559232/jasmine"}, "edited": false, "score": 0, "creation_date": 1449650651, "post_id": 34173989, "comment_id": 56095290, "body": "Can i also add in AND condition inside my IF condition? as i want to compare 2 different cell dates so as to know which item is overdue. I tried adding in AND but the code isn&#39;t working."}, {"owner": {"reputation": 516, "user_id": 5102865, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/71bf035de4fbcb43a6b9a1eb2d07c76e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Ryabov", "link": "https://stackoverflow.com/users/5102865/sergey-ryabov"}, "reply_to_user": {"reputation": 3, "user_id": 1559232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de804efcdc8a2f9d2ed1224f2bd1607e?s=128&d=identicon&r=PG", "display_name": "jasmine", "link": "https://stackoverflow.com/users/1559232/jasmine"}, "edited": false, "score": 0, "creation_date": 1449650800, "post_id": 34173989, "comment_id": 56095381, "body": "@jasmine but you already have AND condition within one of your IFs:  <code>If Cells(cell.Row, &quot;G&quot;).Value &lt; Cells(cell.Row, &quot;F&quot;).Value And Cells(cell.Row, &quot;L&quot;).Value = &quot;Incomplete&quot; Then</code> Does it work?"}, {"owner": {"reputation": 3, "user_id": 1559232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de804efcdc8a2f9d2ed1224f2bd1607e?s=128&d=identicon&r=PG", "display_name": "jasmine", "link": "https://stackoverflow.com/users/1559232/jasmine"}, "edited": false, "score": 0, "creation_date": 1449651149, "post_id": 34173989, "comment_id": 56095613, "body": "nope it does not run at all unfortunately. :( my code goes like this now: If Cells(cell.Row, &quot;B&quot;).Value &lt;&gt; Cells(cell.Row + 1, &quot;B&quot;).Value And Cells(cell.Row, &quot;G&quot;).Value &lt; Cells(cell.Row, &quot;F&quot;).Value And Cells(cell.Row, &quot;L&quot;).Value = &quot;Incomplete&quot; Then"}, {"owner": {"reputation": 516, "user_id": 5102865, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/71bf035de4fbcb43a6b9a1eb2d07c76e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Ryabov", "link": "https://stackoverflow.com/users/5102865/sergey-ryabov"}, "reply_to_user": {"reputation": 3, "user_id": 1559232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de804efcdc8a2f9d2ed1224f2bd1607e?s=128&d=identicon&r=PG", "display_name": "jasmine", "link": "https://stackoverflow.com/users/1559232/jasmine"}, "edited": false, "score": 0, "creation_date": 1449651344, "post_id": 34173989, "comment_id": 56095735, "body": "Where does it stop and what is it saying?"}, {"owner": {"reputation": 3, "user_id": 1559232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de804efcdc8a2f9d2ed1224f2bd1607e?s=128&d=identicon&r=PG", "display_name": "jasmine", "link": "https://stackoverflow.com/users/1559232/jasmine"}, "edited": false, "score": 0, "creation_date": 1449651440, "post_id": 34173989, "comment_id": 56095802, "body": "it didn&#39;t show me any error or to debug any row. It just doesn&#39;t run :("}], "tags": [], "owner": {"reputation": 516, "user_id": 5102865, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/71bf035de4fbcb43a6b9a1eb2d07c76e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Ryabov", "link": "https://stackoverflow.com/users/5102865/sergey-ryabov"}, "is_accepted": false, "score": 0, "last_activity_date": 1449649645, "creation_date": 1449649645, "answer_id": 34173989, "question_id": 34172022, "link": "https://stackoverflow.com/questions/34172022/macro-to-loop-through-cells-of-similar-value-product-and-send-that-range-of-emai/34173989#34173989", "title": "Macro to loop through cells of similar value/product and send that range of email", "body": "<p>First you can alphabetically sort the column with Product names and then within if statement you put a condition like:</p>\n\n<pre><code>If Cells(cell.Row, \"Product name column\").Value &lt;&gt; Cells(cell.Row + 1, \"Product name column\").Value then\n</code></pre>\n\n<p>So macro runs the rest of the code only after reaching the last item with the same name.</p>\n"}], "owner": {"reputation": 3, "user_id": 1559232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de804efcdc8a2f9d2ed1224f2bd1607e?s=128&d=identicon&r=PG", "display_name": "jasmine", "link": "https://stackoverflow.com/users/1559232/jasmine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451818710, "creation_date": 1449642138, "last_edit_date": 1451818710, "question_id": 34172022, "link": "https://stackoverflow.com/questions/34172022/macro-to-loop-through-cells-of-similar-value-product-and-send-that-range-of-emai", "title": "Macro to loop through cells of similar value/product and send that range of email", "body": "<p>I have a created a macro for my spreadsheet which can sent out emails successfully. </p>\n\n<p>However, it can only send e-mails of each individual part numbers which are over the due date. Which means if I have 100 over the due date part numbers, there will be 100 emails being sent out.</p>\n\n<p>I would like my macro to send the email by a range of cells which are of similar product (eg. printer) and are over the due date. There can be other products like laptop, camera, webcam as well. I need to do this as i don't want to spam the receiver's inbox.</p>\n\n<p>How do I do that?</p>\n\n<pre><code>Sub LabelArtworkRelease()\n\n    Dim OutApp As Object\n    Dim Message1 As Object\n    Dim cell As Range\n    Dim emailBody As String\n    Dim Signature As String\n\n    'GET DEFAULT EMAIL SIGNATURE\n    Signature = Environ(\"appdata\") &amp; \"\\Microsoft\\Signatures\\\"\n    If Dir(Signature, vbDirectory) &lt;&gt; vbNullString Then\n        Signature = Signature &amp; Dir$(Signature &amp; \"*.htm\")\n    Else:\n        Signature = \"\"\n    End If\n    Signature = CreateObject(\"Scripting.FileSystemObject\").GetFile(Signature).OpenAsTextStream(1, -2).ReadAll\n    'End\n\n    Application.ScreenUpdating = False\n\n    'Create a new Outlook session\n    Set appOutlook = CreateObject(\"Outlook.Application\")\n\n    On Error GoTo cleanup\n\n            'Declare header variables\n            partnumber = Range(\"A3\").Value\n            productfamily = Range(\"B3\").Value\n            desc = Range(\"C3\").Value\n            artworkactual = Range(\"F3\").Value\n            artworkexpected = Range(\"G3\").Value\n            remark = Range(\"L3\").Value\n\n            On Error Resume Next\n\n            'if artwork actual date is later than artwork expected date\n            For Each cell In Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\n            If Cells(cell.Row, \"G\").Value &lt; Cells(cell.Row, \"F\").Value And Cells(cell.Row, \"L\").Value = \"Incomplete\" Then\n\n            'Create a new message\n            Set Message1 = appOutlook.CreateItem(olMailItem)\n\n\n            'Create default message\n            emailBody = \"&lt;Font face=Calibri&gt;Hi \" &amp; Cells(cell.Row, \"D\").Value &amp; \" , &lt;p&gt;\" _\n                            &amp; \"Please be reminded that the following part numbers - is/are over the expected artwork release date. &lt;p&gt; Kindly act on the following item(s): &lt;br&gt; \" _\n                            &amp; \"&lt;table border=1&gt;&lt;tr&gt;&lt;th&gt;\" _\n                            &amp; partnumber &amp; \"&lt;/th&gt;\" _\n                            &amp; \"&lt;th&gt;\" &amp; productfamily &amp; \"&lt;/th&gt;\" _\n                            &amp; \"&lt;th&gt;\" &amp; desc &amp; \"&lt;/th&gt;\" _\n                            &amp; \"&lt;th&gt;\" &amp; artworkactual &amp; \"&lt;/th&gt;\" _\n                            &amp; \"&lt;th&gt;\" &amp; artworkexpected &amp; \"&lt;/th&gt;\" _\n                            &amp; \"&lt;th&gt;\" &amp; remark &amp; \"&lt;/th&gt;\" _\n                            &amp; \"&lt;tr&gt;\" _\n                            &amp; \"&lt;td&gt;\" &amp; Cells(cell.Row, \"A\").Value &amp; \"&lt;/td&gt;\" _\n                            &amp; \"&lt;td&gt;\" &amp; Cells(cell.Row, \"B\").Value &amp; \"&lt;/td&gt;\" _\n                            &amp; \"&lt;td&gt;\" &amp; Cells(cell.Row, \"C\").Value &amp; \"&lt;/td&gt;\" _\n                            &amp; \"&lt;td&gt;\" &amp; Cells(cell.Row, \"F\").Value &amp; \"&lt;/td&gt;\" _\n                            &amp; \"&lt;td&gt;\" &amp; Cells(cell.Row, \"G\").Value &amp; \"&lt;/td&gt;\" _\n                            &amp; \"&lt;td&gt;\" &amp; Cells(cell.Row, \"L\").Value &amp; \"&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br /&gt;&lt;/font&gt;\" &amp; Signature\n\n\n\n            With Message1\n                .to = \"email@email.com\"\n                .CC = Cells(cell.Row, \"N\") &amp; \";\" &amp; Cells(cell.Row, \"O\")\n                .Subject = \"Reminder for Label Artwork Tracking (Artwork Expected Date) - Product Family (\" &amp; Cells(cell.Row, \"B\").Value &amp; \")\"\n                .HTMLBody = emailBody\n\n\n\n                .Send\n                End With\n\n\n\n\n            On Error GoTo 0\n            Set OutMail = Nothing\n    End If\n    Next cell\n\ncleanup:\n    Set OutApp = Nothing\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "hyperlink", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449641195, "post_id": 34171496, "comment_id": 56090790, "body": "Record a macro while creating a hyperlink: that will give you the code you need.  You can use <code>Application.GetOpenFileName</code> to allow the user to select a file."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 5158904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2739a6a3b09b17c618e8e13626fe4bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Ball", "link": "https://stackoverflow.com/users/5158904/alex-ball"}, "is_accepted": false, "score": 0, "last_activity_date": 1449644640, "creation_date": 1449644640, "answer_id": 34172612, "question_id": 34171496, "link": "https://stackoverflow.com/questions/34171496/user-form-command-button-to-embed-hyperlink-to-spreadsheet-database/34172612#34172612", "title": "User Form Command Button to embed hyperlink to spreadsheet database", "body": "<p>I want to comment to Tim Williams but its too hard to format.</p>\n\n<p>Thanks for your suggestion to record a macro, it gave me some clues as to what to do. I now have a working solution, but it is quite ugly.</p>\n\n<pre><code>Private Sub AddHyper_button_Click()\n    Dim URL As String\n    URL = Application.GetOpenFilename\n    Hyperlink_textbox = URL\nEnd Sub\n\nPrivate Sub Hyperlink_Label_Click()\n    Dim URL As String\n    Dim cellvalue As Variant\n\n    cellvalue = Hyperlink_textbox.Value\n    URL = cellvalue\n\n    On Error GoTo urlnotopen\n    ActiveWorkbook.FollowHyperlink Address:=URL, NewWindow:=True\n    Exit Sub\nurlnotopen:\n    MsgBox \"Cannot open \" &amp; URL\nEnd Sub\n</code></pre>\n\n<p>This finds the file address on button click, posts it to a text box on the form (which is hidden) which can be then written to the correct cell. There is also a label on the form which will follow the hyperlink to the correct file.</p>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1449656475, "last_edit_date": 1449656475, "creation_date": 1449649044, "answer_id": 34173832, "question_id": 34171496, "link": "https://stackoverflow.com/questions/34171496/user-form-command-button-to-embed-hyperlink-to-spreadsheet-database/34173832#34173832", "title": "User Form Command Button to embed hyperlink to spreadsheet database", "body": "<p>You don't need to put the selection in a textbox, unless you really want to.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim x As String\n    x = Application.GetOpenFilename\n    Label1 = x\n\nEnd Sub\n\nPrivate Sub Label1_Click()\n    ActiveWorkbook.FollowHyperlink Address:=Me.Label1, NewWindow:=True\n    Unload Me\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    With Label1\n        .ForeColor = vbBlue\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Here is a short clip on this.\n<a href=\"https://youtu.be/YgbhX1DFRDM\" rel=\"nofollow\">UserForm HyperLink</a></p>\n"}], "owner": {"reputation": 41, "user_id": 5158904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2739a6a3b09b17c618e8e13626fe4bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Ball", "link": "https://stackoverflow.com/users/5158904/alex-ball"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2989, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1449656475, "creation_date": 1449639652, "last_edit_date": 1531164843, "question_id": 34171496, "link": "https://stackoverflow.com/questions/34171496/user-form-command-button-to-embed-hyperlink-to-spreadsheet-database", "title": "User Form Command Button to embed hyperlink to spreadsheet database", "body": "<p>I have a simple spreadsheet database where the second column of every row contains a hyperlink to a pdf. Each Hyperlink is unique for each row.</p>\n\n<p>I want to add a command button to a user form that when clicked, allows the user to browse to the correct pdf and embed it as a hyperlink into the spreadsheet database in the correct cell. (cell 2 or every row in my case)</p>\n\n<p>I know how to create a label that will follow the hyperlink once it is in the cell, but I am totally stuck on how to embed the hyperlink in the first place!</p>\n\n<p>Hope someone can help.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5648663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f1f1b209df43f3b7a3890ea416a5316?s=128&d=identicon&r=PG&f=1", "display_name": "DNunz", "link": "https://stackoverflow.com/users/5648663/dnunz"}, "edited": false, "score": 0, "creation_date": 1449636971, "post_id": 34170733, "comment_id": 56089312, "body": "Thanks Sergey, I tried your suggestion. The problem with that is that although the Access Options buttons does display now when i click it the Current Database options is disabled, so I&#39;m still unable to change the ribbon selection - which BTW I did create two exactly as you described but evidently need to try something different. Any other ideas maybe?"}, {"owner": {"reputation": 3, "user_id": 5648663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f1f1b209df43f3b7a3890ea416a5316?s=128&d=identicon&r=PG&f=1", "display_name": "DNunz", "link": "https://stackoverflow.com/users/5648663/dnunz"}, "edited": false, "score": 0, "creation_date": 1449637969, "post_id": 34170733, "comment_id": 56089639, "body": "Sergey! It worked after all... you just need to release the [shift] key to enter the password on the login screen but THEN by pressing again the [shift] key before pressing [enter] I regained access to the full menus. Thanks a million, you&#39;ve saved me from a whole lots of headaches!"}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 3, "user_id": 5648663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f1f1b209df43f3b7a3890ea416a5316?s=128&d=identicon&r=PG&f=1", "display_name": "DNunz", "link": "https://stackoverflow.com/users/5648663/dnunz"}, "edited": false, "score": 0, "creation_date": 1449638553, "post_id": 34170733, "comment_id": 56089831, "body": "Yes, password required if database is encrypted. Please accept the answer if you are satisfied."}, {"owner": {"reputation": 3, "user_id": 5648663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f1f1b209df43f3b7a3890ea416a5316?s=128&d=identicon&r=PG&f=1", "display_name": "DNunz", "link": "https://stackoverflow.com/users/5648663/dnunz"}, "edited": false, "score": 0, "creation_date": 1449641737, "post_id": 34170733, "comment_id": 56090967, "body": "Thanks again and I did click the green arrow, hope that is how the answer is shown as accepted."}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1449635324, "creation_date": 1449635324, "answer_id": 34170733, "question_id": 34170497, "link": "https://stackoverflow.com/questions/34170497/need-to-override-the-ribbon-assigned-to-database-on-access-2007/34170733#34170733", "title": "Need to override the ribbon assigned to database on access 2007", "body": "<p>Hold Shift when starting the application. It prevents loading forms, ribbons and autoexec macros. Google for \"bypass key\".</p>\n\n<p>I'd recommend to create at least two ribbon menus: one for development, with system groups and full backstage (File) menu and production, without. </p>\n"}], "owner": {"reputation": 3, "user_id": 5648663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f1f1b209df43f3b7a3890ea416a5316?s=128&d=identicon&r=PG&f=1", "display_name": "DNunz", "link": "https://stackoverflow.com/users/5648663/dnunz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 34170733, "answer_count": 1, "score": -1, "last_activity_date": 1449635324, "creation_date": 1449633703, "question_id": 34170497, "link": "https://stackoverflow.com/questions/34170497/need-to-override-the-ribbon-assigned-to-database-on-access-2007", "title": "Need to override the ribbon assigned to database on access 2007", "body": "<p>I'm a small business owner and I'm very new to Access/VBA programming and in trying to protect my Access 2007 database I created a ribbon that restricts users permissions to forms, reports, etc. </p>\n\n<p>Although I gave myself what I thought were the right permissions (as the Admin user in the Admins group) now, when I log into access, the ribbon I created (or some other setting I must have changed) does not allow the \"Access Options\" button to be displayed when I click the round Office Button so now I'm unable to continue work on designing the forms, queries, reports, etc.</p>\n\n<p>How can I override the ribbon selected before the database actually opens, after entering my login information? or just please explain how can I get the \"Access Options\" button to display again?</p>\n\n<p>Getting desperate over here, I've watched all the videos I found and read postings to no avail... Help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48960, "user_id": 2522554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83cebe27d4fdd15bb1fb77bab95ff493?s=128&d=identicon&r=PG", "display_name": "bansi", "link": "https://stackoverflow.com/users/2522554/bansi"}, "edited": false, "score": 0, "creation_date": 1449632004, "post_id": 34170262, "comment_id": 56087833, "body": "do you mean <code>ElseIf</code>?"}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1449632078, "post_id": 34170262, "comment_id": 56087861, "body": "At what point do you assign a value to <code>Average</code>?"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1449632367, "post_id": 34170262, "comment_id": 56087955, "body": "Made some changes I get a new error, Loop without Do"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1449633283, "post_id": 34170262, "comment_id": 56088250, "body": "There is a typo in your code, .Valve should be .Value This is why you get the object doesn&#39;t support the method error"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1449633739, "post_id": 34170262, "comment_id": 56088354, "body": "Fixed all the typos and updated the code, same error just new location"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1449633778, "post_id": 34170262, "comment_id": 56088367, "body": "Have you tried my code?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1449633804, "post_id": 34170262, "comment_id": 56088377, "body": "Typo: you have <code>Average = Cells(i, 6).Valve</code> with a <code>v</code>, should be <code>Average = Cells(i, 6).Value</code> with a <code>u</code>"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1449633883, "post_id": 34170262, "comment_id": 56088395, "body": "@Chris, there is more than one, EVERY Value is typed as Valve :)"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1449634036, "post_id": 34170262, "comment_id": 56088438, "body": "Duraholiday you changed the wrong one, you change the only one that was correctly .Value to .Valve also. You need to do a little research on objects, properties and methods, Cells can have a Value, a formula or many other things, they can&#39;t have a Valve"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1449634282, "post_id": 34170262, "comment_id": 56088504, "body": "Ughh, Yeah I see that now... Mechanical Engineer probs haha. Sorry guys."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1449634714, "post_id": 34170262, "comment_id": 56088615, "body": "All good mate, glad we could get it working for you :). Check the updated code in my post, condensed it down a bit more for you :)"}], "answers": [{"tags": [], "owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "is_accepted": false, "score": 1, "last_activity_date": 1449632017, "creation_date": 1449632017, "answer_id": 34170286, "question_id": 34170262, "link": "https://stackoverflow.com/questions/34170262/do-until-loop-syntax-error-vba-excel/34170286#34170286", "title": "Do Until loop Syntax error vba excel", "body": "<p>Change</p>\n\n<pre><code>Dim Average As Double\ni As Integer\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Dim Average As Double\nDim i As Integer\n\nor\n\nDim Average As Double, i As Integer\n\nor\n\nDim Average As Double, _\ni As Integer\n</code></pre>\n\n<p>Your code needs a little more work. Use something like this:</p>\n\n<pre><code>Sub Grade()\nDim Average As Double\nDim i As Integer\n\ni = 3\n\nDo Until IsEmpty(Cells(i, 7))\n\n    Cells(i, 6).Value = Average\n    ' Perhaps the above should be \n    ' Average = Cells(i,6).Value\n\n    If (Average &lt; 60) Then\n        Cells(i, 7).Valve = (\"E\")\n    End If\n    If (Average &lt; 70) Then\n        Cells(i, 7).Valve = (\"D\")\n    End If\n    If (Average &lt; 80) Then\n        Cells(i, 7).Valve = (\"C\")\n    End If\n    If (Average &lt; 90) Then\n        Cells(i, 7).Valve = (\"B\")\n    End If\n    If (Average &lt; 100) Then\n        Cells(i, 7).Valve = (\"A\")\n    End If\n\n    i = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 1, "creation_date": 1449634110, "post_id": 34170331, "comment_id": 56088461, "body": "Because you have .Valve everywhere instead of .Value. You would be better off trying to understand the code I have given you and sticking with that as opposed to trying to get the bloated multiple if code working. Happy to help you if you want to make it work but it&#39;s not as efficient. Alternatively use the multiple if code I posted, that should work also."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1449634938, "post_id": 34170331, "comment_id": 56088694, "body": "You might want to debug the &quot;fixed&quot; version of the OPs code.  Not only won&#39;t it work if the grade column is empty (column 7), but if is does run it gives everybody an A"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1449679996, "post_id": 34170331, "comment_id": 56115173, "body": "Yeah i started to use it today and this issue happens. If the grade for example is 75 then it will put C then it will go to the next if statement and sees that its less then 80 and changes it to B and then A... how can i get around this?"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 0, "last_activity_date": 1449635865, "last_edit_date": 1449635865, "creation_date": 1449632415, "answer_id": 34170331, "question_id": 34170262, "link": "https://stackoverflow.com/questions/34170262/do-until-loop-syntax-error-vba-excel/34170331#34170331", "title": "Do Until loop Syntax error vba excel", "body": "<p>Just a thought on @zedfoxus post</p>\n\n<p>Single line ifs don't need an end if</p>\n\n<pre><code>Sub Grade()\nDim Average As Double\nDim i As Long\n\ni = 3\n\nDo Until IsEmpty(Cells(i, 7))\n\n    Average = Cells(i, 6).Value\n    Average = Average * 100    \n    If (Average &lt; 60) Then Cells(i, 7).Value = (\"E\")\n    If (Average &lt; 70) Then Cells(i, 7).Value = (\"D\")\n    If (Average &lt; 80) Then Cells(i, 7).Value = (\"C\")\n    If (Average &lt; 90) Then Cells(i, 7).Value = (\"B\")\n    If (Average &lt; 100) Then Cells(i, 7).Value = (\"A\")\n\n    i = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Further to this though, here is my take on the problem. I have put together a condensed routine using a 2 dimensional array and taking advantage of the worksheet function Vlookup. This works because it will find the closest thing (useful when you are using ranges of numbers)</p>\n\n<pre><code>Sub Grade()\nDim Average As Double, i As Long, MyArr As Variant\nMyArr = Array(Array(60, \"E\"), Array(70, \"D\"), Array(80, \"C\"), Array(90, \"B\"), Array(100, \"A\"))\ni = 3\nDo Until IsEmpty(Cells(i, 7))\n    Average = Cells(i, 6).Value * 100 'Why * 100? Anyway just copied what you have done in your code\n    Cells(i, 7).Value = Application.WorksheetFunction.VLookup(Average, MyArr, 2)\n    i = i + 1\nLoop\nEnd Sub\n</code></pre>\n\n<p>And lastly, because the Average variable is only used once, it doesn't really need to be there (whilst it could be argued the same for MyArr it would be too bloated to include in the Vlookup, it would become hard to read), you can remove it and just reference its makeup in the Vlookup to condense the code further, and finally, we can remove <code>i=3</code> and <code>i=i+1</code> by using a for next loop and polling to the last row of data like so:</p>\n\n<pre><code>Sub Grade()\nDim i as long, MyArr As Variant\nMyArr = Array(Array(60, \"E\"), Array(70, \"D\"), Array(80, \"C\"), Array(90, \"B\"), Array(100, \"A\"))\nFor i = 3 To Range(\"G\" &amp; Rows.Count).End(xlUp).Row\n    Cells(i, 7).Value = Application.WorksheetFunction.VLookup(Cells(i, 6).Value * 100, MyArr, 2)\nLoop\nEnd Sub\n</code></pre>\n\n<p>I am not sure why you are multiplying by 100 and I don't have your test data. I made my own test data but had to remove the *100 to make it work, my data was in column F.</p>\n\n<pre><code>40  \n50  \n60  E\n65  E\n70  D\n75  D\n80  C\n85  C\n90  B\n95  B\n100 A\n</code></pre>\n\n<p>This is the code I used:</p>\n\n<pre><code>Sub Grade2()\nDim i As Long, MyArr As Variant\nMyArr = Array(Array(60, \"E\"), Array(70, \"D\"), Array(80, \"C\"), Array(90, \"B\"), Array(100, \"A\"))\nFor i = 3 To Range(\"F\" &amp; Rows.Count).End(xlUp).Row\n    Cells(i, 7).Value = Application.WorksheetFunction.VLookup(Cells(i, 6).Value, MyArr, 2)\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1449633737, "creation_date": 1449633737, "answer_id": 34170502, "question_id": 34170262, "link": "https://stackoverflow.com/questions/34170262/do-until-loop-syntax-error-vba-excel/34170502#34170502", "title": "Do Until loop Syntax error vba excel", "body": "<p>I wonder if you want to use Formula instead of VBA.</p>\n\n<p>Vlookup can do this. As below, hope this help.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ctQzN.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ctQzN.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1800, "favorite_count": 0, "accepted_answer_id": 34170331, "answer_count": 3, "score": -1, "last_activity_date": 1449635865, "creation_date": 1449631732, "last_edit_date": 1449633474, "question_id": 34170262, "link": "https://stackoverflow.com/questions/34170262/do-until-loop-syntax-error-vba-excel", "title": "Do Until loop Syntax error vba excel", "body": "<p>I'm trying to write this module to compute a letter grade from a % in the next cell over and loop through the rows until the row is empty. Whats wrong with the syntax of this code? I get error: Runtime error 438: Object doesnt support this property or method at <code>Average = Cells(i, 6).Valve</code></p>\n\n<pre><code>Sub Grade()\nDim Average As Double\nDim i As Integer\n\ni = 3\n\nDo Until IsEmpty(Cells(i, 6))\n\nAverage = Cells(i, 6).Valve\nAverage = Average * 100\n\nIf (Average &lt;= 60) Then\n    Cells(i, 7).Valve = (\"E\")\nEnd If\nIf (Average &lt;= 70) Then\n    Cells(i, 7).Valve = (\"D\")\nEnd If\nIf (Average &lt;= 80) Then\n    Cells(i, 7).Valve = (\"C\")\nEnd If\nIf (Average &lt;= 90) Then\n    Cells(i, 7).Valve = (\"B\")\nEnd If\nIf (Average &lt;= 100) Then\n    Cells(i, 7).Valve = (\"A\")\nEnd If\n\ni = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1449633005, "post_id": 34170199, "comment_id": 56088153, "body": "Can you be a little more specific about how it&#39;s not working?  Either that or  spell out what you want to do.  I can see what this code is doing, but I&#39;m not exactly sure what you want it to do.  Maybe a before and desired after sample?"}, {"owner": {"reputation": 1, "user_id": 5657251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUE3Y.png?s=128&g=1", "display_name": "Anmol goel", "link": "https://stackoverflow.com/users/5657251/anmol-goel"}, "reply_to_user": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1449633417, "post_id": 34170199, "comment_id": 56088274, "body": "Thank you for the quick reply Hambone! First of all this code has become system specific/user specific (please see the code where i am asking the code to open a workbook) ,if i share this macro with my team that link becomes orphan ,resulting in a code crash"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1449635682, "post_id": 34170199, "comment_id": 56088915, "body": "if the problem is with link, then you should use <code>Environ(&quot;USERPROFILE&quot;)</code> <a href=\"http://stackoverflow.com/questions/31820485/not-able-to-get-my-vba-code-to-work-outlook-2010/31820964#31820964\">Example</a>  <code>sPath = Environ(&quot;USERPROFILE&quot;) &amp; &quot;\\Desktop\\Events for tomorrow format.xlsx</code>"}, {"owner": {"reputation": 1, "user_id": 5657251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUE3Y.png?s=128&g=1", "display_name": "Anmol goel", "link": "https://stackoverflow.com/users/5657251/anmol-goel"}, "edited": false, "score": 0, "creation_date": 1449636869, "post_id": 34170199, "comment_id": 56089286, "body": "(USERPROFILE)? shall i enter the name of user here?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1449641011, "post_id": 34170199, "comment_id": 56090719, "body": "You enter the code literally as posted by @Om3r"}, {"owner": {"reputation": 1, "user_id": 5657251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUE3Y.png?s=128&g=1", "display_name": "Anmol goel", "link": "https://stackoverflow.com/users/5657251/anmol-goel"}, "edited": false, "score": 0, "creation_date": 1449644633, "post_id": 34170199, "comment_id": 56092146, "body": "i did that but the code crashes again - Compile Error: Syntax Error"}, {"owner": {"reputation": 1, "user_id": 5657251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUE3Y.png?s=128&g=1", "display_name": "Anmol goel", "link": "https://stackoverflow.com/users/5657251/anmol-goel"}, "edited": false, "score": 0, "creation_date": 1449644706, "post_id": 34170199, "comment_id": 56092174, "body": "Workbooks.Open Filename:= _     &quot;sPath = Environ(&quot;USERPROFILE&quot;) &amp; &quot;\\Desktop\\2015 AIX Integrated Workbook and Schedule.xlsb&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": false, "score": 0, "last_activity_date": 1449657628, "creation_date": 1449657628, "answer_id": 34176712, "question_id": 34170199, "link": "https://stackoverflow.com/questions/34170199/how-can-i-copy-data-from-one-workbook-and-create-another-workbook/34176712#34176712", "title": "How can I copy data from one workbook and create another workbook?", "body": "<p>Looks like you already have some useful answers in the comments above, but here are a few extra tips:\nYou don't need to \"select\" objects in order to use them in VBA. The lines where you have:</p>\n\n<pre><code>Columns(\"B:E\").Select\nSelection.Delete Shift:=xlToLeft\n</code></pre>\n\n<p>... can simply be written as:</p>\n\n<pre><code>Columns(\"B:E\").Delete Shift:=xlToLeft\n</code></pre>\n\n<p>Also you don't need <em>any</em> of the ActiveWindow.ScrollColumn lines. These will typically be added into your code by the macro recorder, because it records every single change you make. The macro recorder is a great way to start learning VBA, but the next step you'll take is to realise that half the lines generated are unnecessary :)</p>\n\n<p>Another thing you might like to do is to add the following at the beginning and end of your code:</p>\n\n<pre><code>Application.Screenupdating = False\nApplication.Calculation = xlCalculationManual\n    ... your code here\nApplication.Calculation = xlCalculationAutomatic\nApplication.Screenupdating = True\n</code></pre>\n\n<p>Without these lines, you may notice the screen flickering as it visually displays all the steps to the user; and you may have some speed issues due to the repeated recalculation of formul\u00e6 on your sheet as cells are modified. The lines above suspend these activities from taking place at the beginning of your code, then reinstate them at the end.</p>\n"}], "owner": {"reputation": 1, "user_id": 5657251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cUE3Y.png?s=128&g=1", "display_name": "Anmol goel", "link": "https://stackoverflow.com/users/5657251/anmol-goel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1449657628, "creation_date": 1449631281, "last_edit_date": 1449632963, "question_id": 34170199, "link": "https://stackoverflow.com/questions/34170199/how-can-i-copy-data-from-one-workbook-and-create-another-workbook", "title": "How can I copy data from one workbook and create another workbook?", "body": "<p>I would like to know how I can copy data from one workbook and paste it into another workbook. Note - 'Another workbook' contains a specific format in which data should be pasted and the first workbook is humongous source of data, so I should be able to go to a specific tab, unhide hidden columns, apply date filters, remove the data not needed and then paste the remaining fields and data in second workbook.</p>\n\n<p><img src=\"https://i.stack.imgur.com/cDxGG.png\" alt=\"Review dates Tab\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/iYyFs.png\" alt=\"Specified format\"></p>\n\n<pre><code>Option Explicit\n\nSub EventsForTomorrow()\n'\n' EventsForTomorrow Macro\n' This macro will fetchevent scheduled for tomorrow data from AIX workbook\n'\n' Keyboard Shortcut: Ctrl+Shift+E\n'\n    Workbooks.Open Filename:= _\n        \"C:\\Users\\agoel5\\Desktop\\2015 AIX Integrated Workbook and Schedule.xlsb\"\n    Range(\"A11\").Select\n    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True\n    ActiveSheet.ListObjects(\"Review_Dates\").Range.AutoFilter Field:=2, Criteria1 _\n        :=xlFilterTomorrow, Operator:=xlFilterDynamic\n    Columns(\"A:BD\").Select\n    Selection.EntireColumn.Hidden = False\n    Columns(\"A:A\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"B:E\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"F:L\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"F:F\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"H:I\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"J:J\").Select\n    ActiveWindow.ScrollColumn = 2\n    ActiveWindow.ScrollColumn = 3\n    ActiveWindow.ScrollColumn = 5\n    ActiveWindow.ScrollColumn = 8\n    ActiveWindow.ScrollColumn = 12\n    ActiveWindow.ScrollColumn = 13\n    ActiveWindow.ScrollColumn = 15\n    ActiveWindow.ScrollColumn = 14\n    ActiveWindow.ScrollColumn = 10\n    ActiveWindow.ScrollColumn = 9\n    Columns(\"J:AL\").Select\n    Selection.Delete Shift:=xlToLeft\n    ActiveWindow.ScrollColumn = 3\n    ActiveWindow.ScrollColumn = 1\n    Range(\"Review_Dates[[#Headers],[Planned Date]]\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(\"A3:I14181\").Select\n    Selection.Copy\n    Application.CutCopyMode = False\n    Selection.Copy\n    Workbooks.Open Filename:= _\n        \"C:\\Users\\agoel5\\Desktop\\Events for tomorrow format.xlsx\"\n    Range(\"B7\").Select\n    Selection.PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _\n        , SkipBlanks:=False, Transpose:=False\n    Range(\"G10\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vbscript"], "comments": [{"owner": {"reputation": 344, "user_id": 1445609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba139f5c8152aeb92705236e7faa53d0?s=128&d=identicon&r=PG", "display_name": "davidmneedham", "link": "https://stackoverflow.com/users/1445609/davidmneedham"}, "edited": false, "score": 0, "creation_date": 1449630950, "post_id": 34170075, "comment_id": 56087555, "body": "Take a look at this similar question: <a href=\"http://stackoverflow.com/questions/5109841/vbscript-data-validation-numeric-1-results-in-infinite-loop\" title=\"vbscript data validation numeric 1 results in infinite loop\">stackoverflow.com/questions/5109841/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5613056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-D7tQxylox_8/AAAAAAAAAAI/AAAAAAAAANA/aPXN-HMXtSU/photo.jpg?sz=128", "display_name": "Jon Chan", "link": "https://stackoverflow.com/users/5613056/jon-chan"}, "edited": false, "score": 0, "creation_date": 1449710776, "post_id": 34170848, "comment_id": 56130698, "body": "thank you this works well! Is there a way to make the Loop end if the user clicks on the Exit or Cancel button?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 53, "user_id": 5613056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-D7tQxylox_8/AAAAAAAAAAI/AAAAAAAAANA/aPXN-HMXtSU/photo.jpg?sz=128", "display_name": "Jon Chan", "link": "https://stackoverflow.com/users/5613056/jon-chan"}, "edited": false, "score": 0, "creation_date": 1449721188, "post_id": 34170848, "comment_id": 56133335, "body": "Check second part of solution."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 2, "last_activity_date": 1449721127, "last_edit_date": 1449721127, "creation_date": 1449635983, "answer_id": 34170848, "question_id": 34170075, "link": "https://stackoverflow.com/questions/34170075/create-loop-based-on-length-of-user-input/34170848#34170848", "title": "Create Loop based on Length of User Input", "body": "<p>There are no max length inputbox in VBS, but try this:</p>\n\n<pre><code>Dim UserInput\nUserInput = InputChecker\n' You can reuse the accepted user input\n\nFunction InputChecker\n    Dim Input, Length       \n    Do\n        Input = Trim(InputBox(\"Enter your name\")) ' Remove spaces at front and back\n        Length = Len(Input)\n        If Length &lt;&gt; 8 Then Msgbox \"Input must be 8 characters\"\n    Loop Until Length = 8\n    MsgBox \"Input Success\"\n    InputChecker = Input\nEnd Function\n</code></pre>\n\n<p><HR>\nTo trap <kbd>Cancel</kbd> or <strong><kbd>X</kbd></strong> the Inputbox, check if it's <strong>FALSE</strong>. See below with adjustments to UI and program flow.</p>\n\n<pre><code>Dim UserInput\nUserInput = InputChecker\n' You can reuse the accepted user input\nIf Length = 8 Then Wscript.Echo \"User input: \"\"\" &amp; UserInput &amp; \"\"\"\"\n\nFunction InputChecker\n    Dim Input, Length       \n    Do\n        Input = InputBox(\"Enter your name\",\"Enter your name (must be 8 characters)\")\n        If Input = False Then Exit Do\n        Input = Trim(Input) ' Remove spaces at front and back\n        Length = Len(Input)\n        If Length &lt;&gt; 8 Then\n            If Msgbox(\"Input must be 8 characters, not \" &amp; Len(Input) &amp; \"!\",5+48,\"INPUT LENGTH ERROR\") = 2 Then\n                Input = \"\" ' Reset it to empty string\n                Exit Do\n            End If\n        End If\n    Loop Until Length = 8\n    InputChecker = Input\nEnd Function\n</code></pre>\n\n<p>Ref: \n<a href=\"https://msdn.microsoft.com/en-us/library/sfw6660x(v=vs.84).aspx\" rel=\"nofollow\">MsgBox</a>, \n<a href=\"https://msdn.microsoft.com/en-us/library/3yfdhzk5(v=vs.84).aspx\" rel=\"nofollow\">InputBox</a></p>\n"}], "owner": {"reputation": 53, "user_id": 5613056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-D7tQxylox_8/AAAAAAAAAAI/AAAAAAAAANA/aPXN-HMXtSU/photo.jpg?sz=128", "display_name": "Jon Chan", "link": "https://stackoverflow.com/users/5613056/jon-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 34170848, "answer_count": 1, "score": 1, "last_activity_date": 1449721127, "creation_date": 1449630408, "last_edit_date": 1449649921, "question_id": 34170075, "link": "https://stackoverflow.com/questions/34170075/create-loop-based-on-length-of-user-input", "title": "Create Loop based on Length of User Input", "body": "<p><strong>Problem</strong></p>\n\n<p>Although the current code prompts the user to retry their input if he/she enters an input that is less or more than 8 characters on the first try, the user can still enter an erroneous code on the second try. </p>\n\n<p><strong>Question</strong></p>\n\n<p>How do I make a loop that keeps on prompting the user to retry, until their answer is 8 characters long?</p>\n\n<p>Alternatively, is it possible to make an input that only has space for 8 characters?</p>\n\n<p><strong>Current VBScript:</strong></p>\n\n<pre><code>Call InputChecker\n\nFunction InputChecker\n  Dim Input\n  Input = InputBox(\"Enter your name\") \n\n  If Len(Input) &lt;&gt; 8 Then\n    Msgbox (\"Input must be 8 characters\")\n    Input = InputBox(\"Enter your name\")\n  Else\n    MsgBox (\"Input Success\")\n  End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 484, "user_id": 5657234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b97c13e55d26cfd933e457777d55531?s=128&d=identicon&r=PG&f=1", "display_name": "Zoltan", "link": "https://stackoverflow.com/users/5657234/zoltan"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449637958, "post_id": 34170022, "comment_id": 56089636, "body": "Hi Tim, thanks for replying but I get the same error.  Again, this is run as a VBscript if it helps. (unknown runtime error)"}], "answers": [{"tags": [], "owner": {"reputation": 484, "user_id": 5657234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b97c13e55d26cfd933e457777d55531?s=128&d=identicon&r=PG&f=1", "display_name": "Zoltan", "link": "https://stackoverflow.com/users/5657234/zoltan"}, "is_accepted": true, "score": 1, "last_activity_date": 1449639277, "creation_date": 1449639277, "answer_id": 34171423, "question_id": 34170022, "link": "https://stackoverflow.com/questions/34170022/how-to-refer-to-a-cell-using-a-string-in-vbscript/34171423#34171423", "title": "How to refer to a cell using a string in VBScript?", "body": "<p>Turns out the code was fine.  It's my input files that were wrong.\nRemoving the double quotes at the start and end of the lines fixed it.</p>\n"}], "owner": {"reputation": 484, "user_id": 5657234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b97c13e55d26cfd933e457777d55531?s=128&d=identicon&r=PG&f=1", "display_name": "Zoltan", "link": "https://stackoverflow.com/users/5657234/zoltan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 34171423, "answer_count": 1, "score": -1, "last_activity_date": 1449639277, "creation_date": 1449630035, "question_id": 34170022, "link": "https://stackoverflow.com/questions/34170022/how-to-refer-to-a-cell-using-a-string-in-vbscript", "title": "How to refer to a cell using a string in VBScript?", "body": "<p>I'm trying to write a VBscript that will take three argument:\nargument0 :  the excel file to modify, for example C:\\temp\\temp.xls</p>\n\n<p>argument1:  the name of a text file containing the list of images to insert . \nThe first three lines could be:\n\"c:\\temp\\image1.gif\" \n\"c:\\temp\\image2.gif\"\n\"c:\\temp\\image3.gif\"</p>\n\n<p>argument2:  the name of a text file containing the list of the in which to insert the images. The first three lines could be:\n\"A2\"\n\"C3\"\n\"E2\"</p>\n\n<hr>\n\n<p>Here is what I have so far, my code crashes at this line: \n mycell = xlObj.ActiveSheet.range(cellule)</p>\n\n<hr>\n\n<pre><code>argument0 = \"C:\\temp\\temp.xls\"\nargument1 = \"c:\\temp\\images.txt\"\nargument2= \"c:\\temp\\cellules.txt\"\n\nSet xlObj = CreateObject(\"Excel.Application\")\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\n'Set file = fso.GetFile(WScript.Arguments(0)) \nSet file          = fso.GetFile(argument0) \nset file_images   =fso.OpenTextFile(argument1)\nset file_cellules =fso.OpenTextFile(argument2)\nset xlWB = xlObj.Workbooks.Open(file)\n\n\n\nDo Until file_cellules.AtEndOfStream\n cellule   =     file_cellules.ReadLine\n image     =     file_images.ReadLine\n\n mycell = xlObj.ActiveSheet.range(cellule)\ncellleft = mycell.Left\ncelltop = mycell.Top\ncellheight =mycell.Height\ncellwidth = mycellWidth\n\n  With xlObj.ActiveSheet.Shapes.AddPicture(image, _\n    True, True, cellleft, celltop, cellwidth, cellheight)    \n  End With\nLoop        \n  xlWB.save\n  xlWB.close\n\nxlObj.quit\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449628589, "post_id": 34169412, "comment_id": 56086942, "body": "what defines old / new range in terms of your code? does it relate to <code>Sheet3</code> or <code>Sheet2</code>? When does it get copied in? Is the <code>Worksheet_Change</code> event triggered from the copy? As a side note, <code>ThisWorkbook.RefreshAll</code> will refresh all your pivots at once without having to loop the sheets and tables.*(note - this will also refresh data connections if you have any, which you may not want to do)*"}, {"owner": {"reputation": 31, "user_id": 5616236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37e2a247f0955c3a2f571bfbd2105b9?s=128&d=identicon&r=PG&f=1", "display_name": "rookie17768", "link": "https://stackoverflow.com/users/5616236/rookie17768"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1449633105, "post_id": 34169412, "comment_id": 56088193, "body": "@scott I&#39;ve updated the post... thanks"}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 31, "user_id": 5616236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37e2a247f0955c3a2f571bfbd2105b9?s=128&d=identicon&r=PG&f=1", "display_name": "rookie17768", "link": "https://stackoverflow.com/users/5616236/rookie17768"}, "edited": false, "score": 0, "creation_date": 1449670724, "post_id": 34179917, "comment_id": 56108241, "body": "@rookie17768 - glad it works and glad I could help. Please mark as answered if has indeed solved your question :)"}, {"owner": {"reputation": 31, "user_id": 5616236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37e2a247f0955c3a2f571bfbd2105b9?s=128&d=identicon&r=PG&f=1", "display_name": "rookie17768", "link": "https://stackoverflow.com/users/5616236/rookie17768"}, "edited": false, "score": 0, "creation_date": 1449671487, "post_id": 34179917, "comment_id": 56108775, "body": "No worries Scott... for a newbie, its always good to see what improvements can be done to make the code readable and efficient.  I&#39;ve tested the code and it works when I paste the new data. Now I tried to delete the bottom row then accept the change but it deleted all the data... I&#39;ll try to find a solution for that or just make sure to always paste the data. Thanks again :)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 31, "user_id": 5616236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37e2a247f0955c3a2f571bfbd2105b9?s=128&d=identicon&r=PG&f=1", "display_name": "rookie17768", "link": "https://stackoverflow.com/users/5616236/rookie17768"}, "edited": false, "score": 0, "creation_date": 1449672418, "post_id": 34179917, "comment_id": 56109537, "body": "ah ... good find to break the code! ... that is <b>very</b> important with <code>Worksheet_Change</code> event code, because so <b>many</b> things can trigger it. One thing you could to avoid when you delete entire rows would be to add this to the initial <code>If</code> block ... <code>And Me.Columns.Count &lt;&gt; Target.Columns.Count</code> ... But that will not work if you just delete a few columns from the row... so you&#39;ll have to be crafty as you consider all possible things that can happen."}, {"owner": {"reputation": 31, "user_id": 5616236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37e2a247f0955c3a2f571bfbd2105b9?s=128&d=identicon&r=PG&f=1", "display_name": "rookie17768", "link": "https://stackoverflow.com/users/5616236/rookie17768"}, "edited": false, "score": 0, "creation_date": 1449673946, "post_id": 34179917, "comment_id": 56110674, "body": "Got that Scott... I was looking into adding conditions on the if statements to address the issue... even tried to step into the code to check the values I was getting (should&#39;ve chosen this field... I love talking to myself when something&#39;s wrong with the logic hahaha)"}, {"owner": {"reputation": 31, "user_id": 5616236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37e2a247f0955c3a2f571bfbd2105b9?s=128&d=identicon&r=PG&f=1", "display_name": "rookie17768", "link": "https://stackoverflow.com/users/5616236/rookie17768"}, "edited": false, "score": 1, "creation_date": 1449679762, "post_id": 34179917, "comment_id": 56115014, "body": "<code>If Application.Intersect(Range(&quot;A1&quot;), Target) Is Nothing</code> solved it :)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1449667361, "creation_date": 1449667361, "answer_id": 34179917, "question_id": 34169412, "link": "https://stackoverflow.com/questions/34169412/excel-vba-worksheet-change-event-copy-paste-clear-data/34179917#34179917", "title": "Excel/VBA - worksheet change event copy/paste/clear data", "body": "<p>You can use the <code>Target</code> argument of the <code>Worksheet_Change</code> Event to determine how many rows were pasted in and compare that against any additional rows that still exist and delete any additional rows that are there.</p>\n\n<p>I have fleshed that out in the code below and tested it. I also refactored your code in some ways that I thought made sense based on your question. I also put plenty of comments in the code to explain myself. Please ignore anything I may have misunderstood and apologies if I stepped on your code, too much :)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Application.Intersect(Range(\"A:D\"), Target) Is Nothing Then\n\n    'confirm changes\n    Dim processDB As Integer\n\n    processDB = MsgBox(\"Raw data has been changed. Do you want to accept the changes?\", vbOKCancel)\n\n    If processDB = 2 Then\n\n        With Application\n            .EnableEvents = False\n            .Undo\n            .EnableEvents = True\n        End With\n\n        Exit Sub 'put this because do you really need to update pivot tables and other data if there is no change?\n\n    End If\n\n    'clear out old data\n    Dim lRowsRange As Long, lRowsTotal As Long\n    lRows = Target.Rows.Count 'get row count of newly pasted range\n    lRowsTotal = Me.Range(\"A\" &amp; Me.Rows.Count).End(xlUp).Row 'get row count of all data on sheet\n\n    If lRowsTotal &gt; lRows Then\n\n        Application.EnableEvents = False\n        Me.Range(Rows(lRowsTotal), Rows(lRows + 1)).Delete 'if total rows of data is more than paste range, delete extra rows\n        Application.EnableEvents = True\n\n    End If\n\n    'refresh pivot tables\n    ThisWorkbook.RefreshAll\n\n    'Dim xWs As Worksheet, xTable As PivotTable\n    'For Each xWs In ThisWorkbook.Worksheets\n    '    For Each xTable In xWs.PivotTables\n    '        xTable.RefreshTable\n    '    Next\n    'Next\n\n    ndata = Sheet3.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    Sheet3.Range(\"A\" &amp; ndata &amp; \":\" &amp; \"D\" &amp; ndata).Value = Sheet2.Range(\"B6:E6\").Value\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5616236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37e2a247f0955c3a2f571bfbd2105b9?s=128&d=identicon&r=PG&f=1", "display_name": "rookie17768", "link": "https://stackoverflow.com/users/5616236/rookie17768"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1862, "favorite_count": 0, "accepted_answer_id": 34179917, "answer_count": 1, "score": 0, "last_activity_date": 1449667361, "creation_date": 1449625813, "last_edit_date": 1531164843, "question_id": 34169412, "link": "https://stackoverflow.com/questions/34169412/excel-vba-worksheet-change-event-copy-paste-clear-data", "title": "Excel/VBA - worksheet change event copy/paste/clear data", "body": "<p>I'm new to VBA and I was trying to automate a daily routine we do using excel. Basically I just want to copy raw data from a tool we have then paste this to excel. What the macro does is to process the data, put it in a table and generate a summary which will then be used for our reports. To do this, I have the following code</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim processDB As Integer\nDim xWs As Worksheet\nDim xTable As PivotTable\nIf Not Application.Intersect(Range(\"A:D\"), Target) Is Nothing Then\n    processDB = MsgBox(\"Raw data has been changed. Do you want to accept the changes?\", vbOKCancel)\n    Application.EnableEvents = False\n    If processDB = 2 Then\n        Application.Undo\n    End If\n    Application.EnableEvents = True\n    For Each xWs In Application.ActiveWorkbook.Worksheets\n        For Each xTable In xWs.PivotTables\n            xTable.RefreshTable\n        Next\n    Next\nndata = Sheet3.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\nSheet3.Range(\"A\" &amp; ndata &amp; \":\" &amp; \"D\" &amp; ndata).Value = Sheet2.Range(\"B6:E6\").Value\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Problem is when the old data is larger than the new one. Let's say old = A1:D10 then new = A1:D5 so A6:D10 should be cleared. I need to somehow clear the values below the newly pasted table before processing. I was thinking of using global variables to record the last value of the rows then work with that but I'm not sure if there's another way to do this. </p>\n\n<p>I copy the raw data from another application then paste it in sheet1... when the code detects a change it'll just update the pivot on sheet 2 and will record the summary for that day on sheet 3. The problem I have is when I paste a smaller data range.</p>\n\n<pre><code>OLD\nAAA BBB CCC DDD\n11  12  13  14\n12  13  14  15\n\nNEW\nAAA BBB CCC DDD\n33  36  39  44\n\nResult\nAAA BBB CCC DDD\n33  36  39  44\n12  13  14  15 &lt;&lt;&lt; need this cleared somehow when I paste the new data\n</code></pre>\n\n<p>Any help is greatly appreciated and sorry for the newbie question :(</p>\n"}, {"tags": ["excel", "vba", "parsing", "web-scraping", "internet-explorer-11"], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "edited": false, "score": 0, "creation_date": 1449629371, "post_id": 34169561, "comment_id": 56087145, "body": "@user3185735 - second pair of eyes always helps :)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 3, "last_activity_date": 1449626638, "creation_date": 1449626638, "answer_id": 34169561, "question_id": 34169217, "link": "https://stackoverflow.com/questions/34169217/vba-excel-2013-automation-open-links-in-same-browser-window-tab/34169561#34169561", "title": "VBA [EXCEL 2013]: Automation: Open Links in Same Browser Window / Tab", "body": "<p>The reason it opens a new window each time is that you tell it to at the beginning of your loop with this line <code>Set ie = New InternetExplorerMedium</code></p>\n\n<p>There are two ways to solve it.</p>\n\n<ol>\n<li>Initiate IE before the loop, then quit IE after the loop is done:</li>\n</ol>\n\n<p>Like so:</p>\n\n<pre><code>Dim ie As InternetExplorerMedium\nSet ie = New InternetExplorerMedium\nie.Visible = True\n\nFor startNumber = 1 To TotalProfiles\n\n     Application.StatusBar = \"Loading profile: \" &amp; ProfileNumber &amp; \"; file location: \" &amp; currentProfile\n     Do While ie.READYSTATE &lt;&gt; READYSTATE_COMPLET\n          DoEvents\n     Loop\n\n     Set currentProfile = Worksheets(\"List_of_Files\").Range(\"B\" &amp; CurrentRowPosition)\n     ie.navigate currentProfile\n\n     Application.StatusBar = \"Storing \" &amp; currentProfile &amp; \" information into HTMLElement\"\n\n     Set html = ie.document\n\n     [some code here...]\n\nNext\n\nSet html = Nothing\nie.Quit\nSet ie = Nothing\n</code></pre>\n\n<ol start=\"2\">\n<li>Quit the IE instance each time before you end your loop (probably not as efficient as first way)</li>\n</ol>\n\n<p>Like so:</p>\n\n<pre><code>For startNumber = 1 To TotalProfiles\n\n     Dim ie As InternetExplorerMedium\n     Set ie = New InternetExplorerMedium\n     ie.Visible = True\n\n     Application.StatusBar = \"Loading profile \" &amp; ProfileNumber &amp; \" from a total of \" &amp; TotalProfiles &amp; \" profiles\"\n     Set currentProfile = Worksheets(\"List_of_Files\").Range(\"B\" &amp; CurrentRowPosition)\n     ie.navigate currentProfile\n\n     Application.StatusBar = \"Loading profile: \" &amp; ProfileNumber &amp; \"; file location: \" &amp; currentProfile\n     Do While ie.READYSTATE &lt;&gt; READYSTATE_COMPLET\n          DoEvents\n     Loop\n\n     Application.StatusBar = \"Storing \" &amp; currentProfile &amp; \" information into HTMLElement\"\n     Set html = ie.document\n\n     [some code here...]\n\n     Set html = Nothing\n     ie.Quit\n     Set ie = Nothing\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 3185735, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/821e449c4eb130625aeb2c1738da4a57?s=128&d=identicon&r=PG&f=1", "display_name": "user3185735", "link": "https://stackoverflow.com/users/3185735/user3185735"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1598, "favorite_count": 0, "accepted_answer_id": 34169561, "answer_count": 1, "score": 1, "last_activity_date": 1449626638, "creation_date": 1449624565, "question_id": 34169217, "link": "https://stackoverflow.com/questions/34169217/vba-excel-2013-automation-open-links-in-same-browser-window-tab", "title": "VBA [EXCEL 2013]: Automation: Open Links in Same Browser Window / Tab", "body": "<p>I want to parse with VBA (Excel) a long list of local webpages (<code>.HTM</code> files) and extract some data into excel. There are more than 9000 webpages which the program needs to scrape. This is an example:</p>\n\n<pre><code>&gt; C:\\Users\\User_ID\\Webpages\\BS_1000.HTM.htm\nC:\\Users\\User_ID\\Webpages\\BS_1001.HTM.htm\nC:\\Users\\User_ID\\Webpages\\BS_1002.HTM.htm\nC:\\Users\\User_ID\\Webpages\\BS_1003.HTM.htm\nC:\\Users\\User_ID\\Webpages\\BS_1006.HTM.htm\nC:\\Users\\User_ID\\Webpages\\BS_1007.HTM.htm\nC:\\Users\\User_ID\\Webpages\\BS_1011.HTM.htm\nC:\\Users\\User_ID\\Webpages\\BS_1012.HTM.htm\nC:\\Users\\User_ID\\Webpages\\BS_1015.HTM.htm\nC:\\Users\\User_ID\\Webpages\\BS_1016.HTM.htm\n[... and the list goes on ...]\n</code></pre>\n\n<p>Here is the VBA:</p>\n\n<pre><code>&lt;!-- language: lang-HTML --&gt;\nFor startNumber = 1 To TotalProfiles\nDim ie As InternetExplorerMedium\nSet ie = New InternetExplorerMedium\nie.Visible = True\n\nApplication.StatusBar = \"Loading profile \" &amp; ProfileNumber &amp; \" from a total of \" &amp; TotalProfiles &amp; \" profiles\"\nSet currentProfile = Worksheets(\"List_of_Files\").Range(\"B\" &amp; CurrentRowPosition)\nie.navigate currentProfile\n\nApplication.StatusBar = \"Loading profile: \" &amp; ProfileNumber &amp; \"; file location: \" &amp; currentProfile\nDo While ie.READYSTATE &lt;&gt; READYSTATE_COMPLET\nDoEvents\nLoop\n\nApplication.StatusBar = \"Storing \" &amp; currentProfile &amp; \" information into HTMLElement\"\nSet html = ie.document\nSet ie = Nothing\n[some code here...]\n</code></pre>\n\n<p>The problem is that my current code opens each page in a new IE window (without closing the previous). With more than 9000 webpages to scrape, this can very soon be a very big problem.</p>\n\n<p>I use Internet Explorer 11 (on Windows 7 Enterprise SP1) with Microsoft Office 2013.</p>\n\n<p>What I would like is that IE should open each webpage in the same tab (pretty much just refresh the already \"in use\" tab after finishing parsing and load the next page - or at least close the window after finishing parsing and open the next webpage in a \"new\" window). Sadly, I didn't manage to find a solution until now. Any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5411829, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/61b1eb7ee30ffc07f84994a0a7d3cdd4?s=128&d=identicon&r=PG&f=1", "display_name": "CuriousGeorge", "link": "https://stackoverflow.com/users/5411829/curiousgeorge"}, "edited": false, "score": 0, "creation_date": 1449619307, "post_id": 34168405, "comment_id": 56084234, "body": "Steps is the height of my matrix... in this case it will end 1 Row X 1000 columns."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 181, "user_id": 5411829, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/61b1eb7ee30ffc07f84994a0a7d3cdd4?s=128&d=identicon&r=PG&f=1", "display_name": "CuriousGeorge", "link": "https://stackoverflow.com/users/5411829/curiousgeorge"}, "edited": false, "score": 1, "creation_date": 1449619790, "post_id": 34168405, "comment_id": 56084410, "body": "But that is not what your code is saying.  every loop you redim preserve the array a one dimensional array with 1000 items, but you are only filling the last slot; 1000."}, {"owner": {"reputation": 181, "user_id": 5411829, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/61b1eb7ee30ffc07f84994a0a7d3cdd4?s=128&d=identicon&r=PG&f=1", "display_name": "CuriousGeorge", "link": "https://stackoverflow.com/users/5411829/curiousgeorge"}, "edited": false, "score": 0, "creation_date": 1449620004, "post_id": 34168405, "comment_id": 56084480, "body": "Sorry about that, the Steps should of been &quot;i&quot; as in your code, that&#39;s a typo - still same issue."}, {"owner": {"reputation": 181, "user_id": 5411829, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/61b1eb7ee30ffc07f84994a0a7d3cdd4?s=128&d=identicon&r=PG&f=1", "display_name": "CuriousGeorge", "link": "https://stackoverflow.com/users/5411829/curiousgeorge"}, "edited": false, "score": 0, "creation_date": 1449620204, "post_id": 34168405, "comment_id": 56084538, "body": "I answered my question, looks like it was transposed later in the code so it was printing the first number 1000 times. I swear I looked at this for 15 minutes. Thanks for your help Scott."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 181, "user_id": 5411829, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/61b1eb7ee30ffc07f84994a0a7d3cdd4?s=128&d=identicon&r=PG&f=1", "display_name": "CuriousGeorge", "link": "https://stackoverflow.com/users/5411829/curiousgeorge"}, "edited": false, "score": 0, "creation_date": 1449620262, "post_id": 34168405, "comment_id": 56084559, "body": "@CuriousGeorge the redim preserve is still not needed.  Your code and mine will do the same, but mine uses a lot less memory."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 5, "last_activity_date": 1449619685, "last_edit_date": 1449619685, "creation_date": 1449619128, "answer_id": 34168405, "question_id": 34168382, "link": "https://stackoverflow.com/questions/34168382/rnd-returning-only-one-variable-in-array/34168405#34168405", "title": "Rnd() returning only one variable in array", "body": "<p>Steps is always 1000</p>\n\n<pre><code>Steps = 1000\nDim ArrayRand(1 to Steps) As Double\nFor i = 1 To Steps\n    Randomize\n    ArrayRand(i) = WorksheetFunction.NormSInv(Rnd())\nNext i\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 5411829, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/61b1eb7ee30ffc07f84994a0a7d3cdd4?s=128&d=identicon&r=PG&f=1", "display_name": "CuriousGeorge", "link": "https://stackoverflow.com/users/5411829/curiousgeorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1449619924, "creation_date": 1449619010, "last_edit_date": 1531164843, "question_id": 34168382, "link": "https://stackoverflow.com/questions/34168382/rnd-returning-only-one-variable-in-array", "title": "Rnd() returning only one variable in array", "body": "<p>I am trying to create an array of random sigmas. When I call the below code it generates an array of 1000 identical numbers, please advise.</p>\n\n<pre><code>Steps = 1000\nDim ArrayRand() As Double\nFor i = 1 To Steps\n    ReDim Preserve ArrayRand(1 To Steps)\n    Randomize\n    ArrayRand(i) = WorksheetFunction.NormSInv(Rnd)\nNext i\n</code></pre>\n"}, {"tags": ["python", "excel", "vba", "xlwings"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1449618532, "post_id": 34167920, "comment_id": 56083937, "body": "Maybe <code>RunPython (&quot;import Test; Test.sayhi(&#39;&quot; &amp; name &amp; &quot;&#39;)&quot;)</code>"}, {"owner": {"reputation": 6671, "user_id": 2242044, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/220021af6dbb03bde70f36ddbabb5562?s=128&d=identicon&r=PG", "display_name": "user2242044", "link": "https://stackoverflow.com/users/2242044/user2242044"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449674784, "post_id": 34167920, "comment_id": 56111309, "body": "@TimWilliams...Ha oops was getting frustrated with xlwings and overlooked the obvious. Submit as an answer please."}], "answers": [{"comments": [{"owner": {"reputation": 6671, "user_id": 2242044, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/220021af6dbb03bde70f36ddbabb5562?s=128&d=identicon&r=PG", "display_name": "user2242044", "link": "https://stackoverflow.com/users/2242044/user2242044"}, "edited": false, "score": 0, "creation_date": 1449628879, "post_id": 34169813, "comment_id": 56087021, "body": "not familiar with ExcelPython, looked it up, but can you clarify the difference between this and xlwings?"}, {"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "edited": false, "score": 0, "creation_date": 1449647733, "post_id": 34169813, "comment_id": 56093638, "body": "ExcelPython has been integrated into xlwings as of v0.6.0, see <a href=\"http://docs.xlwings.org/whatsnew.html#v0-6-0-november-30-2015\" rel=\"nofollow noreferrer\">what&#39;s new</a> and the <a href=\"http://docs.xlwings.org/udfs.html\" rel=\"nofollow noreferrer\">docs</a>"}, {"owner": {"reputation": 5157, "user_id": 918626, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8c377a6e6f8a5a6910bb62f51c6f853?s=128&d=identicon&r=PG", "display_name": "Felix Zumstein", "link": "https://stackoverflow.com/users/918626/felix-zumstein"}, "edited": false, "score": 0, "creation_date": 1449647955, "post_id": 34169813, "comment_id": 56093763, "body": "Note that the <code>RunPython</code> call has currently the advantage of being cross-platform - if that&#39;s not an issue, use the decorator-based syntax from the integrated ExcelPython project."}, {"owner": {"reputation": 318, "user_id": 3104257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ece9a469ab82e0ee50f973981c93e3ca?s=128&d=identicon&r=PG&f=1", "display_name": "bobyuan", "link": "https://stackoverflow.com/users/3104257/bobyuan"}, "edited": false, "score": 0, "creation_date": 1449814925, "post_id": 34169813, "comment_id": 56178902, "body": "Thanks to Felix, I noticed the 2 are now combined, which definitely is a good news."}], "tags": [], "owner": {"reputation": 318, "user_id": 3104257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ece9a469ab82e0ee50f973981c93e3ca?s=128&d=identicon&r=PG&f=1", "display_name": "bobyuan", "link": "https://stackoverflow.com/users/3104257/bobyuan"}, "is_accepted": false, "score": 0, "last_activity_date": 1449640160, "last_edit_date": 1449640160, "creation_date": 1449628463, "answer_id": 34169813, "question_id": 34167920, "link": "https://stackoverflow.com/questions/34167920/passing-a-variable-from-excel-to-python-with-xlwings/34169813#34169813", "title": "Passing a variable from Excel to Python with XLwings", "body": "<p>The text inside RunPython() should be a valid python script. So the comment from \"Tim Williams\" is a quick solution. You just need to be careful to avoid ' character inside the name variable to break the python script.</p>\n\n<p>If you need to write UDF (User Defined Function) a lot, or need to pass in value to get the output and then handle the result via VBA, try use ExcelPython instead of Xlwings. </p>\n\n<p>Note, ExcelPython and Xlwings can work together, you can have both without conflict.</p>\n\n<p>I think it's better you play the example to understand the difference. My understanding is limited to my knowledge, which might not be correct. </p>\n\n<p>To summarize the difference:</p>\n\n<ul>\n<li>ExcelPython needs a installer to be installed, it is good in UDF, which helps if you want to pass arguments in and out, and the function is cached in memory, so later call will be very quick.</li>\n<li>Xlwings is simpler by just add the VBA module, no installer needed. It trigger Python in the background each time to run the script (each call starts a new process), in the script you can manipulate (read/write) Excel via COM.</li>\n</ul>\n\n<p>I have the same question in the beginning, but later I find out using VBA in Excel side (intellisense) plus ExcelPython on UDF (simply process and return the data back) is a nice combination, so I think ExcelPython is only what I need.</p>\n\n<p>As mentioned earlier, the 2 components have no conflict, you can have both. If the 2 author agree too, it is a good idea to combine them.</p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 5, "last_activity_date": 1449675092, "creation_date": 1449675092, "answer_id": 34182685, "question_id": 34167920, "link": "https://stackoverflow.com/questions/34167920/passing-a-variable-from-excel-to-python-with-xlwings/34182685#34182685", "title": "Passing a variable from Excel to Python with XLwings", "body": "<p>Make sure you're supplying the argument correctly:</p>\n\n<pre><code>RunPython (\"import Test; Test.sayhi('\" &amp;  name &amp; \"')\") \n</code></pre>\n"}], "owner": {"reputation": 6671, "user_id": 2242044, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/220021af6dbb03bde70f36ddbabb5562?s=128&d=identicon&r=PG", "display_name": "user2242044", "link": "https://stackoverflow.com/users/2242044/user2242044"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4984, "favorite_count": 1, "accepted_answer_id": 34182685, "answer_count": 2, "score": 2, "last_activity_date": 1449675092, "creation_date": 1449616555, "question_id": 34167920, "link": "https://stackoverflow.com/questions/34167920/passing-a-variable-from-excel-to-python-with-xlwings", "title": "Passing a variable from Excel to Python with XLwings", "body": "<p>I am trying write a simple user defined function in Python that I pass a value to from <code>Excel</code> via <code>Xlwings</code>. I ran across some examples with an Add-in that you need to import user defined functions, but that seems overly complex. </p>\n\n<p>Why isn't my example working?</p>\n\n<p>VBA:</p>\n\n<pre><code>Function Hello(name As String) As String\n    RunPython (\"import Test; Test.sayhi(name)\")\nEnd Function\n</code></pre>\n\n<p>Python (<code>Test.py</code>):</p>\n\n<pre><code>from xlwings import Workbook, Range\n\ndef sayhi(name):\n    wb = Workbook.caller()\n    return 'Hello {}'.format(name)\n</code></pre>\n\n<p>Error: </p>\n\n<pre><code>NameError: name 'name' is not defined\n</code></pre>\n"}, {"tags": ["string", "vba", "excel", "extract"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449614056, "post_id": 34167355, "comment_id": 56082088, "body": "<code>instr</code> for &quot;, &quot; then do a <code>left</code> for 8 from there."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449614172, "post_id": 34167355, "comment_id": 56082148, "body": "Is it always the forth number, ie is there always a three digit number with a comma in the front?"}, {"owner": {"reputation": 59, "user_id": 3812753, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5692fdc6b54a4fe0b8618e59ff02c39f?s=128&d=identicon&r=PG&f=1", "display_name": "user3812753", "link": "https://stackoverflow.com/users/3812753/user3812753"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449614345, "post_id": 34167355, "comment_id": 56082226, "body": "@ScottCraner there could be a 3 digit number with a comma or without a comma, depends on the people filling out the spreadsheet"}, {"owner": {"reputation": 59, "user_id": 3812753, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5692fdc6b54a4fe0b8618e59ff02c39f?s=128&d=identicon&r=PG&f=1", "display_name": "user3812753", "link": "https://stackoverflow.com/users/3812753/user3812753"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449614378, "post_id": 34167355, "comment_id": 56082239, "body": "@findwindow sorry, forgot to mention that not always a comma exist there. Maybe this helps that every number starts with 6 and then 7 digits?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449614467, "post_id": 34167355, "comment_id": 56082273, "body": "oh lol didn&#39;t even see the <code>id</code> my fault XD Edit: don&#39;t debug and comment!"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1449614582, "post_id": 34167355, "comment_id": 56082328, "body": "&quot;depends on the people filling out the spreadsheet&quot; - shudder. That means they might do anything to the cell and no logic or rule can be applied. Restrict what they can enter. Let them enter the ID into a different cell and use data validation."}, {"owner": {"reputation": 59, "user_id": 3812753, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5692fdc6b54a4fe0b8618e59ff02c39f?s=128&d=identicon&r=PG&f=1", "display_name": "user3812753", "link": "https://stackoverflow.com/users/3812753/user3812753"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1449614732, "post_id": 34167355, "comment_id": 56082406, "body": "@teylyn thanks for your advise, I am thinking about that for a while, problem is that there might be more than 20-30 workbooks which operates on the same logic... Corporate stuff :)"}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 2, "creation_date": 1449614737, "post_id": 34167355, "comment_id": 56082408, "body": "I suspect you could get it to work using Regex and some instructions described in this highly upvoted answer here using a match pattern something like `[0-9]{8,8}:  <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a>"}, {"owner": {"reputation": 59, "user_id": 3812753, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5692fdc6b54a4fe0b8618e59ff02c39f?s=128&d=identicon&r=PG&f=1", "display_name": "user3812753", "link": "https://stackoverflow.com/users/3812753/user3812753"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1449614777, "post_id": 34167355, "comment_id": 56082422, "body": "@pnuts works like a charm. I believe I will go with your solution as this I think is as simple as this could get. I will still check for macro based solution if any will occur. Thank you very much."}, {"owner": {"reputation": 59, "user_id": 3812753, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5692fdc6b54a4fe0b8618e59ff02c39f?s=128&d=identicon&r=PG&f=1", "display_name": "user3812753", "link": "https://stackoverflow.com/users/3812753/user3812753"}, "reply_to_user": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1449614950, "post_id": 34167355, "comment_id": 56082491, "body": "@marc thanks for the regex. I saw it few times but never came up to step by step instructions. Will definetely find it where to use."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 3812753, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5692fdc6b54a4fe0b8618e59ff02c39f?s=128&d=identicon&r=PG&f=1", "display_name": "user3812753", "link": "https://stackoverflow.com/users/3812753/user3812753"}, "edited": false, "score": 0, "creation_date": 1449616318, "post_id": 34167585, "comment_id": 56083040, "body": "I am not sure where one post did go, but I have used that function that was called &quot;extracteight&quot;.... Thanks though!"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 59, "user_id": 3812753, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5692fdc6b54a4fe0b8618e59ff02c39f?s=128&d=identicon&r=PG&f=1", "display_name": "user3812753", "link": "https://stackoverflow.com/users/3812753/user3812753"}, "edited": false, "score": 1, "creation_date": 1449674134, "post_id": 34167585, "comment_id": 56110815, "body": "@user3812753 ok, great that you are using the other solution but I want to point out, if my memory serves me correct, that the other solution was checking 8 character chunks for IsNumeric so 6547.8411 would return true.  The reason I did the approach I did was that it would fail if it came across a period. therefor 6547.8411 would not be returned as your 8 digits. - I am aware that 6547.8411 is 9 digits but I wanted to show the full number so as to alleviate anyone coming back stating the number was not correct.....hope that makes sense"}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 1, "last_activity_date": 1449615051, "creation_date": 1449615051, "answer_id": 34167585, "question_id": 34167355, "link": "https://stackoverflow.com/questions/34167355/excel-vba-extracting-8-digits-sequence-from-a-string-in-cell/34167585#34167585", "title": "EXCEL VBA: extracting 8 digits sequence from a string in cell", "body": "<p>You can also write a UDF to accomplish this task, example below</p>\n\n<pre><code>Public Function GetMy8Digits(cell As Range)\nDim s As String\nDim i As Integer\nDim answer\nDim counter As Integer\n\n'get cell value\ns = cell.Value\n\n'set the counter\ncounter = 0\n'loop through the entire string\nFor i = 1 To Len(s)\n    'check to see if the character is a numeric one\n    If IsNumeric(Mid(s, i, 1)) = True Then\n        'add it to the answer\n        answer = answer + Mid(s, i, 1)\n        counter = counter + 1\n        'check to see if we have reached 8 digits\n        If counter = 8 Then\n            GetMy8Digits = answer\n            Exit Function\n        End If\n     Else\n     'was not numeric so reset counter and answer\n     counter = 0\n     answer = \"\"\n    End If\nNext i\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1449625728, "post_id": 34167666, "comment_id": 56086179, "body": "@pnuts when I was building it I wanted to insure that any leading zeroes were captured, then thought I thought I needed to change it back to a number.  I kept adding till it worked. Then took it too far. :)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 5, "last_activity_date": 1449624901, "last_edit_date": 1449624901, "creation_date": 1449615370, "answer_id": 34167666, "question_id": 34167355, "link": "https://stackoverflow.com/questions/34167355/excel-vba-extracting-8-digits-sequence-from-a-string-in-cell/34167666#34167666", "title": "EXCEL VBA: extracting 8 digits sequence from a string in cell", "body": "<p>Try this formula:</p>\n\n<pre><code>=--TEXT(LOOKUP(10^8,MID(SUBSTITUTE(A1,\" \",\"x\"),ROW(INDIRECT(\"1:\"&amp;LEN(A1)-7)),8)+0),\"00000000\")\n</code></pre>\n\n<p>This will return the 8 digit number in the string.</p>\n\n<p>To return just the text then:</p>\n\n<pre><code>=TEXT(LOOKUP(10^8,MID(SUBSTITUTE(A1,\" \",\"x\"),ROW(INDIRECT(\"1:\"&amp;LEN(A1)-7)),8)+0),\"00000000\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1449633141, "last_edit_date": 1449633141, "creation_date": 1449631839, "answer_id": 34170273, "question_id": 34167355, "link": "https://stackoverflow.com/questions/34167355/excel-vba-extracting-8-digits-sequence-from-a-string-in-cell/34170273#34170273", "title": "EXCEL VBA: extracting 8 digits sequence from a string in cell", "body": "<p>Here is an alternative:</p>\n\n<p><code>=RIGHT(TRIM(MID(SUBSTITUTE(A1,\",\",REPT(\" \",LEN(A1))),LEN(A4),LEN(A1))),8)</code></p>\n\n<p>Replace all commas with spaces repeated the length of the string,</p>\n\n<p>Then take the mid point starting from the length of the original string for the length of the string (ie second word in new string)</p>\n\n<p>Trim out the spaces</p>\n\n<p>take the right 8 chars to trim out any extra chars (like id)</p>\n"}], "owner": {"reputation": 59, "user_id": 3812753, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5692fdc6b54a4fe0b8618e59ff02c39f?s=128&d=identicon&r=PG&f=1", "display_name": "user3812753", "link": "https://stackoverflow.com/users/3812753/user3812753"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2231, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1449633141, "creation_date": 1449613975, "question_id": 34167355, "link": "https://stackoverflow.com/questions/34167355/excel-vba-extracting-8-digits-sequence-from-a-string-in-cell", "title": "EXCEL VBA: extracting 8 digits sequence from a string in cell", "body": "<p>Good day everyone,</p>\n\n<p>I am trying to find a smart solution of extracting 8 digits from a cell (unique ID). The problem here occurs that it might look like this:</p>\n\n<pre><code>112, 65478411, sale\n746, id65478411, sale 12.50\n999, 65478411\n999, id65478411\n</code></pre>\n\n<p>Thats most of the cases, and probably all mentioned, so I basically need to find the 8 digits in the cell and extract them into different cell. Does anyone have any ideas? I though of eliminating the first characted, then check if the cell is starting with the id, eliminate it further but I understood that this is not the smart way..</p>\n\n<p>Thank you for the insights.</p>\n"}, {"tags": ["excel", "vba", "copy", "cell", "isnumeric"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1449612980, "post_id": 34167032, "comment_id": 56081583, "body": "<i>I have been struggling with this for quite a while now</i>  &lt;-- What have you tried so far?"}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1449613481, "post_id": 34167032, "comment_id": 56081796, "body": "What have you tried and do you have any ideas about what could/might work that you haven&#39;t tried?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1449613956, "post_id": 34167032, "comment_id": 56082041, "body": "You could do this with an Advanced Filter.  No vba required."}, {"owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449617520, "post_id": 34167032, "comment_id": 56083545, "body": "I tried this. It works but is quite cumbersome and still has code that would need to be removed before sent. Also it needs to be simple for others to use when I am away."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449617680, "post_id": 34167032, "comment_id": 56083611, "body": "You do not need any code to use Advanced Filter, but you do need a little know how, and it is not the most intuitive."}, {"owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449617760, "post_id": 34167032, "comment_id": 56083649, "body": "I tried my own code and many other examples from this website and attempted to modify them to work. The code is now gone (excel crashed and the restore was corrupt). I can list the links to the 12 VBA scripts if that will help."}, {"owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449618187, "post_id": 34167032, "comment_id": 56083812, "body": "@ScottCraner I&#39;m sorry I was saying that it shows everything correctly, but like you pointed out it isn&#39;t simple (which it needs to be for others) and if you try to copy and past it into something else, it still leave the formula =E9-F9+G9...."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449618481, "post_id": 34167032, "comment_id": 56083916, "body": "With Advanced filter there is an option to copy to another page automatically and the formulas do not come across."}, {"owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449626131, "post_id": 34167032, "comment_id": 56086298, "body": "@ScottCraner This is what I first attempted, I&#39;m sorry to say I was unsuccessful in making it copy over only three columns."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449626409, "post_id": 34167032, "comment_id": 56086374, "body": "See <a href=\"http://excelsemipro.com/2011/03/copy-data-to-another-worksheet-with-advanced-filter/\" rel=\"nofollow noreferrer\">this</a>.  It is a good reference."}, {"owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449627899, "post_id": 34167032, "comment_id": 56086751, "body": "Thanks for that, Do you have an example that would allow you to only copy over specific columns if the value is true?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1449758552, "post_id": 34167032, "comment_id": 56153877, "body": "I revised my answer based on your updated code, and it should avoid the second bug.  About the first bug, is C8:P8 a row that contains labels/headers? Or is it data?"}, {"owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449821688, "post_id": 34167032, "comment_id": 56181887, "body": "Had to make a minor correction as the data is on column 14     &#39;Copy column P to column D     rng.Columns(14).SpecialCells(xlCellTypeVisible).Copy&#39; Well ideally it should be C9:P9 as that is the beginning of the list. Currently that is a blank line to avoid confusion."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449617856, "post_id": 34167228, "comment_id": 56083689, "body": "I get error 424 trying to run this macro. Apparently there is an error with the line  ws.AutoFilter = False"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449623795, "post_id": 34167228, "comment_id": 56085639, "body": "@user5656417 I made a revision to my answer, I think it should be <code>wsFull.AutoFilterMode = False</code>  (<code>ws</code> isn&#39;t a valid object, and even if it was, my original answer had the wrong method name).  Try that and see how it works."}, {"owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449626025, "post_id": 34167228, "comment_id": 56086270, "body": "Ok that is almost exactly it! I am unsure how to copy only those three cells C, D &amp; P from each correct row. It also needs to start at row 9, currently it starts at the beginning and for some unknown reason those cells and text are also being copied. Thank you so much, each time I tried my code was a lot longer than this and unfortunately never worked."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449626555, "post_id": 34167228, "comment_id": 56086413, "body": "Sorry you&#39;re looking for someone else to solve all your problems and deliver turnkey code, for free. That&#39;s really not the spirit of this site and I wouldn&#39;t really be helping anyone if I did that for you.  Good luck."}, {"owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449627600, "post_id": 34167228, "comment_id": 56086672, "body": "Oops sorry first time using this site. If I came a across as ungrateful or needy I do apologize. I have been trying this for a while and shocked how quickly someone else came up with the solution, not sure with the code how to start from a specific row or how to only copy specific cells. I understand if you are hesitant to spell everything out. Do you have any other resources you could point me to? Thanks :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449630881, "post_id": 34167228, "comment_id": 56087540, "body": "As I mentioned in the OP, the Macro Recorder is a good enough place to start. That will show you the <i>literal</i> way to implement your mouse-clicks and keystrokes, in to code. Then it is up to you to make that more <i>flexible</i>.  Learn how to use <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">debugging techniques</a> (seriously I can&#39;t stress this enough), this will make it easier for you to do trial-and-error, and to <i>see</i> and understand what&#39;s happening in the code."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449631003, "post_id": 34167228, "comment_id": 56087575, "body": "For this specific problem, use the macro recorder to applyt he autofilter as I have done. Then instead of copying the entire range, just copy column C, then go to the next sheet, right-click and past-special &quot;Values&quot;.  Repeate for Columns D and P.  Those bits of code can then be integrated or modified along with the methods I used above.  If you do that initial work and then update your Question with your new code from Macro Recorder, I&#39;ll give it another look and make some suggestions and explanations for you."}, {"owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449635032, "post_id": 34167228, "comment_id": 56088724, "body": "Cant post everything, But here is almost all the solution. Currently it records two cells before row 9 and I believe one after. Any ideas on how to start from row 9? Set rng = wsFull.Range(&quot;C:P&quot;) &#39;Range from Begining to End          wsFull.AutoFilterMode = False     &#39;filter so that only numeric values in column P are showing     rng.AutoFilter Field:=14, Criteria1:=&quot;&gt;0&quot;, _         Operator:=xlAnd     rng.Columns(&quot;A:B&quot;).Copy     wsOrder.Range(&quot;B1&quot;).PasteSpecial xlPasteValues          rng.Columns(&quot;N:N&quot;).Copy     wsOrder.Range(&quot;D1&quot;).PasteSpecial xlPasteValues     wsFull.AutoFilterMode = False"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449636231, "post_id": 34167228, "comment_id": 56089067, "body": "You can <i>edit</i> your original question. There, the code is readable, as it can be formatted properly, and also not subject to character count limitations :)  Try tinkering with <code>set rng = wsFull.Range(&quot;C9:P&quot; &amp; Rows.Count)</code> Also, when you&#39;re copying, us the <code>rng.Columns(&quot;N:N&quot;).SpecialCells(xlCellTypeVisible).Copy</code> to copy only the <i>visible</i> cells (those not excluded by the AutoFilter)."}, {"owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449667423, "post_id": 34167228, "comment_id": 56105983, "body": "Ah thanks for the rows.count, that solved the issue. But I am still getting one error (well two really). As the code selects the very first row no matter what is there. Not sure why (the other error is minor as it copies all rows after the last value, not bad really). I can make it so it can copy a blank row if that is needed. But the paste should only list order items. I tried the trick you showed to try and paste &quot;A2:B&quot; but to no success. btw you have been so amazing to get me to this point and help me with this. Even if you don&#39;t know how to resolve this thanks so much for the assistance :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449667897, "post_id": 34167228, "comment_id": 56106263, "body": "Update your Question above, and I&#39;ll try to take another look when I&#39;m in the office later."}, {"owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449702757, "post_id": 34167228, "comment_id": 56127973, "body": "I used up the text limit with the previous comment so I have placed the code below :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449702861, "post_id": 34167228, "comment_id": 56128021, "body": "Just replace the contents of your original question with the called that you&#39;re currently trying to use"}, {"owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "edited": false, "score": 0, "creation_date": 1449704583, "post_id": 34167228, "comment_id": 56128660, "body": "Ah ok, sorry I misunderstood :)"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1449758499, "last_edit_date": 1495540338, "creation_date": 1449613513, "answer_id": 34167228, "question_id": 34167032, "link": "https://stackoverflow.com/questions/34167032/problems-with-an-automated-list-always-selecting-and-pasting-the-first-line-of-t/34167228#34167228", "title": "Problems with an automated list always selecting and pasting the first line of the array", "body": "<p>There are several ways you can do this, but one would be using <code>AutoFilter</code>.  Assuming both worksheets exist. I've made some revisions based on the additional details you've provided, and implement a custom function <code>GetLastRow</code> based on the answer <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">here</a>.</p>\n\n<p>This should avoid the second bug, which is copying some additional blank rows.</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    Dim wsFull As Worksheet, wsOrder As Worksheet\n    Dim rng As Range\n\n    Set wsFull = Worksheets(\"Full List\")\n    Set wsOrder = Worksheets(\"Order\")\n\n    'Clear Columns B, C, &amp; D below row 3 in the Order sheet\n    wsOrder.Range(\"B3:D\" &amp; Rows.Count).ClearContents\n\n    'Set Range to include all columns from C to P starting with row 8\n    Set rng = wsFull.Range(\"C8:P\" &amp; GetLastRow(wsFull, 3))\n    wsFull.AutoFilterMode = False\n\n    'filter so that only numeric values in column P are showing\n    rng.AutoFilter Field:=14, Criteria1:=\"&gt;0\", _\n        Operator:=xlAnd\n\n    'Copy column C to column B\n    rng.Columns(1).SpecialCells(xlCellTypeVisible).Copy\n    wsOrder.Range(\"B2\").PasteSpecial xlPasteValues\n    'Copy column D to column C\n    rng.Columns(2).SpecialCells(xlCellTypeVisible).Copy\n    wsOrder.Range(\"C2\").PasteSpecial xlPasteValues\n    'Copy column P to column D\n    rng.Columns(12).SpecialCells(xlCellTypeVisible).Copy\n    wsOrder.Range(\"D2\").PasteSpecial xlPasteValues\n\n    wsFull.AutoFilterMode = False\nEnd Sub`\n\n\nFunction GetLastRow(sh As Worksheet, column As Long)\n'  Function will return the last effective cell in specified column on worksheet\n'      sh:      Worskheet object i.e., Worksheets(\"Sheet1\")\n'      column:  long/integer value of column, i.e., column A = 1, column N = 12, etc.\n'  Modified from :\n'  https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\n'\nWith sh\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        lastRow = .Cells.Find(What:=\"*\", _\n                      After:=.Cells(1, column), _\n                      Lookat:=xlPart, _\n                      LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious, _\n                      MatchCase:=False).Row\n    Else\n        lastRow = 1\n    End If\nEnd With\n\nGetLastRow = lastRow\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5656417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d205c92f5b9d61aad1882f8dba8ea2a0?s=128&d=identicon&r=PG&f=1", "display_name": "user5656417", "link": "https://stackoverflow.com/users/5656417/user5656417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450632978, "creation_date": 1449612635, "last_edit_date": 1450632978, "question_id": 34167032, "link": "https://stackoverflow.com/questions/34167032/problems-with-an-automated-list-always-selecting-and-pasting-the-first-line-of-t", "title": "Problems with an automated list always selecting and pasting the first line of the array", "body": "<h2>Update:</h2>\n\n<p>Every time the tab is opened it automatically generates the an order list. </p>\n\n<p>As far as I can tell, there is one bug in the code: </p>\n\n<ol>\n<li>The first line on \"Full List\" (in this case C8:P8) is always copied\nand inserted into the new array no matter what is there.</li>\n</ol>\n\n<p>I made it copy a blank row, but the paste into the Order tab should only list order items. I tried pasting all items from the results array aside from the first row but to no success. Oh and thank you so much @David-Zemens for all the assistance on this. You know what you are doing and it shows :)</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    Dim wsList As Worksheet, wsOrder As Worksheet\n    Dim rng As Range\n\n    Set wsList = Worksheets(\"Full List\")\n    Set wsOrder = Worksheets(\"Order\")\n    wsList.Unprotect\n\n    'Clear Columns B, C, &amp; D below row 3 in the Order sheet\n    wsOrder.Range(\"B3:D\" &amp; Rows.Count).ClearContents\n\n    'Set Range to include all columns from C to P starting with row 8\n    Set rng = wsList.Range(\"C8:P\" &amp; GetLastRow(wsList, 3))\n    wsList.AutoFilterMode = False\n\n    'filter so that only numeric values in column P are showing\n    rng.AutoFilter Field:=14, Criteria1:=\"&gt;0\", _\n        Operator:=xlAnd\n\n    'Copy column C (in wsList) to column B (in wsOrder)\n    rng.Columns(1).SpecialCells(xlCellTypeVisible).Copy\n    wsOrder.Range(\"B2\").PasteSpecial xlPasteValues\n    'Copy column D (in wsList) to column C (in wsOrder)\n    rng.Columns(2).SpecialCells(xlCellTypeVisible).Copy\n    wsOrder.Range(\"C2\").PasteSpecial xlPasteValues\n    'Copy column P (in wsList) to column D (in wsOrder)\n    rng.Columns(14).SpecialCells(xlCellTypeVisible).Copy\n    wsOrder.Range(\"D2\").PasteSpecial xlPasteValues\n\n    wsList.AutoFilterMode = False\n    wsList.Protect\n\nEnd Sub\n\nFunction GetLastRow(sh As Worksheet, column As Long)\n'  Function will return the last effective cell in specified column on worksheet\n'      sh:      Worskheet object i.e., Worksheets(\"Sheet1\")\n'      column:  long/integer value of column, i.e., column A = 1, column N = 12, etc.\n'  Modified from :\n'  http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\n'\nWith sh\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        lastRow = .Cells.Find(What:=\"*\", _\n                      After:=.Cells(1, column), _\n                      Lookat:=xlPart, _\n                      LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious, _\n                      MatchCase:=False).Row\n    Else\n        lastRow = 1\n    End If\nEnd With\n\nGetLastRow = lastRow\nEnd Function\n</code></pre>\n\n<h2>Original Post:</h2>\n\n<p>I was hoping that someone might be able to assist.</p>\n\n<p>I created an excel program that allows me to see what the stock levels are and to compare it against counted or expected values. This allows me to see how many items we need to order. </p>\n\n<p>What I was hoping to do was generate (on another tab) a separate list that only shows me the Product Code, Product Name, and the Quantity to order.</p>\n\n<p>The main tab where everything is counted is named \"Full List\" aka Sheet06.</p>\n\n<p>There are multiple rows, but the ones that I am interested in start at row 9 and are on columns C (Product Code), D (Product Name), &amp; P (How many to Order) and there are over a thousand rows of product with some blank rows used to try to make it easy to read (if needed these lines can be filled with something or use column Q to have a TRUE/FALSE \"=ISNUMBER(P9)\" equation)</p>\n\n<p>On Column P, if an order is not needed there is a blank space (=\"\") or text</p>\n\n<pre><code>  |A|B|Product Code|Name     |E|F|G|H|I|J|K|L|M|N|O|Order\n9 | | |00002       |something| | | | | | | | | | | |\"\"\n10| | |345663      |something| | | | | | | | | | | |3\n11| | |6534214     |something| | | | | | | | | | | |15\n12| | |            |         | | | |(Blank row)| | | \n13| | |24435224    |something| | | | | | | | | | | |DONT ORDER\n14| | |8784347     |something| | | | | | | | | | | |8\n15| | |357823      |something| | | | | | | | | | | |\"\"\n</code></pre>\n\n<p>What I have been trying to create (and failing) is another tab called \"Order\" aka Sheet07 </p>\n\n<p>It is supposed to copy over the Product Code, Name, and how many to order if and only if there is a number on row P on the other tab. Also this would have to copy over the value generated for the order (18, 4, etc) not the formula (=E9-F9+G9....).</p>\n\n<pre><code> |A|Product Code|Name     |Order\n4| |345663      |something|3\n5| |6534214     |something|15\n6| |8784347     |something|8\n</code></pre>\n\n<p>I have been struggling with this for quite a while now and I have reached a mental roadblock.</p>\n\n<p>Any help would be appreciated :)</p>\n"}, {"tags": ["vba", "excel", "nested-loops", "ranged-loops"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449611139, "post_id": 34166582, "comment_id": 56080564, "body": "Have you tried autofilter?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1449611430, "post_id": 34166582, "comment_id": 56080732, "body": "This line <code>Set varray = Range(&quot;$F$1&quot;, Cells(Rows.count, &quot;F&quot;).End(x1up)).Value</code> has a typo.  There is a <code>1</code> instead of an <code>l</code> in <code>xlup</code>. If this is not just a transfer typo I would bet that you are cycling through all 1 million + rows."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1449613269, "post_id": 34166582, "comment_id": 56081704, "body": "@ScottCraner - good catch. Another good reason to always use <code>Option Explicit</code> ..."}, {"owner": {"reputation": 689, "user_id": 3575301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aed80b4d6936adbca4637b90da156e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jzz", "link": "https://stackoverflow.com/users/3575301/jzz"}, "edited": false, "score": 0, "creation_date": 1449617089, "post_id": 34166582, "comment_id": 56083354, "body": "Does this compile? I don&#39;t think you can &#39;For Each&#39; with a Long variable. Also, why do you assign the range to a variant? The range itself is a very usable array. Lastly, I think the &#39;Find&#39; function is usually faster then looping a range."}, {"owner": {"reputation": 21, "user_id": 5656435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bc93353d7587b2cf0d894a0a86d8f2d?s=128&d=identicon&r=PG&f=1", "display_name": "lathare", "link": "https://stackoverflow.com/users/5656435/lathare"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449762561, "post_id": 34166582, "comment_id": 56156696, "body": "@ScottCraner That actually is a &quot;one&quot; in that line.  It must look different when copied.  Also, I did use Option Explicit--it was just further up in the code in this Class Module.  Thanks!"}, {"owner": {"reputation": 21, "user_id": 5656435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bc93353d7587b2cf0d894a0a86d8f2d?s=128&d=identicon&r=PG&f=1", "display_name": "lathare", "link": "https://stackoverflow.com/users/5656435/lathare"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449762622, "post_id": 34166582, "comment_id": 56156741, "body": "@findwindow No, I have not tried autofilter, and unfortunately I&#39;m not sure how to do that.  I can google it like I have just about everything in my code, though, unless you happen to have an easy example that would work.  Thanks!"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449763253, "post_id": 34166582, "comment_id": 56157232, "body": "I was <a href=\"http://stackoverflow.com/questions/34028430/deleting-via-autofilter-takes-too-long\">deleting rows</a>, not hiding but should be same idea. The answer posted there is pretty amazing but not sure if applicable to you."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449763256, "post_id": 34166582, "comment_id": 56157235, "body": "It should not be a &#39;one&#39; it should be an lowercase &#39;L&#39; as in <code>XLUP</code> not <code>X1UP</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5656435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bc93353d7587b2cf0d894a0a86d8f2d?s=128&d=identicon&r=PG&f=1", "display_name": "lathare", "link": "https://stackoverflow.com/users/5656435/lathare"}, "edited": false, "score": 0, "creation_date": 1449762880, "post_id": 34166901, "comment_id": 56156935, "body": "I&#39;m trying this now.  Is this part still ok (before the For Each statement)? <code>code</code>  If Not FormatSheet(Sh) Then Exit Sub End If <code>code</code>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1449612207, "creation_date": 1449612207, "answer_id": 34166901, "question_id": 34166582, "link": "https://stackoverflow.com/questions/34166582/how-can-i-improve-performance-in-an-excel-vba-for-loop-with-nested-if-loop/34166901#34166901", "title": "How can I improve performance in an Excel VBA For loop with nested If loop?", "body": "<p>With several very slight changes:</p>\n\n<pre><code>Sub qwerty()\n   Dim r As Range\n   Dim z As Long, N As Long\n   Dim varray As Range\n\n   Application.Calculation = xlCalculationManual\n   Application.ScreenUpdating = False\n   Application.DisplayStatusBar = False\n   Application.EnableEvents = False\n   ActiveSheet.DisplayPageBreaks = False\n\n   N = Cells(Rows.Count, \"F\").End(xlUp).Row\n   Set varray = Range(\"F1:F\" &amp; N)\n\n   For Each r In varray\n      z = r.Value\n      If z = 0 Then\n         r.EntireRow.Hidden = True\n      Else\n         r.EntireRow.Hidden = False\n      End If\n   Next r\n\n   Application.Calculation = xlCalculationAutomatic\n   Application.ScreenUpdating = True\n   Application.DisplayStatusBar = True\n   Application.EnableEvents = True\n   ActiveSheet.DisplayPageBreaks = True\n\nEnd Sub\n</code></pre>\n\n<p>run quite rapidly</p>\n"}, {"tags": [], "owner": {"reputation": 516, "user_id": 5102865, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/71bf035de4fbcb43a6b9a1eb2d07c76e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Ryabov", "link": "https://stackoverflow.com/users/5102865/sergey-ryabov"}, "is_accepted": false, "score": 0, "last_activity_date": 1449612329, "creation_date": 1449612329, "answer_id": 34166937, "question_id": 34166582, "link": "https://stackoverflow.com/questions/34166582/how-can-i-improve-performance-in-an-excel-vba-for-loop-with-nested-if-loop/34166937#34166937", "title": "How can I improve performance in an Excel VBA For loop with nested If loop?", "body": "<p>One thing that may speed up it a little bit.. I would not use <strong>z</strong> variable. You can do the same with existing <strong>r</strong>.</p>\n\n<pre><code>For Each r In varray\nIf r.Value = 0 Then\n    Range(\"F\" &amp; r).EntireRow.Hidden = True\nElse\n    Range(\"F\" &amp; r).EntireRow.Hidden = False\nEnd If\nNext r\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 468, "user_id": 5024196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac86f5c5ed643fd380441ec3fa72a649?s=128&d=identicon&r=PG&f=1", "display_name": "wotter", "link": "https://stackoverflow.com/users/5024196/wotter"}, "is_accepted": false, "score": 0, "last_activity_date": 1570546884, "creation_date": 1570546884, "answer_id": 58289058, "question_id": 34166582, "link": "https://stackoverflow.com/questions/34166582/how-can-i-improve-performance-in-an-excel-vba-for-loop-with-nested-if-loop/58289058#58289058", "title": "How can I improve performance in an Excel VBA For loop with nested If loop?", "body": "<p>I think the quickest way could be to use autofilter. Set the autofilter with values &lt;> 0 and voil\u00e0!</p>\n"}], "owner": {"reputation": 21, "user_id": 5656435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bc93353d7587b2cf0d894a0a86d8f2d?s=128&d=identicon&r=PG&f=1", "display_name": "lathare", "link": "https://stackoverflow.com/users/5656435/lathare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1570546884, "creation_date": 1449611018, "question_id": 34166582, "link": "https://stackoverflow.com/questions/34166582/how-can-i-improve-performance-in-an-excel-vba-for-loop-with-nested-if-loop", "title": "How can I improve performance in an Excel VBA For loop with nested If loop?", "body": "<p>This is my first post, so if I need to make any changes, please let me know.</p>\n\n<p>I've found a few examples of ways to optimize loops, but I cannot seem to apply any of them effectively to my code.  What I'm trying to do is loop through about 170 cells in a single column, and hide or show the entire row based on whether the cell value is 0 or not.</p>\n\n<p>I want the code to run each time I activate certain sheets.  Right now this piece of code is taking about 4 seconds to run.  It seems like it should be much faster than that! That's why I'm here for help.</p>\n\n<p>Here is the code I'm using (FormatSheet returns a BOOLEAN where True means that it is okay to perform this code on this sheet and False means to skip performing this code on this sheet:</p>\n\n<pre><code>Private Sub mobjWb_SheetActivate(ByVal Sh As Object)\n\nDim r As Long\nDim z As Long\nDim varray As Variant\n\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\nApplication.EnableEvents = False\nActiveSheet.DisplayPageBreaks = False\n\nIf Not FormatSheet(Sh) Then\nExit Sub\nEnd If\n\nSet varray = Range(\"$F$1\", Cells(Rows.count, \"F\").End(x1up)).Value\n\n\nFor Each r In varray\n\nz = r.Value\nIf z = 0 Then\nRange(\"F\" &amp; r).EntireRow.Hidden = True\n    Else\n    Range(\"F\" &amp; r).EntireRow.Hidden = False\nEnd If\nNext r\n\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nApplication.DisplayStatusBar = True\nApplication.EnableEvents = True\nActiveSheet.DisplayPageBreaks = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1449613156, "post_id": 34166640, "comment_id": 56081666, "body": "From nutsch without Autofilter <code>Sub SortRawData2()     Dim lLastRow As Long, lLoop As Long     lLastRow = Cells(Rows.Count, 1).End(xlUp).Row     Dim rngDelete As Range      For lLoop = 1 To lLastRow Step 3         Cells(lLoop, 2) = Cells(lLoop + 1, 1)         Cells(lLoop, 3) = Cells(lLoop + 2, 1)                  If rngDelete Is Nothing Then             Set rngDelete = Union(Cells(lLoop + 1, 1), Cells(lLoop + 2, 1))         Else             Set rngDelete = Union(rngDelete, Cells(lLoop + 1, 1), Cells(lLoop + 2, 1))         End If     Next lLoop          rngDelete.EntireRow.Delete  End Sub</code>"}, {"owner": {"reputation": 1, "user_id": 5656313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd7965bffbdfd20d4efb5c243f522333?s=128&d=identicon&r=PG&f=1", "display_name": "stkinkuwait", "link": "https://stackoverflow.com/users/5656313/stkinkuwait"}, "edited": false, "score": 0, "creation_date": 1449614225, "post_id": 34166640, "comment_id": 56082166, "body": "Thank you!  That did it exactly!  I need to learn a lot more about VBA, I have some web programming experience but VBA is just a language all its own!  It doesn&#39;t help that I see DIM and i think dimension but it seems to be something slightly different."}, {"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "edited": false, "score": 0, "creation_date": 1449689952, "post_id": 34166640, "comment_id": 56121342, "body": "dim is the variable declaration. It&#39;s javascript&#39;s var, but with a variable type added to it."}], "tags": [], "owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "is_accepted": false, "score": 0, "last_activity_date": 1449611234, "creation_date": 1449611234, "answer_id": 34166640, "question_id": 34166267, "link": "https://stackoverflow.com/questions/34166267/transpose-every-2nd-and-3rd-line/34166640#34166640", "title": "Transpose every 2nd and 3rd line", "body": "<p>Try this, then code an autofilter to remove the empty rows:</p>\n\n<pre><code>Sub SortRawData2()\nDim lLastRow As Long, lLoop As Long\n\nlLastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor lLoop = 1 To lLastRow Step 3\n    Cells(lLoop, 2) = Cells(lLoop + 1, 1)\n    Cells(lLoop, 3) = Cells(lLoop + 2, 1)\n    Cells(lLoop + 1, 1).Resize(2).ClearContents\nNext lLoop\n\nWith Range(\"A1:A\" &amp; lLastRow)\n    .AutoFilter field:=1, Criteria1:=\"=\"\n    .Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    .AutoFilter\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5656313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd7965bffbdfd20d4efb5c243f522333?s=128&d=identicon&r=PG&f=1", "display_name": "stkinkuwait", "link": "https://stackoverflow.com/users/5656313/stkinkuwait"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 482, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449611234, "creation_date": 1449609744, "question_id": 34166267, "link": "https://stackoverflow.com/questions/34166267/transpose-every-2nd-and-3rd-line", "title": "Transpose every 2nd and 3rd line", "body": "<p>I am trying to transpose every second and third row to columns B and C and then preferably delete the old rows so that I don't have two unused rows in B and C. I tried recording a macro, which worked for only the selection I made. Then I tried deleting the specific selections and replacing them with an offset range but I keep getting an error in the PasteSpecial line.</p>\n\n<pre><code>Sub SortRawData()\n'\n' SortRawData Macro\n'\n' Keyboard Shortcut: Ctrl+q\n'\n    Selection.Offset(1, 0).Resize(Selection.Rows.Count + 2, _\n        Selection.Columns.Count).Select\n    ActiveCell.Copy\n    ActiveCell.Offset(-1, 1).Select\n    ActiveCell.PasteSpecial Paste:=xlPasteValues, Transpose:=True\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlUp\nEnd Sub\n</code></pre>\n\n<p>I tried initially using Selection everywhere I have ActiveCell but neither seemed to work. I know I am missing the selection for the two rows I want to delete after I transpose the data into column B and C. What I have is a raw data dump of information that is formatted as:</p>\n\n<p>Item1 Weight1 Color1 Item2 Weight2 Color2 Item 3 Weight 3 Color 3</p>\n\n<p>I can get it to transpose one selection at a time by I can't seem to square away the automation of it.</p>\n\n<pre><code>Sub SortRawData2()\n'\n' SortRawData2 Macro\n'\n' Keyboard Shortcut: Ctrl+w\n'\n    Selection.Copy\n    Range(\"B1\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n    Rows(\"2:3\").Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlUp\nEnd Sub\n</code></pre>\n\n<p>This is the initial recorded macro and even it fails debugging at the PasteSpecial line. Any suggestions would be much appreciated!</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 5631681, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iaoBt.jpg?s=128&g=1", "display_name": "Colin Stadig", "link": "https://stackoverflow.com/users/5631681/colin-stadig"}, "edited": false, "score": 0, "creation_date": 1449611158, "post_id": 34166384, "comment_id": 56080572, "body": "Is there no way to use the union to both insert and delete the columns?"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 225, "user_id": 5631681, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iaoBt.jpg?s=128&g=1", "display_name": "Colin Stadig", "link": "https://stackoverflow.com/users/5631681/colin-stadig"}, "edited": false, "score": 0, "creation_date": 1449612145, "post_id": 34166384, "comment_id": 56081119, "body": "The Union only defines the range set to the variable. When you have then the range you can do whatever( ie. delete columns or rows). But my bigger take away is that you have to insert the columns first and then set those cells to your range using Union. Let me know if further explanation is required. Regards."}, {"owner": {"reputation": 225, "user_id": 5631681, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iaoBt.jpg?s=128&g=1", "display_name": "Colin Stadig", "link": "https://stackoverflow.com/users/5631681/colin-stadig"}, "edited": false, "score": 0, "creation_date": 1449612971, "post_id": 34166384, "comment_id": 56081576, "body": "I&#39;m sorry if I&#39;m not understanding... does this mean I should reset the union through the reverse loop I have in my code and then use the code you&#39;ve provided once I&#39;ve gone through that loop?"}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 0, "last_activity_date": 1449610221, "creation_date": 1449610221, "answer_id": 34166384, "question_id": 34166142, "link": "https://stackoverflow.com/questions/34166142/deleting-columns-that-were-inserted-with-a-union/34166384#34166384", "title": "Deleting Columns that were Inserted with a Union", "body": "<p>When you insert columns to the left of <code>myWeekendUnion</code> this set range shifts its address however many columns you added. So when you try to delete the range it is offset from your actual weekends. You should first insert the columns and then set the range of the weekends doing <code>Union</code>. Then you can simply call:</p>\n\n<pre><code>myWeekendUnion.EntireColumn.Delete\n</code></pre>\n\n<p>Cheers,</p>\n"}], "owner": {"reputation": 225, "user_id": 5631681, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iaoBt.jpg?s=128&g=1", "display_name": "Colin Stadig", "link": "https://stackoverflow.com/users/5631681/colin-stadig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581765952, "creation_date": 1449609278, "last_edit_date": 1581765952, "question_id": 34166142, "link": "https://stackoverflow.com/questions/34166142/deleting-columns-that-were-inserted-with-a-union", "title": "Deleting Columns that were Inserted with a Union", "body": "<p>I have some code where I've inserted two columns through a checkbox multiple times (if user clicks box called Include_Weekends - two columns are inserted for duration of project). If the project lasts 10 weeks, then a union is created that inserts two columns 10 times to account for all 10 weekends. </p>\n\n<p>For whatever reason I can't delete the inserted rows (when user unclicks the box) using the union and I have to resort to a loop as shown in my example. Is there a way to delete all the columns at once (in order to speed up code whereas the loop deletes each column individually instead of as a whole). Perhaps I am using poor coding practice as I'm still relatively new to VBA w/ excel so please excuse that.</p>\n\n<pre><code>Private Sub Include_Weekends_Click()\n\nDim myWeekendUnion as Range\nDim iWeekCount as Integer '# of weeks in project\nDim iFirstColumn as Integer 'First column in schedule\nDim xyz as Integer\nDim abc as Integer\niWeekCount = 5 'as an example... although this is user defined.\n\nIf ThisWorkbook.Sheets(\"Sheet1\").Include_Weekends.Value = True Then\n            Set myWeekendUnion = Union(Columns((iFirstColumn) + 5), Columns((iFirstColumn) + 6))\n\n    If iWeekCount &gt; 1 Then\n         For xyz = 2 To iWeekCount\n              Set myWeekendUnion = Union(myWeekendUnion, Columns((iFirstColumn) + (5 * xyz)), Columns((iFirstColumn) + (5 * xyz) + 1))\n         Next xyz\n    End If\n\n    myWeekendUnion.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\nElse\n    abc = iFirstColumn + (iWeekCount * 7) - 1\n    For abc= abc To (iFirstColumnGantt + 6) Step -7\n         ThisWorkbook.Sheets(\"Sheet1\").Columns(abc).Delete\n         ThisWorkbook.Sheets(\"Sheet1\").Columns(abc - 1).Delete\n    Next abc\nEnd If \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "named-ranges"], "comments": [{"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 1, "creation_date": 1449608558, "post_id": 34165919, "comment_id": 56079107, "body": "Have you considered using range or string variables in your range references?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1449608593, "post_id": 34165919, "comment_id": 56079128, "body": "You could load all the named ranges into more manegable variables. <code>Set GSBD = Range(&quot;GS_BeginData&quot;)</code>.  Then all you need to use is the variable."}, {"owner": {"reputation": 181, "user_id": 3096324, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1372d201385e3c147b9abe679c6b70c5?s=128&d=identicon&r=PG&f=1", "display_name": "FredGooch", "link": "https://stackoverflow.com/users/3096324/fredgooch"}, "edited": false, "score": 0, "creation_date": 1449608729, "post_id": 34165919, "comment_id": 56079209, "body": "You guys are fast! As I just added in the edit to the original post, I have quite a few of them and would rather not have line after line of variable declarations at the beginning of my Subs, but if there isn&#39;t another way I guess that will have to work."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1449608756, "post_id": 34165919, "comment_id": 56079222, "body": "Why don&#39;t you use a Table? You can reference parts of it almost like you would reference a table in a database."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449609475, "post_id": 34165919, "comment_id": 56079634, "body": "You could really clean it up using <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\"><code>With</code> Statements</a>. Combine that with @ScottCraner&#39;s suggestion to set <code>Range</code> variables, and you&#39;re on your way!"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1449610081, "post_id": 34166214, "comment_id": 56079979, "body": "He could even add <code>With GSBegin</code> before those first two lines, and then <code>End With</code> just before the end, no?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1449610275, "post_id": 34166214, "comment_id": 56080082, "body": "@BruceWayne yes of course, and as ChrisNielsen points out the <code>Resize</code> method is also valuable in cases like this."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1449609562, "creation_date": 1449609562, "answer_id": 34166214, "question_id": 34165919, "link": "https://stackoverflow.com/questions/34165919/simpler-cleaner-way-to-specify-ranges-when-using-lots-of-named-cells-in-vba/34166214#34166214", "title": "Simpler/cleaner way to specify ranges when using lots of named cells in VBA?", "body": "<p><em>more easily readable way</em> -- yes. Declare and assign object variables as may be required. At a minimum, you can define ranges for \"GS_BeginData\" and \"SS_Unit\" and \"SS_BeginData\" which would make your code more readable and maintainable.</p>\n\n<p>This way, if you ever change the <em>names</em> of your named range references, you only need to update a few short lines of code that assign to the initial objects, instead of every literal reference e.g., to <code>\"GS_BeginData\"</code>, etc.</p>\n\n<pre><code>Dim GSBegin as Range, SSBegin as Range, SSUnit as Range\n\nSet GSBegin = Range(\"GS_BeginData\")\nSet SSBegin = Range(\"SS_BeginData\")\nSet SSUnit = Range(\"SS_Unit\")\n</code></pre>\n\n<p>Then, your ugly references can be modified:</p>\n\n<pre><code>Range(GSBegin.Offset((counter + m), -1), GSBegin.Offset((counter + m), 2))\n\nRange(GSBegin.Offset(counter, 1), GSBegin.Offset((counter + fileCount), 1))\n\nSSUnit.Offset(0, 1)\n\nRange(SSBegin, SSBegin.End(xlDown))\n\nCells((SSBegin.Row + i), (SSBegin.Column + 1))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1716, "user_id": 2548351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e810bae4aad9cb4fd141a593d99b2c9?s=128&d=identicon&r=PG", "display_name": "caiohamamura", "link": "https://stackoverflow.com/users/2548351/caiohamamura"}, "edited": false, "score": 0, "creation_date": 1449674937, "post_id": 34166264, "comment_id": 56111413, "body": "Dim As Range will also be faster if you are calling Range() multiple times, since Range() will be get dynamically, while the variable will directly point to the Range object."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1449612596, "last_edit_date": 1449612596, "creation_date": 1449609725, "answer_id": 34166264, "question_id": 34165919, "link": "https://stackoverflow.com/questions/34165919/simpler-cleaner-way-to-specify-ranges-when-using-lots-of-named-cells-in-vba/34166264#34166264", "title": "Simpler/cleaner way to specify ranges when using lots of named cells in VBA?", "body": "<ol>\n<li>Use variables! (<code>Dim</code>'s are a small price to pay)</li>\n<li>Leverage other Range properties.  In these cases <code>Resize</code> is useful</li>\n</ol>\n\n<p>.</p>\n\n<pre><code>Dim GS_BeginData As Range\nSet GS_BeginData = Range(\"GS_BeginData\")\n'Set r = Range(Range(\"GS_BeginData\").Offset((counter + m), -1), Range(\"GS_BeginData\").Offset((counter + m), 2))\nSet r = GS_BeginData.Offset(counter + m, -1).Resize(, 3)\n\n'Set r = Range(Range(\"GS_BeginData\").Offset(counter, 1), Range(\"GS_BeginData\").Offset((counter + fileCount), 1))\nSet r = GS_BeginData.Offset(counter, 1).Resize(fileCount, 1)\n\nDim SS_Unit As Range\nSet SS_Unit = Range(\"SS_Unit\")\n'Set r = Range(\"SS_Unit\", Range(\"SS_Unit\").Offset(0, 1))\nSet r = SS_Unit.Resize(, 2)\nSet r = SS_Unit.Resize(, SS_Unit.Columns.Count + 1) ' if SS_Unit has more than 1 column\n\nDim SS_BeginData As Range\nSet SS_BeginData = Range(\"SS_BeginData\")\n'Set r = Range(\"SS_BeginData\", Range(\"SS_BeginData\").End(xlDown))\nSet r = Range(SS_BeginData, SS_BeginData.End(xlDown))\n\n'Set r = Cells((Range(\"SS_BeginData\").Row + i), (Range(\"SS_BeginData\").Column + 1))\nSet r = SS_BeginData.Offset(i, 1).Resize(1, 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "is_accepted": false, "score": -1, "last_activity_date": 1449610425, "creation_date": 1449610425, "answer_id": 34166443, "question_id": 34165919, "link": "https://stackoverflow.com/questions/34165919/simpler-cleaner-way-to-specify-ranges-when-using-lots-of-named-cells-in-vba/34166443#34166443", "title": "Simpler/cleaner way to specify ranges when using lots of named cells in VBA?", "body": "<p>I don't use named ranges because they are difficult to maintain and soon become a mess. I always use these two functions:</p>\n\n<pre><code>Function RowNumber(Header As String, _\n             Optional Sh As Worksheet, _\n             Optional FromColumn As Integer = 1, _\n             Optional IgnoreError As Boolean = False) As Integer\n  If Sh Is Nothing Then Set Sh = ActiveSheet\n\n  Dim R As Integer\n  For R = 1 To Sh.UsedRange.Row + Sh.UsedRange.Rows.Count - 1\n    If Sh.Cells(R, FromColumn) = Header Then RowNumber = R: Exit Function\n  Next R\n\n  If Not IgnoreError Then MsgBox \"Row \"\"\" &amp; Header &amp; \"\"\" not found\", vbCritical\nEnd Function\n\nFunction ColumnNumber(Header As String, _\n             Optional Sh As Worksheet, _\n             Optional FromRow As Integer = 1, _\n             Optional IgnoreError As Boolean = False) As Integer\n  If Sh Is Nothing Then Set Sh = ActiveSheet\n\n  Dim C As Integer\n  For C = 1 To Sh.UsedRange.Column + Sh.UsedRange.Columns.Count - 1\n    If Sh.Cells(FromRow, C) = Header Then ColumnNumber = C: Exit Function\n  Next C\n\n  If Not IgnoreError Then MsgBox \"Column \"\"\" &amp; Header &amp; \"\"\" not found\", vbCritical\nEnd Function\n</code></pre>\n\n<p>Then I get the value with something like:</p>\n\n<pre><code>Value = Sh.Cells(RowNumber(\"Header\", Sh), 2)\n</code></pre>\n\n<p>I sometimes use another version with <a href=\"https://en.wikipedia.org/wiki/Memoization\" rel=\"nofollow\">memoization</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 689, "user_id": 3575301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aed80b4d6936adbca4637b90da156e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jzz", "link": "https://stackoverflow.com/users/3575301/jzz"}, "edited": false, "score": 2, "creation_date": 1449617717, "post_id": 34167291, "comment_id": 56083632, "body": "Good one, DRY is very usefill skill to learn (or a motto to live by, really). One comment. Using Integer variables is not usefull. Although Integers use less memory then Long variables, the compiler converts the Integers to Longs, so no memory win after all. The compiler needs to convert, so you pay a small perfomance price. On top of that all, writing the word &#39;Integer&#39; in your code takes more time then &#39;Long&#39; ;-)."}, {"owner": {"reputation": 1716, "user_id": 2548351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e810bae4aad9cb4fd141a593d99b2c9?s=128&d=identicon&r=PG", "display_name": "caiohamamura", "link": "https://stackoverflow.com/users/2548351/caiohamamura"}, "reply_to_user": {"reputation": 689, "user_id": 3575301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aed80b4d6936adbca4637b90da156e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jzz", "link": "https://stackoverflow.com/users/3575301/jzz"}, "edited": false, "score": 0, "creation_date": 1449618400, "post_id": 34167291, "comment_id": 56083890, "body": "Good point. Didn&#39;t know about compiler converting Integer to Long. :-)"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 689, "user_id": 3575301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aed80b4d6936adbca4637b90da156e1?s=128&d=identicon&r=PG&f=1", "display_name": "Jzz", "link": "https://stackoverflow.com/users/3575301/jzz"}, "edited": false, "score": 0, "creation_date": 1449625703, "post_id": 34167291, "comment_id": 56086169, "body": "@jzz not only that, you can&#39;t access the whole sheet with in Integer"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1449625819, "post_id": 34167291, "comment_id": 56086202, "body": "How is this DRY, when all it does is repeats the offset functionality?"}, {"owner": {"reputation": 1716, "user_id": 2548351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e810bae4aad9cb4fd141a593d99b2c9?s=128&d=identicon&r=PG", "display_name": "caiohamamura", "link": "https://stackoverflow.com/users/2548351/caiohamamura"}, "edited": false, "score": 0, "creation_date": 1449672365, "post_id": 34167291, "comment_id": 56109485, "body": "This is repeating <code>Range(Range(&quot;GS_BeginData&quot;).Offset((counter + m), -1), Range(&quot;GS_BeginData&quot;).Offset((counter + m), 2))</code> and <code>Range(Range(&quot;GS_BeginData&quot;).Offset(counter, 1), Range(&quot;GS_BeginData&quot;).Offset((counter + fileCount), 1))</code>"}, {"owner": {"reputation": 1716, "user_id": 2548351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e810bae4aad9cb4fd141a593d99b2c9?s=128&d=identicon&r=PG", "display_name": "caiohamamura", "link": "https://stackoverflow.com/users/2548351/caiohamamura"}, "edited": false, "score": 0, "creation_date": 1449672593, "post_id": 34167291, "comment_id": 56109699, "body": "GSBeginOffsetRange will prevent to repeat <code>Range(Range, Range)</code> stuff which is a complicated syntax that will become difficult to maintain. GSBeginOffsetRange is certainly easier to maintain."}, {"owner": {"reputation": 1716, "user_id": 2548351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e810bae4aad9cb4fd141a593d99b2c9?s=128&d=identicon&r=PG", "display_name": "caiohamamura", "link": "https://stackoverflow.com/users/2548351/caiohamamura"}, "edited": false, "score": 0, "creation_date": 1449672939, "post_id": 34167291, "comment_id": 56109968, "body": "Also if he changes GS_BeginData name for any reason he will only have to change it once in the code. And he can reuse the function across different subroutines while Dim cannot, although I know Dim will perform better, it is not an issue if it is not in a while loop or something."}, {"owner": {"reputation": 1716, "user_id": 2548351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e810bae4aad9cb4fd141a593d99b2c9?s=128&d=identicon&r=PG", "display_name": "caiohamamura", "link": "https://stackoverflow.com/users/2548351/caiohamamura"}, "edited": false, "score": 0, "creation_date": 1449674164, "post_id": 34167291, "comment_id": 56110847, "body": "The developer should create functions to DRY up code which will best fit its needs, I don&#39;t have access to his code to do so, this is just a silly example which will satisfy the question &quot;Simpler/cleaner way to specify ranges when using lots of named cells in VBA?&quot;. Can&#39;t state it isn&#39;t simpler and cleaner."}], "tags": [], "owner": {"reputation": 1716, "user_id": 2548351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e810bae4aad9cb4fd141a593d99b2c9?s=128&d=identicon&r=PG", "display_name": "caiohamamura", "link": "https://stackoverflow.com/users/2548351/caiohamamura"}, "is_accepted": false, "score": 1, "last_activity_date": 1449672677, "last_edit_date": 1449672677, "creation_date": 1449613750, "answer_id": 34167291, "question_id": 34165919, "link": "https://stackoverflow.com/questions/34165919/simpler-cleaner-way-to-specify-ranges-when-using-lots-of-named-cells-in-vba/34167291#34167291", "title": "Simpler/cleaner way to specify ranges when using lots of named cells in VBA?", "body": "<p>If you are really using it in a number of different Subs you could also make a function to <a href=\"https://en.wikipedia.org/wiki/Don&#39;t_repeat_yourself\" rel=\"nofollow\">DRY</a> up your code, like.</p>\n\n<pre><code>Function GSBeginOffsetRange(a As Long, b As Long, c As Long, d As Long) As Range\n    Dim GSBegin As Range\n    Set GSBegin = Range(\"GS_BeginData\")\n    Set GSBeginOffsetRange = Range(GSBegin.Offset(a, b), GSBegin.Offset(c, d))\nEnd Function\n</code></pre>\n\n<p>This would make your first line example:</p>\n\n<pre><code>GSBeginOffsetRange((counter + m), -1, (counter + m), 2)\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5656611"}, "is_accepted": false, "score": 0, "last_activity_date": 1449616663, "creation_date": 1449616663, "answer_id": 34167943, "question_id": 34165919, "link": "https://stackoverflow.com/questions/34165919/simpler-cleaner-way-to-specify-ranges-when-using-lots-of-named-cells-in-vba/34167943#34167943", "title": "Simpler/cleaner way to specify ranges when using lots of named cells in VBA?", "body": "<p>Can you simply list all the Named Rnages and then loop through each item in that list?</p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/44907-list-out-named-ranges-visual-basic-applications.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/44907-list-out-named-ranges-visual-basic-applications.html</a></p>\n"}], "owner": {"reputation": 181, "user_id": 3096324, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1372d201385e3c147b9abe679c6b70c5?s=128&d=identicon&r=PG&f=1", "display_name": "FredGooch", "link": "https://stackoverflow.com/users/3096324/fredgooch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 34166214, "answer_count": 5, "score": 0, "last_activity_date": 1449672677, "creation_date": 1449608407, "last_edit_date": 1449608644, "question_id": 34165919, "link": "https://stackoverflow.com/questions/34165919/simpler-cleaner-way-to-specify-ranges-when-using-lots-of-named-cells-in-vba", "title": "Simpler/cleaner way to specify ranges when using lots of named cells in VBA?", "body": "<p>In a fairly large Excel program I'm working on, I have a lot of named cells in the spreadsheets that get filled with data in order to help keep formatting consistent if the user ever decides to move the template setup around, and to avoid hardcoding row/column numbers in the various subs. Unfortunately, this leads to lots of ugly looking range references in my code, examples below. Is there a simpler/cleaner looking, more easily readable way to write these that I am missing?</p>\n\n<pre><code>'Examples of ugly range references:\nRange(Range(\"GS_BeginData\").Offset((counter + m), -1), Range(\"GS_BeginData\").Offset((counter + m), 2))\n\nRange(Range(\"GS_BeginData\").Offset(counter, 1), Range(\"GS_BeginData\").Offset((counter + fileCount), 1))\n\nRange(\"SS_Unit\", Range(\"SS_Unit\").Offset(0, 1))\n\nRange(\"SS_BeginData\", Range(\"SS_BeginData\").End(xlDown))\n\nCells((Range(\"SS_BeginData\").Row + i), (Range(\"SS_BeginData\").Column + 1))\n</code></pre>\n\n<p>I suppose I could always set simply named variables to these various named cells and ranges at the beginning of the Subs to clean up the appearance of the code, but I have quite a bit of them and don't really want to add tons of lines of variable declarations to the beginning of all my Subs.</p>\n"}, {"tags": ["excel", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1449608038, "post_id": 34165647, "comment_id": 56078805, "body": "what you have tried to accomplish your goal? You won&#39;t find many who will <b>write your code for you</b>. Please post your efforts to create your pop-up. That said, you may want to consider just filling a range of cells on sheet with the months and then having the user double-click on the month they want and using the <code>Worksheet_BeforeDoubleClick</code> Event to fire the code."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449608367, "post_id": 34165647, "comment_id": 56078992, "body": "Hi Scott. I am not looking for anyone to write the code for me. But a tip or suggestion as to what direction would work best. I am still learning VBA and do need a little direction. I like your suggestion for the BeforeDoubleClick event as an option. I have not attempted to tackle this part yet as I am not sure how to get this part to work, so I cannot provide information about what has worked or failed so far."}], "answers": [{"tags": [], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "is_accepted": true, "score": 0, "last_activity_date": 1449673105, "creation_date": 1449673105, "answer_id": 34181963, "question_id": 34165647, "link": "https://stackoverflow.com/questions/34165647/need-to-run-a-macro-based-on-values-in-a-column/34181963#34181963", "title": "Need to run a macro based on values in a column", "body": "<p>Found a quicker way to achieve the true goal for this issue. Changed the order of the sort and hide sections. This now produces the desired results.</p>\n\n<pre><code>Sub Extract_Sort_1511_November()\n'\n'\n\n' This line renames the worksheet to \"Extract\"\nApplication.ScreenUpdating = False\n    ActiveSheet.Name = \"Extract\"\n\n' This line autofits the columns C, D, O, and P\n    Range(\"C:C,D:D,O:O,P:P\").Select\n    Range(\"P1\").Activate\n    Selection.Columns.AutoFit\n    Range(\"A2\").Select\n\n' This unhides any hidden rows\nCells.Select\n    Selection.EntireRow.Hidden = False\n    Range(\"A2\").Select\n\n' Want to alter the code below to perform a query in column B to determine\n' which months are listed from the import, then use the results in a dialog box to\n' allow the user to choose which month to view\n\nDim LR As Long\n\nWith ActiveWorkbook.Worksheets(\"Extract\").Sort\n    With .SortFields\n        .Clear\n        .Add Key:=Range(\"B2:B2000\"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n    End With\n    .SetRange Range(\"A2:Z2000\")\n    .Apply\nEnd With\n\n    For LR = Range(\"B\" &amp; Rows.Count).End(xlUp).Row To 2 Step -1\n        If Range(\"B\" &amp; LR).Value &lt;&gt; \"11\" Then\n            Rows(LR).EntireRow.Hidden = True\n        End If\n    Next LR\n\nCells.WrapText = False\nSheets(\"Extract\").Range(\"A2\").Select\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 34181963, "answer_count": 1, "score": -1, "last_activity_date": 1449673105, "creation_date": 1449607339, "last_edit_date": 1531164843, "question_id": 34165647, "link": "https://stackoverflow.com/questions/34165647/need-to-run-a-macro-based-on-values-in-a-column", "title": "Need to run a macro based on values in a column", "body": "<p>More specifically, what I need is to look up all the unique values in a column (these values are number representations of the months of the year) and use the value(s) returned to create a pop up box allowing the user to choose which macro to run. As an example, I import report data into a worksheet that contains 100 records. In column B we will see 11's and 12's representing November and December. What I am looking to do is capture those two numbers and use that to allow the user to run the code for November OR December. I have added code that I use for November as an example.</p>\n\n<pre><code>Sub Extract_Sort_1511_November()\n'\n'\n\n' This line renames the worksheet to \"Extract\"\nApplication.ScreenUpdating = False\n    ActiveSheet.Name = \"Extract\"\n\n' This line autofits the columns C, D, O, and P\n    Range(\"C:C,D:D,O:O,P:P\").Select\n    Range(\"P1\").Activate\n    Selection.Columns.AutoFit\n    Range(\"A2\").Select\n\n' This unhides any hidden rows\nCells.Select\n    Selection.EntireRow.Hidden = False\n    Range(\"A2\").Select\n\n' Want to alter the code below to perform a query in column B to determine\n' which months are listed from the import, then use the results in a dialog box to\n' allow the user to choose which month to view\n\nDim LR As Long\n\n    For LR = Range(\"B\" &amp; Rows.Count).End(xlUp).Row To 2 Step -1\n        If Range(\"B\" &amp; LR).Value &lt;&gt; \"11\" Then\n            Rows(LR).EntireRow.Hidden = True\n        End If\n    Next LR\n\nWith ActiveWorkbook.Worksheets(\"Extract\").Sort\n    With .SortFields\n        .Clear\n        .Add Key:=Range(\"B2:B2000\"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n    End With\n    .SetRange Range(\"A2:Z2000\")\n    .Apply\nEnd With\nCells.WrapText = False\nSheets(\"Extract\").Range(\"A2\").Select\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "crash", "save"], "comments": [{"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1449606801, "post_id": 34165333, "comment_id": 56078041, "body": "Disable macros in excel first on the developer tab&gt; macro security"}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1449606842, "post_id": 34165333, "comment_id": 56078064, "body": "Or try putting the file in design mode first before opening editor  on developer tab&gt; design mode"}, {"owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "edited": false, "score": 0, "creation_date": 1449606885, "post_id": 34165333, "comment_id": 56078102, "body": "Or hold shift while opening the file to force design mode - 1 of these 3 ways will always work"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449606897, "post_id": 34165333, "comment_id": 56078109, "body": "Try - <a href=\"http://www.appspro.com/Utilities/CodeCleaner.htm\" rel=\"nofollow noreferrer\">appspro.com/Utilities/CodeCleaner.htm</a>"}, {"owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1449609110, "post_id": 34165333, "comment_id": 56079430, "body": "Tried disabling macros and opening the developer tool in design mode - Excel still crashes when I try to save or open the VBA console."}, {"owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449611819, "post_id": 34165333, "comment_id": 56080933, "body": "@TimWilliams Is there a 64 bit version of that app? The page you linked to says it will only work for 32 bit version of Excel."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449612494, "post_id": 34165333, "comment_id": 56081329, "body": "Sorry - only 32-bit.  64-bit Excel still much less-common I guess, since it has issues with many of the avaliable add-ins out there."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1449612584, "post_id": 34165333, "comment_id": 56081376, "body": "If you absolutely can&#39;t open the file using excel then <i>maybe</i> you can still open it in OpenOffice ?  That&#39;s one thing to try..."}, {"owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1449612751, "post_id": 34165333, "comment_id": 56081471, "body": "I can open the file but any attempts to access VBE, modify macro names, or save the workbook cause a crash. I think it has to do with the naming of some of the macros, but I&#39;m not sure. I&#39;ll try open office"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1449647325, "post_id": 34165333, "comment_id": 56093427, "body": "What happens if you open Excel in safe mode?"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1449766430, "post_id": 34165333, "comment_id": 56159365, "body": "your WB might be corrupt. save modules to disk, create new empty WB, copy sheets to new WB manually, and then import modules..."}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1521045666, "post_id": 34165333, "comment_id": 85569178, "body": "try to save as xls 1997-2003, and not xlsm or xlsb"}], "answers": [{"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 1, "last_activity_date": 1449626596, "last_edit_date": 1495542192, "creation_date": 1449626596, "answer_id": 34169554, "question_id": 34165333, "link": "https://stackoverflow.com/questions/34165333/excel-workbook-crashing-on-save-and-visual-basic-editor-open/34169554#34169554", "title": "Excel Workbook Crashing on Save and Visual Basic editor open", "body": "<p>Remove the VBAProject.bin file from the .xlsm file:</p>\n\n<ul>\n<li>copy the .xlsm file</li>\n<li>change the extension of the copy to .zip (say Yes to the warning about changing extensions)</li>\n<li>open the ZIP file</li>\n<li>open the xl folder</li>\n<li>cut the VBAProject.bin file and paste it to somewhere outside the ZIP file</li>\n<li>rename the ZIP file back to a .xlsm extension</li>\n</ul>\n\n<p>You should now be able to open the .xlsm file in Excel but it will no longer have any macros.</p>\n\n<p>It is theoretically possible to reconstruct the macros from the VBAProject.bin file using the resources linked to in <a href=\"https://stackoverflow.com/a/17538985/2127508\">this answer</a> but this may involve considerable effort</p>\n"}], "owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3582, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1449626596, "creation_date": 1449606259, "last_edit_date": 1449609849, "question_id": 34165333, "link": "https://stackoverflow.com/questions/34165333/excel-workbook-crashing-on-save-and-visual-basic-editor-open", "title": "Excel Workbook Crashing on Save and Visual Basic editor open", "body": "<p>A specific xlsm workbook crashes when I try to save, save as, or when I open the VBA editor. I've tried disabling macros, removing auto calculations, etc. I can't actually get to the code to see if there's a bug causing the crash due to the editor itself causing crashes. </p>\n\n<p>Edit: Also forgot to mention there are links to another workbook in the file - but removing auto-updating/calculating upon save doesn't seem to help. Also, I'm able to modify the workbook, I just can't execute the macros, save, or open the VBA editor.</p>\n\n<p>Edit2: Some additional info. I tried deleting all worksheets and still have the same problems so there must be something wrong in the code. </p>\n\n<p>Looking for a solution to salvage the workbook. </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1449672850, "post_id": 34165278, "comment_id": 56109897, "body": "Your problem is that Normal.dotm is &quot;locked&quot; when Word is running. If you run this code from, say, Excel with Word not running it might work... &quot;Better way to do this&quot; depends on how your company is set up. Is there a central IT administration that manages installation, user profiles, etc.? If yes, then &quot;Group Policy&quot; would be the way to go as that should be able to back up (and restore) files in the users&#39; &quot;Roaming&quot; folders."}], "answers": [{"tags": [], "owner": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1449607070, "creation_date": 1449607070, "answer_id": 34165567, "question_id": 34165278, "link": "https://stackoverflow.com/questions/34165278/word-2013-vba-to-create-copy-of-normal-dotm/34165567#34165567", "title": "Word 2013, VBA to create copy of Normal.dotm", "body": "<p>Try this VBScript (Not VBA)</p>\n\n<pre><code>Dim sUserName\nsUserName = CreateObject(\"WScript.Network\").UserName\n\nDim BackupDir\nBackupDir = \"C:\\Users\\\" + sUserName + \"\\Desktop\\Backup for Normal - DO NOT DELETE\"\n\ndim filesys\n\nset filesys=CreateObject(\"Scripting.FileSystemObject\")\non error resume next\nfilesys.CreateFolder BackupDir\non error goto 0\nfilesys.CopyFile \"C:\\Users\\\" &amp; sUserName &amp; \"\\AppData\\Roaming\\Microsoft\\Templates\\Normal.dotm\", (BackupDir &amp; \"\\Normal.dotm\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4235872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a851f336a047d03030882e558e0c3a7?s=128&d=identicon&r=PG", "display_name": "Colonelshaw", "link": "https://stackoverflow.com/users/4235872/colonelshaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 388, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449607070, "creation_date": 1449606103, "question_id": 34165278, "link": "https://stackoverflow.com/questions/34165278/word-2013-vba-to-create-copy-of-normal-dotm", "title": "Word 2013, VBA to create copy of Normal.dotm", "body": "<p>My workplace is rolling out some large updates for Microsoft office. I'm trying to set up a VBA macro to run on everyone's computer to create a new folder with copies of Normal.dotm so that if (God forbid) something goes wrong we can restore the Normal.dotm. This is important because EVERYONE has a different ribbon layout and different macros and settings that we don't want lost. </p>\n\n<p>My problem is I have a macro that is functionally fine, however when i try it on the Normal.dotm it gives the Permission Denied error because the FileCopy funtion cant work on Normal.dotm. </p>\n\n<p>Code: </p>\n\n<pre><code>Private Sub CopyFiles_Click()\nsUserName = Environ$(\"username\")\n\nDim BackupDir As String\nBackupDir = \"C:\\Users\\\" + sUserName + \"\\Desktop\\Backup for Normal - DO NOT DELETE\"\n\nIf FileFolderExists(BackupDir) Then\nElse\n    MkDir BackupDir\nEnd If\n\nIf FileFolderExists(\"C:\\Users\\\" + sUserName + \"\\AppData\\Roaming\\Microsoft\\Templates\\Normal.dotm\") Then\n    FileCopy \"C:\\Users\\\" + sUserName + \"\\AppData\\Roaming\\Microsoft\\Templates\\Normal.dotm\", (BackupDir + \"\\Normal.dotm\")\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><em>I have a function for \"FileFolderExists\" i just didn't include it to save space (it works fine)</em></p>\n\n<p>My question is, is there any way to work around this (Been searching for a while and have come up empty handed), or is there a better way to do this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 735, "user_id": 4619569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEDZ7.jpg?s=128&g=1", "display_name": "nicolaus-hee", "link": "https://stackoverflow.com/users/4619569/nicolaus-hee"}, "edited": false, "score": 0, "creation_date": 1449624051, "post_id": 34165253, "comment_id": 56085706, "body": "I suggest you try the <code>.Placement</code> property of the object. Have a look at the accepted answer to this question: <a href=\"http://stackoverflow.com/questions/24810796/vba-chart-position-changes-when-rows-inserted\">VBA chart position changes when rows inserted</a>"}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "reply_to_user": {"reputation": 735, "user_id": 4619569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEDZ7.jpg?s=128&g=1", "display_name": "nicolaus-hee", "link": "https://stackoverflow.com/users/4619569/nicolaus-hee"}, "edited": false, "score": 0, "creation_date": 1449703722, "post_id": 34165253, "comment_id": 56128341, "body": "Thank you, it worked for me."}], "owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449605993, "creation_date": 1449605993, "last_edit_date": 1531164843, "question_id": 34165253, "link": "https://stackoverflow.com/questions/34165253/prevent-programatically-generated-chart-from-resing-with-cells-with-vba", "title": "prevent programatically generated chart from resing with cells with VBA", "body": "<p>The code below creates a chart programmatically but later when new data is imported the chart is deleted.  Is it possible to program the Chart not to resize when data on sheet is filtered? I know this can be set manually but I would like to do this with VBA.  Please let me know if this can\u2019t be done? </p>\n\n<pre><code>Set objChart = ActiveSheet.ChartObjects.Add _\n(Left:=30, Width:=775, Top:=15, Height:=345)\nobjChart.Chart.ChartType = xlXYScatterLines\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "internet-explorer-11"], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 4354730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04f0b9e3719f9cd9d365e7365452c34b?s=128&d=identicon&r=PG&f=1", "display_name": "Er.Imran Shaikh", "link": "https://stackoverflow.com/users/4354730/er-imran-shaikh"}, "is_accepted": false, "score": 1, "last_activity_date": 1523976753, "last_edit_date": 1523976753, "creation_date": 1455634807, "answer_id": 35435843, "question_id": 34164966, "link": "https://stackoverflow.com/questions/34164966/excel-vba-to-populate-i-e-causes-run-time-error-in-i-e-11-but-not-9/35435843#35435843", "title": "Excel VBA to populate I.E. causes Run-time error in I.E. 11 but not 9", "body": "<p>For the script element, <code>readyState</code> is no longer supported. Starting with Internet Explorer 11, use <code>onload</code>.</p>\n\n<p>IE 11 has different ways to access attributes:</p>\n\n<p><strong>Example: this will work for IE8 and 9</strong></p>\n\n<pre><code>Set doc = ie.document\nSet doc1 = doc.frames(2).document 'here comes the error\n</code></pre>\n\n<p><strong>and this will work for IE11</strong></p>\n\n<pre><code>Set doc = ie.document.frames\n\nSet doc1 = doc.frames(2)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5656049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4488089a0ad3fa8b18a25022ff4f897?s=128&d=identicon&r=PG&f=1", "display_name": "Jude", "link": "https://stackoverflow.com/users/5656049/jude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1142, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1523976753, "creation_date": 1449604933, "question_id": 34164966, "link": "https://stackoverflow.com/questions/34164966/excel-vba-to-populate-i-e-causes-run-time-error-in-i-e-11-but-not-9", "title": "Excel VBA to populate I.E. causes Run-time error in I.E. 11 but not 9", "body": "<p>I created a sub to populate form fields in a website with data from an Excel workbook</p>\n\n<p>The sub opens a new window in Internet Explorer, navigates to a intranet site, and populates form fields with data from an Excel workbook</p>\n\n<p>This sub works using Win7 Excel 2010 and I.E. 9</p>\n\n<p>When I use newer versions of I.E., the sub opens a new window in Internet Explorer and navigates to a intranet site, but fails to populate the form fields\nI receive the following error from VBA:</p>\n\n<p><strong><em>Run-time error \u2018-2147417848 (80010108)\u2019:</em></strong></p>\n\n<p><strong><em>Automation error</em></strong></p>\n\n<p><strong><em>The object invoked has disconnected from its clients</em></strong></p>\n\n<p>Here is my code</p>\n\n<pre><code>Sub hOpenWsAndPopulate()\nDim ie      As Object\nDim frm     As Variant\nDim element As Variant\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.navigate \"www.mywebsite.com\"\nWhile ie.readyState &lt;&gt; 4: DoEvents: Wend\n\n' try to get form by ID\nSet frm = ie.document.getElementById(\"incidentTicket_Form\")\n\n' try to get form by tag name and index.\n' Item(0) = 1st form\n' Item(1) = 2nd form\n' Item(2) = 3rd form, etc.\nIf frm Is Nothing Then Set frm = ie.document.getElementsByTagName(\"form\").Item(0)\n\nIf frm Is Nothing Then\n    MsgBox \"Form not found\"\n    ie.Quit\n    Set ie = Nothing\n    Else\n        ie.Visible = True\n        For Each element In frm.elements\n            On Error Resume Next\n            Select Case element.Name\n                ' Input Classification\n                    Case \"strClassificationName\": element.Value = Sheets(\"OUT-Class\").Range(\"Classification\")\n                ' Input Short Description\n                    Case \"txtShortDescription\": element.Value = Sheets(\"OUT-SD\").Range(\"SD_Output\")\n                ' Input Long Description\n                    Case \"txtLongDescription\": element.Value = Sheets(\"OUT-LD\").Range(\"LD_Output\")\n                ' Input CC\n                    Case \"strCCString\": element.Value = Sheets(\"OUT-CC\").Range(\"CcBa\")\n            End Select\n    Next\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I've tried numerous changes to my code (below), but nothing works</p>\n\n<pre><code>Sub zzzOpenWsAndPopulate()\n\nDim objIE As InternetExplorer\nDim htmlDoc As HTMLDocument\nDim htmlFrame As HTMLFrameElement\nDim frame As HTMLIFrame\nDim htmlElement As HTMLDTElement\nDim myDoc As Object\nDim frm     As Variant\nDim element As Variant\n\n\n' Set the variables\nSet objIE = New InternetExplorer\n\n' Make the browser visible and navigate\nWith objIE\n    .Visible = True\n    .navigate \"www.mywebsite.com\"\nEnd With\n\nhWaitForInternetToLoad objIE\n\nSet frm = objIE.document.getElementById(\"incidentTicket_Form\")\n\nIf frm Is Nothing Then Set frm = ie.document.getElementsByTagName(\"form\").Item(0)\n\nIf frm Is Nothing Then\n    MsgBox \"Form not found\"\n    ie.Quit\n    Set ie = Nothing\n    Else\n        objIE.Visible = True\n        For Each element In frm.elements\n            On Error Resume Next\n            Select Case element.Name\n                ' Input Classification\n                    Case \"strClassificationName\": element.Value = Sheets(\"OUT-Class\").Range(\"Classification\")\n                ' Input Short Description\n                    Case \"txtShortDescription\": element.Value = Sheets(\"OUT-SD\").Range(\"SD_Output\")\n                ' Input Long Description\n                    Case \"txtLongDescription\": element.Value = Sheets(\"OUT-LD\").Range(\"LD_Output\")\n                ' Input CC\n                    Case \"strCCString\": element.Value = Sheets(\"OUT-CC\").Range(\"CcBa\")\n            End Select\n    Next\nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<p>Is there something about I.E. 10, 11, etc. that is different from I.E. 9?</p>\n\n<p>Is there a way to force open an older version of I.E. (browser mode 9)</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["vba", "ms-word", "word-2010"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1449675125, "post_id": 34164783, "comment_id": 56111562, "body": "Your actual question isn&#39;t clear... Where and when is the error about document variables appearing, exactly? My best guess, based on the information, is that you have DocVariable fields in the document with no corresponding Document Variables. The Document Variables must be present, or the fields need to be removed. A Document Variables cannot be &quot;empty&quot;, but you can assign a &quot;space&quot; character (which will reflect in the document). If that&#39;s a problem, you can format the field result as &quot;hidden&quot;..."}], "owner": {"reputation": 11, "user_id": 5656080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4ddd8ba2f2d3a49f9dc38e911b84a8d?s=128&d=identicon&r=PG&f=1", "display_name": "user5656080", "link": "https://stackoverflow.com/users/5656080/user5656080"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449604297, "creation_date": 1449604297, "question_id": 34164783, "link": "https://stackoverflow.com/questions/34164783/populating-a-chart-with-contents-of-frame-only-if-option-box-is-selected", "title": "Populating a chart with contents of frame only if option box is selected?", "body": "<p>I have a user form with a \"Select all that apply\" series of boxes.</p>\n\n<p>When the user selects OptionBox A, a frame appears with pass/fail radio buttons and six text boxes which store the upper and lower ends of three different ranges.</p>\n\n<p>So: \nOption Box 1 is selected and then that runs: \nPass/fail then Range 1 X% to X%\n               Range 2 X% to X%\n               Range 3 X% to X%</p>\n\n<p>I only want to insert the answers from the three \"All that Apply\" Boxes that are toggled, have those pass/fail and range boxes to populate a table when the OptionBox is selected. When it is not selected, I would like nothing to appear, so no \"Error! No Document Variable Supplied!\" So, it would work if just OptionBox 1 is selected, it runs the code for 1, then if 1 and 3, only one and 3 skipping 2, etc. </p>\n\n<p>I'm doing all of this with Doc Variables, I don't know if that's the right way to go. The code listed below works in that it populates the doc with the entries, but it displays with \"Error! Document Variable not Supplied!\" if I don't list anything and I'm not sure how to get it to not do that. </p>\n\n<p>So this is part of the code:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nIf OptionButton11.Value = True Then oVars(\"RecoveryPass\") = _ \"Pass      language.\" Else oVars(\"RecoveryPass\") = _ \"Fail: Failure statement.\" ActiveDocument.Fields.Update Me.Repaint End If\n\nIf CheckBox2 = True Then Set oVars = ActiveDocument.Variables oVars(\"Mean1\").Value = Me.Mean1.Value ActiveDocument.Fields.Update Me.Repaint\n\nSet oVars = ActiveDocument.Variables\noVars(\"Mean2\").Value = Me.mean2.Value\nActiveDocument.Fields.Update\nMe.Repaint\n\n\nSet oVars = ActiveDocument.Variables\noVars(\"HW1\").Value = Me.HW1.Value\nActiveDocument.Fields.Update\nMe.Repaint\n\n\nSet oVars = ActiveDocument.Variables\noVars(\"HW2\").Value = Me.HW2.Value\nActiveDocument.Fields.Update\nMe.Repaint\n\nSet oVars = ActiveDocument.Variables\noVars(\"LS1\").Value = Me.LS1.Value\nActiveDocument.Fields.Update\nMe.Repaint\n\nSet oVars = ActiveDocument.Variables\noVars(\"LS2\").Value = Me.LS2.Value\nActiveDocument.Fields.Update\nMe.Repaint\n\nEnd If\n\nMe.Repaint UserForm3.hide\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>I have very little idea of what I'm doing, this is my first time working on anything like this and it's making me want to jump out the window. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1449603713, "post_id": 34164579, "comment_id": 56076139, "body": "<code>position of the last row </code> There&#39;s probably a gazillion google results for this XD"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1449603771, "post_id": 34164579, "comment_id": 56076179, "body": "like <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">here</a>."}, {"owner": {"reputation": 9, "user_id": 5656058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa595deccc82a62ba02cff2eee2d78e?s=128&d=identicon&r=PG&f=1", "display_name": "Calderon315", "link": "https://stackoverflow.com/users/5656058/calderon315"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449605930, "post_id": 34164579, "comment_id": 56077530, "body": "Thanks @ScottCraner. It&#39;s tough to know the exact phrases to search for. I did some prelim searching but couldn&#39;t find anything. That link looks promising."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5656058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa595deccc82a62ba02cff2eee2d78e?s=128&d=identicon&r=PG&f=1", "display_name": "Calderon315", "link": "https://stackoverflow.com/users/5656058/calderon315"}, "edited": false, "score": 0, "creation_date": 1449609100, "post_id": 34164933, "comment_id": 56079424, "body": "thanks @Jelly and I realize this is just a part of the answer from the other link. I need a little help understanding what&#39;s going on though. I&#39;m new to VBA and understand most but don&#39;t know it all. So &#39;LastRow&#39; from your description is counting from the bottom up? Trying to find out how to best do this. I&#39;ve tried the exact code you&#39;ve given me and it works somewhat. I have a table that is outputted and one of the headers has filtering on so when I use that as a reference it gives me really odd numbers that don&#39;t make sense. When I got to the cell above, it works fine."}, {"owner": {"reputation": 9, "user_id": 5656058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa595deccc82a62ba02cff2eee2d78e?s=128&d=identicon&r=PG&f=1", "display_name": "Calderon315", "link": "https://stackoverflow.com/users/5656058/calderon315"}, "edited": false, "score": 0, "creation_date": 1449613482, "post_id": 34164933, "comment_id": 56081797, "body": "My bad, I understand what&#39;s going on. It was by coincidence that I was counting <i>how many rows</i> were within that range and it lined up for a few instances. This makes complete sense now and gives me what I initially asked for, which was the <b>what row</b> was the last line of data."}], "tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": false, "score": 0, "last_activity_date": 1449604773, "creation_date": 1449604773, "answer_id": 34164933, "question_id": 34164579, "link": "https://stackoverflow.com/questions/34164579/similar-data-sets-need-to-iterate-through-rows-with-vba/34164933#34164933", "title": "Similar data sets, need to iterate through rows with VBA", "body": "<p>I would recommend this: </p>\n\n<pre><code>  Dim LastRow As Long\n  With Sheets(\"Sheet1\")\n   LastRow = .Range(\"E\" &amp; .Rows.Count).End(xlUp).Row\n  End With\n</code></pre>\n\n<p>But bare in mind that:</p>\n\n<ul>\n<li>this would start reading cells from the rows count of the sheet and go upwards until it bums into data filled cell only then it would return the index of that row.</li>\n<li>this would return the last cell of data based on the column E.  So if\nyou have multiple columns and you're processing data for an entire sheet, make sure to choose that one column with the most\ndata.</li>\n<li>This would yield an error if you there are merged cells in the column.</li>\n</ul>\n\n<p>You can then construct your intelligent data range.</p>\n\n<p>it would be something like:</p>\n\n<pre><code>Dim r As Range\nSet r = Range(\"A1:B\" &amp; LastRow)\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5656058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa595deccc82a62ba02cff2eee2d78e?s=128&d=identicon&r=PG&f=1", "display_name": "Calderon315", "link": "https://stackoverflow.com/users/5656058/calderon315"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "closed_date": 1449604924, "answer_count": 1, "score": 0, "last_activity_date": 1449651646, "creation_date": 1449603632, "last_edit_date": 1449651646, "question_id": 34164579, "link": "https://stackoverflow.com/questions/34164579/similar-data-sets-need-to-iterate-through-rows-with-vba", "closed_reason": "Duplicate", "title": "Similar data sets, need to iterate through rows with VBA", "body": "<p>Title may not make complete sense. But description below should aid. I have similar data sets that come from one of our test machines that are no different unless by the number of samples given to the machine changes. \nThere is a macro now that assumes 6 samples are to be measured but if more or less than 6 are done, it screws up the selection of data and then we get false numbers. </p>\n\n<p>So I would like to edit it such that the VBA script intelligently iterates through a given range of cells defined by the first cell where the header for data is contained. This ideally returns the position of the last row and then the VBA script has knowledge of where to look for the specific numbers I want. i.e. cell E12 contains the header for the data I'm concerned with, and goes until E?? has no data in that cell</p>\n\n<p>TL;DR - I need help with some code to give me the position of the last row that has data in it, starting from a certain cell. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449602384, "post_id": 34164162, "comment_id": 56075256, "body": "I guess the actual data has a last name to identify spouses? Either way, may I suggest you research some more?"}, {"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "edited": false, "score": 0, "creation_date": 1449602505, "post_id": 34164162, "comment_id": 56075325, "body": "How large are we talking for the dataset?"}, {"owner": {"reputation": 5, "user_id": 5070152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e4065e43ee623b3a99ada890b3f243?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Hagan", "link": "https://stackoverflow.com/users/5070152/kevin-hagan"}, "edited": false, "score": 0, "creation_date": 1449602605, "post_id": 34164162, "comment_id": 56075391, "body": "I&#39;m matching the fields by an unique identifier. I used first names for clarity sake. I&#39;ve tried typing in every iteration of the question I could think of in google and here in Stack Overflow, with some answers that are close, but don&#39;t quite meet the mark."}, {"owner": {"reputation": 5, "user_id": 5070152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e4065e43ee623b3a99ada890b3f243?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Hagan", "link": "https://stackoverflow.com/users/5070152/kevin-hagan"}, "edited": false, "score": 0, "creation_date": 1449602686, "post_id": 34164162, "comment_id": 56075436, "body": "Over 6000 rows in the dataset"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 3, "creation_date": 1449602750, "post_id": 34164162, "comment_id": 56075474, "body": "<code>some answers that are close, but don&#39;t quite meet the mark</code> uhh so modify the close ones to fit your needs instead of simply asking SO to code for you."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449603394, "post_id": 34164162, "comment_id": 56075926, "body": "or at least show the work you done so far to try to do what you want and where it&#39;s not working :) ...  You also might want to consider a non-vba solution using <code>Conditional Formatting</code> ... lots of useful possibilities there without having to code anything :)"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1449604950, "post_id": 34164162, "comment_id": 56076948, "body": "Read your question, how would anybody but you, know that Mike &amp; Kim are married?"}, {"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1449605388, "post_id": 34164162, "comment_id": 56077228, "body": "@Davesexcel read the comments - &quot;I&#39;m matching the fields by an unique identifier. I used first names for clarity sake.&quot;"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1449605511, "post_id": 34164162, "comment_id": 56077298, "body": "Yep, but are you able you show that in your question?"}, {"owner": {"reputation": 5, "user_id": 5070152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e4065e43ee623b3a99ada890b3f243?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Hagan", "link": "https://stackoverflow.com/users/5070152/kevin-hagan"}, "edited": false, "score": 0, "creation_date": 1449606162, "post_id": 34164162, "comment_id": 56077657, "body": "Maybe to be a little clearer, this is a military organization where spouses sometimes have different last names. We are trying to identify how well we do with respect to ensuring spouses who are both in the military are stationed in the same area. I have a location identifier and a unique number for each person. I have already used a countif function to identify at least if there is a duplicate somewhere, but trying to match the two is where I&#39;m running into a roadblock. I think I need to use a Do Loop or a For Each function to cycle through the rows."}, {"owner": {"reputation": 5, "user_id": 5070152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e4065e43ee623b3a99ada890b3f243?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Hagan", "link": "https://stackoverflow.com/users/5070152/kevin-hagan"}, "edited": false, "score": 0, "creation_date": 1449606423, "post_id": 34164162, "comment_id": 56077810, "body": "I&#39;ve also tried using that same countif function as my conditional statement using a Do Loop, but it doesn&#39;t delete the row (or even just clearing the cell contents). I was using Application.WorksheetFunction.CountIf(ActiveSheet.Range(&quot;A:A&zwnj;&#8203;&quot;), ActiveSheet.Range(&quot;I&quot; &amp; currentRow)) &gt; 0. Current row starts at 2 and then adds 1 for each iteration of the loop. The function works within excel to give me a true or false."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1449608028, "post_id": 34164162, "comment_id": 56078792, "body": "post your code that you have tried, I think you are missing the point,  you say you tried but we see nothing so it looks to us as if you just want us to do it for you."}, {"owner": {"reputation": 5, "user_id": 5070152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e4065e43ee623b3a99ada890b3f243?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Hagan", "link": "https://stackoverflow.com/users/5070152/kevin-hagan"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1449608477, "post_id": 34164162, "comment_id": 56079051, "body": "@Sorceri Got it. I&#39;m running my latest attempt now and will post once it&#39;s complete. New to the board, so I apologize for my ignorance."}, {"owner": {"reputation": 5, "user_id": 5070152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e4065e43ee623b3a99ada890b3f243?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Hagan", "link": "https://stackoverflow.com/users/5070152/kevin-hagan"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1449609280, "post_id": 34164162, "comment_id": 56079527, "body": "@Sorceri edited my response to include code. Only problem is that it ends up clearing the contents for both people instead of just the one. Found the example on the msdn site"}, {"owner": {"reputation": 5, "user_id": 5070152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e4065e43ee623b3a99ada890b3f243?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Hagan", "link": "https://stackoverflow.com/users/5070152/kevin-hagan"}, "edited": false, "score": 1, "creation_date": 1449610622, "post_id": 34164162, "comment_id": 56080277, "body": "Appreciate the helpful feedback. Figured it out with a variation of the code that I previously posted. It didn&#39;t originally work because I didn&#39;t delete the entire row (thus the &quot;Spouse&quot; column data still existed, so it saw the same data twice). By deleting the entire row, I eliminated that possibility. I&#39;m sorry for my original ignorance, and will ensure the full extent of my efforts is posted up front to avoid confusion. I have edited the code in the post for anyone&#39;s future efforts."}], "answers": [{"tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": false, "score": 0, "last_activity_date": 1449609641, "creation_date": 1449609641, "answer_id": 34166243, "question_id": 34164162, "link": "https://stackoverflow.com/questions/34164162/excel-macro-to-delete-a-row-if-cell-in-column-a-equals-cell-in-column-b/34166243#34166243", "title": "Excel Macro to delete a row if cell in Column A equals cell in Column B", "body": "<p>You should be able to change this to suit your needs. It compares columns A &amp; B to look for duplicates and if found, deletes them. It's code I previously wrote for something else but you're welcome to see if it works for you.</p>\n\n<pre><code>Sub FindDuplicates()\n\nDim i As Long, j As Long\nDim numberOfAccounts As Long, numberOfBillClasses As Long\nDim nxtRow As Long\nDim checkForRange As Range, DupeRange As Range\n\nnumberOfAccounts = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nesrd = Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\nFor i = 2 To numberOfAccounts\n    Set checkForRange = Range(\"B\" &amp; i)\n\n    For j = 1 To esrd - 1\n        Set DupeRange = Range(\"A\" &amp; j)\n\n        If StrComp(CStr(checkForRange.Value), CStr(DupeRange.Value), vbTextCompare) = 0 Then\n            checkForRange.Interior.ColorIndex = 22\n        End If\n        Set DupeRange = Nothing\n    Next j\n    Set checkForRange = Nothing\nNext i\nEnd Sub\n\n'This macro will delete the duplicates found after using the above macro.\n\nSub DeleteDuplicates()\n    Dim Lastrow As Long\n    Dim Lrow As Long\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n    End With\n\n    Lastrow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n        For Lrow = Lastrow To 2 Step -1\n                    If Cells(Lrow, \"B\").Interior.ColorIndex = 22 Then\n                        Cells(Lrow, \"B\").Delete\n                    End If\n        Next Lrow\n\n'Removes color from duplicate cells\n     Columns(\"B:B\").Select\n    With Selection.Interior\n        .Pattern = xlNone\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 5070152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e4065e43ee623b3a99ada890b3f243?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Hagan", "link": "https://stackoverflow.com/users/5070152/kevin-hagan"}, "edited": false, "score": 0, "creation_date": 1449612889, "post_id": 34166615, "comment_id": 56081540, "body": "Probably much more elegant than my method (the method I used with the Match function worked great, but took a good while to run)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1449611165, "creation_date": 1449611165, "answer_id": 34166615, "question_id": 34164162, "link": "https://stackoverflow.com/questions/34164162/excel-macro-to-delete-a-row-if-cell-in-column-a-equals-cell-in-column-b/34166615#34166615", "title": "Excel Macro to delete a row if cell in Column A equals cell in Column B", "body": "<p>You could use this formula:</p>\n\n<pre><code>=IFERROR(IF(AND(SUM(($A:$A&amp;$B:$B=A1&amp;B1)+($B:$B&amp;$A:$A=A1&amp;B1))&gt;1,ROW(INDEX($B:$B,MATCH(A1,$B:$B,0)))&lt;ROW()),\"Duplicate\",\"\"),\"\")\n</code></pre>\n\n<p>In an empty column, like column C put it in C1, confirm with Ctrl-Shift-Enter.  Then Copy down.  I t will put \"Duplicate\" in the second version of any matches it finds.</p>\n\n<p>Then sort on column C to bring \"Duplicate\" to the top and delete all those rows.</p>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449612130, "post_id": 34166742, "comment_id": 56081109, "body": "Liked yours better, deleted mine."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1449612242, "post_id": 34166742, "comment_id": 56081172, "body": "I wouldn&#39;t delete mate, SO is a great working think tank and alternative methods are always useful, it shows the steps people can take to get to the same answer and sometimes shows functions that may not have been considered before. Different or longer doesn&#39;t mean wrong, it just means different :)"}, {"owner": {"reputation": 5, "user_id": 5070152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e4065e43ee623b3a99ada890b3f243?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Hagan", "link": "https://stackoverflow.com/users/5070152/kevin-hagan"}, "edited": false, "score": 0, "creation_date": 1449612975, "post_id": 34166742, "comment_id": 56081578, "body": "I used a COUNTIF to find the duplicates, but couldn&#39;t figure out how to only mark the second occurrence as a duplicate. Thanks!"}, {"owner": {"reputation": 5, "user_id": 5070152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e4065e43ee623b3a99ada890b3f243?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Hagan", "link": "https://stackoverflow.com/users/5070152/kevin-hagan"}, "edited": false, "score": 0, "creation_date": 1449613573, "post_id": 34166742, "comment_id": 56081842, "body": "Another great aspect to this is the ability to keep all of the original data and just using a filter. This is perfect."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 1, "last_activity_date": 1449611629, "creation_date": 1449611629, "answer_id": 34166742, "question_id": 34164162, "link": "https://stackoverflow.com/questions/34164162/excel-macro-to-delete-a-row-if-cell-in-column-a-equals-cell-in-column-b/34166742#34166742", "title": "Excel Macro to delete a row if cell in Column A equals cell in Column B", "body": "<p>Put this formula in C1 (Assuming your data starts in A1 and B1) <code>=COUNTIFS(A$1:A1,B1,B$1:B1,A1)</code></p>\n\n<p>Drag down</p>\n\n<p>Filter data to remove none 0</p>\n\n<p>It works using an expanding range, counting the occurrence of the flip. An expanding range is used to stop it from counting the original ie the one you want to keep.</p>\n\n<p>Here is my sample data and results:</p>\n\n<pre><code>Kim     Mike    0\nBob     Mary    0\nJim     Susan   0\nMary    Bob     1\nDave    Angela  0\nMike    Kim     1\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5070152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33e4065e43ee623b3a99ada890b3f243?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Hagan", "link": "https://stackoverflow.com/users/5070152/kevin-hagan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1354, "favorite_count": 0, "accepted_answer_id": 34166742, "answer_count": 3, "score": -3, "last_activity_date": 1449611629, "creation_date": 1449602241, "last_edit_date": 1449610308, "question_id": 34164162, "link": "https://stackoverflow.com/questions/34164162/excel-macro-to-delete-a-row-if-cell-in-column-a-equals-cell-in-column-b", "title": "Excel Macro to delete a row if cell in Column A equals cell in Column B", "body": "<p>Need some help here. Nothing that I've searched for seems to fit my situation. I have a large data set where Column A and Column B have some duplicates. To clarify, it is a personnel data set with Column A being employees and column B being spouses of those employees. However, some employees are married to each other, so I would like to delete the second instance on the list where both employees are married to each other. A sample of my data is this:  </p>\n\n<pre><code>Column A  \nKim  \nDave  \nJim  \nMary  \nMike  \n</code></pre>\n\n<hr>\n\n<pre><code>Column B  \nMike  \nAngela  \nSusan  \nBob  \nKim\n</code></pre>\n\n<p>In this case, Mike is married to Kim, which is depicted in both rows 1 and 5. I want to delete row 5. It is a rather large dataset, so doing it manually would take hours with a probability of human error. Thanks!\\</p>\n\n<p>Edited to include my code:</p>\n\n<pre><code>Sub DeleteDuplicates()\n\nApplication.ScreenUpdating = False\n\n'Declare variables\nDim var As Variant, iSheet As Integer, iRow As Long, iRowL As Long, bln As Boolean\n\n   'Set up the count as the number of filled rows in the first column of Sheet1.\n   iRowL = Cells(Rows.Count, 1).End(xlUp).Row\n\n   'Cycle through all the cells in that column:\n   For iRow = 2 To iRowL\n      'For every cell that is not empty, search through the first column in each worksheet in the\n      'workbook for a value that matches that cell value.\n\n      If Not IsEmpty(Cells(iRow, 2)) Then\n         For iSheet = ActiveSheet.Index + 1 To Worksheets.Count\n            bln = False\n            var = Application.Match(Cells(iRow, 2).Value, ActiveSheet.Columns(9), 0)\n\n            'If you find a matching value, clear the cell contents and exit the loop;\n            'otherwise, continue searching until you reach the end of the workbook.\n            If Not IsError(var) Then\n               bln = True\n               Exit For\n            End If\n         Next iSheet\n      End If\n\n      'If you do not find a matching value, do nothing, if you do find a matching value, clear the contents of the cell\n      If bln = True Then\n         ActiveSheet.Rows(iRow).EntireRow.Delete\n      End If\n   Next iRow\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449601620, "post_id": 34163977, "comment_id": 56074780, "body": "Batman slacking on job not patrolling Gotham. Downvoted and flagged."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1449601779, "post_id": 34163977, "comment_id": 56074892, "body": "You could use a range instead and loop through those columns, and the input box would require a range which you can do with application.inputbox"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1449601805, "post_id": 34163977, "comment_id": 56074912, "body": "@findwindow - how do you know this isn&#39;t a dummy user to fool those who think I&#39;m not out and about?? ...and anyways, I&#39;m not this bat character!"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 6, "creation_date": 1449601806, "post_id": 34163977, "comment_id": 56074914, "body": "<code>allow for unlimited values to be passed through</code> <a href=\"http://www.tushar-mehta.com/publish_train/xl_vba_cases/1005%20ParamArray.shtml\" rel=\"nofollow noreferrer\">paramarray</a> perhaps?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449601893, "post_id": 34163977, "comment_id": 56074960, "body": "@findwindow - Ooh, that looks promising, I&#39;ll check it out."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1449602007, "post_id": 34163977, "comment_id": 56075024, "body": "Ugh can&#39;t find Tim&#39;s exact handle but I got that from him. Edit: @TimWilliams ^_^ Thanks Scott."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1449602135, "post_id": 34163977, "comment_id": 56075116, "body": "@findwindow  - Tim Williams is who you are looking for :)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1449603299, "post_id": 34163977, "comment_id": 56075853, "body": "Please. Credit should goto Tim ^_^ Edit: I like how we all know which Tim I meant^^"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1449603319, "post_id": 34163977, "comment_id": 56075870, "body": "That page is deceptively dense - but man, am I glad I asked about this, that looks like a great tool/method. Thanks again @TimWilliams and Findwindow!"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1449603412, "post_id": 34163977, "comment_id": 56075936, "body": "Sure. Glad to serve as ambassador for Tim&#39;s great wisdom ^_^;"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1449604070, "post_id": 34163977, "comment_id": 56076394, "body": "yeah, looks like findwindow and @TimWIlliams found something there. I need to keep that in my bag o tricks. Never saw it before"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1449604836, "post_id": 34163977, "comment_id": 56076880, "body": "You could also just pass a delimited string and <code>Split</code> it as you do with the <code>Inputbox</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1449605600, "post_id": 34163977, "comment_id": 56077342, "body": "@Rory - Bam! That&#39;s a quick and easy fix for sure, excellent! I don&#39;t know how I didn&#39;t realize that when I was asking this question...as you noted, I use that very method in the sub :P"}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1449605658, "creation_date": 1449601575, "last_edit_date": 1531164843, "question_id": 34163977, "link": "https://stackoverflow.com/questions/34163977/vba-udf-how-to-have-unlimited-byval-parameters", "title": "VBA UDF - how to have &quot;unlimited&quot; ByVal parameters?", "body": "<p>I have a custom Sub. that removes numbers from a column.  It's pretty straightforward, it asks the user (via inputbox) for columns to remove numbers from.  The user can enter \"B C D E F\" and it'll loop through the columns B,C,D,E,F and remove numbers.</p>\n\n<p>However, I'd like to call this sub from another sub, but without using the inputbox.  I'd prefer to pass my columns into the sub, i.e.</p>\n\n<p><code>Call removeNumbers(B,C,D,E,F)</code></p>\n\n<p>and it'd run my removeNumbers macro, using those columns.</p>\n\n<p>How would I set up my <code>removeNumbers</code> sub to allow for unlimited values to be passed through (sorry if that's not the terminology!).  Since I could have also just done column B.  Or B,C,D,E,F,G,H,I,...,ZZ.</p>\n\n<p>I was thinking something like:</p>\n\n<p><code>Sub removeNumbers(Optional ByVal x as String, optional ByVal y as String, optional ByVal z as String)</code></p>\n\n<p>But that only leaves room for three \"passing variables\".  How can I create an open-ended one? Something like <code>Sub removeNumbers(optional ByVal cols() as Array)</code>?</p>\n\n<p>Please let me know if I can clarify anything!</p>\n\n<p>For what it's worth, here's my <code>removeNumbers</code> sub:</p>\n\n<pre><code>Sub removeNumbers()\nDim ChosenColumn As String\nDim LastRowCol As String, i As Integer, cel, columnArray() As String\n\nChosenColumn = InputBox(\"What columns (A,B,C, etc.) would you like to remove numbers from?  Use SPACES, to separate columns\")\ncolumnArray() = Split(ChosenColumn)\n\nLastRowCol = InputBox(\"What column do you want to use to determine the last cell?\")\n\nApplication.ScreenUpdating = False\n\nWith ActiveSheet\n    lastRow = .Cells(.Rows.Count, LastRowCol).End(xlUp).row\nEnd With\n\nDim startCell As Range\n\nFor i = LBound(columnArray) To UBound(columnArray)\n    Debug.Print \"Now going through column \" &amp; columnArray(i)\n    Column2Copy = columnArray(i)\n    For Each cel In Range(Cells(1, columnArray(i)), Cells(lastRow, columnArray(i)))\n        If IsNumeric(cel.Value) And Not IsEmpty(cel.Value) Then\n            cel.Value = \"\"\n        End If\n    Next\n\nNext i\n\nApplication.ScreenUpdating = True\n\nDim runAgain\nrunAgain = MsgBox(\"Run again?\", vbYesNo)\nIf runAgain = vbYes Then\n    Call removeNumbers\nElse\n\n    MsgBox (\"Done!\")\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Edit3: For the solution, @Findwindow's link is a great resource for learning how to do this more programatically.  @Rory's answer is a short and sweet solution, so both work. Thanks everyone!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449600593, "post_id": 34163655, "comment_id": 56074145, "body": "When you open the file to dump the data, just do a quick <code>filename=book.name</code> then drop <code>filename</code> into column A. Declare <code>filename</code> as type string."}, {"owner": {"reputation": 35, "user_id": 1657555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d199f89e94fed35b021591f2ee4e1084?s=128&d=identicon&r=PG", "display_name": "user1657555", "link": "https://stackoverflow.com/users/1657555/user1657555"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449602472, "post_id": 34163655, "comment_id": 56075303, "body": "I&#39;ve gotten to that point. The problem I&#39;m having is that the file name should only apply to the data that was pasted from the workbook that is being imported at that moment."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449602669, "post_id": 34163655, "comment_id": 56075427, "body": "Huh. So you&#39;re not doing this via a loop?"}, {"owner": {"reputation": 35, "user_id": 1657555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d199f89e94fed35b021591f2ee4e1084?s=128&d=identicon&r=PG", "display_name": "user1657555", "link": "https://stackoverflow.com/users/1657555/user1657555"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449602908, "post_id": 34163655, "comment_id": 56075577, "body": "I am using a loop to read each files contents and add them to the main workbook, but I need each filename to only apply to column A for each workbooks data when it is imported.   Please see new image uploaded into main post."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449603031, "post_id": 34163655, "comment_id": 56075662, "body": "Uhhh then my idea works. It would help to see code for your loop because you must be doing something funny XD"}, {"owner": {"reputation": 35, "user_id": 1657555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d199f89e94fed35b021591f2ee4e1084?s=128&d=identicon&r=PG", "display_name": "user1657555", "link": "https://stackoverflow.com/users/1657555/user1657555"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449603760, "post_id": 34163655, "comment_id": 56076174, "body": "Please see uploaded code."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449603945, "post_id": 34163655, "comment_id": 56076298, "body": "So do <code>filename=booklist.name</code> Guess you have trouble determining how many rows eh? So create a new variable that finds lastrow then use it in place of <code>Range(&quot;A65536&quot;).End(xlUp).Row</code> as well as when you paste."}, {"owner": {"reputation": 35, "user_id": 1657555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d199f89e94fed35b021591f2ee4e1084?s=128&d=identicon&r=PG", "display_name": "user1657555", "link": "https://stackoverflow.com/users/1657555/user1657555"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449604410, "post_id": 34163655, "comment_id": 56076626, "body": "How do you find the lastrow?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1449604581, "post_id": 34163655, "comment_id": 56076725, "body": "Sigh. You don&#39;t understand your code at all do you XD Edit: I have essentially given you a guide leaving out some details for you to discover. Please study your code. I will upvote since you have shown effort and appears you will continue to do so but I am not the type to spoon feed XD"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4274709, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jHOOAbxtbQU/AAAAAAAAAAI/AAAAAAAAAC0/Hvi2pj2Bc88/photo.jpg?sz=128", "display_name": "Serious_Mailbox", "link": "https://stackoverflow.com/users/4274709/serious-mailbox"}, "is_accepted": false, "score": 0, "last_activity_date": 1449600969, "creation_date": 1449600969, "answer_id": 34163782, "question_id": 34163655, "link": "https://stackoverflow.com/questions/34163655/appending-file-name-of-combined-excel-file-data-into-master-sheet/34163782#34163782", "title": "Appending file name of combined excel file data into master sheet", "body": "<p>If you are just looking for the file name you can use .Name property of the workbook object, but it does give you the file extension as well though. If you want the full file path you can use the .Path property of the workbook object. Once you do one of those you can just assign the value to the cell as you get them or store them all up in an array and output them to the column in one go.</p>\n"}], "owner": {"reputation": 35, "user_id": 1657555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d199f89e94fed35b021591f2ee4e1084?s=128&d=identicon&r=PG", "display_name": "user1657555", "link": "https://stackoverflow.com/users/1657555/user1657555"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1007, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449603750, "creation_date": 1449600482, "last_edit_date": 1449603750, "question_id": 34163655, "link": "https://stackoverflow.com/questions/34163655/appending-file-name-of-combined-excel-file-data-into-master-sheet", "title": "Appending file name of combined excel file data into master sheet", "body": "<p>I have an excel file that uses VBA to take all excel files in a directory (all files have the same structure/headings) and combines them all into the new excel file starting in column B. </p>\n\n<p><a href=\"https://i.stack.imgur.com/lwWwd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lwWwd.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I can't figure out is how to take the file name of each file as it is opened and place that name in column A for every row that just had data appended to it. Please help.</p>\n\n<pre><code>Dim bookList As Workbook\nDim path As String\nDim mergeObj As Object, dirObj As Object, filesObj As Object, everyObj As Object\nDim rowCount As String\nDim myRange As String\nApplication.ScreenUpdating = False\nSet mergeObj = CreateObject(\"Scripting.FileSystemObject\")\n\n'change folder path of excel files here\npath = InputBox(\"Enter the path to the folder containing the excel files you want to combine.\", \"Excel Combiner\")\nSet dirObj = mergeObj.Getfolder(path)\nSet filesObj = dirObj.Files\nFor Each everyObj In filesObj\nSet bookList = Workbooks.Open(everyObj)\n\n'Grab filename from each open file\nDim MyName As String\nMyName = everyObj.Name\n\n\n'change \"A2\" with cell reference of start point for every files here\n'for example \"B3:IV\" to merge all files start from columns B and rows 3\n'If you're files using more than IV column, change it to the latest column\n'Also change \"A\" column on \"A65536\" to the same column as start point\nRange(\"A2:IV\" &amp; Range(\"A65536\").End(xlUp).Row).Copy\nThisWorkbook.Worksheets(2).Activate\n\n'Do not change the following column. It's not the same column as above\nRange(\"A65536\").End(xlUp).Offset(1, 1).PasteSpecial\nApplication.CutCopyMode = False\n\n'Paste scan name into Column A\nNEED SOMETHING HERE\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1449599231, "post_id": 34163245, "comment_id": 56073249, "body": "Use a <code>while(...) { ... }</code> loop?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1449599645, "post_id": 34163245, "comment_id": 56073543, "body": "FYI I&#39;m pretty sure you can combine all these lines into one line: <code>SheetObject.Range(Columns(1),Columns(15)).NumberFormat = &quot;@&quot;</code>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1449600145, "post_id": 34163245, "comment_id": 56073867, "body": "@Draco18s - <code>Do While(...) Loop</code> will work if the lines are always in order, meaning first 2 (or 3 or 4 or n) lines are always <code>H</code>, next x lines are always <code>D</code> and following lines are <code>T</code> ... If not, OP will have to get the line counts of each letter first, and use that to set the <code>CountHeader, CountDetail, CountTrailer</code> variables."}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1449600362, "post_id": 34163245, "comment_id": 56073999, "body": "Ahh, yes, that would be a problem.  He&#39;s going to need some kind of delimiter that tells the program that it needs to change from one case to another."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1449601256, "post_id": 34163245, "comment_id": 56074551, "body": "@BruceWayne and OP - Headers can also be set like this for example, to shorten code: <code>SheetObject(Range(Cells(27,1),Cells(27,6)).Value = Array(&quot;Record Type&quot;,&quot;Sequence No&quot;,&quot;Contract No&quot;,&quot;Total Record&quot;,&quot;Total AMount&quot;,&quot;Filler&quot;)</code>"}, {"owner": {"reputation": 47, "user_id": 3143305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65f34d05bb27824efa0969765b5d555?s=128&d=identicon&r=PG&f=1", "display_name": "user3143305", "link": "https://stackoverflow.com/users/3143305/user3143305"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1449601659, "post_id": 34163245, "comment_id": 56074800, "body": "@BruceWayne This can be used to simplified my codes but still if change to this format I still need to know the number of rows and key-in the position for the header."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449601973, "post_id": 34163245, "comment_id": 56075003, "body": "@user3143305 - Are the Headers always in order ... like I asked above? ... Like are the first &#39;n&#39; lines always the header, the next &#39;x&#39; lines always detail, and the rest of the lines always trailers? Or could the <code>h</code>, <code>d</code> or <code>t</code> lines be in a any order?"}, {"owner": {"reputation": 47, "user_id": 3143305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65f34d05bb27824efa0969765b5d555?s=128&d=identicon&r=PG&f=1", "display_name": "user3143305", "link": "https://stackoverflow.com/users/3143305/user3143305"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449602613, "post_id": 34163245, "comment_id": 56075397, "body": "@ScottHoltzman the 1st line will be for sure the header for h. I might have cases where number of rows for &#39;h&#39; body increase by any number.In that cases, the header for &#39;d&#39; will also be change.same goes with the &#39;t&#39;. The header depends on the number of data.I update the question with sample of raw data that I received."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449602908, "post_id": 34163245, "comment_id": 56075576, "body": "@user3143305 - okay, I understand that the line counts can change, but is the pattern always the same ...  All <code>H</code> lines come first, then all <code>D</code> lines, all <code>T</code> lines? Or could they come out of order ... like line 1 = h, line 2 = H, line 3 = H, line 4 = D, line 5  = D, line 6 = T, line 7 = T, line 8 = D, line 9 = H, line 10 = T, line 11 = D? This is important to figure out how to structure your code the best way. <i>(Your picture is hard to understand because there are 2 columns)</i>"}, {"owner": {"reputation": 47, "user_id": 3143305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65f34d05bb27824efa0969765b5d555?s=128&d=identicon&r=PG&f=1", "display_name": "user3143305", "link": "https://stackoverflow.com/users/3143305/user3143305"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449603441, "post_id": 34163245, "comment_id": 56075956, "body": "Opss sorry @ScottHoltzman the pattern will always be h, d and t.. My picture is the raw data for every data.all data can be extract based on their position. Thats why i break it using mid function. Example: mid(Line, 2, 9) meaning 2 is the starting position and 9 is the length."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 3143305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65f34d05bb27824efa0969765b5d555?s=128&d=identicon&r=PG&f=1", "display_name": "user3143305", "link": "https://stackoverflow.com/users/3143305/user3143305"}, "edited": false, "score": 0, "creation_date": 1449608938, "post_id": 34165551, "comment_id": 56079337, "body": "you are super genius, I didnt even think about it.How to become the same level as you man?LOL..Thanks a lot man..Really Appreciate it. :)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 47, "user_id": 3143305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65f34d05bb27824efa0969765b5d555?s=128&d=identicon&r=PG&f=1", "display_name": "user3143305", "link": "https://stackoverflow.com/users/3143305/user3143305"}, "edited": false, "score": 0, "creation_date": 1449625182, "post_id": 34165551, "comment_id": 56086017, "body": "@user3143305 - Sometimes its hard to think of solutions when you are so close to the problem. It helps to have a 2nd pair of eyes :)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1449606990, "creation_date": 1449606990, "answer_id": 34165551, "question_id": 34163245, "link": "https://stackoverflow.com/questions/34163245/convert-undefined-rows-of-data-from-text-file-to-excel-using-vbscript/34165551#34165551", "title": "Convert undefined rows of data from text file to excel using vbscript", "body": "<p>Since your data always comes in the same pattern of all <code>H</code> lines coming first, then <code>D</code> lines, then <code>T</code> lines, you can just use one variable to count the rows and then check the first time a <code>D</code> or <code>T</code> row comes to add the headers. I made a <code>pseudo-Boolean</code> variable to determine when to add headers for <code>D</code> and <code>T</code>. <code>H</code> headers are constant at row 1.</p>\n\n<p><strong>Fully Tested Code:</strong></p>\n\n<pre><code>Dim objFSO\nDim TextFile\nDim TextRead\nDim Line, Line1, Line2, Line3\nDim Count\n\n'Open the spreadsheet using the excel application object\nExcelFilePath = \"C:\\Users\\MOHDSABRY\\Desktop\\Converter\\taskCon\\Output.xlsx\"\n\nSet objExcel = CreateObject(\"Excel.Application\")'Creating excel object\nobjExcel.visible = true\nSet objWB = objExcel.Workbooks.Open(ExcelFilePath) 'Creating workbook object \nSet SheetObject = objWB.Worksheets(\"Sheet1\") 'worksheets are a member of workbooks, not the Excel Application (Creating sheet object)\n\n'open the text file\nConst ForReading = 1 'Constant declared so that can be used throughout the script\n\n'Name of the text file that need to be convert\nTextFile = \"C:\\Users\\MOHDSABRY\\Desktop\\Converter\\taskCon\\HRILOANDIC20170601.txt\"\n\n'Create File system object\nset objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n'set the text file to read and open it in read-only mode\nset TextRead = objFSO.OpenTextFile(TextFile,ForReading)\n\nrow = 2 'start with row to set cell values\n\nWith SheetObject\n\n    'format column as text\n    .Range(.Columns(1),.Columns(15)).NumberFormat = \"@\"\n\n    'set `H` headers since its always row 1\n    .Cells(1, 1).Value = \"Record Type\"\n    .Cells(1, 2).Value = \"Sequence No\"\n    .Cells(1, 3).Value = \"Contract No\"\n    .Cells(1, 4).Value = \"Creation By\"\n    .Cells(1, 5).Value = \"Transaction Date\"\n    .Cells(1, 6).Value = \"Total Record\"\n    .Cells(1, 7).Value = \"Total Amount\"\n    .Cells(1, 8).Value = \"Source\"\n    .Cells(1, 9).Value = \"Filler\"\n\n    Do Until TextRead.AtEndOfStream\n\n        Line = TextRead.ReadLine\n\n        If Left(Line,1) = \"H\" Then\n\n            .Cells(row, 1).Value = Mid(Line, 1, 1)\n            .Cells(row, 2).Value = Mid(Line, 2, 9)\n            .Cells(row, 3).Value = Mid(Line, 11, 19) \n            .Cells(row, 4).Value = Mid(Line, 30, 1)\n            .Cells(row, 5).Value = Mid(Line, 31, 8)\n            .Cells(row, 6).Value = Mid(Line, 39, 9)\n            .Cells(row, 7).Value = Mid(Line, 48, 17) \n            .Cells(row, 8).Value = Mid(Line, 65, 2)\n            .Cells(row, 9).Value = Mid(Line, 67, 334)\n\n            row = row +1\n\n        ElseIf Left(Line,1) = \"D\" Then\n\n            Dim bD 'as Boolean \n\n            If Not bD Then 'means its the first D row so set headers\n\n                'now set 'D' headers because 'h' is finished\n                .Cells(row, 1).Value = \"Record Type\"\n                .Cells(row, 2).Value = \"Sequence No\"\n                .Cells(row, 3).Value = \"Contract No\"\n                .Cells(row, 4).Value = \"Payment Type\"\n                .Cells(row, 5).Value = \"Settlement Type\"\n                .Cells(row, 6).Value = \"Effective Date\"\n                .Cells(row, 7).Value = \"Credit Account No.\"\n                .Cells(row, 8).Value = \"Cr. Transaction Amount\"\n                .Cells(row, 9).Value = \"Loan Type\"\n                .Cells(row, 10).Value = \"Bank Employee ID\"\n                .Cells(row, 11).Value = \"ID Number\"\n                .Cells(row, 12).Value = \"ID Type Code\"\n                .Cells(row, 13).Value = \"Bank Employee Name\"\n                .Cells(row, 14).Value = \"HRIS Process Status\"\n                .Cells(row, 15).Value = \"Total Record\"\n                .Cells(row, 16).Value = \"CIF Number\"\n                .Cells(row, 17).Value = \"Account Branch\"\n\n                'add 1 row to paste data again\n                row = row + 1\n\n                'set variable so code knows headers have been set\n                bD = True\n\n            End If\n\n            .Cells(row, 1).Value = Mid(Line, 1, 1) 'HeaderRecordType to column A\n            .Cells(row, 2).Value = Mid(Line, 2, 9) 'ValueHeaderSequenceNo to column b\n            .Cells(row, 3).Value = Mid(Line, 11, 19) 'HeaderContractNo to column C\n            .Cells(row, 4).Value = Mid(Line, 30, 10) \n            .Cells(row, 5).Value = Mid(Line, 40, 1)\n            .Cells(row, 6).Value = Mid(Line, 41, 8)      \n            .Cells(row, 7).Value = Mid(Line, 49, 19) \n            .Cells(row, 8).Value = Mid(Line, 68, 1)\n            .Cells(row, 9).Value = Mid(Line, 69, 17) \n            .Cells(row, 10).Value = Mid(Line, 86, 10) \n            .Cells(row, 11).Value = Mid(Line, 96, 40) \n            .Cells(row, 12).Value = Mid(Line, 136, 40) \n            .Cells(row, 13).Value = Mid(Line, 176, 3)\n            .Cells(row, 14).Value = Mid(Line, 179, 200) \n            .Cells(row, 15).Value = Mid(Line, 379, 1)\n            .Cells(row, 16).Value = Mid(Line, 380, 19)\n            .Cells(row, 17).Value = Mid(Line, 399, 5)\n\n            row = row  + 1 \n\n        ElseIf Left(Line,1) = \"T\" Then\n\n            Dim bT 'as Boolean \n\n            If Not bT Then 'means its the first T row so set headers\n\n                'now set 'T' headers because 'D' is finished\n                .Cells(row, 1).Value = \"Record Type\"\n                .Cells(row, 2).Value = \"Sequence No\"\n                .Cells(row, 3).Value = \"Contract No\"\n                .Cells(row, 4).Value = \"Total Record\"\n                .Cells(row, 5).Value = \"Total Amount\"\n                .Cells(row, 6).Value = \"Filler\"\n\n                'add 1 row to paste data again\n                row = row + 1\n\n                'set variable so code knows headers have been set\n                bT = True\n\n            End If\n\n            .Cells(row, 1).Value = Mid(Line, 1, 1)\n            .Cells(row, 2).Value = Mid(Line, 2, 9)\n            .Cells(row, 3).Value = Mid(Line, 30, 9)\n            .Cells(row, 4).Value = Mid(Line, 39, 17) \n            .Cells(row, 5).Value = Mid(Line, 65, 2)\n            .Cells(row, 6).Value = Mid(Line, 56, 354)\n\n            row = row + 1\n\n        Else\n            'catch errors \n\n        End If\n\n     'to move down the Excel row to paste for each line in the text fix\n    Loop\n\nEnd With\n\n'Save and quit\nobjWB.Save\nobjWB.Close\nobjExcel.Quit\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 3143305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65f34d05bb27824efa0969765b5d555?s=128&d=identicon&r=PG&f=1", "display_name": "user3143305", "link": "https://stackoverflow.com/users/3143305/user3143305"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "accepted_answer_id": 34165551, "answer_count": 1, "score": 1, "last_activity_date": 1449606990, "creation_date": 1449599155, "last_edit_date": 1449602525, "question_id": 34163245, "link": "https://stackoverflow.com/questions/34163245/convert-undefined-rows-of-data-from-text-file-to-excel-using-vbscript", "title": "Convert undefined rows of data from text file to excel using vbscript", "body": "<p>I created this code so far and this is only for defined number of rows because we set counter for every header column.What happen if new batch of file coming with new number of rows ? How to start create this code?</p>\n\n<pre><code>Dim objFSO\nDim TextFile\nDim TextRead\nDim Line, Line1, Line2, Line3\nDim Count\n\n'Open the spreadsheet using the excel application object\nExcelFilePath = \"C:\\Users\\MOHDSABRY\\Desktop\\Converter\\taskCon\\Output.xlsx\"\n\nSet objExcel = CreateObject(\"Excel.Application\")'Creating excel object\nSet objWB = objExcel.Workbooks.Open(ExcelFilePath) 'Creating workbook object \nSet SheetObject = objWB.Worksheets(\"Sheet1\") 'worksheets are a member of workbooks, not the Excel Application (Creating sheet object)\n\n'open the text file\nConst ForReading = 1 'Constant declared so that can be used throughout the script\n\n'Name of the text file that need to be convert\nTextFile = \"C:\\Users\\MOHDSABRY\\Desktop\\Converter\\taskCon\\HRILOANDIC20170601.txt\"\n\n'Create File system object\nset objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n'set the text file to read and open it in read-only mode\nset TextRead = objFSO.OpenTextFile(TextFile,ForReading)\n\nCountHeader = 2 'to set row number for Excel paste\nCountDetail = 4\nCountTrailer = 28\n\nSheetObject.Columns(1).NumberFormat = \"@\"\nSheetObject.Columns(2).NumberFormat = \"@\"\nSheetObject.Columns(3).NumberFormat = \"@\"\nSheetObject.Columns(4).NumberFormat = \"@\"\nSheetObject.Columns(5).NumberFormat = \"@\"\nSheetObject.Columns(6).NumberFormat = \"@\"\nSheetObject.Columns(7).NumberFormat = \"@\"\nSheetObject.Columns(8).NumberFormat = \"@\"\nSheetObject.Columns(9).NumberFormat = \"@\"\nSheetObject.Columns(10).NumberFormat = \"@\"\nSheetObject.Columns(11).NumberFormat = \"@\"\nSheetObject.Columns(12).NumberFormat = \"@\"\nSheetObject.Columns(13).NumberFormat = \"@\"\nSheetObject.Columns(14).NumberFormat = \"@\"\nSheetObject.Columns(15).NumberFormat = \"@\"\n\nSheetObject.Cells(1, 1).Value = \"Record Type\"\nSheetObject.Cells(1, 2).Value = \"Sequence No\"\nSheetObject.Cells(1, 3).Value = \"Contract No\"\nSheetObject.Cells(1, 4).Value = \"Creation By\"\nSheetObject.Cells(1, 5).Value = \"Transaction Date\"\nSheetObject.Cells(1, 6).Value = \"Total Record\"\nSheetObject.Cells(1, 7).Value = \"Total Amount\"\nSheetObject.Cells(1, 8).Value = \"Source\"\nSheetObject.Cells(1, 9).Value = \"Filler\"\n\nSheetObject.Cells(3, 1).Value = \"Record Type\"\nSheetObject.Cells(3, 2).Value = \"Sequence No\"\nSheetObject.Cells(3, 3).Value = \"Contract No\"\nSheetObject.Cells(3, 4).Value = \"Payment Type\"\nSheetObject.Cells(3, 5).Value = \"Settlement Type\"\nSheetObject.Cells(3, 6).Value = \"Effective Date\"\nSheetObject.Cells(3, 7).Value = \"Credit Account No.\"\nSheetObject.Cells(3, 8).Value = \"Cr. Transaction Amount\"\nSheetObject.Cells(3, 9).Value = \"Loan Type\"\nSheetObject.Cells(3, 10).Value = \"Bank Employee ID\"\nSheetObject.Cells(3, 11).Value = \"ID Number\"\nSheetObject.Cells(3, 12).Value = \"ID Type Code\"\nSheetObject.Cells(3, 13).Value = \"Bank Employee Name\"\nSheetObject.Cells(3, 14).Value = \"HRIS Process Status\"\nSheetObject.Cells(3, 15).Value = \"Total Record\"\nSheetObject.Cells(3, 16).Value = \"CIF Number\"\nSheetObject.Cells(3, 17).Value = \"Account Branch\"\n\nSheetObject.Cells(27, 1).Value = \"Record Type\"\nSheetObject.Cells(27, 2).Value = \"Sequence No\"\nSheetObject.Cells(27, 3).Value = \"Contract No\"\nSheetObject.Cells(27, 4).Value = \"Total Record\"\nSheetObject.Cells(27, 5).Value = \"Total Amount\"\nSheetObject.Cells(27, 6).Value = \"Filler\"\n\nDo Until TextRead.AtEndOfStream\n\n    Line = TextRead.ReadLine\n\n    If Left(Line, 1) = \"H\" Then\n\n        SheetObject.Cells(CountHeader, 1).Value = Mid(Line, 1, 1)\n        SheetObject.Cells(CountHeader, 2).Value = Mid(Line, 2, 9)\n        SheetObject.Cells(CountHeader, 3).Value = Mid(Line, 11, 19) \n        SheetObject.Cells(CountHeader, 4).Value = Mid(Line, 30, 1)\n        SheetObject.Cells(CountHeader, 5).Value = Mid(Line, 31, 8)\n        SheetObject.Cells(CountHeader, 6).Value = Mid(Line, 39, 9)\n        SheetObject.Cells(CountHeader, 7).Value = Mid(Line, 48, 17) \n        SheetObject.Cells(CountHeader, 8).Value = Mid(Line, 65, 2)\n        SheetObject.Cells(CountHeader, 9).Value = Mid(Line, 67, 334)\n        CountHeader = CountHeader + 1\n\n    ElseIf Left(Line, 1) = \"D\" Then\n        SheetObject.Cells(CountDetail, 1).Value = Mid(Line, 1, 1) 'HeaderRecordType to column A\n        SheetObject.Cells(CountDetail, 2).Value = Mid(Line, 2, 9) 'ValueHeaderSequenceNo to column b\n        SheetObject.Cells(CountDetail, 3).Value = Mid(Line, 11, 19) 'HeaderContractNo to column C\n        SheetObject.Cells(CountDetail, 4).Value = Mid(Line, 30, 10) \n        SheetObject.Cells(CountDetail, 5).Value = Mid(Line, 40, 1)\n        SheetObject.Cells(CountDetail, 6).Value = Mid(Line, 41, 8)      \n        SheetObject.Cells(CountDetail, 7).Value = Mid(Line, 49, 19) \n        SheetObject.Cells(CountDetail, 8).Value = Mid(Line, 68, 1)\n        SheetObject.Cells(CountDetail, 9).Value = Mid(Line, 69, 17) \n        SheetObject.Cells(CountDetail, 10).Value = Mid(Line, 86, 10) \n        SheetObject.Cells(CountDetail, 11).Value = Mid(Line, 96, 40) \n        SheetObject.Cells(CountDetail, 12).Value = Mid(Line, 136, 40) \n        SheetObject.Cells(CountDetail, 13).Value = Mid(Line, 176, 3)\n        SheetObject.Cells(CountDetail, 14).Value = Mid(Line, 179, 200) \n        SheetObject.Cells(CountDetail, 15).Value = Mid(Line, 379, 1)\n        SheetObject.Cells(CountDetail, 16).Value = Mid(Line, 380, 19)\n        SheetObject.Cells(CountDetail, 17).Value = Mid(Line, 399, 5)\n        CountDetail = CountDetail + 1\n\n    ElseIf Left(Line, 1) = \"T\" Then\n        SheetObject.Cells(CountTrailer, 1).Value = Mid(Line, 1, 1)\n        SheetObject.Cells(CountTrailer, 2).Value = Mid(Line, 2, 9)\n        SheetObject.Cells(CountTrailer, 3).Value = Mid(Line, 30, 9)\n        SheetObject.Cells(CountTrailer, 4).Value = Mid(Line, 39, 17) \n        SheetObject.Cells(CountTrailer, 5).Value = Mid(Line, 65, 2)\n        SheetObject.Cells(CountTrailer, 6).Value = Mid(Line, 56, 354)\n        CountTrailer = CountTrailer + 1\n    Else\n    'Error Handling..\n    End If\n\n     'to move down the Excel row to paste for each line in the text fix\nLoop\n\n'Save and quit\nobjWB.Save\nobjWB.Close\nobjExcel.Quit\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/e4y1M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e4y1M.png\" alt=\"Raw Data Example\"></a></p>\n"}, {"tags": ["mysql", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5655749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2fdb41ecc3b71e1c63e9c93ba262bc?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/5655749/rob"}, "edited": false, "score": 0, "creation_date": 1449599350, "post_id": 34163012, "comment_id": 56073355, "body": "Thank you Gouda, I was clearly over complicating things."}, {"owner": {"reputation": 13, "user_id": 5655749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2fdb41ecc3b71e1c63e9c93ba262bc?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/5655749/rob"}, "edited": false, "score": 0, "creation_date": 1449599700, "post_id": 34163012, "comment_id": 56073589, "body": "Doh! It was looking promising, but it is not returning invoices that don&#39;t have any payments in the tbl_invoices_payments table. Can the query include those as well?"}, {"owner": {"reputation": 13, "user_id": 5655749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2fdb41ecc3b71e1c63e9c93ba262bc?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/5655749/rob"}, "edited": false, "score": 0, "creation_date": 1449600148, "post_id": 34163012, "comment_id": 56073869, "body": "I copied and pasted your query and the invoices without any payments are missing from the result."}, {"owner": {"reputation": 6332, "user_id": 4675055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qwpUh.jpg?s=128&g=1", "display_name": "Gouda Elalfy", "link": "https://stackoverflow.com/users/4675055/gouda-elalfy"}, "reply_to_user": {"reputation": 13, "user_id": 5655749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2fdb41ecc3b71e1c63e9c93ba262bc?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/5655749/rob"}, "edited": false, "score": 0, "creation_date": 1449600541, "post_id": 34163012, "comment_id": 56074113, "body": "change group by to be tbl_invoices.ID"}, {"owner": {"reputation": 13, "user_id": 5655749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2fdb41ecc3b71e1c63e9c93ba262bc?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/5655749/rob"}, "edited": false, "score": 0, "creation_date": 1449600620, "post_id": 34163012, "comment_id": 56074170, "body": "You pointed me in the right direction and I ended up with this  SELECT tbl_invoices.ID, tbl_invoices.customer_id, tbl_invoices.invoice_date, tbl_invoices.invoice_net, tbl_invoices.invoice_tax, tbl_invoices.invoice_gross, Sum(tbl_invoices_payments.payment_amount) AS SumOfpayment_amount FROM tbl_invoices LEFT JOIN tbl_invoices_payments ON tbl_invoices.ID = tbl_invoices_payments.invoice_id GROUP BY tbl_invoices.ID, tbl_invoices.customer_id, tbl_invoices.invoice_date, tbl_invoices.invoice_net, tbl_invoices.invoice_tax, tbl_invoices.invoice_gross HAVING (((tbl_invoices.customer_id)=11));"}], "tags": [], "owner": {"reputation": 6332, "user_id": 4675055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qwpUh.jpg?s=128&g=1", "display_name": "Gouda Elalfy", "link": "https://stackoverflow.com/users/4675055/gouda-elalfy"}, "is_accepted": true, "score": 1, "last_activity_date": 1449600525, "last_edit_date": 1449600525, "creation_date": 1449598303, "answer_id": 34163012, "question_id": 34162918, "link": "https://stackoverflow.com/questions/34162918/nested-mysql-not-working-from-access-vba/34163012#34163012", "title": "Nested MySQL Not working from Access VBA", "body": "<pre><code>SELECT tbl_invoices.ID, tbl_invoices.customer_id, Sum(tbl_invoices_payments.payment_amount) AS SumOfpayment_amount \nFROM tbl_invoices left outer join tbl_invoices_payments on tbl_invoices_payments.invoice_id = tbl_invoices.ID\nGROUP BY tbl_invoices.ID\nhaving tbl_invoices.customer_id=11;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1449605429, "post_id": 34163713, "comment_id": 56077253, "body": "Consider marking Gouda&#39;s answer as accepted (the checkmark icon next to the vote buttons) instead of posting your own answer. Posting your own answer like this, despite the attribution and &quot;thank you&quot; note, can be considered rude, which I&#39;m sure you didn&#39;t mean to be. &quot;Thank you&quot; on Stack Exchange sites is always best expressed as an upvote and/or checkmark."}], "tags": [], "owner": {"reputation": 13, "user_id": 5655749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2fdb41ecc3b71e1c63e9c93ba262bc?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/5655749/rob"}, "is_accepted": false, "score": -1, "last_activity_date": 1449600670, "creation_date": 1449600670, "answer_id": 34163713, "question_id": 34162918, "link": "https://stackoverflow.com/questions/34162918/nested-mysql-not-working-from-access-vba/34163713#34163713", "title": "Nested MySQL Not working from Access VBA", "body": "<p>I figured it out with the help of Gouda.</p>\n\n<pre><code>SELECT tbl_invoices.ID, tbl_invoices.customer_id, tbl_invoices.invoice_date, tbl_invoices.invoice_net, tbl_invoices.invoice_tax, tbl_invoices.invoice_gross, Sum(tbl_invoices_payments.payment_amount) AS SumOfpayment_amount\nFROM tbl_invoices LEFT JOIN tbl_invoices_payments ON tbl_invoices.ID = tbl_invoices_payments.invoice_id\nGROUP BY tbl_invoices.ID, tbl_invoices.customer_id, tbl_invoices.invoice_date, tbl_invoices.invoice_net, tbl_invoices.invoice_tax, tbl_invoices.invoice_gross\nHAVING (((tbl_invoices.customer_id)=11));\n</code></pre>\n\n<p>Thank you.</p>\n"}], "owner": {"reputation": 13, "user_id": 5655749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2fdb41ecc3b71e1c63e9c93ba262bc?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/5655749/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 34163012, "answer_count": 2, "score": 1, "last_activity_date": 1449600670, "creation_date": 1449597996, "last_edit_date": 1592644375, "question_id": 34162918, "link": "https://stackoverflow.com/questions/34162918/nested-mysql-not-working-from-access-vba", "title": "Nested MySQL Not working from Access VBA", "body": "<p>I'm trying to update my queries to MySQL and have found that I need to use nested queries to get the results I need.</p>\n<p>I have the following code:-</p>\n<pre><code>SELECT tbl_invoices.ID, tbl_invoices.customer_id, (SELECT Sum(tbl_invoices_payments.payment_amount) AS SumOfpayment_amount FROM tbl_invoices_payments WHERE invoice_id = id GROUP BY tbl_invoices_payments.invoice_id ) AS Payments\nFROM tbl_invoices\nWHERE (((tbl_invoices.customer_id)=11));\n</code></pre>\n<p>I get the error:-</p>\n<h1>2014 - Commands out of sync; you can't run this command now</h1>\n<p>The results I need are simply the SUM of all the payments for each invoice.</p>\n<p>Can anyone point me in the right direction?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 339, "user_id": 5626469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZonuZ.jpg?s=128&g=1", "display_name": "gazzz0x2z", "link": "https://stackoverflow.com/users/5626469/gazzz0x2z"}, "edited": false, "score": 1, "creation_date": 1449597899, "post_id": 34162742, "comment_id": 56072449, "body": "Seems legit to me. Do you have security against macros?"}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "reply_to_user": {"reputation": 339, "user_id": 5626469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZonuZ.jpg?s=128&g=1", "display_name": "gazzz0x2z", "link": "https://stackoverflow.com/users/5626469/gazzz0x2z"}, "edited": false, "score": 0, "creation_date": 1449598042, "post_id": 34162742, "comment_id": 56072530, "body": "I went to macro security and checked enable all macros, still nada"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1449598047, "post_id": 34162742, "comment_id": 56072532, "body": "Quick tip, you can <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>.Select</code></a> by just combining your two lines to <code>WB.Sheets(&quot;Automation&quot;).Range(&quot;U23:W467&quot;).ClearContents</code>.  This should work though, are you perhaps in a read-only mode? Or have something preventing macros from being run?  When you say it doesn&#39;t clear the contents, what happens?  Try removing <code>.Select</code> and see if that does it."}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 1, "creation_date": 1449598266, "post_id": 34162742, "comment_id": 56072668, "body": "I&#39;m not using range because these are merged cells, select works better. When I say it doesn&#39;t clear the contents, I mean when I open the workbook, the cells still have info on it"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1449598409, "post_id": 34162742, "comment_id": 56072772, "body": "Really? Using <code>.Select</code> works better for merged cells?  Interesting. I&#39;ve always avoided Merged Cells, since they can be a headache, and that&#39;s another reason for me to avoid them.  Thanks for that info!"}], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1449598653, "post_id": 34162969, "comment_id": 56072885, "body": "Thanks! I didn&#39;t know I had to put that into <code>thisworkbook</code> class"}], "tags": [], "owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "is_accepted": true, "score": 7, "last_activity_date": 1449598136, "creation_date": 1449598136, "answer_id": 34162969, "question_id": 34162742, "link": "https://stackoverflow.com/questions/34162742/macro-not-autorunning-upon-open/34162969#34162969", "title": "Macro not autorunning upon open", "body": "<p>Where is the code for sub <code>Workbook_Open()</code> placed?</p>\n\n<p>If you put it in the <code>ThisWorkbook</code> class it should run.</p>\n\n<p>If you have it in a regular code module it will not run with that name, but you could call the sub <code>Auto_Open()</code> instead and it should run automatically.</p>\n"}], "owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 34162969, "answer_count": 1, "score": 4, "last_activity_date": 1449598136, "creation_date": 1449597390, "question_id": 34162742, "link": "https://stackoverflow.com/questions/34162742/macro-not-autorunning-upon-open", "title": "Macro not autorunning upon open", "body": "<pre><code>Private Sub Workbook_Open()\nDim WB As Workbook\n\nSet WB = ActiveWorkbook\n\n\nWB.Sheets(\"Automation\").Range(\"U23:W467\").Select\n\nSelection.ClearContents\n\nEnd Sub\n</code></pre>\n\n<p>From what I can gather from SO, this code should automatically clear contents in those cells when I open the workbook. However, it doesn't. When I step into the code everything works fine and the cells are cleared.</p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["vba", "excel", "if-statement", "email-attachments"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1449597793, "post_id": 34162719, "comment_id": 56072391, "body": "what are the values in rngEntry.Offset(0, 1), rngEntry.Offset(0, 2), and rngEntry.Offset(0, 3)?  At the start of your code, can you concatenate those values together and then put that newly concatenated value is a single argument to add to the .Attachments?"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5569206, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/803d0ab6bfc635d79f8268b5b5986393?s=128&d=identicon&r=PG&f=1", "display_name": "Randa", "link": "https://stackoverflow.com/users/5569206/randa"}, "edited": false, "score": 1, "creation_date": 1449632372, "post_id": 34162876, "comment_id": 56087956, "body": "Your fist &quot;If Not Is&quot; idea is great...I think it will work out well.   I will be seeing if I can make your other code work as well.  Thanks a million."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 4, "last_activity_date": 1449598190, "last_edit_date": 1449598190, "creation_date": 1449597794, "answer_id": 34162876, "question_id": 34162719, "link": "https://stackoverflow.com/questions/34162719/adding-multiple-attachments-where-number-of-attachments-varies/34162876#34162876", "title": "Adding multiple attachments where number of attachments varies", "body": "<p>It's always best to avoid <code>GoTo</code> statements in VBA at all costs, because things can get hairy very quickly. Just write this:</p>\n\n<pre><code>If Not IsEmpty(rngEntry.Offset(0, 1)) Then .Attachments.Add rngEntry.Offset(0, 1).Value\n\nIf Not IsEmpty(rngEntry.Offset(0, 2)) Then .Attachments.Add rngEntry.Offset(0, 2).Value\n\nIf Not ISEmpty(rngEntry.Offset(0, 3)) then .Attachments.Add rngEntry.Offset(0, 3).Value\n</code></pre>\n\n<p><strong>Additional Info</strong> </p>\n\n<p>You may also be interested in a function I built to send emails, which passes attachments as a <code>|</code> separated string values and then splits them into an array to load them. In this way, you can send one or more with the same function, plus a few other nifty things.</p>\n\n<p>A few notes: I declared Outlook outside the function in the capacity I was using it, so you'd have to either do the same, or add it into the function. It also uses <code>Early Binding</code> as I use inside other MS Office Products.</p>\n\n<pre><code>Option Explicit\n\nSub SendMail(strTo As String, strSubject As String, strBody As String, strAttachments As String, Optional strCC As String, Optional strFolder As String, Optional blSend As Boolean)\n'requires declaration of Outlook Application outside of sub-routine\n'passes file name and folder separately\n'strAttachments is a \"|\" separate listed of attachment paths\n\nDim olNs As Outlook.Namespace\nDim oMail As Outlook.MailItem\n\n'login to outlook\nSet olNs = oApp.GetNamespace(\"MAPI\")\nolNs.Logon\n\n'create mail item\nSet oMail = oApp.CreateItem(olMailItem)\n\n'display mail to get signature\nWith oMail\n    .Display\nEnd With\n\nDim strSig As String\nstrSig = oMail.HTMLBody\n\n'build mail and send\nWith oMail\n\n    .To = strTo\n    .CC = strCC\n    .Subject = strSubject\n    .HTMLBody = strBody &amp; strSig\n\n    Dim strAttach() As String, x As Integer\n    strAttach() = Split(strAttachments, \"|\")\n\n    For x = LBound(strAttach()) To UBound(strAttach())\n        If FileExists(strFolder &amp; strAttach(x)) Then .Attachments.Add strFolder &amp; strAttach(x)\n    Next\n\n    .Display\n    If blSend Then .Send\n\nEnd With\n\nSet olNs = Nothing\nSet oMail = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Here is the <code>FileExists</code> that checks if the attachment exists before trying to add it:</p>\n\n<pre><code>Function FileExists(sFile As String) As Boolean\n'requires reference to Microsoft Scripting RunTime\n\nDim fso As FileSystemObject\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nIf fso.FileExists(sFile) Then\n    FileExists = True\nElse\n    FileExists = False\nEnd If\n\nSet fso = Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5569206, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/803d0ab6bfc635d79f8268b5b5986393?s=128&d=identicon&r=PG&f=1", "display_name": "Randa", "link": "https://stackoverflow.com/users/5569206/randa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "accepted_answer_id": 34162876, "answer_count": 1, "score": 4, "last_activity_date": 1449599205, "creation_date": 1449597286, "last_edit_date": 1449599205, "question_id": 34162719, "link": "https://stackoverflow.com/questions/34162719/adding-multiple-attachments-where-number-of-attachments-varies", "title": "Adding multiple attachments where number of attachments varies", "body": "<p>I am sending emails out to approximately 150 individuals, each email may have between 1 and 3 attachments.  </p>\n\n<p>I can send emails out just fine with one attachment...getting multiple attachments is difficult.  </p>\n\n<p>Lets say the attachment file path is located in A1 through C1.  </p>\n\n<p>How can I Perform. </p>\n\n<p>If A1 is empty, go to Send, if not, attach file\nIf B1 is empty, go to Send, if not, attach file\nIf C1 is empty, go to Send, if not, attach file</p>\n\n<p>Send: </p>\n\n<p>This is the code I have currently: I realize my ranges are different than what I posted above.  The following script works...its just for the one attachment however.  </p>\n\n<pre><code>Set rngEntries = ActiveSheet.Range(\"b5:b172\")\n\nFor Each rngEntry In rngEntries\n    Set objMail = objOutlook.CreateItem(0)\n    With objMail\n        .To = rngEntry.Offset(0, 11).Value\n        .Subject = rngEntry.Offset(0, 8).Value\n        .Body = rngEntry.Offset(0, 10).Value\n        .Attachments.Add rngEntry.Offset(0, 9).Value\n        .send\n    End With\nNext rngEntry\n</code></pre>\n\n<p>What I want would look a little like this....</p>\n\n<pre><code>Set rngEntries = ActiveSheet.Range(\"b5:b172\")\n\nFor Each rngEntry In rngEntries\n    Set objMail = objOutlook.CreateItem(0)\n    With objMail\n        .To = rngEntry.Offset(0, 11).Value\n        .Subject = rngEntry.Offset(0, 8).Value\n        .Body = rngEntry.Offset(0, 10).Value\n\nIf rngEntry.Offset(0, 1) is empty, goto Send\n\n        .Attachments.Add rngEntry.Offset(0, 1).Value\n\nIf rngEntry.Offset(0, 2) is empty, goto Send\n\n        .Attachments.Add rngEntry.Offset(0, 2).Value\n\nIf rngEntry.Offset(0, 3) is empty, goto Send\n\n        .Attachments.Add rngEntry.Offset(0, 3).Value\n\nSend: \n        .send\n    End With\n\nNext rngEntry\n</code></pre>\n"}, {"tags": ["c#", "linq", "excel", "vba"], "comments": [{"owner": {"reputation": 525, "user_id": 875317, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/tQ8Th.jpg?s=128&g=1", "display_name": "B. Clay Shannon", "link": "https://stackoverflow.com/users/875317/b-clay-shannon"}, "edited": false, "score": 2, "creation_date": 1449597494, "post_id": 34162639, "comment_id": 56072217, "body": "Why did somebody vote to close this? Odd, to say the least."}, {"owner": {"reputation": 525, "user_id": 875317, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/tQ8Th.jpg?s=128&g=1", "display_name": "B. Clay Shannon", "link": "https://stackoverflow.com/users/875317/b-clay-shannon"}, "edited": false, "score": 0, "creation_date": 1449597536, "post_id": 34162639, "comment_id": 56072243, "body": "PPR, is this &quot;ACE&quot; for Ace Reports, of Illinois? If so, I know that cat, and I&#39;m sure he&#39;d be glad to help you."}, {"owner": {"reputation": 525, "user_id": 875317, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/tQ8Th.jpg?s=128&g=1", "display_name": "B. Clay Shannon", "link": "https://stackoverflow.com/users/875317/b-clay-shannon"}, "edited": false, "score": 0, "creation_date": 1449597894, "post_id": 34162639, "comment_id": 56072447, "body": "I don&#39;t know, then, what the &quot;ACE&quot; in &quot;Provider=Microsoft.ACE.OLEDB.12.0&quot; stands for."}, {"owner": {"reputation": 433, "user_id": 5067286, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/y803Q.png?s=128&g=1", "display_name": "Just Do It", "link": "https://stackoverflow.com/users/5067286/just-do-it"}, "reply_to_user": {"reputation": 525, "user_id": 875317, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/tQ8Th.jpg?s=128&g=1", "display_name": "B. Clay Shannon", "link": "https://stackoverflow.com/users/875317/b-clay-shannon"}, "edited": false, "score": 2, "creation_date": 1449598104, "post_id": 34162639, "comment_id": 56072569, "body": "stands for &quot;Office Access Connectivity Engine&quot; @B.ClayShannon"}, {"owner": {"reputation": 5203, "user_id": 1760479, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gFcMy.jpg?s=128&g=1", "display_name": "David Tansey", "link": "https://stackoverflow.com/users/1760479/david-tansey"}, "edited": false, "score": 1, "creation_date": 1449598225, "post_id": 34162639, "comment_id": 56072640, "body": "Is it possible that you have another instance of your code that is still running?  This happens sometimes while debugging.  Check TaskManager for another instance."}, {"owner": {"reputation": 433, "user_id": 5067286, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/y803Q.png?s=128&g=1", "display_name": "Just Do It", "link": "https://stackoverflow.com/users/5067286/just-do-it"}, "reply_to_user": {"reputation": 5203, "user_id": 1760479, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gFcMy.jpg?s=128&g=1", "display_name": "David Tansey", "link": "https://stackoverflow.com/users/1760479/david-tansey"}, "edited": false, "score": 0, "creation_date": 1449598494, "post_id": 34162639, "comment_id": 56072812, "body": "Yes, there was another instance running; after terminating it everything worked fine. If you post your comment as answer I&#39;ll accept it @DavidTansey , I always forget to check the most obvious/logic reasons, I guess I was too tilted."}], "answers": [{"tags": [], "owner": {"reputation": 5203, "user_id": 1760479, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gFcMy.jpg?s=128&g=1", "display_name": "David Tansey", "link": "https://stackoverflow.com/users/1760479/david-tansey"}, "is_accepted": true, "score": 2, "last_activity_date": 1449600186, "creation_date": 1449600186, "answer_id": 34163569, "question_id": 34162639, "link": "https://stackoverflow.com/questions/34162639/cant-modify-an-excel-file-using-linq/34163569#34163569", "title": "Can&#39;t modify an Excel File using LINQ", "body": "<p>When I encounter this error or similar errors during debugging, I have a soft-assumption that I am working in isolation (i.e. because it is all local, I am the only 'user' actively working with the artifacts/data etc), the problem usually ends up being that <strong>I am also the 'other user'</strong> that the error message is complaining about.</p>\n\n<p>It is easy to inadvertently leave an instance of my code still executing when I am working through debugging cycles of DEBUG | TEST | Stop Debugging.  An orphaned instance of the code may well still have locks on various resources causing the problem you described.</p>\n\n<p>Check in the Windows TaskManager to see if there are possibly one or more orphaned instances of your code / debug session.  Kill the orphaned tasks and the next DEBUG execution you start should be now be able to execute cleanly.</p>\n"}], "owner": {"reputation": 433, "user_id": 5067286, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/y803Q.png?s=128&g=1", "display_name": "Just Do It", "link": "https://stackoverflow.com/users/5067286/just-do-it"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 34163569, "answer_count": 1, "score": 2, "last_activity_date": 1449600186, "creation_date": 1449597082, "last_edit_date": 1531161705, "question_id": 34162639, "link": "https://stackoverflow.com/questions/34162639/cant-modify-an-excel-file-using-linq", "title": "Can&#39;t modify an Excel File using LINQ", "body": "<p>I have a winform application where I read a XML invoice, get the order number of it and then insert it into an Excel file previously loaded with the list of invoices(a way to locally keep track of them) updating the row.</p>\n\n<p>I used to do it for 97-2003 Worksheets, and it worked just fine. But since our users prefer working on 2013 Worksheets I started working on modifying the connection string to work with it.</p>\n\n<p>I also had to install Office System Driver: Data Connectivity Components  2007 so it could work with <code>Microsoft.ACE.OLEDB.12.0</code></p>\n\n<p>When I run it I get the following exception:</p>\n\n<blockquote>\n  <p>System.Data.OleDb.OleDbExeption (0x80004005): The Microsoft Office Access database engine stopped the process because you and another user are attempting to change the same data at the same time.</p>\n</blockquote>\n\n<p>Which is odd since I'm currently working locally. Currently only two users use this application, and they were able to work with it by just sharing the file. </p>\n\n<p>I'm a bit stuck with this, I've been reading for more info about this but I haven't been successful, when I just look for the exception results say that it's about a <em>not found</em> file. And when I look for the exception text I don't get results for my particular case.</p>\n\n<p>I've debugged the code but I didn't get much information, since everything runs fine until it hits the exception. Which is basically what I show up in a <code>MessageBox</code>.</p>\n\n<h2>Anyone has knowledge as to why this might be happening?</h2>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>            System.Data.OleDb.OleDbConnection MyConnection;\n            System.Data.OleDb.OleDbCommand myCommand = new System.Data.OleDb.OleDbCommand();\n            string sql = null;\n            string connectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + \"C:\\\\Users\\\\user\\\\Desktop\\\\file.xlsx;\" + \"Extended Properties=\\\"Excel 12.0;ReadOnly=False;HDR=Yes\\\";\";\n            MyConnection = new       System.Data.OleDb.OleDbConnection(connectionString);\n            MyConnection.Open();\n            myCommand.Connection = MyConnection;\n            sql = \"Update [sheetname$] set OrderNumber= @order where Invoice= @invoice\";\n            myCommand.Parameters.AddWithValue(\"@order\", orderNumber);\n            myCommand.Parameters.AddWithValue(\"@invoice\", invoiceNumber);\n            myCommand.CommandText = sql;\n            myCommand.ExecuteNonQuery();\n            MyConnection.Close();\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 5169814, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90ff5c4b8024f67ffb28220ac6bf3dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Erc", "link": "https://stackoverflow.com/users/5169814/erc"}, "edited": false, "score": 0, "creation_date": 1449599720, "post_id": 34163352, "comment_id": 56073611, "body": "But 24000 is not the limit per cell."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1449600039, "post_id": 34163352, "comment_id": 56073805, "body": "No, that&#39;s true, but suppose you have a cell that has 24,000 characters, and you are replacing a word in that cell with text from a second cell that has 24,000 characters.  Perhaps I misunderstood, but this is what I understood you were doing in your example.  The new combined text would be roughly 48,000 characters which is greater than the limit of 32,767 characters.  What you might be able to do instead, is take the newly formed string and store it in a list, or a file, or broken up into two cells.  But if the combination exceeds the 32,767 limit, it cannot be stored in a single cell."}, {"owner": {"reputation": 67, "user_id": 5169814, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90ff5c4b8024f67ffb28220ac6bf3dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Erc", "link": "https://stackoverflow.com/users/5169814/erc"}, "edited": false, "score": 0, "creation_date": 1449600988, "post_id": 34163352, "comment_id": 56074404, "body": "No. The second cell contains only 1 to about 50 words. That still will not exceed the cell limitation. Did you try my code? I need to figure this one out."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "reply_to_user": {"reputation": 67, "user_id": 5169814, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90ff5c4b8024f67ffb28220ac6bf3dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Erc", "link": "https://stackoverflow.com/users/5169814/erc"}, "edited": false, "score": 0, "creation_date": 1449602869, "post_id": 34163352, "comment_id": 56075551, "body": "I tried to use the <code>Replace</code> on a cell with more than 24,000 characters and it worked for me.  Of course to run your code properly, I would need your workbook, but I would suggest instead adding some code to notate what is happening.  I will edit my answer with a diagnostics accordingly."}, {"owner": {"reputation": 67, "user_id": 5169814, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90ff5c4b8024f67ffb28220ac6bf3dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Erc", "link": "https://stackoverflow.com/users/5169814/erc"}, "edited": false, "score": 0, "creation_date": 1449603880, "post_id": 34163352, "comment_id": 56076259, "body": "Did you use html code in the cells that contain the data that will be replaced?"}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "reply_to_user": {"reputation": 67, "user_id": 5169814, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90ff5c4b8024f67ffb28220ac6bf3dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Erc", "link": "https://stackoverflow.com/users/5169814/erc"}, "edited": false, "score": 0, "creation_date": 1449604054, "post_id": 34163352, "comment_id": 56076378, "body": "No, I do not have the html code in question.  If you can give me a test data to use, I could try that, but I have used &quot;dummy&quot; text because I do not have your exact test data."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "reply_to_user": {"reputation": 67, "user_id": 5169814, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90ff5c4b8024f67ffb28220ac6bf3dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Erc", "link": "https://stackoverflow.com/users/5169814/erc"}, "edited": false, "score": 0, "creation_date": 1449604187, "post_id": 34163352, "comment_id": 56076474, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/97325/discussion-between-demetri-and-erc\">continue this discussion in chat</a>."}, {"owner": {"reputation": 67, "user_id": 5169814, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90ff5c4b8024f67ffb28220ac6bf3dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Erc", "link": "https://stackoverflow.com/users/5169814/erc"}, "edited": false, "score": 0, "creation_date": 1449605213, "post_id": 34163352, "comment_id": 56077113, "body": "I am in chat right by the way. I uploaded some test code."}], "tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": false, "score": 0, "last_activity_date": 1449603928, "last_edit_date": 1449603928, "creation_date": 1449599511, "answer_id": 34163352, "question_id": 34161764, "link": "https://stackoverflow.com/questions/34161764/excel-vba-replace-characters-in-cells-that-contain-html-code/34163352#34163352", "title": "Excel VBA Replace characters in cells that contain html code", "body": "<p>If you run the following, does the message box always say it is successful, even for characters greater than 24,000.  If not, which data points fail exactly and at what point.  You can review these data sets to verify that the overall length will not be greater than the limit.</p>\n\n<pre><code>Sub GoodREPLACETeleModule()\n\n    Dim wFind As Long\n\n    ' &lt;PUTDESCRIPTIONHERE&gt;\n    For MY_ROWS = 1 To Range(\"AF\" &amp; Rows.Count).End(xlUp).Row\n        MsgBox \"Row \" &amp; MY_ROWS\n        wFind = InStr(Range(\"R\" &amp; MY_ROWS).Value, \"PUTDESCRIPTIONHERE\")\n        If wFind = 0 Then\n            MsgBox \"Nothing to replace\"\n            Else\n            a = Len(Range(\"R\" &amp; MY_ROWS).Value): b = Len(Range(\"AF\" &amp; MY_ROWS).Value)\n            Range(\"R\" &amp; MY_ROWS).Value = Replace(Range(\"R\" &amp; MY_ROWS).Value, \"PUTDESCRIPTIONHERE\", Range(\"AF\" &amp; MY_ROWS).Value)\n            wFind = InStr(Range(\"R\" &amp; MY_ROWS).Value, \"PUTDESCRIPTIONHERE\")\n            If Not wFind = 0 Then MsgBox \"Replace Failed\"\n            If Len(Range(\"R\" &amp; MY_ROWS).Value) &lt; a + b - Len(\"PUTDESCRIPTIONHERE\") Then\n                MsgBox \"The replace did not happen successfully\"\n                Else\n                If Len(Range(\"R\" &amp; MY_ROWS).Value) &gt; 32766 then \n                    Msgbox \"Too many characters\"\n                    Else\n                    MsgBox \"Replace succeeded, old string was \" &amp; a &amp; \" characters, new string is \" &amp; Len(Range(\"R\" &amp; MY_ROWS).Value) &amp; \" characters.\"\n                End If\n            End If\n        End If\n    Next MY_ROWS\n\n    ' &lt;PUTIMAGEHERE&gt;\n    For MY_ROWS = 1 To Range(\"AF\" &amp; Rows.Count).End(xlUp).Row\n        MsgBox \"Row \" &amp; MY_ROWS\n        wFind = InStr(Range(\"P\" &amp; MY_ROWS).Value, \"PUTIMAGEHERE\")\n        If wFind = 0 Then\n            MsgBox \"Nothing to replace\"\n            Else\n            a = Len(Range(\"R\" &amp; MY_ROWS).Value): b = Len(Range(\"AF\" &amp; MY_ROWS).Value)\n            Range(\"P\" &amp; MY_ROWS).Value = Replace(Range(\"P\" &amp; MY_ROWS).Value, \"PUTIMAGEHERE\", Range(\"AF\" &amp; MY_ROWS).Value)\n            wFind = InStr(Range(\"P\" &amp; MY_ROWS).Value, \"PUTIMAGEHERE\")\n            If Not wFind = 0 Then MsgBox \"Replace Failed\"\n            If Len(Range(\"P\" &amp; MY_ROWS).Value) &lt; a + b - Len(\"PUTIMAGEHERE\") Then\n                MsgBox \"The replace did not happen successfully\"\n                Else\n                If Len(Range(\"P\" &amp; MY_ROWS).Value) &gt; 32766 then \n                    Msgbox \"Too many characters\"\n                    Else\n                    MsgBox \"Replace succeeded, old string was \" &amp; a &amp; \" characters, new string is \" &amp; Len(Range(\"P\" &amp; MY_ROWS).Value) &amp; \" characters.\"\n                End If\n            End If\n        End If\n    Next MY_ROWS\n\nEnd Sub\n</code></pre>\n\n<p>Unfortunately there are <a href=\"https://support.office.com/en-nz/article/Excel-specifications-and-limits-16c69c74-3d6a-4aaf-ba35-e6eb276e8eaa\" rel=\"nofollow\">Excel Limits</a>\nas to how many characters can be contained in a cell.</p>\n"}], "owner": {"reputation": 67, "user_id": 5169814, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/90ff5c4b8024f67ffb28220ac6bf3dc8?s=128&d=identicon&r=PG&f=1", "display_name": "Erc", "link": "https://stackoverflow.com/users/5169814/erc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449603928, "creation_date": 1449594185, "last_edit_date": 1531164843, "question_id": 34161764, "link": "https://stackoverflow.com/questions/34161764/excel-vba-replace-characters-in-cells-that-contain-html-code", "title": "Excel VBA Replace characters in cells that contain html code", "body": "<p>I have data in 3 different columns that I want to place in a column of cells that contain 22000 - 24000 characters of html code each. I was able to execute successfully with fewer characters in the column of cells that contain the html code. Is it possible to replace data in the column of cells that contain 22000 -24000 characters of html code each?</p>\n\n<p>And I use a VBA program to do this.</p>\n\n<pre><code>Sub GoodREPLACETeleModule()\n\n' &lt;PUTDESCRIPTIONHERE&gt;\nFor MY_ROWS = 1 To Range(\"AF\" &amp; Rows.Count).End(xlUp).Row\n    Range(\"R\" &amp; MY_ROWS).Value = Replace(Range(\"R\" &amp; MY_ROWS).Value, \"PUTDESCRIPTIONHERE\", Range(\"AF\" &amp; MY_ROWS).Value)\nNext MY_ROWS\n\n' &lt;PUTIMAGEHERE&gt;\nFor MY_ROWS = 1 To Range(\"AF\" &amp; Rows.Count).End(xlUp).Row\n    Range(\"P\" &amp; MY_ROWS).Value = Replace(Range(\"P\" &amp; MY_ROWS).Value, \"PUTIMAGEHERE\", Range(\"AF\" &amp; MY_ROWS).Value)\nNext MY_ROWS\nEnd Sub\n</code></pre>\n\n<p>I have \"PUTIMAGEHERE\" and \"PUTDESCRIPTIONHERE\" placed within the 24000 lines of html code but it does not reach it.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "edited": false, "score": 0, "creation_date": 1449599351, "post_id": 34161736, "comment_id": 56073356, "body": "the email works just like a web page, when you include an <code>&lt;img&gt;</code> tag, you&#39;re just sending a reference to the path set in <code>src</code>. If the computer receiving the email cannot access that path, then the image will not appear. you need to save the images somewhere public, and leave them there for this to work."}, {"owner": {"reputation": 33, "user_id": 5655277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e729aee7325c9edb1b91abee26e0c?s=128&d=identicon&r=PG&f=1", "display_name": "HalfTimeDreamer", "link": "https://stackoverflow.com/users/5655277/halftimedreamer"}, "reply_to_user": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "edited": false, "score": 0, "creation_date": 1449602116, "post_id": 34161736, "comment_id": 56075103, "body": "But it works fine when i use olMail.Display and then click &quot;send&quot;. By clicking send do I make an image an integral part of a mail? There must be a way to add an image to a body of a mail, so that receiver doesnt have to have acces to source of an image to display it properly..."}, {"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "edited": false, "score": 0, "creation_date": 1449602266, "post_id": 34161736, "comment_id": 56075187, "body": "you can attach it, but <code>img</code> simply creates a reference"}, {"owner": {"reputation": 33, "user_id": 5655277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e729aee7325c9edb1b91abee26e0c?s=128&d=identicon&r=PG&f=1", "display_name": "HalfTimeDreamer", "link": "https://stackoverflow.com/users/5655277/halftimedreamer"}, "reply_to_user": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "edited": false, "score": 0, "creation_date": 1449602581, "post_id": 34161736, "comment_id": 56075373, "body": "How to do it then (in a body of a mail, not as an attachement)? I thought I do it right."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1449602691, "post_id": 34161736, "comment_id": 56075441, "body": "I had this issue in the past (sorry don&#39;t have the code I used to fix it), but I believe I saved it as a picture, then attached the picture... or something close to that."}, {"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "edited": false, "score": 0, "creation_date": 1449603256, "post_id": 34161736, "comment_id": 56075816, "body": "you can use <a href=\"http://stackoverflow.com/questions/16449445/how-can-i-set-image-source-with-base64\">base64</a> to include the actual content of the image on the page, otherwise, the path must be available. see also <a href=\"http://stackoverflow.com/a/8134022/5090771\">Convert image (jpg) to base64</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5655277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e729aee7325c9edb1b91abee26e0c?s=128&d=identicon&r=PG&f=1", "display_name": "HalfTimeDreamer", "link": "https://stackoverflow.com/users/5655277/halftimedreamer"}, "edited": false, "score": 1, "creation_date": 1449765631, "post_id": 34205815, "comment_id": 56158844, "body": "Thanks a lot guys! I found the way how to do it today at work at this site: <a href=\"http://excel-macro.tutorialhorizon.com/excel-vba-send-mail-with-embedded-image-in-message-body-from-ms-outlook-using-excel/\" rel=\"nofollow noreferrer\">excel-macro.tutorialhorizon.com/&hellip;</a> and it works! It&#39;s the same solution as you proposed in your answer.  But do you know maybe why displaying mail and the sending it works, even with  path to an image on your local hard drive?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 33, "user_id": 5655277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e729aee7325c9edb1b91abee26e0c?s=128&d=identicon&r=PG&f=1", "display_name": "HalfTimeDreamer", "link": "https://stackoverflow.com/users/5655277/halftimedreamer"}, "edited": false, "score": 0, "creation_date": 1449766294, "post_id": 34205815, "comment_id": 56159266, "body": "Adding the images as attachments first and setting the properties for the <code>TAG</code> and <code>CONTENT_ID</code> (and then saving the email), are the steps that embed the image in the email body. Those images are now &quot;copied&quot; into the email body. Adding the HTML message contents at this point makes the connection between the message body display and the image data -- using the <code>ident</code> tag as the link between the body and the embedded image. This is why the temporary images are deleted in the code after this step, because they&#39;re already copied into the email."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 3, "last_activity_date": 1449761538, "creation_date": 1449761538, "answer_id": 34205815, "question_id": 34161736, "link": "https://stackoverflow.com/questions/34161736/sending-a-chart-in-mail-body/34205815#34205815", "title": "Sending a chart in mail body", "body": "<p>Getting the images to appear as inline is certainly possible. The <code>img src</code> in the HTML must refer to the <code>cid</code> with an identifier for the image. The code below sets up the email and adds all of the chart objects as inline images to an email.</p>\n\n<p>\n    Option Explicit</p>\n\n<pre><code>Sub CreateEmail()\n    Const PR_ATTACH_MIME_TAG = \"http://schemas.microsoft.com/mapi/proptag/0x370E001E\"\n    Const PR_ATTACH_CONTENT_ID = \"http://schemas.microsoft.com/mapi/proptag/0x3712001E\"\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim olApp As Object\n    Dim olMail As Object\n    Dim msg As String\n    Dim msgGreeting As String\n    Dim msgPara1 As String\n    Dim msgEnding As String\n    Dim chrt As ChartObject\n    Dim fname As String\n    Dim ident As String\n    Dim tempFiles As Collection\n    Dim imgIdents As Collection\n    Dim imgFile As Variant\n    Dim attchmt As Object\n    Dim oPa As Object\n    Dim i As Integer\n\n    '--- create the email body with HTML-formatted content\n    msgGreeting = \"&lt;bold&gt;Dear Sirs&lt;/bold&gt;,&lt;br&gt;&lt;br&gt;\"\n    msgPara1 = \"&lt;div&gt;Here is the data you requested:&lt;/div&gt;\"\n    msgEnding = \"&lt;br&gt;&lt;br&gt;Sincerely,&lt;br&gt;JimBob&lt;br&gt;\"\n\n    '--- build the other email body content\n    Set wb = ActiveWorkbook\n    Set ws = ActiveSheet\n    msg = msgGreeting &amp; msgPara1\n    '--- loops and adds all charts found on the worksheet\n    If ws.ChartObjects.Count &gt; 0 Then\n        Set tempFiles = New Collection\n        Set imgIdents = New Collection\n        For Each chrt In ws.ChartObjects\n            fname = \"\"\n            msg = msg &amp; ChartToEmbeddedHTML(chrt, fname, ident) &amp; \"&lt;br&gt;&lt;br&gt;\"\n            tempFiles.Add fname\n            imgIdents.Add ident\n        Next chrt\n    End If\n    msg = msg &amp; msgEnding\n\n    '--- create the mail item\n    Set olApp = CreateObject(\"Outlook.Application\")\n    Set olMail = olApp.CreateItem(0)                'olMailItem=0\n    With olMail\n        .To = \"yyy@zzzz.com\"\n        '.CC = \"xxxx@xxx\"\n        .Subject = \"xxxx\"\n        .bodyformat = 2        'olFormatHTML=2\n        '--- each of the images is referenced as a filename, but each one must be\n        '    individually added as an attachment, then the attachment properties\n        '    set to show the attachment as \"inline\". Because the image will be\n        '    inlined, we'll use the \"ident\" as the reference (internal to the\n        '    message body HTML)\n        If (Not tempFiles Is Nothing) Then\n            For i = 1 To tempFiles.Count\n                Set attchmt = .attachments.Add(tempFiles.Item(i))\n                Set oPa = attchmt.PropertyAccessor\n                oPa.SetProperty PR_ATTACH_MIME_TAG, \"image/png\"\n                oPa.SetProperty PR_ATTACH_CONTENT_ID, imgIdents.Item(i)\n            Next i\n        End If\n        '--- the email item needs to be saved first\n        .Save\n        '--- now add the message contents\n        .htmlbody = msg\n        .display\n    End With\n    '--- delete the temp files now\n    For Each imgFile In tempFiles\n        Kill imgFile\n    Next imgFile\n    '--- clean up and get out\n    Set tempFiles = Nothing\n    Set imgIdents = Nothing\n    Set attchmt = Nothing\n    Set oPa = Nothing\n    Set olMail = Nothing\n    Set olApp = Nothing\n    Set ws = Nothing\n    Set wb = Nothing\nEnd Sub\n\nPrivate Function ChartToEmbeddedHTML(thisChart As ChartObject, _\n                             ByRef tmpFile As String, _\n                             ByRef ident As String) As String\n    Dim html As String\n    ident = RandomString(8)\n    tmpFile = thisChart.Parent.Parent.Path &amp; \"\\\" &amp; ident &amp; \".png\"\n\n    thisChart.Activate\n    thisChart.Chart.Export Filename:=tmpFile, Filtername:=\"png\"\n    html = \"&lt;img alt='Excel Chart' src='cid:\" &amp; ident &amp; \"'&gt;&lt;/img&gt;\"\n    ChartToEmbeddedHTML = html\nEnd Function\n\nPrivate Function RandomString(strlen As Integer) As String\n    Dim i As Integer, iTemp As Integer, bOK As Boolean, strTemp As String\n    '48-57 = 0 To 9, 65-90 = A To Z, 97-122 = a To z\n    'amend For other characters If required\n    For i = 1 To strlen\n        Do\n            iTemp = Int((122 - 48 + 1) * Rnd + 48)\n            Select Case iTemp\n            Case 48 To 57, 65 To 90, 97 To 122: bOK = True\n            Case Else: bOK = False\n            End Select\n        Loop Until bOK = True\n        bOK = False\n        strTemp = strTemp &amp; Chr(iTemp)\n    Next i\n    RandomString = strTemp\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10170777, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k82FgIZdauc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p_x8kln16LeR7aBy2QsLAyXIEf6g/mo/photo.jpg?sz=128", "display_name": "Eliton Elias", "link": "https://stackoverflow.com/users/10170777/eliton-elias"}, "is_accepted": false, "score": 0, "last_activity_date": 1533208739, "creation_date": 1533208739, "answer_id": 51652328, "question_id": 34161736, "link": "https://stackoverflow.com/questions/34161736/sending-a-chart-in-mail-body/51652328#51652328", "title": "Sending a chart in mail body", "body": "<p>Excellent! I couldn't manage to attach the active workbook into the mail.\nI tried to add the code <em>.Attachments.Add (ActiveWorkbook.FullName)</em> but didn't work, I received a message saying that the file is in use, and sometimes Runtime error 424 - Object required</p>\n\n<pre><code>With olMail\n    .To = \"yyy@zzzz.com\"\n    '.CC = \"xxxx@xxx\"\n    .Subject = \"xxxx\"\n    .Attachments.Add (ActiveWorkbook.FullName) ' this i added\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5655277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e729aee7325c9edb1b91abee26e0c?s=128&d=identicon&r=PG&f=1", "display_name": "HalfTimeDreamer", "link": "https://stackoverflow.com/users/5655277/halftimedreamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11504, "favorite_count": 2, "accepted_answer_id": 34205815, "answer_count": 2, "score": 3, "last_activity_date": 1533208739, "creation_date": 1449594101, "question_id": 34161736, "link": "https://stackoverflow.com/questions/34161736/sending-a-chart-in-mail-body", "title": "Sending a chart in mail body", "body": "<p>Im trying to modify Ron de Bruins macro to send a chart in mail body. First, I export chart and save it as an PNG image, then i modify HTML code to add it to the message. Macro should run on a server and send mails to other people working in my workplace. When Im using MailItem.Display method and manually click \"send\" when my message appears, everything works fine. When I try to use MailItem.Send method though, it doesnt - in mail body I get an icon like it tried to attach an image which it couldnt find. Whats funny, when I send that mail from a server, on a server acount, chart is displayed corectly. It doesnt work only when I try to send it on \"local\" computers.</p>\n\n<pre><code>Sub wyslij()\n\nNameOfThisFile = ActiveWorkbook.Name\n\nDim rng As Range\nDim dataminus1, dataminus2 As Date\nDim olApp As Outlook.Application\nSet olApp = CreateObject(\"Outlook.Application\")\n\nDim olMail As Outlook.MailItem\nSet olMail = olApp.CreateItem(olMailItem)\n\nSet rng = Nothing\nSet rng = Sheets(2).Range(\"E1:P13\")\n\n\nolMail.To = \"xxx@xxx\" \nolMail.CC = \"xxxx@xxx\"\n\nolMail.Subject = \"xxxx\"\n\nolMail.HTMLBody = RangetoHTML(rng)\n\nolMail.Display\n'olMail.Send\n\n'Delete file after sending a mail\n'Call DeleteFile(Path)\n\nEnd Sub\n\nSub Save_ChartAsImage()\n\nChartEx = False\n\nDim cht As ChartObject\n\nFor Each cht In ActiveSheet.ChartObjects\nIf cht.TopLeftCell.Column = ChartCol And cht.TopLeftCell.Row = ChartRow Then\n    ChartEx = True\n    On erRROR GoTo Err_Chart\n    cht.Chart.Export Filename:=ActiveWorkbook.Path &amp; \"\\Chart.png\", Filtername:=\"PNG\"\nEnd If\nNext cht\n\nErr_Chart:\nIf Err &lt;&gt; 0 Then\n\nDebug.Print Err.Description\n\nErr.Clear\n\nEnd If\nEnd Sub\n\nFunction RangetoHTML(rng As Range)\n' Changed by Ron de Bruin 28-Oct-2006\n' Working in Office 2000-2013\n\nDim fso As Object\nDim ts As Object\nDim TempFile As String\nDim TempWB As Workbook\n\n\n\n\nTempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n'Copy the range and create a new workbook to past the data in\nrng.Copy\nSet TempWB = Workbooks.Add(1)\n\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    '.Cells(1).PasteSpecial xlPasteAll\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n\n\n'kopiujemy wykres z poprzedniego dzia\u0142u\n'Workbooks(\"WplatyFinal.xlsm\").Activate\nWorkbooks(NameOfThisFile).Activate\nCall Save_ChartAsImage\n\nTempWB.Activate\n\nTempWB.Sheets(1).Select\n\n\n'Publish the sheet to a htm file\nWith TempWB.PublishObjects.Add( _\n     SourceType:=xlSourceRange, _\n     Filename:=TempFile, _\n     Sheet:=TempWB.Sheets(1).Name, _\n     Source:=TempWB.Sheets(1).UsedRange.Address, _\n     HtmlType:=xlHtmlStatic)\n    .Publish (True)\nEnd With\n\n\n\n'Read all data from the htm file into RangetoHTML\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nSet ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n\n\nRangetoHTML = ts.readall\nts.Close\n\nIf ChartEx Then\n RangetoHTML = RangetoHTML &amp; \"&lt;img src ='\" &amp; ActiveWorkbook.Path &amp; \"\\Chart.png\" &amp; \"'&gt;\"\nEnd If\n\nRangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                      \"align=left x:publishsource=\")\n\n'Close TempWB\nTempWB.Close savechanges:=False\n\n'Delete the htm file we used in this function\nKill TempFile\n\nSet ts = Nothing\nSet fso = Nothing\nSet TempWB = Nothing\nEnd Function\n</code></pre>\n\n<p>I also want to mention, that I tried to use Wait function directly after Send method, but sadly it didtnt help.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1449593346, "post_id": 34161176, "comment_id": 56069609, "body": "Do you mean users will define x and y and store them in variables.  Have you created the code to grab the data and store the data in a variable?  This isn&#39;t a &quot;write code for me&quot; site.  What have you tried?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1449593593, "post_id": 34161176, "comment_id": 56069760, "body": "What method do you have in mind to allow the user to submit values for <code>x</code> and <code>y</code>?  Then what do you want to do with the computed value?"}, {"owner": {"reputation": 163, "user_id": 1701492, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e342377c09dbd5fde173be8abcd3741c?s=128&d=identicon&r=PG", "display_name": "Avi.S.", "link": "https://stackoverflow.com/users/1701492/avi-s"}, "edited": false, "score": 0, "creation_date": 1449601941, "post_id": 34161176, "comment_id": 56074985, "body": "user input will be made through access form and be saved to data base, so when i run the code it will take these values."}], "answers": [{"tags": [], "owner": {"reputation": 5592, "user_id": 282694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90896d42cfb5df3e088bb2173baf9b2?s=128&d=identicon&r=PG", "display_name": "sarh", "link": "https://stackoverflow.com/users/282694/sarh"}, "is_accepted": false, "score": 1, "last_activity_date": 1449594192, "creation_date": 1449594192, "answer_id": 34161768, "question_id": 34161176, "link": "https://stackoverflow.com/questions/34161176/how-to-evaluate-math-expression-with-variables-in-vba/34161768#34161768", "title": "how to evaluate math expression with variables in vba?", "body": "<p>You may try Eval, but you will have to be very careful with string processing to put arguments properly. Here is a code sample:</p>\n\n<pre><code>Sub TestEval()\n    Dim Expr As String\n\n    Expr = \"x*y+2\"\n    Expr = Replace(Expr, \"x\", \"3\")\n    Expr = Replace(Expr, \"y\", \"4\")\n\n    Debug.Print Eval(Expr)  'prints 14\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 1701492, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e342377c09dbd5fde173be8abcd3741c?s=128&d=identicon&r=PG", "display_name": "Avi.S.", "link": "https://stackoverflow.com/users/1701492/avi-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 975, "favorite_count": 0, "closed_date": 1450422393, "answer_count": 1, "score": -3, "last_activity_date": 1594643064, "creation_date": 1449592532, "last_edit_date": 1594643064, "question_id": 34161176, "link": "https://stackoverflow.com/questions/34161176/how-to-evaluate-math-expression-with-variables-in-vba", "closed_reason": "Needs details or clarity", "title": "how to evaluate math expression with variables in vba?", "body": "<p>Consider the following expression \"x*y+3\".</p>\n\n<p>How can i evaluate this when x &amp; y will be defined by the user in run time. \nThis is for a small data base in access 2013 for my work place.\nthank you. </p>\n"}, {"tags": ["vba", "excel", "email", "groupwise"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1449602275, "post_id": 34160544, "comment_id": 56075191, "body": "It&#39;s not enough to just have the .dll installed, you need to reference it. In the VBA editor, under Tools \\ References, do you have selected <b>GROUPWISE TYPE LIBRARY</b>?"}, {"owner": {"reputation": 67, "user_id": 5080701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89db99b37152e43c415f8df356c2c722?s=128&d=identicon&r=PG&f=1", "display_name": "uofarob", "link": "https://stackoverflow.com/users/5080701/uofarob"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1449611665, "post_id": 34160544, "comment_id": 56080852, "body": "Yes sir, I have it in my reference with a check box &quot;GroupWare type library&quot; location is C:\\Program Files (x86)\\Novell\\GroupWise\\gwcma1.dll"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1449612429, "post_id": 34160544, "comment_id": 56081297, "body": "Is this all of your code? Do you declare other objects?"}, {"owner": {"reputation": 67, "user_id": 5080701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89db99b37152e43c415f8df356c2c722?s=128&d=identicon&r=PG&f=1", "display_name": "uofarob", "link": "https://stackoverflow.com/users/5080701/uofarob"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1449679797, "post_id": 34160544, "comment_id": 56115038, "body": "Just added more to the original text"}, {"owner": {"reputation": 1078, "user_id": 3124273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87d5afe2c849c7123fd07f6ad1349bd2?s=128&d=identicon&r=PG&f=1", "display_name": "cronos2546", "link": "https://stackoverflow.com/users/3124273/cronos2546"}, "edited": false, "score": 0, "creation_date": 1449681228, "post_id": 34160544, "comment_id": 56116004, "body": "In this library <a href=\"https://www.novell.com/documentation/developer/groupwise_sdk/gwsdk_gwobjapi/data/a7qte4k.html\" rel=\"nofollow noreferrer\">novell.com/documentation/developer/groupwise_sdk/gwsdk_gwobj&zwnj;&#8203;api/&hellip;</a>, they reference the application object as application2. Do you not have this version? Also, why don&#39;t you just set the application object to a new application?"}, {"owner": {"reputation": 67, "user_id": 5080701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89db99b37152e43c415f8df356c2c722?s=128&d=identicon&r=PG&f=1", "display_name": "uofarob", "link": "https://stackoverflow.com/users/5080701/uofarob"}, "edited": false, "score": 0, "creation_date": 1449755060, "post_id": 34160544, "comment_id": 56151332, "body": "Added another edit as EDIT 2 to the original so I could get the code to display like I wanted, I appreciate your help immensely!!!"}], "owner": {"reputation": 67, "user_id": 5080701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89db99b37152e43c415f8df356c2c722?s=128&d=identicon&r=PG&f=1", "display_name": "uofarob", "link": "https://stackoverflow.com/users/5080701/uofarob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 975, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1449754992, "creation_date": 1449590784, "last_edit_date": 1449754992, "question_id": 34160544, "link": "https://stackoverflow.com/questions/34160544/vba-groupwise-email", "title": "VBA Groupwise Email", "body": "<p>I'm using Excel 2013, Windows 7, Groupwise 12.</p>\n\n<p>The code should be pretty straight forward, but I keep getting an error</p>\n\n<blockquote>\n  <p>\"Active X component can't create object\"</p>\n</blockquote>\n\n<p>I've made sure the references are there according to the Groupwise's development documents which is simply their \"gwcma1.dll\" and I just can't figure out what is going on.</p>\n\n<p>Theory right now is that Groupwise was installed some way that didn't populate the registry information needed for the code to create the object even though it is in the object browser.</p>\n\n<p>Code:</p>\n\n<pre><code>Dim gwAccount As GroupwareTypeLibrary.Account2\nSet gwApp = CreateObject(\"NovellGroupwareSession\")\n</code></pre>\n\n<p>I've used this code for years on older versions of excel and windows and groupwise, and I can't figure out what has changed.</p>\n\n<p>---EDIT---</p>\n\n<p>Here's the beginning part of the code.  After this is just standard loops and logic that all works.</p>\n\n<p>Here's the first part of it.  After this point, it's just standard loops and and logic.</p>\n\n<pre><code>Sub EmailPDFs()\nDim i, k As Long\nDim PhysicianCount As Long\nDim StartPoint As Long\nDim CurrentNPI As Long\nDim CurrentEmail As String\nDim CurrentFileName As String\nDim CurrentFilePath As String\nDim CurrentDate As String\nDim EmailBody As String\n\n'Declaration for Email\nDim gwMessage As GroupwareTypeLibrary.Message2\nDim gwAccount As GroupwareTypeLibrary.Account2\nDim gwApp As GroupwareTypeLibrary.Application\n\nSet gwApp = CreateObject(\"NovellGroupwareSession\")\nSet gwAccount = gwApp.Login()\n</code></pre>\n\n<p>---EDIT 2---</p>\n\n<p>I tried Application2 and still the same error.  I think I was trying the older one and the properties were the same on the object, but Application2 let you do proxy email access which I wasn't worried about.</p>\n\n<p>For creating a new application, I may need a refresh on the syntax but I'm assuming you're suggesting something like:</p>\n\n<pre><code> Dim xlApp as Excel.Application\n Set xlApp = New Excel.Application             'Early Binding\n Set xlApp = CreateObject(\u201cExcel.Application\u201d) 'Late Binding\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 1, "creation_date": 1449590449, "post_id": 34160339, "comment_id": 56067577, "body": "Where is k used? you are incrementing k twice. once inside the if, and once outside the if."}, {"owner": {"reputation": 75, "user_id": 5606603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85b2b20de9cde8def9234d68724be735?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/5606603/matt"}, "reply_to_user": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 0, "creation_date": 1449591908, "post_id": 34160339, "comment_id": 56068636, "body": "Thank you! That was the error.  I am using k to tell me how many files were checked in the message box which runs at the end."}], "answers": [{"tags": [], "owner": {"reputation": 339, "user_id": 5626469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZonuZ.jpg?s=128&g=1", "display_name": "gazzz0x2z", "link": "https://stackoverflow.com/users/5626469/gazzz0x2z"}, "is_accepted": true, "score": 4, "last_activity_date": 1449590534, "creation_date": 1449590534, "answer_id": 34160438, "question_id": 34160339, "link": "https://stackoverflow.com/questions/34160339/dir-not-functioning-correctly/34160438#34160438", "title": "DIR Not Functioning Correctly", "body": "<pre><code>    k = k + 1\n    MyFile = Dir()\n</code></pre>\n\n<p>That code is duplicated. If your \"If\" just above is true, you are jumping one file. Your loop should be :</p>\n\n<pre><code>Do While MyFile &lt;&gt; \"\"\n    TxtFile = MyFolder &amp; MyFile\n    If FileDateTime(TxtFile) &gt; LastDate Then \n        Open TxtFile For Input As #1 \n        Do Until EOF(1)\n            Line Input #1, textline\n            text = text &amp; textline\n        Loop\n        Close #1\n        Call CommonImportCode 'separate sub which picks out information from the .txt file string and adds it to the table as a new entry\n        t = t + 1\n    End If\n    k = k + 1\n    MyFile = Dir()\nLoop\n</code></pre>\n\n<p>or something approaching.</p>\n"}], "owner": {"reputation": 75, "user_id": 5606603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85b2b20de9cde8def9234d68724be735?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/5606603/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 34160438, "answer_count": 1, "score": 3, "last_activity_date": 1449616363, "creation_date": 1449590248, "last_edit_date": 1449616363, "question_id": 34160339, "link": "https://stackoverflow.com/questions/34160339/dir-not-functioning-correctly", "title": "DIR Not Functioning Correctly", "body": "<p>I am using VBA to import data from .txt files into a table of my spreadsheet which I am using for further pivot charts.  The network directory that I am importing the files from contains ~5500 files and will grow over time at about 2000 files per year currently.  The entries in the table are sorted by date (oldest to newest).  </p>\n\n<p>I have a macro which checks the date of the most recent entry, then uses DIR to search the network location and iterate through the files in that directory.  For each file, if the file is newer than the most recent entry, I want to import the data and add it to the table.  If the file is older, I want DIR to move to the next file.  Below is the code I am currently using.</p>\n\n<pre><code>Sub NewFilesFromNetwork()\n\nDim myDatabase As Worksheet\nSet myDatabase = Sheets(\"Database\")\n\nDim TotalRows As Long, LastDate As Date\n\nTotalRows = myDatabase.ListObjects(\"Table1\").Range.Rows.Count\nLastDate = Cells(TotalRows + 48, 6).Value 'the \"+48\" here is important because there are 48 hidden rows at the top of the spreadsheet before the table starts\n\nDim MyFolder As String, MyFile As String\n\nOn Error Resume Next\nApplication.ScreenUpdating = False\n\nMyFolder = \"*path to my network location*\" \nMyFile = Dir(MyFolder &amp; \"*.txt\")\n\nDim t As Integer, k As Integer\nt = 0 'counter for calculating total files imported\nk = 0 'counter for calculating total files checked\n\nDo While MyFile &lt;&gt; \"\"\n    TxtFile = MyFolder &amp; MyFile\n    If FileDateTime(TxtFile) &gt; LastDate Then \n        Open TxtFile For Input As #1 \n        Do Until EOF(1)\n            Line Input #1, textline\n            text = text &amp; textline\n        Loop\n        Close #1\n        Call CommonImportCode 'separate sub which picks out information from the .txt file string and adds it to the table as a new entry\n        k = k + 1\n        t = t + 1\n        MyFile = Dir()\n    End If\n\n        k = k + 1\n        MyFile = Dir()\nLoop\n\nApplication.ScreenUpdating = True\n\nMsgBox \"Number of files searched = \" &amp; k &amp; vbNewLine &amp; \"Number of files imported = \" &amp; t\n\nEnd Sub\n</code></pre>\n\n<p>The issue I am having is this:  </p>\n\n<p>I can check the network location and see that there are 10 new files. However, the macro only imports 5 of them, and seems to be importing only every other file of the new files.  Is there a reason the macro is skipping files when they meet the conditions of the IF statement?</p>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"reputation": 627, "user_id": 5438128, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d0e061b267311381d8226c3bb60a20c?s=128&d=identicon&r=PG", "display_name": "ebyrob", "link": "https://stackoverflow.com/users/5438128/ebyrob"}, "edited": false, "score": 0, "creation_date": 1449589530, "post_id": 34159987, "comment_id": 56066877, "body": "You might want to <code>While Not rs.EOF</code> instead of <code>Loop Until</code>.  Sorry, test for <code>EOF</code> needs to happen before <code>.MoveFirst</code> per MSDN.  <a href=\"https://msdn.microsoft.com/en-us/library/ms677527%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms677527%28v=vs.85%29.aspx</a>"}, {"owner": {"reputation": 29, "user_id": 5600169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d059a910acbcc4469a5e0a174583f5f2?s=128&d=identicon&r=PG&f=1", "display_name": "Rajat Sharma", "link": "https://stackoverflow.com/users/5600169/rajat-sharma"}, "reply_to_user": {"reputation": 627, "user_id": 5438128, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d0e061b267311381d8226c3bb60a20c?s=128&d=identicon&r=PG", "display_name": "ebyrob", "link": "https://stackoverflow.com/users/5438128/ebyrob"}, "edited": false, "score": 0, "creation_date": 1449593400, "post_id": 34159987, "comment_id": 56069644, "body": "Thanks Guyz, it worked !!!!!1"}], "answers": [{"tags": [], "owner": {"reputation": 30431, "user_id": 1507566, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40b799a199eda9317d64e854c9fc8858?s=128&d=identicon&r=PG", "display_name": "Tab Alleman", "link": "https://stackoverflow.com/users/1507566/tab-alleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1449589571, "creation_date": 1449589571, "answer_id": 34160104, "question_id": 34159987, "link": "https://stackoverflow.com/questions/34159987/error-loading-user-form-when-database-is-blank/34160104#34160104", "title": "Error Loading User form when database is blank", "body": "<p>Pseudocode:  Add <code>\"IF NOT rs.EOF\"</code> before each <code>rs.MoveFirst</code>.</p>\n"}], "owner": {"reputation": 29, "user_id": 5600169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d059a910acbcc4469a5e0a174583f5f2?s=128&d=identicon&r=PG&f=1", "display_name": "Rajat Sharma", "link": "https://stackoverflow.com/users/5600169/rajat-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449589571, "creation_date": 1449589253, "question_id": 34159987, "link": "https://stackoverflow.com/questions/34159987/error-loading-user-form-when-database-is-blank", "title": "Error Loading User form when database is blank", "body": "<p>The database table is blank and I have coded the VBA User Form to load the Customer and User list at Userform_Initialize from the database table.</p>\n\n<p>Now I am getting the EOF_BOF error which is fine since there is no data in the table. And I have to close the user form.</p>\n\n<p>What should I do so that I dont receive an error while database is blank.</p>\n\n<p>Below is the code.</p>\n\n<pre><code>Sql = \"Select DISTINCT [Exec] from tblKPI\"\nSet rs = CreateObject(\"ADODB.Recordset\")\nrs.Open Sql, conn, adOpenStatic\nrs.Movefirst\n    With frmReport.lstUser\n    .Clear\n    Do\n        .AddItem rs![exec]\n        rs.MoveNext\n    Loop Until rs.EOF\nEnd With\n\n\n'update Customers\nSql = \"Select DISTINCT Customer from tblKPI\"\nSet rs = CreateObject(\"ADODB.Recordset\")\nrs.Open Sql, conn, adOpenStatic\nrs.Movefirst\n    With frmReport.Customer\n    .Clear\n    Do\n        .AddItem rs![Customer]\n        rs.MoveNext\n    Loop Until rs.EOF\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5570317, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066451820033206/picture?type=large", "display_name": "Josu&#233; Luna", "link": "https://stackoverflow.com/users/5570317/josu%c3%a9-luna"}, "edited": false, "score": 0, "creation_date": 1449675053, "post_id": 34160044, "comment_id": 56111509, "body": "I meant that i don&#39;t want to have data missing, i&#39;m not really sure on how making the array, and then added to the columns in the order that i want to, i already have the format of the sheet, and the data import is ok, just don&#39;t know how to arrange into the columns the last 3 fields"}], "tags": [], "owner": {"reputation": 1430, "user_id": 3425324, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/805315200/picture?type=large", "display_name": "Schalton", "link": "https://stackoverflow.com/users/3425324/schalton"}, "is_accepted": false, "score": 0, "last_activity_date": 1449589403, "last_edit_date": 1495541714, "creation_date": 1449589403, "answer_id": 34160044, "question_id": 34159780, "link": "https://stackoverflow.com/questions/34159780/access-query-to-excel-sheet-with-proper-column-row-format/34160044#34160044", "title": "Access Query To Excel Sheet With Proper Column &amp; Row Format", "body": "<p>So as far as exporting the data into excel you have several options:</p>\n\n<p>SQL do command:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff844793.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff844793.aspx</a></p>\n\n<p>Same command but in VBA:\n<a href=\"https://stackoverflow.com/questions/16161865/using-excel-vba-to-export-data-to-ms-access-table\">Using Excel VBA to export data to MS Access table</a></p>\n\n<p>You could iterate through the table and create an array then print that array into a spreadsheet</p>\n\n<p>Once you have the data in excel you're just looking at formatting -- adding some filters, changing the text align, ect.. you can use the \"Record Macro\" function to perform those tasks and clean the code.</p>\n\n<p>So I guess for clarification - what do you mean 'affecting your query?'</p>\n"}], "owner": {"reputation": 21, "user_id": 5570317, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066451820033206/picture?type=large", "display_name": "Josu&#233; Luna", "link": "https://stackoverflow.com/users/5570317/josu%c3%a9-luna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1449688842, "creation_date": 1449588673, "last_edit_date": 1449688842, "question_id": 34159780, "link": "https://stackoverflow.com/questions/34159780/access-query-to-excel-sheet-with-proper-column-row-format", "title": "Access Query To Excel Sheet With Proper Column &amp; Row Format", "body": "<p>I already have the query that retrieves me the data in a correct way, this is my code. </p>\n\n<pre><code>Sub Main()\n\nDim sDBPath As String\nsDBPath = \"C:\\Users\\ges\\Documents\\ExploWR.mdb\"\n\nCall Query_Access_to_excel(sDBPath, \"Explo1\", \"SELECT eipl.MOD_CODE, eipl.BOM_KEY, eipl.DIF, eipl.PART_NO, eipl.PART_DESC, eipl.QTY_PER_CAR, eipl.INTERIOR_COLOUR, eipl.EXTERIOR_COLOUR, eipl.SOURCE_CODE, eipl.SHOP_CLASS,\" &amp; _\n   \" eipl.PART_CLASS, eipl.PROCESS_CODE, eipl.OPERATION_NO, eipl.DESIGN_NOTE_NO, eipl.WIP, eipl.PART_ID_CODE, eipl.ADOPT_DATE_Y2K,eipl.ABOLISH_DATE_Y2K, ipo_Modelos.EIM, ipo_Modelos.DEST, ipo_Modelos.MY \" &amp; _\n   \" FROM eipl, explo, ipo_Modelos\" &amp; _\n   \" WHERE explo.MOD_CODE = eipl.MOD_CODE And explo.MY = ipo_Modelos.MY\" &amp; _\n   \" And explo.PLANT = ipo_Modelos.PLANT And eipl.ADOPT_DATE_Y2K &lt;= explo.ADOP \" &amp; _\n   \" And explo.DEST = ipo_Modelos.DEST And explo.EIM = ipo_Modelos.EIM\")\n\nEnd Sub\n\nSub Query_Access_to_excel(sBd As String, sHoja As String, sSQL As String)\n\n     On Error GoTo error_handler\n\n     Dim rs As ADODB.Recordset\n     Dim conn As String\n     Dim Range_Destino As Range  \n\n     Set Range_Destino = ActiveWorkbook.Sheets(sHoja).Cells(6, 1)     \n     conn = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; \"Data Source= \" &amp; sBd &amp; \";\"\n     Set rs = New ADODB.Recordset\n     Call rs.Open(sSQL, conn, adOpenForwardOnly, adLockReadOnly)\n\n     If Not rs.EOF Then\n\n          Range_Destino.Offset(1, 0).CopyFromRecordset rs\n          DoEvents\n\n          MsgBox \"Import Complete\", vbInformation\n     Else\n          MsgBox \"No registers to import\", vbInformation\n     End If\n\n     If Not rs Is Nothing Then\n        If rs.State = adStateOpen Then\n            rs.Close\n        End If\n        Set rs = Nothing\n     End If\n\n     If Not Range_Destino Is Nothing Then\n        Set Range_Destino = Nothing\n     End If\n\n     Exit Sub\nerror_handler:\n     MsgBox Err.Description, vbCritical\nEnd Sub\n</code></pre>\n\n<p>What I want to do is to correctly place the data in the cells, something like this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/SzobI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SzobI.png\" alt=\"enter image description here\"></a></p>\n\n<p>And what I have is something like this.  I want to place the data in the correct cells, I'm talking about the last 3 fields to be properly placed in the columns like the first image. I have no idea how to do this without affecting my query.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0VCZW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0VCZW.png\" alt=\"enter image description here\"></a></p>\n"}]