[{"tags": ["excel", "vba", "if-statement", "macros"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1460591224, "post_id": 36611291, "comment_id": 60819753, "body": "usually this means that Sheet1 does not exist.  Is it named something else?"}, {"owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1460623331, "post_id": 36611291, "comment_id": 60832178, "body": "@ScottCraner I&#39;d post that as an answer mate, definitely looks to be the root cause"}, {"owner": {"reputation": 1, "user_id": 6201324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xlcfK.jpg?s=128&g=1", "display_name": "Seeker of Truth", "link": "https://stackoverflow.com/users/6201324/seeker-of-truth"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1460679393, "post_id": 36611291, "comment_id": 60867339, "body": "Thank you very much  @ScottCraner. Your answer was very helpful. I don&#39;t know why I missed such a small detail. I should get more careful with experience. I am new to VBA programming."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6201324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xlcfK.jpg?s=128&g=1", "display_name": "Seeker of Truth", "link": "https://stackoverflow.com/users/6201324/seeker-of-truth"}, "is_accepted": false, "score": 0, "last_activity_date": 1460679511, "creation_date": 1460679511, "answer_id": 36636247, "question_id": 36611291, "link": "https://stackoverflow.com/questions/36611291/compare-cell-with-a-previous-cell-in-the-column-and-update-the-cell-with-new-val/36636247#36636247", "title": "Compare cell with a previous cell in the column and update the cell with new value based on the difference", "body": "<p>@Scott Craner provided an answer to my question in the comments section. I was using Sheet1 as the sheet name instead of the actual name of the sheet. Should be more careful next time.</p>\n\n<p>Thanks again Scott!</p>\n"}], "owner": {"reputation": 1, "user_id": 6201324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xlcfK.jpg?s=128&g=1", "display_name": "Seeker of Truth", "link": "https://stackoverflow.com/users/6201324/seeker-of-truth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460679511, "creation_date": 1460590100, "last_edit_date": 1460590499, "question_id": 36611291, "link": "https://stackoverflow.com/questions/36611291/compare-cell-with-a-previous-cell-in-the-column-and-update-the-cell-with-new-val", "title": "Compare cell with a previous cell in the column and update the cell with new value based on the difference", "body": "<pre><code>Sub Update_cell()\n\nDim counter As Integer\nFor counter = 7 To 606\n   If Worksheets(\"Sheet1\").Cells(counter + 1, 4).Value &gt; (Worksheets(\"Sheet1\").Cells(counter, 4).Value + Worksheets(\"Sheet1\").Cells(1, 1).Value) Then\n   Worksheets(\"Sheet1\").Cells(counter, 4).Value = (Worksheets(\"Sheet1\").Cells(counter, 4).Value + Worksheets(\"Sheet1\").Cells(1, 1).Value)\n   Worksheets(\"Sheet1\").Cells(counter + 1, 4).Value = Worksheets(\"Sheet1\").Cells(counter + 1, 4).Value - 1 * (Worksheets(\"Sheet1\").Cells(counter + 1, 4).Value - Worksheets(\"Sheet1\").Cells(counter, 4).Value)\n   Worksheets(\"Sheet1\").Cells(counter, 13).Value = -1 * (Worksheets(\"Sheet1\").Cells(counter + 1, 4).Value - Worksheets(\"Sheet1\").Cells(counter, 4).Value)\n   End If\n   If Worksheets(\"Sheet1\").Cells(counter + 1, 4).Value &lt; (Worksheets(\"Sheet1\").Cells(counter, 4).Value - Worksheets(\"Sheet1\").Cells(1, 1).Value) Then\n   Worksheets(\"Sheet1\").Cells(counter, 4).Value = (Worksheets(\"Sheet1\").Cells(counter, 4).Value - Worksheets(\"Sheet1\").Cells(1, 1).Value)\n   Worksheets(\"Sheet1\").Cells(counter + 1, 4).Value = Worksheets(\"Sheet1\").Cells(counter + 1, 4).Value - 1 * (Worksheets(\"Sheet1\").Cells(counter + 1, 4).Value - Worksheets(\"Sheet1\").Cells(counter, 4).Value)\n   Worksheets(\"Sheet1\").Cells(counter, 13).Value = -1 * (Worksheets(\"Sheet1\").Cells(counter + 1, 4).Value - Worksheets(\"Sheet1\").Cells(counter, 4).Value)\n   End If\n   If Worksheets(\"Sheet1\").Cells(counter + 1, 4).Value &lt;= (Worksheets(\"Sheet1\").Cells(counter, 4).Value + Worksheets(\"Sheet1\").Cells(1, 1).Value) And Worksheets(\"Sheet1\").Cells(counter + 1, 4).Value &gt;= (Worksheets(\"Sheet1\").Cells(counter, 4).Value - Worksheets(\"Sheet1\").Cells(1, 1).Value) Then\n   Worksheets(\"Sheet1\").Cells(counter, 4).Value = Worksheets(\"Sheet1\").Cells(counter + 1, 4).Value\n   End If\n   Next counter\nEnd Sub\n</code></pre>\n\n<p>Above is my code which I am using to update a cell based on how far it is from the previous cell. In the beginning, I got an error saying \"The specified dimension is not valid for the current chart type\". I deleted the chart which was already present and now I get the error saying \"Subscript out of range, Runtime error 9\". When I try to debug, it highlights the first If statement.</p>\n\n<p>Any help is highly appreciated. Thank you very much!</p>\n"}, {"tags": ["vba", "if-statement"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "edited": false, "score": 0, "creation_date": 1460591341, "post_id": 36611282, "comment_id": 60819780, "body": "Scott. You have removed the else part which I needed to show both 0 and 1 in the output. I still have not reached to the goal of printing 1 when the statements is true 0 when it is false."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "edited": false, "score": 0, "creation_date": 1460591415, "post_id": 36611282, "comment_id": 60819807, "body": "@Hamidkh no I did not, it is before the inner loop.  Did you try it?"}, {"owner": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "edited": false, "score": 0, "creation_date": 1460591500, "post_id": 36611282, "comment_id": 60819838, "body": "Yes It did. It just gives me 1 not 0 is printed."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "edited": false, "score": 0, "creation_date": 1460591795, "post_id": 36611282, "comment_id": 60819938, "body": "Then every value in column X exist in column U.  Is that not what you wanted, because that is what you are testing with a double loop like this?  It tests the value in X3 against every value in Column U, if found it puts a 1 in Y3, if none is found it puts a 0. Then it moves to X4 and tests that against every value in column U.  If you put the else back in and remove the <code>exit for</code> you are only getting the result of X3 vs. U1002 and you do not need the second loop as it will only return the last iteration of the inside loop.  More explanation may be required."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "edited": false, "score": 0, "creation_date": 1460592250, "post_id": 36611282, "comment_id": 60820056, "body": "@Hamidkh are you trying to test only if X3=U3 and then put 1 or 0 in Y3?"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1460590009, "creation_date": 1460590009, "answer_id": 36611282, "question_id": 36611189, "link": "https://stackoverflow.com/questions/36611189/if-then-else-to-give-0-or-1-vba/36611282#36611282", "title": "If then else to give 0 or 1 - VBA", "body": "<p>You need to exit the for when it is found and move the output outside the inner loop:</p>\n\n<pre><code>For n = 3 To time_frame + 3\n    arr_bed = 0\n    For i = 3 To 1002\n        If (Cells(i, \"U\").Value = Cells(n, \"X\").Value) Then\n            arr_bed = 1\n            Exit For ' admission (HH)\n        End If\n    Next i\n    Cells(n, \"Y\").Value = arr_bed\nNext n\n</code></pre>\n\n<p>Just another note:  You should qualify the sheets(without seeing the rest of the code I do not want to assume how to do this for you).</p>\n"}], "owner": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 36611282, "answer_count": 1, "score": 0, "last_activity_date": 1460590009, "creation_date": 1460589458, "question_id": 36611189, "link": "https://stackoverflow.com/questions/36611189/if-then-else-to-give-0-or-1-vba", "title": "If then else to give 0 or 1 - VBA", "body": "<p>I was wondering why this code does not print 1 at all. I know that 0 are overwriting the arr_bed variable. But, how I can make it distinguishable for the code to have both 0 and 1? Thanks!</p>\n\n<pre><code> For n = 3 To time_frame + 3\n            For i = 3 To 1002\n\n                     If (Cells(i, \"U\").Value = Cells(n, \"X\").Value) Then\n                     arr_bed = 1  ' admission (HH)\n                     Else\n                     arr_bed = 0\n\n                    Cells(n, \"Y\").Value = arr_bed\n                    End If\n                    Next i\n\n                    Next n\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1460589906, "post_id": 36610907, "comment_id": 60819325, "body": "<i>given that this is VBA</i>...I do not see any VBA code, only an SQL query. What is the context you need to run (i.e., form recordsource, combo rowsources, DAO recordsets)?"}], "answers": [{"tags": [], "owner": {"reputation": 5832, "user_id": 4155665, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7IH7Y.png?s=128&g=1", "display_name": "jleach", "link": "https://stackoverflow.com/users/4155665/jleach"}, "is_accepted": false, "score": 0, "last_activity_date": 1460588555, "creation_date": 1460588555, "answer_id": 36611049, "question_id": 36610907, "link": "https://stackoverflow.com/questions/36610907/access-vba-query-parent-table-data-easily/36611049#36611049", "title": "Access VBA - Query Parent Table Data Easily?", "body": "<p>In VBA you build a dynamic query string that results in the SQL string required (including joins, or whatever else you need), then you typically use <code>currentDb.OpenRecordset()</code> to set a recordset variable.  Alternatively, the string can be applied to form and control Recordsource properties.</p>\n\n<p>Here's an (non-working - your joins requirements are clear to me) example using variables for your two strings:</p>\n\n<pre><code>Dim str1 As String\nDim str2 As String\nDim sql As String\n\nstr1 = \"somestring\"\nstr2 = \"someotherstring\"\n\nsql = \"SELECT childField1 \" &amp; _\n      \"FROM childTable1 \" &amp; _\n      \"INNER JOIN parentTable \" &amp; _\n      \"ON childTable.childField = parentTable.ParentField \" &amp; _\n      \"WHERE childField = \"\"\" &amp; str1 &amp; \"\"\" AND \" &amp; _\n      \"  parentField = \"\"\" &amp; str2 &amp; \"\"\";\"\n\nMe.RecordSource = sql\n</code></pre>\n"}], "owner": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1460588555, "creation_date": 1460587725, "question_id": 36610907, "link": "https://stackoverflow.com/questions/36610907/access-vba-query-parent-table-data-easily", "title": "Access VBA - Query Parent Table Data Easily?", "body": "<p>Is there a shortcut way to access fields in a parent table in my query like the below:</p>\n\n<pre><code>SELECT childField1\nFROM childTable\nWHERE childField2 = \"somestring\"\nAND\nWHERE parentField1 = \"someotherstring\" 'parent field is in parentTable\n</code></pre>\n\n<p>My tables are of course keyed correctly with ID fields and a <code>parentField1_ID</code> in the childTable. </p>\n\n<p>I can go the traditional route with some <code>JOIN</code>s, but given that this is VBA i'm wondering if there isn't something easier built in to make this kind of reference. </p>\n"}, {"tags": ["vba", "loops", "conditional", "match", "copy-paste"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1460584745, "post_id": 36610244, "comment_id": 60817332, "body": "Show what code you have and it will help us give you the pointers you need.  Put the code in your original post not the comments or as an answer."}, {"owner": {"reputation": 3433, "user_id": 720934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z1OSE.jpg?s=128&g=1", "display_name": "hoodaticus", "link": "https://stackoverflow.com/users/720934/hoodaticus"}, "edited": false, "score": 0, "creation_date": 1460585890, "post_id": 36610244, "comment_id": 60817833, "body": "Is the row you want to copy to sheet 3 on sheet 1 or sheet 2?"}, {"owner": {"reputation": 3, "user_id": 6201054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c384e1e5e47c9ffe1a00ecf5d05fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Wick", "link": "https://stackoverflow.com/users/6201054/wick"}, "edited": false, "score": 0, "creation_date": 1460738145, "post_id": 36610244, "comment_id": 60898138, "body": "The row I want copy/paste is on sheet 2. I want to paste it on a third sheet."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6201054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c384e1e5e47c9ffe1a00ecf5d05fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Wick", "link": "https://stackoverflow.com/users/6201054/wick"}, "edited": false, "score": 0, "creation_date": 1460737062, "post_id": 36610454, "comment_id": 60897467, "body": "Thank you very much, this is pretty comprehensive. Could you maybe just explain quickly what vbnullstring represents here? I interpreted it as being (referencing my original question) the &quot;salesperson&quot;?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 3, "user_id": 6201054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c384e1e5e47c9ffe1a00ecf5d05fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Wick", "link": "https://stackoverflow.com/users/6201054/wick"}, "edited": false, "score": 0, "creation_date": 1460737762, "post_id": 36610454, "comment_id": 60897928, "body": "vbNullString is the built in function/keyword that VBA recognizes as NULL. It&#39;s more efficient to use vbNullString as opposed to &quot;&quot; to reference blanks. I just make it a habit to use it always when possible in regards to blank. Basically, its says if cell(i), the current cell in the loop, is not blank, then execute code"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 3, "user_id": 6201054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c384e1e5e47c9ffe1a00ecf5d05fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Wick", "link": "https://stackoverflow.com/users/6201054/wick"}, "edited": false, "score": 0, "creation_date": 1460932576, "post_id": 36610454, "comment_id": 60955573, "body": "@Wick does this answer your question? If so please mark an answer or ask for more :)"}, {"owner": {"reputation": 3, "user_id": 6201054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c384e1e5e47c9ffe1a00ecf5d05fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Wick", "link": "https://stackoverflow.com/users/6201054/wick"}, "edited": false, "score": 0, "creation_date": 1460977361, "post_id": 36610454, "comment_id": 60972433, "body": "Doug - still working on a final product, but yes, it definitely helped move me in the right direction! thanks!"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 0, "last_activity_date": 1460585682, "last_edit_date": 1460585682, "creation_date": 1460585367, "answer_id": 36610454, "question_id": 36610244, "link": "https://stackoverflow.com/questions/36610244/how-do-i-choose-certain-values-in-one-column-based-on-another-to-match-with-a/36610454#36610454", "title": "How do I choose certain values in one column (based on another) to match with a column in another sheet, for the purpose of copy-paste?", "body": "<pre><code>for i = FirstRowA to LastRowA 'leaving you to figure out how to find these values\n     If cell(i) &lt;&gt; vbNullString Then\n          for h = FirstRowB to LastRowB 'again for you to figure out\n               If cell(h) = cell(i) Then \n                    cell(h).copy\n                    Sheet2.Cells(Sheet2.Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n                    Sheet2.Cells(Sheet2.Rows.Count, 1).End(xlUp).Offset(0, 1).value = \"Column b\"\n               End If\n          Next h\n\n          for j = FirstRowC to LastRowC 'again you figure this out\n               If cell(j) = cell(i) Then \n                    cell(j).copy\n                    Sheet2.Cells(Sheet2.Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n                    Sheet2.Cells(Sheet2.Rows.Count, 1).End(xlUp).Offset(0, 1).value = \"column c\"\n               end if\n          Next j\n      end if\nnext i\n</code></pre>\n\n<p>there might be some syntax issues here, but I have basically given you the loop you asked for. This just get you to the point where you can figure the rest out on your own with ease. </p>\n"}], "owner": {"reputation": 3, "user_id": 6201054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c384e1e5e47c9ffe1a00ecf5d05fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Wick", "link": "https://stackoverflow.com/users/6201054/wick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 0, "accepted_answer_id": 36610454, "answer_count": 1, "score": 0, "last_activity_date": 1489962568, "creation_date": 1460584320, "last_edit_date": 1489962568, "question_id": 36610244, "link": "https://stackoverflow.com/questions/36610244/how-do-i-choose-certain-values-in-one-column-based-on-another-to-match-with-a", "title": "How do I choose certain values in one column (based on another) to match with a column in another sheet, for the purpose of copy-paste?", "body": "<p>I am trying to loop through a list of salespeople (column A) and clients (columns B and C) in \"Sheet1\".</p>\n\n<p>I want to go through column A of \"Sheet1\", and based on salesperson, refer to columns B &amp; C (within the range of that salesperson), and compare it with column A in \"Sheet2\". If the values in columns B or C from \"Sheet1\" match a value in column A of \"Sheet2\", I want to copy that entire row, and paste it in a new \"Sheet3\".</p>\n\n<p>I have been working with loops &amp; conditionals, have figured out how to copy and paste based on condition from another sheet, but am struggling with the link between specifying columns B &amp; C, based on column A from \"Sheet1\", and then matching those to column A of \"Sheet2\".</p>\n\n<p>I can find something in a sheet and copy and paste to another sheet, but it is just a small part of what I want to do:</p>\n\n<pre><code>Sub CopyCode()\n\nDim r As Long, endrow As Long, pasterowindex As Long\n\nendrow = Worksheets(\"sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n  pasterowindex = 1\n\nFor r = 1 To endrow 'Loop through sheet1 and search for your criteria\n\n    'Central CODE:\n    If Worksheets(\"sheet2\").Cells(r, Columns(\"A\").Column).Value = \"CLIENT\" Then\n        'get all value(s) in range of column d  (and c eventually) \n        ' and see if they match values in column A of Readership paste\n        'if they do match values in column A of readership paste,\n        ' then copy that matched row into a new sheet\n        ' (will be designated by salesperson)\n\n        'Copy the current row\n        Rows(r).Select\n        Selection.Copy\n\n        'Switch to the sheet where you want to paste it &amp; paste\n        Sheets(\"Sheet3\").Select\n        Rows(pasterowindex).Select\n        ActiveSheet.Paste\n\n        'Next time you find a match, it will be pasted in a new row\n        pasterowindex = pasterowindex + 1\n\n        'Switch back to your table &amp; continue to search for your criteria\n        Sheets(\"sheet2\").Select\n    End If\n\nNext r\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 120, "user_id": 5228994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHICl.png?s=128&g=1", "display_name": "Jhony Donosso Gutierrez", "link": "https://stackoverflow.com/users/5228994/jhony-donosso-gutierrez"}, "is_accepted": false, "score": 0, "last_activity_date": 1460585017, "creation_date": 1460585017, "answer_id": 36610400, "question_id": 36609942, "link": "https://stackoverflow.com/questions/36609942/delete-multiple-rows-based-on-cell-value/36610400#36610400", "title": "Delete Multiple Rows Based On Cell Value", "body": "<p>try it!, just copy and paste this code on new sub VBA, when cell F8 is >100, delete rows 5,6,7 &amp;8</p>\n\n<pre><code>Sub delete()\n\nIf Range(\"F8\").Value &gt; 100 Then\n    Rows(\"5:8\").delete Shift:=xlUp\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/d7C8a.jpg\" rel=\"nofollow\">Value cell F8</a></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6201052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nv8BtaWvMxc/AAAAAAAAAAI/AAAAAAAAB4s/XgQdjUuM0Rw/photo.jpg?sz=128", "display_name": "bane0830", "link": "https://stackoverflow.com/users/6201052/bane0830"}, "edited": false, "score": 0, "creation_date": 1460651901, "post_id": 36628543, "comment_id": 60853920, "body": "This works near perfect. The only problem I have run into is I have to run it 3 or 4 times to get all the values. Might you know why? Also, thank you for the link. I am going to start reviewing it."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1460650485, "creation_date": 1460650485, "answer_id": 36628543, "question_id": 36609942, "link": "https://stackoverflow.com/questions/36609942/delete-multiple-rows-based-on-cell-value/36628543#36628543", "title": "Delete Multiple Rows Based On Cell Value", "body": "<p>maybe you want to start from something like follows</p>\n\n<pre><code>Option Explicit\n\nSub Delete4PreceedingRows()\n\nDim cellsToCheck As Range, cell As Range\n\nSet cellsToCheck = ActiveSheet.Range(\"F1:F100\") '&lt;== set here the range address you want to scan\nFor Each cell In cellsToCheck\n    If cell.value &gt; 100 Then cell.EntireRow.Offset(-3).Resize(4).delete Shift:=xlUp\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>where <code>Offset()</code> and <code>Resize()</code> are to very useful methods of Excel <code>Range</code> object you may want to begin studying Excel VBA from (see <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff838238.aspx</a>)</p>\n"}], "owner": {"reputation": 3, "user_id": 6201052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nv8BtaWvMxc/AAAAAAAAAAI/AAAAAAAAB4s/XgQdjUuM0Rw/photo.jpg?sz=128", "display_name": "bane0830", "link": "https://stackoverflow.com/users/6201052/bane0830"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 0, "accepted_answer_id": 36628543, "answer_count": 2, "score": 0, "last_activity_date": 1460650485, "creation_date": 1460583086, "question_id": 36609942, "link": "https://stackoverflow.com/questions/36609942/delete-multiple-rows-based-on-cell-value", "title": "Delete Multiple Rows Based On Cell Value", "body": "<p>Trying to come up with macros to clean up a report I am working on. </p>\n\n<p>I would like to delete multiple rows based on one cell value. So if cell F8 contains a value greater than 100, then I'd like to delete entirety of row 8, 7, 6 &amp; 5. </p>\n\n<p>A bit of a VBA Excel newbie here. Any help would be greatly appreciated.</p>\n"}, {"tags": ["c#", "vba"], "comments": [{"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1460579617, "post_id": 36608982, "comment_id": 60814712, "body": "I suspect you have different <code>SavingsAccount</code> instances and are not updating the same one.  I don;t see anything in the code you post that would change <code>AccountBalance</code> from 0."}, {"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1460579627, "post_id": 36608982, "comment_id": 60814716, "body": "Yoiu need to post the code for <code>SavingsAccount</code>, as that is probably where the issue lies.   At a guess, you&#39;re probably not providing values for the properties in <code>SavingsAccount</code>."}, {"owner": {"reputation": 65, "user_id": 6200744, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/15127bf59153d608f1826519ef5c4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "R. Schiff", "link": "https://stackoverflow.com/users/6200744/r-schiff"}, "edited": false, "score": 0, "creation_date": 1460581502, "post_id": 36608982, "comment_id": 60815737, "body": "@ Tim and D Stanley, true, I do not have a value provided under the SavingsAccount class (but I do under the Account class and the SavingsAccount class is derived from the Account class). When I retrieve it directly from the Account class it still returns that accountBalance is 0, despite under the Account class the accountBalance is assigned under an amount (based on the amount I&#39;ve deposited). Is there a way to check which particular instance of accountBalance I am using? (besides hovering over it in Visual Studio)."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460582697, "post_id": 36608982, "comment_id": 60816353, "body": "Are you instantiating InterestForm passing a value as accountBalance?"}, {"owner": {"reputation": 65, "user_id": 6200744, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/15127bf59153d608f1826519ef5c4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "R. Schiff", "link": "https://stackoverflow.com/users/6200744/r-schiff"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460582919, "post_id": 36608982, "comment_id": 60816455, "body": "@user3598756 I&#39;m not sure what you mean.. Do you mean this---&gt;        public InterestForm(double accountBalance)         {             accountBalance = savingsAccount.AccountBalance;             InitializeComponent();         }"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1460583009, "post_id": 36608982, "comment_id": 60816492, "body": "@R.Schiff just because a class derives from another doesn&#39;t mean that every instance of that class included the same data as a parent instance.  If you have not covered instances in class but you&#39;re expected to share data between multiple forms then I suggest you get some guidance from your professor. There are ways to do it but you need to follow the curriculum you have been given so you do not jump ahead or fall behind the class."}, {"owner": {"reputation": 65, "user_id": 6200744, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/15127bf59153d608f1826519ef5c4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "R. Schiff", "link": "https://stackoverflow.com/users/6200744/r-schiff"}, "edited": false, "score": 0, "creation_date": 1460583317, "post_id": 36608982, "comment_id": 60816662, "body": "@D Stanley, do you mean the protection level (private vs. public vs. protected), which I&#39;ve fussed around with these a bit? As for a curriculum, there really isn&#39;t clear guidelines, we switched books halfway through the semester to Programming C# by O&#39;Reilly. Up until now, most of our classes have been very straightforward. This is the first class using an actual programming language (as opposed to using Access v Excel). I&#39;m open to any suggestions. If you have a recommended resource, I would appreciate that."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460583814, "post_id": 36608982, "comment_id": 60816926, "body": "I mean that somewhere in your code a class must be instantiating InterestForm class. Is it doing by means of some &quot;InterestForm myInterestForm = new InterestForm(10000)&quot;?"}, {"owner": {"reputation": 65, "user_id": 6200744, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/15127bf59153d608f1826519ef5c4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "R. Schiff", "link": "https://stackoverflow.com/users/6200744/r-schiff"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460584049, "post_id": 36608982, "comment_id": 60817039, "body": "@user3598756 Thank you. Would this code go in the Account class?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460584434, "post_id": 36608982, "comment_id": 60817199, "body": "It should go where it already must be otherwise you wouldn&#39;t see any InterestForm show when you run your code. You can have VS help ypu searching all the occurrences of the InterestForm class: I&#39;m not by any PC but you should place the cursor in any occurrence of InterestForm, right-clicking and choosing some &quot;find all occurrences&quot; or the likes"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1460580903, "post_id": 36609074, "comment_id": 60815399, "body": "The designer <i>requires</i> a parameterless constructor that calls <code>InitializeComponent()</code> - it&#39;s probably better to chain the parameterized one and leave a parameterless constructor for the designer. Otherwise, this code breaks the designer."}, {"owner": {"reputation": 65, "user_id": 6200744, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/15127bf59153d608f1826519ef5c4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "R. Schiff", "link": "https://stackoverflow.com/users/6200744/r-schiff"}, "edited": false, "score": 0, "creation_date": 1460581048, "post_id": 36609074, "comment_id": 60815469, "body": "@nikhilvartak Thank you. However, this is still returning a 0 amount."}, {"owner": {"reputation": 4480, "user_id": 1440057, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/TBIqJ.jpg?s=128&g=1", "display_name": "Nikhil Vartak", "link": "https://stackoverflow.com/users/1440057/nikhil-vartak"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1460581263, "post_id": 36609074, "comment_id": 60815582, "body": "@Mat&#39;sMug I have updated code to call default constructor"}, {"owner": {"reputation": 4480, "user_id": 1440057, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/TBIqJ.jpg?s=128&g=1", "display_name": "Nikhil Vartak", "link": "https://stackoverflow.com/users/1440057/nikhil-vartak"}, "reply_to_user": {"reputation": 65, "user_id": 6200744, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/15127bf59153d608f1826519ef5c4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "R. Schiff", "link": "https://stackoverflow.com/users/6200744/r-schiff"}, "edited": false, "score": 0, "creation_date": 1460581436, "post_id": 36609074, "comment_id": 60815684, "body": "@R.Schiff Is this working for you? I don&#39;t see any reason why it would not work."}, {"owner": {"reputation": 65, "user_id": 6200744, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/15127bf59153d608f1826519ef5c4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "R. Schiff", "link": "https://stackoverflow.com/users/6200744/r-schiff"}, "edited": false, "score": 0, "creation_date": 1460581695, "post_id": 36609074, "comment_id": 60815829, "body": "@nikhilvartak It&#39;s not. :( I&#39;m really not sure what I&#39;m doing wrong. I&#39;ve been at this for a few days and I&#39;ve restarted a few times. Would it help to post the code from the SavingsAccount class and the Account class?"}], "tags": [], "owner": {"reputation": 4480, "user_id": 1440057, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/TBIqJ.jpg?s=128&g=1", "display_name": "Nikhil Vartak", "link": "https://stackoverflow.com/users/1440057/nikhil-vartak"}, "is_accepted": true, "score": 3, "last_activity_date": 1460581219, "last_edit_date": 1460581219, "creation_date": 1460579686, "answer_id": 36609074, "question_id": 36608982, "link": "https://stackoverflow.com/questions/36608982/why-is-my-reference-to-accountbalance-returning-a-0-amount/36609074#36609074", "title": "Why is my reference to AccountBalance returning a 0 amount?", "body": "<p>Change your <code>InterestForm</code> constructor to:</p>\n\n<pre><code>public InterestForm(double accountBalance) : this()\n{\n   savingsAccount.AccountBalance = accountBalance; \n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 6200744, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/15127bf59153d608f1826519ef5c4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "R. Schiff", "link": "https://stackoverflow.com/users/6200744/r-schiff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 36609074, "answer_count": 1, "score": 1, "last_activity_date": 1460581219, "creation_date": 1460579402, "last_edit_date": 1460579584, "question_id": 36608982, "link": "https://stackoverflow.com/questions/36608982/why-is-my-reference-to-accountbalance-returning-a-0-amount", "title": "Why is my reference to AccountBalance returning a 0 amount?", "body": "<p>I'm brand new to C# and am struggling with a program I am trying to create. I hope I can ask this question to the best of my ability. Per my assignment, we are creating a Windows Form in Visual Basic that creates an account. For the purpose of my question, I have an <code>Account</code> class, a Savings Account class (that is derived from the <code>Account</code> class), I have four forms, I have a <code>AccountForm</code> (that is the main form which displays the account number and the account amount using a string method). I have an estimate interest form, that needs to take the current <code>AccountBalance</code> from the account class (or savings account class, not sure which) and take user entered rate and term (which is collected from the <code>InterestForm</code>) to calculate an estimated interest. Right now, my <code>AccountBalance</code> on my <code>InterestForm</code> is returning 0 and I'm not sure why. Here is my code for the <code>InterestForm</code>.</p>\n\n<pre><code>namespace Assignment_6_third_attempt\n{\n    public partial class InterestForm : Form\n    {\n\n        private SavingsAccount savingsAccount = new SavingsAccount();\n        //private double accountBalance;\n\n\n        public InterestForm()\n        {\n            InitializeComponent();\n        }\n\n\n        public InterestForm(double accountBalance)\n        {\n            accountBalance = savingsAccount.AccountBalance;\n            InitializeComponent();\n        }\n\n\n        private void addInterestButton_Click(object sender, EventArgs e)\n        {\n            CalculateInterest();\n            // this.Close();\n        }\n\n        public void CalculateInterest()\n        {\n            //A = P(1 + rt)\n            double accountBalance = savingsAccount.AccountBalance;\n            double interestRate = double.Parse(interestUpDown.Text);\n            double term = double.Parse(termUpDown.Text);\n            double estimateInterest = (accountBalance * (1 + (interestRate * term)));\n            estimateTextBox.Text = estimateInterest.ToString(\"C\");\n        }\n\n    }\n}\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1460580276, "post_id": 36608796, "comment_id": 60815070, "body": "<code>arr</code> is a range, not a variant, <code>varr</code> is a range as well, these need to be set as ranges."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1460580585, "post_id": 36608796, "comment_id": 60815236, "body": "I highly recommend reading through <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using <code>.Active</code>/`.Select</a>, as it can alleviate some headaches and is also a great way to learn, and to tighten code up and avoid any potential errors."}, {"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "edited": false, "score": 0, "creation_date": 1461753528, "post_id": 36608796, "comment_id": 61339050, "body": "What&#39;s the data volume? If it&#39;s a few hundred, I&#39;d do it in COUNTIF() formulas; a few thousand, and I&#39;d pass one array variant from each range into some VBA; more than ten thousand, and I&#39;d do it with SQL from VBA. If it&#39;s more than sixty-five thousand and you&#39;re doing it regularly, I&#39;d do it in SQL Server rather than on the desktop in Excel."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6169056, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TnyT07WqYBs/AAAAAAAAAAI/AAAAAAAAAAA/IEf_d5tz2FA/photo.jpg?sz=128", "display_name": "HorseDog", "link": "https://stackoverflow.com/users/6169056/horsedog"}, "is_accepted": false, "score": 0, "last_activity_date": 1460580910, "creation_date": 1460580910, "answer_id": 36609399, "question_id": 36608796, "link": "https://stackoverflow.com/questions/36608796/exact-comparison-of-string-column-between-2-worksheets-excel-vba/36609399#36609399", "title": "Exact comparison of string column between 2 worksheets excel vba", "body": "<p>You can specify the worksheet that the range is referencing within the Range variable.</p>\n\n<pre><code>Sub Match()\n\n'Call Concatenate\n\nApplication.ScreenUpdating = False\n\nDim stNow As String\nstNow = Now\n\nDim arr As Range\nSet arr = Worksheets(\"StrategyIn\").Range(\"A2:A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Value\n\n\nDim varr As Range\nSet varr = Worksheets(\"Contractor\").Range(\"E2:E\" &amp; Range(\"E\" &amp; Rows.Count).End(xlUp).Row).Value\n\n\nDim temp As Double\ntemp = 0\n\nWith Worksheets(\"StrategyIn\")\nlastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\nWorksheets(\"Contractor\").Select\nDim x, y, Match As Boolean\n\nFor Each x In arr\n\n    Match = False\n        For Each y In varr\n            If x = y Then Match = True\nNext y\n\n    If Not Match Then\n        temp = temp + 1\n    End If\n\nNext\n   'temp = (temp / lastrow) * 100\n\nMsgBox \"Percentage difference = \" &amp; temp &amp; \"%\"\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1461728970, "last_edit_date": 1461728970, "creation_date": 1461728387, "answer_id": 36879835, "question_id": 36608796, "link": "https://stackoverflow.com/questions/36608796/exact-comparison-of-string-column-between-2-worksheets-excel-vba/36879835#36879835", "title": "Exact comparison of string column between 2 worksheets excel vba", "body": "<p>Not sure why you used Range A in code for <strong>StrategIn</strong>. You can make use of <a href=\"https://msdn.microsoft.com/en-us/library/system.collections.arraylist.aspx\" rel=\"nofollow\">.NET's Collection ArrayList</a> for fast check in item found in array.</p>\n\n<p>Below code will be suitable for your use, it's okay if you have very large data set in both columns. I changed the final display of the differences in <strong><em>Immediate Window</em></strong> instead of <strong>MsgBox</strong> for table like output.</p>\n\n<pre><code>Option Explicit\n\nSub ShowDifferences()\n    Dim aColB As Variant, aColE As Variant ' Memory allocations for the range values\n    Dim oItem As Variant\n    Dim oListB As Object, oListE As Object, oTemp As Object ' Arraylist Objects from .NET\n\n    ' Create Collections from .NET\n    Set oListB = CreateObject(\"System.Collections.ArrayList\")\n    Set oListE = CreateObject(\"System.Collections.ArrayList\")\n    Set oTemp = CreateObject(\"System.Collections.ArrayList\")\n\n    ' Load the ranges into memory array\n    With ThisWorkbook.Worksheets(\"StrategyIn\")\n        aColB = .Range(\"B2:B\" &amp; .Range(\"B\" &amp; Rows.Count).End(xlUp).Row).Value\n    End With\n    With ThisWorkbook.Worksheets(\"Contractor\")\n        aColE = .Range(\"E2:E\" &amp; .Range(\"E\" &amp; Rows.Count).End(xlUp).Row).Value\n    End With\n\n    ' Add these data to the ArrayList\n    For Each oItem In aColB\n        If Not oListB.Contains(oItem) Then oListB.Add oItem\n    Next\n    For Each oItem In aColE\n        If Not oListE.Contains(oItem) Then oListE.Add oItem\n    Next\n\n    ' Free memory of Range values\n    Set aColB = Nothing\n    Set aColE = Nothing\n\n    ' Compare the differences (different if each B not found in E)\n    For Each oItem In oListB\n        If Not oListE.Contains(oItem) Then oTemp.Add oItem\n    Next\n\n    ' Display the result\n    Debug.Print \"B-items\", \"E-items\", \"Differences (#Diff/#B)\"\n    Debug.Print oListB.Count, oListE.Count, oTemp.Count &amp; Format(oTemp.Count / oListB.Count, \" (0%) \") &amp; Join(oTemp.ToArray, \"|\")\n\n    ' CleanUp\n    oListB.Clear\n    oListE.Clear\n    oTemp.Clear\n    Set oListB = Nothing\n    Set oListE = Nothing\n    Set oTemp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "is_accepted": false, "score": 0, "last_activity_date": 1461751221, "last_edit_date": 1461751221, "creation_date": 1461747394, "answer_id": 36884960, "question_id": 36608796, "link": "https://stackoverflow.com/questions/36608796/exact-comparison-of-string-column-between-2-worksheets-excel-vba/36884960#36884960", "title": "Exact comparison of string column between 2 worksheets excel vba", "body": "<p>I have tried a different solution, it worked on my data. But I am not sure if that is exactly what you want.</p>\n\n<pre><code>Sub mismatch()\n\nDim Lastrow_StrategyIn As Integer, temp As Integer\nDim strg As Worksheet, contr As Worksheet\n\nSet strg = Worksheets(\"StrategyIn\")\nSet contr = Worksheets(\"Contractor\")\n\nLastrow_StrategyIn = strg.Range(\"A65555\").End(3).Row\n\n\nFor i = 2 To Lastrow_StrategyIn\n    strg.Cells(i, 2) = Application.IfError(Application.VLookup(strg.Cells(i, 1), contr.Range(\"A:A\"), 1, 0), \"\")\n    If strg.Cells(i, 2) = \"\" Then\n        temp = temp + 1\n    End If\n\nNext\nMsgBox (temp / (Lastrow_StrategyIn - 1)) * 100 &amp; \"%\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 531, "user_id": 1946796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vd55i.jpg?s=128&g=1", "display_name": "Rafa Barragan", "link": "https://stackoverflow.com/users/1946796/rafa-barragan"}, "is_accepted": false, "score": 1, "last_activity_date": 1461778462, "creation_date": 1461778462, "answer_id": 36896975, "question_id": 36608796, "link": "https://stackoverflow.com/questions/36608796/exact-comparison-of-string-column-between-2-worksheets-excel-vba/36896975#36896975", "title": "Exact comparison of string column between 2 worksheets excel vba", "body": "<h1>Sub to Match</h1>\n\n<pre><code>Sub Match()  \n\nDim WksS as Range, WksC as Range\nDim stNow as String\nDim rSI as Range, rCon as Range\nDim iLR as Integer, iTemp as Variant, vVal as Variant\n\nSet WksS = Worksheets(\"StrategyIn\")\nSet WksC = Worksheets(\"Contractor\")\nSet rSI = WksS.Range(\"A2\", WksS.Range(\"A2\").End(xlDown))\nSet rCon = WksC.Range(\"E2\", WksC.Range(\"E2\").End(xlDown))\nstNow = Now()\n\niLR = WksC.Range(\"A2\").End(xlDown).Row '' \"lastrow\"\niTemp = 0\n\n'' Because is only one column you dont need to create an array\nFor Each vVal in rCon \n    iTemp = iTemp + IIF(Fun_Val(vVal,rCon),1,0)\nNext vVal\n\niTemp = (iTemp/iLR)*100\n\nMsgBox \"Percentage difference = \" &amp; temp &amp; \"%\"\n\nExit Sub\n</code></pre>\n\n<h1>Function to Validate</h1>\n\n<pre><code>Function Fun_Val(dVal As Double, rRange As Range) As Boolean  \n\nOn Error GoTo errHdlr  \n\n    Fun_Val = IsNumeric(Application.WorksheetFunction.Match(dVal, rRange, 0))  \n\n    Exit Function  \n    errHdlr:  \n    Fun_Val = False  \n\nEnd Function\n</code></pre>\n\n<p><em>BTW you should consider change the way you set variables.</em></p>\n\n<ol>\n<li>Ranges<br>\n<code>arr = Range(\"B2:B\" &amp; Range(\"B\"&amp;Rows.Count).End(xlUp).Row).Value</code>  to<br>\n<code>arr = Range(\"B2\", Range(\"B2\").End(xlDown))</code>  </li>\n<li>Declaration<br>\n<code>Dim x, y, Match As Boolean</code> to<br>\n<code>Dim x as Variant, y as Variant, Match As Boolean</code>  </li>\n<li>Worksheets<br>\n<code>Worksheets(\"StrategyIn\")</code><br>\nto<br>\n<code>Dim Wks as Worksheet</code><br>\n<code>Set Wks = Worksheets(\"StrategyIn\")</code><br>\n<em>this way you could avoid errors between Worksheets</em></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 0, "last_activity_date": 1461913421, "last_edit_date": 1461913421, "creation_date": 1461913061, "answer_id": 36931552, "question_id": 36608796, "link": "https://stackoverflow.com/questions/36608796/exact-comparison-of-string-column-between-2-worksheets-excel-vba/36931552#36931552", "title": "Exact comparison of string column between 2 worksheets excel vba", "body": "<p>Hope this will work for you.</p>\n\n<pre><code>Sub Main()\n    Dim match As Boolean\n    Dim temp As Long\n    Dim blankcount As Long\n    Dim lastrowS As Long\n    Dim lastrowC As Long\n    match = False\n    lastrowS = Worksheets(\"StrategyIn\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    lastrowC = Worksheets(\"Contractor\").Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n    With Worksheets(\"StrategyIn\")\n        For i = 2 To lastrowS\n            If .Range(\"B\" &amp; i).Value &lt;&gt; \"\" Then\n                For j = 2 To lastrowC\n                    If .Range(\"B\" &amp; i).Value = Worksheets(\"Contractor\").Range(\"E\" &amp; j).Value Then\n                        match = True\n                    End If\n                Next j\n            Else\n                blankcount = blankcount + 1\n            End If\n            If match = False Then\n                temp = temp + 1\n            Else\n                match = False\n            End If\n        Next i\n    End With\n    MsgBox \"Number of names that do not match = \" &amp; (temp - blankcount)\nEnd Sub\n</code></pre>\n\n<p><strong>Proof of Work</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/nXnru.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nXnru.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 253, "user_id": 1168160, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/75c746005702f67c78c0b0f916e95e88?s=128&d=identicon&r=PG", "display_name": "Mjall2", "link": "https://stackoverflow.com/users/1168160/mjall2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 1, "accepted_answer_id": 36931552, "answer_count": 5, "score": 0, "last_activity_date": 1461913421, "creation_date": 1460578752, "last_edit_date": 1461876654, "question_id": 36608796, "link": "https://stackoverflow.com/questions/36608796/exact-comparison-of-string-column-between-2-worksheets-excel-vba", "title": "Exact comparison of string column between 2 worksheets excel vba", "body": "<p>FOR SOME REASON IM NOT ABLE TO COMMENT.\nThe answers below all gave me a variety of errors from activex cannot create object to object undefined.</p>\n\n<p>This is my code. </p>\n\n<pre><code>Sub Main()\nApplication.ScreenUpdating = False\n\nDim stNow As String\nstNow = Now\n\n\nSet sh1 = ThisWorkbook.Worksheets(\"StrategyIn\")\nSet sh2 = ThisWorkbook.Worksheets(\"Contractor\")\n\nDim arr As Variant\narr = sh1.Range(\"B2:B\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row).Value\n\n\n\nDim varr As Variant\nvarr = sh2.Range(\"E2:E\" &amp; Range(\"E\" &amp; Rows.Count).End(xlUp).Row).Value\n\n\nDim temp As Integer\ntemp = 0\n\n\nDim x As Variant, y As Variant, Match As Boolean\nFor Each x In arr\n    Match = False\n    For Each y In varr\n        If x = y Then Match = True\n    Next y\n    If Not Match Then\n    temp = temp + 1\n    End If\nNext\n\nMsgBox \"Number of names that do not match = \" &amp; temp\n    'Debug.Print DateDiff(\"s\", stNow, Now)\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>It works when I remove the reference to other worksheets to get the range, works perfectly when I am in one sheet and data is all gathered in one sheet.\nThere is a logical error which results in me getting a number of names that do no match as = 1.\nThanks for your help!</p>\n"}, {"tags": ["vba", "excel", "oledb", "adodb"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1460603376, "post_id": 36608715, "comment_id": 60823085, "body": "What is the error when it fails?"}, {"owner": {"reputation": 61, "user_id": 6027208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a44c42e7bfc99445d008da700f987440?s=128&d=identicon&r=PG&f=1", "display_name": "ex-expat", "link": "https://stackoverflow.com/users/6027208/ex-expat"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1460606188, "post_id": 36608715, "comment_id": 60823858, "body": "Thanks for the response. It returns the &quot;No records found&quot; message box, but that can&#39;t be right as the code has worked successfully on the exact same file."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1460639308, "post_id": 36608715, "comment_id": 60844051, "body": "Change your if/then logic from using BOF and EOF to recordcount: <code>If ORS.recordcount &gt; 0 Then</code>."}, {"owner": {"reputation": 61, "user_id": 6027208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a44c42e7bfc99445d008da700f987440?s=128&d=identicon&r=PG&f=1", "display_name": "ex-expat", "link": "https://stackoverflow.com/users/6027208/ex-expat"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1460647967, "post_id": 36608715, "comment_id": 60851363, "body": "Thanks. I tried like you said, but no luck. I also tried removing the if/then entirely, and the Recordset comes back as blank."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1460657587, "post_id": 36608715, "comment_id": 60857115, "body": "Can your provide sample data of the <code>[Natural Detail $]</code> worksheet with headers for a reproducible example? Simply copy and paste from worksheet into SO with code formatting {}."}, {"owner": {"reputation": 61, "user_id": 6027208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a44c42e7bfc99445d008da700f987440?s=128&d=identicon&r=PG&f=1", "display_name": "ex-expat", "link": "https://stackoverflow.com/users/6027208/ex-expat"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1460670555, "post_id": 36608715, "comment_id": 60864357, "body": "I added a sample to the above post - is that acceptable? I changed the data values for confidentiality reasons. In case I was not clear in my initial post, the code above works every time on my computer with Excel 2013. The only way I have gotten the code to work on the computer with Excel 2010 is by opening it and auto-fitting the columns, though that may be entirely coincidental."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1460671365, "post_id": 36608715, "comment_id": 60864744, "body": "Your query points to F fields. Why not use actual headers such as <code>SELECT Company, Code, Group, RES FROM [Natural Detail $]</code>? And with the Company Name/Info lines does data begin at a certain row?"}, {"owner": {"reputation": 61, "user_id": 6027208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a44c42e7bfc99445d008da700f987440?s=128&d=identicon&r=PG&f=1", "display_name": "ex-expat", "link": "https://stackoverflow.com/users/6027208/ex-expat"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1460671984, "post_id": 36608715, "comment_id": 60864970, "body": "To be honest, I just assumed that since the headers were not on the first row that I should use the F fields. As for the company info, etc. I believe it will always be on rows 2, 4, 6, and 8."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 6027208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a44c42e7bfc99445d008da700f987440?s=128&d=identicon&r=PG&f=1", "display_name": "ex-expat", "link": "https://stackoverflow.com/users/6027208/ex-expat"}, "edited": false, "score": 0, "creation_date": 1461008816, "post_id": 36651317, "comment_id": 60993757, "body": "Thanks for the feedback. My code now references the actual headers and worksheet range, and so far it&#39;s working great. Your help is much appreciated!"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 61, "user_id": 6027208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a44c42e7bfc99445d008da700f987440?s=128&d=identicon&r=PG&f=1", "display_name": "ex-expat", "link": "https://stackoverflow.com/users/6027208/ex-expat"}, "edited": false, "score": 0, "creation_date": 1461009493, "post_id": 36651317, "comment_id": 60994120, "body": "Didn&#39;t hear from you in a while. I thought you took off like most new SO users! Glad to help!"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1460734410, "creation_date": 1460734410, "answer_id": 36651317, "question_id": 36608715, "link": "https://stackoverflow.com/questions/36608715/excel-ado-error-accessing-recordset/36651317#36651317", "title": "Excel/ADO: Error Accessing Recordset", "body": "<p>Syntactically, nothing is wrong with your VBA code. Simply your SQL query's <code>WHERE</code> condition does not return records and hence why it sporadically works. For your posted sample data F18 and F25 do not have such <code>WHERE</code> clause values in the columns as shown:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IbgVZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IbgVZ.png\" alt=\"Spreadsheet Input\"></a></p>\n\n<p>If you remove the <code>WHERE</code> condition all records are returned:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EeuQQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EeuQQ.png\" alt=\"Spreadsheet Output\"></a></p>\n\n<p>Possibly, worksheets may differ in arrangement of columns so F18 and F25 may point to different fields. So, consider explicitly referencing columns as well as the portion of the worksheet that contains the recordset. Be sure such columns do exist in each worksheet or query will fail. Finally, specify <code>HDR=Yes</code> in connection string to indicate first row contains column names:</p>\n\n<pre><code>sSQL = \"select [Company1], [Group], [RES], [Band], [Name1],\" _\n           &amp; \" [CENTER2], [AL], [Tran], [Type2]\" _\n           &amp; \" from [Natural Detail$A10:BL19]\" _\n           &amp; \" where [CENTER2]='0000121046' or [Name2]='Natural GL Acct Nbr'\"\n...\noConn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source='\" &amp; DBpath &amp; \"';\" &amp; _\n                \"Extended Properties=\"\"Excel 12.0 Xml;HDR=Yes;\"\";\"\n</code></pre>\n\n<p>You will notice above SQL statement has numbered suffixes by some column names which is due to the repeated column names in data source: (Company, Code, Type, Name, ...) which the Jet/ACE SQL Engine suffixes with a number in recordset as each field must be uniquely identified. First instance has no number and every one after with increasing suffixed numbers: Company, Company1, Company2... Also do note: with <code>HDR=Yes</code>, no field names will result in recordset:</p>\n\n<p><a href=\"https://i.stack.imgur.com/j96B7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j96B7.png\" alt=\"Spreadsheet Output without headers\"></a></p>\n\n<p>Last but not least, for best practices always error handle your code to show explicit message of runtime error and use <code>Option Explicit</code> in global space to ensure variables/objects are properly declared:</p>\n\n<pre><code>Option Explicit\n\nSub RunSQL()\nOn Error GoTo ErrHandle\n    Dim oConn As New ADODB.Connection\n    Dim oRS As New ADODB.Recordset\n\n    ...\n    oRS.Close\n    oConn.Close\n    Set oConn = Nothing\n    Exit Sub\n\nErrHandle:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description, vbCritical, \"RUNTIME ERROR\"\n    Exit Sub\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6027208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a44c42e7bfc99445d008da700f987440?s=128&d=identicon&r=PG&f=1", "display_name": "ex-expat", "link": "https://stackoverflow.com/users/6027208/ex-expat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 694, "favorite_count": 0, "accepted_answer_id": 36651317, "answer_count": 1, "score": 0, "last_activity_date": 1460734410, "creation_date": 1460578561, "last_edit_date": 1460669811, "question_id": 36608715, "link": "https://stackoverflow.com/questions/36608715/excel-ado-error-accessing-recordset", "title": "Excel/ADO: Error Accessing Recordset", "body": "<p>I can usually run the following code without issue, but it sometimes fails to find any records in the record set. The file itself is large - over 200k rows. In addition, it has some merged cells, and the column widths are not wide enough to view the data without auto-fitting (I am not sure if either of those could be a contributing factor). I'd also like to add that the times no records have been found have mostly been on a machine running Excel 2010, whereas the successful instances have been on a machine running Excel 2013. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim oConn As New ADODB.Connection\nDim oRS As New ADODB.Recordset\nDim sPath\nDim sSQL As String\nDim fd As Office.FileDialog\nDim fr11 As String\n\nWorksheets.Add(After:=Worksheets(Worksheets.Count)).Name = \"FR11\".\n\nsSQL = \"select F3,F6,F8,F9,F10,F18,F22,F23,F28 from [Natural Detail $] where F18 = '0000121046' or F25 = 'Natural GL Acct Nbr'\"\n\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\n\n  With fd\n\n      .AllowMultiSelect = False    \n      .Title = \"Please select the file.\" box.\n      .Filters.Clear\n      .Filters.Add \"Excel\", \"*.xlsx\"\n      .Filters.Add \"All Files\", \"*.*\"\n\n\n      If .Show = True Then\n        fr11 = .SelectedItems(1) \n\n      End If\n   End With\n\nDBPath = fr11\n\noConn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source='\" &amp; DBPath &amp; \"';\" &amp; _\n                 \"Extended Properties='Excel 12.0 Xml;HDR=No;IMEX=1;MaxScanRows=0';\"\n\noRS.Open sSQL, oConn\n\nIf Not (oRS.BOF And oRS.EOF) Then\n        Worksheets(\"FR11\").Range(\"A1\").CopyFromRecordset oRS\n    Else\n        MsgBox \"No records found\"\n    End If\n\n    oRS.Close\n    oConn.Close\n    Set oConn = Nothing\n</code></pre>\n\n<p>Is there anything you see that could be causing the above to sometimes fail, or that would improve the code in general. Any feedback is much appreciated.</p>\n\n<p>Here is a sample of the data:</p>\n\n<pre><code>Company Name                                                                                                                \n\nCompany Name                                                                                                                \n\nCompany Info                                                                                                                \n\nAccounting Date:    04/12/2016                                                                                                          \n\nCompany Code    Company Code    Type    Group   TP  RES Band    Name    Arrival Date    Departure Date  ACCTING CENTER1 ACCTING CENTER2 Center Name GL AL Tran Type Name    Acctng Tran Type Name   Natural Posting Item Name   Creation User Id    SAP Account Name    Paymnet Method  Document Number Payment Originator Name Natural Posting Amt ID  Acctng Tran Id  Natural GL Acct Nbr Natural CAC Id  PAY ID  ID  Totals\n222 7887878 Master  4696941 0   4696941     random name 04/09/2016  04/23/2016  Undistributed   Undistributed   Company Info        REC         Ledger  RE  Ledger  CC  ******* random name 4696941 4696941 5857    0000121046  4   1616165 649848  \n777 7768    Master  7575    0   783783      random name 12/01/2015  02/26/2016  Undistributed   Undistributed   Company Info        REC         Ledger  RE  Ledger  CC  ******* random name 4696941 4696941 8778    0000121046  5   6168161 128572150   \n783783  4696941 Master  4696941 0   783783      random name 04/09/2016  04/25/2016  Undistributed   Undistributed   Company Info        REC         Ledger  RE  Ledger  CC  ******* random name 4696941 4696941 8   0000121046  7   198816313   5464    \n4696941 78666   Master  4696941 0   4696941     random name 04/10/2016  04/22/2016  Undistributed   Undistributed   Company Info        REC         Ledger  RE  Ledger  CC  ******* random name 4696941 4696941 1097152750  0000121046  3   171984  5616    \n78  4696941 Master  786 0   783783      random name 02/19/2016  03/04/2016  Undistributed   Undistributed   Company Info        REC         Ledger  RE  Ledger  CC  ******* random name 4696941 4696941 27217   0000121046  1   515678  115616  \n66  786 Master  4696941 0   78378       random name 04/02/2016  04/06/2016  Undistributed   Undistributed   Company Info        REC         Ledger  RE  Ledger  CC  ******* random name 4696941 4696941 4177    0000121046  2   56468   117980742   \n22  666///  Master  4696941 0   42753       random name 04/09/2016  04/29/2016  Undistributed   Undistributed   Company Info        REC         Ledger  RE  Ledger  CC  ******* random name 4696941 4696941 9   0000121046  32  198805200   42742   \n783 86788   Master  4696941 0   4696941     random name 04/01/2016  04/17/2016  Undistributed   Undistributed   Company Info        REC         Ledger  RE  Ledger  CC  ******* random name 4696941 4696941 879 0000121046  7   254948  1561    \n66676   4696941 Master  4696941 0   4696941     random name 02/29/2016  03/15/2016  Undistributed   Undistributed   Company Info        REC         Ledger  RE  Ledger  CC  ******* random name 4696941 4696941 78  0000121046  7   45618   615 \n</code></pre>\n"}, {"tags": ["vba", "excel", "vsto"], "answers": [{"comments": [{"owner": {"reputation": 2240, "user_id": 582962, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/17935a018451ecef63ff3d593e4299f2?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/582962/jim"}, "edited": false, "score": 0, "creation_date": 1460657173, "post_id": 36630527, "comment_id": 60856857, "body": "Unfortunately CodeName doesn&#39;t fulfill the second requirement, which is change if anything on the sheet is changed. I ended up to hash the content of the sheet. Any ideas why GetHashCode() changes each time I call it?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 2240, "user_id": 582962, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/17935a018451ecef63ff3d593e4299f2?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/582962/jim"}, "edited": false, "score": 0, "creation_date": 1460658420, "post_id": 36630527, "comment_id": 60857612, "body": "Why not use CodeName as the basis and increment a value concatenated to it?"}, {"owner": {"reputation": 2240, "user_id": 582962, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/17935a018451ecef63ff3d593e4299f2?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/582962/jim"}, "edited": false, "score": 0, "creation_date": 1460662852, "post_id": 36630527, "comment_id": 60860233, "body": "For some reason when new workbook opened CodeName is empty."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 2240, "user_id": 582962, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/17935a018451ecef63ff3d593e4299f2?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/582962/jim"}, "edited": false, "score": 0, "creation_date": 1460667324, "post_id": 36630527, "comment_id": 60862843, "body": "Then you need to provide more information about your project *in your question&quot; using the <a href=\"https://stackoverflow.com/posts/36630527/edit\">edit</a> link."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1460656505, "last_edit_date": 1525816150, "creation_date": 1460656505, "answer_id": 36630527, "question_id": 36608420, "link": "https://stackoverflow.com/questions/36608420/excel-vsto-worksheet-unique-identifier/36630527#36630527", "title": "Excel VSTO Worksheet unique identifier", "body": "<p>The <code>CodeName</code> of a worksheet <em>is</em> a unique identifier. VSTO uses the <code>CodeName</code> property for the internal name of the worksheet (probably Sheet1, Sheet2, etc.) when it creates a project with Worksheets in the Workbook. </p>\n\n<p>In the VBA interface this property can be changed in the VBA IDE - it's the name used for the class module belonging to each Worksheet. </p>\n\n<p>The property cannot be changed at run-time, only at design time. While the property may seem to reflect the caption for the worksheet (the name the user sees and can change in the UI), the two are <em>not</em> linked.</p>\n\n<p>For more information, see:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff837552.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff837552.aspx?f=255&amp;MSPPError=-2147217396</a></p>\n\n<p><a href=\"http://www.cpearson.com/excel/RenameProblems.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/RenameProblems.aspx</a></p>\n"}], "owner": {"reputation": 2240, "user_id": 582962, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/17935a018451ecef63ff3d593e4299f2?s=128&d=identicon&r=PG", "display_name": "Jim", "link": "https://stackoverflow.com/users/582962/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460656505, "creation_date": 1460577671, "question_id": 36608420, "link": "https://stackoverflow.com/questions/36608420/excel-vsto-worksheet-unique-identifier", "title": "Excel VSTO Worksheet unique identifier", "body": "<p>I am looking for a way to create unique Worsksheet identifier, which would take into account at least name and content. If any worksheet value is changed then the identifier would change as well. I have checked the GetHashCode() but for some reason each time I call this method on the same sheet it always changes. Any ideas how to create that identifier/hash code</p>\n\n<pre><code> Excel.Worksheet sheet2 = (Excel.Worksheet)Globals.ThisAddIn.Application.ActiveSheet;\n var hash = sheet2.GetHashCode();\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 5371653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b216d0a5500b87c6a89e472aba477ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/5371653/will"}, "edited": false, "score": 0, "creation_date": 1460633895, "post_id": 36609858, "comment_id": 60839652, "body": "thanks a lot for providing the inspiring idea. I tried your approach and put the codes in both MainFom and SubForm, but SubForm still loads all column (without any error message), I have put the codes in the bottom of my question, udpate1 and update2, appreicate if you or someone can provide hints. Thanks again."}, {"owner": {"reputation": 79, "user_id": 5371653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b216d0a5500b87c6a89e472aba477ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/5371653/will"}, "edited": false, "score": 0, "creation_date": 1460653807, "post_id": 36609858, "comment_id": 60855001, "body": "it works!! The codes are truely amazing!! Thanks a lot!"}], "tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1460634724, "last_edit_date": 1460634724, "creation_date": 1460582780, "answer_id": 36609858, "question_id": 36608245, "link": "https://stackoverflow.com/questions/36608245/access-vba-set-form-column-visibility-from-other-table-without-hard-coding/36609858#36609858", "title": "Access VBA set form column visibility from other table without hard coding", "body": "<p>You should try the following approach</p>\n\n<pre><code>Private Sub Form_Load()\n\n    Dim RST As Recordset\n    Dim strBookType As String\n    Dim strSQL as string\n    Dim ctrl As Control\n\n    strBookType = Forms![SubForm]!BookType\n\n    ' Set visible controls\n    strSQL = \"SELECT Attribute FROM Table_Setting WHERE BookType='\" &amp; strBookType &amp; \"'\"\n    Set RST = CurrentDb.OpenRecordset(strSQL)\n    If Not RST.BOF Then\n        While Not RST.EOF\n            Set ctrl = Me.Controls(RST!Attribute)\n            ctrl.ColumnHidden = False\n            RST.MoveNext\n        Wend\n    End If\n    RST.Close\n\n    ' Set invisible controls\n    strSQL = \"SELECT DISTINCT(Attribute) FROM Table_Setting WHERE Attribute NOT IN (SELECT Attribute FROM Table_Setting WHERE BookType='\" &amp; strBookType &amp; \"')\"\n    Set RST = CurrentDb.OpenRecordset(strSQL)\n    If Not RST.BOF Then\n        While Not RST.EOF\n            Set ctrl = Me.Controls(RST!Attribute)\n            ctrl.ColumnHidden = True\n            RST.MoveNext\n        Wend\n    End If\n    RST.Close\n\n    Set RST = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>The idea is to retrieve the attributes, to loop on them, and to set visible or not the controls on your form having the attribute's name using <code>Me.Controls(attribute).ColumnHidden</code></p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>At first glance I did not realized that you were trying to hide columns in a datasheet. You can't use the <code>Visible</code> property for this, you have to use <code>ColumnHidden</code>. I adapted my code accordingly</p>\n"}], "owner": {"reputation": 79, "user_id": 5371653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b216d0a5500b87c6a89e472aba477ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/5371653/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 36609858, "answer_count": 1, "score": 0, "last_activity_date": 1460634724, "creation_date": 1460577067, "last_edit_date": 1460633364, "question_id": 36608245, "link": "https://stackoverflow.com/questions/36608245/access-vba-set-form-column-visibility-from-other-table-without-hard-coding", "title": "Access VBA set form column visibility from other table without hard coding", "body": "<p>My question is related to following tables and form. image3 and image4 are same form, which loads data from Table_2(image2). Table_Setting(image1) is used to define which attribute column should be visible in the SubForm of MainForm (image3 and image 4). That means whether the columns in the subform is visible is defined by user in Table_Setting(image1). For example, according to Table_Setting, if the BookType in MainForm is \"novel\", then SubForm should display Author,Publisher,BookName; if the BookType is \"text book\", only display Publisher,PublishYear.<br></p>\n\n<p><strong>image1:</strong> <br>\n<a href=\"https://i.stack.imgur.com/1VHpV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1VHpV.jpg\" alt=\"enter image description here\"></a><br><br>\n<strong>image2:</strong> <br>\n<a href=\"https://i.stack.imgur.com/eXSau.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eXSau.jpg\" alt=\"enter image description here\"></a><br><br>\n<strong>image3:</strong> <br>\n<a href=\"https://i.stack.imgur.com/taI52.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/taI52.jpg\" alt=\"enter image description here\"></a><br><br>\n<strong>image4:</strong> <br>\n<a href=\"https://i.stack.imgur.com/A9nYW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A9nYW.jpg\" alt=\"enter image description here\"></a><br><br></p>\n\n<p>I know the following codes can set whether the column in the SubForm is visible or not. But this is hard code version. It is not flexible enough if the user updates the Table_Setting table.  </p>\n\n<pre><code>Private Sub Form_Load()\n    Select Case Forms![SubForm]!BookType\n        Case \"novel\"\n            Me.BookType.Visible = True\n            Me.Author.Visible = True\n            Me.Publisher.Visible = True\n            Me.BookName.Visible = True\n            Me.PublishYear.Visible = False\n        Case \"research\"\n            Me.BookType.Visible = True\n            Me.Author.Visible = False\n            Me.Publisher.Visible = False\n            Me.BookName.Visible = False\n            Me.PublishYear.Visible = True           \n        Case \"text book\"    \n            Me.BookType.Visible = True\n            Me.Author.Visible = Falss\n            Me.Publisher.Visible = True\n            Me.BookName.Visible = False\n            Me.PublishYear.Visible = True                   \n    End Select\nEnd Sub\n</code></pre>\n\n<p><strong>My question:</strong> <br>\nMy quesiton is: is it possible to write some codes to automatically set the column visibility simply according to the Table_Setting table while no need to hard code for each column in SubForm? So the user can easily change which columns to display by udating the Table_Setting table only. Thanks a lot. <br> <br></p>\n\n<p><strong>Update1:</strong> <br>\nI run the following codes in MainForm.<br></p>\n\n<pre><code>Private Sub Form_Load()\n\n    Dim RST As Recordset\n    Dim strBookType As String\n    Dim strSQL As String\n\n    strBookType = Me.BookType\n\n    ' Set visible controls\n    strSQL = \"SELECT Attribute FROM Table_Setting WHERE BookType = '\" &amp; strBookType &amp; \"'\"\n    Set RST = CurrentDb.OpenRecordset(strSQL)\n    If Not RST.BOF Then\n        While Not RST.EOF\n            Me!Table_2_DataSheet.Form.Controls(RST!Attribute).Visible = True 'Table_2_DataSheet is the subform name\n            RST.MoveNext\n        Wend\n    End If\n    RST.Close\n\n    ' Set invisible controls\n    strSQL = \"SELECT DISTINCT(Attribute) FROM Table_Setting WHERE Attribute NOT IN (SELECT Attribute FROM Table_Setting WHERE BookType='\" &amp; strBookType &amp; \"')\"\n    Set RST = CurrentDb.OpenRecordset(strSQL)\n    If Not RST.BOF Then\n        While Not RST.EOF\n            Me!Table_2_DataSheet.Form.Controls(RST!Attribute).Visible = False 'Table_2_DataSheet is the subform name\n            RST.MoveNext\n        Wend\n    End If\n    RST.Close\n\n    Set RST = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><br>\n<br>\n<strong>Update2:</strong> <br>\nI run the following codes in SubForm.<br></p>\n\n<pre><code>Private Sub Form_Load()\n\n    Dim RST As Recordset\n    Dim strBookType As String\n    Dim strSQL As String\n\n    strBookType = Me.Parent.BookType\n\n    ' Set visible controls\n    strSQL = \"SELECT Attribute FROM Table_Setting WHERE BookType = '\" &amp; strBookType &amp; \"'\"\n    Set RST = CurrentDb.OpenRecordset(strSQL)\n    If Not RST.BOF Then\n        While Not RST.EOF\n            Me.Controls(RST!Attribute).Visible = True\n            RST.MoveNext\n        Wend\n    End If\n    RST.Close\n\n    ' Set invisible controls\n    strSQL = \"SELECT DISTINCT(Attribute) FROM Table_Setting WHERE Attribute NOT IN (SELECT Attribute FROM Table_Setting WHERE BookType='\" &amp; strBookType &amp; \"')\"\n    Set RST = CurrentDb.OpenRecordset(strSQL)\n    If Not RST.BOF Then\n        While Not RST.EOF\n            Me.Controls(RST!Attribute).Visible = False\n            RST.MoveNext\n        Wend\n    End If\n    RST.Close\n\n    Set RST = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "filter", "combobox", "macros"], "answers": [{"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1460618787, "creation_date": 1460618787, "answer_id": 36616391, "question_id": 36608122, "link": "https://stackoverflow.com/questions/36608122/excel-vba-combo-box-macro-for-changing-list-items/36616391#36616391", "title": "Excel VBA Combo Box Macro for Changing List Items", "body": "<p>Since you haven't provide any relations of fields-columns, there isn't much generic code possible.</p>\n\n<p>Your current code can be simplified to below:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub cboIntervieweeName_Change()\n    Dim lField As Long\n    Select Case Me.cboIntervieweeName.Value\n        Case \"Chuck Fox\":       lField = 17\n        Case \"Rob Copeland 1\":  lField = 19\n        Case \"Rob Copeland 2\":  lField = 21\n        Case \"Rob Copeland 3\":  lField = 23\n        Case Else\n            Selection.AutoFilter\n            Exit Sub\n    End Select\n    ActiveSheet.Range(\"B6:BL119\").AutoFilter field:=lField, Criteria1:=\"Yes\", VisibleDropDown:=True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1460628112, "creation_date": 1460628112, "answer_id": 36619767, "question_id": 36608122, "link": "https://stackoverflow.com/questions/36608122/excel-vba-combo-box-macro-for-changing-list-items/36619767#36619767", "title": "Excel VBA Combo Box Macro for Changing List Items", "body": "<p>Here what you could place in your UserForm code pane</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub cboIntervieweeName_Change()\n    Dim lField As Long\n    Dim dataRng As Range, IntervieweeNameRng As Range, found As Range\n\n\n    With Worksheets(\"Assessment\")\n        Set dataRng = .Range(\"B6:BL119\") '&lt;== here set your \"data\" range, included first header row above the actual \"data\"\n        Set IntervieweeNameRng = .Range(\"B5:BL5\") '&lt;== here set your \"Assessment\" sheet range where to search for combobox IntervieweeName selected\n    End With\n\n    If cboIntervieweeName.ListIndex &gt; -1 Then\n\n        Set found = IntervieweeNameRng.Find(What:=Me.cboIntervieweeName.Value, LookAt:=xlWhole, LookIn:=xlValues, MatchCase:=True)\n        If found Is Nothing Then\n            dataRng.AutoFilter  'clear possible previous .Autofilter\n        Else\n            lField = found.Column\n            With dataRng\n                .AutoFilter 'clear possible previous .Autofilter\n                .AutoFilter field:=lField, Criteria1:=\"Yes\", VisibleDropDown:=True\n            End With\n        End If\n    Else\n        dataRng.AutoFilter  'clear possible previous .Autofilter\n    End If\n\nEnd Sub\n\n\nPrivate Sub resetIntervieweeName_Click()\n    cboIntervieweeName.ListIndex = -1\nEnd Sub\n</code></pre>\n\n<p>this way you can modify both range and values of <code>IntervieweeName</code> named range and still have <code>cboIntervieweeName</code> combobox \"change\" event handler filter \"Assessment\" sheet accordingly</p>\n\n<p>I also modified your <code>resetIntervieweeName_Click</code> routine so as to \"clear\" the <code>cboIntervieweeName</code> combobox text setting its <code>.ListIndex</code> property to 1</p>\n"}], "owner": {"reputation": 1, "user_id": 6200602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/007111bdf33daf450610b2387bdddd66?s=128&d=identicon&r=PG&f=1", "display_name": "Jon R.", "link": "https://stackoverflow.com/users/6200602/jon-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1159, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1460628112, "creation_date": 1460576653, "question_id": 36608122, "link": "https://stackoverflow.com/questions/36608122/excel-vba-combo-box-macro-for-changing-list-items", "title": "Excel VBA Combo Box Macro for Changing List Items", "body": "<p>I created an IntervieweeName named list on sheet \"Tables\":\n<a href=\"http://i.stack.imgur.com/5p3Xe.png\" rel=\"nofollow\">IntervieweeName named list on Sheet2</a></p>\n\n<p>On sheet \"Assessment\", I've created a combobox with a ListFillRange of IntervieweeName. The purpose of the combobox is for the worksheet to autofilter based on the criteria if \"Yes\" exists in the column that corresponds to the selected IntervieweeName list item.  Here is relevant data from sheet \"Assessment\":\n<a href=\"http://i.stack.imgur.com/PVrts.png\" rel=\"nofollow\">Yes/No columns for Sheet \"Assessment\"</a></p>\n\n<p>In order to accomplish the filter, I created this macro and it works correctly.</p>\n\n<pre><code>Private Sub cboIntervieweeName_Change()\n    Dim IntervieweeName As String\n\n    IntervieweeName = Me.cboIntervieweeName\n\n    If IntervieweeName = \"None\" Then\n        Selection.AutoFilter\n    End If\n    If IntervieweeName = \"Chuck Fox\" Then\n        ActiveSheet.Range(\"B6:BL119\").AutoFilter _\n            field:=17, _\n            Criteria1:=\"Yes\", _\n            VisibleDropDown:=True\n    End If\n     If IntervieweeName = \"Rob Copeland 1\" Then\n        ActiveSheet.Range(\"B6:BL119\").AutoFilter _\n            field:=19, _\n            Criteria1:=\"Yes\", _\n            VisibleDropDown:=True\n    End If\n     If IntervieweeName = \"Rob Copeland 2\" Then\n        ActiveSheet.Range(\"B6:BL119\").AutoFilter _\n            field:=21, _\n            Criteria1:=\"Yes\", _\n            VisibleDropDown:=True\n    End If   \n  If IntervieweeName = \"Rob Copeland 3\" Then\n        ActiveSheet.Range(\"B6:BL119\").AutoFilter _\n            field:=23, _\n            Criteria1:=\"Yes\", _\n            VisibleDropDown:=True\n    End If\nEnd Sub\n</code></pre>\n\n<p>I also created a button macro to reset the combobox list item to 0, which is none.</p>\n\n<pre><code>Private Sub resetIntervieweeName_Click()\n    cboIntervieweeName.ListIndex = 0\nEnd Sub\n</code></pre>\n\n<p>This is great for one instance but my team would like to use this for future projects.  How do I modify the sheet(s) and/or macro to accomodate changing the names in the IntervieweeName list without having to modify the macro?</p>\n\n<p>This is my first macro.  Total noob.  Any help is appreciated, thanks.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1460578025, "creation_date": 1460578025, "answer_id": 36608545, "question_id": 36607950, "link": "https://stackoverflow.com/questions/36607950/send-mailitem-display-msgbox/36608545#36608545", "title": "Send MailItem, Display MsgBox", "body": "<p>Use the Items.ItemAdd event on the Sent Items folder. </p>\n"}], "owner": {"reputation": 763, "user_id": 3813324, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cf32b9b21d44f549e3798567fa88d4ab?s=128&d=identicon&r=PG", "display_name": "user65", "link": "https://stackoverflow.com/users/3813324/user65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 326, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488526441, "creation_date": 1460576112, "last_edit_date": 1488526441, "question_id": 36607950, "link": "https://stackoverflow.com/questions/36607950/send-mailitem-display-msgbox", "title": "Send MailItem, Display MsgBox", "body": "<p>I am trying to send a message and then display a notification that it has been sent.  Something like this:</p>\n\n<pre><code>msg.Send\nMsgBox \"Message has been sent\"\n</code></pre>\n\n<p>Unfortunately Outlook dumps the message in the Outbox, and does not process a Send/Receive until the dialog box has been closed.</p>\n\n<p>I pasted together a few snippets to force a Send/Receive and then wait for the outbox to clear, but unfortunately this code blocks forever (as the Outbox never sends while the macro is running, and the macro is waiting for the Outbox to send):</p>\n\n<pre><code>msg.Send\n\nSet nsp = Application.GetNamespace(\"MAPI\")\nSet sycs = nsp.SyncObjects\nFor i = 1 To sycs.Count\n    sycs.Item(i).Start\nNext\n\nSet outb = nsp.GetDefaultFolder(olFolderOutbox)\nDo While outb.Items.Count &gt; 0\n    DoEvents\nLoop\n\nMsgBox \n</code></pre>\n\n<p>Is there any simple way to achieve what I want?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1460589771, "post_id": 36607762, "comment_id": 60819287, "body": "Remove <code>.Value</code> from the Slope function call."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6189964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8ac7b113da63d32548c1d58ca602f55?s=128&d=identicon&r=PG&f=1", "display_name": "StarrySky", "link": "https://stackoverflow.com/users/6189964/starrysky"}, "edited": false, "score": 0, "creation_date": 1460607550, "post_id": 36611279, "comment_id": 60824275, "body": "It worked until a &quot;#DIV/0&quot; error came up, as shown here:  <a href=\"http://i.imgur.com/oXyo1nZ.png\" rel=\"nofollow noreferrer\">i.imgur.com/oXyo1nZ.png</a>"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 29, "user_id": 6189964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8ac7b113da63d32548c1d58ca602f55?s=128&d=identicon&r=PG&f=1", "display_name": "StarrySky", "link": "https://stackoverflow.com/users/6189964/starrysky"}, "edited": false, "score": 0, "creation_date": 1460608830, "post_id": 36611279, "comment_id": 60824653, "body": "@StarrySky - I modified the answer to capture the case where there is only on Y value and then not calculate a slope. It relies on there being no data to the right of your dates in the first row."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 29, "user_id": 6189964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8ac7b113da63d32548c1d58ca602f55?s=128&d=identicon&r=PG&f=1", "display_name": "StarrySky", "link": "https://stackoverflow.com/users/6189964/starrysky"}, "edited": false, "score": 0, "creation_date": 1460610428, "post_id": 36611279, "comment_id": 60825142, "body": "remind me again why you are using VBA. This would be simple with Excel formulas: <code>=IF(GT(COUNTIF(C1:C7,&quot;&lt;&gt;&quot;&quot;&quot;),1),SLOPE(C1:C7,$B$1:$B$7),&quot;&quot;)</code> and then fill down."}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 0, "last_activity_date": 1460608746, "last_edit_date": 1460608746, "creation_date": 1460590003, "answer_id": 36611279, "question_id": 36607762, "link": "https://stackoverflow.com/questions/36607762/invalid-qualifier-error-with-slope-function/36611279#36611279", "title": "Invalid Qualifier error with Slope function", "body": "<p>As stated, removing .Value from the slope call allows it to pass the compiler.</p>\n\n<p>Otherwise, it seems to work.</p>\n\n<p>This input ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/Z8IpU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z8IpU.png\" alt=\"enter image description here\"></a></p>\n\n<p>Provided this output ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/L6uwU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L6uwU.png\" alt=\"enter image description here\"></a></p>\n\n<p>Using this code (slightly modified to get the correct columns) ...</p>\n\n<pre><code>Sub main()\nDim n As Long\nDim MyRange As Range\n\nSet MyRange = ActiveSheet.UsedRange\nDim TargetSheet As Worksheet, SourceSheet As Worksheet\nDim TargetBook As Workbook\n\nSet TargetBook = Application.ActiveWorkbook\nSet TargetSheet = Application.ActiveSheet\n\nFor n = 2 To MyRange.Rows.Count\n\n    TargetSheet.Cells(n, (MyRange.Columns.Count) + 1).Value = _\n        Application.WorksheetFunction.Slope(TargetSheet.Range(TargetSheet.Cells(n, 1), TargetSheet.Cells(n, MyRange.Columns.Count)), _\n        TargetSheet.Range(TargetSheet.Cells(1, 1), TargetSheet.Cells(1, MyRange.Columns.Count)))\n\nNext n\n\nEnd Sub\n</code></pre>\n\n<p>Below is revised code to capture case when only 1 Y value is present to avoid divide by zero. This assumes that row 1 in the worksheet will have nothing to the right of the headers.</p>\n\n<pre><code>Option Explicit\n\nSub main()\nDim n As Long\nDim MyRange As Range\nDim nRows As Long, nCols As Long, ColCount As Long\n\nSet MyRange = ActiveSheet.UsedRange\nDim TargetSheet As Worksheet, SourceSheet As Worksheet\nDim TargetBook As Workbook\n\nSet TargetBook = Application.ActiveWorkbook\nSet TargetSheet = Application.ActiveSheet\n\nnRows = MyRange.Rows.Count\nnCols = MyRange.Rows(1).End(xlToRight)\n\nFor n = 2 To nRows\n\n    ColCount = Application.CountIf(TargetSheet.Range(TargetSheet.Cells(n, 1), Sheet1.Cells(n, nCols)), \"\"\"&lt;&gt;\"\"\"\"\"\"\")\n    If ColCount &gt; 1 Then\n        TargetSheet.Cells(n, (MyRange.Columns.Count) + 1).Value = _\n            Application.Slope(TargetSheet.Range(TargetSheet.Cells(n, 1), TargetSheet.Cells(n, MyRange.Columns.Count)), _\n            TargetSheet.Range(TargetSheet.Cells(1, 1), TargetSheet.Cells(1, MyRange.Columns.Count)))\n    End If\nNext n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 6189964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8ac7b113da63d32548c1d58ca602f55?s=128&d=identicon&r=PG&f=1", "display_name": "StarrySky", "link": "https://stackoverflow.com/users/6189964/starrysky"}, "is_accepted": true, "score": 0, "last_activity_date": 1460616322, "creation_date": 1460616322, "answer_id": 36615623, "question_id": 36607762, "link": "https://stackoverflow.com/questions/36607762/invalid-qualifier-error-with-slope-function/36615623#36615623", "title": "Invalid Qualifier error with Slope function", "body": "<p>Thanks @OldUgly! Managed to fix the error. Reason for VBA: automate for multiple data sheets in the same format with varying no. of columns and rows.</p>\n\n<p>WorksheetFunction.Slope doesn't like it when there's only one data point and the rest of one array is empty.</p>\n\n<p>I created another loop to count non-empty cells within the <code>For</code> loop for each row. If the no. of non-empty cells is &lt; 2 for a particular row, the output would be \"Insufficient Data\".</p>\n\n<p>If not, then the slope value would be calculated.</p>\n\n<p>Another, less painstaking way to get around this issue is to simply use <code>On Error Resume Next</code> for this specific case.</p>\n\n<pre><code>Dim n As Long, o As Range, CurrentRow As Range, NonEmptyCellCountRow As Integer\n\n\nFor n = 3 To MyRange.Rows.Count `Within each row, counting non-empty cells\n\n    Set CurrentRow = TargetSheet.Range(TargetSheet.Cells(n, 5), TargetSheet.Cells(n, MyRange.Columns.Count))\n\n    NonEmptyCellCountRow = 0\n\n    For Each o In CurrentRow\n\n        If o.Value &lt;&gt; \"\" Then NonEmptyCellCountRow = NonEmptyCellCountRow + 1\n\n    Next o\n\n    If NonEmptyCellCountRow &lt; 2 Then _\n\n        TargetSheet.Cells(n, (MyRange.Columns.Count) + 1) = \"Insufficient Data\"\n\n    Else\n\n        TargetSheet.Cells(n, (MyRange.Columns.Count) + 1) = Application.WorksheetFunction.Slope(TargetSheet.Range(TargetSheet.Cells(n, 5), TargetSheet.Cells(n, MyRange.Columns.Count)), TargetSheet.Range(TargetSheet.Cells(1, 5), TargetSheet.Cells(1, MyRange.Columns.Count)))\n\n    End If\n\nNext n\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6189964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8ac7b113da63d32548c1d58ca602f55?s=128&d=identicon&r=PG&f=1", "display_name": "StarrySky", "link": "https://stackoverflow.com/users/6189964/starrysky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 36615623, "answer_count": 2, "score": 0, "last_activity_date": 1460616322, "creation_date": 1460575440, "question_id": 36607762, "link": "https://stackoverflow.com/questions/36607762/invalid-qualifier-error-with-slope-function", "title": "Invalid Qualifier error with Slope function", "body": "<p>New to VBA and got this qualifier error for a code that's supposed to calculate the slope of two arrays and place it in a column with the given address.</p>\n\n<p>Beats me so far, so it'd be nice to have some help! The sizes of the arrays are matching.</p>\n\n<p>The compile error is given at the <code>.Slope</code> within the <code>TargetSheet.Cells(n, (MyRange.Columns.Count) + 1).Value = Application.WorksheetFunction.Slope(TargetSheet.Range(TargetSheet.Cells(n, 5), TargetSheet.Cells(n, MyRange.Columns.Count)), TargetSheet.Range(TargetSheet.Cells(1, 5), TargetSheet.Cells(1, MyRange.Columns.Count))).Value</code></p>\n\n<pre><code>Dim n As Long\nDim MyRange As Range\nSet MyRange = ActiveSheet.UsedRange\nDim TargetSheet As Worksheet, SourceSheet As Worksheet\nDim TargetBook As Workbook\n\nSet TargetBook = Application.ActiveWorkbook\nSet TargetSheet = Application.ActiveSheet\n\nFor n = 3 To MyRange.Rows.Count\n\n    TargetSheet.Cells(n, (MyRange.Columns.Count) + 1).Value = Application.WorksheetFunction.Slope(TargetSheet.Range(TargetSheet.Cells(n, 5), TargetSheet.Cells(n, MyRange.Columns.Count)), TargetSheet.Range(TargetSheet.Cells(1, 5), TargetSheet.Cells(1, MyRange.Columns.Count))).Value\n\nNext n\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>A version before this one (can't undo till that point :/) was working up till a point where it stopped and gave the qualifier error. I used Excel's SLOPE function on the data set and compared alongside: it was giving this error at a #DIV/0 result (but the VBA didn't show that).</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6200482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f481aab93b84cc489673e2cdab71ff?s=128&d=identicon&r=PG&f=1", "display_name": "Victor Warhol", "link": "https://stackoverflow.com/users/6200482/victor-warhol"}, "edited": false, "score": 0, "creation_date": 1460575309, "post_id": 36607478, "comment_id": 60812165, "body": "That worked like warm knife through butter. Thank you. Did I understand corectly that we are processing the rows from the bottom up?  Any advice on where to learn more?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23, "user_id": 6200482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f481aab93b84cc489673e2cdab71ff?s=128&d=identicon&r=PG&f=1", "display_name": "Victor Warhol", "link": "https://stackoverflow.com/users/6200482/victor-warhol"}, "edited": false, "score": 0, "creation_date": 1460575526, "post_id": 36607478, "comment_id": 60812291, "body": "@VictorWarhol Glad it worked.  Please mark as correct by clicking the grey/green check by the answer.  To learn, there are many free websites that will walk through step by step.  Start <a href=\"http://www.techonthenet.com/excel/macros/what_is_vba2013.php\" rel=\"nofollow noreferrer\">HERE</a>."}, {"owner": {"reputation": 23, "user_id": 6200482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f481aab93b84cc489673e2cdab71ff?s=128&d=identicon&r=PG&f=1", "display_name": "Victor Warhol", "link": "https://stackoverflow.com/users/6200482/victor-warhol"}, "edited": false, "score": 0, "creation_date": 1460575764, "post_id": 36607478, "comment_id": 60812442, "body": "Great! Thank you again."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1460575372, "last_edit_date": 1495542246, "creation_date": 1460574589, "answer_id": 36607478, "question_id": 36607344, "link": "https://stackoverflow.com/questions/36607344/change-recorded-macro-to-process-all-data-need-help-on-loop-and-syntax/36607478#36607478", "title": "Change recorded macro to process all data [Need Help on Loop and Syntax]", "body": "<p>Something like this:</p>\n\n<pre><code>Sub Macro2()\nDim i As Long\nFor i = 100 To 2 Step -1\n    Rows(i).Copy\n    Rows(i + 1).Insert shift:=xlDown\n    Cells(i, 2).Cut Cells(i + 1, 1)\nNext i\nEnd Sub\n</code></pre>\n\n<p>I removed the <code>.Select</code> and <code>.Activate</code> It slows down the code. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">HERE</a> for good guidance on such.</p>\n\n<p>When adding or subtracting rows it is best to iterate from bottom to top.  The <code>Step - 1</code> does that.  It starts at row 100 and goes up till row 2.</p>\n\n<p>Another note you will want to designate the sheet so that it looks at the correct sheet:</p>\n\n<pre><code>Sub Macro2()\nDim ws as Worksheet\nDim i As Long\n\nSet ws = Sheets(\"Sheet1\") 'Change to your sheet.\nFor i = 100 To 2 Step -1\n    ws.Rows(i).Copy\n    ws.Rows(i + 1).Insert shift:=xlDown\n    ws.Cells(i, 2).Cut ws.Cells(i + 1, 1)\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6200482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f481aab93b84cc489673e2cdab71ff?s=128&d=identicon&r=PG&f=1", "display_name": "Victor Warhol", "link": "https://stackoverflow.com/users/6200482/victor-warhol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 36607478, "answer_count": 1, "score": 2, "last_activity_date": 1460575372, "creation_date": 1460574198, "question_id": 36607344, "link": "https://stackoverflow.com/questions/36607344/change-recorded-macro-to-process-all-data-need-help-on-loop-and-syntax", "title": "Change recorded macro to process all data [Need Help on Loop and Syntax]", "body": "<p>I have recorded this macro in excel. The idea is to go through all rows (100)\nand repeat the SUB. I think i figured the proper algorithm (I have basic Turbo Pascal knowlege). </p>\n\n<p>Here is my algorithm:</p>\n\n<p><strong>Create a loop that is using a variable, i, for counting.</strong>\n<strong>For i from 2</strong> (we start from row 2, row 1 has headers) <strong>to 200</strong> (even if we initially have 100 rows by the time the scrip will finish executing we will have doubled the amount of rows)</p>\n\n<p><strong>Do the sub</strong></p>\n\n<p>How do I make <strong>Rows(\"2:2\")</strong> for example to reference the current value of i. </p>\n\n<p>How do <strong>Rows(\"3:3\")</strong> to use the value i+1. </p>\n\n<p>How do I make <strong>Range(\"B2\")</strong> to use the value B(i)</p>\n\n<p>I am stuck with the loop and the proper syntax Please help. Also since I want to get deeper into the topic could you please suggest some good sources? I was not really interested in coding after during high school, but now I want to get deeper into the topic.</p>\n\n<pre><code>Sub Macro2()\n    Rows(\"2:2\").Select\n    Selection.Copy\n    Rows(\"3:3\").Select\n    Selection.Insert Shift:=xlDown\n    Range(\"B2\").Select\n    Application.CutCopyMode = False\n    Selection.Cut\n    Range(\"A3\").Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6200527"}, "edited": false, "score": 0, "creation_date": 1460578951, "post_id": 36607619, "comment_id": 60814345, "body": "Is there a way to rename all the images on the worksheet before adding the imageborder around the selected image?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1460580505, "post_id": 36607619, "comment_id": 60815199, "body": "Well, I&#39;d start with looping through all of the objects on the sheet, checking if the item is a picture and then renaming it if it is.  Write some code to try to do that, and then if you are having specific trouble with the code, ask a new question.  Also, if this answer resolves the issue in your question, consider marking it as the answer."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 0, "last_activity_date": 1460575854, "last_edit_date": 1460575854, "creation_date": 1460575015, "answer_id": 36607619, "question_id": 36607282, "link": "https://stackoverflow.com/questions/36607282/renaming-inserted-pictures-in-excel/36607619#36607619", "title": "Renaming inserted pictures in excel", "body": "<p>Try this:</p>\n\n<pre><code>Private Function AddImageBorder()\n     If TypeName(Selection) = \"Picture\" Then 'Make sure the object is a picture first\n         With Selection.ShapeRange\n         .Line.Weight = 5\n         .Line.Visible = msoTrue\n         End With\n      End If\n\nEnd Function\n</code></pre>\n\n<p>I added a check to make sure the selection is a picture to prevent some errors.</p>\n\n<p>To answer your direct question, you could do:</p>\n\n<pre><code>Selection.Name = \"NewName\" \n</code></pre>\n\n<p>and it will change the name of the picture object.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6200527"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7913, "favorite_count": 0, "accepted_answer_id": 36607619, "answer_count": 1, "score": 2, "last_activity_date": 1593700664, "creation_date": 1460574030, "last_edit_date": 1593700664, "question_id": 36607282, "link": "https://stackoverflow.com/questions/36607282/renaming-inserted-pictures-in-excel", "title": "Renaming inserted pictures in excel", "body": "<p>Pictures that are inserted in excel will automatically be named &quot;Picture 1&quot;, &quot;Picture 2&quot; and so forth. I'm running a function to put a border around the selected picture. Problem is, if there are two images in the worksheet that is &quot;Picture 1&quot;, the function will get confuse and not know which one to put it on but randomly put it on a image which could be incorrect. Is there anyway to change the name box of a image or at least get the selected image?</p>\n<p>Here's my code to put border on image:</p>\n<pre><code>Private Function AddImageBorder(WhichSheet As String)\n\n    With ActiveWorkbook.Sheets(WhichSheet).Shapes(Selection.Name)\n        .Line.Weight = 5\n        .Line.Visible = msoTrue\n    End With\n    \nEnd Function\n</code></pre>\n"}, {"tags": ["c#", "vba", "date", "string-formatting", "date-formatting"], "answers": [{"tags": [], "owner": {"reputation": 1126, "user_id": 1368115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24bed58b351e881fc981f08bef1877b?s=128&d=identicon&r=PG", "display_name": "DHW", "link": "https://stackoverflow.com/users/1368115/dhw"}, "is_accepted": true, "score": 0, "last_activity_date": 1460573795, "creation_date": 1460573795, "answer_id": 36607196, "question_id": 36607195, "link": "https://stackoverflow.com/questions/36607195/how-to-separate-date-format-literals-when-no-separator-is-required/36607196#36607196", "title": "How to separate date format literals when no separator is required", "body": "<p>The trick is to use a separator that is not translated.  Which separator you use is determined by which programming language you are using.  As an example, here is the code for VBA and C#.</p>\n\n<p><strong>VBA:</strong></p>\n\n<pre><code>Const strFormattedTimeFormat As String = \"yyyyMM[]MMM\"\n\nPublic Function strFormattedDate() As String\n    strFormattedDate = Format(Date, strFormattedTimeFormat)\nEnd Function\n</code></pre>\n\n<p><strong>C#:</strong></p>\n\n<pre><code>public static String strFormattedDate()\n{\n    const String sstrDateFormat = \"yyyyMM''MMM\";\n    DateTime dtmLocalDate = DateTime.Now;\n\n    return dtmLocalDate.ToString(sstrDateFormat);\n} \n</code></pre>\n"}], "owner": {"reputation": 1126, "user_id": 1368115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e24bed58b351e881fc981f08bef1877b?s=128&d=identicon&r=PG", "display_name": "DHW", "link": "https://stackoverflow.com/users/1368115/dhw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 36607196, "answer_count": 1, "score": 0, "last_activity_date": 1460573795, "creation_date": 1460573795, "question_id": 36607195, "link": "https://stackoverflow.com/questions/36607195/how-to-separate-date-format-literals-when-no-separator-is-required", "title": "How to separate date format literals when no separator is required", "body": "<p>What date format string would you use in order to display consecutive date format literals so they are interpreted separately, as required?</p>\n\n<p>As an example, if I wish to display March 31, 2016 as \"201603Mar\" - what date format string would I use?</p>\n\n<p>Using \"yyyyMMMMM\" will not give the desired results, since \"MMMMM\" is translated to either \"March\" or \"March3\", depending on the implementation.</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1460572396, "post_id": 36606583, "comment_id": 60810330, "body": "store the email addresses in a collection and check the collection to see if it&#39;s in there before creating an email.  If it is, skip."}, {"owner": {"reputation": 11, "user_id": 6200356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73589fb13fb02953883fe4b5ca416cb8?s=128&d=identicon&r=PG&f=1", "display_name": "SamHink123", "link": "https://stackoverflow.com/users/6200356/samhink123"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1460572708, "post_id": 36606583, "comment_id": 60810531, "body": "The file I use is created from a system report and changes all the time. It&#39;s related to Over Due invoices so a customer could have multiple rows on this spreadsheet. There&#39;s over 3000 rows of records, and multiple new email addresses could be added each time it&#39;s ran (as well as others be removed). So creating and maintaining an address collection could in turn be tedious."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1460573027, "post_id": 36606583, "comment_id": 60810744, "body": "You don&#39;t maintain it.  You use a &quot;Collection&quot; object in the code.  I&#39;ll add an answer."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1460573143, "post_id": 36606583, "comment_id": 60810812, "body": "Why not &quot;Remove Duplicates&quot; from your email list first? Then just run the code. (Or, duplicate the Email column, then remove duplicates, if you want to keep the original list too).  Or, why not check all the cells ABOVE the current cell, and if there&#39;s a <code>like</code> or match, then skip the current row?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6200356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73589fb13fb02953883fe4b5ca416cb8?s=128&d=identicon&r=PG&f=1", "display_name": "SamHink123", "link": "https://stackoverflow.com/users/6200356/samhink123"}, "edited": false, "score": 0, "creation_date": 1460735444, "post_id": 36607118, "comment_id": 60896446, "body": "When I added this to my code, I start getting a Compile error on the &quot;Next cell&quot; line saying &quot;Next without For.&quot; Any idea&#39;s on what would be causing this?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 11, "user_id": 6200356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73589fb13fb02953883fe4b5ca416cb8?s=128&d=identicon&r=PG&f=1", "display_name": "SamHink123", "link": "https://stackoverflow.com/users/6200356/samhink123"}, "edited": false, "score": 0, "creation_date": 1460748486, "post_id": 36607118, "comment_id": 60903954, "body": "Yeah.  There&#39;s an extraneous &quot;End With&quot; in the middle of your code under &quot;.display&quot;  I left it as it was, but I&#39;m guessing if you remove it, the code should compile."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1460573586, "last_edit_date": 1495541760, "creation_date": 1460573586, "answer_id": 36607118, "question_id": 36606583, "link": "https://stackoverflow.com/questions/36606583/how-can-i-create-emails-for-only-unique-addresses-from-a-column-in-excel/36607118#36607118", "title": "How can I create emails for only unique addresses from a column in excel?", "body": "<pre><code> Dim myColl As Collection\n Set myColl = New Collection\n\n With Application\n     .EnableEvents = False\n     .ScreenUpdating = False\n End With\n\n Set sh = Sheets(\"TestSheet\")\n\n Set OutApp = CreateObject(\"Outlook.Application\")    \n\n For Each cell In sh.Columns(\"D\").Cells.SpecialCells(xlCellTypeConstants)\n\n     Set rng = sh.Cells(cell.Row, 1).Range(\"E1:Z1\")\n\n     If cell.Value Like \"?*@?*.?*\" And _\n        Application.WorksheetFunction.CountA(rng) &gt; 0 Then\n         If Not Contains(myColl, CStr(cell.Value)) Then\n                 myColl.Add CStr(cell.Value), CStr(cell.Value)\n                 Set OutMail = OutApp.CreateItem(0)\n                 Set Entity = cell.Offset(0, -3)\n                 Set Quarter = cell.Offset(0, -2)\n                 Set Year = cell.Offset(0, -1)\n                 Set CCRecip = cell.Offset(0, 1)\n\n                 strbody = \"&lt;font face = 'Calibri'&gt;&lt;b&gt;Hello All--&lt;/b&gt;\" &amp; ...\n\n                 signature = \"&lt;br&gt;Thank you,&lt;br&gt;\" &amp; ...\n\n                    .To = cell.Value\n                    .CC = CCRecip.Value\n                    .Subject = Entity.Value \n                    .HTMLBody = strbody &amp; signature             \n                    .display\n                End With                  \n                Set OutMail = Nothing\n\n         End If\n    End If\n\n Next cell\n\n End Sub\n\n Public Function Contains(col As Collection, key As Variant) As Boolean\n     Dim obj As Variant\n     On Error GoTo err\n     Contains = True\n     obj = col(key)\n     Exit Function\n err:\n\n     Contains = False\n End Function\n</code></pre>\n\n<p>Contains function courtesy of Vadim <a href=\"https://stackoverflow.com/a/991900/4560433\">here</a></p>\n"}], "owner": {"reputation": 11, "user_id": 6200356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73589fb13fb02953883fe4b5ca416cb8?s=128&d=identicon&r=PG&f=1", "display_name": "SamHink123", "link": "https://stackoverflow.com/users/6200356/samhink123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1261, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460578263, "creation_date": 1460571941, "question_id": 36606583, "link": "https://stackoverflow.com/questions/36606583/how-can-i-create-emails-for-only-unique-addresses-from-a-column-in-excel", "title": "How can I create emails for only unique addresses from a column in excel?", "body": "<p>Currently, I'm trying to create blast emails to be sent to customers, and there are some duplicate email addresses in the column list. I want to only send one email to each unique email address, but when I run my macro it creates an email for each cell in the column, regardless if there's a repetition of the address earlier/later in the column.\na snippet of my code is below:</p>\n\n<pre><code>With Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\n    Set sh = Sheets(\"TestSheet\")\n\n    Set OutApp = CreateObject(\"Outlook.Application\")    \n\nFor Each cell In sh.Columns(\"D\").Cells.SpecialCells(xlCellTypeConstants)\n\n    Set rng = sh.Cells(cell.Row, 1).Range(\"E1:Z1\")\n\n        If cell.Value Like \"?*@?*.?*\" And _\n            Application.WorksheetFunction.CountA(rng) &gt; 0 Then\n\n                Set OutMail = OutApp.CreateItem(0)\n                Set Entity = cell.Offset(0, -3)\n                Set Quarter = cell.Offset(0, -2)\n                Set Year = cell.Offset(0, -1)\n                Set CCRecip = cell.Offset(0, 1)\n\n                    strbody = \"&lt;font face = 'Calibri'&gt;&lt;b&gt;Hello All--&lt;/b&gt;\" &amp; ...\n\n                    signature = \"&lt;br&gt;Thank you,&lt;br&gt;\" &amp; ...\n\n                        .To = cell.Value\n                        .CC = CCRecip.Value\n                        .Subject = Entity.Value \n                        .HTMLBody = strbody &amp; signature             \n                        .display\n                    End With                  \n                Set OutMail = Nothing\n\n        End If\n\nNext cell\n</code></pre>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1460571147, "post_id": 36606279, "comment_id": 60809576, "body": "<code>MP= Int(Left(CB1.Value,1))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1460571307, "post_id": 36606326, "comment_id": 60809689, "body": "Thanks for the catch @omegastripes"}, {"owner": {"reputation": 7, "user_id": 6195038, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/adb7cd1c8880ac00107ef5bc48e580c1?s=128&d=identicon&r=PG&f=1", "display_name": "amy", "link": "https://stackoverflow.com/users/6195038/amy"}, "edited": false, "score": 0, "creation_date": 1460572961, "post_id": 36606326, "comment_id": 60810699, "body": "I&#39;m getting confused with these quotations, so if i want to write a vlookup instead of adding with D it could be as this:      sh.Range(2,2).Formula= &quot;=&quot; &amp; temp &amp; &quot; + vlookup (....)&quot; ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 7, "user_id": 6195038, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/adb7cd1c8880ac00107ef5bc48e580c1?s=128&d=identicon&r=PG&f=1", "display_name": "amy", "link": "https://stackoverflow.com/users/6195038/amy"}, "edited": false, "score": 0, "creation_date": 1460573271, "post_id": 36606326, "comment_id": 60810885, "body": "@amy yes, as long as the vlookup does not refer to a variable in the sub then it is all in the quotes."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1460571237, "last_edit_date": 1460571237, "creation_date": 1460571176, "answer_id": 36606326, "question_id": 36606279, "link": "https://stackoverflow.com/questions/36606279/how-to-do-left-operation-in-vba-combo-box-user-form-value/36606326#36606326", "title": "how to do left operation in vba combo box user form value?", "body": "<p>A couple of things:</p>\n\n<ol>\n<li><p>Left has two criteria.</p></li>\n<li><p>When using a variable in a string it must be outside the quotes</p></li>\n</ol>\n\n<p>So:</p>\n\n<pre><code>set sh2 = worksheets(\"sheet2\").Listobjects(\"result\")\nMP = Int(Left(CB1.Value,1))\nIf MP = 2 Then\n    temp = worksheets(\"sheet1\").cells(10,5)\n    sh.Range(2,2).Formula= \"=\" &amp; temp &amp; \" + D2\"\nelse \n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6195038, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/adb7cd1c8880ac00107ef5bc48e580c1?s=128&d=identicon&r=PG&f=1", "display_name": "amy", "link": "https://stackoverflow.com/users/6195038/amy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462452011, "creation_date": 1460571010, "last_edit_date": 1531164843, "question_id": 36606279, "link": "https://stackoverflow.com/questions/36606279/how-to-do-left-operation-in-vba-combo-box-user-form-value", "title": "how to do left operation in vba combo box user form value?", "body": "<p>i want to get the the first number on left from the combobox and add different values to that regarding the first number. I did below but it gives me an error.</p>\n\n<pre><code>set sh2 = worksheets(\"sheet2\").Listobjects(\"result\")\nMP= Int(Left(CB1.Value))\nIf MP = 2 Then\n    temp = worksheets(\"sheet1\").cells(10,5)\n    sh.Range(2,2).Formula= \"=temp+ D2\"\nelse \n...\n</code></pre>\n"}, {"tags": ["excel", "vba", "decimal"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1460578166, "post_id": 36606068, "comment_id": 60813897, "body": "You must then have a custom mask on the numbers.  Something like <code>00.00&quot;%&quot;</code> which means the numbers are not true percentages but number mascarading as percentages."}, {"owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1460578300, "post_id": 36606068, "comment_id": 60813977, "body": "No. These are values in the hundreds. I changed back to &gt;= 98.00 and it works! Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1460571369, "post_id": 36606104, "comment_id": 60809731, "body": "Thanks for the catch @tigeravatar"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "edited": false, "score": 1, "creation_date": 1460573457, "post_id": 36606104, "comment_id": 60811028, "body": "@Dombey If you are deleting rows, you need to work from the bottom of the range up, else your algorithm won&#39;t work.  If you are doing that, and still deleting 24.75%, etc, then there is something flakey about your data."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "edited": false, "score": 0, "creation_date": 1460573495, "post_id": 36606104, "comment_id": 60811061, "body": "@Dombey Then you have a mixture of numbers and text that look like numbers."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "edited": false, "score": 0, "creation_date": 1460575127, "post_id": 36606104, "comment_id": 60812058, "body": "@Dombey a quick check would be to select one of the cells, then in the immediate window in the VBE type <code>? Selection.Value</code> and hit enter.  If it returns <code>24.75%</code> then it is a text, if it returns <code>0.2475</code> then it is a number."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "edited": false, "score": 0, "creation_date": 1460577273, "post_id": 36606104, "comment_id": 60813386, "body": "@Dombey One more question, are the percentages in column D?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "edited": false, "score": 0, "creation_date": 1460578477, "post_id": 36606104, "comment_id": 60814094, "body": "@Dombey whew... that took a while, glad to finally resolve the problem.  Thanks for your patience."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 4, "last_activity_date": 1460578342, "last_edit_date": 1460578342, "creation_date": 1460570401, "answer_id": 36606104, "question_id": 36606068, "link": "https://stackoverflow.com/questions/36606068/comparing-decimal-values-excel-vba/36606104#36606104", "title": "Comparing Decimal Values Excel VBA", "body": "<p>Percentages are decimal depicted with integers. For example 100.00% is stored as 1 and 98.01% is stored as .9801.</p>\n\n<p>Therefor you need to adjust the threshold:</p>\n\n<pre><code>For Each i In WSData.Range(\"A7\", WSData.Range(\"A7\").End(xlDown)).Cells\n     If i.Offset(0, 3).Value &gt;= .98 Then\n        i.EntireRow.Delete\n     End If\nNext\n</code></pre>\n\n<p>The second problem is that when deleting rows it is best to iterate backwards.  Otherwise it might miss some rows, because as each row is deleted it is moved up and then the next iteration skips the next row.</p>\n\n<p>Change i from a range to a long and use this:</p>\n\n<pre><code>For  i = WSData.Range(\"A7\").End(xlDown).row to 7 Step -1\n     If WSData.Cells(i,3).Value &gt;= .98 Then\n        Row(i).Delete\n     End If\nNext\n</code></pre>\n\n<p>Edit: Because it appears there is a custom mask on the number format that is forcing numbers to look like percentages try this:</p>\n\n<pre><code>For  i = WSData.Range(\"A7\").End(xlDown).row to 7 Step -1\n     If WSData.Cells(i,3).Value &gt;= 98 Then\n        Row(i).Delete\n     End If\nNext\n</code></pre>\n\n<p>If this works then your main problem was that you were looking at column D.  The offset is additive.  So when you used <code>.offset(0,3)</code> it was moving three columns from column A. 1 + 3 is 4.</p>\n"}], "owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1335, "favorite_count": 0, "accepted_answer_id": 36606104, "answer_count": 1, "score": 0, "last_activity_date": 1460580164, "creation_date": 1460570249, "last_edit_date": 1460580164, "question_id": 36606068, "link": "https://stackoverflow.com/questions/36606068/comparing-decimal-values-excel-vba", "title": "Comparing Decimal Values Excel VBA", "body": "<p>I am trying to compare decimal values in Excel VBA and delete rows that \nmatch the criteria. This was my original code and it skipped over many rows.</p>\n\n<pre><code>For Each i In WSData.Range(\"A7\", WSData.Range(\"A7\").End(xlDown)).Cells\n     If i.Offset(0, 3).Value &gt;= 98 Then\n        i.EntireRow.Delete\n    End If\nNext\n</code></pre>\n\n<p>And the values on the spreadsheet are decimal values just with the % sign.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xR9dl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xR9dl.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried \"> 97.99\" because Excel has some issues with floating point comparison but it still doesn't accurately compare.</p>\n\n<p>Here is what it shows after using Selection.Value.\n<a href=\"https://i.stack.imgur.com/S1d4Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S1d4Y.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ViAYR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ViAYR.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "duplicates"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1460573665, "post_id": 36606017, "comment_id": 60811150, "body": "I cannot copy your screenshots into Excel to work on your problem. And I don&#39;t want to take the time to type it all in manually.  Consider pasting the data into your question as a table rather than as an image."}, {"owner": {"reputation": 11, "user_id": 6036656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7173692e2ff770d312ff1f777a66bb?s=128&d=identicon&r=PG&f=1", "display_name": "G. Hdez", "link": "https://stackoverflow.com/users/6036656/g-hdez"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1460577418, "post_id": 36606017, "comment_id": 60813477, "body": "Thank you Ron for tacking your time to read my question. I have attaced the file to the question. Thanks for your advice. I hope you can help me"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1460579858, "post_id": 36606017, "comment_id": 60814837, "body": "In your sample, it seem the only way to separate the groups is by the fact that there are different numbers of nuts and washers.  Will that always be how groups are differentiated?"}, {"owner": {"reputation": 11, "user_id": 6036656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7173692e2ff770d312ff1f777a66bb?s=128&d=identicon&r=PG&f=1", "display_name": "G. Hdez", "link": "https://stackoverflow.com/users/6036656/g-hdez"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1460584270, "post_id": 36606017, "comment_id": 60817129, "body": "thats one and the other is if the bolt has a different diameter and/or length"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6036656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7173692e2ff770d312ff1f777a66bb?s=128&d=identicon&r=PG&f=1", "display_name": "G. Hdez", "link": "https://stackoverflow.com/users/6036656/g-hdez"}, "edited": false, "score": 0, "creation_date": 1460644119, "post_id": 36612538, "comment_id": 60848280, "body": "Thank you very much! Where can I change in the code so it can get any range, from 1 cell to the largetst range &amp; they can be in different order the washers and nuts.  I also need to sum the weight."}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 0, "last_activity_date": 1460655838, "last_edit_date": 1460655838, "creation_date": 1460599151, "answer_id": 36612538, "question_id": 36606017, "link": "https://stackoverflow.com/questions/36606017/compare-ranges-to-see-if-they-are-equal/36612538#36612538", "title": "Compare Ranges to see if they are equal", "body": "<p>Taking a different approach. </p>\n\n<ol>\n<li>take advantage of the structure; three lines define it</li>\n<li>Put results on a different tab</li>\n</ol>\n\n<p>This input ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/tshJ2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tshJ2.png\" alt=\"enter image description here\"></a></p>\n\n<p>generates this output ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/8qybZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8qybZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>using this code ...</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n\nDim LastRow As Long, LastColumn As Long\nDim wSrc As Worksheet: Set wSrc = Sheets(\"Hoja1\")\nDim tmpSrc As Worksheet\nDim outRng As Range, inRng As Range\nDim iLoop As Long, jLoop As Long, QSum As Long\n\n' turn off updating for speed\nWith Application\n    .ScreenUpdating = False\n    .Calculation = xlCalculationManual\nEnd With\n\n' setup - tmpSrc is the working and final result\nSet tmpSrc = ActiveWorkbook.Sheets.Add(, wSrc)\nSet inRng = wSrc.UsedRange\ninRng.Copy\ntmpSrc.Range(\"A1\").PasteSpecial (xlPasteAll)\n\nWith tmpSrc\n\n    .Name = \"Hoja2\"\n    Set outRng = .UsedRange\n    LastRow = .UsedRange.Rows.Count\n    LastColumn = .UsedRange.Columns.Count\n\nEnd With\n\n' loop down through the range\nFor iLoop = 2 To LastRow\n    If outRng.Cells(iLoop, 1) &lt;&gt; \"\" Then\n\n        QSum = outRng.Cells(iLoop, 1).Value\n        For jLoop = LastRow To iLoop + 1 Step -1 'loop up through the range to find a match\n\n        ' matches are defined by all three rows in column B\n            If outRng.Cells(jLoop, 1) &lt;&gt; \"\" And _\n                outRng.Cells(iLoop, 2) = outRng.Cells(jLoop, 2) And _\n                outRng.Cells(iLoop + 1, 2) = outRng.Cells(jLoop + 1, 2) And _\n                outRng.Cells(iLoop + 2, 2) = outRng.Cells(jLoop + 2, 2) Then\n\n                QSum = QSum + outRng.Cells(jLoop, 1).Value\n                outRng.Rows(jLoop + 2).Delete\n                outRng.Rows(jLoop + 1).Delete\n                outRng.Rows(jLoop).Delete\n                LastRow = LastRow - 3\n\n            End If\n        Next jLoop\n\n        outRng.Cells(iLoop, 1).Value = QSum\n\n    End If\nNext iLoop\n\nFor iLoop = 1 To 3\n    outRng.Columns(iLoop).ColumnWidth = inRng.Columns(iLoop).ColumnWidth\nNext iLoop\n\nWith Application\n    .ScreenUpdating = True\n    .Calculation = xlCalculationAutomatic\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Edit:</p>\n\n<ul>\n<li>Summing weights for bolts, nuts, and washers</li>\n<li>Checking for case where nuts and washers appear in reverse order</li>\n<li>n.b. I am using .UsedRange to find the last row and last column. Other methods are available.</li>\n</ul>\n\n<p>.</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n\nDim LastRow As Long, LastColumn As Long\nDim wSrc As Worksheet: Set wSrc = Sheets(\"Hoja1\")\nDim tmpSrc As Worksheet\nDim outRng As Range, inRng As Range\nDim iLoop As Long, jLoop As Long, QSum As Long\nDim WSum1 As Double, WSum2 As Double, WSum3 As Double\n\n' turn off updating for speed\nWith Application\n    .ScreenUpdating = False\n    .Calculation = xlCalculationManual\nEnd With\n\n' setup - tmpSrc is the working and final result\nSet tmpSrc = ActiveWorkbook.Sheets.Add(, wSrc)\nSet inRng = wSrc.UsedRange\ninRng.Copy\ntmpSrc.Range(\"A1\").PasteSpecial (xlPasteAll)\n\nWith tmpSrc\n    .Name = \"Hoja2\"\n    Set outRng = .UsedRange\n    LastRow = .UsedRange.Rows.Count\n    LastColumn = .UsedRange.Columns.Count\nEnd With\n\n' loop down through the range\nFor iLoop = 2 To LastRow\n    If outRng.Cells(iLoop, 1) &lt;&gt; \"\" Then\n\n\n    QSum = outRng.Cells(iLoop, 1).Value\n    WSum1 = outRng.Cells(iLoop, 3).Value\n    WSum2 = outRng.Cells(iLoop + 1, 3).Value\n    WSum3 = outRng.Cells(iLoop + 2, 3).Value\n    For jLoop = LastRow To iLoop + 1 Step -1 'loop up through the range to find a match\n    ' matches are defined by all three rows in column B\n        If outRng.Cells(jLoop, 1) &lt;&gt; \"\" And _\n        outRng.Cells(iLoop, 2) = outRng.Cells(jLoop, 2) And _\n        outRng.Cells(iLoop + 1, 2) = outRng.Cells(jLoop + 1, 2) And _\n        outRng.Cells(iLoop + 2, 2) = outRng.Cells(jLoop + 2, 2) Then\n\n            QSum = QSum + outRng.Cells(jLoop, 1).Value\n            WSum1 = WSum1 + outRng.Cells(jLoop, 3).Value\n            WSum2 = WSum2 + outRng.Cells(jLoop + 1, 3).Value\n            WSum3 = WSum3 + outRng.Cells(jLoop + 2, 3).Value\n            outRng.Rows(jLoop + 2).Delete\n            outRng.Rows(jLoop + 1).Delete\n            outRng.Rows(jLoop).Delete\n            LastRow = LastRow - 3\n        Else ' check if bolts and washers are in reverse order\n            If outRng.Cells(jLoop, 1) &lt;&gt; \"\" And _\n                outRng.Cells(iLoop, 2) = outRng.Cells(jLoop, 2) And _\n                outRng.Cells(iLoop + 1, 2) = outRng.Cells(jLoop + 2, 2) And _\n                outRng.Cells(iLoop + 2, 2) = outRng.Cells(jLoop + 1, 2) Then\n\n                QSum = QSum + outRng.Cells(jLoop, 1).Value\n                WSum1 = WSum1 + outRng.Cells(jLoop, 3).Value\n                WSum2 = WSum2 + outRng.Cells(jLoop + 2, 3).Value\n                WSum3 = WSum3 + outRng.Cells(jLoop + 1, 3).Value\n                outRng.Rows(jLoop + 2).Delete\n                outRng.Rows(jLoop + 1).Delete\n                outRng.Rows(jLoop).Delete\n                LastRow = LastRow - 3\n            End If\n\n        End If\n    Next jLoop\n\n    outRng.Cells(iLoop, 1).Value = QSum\n    outRng.Cells(iLoop, 3).Value = WSum1\n    outRng.Cells(iLoop + 1, 3).Value = WSum2\n    outRng.Cells(iLoop + 2, 3).Value = WSum3\n\nEnd If\nNext iLoop\n\nFor iLoop = 1 To 3\n    outRng.Columns(iLoop).ColumnWidth = inRng.Columns(iLoop).ColumnWidth\nNext iLoop\n\nWith Application\n    .ScreenUpdating = True\n    .Calculation = xlCalculationAutomatic\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6036656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7173692e2ff770d312ff1f777a66bb?s=128&d=identicon&r=PG&f=1", "display_name": "G. Hdez", "link": "https://stackoverflow.com/users/6036656/g-hdez"}, "edited": false, "score": 0, "creation_date": 1460664778, "post_id": 36632713, "comment_id": 60861426, "body": "Thank you for your time  I Just have a question  What do you mean with &quot;Rename: cHardwareGrp&quot;?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 11, "user_id": 6036656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7173692e2ff770d312ff1f777a66bb?s=128&d=identicon&r=PG&f=1", "display_name": "G. Hdez", "link": "https://stackoverflow.com/users/6036656/g-hdez"}, "edited": false, "score": 0, "creation_date": 1460665769, "post_id": 36632713, "comment_id": 60861958, "body": "When you insert a class module, it will be named something like <code>Class1</code> (just like the regular modules are named <code>Modulo1</code> and worksheets also have a default name.  You need to access the properties and change the name from <code>Class1</code> to the name stated."}, {"owner": {"reputation": 11, "user_id": 6036656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7173692e2ff770d312ff1f777a66bb?s=128&d=identicon&r=PG&f=1", "display_name": "G. Hdez", "link": "https://stackoverflow.com/users/6036656/g-hdez"}, "edited": false, "score": 0, "creation_date": 1460667076, "post_id": 36632713, "comment_id": 60862705, "body": "It Works perfectly!! thank you, I really appreciate it. I know that this will be too much  but how do you add a sorting routin to the group generation so that will be irrelevant the order?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 11, "user_id": 6036656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7173692e2ff770d312ff1f777a66bb?s=128&d=identicon&r=PG&f=1", "display_name": "G. Hdez", "link": "https://stackoverflow.com/users/6036656/g-hdez"}, "edited": false, "score": 0, "creation_date": 1460667495, "post_id": 36632713, "comment_id": 60862918, "body": "@G.Hdez Since the list of hardware components will be small, I would probably sort by ensuring that the Hardware object (<code>cHardware</code>) is inserted into the collection in the group in sorted order.  That would mean modifying the <code>AddHW</code> function in the <code>cHardwareGrp</code> class module."}, {"owner": {"reputation": 11, "user_id": 6036656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7173692e2ff770d312ff1f777a66bb?s=128&d=identicon&r=PG&f=1", "display_name": "G. Hdez", "link": "https://stackoverflow.com/users/6036656/g-hdez"}, "edited": false, "score": 0, "creation_date": 1460667704, "post_id": 36632713, "comment_id": 60863028, "body": "Ok, to be honest I don&#39;t have any Idea how to do that. I have never used clases before."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 11, "user_id": 6036656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7173692e2ff770d312ff1f777a66bb?s=128&d=identicon&r=PG&f=1", "display_name": "G. Hdez", "link": "https://stackoverflow.com/users/6036656/g-hdez"}, "edited": false, "score": 0, "creation_date": 1460668929, "post_id": 36632713, "comment_id": 60863588, "body": "@G.Hdez For the purposes of sorting, the location of the code (Class or Regular module) is irrelevant. I&#39;ll see if I can work something out."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 11, "user_id": 6036656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7173692e2ff770d312ff1f777a66bb?s=128&d=identicon&r=PG&f=1", "display_name": "G. Hdez", "link": "https://stackoverflow.com/users/6036656/g-hdez"}, "edited": false, "score": 0, "creation_date": 1460670798, "post_id": 36632713, "comment_id": 60864473, "body": "@G.Hdez OK, I modified that function so as to insert the HW items in sorted order.  It is a normal, ascending sort using VBA&#39;s default binary comparison.  I think this insertion sort will be fast enough since you only have a few items in each group -- but if you have 100&#39;s or more, you may want to use a different algorithm.  Also, you can probably make it a descending sort, which would return the bolts to &quot;first place&quot;, by reversing the comparison operator in the sort, and leaving everything else the same."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1460716075, "last_edit_date": 1460716075, "creation_date": 1460663613, "answer_id": 36632713, "question_id": 36606017, "link": "https://stackoverflow.com/questions/36606017/compare-ranges-to-see-if-they-are-equal/36632713#36632713", "title": "Compare Ranges to see if they are equal", "body": "<p>Here is an approach that utilizes User Defined Object for the Hardware, and Hardware groups.</p>\n\n<p>We could create more compact code with fewer loops, but, unless there is a significant speed issue, this is probably more readable, and can be more easily adapted to future needs.</p>\n\n<p>We create two class modules (<strong>and be sure to rename them as indicated in the code</strong>).\nOne class module is for the hardware items, the second is for the different groups.</p>\n\n<p>The hardware items properties are the description, the weight per item, and the number of items.</p>\n\n<p>The hardware groups properties are a collection of Hardware items, and the Quantity of items in that group.</p>\n\n<p>We then combine the hardware groups into a collection of unique hardware groups.</p>\n\n<p>As the code is written, you could combine in other ways to generate other types of reports.</p>\n\n<p>The results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Yu74G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yu74G.png\" alt=\"enter image description here\"></a></p>\n\n<h2>Class Module 1</h2>\n\n<hr>\n\n<pre><code>'**Rename:  cHardware**\n\nOption Explicit\nPrivate pDescription As String\nPrivate pWt As Double\nPrivate pItemCount As Long\n\nPublic Property Get Description() As String\n    Description = pDescription\nEnd Property\nPublic Property Let Description(Value As String)\n    pDescription = Value\nEnd Property\n\nPublic Property Get Wt() As Double\n    Wt = pWt\nEnd Property\nPublic Property Let Wt(Value As Double)\n    pWt = Value\nEnd Property\n\nPublic Property Get ItemCount() As Long\n    ItemCount = pItemCount\nEnd Property\nPublic Property Let ItemCount(Value As Long)\n    pItemCount = Value\nEnd Property\n</code></pre>\n\n<hr>\n\n<h2>Class Module 2</h2>\n\n<hr>\n\n<pre><code>'**Rename: cHardwareGrp**\n\nOption Explicit\nPrivate pHW As cHardWare\nPrivate pHWs As Collection\nPrivate pQty As Long\n\nPrivate Sub Class_Initialize()\n    Set pHWs = New Collection\nEnd Sub\n\nPublic Property Get HW() As cHardWare\n    Set HW = pHW\nEnd Property\nPublic Property Let HW(Value As cHardWare)\n    Set pHW = Value\nEnd Property\n\nPublic Property Get HWs() As Collection\n    Set HWs = pHWs\nEnd Property\nPublic Function AddHW(Value As cHardWare)\nDim I As Long, J As Long\n    If pHWs.Count = 0 Then\n        pHWs.Add Value\n    Else 'Insert in sorted order\n        For J = pHWs.Count To 1 Step -1\n            If pHWs(J).Description &lt;= Value.Description Then Exit For\n        Next J\n        If J = 0 Then\n            pHWs.Add Value, before:=1\n        Else\n            pHWs.Add Value, after:=J\n        End If\n    End If\nEnd Function    \nPublic Property Get Qty() As Long\n    Qty = pQty\nEnd Property\nPublic Property Let Qty(Value As Long)\n    pQty = Value\nEnd Property\n</code></pre>\n\n<hr>\n\n<h2>Regular Module</h2>\n\n<hr>\n\n<pre><code>Option Explicit\nSub SummarizeHW()\n    Dim wsRes As Worksheet, wsSrc As Worksheet, rRes As Range\n    Dim vSrc As Variant, vRes() As Variant\n    Dim cHW As cHardWare, colHW As Collection\n    Dim cHWG As cHardwareGrp, colHWG As Collection\n    Dim colUniqueHWG As Collection\n    Dim I As Long, J As Long, K As Long\n    Dim lQTY As Long\n    Dim S As String\n    Dim V As Variant\n\n    Dim RE As Object, MC As Object\n\n'Set Source and Results Worksheets and Ranges\nSet wsSrc = Worksheets(\"Hoja1\")\nSet wsRes = Worksheets(\"Hoja2\")\n    Set rRes = wsRes.Cells(1, 1)\n\n'Get Source Data\nWith wsSrc\n    vSrc = .Range(.Cells(1, 2), .Cells(.Rows.Count, 2).End(xlUp)) _\n        .Offset(columnoffset:=-1).Resize(columnsize:=3)\nEnd With\n\n'Set up regex to extract number of HW items in description\nSet RE = CreateObject(\"vbscript.regexp\")\nWith RE\n    .Global = False\n    .Pattern = \"^\\((\\d+)\\)\\s*\"\n    .MultiLine = True\nEnd With\n\n'Collect unique list of hardware items\n' compute the weight of each single item\nSet colHW = New Collection\nOn Error Resume Next\nFor I = 2 To UBound(vSrc, 1) 'assumes header row\n    If vSrc(I, 1) &lt;&gt; \"\" Then lQTY = vSrc(I, 1)\n    Set cHW = New cHardWare\n    With cHW\n        S = vSrc(I, 2)\n        If RE.test(S) = True Then\n            Set MC = RE.Execute(S)\n            .ItemCount = CLng(MC(0).submatches(0))\n        Else\n            .ItemCount = 1\n        End If\n            .Wt = vSrc(I, 3) / lQTY / .ItemCount\n        .Description = S\n        colHW.Add cHW, .Description\n    End With\nNext I\nOn Error GoTo 0\n\n'Collect the Hardware Groups\n'HW group starts if there is a \"Qty\" in column 1\nSet colHWG = New Collection\nFor I = 2 To UBound(vSrc, 1)\n    If vSrc(I, 1) &lt;&gt; \"\" Then lQTY = vSrc(I, 1)\n    Set cHWG = New cHardwareGrp\n\n    Do\n    With cHWG\n        .HW = colHW(vSrc(I, 2))\n        .AddHW .HW\n        .Qty = lQTY\n    End With\n    I = I + 1\n    If I &gt; UBound(vSrc, 1) Then Exit Do\n    Loop Until vSrc(I, 1) &lt;&gt; \"\"\n\n    colHWG.Add cHWG\n    I = I - 1\nNext I\n\n'Collect the unique hardware groups\n' A group is defined by ALL of the hardware components being identical\n' in both type and quantity.  Therefore, we can concatenate them as a key\n\nSet colUniqueHWG = New Collection\nOn Error Resume Next\nFor I = 1 To colHWG.Count\n    With colHWG(I)\n        ReDim V(1 To .HWs.Count)\n        For J = 1 To UBound(V)\n            V(J) = .HWs(J).Description\n        Next J\n        S = Join(V, \"|\")\n        colUniqueHWG.Add colHWG(I), S\n        Select Case Err.Number\n            Case 457 'a duplicate so add the QTY\n                colUniqueHWG(S).Qty = colUniqueHWG(S).Qty + .Qty\n                Err.Clear\n            Case Is &lt;&gt; 0 'error stop\n                Debug.Print Err.Number, Err.Description\n        End Select\n    End With\nNext I\nOn Error GoTo 0\n\n'Final Report\n'# of columns = 3\n'# of rows = sum of the number of HW items in each group + 1 for the header\nJ = 0\nFor I = 1 To colUniqueHWG.Count\n    J = J + colUniqueHWG(I).HWs.Count\nNext I\n\nReDim vRes(0 To J, 1 To 3)\n'Column headers\nvRes(0, 1) = \"Qty\"\nvRes(0, 2) = \"Hardware Description\"\nvRes(0, 3) = \"Weight\"\n\n'populate the results array'\nK = 1\nFor I = 1 To colUniqueHWG.Count\n    With colUniqueHWG(I)\n        For J = 1 To .HWs.Count\n            If J = 1 Then vRes(K, 1) = .Qty\n            vRes(K, 2) = .HWs(J).Description\n            vRes(K, 3) = .Qty * .HWs(J).Wt * .HWs(J).ItemCount\n            K = K + 1\n        Next J\n    End With\nNext I\n\n'Write the results on a new sheet\nSet rRes = rRes.Resize(UBound(vRes, 1) + 1, UBound(vRes, 2))\nWith rRes\n    .EntireColumn.Clear\n    .Value = vRes\n    .ColumnWidth = 255\n    With Rows(1)\n        .Font.Bold = True\n        .HorizontalAlignment = xlCenter\n    End With\n    .EntireColumn.AutoFit\nEnd With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Hmmm.  I see from your comments that the hardware may not always be in the same order.  I will add a sorting routine to our group generation so that will be irrelevant.</p>\n\n<p><strong>EDIT</strong>:  The AddHW function was modified to insert the HW items in sorted order.  Since there should only be a few items, this insertion sort should be adequate.</p>\n"}], "owner": {"reputation": 11, "user_id": 6036656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7173692e2ff770d312ff1f777a66bb?s=128&d=identicon&r=PG&f=1", "display_name": "G. Hdez", "link": "https://stackoverflow.com/users/6036656/g-hdez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 36632713, "answer_count": 2, "score": 0, "last_activity_date": 1460716075, "creation_date": 1460570076, "last_edit_date": 1460577348, "question_id": 36606017, "link": "https://stackoverflow.com/questions/36606017/compare-ranges-to-see-if-they-are-equal", "title": "Compare Ranges to see if they are equal", "body": "<p>I am working on my computer to automate a quote in Excel with VBA\nIt consists of finding duplicates so they can be summed.</p>\n\n<p>For example:</p>\n\n<p>I have the following information: </p>\n\n<p><a href=\"https://www.dropbox.com/s/oyigulk56g8xou4/Woorkbook1.xlsm?dl=0\" rel=\"nofollow noreferrer\">Click here</a> for the Excel file</p>\n\n<p>The range from A2:C4 is a group that it states there are 28 bolts, 1 nut for each bolt &amp; 1 washer for each bolt.</p>\n\n<p>A5:C7 is another group that is the same 28 bolts, 1 nut for each bolt &amp; 1 washer for each bolt.</p>\n\n<p>A11:C13 is another group but the difference is that for this one are 2 nuts &amp; 2 washer per bolt.</p>\n\n<p>So this wont be sum</p>\n\n<p>This would be the result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/J9rs1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J9rs1.jpg\" alt=\"Output Information\"></a></p>\n\n<p>I have the following code where it only looks through all the cells, I can't find a way to make it look in groups or ranges.</p>\n\n<pre><code>Sub Macro1()\n\nDim LastRow As Long, LastColumn As Long\nDim wSrc As Worksheet: Set wSrc = Sheets(\"Hoja1\")\n\nWith Application\n    .ScreenUpdating = False\n    .Calculation = xlCalculationManual\nEnd With\n\nWith wSrc\n    LastRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n    Set rng = .Range(\"B1:B\" &amp; LastRow)\n    LastColumn = .Cells(1, .Columns.Count).End(xlToLeft).Column + 2\n    rng.AdvancedFilter Action:=xlFilterCopy, copytoRange:=.Cells(1, LastColumn), unique:=True\n    Z = .Cells(.Rows.Count, LastColumn).End(xlUp).Row\n    LastColumn = LastColumn + 1\n    .Cells(1, LastColumn).Value = \"Total\"\n    .Range(.Cells(2, LastColumn), .Cells(Z, LastColumn)).Formula = _\n        \"=SUMIF(\" &amp; rng.Address &amp; \",\" &amp; .Cells(2, LastColumn - 1).Address(False, False) &amp; \",\" &amp; rng.Offset(, 1).Address &amp; \")\"\nEnd With\n\nWith Application\n    .ScreenUpdating = Truek\n    .Calculation = xlCalculationAutomatic\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Click below for the Excel file</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "answers": [{"comments": [{"owner": {"reputation": 200, "user_id": 5024605, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/15efe9db962038121154688795014a40?s=128&d=identicon&r=PG&f=1", "display_name": "SunRay", "link": "https://stackoverflow.com/users/5024605/sunray"}, "edited": false, "score": 0, "creation_date": 1460571995, "post_id": 36606092, "comment_id": 60810105, "body": "I have tried eliminating all requeries from the from&#39;s event but i am still getting the same error. the funny thing is that if i set the control source as cbo.column(1).value it works"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1460576097, "last_edit_date": 1460576097, "creation_date": 1460570345, "answer_id": 36606092, "question_id": 36605863, "link": "https://stackoverflow.com/questions/36605863/error-424-when-trying-to-get-a-value-form-combobox-in-on-activate-event/36606092#36606092", "title": "Error 424 when trying to get a value form combobox in ON Activate event", "body": "<p>When you requery the combobox, it looses its value (if it is unbound as it seems), and then neither column(1) has a value.</p>\n\n<p>So after the requery, set the combobox to some value - or rethink your concept.</p>\n\n<p>Edit:</p>\n\n<p>Property <code>Column(n)</code> carries no (sub)properties, thus:</p>\n\n<pre><code>    Me.txtMin_DailyDose.Value = Me.cboActive_Name.Column(1)\n    Me.txtADE_PDE.Value = Me.cboActive_Name.Column(2)\n    Me.txtTTC.Value = Me.cboActive_Name.Column(3)\n</code></pre>\n"}], "owner": {"reputation": 200, "user_id": 5024605, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/15efe9db962038121154688795014a40?s=128&d=identicon&r=PG&f=1", "display_name": "SunRay", "link": "https://stackoverflow.com/users/5024605/sunray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 36606092, "answer_count": 1, "score": 0, "last_activity_date": 1594642318, "creation_date": 1460569550, "last_edit_date": 1594642318, "question_id": 36605863, "link": "https://stackoverflow.com/questions/36605863/error-424-when-trying-to-get-a-value-form-combobox-in-on-activate-event", "title": "Error 424 when trying to get a value form combobox in ON Activate event", "body": "<p>I have been trying use the value in the combo box however the combobox will be locked if the revision num > 0 </p>\n\n<p>it gives me an error when i put it in the ON ACTIVATE event\ni got the error 424 on         <code>Me.txtMin_DailyDose.Value = Me.cboActive_Name.Column(1).Value</code></p>\n\n<pre><code> Private Sub Form_Activate()\n    Me.Requery\n\n    ' prevents user from changing the client, chemical, active name once the     \n      revision number has become 1 or more\n    If Me.txtRev.Value &gt; 0 Then\n        Me.cboClient_Name.Locked = True\n        Me.cboChemical_Name.Locked = True\n        Me.cboActive_Name.Locked = True\n        Me.cboActive_Name.Requery\n        Me.txtMin_DailyDose.Value = Me.cboActive_Name.Column(1).Value\n        Me.txtADE_PDE.Value = Me.cboActive_Name.Column(2).Value\n        Me.txtTTC.Value = Me.cboActive_Name.Column(3).Value\n    End If\n\n    End Sub\n</code></pre>\n\n<p>Is there anyway i can solve this problem?</p>\n"}, {"tags": ["vba", "date", "max"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1460569230, "post_id": 36605728, "comment_id": 60808417, "body": "So what is this code doing or not doing that is incorrect?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1460569284, "post_id": 36605728, "comment_id": 60808459, "body": "get rid of the <code>.value</code> at the end it is not part of the worksheet function"}, {"owner": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1460569402, "post_id": 36605728, "comment_id": 60808534, "body": "It gives me some numbers as output. But the numbers has no thing to do with the date that I am looking for.. Thanks Scott."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1460569554, "post_id": 36605728, "comment_id": 60808617, "body": "Are the number like <code>42056</code>?  If so that is the numerical form of the date.  Try <code>msgbox Cdate(max_date)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 625, "user_id": 5759254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kChhb.jpg?s=128&g=1", "display_name": "Kapocsi", "link": "https://stackoverflow.com/users/5759254/kapocsi"}, "is_accepted": true, "score": 1, "last_activity_date": 1460640969, "last_edit_date": 1460640969, "creation_date": 1460569704, "answer_id": 36605896, "question_id": 36605728, "link": "https://stackoverflow.com/questions/36605728/how-to-find-the-most-recent-date-in-a-date-column-using-vba/36605896#36605896", "title": "How to find the most recent date in a date column using VBA", "body": "<p>Remove \".value\" from your first line of code.</p>\n\n<pre><code>Max_date = Application.WorksheetFunction.Max(Columns(\"X\"))\nMsgBox Max_date\n</code></pre>\n\n<p>This returns the number that represents the date in Microsoft Excel date-time code.</p>\n\n<p>To echo Scott Craner's comment, use the following to display the date formatted version of the number.</p>\n\n<pre><code>Max_date = Application.WorksheetFunction.Max(Columns(\"X\"))\nMsgBox cDate(Max_date)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1460569895, "creation_date": 1460569895, "answer_id": 36605962, "question_id": 36605728, "link": "https://stackoverflow.com/questions/36605728/how-to-find-the-most-recent-date-in-a-date-column-using-vba/36605962#36605962", "title": "How to find the most recent date in a date column using VBA", "body": "<p>MsgBox CDate(Max_date) will do it.</p>\n\n<p>Dates are represented as numbers in Excel, with typical values around 40000.</p>\n\n<p>CDate converts that number to a VBA date type.</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1460570829, "last_edit_date": 1460570829, "creation_date": 1460570329, "answer_id": 36606086, "question_id": 36605728, "link": "https://stackoverflow.com/questions/36605728/how-to-find-the-most-recent-date-in-a-date-column-using-vba/36606086#36606086", "title": "How to find the most recent date in a date column using VBA", "body": "<p>So there are a couple of ways to deal with this:</p>\n\n<p>First you can deal with it at the time of the output by using CDate():</p>\n\n<pre><code>Max_date = Application.WorksheetFunction.Max(Columns(\"X\"))\nMsgBox CDate(Max_date)\n</code></pre>\n\n<p>Second You can declare the Max_date as a date and it will automatically make the switch:</p>\n\n<pre><code>Dim Max_date as Date\nMax_date = Application.WorksheetFunction.Max(Columns(\"X\"))\nMsgBox Max_date\n</code></pre>\n\n<p>Personally I prefer the second as it will not allow non date values to be entered in the first place.</p>\n"}], "owner": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14999, "favorite_count": 0, "accepted_answer_id": 36605896, "answer_count": 3, "score": 1, "last_activity_date": 1460640969, "creation_date": 1460569150, "last_edit_date": 1460569190, "question_id": 36605728, "link": "https://stackoverflow.com/questions/36605728/how-to-find-the-most-recent-date-in-a-date-column-using-vba", "title": "How to find the most recent date in a date column using VBA", "body": "<p>I have a column of dates which are linked to other data and I am happy with how they are sorted. So without sorting the data in the excel sheet I need to find the most recent and the oldest dates in that column.</p>\n\n<p>I have had the following code so far which are not that helpful.</p>\n\n<pre><code>Max_date = Application.WorksheetFunction.Max(Columns(\"X\")).Value\n\nMsgBox Max_date\n</code></pre>\n\n<p>Thanks\nH</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2182, "user_id": 1095863, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fae78242e84e97f38efc0be874c58136?s=128&d=identicon&r=PG&f=1", "display_name": "mani_nz", "link": "https://stackoverflow.com/users/1095863/mani-nz"}, "edited": false, "score": 0, "creation_date": 1460628311, "post_id": 36606760, "comment_id": 60835661, "body": "Thanks for the nice formula but I think there seems to be an error. I just brings the maximum value i.e. 15 for XYZ. If you just replace B5 to 20, then 20 will be highlighted."}, {"owner": {"reputation": 2182, "user_id": 1095863, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fae78242e84e97f38efc0be874c58136?s=128&d=identicon&r=PG&f=1", "display_name": "mani_nz", "link": "https://stackoverflow.com/users/1095863/mani-nz"}, "edited": false, "score": 0, "creation_date": 1460631765, "post_id": 36606760, "comment_id": 60838030, "body": "I think my question was little vague. I wanted to highlight the number that occurred the most. Not the highest in value. I have updated the example above."}, {"owner": {"reputation": 2182, "user_id": 1095863, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fae78242e84e97f38efc0be874c58136?s=128&d=identicon&r=PG&f=1", "display_name": "mani_nz", "link": "https://stackoverflow.com/users/1095863/mani-nz"}, "edited": false, "score": 0, "creation_date": 1460965021, "post_id": 36606760, "comment_id": 60964519, "body": "Thanks again for the response. The formula seems to break if ABC has three different values. It highlights all the values if it couldn&#39;t find a maximum occurrence for a single value. Is there a way to use MODE? I&#39;m quite new to excel so sorry if I&#39;m being rudimentary. Appreciate your help."}, {"owner": {"reputation": 2182, "user_id": 1095863, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fae78242e84e97f38efc0be874c58136?s=128&d=identicon&r=PG&f=1", "display_name": "mani_nz", "link": "https://stackoverflow.com/users/1095863/mani-nz"}, "edited": false, "score": 0, "creation_date": 1461138185, "post_id": 36606760, "comment_id": 61056571, "body": "I found another way to fix the gap in the formula.Thanks for this wonderful formula. I wouldn&#39;t have got this in a million years!! Thanks :)"}, {"owner": {"reputation": 2182, "user_id": 1095863, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fae78242e84e97f38efc0be874c58136?s=128&d=identicon&r=PG&f=1", "display_name": "mani_nz", "link": "https://stackoverflow.com/users/1095863/mani-nz"}, "edited": false, "score": 0, "creation_date": 1463648115, "post_id": 36606760, "comment_id": 62156483, "body": "Is it possible to tweak this formula? I have 60,000 rows and excel crashes with the current formula. Thanks!!"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 2182, "user_id": 1095863, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fae78242e84e97f38efc0be874c58136?s=128&d=identicon&r=PG&f=1", "display_name": "mani_nz", "link": "https://stackoverflow.com/users/1095863/mani-nz"}, "edited": false, "score": 0, "creation_date": 1463670036, "post_id": 36606760, "comment_id": 62173186, "body": "@mani_nz In that case, instead of a conditional format formula you would be much better off with a pivot table.  The pivot will show the unique entries for your HeaderA, and then you can tell it to show the maximum values for your HeaderB.  It uses significantly less resources than formulas or VBA, and you can right-click on the pivot table and select Refresh to have it update when new data is added.  You can put the Pivot table on a separate worksheet if preferred."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1460646272, "last_edit_date": 1460646272, "creation_date": 1460572470, "answer_id": 36606760, "question_id": 36605342, "link": "https://stackoverflow.com/questions/36605342/highlight-the-maximum-occurance-within-a-table/36606760#36606760", "title": "Highlight the maximum occurance within a table", "body": "<p>First, I highly recommend having your column A value in every row of column A.  So, assuming your data setup looks like this:</p>\n\n<p>(updated image)</p>\n\n<p><a href=\"https://i.stack.imgur.com/ozWgR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ozWgR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then select cell B2 and create a new conditional format via formula.  The conditional format formula is (updated):</p>\n\n<pre><code>=AND(COUNTIFS($A$2:$A2,$A2,$B$2:$B2,$B2)=1,COUNTIFS($A$2:$A$7,$A2,$B$2:$B$7,$B2)=MAX(INDEX(COUNTIFS($A$2:$A$7,$A2,$B$2:$B$7,$B$2:$B$7),)))\n</code></pre>\n\n<p>And as you can see based on the above screenshot, it highlights the first <code>10</code> for value <code>ABC</code> and it highlights the first <code>15</code> for value <code>XYZ</code></p>\n\n<p>Adjust the conditional format formula ranges to suit your actual data.</p>\n\n<p><strong>EDIT</strong>: Updated answer based on comments and updated question from OP</p>\n"}], "owner": {"reputation": 2182, "user_id": 1095863, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fae78242e84e97f38efc0be874c58136?s=128&d=identicon&r=PG&f=1", "display_name": "mani_nz", "link": "https://stackoverflow.com/users/1095863/mani-nz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 36606760, "answer_count": 1, "score": 0, "last_activity_date": 1460646272, "creation_date": 1460567930, "last_edit_date": 1531161705, "question_id": 36605342, "link": "https://stackoverflow.com/questions/36605342/highlight-the-maximum-occurance-within-a-table", "title": "Highlight the maximum occurance within a table", "body": "<p>I have created a pivot table with Column A and Column B. Column A has one to many relation with Column B.</p>\n\n<p>I want to highlight the value in Column B which occurs many times in its scope with value in Column A. For example in the below table, I want 10 to be highlighted for ABC and 15 to be highlighted for XYZ scope.</p>\n\n<pre><code>COLA        COLB\nABC          10\nABC          10\nABC          15\nXYZ          10\nXYZ          15\nXYZ          15\n</code></pre>\n\n<p>If there is a tie, any one value needs to be highlighted.</p>\n\n<p>Cheers!!</p>\n"}, {"tags": ["excel", "loops", "vba"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1460567674, "last_edit_date": 1495539911, "creation_date": 1460567674, "answer_id": 36605268, "question_id": 36605194, "link": "https://stackoverflow.com/questions/36605194/vba-macro-loop-for-simple-formatting/36605268#36605268", "title": "VBA Macro Loop for simple formatting", "body": "<p>You need to assign the correct parentage to all range object or it will only refer to the active sheet.</p>\n\n<pre><code>Sub MQA_Shrink()\nDim sht As Worksheet\nFor Each sht In ThisWorkbook.Worksheets\n    sht.Range(\"B:B,D:D,H:I,K:O\").Delete Shift:=xlToLeft\n    sht.Columns(\"B:F\").AutoFit\n    With sht.Range(\"A1:F1\")\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n        .Merge\n    End With\nNext sht\n\nEnd Sub\n</code></pre>\n\n<p>Also after using the macro recorder one should go through and remove all the <code>.Select</code> and <code>.Activate</code> it slows down the code.  See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">HERE</a></p>\n"}], "owner": {"reputation": 11, "user_id": 6200070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef88835fb7b43ad8fef38d3f2735a22?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6200070/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 400, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1460567674, "creation_date": 1460567431, "last_edit_date": 1531164843, "question_id": 36605194, "link": "https://stackoverflow.com/questions/36605194/vba-macro-loop-for-simple-formatting", "title": "VBA Macro Loop for simple formatting", "body": "<p>I have a few basic macros, but I'd like to add a looping function to each.  I'm looking for the starting code to kick of a loop and the ending code to close a loop on the last active worksheet.</p>\n\n<p>Here is the current code:</p>\n\n<pre><code>Sub MQA_Shrink()\n'\n'\n'\nFor Each sht In ThisWorkbook.Worksheets\nRange(\"B:B,D:D,H:I,K:O\").Select\nRange(\"K1\").Activate\nSelection.Delete Shift:=xlToLeft\nActiveWindow.ScrollColumn = 1\nColumns(\"B:F\").Select\nColumns(\"B:F\").EntireColumn.AutoFit\nRange(\"A1:F1\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlBottom\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nSelection.Merge\nNext sht\n\nEnd Sub\n</code></pre>\n\n<p>I'd just like this basic formatting macro to cycle through all the tabs and end.</p>\n\n<p>I've mashed up different examples I've seen on here, but nothing seems to cycle through properly.  They were all specifically tailored to the requester's project.  Any advice?</p>\n"}, {"tags": ["mysql", "vba", "excel", "macros"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1460565731, "post_id": 36604584, "comment_id": 60806271, "body": "Build a cross-reference lookup table and match. tbh, I don&#39;t see why the native worksheet <a href=\"https://support.office.com/en-us/article/vlookup-function-adceda66-30de-4f26-923b-7257939faa65\" rel=\"nofollow noreferrer\">VLOOKUP function</a> could not be used unless you <b>want</b> to write out ~150 different scenarios."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1460565932, "post_id": 36604584, "comment_id": 60806402, "body": "What does this have to do with mysql?"}, {"owner": {"reputation": 37, "user_id": 6193662, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dfee15f7df7b13d14a089528f37407b0?s=128&d=identicon&r=PG&f=1", "display_name": "Alec Terry", "link": "https://stackoverflow.com/users/6193662/alec-terry"}, "edited": false, "score": 0, "creation_date": 1460718889, "post_id": 36604584, "comment_id": 60884488, "body": "Hi Jeeped, that&#39;s actually a really good point.  It&#39;s just that I have to create this matrix usually about 10 times per week to satisfy different requests that my managers make of me to see certain products, options, etc.  So it just eliminates a step for me by having the information written out in VBA as opposed to attaching the table every time."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1460566310, "last_edit_date": 1460566310, "creation_date": 1460565918, "answer_id": 36604732, "question_id": 36604584, "link": "https://stackoverflow.com/questions/36604584/how-do-i-apply-the-same-if-statements-to-multiple-cells-in-the-same-column-exc/36604732#36604732", "title": "How do I apply the same IF statements to multiple cells in the same column? (EXCEL)", "body": "<p>I would do what @Jeeped suggested in the comments but if you really want to do it in vba then:</p>\n\n<pre><code>Private Sub Option_Matrix_2()\nDim cl As Range\nDim ws As Worksheet\n\nSet ws = Sheets(\"Sheet1\") ' change to your sheet\n'Enters data for Option code Description into worksheet\nFor Each cl In ws.Range(\"G4:G3000\")\n    If cl.FormulaR1C1 = \"AAAA\" Then\n        cl.Offset(, 1).FormulaR1C1 = \"Description 1\"\n    ElseIf cl.FormulaR1C1 = \"CCCCC\" Then\n        cl.Offset(, 1).FormulaR1C1 = \"Description 2\"\n    ElseIf cl.FormulaR1C1 = \"EEEEE\" Then\n        cl.Offset(, 1).FormulaR1C1 = \"Description 3\"\n    Else\n    cl.Offset(, 1).FormulaR1C1 = \"\"\n    End If\nNext cl\nEnd Sub\n</code></pre>\n\n<p>Or better yet use Select Case:</p>\n\n<pre><code>Private Sub Option_Matrix_2()\nDim cl As Range\nDim ws As Worksheet\n\nSet ws = Sheets(\"Sheet1\") ' change to your sheet\n'Enters data for Option code Description into worksheet\nFor Each cl In ws.Range(\"G4:G3000\")\n    Select Case cl\n        Case \"AAAA\": cl.Offset(, 1) = \"Description 1\"\n        Case \"CCCC\": cl.Offset(, 1) = \"Description 2\"\n        Case \"EEEE\": cl.Offset(, 1) = \"Description 3\"\n        Case Else: cl.Offset(, 1) = \"\"\n    End Select\nNext cl\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1460567886, "creation_date": 1460567886, "answer_id": 36605331, "question_id": 36604584, "link": "https://stackoverflow.com/questions/36604584/how-do-i-apply-the-same-if-statements-to-multiple-cells-in-the-same-column-exc/36605331#36605331", "title": "How do I apply the same IF statements to multiple cells in the same column? (EXCEL)", "body": "<p>you could try this</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Option_Matrix_3()\n\nWith Sheets(\"Sheet01\").Range(\"G4:G3000\") ' change to your actual sheet name and range\n    .Copy\n    With .Offset(, 1)\n        .PasteSpecial xlPasteValues\n\n        .Replace What:=\"AAAA\", LookAt:=xlWhole, Replacement:=\"Description 1\", SearchOrder:=xlByColumns, MatchCase:=True\n        .Replace What:=\"CCCCC\", LookAt:=xlWhole, Replacement:=\"Description 2\", SearchOrder:=xlByColumns, MatchCase:=True\n        .Replace What:=\"EEEEE\", LookAt:=xlWhole, Replacement:=\"Description 3\", SearchOrder:=xlByColumns, MatchCase:=True\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>seems quite fast!</p>\n"}], "owner": {"reputation": 37, "user_id": 6193662, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dfee15f7df7b13d14a089528f37407b0?s=128&d=identicon&r=PG&f=1", "display_name": "Alec Terry", "link": "https://stackoverflow.com/users/6193662/alec-terry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1460567886, "creation_date": 1460565494, "question_id": 36604584, "link": "https://stackoverflow.com/questions/36604584/how-do-i-apply-the-same-if-statements-to-multiple-cells-in-the-same-column-exc", "title": "How do I apply the same IF statements to multiple cells in the same column? (EXCEL)", "body": "<p>I'm currently working on a macro to create a matrix of different products and option codes for work.  Most of the information I need has already been exported from an order creation system we run.  One of the things that does not export, however, are the descriptions for the roughly 150 option codes.  Each option code comes with a description that is outlined in a separate worksheet, so instead of having to always refer back to the other worksheet I have decided to program the descriptions into the code using IF statements.  My goal is to write a program that looks at each option code in the column, then insert the matching description of that option code in the adjacent column.  </p>\n\n<p>For example:\nMy program would say:  If the active cell says \"AAAAA\" then select the cell one unit offset horizontally and insert \"Option 1\".  Else, if it says \"BBBBB\", then insert a another option description.</p>\n\n<p>Since our product orders are always changing and I need to present this info for roughly 3000 products per week, I need to know how I can type my conditions once, then insert a piece of code that will tell the program to carry it out for next (X) number of options in the column, or as long as the cells have data in them.  </p>\n\n<p>I'm pretty sure a loop would solve my problem but I have yet been able to find a loop script that satisfies my requirements.  </p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>Private Sub Option_Matrix_2()\n'Enters data for Option code Description into worksheet\nRange(\"G4\").Select\nIf ActiveCell.FormulaR1C1 = \"AAAA\" Then\nActiveCell.Offset(rowOffset:=0, columnOffset:=1).Activate\n ActiveCell.FormulaR1C1 = \"Description 1\"\n\n\n\nElseIf ActiveCell.FormulaR1C1 = \"CCCCC\" Then\nActiveCell.Offset(rowOffset:=0, columnOffset:=1).Activate\n ActiveCell.FormulaR1C1 = \"Description 2\"\n\n\nElseIf ActiveCell.FormulaR1C1 = \"EEEEE\" Then\nActiveCell.Offset(rowOffset:=0, columnOffset:=1).Activate\n ActiveCell.FormulaR1C1 = \"Description 3\"\n\n Else\n ActiveCell.Offset(rowOffset:=0, columnOffset:=1).Activate\n ActiveCell.FormulaR1C1 = \"\"\n\nEnd If\n</code></pre>\n\n<p>Since I have over 3000 products and 150 different options, I need to know what I need to insert to tell the macro to run the code for each cell in the column that contains data.  In this case it would be (\"G4:G3000\")</p>\n\n<p>If there is any other information that is required please let me know I'd be happy to help in any way I can</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 4, "creation_date": 1460563360, "post_id": 36603754, "comment_id": 60804647, "body": "There&#39;s nothing in this code that would put a 0 in a random cell. The result of the formula is posted to the cell which is active at the time of you pressing the button. If the formula is pointing to an empty cell it will produce a <code>0</code> - is this what you mean?"}, {"owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1460567683, "post_id": 36603754, "comment_id": 60807528, "body": "Yes, sorry for the confusion  and I also just realized that. Is there a way to not add that zero?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1460571194, "post_id": 36603754, "comment_id": 60809611, "body": "Can you change your formula?<code>=IF(&#39;raw data&#39;!A2=&quot;&quot;,&quot;&quot;,&#39;raw data&#39;!A2)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1460568762, "post_id": 36603924, "comment_id": 60808144, "body": "Actually, that would insert a relative formula in each cell. I think the OP wants the result of a specific cell from the raw data sheet copied into each cell instead."}, {"owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "edited": false, "score": 0, "creation_date": 1460569240, "post_id": 36603924, "comment_id": 60808428, "body": "Were you able to see my comment earlier?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1460571338, "post_id": 36603924, "comment_id": 60809716, "body": "@MacroMan, the formula is relative"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1460571744, "post_id": 36603924, "comment_id": 60809942, "body": "Yes but in the original code, the value of A7 is copied to the range, not the formula."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1460563940, "last_edit_date": 1460563940, "creation_date": 1460563562, "answer_id": 36603924, "question_id": 36603754, "link": "https://stackoverflow.com/questions/36603754/why-is-a-random-zero-appearing-every-time-i-run-this-macro/36603924#36603924", "title": "Why is a random zero appearing every time I run this macro?", "body": "<p>I assume it is where your <code>activecell</code> is located when you run the code.</p>\n\n<p>This will solve that problem.</p>\n\n<pre><code>Range(\"A7:A500\") = \"='raw data'!R[-5]C\"\n</code></pre>\n\n<p>Just to add an additional option:</p>\n\n<pre><code>Sub Values()\nRange(\"A7:A500\").Value = Sheets(\"raw data\").Range(\"A2:A500\").Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460563940, "creation_date": 1460563093, "last_edit_date": 1460563274, "question_id": 36603754, "link": "https://stackoverflow.com/questions/36603754/why-is-a-random-zero-appearing-every-time-i-run-this-macro", "title": "Why is a random zero appearing every time I run this macro?", "body": "<p>I am using a command button to run the macro below, but a zero keeps on appearing on the sheet on a random cell everytime I run I run the macro. The macro being used is from a recorded macro just noting that in case maybe that's why. The recorded macro all it is it's taking references from another sheet and autofiling in another.</p>\n\n<pre><code>Sub Refresh()\n    ActiveCell.FormulaR1C1 = \"='raw data'!R[-5]C\"\n    Range(\"A7\").Select\n    Selection.AutoFill Destination:=Range(\"A7:A500\"), Type:=xlFillDefault\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 8279, "user_id": 5309300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63d02949d5e7330b5db7c59283041d86?s=128&d=identicon&r=PG&f=1", "display_name": "asongtoruin", "link": "https://stackoverflow.com/users/5309300/asongtoruin"}, "edited": false, "score": 5, "creation_date": 1460563544, "post_id": 36603703, "comment_id": 60804762, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31382682/fill-blank-cells-variation\">Fill blank cells (Variation)</a> and <a href=\"http://stackoverflow.com/questions/18385038/in-excel-how-to-fill-blank-cells-with-the-last-preceding-non-blank-cell\">how to fill blank cells with the last preceding non-blank cell</a>"}, {"owner": {"reputation": 41, "user_id": 5139867, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a90a9db032a1c963f3b438a7baa0abdf?s=128&d=identicon&r=PG&f=1", "display_name": "Keen2Learn", "link": "https://stackoverflow.com/users/5139867/keen2learn"}, "reply_to_user": {"reputation": 8279, "user_id": 5309300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63d02949d5e7330b5db7c59283041d86?s=128&d=identicon&r=PG&f=1", "display_name": "asongtoruin", "link": "https://stackoverflow.com/users/5309300/asongtoruin"}, "edited": false, "score": 0, "creation_date": 1460565170, "post_id": 36603703, "comment_id": 60805945, "body": "Thanks asongtourin. This is what I was looking for."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6199691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc3cce08f57c2a2ce73f7efca2fae101?s=128&d=identicon&r=PG&f=1", "display_name": "factotem", "link": "https://stackoverflow.com/users/6199691/factotem"}, "is_accepted": false, "score": 1, "last_activity_date": 1460565363, "creation_date": 1460565363, "answer_id": 36604532, "question_id": 36603703, "link": "https://stackoverflow.com/questions/36603703/copy-row-to-next-empty-rows-if-any/36604532#36604532", "title": "Copy row to next empty rows if any", "body": "<p>If you insert a new column between A &amp; B and set B1=1 then copy this code to all the remaining rows it should work ie starting at row 2.</p>\n\n<p>=IF(A2=0,B1,A2)</p>\n\n<p>You might want to do a special copy/paste to set the values.</p>\n"}], "owner": {"reputation": 41, "user_id": 5139867, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a90a9db032a1c963f3b438a7baa0abdf?s=128&d=identicon&r=PG&f=1", "display_name": "Keen2Learn", "link": "https://stackoverflow.com/users/5139867/keen2learn"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "closed_date": 1460834330, "answer_count": 1, "score": -1, "last_activity_date": 1460565363, "creation_date": 1460562985, "last_edit_date": 1531161705, "question_id": 36603703, "link": "https://stackoverflow.com/questions/36603703/copy-row-to-next-empty-rows-if-any", "closed_reason": "Duplicate", "title": "Copy row to next empty rows if any", "body": "<p>I am new to excel and need some help here.\nI have excel sheet where there is one to many mapping to each row. It means, in column A, I have one value and in column B, I have multiple(3-4) values mapped to column A value. Something like shown below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/EqO9t.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EqO9t.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I want to copy value from column A to next empty rows in column A till it find non-empty row. If there is no next empty row, like 2 in column A, it dont need to copy. \nExpected result as shown below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RKxqN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RKxqN.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Could you please help? \nThis is just example. I have this situation for huge excel sheet.</p>\n\n<p>All responses and comments are highly appreciated.</p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6199726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5608485a4ea4169ff61ff9907633dc3?s=128&d=identicon&r=PG&f=1", "display_name": "johnydoo", "link": "https://stackoverflow.com/users/6199726/johnydoo"}, "edited": false, "score": 0, "creation_date": 1460564783, "post_id": 36604108, "comment_id": 60805666, "body": "Awesome, I see it working. However, I have cells above the table that I do not want merged. So, the table really starts at Cells B9&amp;C9. Is there something I can add or edit in the code to make the code only apply to cells C9:B169? I am very new to VBA code, not to familiar with it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 6199726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5608485a4ea4169ff61ff9907633dc3?s=128&d=identicon&r=PG&f=1", "display_name": "johnydoo", "link": "https://stackoverflow.com/users/6199726/johnydoo"}, "edited": false, "score": 0, "creation_date": 1460565059, "post_id": 36604108, "comment_id": 60805860, "body": "You might try <code>srw = 8</code>."}, {"owner": {"reputation": 1, "user_id": 6199726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5608485a4ea4169ff61ff9907633dc3?s=128&d=identicon&r=PG&f=1", "display_name": "johnydoo", "link": "https://stackoverflow.com/users/6199726/johnydoo"}, "edited": false, "score": 0, "creation_date": 1460565929, "post_id": 36604108, "comment_id": 60806397, "body": "Perfect. Worked. Now I have a few follow up questions.  1) I placed a button and assigned this code to it so it runs once you press the button and I get a Microsoft Visual Basic for Applications (400) error when I press the button. Any suggestions?  2) When I&#39;m typing the list, I won&#39;t always end it with &quot;1&quot; so everything above will merge. For example: in your table, if you removed the &quot;1&quot; from C16, so it was just 1 to 5 from C11:C16, can I add something to the code to know to merge that?  3) Lastly, do you have a VBA code to add a thicker border to all cells above the &quot;1&quot; from Column B to O?."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 6199726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5608485a4ea4169ff61ff9907633dc3?s=128&d=identicon&r=PG&f=1", "display_name": "johnydoo", "link": "https://stackoverflow.com/users/6199726/johnydoo"}, "edited": false, "score": 2, "creation_date": 1460566087, "post_id": 36604108, "comment_id": 60806492, "body": "If you have follow-up questions then close this question off and post follow-up questions with the updated information; referring back to this question if you think it will provide relevant information. Otherwise, this become a <a href=\"http://meta.stackexchange.com/questions/188625\">Russian Doll Question</a>. btw, people asking for code are <b>*expected</b> to show oriinal effort; I answered this because I found it interesting but so far you&#39;ve shown no original effort."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1460564069, "creation_date": 1460564069, "answer_id": 36604108, "question_id": 36603612, "link": "https://stackoverflow.com/questions/36603612/merging-cells-in-column-based-on-condition/36604108#36604108", "title": "merging cells in column based on condition", "body": "<p>This short loop using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow noreferrer\">WorksheetFunction object</a> <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow noreferrer\">MATCH function</a> to locate 'ones' should suffice.</p>\n\n<pre><code>Dim srw As Long, frw As Variant\nWith Worksheets(\"Sheet1\")\n    With Intersect(.Columns(3), .UsedRange)\n        srw = 0\n        Do While srw &lt; .Rows.Count\n            frw = Application.Match(1, .Columns(1).Offset(srw + 1, 0), 0)\n            If Not IsError(frw) Then\n                .Cells(srw + 1, 1).Resize(frw, 1).Offset(0, -1).Merge\n                srw = srw + frw\n            Else\n                srw = .Cells(Rows.Count, 1).End(xlUp).Row\n            End If\n        Loop\n    End With\nEnd With\n</code></pre>\n\n<p>It's just a matter of finding the restarting point (the 'ones') and using a little maths to resize the cells to be merged.</p>\n\n<hr>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/J0mFs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J0mFs.png\" alt=\"merge_groups\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1460571631, "creation_date": 1460571631, "answer_id": 36606480, "question_id": 36603612, "link": "https://stackoverflow.com/questions/36603612/merging-cells-in-column-based-on-condition/36606480#36606480", "title": "merging cells in column based on condition", "body": "<p>an alternative code pattern, using a formula approach with a helper column (cleared before ending) by which jumping through relevant rows only</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\nDim i As Long\n\nWith Worksheets(\"Sheet001\")\n    With .Columns(3).SpecialCells(xlCellTypeConstants, xlNumbers)\n        With .Offset(, 1)\n            .FormulaR1C1 = \"=if(RC[-1]=1,\"\"\"\",1)\"\n            .Value = .Value\n            With .SpecialCells(xlCellTypeBlanks)\n                For i = 1 To .Areas.Count - 1\n                    Range(.Areas(i).Cells(.Areas(i).Count), .Areas(i + 1).Cells(1).Offset(-1)).Offset(0, -2).Merge\n                Next i\n            End With\n            .ClearContents\n        End With\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6199726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5608485a4ea4169ff61ff9907633dc3?s=128&d=identicon&r=PG&f=1", "display_name": "johnydoo", "link": "https://stackoverflow.com/users/6199726/johnydoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1460571631, "creation_date": 1460562747, "last_edit_date": 1531161705, "question_id": 36603612, "link": "https://stackoverflow.com/questions/36603612/merging-cells-in-column-based-on-condition", "title": "merging cells in column based on condition", "body": "<p>I am trying to merge the cells in a column (column B) based on a condition in another column (Column C).</p>\n\n<p>In Column C, I have a list that starts at 1 and goes to a maximum of 10. However, it may stop at any number before 10 and restart. For Example:</p>\n\n<pre><code>B C\n\n  1\n  2\n  3\n  4\n  5\n  6\n  1\n  2\n  3\n  4\n  1\n  2\n  3\n  4\n  5\n  1\n</code></pre>\n\n<p>As you can see, at B7 and B11, Column C starts over a 1. When this happens, I would like to merge everything above that restart (from 1 to last number before restart). So for this example, I would like to merge B1:B6, B7:10, and B11:15. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 442, "user_id": 5773951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ab4118ae0aebf82f87404d8315e47eb?s=128&d=identicon&r=PG&f=1", "display_name": "dnep", "link": "https://stackoverflow.com/users/5773951/dnep"}, "edited": false, "score": 0, "creation_date": 1460561708, "post_id": 36602492, "comment_id": 60803429, "body": "Your code doesn&#39;t seem to be doing anything near what you describe. It is, instead, copying data from one sheet to another and painting cells on the destination sheet... not sure what you want here... anyway, did you try to achieve the coloring you mention with conditional formatting instead of VBA?"}, {"owner": {"reputation": 731, "user_id": 4894466, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/10200569228069422/picture?type=large", "display_name": "Rey Norbert Besmonte", "link": "https://stackoverflow.com/users/4894466/rey-norbert-besmonte"}, "reply_to_user": {"reputation": 442, "user_id": 5773951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ab4118ae0aebf82f87404d8315e47eb?s=128&d=identicon&r=PG&f=1", "display_name": "dnep", "link": "https://stackoverflow.com/users/5773951/dnep"}, "edited": false, "score": 0, "creation_date": 1460620117, "post_id": 36602492, "comment_id": 60830092, "body": "Hi, Pasted the wrong code..  Sub checkNewItems()     Dim i As Integer     i = 0          Do While Sheet1.Range(&quot;B&quot; &amp; i + 2).Value &lt;&gt; &quot;&quot;         If (Sheet2.Range(&quot;B&quot; &amp; i + 2).Value &lt;&gt; Sheet3.Range(&quot;B&quot; &amp; i + 2).Value) Then Sheet2.Range(&quot;B&quot; &amp; i + 2).Interior.Color = 13561798         If (Sheet2.Range(&quot;C&quot; &amp; i + 2).Value &lt;&gt; Sheet3.Range(&quot;C&quot; &amp; i + 2).Value) Then Sheet2.Range(&quot;C&quot; &amp; i + 2).Interior.Color = 13561798         i = i + 1     Loop End Sub  The problem with this is this is a static code. when someone add a new row from sheet 1 then the the other sheet will consider everything from that as new"}], "owner": {"reputation": 731, "user_id": 4894466, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/10200569228069422/picture?type=large", "display_name": "Rey Norbert Besmonte", "link": "https://stackoverflow.com/users/4894466/rey-norbert-besmonte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1463447758, "creation_date": 1460559861, "last_edit_date": 1463447758, "question_id": 36602492, "link": "https://stackoverflow.com/questions/36602492/vba-macro-search-difference-in-range", "title": "VBA Macro Search Difference in Range", "body": "<p>I need to check the range from <code>A1</code> to <code>AY1</code>, <code>B1</code> to <code>BY1</code>.... from sheet 1 and compare them with the range from <code>A1</code> to <code>AY1</code>, <code>B1</code> to <code>BY1</code>.... from sheet 2 and highlight in yellow the difference in sheet 1.</p>\n\n<pre><code>Sub copyWorkingFileToConsolidated()\n    Dim i As Integer\n    i = 5\n\n    Do While Sheet2.Range(\"A\" &amp; i).Value &lt;&gt; \"\"\n        Sheet3.Range(\"A\" &amp; i &amp; \":D\" &amp; i).Value = Sheet2.Range(\"A\" &amp; i &amp; \":D\" &amp; i).Value\n        Sheet3.Range(\"F\" &amp; i &amp; \":Y\" &amp; i).Value = Sheet2.Range(\"E\" &amp; i &amp; \":X\" &amp; i).Value\n        Sheet3.Range(\"A\" &amp; i &amp; \":Y\" &amp; i).Interior.ColorIndex = 0\n        i = i + 1\n    Loop\n    getResourceLevel\nEnd Sub\n</code></pre>\n\n<p>Please help</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "alm"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1460561311, "post_id": 36602439, "comment_id": 60803101, "body": "Does 12.5 work with early binding instead of late binding / <code>CreateObject</code>?"}, {"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1460563985, "post_id": 36602439, "comment_id": 60805046, "body": "@Mat&#39;s Mug :can you give please give me a hint on how to check that?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1460565145, "post_id": 36602439, "comment_id": 60805925, "body": "Meh, I don&#39;t think it has anything to do with late/early binding. FWIW you can early-bind a dependency by browsing to its library in the Tools/References menu, and then you could do <code>Set connection = New TDConnection</code> instead of <code>CreateObject</code>. Reason I don&#39;t think it&#39;s that is because you <i>are</i> getting a response (&quot;invalid username/password&quot; is a response), so the thing works. Are you handling runtime errors anywhere? Are the two versions connecting to the same place?"}, {"owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1460568902, "post_id": 36602439, "comment_id": 60808227, "body": "I will try it, 2 projects in 2 ALM so not connecting to the same place. my requirement is collecting defects from 4 different alms to excel,every thing was working till updating to ALM12.5 :( (3 alm&#39;s in with version 11, just one in 12.5)"}], "answers": [{"tags": [], "owner": {"reputation": 1574, "user_id": 6304906, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/783a08c5d7a3ca42d6fb007774a49f45?s=128&d=identicon&r=PG&f=1", "display_name": "Barney", "link": "https://stackoverflow.com/users/6304906/barney"}, "is_accepted": false, "score": 0, "last_activity_date": 1465568032, "last_edit_date": 1465568032, "creation_date": 1465567699, "answer_id": 37750375, "question_id": 36602439, "link": "https://stackoverflow.com/questions/36602439/unable-to-make-a-connection-to-alm-12-5-using-vb-macro/37750375#37750375", "title": "Unable to make a connection to ALM 12.5 using vb macro", "body": "<p>I generally use the below syntax to create the OTA object</p>\n\n<blockquote>\n  <p>Set TDconnection = CreateObject(\"tdapiole80.tdconnection\")</p>\n</blockquote>\n\n<p>However, Since the connection and authentication are enclosed inside \"On Error Resume Next\", the error message may not actually reflect the real cause.</p>\n\n<p>So, this is what I would do to debug.</p>\n\n<ol>\n<li>Remove the On Error Resume Next and check whether the code can create a TDConnection Object</li>\n<li>Installing the correct version of HP ALM Addin.</li>\n<li>Console out \"err.description\" to understand the real cause</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 2826, "user_id": 6240567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/654a8cca486758a5db347b9db603eb41?s=128&d=identicon&r=PG", "display_name": "Geoff James", "link": "https://stackoverflow.com/users/6240567/geoff-james"}, "edited": false, "score": 1, "creation_date": 1471360239, "post_id": 38978418, "comment_id": 65309736, "body": "Welcome to SO! Please try and refrain from <i>just</i> linking code samples in your answer. There&#39;s nothing wrong with posting the link, but I would suggest that you might post some relevant snippets from the link, in the event that the link goes down."}], "tags": [], "owner": {"reputation": 1, "user_id": 6721819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2cfba2e2d763e569a3fe50cdd7d3781?s=128&d=identicon&r=PG&f=1", "display_name": "isrequiem", "link": "https://stackoverflow.com/users/6721819/isrequiem"}, "is_accepted": false, "score": 0, "last_activity_date": 1471359983, "creation_date": 1471359983, "answer_id": 38978418, "question_id": 36602439, "link": "https://stackoverflow.com/questions/36602439/unable-to-make-a-connection-to-alm-12-5-using-vb-macro/38978418#38978418", "title": "Unable to make a connection to ALM 12.5 using vb macro", "body": "<p>As I can see from your code it throws message \"Invalid UserName or Password\" in any case when TDConnection.loggedin property is not True, but it can be because of other reason, e.g. wrong OTAClient.dll library (they are not backward compatible). So in general case you should register your ALM client on the machine (server_url/qcbin -> Tools -> Register client) and then try one more time.</p>\n\n<p>If it doesn't help, you can try to rewrite your code using sample from official documentation <a href=\"http://alm-help.saas.hpe.com/en/12.50/api_refs/ota/topic96.html\" rel=\"nofollow\">http://alm-help.saas.hpe.com/en/12.50/api_refs/ota/topic96.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "is_accepted": false, "score": 0, "last_activity_date": 1511246244, "creation_date": 1511246244, "answer_id": 47406699, "question_id": 36602439, "link": "https://stackoverflow.com/questions/36602439/unable-to-make-a-connection-to-alm-12-5-using-vb-macro/47406699#47406699", "title": "Unable to make a connection to ALM 12.5 using vb macro", "body": "<p>This problem is due to the Project unavailable. Also check if you have access to any one of the projects in the v12.5.</p>\n\n<p>Thanks.</p>\n"}], "owner": {"reputation": 27, "user_id": 3361288, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e0e50504d97e085a71d3c1277654673d?s=128&d=identicon&r=PG&f=1", "display_name": "Venkat", "link": "https://stackoverflow.com/users/3361288/venkat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4371, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1525349781, "creation_date": 1460559724, "last_edit_date": 1531164843, "question_id": 36602439, "link": "https://stackoverflow.com/questions/36602439/unable-to-make-a-connection-to-alm-12-5-using-vb-macro", "title": "Unable to make a connection to ALM 12.5 using vb macro", "body": "<p>I have 2 ALM's (11 and 12.5), with the below code, i am able to connect to ALM11, but it says invalid user name and password for 12.5 ALM, (user credentials are correct) </p>\n\n<pre><code>Function ALM_Connection(ByRef TDConnection, server, user, pwd)\n\n    On Error Resume Next\n    Dim fileArray\n    almLogin.connectionMessage.ForeColor = vbBlue\n    Set TDConnection = CreateObject(\"tdconnection\")\n    sUserName = user\n    sPassword = pwd\n    If Trim(sUserName) = \"\" Or Trim(sPassword) = \"\" Then\n        almLogin.connectionMessage.ForeColor = vbRed\n        almLogin.connectionMessage.Caption = \"Please Enter the data and click on 'Authenticate'\"\n        ALM_Connection = False\n        Exit Function\n    End If\n    almLogin.connectionMessage.Caption = \" Please Wait.. \"\n    Application.Wait (Now + TimeValue(\"0:00:02\"))\n    TDConnection.InitConnectionEx server\n    TDConnection.Login sUserName, sPassword\n\n    If (TDConnection.loggedin &lt;&gt; True) Then\n        almLogin.connectionMessage.ForeColor = vbRed\n        almLogin.connectionMessage.Caption = \"Invalid UserName or Password\"\n        ALM_Connection = False\n        Exit Function\n    Else\n        almLogin.connectionMessage.Caption = \"Logged In Successfully\"\n        ALM_Connection = True\n    End If\n\nEnd Function\n</code></pre>\n\n<p>any help is appreciated</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 1, "creation_date": 1460561018, "post_id": 36601776, "comment_id": 60802881, "body": "Works for me.  Tag information looks to be detail #18 and Title is #21"}, {"owner": {"reputation": 271, "user_id": 4332302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d089a170155760ea42e087efb7891b52?s=128&d=identicon&r=PG&f=1", "display_name": "orangutangas", "link": "https://stackoverflow.com/users/4332302/orangutangas"}, "reply_to_user": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1460611297, "post_id": 36601776, "comment_id": 60825447, "body": "For me doesn&#39;t. Where can be a problem? I do not see any of file attribute s from #5th or #7th till the end of that loop."}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1460649957, "post_id": 36601776, "comment_id": 60852708, "body": "Is the file location correct?"}, {"owner": {"reputation": 271, "user_id": 4332302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d089a170155760ea42e087efb7891b52?s=128&d=identicon&r=PG&f=1", "display_name": "orangutangas", "link": "https://stackoverflow.com/users/4332302/orangutangas"}, "reply_to_user": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1460698910, "post_id": 36601776, "comment_id": 60872592, "body": "yes. the only thing it worked for me is when i used DSOFile.dll library"}], "owner": {"reputation": 271, "user_id": 4332302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d089a170155760ea42e087efb7891b52?s=128&d=identicon&r=PG&f=1", "display_name": "orangutangas", "link": "https://stackoverflow.com/users/4332302/orangutangas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1650, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1460558267, "creation_date": 1460558267, "question_id": 36601776, "link": "https://stackoverflow.com/questions/36601776/get-external-file-title-and-tag-info-using-vba", "title": "Get external file title and tag info using VBA", "body": "<p>Having a question how can i get an external file title and tag information from properties window using VBA code?\nI have tried to use this code in VBA:  </p>\n\n<pre><code>Dim sFile As Variant\nDim oShell: Set oShell = CreateObject(\"Shell.Application\")\nDim oDir:   Set oDir = oShell.Namespace(\"C:\\Users\\vadis\\Desktop\\folderis\\\")\n\nFor Each strFileName In oDir.Items\n For i = 0 To 134\n  MsgBox (oDir.GetDetailsOf(strFileName, i))\n Next\nNext\n</code></pre>\n\n<p>But it does not provide title and tag information of the file( gives only date_created and ownder info).\nMy file properties are here:<br>\n<a href=\"https://i.stack.imgur.com/F0BX9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F0BX9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1460559130, "post_id": 36601733, "comment_id": 60801251, "body": "<a href=\"http://stackoverflow.com/questions/19985895/convert-an-entire-range-to-uppercase-without-looping-through-all-the-cells\" title=\"convert an entire range to uppercase without looping through all the cells\">stackoverflow.com/questions/19985895/&hellip;</a> Similarly you can use <code>[A1:A20] = [INDEX(PROPER(A1:A20),)]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2939, "user_id": 4320738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de47f691b009d906bf13e2e6c0fb1451?s=128&d=identicon&r=PG&f=1", "display_name": "Munir", "link": "https://stackoverflow.com/users/4320738/munir"}, "is_accepted": false, "score": 0, "last_activity_date": 1460558456, "creation_date": 1460558456, "answer_id": 36601872, "question_id": 36601733, "link": "https://stackoverflow.com/questions/36601733/vba-excel-changing-case-to-proper-case/36601872#36601872", "title": "VBA Excel - changing case to Proper Case", "body": "<p><code>Application.WorksheetFunction.Proper(range)</code> should do it. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff834434.aspx</a> for documentation on <code>WorksheetFunction</code></p>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 27, "user_id": 6039223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4398603fcc1df966a0dcc17387d0fd18?s=128&d=identicon&r=PG&f=1", "display_name": "Amy", "link": "https://stackoverflow.com/users/6039223/amy"}, "edited": false, "score": 0, "creation_date": 1460558858, "post_id": 36601881, "comment_id": 60800981, "body": "@Amy in about 7-8 minutes you will be able to choose one to mark as correct.  You do this by clicking the grey/green check mark by the answer.  Please come back and mark one as correct, it is something only you can do and it will close out the question as being answered."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 27, "user_id": 6039223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4398603fcc1df966a0dcc17387d0fd18?s=128&d=identicon&r=PG&f=1", "display_name": "Amy", "link": "https://stackoverflow.com/users/6039223/amy"}, "edited": false, "score": 0, "creation_date": 1460559186, "post_id": 36601881, "comment_id": 60801300, "body": "@Amy yes you have."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1460559429, "post_id": 36601881, "comment_id": 60801505, "body": "@SiddharthRout just standing on the shoulders of giants like yourself."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1460559061, "last_edit_date": 1460559061, "creation_date": 1460558475, "answer_id": 36601881, "question_id": 36601733, "link": "https://stackoverflow.com/questions/36601733/vba-excel-changing-case-to-proper-case/36601881#36601881", "title": "VBA Excel - changing case to Proper Case", "body": "<p>Try this:</p>\n\n<pre><code>Dim Lastrow As Integer\n\nWith Worksheets(\"Overdue PO\")\n    Lastrow = .Cells(Rows.Count, \"D\").End(xlUp).Row\n    .Range(\"D2:F\" &amp; Lastrow).Value = .Evaluate(\"INDEX(PROPER(D2:F\" &amp; Lastrow &amp; \"),)\")\nEnd With\n</code></pre>\n\n<p>It will be near instant, without the need for loops.</p>\n\n<p>Also using <code>.Select</code> or <code>.Activate</code> also slow down the code, aoid them if possible by referring to the cells directly.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 6039223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4398603fcc1df966a0dcc17387d0fd18?s=128&d=identicon&r=PG&f=1", "display_name": "Amy", "link": "https://stackoverflow.com/users/6039223/amy"}, "edited": false, "score": 0, "creation_date": 1460560298, "post_id": 36602068, "comment_id": 60802280, "body": "This works well too :) thanks for your help! @jcarroll"}, {"owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "reply_to_user": {"reputation": 27, "user_id": 6039223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4398603fcc1df966a0dcc17387d0fd18?s=128&d=identicon&r=PG&f=1", "display_name": "Amy", "link": "https://stackoverflow.com/users/6039223/amy"}, "edited": false, "score": 0, "creation_date": 1460560428, "post_id": 36602068, "comment_id": 60802399, "body": "I would probably recommend combing the LastRow = ... line from my code with Scott&#39;s answer."}], "tags": [], "owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "is_accepted": true, "score": 1, "last_activity_date": 1460558924, "creation_date": 1460558924, "answer_id": 36602068, "question_id": 36601733, "link": "https://stackoverflow.com/questions/36601733/vba-excel-changing-case-to-proper-case/36602068#36602068", "title": "VBA Excel - changing case to Proper Case", "body": "<p>Try this</p>\n\n<pre><code>Sub test()\n\nDim Lastrow As Integer\nDim range As range\nDim c As range\n\n\nWith Worksheets(\"Overdue PO\")\nLastrow = Columns(\"D:F\").Cells.Find(What:=\"*\", LookIn:=xlValues,   SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Row\n    .range(\"D2:F\" &amp; Lastrow).Select\n    Set range = Selection\nEnd With\n\nFor Each c In range\n    c.Value = Application.WorksheetFunction.Proper(c.Value)\nNext c\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10173717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c61e197de1b131efe9d1634c7613297c?s=128&d=identicon&r=PG", "display_name": "Ron", "link": "https://stackoverflow.com/users/10173717/ron"}, "edited": false, "score": 0, "creation_date": 1533586427, "post_id": 51663973, "comment_id": 90391319, "body": "Ops, obviously missed getting it all in the correct place. Thanks"}], "tags": [], "owner": {"reputation": 1, "user_id": 10173717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c61e197de1b131efe9d1634c7613297c?s=128&d=identicon&r=PG", "display_name": "Ron", "link": "https://stackoverflow.com/users/10173717/ron"}, "is_accepted": false, "score": 0, "last_activity_date": 1533259624, "last_edit_date": 1533259624, "creation_date": 1533257790, "answer_id": 51663973, "question_id": 36601733, "link": "https://stackoverflow.com/questions/36601733/vba-excel-changing-case-to-proper-case/51663973#51663973", "title": "VBA Excel - changing case to Proper Case", "body": "<p>I wanted to use this with a named range, and was kindly provided the following code. Perhaps it will assist someone else:</p>\n\n<pre><code>Sub m_MakeProper()\n'2/8/2018\n'\nApplication.Volatile True\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.DisplayStatusBar = False\n'\nWorksheets(\"test\").Activate\n'\nDim LastRow                       As Long\nDim LastCol                       As Integer\nDim cell                          As Variant\nDim thiswksht                     As Worksheet\nDim thiswb                        As Workbook\n'\n'\nSet thiswksht = ActiveSheet\nIf thiswksht.AutoFilterMode Then\n    AutoFilterMode = False\nEnd If\n'\nWith thiswksht\n    LastRow = Cells(Cells.Rows.Count, \"A\").End(xlUp).Row\n    LastCol = Cells(1, Columns.Count).End(xlToLeft).Column\nEnd With\n'\nCells(1, 1).Activate\nRows(1).find(\"Status\").Select\nRange(ActiveCell.Address, Cells(LastRow, ActiveCell.Column)).Select\nSelection.Name = \"c_P_Status\"\nWith Range(\"c_P_Status\")\n    .Value = Application.Evaluate(\"INDEX(PROPER(\" &amp; .Address &amp; \"),0)\")\nEnd With\n'\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6039223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4398603fcc1df966a0dcc17387d0fd18?s=128&d=identicon&r=PG&f=1", "display_name": "Amy", "link": "https://stackoverflow.com/users/6039223/amy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7032, "favorite_count": 0, "accepted_answer_id": 36602068, "answer_count": 4, "score": 2, "last_activity_date": 1533259624, "creation_date": 1460558167, "last_edit_date": 1531164843, "question_id": 36601733, "link": "https://stackoverflow.com/questions/36601733/vba-excel-changing-case-to-proper-case", "title": "VBA Excel - changing case to Proper Case", "body": "<p>I'm new to Stackoverflow so hopefully I have posted this question in the right place.</p>\n\n<p>I'm having trouble getting my code to work in VBA. I want it to select columns D:F until the last cell value. With this selection, I would like to change the case of the cells (they are currently uppercase) to Proper case.</p>\n\n<pre><code>Dim Lastrow As Integer\nDim range As Variant\n\nWith Worksheets(\"Overdue PO\")\n    Lastrow = .Cells(Rows.Count, \"D\").End(xlUp).Row\n    .range(\"D2:F\" &amp; Lastrow).Select\n    range = Selection.Value\nEnd With\n\nApplication.Proper (range)\n</code></pre>\n\n<p>It currently selects the range until the bottom row, but it doesn't change the case of text. No error appears when running the code.</p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["excel", "google-apps-script", "vba"], "comments": [{"owner": {"reputation": 18507, "user_id": 2213940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEbb2.jpg?s=128&g=1", "display_name": "Zig Mandel", "link": "https://stackoverflow.com/users/2213940/zig-mandel"}, "edited": false, "score": 0, "creation_date": 1460638383, "post_id": 36601474, "comment_id": 60843274, "body": "that script is not valid for a google sheet. not clear why you want to run it froma browser."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 3911603, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/wJwm1.jpg?s=128&g=1", "display_name": "mond007", "link": "https://stackoverflow.com/users/3911603/mond007"}, "is_accepted": false, "score": 0, "last_activity_date": 1460660178, "creation_date": 1460660178, "answer_id": 36631675, "question_id": 36601474, "link": "https://stackoverflow.com/questions/36601474/google-script-or-action-script-to-run-a-program-on-a-network-drive/36631675#36631675", "title": "Google Script or Action Script to run a program on a Network Drive", "body": "<p>Oh ...ok the reason is because we have an internal system called eTracker which allows a link onlyof the  the following types. It will not allow me to enter a link to a network drive to  run a .exe program directly. </p>\n\n<p>Http:// \nHttps://\nJavascript. </p>\n\n<p>So you see I thought that a Google sheet could launch my application for ne.</p>\n"}], "owner": {"reputation": 119, "user_id": 3911603, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/wJwm1.jpg?s=128&g=1", "display_name": "mond007", "link": "https://stackoverflow.com/users/3911603/mond007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460660178, "creation_date": 1460557546, "last_edit_date": 1531164843, "question_id": 36601474, "link": "https://stackoverflow.com/questions/36601474/google-script-or-action-script-to-run-a-program-on-a-network-drive", "title": "Google Script or Action Script to run a program on a Network Drive", "body": "<p>I am trying to run a Visual Studio Executable application say SAP Order Prerequisite Form.exe from a goggle sheet or some other mechanism.</p>\n\n<p>Basically, no web browser will allow me to run an .exe file as its deemed a security risk. Trust me I have read enough about that now. Therefore I have created a Excel_Launcher.xlsm file that simply runs a macro and this works fine : </p>\n\n<pre><code>Private Sub Workbook_Open()\nDim RetVal\nRetVal = Shell(\"\\\\MyNetwork\\SAP Order Prerequisite Form.exe\", 1)\nEnd Sub\n</code></pre>\n\n<p>Unfortunately, I can't upload this file to a Google site so I though of creating the GoogleSheet with some action script to run this application and not having much luck really. \nI have also tried using the following script : </p>\n\n<pre><code>html&gt;\n  &lt;body&gt;\n    &lt;form name=\"form1\"&gt;\n      &lt;input type=button onClick=\"test()\" value=\"Open File\"&gt;\n      &lt;br&gt;&lt;br&gt;\n    &lt;/form&gt;\n\n    &lt;script type=\"text/javascript\"&gt;\n      function test() {\n        var Excel = new ActiveXObject(\"Excel.Application\");\n        Excel.Visible = true;\n        Excel.Workbooks.Open(\"\\\\MyNetworkDrive\\Excel_Launcher.xlsm\");\n      }\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Any ideas on an app that can run this file directly or via some google script would be great. </p>\n"}, {"tags": ["arrays", "excel", "excel-2007", "vba"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1460565406, "creation_date": 1460565406, "answer_id": 36604553, "question_id": 36601422, "link": "https://stackoverflow.com/questions/36601422/vba-array-based-on-check-box-values/36604553#36604553", "title": "VBA, Array based on check box values?", "body": "<p>Something like this will work:</p>\n\n<pre><code>Sub sheetselect()\nDim wsStr() As Variant\nDim ostr() As Variant\n\nReDim wsStr(0 To 0)\n\nIf Me.chktable1 = True Then\n    wsStr(UBound(wsStr)) = table3.Name\n    ReDim Preserve wsStr(UBound(wsStr) + 1) As Variant\nEnd If\nIf Me.chktable2 = True Then\n    wsStr(UBound(wsStr)) = table4.Name\n    ReDim Preserve wsStr(UBound(wsStr) + 1) As Variant\nEnd If\nReDim ostr(0 To UBound(wsStr) - 1)\nFor k = 0 To UBound(wsStr) - 1\n    ostr(k) = wsStr(k)\nNext k\nSheets(ostr).Select\nEnd Sub\n</code></pre>\n\n<p>It loads an array with the names of the sheets.  Then uses this array to select the proper sheets.</p>\n"}], "owner": {"reputation": 55, "user_id": 6172151, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bac2a4a151cc0aa13a3b88fe68ed0f9c?s=128&d=identicon&r=PG&f=1", "display_name": "Rygar", "link": "https://stackoverflow.com/users/6172151/rygar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 449, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460569056, "creation_date": 1460557448, "last_edit_date": 1531164843, "question_id": 36601422, "link": "https://stackoverflow.com/questions/36601422/vba-array-based-on-check-box-values", "title": "VBA, Array based on check box values?", "body": "<p>Good morning everyone.  I am having a bit of difficulty trying to get a button working properly in Excel 2007, VBA.  What this button does is group worksheets based on the check box value being true.  Then it will display the print dialogue so the the user can print to PDF or to their printer.</p>\n\n<p>I am not sure how to go about this.  I did try using:</p>\n\n<pre><code>If me.chkTable1 = True Then Sheets(Table3.Name).Select\nIf me.chkTable2 = True Then Sheets(Table4.Name).Select\n</code></pre>\n\n<p>However I found that with this method the previous worksheet will deselect.  I thought that maybe an array will work.  That if the value of me.chkTableX = True then the array would be populated with the worksheet.  Then at the end I could select the array for printing.</p>\n\n<p>I am fairly new, so my apologies if I am missing something.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1460558797, "post_id": 36601275, "comment_id": 60800923, "body": "Have you tried setting calculation to manual before you delete the sheets, then reset afterwards?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6199207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fcef245565ca87937bffabc64f6b20?s=128&d=identicon&r=PG&f=1", "display_name": "Chiso", "link": "https://stackoverflow.com/users/6199207/chiso"}, "edited": false, "score": 0, "creation_date": 1460557623, "post_id": 36601433, "comment_id": 60799870, "body": "Yes, I am. Including <code>.DisplayAlerts = False</code>"}], "tags": [], "owner": {"reputation": 65, "user_id": 2637680, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a523082bf4b69dbf424f0ad4dc1b220?s=128&d=identicon&r=PG", "display_name": "sticks", "link": "https://stackoverflow.com/users/2637680/sticks"}, "is_accepted": false, "score": 1, "last_activity_date": 1460557481, "creation_date": 1460557481, "answer_id": 36601433, "question_id": 36601275, "link": "https://stackoverflow.com/questions/36601275/faster-method-for-deleting-multiple-worksheets/36601433#36601433", "title": "Faster Method for deleting multiple worksheets", "body": "<p>Are you using <code>Application.ScreenUpdating = False</code>?</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 6199207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fcef245565ca87937bffabc64f6b20?s=128&d=identicon&r=PG&f=1", "display_name": "Chiso", "link": "https://stackoverflow.com/users/6199207/chiso"}, "edited": false, "score": 0, "creation_date": 1460558239, "post_id": 36601492, "comment_id": 60800415, "body": "I split the code into sections using timers to find out which actions were taking up so much time. Also, previously I&#39;d force a break if it was running too slow and <code>Wrksh.Delete</code> would be highlighted."}], "tags": [], "owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "is_accepted": false, "score": 0, "last_activity_date": 1460557937, "last_edit_date": 1460557937, "creation_date": 1460557599, "answer_id": 36601492, "question_id": 36601275, "link": "https://stackoverflow.com/questions/36601275/faster-method-for-deleting-multiple-worksheets/36601492#36601492", "title": "Faster Method for deleting multiple worksheets", "body": "<p>Are you sure it's that portion of your code causing the problem? I quickly recreated your situation, and it runs almost instantly. </p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 6199207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fcef245565ca87937bffabc64f6b20?s=128&d=identicon&r=PG&f=1", "display_name": "Chiso", "link": "https://stackoverflow.com/users/6199207/chiso"}, "edited": false, "score": 0, "creation_date": 1460562360, "post_id": 36601624, "comment_id": 60803903, "body": "Thanks. The array method shortened runtime to 4 seconds on average."}], "tags": [], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "is_accepted": true, "score": 0, "last_activity_date": 1460558367, "last_edit_date": 1460558367, "creation_date": 1460557890, "answer_id": 36601624, "question_id": 36601275, "link": "https://stackoverflow.com/questions/36601275/faster-method-for-deleting-multiple-worksheets/36601624#36601624", "title": "Faster Method for deleting multiple worksheets", "body": "<p>OPTION 1\nYou can group the sheets and delete them as a group. That may be faster; you can test it.</p>\n\n<pre><code>Dim arrDelete() As String\nReDim arrDelete(MainFile.Worksheets.Count)\n\nDim index As Long\nFor Each WrkSh In MainFile.Worksheets\n    If WrkSh.index &gt; 5 Then\n        arrDelete(index) = WrkSh.Name\n        index = index + 1\n    End If\nNext WrkSh\n\nReDim Preserve arrDelete(index - 1)\n\nApplication.DisplayAlerts = False\nMainFile.Sheets(arrDelete).Delete\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p>OPTION 2\nIf there are no links outside of the sheets you want to keep, you could copy those sheets to a new workbook and delete the old workbook. This is probably not the safest option but may work in some situations.</p>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1460560321, "creation_date": 1460560321, "answer_id": 36602680, "question_id": 36601275, "link": "https://stackoverflow.com/questions/36601275/faster-method-for-deleting-multiple-worksheets/36602680#36602680", "title": "Faster Method for deleting multiple worksheets", "body": "<pre><code>Sub test()\n    Dim a(), sh As Worksheet\n\n    ReDim a(1 To Sheets.Count - 5)\n    For Each sh In ThisWorkbook.Sheets\n        If sh.Index &gt; 5 Then a(sh.Index - 5) = sh.Name\n    Next sh\n\n    Sheets(a).Delete\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6199207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fcef245565ca87937bffabc64f6b20?s=128&d=identicon&r=PG&f=1", "display_name": "Chiso", "link": "https://stackoverflow.com/users/6199207/chiso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1167, "favorite_count": 0, "accepted_answer_id": 36601624, "answer_count": 4, "score": 2, "last_activity_date": 1460560321, "creation_date": 1460557157, "last_edit_date": 1460557786, "question_id": 36601275, "link": "https://stackoverflow.com/questions/36601275/faster-method-for-deleting-multiple-worksheets", "title": "Faster Method for deleting multiple worksheets", "body": "<p>I have a workbook with multiple worksheets, most of which are to be deleted every time I run a specific macro. The number of worksheets to be deleted varies anywhere from 1 to 150.</p>\n\n<p>Currently the section of the macro below takes approximately 215 seconds to delete 78 worksheets. Is there any way to make it faster? Less than 60s runtime for a similar number of worksheets?</p>\n\n<p>Here is the relevant section of code:</p>\n\n<pre><code>For Each WrkSh In MainFile.Worksheets\n  If WrkSh.Index &gt; 5 Then\n    WrkSh.Delete\n  End If\nNext WrkSh\n\n\nMainFile.Sheets(\"Input\").Unprotect\nMainFile.Sheets(\"Buyers\").Unprotect\nMainFile.Sheets(\"Template\").Visible = True\nMainFile.Sheets(\"Holidays\").Visible = True\n\n\nWith MainFile.Sheets(\"Input\")\n  .Range(\"A10:A200\").ClearContents\n  .Range(\"E11:N200\").Clear\nEnd With\n\nWith MainFile.Sheets(\"Buyers\")\n  .Range(\"A10:B40\").ClearContents\n  .Range(\"C11:J40\").Clear\nEnd With\n</code></pre>\n\n<p>EDIT: I have this <code>Application.ScreenUpdating = False</code> at the beginning of the main code.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1460557316, "post_id": 36601339, "comment_id": 60799580, "body": "Thanks Scott, I&#39;ve plugged that in and then put the formula in a basic cell loop but am getting &quot;application-defined or object-defined error&quot;. would you be able to assist as to why? I have just added the code to the quesiton"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1460557382, "post_id": 36601339, "comment_id": 60799630, "body": "This is different, there was a typo in your original formula, there was an extra <code>)</code> in the formula.  Try the one I just posted."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1460557427, "post_id": 36601339, "comment_id": 60799682, "body": "Also I gave bad advice in my comment hence the repost in the answer."}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1460557612, "post_id": 36601339, "comment_id": 60799855, "body": "That&#39;s perfect Scott, thanks so much for the help!! So would I be correct in saying when referencing a new sheet, R1C1 will automatically start at the beginning of the sheet?"}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1460557633, "post_id": 36601339, "comment_id": 60799880, "body": "also can only accept the answer in 2 mins but will be sure to do so! :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1460557649, "post_id": 36601339, "comment_id": 60799897, "body": "Give me a second and I will edit the post to explain better."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 5, "last_activity_date": 1460558072, "last_edit_date": 1460558072, "creation_date": 1460557267, "answer_id": 36601339, "question_id": 36601150, "link": "https://stackoverflow.com/questions/36601150/mixing-r1c1-and-a1-notation/36601339#36601339", "title": "Mixing R1C1 and A1 notation", "body": "<p>In place of <code>A:C</code> put <code>C1:C3</code>:</p>\n\n<pre><code>ell.Offset(0, 5).FormulaR1C1 = \"=IF(LEN(RC[-2])&gt;0,(RC[-2])*VLOOKUP(RC[1],Core!C1:C3,3,FALSE)/_\nVLOOKUP(RC[-1],Core!C1:C3,3,FALSE),RC[4])\"\n</code></pre>\n\n<p>When using R1C1:</p>\n\n<ol>\n<li><p>the <code>[]</code> will denote a relative non absolute reference.  For example <code>RC[-1]</code> refers to the cells directly to the left.</p></li>\n<li><p>If absolute references are wanted then do not use the <code>[]</code> and it will refer to the row/column number. For example <code>R[1]C3</code> will return the row directly under the one being referenced but in column C.  If the referenced cell is <code>A3</code> then it would return <code>$C4</code>.</p></li>\n<li><p>If full column or full row are wanted then discard the <code>R</code> or <code>C</code>.  For example <code>C1:C3</code> would return <code>$A:$C</code> and <code>R[1]:R[2]</code> would return the relative reference of the two full rows directly below the referenced cell</p></li>\n</ol>\n"}], "owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3571, "favorite_count": 0, "accepted_answer_id": 36601339, "answer_count": 1, "score": 1, "last_activity_date": 1460558072, "creation_date": 1460556876, "last_edit_date": 1460557291, "question_id": 36601150, "link": "https://stackoverflow.com/questions/36601150/mixing-r1c1-and-a1-notation", "title": "Mixing R1C1 and A1 notation", "body": "<p>Struggling through applying a normal excel formula into R1C1 format so I can loop the formula in VBA. The question is how can I refer to columns in other sheets using R1C1 notation. So in the following formula:</p>\n\n<pre><code>ell.Offset(0, 5).FormulaR1C1 = \"=IF(LEN(R[]C[-2])&gt;0,(R[]C[-2])*VLOOKUP([R[]C[1]),Core!A:C,3,FALSE)/_\nVLOOKUP(R[]C[-1],Core!A:C,3,FALSE),R[]C[4])\"\n</code></pre>\n\n<p>How do I get Core!A:C into R1C1 format? I know you can't mix the two formats but i'm afraid i don't know the syntax for this! Any help is appreciated!</p>\n\n<p><strong>EDIT:</strong> </p>\n\n<pre><code>Sub Expo_dos_Formulas()\n\n'===============================================================================\nSheets(\"Data_Sheet\").Activate\n\nFor Each cell In Range(\"G5:G500\")\n    If cell &lt;&gt; \"Error\" Then\n        cell.Offset(0, 5).FormulaR1C1 = \"=IF(LEN(R[]C[-2])&gt;0,_\n(R[]C[-2])*VLOOKUP([R[]C[1]),Core!RC1:RC3,3,FALSE)/VLOOKUP(R[]C[-1],_\nCore!RC1:RC3,3,FALSE),R[]C[4])\"\n    End If\nNext\n'===============================================================================\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "is_accepted": false, "score": 1, "last_activity_date": 1460573109, "last_edit_date": 1460573109, "creation_date": 1460565316, "answer_id": 36604516, "question_id": 36600807, "link": "https://stackoverflow.com/questions/36600807/error-adding-table-to-document-object-variable-or-with-block-variable-is-not-s/36604516#36604516", "title": "Error Adding Table to document - Object variable or with block variable is not set", "body": "<p>You never set <code>t_newtable</code> in your <code>BuildTable</code> sub. If you have to create your table somewhere else, then you have to</p>\n\n<p><code>Set t_newtable = ActiveDocument.Tables(indexOfYourTable)</code> </p>\n\n<p>which will instantiate your <code>t_newtable</code> to the object you want it to be. <strong>NOTE:</strong> <code>indexOfYourTable</code> is <code>1</code> based not <code>0</code> based.</p>\n\n<p><strong>OR</strong></p>\n\n<p>You can put the line of code in your <code>Create_Sized_Table_Multi_Column</code> sub inside your <code>BuildTable</code> sub and pass the variables needed into your <code>BuildTable</code> sub.</p>\n"}, {"comments": [{"owner": {"reputation": 2489, "user_id": 4941264, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/72edbb7098bc7082a3f245d694602160?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Price", "link": "https://stackoverflow.com/users/4941264/simon-price"}, "edited": false, "score": 0, "creation_date": 1460622773, "post_id": 36607719, "comment_id": 60831813, "body": "thank you very much! its been a while since using VBA as I say, plus having a new born in the house..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 2489, "user_id": 4941264, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/72edbb7098bc7082a3f245d694602160?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Price", "link": "https://stackoverflow.com/users/4941264/simon-price"}, "edited": false, "score": 0, "creation_date": 1460658847, "post_id": 36607719, "comment_id": 60857902, "body": "Yes, very distracting :-)"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1460639226, "last_edit_date": 1460639226, "creation_date": 1460575333, "answer_id": 36607719, "question_id": 36600807, "link": "https://stackoverflow.com/questions/36600807/error-adding-table-to-document-object-variable-or-with-block-variable-is-not-s/36607719#36607719", "title": "Error Adding Table to document - Object variable or with block variable is not set", "body": "<p>You declare t_<code>newtable</code> in the procedure <code>Create_Sized_Table_Multi_Column</code>, so it will be limited to that scope. If you want to call that procedure, have it create the table, then make it available to the code that called it, you need to change the <code>Sub</code> into a <code>Function</code> and have the function return the table.</p>\n\n<p>For example:</p>\n\n<pre><code>Private Function Create_Sized_Table_Multi_Column(i_Rows As Integer, _\n                                           i_Columns As Integer) As Table\n\n  'create a table\n  Set Create_Sized_Table_Multi_Column = ActiveDocument.Tables.Add( _\n                                      Selection.Range, i_Rows, i_Columns)\nEnd Function\n</code></pre>\n\n<p>Then you use it like this (code shortened for clarity):</p>\n\n<pre><code>Private Sub BuildTable(arr() As String, colCount As Integer, bookMark As String)\n\n  Dim t_newtable As Table\n  'Add a table - this table will contain moved funds\n  'creates the table dimensioned by i_rows x i_column\n  Set t_newtable = Create_Sized_Table_Multi_Column(i_Rows_Required, _\n                                                i_Columns_Required)\nEnd Sub\n</code></pre>\n\n<p>Note the added parenthesis around the call to the function. These are required when something is to be returned from a call.</p>\n"}], "owner": {"reputation": 2489, "user_id": 4941264, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/72edbb7098bc7082a3f245d694602160?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Price", "link": "https://stackoverflow.com/users/4941264/simon-price"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 36607719, "answer_count": 2, "score": 0, "last_activity_date": 1460642349, "creation_date": 1460556091, "last_edit_date": 1460642349, "question_id": 36600807, "link": "https://stackoverflow.com/questions/36600807/error-adding-table-to-document-object-variable-or-with-block-variable-is-not-s", "title": "Error Adding Table to document - Object variable or with block variable is not set", "body": "<p>I am working with VBA for the first time in a long time and need some help with adding a table into the document. </p>\n\n<p>the line in question at the moment is </p>\n\n<pre><code>.Cell(1, x).Range.Select\n</code></pre>\n\n<p>and the error that I get is object variable or with block variable is not set. and for the life of me I cannot see where I am going wrong on this one. </p>\n\n<p>I am passing in a 3 dimensional string array that I am looking to pass into a table and this is the code I am working with at the moment </p>\n\n<pre><code>Private Sub Create_Sized_Table_Multi_Column(i_Rows As Integer, i_Columns As Integer)\n'create a table\nSet t_newtable = ActiveDocument.Tables.Add(Selection.Range, i_Rows, i_Columns)\nEnd Sub\n\n\nPrivate Sub BuildTable(arr() As String, colCount As Integer, bookMark As String)\n\nDim t_newtable As Table\nDim i_Fund_Quantity As Integer\nDim i_Rows_Required As Integer\nDim i_Columns_Required As Integer\n            'Number of funds is the upperbound + 1 to allow for the zero relative\n            i_Fund_Quantity = UBound(arr) + 1\n            'header Row\n            i_Rows_Required = UBound(arr) + 1\n\n            'Number of columns\n            i_Columns_Required = colCount\n\n'Add a table - this table will contain moved funds\n'creates the table dimensioned by i_rows x i_column\n            Create_Sized_Table_Multi_Column i_Rows_Required, i_Columns_Required\n\n            'Now populate the header row\n            With t_newtable\n                For x = 0 To i_Columns_Required\n                    .Cell(1, x).Range.Select\n                    If x = 1 Then\n                        Set_Table_Headers \"Existing Fund\"\n                    ElseIf x = 2 Then\n                        Set_Table_Headers \"Customer Name\"\n                    ElseIf x = 3 Then\n                        Set_Table_Headers \"Switch To\"\n                        ActiveDocument.Bookmarks.Add (\"bk_Switched_Table\")\n                    End If\n                Next\n            End With\n\n\n            'Populate the table with the fund details\n            ''//sp write to table here\n\n            With t_newtable\n                'Position cursor at first insertion point\n                'ActiveDocument.Bookmarks(\"bk_Switched_Table\").Select\n                'Now create a loop\n                For i_Loop_Rows = 0 To UBound(arr)\n\n                        Set_Table_Rows\n                        Selection.TypeText arr(i, 0)\n                        Selection.MoveRight UNIT:=wdCell\n                        Selection.TypeText arr(i, 1)\n                        Selection.MoveRight UNIT:=wdCell\n                        Selection.TypeText arr(i, 2)\n                        t_newtable.Columns(3).Select\n                        t_newtable.Columns.AutoFit\n                        Selection.Collapse Direction:=wdCollapseEnd\n\n\n                Next\n            End With\n\n            ActiveDocument.Bookmarks(bookMark).Select\n            Selection.TypeParagraph\n            Selection.TypeText s_Text\n            Selection.TypeParagraph\n            ActiveDocument.Bookmarks.Add (bookMark)\n\nEnd Sub\n</code></pre>\n\n<p>I would be grateful if someone could review this and let me know where I have gone wrong and what I need to change. </p>\n\n<p>thanks</p>\n\n<p>Simon </p>\n"}, {"tags": ["xml", "excel", "uiribbon", "vba"], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 6199120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4d45fd866fdc1be9a9e0dd0b7f00a9?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6199120/hugo"}, "is_accepted": true, "score": 4, "last_activity_date": 1460646825, "creation_date": 1460646825, "answer_id": 36627275, "question_id": 36600682, "link": "https://stackoverflow.com/questions/36600682/dynamically-populate-dynamicmenu-in-excel-ui-ribbon/36627275#36627275", "title": "Dynamically populate dynamicMenu in excel UI Ribbon", "body": "<p>Solved! Got the answer from <a href=\"http://www.rondebruin.nl/win/s2/win014.htm\" rel=\"nofollow\">this link</a>.</p>\n\n<p>just direct your getContent instruction to this macro:</p>\n\n<pre><code>Sub GetContent(control As IRibbonControl, ByRef returnedVal)\n    Dim xml As String\n\n    xml = \"&lt;menu xmlns=\"\"http://schemas.microsoft.com/office/2009/07/customui\"\"&gt;\" &amp; _\n          \"&lt;button id=\"\"but1\"\" imageMso=\"\"Help\"\" label=\"\"Help\"\" onAction=\"\"HelpMacro\"\"/&gt;\" &amp; _\n          \"&lt;button id=\"\"but2\"\" imageMso=\"\"FindDialog\"\" label=\"\"Find\"\" onAction=\"\"FindMacro\"\"/&gt;\" &amp; _\n          \"&lt;/menu&gt;\"\n\n    returnedVal = xml\nEnd Sub\n\nSub HelpMacro(control As IRibbonControl)\n    MsgBox \"Help macro\"\nEnd Sub\n\nSub FindMacro(control As IRibbonControl)\n    MsgBox \"Find macro\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 6199120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4d45fd866fdc1be9a9e0dd0b7f00a9?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6199120/hugo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2397, "favorite_count": 1, "accepted_answer_id": 36627275, "answer_count": 1, "score": 2, "last_activity_date": 1460646825, "creation_date": 1460555816, "last_edit_date": 1531161705, "question_id": 36600682, "link": "https://stackoverflow.com/questions/36600682/dynamically-populate-dynamicmenu-in-excel-ui-ribbon", "title": "Dynamically populate dynamicMenu in excel UI Ribbon", "body": "<p>I want to populate a dynamicMenu in a custom Excel Ribbon from a list in a sheet. My xml code is this:</p>\n\n<pre><code>&lt;dynamicMenu id=\"A\" label=\"Menu A\" imageMso=\"FormatPainter\" getContent=\"GetMenuContent\" /&gt;\n</code></pre>\n\n<p>I can see the menu. What I don\u00b4t have is the GetMenuContent callback, but I understand that there is where the macro to populate the menu should go right?</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1460556242, "post_id": 36600510, "comment_id": 60798674, "body": "This doesn&#39;t seem right. There is no <code>Dim</code> for Counter as far as I can see before <code>Counter = Counter + 1</code>. So, in the first run it is 0 and therefore the first <code>ReDim</code> will go from 1 to 0 and then from 1 to 1. Could it be that you are stirring up your array? By default VBA uses the <code>Option Base 0</code>. So, I&#39;d change your line to <code>ReDim Preserve o_Summ(0 To Counter)</code> or set Counter to 1 (before the loop), <code>Dim</code> it as <code>Long</code>, and use <code>ReDim Preserve o_Summ(Counter)</code> (stating the elements only and not where to start or where to end)."}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 1, "creation_date": 1460587995, "post_id": 36600510, "comment_id": 60818648, "body": "Your code doesn&#39;t make sense? The fso.GetFolder(Path) loop is not adding anything to your inner rs.eof loop."}], "answers": [{"tags": [], "owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "is_accepted": false, "score": 0, "last_activity_date": 1461116221, "last_edit_date": 1461116221, "creation_date": 1461110882, "answer_id": 36731571, "question_id": 36600510, "link": "https://stackoverflow.com/questions/36600510/excel-vba-types-converting-error/36731571#36731571", "title": "Excel VBA types converting error", "body": "<p>Just curious with this issue and found the problem.  There is a bug in lotus 1-2-3 as it assumes 1900 is a leap year and Excel replicate the bug deliberately <a href=\"https://support.microsoft.com/en-us/kb/214326\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/kb/214326</a>.</p>\n\n<p>On the excel I change the cell format to date time:</p>\n\n<ul>\n<li><p>59 as 28 Feb 1900 </p></li>\n<li><p>60 as 29 Feb 1900 </p></li>\n</ul>\n\n<p>However in ADO field's value, both are displayed as 28 Feb 1900 and when converted to double both values are 60. </p>\n\n<p>The only way I can think of to solve this issue is to open your data worksheet, change the cell format to general.</p>\n\n<p>EDIT: Test Data\n<a href=\"https://i.stack.imgur.com/PNhPs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PNhPs.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 6198837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddbeec5b418f0a5965973f5c33b905fc?s=128&d=identicon&r=PG&f=1", "display_name": "Ihor", "link": "https://stackoverflow.com/users/6198837/ihor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461116221, "creation_date": 1460555427, "last_edit_date": 1460645731, "question_id": 36600510, "link": "https://stackoverflow.com/questions/36600510/excel-vba-types-converting-error", "title": "Excel VBA types converting error", "body": "<p>I'm collecting data from Excel files (hundreds or thousands of files) to one resulting Excel table using SQL query. </p>\n\n<blockquote>\n  <p>Problem is:</p>\n</blockquote>\n\n<p>somehow all numbers in Excel files are stored in Date format (ADO Fields(i).Type = 7) and while converting them back to numeric format ex. <code>myVar = cDbl(recordset.Fields(8).Value)</code> I receive result bigger then origin by 1.</p>\n\n<p>This error occures for number smaller then 60 (earlier then 01.03.1900 respectivly).</p>\n\n<p>Should be common problem but I couldn't find any straight idea how to fix it.</p>\n"}, {"tags": ["excel", "for-loop", "find", "rows", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1460555228, "post_id": 36600019, "comment_id": 60797765, "body": "Look at doing a <code>.find</code> from the bottom up.  <a href=\"http://stackoverflow.com/questions/22464631/perform-a-find-within-vba-from-the-bottom-of-a-range-up\" title=\"perform a find within vba from the bottom of a range up\">stackoverflow.com/questions/22464631/&hellip;</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1460556029, "post_id": 36600019, "comment_id": 60798488, "body": "Also, using <code>.Select</code>/<code>.Activate</code> can slow down code. See <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">this thread</a> on how to avoid using those."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1460556360, "post_id": 36600019, "comment_id": 60798772, "body": "I&#39;m having right trouble looking through your code - I copied and pasted it into my workbook and it asks to define these variables: <code>d_input, data_col, data_row, data_last, j, CBtype, lRow, cBend, CBstart, CBold, box_name, CBnew, CBend2, YN_result</code>.  Good practice to add <code>Option Explicit</code> at the top of each module.  You can get the value for <code>data_row</code> using <code>data_row = Range(d_input).Row</code>.  When you use <code>End(xlDown)</code> are you looking for the last row or the first row containing no data?  Should it always look at column B, or the column selected with  <code>d_input</code>? As @MatthewD said - use <code>.Find</code>."}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1460568655, "post_id": 36600019, "comment_id": 60808086, "body": "@MatthewD if you could put that find suggestion as an answer I will be happy to accept it. It does what i need I just need to integrate it into my code."}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1460568738, "post_id": 36600019, "comment_id": 60808130, "body": "@BruceWayne I tried to minimize my use of <code>select</code> and <code>activate</code>. That link is alos very helpful. When I have time I will go back thru my code and adjust accordingly."}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1460578591, "post_id": 36600019, "comment_id": 60814164, "body": "@DarrenBartrup-Cook im looking from the bottom up, because of the loop that I&#39;m running. find template ID, copy that template rename info in template, find next template repeat. as for the variables most of them are generated form user inputs or finding a row in the <code>HR-Calc</code> sheet"}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1460659841, "last_edit_date": 1495540777, "creation_date": 1460659841, "answer_id": 36631568, "question_id": 36600019, "link": "https://stackoverflow.com/questions/36600019/excel-vba-step-thru-rows-faster/36631568#36631568", "title": "excel vba step thru rows faster", "body": "<p>Look at doing a .find from the bottom up.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/22464631/perform-a-find-within-vba-from-the-bottom-of-a-range-up\">Perform a FIND, within vba, from the bottom of a range up</a></p>\n\n<p>That will eliminate the need to do the for loop from the last row to the first occurrence of the value you want to locate.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1460662587, "post_id": 36632179, "comment_id": 60860084, "body": "This is a viable alternative but the loop should still step backwards; e.g. <code>For y = UBound(varArray,1) to LBound(varArray,1) Step -1</code> in this particular case. If the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">Range.Find method</a> was isolated to a single column and <b>xlPrevious</b> was used, it will probably be as fast or slightly faster than the array loop. Either will be faster then looping through the worksheet&#39;s cells."}], "tags": [], "owner": {"reputation": 41, "user_id": 6188708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WtUPM.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/6188708/david"}, "is_accepted": false, "score": 1, "last_activity_date": 1460661854, "creation_date": 1460661854, "answer_id": 36632179, "question_id": 36600019, "link": "https://stackoverflow.com/questions/36600019/excel-vba-step-thru-rows-faster/36632179#36632179", "title": "excel vba step thru rows faster", "body": "<p>I'm not sure if this will help but I've had a great performance increase with pulling the entire range you need to loop through into a variant array and then looping through the array.  If I need to loop through large data sets, this method has worked out well.</p>\n\n<pre><code>Dim varArray as Variant\nvarArray = Range(....) 'set varArray to the range you're looping through\nFor y = 1 to uBound(varArray,1)  'loops through rows of the array\n    'code for each row here\n    'to loop through individual columns in that row, throw in another loop\n    For x = 1 to uBound(varArray, 2) 'loop through columns of array\n       'code here\n    Next x\nNext y\n</code></pre>\n\n<p>You can also define the column indexes prior to executing the loop.  Then you only need to execute the you need to pull those directly in the loop.</p>\n\n<pre><code>'prior to executing the loop, define the column index of what you need to look at\nDim colRevenue as Integer\ncolRevenue = 5 'or a find function that searches for a header named \"Revenue\"\n\nDim varArray as Variant\n    varArray = Range(....) 'set varArray to the range you're looping through\nFor y = 1 to uBound(varArray,1)  'loops through rows of the array\n    tmpRevenue = CDbl(varArray(y, colRevenue))\nNext y\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1460661854, "creation_date": 1460554279, "last_edit_date": 1531161705, "question_id": 36600019, "link": "https://stackoverflow.com/questions/36600019/excel-vba-step-thru-rows-faster", "title": "excel vba step thru rows faster", "body": "<p>the code below works 100%. It scans for a match in Column B and copies and renames a group of cells when a match is found. However the is a line <code>For lRow = Sheets(\"HR-Calc\").Cells(Cells.Rows.count, \"b\").End(xlUp).Row To 7 Step -1</code>\nWhere the <code>step -1</code> will scan row by row from the bottom of the sheet until a match is found. It would be much easier if the step was set to <code>End.(xlUp)</code> instead of <code>-1</code>. searching every row is overkill because of how the data is set up <code>End.(xlUp)</code> would massive cut down the run time. \nIs something like this possible?</p>\n\n<pre><code>Sub Fill_CB_Calc()\n\nM_Start:\n\nApplication.ScreenUpdating = True\n\nSheets(\"summary\").Activate\nd_input = Application.InputBox(\"select first cell in data column\", \"Column Data Check\", Default:=\"\", Type:=8).Address(ReferenceStyle:=xlA1, RowAbsolute:=True, ColumnAbsolute:=False)\n\ndata_col = Left(d_input, InStr(2, d_input, \"$\") - 1)\ndata_row = Right(d_input, Len(d_input) - InStr(2, d_input, \"$\"))\n\nApplication.ScreenUpdating = False\n\nSheets(\"summary\").Activate\nRange(d_input).End(xlDown).Select\n\ndata_last = ActiveCell.Row\n\nIf IsEmpty(Range(data_col &amp; data_row + 1)) = True Then\n    data_last = data_row\n\nElse\nEnd If\n\n    For j = data_row To data_last\n\nCBtype = Sheets(\"summary\").Range(data_col &amp; j)\n\n    Sheets(\"HR-Calc\").Activate\n    For lRow = Sheets(\"HR-Calc\").Cells(Cells.Rows.count, \"b\").End(xlUp).Row To 7 Step -1\n\n    If Sheets(\"HR-Calc\").Cells(lRow, \"b\") = CBtype Then\n\n            CBend = Sheets(\"HR-Calc\").Range(\"C\" &amp; lRow).End(xlDown).Row + 1\n            Sheets(\"HR-Calc\").Rows(lRow &amp; \":\" &amp; CBend).Copy\n\n            CBstart = Sheets(\"HR-Calc\").Range(\"c50000\").End(xlUp).Row + 2\n\n            ActiveWindow.ScrollRow = CBstart - 8\n\n            Sheets(\"HR-Calc\").Range(\"A\" &amp; CBstart).Insert Shift:=xlDown\n\n            CBold = Right(Range(\"c\" &amp; CBstart), Len(Range(\"C\" &amp; CBstart)) - 2)\n\n                box_name = Sheets(\"summary\").Range(data_col &amp; j).Offset(0, -10)\n\n                CBnew = Right(box_name, Len(box_name) - 2) &amp; \"-\"  ' &lt;--this is custom and can be changed based on CB naming structure\n                If CBnew = \"\" Or vbCancel Then\n                End If\n            CBend2 = Range(\"c50000\").End(xlUp).Row - 2\n\n            Range(\"C\" &amp; CBstart + 1 &amp; \":\" &amp; \"C\" &amp; CBend2).Select\n                Selection.Replace What:=CBold &amp; \"-\", Replacement:=CBnew, LookAt:=xlPart, _\n                SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n                ReplaceFormat:=False\n\n            Range(\"C\" &amp; CBstart).FormulaR1C1 = \"CB\" &amp; Left(CBnew, Len(CBnew) - 1)\n\n            GoTo M_Start2\n    Else\n\n    End If\n\nNext lRow\nM_Start2:\n            Next j\n\nYN_result = MsgBox(\"Fill info for another block/inverter?\", vbYesNo + vbExclamation)\nIf YN_result = vbYes Then GoTo M_Start\nIf YN_result = vbNo Then GoTo jumpout\n\njumpout:\n'    Sheets(\"summary\").Range(d_input).Select\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1460558956, "post_id": 36599960, "comment_id": 60801084, "body": "Posted a regexp solution :)"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460566730, "post_id": 36600490, "comment_id": 60806883, "body": "surprisingly, as per my testing, this is the fastest method of the ones here posted up to date"}, {"owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460614324, "post_id": 36600490, "comment_id": 60826607, "body": "Glad I could help mate,  I would have a assumed a regex to be faster also."}], "tags": [], "owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "is_accepted": true, "score": 2, "last_activity_date": 1460555377, "creation_date": 1460555377, "answer_id": 36600490, "question_id": 36599960, "link": "https://stackoverflow.com/questions/36599960/how-to-check-if-a-string-contains-a-continous-integer/36600490#36600490", "title": "How to check if a string contains a continous integer", "body": "<p>You could use a user defined formula in VBA. Place the foloowing code in a new module and call it as a function in Excel as <code>=Extract6Digits(A1)</code></p>\n\n<pre><code>Function Extract6Digits(Number As String)\n\nDim varCount As Integer\nDim i As Integer\nDim varOutput As String\nDim varTemp As String\n\nvarCount = 0\nvarTemp = \"\"\n\nFor i = 1 To Len(\"\" &amp; Number &amp; \"\")\n\n    If Asc(Mid(\"\" &amp; Number &amp; \"\", i, 1)) &gt;= 48 And Asc(Mid(\"\" &amp; Number &amp; \"\", i, 1)) &lt;= 57 Then\n\n        varCount = varCount + 1\n        varTemp = varTemp &amp; Mid(\"\" &amp; Number &amp; \"\", i, 1)\n\n    Else\n\n        varCount = 0\n        varTemp = \"\"\n\n    End If\n\n    If varCount = 6 Then\n\n        If varOutput = \"\" Then\n\n            varOutput = varTemp\n\n        Else\n\n            varOutput = varOutput &amp; \",\" &amp; varTemp\n\n        End If\n\n        varCount = 0\n        varTemp = \"\"\n\n    End If\n\nNext\n\nExtract6Digits = varOutput\n\nEnd Function\n</code></pre>\n\n<p>This is by no means the most efficient method, but it works</p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460566627, "post_id": 36600546, "comment_id": 60806820, "body": "in such a string as &quot;hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105&quot; this functions only catches the &quot;800000&quot; number"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "is_accepted": false, "score": 0, "last_activity_date": 1460555503, "creation_date": 1460555503, "answer_id": 36600546, "question_id": 36599960, "link": "https://stackoverflow.com/questions/36599960/how-to-check-if-a-string-contains-a-continous-integer/36600546#36600546", "title": "How to check if a string contains a continous integer", "body": "<p>Try</p>\n\n<pre><code>Function GetSixDigits(s As String) As String\n\n    Dim intIndex As Integer\n    Dim strArr() As String\n    strArr = Split(s, \"_\")\n\n    For intIndex = LBound(strArr) To UBound(strArr)\n        If Len(strArr(intIndex)) = 6 And IsNumeric(strArr(intIndex)) Then\n            GetSixDigits = strArr(intIndex)\n            Exit Function\n        End If\n    Next\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460566351, "post_id": 36601084, "comment_id": 60806651, "body": "this only catches the first occurrence of a 6 digit number"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1460556734, "creation_date": 1460556734, "answer_id": 36601084, "question_id": 36599960, "link": "https://stackoverflow.com/questions/36599960/how-to-check-if-a-string-contains-a-continous-integer/36601084#36601084", "title": "How to check if a string contains a continous integer", "body": "<p>try this</p>\n\n<pre><code>Sub test()\n    lastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For i = 1 To lastrow\n        totallen = Len(Range(\"A\" &amp; i).Value)\n        For j = 1 To totallen\n            thischar = Mid(Range(\"A\" &amp; i), j, 1)\n            Select Case thischar\n            Case \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"0\"\n                If IsNumeric(Mid(Range(\"A\" &amp; i), j, 6)) = True Then\n                    Range(\"B\" &amp; i).Value = Mid(Range(\"A\" &amp; i), j, 6)\n                    Exit For\n                End If\n            End Select\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460566516, "post_id": 36602032, "comment_id": 60806758, "body": "this works but (sadly) is the slowest one. I said sadly since in my opinion this is the most elegant solution. could be that <code>For Each Match In matches</code> loop adding sensitive time?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460568835, "post_id": 36602032, "comment_id": 60808187, "body": "Slowest? How? Try timing it with a string which is 2k long ;)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460569142, "post_id": 36602032, "comment_id": 60808364, "body": "well my tests were with one column of 12k rows whose cells were filled with a string like &quot;A2&quot; from OP question. I didn&#39;t test with a longer string, but I believe you by word!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460570144, "post_id": 36602032, "comment_id": 60808992, "body": "I couldn&#39;t resist and made a test! I filled each cell of a 1k rows column with a 3k long word (I repeated the &quot;A2&quot; OP&#39;s pattern as needed). I found that AranDG code is twice faster than yours (and giving the same results...). Does this make sense to you?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460570323, "post_id": 36602032, "comment_id": 60809101, "body": "I am not sure how are you using it. I am out at the moment. Posting from phone. Let me come back and post my findings :)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460571400, "post_id": 36602032, "comment_id": 60809747, "body": "if you don&#39;t mind I could edit your post and at the bottom add code about how I use it. or make a new answer (which is not however)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460571600, "post_id": 36602032, "comment_id": 60809865, "body": "I would recommend adding it to your question on how are you testing both methods"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460571696, "post_id": 36602032, "comment_id": 60809917, "body": "should I start a question anew?"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1460558846, "creation_date": 1460558846, "answer_id": 36602032, "question_id": 36599960, "link": "https://stackoverflow.com/questions/36599960/how-to-check-if-a-string-contains-a-continous-integer/36602032#36602032", "title": "How to check if a string contains a continous integer", "body": "<p>I thought you wanted <code>regexp</code> solution ;)</p>\n\n<p>Is this what you want?</p>\n\n<pre><code>Sub Sample()\n    Dim s As String\n    Dim regEx, Match, matches\n    Dim rngRange As Range\n\n    s = \"A123456X hello_24.02_75_150001 A3 : 6500000_take:away A4 : computer_800000_24.01.105 987654\"\n\n    With CreateObject(\"vbscript.regexp\")\n        .Pattern = \"(^|\\D)(\\d{6})(\\D|$)\"\n        .Global = True\n\n        Set matches = .Execute(s)\n\n        If matches.Count &gt; 0 Then\n            For Each Match In matches\n                Debug.Print Match.SubMatches(1)\n                '~~&gt; Result\n                '123456\n                '150001\n                '800000\n                '987654\n            Next\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3870, "user_id": 2336725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20a0b96a26cf233d752469445595f872?s=128&d=identicon&r=PG", "display_name": "Teepeemm", "link": "https://stackoverflow.com/users/2336725/teepeemm"}, "edited": false, "score": 0, "creation_date": 1460658875, "post_id": 36606675, "comment_id": 60857917, "body": "Don&#39;t open with &quot;this is not an answer&quot;.  It provides two answers to the question, and compares them.  The fact that the answers came from other users should be noted, but you&#39;re still providing an answer."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3870, "user_id": 2336725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20a0b96a26cf233d752469445595f872?s=128&d=identicon&r=PG", "display_name": "Teepeemm", "link": "https://stackoverflow.com/users/2336725/teepeemm"}, "edited": false, "score": 0, "creation_date": 1460663370, "post_id": 36606675, "comment_id": 60860551, "body": "My first concern was not to steal any credits from people who gave real answers. That said, if you really think it is an answer I&#39;d expect focus on being it useful or not whether on which word I chose to begin it with. I feel a lot of respect for people here who take their time to help other people and never care about how they write things but only if they add something or not."}, {"owner": {"reputation": 12054, "user_id": 3614835, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/xzZDV.png?s=128&g=1", "display_name": "Jeffrey Bosboom", "link": "https://stackoverflow.com/users/3614835/jeffrey-bosboom"}, "edited": false, "score": 0, "creation_date": 1460702034, "post_id": 36606675, "comment_id": 60873973, "body": "There&#39;s a flag type named <i>not an answer</i> that feeds your post into the Low Quality Posts queue, where reviewers can choose to delete it.  If you start your post with &quot;this is not an answer&quot;, it&#39;s very likely to be deleted in review.  Teepeemm&#39;s just trying to help you keep your answer from being deleted."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460703401, "post_id": 36606675, "comment_id": 60874677, "body": "I appreciate both your explanation and the &quot;possible&quot; help try by Teepeemm. I also think help cab be given with a plain comment without down-voting the answer... as for my not-answer deletion risk: I&#39;m confident that anyone who decides to delete any answer is going to read it through first. but it&#39;s very likely to be deleted since nobody till now happened to find it useful (no up-votes). that&#39;s life!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1460744789, "post_id": 36606675, "comment_id": 60901855, "body": "It has, indeed, landed in the deletion queue. Would it hurt so much to click the <a href=\"https://stackoverflow.com/posts/36606675/edit\">edit</a> link below the Answer and make some small changes to reflect how it helps in the discussion :-)? There <i>are</i> &quot;robo-reviewers&quot; who will delete based on that one statement, without reading further. I&#39;m not one of them, but it almost happened to me..."}, {"owner": {"reputation": 40596, "user_id": 1677912, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/craWj.png?s=128&g=1", "display_name": "Mogsdad", "link": "https://stackoverflow.com/users/1677912/mogsdad"}, "edited": false, "score": 0, "creation_date": 1460988913, "post_id": 36606675, "comment_id": 60981030, "body": "See the simple edit that makes answers like this helpful. Now... if you included the results of the testing, that would be really helpful!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1460988798, "last_edit_date": 1460988798, "creation_date": 1460572184, "answer_id": 36606675, "question_id": 36599960, "link": "https://stackoverflow.com/questions/36599960/how-to-check-if-a-string-contains-a-continous-integer/36606675#36606675", "title": "How to check if a string contains a continous integer", "body": "<p>Expanding on Siddharth Rout and AranDG answers, I've done some performance testing.</p>\n\n<p>Test of Siddharth Rout's solution</p>\n\n<pre><code>'----------------------------------------\n'adapted from Siddharth Rout's answer\n' works\nSub Sample()\n    Dim regEx, Match, matches\n    Dim rngRange As Range, cell As Range\n    Dim i As Integer\n    Dim mytime As Long\n\n    mytime = Timer\n\n    With CreateObject(\"vbscript.regexp\")\n        .Pattern = \"(^|\\D)(\\d{6})(\\D|$)\"\n        .Global = True\n\n        For Each cell In Range(\"A1:A12000\").SpecialCells(xlCellTypeConstants, xlTextValues)\n            Set matches = .Execute(cell.Value)\n\n            If matches.Count &gt; 0 Then\n                i = 0\n                For Each Match In matches\n                    i = i + 1\n                    cell.Offset(, i) = Match.SubMatches(1)\n                Next\n            End If\n        Next cell\n\n    End With\n    MsgBox Timer - mytime\n\nEnd Sub\n'----------------------------------------\n</code></pre>\n\n<p>Test of AranDG's solution:</p>\n\n<pre><code>'----------------------------------------\n'adapted form AranDG\n' works\nSub Sample4()\nDim cell As Range\nDim arr As Variant\nDim mytime As Long\n\nmytime = Timer\n\nFor Each cell In Range(\"A1:A12000\").SpecialCells(xlCellTypeConstants, xlTextValues)\n'    cell.Offset(, 1) = Extract6Digits(cell.Value)\n    arr = Extract6Digits(cell.Value)\n    cell.Offset(, 1).Resize(, UBound(arr) + 1) = arr\nNext cell\n\nMsgBox Timer - mytime\nEnd Sub\n\nFunction Extract6Digits(Number As String) As Variant\n\nDim varCount As Integer\nDim i As Integer\nDim varOutput As String\nDim varTemp As String\n\nvarCount = 0\nvarTemp = \"\"\n\nFor i = 1 To Len(\"\" &amp; Number &amp; \"\")\n\n    If Asc(Mid(\"\" &amp; Number &amp; \"\", i, 1)) &gt;= 48 And Asc(Mid(\"\" &amp; Number &amp; \"\", i, 1)) &lt;= 57 Then\n\n        varCount = varCount + 1\n        varTemp = varTemp &amp; Mid(\"\" &amp; Number &amp; \"\", i, 1)\n\n    Else\n\n        varCount = 0\n        varTemp = \"\"\n\n    End If\n\n    If varCount = 6 Then\n\n        If varOutput = \"\" Then\n\n            varOutput = varTemp\n\n        Else\n\n            varOutput = varOutput &amp; \",\" &amp; varTemp\n\n        End If\n\n        varCount = 0\n        varTemp = \"\"\n\n    End If\n\nNext\n\nExtract6Digits = Split(varOutput, \",\")\n\nEnd Function\n'----------------------------------------\n</code></pre>\n\n<p>And I run them with active sheet column \"A\" filled from \"A1\" to \"A1000\" with the following string:</p>\n\n<pre><code>hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105  hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105  hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105  hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105  hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 hello_24.02_75_150001 A3 : 650000_take:away A4 : computer_800000_24.01.105 \n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 2965711, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a66ddff0ca033da9adf3f2425493767b?s=128&d=identicon&r=PG&f=1", "display_name": "user2965711", "link": "https://stackoverflow.com/users/2965711/user2965711"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 36600490, "answer_count": 5, "score": 1, "last_activity_date": 1460988798, "creation_date": 1460554178, "last_edit_date": 1460735407, "question_id": 36599960, "link": "https://stackoverflow.com/questions/36599960/how-to-check-if-a-string-contains-a-continous-integer", "title": "How to check if a string contains a continous integer", "body": "<p>I have rows of information, and need to extract just the integers from them.</p>\n\n<p>Ex:</p>\n\n<pre><code>A1 : 130001    \nA2 : hello_24.02_75_150001  \nA3 : 650000_take:away  \nA4 : computer_800000_24.01.105\n</code></pre>\n\n<p>I want to take only the six digit numbers (130000, 150001, 650000, 800000). How can I get only those?</p>\n\n<p>I tried <code>IsNumeric(number)</code> and</p>\n\n<pre><code>If Regex.IsMatch(number, \"^[0-9 ]+$\") Then\n\n...\n\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "syntax", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1460552468, "post_id": 36599002, "comment_id": 60795342, "body": "It doesn&#39;t look like the field names you use in the <code>GetPivotData</code> call match the fields you are looping through."}, {"owner": {"reputation": 19, "user_id": 1437832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ccb3441ae48ea83052cff97693e1e60?s=128&d=identicon&r=PG", "display_name": "user1437832", "link": "https://stackoverflow.com/users/1437832/user1437832"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1460612485, "post_id": 36599002, "comment_id": 60825875, "body": "These are not the original fields. So this is not a problem"}], "owner": {"reputation": 19, "user_id": 1437832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ccb3441ae48ea83052cff97693e1e60?s=128&d=identicon&r=PG", "display_name": "user1437832", "link": "https://stackoverflow.com/users/1437832/user1437832"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 378, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460551944, "creation_date": 1460551944, "last_edit_date": 1531164843, "question_id": 36599002, "link": "https://stackoverflow.com/questions/36599002/vba-getpivotdata-wrong-syntax", "title": "Vba Getpivotdata wrong syntax", "body": "<p>i just want to iterate throught a pivot table. I am using getpivotdata to extract the pivot values. However, i must doing something wrong with syntax, because getpivotdata cannot work. I know that the problem is there because using values straigth from the pivot, makes it work.</p>\n\n<p>I tried single quotes, double quotes, nothing helped. Please, can anyone check what is wrong with the getpivotdata syntax?</p>\n\n<p>I</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\nDim pt As PivotTable\nDim rsl As PivotTable\nSet pt = Worksheets(\"Sheet3\").PivotTables(\"PivotTable1\")\nDim counter As Integer\n\n\n\nFor Each customer In pt.RowFields(\"ccode\").PivotItems\n  For Each product In pt.RowFields(\"pcode\").PivotItems\n   For Each size In pt.RowFields(\"psize\").PivotItems\n\n       Range(\"D1\") = pt.GetPivotData(\"quantity\", \"Customer Name\", customer, \"Product Name\", product, \"Product size\", size)\n\n\n\n   Next\n Next\nNext\n\n\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 2965711, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a66ddff0ca033da9adf3f2425493767b?s=128&d=identicon&r=PG&f=1", "display_name": "user2965711", "link": "https://stackoverflow.com/users/2965711/user2965711"}, "edited": false, "score": 0, "creation_date": 1460552734, "post_id": 36599005, "comment_id": 60795592, "body": "it check only one time, where as I have to check in a loop , , m question is how i can swithc or , save the &quot;folderpath&quot; excel sheet and  find in a single"}, {"owner": {"reputation": 1042, "user_id": 6099813, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6ad1a82990f2fe3f70fa19274a71af79?s=128&d=identicon&r=PG&f=1", "display_name": "Danhol86", "link": "https://stackoverflow.com/users/6099813/danhol86"}, "reply_to_user": {"reputation": 77, "user_id": 2965711, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a66ddff0ca033da9adf3f2425493767b?s=128&d=identicon&r=PG&f=1", "display_name": "user2965711", "link": "https://stackoverflow.com/users/2965711/user2965711"}, "edited": false, "score": 0, "creation_date": 1460554548, "post_id": 36599005, "comment_id": 60797211, "body": "I would declare two objects.  One for this workbook, and one for the workbook you want to compare to:  Set wbkA = Workbooks.Open(Filename:=&quot;myPath&quot;) Set wbkB = ThisWorkbook  Then to compare just use following: if wbkA.Sheets(&quot;SheetName&quot;).Cell(1,1) = wbkB.Sheets(&quot;SheetName&quot;).cells(1,1) then msgbox(&quot;Yes&quot;)"}, {"owner": {"reputation": 77, "user_id": 2965711, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a66ddff0ca033da9adf3f2425493767b?s=128&d=identicon&r=PG&f=1", "display_name": "user2965711", "link": "https://stackoverflow.com/users/2965711/user2965711"}, "edited": false, "score": 0, "creation_date": 1460556478, "post_id": 36599005, "comment_id": 60798876, "body": "Set wbkA = Workbooks.Open(Filename:=&quot;myPath&quot;) ... I am getting error."}, {"owner": {"reputation": 1042, "user_id": 6099813, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6ad1a82990f2fe3f70fa19274a71af79?s=128&d=identicon&r=PG&f=1", "display_name": "Danhol86", "link": "https://stackoverflow.com/users/6099813/danhol86"}, "reply_to_user": {"reputation": 77, "user_id": 2965711, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a66ddff0ca033da9adf3f2425493767b?s=128&d=identicon&r=PG&f=1", "display_name": "user2965711", "link": "https://stackoverflow.com/users/2965711/user2965711"}, "edited": false, "score": 0, "creation_date": 1460557902, "post_id": 36599005, "comment_id": 60800127, "body": "try - Set wbkA = Workbooks.Open(Filename) as im assuming the location myPath doesnt exist. You should also declare Filename as a string"}, {"owner": {"reputation": 1042, "user_id": 6099813, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6ad1a82990f2fe3f70fa19274a71af79?s=128&d=identicon&r=PG&f=1", "display_name": "Danhol86", "link": "https://stackoverflow.com/users/6099813/danhol86"}, "reply_to_user": {"reputation": 77, "user_id": 2965711, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a66ddff0ca033da9adf3f2425493767b?s=128&d=identicon&r=PG&f=1", "display_name": "user2965711", "link": "https://stackoverflow.com/users/2965711/user2965711"}, "edited": false, "score": 1, "creation_date": 1460557978, "post_id": 36599005, "comment_id": 60800200, "body": "Sorry. just realised you have declared myPath. you should then remove the quotes as this will use literal string. change to -  \t Set wbkA = Workbooks.Open(Filename:=myPath)"}, {"owner": {"reputation": 1042, "user_id": 6099813, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6ad1a82990f2fe3f70fa19274a71af79?s=128&d=identicon&r=PG&f=1", "display_name": "Danhol86", "link": "https://stackoverflow.com/users/6099813/danhol86"}, "reply_to_user": {"reputation": 77, "user_id": 2965711, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a66ddff0ca033da9adf3f2425493767b?s=128&d=identicon&r=PG&f=1", "display_name": "user2965711", "link": "https://stackoverflow.com/users/2965711/user2965711"}, "edited": false, "score": 0, "creation_date": 1460558051, "post_id": 36599005, "comment_id": 60800255, "body": "but as myPath is the activeworkbook then you dont need to open it..... Set wbkA = ActiveWorkbook should suffice"}], "tags": [], "owner": {"reputation": 1042, "user_id": 6099813, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6ad1a82990f2fe3f70fa19274a71af79?s=128&d=identicon&r=PG&f=1", "display_name": "Danhol86", "link": "https://stackoverflow.com/users/6099813/danhol86"}, "is_accepted": false, "score": 0, "last_activity_date": 1460551950, "creation_date": 1460551950, "answer_id": 36599005, "question_id": 36598831, "link": "https://stackoverflow.com/questions/36598831/compare-two-workbook-sheets-excel-vba/36599005#36599005", "title": "Compare two workbook sheets excel vba", "body": "<p>Have you tried using ThisWorkbook.Sheets(\"sheet name\").Range(\"A2:A4\") or ThisWorkbook.ActiveSheet.Range(\"A2:A4\"). This will ensure the reference is to the workbook where the code is located.</p>\n\n<p>More info on Application.ThisWorkbook\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff193227.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff193227.aspx</a>.</p>\n"}], "owner": {"reputation": 77, "user_id": 2965711, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a66ddff0ca033da9adf3f2425493767b?s=128&d=identicon&r=PG&f=1", "display_name": "user2965711", "link": "https://stackoverflow.com/users/2965711/user2965711"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460551950, "creation_date": 1460551512, "question_id": 36598831, "link": "https://stackoverflow.com/questions/36598831/compare-two-workbook-sheets-excel-vba", "title": "Compare two workbook sheets excel vba", "body": "<p>I am working on a excel newly jfor 1 weeks where i want to compare opened excel file current open file,</p>\n\n<p>I made all possible but whenever  I try to read the row, it only reading the value from the opened , I cant' able to access to read current workbook where i my macro was coded</p>\n\n<pre><code>Sub test1()\nDim iComp\nDim sheet As String\nDim wbTarget As Worksheet\nDim wbThis As Worksheet\nDim bsmWS As Worksheet\nDim c As Integer\nDim x As Integer\nDim strValue As String\nStatic value As Integer\n\nDim myPath As String\nDim folderPath As String\nk = 3\n\n\nFilename = Application.GetOpenFilename(\"Excel files (*.xls*),*.xl*\", Title:=\"Open data\") ' Choosing the Trigger Discription\n'Set wbTarget = ActiveWorkbook.ActiveSheet\nSet theRange = Range(\"A2:A4\")\nc = theRange.Rows.Count\nstrValue = vbNullString\nFor x = 1 To c\nstrValue = strValue &amp; theRange.Cells(x, 1).value\nNext x\n\n\n'Set tabWS = Sheets(\"Tabelle1\")\n\n\n\nfolderPath = Application.ActiveWorkbook.Path\nmyPath = Application.ActiveWorkbook.FullName\nSet bsmWS = Sheets(\"Tabelle1\")\n\nSet wbkA = Workbooks.Open(Filename:=\"myPath\")\nSet varSheetA = wbkA.Worksheets(\"Balance sheet\").Range(strRangeToCheck)\n</code></pre>\n\n<p>Its a 1000 line code , I just put only snippet.</p>\n\n<p>I have myworksheet in the workbook where I am programed . I want to open another worksheet, take the value and compare it with my current worksheet . If string matches (ex range (A1:A2)) then msgbox yes</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1460551725, "post_id": 36598495, "comment_id": 60794665, "body": "It is pretty easy actually but before I post an answer, can you show your screenshot of the tables so that I can check the code before postin git"}, {"owner": {"reputation": 121, "user_id": 6072734, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/70xmU.jpg?s=128&g=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/6072734/salman-khan"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1460551910, "post_id": 36598495, "comment_id": 60794818, "body": "i have posted the image of tables..."}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1460552869, "creation_date": 1460552869, "answer_id": 36599399, "question_id": 36598495, "link": "https://stackoverflow.com/questions/36598495/code-to-populate-combobox-with-the-change-in-value-of-textbox/36599399#36599399", "title": "Code to Populate Combobox with the change in Value of Textbox", "body": "<p><strong>My Sample Data</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/1ZLpL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1ZLpL.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Logic For code</strong></p>\n\n<ol>\n<li>Add the table 1 items to combobox1</li>\n<li>In the click event of 1st combobox, populate the textbox and the 2nd combobox</li>\n</ol>\n\n<p><strong>In Action</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/GUMjs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GUMjs.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Dim tblGH As ListObject\nDim tblCH As ListObject\n\n'~~&gt; Populate combobox1 in userform init event\nPrivate Sub UserForm_Initialize()\n    Dim ws As Worksheet\n\n    Set ws = Sheets(\"Summary of Accounts\")\n\n    Set tblGH = ws.ListObjects(\"grouphead\")\n    Set tblCH = ws.ListObjects(\"controlhead\")\n\n    For i = 1 To tblGH.DataBodyRange.Rows.Count\n        ComboBox1.AddItem tblGH.DataBodyRange.Cells(i, 1)\n    Next\nEnd Sub\n\n'~~&gt; The click event\nPrivate Sub ComboBox1_Click()\n    Dim r As Long\n\n    r = ComboBox1.ListIndex\n\n    If r = -1 Then Exit Sub\n\n    '~~&gt; Add to txtbox\n    TextBox1.Text = tblGH.DataBodyRange.Cells(r + 1, 2)\n\n    '~~&gt; Add to 2nd Combo\n    PopulateCombo\nEnd Sub\n\nSub PopulateCombo()\n    ComboBox2.Clear\n\n    For i = 1 To tblCH.DataBodyRange.Rows.Count\n        If tblCH.DataBodyRange.Cells(i, 1) = TextBox1.Text Then _\n        ComboBox2.AddItem tblCH.DataBodyRange.Cells(i, 2)\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 6072734, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/70xmU.jpg?s=128&g=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/6072734/salman-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 762, "favorite_count": 0, "accepted_answer_id": 36599399, "answer_count": 1, "score": 1, "last_activity_date": 1460552869, "creation_date": 1460550746, "last_edit_date": 1531161705, "question_id": 36598495, "link": "https://stackoverflow.com/questions/36598495/code-to-populate-combobox-with-the-change-in-value-of-textbox", "title": "Code to Populate Combobox with the change in Value of Textbox", "body": "<p><a href=\"https://i.stack.imgur.com/WlYu6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WlYu6.png\" alt=\"enter image description here\"></a>I have one worksheet in which 2 tables are there.</p>\n\n<p>One table is grouphead and the other table is controlhead.</p>\n\n<p>In grouphead table, there are several unique records along with their ID. Like Non-current assets has a id NCA, Current Assets has a ID CA and so on.\nIn controlhead table, there are several unique records along with grouphead id. Like Salman and Amir has id NCA and Abdur Rehman and Rahim has id CA.</p>\n\n<p>When i open the userform, the grouphead combobox populates with grouphead and the groupcode id textbox shows the id of item selected in combobox.</p>\n\n<p>There is another combobox named as controlhead.\nWhat i want is, the controlhead combobox will populate only those values which have id present in grouphead textbox.</p>\n\n<p>so far my code is as below:</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    Dim start As String\n    Dim start2 As String\n    Dim sfind As String\n    Dim sfind2 As String\n    Dim ws As Worksheet\n    Dim tbl As ListObject\n    Dim tbl2 As ListObject\n\n    Set ws = Sheets(\"Summary of Accounts\")\n    Set tbl = ws.ListObjects(\"grouphead\")\n    Set tbl2 = ws.ListObjects(\"controlhead\")\n\n    With Me\n        If .ComboBox1.Value &lt;&gt; vbNullString Then\n            sfind = .ComboBox1.Value\n            start = Application.WorksheetFunction.VLookup(sfind, tbl.DataBodyRange, 2, False)\n                .TextBox1 = start\n        End If\n    End With\n\n    With Me\n        If .TextBox1.Value &lt;&gt; vbNullString Then\n            sfind2 = .TextBox1.Value\n            start2 = Application.WorksheetFunction.VLookup(sfind2, tbl2.DataBodyRange, 2, False)\n            .ComboBox2 = start2\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>I am unable to populate the controlhead combobox.</p>\n\n<p>Kindly review and help me.</p>\n"}, {"tags": ["vba", "ms-access", "combobox"], "comments": [{"owner": {"reputation": 717, "user_id": 4081390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0dcde8a9ae20efba80f5fd74458808?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4081390/nick"}, "edited": false, "score": 0, "creation_date": 1460552783, "post_id": 36598389, "comment_id": 60795637, "body": "So is what you want to do is have the updates from the combobox selections append to a textbox? After you change a combobox you are seeing the other combo boxes change, even though you don&#39;t expect them too? Just to verify: are each of your combo boxes populated from a different table in the database?"}, {"owner": {"reputation": 1, "user_id": 5913098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4954865c7b8c9e9f0845c64a59cd8fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Baker", "link": "https://stackoverflow.com/users/5913098/justin-baker"}, "reply_to_user": {"reputation": 717, "user_id": 4081390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0dcde8a9ae20efba80f5fd74458808?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4081390/nick"}, "edited": false, "score": 0, "creation_date": 1460553234, "post_id": 36598389, "comment_id": 60796044, "body": "Hi @Nick Thanks for your response. Yeah, currently the combo boxes are changing on every selection, so I put the textboxes to capture the row data so when you change a bottle it doesn&#39;t effect the label row and when you select a cap it doesn&#39;t effect the bottle row. I tried to build this as a work around as the combo boxes are changing when I don&#39;t want them too. All data comes initially comes from one table and the combo boxes are all from another table. They are defined by criteria to determine whether a bottle is a bottle etc."}, {"owner": {"reputation": 717, "user_id": 4081390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0dcde8a9ae20efba80f5fd74458808?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4081390/nick"}, "edited": false, "score": 0, "creation_date": 1460553379, "post_id": 36598389, "comment_id": 60796163, "body": "Are all of your four fields in the same table? For example do you have tblProductProperties with four fields in it called Label, Cap, Bottle, and Oil?"}, {"owner": {"reputation": 1, "user_id": 5913098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4954865c7b8c9e9f0845c64a59cd8fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Baker", "link": "https://stackoverflow.com/users/5913098/justin-baker"}, "reply_to_user": {"reputation": 717, "user_id": 4081390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0dcde8a9ae20efba80f5fd74458808?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4081390/nick"}, "edited": false, "score": 0, "creation_date": 1460553727, "post_id": 36598389, "comment_id": 60796476, "body": "Yeah, they are all in the same table and defined by a unique field, i have made the row source on the combo boxes a query in which I match against the base data (i.e. I have the base data table, in there is a field (bottle, Cap, Label, Oil) and match this in the row source of the combo box to the list data that I am selecting from which has a field (bottle, Cap, Label, Oil) So there might be 10 bottles/caps/labels/oils and you can use the combo box to select them. (To stop users replacing a cap with a bottle)"}, {"owner": {"reputation": 717, "user_id": 4081390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0dcde8a9ae20efba80f5fd74458808?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4081390/nick"}, "edited": false, "score": 0, "creation_date": 1460553814, "post_id": 36598389, "comment_id": 60796551, "body": "okay, so the short answer is that you need to break those out into different tables. I&#39;ll write a more detailed answer."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5913098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4954865c7b8c9e9f0845c64a59cd8fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Baker", "link": "https://stackoverflow.com/users/5913098/justin-baker"}, "edited": false, "score": 0, "creation_date": 1460553004, "post_id": 36599014, "comment_id": 60795835, "body": "Hi @Gustav, thanks for the quick response. How exactly would you do this? Do you mean binding the combo box or binding the text box to the combo box? Still relatively new to this"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 5913098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4954865c7b8c9e9f0845c64a59cd8fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Baker", "link": "https://stackoverflow.com/users/5913098/justin-baker"}, "edited": false, "score": 0, "creation_date": 1460554070, "post_id": 36599014, "comment_id": 60796774, "body": "Set its ControlSource to a (new) field of the table."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1460551967, "creation_date": 1460551967, "answer_id": 36599014, "question_id": 36598389, "link": "https://stackoverflow.com/questions/36598389/access-vba-code-for-copying-information-from-a-combobox-and-pasting-into-a-textb/36599014#36599014", "title": "Access VBA code for copying information from a combobox and pasting into a textbox on a continuous form", "body": "<p>You have to bind the textbox to a field in the record.</p>\n\n<p>As long as the textbox is unbound, it doesn't know about a record and will display the same for all records.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5913098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4954865c7b8c9e9f0845c64a59cd8fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Baker", "link": "https://stackoverflow.com/users/5913098/justin-baker"}, "edited": false, "score": 0, "creation_date": 1460556195, "post_id": 36599978, "comment_id": 60798640, "body": "Thanks nick, will try that"}], "tags": [], "owner": {"reputation": 717, "user_id": 4081390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0dcde8a9ae20efba80f5fd74458808?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/4081390/nick"}, "is_accepted": false, "score": 0, "last_activity_date": 1460554204, "creation_date": 1460554204, "answer_id": 36599978, "question_id": 36598389, "link": "https://stackoverflow.com/questions/36598389/access-vba-code-for-copying-information-from-a-combobox-and-pasting-into-a-textb/36599978#36599978", "title": "Access VBA code for copying information from a combobox and pasting into a textbox on a continuous form", "body": "<p>I'm making the assumption that you want to be able to map some product to 4 different types of caps, bottles, labels, and oil:</p>\n\n<p>It seems that your problem is in your data table design, not in your comboboxes. You shouldn't need the text field at all. The problem is that your comboboxes are all based on the same table. When you select Bottle2 from one of them, it matches the rest of the comboboxes to that row. So all the others will get Label2, Cap2, etc. because they are in the same row of the table.</p>\n\n<p>Make a products table call it tblProducts. The fields ID (autonumber), product_name, label_FK, cap_FK, Bottle_FK, and oil_FK should be in it. Those FK stand for Foreign key and should be a number type. The product name can be text.</p>\n\n<p>Create the tblLabel, tblCap, etc. with an ID, and a description.</p>\n\n<p>In your relationships you need to map the tblLable.ID to the tblProducts.Label_FK field. Do this for all 4 type. Then you can re-create the form based on the products table. Whatever the form gives you for the way to control the label_FK, cap_FK, etc. fields you can convert it to a combobox by right click -> change to...</p>\n\n<p>Finally, you may need to update the number of columns of the comboboxes in order to see the description also.</p>\n\n<p>EDIT: More lasting information -\nDoing some solid research on data table design will pay huge dividends in design time. Starting with the <a href=\"https://support.office.com/en-us/article/Database-design-basics-EB2159CF-1E30-401A-8084-BD4F9C9CA1F5\" rel=\"nofollow\">Database Design Basics</a> page from Microsoft will help as a decent 30 minute intro and should help clear some things up for you.</p>\n"}], "owner": {"reputation": 1, "user_id": 5913098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4954865c7b8c9e9f0845c64a59cd8fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Baker", "link": "https://stackoverflow.com/users/5913098/justin-baker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 318, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1460554204, "creation_date": 1460550491, "question_id": 36598389, "link": "https://stackoverflow.com/questions/36598389/access-vba-code-for-copying-information-from-a-combobox-and-pasting-into-a-textb", "title": "Access VBA code for copying information from a combobox and pasting into a textbox on a continuous form", "body": "<p>Really need help with this, I have a continuous form with a combo box to choose data, each row has a different criteria and you can choose only certain items per row in the combo box drop down. (As an example I have four rows one is a cap, one is a bottle, one is a label and the last is oil to go in the bottle.)</p>\n\n<p>What I need is when I have chosen something in the combo box drop down I want it to paste into a text box and stay there until another choice on the same row is made...... Currently I can make the information appear in the textbox but then when I move to another row and choose anothe item it over writes anything I have already chosen.</p>\n\n<p>So an example would be I have chosen product 1, it has cap 1, bottle 1, label 1 and oil 1. In the drop down combo box I can choose only bottles to replace bottles caps to replace caps and so on. I want to choose bottle 2 in the combo box on the bottle line (Which changes all the combo boxes) I now want to save that choice in the text box on the bottle row only, then when I choose Label 2 on the label row even though it changes all the combo boxes I don't want it to overwrite the text box for the bottle row. (I'm assuming a criteria that will only change the row of the combo box you are clicking on or something like that)</p>\n\n<p>hope this makes sense to every body (P.S. I don't know how to get a screen shot in here so have tried to explain to the best of my ability)</p>\n\n<p>Many thanks</p>\n\n<p>Justin</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1460550409, "post_id": 36598169, "comment_id": 60793498, "body": "Your test is only checking if the values are the same, not whether they are the same cells. You could test the <code>.Address</code> property or use: <code>If cell_target Is cell2 Then</code>"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1460550856, "post_id": 36598169, "comment_id": 60793907, "body": "@Rory is right. Just exercise caution when comparing the <code>.Address</code> properties (esp. if the cells are on different sheets or workbooks) because <code>Sheet1.Range(&quot;A1&quot;).Address = Sheet2.Range(&quot;A1&quot;).Address</code> would return <code>True</code>."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1460551280, "post_id": 36598169, "comment_id": 60794291, "body": "Good point made by @Ambie - if you use the address make sure to use <code>.Address(External:=True)</code>"}, {"owner": {"reputation": 104, "user_id": 2132992, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/70286dcb42281043dd345a7b064bcf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tango_Mike", "link": "https://stackoverflow.com/users/2132992/tango-mike"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1460552063, "post_id": 36598169, "comment_id": 60794954, "body": "@Rory and @Ambie, thank you very much for your insightful comments! <code>Is</code> operator is exactly what I needed, @Rory! Should you wish to re-post your first comment as an answer, I will tick it as such."}], "answers": [{"tags": [], "owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "is_accepted": false, "score": 0, "last_activity_date": 1460550850, "creation_date": 1460550850, "answer_id": 36598538, "question_id": 36598169, "link": "https://stackoverflow.com/questions/36598169/calling-a-variable-assigned-to-an-object/36598538#36598538", "title": "Calling a variable assigned to an object", "body": "<p>As commented already, your test compares the cell contents. </p>\n\n<p>I would suggest to check </p>\n\n<p><code>Interect(cell_target,cell2).Cells.Count&gt;0</code> </p>\n"}, {"comments": [{"owner": {"reputation": 104, "user_id": 2132992, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/70286dcb42281043dd345a7b064bcf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tango_Mike", "link": "https://stackoverflow.com/users/2132992/tango-mike"}, "edited": false, "score": 0, "creation_date": 1460552818, "post_id": 36599170, "comment_id": 60795666, "body": "Thank you, @Rory, for that additional comment on the <code>Is</code> operator."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 3, "last_activity_date": 1460552340, "creation_date": 1460552340, "answer_id": 36599170, "question_id": 36598169, "link": "https://stackoverflow.com/questions/36598169/calling-a-variable-assigned-to-an-object/36599170#36599170", "title": "Calling a variable assigned to an object", "body": "<p>Per the earlier comments, your test is only checking if the <strong>values</strong> are the same, not whether they are the same cells.</p>\n\n<p>You could test the <code>.Address(External:=True)</code> property or use:</p>\n\n<pre><code>If cell_target Is cell2 Then\n</code></pre>\n\n<p>Small note about the <code>Is</code> operator with ranges: it will work here because you assigned one range variable to the other directly. However if you had assigned say Range(\"A1\") to two variables, the <code>Is</code> operator would return <code>False</code> when you compared them, because the Range property returns a new reference each time.</p>\n"}], "owner": {"reputation": 104, "user_id": 2132992, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/70286dcb42281043dd345a7b064bcf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tango_Mike", "link": "https://stackoverflow.com/users/2132992/tango-mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 36599170, "answer_count": 2, "score": 1, "last_activity_date": 1460552340, "creation_date": 1460549998, "last_edit_date": 1531164843, "question_id": 36598169, "link": "https://stackoverflow.com/questions/36598169/calling-a-variable-assigned-to-an-object", "title": "Calling a variable assigned to an object", "body": "<p>This is a small portion of my code:</p>\n\n<pre><code>If cell1.Offset(0, 8) = \"Alpha\" Then\n   Set cell_target = cell2\nElseIf cell1.Offset(0, 8) = \"Bravo\" Then\n   Set cell_target = cell3\nElse\n   MsgBox \"ERROR\"\n   End\nEnd if\n</code></pre>\n\n<p>where cell1 is just a cell inside a for...next loop within <code>myRange</code> on Sheet1 and cell2 and cell3 are just single cells (range \"A2\") located on Sheet2 and Sheet3.</p>\n\n<p>At the end of my code, I want to shift either cell2 or cell3 (depending on what <code>cell_target</code> is in the code above) down by one row, which I do in the following line of code:</p>\n\n<pre><code>If cell_target = cell2 Then\n   Set cell2 = cell2.Offset(1)\nElseIf cell_target = cell3 Then\n   Set cell3 = cell3.Offset(1)\nElse\n   MsgBox \"ERROR\"\n   End\nEnd if\n</code></pre>\n\n<p>The problem is that all of the cells are treated as cell2 even if they are not. I have worked around this problem by writing:</p>\n\n<pre><code>If cell1.Offset(0, 8) = \"Alpha\" Then\n   Set cell2 = cell2.Offset(1)\nElseIf cell1.Offset(0, 8) = \"Bravo\" Then\n   Set cell3 = cell3.Offset(1)\nElse\n   MsgBox \"ERROR\"\n   End\nEnd if\n</code></pre>\n\n<p>I am just curious why the first method did not work. My personal guess is that by typing <code>cell_target = cell2</code>, the code was not checking the reference name (cell2 or cell3) (which is what I need) but whether <code>cell2</code> is an object or not; and since it was, all the cells ended up being treated as cell2. \nI would greatly appreciate if you could either confirm my understanding or refute it and clarify this issue for me. Should my description be too vague, I could provide my code in full either here or via an Excel file.</p>\n"}, {"tags": ["excel", "udf", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1460549881, "post_id": 36597856, "comment_id": 60792990, "body": "You can&#39;t. That functionality is not exposed."}, {"owner": {"reputation": 2266, "user_id": 5698517, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/915a651f37965c17b3a65cd9505bc6a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Tor", "link": "https://stackoverflow.com/users/5698517/ali-tor"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1460550263, "post_id": 36597856, "comment_id": 60793347, "body": "Really! I don&#39;t expect that there is no way to do that. How is it possible to call Excel the &quot;Excellent&quot; now!"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1460552767, "post_id": 36597856, "comment_id": 60795617, "body": "This might help: <a href=\"http://stackoverflow.com/questions/4262421/how-to-put-a-tooltip-on-a-user-defined-function\" title=\"how to put a tooltip on a user defined function\">stackoverflow.com/questions/4262421/&hellip;</a>"}], "owner": {"reputation": 2266, "user_id": 5698517, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/915a651f37965c17b3a65cd9505bc6a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Tor", "link": "https://stackoverflow.com/users/5698517/ali-tor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2527, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460550451, "creation_date": 1460549222, "last_edit_date": 1531164843, "question_id": 36597856, "link": "https://stackoverflow.com/questions/36597856/how-to-show-the-parameters-of-an-udf-when-typing-the-function-in-excel-vba", "title": "How to show the parameters of an UDF when typing the function in Excel-Vba?", "body": "<p>I have a custom <code>Excel</code> function but when typing it there is <em>no parameter</em> seems. How can I show the parameters of this function like default Excel functions like below?</p>\n\n<p><a href=\"https://i.stack.imgur.com/ctA2C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ctA2C.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>My Excel function:</strong></p>\n\n<pre><code>Public Function DiscreteEmp(ByVal rng As Range)\n\nc = rng.Rows.Count\nDim bounds() As Double\nReDim bounds(1 To c + 1) As Double\nDim vals() As Double\nReDim vals(1 To c + 1) As Double\nbounds(1) = 0\n\nFor i = 1 To c\nbounds(i + 1) = bounds(i) + rng.Cells(i, 1).Value\nvals(i) = rng.Cells(i, 2).Value\nNext i\n\nnum = Rnd\nIf num = 0 Then\nDiscreteEmp = vals(1)\nEnd If\nFor i = 1 To c\nIf num &gt; bounds(i) And num &lt;= bounds(i + 1) Then\nDiscreteEmp = vals(i)\nExit For\nEnd If\nNext i\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "pdf", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 2637680, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a523082bf4b69dbf424f0ad4dc1b220?s=128&d=identicon&r=PG", "display_name": "sticks", "link": "https://stackoverflow.com/users/2637680/sticks"}, "is_accepted": true, "score": 0, "last_activity_date": 1460618245, "creation_date": 1460618245, "answer_id": 36616218, "question_id": 36597511, "link": "https://stackoverflow.com/questions/36597511/excel-vba-export-multiple-sheets-to-pdf/36616218#36616218", "title": "Excel VBA Export Multiple sheets to PDF", "body": "<p>I managed to solve my problem by copying the selected ranges to a temporary file then exporting from there. The complete solution looks like this...</p>\n\n<pre><code>Dim wb As Workbook\nDim srcSht As Worksheet\nDim tempFile As String\n\nSet wb = ThisWorkbook\nSet srcSht = wb.Sheets(\"print_array\")\n\nDim myArr1() As Variant\n    myArr1 = srcSht.Range(\"myPrintArray\")\n\nDim i As Long\nDim j As String\n    For i = LBound(myArr1, 1) To UBound(myArr1, 1)\n            j = myArr1(i, 1)\n\n    wb.Sheets(j).Activate\n\n    With ActiveSheet.PageSetup\n        .Orientation = xlLandscape\n        .PaperSize = xlPaperA4\n        .Zoom = False\n        .FitToPagesWide = 1\n        .FitToPagesTall = 1\n        .PrintArea = Range(\"CCB_\" &amp; Left(j, 5) &amp; \"_Print\").Address\n    End With\n\n        Next i\n\n    wb.Sheets(Array(\"CAT01 - Request for Resource\", _\n                                \"CAT02 - Resource Allocation\", _\n                                \"CAT03 - Product Data Sources\", _\n                                \"CAT04 - Target &amp; Control Cells\", _\n                                \"CAT05 - Matching And Deduping\", _\n                                \"CAT06 - Exclusions\", _\n                                \"CAT07 - Data from other teams\", _\n                                \"CAT08 - Outputs\", _\n                                \"CAT09 - Special Instructions\", _\n                                \"CAT10 - Brief Meeting Sign Off\" _\n                                )).copy\n\n                With ActiveWorkbook\n                    .Save\n\n                    tempFile = .FullName\n\n                    .ExportAsFixedFormat Type:=xlTypePDF, Filename:=PDF_FileAndPath, _\n                        Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n                        :=False, OpenAfterPublish:=True\n\n                    .Close\n\n                End With\n\n                Kill tempFile\n\n   End If\n</code></pre>\n\n<p>I hope this helps someone in the future.</p>\n\n<p>Thanks.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9323902, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/72c9b792dcdd2e0ac8074a79ccdf66bf?s=128&d=identicon&r=PG", "display_name": "Hilary B", "link": "https://stackoverflow.com/users/9323902/hilary-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1517944534, "creation_date": 1517944534, "answer_id": 48650347, "question_id": 36597511, "link": "https://stackoverflow.com/questions/36597511/excel-vba-export-multiple-sheets-to-pdf/48650347#48650347", "title": "Excel VBA Export Multiple sheets to PDF", "body": "<p>I was having the same issue.  I came across another, easier solution.  No need for temp files.</p>\n\n<p>After you .select your array, instead of <strong>Selection</strong>.ExportAsFixedFormat, use <strong>ActiveSheet</strong>.ExportAsFixedFormat.  Because your sheets are made active with your initial .select, ActiveSheet then selects all desired sheets to export.</p>\n\n<p>Your code should look like this:</p>\n\n<pre><code>Dim wb As Workbook\nDim srcSht As Worksheet\nDim toPrnt As String\n\nSet wb = ThisWorkbook\nSet srcSht = wb.Sheets(\"print_array\")\n\nDim myArr1() As Variant\n    myArr1 = srcSht.Range(\"myPrintArray\")\n\nDim i As Long\nDim j As String\n    For i = LBound(myArr1, 1) To UBound(myArr1, 1)\n            j = myArr1(i, 1)\n\n    wb.Sheets(j).Activate\n        wb.ActiveSheet.Range(\"CCB_\" &amp; Left(j, 5) &amp; \"_Print\").Select\n\n    Next i\n\nwb.Sheets(Array(\"CAT01 - Request for Resource\", _\n                            \"CAT02 - Resource Allocation\", _\n                            \"CAT03 - Product Data Sources\", _\n                            \"CAT04 - Target &amp; Control Cells\", _\n                            \"CAT05 - Matching And Deduping\", _\n                            \"CAT06 - Exclusions\", _\n                            \"CAT07 - Data from other teams\", _\n                            \"CAT08 - Outputs\", _\n                            \"CAT09 - Special Instructions\", _\n                            \"CAT10 - Brief Meeting Sign Off\" _\n                            )).Select\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=PDF_FileAndPath, _\nQuality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n    :=False, OpenAfterPublish:=True\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 2637680, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a523082bf4b69dbf424f0ad4dc1b220?s=128&d=identicon&r=PG", "display_name": "sticks", "link": "https://stackoverflow.com/users/2637680/sticks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3281, "favorite_count": 0, "accepted_answer_id": 36616218, "answer_count": 2, "score": 1, "last_activity_date": 1517944534, "creation_date": 1460548295, "question_id": 36597511, "link": "https://stackoverflow.com/questions/36597511/excel-vba-export-multiple-sheets-to-pdf", "title": "Excel VBA Export Multiple sheets to PDF", "body": "<p>I have been trying to export a named range on multiple worksheets to a single pdf. Initially, it seemed to work fine, then I noticed the the selected range would change when loading the various sheets into an array.</p>\n\n<p>It is my understanding by using <code>Selection.ExportAsFixedFormat</code> this would export the selected cells only. Therefore, I have a macro to loop through the required sheets, select the various ranges need then create an array for all the sheets to allow exporting to a single pdf.</p>\n\n<pre><code>Dim wb As Workbook\nDim srcSht As Worksheet\nDim toPrnt As String\n\nSet wb = ThisWorkbook\nSet srcSht = wb.Sheets(\"print_array\")\n\nDim myArr1() As Variant\n    myArr1 = srcSht.Range(\"myPrintArray\")\n\nDim i As Long\nDim j As String\n    For i = LBound(myArr1, 1) To UBound(myArr1, 1)\n            j = myArr1(i, 1)\n\n    wb.Sheets(j).Activate\n        wb.ActiveSheet.Range(\"CCB_\" &amp; Left(j, 5) &amp; \"_Print\").Select\n\n    Next i\n\nwb.Sheets(Array(\"CAT01 - Request for Resource\", _\n                            \"CAT02 - Resource Allocation\", _\n                            \"CAT03 - Product Data Sources\", _\n                            \"CAT04 - Target &amp; Control Cells\", _\n                            \"CAT05 - Matching And Deduping\", _\n                            \"CAT06 - Exclusions\", _\n                            \"CAT07 - Data from other teams\", _\n                            \"CAT08 - Outputs\", _\n                            \"CAT09 - Special Instructions\", _\n                            \"CAT10 - Brief Meeting Sign Off\" _\n                            )).Select\n\nSelection.ExportAsFixedFormat Type:=xlTypePDF, Filename:=PDF_FileAndPath, _\nQuality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n    :=False, OpenAfterPublish:=True\n</code></pre>\n\n<p>When stepping through the code, everything goes to plan right up to creating the sheets array, at this point the selected ranges change.</p>\n\n<p>I have also tried using PageSetup, but the result is the same.</p>\n\n<pre><code>With ActiveSheet.PageSetup\n    .Orientation = xlLandscape\n    .PaperSize = xlPaperA4\n    .Zoom = False\n    .FitToPagesWide = 1\n    .FitToPagesTall = 1\n    .PrintArea = Range(\"CCB_\" &amp; Left(j, 5) &amp; \"_Print\").Address\nEnd With\n</code></pre>\n\n<p>After reviewing a few similar post in this forum, I am still at a loss.</p>\n\n<p>Can anyone shed light on why the selected range changes when creating the array or, have any other suggestions that may help?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1460548978, "post_id": 36597220, "comment_id": 60792255, "body": "You want dynamic textbox to appear at side by side?"}, {"owner": {"reputation": 202, "user_id": 4806710, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh3.googleusercontent.com/-QMjjUxEWjZ8/AAAAAAAAAAI/AAAAAAAABj0/0Eo9b8rdeG8/photo.jpg?sz=128", "display_name": "nandesh kalyankar", "link": "https://stackoverflow.com/users/4806710/nandesh-kalyankar"}, "reply_to_user": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1460549255, "post_id": 36597220, "comment_id": 60792468, "body": "@Karthick  yes, Here the columns are fixed &amp; rows can change. In addition, I want the first column  to display data from excel."}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1460549437, "post_id": 36597220, "comment_id": 60792617, "body": "use textbox position to appear where ever you want"}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1460550075, "last_edit_date": 1460550075, "creation_date": 1460549762, "answer_id": 36598064, "question_id": 36597220, "link": "https://stackoverflow.com/questions/36597220/read-a-column-from-a-excel-sheet-display-on-textbox-vba/36598064#36598064", "title": "read a column from a excel sheet &amp; display on textbox vba", "body": "<p>I don't see you create a textbox named <code>\"chkDemo\"</code>. They all have a number appended. As you take <code>tbox</code> from all controls, there might be a control on your sheet somewhere named <code>\"chkDemo\"</code> but which is not a textbox. Neither do I see <code>counter</code> declared or initialized. That might also let the code fail.</p>\n\n<p>Note also that with <code>.Name = \"chkDemo\" &amp; i</code> you give the same name to textboxes because you are also in a <code>For jrow</code> loop.</p>\n"}], "owner": {"reputation": 202, "user_id": 4806710, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh3.googleusercontent.com/-QMjjUxEWjZ8/AAAAAAAAAAI/AAAAAAAABj0/0Eo9b8rdeG8/photo.jpg?sz=128", "display_name": "nandesh kalyankar", "link": "https://stackoverflow.com/users/4806710/nandesh-kalyankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 678, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460550075, "creation_date": 1460547528, "question_id": 36597220, "link": "https://stackoverflow.com/questions/36597220/read-a-column-from-a-excel-sheet-display-on-textbox-vba", "title": "read a column from a excel sheet &amp; display on textbox vba", "body": "<p>Read all the rows for one column &amp; display on textbox(s) which are created at run time.I am turning over to seek you assistance for below after several attempts which didn't help.</p>\n\n<p><code>Name</code></p>\n\n<p><code>ABC</code></p>\n\n<p><code>AB</code></p>\n\n<p><code>ABCEF</code></p>\n\n<p><code>GHFD</code></p>\n\n<p>I want all the rows from excel sheet to be shown in textbox just as they appear in sheet for a particular column.I am creating 4 textbox(s) that represent columns &amp; 11 textbox(s) that represent rows. For the first column, I want the data to be displayed as it is in sheet. I am successful in creating text box as per my requirement but not able to display data as per needs. Thanks a ton for help</p>\n\n<p><code>Public Sub UserForm_Initialize()</code></p>\n\n<pre><code>Set sh = ThisWorkbook.Sheets(\"Testing\")\n\nsh.Range(\"F21\").Activate\n\nWith sh\n    fatalcount = WorksheetFunction.CountIf(Range(\"F:F\"), \"Fatal\")\n    Majorcount = WorksheetFunction.CountIf(Range(\"F:F\"), \"Major\")\n    Minorcount = WorksheetFunction.CountIf(Range(\"F:F\"), \"Minor\")\nEnd With\n\nFor jrow = 1 To 11\nFor i = 0 To 4\n    Set txtB1 = WtmsFrm.Controls.Add(\"Forms.TextBox.1\")\n    With txtB1\n    .Name = \"chkDemo\" &amp; i\n    .Height = 20\n    .Width = 5 + 50 + 5\n    .Left = 10 + 50 * i + 2\n    .Top = 15 * jrow + 10\n    .ControlTipText = \"Type of Bug\"\n    End With\n Next i\nNext jrow\n\nFor Each tbox In  Frm.Controls\n   ' For counter = 2 To 11\n\n    If tbox.Name = \"chkDemo\" Then\n\n        tbox.Value = Sheets(\"sheet1\").Cells(counter, 2).Value  ' failing code\n        tbox.ControlTipText = \"Name\"\n\n    ElseIf tbox.Name = \"chkDemo1\" Then\n        tbox.Value = 1\n\n    ElseIf tbox.Name = \"chkDemo2\" Then\n        tbox.Value = 2\n    ElseIf tbox.Name = \"chkDemo3\" Then\n        tbox.Value = 3\n     ElseIf tbox.Name = \"chkDemo4\" Then\n        tbox.Value = 4\n    End If\n   ' Next counter\n\nNext\n\n\n' Initialise the followings\n Frm.txtFatal.Value = fatalcount\n\n Frm.txtMajor.Value = Majorcount\n\n Frm.txtMinor.Value = Minorcount\n\n Frm.txtTotoal.Value = fatalcount + Majorcount + Minorcount\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "formula"], "answers": [{"tags": [], "owner": {"reputation": 1286, "user_id": 6122062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43dd41fb587ae514e874f9167fd74a4c?s=128&d=identicon&r=PG&f=1", "display_name": "bassfader", "link": "https://stackoverflow.com/users/6122062/bassfader"}, "is_accepted": false, "score": 0, "last_activity_date": 1460555904, "creation_date": 1460555904, "answer_id": 36600718, "question_id": 36597136, "link": "https://stackoverflow.com/questions/36597136/concatenate-string-in-formula-in-a-special-case/36600718#36600718", "title": "Concatenate string in formula in a special case", "body": "<p>Seems like some quotes are wrong here. The following code worked for me:</p>\n\n<pre><code>.Formula = \"=INDIRECT('testsheet'!G\" &amp; 4*i &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 665, "user_id": 3890577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49505033d552f580a098cada779297b1?s=128&d=identicon&r=PG&f=1", "display_name": "Twi", "link": "https://stackoverflow.com/users/3890577/twi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "closed_date": 1460835161, "answer_count": 1, "score": 0, "last_activity_date": 1460555904, "creation_date": 1460547303, "last_edit_date": 1460549475, "question_id": 36597136, "link": "https://stackoverflow.com/questions/36597136/concatenate-string-in-formula-in-a-special-case", "closed_reason": "Duplicate", "title": "Concatenate string in formula in a special case", "body": "<p>I'd like to concatenate in a formula, like this in my VBA code:</p>\n\n<pre><code>  .Formula = \"=INDIRECT(\" \"\"'testsheet'!G\"\" &amp; 4*i ) \" //i = 3 for example \n</code></pre>\n\n<p>Because I'd like to see that:</p>\n\n<pre><code>='test_sheet'!G12\n</code></pre>\n\n<p>But it's not working. Can someone help?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 1775, "user_id": 5066895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bHw56.png?s=128&g=1", "display_name": "Dieter Meemken", "link": "https://stackoverflow.com/users/5066895/dieter-meemken"}, "edited": false, "score": 0, "creation_date": 1460546782, "post_id": 36596839, "comment_id": 60790511, "body": "What did you try so far?"}, {"owner": {"reputation": 99, "user_id": 6198359, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55149bc99b0c7fe7cc6e0adf093ab808?s=128&d=identicon&r=PG&f=1", "display_name": "Pythonist", "link": "https://stackoverflow.com/users/6198359/pythonist"}, "reply_to_user": {"reputation": 1775, "user_id": 5066895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bHw56.png?s=128&g=1", "display_name": "Dieter Meemken", "link": "https://stackoverflow.com/users/5066895/dieter-meemken"}, "edited": false, "score": 0, "creation_date": 1460549760, "post_id": 36596839, "comment_id": 60792884, "body": "I tried to play with MATCH function but values are not in descending order."}], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 6198359, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55149bc99b0c7fe7cc6e0adf093ab808?s=128&d=identicon&r=PG&f=1", "display_name": "Pythonist", "link": "https://stackoverflow.com/users/6198359/pythonist"}, "is_accepted": true, "score": 0, "last_activity_date": 1460554860, "last_edit_date": 1460554860, "creation_date": 1460554500, "answer_id": 36600106, "question_id": 36596839, "link": "https://stackoverflow.com/questions/36596839/advanced-data-import-from-excel-sheet/36600106#36600106", "title": "Advanced data import from Excel sheet", "body": "<p>I found a solution:</p>\n\n<ol>\n<li><p>Checking maximum value in a row</p></li>\n<li><p>With function \"delete row based on cell value\" I'm deleting all rows where maximum value is smaller than desired </p></li>\n<li><p>I'm transferring next 720 rows to another sheet with simple addressing </p></li>\n</ol>\n\n<p>Not as perfect as I'd imagine but is working </p>\n"}], "owner": {"reputation": 99, "user_id": 6198359, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55149bc99b0c7fe7cc6e0adf093ab808?s=128&d=identicon&r=PG&f=1", "display_name": "Pythonist", "link": "https://stackoverflow.com/users/6198359/pythonist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 36600106, "answer_count": 1, "score": 0, "last_activity_date": 1460554860, "creation_date": 1460546558, "question_id": 36596839, "link": "https://stackoverflow.com/questions/36596839/advanced-data-import-from-excel-sheet", "title": "Advanced data import from Excel sheet", "body": "<p>currently I'm trying to import data from one excel sheet to another.\nI'm going through the cells in 13 columns and if value in one of them exceeds X I need to copy this and 719 following rows into another excel sheet. </p>\n\n<p>Does anyone have tips how to do so?\nI'm not really into that but I'm trying to simplify work of my service engineers...\nThanks so much for your answers.</p>\n"}, {"tags": ["excel", "vba", "macros"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "is_accepted": false, "score": 0, "last_activity_date": 1460545681, "creation_date": 1460545681, "answer_id": 36596498, "question_id": 36596298, "link": "https://stackoverflow.com/questions/36596298/how-do-i-using-a-macro-decrease-all-the-values-in-a-selected-range-by-1/36596498#36596498", "title": "How do I, using a macro, decrease all the values in a selected range by 1", "body": "<pre><code>Sub test()\n\n    Dim rngTarget As Range\n    Set rngTarget = Sheet1.Range(\"A1\")\n    Set rngTarget = Range(rngTarget, rngTarget.End(xlDown))\n\n    Dim rngIndex As Range\n\n    For Each rngIndex In rngTarget\n        With rngIndex\n            .Value = .Value - 1\n        End With\n    Next rngIndex\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 6198644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3855af64bfb099d294f8795dbda9b73d?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/6198644/alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1460555270, "last_edit_date": 1460555270, "creation_date": 1460550041, "answer_id": 36598187, "question_id": 36596298, "link": "https://stackoverflow.com/questions/36596298/how-do-i-using-a-macro-decrease-all-the-values-in-a-selected-range-by-1/36598187#36598187", "title": "How do I, using a macro, decrease all the values in a selected range by 1", "body": "<p>This uses the <code>Counta</code> function, assuming there aren't any blanks in the data. I also added <code>IsNumeric</code> in case the value is text. If you wanted to go a step further to make sure everything is neat, you can add this right before the <code>If</code> statement:</p>\n\n<pre><code>Sub Minus_One()\n\nDim Cell As Range\nDim Cells As Range\n\nSet Cells = Sheets(WhateverSheet).Range(\"A1:A\" &amp; Application.WorksheetFunction.CountA(Range(\"A:A\")))\n\nFor Each Cell In Cells\n\nIf IsNumeric(Cell.Value) = True Then Cell.Value = Cell.Value - 1\n\nNext Cell\n\nEnd Sub\n\n\nCell.Value = Trim(Cell.Value)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6083186, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KwCbHeI9qYs/AAAAAAAAAAI/AAAAAAAAAIw/XaArhrwTBcA/photo.jpg?sz=128", "display_name": "Milan", "link": "https://stackoverflow.com/users/6083186/milan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1460555270, "creation_date": 1460545110, "question_id": 36596298, "link": "https://stackoverflow.com/questions/36596298/how-do-i-using-a-macro-decrease-all-the-values-in-a-selected-range-by-1", "title": "How do I, using a macro, decrease all the values in a selected range by 1", "body": "<p>I've searched for similar questions, but the problem I'm having is that I'm adding what I'm looking for to an existing recorded macro that uses commands like:</p>\n\n<p>Range(Selection, Selection.End(xlUp)).Select</p>\n\n<p>to select a range.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 0, "creation_date": 1460545319, "post_id": 36596201, "comment_id": 60789454, "body": "Are you familiar with Visual Basic?"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6138950, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eedeb65e7ec6ea107e30c8ea90780983?s=128&d=identicon&r=PG&f=1", "display_name": "Zakky", "link": "https://stackoverflow.com/users/6138950/zakky"}, "edited": false, "score": 0, "creation_date": 1460615610, "post_id": 36599107, "comment_id": 60827266, "body": "WOW!!!!  amazing code - works 100%.  work of a genius. You&#39;ve just saved me 30 mins of extra work everyday.. Thank you sooooo much!!"}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 0, "last_activity_date": 1460552500, "last_edit_date": 1460552500, "creation_date": 1460552189, "answer_id": 36599107, "question_id": 36596201, "link": "https://stackoverflow.com/questions/36596201/loop-to-find-an-empty-cell-in-a-column-then-copy-the-cell-above-the-empty-cell/36599107#36599107", "title": "Loop to find an empty cell in a column, then copy the cell above the empty cell into the empty cell", "body": "<p>Is this what you're looking for? This sub loops over all rows and checks if the cell in column B is empty but the cell in column A contains a value. If so, it copies the cell in column B from the previous row into the current row.</p>\n\n<pre><code> Sub fillEmptyCells()\n 'copies the above cell for each empty cell in B where the cell in A is not empty\n    Dim i As Integer\n    Dim lastRow As Integer\n    Dim ws As Worksheet\n    Set ws = ActiveSheet\n\n    lastRow = ws.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row   'This gives the last Row with a nonempty cell in column A\n    For i = 1 To lastRow\n        If IsEmpty(ws.Cells(i, 2)) And Not IsEmpty(ws.Cells(i, 1)) Then\n            ws.Cells(i - 1, 2).Copy ws.Cells(i, 2)\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Edit: here is the same sub with a <code>with</code> environment</p>\n\n<pre><code> Sub fillEmptycells()\n 'copies the above cell for each empty cell in B where the cell in A is not empty\n     Dim i As Integer\n     Dim lastRow As Integer\n\n     With ActiveSheet\n         lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row   'This gives the last Row with a nonempty cell in column B\n         For i = 1 To lastRow\n             If IsEmpty(.Cells(i, 2)) And Not IsEmpty(.Cells(i, 1)) Then\n                 .Cells(i - 1, 2).Copy .Cells(i, 2)\n             End If\n         Next i\n     End With\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 6138950, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eedeb65e7ec6ea107e30c8ea90780983?s=128&d=identicon&r=PG&f=1", "display_name": "Zakky", "link": "https://stackoverflow.com/users/6138950/zakky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1825, "favorite_count": 1, "accepted_answer_id": 36599107, "answer_count": 1, "score": 0, "last_activity_date": 1460552500, "creation_date": 1460544823, "question_id": 36596201, "link": "https://stackoverflow.com/questions/36596201/loop-to-find-an-empty-cell-in-a-column-then-copy-the-cell-above-the-empty-cell", "title": "Loop to find an empty cell in a column, then copy the cell above the empty cell into the empty cell", "body": "<p>I have a SAP report in Excel with over 10,000 rows. There are 2 columns - A &amp; B. A is value in $ and B is ref for the value. The SAP report shows subtotals by reference type but the subtotal ref cell B is always empty. I need to copy the cell above the empty cell into the empty cell (into the same row as the subtotal). e.g. A1:A5 has values 3,2,3,1,1 so the subtotal is 10 and it's in A6. the cell in B6 is empty. The ref type in B5 is 12kg Bag. I need to copy this ref into Cell B6. the reason why i do this is because i filter the report by subtotal to copy to another file. At the moment I'm doing this manually and it takes ages. I'm guessing it's a loop code until the last row as the rows vary each time i run the report. Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 1, "creation_date": 1460545441, "post_id": 36595935, "comment_id": 60789539, "body": "Can you edit your question to provide the code. Without that it&#39;s difficult to comment."}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1460548109, "post_id": 36595935, "comment_id": 60791500, "body": "@Ambie question amended with code"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1460549765, "post_id": 36595935, "comment_id": 60792891, "body": "The symptoms you describe would occur if you are handling events in your worksheets or workbook. Having read your code, the <code>_Change</code> and <code>_SelectionChange</code> events would be prime candidates. Is there any possibility that your project has such event handling code?"}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1460551314, "post_id": 36595935, "comment_id": 60794315, "body": "@Ambie No I don&#39;t think it does have an event handling code"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1460551547, "post_id": 36595935, "comment_id": 60794512, "body": "And are the worksheets protected, cells locked or otherwise restricted?"}, {"owner": {"reputation": 983, "user_id": 4632606, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/VsoxX.jpg?s=128&g=1", "display_name": "ZwoRmi", "link": "https://stackoverflow.com/users/4632606/zwormi"}, "edited": false, "score": 0, "creation_date": 1460551664, "post_id": 36595935, "comment_id": 60794603, "body": "Try to set explicitly your <code>Workbook</code> and your <code>Sheet</code> before using them,  so before each <code>Range</code> or <code>Cells</code> put <code>Workbooks(&quot;wbkName&quot;).Sheets(&quot;shtName&quot;)</code>"}], "owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513923354, "creation_date": 1460544105, "last_edit_date": 1513923354, "question_id": 36595935, "link": "https://stackoverflow.com/questions/36595935/excel-vba-2013-compatibility-issues", "title": "excel VBA 2013 Compatibility issues", "body": "<p>I have just had an upgrade from office 2010 to office 2013.  The VBA scripting which I had ran perfectly fine in office 2010 with no issues, since the upgrade it now crashes when the button is clicked to run the code.  I stepped through the code line by line to see what the problem was but it worked fine, didn't crash it done everything it was suppose to do.  </p>\n\n<p>Is this a compatibility issue?  I know the scripting is correct, but it know causes excel to not respond and shut down when the button is clicked and the scripting now runs really slow where as before it was fast.</p>\n\n<p>Here is the code which I am running: </p>\n\n<pre><code>   Dim x As Workbook 'Saved workbook from email (MEP)\n   Dim y As Workbook 'Saved workbook from email (PS)\n   Dim sht1 As Worksheet 'Current active worksheet (Formatted)\n   Dim LResult As String\n   Dim RangeSort As Range\n   Dim RangeKey As Range\n   Dim majVarCount As Integer\n   Dim minVarCount As Integer\n   Dim onTrackCount As Integer\n   Dim rng As Range\n   Dim iVal As Integer\n   Dim compStartRow As Integer\n   Dim compEndRow As Integer\n\n'Open Closed Project PS report\n        Set y = Workbooks.Open(\"C:\\documents\\Closed.xlsx\") 'Path for workbook to copy from\n            lastRow = Cells(Rows.Count, 2).End(xlUp).Row        'Find the last row\n        Rows(lastRow).Delete                                    'Deletes un-necessary row\n\n'Find last row again after deleting un-necessary row\n        lastRow = Cells(Rows.Count, 2).End(xlUp).Row\n\n'Copy over required data\n        Range(\"B6:E\" &amp; lastRow).Select\n            Selection.Hyperlinks.Delete\n            Selection.Copy\n            Workbooks(\"Formatted\").Worksheets(\"Formatted\").Range(\"E22\").Insert Shift:=xlDown                  \n        Range(\"F6:F\" &amp; lastRow).Select\n                Selection.Copy\n                Workbooks(\"Formatted\").Worksheets(\"Formatted\").Range(\"K22\").Insert Shift:=xlDown      '(Global/Regional)\n            Range(\"G6:G\" &amp; lastRow).Select\n                Selection.Copy\n                Workbooks(\"Formatted\").Worksheets(\"Formatted\").Range(\"M22\").Insert Shift:=xlDown      \n             Range(\"H6:H\" &amp; lastRow).Select\n                Selection.Copy\n                Workbooks(\"Formatted\").Worksheets(\"Formatted\").Range(\"X22\").Insert Shift:=xlDown      \n            Range(\"I6:K\" &amp; lastRow).Select\n                Selection.Copy\n                Workbooks(\"Formatted\").Worksheets(\"Formatted\").Range(\"AS22\").Insert Shift:=xlDown     \n\n            Application.DisplayAlerts = False\n            y.Close\n\n    'To remove characters after the first blank space in column M\n            lastRow = Cells(Rows.Count, \"M\").End(xlUp).Row\n            Range(\"M22:M\" &amp; lastRow).Replace What:=\" *\", Replacement:=\"\", LookAt:=xlPart\n\n    'Change strings from \"Green = OnTrack, Amber = Minor Variance, Red = Significant Variance\"\n            With Range(\"AS:AU\")\n                .Replace What:=\"Green\", Replacement:=\"On Track\"\n                .Replace What:=\"Amber\", Replacement:=\"Minor Variance\"\n                .Replace What:=\"Red\", Replacement:=\"Significant Variance\"\n            End With\n\n    'Checking the last row\n            lastRow = Cells(Rows.Count, 5).End(xlUp).Row\n    'Used to confirm that LastRow worked displays as message\n            'MsgBox \"Last Row: \" &amp; lastRow\n\n    'Searching for blank cells and populating with'On track'\n            With Range(\"AS22:AU\" &amp; lastRow)\n                .Replace What:=\"\", Replacement:=\"On Track\"\n            End With\n\n            With Range(\"X22:X\" &amp; lastRow)\n                .Replace What:=\"\", Replacement:=\"Complete\"\n            End With\n\n    'Clear contents in column DP no not needed\n            lastRow = Cells(Rows.Count, 5).End(xlUp).Row\n            Range(\"DP22:DP\" &amp; lastRow).ClearContents\n\n            With Worksheets(\"Formatted\")\n                lastRow = .Cells(Rows.Count, 5).End(xlUp).Row\n                For Each rng In .Range(\"DP22:DP\" &amp; lastRow)\n                    rng.Formula = \"=IF(COUNTIF(AS\" &amp; rng.Row &amp; \":AU\" &amp; rng.Row &amp; \", \"\"Significant Variance\"\"), \"\"Significant Variance\"\", \" &amp; _\n                                   \"IF(COUNTIF(AS\" &amp; rng.Row &amp; \":AU\" &amp; rng.Row &amp; \", \"\"Minor Variance\"\"), \"\"Minor Variance\"\", \" &amp; _\n                                   \"\"\"On Track\"\"))\"\n                    rng.Value = rng.Value\n                Next rng\n            End With\n\n    'Find the range of cells for Complete Project\n            compStartRow = Range(\"X:X\").Find(What:=\"Complete\", after:=Range(\"X21\")).Row\n            compEndRow = Range(\"X:X\").Find(What:=\"Complete\", after:=Range(\"X21\"), SearchDirection:=xlPrevious).Row\n            'MsgBox \"First and Last Row for Complete Projects: \" &amp; compStartRow &amp; compEndRow           'Used for checking first and last row values are correct\n\n    'Counts the values and paste in to Count Table sheet\n            iVal = Application.WorksheetFunction.CountIf(Range(\"DP\" &amp; compStartRow &amp; \":DP\" &amp; compEndRow), \"On Track\")\n            Worksheets(\"Count Table\").Range(\"E8\").Value = iVal\n            iVal = Application.WorksheetFunction.CountIf(Range(\"DP\" &amp; compStartRow &amp; \":DP\" &amp; compEndRow), \"Minor Variance\")\n            Worksheets(\"Count Table\").Range(\"D8\").Value = iVal\n            iVal = Application.WorksheetFunction.CountIf(Range(\"DP\" &amp; compStartRow &amp; \":DP\" &amp; compEndRow), \"Significant Variance\")\n            Worksheets(\"Count Table\").Range(\"C8\").Value = iVal\n\n\n\n    'Clear contents in column DP not needed\n            lastRow = Cells(Rows.Count, 5).End(xlUp).Row\n            Range(\"DP22:DP\" &amp; lastRow).ClearContents\n\n    'Copy information from the Lookup table sheet into the Formatted sheet and clears the clipboard\n            Sheets(\"Lookup Table\").Range(\"C5\").Copy Sheets(\"Formatted\").Range(\"L22:L\" &amp; lastRow)\n            Application.CutCopyMode = False\n            Sheets(\"Lookup Table\").Range(\"C4\").Copy Sheets(\"Formatted\").Range(\"J22:J\" &amp; lastRow)\n            Application.CutCopyMode = False\n            Sheets(\"Lookup Table\").Range(\"C6\").Copy Sheets(\"Formatted\").Range(\"K22:K\" &amp; lastRow)\n            Application.CutCopyMode = False\n            Sheets(\"Lookup Table\").Range(\"C8\").Copy Sheets(\"Formatted\").Range(\"Q22:Q\" &amp; lastRow)\n            Application.CutCopyMode = False\n            Sheets(\"Lookup Table\").Range(\"C10\").Copy Sheets(\"Formatted\").Range(\"AQ22:AQ\" &amp; lastRow)\n            Application.CutCopyMode = False\n            Sheets(\"Lookup Table\").Range(\"C11\").Copy Sheets(\"Formatted\").Range(\"AR22:AR\" &amp; lastRow)\n            Application.CutCopyMode = False\n            Sheets(\"Lookup Table\").Range(\"C13\").Copy Sheets(\"Formatted\").Range(\"BD22:BD\" &amp; lastRow)\n            Application.CutCopyMode = False\n            Sheets(\"Lookup Table\").Range(\"C15\").Copy Sheets(\"Formatted\").Range(\"BF22:BF\" &amp; lastRow)\n            Application.CutCopyMode = False\n            Sheets(\"Lookup Table\").Range(\"C17\").Copy Sheets(\"Formatted\").Range(\"BH22:BH\" &amp; lastRow)\n            Application.CutCopyMode = False\n            Sheets(\"Lookup Table\").Range(\"C19\").Copy Sheets(\"Formatted\").Range(\"BJ22:BJ\" &amp; lastRow)\n            Application.CutCopyMode = False\n            Sheets(\"Lookup Table\").Range(\"C21\").Copy Sheets(\"Formatted\").Range(\"BL22:BL\" &amp; lastRow)\n            Application.CutCopyMode = False\n            Sheets(\"Lookup Table\").Range(\"C23\").Copy Sheets(\"Formatted\").Range(\"BN22:BN\" &amp; lastRow)\n            Application.CutCopyMode = False\n            Sheets(\"Lookup Table\").Range(\"C24\").Copy Sheets(\"Formatted\").Range(\"BO22:BO\" &amp; lastRow)\n            Application.CutCopyMode = False\n            Sheets(\"Lookup Table\").Range(\"C25\").Copy Sheets(\"Formatted\").Range(\"BP22:BP\" &amp; lastRow)\n            Application.CutCopyMode = False\n\n    'Remove cell borders\n            Set rng = ActiveSheet.Range(\"E22:BP\" &amp; lastRow)\n            rng.Borders.LineStyle = xlNone\n\n    'Save formatted sheet as new workbook before overlay has been applied\n            FPath = \"C:\\documents\\Reports\\formatted\\\"\n            FName = \"Formatted with Closed\" &amp; Format(Now, \"ddmmmyyyy_hhmm\") &amp; \".xls\"\n\n            Set NewBook = Workbooks.add\n\n            ThisWorkbook.Sheets(\"Formatted\").Copy Before:=NewBook.Sheets(1)\n            NewBook.SaveAs Filename:=FPath &amp; \"\\\" &amp; FName\n            Application.DisplayAlerts = False\n            NewBook.Close\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1460543316, "post_id": 36595499, "comment_id": 60787986, "body": "Assuming that&#39;s a control on the sheet, use: <code>activesheet.oleobjects(&quot;chb_g_ba1&quot;).visible = true</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1460543467, "post_id": 36595499, "comment_id": 60788125, "body": "No, other than actually writing the code to a module."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1460543542, "post_id": 36595499, "comment_id": 60788181, "body": "Ok, thank you. I have deleted my answer just to double check it. But it really works. The Question was - &quot;Is it possible to do it like Eval()&quot;"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1460543782, "post_id": 36595499, "comment_id": 60788357, "body": "I don&#39;t know what answer you are talking about. There is no Eval or equivalent for this in Excel VBA. Nor can I think of a good reason to need one, to be honest."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1460543808, "post_id": 36595499, "comment_id": 60788374, "body": "I meant the comment, before your second comment."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1460546809, "post_id": 36595499, "comment_id": 60790535, "body": "@Rory do you know why the following does not work - activesheet.oleobjects(&quot;chb_g_ba1&quot;).value = true"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1460546957, "post_id": 36595499, "comment_id": 60790629, "body": "You need to access the object contained in the OLEobject: <code>activesheet.oleobjects(&quot;chb_g_ba1&quot;).Object.value = True</code>"}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1460545942, "post_id": 36596146, "comment_id": 60789898, "body": "It also requires trusted access to the vb project, which is not set by default."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1460546223, "post_id": 36596146, "comment_id": 60790103, "body": "Thanks, Karthick. But it looks like overkill. I just wanted to eliminate writing 10 lines of code."}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 1, "creation_date": 1460546386, "post_id": 36596146, "comment_id": 60790219, "body": "you can add more lines by using the chr(13)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1460547105, "post_id": 36596146, "comment_id": 60790724, "body": "I mean, the whole idea was not write If Else 10 times. But thanks :)"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 1, "last_activity_date": 1532768166, "last_edit_date": 1532768166, "creation_date": 1460544669, "answer_id": 36596146, "question_id": 36595499, "link": "https://stackoverflow.com/questions/36595499/vba-execute-string-as-command-in-excel/36596146#36596146", "title": "VBA - Execute string as command in Excel", "body": "<p>Credit to <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">CPearson</a>:</p>\n\n<p>There is a way to do that but we have to add a new module dynamically with required code and delete while finished. </p>\n\n<p>References: Microsoft Visual Basic for Applications Extensibility 5.3</p>\n\n<pre><code>Sub test()\n    Set VBComp = ThisWorkbook.VBProject.VBComponents.Add(vbext_ct_StdModule)\n    VBComp.Name = \"NewModule\"\n    Set VBCodeMod = ThisWorkbook.VBProject.VBComponents(\"NewModule\").CodeModule\n    Dim l_counter As Long\n    l_counter = 1\n    With VBCodeMod\n        LineNum = .CountOfLines + 1\n        .InsertLines LineNum, _\n        \"Sub MyNewProcedure()\" &amp; Chr(13) &amp; \"UserForm1.chb_g_ba\" &amp; l_counter &amp; \".Visible = True\" &amp; Chr(13) &amp; \"End Sub\"\n    End With\n    'run the new module\n    Application.Run \"MyNewProcedure\"\n    UserForm1.Show\n    'Delete the created module\n    ThisWorkbook.VBProject.VBComponents.Remove VBComp\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2256, "favorite_count": 3, "accepted_answer_id": 36596146, "answer_count": 1, "score": 0, "last_activity_date": 1532768166, "creation_date": 1460542988, "last_edit_date": 1495542701, "question_id": 36595499, "link": "https://stackoverflow.com/questions/36595499/vba-execute-string-as-command-in-excel", "title": "VBA - Execute string as command in Excel", "body": "<p>In the last 30 minutes I am trying to execute a string in VBA as a command. The command is like this and it runs ok:</p>\n\n<pre><code>activesheet.chb_g_ba1.visible = true\n</code></pre>\n\n<p>What I am trying to do is to set \"chb_g_ba1\" as a variable, because there are \"chb_g_ba2\", \"chb_g_ba3\", etc as well.</p>\n\n<p>What I have tried so far - things like:</p>\n\n<pre><code>dim l_counter as long: l_counter = 1\nEvaluate (CStr(\"me.chb_g_ba\" &amp; l_counter &amp; \".visible = true\"))\n</code></pre>\n\n<p>Or even Eval</p>\n\n<pre><code>Eval (CStr(\"me.chb_g_ba\" &amp; l_counter &amp; \".visible = true\"))\n</code></pre>\n\n<p>Eval is a function in MS Access VBA, but obviously it is not present in Excel. Pretty much my question is extremely similar to this one:<a href=\"https://stackoverflow.com/questions/24956527/vba-how-to-run-a-string-as-a-line-of-code\">VBA how to run a string as a line of code</a>, but it is for Excel, not for Access.</p>\n\n<p>So, any ideas are welcomed! :)</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1460564978, "post_id": 36595189, "comment_id": 60805802, "body": "I see. Is your <code>ID_Field</code> the Primary Key? Normally, PKs should be invisible to the user, and definitely not be editable by the user. As you have found out, it creates problems. If it&#39;s the PK, is there a reason why users can edit it? If not, you can use the PK to identify the current record and exclude it from your search."}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1460567915, "post_id": 36595189, "comment_id": 60807666, "body": "@Andre, no. ID_Field is not primary key. And PK is invisible to user.But both ID and ID_Field(which has completety different name - I messed this up) have index set to No duplicates. However, changing Id_Field to Indexed No doesn&#39;t change anything."}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1460568239, "post_id": 36595189, "comment_id": 60807851, "body": "How can I exclude record from search, but keep code going If new record with same Id_Field would be entered ?"}], "answers": [{"comments": [{"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1460542838, "post_id": 36595321, "comment_id": 60787612, "body": "I tried, but this doesn&#39;t solve the problem, Records still can&#39;t be edited."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1460543154, "post_id": 36595321, "comment_id": 60787853, "body": "Please show the full code where you try to edit the record(s)."}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1460544842, "post_id": 36595321, "comment_id": 60789077, "body": "Paul, my code for editing records is simple button which unlocks the fields in continous form."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1460542537, "creation_date": 1460542537, "answer_id": 36595321, "question_id": 36595189, "link": "https://stackoverflow.com/questions/36595189/access-vba-prevent-duplicate-entry/36595321#36595321", "title": "Access VBA - prevent duplicate entry", "body": "<p>A \"snapshot\" takes the records in their current state for e.g. inspection. They are read-only.</p>\n\n<p>To open the record set read/write, use <code>dbOpenDynaset</code></p>\n"}, {"comments": [{"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1460545384, "post_id": 36596189, "comment_id": 60789491, "body": "thanks for that. I allready had something like this before, but still one problem - When you are still on same record in continous form and you try to save record via DoCmd.RunCommand acCmdSaveRecord, error &quot;3022&quot; still pops-up. This can be solved by a simple Error handle - If err.number=3022 Then...However, form error code works when you try to go on another record in continous form. BUT - I&#39;m trying to solve this problem with one code only, that&#39;s why I changed everything."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1460544797, "creation_date": 1460544797, "answer_id": 36596189, "question_id": 36595189, "link": "https://stackoverflow.com/questions/36595189/access-vba-prevent-duplicate-entry/36596189#36596189", "title": "Access VBA - prevent duplicate entry", "body": "<p>To prevent the built-in message, it is best to use the <code>Form.OnError</code> event.<br>\nSee: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836345.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff836345.aspx</a></p>\n\n<p>E.g. like this:</p>\n\n<pre><code>Private Sub Form_Error(DataErr As Integer, Response As Integer)\n\n    ' Error 3022 = \"Cannot add a duplicate value because of a key constraint...\"\n    If DataErr = 3022 Then\n        MsgBox \"Your duplicate warning\", vbExclamation\n        ' Remove duplicate ID and set focus into ID control\n        Me!ID_Field = Null\n        Me!ID_Field.SetFocus\n        ' Dont't show default error message\n        Response = acDataErrContinue\n    Else\n        ' Other errors: show default error message\n        Response = acDataErrDisplay\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1460609391, "post_id": 36610741, "comment_id": 60824802, "body": "Great Andre, this works !! What a nightmare, I have tried thousand variations but nothing worked. A BIG thanks !"}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1460609737, "post_id": 36610741, "comment_id": 60824915, "body": "Andre, what about If need combination of two fields ? like ID_Field and SomeOther_Field ? just add It after Me.ID_Field ?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1460609934, "post_id": 36610741, "comment_id": 60824978, "body": "@LuckyLuke82: The 3rd parameter of DLookup is like a WHERE clause, you can build any criteria you like. e.g. <code>&quot;ID_Field = &quot; &amp; Me.ID_Field &amp; &quot; AND SomeOther_Field = &quot; &amp; Me.SomeOther_Field &amp; &quot; AND myPK &lt;&gt; &quot; &amp; Nz(Me.myPK, 0)</code>. For text criteria, enclose them in <code>&#39;&#39;</code>."}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1460610411, "post_id": 36610741, "comment_id": 60825137, "body": "I have tried this, but seems like it doesn&#39;t work :  Nz(DLookup(&quot;ID_Field&quot;, &quot;JoinTable&quot;, &quot;ID_Field = &quot; &amp; Me.ID_Field &amp; Another_Field &amp; _                     &quot; AND PK_JoinTable &lt;&gt; &quot; &amp; Nz(Me.PK_JoinTable, 0)), 0). However, this is a Join table, and index of 2 FK has to be checked."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1460610543, "post_id": 36610741, "comment_id": 60825186, "body": "@LuckyLuke82: Build your query in the query design editor, switch to SQL view, and use the WHERE clause as template to build the DLookup parameter."}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1460610627, "post_id": 36610741, "comment_id": 60825210, "body": "I will try, and let you know."}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1460612242, "post_id": 36610741, "comment_id": 60825786, "body": "I don&#39;t know - I tried this but It&#39;s not working...Problem is that Dlookup&#39;s first parameter should be a combination of 2 fields. It&#39;s a Join table, from which I need to check duplicates of 2 fields together (both fields are FK). This is too difficult for me."}, {"owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "edited": false, "score": 0, "creation_date": 1460613472, "post_id": 36610741, "comment_id": 60826250, "body": "I have opened another thread for that, I just can&#39;t get It working, It&#39;s frustrating."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1460586827, "creation_date": 1460586827, "answer_id": 36610741, "question_id": 36595189, "link": "https://stackoverflow.com/questions/36595189/access-vba-prevent-duplicate-entry/36610741#36610741", "title": "Access VBA - prevent duplicate entry", "body": "<p>Let's say your primary key column is <code>myPK</code>.</p>\n\n<p>To check <code>ID_Field</code> against all but the current record, don't use a Recordset and <code>FindFirst</code>, use <code>DLookup</code> instead.</p>\n\n<pre><code>Dim TestID as Long\nTestID = Nz(DLookup(\"ID_Field\", \"MyTable\", \"ID_Field = \" &amp; Me.ID_Field &amp; _\n                    \" AND myPK &lt;&gt; \" &amp; Nz(Me.myPK, 0)), 0)\nIf TestID &gt; 0 Then\n    ' Dupe\nElse\n    ' ok\nEnd If\n</code></pre>\n\n<p>You may need to add <code>myPK</code> as invisible text box to the form, to be able to read its value.</p>\n"}], "owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3847, "favorite_count": 0, "accepted_answer_id": 36610741, "answer_count": 3, "score": 1, "last_activity_date": 1460586827, "creation_date": 1460542185, "last_edit_date": 1460547986, "question_id": 36595189, "link": "https://stackoverflow.com/questions/36595189/access-vba-prevent-duplicate-entry", "title": "Access VBA - prevent duplicate entry", "body": "<p>I'm trying to avoid Access built-in msgbox about entering duplicate records, by checking entries  in before update event. Code works, but one BIG problem - you cannot edit those records anymore. Any way to accomplish both - allow edits and avoid Access msgbox ?</p>\n\n<pre><code>Private Sub Form_BeforeUpdate(Cancel As Integer)\n\nDim rs As Recordset\nSet rs = CurrentDb.OpenRecordset(\"MyTable\", dbOpenDynaset)\n\nIf Data_Changed Then 'Variable of Boolean that is set to True in Dirty event\n\n     If Not IsNull(ID_Field) Then\n\n         If MsgBox(\"You have done changes. you wish to save? ?\" &amp; vbCrLf &amp; vBCrLf &amp; \"Click Yes for saving changes or NO for Undoing changes ! \" &amp; _\n         , vbQuestion + vbOKCancel + vbDefaultButton1) = vbOK Then\n\n             rs.FindFirst \"ID = \" &amp; Me.ID_Field\n\n             If Not rs.NoMatch Then\n                 Cancel = True\n                 MsgBox \"Error. You cannot add another record with same ID!\", vbCritical\n                 DoCmd.RunCommand acCmdUndo\n                 Exit Sub\n             End If\n\n\n         Else\n\n             DoCmd.RunCommand acCmdUndo\n\n         End If\n\n      Else\n\n          MsgBox \"Error. you cannot save record with blank ID !\", vbCritical\n\n          DoCmd.SetWarnings False\n          If Me.Dirty Then Me.Undo\n          DoCmd.SetWarnings True\n\n          Exit Sub\n\n      End If\n\n      Me.ID_Field.Locked = True\n      Me.Other_Field.Locked = True\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1460551950, "post_id": 36595093, "comment_id": 60794855, "body": "Have your tried working with any of these two solutions instead: <a href=\"http://stackoverflow.com/questions/17531128/copy-paste-calculate-visible-cells-from-one-column-of-a-filtered-table\" title=\"copy paste calculate visible cells from one column of a filtered table\">stackoverflow.com/questions/17531128/&hellip;</a> OR <a href=\"http://stackoverflow.com/questions/16039774/excel-vba-copying-and-pasting-visible-table-rows-only\" title=\"excel vba copying and pasting visible table rows only\">stackoverflow.com/questions/16039774/&hellip;</a>? If that&#39;s not an option: how much data are we talking about? Is it a table you could possibly <code>SELECT</code> from like so: <a href=\"http://stackoverflow.com/questions/2188233/how-to-select-a-subset-of-a-table-with-excel-vba-in-the-manner-of-select-from\" title=\"how to select a subset of a table with excel vba in the manner of select from\">stackoverflow.com/questions/2188233/&hellip;</a>?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460553139, "post_id": 36595093, "comment_id": 60795964, "body": "I must be missing some relevant info so take it just as a guessing: why not simply go <code>myRange.Copy</code> and then <code>Selection.PasteSpecial ...</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1460554413, "creation_date": 1460554413, "answer_id": 36600069, "question_id": 36595093, "link": "https://stackoverflow.com/questions/36595093/copying-data-from-autofilter-in-vba/36600069#36600069", "title": "Copying data from autofilter in vba", "body": "<p>Should not be useful (see my above comment) the following \"direct\" solution:</p>\n\n<pre><code>myRange.Copy\nWorkbooks(mainwb).Worksheets(\"Sheet1\").Range(\"A1\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>I propose the following alternative:</p>\n\n<pre><code>Dim dummyRange As Range\n...\nSet dummyRange = myRange.Parent.Range(\"XFD10000\") '&lt;== I assume cell \"XFD10000\" isn't used... As for this range utility, see right below\nSet myFltrdRange = dummyRange '&lt;==\"dummy\" and \"helper\" range to falsely initialize myFltrdRange and prevent \".Union().\" method from failing the first time. it'll be removed from resulting \"myFltrdRange\" before the \".Copy\" method\nFor Each myArea In myRange.Areas\n    For Each rw In myArea.Rows\n        Set myFltrdRange = Union(myFltrdRange, rw)\n    Next\nNext\n\nIntersect(myFltrdRange, myRange).Copy '&lt;== this removes the\"dummy\" range\nWorkbooks(mainwb).Worksheets(\"Sheet1\").Range(\"A1\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1460554413, "creation_date": 1460541934, "last_edit_date": 1531164843, "question_id": 36595093, "link": "https://stackoverflow.com/questions/36595093/copying-data-from-autofilter-in-vba", "title": "Copying data from autofilter in vba", "body": "<p>I am trying to copy data from cells that have been autofiltered in vba. My code looks like this:</p>\n\n<pre><code> For Each myArea In myRange.Areas\n      For Each rw In myArea.Rows\n          strFltrdRng = strFltrdRng &amp; rw.Address &amp; \",\"\n      Next\n Next\n\n strFltrdRng = Left(strFltrdRng, Len(strFltrdRng) - 1)\n Set myFltrdRange = Range(strFltrdRng)\n myFltrdRange.Copy\n strFltrdRng = \"\"\n\n Workbooks(mainwb).Activate\n Workbooks(mainwb).Worksheets(\"Sheet1\").Range(\"A1\").Select\n Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>But when the variable strFltrdRng is this long:</p>\n\n<pre><code>\"$B$2:$H$2,$B$3:$H$3,$B$4:$H$4,$B$5:$H$5,$B$6:$H$6,$B$7:$H$7,$B$8:$H$8,$B$10:$H$10,$B$11:$H$11,$B$12:$H$12,$B$13:$H$13,$B$15:$H$15,$B$17:$H$17,$B$18:$H$18,$B$19:$H$19,$B$20:$H$20,$B$21:$H$21,$B$22:$H$22,$B$23:$H$23,$B$26:$H$26,$B$27:$H$27,$B$28:$H$28,$B$2\"\n</code></pre>\n\n<p>It throws me an error: Method 'Range' of object_Global' failed. However when I shorten the strFltrRng, I am able to copy the data. </p>\n\n<p>Is there any way to solve this problem?</p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"tags": [], "owner": {"reputation": 419, "user_id": 6187464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IqTLI.jpg?s=128&g=1", "display_name": "HedgePig", "link": "https://stackoverflow.com/users/6187464/hedgepig"}, "is_accepted": false, "score": 0, "last_activity_date": 1460600927, "last_edit_date": 1460600927, "creation_date": 1460550402, "answer_id": 36598345, "question_id": 36594530, "link": "https://stackoverflow.com/questions/36594530/loop-to-run-macros-from-other-workbooks/36598345#36598345", "title": "Loop to run macros from other workbooks", "body": "<p>I think something like the code below will achieve what you are wanting to do.</p>\n\n<p>Note that the code first opens the workbook whose macro you want to run.\nYou can then run the macro in that opened workbook from your original workbook with the Application.Run() command, e.g. </p>\n\n<pre><code>Application.Run(\"book1.xlsm!mymacro\"), or\nresult = Application.Run(\"book1.xlsm!mymacro\", \"Hello\", 20)\n</code></pre>\n\n<p>The second example calls a macro that requires a string paramater and an integer parameter.</p>\n\n<p>The fuller example below opens some specific workbooks called 100.xlsm, 110.xlsm, etc and then runs a macro in each of them called SayHelloMessage.\nI hope this helps.</p>\n\n<pre><code>Sub RunMacrosInOtherWorkbooks()\n\n   Dim wbpath As String          'path where the workbooks containing the macros you want to run are saved\n   Dim wbnames() As String       'array containing names of workbooks whose macros you want to run\n   Dim wbTarget As Workbook      'current workbook who macro is being run\n   Dim macroname As String       'name of macro being run\n\n   wbpath = \"C:\\Test\"\n   wbnames() = Split(\"100.xlsm,110.xlsm,137.xlsm,140.xlsm\", \",\")  'Just one way of creating the list of workbooks.\n   macroname = \"SayHelloMessage\"\n\n   Dim i As Integer\n   Dim result As Variant\n   For i = 0 To UBound(wbnames)\n      Set wbTarget = Workbooks.Open(wbpath &amp; \"\\\" &amp; wbnames(i))\n      result = Application.Run(wbTarget.Name &amp; \"!\" &amp; macroname)\n      ' result = Application.Run(wbTarget.Name &amp; \"!\" &amp; macroname, 76)  'calling a subroutine or function with an argument.  You need something to catch a return code\n      wbTarget.Save\n      wbTarget.Close\n   Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 6197868, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6e23b39e1fa042bae2f2cefee157cbde?s=128&d=identicon&r=PG&f=1", "display_name": "korone", "link": "https://stackoverflow.com/users/6197868/korone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460627942, "creation_date": 1460540630, "last_edit_date": 1460627942, "question_id": 36594530, "link": "https://stackoverflow.com/questions/36594530/loop-to-run-macros-from-other-workbooks", "title": "Loop to run macros from other workbooks", "body": "<p>I would greatly appreciate your help with a macro that I am trying to create. </p>\n\n<p>I have a pathway that looks as follows: <code>K:\\XXX\\XXX\\XXX\\Module 1</code></p>\n\n<p><code>Module 1</code> is a folder that contains a bunch of <code>xlsm</code> files named with a number (i.e. <code>100.xlsm</code>, <code>110.xlsm</code>, and so forth)</p>\n\n<p>I would like to create a loop that:</p>\n\n<ol>\n<li>Runs the macro in workbook <code>100.xlsm</code>;</li>\n<li>Saves the <code>100.xlsm</code> (NOT \"save as\") when the macro is done running;</li>\n<li>Closes the saved <code>xlsm</code>, moves on to the next file (i.e.\n<code>110.xlsm</code>), and repeats the same steps.</li>\n</ol>\n\n<p>Before running the loop, I would like to create a statement that stores the names of those <code>xlsm</code> files. </p>\n\n<p>The macro below may give you an idea of what I am after. There are indeed several errors. </p>\n\n<pre><code>Sub update()\n\nDim path As String path = \"K:\\XXX\\XXX\\XXX\\Module 1\" \n\nDim list() As Integer \nList=(100, 110, 137, 140)\n\nFor Each n As Integer In list   \n\n  Application.Run (path &amp; \"\\\" &amp;n.xslm!refresh)   \n  Save WORKBOOK  \n  Close WORKBOOK\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1513, "user_id": 3477792, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/dNUwn.png?s=128&g=1", "display_name": "Savad KP", "link": "https://stackoverflow.com/users/3477792/savad-kp"}, "edited": false, "score": 0, "creation_date": 1460540842, "post_id": 36594457, "comment_id": 60786102, "body": "Format the question in right way. It will help others to understand easily."}, {"owner": {"reputation": 7, "user_id": 6052891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f7ce79cbeacc2906140966d05dd023?s=128&d=identicon&r=PG", "display_name": "mrinal", "link": "https://stackoverflow.com/users/6052891/mrinal"}, "reply_to_user": {"reputation": 1513, "user_id": 3477792, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/dNUwn.png?s=128&g=1", "display_name": "Savad KP", "link": "https://stackoverflow.com/users/3477792/savad-kp"}, "edited": false, "score": 0, "creation_date": 1460614603, "post_id": 36594457, "comment_id": 60826741, "body": "code working properly without errors on host server but not working on web server showing no erorrs.can u help me solve this issue.."}], "owner": {"reputation": 7, "user_id": 6052891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f7ce79cbeacc2906140966d05dd023?s=128&d=identicon&r=PG", "display_name": "mrinal", "link": "https://stackoverflow.com/users/6052891/mrinal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460618279, "creation_date": 1460540427, "last_edit_date": 1460618279, "question_id": 36594457, "link": "https://stackoverflow.com/questions/36594457/program-working-on-localhost-but-not-at-webserver-in-vb-net", "title": "program working on localhost but not at webserver in vb.net", "body": "<p>'Function for inserting data in gridview table</p>\n\n<pre><code>Public Function GetData(ByVal cmd As SqlCommand) As DataTable\n        Dim dt As New DataTable\n        Dim strConnString As String = \"Data Source=DTPS-CMS-SVR;Initial Catalog=CAPEXTRACK\"\n        Dim con As New SqlConnection(strConnString)\n        Dim sda As New SqlDataAdapter\n        cmd.CommandType = CommandType.Text\n        cmd.Connection = con\n        Try\n            con.Open()\n            sda.SelectCommand = cmd\n            sda.Fill(dt)\n            Return dt\n        Catch ex As Exception\n            Response.Write(ex.Message)\n            Return Nothing\n        Finally\n            con.Close()\n            sda.Dispose()\n            con.Dispose()\n        End Try\n    End Function\n\n    ' Bind Gridview Data\n\n    Private Sub BindGridviewData()\n        Using con As New SqlConnection(strCon)\n            Using cmd As New SqlCommand()\n                cmd.CommandText = \"select * from fileinfo\"\n                cmd.Connection = con\n                con.Open()\n                GridView1.DataSource = cmd.ExecuteReader()\n                GridView1.DataBind()\n                con.Close()\n            End Using\n        End Using\n    End Sub\n</code></pre>\n\n<p>'button for uploading the selected files</p>\n\n<pre><code>    Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button1.Click\n        Dim filename As String = Path.GetFileName(FileUpload1.PostedFile.FileName)\n        Dim str As Stream = FileUpload1.PostedFile.InputStream\n        Dim br As New BinaryReader(str)\n        Dim size As [Byte]() = br.ReadBytes(CInt(str.Length))\n        Using con As New SqlConnection(strCon)\n            Using cmd As New SqlCommand()\n                cmd.CommandText = \"insert into fileinfo(FileName,FileType,FileData) values(@Name,@Type,@Data)\"\n                cmd.Parameters.AddWithValue(\"@Name\", filename)\n                cmd.Parameters.AddWithValue(\"@Type\", \"application/word\")\n                cmd.Parameters.AddWithValue(\"@Data\", size)\n                cmd.Connection = con\n                con.Open()\n                cmd.ExecuteNonQuery()\n                con.Close()\n                BindGridviewData()\n            End Using\n        End Using\n\n    End Sub\n</code></pre>\n\n<p>'Code For Downloading on the link button</p>\n\n<pre><code>Protected Sub lnkDownload_Click(ByVal sender As Object, ByVal e As EventArgs)\n    Dim lnkbtn As LinkButton = TryCast(sender, LinkButton)\n    Dim gvrow As GridViewRow = TryCast(lnkbtn.NamingContainer, GridViewRow)\n    Dim fileid As Integer = Convert.ToInt32(GridView1.DataKeys(gvrow.RowIndex).Value.ToString())\n    ' Dim name As String, type As String\n    Using con As New SqlConnection(strCon)\n        Using cmd As New SqlCommand()\n            cmd.CommandText = \"select FileName, FileType, FileData from fileinfo where Id=@Id\"\n            cmd.Parameters.AddWithValue(\"@id\", fileid)\n            cmd.Connection = con\n            con.Open()\n            Dim dr As SqlDataReader = cmd.ExecuteReader()\n            If dr.Read() Then\n                Response.ContentType = dr(\"FileType\").ToString()\n                Response.AddHeader(\"Content-Disposition\", \"attachment;filename=\"\"\" &amp; Convert.ToString(dr(\"FileName\")) &amp; \"\"\"\")\n                Response.BinaryWrite(DirectCast(dr(\"FileData\"), Byte()))\n\n            End If\n        End Using\n    End Using\nEnd Sub\n</code></pre>\n\n<p>'Download function for downloading the uploaded File</p>\n\n<pre><code>Protected Sub download(ByVal dt As DataTable)\n    Dim bytes() As Byte = CType(dt.Rows(0)(\"FileData\"), Byte())\n    Response.Buffer = True\n    Response.Charset = \"\"\n    Response.Cache.SetCacheability(HttpCacheability.NoCache)\n    Response.ContentType = dt.Rows(0)(\"FileType\").ToString()\n    Response.AddHeader(\"content-disposition\", \"attachment;filename=\" &amp; dt.Rows(0)(\"FileName\").ToString())\n    Response.BinaryWrite(bytes)\n    Response.Flush()\n    Response.End()\nEnd Sub\n</code></pre>\n\n<p>'Code For Downloading in the link button</p>\n\n<pre><code>Protected Sub InkDownload_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles InkDownload.Click\n    Dim strQuery As String = \"select FileName, FileType, FileData from fileinfo where Id=@Id\"\n    Dim cmd As SqlCommand = New SqlCommand(strQuery)\n    cmd.Parameters.Add(\"@id\", SqlDbType.Int).Value = 1\n    Dim dt As DataTable = GetData(cmd)\n    If dt IsNot Nothing Then\n        download(dt)\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1460547683, "post_id": 36594447, "comment_id": 60791169, "body": "Not shure of what you want to achieve. But maybe you can try something like <code>RngCl.Offset(0, 3) = Sheet.Cells(RngCl.Row, RngCl.Column-1) &#47; Sheet.Cells(RngCl.Row, RngCl.Column-3)</code>. Watch out that in your example (since Range is A1:A6) there is no <code>Column-1</code> or <code>Column-3</code>"}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "reply_to_user": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1460549059, "post_id": 36594447, "comment_id": 60792313, "body": "Hi, CMArg, Thanks for the input, I thought the upside of using R1C1 Format was that it goes from the active cell, so you can reference cells &quot;behind&quot; the current one using R[-1]C[-1] per say."}], "owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460540397, "creation_date": 1460540397, "question_id": 36594447, "link": "https://stackoverflow.com/questions/36594447/referring-to-other-cells-in-relation-to-current-cell-in-loop", "title": "Referring to OTHER cells in relation to CURRENT cell in loop", "body": "<p>I have a data document i'm working on but some things on it are wrong so i need to overwrite specific cells automatically. I'm looking to set up a loop that goes through each cell in <code>column G</code> and if a certain value is present then insert a formula into the cell in the same row but in <code>column J</code>. I've got as far as setting up the loop but I don't know how to put the formula in the new cell and relate it to the current cell. I was thinking R[]C[] formulas may be the way to go but think this becomes confusing when the formula in not straightforward e.g VLOOKUPS with IFs and MATCHES etc...</p>\n\n<pre><code>Sub FindDefects()\n\n    Dim RngCl As Range\n    Dim Rngg As Range\n\n    Set Rngg = Sheet1.Range(\"A1:A6\")\n\n    For Each RngCl In Rngg.Cells\n        If RngCl.Value = \"TEXT\" Then\n            RngCl.Offset(0,3).FormulaR1C1 = \"R[0]C[-1]/R[0]C[3]\"\n        Else\n            'Nada\n        End If\n    Next RngCl\n\nEnd Sub\n</code></pre>\n\n<p>I'm not sure really where to go from here, especially how to add in formulas such as:</p>\n\n<pre><code>=IF(LEN(J9)&gt;0,J9*VLOOKUP(M9,Core!A:C,3,FALSE)/VLOOKUP(K9,Core!A:C,3,FALSE),P9)\n</code></pre>\n\n<p>Instead of R1C1 formulas. Any help on moving forward is appreciated!</p>\n"}, {"tags": ["vba", "if-statement", "ms-word"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1460540448, "post_id": 36594403, "comment_id": 60785785, "body": "Can you not check what <code>timeon</code> contains an that point?"}, {"owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1460540857, "post_id": 36594403, "comment_id": 60786115, "body": "Timeon contains the value in the cell specified (when checking the immediate window). There is a black circle next to it - does that affect it and if so how do i remove it from the table?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1460541661, "post_id": 36594403, "comment_id": 60786756, "body": "This is a line break followed by the table cell terminator character. You might want to remove them before comparing."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1460542114, "post_id": 36594403, "comment_id": 60787097, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/15585202/how-to-trim-table-cell-values-in-ms-word-with-vba\">How to trim table cell values in MS Word with VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "is_accepted": false, "score": 0, "last_activity_date": 1460542189, "creation_date": 1460542189, "answer_id": 36595191, "question_id": 36594403, "link": "https://stackoverflow.com/questions/36594403/if-table-cell-value-then-not-working/36595191#36595191", "title": "If TABLE CELL VALUE = .... THEN (not working)", "body": "<p>Removing the black did did work - using this code:</p>\n\n<pre><code>timeon = wdDocSrc.Tables(3).Cell(2, 2)\nTimeconfig = timeon\nTimeconfig = Left$(Timeconfig, Len(Timeconfig) - 2)\nIf Timeconfig = \"Yes\" Then\nTimeReplace = wdDocSrc.Tables(2).Cell(2, 1)\n\nTimeText = TimeReplace\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1479756726, "creation_date": 1460540293, "last_edit_date": 1479756726, "question_id": 36594403, "link": "https://stackoverflow.com/questions/36594403/if-table-cell-value-then-not-working", "title": "If TABLE CELL VALUE = .... THEN (not working)", "body": "<p>I have the following code that looks in a document for a sentence with 'pm' in - if found it replaces it with the value is a master document table 2 cells 2,2.</p>\n\n<p>For some reason the IF statement is not working and always goes to the ELSE IF not replacing the text in the document - can any one help me with this as I've been stuck all morning.</p>\n\n<pre><code>timeon = wdDocSrc.Tables(2).Cell(2, 2).Range.Text\nIf timeon = \"a\" Then  'ERROR HERE\nTimeReplace = wdDocSrc.Tables(2).Cell(3, 1)\n\nTimeText = TimeReplace\n\nwdDocTgt.Activate\n\nWith wdDocTgt\nSelection.Find.Execute FindText:=\"pm\", Forward:=True\n\nIf Selection.Text = \"pm\" Then\nWith Selection\n ' Collapse current selection to insertion point.\n.Collapse\n ' Turn extend mode on.\n.Extend\n ' Extend selection to word.\n.Extend\n ' Extend selection to sentence.\n.Extend\n End With\n With Selection\n    'Selection.Text = \"We are now open Christmas DAY!!. \"\n    Selection.Text = TimeText\n\nEnd With\n\nElse\nMsgBox \"No timing in this letter\"\nEnd If\nEnd With\nElse\nMsgBox \"ERROR\" 'AWAYS JUMPS TO THIS\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1460546287, "post_id": 36594157, "comment_id": 60790146, "body": "Do you have anything to show us that you have tried already?"}], "answers": [{"tags": [], "owner": {"reputation": 503, "user_id": 136193, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a53bb9da456c3215ef71a792caf987b0?s=128&d=identicon&r=PG", "display_name": "SrinR", "link": "https://stackoverflow.com/users/136193/srinr"}, "is_accepted": false, "score": 0, "last_activity_date": 1460549931, "last_edit_date": 1460549931, "creation_date": 1460549337, "answer_id": 36597893, "question_id": 36594157, "link": "https://stackoverflow.com/questions/36594157/removing-duplicates-from-many-excel-sheets/36597893#36597893", "title": "Removing duplicates from many excel sheets", "body": "<p>I can think of a workaround for this:</p>\n\n<ol>\n<li>Create a column at the end of each row which is concatenation of all the columns of that particular row: Lets sat below are the two tables on the two excel sheets:<br></li>\n</ol>\n\n<p>sheet1<br></p>\n\n<pre>\nA   B   C   D(Concat)\n1   2   3   123\n4   5   6   456\n7   8   9   789\n1   3   5   135\n4   3   2   432 </pre>\n\n<p><br>sheet2<br></p>\n\n<pre>\nA   B   C   D(Concat)\n2   3   4   234\n1   1   1   111\n1   2   3   123\n2   2   2   222\n4   5   6   456</pre>\n\n<ol start=\"2\">\n<li>We will now identify the duplicate rows based on the last concatenated column. Using the formula<br> <code>=IF(ISNUMBER(MATCH(D4,Sheet1!D:D,0)),\"DUP\",\"NONDUP\")</code><br> in the second sheet, we can identify the rows which are already present in sheet1 irrespective of the sequence of the row in sheet1 wrt sheet2.</li>\n</ol>\n\n<p>Result on Sheet2 shows up as below:<br></p>\n\n<pre>\nA   B   C   D   E(Result)\n2   3   4   234 NONDUP\n1   1   1   111 NONDUP\n1   2   3   123 DUP\n2   2   2   222 NONDUP\n4   5   6   456 DUP</pre>\n"}], "owner": {"reputation": 1, "user_id": 6133882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8393f8a7fa27cb35ec318ddd2bbfc3?s=128&d=identicon&r=PG&f=1", "display_name": "EmJotPe", "link": "https://stackoverflow.com/users/6133882/emjotpe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460549931, "creation_date": 1460539665, "question_id": 36594157, "link": "https://stackoverflow.com/questions/36594157/removing-duplicates-from-many-excel-sheets", "title": "Removing duplicates from many excel sheets", "body": "<p>I got a question if there is any fast way to remove duplicate rows across two excel spreadsheets. After searching I can do it by comparing the same rows in the spreadsheets (VBA). But I want to check whether the row from one is included anywhere in two. If exactly the same row exists in two it should be removed. So far I can do it if they are the same rows (e.g. 1 and 1).\nThanks in advance for any kind of help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 619, "user_id": 4091300, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dd580ce66c4208f1484bcc51b33c815d?s=128&d=identicon&r=PG&f=1", "display_name": "GavinP", "link": "https://stackoverflow.com/users/4091300/gavinp"}, "edited": false, "score": 0, "creation_date": 1460539950, "post_id": 36594049, "comment_id": 60785363, "body": "You&#39;re not stating what you want Alt_State to be if the PrevSoc is between 30 and 40."}, {"owner": {"reputation": 619, "user_id": 4091300, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dd580ce66c4208f1484bcc51b33c815d?s=128&d=identicon&r=PG&f=1", "display_name": "GavinP", "link": "https://stackoverflow.com/users/4091300/gavinp"}, "edited": false, "score": 0, "creation_date": 1460540335, "post_id": 36594049, "comment_id": 60785699, "body": "Apologies, missed the static reference. How is this function being called?"}, {"owner": {"reputation": 3, "user_id": 4843181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/101d3898b56144f966787362cf94a040?s=128&d=identicon&r=PG&f=1", "display_name": "Fenrir", "link": "https://stackoverflow.com/users/4843181/fenrir"}, "reply_to_user": {"reputation": 619, "user_id": 4091300, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dd580ce66c4208f1484bcc51b33c815d?s=128&d=identicon&r=PG&f=1", "display_name": "GavinP", "link": "https://stackoverflow.com/users/4091300/gavinp"}, "edited": false, "score": 0, "creation_date": 1460540641, "post_id": 36594049, "comment_id": 60785950, "body": "I simply write &quot;=SOC(W15;T16*1000)&quot; in the next column on my &quot;Data worksheet&quot;. I also repeat or rather drag it up to the final cell to get the whole column. So: =SOC(W15;T16*1000), =SOC(W16;T17*1000) etc ..."}, {"owner": {"reputation": 619, "user_id": 4091300, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dd580ce66c4208f1484bcc51b33c815d?s=128&d=identicon&r=PG&f=1", "display_name": "GavinP", "link": "https://stackoverflow.com/users/4091300/gavinp"}, "edited": false, "score": 0, "creation_date": 1460540825, "post_id": 36594049, "comment_id": 60786088, "body": "OK. can you give me a sample of W and T columns where it&#39;s causing you an issue? Edit it into your question maybe?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460542378, "post_id": 36594049, "comment_id": 60787280, "body": "in which cells (address) do you actually write the SOC function?"}], "owner": {"reputation": 3, "user_id": 4843181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/101d3898b56144f966787362cf94a040?s=128&d=identicon&r=PG&f=1", "display_name": "Fenrir", "link": "https://stackoverflow.com/users/4843181/fenrir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460542224, "creation_date": 1460539454, "last_edit_date": 1460542224, "question_id": 36594049, "link": "https://stackoverflow.com/questions/36594049/excel-vba-static-variables", "title": "Excel VBA, static variables?", "body": "<p>I am trying to write a function that would simulate the alternator activation (to recharge a battery). In a few words, my function \"Alt\" regulates the activation of the alternator depending on the <strong>State of Charge (SOC)</strong> of the battery. It is <strong>On</strong> as soon as <strong>SOC &lt; 30</strong> and remains so until <strong>SOC > 40</strong>. Therefore the alternator will be charing to battery up to 40%, after that it goes to the <strong>Off</strong> state again. </p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>Function SOC(PrevSoc As Double, Power As Double)\n    Static Alt_State As Integer\n\n    If PrevSoc &gt;= 40 Then\n        Alt_State = 0\n    ElseIf PrevSoc &lt;= 30 Then\n        Alt_State = 1\n    End If\n\n    If Alt_State = 0 Then\n        SOC = PrevSoc - ((350 - Power) / (12 * 360))\n    ElseIf Alt_State = 1 Then\n        SOC = PrevSoc - ((350 - (Power + 3500)) / (14 * 360))\n    End If\nEnd Function\n</code></pre>\n\n<p>Note that depending on the alternator's state I would have a specific equation which would or would not take into account the additional power input from the alternator.</p>\n\n<p>Now my problem is that the behaviour is very strange and I observe an activation at 36% for example. In my opinion it is related static variable \"alt state\". Would there be another way to resolve this issue in excel? Any help would be very appreciated.</p>\n\n<p>PS: I could upload an excel file if needed</p>\n\n<p>PS2 (Edit): The variable \"Power\" represents power input coming from another source that would recharge the battery as well. While Power = 0, the battery discharges following a simple equation, therefore with a constant rate (case of alt_state = 0 and considering Power = 0). </p>\n"}, {"tags": ["vba", "excel", "types"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "edited": false, "score": 0, "creation_date": 1460538183, "post_id": 36593404, "comment_id": 60784049, "body": "What format is the text in?"}, {"owner": {"reputation": 21, "user_id": 5292320, "user_type": "registered", "profile_image": "https://graph.facebook.com/694023084061063/picture?type=large", "display_name": "Harish Chaudhary", "link": "https://stackoverflow.com/users/5292320/harish-chaudhary"}, "edited": false, "score": 0, "creation_date": 1460538612, "post_id": 36593404, "comment_id": 60784352, "body": "Data, I used is coming out of a software. It is in text(string), which look like date."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "edited": false, "score": 0, "creation_date": 1460538673, "post_id": 36593404, "comment_id": 60784391, "body": "Format as in yyyy/mm/dd or mm-dd-yy or ...?"}], "answers": [{"tags": [], "owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "is_accepted": false, "score": 0, "last_activity_date": 1460538303, "creation_date": 1460538303, "answer_id": 36593520, "question_id": 36593404, "link": "https://stackoverflow.com/questions/36593404/to-convert-text-to-date-in-excel-2010/36593520#36593520", "title": "To convert text to date in Excel 2010", "body": "<p>From what I can gather, you have a range of cells with data you wish to convert to dates, but some of the cells in that range are blank? What do you want to do with the blank cells?</p>\n\n<p>If you want to ignore them, just add an IF statement to cater for them</p>\n\n<pre><code>For Each c In Range(\"B4:B\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row)\n    If c.Value &lt;&gt; \"\" Then\n        c.Value = DateValue(c.Value)\n    End If\nNext c\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "is_accepted": true, "score": 1, "last_activity_date": 1460538437, "creation_date": 1460538437, "answer_id": 36593588, "question_id": 36593404, "link": "https://stackoverflow.com/questions/36593404/to-convert-text-to-date-in-excel-2010/36593588#36593588", "title": "To convert text to date in Excel 2010", "body": "<p>You can try this as well : <a href=\"http://www.techonthenet.com/excel/formulas/isdate.php\" rel=\"nofollow\">Isdate</a> function checks if a value is date or not.</p>\n\n<pre><code>For Each c In Range(\"B4:B\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row)\n      if Isdate(c.value) then\n        c.Value = CDate(c.Value)\n      Else End if\nNext c\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1460539315, "last_edit_date": 1592644375, "creation_date": 1460539315, "answer_id": 36593989, "question_id": 36593404, "link": "https://stackoverflow.com/questions/36593404/to-convert-text-to-date-in-excel-2010/36593989#36593989", "title": "To convert text to date in Excel 2010", "body": "<p>Here is a two line code (This doesn't require looping)</p>\n<pre><code>Sub Sample()\n    [A1:A20].NumberFormat = &quot;DD/MM/YYYY&quot;\n    [A1:A20] = [index(IF(A1:A20=&quot;&quot;,&quot;&quot;,DATEVALUE(A1:A20)),)]\nEnd Sub\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/Ewd4b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ewd4b.png\" alt=\"enter image description here\" /></a></p>\n<p>I am assuming that the range is from <code>A1:A20</code> Please change as applicable.</p>\n<p>If you want to understand what this code does then see the explanation that I have given <a href=\"https://stackoverflow.com/questions/19985895/convert-an-entire-range-to-uppercase-without-looping-through-all-the-cells\">Here</a></p>\n<p>This is a combination of <code>INDEX</code> and <code>=IF(A1=&quot;&quot;,&quot;&quot;,DATEVALUE(A1))</code></p>\n"}], "owner": {"reputation": 21, "user_id": 5292320, "user_type": "registered", "profile_image": "https://graph.facebook.com/694023084061063/picture?type=large", "display_name": "Harish Chaudhary", "link": "https://stackoverflow.com/users/5292320/harish-chaudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 36593588, "answer_count": 3, "score": 0, "last_activity_date": 1460539315, "creation_date": 1460537973, "last_edit_date": 1460538426, "question_id": 36593404, "link": "https://stackoverflow.com/questions/36593404/to-convert-text-to-date-in-excel-2010", "title": "To convert text to date in Excel 2010", "body": "<p>I want to use VBA code to convert my data (date) from text to date.</p>\n\n<pre><code>For Each c In Range(\"B4:B\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row)\n    c.Value = DateValue(c.Value)\nNext c\n</code></pre>\n\n<p>This code is not working with blank cells in between. Showing runtime error (error in datatype).\nAnd this code:</p>\n\n<pre><code> For Each c In Range(\"B4:B\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row)\n    c.Value = CDate(c.Value)\n Next c\n</code></pre>\n\n<p>is showing 12.00.00 AM for empty values.</p>\n\n<p>Basic idea behind to convert all text to date in given range, when new data is pasted.</p>\n\n<p>Please give suggestions. Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1460539562, "post_id": 36593354, "comment_id": 60785066, "body": "<code>Sheets(&quot;Sheet1&quot;).Cells(i, &quot;B&quot;).Value = wf.WorkDay(Sheets(&quot;Sheet1&quot;).Cells(i, &quot;A&quot;), -1)</code> (Untested)"}, {"owner": {"reputation": 13, "user_id": 6197657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7972c7ce8909c3aca6997ab2913af2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Lakshman", "link": "https://stackoverflow.com/users/6197657/lakshman"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1460540164, "post_id": 36593354, "comment_id": 60785564, "body": "That worked perfect Siddharth.. Thank you so much"}, {"owner": {"reputation": 13, "user_id": 6197657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7972c7ce8909c3aca6997ab2913af2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Lakshman", "link": "https://stackoverflow.com/users/6197657/lakshman"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1460540787, "post_id": 36593354, "comment_id": 60786066, "body": "Just encountered a problem :( The query is returning the previous date for any date where as I want current date if it is a working day and previous date if it is a holiday."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6197657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7972c7ce8909c3aca6997ab2913af2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Lakshman", "link": "https://stackoverflow.com/users/6197657/lakshman"}, "edited": false, "score": 0, "creation_date": 1460540818, "post_id": 36594129, "comment_id": 60786084, "body": "Just encountered a problem The query is returning the previous date for any date where as I want current date if it is a working day and previous date if it is a holiday. Not sure how to arrive at it."}, {"owner": {"reputation": 503, "user_id": 136193, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a53bb9da456c3215ef71a792caf987b0?s=128&d=identicon&r=PG", "display_name": "SrinR", "link": "https://stackoverflow.com/users/136193/srinr"}, "reply_to_user": {"reputation": 13, "user_id": 6197657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7972c7ce8909c3aca6997ab2913af2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Lakshman", "link": "https://stackoverflow.com/users/6197657/lakshman"}, "edited": false, "score": 0, "creation_date": 1460544355, "post_id": 36594129, "comment_id": 60788745, "body": "Hope this works: <code>Sheets(&quot;Sheet1&quot;).Cells(i, &quot;B&quot;).Value = wf.WorkDay(Range(&quot;A&quot; &amp; i)+1, -1)</code>"}, {"owner": {"reputation": 503, "user_id": 136193, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a53bb9da456c3215ef71a792caf987b0?s=128&d=identicon&r=PG", "display_name": "SrinR", "link": "https://stackoverflow.com/users/136193/srinr"}, "reply_to_user": {"reputation": 13, "user_id": 6197657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7972c7ce8909c3aca6997ab2913af2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Lakshman", "link": "https://stackoverflow.com/users/6197657/lakshman"}, "edited": false, "score": 0, "creation_date": 1460697696, "post_id": 36594129, "comment_id": 60872132, "body": "Good to know that it works!! Please accept the answer if it saves the day.. That would be a nice encouragement."}, {"owner": {"reputation": 13, "user_id": 6197657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7972c7ce8909c3aca6997ab2913af2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Lakshman", "link": "https://stackoverflow.com/users/6197657/lakshman"}, "edited": false, "score": 0, "creation_date": 1460719148, "post_id": 36594129, "comment_id": 60884652, "body": "Hey @identifymecnu I tried to add the sheet containing Holidays just so to get previous day in case of Holiday.. I wrote the code something like this      Sheets(&quot;Sheet1&quot;).Cells(i, &quot;CA&quot;).Value = wf.WorkDay((Range(&quot;E&quot; &amp; i) + 1), -1, Sheets(&quot;Holidays&quot;).Range(&quot;A1:A10&quot;))  Now am getting the same &quot;workday property of the worksheetfunction class&quot; error.. Could you please let me know where am going wrong"}, {"owner": {"reputation": 503, "user_id": 136193, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a53bb9da456c3215ef71a792caf987b0?s=128&d=identicon&r=PG", "display_name": "SrinR", "link": "https://stackoverflow.com/users/136193/srinr"}, "reply_to_user": {"reputation": 13, "user_id": 6197657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7972c7ce8909c3aca6997ab2913af2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Lakshman", "link": "https://stackoverflow.com/users/6197657/lakshman"}, "edited": false, "score": 0, "creation_date": 1460780993, "post_id": 36594129, "comment_id": 60912922, "body": "I have the code <code>Sheets(&quot;Sheet1&quot;).Cells(i, &quot;B&quot;).Value = wf.WorkDay(Range(&quot;A&quot; &amp; i) + 1, -1, Sheets(&quot;Holidays&quot;).Range(&quot;A1:A2&quot;))</code> which works. As such, I tried with the line of code in your comment and that works as well!!"}], "tags": [], "owner": {"reputation": 503, "user_id": 136193, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a53bb9da456c3215ef71a792caf987b0?s=128&d=identicon&r=PG", "display_name": "SrinR", "link": "https://stackoverflow.com/users/136193/srinr"}, "is_accepted": true, "score": 1, "last_activity_date": 1460539614, "creation_date": 1460539614, "answer_id": 36594129, "question_id": 36593354, "link": "https://stackoverflow.com/questions/36593354/how-to-get-previous-date-if-the-current-date-is-a-holiday/36594129#36594129", "title": "How to get previous date if the current date is a Holiday", "body": "<p>The left hand side will be able to capture only one value whereas the right hand side of the expression is trying to give out the result for the whole range of <strong>A:A</strong></p>\n\n<p>Small correction in the code gives the previous/current working day as returned by the function in Datevalue integer value:<br>\n    <code>Sheets(\"Sheet1\").Cells(i, \"B\").Value = wf.WorkDay(Range(\"A\" &amp; i), -1)</code></p>\n\n<p>This further can be converted into a date formatted value using the below formula in the excel cell.<p>\n<code>=TEXT(MONTH(B2)&amp;\"/\"&amp;DAY(B2)&amp;\"/\"&amp;YEAR(B2),\"mm/dd/yyyy\")</code><br> where range <strong>B:B</strong> is the result from the VB execution.</p>\n"}], "owner": {"reputation": 13, "user_id": 6197657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7972c7ce8909c3aca6997ab2913af2c8?s=128&d=identicon&r=PG&f=1", "display_name": "Lakshman", "link": "https://stackoverflow.com/users/6197657/lakshman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 36594129, "answer_count": 1, "score": 0, "last_activity_date": 1460539675, "creation_date": 1460537863, "last_edit_date": 1531161705, "question_id": 36593354, "link": "https://stackoverflow.com/questions/36593354/how-to-get-previous-date-if-the-current-date-is-a-holiday", "title": "How to get previous date if the current date is a Holiday", "body": "<p>Newbie to VB here and I got caught up in this situation.</p>\n\n<p>I have a column which has dates in it.</p>\n\n<pre><code>A\n1/31/2016\n1/31/2016\n1/31/2016\n1/31/2016\n</code></pre>\n\n<p>Now in column B, I want to get the previous working date if the date mentioned in column A is a weekend or Holiday else the same date if the date mentioned in column A is a working day. So the output will be like.</p>\n\n<pre><code>A          B\n1/31/2016  1/29/2016\n1/31/2016  1/29/2016\n1/31/2016  1/29/2016\n1/31/2016  1/29/2016\n</code></pre>\n\n<p>I am currently using this code. But am getting error. Please let me know how to arrive at the desired output.</p>\n\n<pre><code>Sub Work_day()\n\nDim wf As WorksheetFunction\nSet wf = Application.WorksheetFunction\n\nFor i = 2 To Sheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row\nSheets(\"Sheet1\").Cells(i, \"B\").Value = wf.WorkDay(Range(\"A:A\"), -1)\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>The error am getting is \"Unable to get the workday property of the worksheetfunction class\"</p>\n"}, {"tags": ["excel", "paste", "vba"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 4964444, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/19f8820f57640ae84c044e99880398a3?s=128&d=identicon&r=PG&f=1", "display_name": "yfro", "link": "https://stackoverflow.com/users/4964444/yfro"}, "edited": false, "score": 1, "creation_date": 1460538661, "post_id": 36593459, "comment_id": 60784384, "body": "Thank you sir or mam! :)"}], "tags": [], "owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "is_accepted": true, "score": 0, "last_activity_date": 1460538138, "creation_date": 1460538138, "answer_id": 36593459, "question_id": 36593264, "link": "https://stackoverflow.com/questions/36593264/paste-special-error-in-vba-excel-2010/36593459#36593459", "title": "Paste Special error in VBA Excel 2010", "body": "<p>Looks like you are referencing the sheet, selecting the cells, but then referencing the sheet object again to paste into without giving a range to do so. This works on Excel 2013, you may need to play with the syntax on other versions</p>\n\n<pre><code>Set wsd = Sheets(\"Data\")\nWith wsd\n    .Range(\"L5:X5\").PasteSpecial xlPasteValues, xlPasteSpecialOperationNone, False, False\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 4964444, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/19f8820f57640ae84c044e99880398a3?s=128&d=identicon&r=PG&f=1", "display_name": "yfro", "link": "https://stackoverflow.com/users/4964444/yfro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 932, "favorite_count": 0, "accepted_answer_id": 36593459, "answer_count": 1, "score": 0, "last_activity_date": 1460538492, "creation_date": 1460537599, "last_edit_date": 1531164843, "question_id": 36593264, "link": "https://stackoverflow.com/questions/36593264/paste-special-error-in-vba-excel-2010", "title": "Paste Special error in VBA Excel 2010", "body": "<p>I am trying to copy and paste values, which is actually no difficult task.</p>\n\n<p>In order to only copy the values of the cells values I use Paste.Special x1PasteValues.</p>\n\n<p>Here comes the funny part:</p>\n\n<pre><code>Set wsd = Sheets(\"Data\")\nwsd.Select\nWith wsd\n.Range(\"L5:X5\").Select\n\n.PasteSpecial x1=PasteValues        &lt;~~ Runtime error: 1004        \n'.PasteSpecial Paste:=xlPasteValues &lt;~~ equivalent to the above\n'.PasteSpecial                      &lt;~~ This works, but only pastes the formula\n'.Paste                             &lt;~~ This pastes the formula\n\nEnd With\n</code></pre>\n\n<p>If I execute the code I receive a runtime error: 1004 and I can't find a solution for it. The same happens if I want to paste the format.</p>\n\n<p>Maybe the problem is that the macro is written in an ActiveX button, which is why I have to use with wsd.</p>\n\n<p>Help is much appreciated. Thanks in advance!</p>\n\n<p>edit: I just found a similar topic in which a problem occured by switching a workbook and manually activating a macro (instead of i.e. a macro button). Could the same problem occur in my code, since I switch between worksheets?</p>\n\n<p><a href=\"https://stackoverflow.com/questions/21680758/excel-vba-runtime-error-1004\">Excel VBA runtime error 1004</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1460537042, "post_id": 36592896, "comment_id": 60783252, "body": "Subtract half the Width/Height from the Left/Top."}], "answers": [{"comments": [{"owner": {"reputation": 1446, "user_id": 1064028, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6dc426e4c9e4fce1c9ee9e81e4673e1a?s=128&d=identicon&r=PG", "display_name": "NeverPhased", "link": "https://stackoverflow.com/users/1064028/neverphased"}, "edited": false, "score": 0, "creation_date": 1460538335, "post_id": 36593194, "comment_id": 60784157, "body": "Thank you very much. However this centres my shape to the centre of the range. I need the shape to centre on the left top edge of the range defined!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "reply_to_user": {"reputation": 1446, "user_id": 1064028, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6dc426e4c9e4fce1c9ee9e81e4673e1a?s=128&d=identicon&r=PG", "display_name": "NeverPhased", "link": "https://stackoverflow.com/users/1064028/neverphased"}, "edited": false, "score": 0, "creation_date": 1460538400, "post_id": 36593194, "comment_id": 60784200, "body": "Delete everything on the rng.Left line after rng.Left"}, {"owner": {"reputation": 1446, "user_id": 1064028, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6dc426e4c9e4fce1c9ee9e81e4673e1a?s=128&d=identicon&r=PG", "display_name": "NeverPhased", "link": "https://stackoverflow.com/users/1064028/neverphased"}, "edited": false, "score": 0, "creation_date": 1460539080, "post_id": 36593194, "comment_id": 60784680, "body": "Thanks its getting closer...however please see my update!"}, {"owner": {"reputation": 1446, "user_id": 1064028, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6dc426e4c9e4fce1c9ee9e81e4673e1a?s=128&d=identicon&r=PG", "display_name": "NeverPhased", "link": "https://stackoverflow.com/users/1064028/neverphased"}, "edited": false, "score": 0, "creation_date": 1460539683, "post_id": 36593194, "comment_id": 60785174, "body": "Issue with my last screenshot please see now"}, {"owner": {"reputation": 1446, "user_id": 1064028, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6dc426e4c9e4fce1c9ee9e81e4673e1a?s=128&d=identicon&r=PG", "display_name": "NeverPhased", "link": "https://stackoverflow.com/users/1064028/neverphased"}, "edited": false, "score": 0, "creation_date": 1460539726, "post_id": 36593194, "comment_id": 60785206, "body": "Basically I have it perfectly lined up to the middle of the cell but I need the middle of the shape to the edge of the cell not the middle of shape to the middle of cell!"}, {"owner": {"reputation": 1446, "user_id": 1064028, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6dc426e4c9e4fce1c9ee9e81e4673e1a?s=128&d=identicon&r=PG", "display_name": "NeverPhased", "link": "https://stackoverflow.com/users/1064028/neverphased"}, "edited": false, "score": 0, "creation_date": 1460539868, "post_id": 36593194, "comment_id": 60785310, "body": "got it by commenting out &#39;+ (rng.Width / 2)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "is_accepted": true, "score": 2, "last_activity_date": 1460537834, "last_edit_date": 1460537834, "creation_date": 1460537421, "answer_id": 36593194, "question_id": 36592896, "link": "https://stackoverflow.com/questions/36592896/how-can-i-move-a-shape-so-its-centre-lines-up-with-a-cell-left-edge-in-excel-vba/36593194#36593194", "title": "How can I move a shape so its centre lines up with a cell left edge in excel VBA", "body": "<p>This will center your shape on the range defined, modify as appropriate.</p>\n\n<pre><code>Dim rng As Range\nSet rng = Range(\"D15\")\nWith Sheet1\n    .Shapes(\"Group 9\").Left = rng.Left - (.Shapes(\"Group 9\").Width / 2) + (rng.Width / 2)\n    .Shapes(\"Group 9\").Top = rng.Top - (.Shapes(\"Group 9\").Height / 2) + (rng.Height / 2)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1446, "user_id": 1064028, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6dc426e4c9e4fce1c9ee9e81e4673e1a?s=128&d=identicon&r=PG", "display_name": "NeverPhased", "link": "https://stackoverflow.com/users/1064028/neverphased"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1474, "favorite_count": 0, "accepted_answer_id": 36593194, "answer_count": 1, "score": 1, "last_activity_date": 1460539669, "creation_date": 1460536619, "last_edit_date": 1460539669, "question_id": 36592896, "link": "https://stackoverflow.com/questions/36592896/how-can-i-move-a-shape-so-its-centre-lines-up-with-a-cell-left-edge-in-excel-vba", "title": "How can I move a shape so its centre lines up with a cell left edge in excel VBA", "body": "<p>I have a group of shapes and I can currently move it to the top left edge of a reference cell however I need the middle of the shape to line up with this left edge. There is only \"Top\" and \"Left\" parameters and no \"Middle\" is there any way of doing this?</p>\n\n<p>I could move to left edge then increment by x amount based on the column width but this seems long winded?</p>\n\n<pre><code>Sub Macro4()\n\nDim x\nSet x = Range(\"A2\")\n\nSheet1.Shapes(\"Group 9\").Left = Sheet1.Cells(13, x).Left\nSheet1.Shapes(\"Group 9\").Top = Sheet1.Cells(13, x).Top\n\n\nEnd Sub\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>My code is now as follows:</p>\n\n<p>With Sheet1</p>\n\n<pre><code>    .Shapes(\"Group 9\").Top = rng.Top\n    .Shapes(\"Group 9\").Left = rng.Left - (.Shapes(\"Group 9\").Width / 2) + (rng.Width / 2)\n\n\nEnd With\n</code></pre>\n\n<p>Which achieves the following</p>\n\n<p><a href=\"https://i.stack.imgur.com/Dh9mj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dh9mj.png\" alt=\"enter image description here\"></a></p>\n\n<p>However I need to achieve this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Plbnt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Plbnt.png\" alt=\"enter image description here\"></a></p>\n\n<p>Whereby the inputed date in red means the shape centre aligns to the right edge of the cell in row 11 which matches the date in this case R11</p>\n"}, {"tags": ["vb.net", "excel", "pivot", "excel-2007", "vba"], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 3451210, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ca71ddecb13b76f60a28d0d52274f5c2?s=128&d=identicon&r=PG&f=1", "display_name": "404notfound", "link": "https://stackoverflow.com/users/3451210/404notfound"}, "is_accepted": true, "score": 0, "last_activity_date": 1461131318, "creation_date": 1461131318, "answer_id": 36734848, "question_id": 36592764, "link": "https://stackoverflow.com/questions/36592764/filter-column-labels-in-pivot-by-days-using-vb-net/36734848#36734848", "title": "Filter column labels in pivot by days using VB.NET", "body": "<p>After a couple of days, I already found the answer using the <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff839808.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Range.Group Method</a></p>\n\n<p>Also another mistake is I code <code>.xlColumnField</code> first before the <code>.xlDataField</code> . It should be on the last. </p>\n\n<p>Sample below:</p>\n\n<pre><code>ptField2 = ptTable2.PivotFields(\"Total Pages\")\nWith ptField2\n     .Orientation = Excel.XlPivotFieldOrientation.xlDataField\n     .Function = Excel.XlConsolidationFunction.xlSum\n     .Name = \"Pages\"\n     .NumberFormat = \"#,##0\"\nEnd With\n\nptField2 = ptTable2.PivotFields(\"Group\")\nWith ptField2\n     .Orientation = Excel.XlPivotFieldOrientation.xlRowField\n     .Name = \"Group\"\nEnd With\n\nptField2 = ptTable2.PivotFields(\"Submitted Date\")\nWith ptField2\n     .Orientation = Excel.XlPivotFieldOrientation.xlColumnField\n     .Name = \"Submitted Date\"\n     .DataRange.Cells(1).Group(True, True, 7, New Boolean() {False, False, False, True, False, False, False})\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 3451210, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ca71ddecb13b76f60a28d0d52274f5c2?s=128&d=identicon&r=PG&f=1", "display_name": "404notfound", "link": "https://stackoverflow.com/users/3451210/404notfound"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 1, "accepted_answer_id": 36734848, "answer_count": 1, "score": 1, "last_activity_date": 1533541526, "creation_date": 1460536265, "last_edit_date": 1531161705, "question_id": 36592764, "link": "https://stackoverflow.com/questions/36592764/filter-column-labels-in-pivot-by-days-using-vb-net", "title": "Filter column labels in pivot by days using VB.NET", "body": "<p>I have my pivot field code for submitted date.</p>\n\n<pre><code>ptField2 = ptTable2.PivotFields(\"Submitted Date\")\n    With ptField2\n        .Orientation = Excel.XlPivotFieldOrientation.xlColumnField\n        .Name = \"Submitted Date\"\n        .Caption = dtIntFrom.Value.ToString(\"MM-dd-yyyy\")\n        .ClearAllFilters()\n        .PivotFilters.Add(Type:=Excel.XlPivotFilterType.xlCaptionEquals, DataField:=\"Submitted Date\", Value1:=date_stamp)\n    End With\n</code></pre>\n\n<p><strong>Here is my target date: <em>mar15-mar31, 2016</em></strong></p>\n\n<pre><code>  date_stamp = Format(dtIntFrom.Value(), \"m/d/yyyy\") '3/15/2016\n  date_stamp2 = Format(dtIntTo.Value(), \"m/d/yyyy\") '3/31/2016\n</code></pre>\n\n<p>When I run my program, it displays all dates from my target date.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Qzyw8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Qzyw8.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to <strong>filter</strong> my selected target date per week and it must look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3EDvN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3EDvN.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks for any help! </p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460535031, "post_id": 36592296, "comment_id": 60781913, "body": "@JamieG If you could help"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460537612, "post_id": 36593170, "comment_id": 60783663, "body": "ERROR 429 : Active X component cant create an object"}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460538513, "post_id": 36593170, "comment_id": 60784276, "body": "ERROR 438 : object doent Support this property or method."}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460538589, "post_id": 36593170, "comment_id": 60784331, "body": "<code>Set pptSlide = oPPTApp.ActivePresentation.Slides(1).Duplicate</code> this code works fine for me. But after creating a new slide it gives a Type Mismatch error. Any Idea ?"}, {"owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460539172, "post_id": 36593170, "comment_id": 60784743, "body": "I&#39;m afraid not,  I can&#39;t test the code at the minute so i can&#39;t troubleshoot"}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460539268, "post_id": 36593170, "comment_id": 60784824, "body": "I just modified the code by adding ActivePresentation after the oPPTApp object. It works and creates a new Slide but that is a new Title Slide. I want the same slide as I am using i.e. sort of a duplicate of the same slide."}, {"owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460539371, "post_id": 36593170, "comment_id": 60784908, "body": "Are you referencing the correct layout for pptLayout?"}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460539468, "post_id": 36593170, "comment_id": 60784981, "body": "No, I dont want to refer to a pptLayout. I have myself created a table in ppt and want to use the same table in every slide. that is the reason I am trying to duplicate the slide."}, {"owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460539811, "post_id": 36593170, "comment_id": 60785259, "body": "Apologies, you didn&#39;t mention in your question that you want to duplicate the slides, you state they need the same layout and reference pptLayout in your code. Try  Set pptSlide = oPPTApp.ActivePresentation.Slides(oPPTAppActivePresentation.&zwnj;&#8203;Slides.Count).Duplic&zwnj;&#8203;ate  pptSlide.MoveTo(oPPTAppActivePresentation.Slides.Count)"}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460540303, "post_id": 36593170, "comment_id": 60785669, "body": "I am sorry for the wrong Interpretation of the question. I guess I tried the same Thing which you stated., The Count here is 1 for me so I directly states <code>.Slides(1)</code> . But Still I tried your code as well. Again the same Problem. It creates a duplicate slide but gives a TYPE MISMATCH error just after that."}, {"owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460540507, "post_id": 36593170, "comment_id": 60785845, "body": "I&#39;ve missed some stops out form the code i posted, can you try this for me please? Change oPPTAppActivePresentation to oPPTApp.ActivePresentation"}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460540616, "post_id": 36593170, "comment_id": 60785927, "body": "yes yes dont worry. I already did that. I just want to get rid of this TYPE MISMATCH error."}, {"owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460540922, "post_id": 36593170, "comment_id": 60786165, "body": "Is the error being thrown on that line? Can you step through the code and see where the error in thrown please?"}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460541071, "post_id": 36593170, "comment_id": 60786291, "body": "for my code it Shows error at <code>Set pptSlide = oPPTApp.ActivePresentation.Slides(1).Duplicate</code>  and for your code it Shows error at <code>Set pptSlide = oPPTApp.ActivePresentation.Slides(oPPTAppActivePresentation.&zwnj;&#8203;Slides.Count).Duplic&zwnj;&#8203;ate</code>. So basically, It is at the same line."}, {"owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460541469, "post_id": 36593170, "comment_id": 60786598, "body": "I&#39;ve just tested the code on my machine and the following works fine for me <code>Set pptSlide = oPPTApp.ActivePresentation.Slides(oPPTApp.ActivePresentation&zwnj;&#8203;.Slides.Count).Dupli&zwnj;&#8203;cate pptSlide.MoveTo (oPPTApp.ActivePresentation.Slides.Count)</code>"}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460541987, "post_id": 36593170, "comment_id": 60787004, "body": "<code>pptSlide.MoveTo (oPPTApp.ActivePresentation.Slides.Count)</code> is a new command . right? I mean it shoukd go in the next line ?"}, {"owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460543821, "post_id": 36593170, "comment_id": 60788387, "body": "Correct yes it should"}, {"owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460545395, "post_id": 36593170, "comment_id": 60789499, "body": "I got what was wrong. Duplicate Returns a range. not a slide. The correct Version was : <code>Set pptSlide = oPPTApp.ActivePresentation.Slides(1).Duplicate.Item(1)</code>"}, {"owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "reply_to_user": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "edited": false, "score": 0, "creation_date": 1460545833, "post_id": 36593170, "comment_id": 60789816, "body": "Odd, the original code works on mine. Glad it&#39;s working for you though"}], "tags": [], "owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "is_accepted": false, "score": 0, "last_activity_date": 1460537811, "last_edit_date": 1460537811, "creation_date": 1460537374, "answer_id": 36593170, "question_id": 36592296, "link": "https://stackoverflow.com/questions/36592296/excel-vba-adding-a-new-slide-to-powerpoint-automatically/36593170#36593170", "title": "EXCEL VBA adding a new slide to Powerpoint Automatically", "body": "<p>Use this code whever you need to insert a new slide, it will add the slide to the end of the presentation and apply your custom layout</p>\n\n<pre><code>Set pptSlide = oPPTApp.Slides.AddSlide(oPPTApp.Slides.Count + 1, pptLayout) \n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>Apologies, I couldn't test it myself. Try the edited code above</p>\n"}], "owner": {"reputation": 51, "user_id": 5426930, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce60caeb9bbe02e75be3f9b6fc30bdf2?s=128&d=identicon&r=PG&f=1", "display_name": "Nikky", "link": "https://stackoverflow.com/users/5426930/nikky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6805, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1614384400, "creation_date": 1460534904, "question_id": 36592296, "link": "https://stackoverflow.com/questions/36592296/excel-vba-adding-a-new-slide-to-powerpoint-automatically", "title": "EXCEL VBA adding a new slide to Powerpoint Automatically", "body": "<p>This is my code for exporting Contents from Excel to PowerPoint. My Problem is I have only one slide in the presentation. As the criteria is met,  VBA should automatically increase the slides and populate it. The slides should be of the same layout. After every IF and Else Loop I Need to add a new slide for the next Iteration. Using this code I get an error that Active X component cant create object. Any help ?  </p>\n\n<pre><code>Dim oPPTShape As PowerPoint.Shape\nDim oPPTFile As PowerPoint.Presentation\nDim SlideNum As Integer\nDim pptSlide As PowerPoint.Slide\nDim pptLayout As CustomLayout\nDim strPresPath As String, strExcelFilePath As String, strNewPresPath As String\n                strPresPath = \"C:\\Users\\asehgal\\Desktop\\OPL\\Presentation1.pptx\"\n\n            On Error Resume Next\n            Set oPPTApp = GetObject(, \"PowerPoint.Application\")\n\n                If oPPTApp Is Nothing Then\n\n\n\n                Set oPPTApp = CreateObject(\"PowerPoint.Application\")\n                oPPTApp.Visible = True 'msoTrue\n\n                End If\n                On Error GoTo 0\n                Set oPPTFile = oPPTApp.Presentations.Open(strPresPath)\n                SlideNum = 1\n                oPPTFile.Slides(SlideNum).Select\n                Set oPPTShape = oPPTFile.Slides(SlideNum).Shapes(\"Table 1\")\n\n                On Error Resume Next\n                If oPPTApp.Windows.Count &gt; 0 Then\n                Set oPPTFile = oPPTApp.ActivePresentation\n\n                Set pptSlide = oPPTFile.Slides(oPPTApp.ActiveWindow.Selection.SlideRange.SlideIndex)\n                Else\n\n                    Set oPPTFile = oPPTApp.Presentations.Add\n\n                    Set pptSlide = oPPTFile.Slides.AddSlide(1, ppLayout)\n                End If\n                On Error GoTo 0      \n                Do\n            'if topics are same\n            If (arrThema(p, 0) = arrThema(p + 1, 0)) Then\n\n                With oPPTShape.Table\n                .cell(1, 1).Shape.TextFrame.TextRange.text = arrThema(p, 0)\n                'if true Adda new slide here for the next iteration\n                End With\n\n                'If subtopics are also same\n                If (arrThema(p, 1) = arrThema(p + 1, 1)) Then\n\n\n                Else 'if subtopics are different\n\n                With oPPTShape.Table\n\n                .cell(2, 1).Shape.TextFrame.TextRange.text = arrThema(p, 1)\n                .cell(3, 2).Shape.TextFrame.TextRange.text = Beschreibung(p)\n                'if true Add a new slide here for the next iteration            \n                End With\n\n                oPPTFile.Slides(SlideNum).Select\n                Set oPPTShape = oPPTFile.Slides(SlideNum).Shapes(\"Table 1\")\n                With oPPTShape.Table\n                .cell(2, 1).Shape.TextFrame.TextRange.text = arrThema(p + 1, 1)\n                .cell(3, 2).Shape.TextFrame.TextRange.text = Beschreibung(p + 1)\n                'if true Adda new slide here for the next iteration\n\n                End With\n\n               ' MsgBox \"Description : \" &amp; Beschreibung(p)\n                End If\n\n\n                Else\n\n\n                'add a new slide here and add the details there\n                With oPPTShape.Table\n                .cell(1, 1).Shape.TextFrame.TextRange.text = arrThema(p, 0)\n                .cell(2, 1).Shape.TextFrame.TextRange.text = arrThema(p, 1)\n                .cell(3, 2).Shape.TextFrame.TextRange.text = Beschreibung(p)\n\n    'if true Adda new slide here for the next iteration\n\n                    'code for adding a new slide which does not work\n                Set pptLayout = ActivePresentation.Slides(1).CustomLayout\n               Set pptSlide = ActivePresentation.Slides.AddSlide(2, pptLayout)\n\n                End With\n\n\n\n            End If\n            p = p + 1\n           Loop Until p = noThema\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "edited": false, "score": 1, "creation_date": 1460535441, "post_id": 36592181, "comment_id": 60782171, "body": "I&#39;d define data = Range(Cells(2,1), Cells(2, 1).Resize(rowCount, columnCount))"}, {"owner": {"reputation": 181, "user_id": 5972291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ac34cf44a2368c6f0203c078ea24031a?s=128&d=identicon&r=PG", "display_name": "J.H", "link": "https://stackoverflow.com/users/5972291/j-h"}, "edited": false, "score": 0, "creation_date": 1460536234, "post_id": 36592181, "comment_id": 60782695, "body": "Interesting, could you explain the difference in doing so? Also would it be affected by removing the .Value?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "edited": false, "score": 0, "creation_date": 1460536633, "post_id": 36592181, "comment_id": 60782975, "body": "Well your example should work fine with data = Cells(2, 1).Resize(rowCount, columnCount).Value for defining a variant array of data minus row 1 headers. That&#39;s exactly what data = Range(Cells(2,1), Cells(2, 1).Resize(rowCount, columnCount)) would do also if you called data.Value. Both the same thing, one&#39;s a variant array the other&#39;s a range, personal preference but back to the original point - I do believe if you&#39;re after data without the headers it should start from (2,1) = (row,col)"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1460536857, "post_id": 36592181, "comment_id": 60783131, "body": "FWIW, if you start from row 2, you want to subtract 1 from <code>rowCount</code> when resizing."}, {"owner": {"reputation": 181, "user_id": 5972291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ac34cf44a2368c6f0203c078ea24031a?s=128&d=identicon&r=PG", "display_name": "J.H", "link": "https://stackoverflow.com/users/5972291/j-h"}, "edited": false, "score": 0, "creation_date": 1460602950, "post_id": 36592181, "comment_id": 60822956, "body": "@Will, thanks but defiing a variant array here is actually very important to the purpose of the entire code (huuuuge amounts of uniform data manipulation). I probably should have specified that."}, {"owner": {"reputation": 181, "user_id": 5972291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ac34cf44a2368c6f0203c078ea24031a?s=128&d=identicon&r=PG", "display_name": "J.H", "link": "https://stackoverflow.com/users/5972291/j-h"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1460602976, "post_id": 36592181, "comment_id": 60822964, "body": "@Rory, I&#39;m still on my first cup of coffee today, so can&#39;t really connect the dots.. But I&#39;m guessing that is where that 1 row went. Thanks!"}], "owner": {"reputation": 181, "user_id": 5972291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ac34cf44a2368c6f0203c078ea24031a?s=128&d=identicon&r=PG", "display_name": "J.H", "link": "https://stackoverflow.com/users/5972291/j-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460535147, "creation_date": 1460534547, "last_edit_date": 1460535147, "question_id": 36592181, "link": "https://stackoverflow.com/questions/36592181/setting-ranges-for-array-keeps-skipping-first-row", "title": "Setting ranges for array, keeps skipping first row?", "body": "<p>Nothing wrong with the functionality of the code. Just something I don't quite understand. when defining 'data', I start at <code>Cell(1, 1)</code>, which is supposed to be A1 right? I don't want it to start at A1, I want it from A2 (Because headers). How come I can only get the first row of data AKA A2:A* when using <code>Cells(1, 1)</code>? Shouldn't it be <code>Cells(2, 1)</code>?</p>\n\n<pre><code>Dim rowCount As Integer\nDim columnCount As Integer\nDim mainsht As Worksheet\n\nSet mainsht = Worksheets(\"DATA\")\n'So array size will dynamically change with updates\nrowCount = mainsht.Range(\"A1048576\").End(xlUp).Row\ncolumnCount = mainsht.Range(\"XFD1\").End(xlToLeft).Column\n\n' load the headers and data to an array '\nheaders = Cells(1, 1).Resize(1, columnCount).Value\ndata = Cells(1, 1).Resize(rowCount, columnCount).Value\n</code></pre>\n"}, {"tags": ["excel", "macros", "vba"], "answers": [{"tags": [], "owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "is_accepted": false, "score": 0, "last_activity_date": 1460534375, "creation_date": 1460534375, "answer_id": 36592100, "question_id": 36591800, "link": "https://stackoverflow.com/questions/36591800/macro-to-insert-image-filename-into-a-cell/36592100#36592100", "title": "Macro to insert image filename into a cell", "body": "<p>I'm assuming your picture filename variable is fName, and that you already have the path of your picture file as a variable also (let's assume it's called pName):</p>\n\n<hr>\n\n<p>To insert the filename into a cell you could use (but are not limited to)</p>\n\n<pre><code>ThisWorkbook.Sheets(\"SheetName\").Range(\"A1\").Value = fName\n</code></pre>\n\n<p>or </p>\n\n<pre><code>ActiveSheet.Range(\"A1\").Value = fName\n</code></pre>\n\n<hr>\n\n<p>To insert a link to the file, you could insert a hyperlink formula such as</p>\n\n<pre><code>ActiveSheet.Range(\"A1\").Formula = \"=HYPERLINK(\"\"\" &amp; pName &amp; fName &amp; \"\")\"\n</code></pre>\n\n<hr>\n\n<p>As for the target, you could use an IF statement to ensure target is within the required range of cells:</p>\n\n<pre><code> If Target.Column = 4 And Target.Row &lt;= 10 Then\n\n    '// Your code here\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6191949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b21623503784017030bef219a4a5fe5?s=128&d=identicon&r=PG&f=1", "display_name": "Anibal", "link": "https://stackoverflow.com/users/6191949/anibal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 772, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1460547485, "creation_date": 1460533528, "last_edit_date": 1531161705, "question_id": 36591800, "link": "https://stackoverflow.com/questions/36591800/macro-to-insert-image-filename-into-a-cell", "title": "Macro to insert image filename into a cell", "body": "<p>I've used this code and I need some help to add two features:</p>\n\n<ol>\n<li>Insert the pic name in a cell when picture selected</li>\n<li>Create a link to a folder where this image followed by /picname.jpg</li>\n</ol>\n\n<p>Is this possible?\nOther thing is to use this in a range of cells\nI've tried something like</p>\n\n<pre><code>  If Target = \"$D$1:$D$10\" Then\n</code></pre>\n\n<p>But don't works..</p>\n\n<p>I would really appreciate some help.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Address = \"$D$1\" Or Target.Address = \"$D$2\" Then\n        fName = Application.GetOpenFilename(\"Picture files (*.jpg;*.gif;*.bmp;*.tif), *.jpgs;*.gif;*.bmp;*.tif\", , _\n\"Select picture to insert\")\n        If fName = \"False\" Then Exit Sub\n        ActiveSheet.Pictures.Insert(fName).Select\n        With Selection.ShapeRange\n            .LockAspectRatio = msoFalse\n            .Height = ActiveCell.Height\n            .Width = ActiveCell.Width\n            .Top = ActiveCell.Top\n            .Left = ActiveCell.Left\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1460534839, "post_id": 36591717, "comment_id": 60781790, "body": "If ArrayX is actually an array, you can&#39;t. If it&#39;s a <code>Range</code>, construct another <code>Range</code> from desired cells."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6197278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12f53524a065239e0f2ad4c8dfac173e?s=128&d=identicon&r=PG&f=1", "display_name": "LYang", "link": "https://stackoverflow.com/users/6197278/lyang"}, "edited": false, "score": 0, "creation_date": 1460691125, "post_id": 36593179, "comment_id": 60870410, "body": "Thanks for responding. It works when the inputs for row() are actual numbers, but when they are variables, I get the Run-time error 1004: Unable to get the Average property of the WorksheetFunction class. For instance, row(12:24) works, but row(m:n), where m = 12, n = 24, does not. In my code, m and n are determined via the Count function. Anyway round this? Thanks again!"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 63, "user_id": 6197278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12f53524a065239e0f2ad4c8dfac173e?s=128&d=identicon&r=PG&f=1", "display_name": "LYang", "link": "https://stackoverflow.com/users/6197278/lyang"}, "edited": false, "score": 0, "creation_date": 1460757766, "post_id": 36593179, "comment_id": 60907987, "body": "Use <code>Evaluate(&quot;ROW(&quot; &amp; m &amp; &quot;:&quot; &amp; n &amp; &quot;)&quot;)</code>"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1460537387, "creation_date": 1460537387, "answer_id": 36593179, "question_id": 36591717, "link": "https://stackoverflow.com/questions/36591717/how-to-use-index-function-in-vba-to-a-dynamic-range/36593179#36593179", "title": "How to use index function in VBA to a dynamic range", "body": "<p>You can use <code>Application.Index</code> to extract subsets of your array by passing an array of row and column numbers:</p>\n\n<pre><code>x = WorksheetFunction.Average(Application.Index(ArrayX, [row(20:32)], Array(1, 2, 3)))\n</code></pre>\n\n<p>Note that <code>WorksheetFunction.Index</code> will not work for this, you must use <code>Application.Index</code>. Also, there is a limit of 65536 'rows' for your array.</p>\n"}], "owner": {"reputation": 63, "user_id": 6197278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12f53524a065239e0f2ad4c8dfac173e?s=128&d=identicon&r=PG&f=1", "display_name": "LYang", "link": "https://stackoverflow.com/users/6197278/lyang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1094, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460538371, "creation_date": 1460533303, "last_edit_date": 1460538371, "question_id": 36591717, "link": "https://stackoverflow.com/questions/36591717/how-to-use-index-function-in-vba-to-a-dynamic-range", "title": "How to use index function in VBA to a dynamic range", "body": "<p>I got a <code>n x m data array</code> and I'm trying to compute the average value of a subset of that array without using a loop. </p>\n\n<p>In excel, I can use for example:</p>\n\n<pre><code>x = AVERAGE(INDEX(A1:A100,20,1):INDEX(A1:A100,50,3))\n</code></pre>\n\n<p>But not sure how to convert this into VBA. The following will give me an error:</p>\n\n<pre><code>x = Worksheetfunction.Average(Worksheetfunction.Index(ArrayX,20,1):Worksheetfunction.Index(ArrayX,50,3))\n</code></pre>\n\n<p>I'm assuming I cannot just use <code>\":\"</code> in between the functions. How can I get around it? Appreciate the help!</p>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1460535661, "post_id": 36591550, "comment_id": 60782331, "body": "The code works OK, and extracts: <i>&quot; APOS TCDE&quot;</i>. You have to describe in greater detail what the exact problem is. The screenshots do not show what is the currently executed line (marked in yellow during debugging)."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "is_accepted": false, "score": 0, "last_activity_date": 1460535941, "creation_date": 1460535941, "answer_id": 36592639, "question_id": 36591550, "link": "https://stackoverflow.com/questions/36591550/vba-outlook-error-when-stripping-email-body/36592639#36592639", "title": "VBA outlook error when stripping email body", "body": "<pre><code>postcode = Trim$(Mid$(b4, 8 + Len(\"Enquiry:\" &amp; vbNewLine), Len(b4)))\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 6143759, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c74efd2a64ada6407dcc5af0d13a0340?s=128&d=identicon&r=PG&f=1", "display_name": "G.Smith", "link": "https://stackoverflow.com/users/6143759/g-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1460535941, "creation_date": 1460532847, "question_id": 36591550, "link": "https://stackoverflow.com/questions/36591550/vba-outlook-error-when-stripping-email-body", "title": "VBA outlook error when stripping email body", "body": "<p>I'm using a VBA script to strip the body of an email, i have successfully stripped 90% of the email, but when i get to the final \"Enquiry\" part i am having an error i cannot fix. This is the email body.</p>\n\n<pre><code>Ref: 1993\nBusiness Headline: bla bka\nName: A Name\nEmail: email@email.com\nTel: 0777777777\n\nAddress Line: 123\nAddress Line 2: someroad\nTown: sometown\nCounty: lancashire\nPostcode: APOS TCDE\n\nEnquiry:\nPlease send me more information about this business. Regards, Gary.\n</code></pre>\n\n<p>The problem is at postcode when it is trying to find Enquiry. In my code it seems to find the position of Enquiry but doesnt assign the integer to the variable. Please see screenshots to see what i mean.</p>\n\n<p><a href=\"http://i.stack.imgur.com/vGxEd.png\" rel=\"nofollow\">finds correct positon</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/l0zfr.png\" rel=\"nofollow\">The variable is just staying at 0</a></p>\n\n<p>This is the postcode stripping code :</p>\n\n<pre><code>Dim pstcodee As Integer\n            pstcodee = InStr(1, b4, \"Postcode: \")\n\n        Dim enqui As Integer\n            enqui = InStr(1, b4, \"Enquiry:\")\n\n        Dim pstenquire As String\n             pstenquire = Mid(b4, pstcodee, enqui - pstcodee)\n\n        Dim bup2222() As String\n        bup2222 = Split(pstenquire, \":\")\n\n        postcode = bup2222(1)\n</code></pre>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1460535306, "post_id": 36591427, "comment_id": 60782083, "body": "Have you tried the A-&gt;Z tool in Format Text, Paragraph?"}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1460536647, "post_id": 36591427, "comment_id": 60782991, "body": "hi, it doesn&#39;t put the paragraph where it should that is why i want to make it with vba."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1460537689, "post_id": 36591427, "comment_id": 60783721, "body": "Then you need to click the <a href=\"https://stackoverflow.com/posts/36591427/edit\">edit</a> link below the question and add more details: describe what you mean by &quot;doesn&#39;t put the paragraph where it should&quot;. You also need to specify whether these are &quot;plain text&quot; numbers or autonumbering."}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1461835136, "post_id": 36814534, "comment_id": 61383164, "body": "Thank you, it does the job."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 1, "last_activity_date": 1461434787, "creation_date": 1461434787, "answer_id": 36814534, "question_id": 36591427, "link": "https://stackoverflow.com/questions/36591427/replace-numbers-in-email-body/36814534#36814534", "title": "Replace numbers in email body", "body": "<p>Your request is very vage. This is due to the fact that you want to parse a string which you haven't properly \"defined\". The missing pieces are:</p>\n\n<p>(1) What makes a line a line in your string? Are they separated with a line break such as <code>vbCrLf</code> or are you using <code>Chr(10)</code> or anything else instead? Can it be all of them interchangeably?</p>\n\n<p>(2) How do you want to tell VBA that a list starts and that a list ends? Is it that there is a number as the first character in a line? What if a line starts with a number due to other reasons or if someone put a space before that number such as <code>2. some thing to be done</code>. Then the first character would be a space and not a number. Especially, if your list surpasses 10 items it might be that the first 9 number will be written as <code>1.</code> (with a leading space).</p>\n\n<p>(3) Once the list is completed no more list items should be generated and the list should be marked \"closed\". How do you define this? Is it that there were lines starting with a number before and that the next line does not start with a number anymore? But that would also mean that nobody can use a <code>Return</code> within any of the line items (because the description of what should be done is getting too long).</p>\n\n<p>Since none of the above is included in your question, a reader might come to the conclusion that you haven't really fully understood the problem yet. I guess that explains also the comment by @CindyMeister.</p>\n\n<p>Still, I had a little bit of a spare time and gave it some thought and came up with the following small sub:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub HTML_List()\n\nDim lngRow As Long\nDim lngChar As Long\nDim strTmp() As String\nDim strHTMLbody As String\nDim bolListStart As Boolean\n\nstrHTMLbody = \"Hello,  \" &amp; vbCrLf\nstrHTMLbody = strHTMLbody &amp; \" \" &amp; vbCrLf\nstrHTMLbody = strHTMLbody &amp; \"6. some thing to be done \" &amp; vbCrLf\nstrHTMLbody = strHTMLbody &amp; \"5. some thing to be done \" &amp; vbCrLf\nstrHTMLbody = strHTMLbody &amp; \"4. some thing to be done \" &amp; vbCrLf\nstrHTMLbody = strHTMLbody &amp; \"3. some thing to be done \" &amp; vbCrLf\nstrHTMLbody = strHTMLbody &amp; \"2. some thing to be done \" &amp; vbCrLf\nstrHTMLbody = strHTMLbody &amp; \"1. some thing to be done \" &amp; vbCrLf\nstrHTMLbody = strHTMLbody &amp; \" \" &amp; vbCrLf\nstrHTMLbody = strHTMLbody &amp; \"Have a nice day. \"\n\nstrTmp() = Split(strHTMLbody, vbCrLf)\n\nFor lngRow = LBound(strTmp) To UBound(strTmp)\n    strTmp(lngRow) = Trim(strTmp(lngRow))\n    If strTmp(lngRow) &lt;&gt; vbNullString Then\n        Select Case Asc(strTmp(lngRow))\n        Case 48 To 57\n            strTmp(lngRow) = Mid(strTmp(lngRow), InStr(1, strTmp(lngRow), \".\", vbTextCompare) + 1)\n            strTmp(lngRow) = \"&lt;li&gt;\" &amp; strTmp(lngRow) &amp; \"&lt;/li&gt;\"\n            If bolListStart = False Then\n                strTmp(lngRow) = \"&lt;ol&gt;\" &amp; strTmp(lngRow)\n                bolListStart = True\n            End If\n        Case Else\n            If bolListStart = True Then\n                bolListStart = False\n                strTmp(lngRow - 1) = strTmp(lngRow - 1) &amp; \"&lt;/ol&gt;\"\n            End If\n        End Select\n    End If\nNext lngRow\n\nstrHTMLbody = \"\"\nFor lngRow = LBound(strTmp) To UBound(strTmp)\n    strHTMLbody = strHTMLbody &amp; strTmp(lngRow) &amp; vbCrLf\nNext lngRow\n\nDebug.Print strHTMLbody\n\nEnd Sub\n</code></pre>\n\n<p>So, the basic steps behind the sub are the following:</p>\n\n<ol>\n<li>Split the initial string by <code>vbCrLf</code> (hopefully that makes a line a line).</li>\n<li>Check if the first character in that line is a number.</li>\n<li>With the first occurence of the above a list will be started. In HTML a list is started with <code>&lt;ol&gt;</code>.</li>\n<li>Remove the number from that line and rather tell HTML that this is a list item. That's tagged with a <code>&lt;li&gt;</code> at the start of a list item and a <code>&lt;/li&gt;</code> at the end of that line item.</li>\n<li>Once, a line does not start anymore with a number, the list is closed in HTML with <code>&lt;/ol&gt;</code>.</li>\n<li>Bring all the lines together again into one HTML string.</li>\n</ol>\n\n<p>If you use then this string in an Outlook email as <code>.HTMLbody</code> then HTML will automatically format your list and number the line items accordingly.</p>\n\n<p>As a result of the above code you will get the following in return:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Hello,\r\n\r\n&lt;ol&gt;&lt;li&gt; some thing to be done&lt;/li&gt;\r\n&lt;li&gt; some thing to be done&lt;/li&gt;\r\n&lt;li&gt; some thing to be done&lt;/li&gt;\r\n&lt;li&gt; some thing to be done&lt;/li&gt;\r\n&lt;li&gt; some thing to be done&lt;/li&gt;\r\n&lt;li&gt; some thing to be done&lt;/li&gt;\r\n&lt;/ol&gt;\r\nHave a nice day.</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I hope that helps. Let me know if you have any questions.</p>\n"}], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 2, "accepted_answer_id": 36814534, "answer_count": 1, "score": 0, "last_activity_date": 1461434787, "creation_date": 1460532428, "last_edit_date": 1460704810, "question_id": 36591427, "link": "https://stackoverflow.com/questions/36591427/replace-numbers-in-email-body", "title": "Replace numbers in email body", "body": "<p>i have some numbers with point after them in emails. The problem is that they are descending in the email:  6. 5. 4. 3. 2. 1.    - first after hello is  6. 5. 4. 3. 2. 1.  But not always, sometimes are just 3 or 4 or 2 of them:   2. 1.   or   4. 3. 2. 1.     Is there a way to order them ascending after hello:   1. 2. 3. 4. 5. 6.  via vba ? The text is plain text numbers and are only 6 numbers with point after them in the email. The numbers are not auto generated.  </p>\n\n<p>ex:</p>\n\n<pre><code>Hello, \n\n6. some thing to be done\n5. some thing to be done\n4. some thing to be done\n3. some thing to be done\n2. some thing to be done\n1. some thing to be done\n\nHave a nice day.\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Hello, \n\n4. some thing to be done\n3. some thing to be done\n2. some thing to be done\n1. some thing to be done\n\nHave a nice day.\n</code></pre>\n\n<p>The auto paragraph is not working :</p>\n\n<pre><code>   * Hello, \n   * \n    4. some thing to be done\n    3. some thing to be done\n    2. some thing to be done\n    1. some thing to be done\n   * \n   * Have a nice day.\n</code></pre>\n\n<p>i have tried this but it doesn't work.</p>\n\n<pre><code>With objItem.Content.Find\n    .Text = \"6.\"\n    .Forward = True\n    .Execute\n\n    If .Found = True Then\n    objItem.HTMLBody = Replace(objItem.HTMLBody, \"6.\", \"1.\")\n    objItem.HTMLBody = Replace(objItem.HTMLBody, \"5.\", \"2.\")\n    objItem.HTMLBody = Replace(objItem.HTMLBody, \"4.\", \"3.\")\n    objItem.HTMLBody = Replace(objItem.HTMLBody, \"3.\", \"4.\")\n    objItem.HTMLBody = Replace(objItem.HTMLBody, \"2.\", \"5.\")\n    objItem.HTMLBody = Replace(objItem.HTMLBody, \"1.\", \"6.\")\n\n    Else\n\n    With objItem.Content.Find\n    .Text = \"5.\"\n    .Forward = True\n    .Execute\n\n    If .Found = True Then\n    objItem.HTMLBody = Replace(objItem.HTMLBody, \"5.\", \"1.\")\n    objItem.HTMLBody = Replace(objItem.HTMLBody, \"4.\", \"2.\")\n    objItem.HTMLBody = Replace(objItem.HTMLBody, \"2.\", \"4.\")\n    objItem.HTMLBody = Replace(objItem.HTMLBody, \"1.\", \"5.\")\n\n    'Else...\n\n    End With\n\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 5532589, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/QI0o9.jpg?s=128&g=1", "display_name": "Neelesh", "link": "https://stackoverflow.com/users/5532589/neelesh"}, "edited": false, "score": 0, "creation_date": 1460538937, "post_id": 36592641, "comment_id": 60784582, "body": "Thanks @Darren, String was missing"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1460535945, "creation_date": 1460535945, "answer_id": 36592641, "question_id": 36591255, "link": "https://stackoverflow.com/questions/36591255/r1c1-array-formula-based-on-row-count/36592641#36592641", "title": "R1C1 array formula based on Row Count", "body": "<p>You need to insert the variable name into the string - not so that it's part of the string, but rather its value is.</p>\n\n<p>Whereever you want to replace <code>591</code> with <code>L</code> break out of the string text using <code>\"</code>, add your variable <code>&amp; L &amp;</code> and then step back into the string with another <code>\"</code>.</p>\n\n<p>So <code>...Source!R1C3:R\" &amp; L &amp; \"C3....</code></p>\n"}], "owner": {"reputation": 138, "user_id": 5532589, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/QI0o9.jpg?s=128&g=1", "display_name": "Neelesh", "link": "https://stackoverflow.com/users/5532589/neelesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "closed_date": 1460750753, "accepted_answer_id": 36592641, "answer_count": 1, "score": -1, "last_activity_date": 1460537226, "creation_date": 1460532016, "last_edit_date": 1460537226, "question_id": 36591255, "link": "https://stackoverflow.com/questions/36591255/r1c1-array-formula-based-on-row-count", "closed_reason": "Needs details or clarity", "title": "R1C1 array formula based on Row Count", "body": "<pre><code>ws.Range(\"E1\").FormulaArray = \"=IF(ISNA(INDEX(Source!R1C3:R591C3,MATCH(Components!RC3,IF(Source!R1C1:R591C1=Components!R25C,Source!R1C2:R591C2),0))),0,1)\"\n</code></pre>\n\n<p>I have this, how do I change the dynamic reference 591 to L?</p>\n\n<pre><code>L = ws2.Cells(Rows.Count, 1).End(xlUp).Row\n</code></pre>\n"}, {"tags": ["excel", "vba", "hyperlink"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5856464, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XarWDpTz1Ww/AAAAAAAAAAI/AAAAAAAAAJQ/pTrlEJ8y8Ic/photo.jpg?sz=128", "display_name": "Alejandro Salido", "link": "https://stackoverflow.com/users/5856464/alejandro-salido"}, "edited": false, "score": 0, "creation_date": 1460541447, "post_id": 36592806, "comment_id": 60786581, "body": "Could you tell me if this is quicker/better than an usual &#39;if then&#39; instructions? If so, I am going to start to start using it more often."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "reply_to_user": {"reputation": 5, "user_id": 5856464, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XarWDpTz1Ww/AAAAAAAAAAI/AAAAAAAAAJQ/pTrlEJ8y8Ic/photo.jpg?sz=128", "display_name": "Alejandro Salido", "link": "https://stackoverflow.com/users/5856464/alejandro-salido"}, "edited": false, "score": 0, "creation_date": 1460543234, "post_id": 36592806, "comment_id": 60787908, "body": "Don&#39;t know about quicker, the difference if any would be small I imagine, but I reckon it&#39;s easier to read/debug."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6028892"}, "is_accepted": true, "score": 0, "last_activity_date": 1460536387, "creation_date": 1460536387, "answer_id": 36592806, "question_id": 36591192, "link": "https://stackoverflow.com/questions/36591192/vba-generating-and-modifying-links/36592806#36592806", "title": "VBA Generating and modifying links", "body": "<p>You couldn't do something like this instead - based on the cell's value?</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n\n    If Target.Range.Column = 12 Then    'is column L\n        With Target.Range\n            Select Case .Value\n                Case \"Clear\"\n                    'Clear button function\n                Case \"Generate\"\n                    'Generate button function\n                Case \"Calculate\"\n                    'Calculate button function\n                Case \"Publish\"\n                    'Publish PDF button function\n            End Select\n            Exit Sub\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5856464, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XarWDpTz1Ww/AAAAAAAAAAI/AAAAAAAAAJQ/pTrlEJ8y8Ic/photo.jpg?sz=128", "display_name": "Alejandro Salido", "link": "https://stackoverflow.com/users/5856464/alejandro-salido"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 36592806, "answer_count": 1, "score": 0, "last_activity_date": 1460536387, "creation_date": 1460531869, "question_id": 36591192, "link": "https://stackoverflow.com/questions/36591192/vba-generating-and-modifying-links", "title": "VBA Generating and modifying links", "body": "<p>I have a Excel form which has 4 steps launched by links instead of buttons (I try to avoid them), these are 'Clear', 'Generate', 'Calculate' and 'Publish PDF'.</p>\n\n<p>I call those links through:</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink) \nIf Target.Range.Address = \"$L$13\" Then\n'Function\n</code></pre>\n\n<p>And so on. Where \"$L$13\" is the cell address where the first link is placed. Every link calls for its own cell address. Right now the code for this is a 'if...else if' loop for 4 premises (one per step).</p>\n\n<p>'Clear' function is clear (this joke was on me).</p>\n\n<p>'Generate' function copies and pastes a range of cells (the 'form') as many times as groups are indicated by the user. They are separated the same amount of rows. </p>\n\n<p>'Calculate' function performs some hand calculations according user's inputs. </p>\n\n<p>'Publish PDF' take the spreadsheet and print it in PDF.</p>\n\n<p>Well, I have been requested to have a 'Calculate' button (and also a 'publish PDF' but it doesn't matter now) for each generated 'form' to push users to calculate results once per group. </p>\n\n<p>Because it is a link, I can copy and paste the link with the rest of the form but I only got it to send the user to the original 'Calculate' button at the beginning of the sheet. The copied link keeps the subaddress of the original link (i.e. subaddress=L13)</p>\n\n<p>Is there any chance to keep using links for calling each step but having many 'Calculate' links to the same function?</p>\n\n<p>Thank you in advance.</p>\n\n<p>I leave it the main structure of the code:</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n\n'Comparing this with $L$13:$L$16\n\nIf Target.Range.Address = \"$L$13\" Then\n\n'Clear button function                \n\nExit Sub\n\nElseIf Target.Range.Address = \"$L$14\" Then\n\n'Generate button function\n\n    'Copying_the_template (k)\n\n        'This is an fail attempt to modify the link once it is pasted.\n\n        'Cells(Group_index + 5, 10).Select\n        'Selection.Hyperlinks(1).Address = Sheet3.Cells _\n        (Group_index + 5,10).Address\n        'ActiveSheet.Hyperlinks.Add , SubAddress:=Sheet3. _\n        Cells(Group_index + 5, 10)\n\nElseIf Target.Range.Address = \"$L$15\" Then\n\n'Calculate button function\n\n   Exit Sub\n\nElseIf Target.Range.Address = \"$L$16\" Then\n\n'Publish PDF button function\n\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 293, "user_id": 3799061, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6be43888ffbde83daf4bc285a84bde9?s=128&d=identicon&r=PG", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/3799061/prasanna"}, "edited": false, "score": 0, "creation_date": 1460532418, "post_id": 36591138, "comment_id": 60780192, "body": "Please provide proper background and state your question specifically. No one would be interested in understanding your code to provide you a solution. Follow this link on how to ask a good question <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 552, "user_id": 6046766, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a9801af62bcf72ae7979f12d7b6f2bce?s=128&d=identicon&r=PG&f=1", "display_name": "Davy C", "link": "https://stackoverflow.com/users/6046766/davy-c"}, "edited": false, "score": 0, "creation_date": 1460538869, "post_id": 36591138, "comment_id": 60784533, "body": "What are you trying to achieve? I can&#39;t make head nor tail of your code currently."}, {"owner": {"reputation": 185, "user_id": 5740588, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/894059147793c04945d6e2224318bbbd?s=128&d=identicon&r=PG", "display_name": "Ongok Ongoksepen", "link": "https://stackoverflow.com/users/5740588/ongok-ongoksepen"}, "edited": false, "score": 0, "creation_date": 1460542164, "post_id": 36591138, "comment_id": 60787132, "body": "it&#39;s a bit complicated to explain the goal of this macro, I need to share the spreadsheet.  basicly in the coding, there are 3 For statement, but I want to exit this &quot;For i = 4 To 145&quot; if Range(&quot;Negative&quot;) = 0 happen, then proceed to next For which is &quot;For Age = 0 To 100&quot;.   to make it simple, I have 3 for statement, and I want to exit 1 for statement if my &quot;IF&quot; statement is fulfilled"}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 5740588, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/894059147793c04945d6e2224318bbbd?s=128&d=identicon&r=PG", "display_name": "Ongok Ongoksepen", "link": "https://stackoverflow.com/users/5740588/ongok-ongoksepen"}, "edited": false, "score": 0, "creation_date": 1460542693, "post_id": 36595314, "comment_id": 60787520, "body": "really thanks, this can solved my problem, before i place the exit for after Then"}, {"owner": {"reputation": 185, "user_id": 5740588, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/894059147793c04945d6e2224318bbbd?s=128&d=identicon&r=PG", "display_name": "Ongok Ongoksepen", "link": "https://stackoverflow.com/users/5740588/ongok-ongoksepen"}, "edited": false, "score": 0, "creation_date": 1460543095, "post_id": 36595314, "comment_id": 60787803, "body": "If i want to make another condition to run <code>For i = 4 to 465</code> if the Cells (Age,12) = 0 , then where i need to add  <code>If Cells(Age,12).value = 0 Then</code> and <code>End If</code>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 185, "user_id": 5740588, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/894059147793c04945d6e2224318bbbd?s=128&d=identicon&r=PG", "display_name": "Ongok Ongoksepen", "link": "https://stackoverflow.com/users/5740588/ongok-ongoksepen"}, "edited": false, "score": 0, "creation_date": 1460543542, "post_id": 36595314, "comment_id": 60788180, "body": "do you mean something like <code>If Range(&quot;Negative&quot;) = 0 and Cells (Age,15) = 0 Then ...</code>. otherwise add more info. Finally: you may want to up-vote any answer you find useful, and mark as accepted the one that fulfilled your original question. thank you"}, {"owner": {"reputation": 185, "user_id": 5740588, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/894059147793c04945d6e2224318bbbd?s=128&d=identicon&r=PG", "display_name": "Ongok Ongoksepen", "link": "https://stackoverflow.com/users/5740588/ongok-ongoksepen"}, "edited": false, "score": 0, "creation_date": 1460544192, "post_id": 36595314, "comment_id": 60788651, "body": "Sorry, ignore the second comment, what I mean is If the <code>Cells (Age +4,12) &gt; 0</code>, then I want to run the whole macro. so where I need to put this if statement?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 185, "user_id": 5740588, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/894059147793c04945d6e2224318bbbd?s=128&d=identicon&r=PG", "display_name": "Ongok Ongoksepen", "link": "https://stackoverflow.com/users/5740588/ongok-ongoksepen"}, "edited": false, "score": 0, "creation_date": 1460545953, "post_id": 36595314, "comment_id": 60789909, "body": "see edited answer. If the <i>original</i> question is fulfilled you may want to mark it as accepted"}, {"owner": {"reputation": 185, "user_id": 5740588, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/894059147793c04945d6e2224318bbbd?s=128&d=identicon&r=PG", "display_name": "Ongok Ongoksepen", "link": "https://stackoverflow.com/users/5740588/ongok-ongoksepen"}, "edited": false, "score": 0, "creation_date": 1460547467, "post_id": 36595314, "comment_id": 60790992, "body": "Can we put the <code>if Cells(Age + 4, 12) &gt; 0 Then</code> after <code>For Age = 0 To 100</code>, because I want the macro to enter the statement for Age then check the if condition?"}, {"owner": {"reputation": 185, "user_id": 5740588, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/894059147793c04945d6e2224318bbbd?s=128&d=identicon&r=PG", "display_name": "Ongok Ongoksepen", "link": "https://stackoverflow.com/users/5740588/ongok-ongoksepen"}, "edited": false, "score": 0, "creation_date": 1460547567, "post_id": 36595314, "comment_id": 60791079, "body": "I think we cant move the <code>If Cells(Age + 4, 12) &gt; 0 Then</code> after the for statement,"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1460545852, "last_edit_date": 1460545852, "creation_date": 1460542528, "answer_id": 36595314, "question_id": 36591138, "link": "https://stackoverflow.com/questions/36591138/looping-vba-excel/36595314#36595314", "title": "Looping vba excel", "body": "<p><strong>edited</strong> after OP's clarifications</p>\n\n<pre><code>Option Explicit\n\nSub Correction()\n\nDim i As Integer, Sex As Integer, Age As Integer\n\nIf Cells(Age + 4, 12) &gt; 0 Then\n\n    For Sex = 1 To 2\n        For Age = 0 To 100\n\n            Range(\"Test1\") = Sex\n            Range(\"Test2\") = Age\n\n            For i = 4 To 145\n\n                Sheets(\"Input\").Cells(i, 10).Copy\n                Range(\"Amount\").PasteSpecial Paste:=xlValues\n\n                If Range(\"Negative\") = 0 Then\n\n                    Sheets(\"Input\").Cells(i, 13).Copy\n                    Sheets(\"Input\").Cells(Age + 4, 14).PasteSpecial Paste:=xlValues\n\n                    Exit For  '&lt;== this will have you exit the current for loop\n\n                End If\n\n            Next i\n\n        Next Age\n    Nextsex\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I'd suggest to fully qualify the ranges you use. Since , as it is now:</p>\n\n<ul>\n<li><p><code>Cells(Age + 4, 12)</code>, <code>Range(\"Test1\")</code>, <code>Range(\"Test2\")</code>, <code>Range(\"Amount\")</code>, <code>Range(\"Negative\")</code> are all referring to the current active sheet, which may not be the one of interest</p></li>\n<li><p><code>Sheets(\"Input\").Cells(i, 10)</code>, <code>Sheets(\"Input\").Cells(Age + 4, 14)</code> are referring to the cells of a sheet named \"Input\" belonging to the current Active Workbook</p></li>\n</ul>\n\n<p>maybe what above will actually work for you, but it'd be not a robust nor easily maintainable solution</p>\n"}], "owner": {"reputation": 185, "user_id": 5740588, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/894059147793c04945d6e2224318bbbd?s=128&d=identicon&r=PG", "display_name": "Ongok Ongoksepen", "link": "https://stackoverflow.com/users/5740588/ongok-ongoksepen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 36595314, "answer_count": 1, "score": -2, "last_activity_date": 1460545852, "creation_date": 1460531673, "last_edit_date": 1460542096, "question_id": 36591138, "link": "https://stackoverflow.com/questions/36591138/looping-vba-excel", "title": "Looping vba excel", "body": "<pre><code>Sub Correction()\n\nDim i As Integer\n\nFor Sex = 1 To 2\nFor Age = 0 To 100\n\nRange(\"Test1\") = Sex\nRange(\"Test2\") = Age\n\nFor i = 4 To 145\n\nSheets(\"Input\").Cells(i, 10).Copy\nRange(\"Amount\").PasteSpecial Paste:=xlValues\n\nIf Range(\"Negative\") = 0 Then\n\nSheets(\"Input\").Cells(i, 13).Copy\nSheets(\"Input\").Cells(Age + 4, 14).PasteSpecial Paste:=xlValues\n\nEnd If\n\n\nNext\nNext\nNext\n\n\nEnd Sub\n</code></pre>\n\n<p>when I try to run the macro, For <code>Sex = 1</code> , <code>Age = 0</code>, let's say After the Macro found that <code>i = 10</code> make the <code>\"Negative\" = 0</code>, the macro still proceed to the next i. But i want the macro to proceed with the next Age after find the <code>\"Negative\" = 0</code> for specific age.</p>\n\n<p>Please kindly help me to fix this macro</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 14053, "user_id": 2577734, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/7ozwU.png?s=128&g=1", "display_name": "Joe Taras", "link": "https://stackoverflow.com/users/2577734/joe-taras"}, "edited": false, "score": 0, "creation_date": 1460529038, "post_id": 36590271, "comment_id": 60778304, "body": "Your table, Leaves, has data inside? Post a minimal set of data"}, {"owner": {"reputation": 33, "user_id": 6192744, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh6.googleusercontent.com/-_XHW2a6QCvU/AAAAAAAAAAI/AAAAAAAABNI/vDDPf8ZWAGU/photo.jpg?sz=128", "display_name": "Manouchehr Tizkhan", "link": "https://stackoverflow.com/users/6192744/manouchehr-tizkhan"}, "reply_to_user": {"reputation": 14053, "user_id": 2577734, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/7ozwU.png?s=128&g=1", "display_name": "Joe Taras", "link": "https://stackoverflow.com/users/2577734/joe-taras"}, "edited": false, "score": 0, "creation_date": 1460529546, "post_id": 36590271, "comment_id": 60778593, "body": "yes, we before use this code insert data to table"}, {"owner": {"reputation": 26453, "user_id": 2118383, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/JhgC9.jpg?s=128&g=1", "display_name": "Vignesh Kumar A", "link": "https://stackoverflow.com/users/2118383/vignesh-kumar-a"}, "edited": false, "score": 0, "creation_date": 1460529634, "post_id": 36590271, "comment_id": 60778646, "body": "Please run the query <code>SELECT Date FROM Leaves WHERE CodePersonali = &quot; &amp; Nz(Me.CodePersonali.Value) &amp; &quot;</code> and make sure data exist."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1460533750, "creation_date": 1460533750, "answer_id": 36591870, "question_id": 36590271, "link": "https://stackoverflow.com/questions/36590271/display-table-data-in-a-list-box-access-form/36591870#36591870", "title": "display table data in a list box (access form)", "body": "<p><code>Date</code> is a reserved word (it's a function), so you shouldn't use it as column name. If you must, put it between square brackets <code>[Date]</code>.</p>\n\n<p><strong>If</strong> <code>CodePersonali</code> is a text column, you need to put the value between <code>''</code>.</p>\n\n<p>That would be</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.List_history.RowSource = \"SELECT [Date] \" &amp; _\n  \"FROM Leaves \" &amp; _\n  \"WHERE CodePersonali = '\" &amp; Nz(Me.CodePersonali.Value) &amp; \"'\"\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6192744, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh6.googleusercontent.com/-_XHW2a6QCvU/AAAAAAAAAAI/AAAAAAAABNI/vDDPf8ZWAGU/photo.jpg?sz=128", "display_name": "Manouchehr Tizkhan", "link": "https://stackoverflow.com/users/6192744/manouchehr-tizkhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 1, "accepted_answer_id": 36591870, "answer_count": 1, "score": 0, "last_activity_date": 1460533891, "creation_date": 1460528824, "last_edit_date": 1460533891, "question_id": 36590271, "link": "https://stackoverflow.com/questions/36590271/display-table-data-in-a-list-box-access-form", "title": "display table data in a list box (access form)", "body": "<p>I want display table data in a list box with this code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.List_history.RowSource = \"SELECT Date \" &amp; _\n    \"FROM Leaves \" &amp; _\n    \"WHERE CodePersonali = \" &amp; Nz(Me.CodePersonali.Value)\n</code></pre>\n\n<p>but the list box doesn't display anything</p>\n\n<p><code>List_history</code> = my list box name</p>\n\n<p><code>Date</code> = field name in <code>leave</code> table</p>\n"}, {"tags": ["vba", "import", "permissions"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6222255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31430ea8151e516449f10524f2356a0c?s=128&d=identicon&r=PG", "display_name": "Siraj", "link": "https://stackoverflow.com/users/6222255/siraj"}, "is_accepted": false, "score": 0, "last_activity_date": 1461026377, "last_edit_date": 1461026377, "creation_date": 1461023217, "answer_id": 36706160, "question_id": 36589715, "link": "https://stackoverflow.com/questions/36589715/importing-csv-file-into-ms-access-using-docmd-transfertext-network-permissions/36706160#36706160", "title": "Importing csv file into ms access using DoCmd.TransferText network permissions", "body": "<p>Here is a solution. It creates a local mapped network drive of the network location, than it imports data as it would import from csv file in a local drive; when finished it removes the mapped drive.</p>\n\n<pre><code>Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\nSet wshNet = CreateObject(\"WScript.Network\")\n\nstrUsername = Domain\\username\n\nstrPassword = Password\n\nstrDestination = GetNextLetter(\"F\", wshNet)\n\nwshNet.MapNetworkDrive strDestination, \"\\\\ServerAddress\\Folder\", , strUsername, strPassword\n\nDoCmd.TransferText acImportDelim, , \"Daily_data\", strDestination &amp; \"\\RestOfThePathIncludingFileName\", True\n\nwshNet.RemoveNetworkDrive strDestination, True\n\nSet objFSO = Nothing\nSet wshNetwork = Nothing\n</code></pre>\n\n<p>This solution was done following from <a href=\"https://www.experts-exchange.com/questions/21108808/using-vba-to-copy-file-to-a-network-share-with-username-and-password.html\" rel=\"nofollow\">https://www.experts-exchange.com/questions/21108808/using-vba-to-copy-file-to-a-network-share-with-username-and-password.html</a></p>\n\n<pre><code>Function GetNextLetter(DriveLetter, wshNet)\n\n   'Start x at the ascii value of the drive letter to start the search\n   'unless something is passed in. This sample uses capital letters and\n   'starts at F.\n\n   If IsEmpty(DriveLetter) Then\n\n    x = 70\n\n   Else\n\n    x = Asc(DriveLetter)\n\n   End If   \n\n   Set oDrives = wshNet.EnumNetworkDrives\n   'Step by two since the first item in the collection is the drive letter\n   'and the second item is the network mapping\n\n   For i = 0 To oDrives.Count - 1 Step 2\n\n    If Chr(x) &amp; \":\" = oDrives.Item(i) Then\n\n        x = x + 1\n\n    End If\n\n   Next   \n\n   GetNextLetter = Chr(x) &amp; \":\"\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6196827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e99db51e305c0c87215f20735ff7d1?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hopley", "link": "https://stackoverflow.com/users/6196827/j-hopley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 677, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461026377, "creation_date": 1460526888, "question_id": 36589715, "link": "https://stackoverflow.com/questions/36589715/importing-csv-file-into-ms-access-using-docmd-transfertext-network-permissions", "title": "Importing csv file into ms access using DoCmd.TransferText network permissions", "body": "<p>I have a simple vba script to import a csv from a network share into a new table in my access database. I have access to the network share and it runs fine from my machine.  I want others who dont have access to the network share to be able to execute the script too. I have a generic network account with the required permissions and am hoping i can embed this into the script?</p>\n\n<p>I've had a look in this and other forums and MSDN and cant find how to do this, most seem to concern database and database connection permissions.</p>\n\n<p>Thankyou</p>\n\n<pre><code>Sub Import_data()\n\nDoCmd.SetWarnings False\nDoCmd.RunSQL \"DELETE * FROM Soil_moisture_data\"\nDoCmd.SetWarnings True\nDoCmd.TransferText acImportDelim, , \"Soil_moisture_data\", \"full network path and file\", True\nMsgBox \"Soil moisture data has been updated\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1460526883, "post_id": 36589616, "comment_id": 60777253, "body": "Why someone downvoted this question? It&#39;s properly formulated!"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1460527104, "post_id": 36589616, "comment_id": 60777342, "body": "I can&#39;t reproduce such of behaviour. What version of MS Excel? What&#39;s error message? Have you tried to export userform, delete it and import it again? Can you show your class definition?"}, {"owner": {"reputation": 71, "user_id": 5629383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5235e91e3cd4ec9979beea891bc5aa4a?s=128&d=identicon&r=PG", "display_name": "James Gray", "link": "https://stackoverflow.com/users/5629383/james-gray"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1460527472, "post_id": 36589616, "comment_id": 60777519, "body": "Excel 2013. There is no error message, it just fails to update the field and continues on as if nothing happened. Not tried export/import of the form, I&#39;m new to this so any suggestions will be appreciated."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1460530894, "post_id": 36589616, "comment_id": 60779332, "body": "<code>UserForms.Add(formName)</code> will <b>Add</b> the UserForm as a <b>new</b> UserForm to memory. It takes the UserForm from designer with properties and values provided in designer. It will <b>not</b> get an already shown UserForm."}, {"owner": {"reputation": 71, "user_id": 5629383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5235e91e3cd4ec9979beea891bc5aa4a?s=128&d=identicon&r=PG", "display_name": "James Gray", "link": "https://stackoverflow.com/users/5629383/james-gray"}, "edited": false, "score": 0, "creation_date": 1460536019, "post_id": 36589616, "comment_id": 60782559, "body": "Thanks Axel, that makes sense. Still haven&#39;t found how to get an already shown userform :("}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1460538308, "post_id": 36589616, "comment_id": 60784136, "body": "Please show how the UserForm will be shown. Why you can&#39;t assign the UserForm to a variable before it is shown (<code>formName = &quot;frmTest&quot; : Set oUserFOrm = UserForms.Add(formName)</code>) and then show it via <code>oUserFOrm.Show</code>?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1460566908, "post_id": 36589616, "comment_id": 60807001, "body": "We need to see a class definition to be able to reproduce your issue."}, {"owner": {"reputation": 71, "user_id": 5629383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5235e91e3cd4ec9979beea891bc5aa4a?s=128&d=identicon&r=PG", "display_name": "James Gray", "link": "https://stackoverflow.com/users/5629383/james-gray"}, "edited": false, "score": 0, "creation_date": 1460588897, "post_id": 36589616, "comment_id": 60818976, "body": "Axel, I think you have the answer. I was just getting excel to open the forms on file opening but if I do it as you suggest I&#39;ll have a handle on it to use. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5629383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5235e91e3cd4ec9979beea891bc5aa4a?s=128&d=identicon&r=PG", "display_name": "James Gray", "link": "https://stackoverflow.com/users/5629383/james-gray"}, "edited": false, "score": 0, "creation_date": 1460535891, "post_id": 36590909, "comment_id": 60782469, "body": "Using the form name directly works for me as well, it&#39;s when I&#39;m trying to get the form name out of a variable that it&#39;s not happening"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 71, "user_id": 5629383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5235e91e3cd4ec9979beea891bc5aa4a?s=128&d=identicon&r=PG", "display_name": "James Gray", "link": "https://stackoverflow.com/users/5629383/james-gray"}, "edited": false, "score": 0, "creation_date": 1460537710, "post_id": 36590909, "comment_id": 60783739, "body": "Ok. So the idea is to create a form and to manipulate a textbox in a userform which is just created? However, take a look at this answer here, probably you would find what you need:  <a href=\"http://stackoverflow.com/questions/11519345/creating-form-programmatically-in-the-module-using-vba\" title=\"creating form programmatically in the module using vba\">stackoverflow.com/questions/11519345/&hellip;</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1460532247, "last_edit_date": 1460532247, "creation_date": 1460530962, "answer_id": 36590909, "question_id": 36589616, "link": "https://stackoverflow.com/questions/36589616/vba-excel-update-control-on-a-dynamicaly-addressed-userform/36590909#36590909", "title": "VBA Excel - Update control on a dynamicaly addressed userform", "body": "<p>This is how I do it:</p>\n\n<pre><code>UserForm1.Controls(\"Textbox1\").Text = \"123\"\n</code></pre>\n\n<p>At least it works by me, when I am trying it. Office 2010.</p>\n"}], "owner": {"reputation": 71, "user_id": 5629383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5235e91e3cd4ec9979beea891bc5aa4a?s=128&d=identicon&r=PG", "display_name": "James Gray", "link": "https://stackoverflow.com/users/5629383/james-gray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1460532247, "creation_date": 1460526498, "last_edit_date": 1460529829, "question_id": 36589616, "link": "https://stackoverflow.com/questions/36589616/vba-excel-update-control-on-a-dynamicaly-addressed-userform", "title": "VBA Excel - Update control on a dynamicaly addressed userform", "body": "<p>I have a number of userforms with static controls on them. I have created a Class Module to apply event handlers to a set of texboxes I am dynamically adding to the userform. When I specifically address a userform from the Class Module I can update the value in the static controls...</p>\n\n<pre><code>IAFStep2c.Controls(\"chkOptIn\").Value = True\n</code></pre>\n\n<p>But when I try to update the controls with their userform's name in a variable it doesn't work...</p>\n\n<pre><code>Dim oUserFOrm As Object\nDim formName As String\nformName = \"IAFStep2c\"\nSet oUserFOrm = UserForms.Add(formName)\noUserFOrm.Controls(\"chkOptIn\").Value = True\n</code></pre>\n\n<p>I can read the value and other properties of the controls, just not update them. Can someone offer a solution to this?</p>\n\n<p>EDIT</p>\n\n<p>I created another spreadsheet with the class below, same result. TextBox1 and 3 get updated, textBox2 does not.</p>\n\n<pre><code>Sub doStuff()\n'MsgBox (\"ping\")\nDim oUserFOrm As Object\nDim formName As String\nformName = \"frmTest\"\nSet oUserFOrm = UserForms.Add(formName)\nfrmTest.Controls(\"TextBox1\").Value = oUserFOrm.Controls(\"TextBox2\").Name\noUserFOrm.Controls(\"TextBox2\").Value = \"PING\"\nfrmTest.Controls(\"TextBox3\").Value = oUserFOrm.Controls(\"TextBox2\").TextAlign\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "datetime", "date-format"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1460526299, "post_id": 36589381, "comment_id": 60776964, "body": "do you need the date and time or just date?"}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1460527606, "post_id": 36589381, "comment_id": 60777570, "body": "i just need the date.."}], "answers": [{"tags": [], "owner": {"reputation": 293, "user_id": 4332080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6fa3c0e479015639cee5e59c4d325b?s=128&d=identicon&r=PG", "display_name": "INOPIAE", "link": "https://stackoverflow.com/users/4332080/inopiae"}, "is_accepted": false, "score": 0, "last_activity_date": 1460527429, "creation_date": 1460527429, "answer_id": 36589871, "question_id": 36589381, "link": "https://stackoverflow.com/questions/36589381/date-information-in-a-format-excel-doesnt-recognize-as-a-date/36589871#36589871", "title": "Date information in a format Excel doesn&#39;t recognize as a Date", "body": "<p>Isn't the Date format within VBA #MM/DD/YYYY h:mm:ss.sss PM#?</p>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1460528427, "creation_date": 1460528427, "answer_id": 36590157, "question_id": 36589381, "link": "https://stackoverflow.com/questions/36589381/date-information-in-a-format-excel-doesnt-recognize-as-a-date/36590157#36590157", "title": "Date information in a format Excel doesn&#39;t recognize as a Date", "body": "<p>try this</p>\n\n<pre><code>Public Function stringtodate(mytext) As Date\n    str1 = Split(mytext, \" \")\n    str2 = UBound(str1)\n    If str2 &gt; 2 Then\n        If LCase(Left(str1(0), 3)) = \"mar\" Then\n            mon = \"03\"\n        End If\n        stringtodate = str1(1) &amp; \"-\" &amp; mon &amp; \"-\" &amp; str1(2)\n    Else\n        'not a valid date\n    End If\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/IwrzA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IwrzA.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1460529268, "post_id": 36590348, "comment_id": 60778444, "body": "If the syntax is the same, you can iterate over the data and apply the same algorithm."}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1460531555, "post_id": 36590348, "comment_id": 60779678, "body": "what if im going to use this method to remove 2 or 3 more columns? how can i do it?"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1460532085, "post_id": 36590348, "comment_id": 60779991, "body": "To iterate over several columns? Just define those columns as part of the range. <code>Set rng = Range(&quot;A1:C10&quot;)</code> and it will run the macro on all cells within that range."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1460532139, "post_id": 36590348, "comment_id": 60780029, "body": "Alteratively, you can define the macro to take a <code>Range</code> as argument and use a helper sub to run the macro several times on each individual range. This will be more useful if you aren&#39;t working with a contiguous range."}, {"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1460532401, "post_id": 36590348, "comment_id": 60780176, "body": "what i did is use another foor loop for the other column though it&#39;s feels like repetitive, column from H, K L, Z random columns..."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1460534055, "post_id": 36590348, "comment_id": 60781273, "body": "See updated answer for an example on how to do this. But we&#39;re venturing off-topic for this question. If you need help with iteration, you should post a new question."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1460711163, "post_id": 36590348, "comment_id": 60879355, "body": "Preface it with <code>If r.Value &lt;&gt; &quot;&quot;</code>"}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 1, "last_activity_date": 1460534022, "last_edit_date": 1460534022, "creation_date": 1460529100, "answer_id": 36590348, "question_id": 36589381, "link": "https://stackoverflow.com/questions/36589381/date-information-in-a-format-excel-doesnt-recognize-as-a-date/36590348#36590348", "title": "Date information in a format Excel doesn&#39;t recognize as a Date", "body": "<p>You mentioned in a comment that you need just the date:</p>\n\n<pre><code>Sub dateTest()\n    Dim d As Date\n    s = \"Mar 28 2016 4:55:54:380PM\"\n    s = Left(s, 11)\n    d = DateSerial(Year(s), Month(s), Day(s))\n    Debug.Print d\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>28.03.2016 </p>\n</blockquote>\n\n<p>To iterate over some dataset:</p>\n\n<pre><code>Sub dateIteration()\n    Dim d As Date, v As Variant\n    Dim rng As Range\n\n    Set rng = Range(\"A1:A10\")\n\n    For Each r In rng\n        v = Left(r.Value, 11)\n        d = DateSerial(Year(v), Month(v), Day(v))\n\n        ' Do something with d\n        ' Print it to worksheet, maybe?\n        r.Value = d\n    Next r\nEnd Sub\n</code></pre>\n\n<p>To iterate over non-contiguous ranges with minimal code clutter:</p>\n\n<pre><code>Sub helperSub()\n    Call dateIteration(Range(\"A1:A10\"))\n    Call dateIteration(Range(\"Z1:Z10\"))\n    Call dateIteration(Range(\"H1:M89\"))\nEnd Sub\n\nSub dateIteration(rng As Range)\n    Dim d As Date, v As Variant\n\n    For Each r In rng\n        v = Left(r.Value, 11)\n        d = DateSerial(Year(v), Month(v), Day(v))\n\n        ' Do something with d\n        ' Print it to worksheet, maybe?\n        r.Value = d\n    Next r\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1460537610, "last_edit_date": 1495535291, "creation_date": 1460537350, "answer_id": 36593162, "question_id": 36589381, "link": "https://stackoverflow.com/questions/36589381/date-information-in-a-format-excel-doesnt-recognize-as-a-date/36593162#36593162", "title": "Date information in a format Excel doesn&#39;t recognize as a Date", "body": "<p>Here is a 2 line code ;)</p>\n\n<p>I am assuming that the range is from <code>A1:A20</code>. Please amend as applicable</p>\n\n<pre><code>Sub Sample()\n    [A1:A20].NumberFormat = \"DD/MM/YYYY\"\n    [A1:A20] = [index(DATE(MID(A1:A20,8,4),MONTH(1&amp;LEFT(A1:A20,3)),MID(A1:A20,5,2)),)]\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/4XHkS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4XHkS.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you want to understand what this code does then see the explanation that I have given <a href=\"https://stackoverflow.com/questions/19985895/convert-an-entire-range-to-uppercase-without-looping-through-all-the-cells\">Here</a></p>\n"}], "owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 36590348, "answer_count": 4, "score": 1, "last_activity_date": 1460537610, "creation_date": 1460525477, "question_id": 36589381, "link": "https://stackoverflow.com/questions/36589381/date-information-in-a-format-excel-doesnt-recognize-as-a-date", "title": "Date information in a format Excel doesn&#39;t recognize as a Date", "body": "<p>I have a generated file coming from a system the date format of this file is like this <code>Mar 28 2016  4:55:54:380PM</code> my script in VBA doesn't recognize this as date or rather Excel doesn't recognize this as a date format but only a string. Is there other way around?</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1460547528, "post_id": 36589156, "comment_id": 60791047, "body": "The .ApplyChartTemplate method works when I use it to apply a pre-saved custom template to a chart on a slide so is it commented out because it&#39;s not doing anything or because it&#39;s throwing an error and if the later, which error?"}, {"owner": {"reputation": 13, "user_id": 6196731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150cc687aa3abdd2b42e146f71657f3c?s=128&d=identicon&r=PG&f=1", "display_name": "bounty252", "link": "https://stackoverflow.com/users/6196731/bounty252"}, "reply_to_user": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1460551385, "post_id": 36589156, "comment_id": 60794365, "body": "If I uncomment it out, I am receiving a &quot;Run-time error 445: Object doesn&#39;t support this action&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6196731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150cc687aa3abdd2b42e146f71657f3c?s=128&d=identicon&r=PG&f=1", "display_name": "bounty252", "link": "https://stackoverflow.com/users/6196731/bounty252"}, "edited": false, "score": 0, "creation_date": 1460842577, "post_id": 36597328, "comment_id": 60931588, "body": "Steve&#39;s answer directly solved my problem, but this delay function is also a fantastic idea. I was having some problems where the code failed about 20% of the time and this solved that."}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1460547800, "creation_date": 1460547800, "answer_id": 36597328, "question_id": 36589156, "link": "https://stackoverflow.com/questions/36589156/vba-how-to-apply-chart-template-after-pasting-excel-chart-into-powerpoint/36597328#36597328", "title": "VBA - how to apply Chart Template after pasting Excel chart into PowerPoint", "body": "<p>It may be a machine-dependant timing issue (pasting from the clipboard can result in the VBA code running ahead prior to the paste operation completing). Try calling this Delay sub immediately after the PasteSpecial line.</p>\n\n<pre><code>Delay 1, True\n\nPublic Sub Delay(Seconds As Single, Optional DoAppEvents As Boolean)\n  Dim TimeNow As Long\n  TimeNow = Timer\n  Do While Timer &lt; TimeNow + Seconds\n    If DoAppEvents = True Then DoEvents\n  Loop\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1460628598, "post_id": 36604058, "comment_id": 60835852, "body": "Doh. Didn&#39;t see that Steve! Where is the &quot;()(1)&quot; syntax documented btw? bounty52 : I would recommend using the expected object type in the variable declaration if at all possible as it would have pointed to an error on the &quot;Set myShape2&quot; line if myShape2 had been declared As PowerPoint.Shape instead of the generic Object type."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1460647281, "post_id": 36604058, "comment_id": 60850777, "body": "Documented.  Hmm.  I don&#39;t know that it is, but anything that returns a range can (and sometimes must) be treated like a collection, so if you need a member of a range rather than the entire range, you have to specify an index into the range.  And BTW, as long as you&#39;re doing early binding, I completely agree that myShape2 should be dimmed as PowerPoint.Shape rather than Object."}, {"owner": {"reputation": 13, "user_id": 6196731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150cc687aa3abdd2b42e146f71657f3c?s=128&d=identicon&r=PG&f=1", "display_name": "bounty252", "link": "https://stackoverflow.com/users/6196731/bounty252"}, "edited": false, "score": 0, "creation_date": 1460842504, "post_id": 36604058, "comment_id": 60931570, "body": "Sorry for the late response - this was absolutely the right answer though. Thanks! The explanation on why it works this way is also really helpful."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 0, "last_activity_date": 1460563930, "creation_date": 1460563930, "answer_id": 36604058, "question_id": 36589156, "link": "https://stackoverflow.com/questions/36589156/vba-how-to-apply-chart-template-after-pasting-excel-chart-into-powerpoint/36604058#36604058", "title": "VBA - how to apply Chart Template after pasting Excel chart into PowerPoint", "body": "<p>PasteSpecial returns a shaperange, not shape, but you need to apply a template to a single shape (ie, the chart object).  Try this instead:</p>\n\n<pre><code>Set myShape2 = firstSlide.Shapes.PasteSpecial()(1)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6196731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150cc687aa3abdd2b42e146f71657f3c?s=128&d=identicon&r=PG&f=1", "display_name": "bounty252", "link": "https://stackoverflow.com/users/6196731/bounty252"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1299, "favorite_count": 0, "accepted_answer_id": 36604058, "answer_count": 2, "score": 1, "last_activity_date": 1460563930, "creation_date": 1460524566, "last_edit_date": 1531164843, "question_id": 36589156, "link": "https://stackoverflow.com/questions/36589156/vba-how-to-apply-chart-template-after-pasting-excel-chart-into-powerpoint", "title": "VBA - how to apply Chart Template after pasting Excel chart into PowerPoint", "body": "<pre><code>Sub printDashboard()\n\n    Dim sheet1 As Excel.Worksheet\n    Set sheet1 = ActiveWorkbook.Sheets(\"PM Dashboard\")\n\n    Dim pptChart2 As Excel.ChartObject\n\n    'Open PowerPoint template\n    Dim sPath As String\n    sPath = ActiveWorkbook.Path\n    Dim pp As PowerPoint.Application, pps As PowerPoint.Presentation\n    Set pp = New PowerPoint.Application\n    pp.Visible = True\n    Set pps = pp.Presentations.Open(sPath &amp; \"\\template_Slides.pptx\")\n    Dim firstSlide As PowerPoint.Slide\n    Set firstSlide = pps.Slides(1)    \n\n    'Paste the second chart\n    Set pptChart2 = sheet1.ChartObjects(\"chartPM2\")\n    pptChart2.Copy\n    Dim myShape2 As Object\n    Set myShape2 = firstSlide.Shapes.PasteSpecial()\n    'myShape2.Chart.ApplyChartTemplate (sPath &amp; \"\\pipelineManagementChartFormat.crtx\")\n    With myShape2\n        .Top = 1.52 * 72\n        .Left = 5.33 * 72\n        .Width = 4.08 * 72\n        .Height = 2.6 * 72\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>So this code works perfectly in that it:</strong></p>\n\n<ul>\n<li>Correctly opens the PowerPoint file</li>\n<li>The Excel chart is pasted in and resized / repositioned</li>\n</ul>\n\n<p>However, I can not figure out how to apply a saved chart template that I have within the same directory. You can see that I have tried to accomplish this with the \"ApplyChartTemplate\" line that is commented out in the \"Paste Second Chart\" section.</p>\n\n<p>I would appreciate any help here. I have tried a number of different ways to apply the chart template after pasting it into the slide. I have not had any success with that yet.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5972291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ac34cf44a2368c6f0203c078ea24031a?s=128&d=identicon&r=PG", "display_name": "J.H", "link": "https://stackoverflow.com/users/5972291/j-h"}, "edited": false, "score": 0, "creation_date": 1460535838, "post_id": 36590495, "comment_id": 60782444, "body": "Thanks, although you forgot to declare the worksheet!  Unfortunately, this gives me the same issue as the title. The counter AKA &quot;i&quot; is not defined. I don&#39;t know what this means...  I do really like the starting from the bottom for the row method, eliminates the need for the +1. Great tip!"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 181, "user_id": 5972291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ac34cf44a2368c6f0203c078ea24031a?s=128&d=identicon&r=PG", "display_name": "J.H", "link": "https://stackoverflow.com/users/5972291/j-h"}, "edited": false, "score": 0, "creation_date": 1460541025, "post_id": 36590495, "comment_id": 60786256, "body": "@J.H, see the edited code. purpose of &quot;i&quot; is to get the corresponding latitute and longiture from the F column"}, {"owner": {"reputation": 153, "user_id": 4751756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e655f5ce62d53cef5f5e68e2a69f8?s=128&d=identicon&r=PG&f=1", "display_name": "Sunny Onesotrue", "link": "https://stackoverflow.com/users/4751756/sunny-onesotrue"}, "edited": false, "score": 0, "creation_date": 1460541135, "post_id": 36590495, "comment_id": 60786345, "body": "Shouldn&#39;t it be &quot;Next i&quot; at the end of the loop? Correct me if I&#39;m wrong!"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 153, "user_id": 4751756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e655f5ce62d53cef5f5e68e2a69f8?s=128&d=identicon&r=PG&f=1", "display_name": "Sunny Onesotrue", "link": "https://stackoverflow.com/users/4751756/sunny-onesotrue"}, "edited": false, "score": 0, "creation_date": 1460541296, "post_id": 36590495, "comment_id": 60786466, "body": "@SunnyOnesotrue, its a single loop.. it does not require i"}, {"owner": {"reputation": 181, "user_id": 5972291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ac34cf44a2368c6f0203c078ea24031a?s=128&d=identicon&r=PG", "display_name": "J.H", "link": "https://stackoverflow.com/users/5972291/j-h"}, "edited": false, "score": 0, "creation_date": 1460685852, "post_id": 36590495, "comment_id": 60869019, "body": "I think I have figured it out. What I was missing and what you are also missing was:  &#39;Dim i As Integer&#39;"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1460540894, "last_edit_date": 1460540894, "creation_date": 1460529657, "answer_id": 36590495, "question_id": 36588923, "link": "https://stackoverflow.com/questions/36588923/start-on-first-blank-row-and-declaring-variable-for-counter-in-for-next-loop-in/36590495#36590495", "title": "Start on first blank row and declaring variable for counter in For..Next Loop in VBA", "body": "<p>Hope you are looking for this</p>\n\n<pre><code>Sub FormulaRepeater()\n    Dim sht As Worksheet\n    Dim rowcount As Long\n    Dim Latitude As String\n    Dim Longitude As String\n    Dim result As String\n    Dim StartCell As Long\n    Set sht = Worksheets(\"S2\")\n    StartCell = sht.Range(\"F4\").End(xlDown).Row\n    rowcount = sht.Range(\"F\" &amp; Rows.Count).End(xlUp).Row 'start from first blank row in F\n    For i = StartCell To rowcount\n        Latitude = sht.Range(\"F\" &amp; i).Offset(0, -2).Value ' get latitude 2 cells to the left\n        Longitude = sht.Range(\"F\" &amp; i).Offset(0, -1).Value 'get longitude 1 cell to the left\n        result = GEOAddress(Latitude, Longitude)\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 5972291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ac34cf44a2368c6f0203c078ea24031a?s=128&d=identicon&r=PG", "display_name": "J.H", "link": "https://stackoverflow.com/users/5972291/j-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460540894, "creation_date": 1460523409, "last_edit_date": 1460527234, "question_id": 36588923, "link": "https://stackoverflow.com/questions/36588923/start-on-first-blank-row-and-declaring-variable-for-counter-in-for-next-loop-in", "title": "Start on first blank row and declaring variable for counter in For..Next Loop in VBA", "body": "<p>The code below is a simple formula repeater. I had one that worked fine, but I want to move away from <code>select</code> and <code>activate</code> and start declaring variables so code is easier to read.</p>\n\n<p>I basically want to press my shortcut and have the code start from the first blank row in column F (starting from F4). Then I want the code to enter a formula using values in this format: Formula( ValueTwoColumnsLeft, ValueOneColumnLeft).</p>\n\n<p>The thing I really need help on is understanding For..Next loops. For the part <code>For StartCell = 1 To 2500</code>, I do not understand what the <code>i</code> is supposed to be or how I should define it. I know it can't be a range, then it doesn't make sense anymore.</p>\n\n<pre><code>Sub FormulaRepeater()\n\n' Keyboard Shortcut: Ctrl+q\nDim sht As Worksheet\nDim Address As Range\nDim rowcount As Long\nDim Latitude As String\nDim Longitude As String\nDim result As String\nDim StartCell As Range\n\nSet sht = Worksheets(\"S2\")\nSet Address = sht.Range(\"F4\").End(xlDown)\n\nrowcount = sht.Cells(Rows.Count, Address) 'start from first blank row in F\nSet StartCell = sht.Cells(rowcount + 1, Address)\n\nLatitude = Cells.Offset(0, -2).Value ' get latitude 2 cells to the left\nLongitude = Cells.Offset(0, -1).Value 'get longitude 1 cell to the left\n'Would using offset here be the same as select i.e. sets Application.ScreenUpdating=True\n\nFor rowcount = StartCell To 10 'from the selected cell to 2500, _\nwhich is the daily limit for the Google API\n\n        result = GEOAddress(Latitude, Longitude)\n\n\n    Next\nEnd Sub\n</code></pre>\n\n<p>P.S don't worry about the formula itsel, it works on it's own. Yes I can drag it down but I am trying to practice. Getting type mismatch on defining rowcount ATM.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "edited": false, "score": 0, "creation_date": 1460522670, "post_id": 36588561, "comment_id": 60775571, "body": "I have a few thoughts, although I&#39;m not specifically answering you: 1) You&#39;d be better to use combobox_afterupdate than combobox_change. 2) The statement cbRowStudentGrade = cbRowStudentGrade.Column(0) makes no sense: if the bound column is 0, all this statement does is assign its current value to itself. 3) Your public functions lack arguments, which implies that the functions are defined in your form, but public functions in a form are not recognised by a query unless the form is open"}, {"owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "edited": false, "score": 0, "creation_date": 1460523251, "post_id": 36588561, "comment_id": 60775779, "body": "You might wish to add your query to your post as well"}, {"owner": {"reputation": 305, "user_id": 1132690, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcaffd6c9a665c4e055da47acbb9c01e?s=128&d=identicon&r=PG", "display_name": "Josh Smith", "link": "https://stackoverflow.com/users/1132690/josh-smith"}, "reply_to_user": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "edited": false, "score": 0, "creation_date": 1460523460, "post_id": 36588561, "comment_id": 60775828, "body": "It seems like the function is being run before the sub has populated the variables."}, {"owner": {"reputation": 305, "user_id": 1132690, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcaffd6c9a665c4e055da47acbb9c01e?s=128&d=identicon&r=PG", "display_name": "Josh Smith", "link": "https://stackoverflow.com/users/1132690/josh-smith"}, "reply_to_user": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "edited": false, "score": 0, "creation_date": 1460525376, "post_id": 36588561, "comment_id": 60776556, "body": "The name of the variables and the name of the subroutine are identical. I changed the name of the variable to something different and it works fine."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1460540025, "post_id": 36588561, "comment_id": 60785438, "body": "Further: Values from Combo- and ListBoxes are always strings."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1460533272, "creation_date": 1460533272, "answer_id": 36591705, "question_id": 36588561, "link": "https://stackoverflow.com/questions/36588561/convert-values-from-access-combo-box-to-string/36591705#36591705", "title": "Convert values from Access Combo Box to string", "body": "<p>You're doing this way too complicated.</p>\n\n<p>You can directly refer from your INSERT query to the form controls:</p>\n\n<pre><code>INSERT INTO tblRegistrationGrade ( Red_ID, Course_ID, Grade )\nVALUES (Forms!myForm!StuRed_ID, Forms!myForm!Course_ID, Forms!myForm!cbRowStudentGrade);\n</code></pre>\n\n<p>and get rid of almost all of the code, except calling the query. </p>\n\n<p>As John wrote, it would be better placed in <code>cbRowStudentGrade_AfterUpdate()</code>.</p>\n\n<hr>\n\n<p>Or, instead of the INSERT query, use a <code>DAO.Recordset</code> with <code>AddNew</code>, see:<br>\n<a href=\"https://msdn.microsoft.com/en-us/library/bb243801%28v=office.12%29.aspx\" rel=\"nofollow\">How to: Add a Record to a DAO Recordset</a></p>\n\n<p>There you can also directly use the values from your from controls without worrying about data types.</p>\n"}], "owner": {"reputation": 305, "user_id": 1132690, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcaffd6c9a665c4e055da47acbb9c01e?s=128&d=identicon&r=PG", "display_name": "Josh Smith", "link": "https://stackoverflow.com/users/1132690/josh-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 861, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460533272, "creation_date": 1460521510, "last_edit_date": 1460523409, "question_id": 36588561, "link": "https://stackoverflow.com/questions/36588561/convert-values-from-access-combo-box-to-string", "title": "Convert values from Access Combo Box to string", "body": "<p>I need to convert the values from combo box to a string so I can add that string to a variable, to a function to eventually add to a database. \nHere is my sub that grabs text from my form and from the combo box: </p>\n\n<pre><code>Private Sub cbRowStudentGrade_Change()\n\n\n  Course_ID.SetFocus\n  rowCourseID = Course_ID.Text\n\n  StuRed_ID.SetFocus\n  rowStudentRedID = StuRed_ID.Text\n\n  cbRowStudentGrade.SetFocus\n  cbRowStudentGrade = cbRowStudentGrade.Column(0)\n\n  CurrentDb.Execute \"qryInputGrades\"\n\n\n  MsgBox (rowCourseID)\n  MsgBox (rowStudentRedID)\n  MsgBox (cbRowStudentGrade)\n\n\n  Requery\n  Repaint\nEnd Sub\n</code></pre>\n\n<p>And here are the functions that I am using as criteria in my Access query builder. </p>\n\n<pre><code>Public Function funcRowCourseID() As String\n\n  funcRowCourseID = rowCourseID\n\nEnd Function\n\n\nPublic Function funcRowStudentRedID() As String\n\n  funcRowStudentRedID = rowStudentRedID\n\nEnd Function\n\n\nPublic Function funcCbRowStudentGrade() As String\n\n  funcCbRowStudentGrade = cbRowStudentGrade\n\nEnd Function\n</code></pre>\n\n<p>My query:</p>\n\n<pre><code>INSERT INTO tblRegistrationGrade ( Red_ID, Course_ID, Grade )\nVALUES (funcRowStudentRedID(), funcRowCourseID(), funcCbRowStudentGrade());\n</code></pre>\n\n<p>I think there is a datatype mismatch between the database and what the combobox value actually is. But, if there were a datatype mismatch wouldn't there be an error stating as such? My database requires <code>short text</code>, which these are. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1460514837, "creation_date": 1460514837, "answer_id": 36587526, "question_id": 36587310, "link": "https://stackoverflow.com/questions/36587310/how-to-delete-empty-rows-that-have-previous-or-subequent-rows-non-empty-in-vba/36587526#36587526", "title": "How to delete empty rows that have previous or subequent rows non-empty in VBA", "body": "<p>It seems like each <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196243.aspx\" rel=\"nofollow noreferrer\">Range.Areas property</a> within the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow noreferrer\">Range.SpecialCells method</a> with <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836534.aspx\" rel=\"nofollow noreferrer\">xlCellTypeBlanks</a> should discount the first and last cell and delete the rest.</p>\n\n<pre><code>Dim a As Long, r As Long, rng As Range\nWith Worksheets(\"sheet1\")\n    With Intersect(.Columns(1), .UsedRange)\n        With .SpecialCells(xlCellTypeBlanks)\n            For a = 1 To .Areas.Count\n                With .Areas(a)\n                    For r = 2 To .Rows.Count - 1\n                        If rng Is Nothing Then\n                            Set rng = .Rows(r).Cells(1, 1)\n                        Else\n                            Set rng = Union(rng, .Rows(r).Cells(1, 1))\n                        End If\n                    Next r\n                End With\n            Next a\n        End With\n    End With\nEnd With\n\n'test with red fill\nrng.Interior.Color = vbRed\n'delete these after comfortable with debugging\n'rng.EntireRow.Delete\n</code></pre>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/gN7Ae.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gN7Ae.png\" alt=\"areas_blanks\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1460528919, "post_id": 36587531, "comment_id": 60778249, "body": "edited the question. Facing an error: Run-Time error &#39;5&#39;: Invalid Procedure Call or Argument at the line Set rngBlanks = Union(rngBlanks, ws.Rows(i+1)). How do I solve that?"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 3, "last_activity_date": 1460534225, "last_edit_date": 1495540788, "creation_date": 1460514857, "answer_id": 36587531, "question_id": 36587310, "link": "https://stackoverflow.com/questions/36587310/how-to-delete-empty-rows-that-have-previous-or-subequent-rows-non-empty-in-vba/36587531#36587531", "title": "How to delete empty rows that have previous or subequent rows non-empty in VBA", "body": "<blockquote>\n  <p>I know how to delete empty rows in a sheet:</p>\n</blockquote>\n\n<p>No. That is an incorrect way to delete empty rows and <strong>will not work</strong> when you have <strong>multiple columns.</strong> You may want to see <a href=\"https://stackoverflow.com/questions/9379673/excel-vba-delete-empty-rows\">This</a>. This one uses looping and <code>Application.WorksheetFunction.CountA</code>. Alternatively, you can use <code>.Autofilter</code> as well.</p>\n\n<blockquote>\n  <p>But I am not sure how to change this to implement that. Need some guidance on how to do this.</p>\n</blockquote>\n\n<p>Use the same logic as shown in my answer in the above link.</p>\n\n<pre><code>    '~~&gt; Loop through the rows to find which range is blank\n    For i = 1 To lRow\n        '~~&gt; Checking 3 rows in one go\n        If Application.WorksheetFunction.CountA(Range(\"A\" &amp; i &amp; \":J\" &amp; i + 2)) = 0 Then\n            If rngBlanks Is Nothing Then\n                Set rngBlanks = .Rows(i + 1)\n            Else\n                Set rngBlanks = Union(rngBlanks, .Rows(i + 1))\n            End If\n        End If\n    Next i\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Please Try This (Untested)</p>\n\n<pre><code>For Each ws In Workbooks(newwb).Sheets\n    Select Case ws.Name\n    Case \"Sheet1\", \"Sheet2\", \"Sheet3\"\n    Case Else\n        With ws\n            lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n            For i = 1 To lRow\n                If i = .Rows.Count - 1 Then Exit For\n\n                If Application.WorksheetFunction.CountA(.Range(\"A\" &amp; i &amp; \":O\" &amp; i + 2)) = 0 Then\n                    If rngBlanks Is Nothing Then\n                        Set rngBlanks = .Rows(i + 1)\n                    Else\n                        Set rngBlanks = Union(rngBlanks, .Rows(i + 1))\n                    End If\n                End If\n            Next i\n\n            If Not rngBlanks Is Nothing Then\n                rngBlanks.Delete\n                Set rngBlanks = Nothing\n            End If\n        End With\n    End Select\nNext ws\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1460539404, "creation_date": 1460539404, "answer_id": 36594026, "question_id": 36587310, "link": "https://stackoverflow.com/questions/36587310/how-to-delete-empty-rows-that-have-previous-or-subequent-rows-non-empty-in-vba/36594026#36594026", "title": "How to delete empty rows that have previous or subequent rows non-empty in VBA", "body": "<p>an alternative \"formula\" approach</p>\n\n<pre><code>Option Explicit\n\nSub main()\nDim ncols As Long\nDim colRng As Range\nDim ws As Worksheet\n\nFor Each ws In Workbooks(newwb).Sheets\n    Select Case ws.Name\n        Case \"Sheet1\", \"Sheet2\", \"Sheet3\"    \n        Case Else\n            With ws\n                Set colRng = .Columns(\"A:O\") '&lt;= set the columns range you want to deal with\n                ncols = colRng.Columns.Count\n                With .Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp)).Resize(, ncols).Offset(, ncols).Resize(, 1)\n                    .FormulaR1C1 = \"=IF(RC[-1]=\"\"\"\",IF(COUNTBLANK(indirect(\"\"R[\"\" &amp; if(row()&lt;2,1,-1) &amp; \"\"]C[-\" &amp; ncols &amp; \"]\"\", False):R[1]C[-1])=\" &amp; 3 * ncols &amp; \",\"\"\"\",1),1)\"\n                    .value = .value\n                    .SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n                    .ClearContents\n                End With\n            End With\n     End Select\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>it uses a \"helper\" column juts one left of the range to process. it then delete its content before ending</p>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 36587531, "answer_count": 3, "score": 2, "last_activity_date": 1460539404, "creation_date": 1460513442, "last_edit_date": 1531164843, "question_id": 36587310, "link": "https://stackoverflow.com/questions/36587310/how-to-delete-empty-rows-that-have-previous-or-subequent-rows-non-empty-in-vba", "title": "How to delete empty rows that have previous or subequent rows non-empty in VBA", "body": "<p>I have empty rows in my worksheet and I want to delete them in such a way that if row above is or below is not empty, I do not want to delete them. I don't want to delete them so there are at least 1 empty row below the previous filled rows.</p>\n\n<p>I know how to delete empty rows in a sheet:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Columns(\"A:A\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n</code></pre>\n\n<p>But I am not sure how to change this to implement that. Need some guidance on how to do this.</p>\n\n<p>My code looks like this now:</p>\n\n<pre><code>For Each ws In Workbooks(newwb).Sheets\n    If (ws.Name &lt;&gt; \"Sheet1\") And (ws.Name &lt;&gt; \"Sheet2\") And (ws.Name &lt;&gt; \"Sheet3\") Then\n        'ws.Columns(\"A:A\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n        lRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        For i = 1 To lRow\n            If Application.WorksheetFunction.CountA(ws.Range(\"A\" &amp; i &amp; \":O\" &amp; i + 2)) = 0 Then\n                If IsEmpty(rngBlanks) Then\n                    Set rngBlanks = ws.Rows(i + 1)\n                Else\n                    Set rngBlanks = Union(rngBlanks, ws.Rows(i + 1))\n                End If\n            End If\n        Next i\n        rngBlanks.EntireRow.Delete\n        Set rngBlanks = Nothing\n    Else\n        ws.Delete\n    End If\nNext\n</code></pre>\n\n<p>When doing, it gives me a Run-Time error '5': Invalid Procedure Call or Argument at the line <code>Set rngBlanks = Union(rngBlanks, ws.Rows(i+1))</code></p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1460513438, "post_id": 36587137, "comment_id": 60773197, "body": "Did you refresh all under the data tab? Or are you just refreshing the worksheet?"}, {"owner": {"reputation": 45, "user_id": 2496021, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ede62b38eaf8549e6054a9ed070719f8?s=128&d=identicon&r=PG", "display_name": "Gorhell", "link": "https://stackoverflow.com/users/2496021/gorhell"}, "reply_to_user": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1460514239, "post_id": 36587137, "comment_id": 60773388, "body": "refresh all under data tab not working. It&#39;s like a need to create a new workbook so the refresh data will work"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1460514401, "post_id": 36587137, "comment_id": 60773428, "body": "You could try highlighting your data range and insert as a table. Then create a pivot table from the new table."}, {"owner": {"reputation": 45, "user_id": 2496021, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ede62b38eaf8549e6054a9ed070719f8?s=128&d=identicon&r=PG", "display_name": "Gorhell", "link": "https://stackoverflow.com/users/2496021/gorhell"}, "reply_to_user": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1460515003, "post_id": 36587137, "comment_id": 60773574, "body": "tried that it work but then again if i reenter a new data in data source or remove some data it will not refresh"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1460515580, "post_id": 36587137, "comment_id": 60773697, "body": "What does the pivot data source point to? Does it show a range like <code>Sheet1!$A$!:$Z$100</code> or does it show a table name like <code>Table1</code>?"}, {"owner": {"reputation": 45, "user_id": 2496021, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ede62b38eaf8549e6054a9ed070719f8?s=128&d=identicon&r=PG", "display_name": "Gorhell", "link": "https://stackoverflow.com/users/2496021/gorhell"}, "edited": false, "score": 0, "creation_date": 1460519072, "post_id": 36587137, "comment_id": 60774590, "body": "It show&#39;s like &#39;Consolidated Data&#39;!$A:$AH"}, {"owner": {"reputation": 619, "user_id": 4091300, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dd580ce66c4208f1484bcc51b33c815d?s=128&d=identicon&r=PG&f=1", "display_name": "GavinP", "link": "https://stackoverflow.com/users/4091300/gavinp"}, "edited": false, "score": 0, "creation_date": 1460540161, "post_id": 36587137, "comment_id": 60785562, "body": "Refresh all tends in my experience to refresh the pivot, then the data source. What happens if you refresh all twice?"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1460631232, "post_id": 36587137, "comment_id": 60837650, "body": "If the pivot data source shows Table 1, for example, you should have no problem adding data to the table (columns or rows). After refresh it will show in the pivot table."}, {"owner": {"reputation": 405, "user_id": 1215260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc7a31b9bf68caa678ab8556f37f8c1?s=128&d=identicon&r=PG", "display_name": "jsaven", "link": "https://stackoverflow.com/users/1215260/jsaven"}, "edited": false, "score": 0, "creation_date": 1504574222, "post_id": 36587137, "comment_id": 79051336, "body": "I&#39;ve had issues with this when renaming/copying a work book - the pivot table points to the old file. In this case, the solution is to edit the data source and reset it to the current workbook (select a cell in the pivot table, select the Analyze tab, select Change Data Source and then select the cells the pivot should be pointing to."}], "answers": [{"comments": [{"owner": {"reputation": 40221, "user_id": 7311767, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/13Fpq.png?s=128&g=1", "display_name": "Stephen Rauch", "link": "https://stackoverflow.com/users/7311767/stephen-rauch"}, "edited": false, "score": 0, "creation_date": 1486140469, "post_id": 42022036, "comment_id": 71232595, "body": "Welcome to Stack Overflow! This is not an answer to the question, it&#39;s a comment/new question. Once you have sufficient reputation (50) you will be able to comment on any post. In the meantime you can gain reputation by asking your own questions or providing answers on subjects you know."}], "tags": [], "owner": {"reputation": 1, "user_id": 4702877, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-imDrgQbZkOc/AAAAAAAAAAI/AAAAAAAAIPA/ctLrr_lOadA/photo.jpg?sz=128", "display_name": "Zeno Marin", "link": "https://stackoverflow.com/users/4702877/zeno-marin"}, "is_accepted": false, "score": 0, "last_activity_date": 1609682448, "last_edit_date": 1609682448, "creation_date": 1486117589, "answer_id": 42022036, "question_id": 36587137, "link": "https://stackoverflow.com/questions/36587137/pivot-table-not-updating-or-not-working-properly/42022036#42022036", "title": "Pivot Table not updating or not working properly", "body": "<p>Not sure if this is the reason, but have you checked the Display Language (are you using the same excel sheet on the same machine)?</p>\n<p>For instance I created a pivot table and a chart, using the Display Language = English, only to find out that if German was selected on another machine, the datasource wouldn't update anymore.</p>\n<p>I cannot find any way to make the datasource language independent. E.g. If the filed is called <code>Column1</code> (which would be the default name of a field in EN) well, in German that is... <code>Spalte1</code>. Which of course prevents the chart to be updated, even when reading the same datasource!</p>\n<p>Renamed fields are not preserved when switching from a Display Language to another. So far the only way to make the graphical representation available is to create... two Excel files, one for German settings, the other for English.</p>\n"}], "owner": {"reputation": 45, "user_id": 2496021, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ede62b38eaf8549e6054a9ed070719f8?s=128&d=identicon&r=PG", "display_name": "Gorhell", "link": "https://stackoverflow.com/users/2496021/gorhell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 9526, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1612285455, "creation_date": 1460512320, "last_edit_date": 1593700620, "question_id": 36587137, "link": "https://stackoverflow.com/questions/36587137/pivot-table-not-updating-or-not-working-properly", "title": "Pivot Table not updating or not working properly", "body": "<p>So I have a pivot table with a data source internal in the workbook just a different sheet but it's not updating/refreshing whenever i click refresh nothing happens.  I really need to modify my data source with a different sheet or different range just to update the pivot. It's like pivottable refresh is not working even though i deleted the old data sheet and created new one it's still the same also even though i deleted the pivot table and create a new one it's also not refrehsing what's wrong with my excel file.</p>\n"}, {"tags": ["vba", "excel", "hyperlink", "macros"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1460514104, "post_id": 36586866, "comment_id": 60773365, "body": "have you tried to use <code>Target.SubAddress</code>?"}, {"owner": {"reputation": 685, "user_id": 5486293, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e0fce42cb5592fd014cb0448abc113d6?s=128&d=identicon&r=PG&f=1", "display_name": "SincereApathy", "link": "https://stackoverflow.com/users/5486293/sincereapathy"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1460514755, "post_id": 36586866, "comment_id": 60773521, "body": "Just tried it. Macro still doesn&#39;t run."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1460515196, "post_id": 36586866, "comment_id": 60773613, "body": "if there is just a <code>Debug.Print &quot;OK&quot;</code> did it trigger?"}, {"owner": {"reputation": 685, "user_id": 5486293, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e0fce42cb5592fd014cb0448abc113d6?s=128&d=identicon&r=PG&f=1", "display_name": "SincereApathy", "link": "https://stackoverflow.com/users/5486293/sincereapathy"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1460516150, "post_id": 36586866, "comment_id": 60773839, "body": "just <code>Debug.Print &quot;Ok&quot;</code> doesn&#39;t do anything, but if I put only <code>MsgBox (&quot;Test&quot;)</code> in the Worksheet_FollowHyperlink event it does work. Also, if I put a call to one of my macros it will trigger. However, I need to be able to call different macros based on different hyperlinks. I tried If statements instead of a Select Case and it doesn&#39;t worth that way either."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1460516465, "post_id": 36586866, "comment_id": 60773911, "body": "what does <code>MsgBox (&quot;Target.SubAddress&quot;)</code> tell you? Or what does <code>MsgBox (&quot;Target.Range.Address&quot;)</code> show you?"}, {"owner": {"reputation": 685, "user_id": 5486293, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e0fce42cb5592fd014cb0448abc113d6?s=128&d=identicon&r=PG&f=1", "display_name": "SincereApathy", "link": "https://stackoverflow.com/users/5486293/sincereapathy"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1460516861, "post_id": 36586866, "comment_id": 60773983, "body": "Good plan, my man! Target.SubAddress showed &quot;Sheet1!Z3&quot;... I changed my Select Case to <code>Target.SubAddress</code> and my Cases to <code>Case &quot;Sheet1!Z3&quot;</code> and <code>Case &quot;Sheet1!B3</code> respectively and it worked. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 685, "user_id": 5486293, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e0fce42cb5592fd014cb0448abc113d6?s=128&d=identicon&r=PG&f=1", "display_name": "SincereApathy", "link": "https://stackoverflow.com/users/5486293/sincereapathy"}, "edited": false, "score": 0, "creation_date": 1460511253, "post_id": 36586936, "comment_id": 60772630, "body": "I have to code in the correct worksheet code area. The only difference I see is that I don&#39;t have the actual address as the text for my hyperlink. Could that be the issue? Preferably, I would like to keep the text descriptive to what the macro will do..."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 685, "user_id": 5486293, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e0fce42cb5592fd014cb0448abc113d6?s=128&d=identicon&r=PG&f=1", "display_name": "SincereApathy", "link": "https://stackoverflow.com/users/5486293/sincereapathy"}, "edited": false, "score": 0, "creation_date": 1460511598, "post_id": 36586936, "comment_id": 60772706, "body": "@SincereApathy  The text is not important..............another reason the macro may not be called is if you are using the <i>=HYERLINK()</i> worksheet function rather than an Inserted hyperlink in the cell."}, {"owner": {"reputation": 685, "user_id": 5486293, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e0fce42cb5592fd014cb0448abc113d6?s=128&d=identicon&r=PG&f=1", "display_name": "SincereApathy", "link": "https://stackoverflow.com/users/5486293/sincereapathy"}, "edited": false, "score": 0, "creation_date": 1460512129, "post_id": 36586936, "comment_id": 60772868, "body": "Still no luck. Thanks you for your time ... must be some other settings/technical issue."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 685, "user_id": 5486293, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e0fce42cb5592fd014cb0448abc113d6?s=128&d=identicon&r=PG&f=1", "display_name": "SincereApathy", "link": "https://stackoverflow.com/users/5486293/sincereapathy"}, "edited": false, "score": 0, "creation_date": 1460512248, "post_id": 36586936, "comment_id": 60772914, "body": "@SincereApathy the problem is not with your code....it runs on my system.......perhaps the problem is with the hyperlink ??"}, {"owner": {"reputation": 685, "user_id": 5486293, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e0fce42cb5592fd014cb0448abc113d6?s=128&d=identicon&r=PG&f=1", "display_name": "SincereApathy", "link": "https://stackoverflow.com/users/5486293/sincereapathy"}, "edited": false, "score": 0, "creation_date": 1460513097, "post_id": 36586936, "comment_id": 60773122, "body": "I have edited my post to show how I set up the hyperlink."}, {"owner": {"reputation": 4630, "user_id": 2994412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gnXJp.jpg?s=128&g=1", "display_name": "Horaciux", "link": "https://stackoverflow.com/users/2994412/horaciux"}, "edited": false, "score": 0, "creation_date": 1573847543, "post_id": 36586936, "comment_id": 104034724, "body": "What can I do when =HYERLINK() is used?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1460510809, "creation_date": 1460510809, "answer_id": 36586936, "question_id": 36586866, "link": "https://stackoverflow.com/questions/36586866/running-excel-macro-on-hyperlink-click/36586936#36586936", "title": "Running Excel Macro On Hyperlink Click", "body": "<p>Your code works <strong>if the code is in the worksheet code area</strong></p>\n\n<p>Right-click the tab at the bottom and:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Y01Wd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y01Wd.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 685, "user_id": 5486293, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e0fce42cb5592fd014cb0448abc113d6?s=128&d=identicon&r=PG&f=1", "display_name": "SincereApathy", "link": "https://stackoverflow.com/users/5486293/sincereapathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3446, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460512954, "creation_date": 1460510298, "last_edit_date": 1460512954, "question_id": 36586866, "link": "https://stackoverflow.com/questions/36586866/running-excel-macro-on-hyperlink-click", "title": "Running Excel Macro On Hyperlink Click", "body": "<p>I'm trying to assign macros to hyperlinks I have set up in excel. I have the hyperlinks linking back to the same cell that contains the hyperlink. Based on code examples I've found I've come up with this code block:</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n\nSelect Case Target.Range.Address\n\nCase \"$B$3\"\n     MsgBox (\"Test\")\nCase \"$Z$3\"\n     MsgBox (\"Test\")\nCase Else\n    Exit Sub\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>Nothing is happening when I click either hyperlink. I have tried running <code>Application.EnableEvents = True</code> as well and still can't get anything to fire. Also, I have verified the code block is set in the correct worksheet module. Any help would be appreciated. Thanks!</p>\n\n<p>EDIT: Here is a screencap of the hyperlink dialog as an example for the hyperlinks I have set up:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RyV16.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RyV16.jpg\" alt=\"http://i.imgur.com/QwHuXJJ.jpg\"></a></p>\n\n<p>I have tried both \"Z3\" and $Z$3 for the address (both ways direct me to the cell properly, it just doesn't fire the macro.)</p>\n"}, {"tags": ["sql", "ms-access", "vba", "operator-keyword"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 3, "creation_date": 1460509913, "post_id": 36586519, "comment_id": 60772263, "body": "Make that <code>WHERE</code> clause the last piece of your query statement.  I suspect you might have better luck building a similar query from scratch using Design View of the Access query designer.  When it works, switch to SQL View to see the valid <code>SELECT</code> statement and use that as the model when you revise your VBA code."}, {"owner": {"reputation": 1339, "user_id": 4675356, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh6.googleusercontent.com/-F6xtp2cHdHI/AAAAAAAAAAI/AAAAAAAANJU/NxfpHThQ_VQ/photo.jpg?sz=128", "display_name": "Matt Kelly", "link": "https://stackoverflow.com/users/4675356/matt-kelly"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1460521287, "post_id": 36586519, "comment_id": 60775162, "body": "You&#39;re a bloody lifesaver, it was all a matter of putting the WHERE statement right at the end after the Inner Join.  If you want to put that as an answer, I&#39;ll accept it.  Thanks so much!"}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1460560847, "creation_date": 1460560847, "answer_id": 36602906, "question_id": 36586519, "link": "https://stackoverflow.com/questions/36586519/access-vba-run-time-error-3075/36602906#36602906", "title": "Access VBA Run-time Error 3075", "body": "<p>Access complained about the query because the <code>WHERE</code> clause is in the wrong position.</p>\n\n<p>Instead of this pattern, <code>SELECT ... FROM ... WHERE ... INNER JOIN</code>, you need a pattern like <code>SELECT ... FROM ... INNER JOIN ... WHERE</code></p>\n\n<p>In other words, move that <code>WHERE</code> clause to the end of the query statement.   </p>\n"}], "owner": {"reputation": 1339, "user_id": 4675356, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh6.googleusercontent.com/-F6xtp2cHdHI/AAAAAAAAAAI/AAAAAAAANJU/NxfpHThQ_VQ/photo.jpg?sz=128", "display_name": "Matt Kelly", "link": "https://stackoverflow.com/users/4675356/matt-kelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1521, "favorite_count": 0, "accepted_answer_id": 36602906, "answer_count": 1, "score": 1, "last_activity_date": 1460560871, "creation_date": 1460507877, "last_edit_date": 1460560871, "question_id": 36586519, "link": "https://stackoverflow.com/questions/36586519/access-vba-run-time-error-3075", "title": "Access VBA Run-time Error 3075", "body": "<p>Before I get started, I know there are a TON of Error 3075 questions on here, and I've had a good look through them to find one that can help me, but I have been unable to.</p>\n\n<p>I have an Access database written in VBA.  I am attempting to execute an SQL statement which is simply querying the database.  I am getting the classic 3075 error, which suggests that my SQL query is invalid.  I have printed the query to a message box and to me it looks fine, but I'm using Inner Joins and I'm not too familiar with them.</p>\n\n<p>Could someone please check over my code to give me a hand?</p>\n\n<p>My SQL related VBA code is below:</p>\n\n<pre><code>MsgBox strSQL\n\nSet rs = db.OpenRecordset(strSQL, dbOpenDynaset)\nIf rs.RecordCount &gt; 0 Then\n    rs.MoveLast\n    lblTotal.Caption = rs.RecordCount\nElse\n    lblTotal.Caption = \"0\"\nEnd If\n</code></pre>\n\n<p>Pretty standard stuff.  I haven't included how I make up <code>strSQL</code> because it is based on a complex set of if statements.  The value of strSQL when I try to set the Recordset is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Q2dpr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q2dpr.png\" alt=\"SQL Statement\"></a></p>\n\n<p>My suspicion is that there is something wrong with the way I am referencing the dates.  Just to give you the whole picture, below are the three tables referenced:</p>\n\n<p><strong>tblHistory:</strong><br>\n<a href=\"https://i.stack.imgur.com/rKN6j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rKN6j.png\" alt=\"tblHistory\"></a></p>\n\n<p><strong>tblBooks:</strong>\n<a href=\"https://i.stack.imgur.com/WOO8y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WOO8y.png\" alt=\"tblBooks1\"></a>\nContinued:\n<a href=\"https://i.stack.imgur.com/q3EBL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q3EBL.png\" alt=\"tblBooks2\"></a></p>\n\n<p><strong>tblBookTypes:</strong>\n<a href=\"https://i.stack.imgur.com/UTlA7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UTlA7.png\" alt=\"tblBookTypes\"></a></p>\n\n<p>I've tried isolating the problem by cutting the SQL statement right down.  I could get it to work with a simple statement like <code>SELECT * FROM tblHistory</code>, as well as adding a <code>WHERE</code> parameter to that, but once I introduced the Inner Join, I got the 3075 error again.</p>\n\n<p>Does anyone know where I'm going wrong?  This is driving me mad!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1460507497, "post_id": 36586347, "comment_id": 60771635, "body": "Put a <code>_</code> after a space at the end of the first line."}], "answers": [{"tags": [], "owner": {"reputation": 2865, "user_id": 4509121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f5SN7.png?s=128&g=1", "display_name": "Ben Rhys-Lewis", "link": "https://stackoverflow.com/users/4509121/ben-rhys-lewis"}, "is_accepted": true, "score": 0, "last_activity_date": 1460536216, "creation_date": 1460536216, "answer_id": 36592749, "question_id": 36586347, "link": "https://stackoverflow.com/questions/36586347/placing-multiple-criterion-in-one-if-statement-excel-vba/36592749#36592749", "title": "Placing Multiple Criterion in One IF Statement Excel VBA", "body": "<p>Your If statement needs to be in one line or if you want it to be over two lines use an underscore.</p>\n\n<pre><code>If i.Value = \"Device Name\" _\nOr Left(i.Value, 11) = \"Average for\" Then\n    i.EntireRow.Delete\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 36592749, "answer_count": 1, "score": 0, "last_activity_date": 1460537375, "creation_date": 1460506774, "last_edit_date": 1460537375, "question_id": 36586347, "link": "https://stackoverflow.com/questions/36586347/placing-multiple-criterion-in-one-if-statement-excel-vba", "title": "Placing Multiple Criterion in One IF Statement Excel VBA", "body": "<p>How can I fit multiple AND/OR criterion in one If statement in Excel VBA\nwithout stretching across one line?\nWhenever I enter the extra the criterion to a new line, a compile \nerror comes up.</p>\n\n<p><a href=\"https://i.stack.imgur.com/E05Zd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E05Zd.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6106416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaff9dbeeb898497ade7fc9166c33f83?s=128&d=identicon&r=PG&f=1", "display_name": "Super Dave", "link": "https://stackoverflow.com/users/6106416/super-dave"}, "edited": false, "score": 0, "creation_date": 1460573119, "post_id": 36586710, "comment_id": 60810801, "body": "@gary for future reference, how do I do the highlighting you did for the example cells? Is that the &#39;code&#39; format?"}, {"owner": {"reputation": 3, "user_id": 6106416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaff9dbeeb898497ade7fc9166c33f83?s=128&d=identicon&r=PG&f=1", "display_name": "Super Dave", "link": "https://stackoverflow.com/users/6106416/super-dave"}, "edited": false, "score": 0, "creation_date": 1460586100, "post_id": 36586710, "comment_id": 60817904, "body": "Thanks @Dirk  I&#39;ll try the code tomorrow morning. If I may ask, how would you recommend I change the paste code so that it appends to the bottom of the rows? I don&#39;t want to separate one column, then overwrite that information when the next column gets processed.      Something like:                      &#39; TheLastRow = Sheets(&quot;Sheet2&quot;).Range(&quot;A1&quot;).SpecialCells(xlCellTypeLastCell&zwnj;&#8203;).Row              Sheets(&quot;Sheet2&quot;).Range(&quot;A&quot;&amp; TheLastRow).Resize(i, 3) = Application.Transpose(xVal) &#39;Change the sheet and the &quot;A1&quot; to the upper left cell to output to &#39; (Grrr! Can&#39;t get line breaks to work)"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 0, "last_activity_date": 1485784871, "last_edit_date": 1485784871, "creation_date": 1460509168, "answer_id": 36586710, "question_id": 36586089, "link": "https://stackoverflow.com/questions/36586089/excel-vba-macro-separate-cell-contents-in-a-range-by-space-into-rows-and-captu/36586710#36586710", "title": "Excel VBA Macro - Separate cell contents in a range by space into rows and capture original cell location", "body": "<p>This code should do what you desire (hopefully):</p>\n\n<pre><code>Sub SplitIt()\n  Dim rng As Range\n  Set rng = Sheets(\"Sheet1\").Range(\"A1:A10\") 'change that as you need it (the data to be splited)\n  Dim rngVal As Variant\n  rngVal = rng.Value\n  Dim xSpl As Variant, xSpl2 As Variant, xVal() As Variant, i As Long, j As Long, col As String\n  j = rng.Row\n  col = Split(Columns(rng.Column).Address(, 0), \":\")(0)\n  ReDim xVal(1 To 3, 0)\n  For Each xSpl In rngVal\n    If Len(xSpl) Then\n      xSpl = Split(Trim(xSpl), \" \")\n      If UBound(xVal, 2) Then\n        ReDim Preserve xVal(1 To 3, 1 To i + UBound(xSpl) + 1)\n      Else\n        ReDim xVal(1 To 3, 1 To UBound(xSpl) + 1)\n      End If\n      For Each xSpl2 In xSpl\n        If Len(xSpl2) Then\n          i = i + 1\n          xVal(1, i) = xSpl2\n          xVal(2, i) = col\n          xVal(3, i) = j\n        End If\n      Next\n    End If\n    j = j + 1\n  Next\n  Sheets(\"Sheet2\").Range(\"A1\").Resize(i, 3) = Application.Transpose(xVal) 'Change the sheet and the \"A1\" to the upper left cell to output to\nEnd Sub\n</code></pre>\n\n<p>it is designed to work only for one column with mutiple rows but do not use a range like \"A:A\" (just the range which contains values) or it may freeze excel for some time ;)</p>\n\n<h2>How it works:</h2>\n\n<p>It checks each cell in the range if it has anything inside it (blank cells will be skipped, also cells only containing spaces).<br>\nThen each cell-value is split to an array (split by a space). This array will be attached to the existing output-array (again, empty parts will be skipped).  </p>\n\n<p>Thanks to the way <code>Redim Preserve</code> works, we get a transposed array which we need to transpose at the end for output. And that's all... (the part for column/row should be self explaining)</p>\n\n<p>If you still have any questions, just ask ;)</p>\n"}], "owner": {"reputation": 3, "user_id": 6106416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaff9dbeeb898497ade7fc9166c33f83?s=128&d=identicon&r=PG&f=1", "display_name": "Super Dave", "link": "https://stackoverflow.com/users/6106416/super-dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1300, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485784871, "creation_date": 1460505058, "last_edit_date": 1495540387, "question_id": 36586089, "link": "https://stackoverflow.com/questions/36586089/excel-vba-macro-separate-cell-contents-in-a-range-by-space-into-rows-and-captu", "title": "Excel VBA Macro - Separate cell contents in a range by space into rows and capture original cell location", "body": "<p>I have an inventory spreadsheet that has multiple entries per cell separated by spaces. They are using the current cell location as the reference number, so I need to maintain that information.</p>\n\n<p>Example:<br>\n   Current</p>\n\n<pre><code>Cell A1 - PartA PartB PartC  \nCell A2 - PartD PartE\n</code></pre>\n\n<p>Desired  </p>\n\n<pre><code>Cell A1 - PartA  Cell B1 - A 'OriginalColumn Cell C1 - 1 'OriginalRow  \nCell A2 - PartB  Cell B2 - A 'OriginalColumn Cell C2 - 1 'OriginalRow  \nCell A3 - PartC  Cell B3 - A 'OriginalColumn Cell C3 - 1 'OriginalRow  \nCell A4 - PartD  Cell B4 - A 'OriginalColumn Cell C4 - 2 'OriginalRow  \nCell A5 - PartE  Cell B5 - A 'OriginalColumn Cell C5 - 2 'OriginalRow  \n</code></pre>\n\n<p>etc.</p>\n\n<p>I've done my research and the closest VBA code does the split information, but it pastes it to the next row over, and for a range, that's no good for me. <a href=\"https://stackoverflow.com/questions/471435/excel-macro-comma-separated-cells-to-rows?rq=1\">SO: Comma Separated Rows</a></p>\n\n<p>I've tried altering the code to make it work for a range, but having troubles getting it to work and not sure what's wrong. I also am having a hard time figuring out how to capture the original cell location and output to the other rows. (If it can't be split from A1 to A &amp; 1, I can live with that, but it's desired.)</p>\n\n<p>Thanks in advance for any assistance in pointing the way!</p>\n\n<p>Current code:  </p>\n\n<pre><code>    Option Explicit\n    Sub ToolFormat()\n\n    Dim mainsheet As Sheet1\n    Dim datalist As Sheet2\n    Dim vLastRow As Long\n    Dim vLastCol As Long\n    Dim y As Long\n    Dim x As Long\n\n\n\n        With ActiveSheet.UsedRange\n            vLastRow = .Rows(.Rows.Count).Row\n            vLastCol = .Columns(.Columns.Count).Column\n        End With\n\n    ' MsgBox (\"Last row: \" &amp; vLastRow &amp; \" Last column: \" &amp; vLastCol)\n\n        Dim toCol As String\n        Dim toRow As String\n        Dim inVal As Range\n        Dim outVal As Range\n        Dim commaPos As Integer\n\n        Set inVal = Nothing\n\n    For y = 1 To vLastCol\n\n        For x = 1 To vLastRow\n\n        ' Copy from mainsheet range to datalist column B.'\n\n        toCol = \"B\"\n        toRow = \"1\"\n\n        ' Go until no more entries\n        inVal = mainsheet.Cells(x, y).Value\n        While inVal &lt;&gt; \"\"\n\n            ' Go until all sub-entries used up.'\n            While inVal &lt;&gt; \"\"\n                Range(y + x).Select\n\n                ' Extract each subentry.'\n                commaPos = InStr(1, inVal, \",\")\n                While commaPos &lt;&gt; 0\n\n                    ' and write to output column.'\n                    outVal = Left(inVal, commaPos - 1)\n                    datalist.Range(toCol + toRow).Select\n                    datalist.Range(toCol + toRow).Value = outVal\n                    toRow = Mid(Str(Val(toRow) + 1), 2)\n\n                    ' Remove that sub-entry.'\n                    inVal = Mid(inVal, commaPos + 1)\n                    While Left(inVal, 1) = \" \"\n                        inVal = Mid(inVal, 2)\n                    Wend\n                    commaPos = InStr(1, inVal, \",\")\n                Wend\n\n                ' Get last sub-entry (or full entry if no commas).'\n                Range(toCol + toRow).Select\n                Range(toCol + toRow).Value = inVal\n                toRow = Mid(Str(Val(toRow) + 1), 2)\n                inVal = \"\"\n            Wend\n\n            ' Advance to next source row.'\n            x = Mid(Str(Val(x) + 1), 2)\n            mainsheet.Range(y + x).Select\n            inVal = mainsheet.Range(y + x).Value\n        Wend\n\n        Next x ' until x.value = \"\"\n\n    Next y\n\n\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos", "excel-2010"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1460524371, "post_id": 36585953, "comment_id": 60776156, "body": "You don&#39;t define &quot;val&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6152514, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/256025db3dd74f26cf7f0e0f2432f419?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi0609", "link": "https://stackoverflow.com/users/6152514/abhi0609"}, "edited": false, "score": 0, "creation_date": 1460553236, "post_id": 36588654, "comment_id": 60796045, "body": "<code>Private Sub txt_BPName_Exit(ByVal Cancel As MSForms.ReturnBoolean) For Each c In Range(&quot;A2:A&quot; &amp; Cells(Rows.Count, 1).End(xlUp).row)         If c.Value = txt_BPName Then MsgBox &quot;Cell &quot; &amp; c.Address &amp; &quot; is a duplicate.&quot; Next c  Cancel = True  End Sub</code>             This code here is finding duplicates, but the only issue is it is finding my immediate entry on a text box as a duplicate. Any idea on how to avoid this.  @user3598756 @Tyler Denton"}, {"owner": {"reputation": 48, "user_id": 4996129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6900323277dfa51fee8188a12438b81?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Denton", "link": "https://stackoverflow.com/users/4996129/tyler-denton"}, "reply_to_user": {"reputation": 31, "user_id": 6152514, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/256025db3dd74f26cf7f0e0f2432f419?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi0609", "link": "https://stackoverflow.com/users/6152514/abhi0609"}, "edited": false, "score": 0, "creation_date": 1460574193, "post_id": 36588654, "comment_id": 60811491, "body": "I dont really understand the problem you are having but this will work. Option Explicit Private Sub CommandButton1_Click() Dim x As Integer Dim I As Integer Dim Match As String Dim row As Integer Dim here As Integer here = 0  With ActiveSheet     x = .Cells(.Rows.Count, &quot;A&quot;).End(xlUp).row     Match = Me.TextBox1.Text  For I = 1 To x     here = InStr(.Cells(I, 1), Match)     If here &lt;&gt; 0 Then         MsgBox (&quot;Match at row &quot; + Str(I))     End If     here = 0 Next I  End With End Sub"}], "tags": [], "owner": {"reputation": 48, "user_id": 4996129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6900323277dfa51fee8188a12438b81?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Denton", "link": "https://stackoverflow.com/users/4996129/tyler-denton"}, "is_accepted": false, "score": 0, "last_activity_date": 1460521992, "creation_date": 1460521992, "answer_id": 36588654, "question_id": 36585953, "link": "https://stackoverflow.com/questions/36585953/compare-a-textbox-entry-to-a-column-that-contains-text-alphanumeric-with/36588654#36588654", "title": "Compare a textbox entry to a column that contains text( alphanumeric with &#39;-&#39;) , if a duplicate is found then alert user", "body": "<p>I think you should look at the instr() function.  You can iterate through your column and compare each cell in the column to your text box value with a for loop. That is probably the easiest solution. If you post an excerpt of your speadsheet it would be easier to edit your function to work. </p>\n"}], "owner": {"reputation": 31, "user_id": 6152514, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/256025db3dd74f26cf7f0e0f2432f419?s=128&d=identicon&r=PG&f=1", "display_name": "Abhi0609", "link": "https://stackoverflow.com/users/6152514/abhi0609"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 456, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593700707, "creation_date": 1460504218, "last_edit_date": 1593700707, "question_id": 36585953, "link": "https://stackoverflow.com/questions/36585953/compare-a-textbox-entry-to-a-column-that-contains-text-alphanumeric-with", "title": "Compare a textbox entry to a column that contains text( alphanumeric with &#39;-&#39;) , if a duplicate is found then alert user", "body": "<p>I have a column that contains text made up of alphanumeric characters with a special character '-' like Kat-1, Amp-2, Xua-09, etc. I tried the below code, but it does not seem to recognize text like Kat-1 as a duplicate. Can anyone  please check what is wrong with this code. </p>\n\n<pre><code>Private Sub txt_BPName_Exit(ByVal Cancel As MSForms.ReturnBoolean)\nDim myrange As Range\nDim match As Boolean\nDim val\nSet myrange = Worksheets(\"Sheet1\").Range(\"A2:A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).row)\nmatch = WorksheetFunction.CountIf(myrange, val) &gt; 0\nIf match Then\nMsgBox (\"Duplicate\")\nCancel = True\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1460516276, "post_id": 36585791, "comment_id": 60773868, "body": "Somewhere after <code>ErrSheetName:</code> add the line <code>Sheets(i).Range(&quot;B3&quot;).Formula = &quot;=A4&quot;</code>, replacing <code>=A4</code> with the formula you want. Since you have quotes in your formula, you will need to replace those with multiples - perhaps build your formula into a text string first."}], "answers": [{"tags": [], "owner": {"reputation": 421, "user_id": 4035813, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WbDmSCWckws/AAAAAAAAAAI/AAAAAAAAABo/H8qjO5htk48/photo.jpg?sz=128", "display_name": "Steve S", "link": "https://stackoverflow.com/users/4035813/steve-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1460518200, "last_edit_date": 1495541637, "creation_date": 1460518200, "answer_id": 36588028, "question_id": 36585791, "link": "https://stackoverflow.com/questions/36585791/macro-to-change-tab-name-based-on-cell-value-with-special-duplicate-handling/36588028#36588028", "title": "Macro to change tab name based on cell value with special duplicate handling", "body": "<p>You can explicitly check for the existence of a sheet named the same as the value in <code>B4</code> by using a function like what is described here: <a href=\"https://stackoverflow.com/questions/6688131/test-or-check-if-sheet-exists\">Test or check if sheet exists</a>.  Then, you can insert something like the following between your <code>On Error...</code> and <code>Sheets(i).Name...</code>:</p>\n\n<pre><code>On Error GoTo ErrSheetName\n\nIf SheetExists(Sheets(i).Range(\"A4\").Value) Then\n  Sheets(i).Range(\"B3\").Formula = \"=IF(AND(C4=\"\",D4=\"\",D3=\"\",C3=\"\"),TRIM((MID(A2,FIND(\": \",A2)+2,20))),\"\")&amp;IF(IFERROR(FIND(\"West \",A2),0)&gt;0,\"W \",\"\")&amp;\"\"&amp;TRIM(RIGHT(SUBSTITUTE(A2,\"\",REPT(\"\",255)),255))\"\nEnd If\n\nSheets(i).Name = Sheets(i).Range(\"A4\").Value\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 36588028, "answer_count": 1, "score": 0, "last_activity_date": 1460518200, "creation_date": 1460503087, "question_id": 36585791, "link": "https://stackoverflow.com/questions/36585791/macro-to-change-tab-name-based-on-cell-value-with-special-duplicate-handling", "title": "Macro to change tab name based on cell value with special duplicate handling", "body": "<p>I have a macro that changed a tab name based on cell value (A4) which contains a formula to give the sheet a unique name, but I wanted to see if it was possible to create special case handling occurrences when there's a duplicate.  So here's the code:</p>\n\n<pre><code>Sub RenameFromA4()\nDim Msg As String, i As Integer\nFor i = 5 To Sheets.Count\nIf Sheets(i).Range(\"A4\").Value = \"\" Then\nMsg = \"Sheet \" &amp; i &amp; \"(\" &amp; Sheets(i).Name &amp; \") has no value in A4. Fix sheet, then rerun.\"\nMsgBox Msg, vbExclamation\nExit Sub\nElse\nOn Error GoTo ErrSheetName\nSheets(i).Name = Sheets(i).Range(\"A4\").Value\nOn Error GoTo 0\nEnd If\nNext i\nExit Sub\nErrSheetName: Msg = \"Sheet \" &amp; i &amp; \"(\" &amp; Sheets(i).Name &amp; \") could not be renamed. Check if name already used.\"\nMsgBox Msg, vbExclamation\n\nEnd Sub\n</code></pre>\n\n<p>The trouble I run into is sometimes duplicates can arise and error out my whole macro where it comes to a complete halt.  So I want to add a sequence that when the macro encounters a duplicate add the following formula in cell B3:  <code>=\"IF(AND(C4=\"\",D4=\"\",D3=\"\",C3=\"\"),TRIM((MID(A2,FIND(\":\",A2)+2,20))),\"\")&amp;IF(IFERROR(FIND(\"West\",A2),0)&gt;0,\" W\",\"\")&amp;\" \"&amp;TRIM(RIGHT(SUBSTITUTE(A2,\" \",REPT(\" \",255)),255))\"</code></p>\n\n<p>and pick from the error or just go back to rerunning the macro.</p>\n\n<p>Any insight on how I can't structure this will be helpful.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1460502566, "post_id": 36585685, "comment_id": 60770189, "body": "Why not <a href=\"https://support.office.com/en-us/article/SUMIFS-function-C9E748F5-7EA7-455D-9406-611CEBCE642B\" rel=\"nofollow noreferrer\">SUMIFS function</a>? <a href=\"https://support.office.com/en-us/article/AVERAGEIFS-function-48910C45-1FC0-4389-A028-F7C5C3001690\" rel=\"nofollow noreferrer\">AVERAGEIFS function</a>?"}, {"owner": {"reputation": 1, "user_id": 6195817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a7df69ebd83226a5ab867ea3b66b43?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Bass", "link": "https://stackoverflow.com/users/6195817/jon-bass"}, "edited": false, "score": 0, "creation_date": 1460503120, "post_id": 36585685, "comment_id": 60770372, "body": "How would I sum every 24 cells using SUMIFS for Cost per Day?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1460503449, "post_id": 36585685, "comment_id": 60770503, "body": "<code>=SUM(INDEX(M:M, (ROW(1:1)-1)*24+18):INDEX(M:M, (ROW(1:1)-1)*24+41))</code> uses the non-volatile <a href=\"https://support.office.com/en-us/article/index-function-0ee99cef-a811-4762-8cfb-a222dd31368a\" rel=\"nofollow noreferrer\">INDEX function</a> instead of the volatile <a href=\"https://support.office.com/en-us/article/OFFSET-function-b3958b36-c30b-4fc3-979e-9b9bbfdcf592\" rel=\"nofollow noreferrer\">OFFSET function</a>."}, {"owner": {"reputation": 1, "user_id": 6195817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a7df69ebd83226a5ab867ea3b66b43?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Bass", "link": "https://stackoverflow.com/users/6195817/jon-bass"}, "edited": false, "score": 0, "creation_date": 1460503675, "post_id": 36585685, "comment_id": 60770580, "body": "Thank you! How would I write a function in VBA? Preferably, I dont want to hard-code anything."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1460503810, "post_id": 36585685, "comment_id": 60770622, "body": "You tap [alt]+F11 and start typing. People asking for code are <b>expected</b> to show original effort. We are here to help you get through problems you encounter; not write your code for you."}, {"owner": {"reputation": 1, "user_id": 6195817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a7df69ebd83226a5ab867ea3b66b43?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Bass", "link": "https://stackoverflow.com/users/6195817/jon-bass"}, "edited": false, "score": 0, "creation_date": 1460504932, "post_id": 36585685, "comment_id": 60770981, "body": "How do I format the code like you have? If I copy and paste it, it will post in a block text format."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1460506036, "post_id": 36585685, "comment_id": 60771255, "body": "Don&#39;t post code blocks into comments. Edit your question and include it as an update. once you have it there, select it and tap [ctrl]+K."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1460506594, "post_id": 36585685, "comment_id": 60771406, "body": "Have a look at <a href=\"https://dl.dropboxusercontent.com/u/100009401/Writing%20a%20VBA%20function%20to%20sum%20Cost%20Per%20Hour%20into%20Cost%20Per%20Day%20and%20then%20into%20Cost%20per%20Month.xlsx\" rel=\"nofollow noreferrer\">this</a>. I honestly doubt whether you are going to increase worksheet efficiency very much past those optimized formulas, VBA or no VBA."}, {"owner": {"reputation": 1, "user_id": 6195817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a7df69ebd83226a5ab867ea3b66b43?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Bass", "link": "https://stackoverflow.com/users/6195817/jon-bass"}, "edited": false, "score": 0, "creation_date": 1460507680, "post_id": 36585685, "comment_id": 60771679, "body": "Thanks for taking the time to make that spreadsheet! My hope was to simply create a user defined function so that someone else (who has little excel experience) can easily update my spreadsheet."}, {"owner": {"reputation": 1, "user_id": 6195817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a7df69ebd83226a5ab867ea3b66b43?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Bass", "link": "https://stackoverflow.com/users/6195817/jon-bass"}, "edited": false, "score": 0, "creation_date": 1471468151, "post_id": 36585685, "comment_id": 65364261, "body": "Hi Jeeped, I am wondering whether you can explain where the 41 comes from in =SUM(INDEX(M:M, (ROW(1:1)-1)*24+18):INDEX(M:M, (ROW(1:1)-1)*24+41))"}], "answers": [{"tags": [], "owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "is_accepted": false, "score": 0, "last_activity_date": 1460504227, "creation_date": 1460504227, "answer_id": 36585957, "question_id": 36585685, "link": "https://stackoverflow.com/questions/36585685/writing-a-vba-function-to-sum-cost-per-hour-into-cost-per-day-and-then-into/36585957#36585957", "title": "Writing a VBA function to sum &quot;Cost Per Hour&quot; into &quot;Cost Per Day&quot; and then into &quot;Cost per Month&quot;", "body": "<p>What if you added a helper column that started with 1 in cell A1 for example.  Second row (A2) would be =If(A1=24,1,A1+1). Column B would have the hourly data. Column C or C1 would say =If(and(A1=24,A2=1),B1,B1+B2)). I didn't test, but I think this should work with perhaps a tweak. </p>\n"}, {"tags": [], "owner": {"reputation": 154, "user_id": 4859154, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHx8sN_2gAs/AAAAAAAAAAI/AAAAAAAAAKk/tKTtkGvTvwA/photo.jpg?sz=128", "display_name": "C. van Dorsten", "link": "https://stackoverflow.com/users/4859154/c-van-dorsten"}, "is_accepted": false, "score": 0, "last_activity_date": 1549446676, "last_edit_date": 1549446676, "creation_date": 1549442757, "answer_id": 54549585, "question_id": 36585685, "link": "https://stackoverflow.com/questions/36585685/writing-a-vba-function-to-sum-cost-per-hour-into-cost-per-day-and-then-into/54549585#54549585", "title": "Writing a VBA function to sum &quot;Cost Per Hour&quot; into &quot;Cost Per Day&quot; and then into &quot;Cost per Month&quot;", "body": "<p>Here's your answer. </p>\n\n<pre><code>Private Sub SumCosts(ByVal MainColumn As String, ByVal CostColumn As String, ByVal FirstDataRow As Long, Optional ByVal BracketType As Byte)\n  '\n  'Parameters:\n  'MainColumn: the columns with dates or months.\n  'CostColumn: the column that holds the costs to sum.\n  'FirstDataRow: the first row where the data starts\n  'BracketType: either 0 for hours or 1 for months\n  '\n  'This procedure assumes that in the data on the sheet\n  '- every hour of every day in the hours columns\n  '- every day of a month is present in the days columns\n  'are present. I.e. All hours of all 31 days of January are persent\n  'in the 'Date' column before the hours of February start and all days of January\n  'are present in the 'Month' column before the days of February start.\n  Const Hours As Byte = 24\n  '\n  Dim Cel As Range\n  Dim I As Long\n  Dim J As Long\n  Dim K As Long\n  Dim Rng As String\n  Dim Bracket As Byte\n  Dim Days As Byte\n  '\n  'Clean the target area, so the modle can be reused time after time.\n  Set Cel = Range(MainColumn &amp; Application.Rows.Count).Offset(0, 1)\n  Rng = Split(Cel.Address, \"$\")(1)\n  Rng = (Rng &amp; FirstDataRow &amp; \":\" &amp; Rng &amp; Cel.End(xlUp).Row)\n  Range(Rng).ClearContents\n  '\n  J = FirstDataRow\n  For Each Cel In Range(MainColumn &amp; \":\" &amp; MainColumn)\n    If Cel.Value = vbNullString Then Exit For\n    If Cel.Row &gt; (FirstDataRow - 1) Then\n      'Number of days in a month. Since this fluctuates the bracket fluctuates.\n      Days = DateSerial(Year(Cel.Value), Month(Cel.Value) + 1, 1) - DateSerial(Year(Cel.Value), Month(Cel.Value), 1)\n      Bracket = IIf(BracketType = 0, Hours, Days)  'Select the bracket to use.\n      K = ((Cel.Row - 1) * Bracket) + (FirstDataRow - 1)  'Determine where to stop calculating for a given day or month.\n      For I = J To K\n        Cel.Offset(0, 1).Value = Cel.Offset(0, 1).Value + Range(CostColumn &amp; I).Value  'Do the calculation.\n      Next\n      J = K + 1  'Next loop we must pick up where we left off.\n    End If\n  Next\nEnd Sub\n\nPublic Sub LaunchCostCalculations()\n  SumCosts \"O\", \"M\", 2, 0\n  SumCosts \"R\", \"P\", 2, 1\nEnd Sub\n</code></pre>\n\n<p>Create a button in your sheet to launch LaunchCostCalculations and Bob's your uncle.</p>\n"}], "owner": {"reputation": 1, "user_id": 6195817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a7df69ebd83226a5ab867ea3b66b43?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Bass", "link": "https://stackoverflow.com/users/6195817/jon-bass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 401, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1549446676, "creation_date": 1460502447, "last_edit_date": 1549413688, "question_id": 36585685, "link": "https://stackoverflow.com/questions/36585685/writing-a-vba-function-to-sum-cost-per-hour-into-cost-per-day-and-then-into", "title": "Writing a VBA function to sum &quot;Cost Per Hour&quot; into &quot;Cost Per Day&quot; and then into &quot;Cost per Month&quot;", "body": "<p>I am trying to model the cost of my home heating unit. I have 3.15 years of hourly data. I calculated cost per hour, cost per day, cost per month, and cost per year. I want to write two VBA function, one called <code>CostPerDay</code> and the other called <code>CostPerMonth</code> in order to simplify the process when I add more data. I have attached a picture of my data. </p>\n\n<p>Picture of Data</p>\n\n<p><a href=\"https://i.stack.imgur.com/7e5jB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7e5jB.png\" alt=\"enter image description here\"></a></p>\n\n<p>The function I wrote for Cost Per Day is: </p>\n\n<pre><code>=SUM(OFFSET($M$18,(ROW()-18)*24,0,24,1))\n</code></pre>\n\n<p>The function I wrote for Cost Per Month is:</p>\n\n<pre><code>Jan-13 =SUM(OFFSET($P$18,(ROW()-18)*31,0,31,1))\nFeb-13 =SUM(OFFSET($P$49,(ROW()-19)*28,0,28,1))\nMar-13 =SUM(OFFSET($P$77,(ROW()-20)*31,0,31,1))\nEtc...\n</code></pre>\n\n<p>In case you need the whole range of data:</p>\n\n<pre><code>Cost Per Hour - M18:M27636\nCost Per Day - P18:P1168\nCost Per Month - S18:S55\nAverage Cost Per Month - V18:V29\n</code></pre>\n\n<p>This is what I was trying. As you can see, I am new to VBA. In the first attempt, I was trying to use Dim to define where the data was located in the spreadsheet and which cell I wanted the calculation in. I got stuck because I couldn't insert the <code>=SUM(OFFSET($M$18,(ROW()-18)*24,0,24,1))</code>function into VBA. I then was trying to make get rid of the hard-coded <code>$M$18</code>by replacing it with <code>Cells(Match(Day,O18:O1168)+17,\"P\")</code>. But none of it worked.</p>\n\n<p>The second one I was playing with dialogue boxes, but I don't think I want to use them.</p>\n\n<p>In the third attempt I was trying to calculate Cost Per Month. I don't have it because I didn't save it. I was using <code>SUMIFS</code>to match Months with the number of days in the month. That may have been my closest attempt but it still didn't work.</p>\n\n<pre><code>Function CostPerDay(BeginningCostPerDay, OutputCell)\n    Dim BeginningCostPerDay, OutputCell\n        BeginningCostPerDay = WorksheetFunction.DSum()\n        OutputCell = ActiveCell.Offset(3, -3).Activate\nEnd Function\n\nFunction CostPerDay1()\n    Dim myValue1 As Variant, myValue2 As Variant\n        myValue1 = InputBox(\"Where do you want the data put?\")\n        myValue2 = InputBox(\"What is the beginning Cost Per Day\")\n            Range(\"myValue1\").Value = myValue1\n            Range(\"myValue2\").Value = myValue2\n\nEnd Function\n</code></pre>\n"}, {"tags": ["c#", "vba", "excel"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 2, "creation_date": 1460502341, "post_id": 36585633, "comment_id": 60770121, "body": "&quot;It doesn&#39;t work&quot; is not a problem statement.  Are you getting any error messages?  What are they?  On which line of code are you getting these error messages?"}, {"owner": {"reputation": 1, "user_id": 6195746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9b42973ad233a5e55d22dbdbe1d7fcf?s=128&d=identicon&r=PG&f=1", "display_name": "MeLop", "link": "https://stackoverflow.com/users/6195746/melop"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1460502690, "post_id": 36585633, "comment_id": 60770232, "body": "yeah, you&#39;re right, sorry, I get the code error &quot;Cannot apply indenxing with [] to an expression of type &#39;Array&#39; &quot;"}, {"owner": {"reputation": 1, "user_id": 6195746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9b42973ad233a5e55d22dbdbe1d7fcf?s=128&d=identicon&r=PG&f=1", "display_name": "MeLop", "link": "https://stackoverflow.com/users/6195746/melop"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1460502800, "post_id": 36585633, "comment_id": 60770266, "body": "On the line <i>oWb.Application.Workbooks.Open(ar[y]);</i>"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1460502886, "post_id": 36585633, "comment_id": 60770296, "body": "Isn&#39;t <code>Files</code> already an array?  You tested for that in <code>if (Files is Array)</code>.  So you shouldn&#39;t need all those casts in <code>Array ar = (Array)((object)Files);</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1460503454, "post_id": 36585633, "comment_id": 60770504, "body": "Why are you using the Excel <code>GetOpenFilename</code> method?  Is there a reason not to use the native .NET tooling for that?"}, {"owner": {"reputation": 1, "user_id": 6195746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9b42973ad233a5e55d22dbdbe1d7fcf?s=128&d=identicon&r=PG&f=1", "display_name": "MeLop", "link": "https://stackoverflow.com/users/6195746/melop"}, "edited": false, "score": 0, "creation_date": 1460503708, "post_id": 36585633, "comment_id": 60770595, "body": "Yes, <code>Files</code> is an array but without that cast I get the error code <i>Unable to cast object of type &#39;System.Object[*]&#39; to type &#39;System.Object[]&#39;.</i>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1460535821, "post_id": 36585633, "comment_id": 60782434, "body": "<code>Array</code> in C# is not an array in VBA: use ar.GetValue(y).ToString();"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1460627277, "last_edit_date": 1460627277, "creation_date": 1460537594, "answer_id": 36593261, "question_id": 36585633, "link": "https://stackoverflow.com/questions/36585633/equivalent-excel-macro-to-c/36593261#36593261", "title": "Equivalent Excel Macro to C#", "body": "<p>An <code>Array</code> is a special type of class in C# and is not the same as a VBA array. If you use <code>Array</code>, then you need to address an individual element like this:</p>\n\n<pre><code>ar.GetValue(y).ToString();\n</code></pre>\n\n<p>More information on the Array class can be found in the <a href=\"https://msdn.microsoft.com/en-us/library/system.array%28v=vs.110%29.aspx\" rel=\"nofollow\">MSDN</a> documentation. C# does have the concept of an array - note the non-capitalization. It is declared more like this:</p>\n\n<pre><code>string[] ar = new string[iNumberOfMembers];\n</code></pre>\n\n<p>And that can be addressed using <code>ar[y]</code></p>\n"}], "owner": {"reputation": 1, "user_id": 6195746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9b42973ad233a5e55d22dbdbe1d7fcf?s=128&d=identicon&r=PG&f=1", "display_name": "MeLop", "link": "https://stackoverflow.com/users/6195746/melop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519164418, "creation_date": 1460502157, "last_edit_date": 1531164843, "question_id": 36585633, "link": "https://stackoverflow.com/questions/36585633/equivalent-excel-macro-to-c", "title": "Equivalent Excel Macro to C#", "body": "<p>I have a Excel Macro that I'm trying to translate to C#, but i don't know how to translate this part:</p>\n\n<pre><code>Dim Files As Variant\nDim glos As Integer\nDim Sheet1 As Object\nDim Un As Workbook\n\nFiles = Application.GetOpenFilename(\"Excel Files (*.xlsx), *.xlsx\", 2, \"Open Files\", , True)\nIf IsArray(Files) Then\n    'Something with some data\n    For y = LBound(Files) To UBound(Files)\n        Workbooks.Open Files(y)\n        b = ActiveWorkbook.Name\n        glos =  glos + 1\n        For Each Sheet1 In ActiveWorkbook.Sheets\n            Sheet1.Copy after:= Un.Sheets(Un.Sheets.Count)\n        Next\n        Workbooks(b).Close False\n    Next\nEnd IF\n</code></pre>\n\n<p>I have tried some methods, but doesn't work, well I have this so far in C#:</p>\n\n<pre><code>var excelApp = new Excel.Application();\nExcel.Workbook oWB = excelApp.Workbooks.Add(Type.Missing);\n\ndynamic Files = oWb.Application.GetOpenFilename(\"Excel Files (*.xlsx), *.xlsx\", 2, \"Select Files\", Type.Missing, true);\nif (Files is Array)\n{\n    //Something with some data\n    Array ar = (Array)((object)Files);\n    for(int y = ar.GetLowerBound(1); y &lt; ar.GetUpperBound(1); y++)\n    {\n        oWB.Application.Workbooks.Open(ar[y]);\n        b = excelApp.ActiveWorkbook.Name;\n        glos += 1;\n        foreach(Excel.Sheets Sheet1 in excelApp.ActiveWorkbook.Sheets)\n        { \n            Sheet1.Copy(After: Un.Sheets[Un.Sheets.Count]);\n        }\n        ExcelApp.Workbooks[b].Close(false);\n    }\n}\n</code></pre>\n\n<p>I have been trying to improve my skills translating some macros that I use in my work to C# but I get stuck in this one, sorry for the bad english, I'm still learning the language. </p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel", "date", "format"], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 0, "last_activity_date": 1460563536, "creation_date": 1460563536, "answer_id": 36603908, "question_id": 36585113, "link": "https://stackoverflow.com/questions/36585113/date-format-issue-on-excel/36603908#36603908", "title": "Date format issue on excel", "body": "<p>Date values are stored in a worksheet cell as a numerical value so different formats can be applied to different cells and still retain the ability to compare (or add, subtract, etc). The formula you're applied to each cell is forcing a comparison in a specific text format when the actual value.</p>\n\n<p>The key is to set your formula up to use the <strong>address</strong> of the cell, not the cell contents.</p>\n\n<p>So your cell formula can simply be:</p>\n\n<p><code>ActiveSheet.Cells(intcounter, x + 1).Formula = \"=If(\" &amp; Cells(intcounter, rFind.Column).Address &amp; \"&gt;=\" &amp; Cells(intcounter, rFind1.Column).Address &amp; \",\"\"\"review\"\"\",\"\"\"disabled\"\"\")\"</code></p>\n"}], "owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 36603908, "answer_count": 1, "score": 2, "last_activity_date": 1460563536, "creation_date": 1460499670, "last_edit_date": 1460531828, "question_id": 36585113, "link": "https://stackoverflow.com/questions/36585113/date-format-issue-on-excel", "title": "Date format issue on excel", "body": "<p>Hi I have a problem with a macro which copies information from one workbook and paste it into another. Then it creates two columns and fill them with an IF formula to compare two dates. Those formulas bring the wrong result as one of the columns have another date format, and I can't change it, whatever I do on the cell is not working, only if I erase the value on any cell of that column and write a date I can change the format.</p>\n\n<p>The main format needed is YYYY-MM-DD, but this column is set as dd/mm/yyyy, even if I update the cell and set it as date or custom it doesn't work at all, it keeps showing the wrong format.</p>\n\n<p>This is the macro I work on, is there any way to solve this issue?</p>\n\n<p>Thank you in advance.</p>\n\n<pre><code>    Sub AD_Audit()\n\n'Last cell in column\nDim ws As Worksheet\nDim LastCell As Range\nDim LastCellRowNumber As Long\nDim wb3 As Workbook\n\nSet ws = Worksheets(2)\nWith ws\n    Set LastCell = .Cells(.Rows.Count, \"A\").End(xlUp)\n    LastCellRowNumber = LastCell.Row + 1\nEnd With\n\nDim Wb As Workbook, wb2 As Workbook\nDim vFile As Variant\n\n'Set source workbook\nSet Wb = ActiveWorkbook\n\n'Open the target workbook\nvFile = Application.GetOpenFilename(\"Excel-files,*.xlsx\", _\n    1, \"Select One File To Open\", , False)\n\n'if the user didn't select a file, exit sub\nIf TypeName(vFile) = \"Boolean\" Then Exit Sub\nWorkbooks.Open vFile\n\n'Set selectedworkbook\nSet wb2 = ActiveWorkbook\n\n'Select cells to copy\nwb2.Worksheets(2).Range(\"A1:BD\" &amp; ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Row).Select\nSelection.Copy\n\n'Go back to original workbook you want to paste into\nWb.Activate\n\n'Paste starting at the last empty row\nWb.Worksheets(2).Activate\nWb.Worksheets(2).Range(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n  Application.CutCopyMode = False\nApplication.ScreenUpdating = True\n\nDim LstrDate As String\nDim LDate As Date\n\nLstrDate = \"Apr 6, 2003\"\nLDate = CDate(LstrDate)\n\n'search for columns containing the data needed\nDim x As Integer\nDim lastRow As Long\nlastRow = Cells.Find(What:=\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n\nDim rFind As Range\nWith Range(\"A:DB\")\n        Set rFind = .Find(What:=\"Account Last Updated\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n        If Not rFind Is Nothing Then\nEnd If\nEnd With\n\n Dim rFind1 As Range\n\n    With Range(\"A:DB\")\n        Set rFind1 = .Find(What:=\"Termination Date\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n        If Not rFind1 Is Nothing Then\n\n        End If\n    End With\n\n    Dim rFind2 As Range\n\n    With Range(\"A:DB\")\n        Set rFind2 = .Find(What:=\"Last Password set date\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n        If Not rFind2 Is Nothing Then\n        End If\n    End With\n\n'create columns and fill them with formulas\nx = ActiveSheet.UsedRange.Columns.Count\nActiveSheet.Cells(1, x + 1) = \"Account last updated after termination\"\nintcounter = 2\nWhile (intcounter &lt;= lastRow)\n    ActiveSheet.Cells(intcounter, x + 1).Formula = \"=IF(TEXT(\"\"\" &amp; Cells(intcounter, rFind.Column) &amp; \"\"\",\"\"YYYY/MM/DD\"\")&gt;=TEXT(\"\"\" &amp; Cells(intcounter, rFind1.Column) &amp; \"\"\",\"\"YYYY/MM/DD\"\"),\"\"review\"\",\"\"disabled\"\")\"\n    intcounter = intcounter + 1\nWend\n\n\nx = ActiveSheet.UsedRange.Columns.Count\nActiveSheet.Cells(1, x + 1) = \"Password After Termination\"\nintcounter = 2\nWhile (intcounter &lt;= lastRow)\n    ActiveSheet.Cells(intcounter, x + 1).Formula = \"=IF(TEXT(\"\"\" &amp; Cells(intcounter, rFind2.Column) &amp; \"\"\",\"\"YYYY/MM/DD\"\")&gt;=TEXT(\"\"\" &amp; Cells(intcounter, rFind1.Column) &amp; \"\"\",\"\"YYYY/MM/DD\"\"),\"\"review\"\",\"\"old\"\")\"\n    intcounter = intcounter + 1\nWend\n\n'add column Actions\nWorksheets(2).Range(\"A1\").EntireColumn.Insert\nWorksheets(2).Range(\"A1\").Formula = \"Actions\"\n\n'Set headers to bold text\nRows(1).Font.Bold = True\n\n\n'check for filter, turn on if none exists\n  If Not ActiveSheet.AutoFilterMode Then\n    ActiveSheet.Range(\"A1:BD1\").AutoFilter\n  End If\n  Dim Notes As Object, Maildb As Object, workspace As Object, UIdoc As Object, UserName As String\nDim MailDbName As String\n\nThisWorkbook.Activate\nFor Each Wb In Workbooks\n     If Not (Wb Is ActiveWorkbook) Then Wb.Close savechanges:=False\nNext\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1460499722, "post_id": 36585032, "comment_id": 60769078, "body": "I doubt there is such method. The general consensus is that if you need to ask this question, you are doing something wrong, because during normal operation you do not come anywhere close the limits. A proper source of Excel limits would be <a href=\"https://support.office.com/en-us/article/Excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>, but it does not specify the particular ones you mention. The <code>Name</code> limit is not surprising though because there is a limit of 255 characters for VBA variable names."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1460499963, "post_id": 36585032, "comment_id": 60769175, "body": "I also doubt this is possible through code (other than checking for exceptions like you&#39;re basically doing).  The workaround solution would be to <a href=\"https://github.com/OfficeDev/VBA-content\" rel=\"nofollow noreferrer\">suggest changes to the documentation</a> to add the method and property limits when you run across them."}, {"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1460500474, "post_id": 36585032, "comment_id": 60769398, "body": "@GSerg, Yeah, your probably right there no way to do this, but I think there&#39;s certainly value in being able to hijack properties of objects such as tables/charts/embedded objects/etc to store related data in which ever format you choose(XML/JSON/CSV), probably just have to go about that another way :( I&#39;m sure this is not what the designers thought the properties would be used for, though it still makes me wonder why they would enforce such limits(as they differ for each string), anyways its always good to dream..."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1460500769, "post_id": 36585032, "comment_id": 60769520, "body": "Would looking up the methods online be an answer? <a href=\"https://msdn.microsoft.com/en-us/library/aa445183(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa445183(v=vs.60).aspx</a> says &quot;An object&#39;s Name property must start with a letter and can be a maximum of 40 characters&quot;?  Or are you wanting a way to do this in the coding environment, not Google?"}, {"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1460500911, "post_id": 36585032, "comment_id": 60769574, "body": "@Comintern This really strikes me as a systematic issue with VBA as a language and office as a platform, Designers add limits and then don&#39;t document them and provide no way, other than by hand, to find those limits they&#39;ve imposed. The real systematic solution to this issue is that I suggest updates to every MSDN VBA page for every string in every object(because I&#39;m pretty sure most of them have a limit, though that could be contested), and that&#39;s only after testing each property by hand... That will never happen"}, {"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1460501133, "post_id": 36585032, "comment_id": 60769654, "body": "@BruceWayne For that specific example you have provided a very good answer, unfortunately documentation providing the maximum string length for a object&#39;s string is rarely available(though that my be a matter of opinion) I&#39;m looking for a way this can be determined if documentation is not available(like for the first example I provide)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1460501460, "post_id": 36585032, "comment_id": 60769791, "body": "@Dave13s - Well, the only real alternative I can think of is to start disassembling the Excel executables and libraries, run some code analysis tools on them, and see if you can find the buffer overrun checks in there. This really isn&#39;t something that is exposed to COM - an object doesn&#39;t have a &quot;schema&quot; you can examine.  It seems much more reasonable to check the documentation, if it isn&#39;t there, test it, then pass it forward to the next person by improving the documentation."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1473450000, "post_id": 36585032, "comment_id": 66162306, "body": "Good question but I wonder why you might want a name above 255 characters?"}, {"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1473452374, "post_id": 36585032, "comment_id": 66163329, "body": "@Absinthe For example, putting XML or JSON data in a field, there are other ways to go about this, but it may be convenient to store data attached to an object by hijacking that objects built-in properties and using them to store data/information about that object."}], "answers": [{"comments": [{"owner": {"reputation": 42285, "user_id": 2057919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec600dcd84770c5d835cd4c943514088?s=128&d=identicon&r=PG&f=1", "display_name": "elixenide", "link": "https://stackoverflow.com/users/2057919/elixenide"}, "edited": false, "score": 4, "creation_date": 1475179872, "post_id": 39773471, "comment_id": 66852594, "body": "How about the long answer? A simple &quot;no&quot; is not very helpful."}, {"owner": {"reputation": 219, "user_id": 2807351, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d02cf42f51b64847e6fcb555d229c28e?s=128&d=identicon&r=PG&f=1", "display_name": "Zack Barresse", "link": "https://stackoverflow.com/users/2807351/zack-barresse"}, "reply_to_user": {"reputation": 42285, "user_id": 2057919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec600dcd84770c5d835cd4c943514088?s=128&d=identicon&r=PG&f=1", "display_name": "elixenide", "link": "https://stackoverflow.com/users/2057919/elixenide"}, "edited": false, "score": 0, "creation_date": 1475278976, "post_id": 39773471, "comment_id": 66895319, "body": "I gave a longer answer. A Mr. Ed Cottrell (<a href=\"http://stackoverflow.com/users/2057919/ed-cottrell\">stackoverflow.com/users/2057919/ed-cottrell</a>) deleted it for some reason, and didn&#39;t give any explanation. Suffice to say there&#39;s no way to get that because it wasn&#39;t put in the application. The &quot;why&quot;, of course, is a different story.  For everyone giving down votes to my answer above, I understand you think it&#39;s not helpful, but the moderator has tied my hands. Apologies for brevity."}, {"owner": {"reputation": 42285, "user_id": 2057919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec600dcd84770c5d835cd4c943514088?s=128&d=identicon&r=PG&f=1", "display_name": "elixenide", "link": "https://stackoverflow.com/users/2057919/elixenide"}, "edited": false, "score": 2, "creation_date": 1475279279, "post_id": 39773471, "comment_id": 66895375, "body": "Actually, your first &quot;answer&quot; was merely an insulting rant. It didn&#39;t offer any real guidance to OP,  so I deleted it. This one is better, but only because it&#39;s not as rude. It&#39;s not very helpful, but it at least doesn&#39;t violate the site&#39;s <a href=\"http://stackoverflow.com/help/be-nice\">&quot;Be Nice&quot;</a> policy. I would suggest you read about <a href=\"https://stackoverflow.com/questions/how-to-answer\">How to Answer</a> questions here."}], "tags": [], "owner": {"reputation": 219, "user_id": 2807351, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d02cf42f51b64847e6fcb555d229c28e?s=128&d=identicon&r=PG&f=1", "display_name": "Zack Barresse", "link": "https://stackoverflow.com/users/2807351/zack-barresse"}, "is_accepted": false, "score": -3, "last_activity_date": 1475160389, "creation_date": 1475160389, "answer_id": 39773471, "question_id": 36585032, "link": "https://stackoverflow.com/questions/36585032/generic-way-to-determine-the-maximum-allowed-length-a-of-string/39773471#39773471", "title": "Generic Way to Determine the Maximum Allowed Length a of String", "body": "<p>The short answer is no.</p>\n\n<p>Regards, Zack Barresse</p>\n"}, {"comments": [{"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "edited": false, "score": 0, "creation_date": 1510327654, "post_id": 47221007, "comment_id": 81402307, "body": "CustomDocumentProperties are <a href=\"https://stackoverflow.com/questions/42120915/how-to-overcome-custom-document-property-size-limit\">very limited in length</a>, or course you can get around that by <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/49f2b496-ed25-4c91-946e-3b1c3684f677/custom-document-properties-is-there-a-limit-to-how-many-can-be-created?forum=exceldev\" rel=\"nofollow noreferrer\">splitting your data into pieces</a> but again that is a very inelegant solution. Of course I long ago came up with a different workaround. The point of my question is that no matter the workaround, it always a sub-optimal solution :("}, {"owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "edited": false, "score": 0, "creation_date": 1510327856, "post_id": 47221007, "comment_id": 81402435, "body": "Of course I think your answer is the best attempt at solving this so far, I&#39;ll have to do some testing with it but as far as I can tell this is probably the best method we&#39;re every going to get(I would love if someone proved me wrong)."}, {"owner": {"reputation": 2159, "user_id": 2822719, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GJ5Hr.jpg?s=128&g=1", "display_name": "Marcus Mangelsdorf", "link": "https://stackoverflow.com/users/2822719/marcus-mangelsdorf"}, "reply_to_user": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "edited": false, "score": 0, "creation_date": 1510497748, "post_id": 47221007, "comment_id": 81450297, "body": "Oh, I didn&#39;t know about the 255 chars length limit for custom document properties. But the <a href=\"https://stackoverflow.com/a/42121489/2822719\">suggested solution using <code>Custom XML Parts</code></a> seems perfect to store meta information alongside the document, albeit handling XML with VBA code might be a bit hard... - still gonna update my answer with a reference to this possibility :)"}], "tags": [], "owner": {"reputation": 2159, "user_id": 2822719, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GJ5Hr.jpg?s=128&g=1", "display_name": "Marcus Mangelsdorf", "link": "https://stackoverflow.com/users/2822719/marcus-mangelsdorf"}, "is_accepted": false, "score": 1, "last_activity_date": 1510499181, "last_edit_date": 1525816189, "creation_date": 1510310832, "answer_id": 47221007, "question_id": 36585032, "link": "https://stackoverflow.com/questions/36585032/generic-way-to-determine-the-maximum-allowed-length-a-of-string/47221007#47221007", "title": "Generic Way to Determine the Maximum Allowed Length a of String", "body": "<p>First of all, if your intention is to store <em>meta information about objects</em>, you could maybe make use of <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-customdocumentproperties-property-excel\" rel=\"nofollow noreferrer\"><code>CustomDocumentProperties</code></a>. You can find examples on their usage <a href=\"https://stackoverflow.com/q/14863250/2822719\">here</a> and <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=677\" rel=\"nofollow noreferrer\">here</a> and some nice wrappers by Chip Pearson <a href=\"http://www.cpearson.com/excel/docprop.aspx\" rel=\"nofollow noreferrer\">here</a>.<br>\nSince they are still very limited (255 chars) in length (thanks for pointing that out!), the best solution might be to use <code>CustomXMLParts</code> like <a href=\"https://stackoverflow.com/a/42121489/2822719\">described here</a>. The hard part would then be building correct XML using VBA, but maybe not impossible, if you add a reference to <em>Microsoft XML</em>.</p>\n\n<p>But to provide some help with your question concerning maximum lengths for string properties, too, here is a <strong>test setup</strong> you can use to (relatively) quickly find these limits for arbitrary properties.\nJust replace the <code>ActiveWorkbook.Sheets(1).Name</code> on line 19 with the property you want to test and run <strong><code>TestMaxStringLengthOfProperty()</code></strong>:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nConst PRINT_STEPS = True   ' If True, calculation steps will be written to Debug.Print\n\n\nPrivate Function LengthWorks(ByVal iLengthToTest As Long) As Boolean\n\n   Dim testString As String\n   testString = String(iLengthToTest, \"#\")   ' Build string with desired length\n   ' Note: The String() method failed for different maximum string lengths possibly\n   '       depending on available memory or other factors. You can test the current \n   '       limit for your setup by putting the string assignment in the test space.\n   '       In my tests I found maximum values around 1073311725 to still work.\n\n   On Error Resume Next\n   ' ---------------------------------------------------------------------------------\n   '   Start of the Test Space - put the method/property you want to test below here\n\n   ActiveWorkbook.Sheets(1).Name = testString\n\n   '   End of the Test Space - put the method/property you want to test above here\n   ' ---------------------------------------------------------------------------------\n   LengthWorks = Err.Number = 0\n   On Error GoTo 0\n\nEnd Function\n\n\nPrivate Sub TestMaxStringLengthOfProperty()\n\n   Const MAX_LENGTH As Long = 1000000000 ' Default: 1000000000\n   Const MAXIMUM_STEPS = 100     ' Exit loop after this many tries, at most\n\n   ' Initialize variables for check loop\n   Dim currentLength As Long\n   Dim lowerBoundary As Long: lowerBoundary = 0\n   Dim upperBoundary As Long: upperBoundary = MAX_LENGTH\n\n   Dim currentStep As Long: currentStep = 0\n   While True    ' Infinite loop, will exit sub directly\n      currentStep = currentStep + 1\n      If currentStep &gt; MAXIMUM_STEPS Then\n         Debug.Print \"Exiting because maximum number of steps (\" &amp; _\n                      CStr(MAXIMUM_STEPS) &amp; _\n                     \") was reached. Last working length was: \" &amp; _\n                      CStr(lowerBoundary)\n         Exit Sub\n      End If\n\n      ' Test the upper boundary first, if this succeeds we don't need to continue search\n      If LengthWorks(upperBoundary) Then\n         ' We have a winner! :)\n         Debug.Print \"Method/property works with the following maximum length: \" &amp; _\n                     upperBoundary &amp; vbCrLf &amp; _\n                     \"(If this matches MAX_LENGTH (\" &amp; _\n                      MAX_LENGTH &amp; \"), \" &amp; _\n                     \"consider increasing it to find the actual limit.)\" &amp; _\n                      vbCrLf &amp; vbCrLf &amp; _\n                     \"Computation took \" &amp; currentStep &amp; \" steps\"\n         Exit Sub\n      Else\n         ' Upper boundary must be at least one less\n         upperBoundary = upperBoundary - 1\n         PrintStep upperBoundary + 1, \"failed\", lowerBoundary, upperBoundary, MAX_LENGTH\n      End If\n\n      ' Approximately halve test length\n      currentLength = lowerBoundary + ((upperBoundary - lowerBoundary) \\ 2)\n         ' \"\\\" is integer division (http://mathworld.wolfram.com/IntegerDivision.html)\n         ' Using `left + ((right - left) \\ 2)` is the default way to avoid overflows\n         ' when calculating the midpoint for our binary search\n         ' (see: https://en.wikipedia.org/w/index.php?title=Binary_search_algorithm&amp;\n         '                                        oldid=809435933#Implementation_issues)\n\n      If LengthWorks(currentLength) Then\n         ' If test was successful, increase lower boundary for next step\n         lowerBoundary = currentLength + 1\n         PrintStep currentLength, \"worked\", lowerBoundary, upperBoundary, MAX_LENGTH\n      Else\n         ' If not, set new upper boundary\n         upperBoundary = currentLength - 1\n         PrintStep currentLength, \"failed\", lowerBoundary, upperBoundary, MAX_LENGTH\n      End If\n\n   Wend\n\nEnd Sub\n\n\nPrivate Sub PrintStep(ByVal iCurrentValue As Long, _\n                      ByVal iWorkedFailed As String, _\n                      ByVal iNewLowerBoundary As Long, _\n                      ByVal iNewUpperBoundary As Long, _\n                      ByVal iMaximumTestValue As Long)\n   If PRINT_STEPS Then\n      Debug.Print Format(iCurrentValue, String(Len(CStr(iMaximumTestValue)), \"0\")) &amp; _\n                  \" \" &amp; iWorkedFailed &amp; \" - New boundaries: l: \" &amp; _\n                  iNewLowerBoundary &amp; \" u: \" &amp; iNewUpperBoundary\n   End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2274, "user_id": 2912011, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pjwRu.png?s=128&g=1", "display_name": "David Rogers", "link": "https://stackoverflow.com/users/2912011/david-rogers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1128, "favorite_count": 3, "answer_count": 2, "score": 11, "last_activity_date": 1525881084, "creation_date": 1460499372, "last_edit_date": 1525881084, "question_id": 36585032, "link": "https://stackoverflow.com/questions/36585032/generic-way-to-determine-the-maximum-allowed-length-a-of-string", "title": "Generic Way to Determine the Maximum Allowed Length a of String", "body": "<p>Take a look at this property(Given you have a table on the first worksheet):</p>\n\n<pre><code>Application.Sheets(1).ListObjects(1).name\n</code></pre>\n\n<p>How many characters can this property contain? Well, after testing out a few strings I've come to the conclusion that its 255, any string with more than 255 characters causes an error to be thrown:</p>\n\n<blockquote>\n  <p>Run-Time Error 5 - Invalid procedure call or arguement</p>\n</blockquote>\n\n<p>Take a look at this property:</p>\n\n<pre><code>Application.Sheets(1).ListObjects(1).Summary\n</code></pre>\n\n<p>How many characters can this property contain? Again, test several strings and you'll come out with a number that's around 50,000, You set it any higher and you get the same error, except in this case excel will sometimes crash or spit out a different error(after multiple attempts):</p>\n\n<pre><code>Dim i As Integer\nDim a As String\n\nFor i = 1 To 5001\n    a = a &amp; \"abcdefghih\"\nNext i\n\nApplication.Sheets(1).ListObjects(1).Summary = a\n</code></pre>\n\n<blockquote>\n  <p>Method \"Summary\" of object 'ListObject' failed</p>\n</blockquote>\n\n<p>This sort of \"hidden\" character limit comes up all over the place(<a href=\"https://stackoverflow.com/questions/2516702/getting-around-the-max-string-size-in-a-vba-function\">here</a>, <a href=\"http://excelribbon.tips.net/T013175_Using_Very_Long_Worksheet_Tab_Names.html\" rel=\"nofollow noreferrer\">here</a>, <a href=\"https://stackoverflow.com/questions/30888993/vba-unexpected-reach-of-string-size-limit\">less specifically here</a>, <a href=\"https://stackoverflow.com/a/3681908/2912011\">and so classically here</a>), and it doesn't seem like they're documented anywhere, for example take a look at the page for <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841184.aspx\" rel=\"nofollow noreferrer\">ListObject.Name</a>, its not noted how many characters you can store in that variable...</p>\n\n<p>So is there a better way to determine this? Are the strings you are setting in properties being stored in a fixed length string somewhere that can be accessed to determine what their maximum length is, or is there some other form of documentation that can be leveraged in order to obtain this information?</p>\n\n<p>It strikes me as odd these character limits that are set on most strings within standard VBA objects, I wonder what their purpose is, why the designers choose to limit \"ListObjects.name\" to 255 characters and whether that was an arbitrary default limit or whether that was a conscious decision that was made. I believe that the standard string length is <a href=\"https://stackoverflow.com/a/10927873/2912011\">this</a>, I wonder why the deviation from this standard.</p>\n\n<p>To summarize the points I've made above and to condense this question into one sentence:</p>\n\n<p>Is there a generic way to determine the maximum length of a string that can be set within an object's property, without first testing that string's property by giving it another value and ignoring errors/checking for character truncation?</p>\n"}, {"tags": ["vba", "ms-access", "if-statement"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1460496469, "post_id": 36583949, "comment_id": 60767614, "body": "Do you have to keep the order of the elements?"}, {"owner": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1460496760, "post_id": 36583949, "comment_id": 60767744, "body": "what do you mean? if you mean [qty1] and [raw1] must stay together then yes but if you are asking if [qty2] must follow [qty1] and so on then no"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1460497927, "post_id": 36583949, "comment_id": 60768329, "body": "Are you trying to find the &#39;best fit&#39; from the eight quantities (i.e. find exact match, or find match with least quantity exceeding &#39;Make Quantity&#39;? Also, it appears all of these fields are on a form, populated by some recordset?"}, {"owner": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "edited": false, "score": 0, "creation_date": 1460498026, "post_id": 36583949, "comment_id": 60768378, "body": "yes the [raw1] is a price related to [qty1] the [raw2] is a price related to [qty2] etc. These values have been entered previously. Now on this current form, the user enters a make quantity, and I need to find the nearest applicable [qty] and [raw] price. Sorry if this is a confusing statement, I don&#39;t know how else to describe what I&#39;m doing"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1460498966, "post_id": 36583949, "comment_id": 60768768, "body": "Are there always only eight &#39;qty&#39; fields (qty1-qy8), and are they all obtained from a some recordsource for your form? If so, and you desire to find an exact match or a qty with the least overage, then it would be simple to create a function to give you the answer. I can help you if that&#39;s the case, otherwise, I still don&#39;t understand what you are trying to do."}, {"owner": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "edited": false, "score": 0, "creation_date": 1460499690, "post_id": 36583949, "comment_id": 60769067, "body": "yes there are 8 qty&#39;s with 8 corresponding prices in a recordset. The user now enters a make quantity, and I need to find the closest qty to the make qty to use that price. eg, 10,20,30,40,50,60,70,80 are qty&#39;s 5,6,7,8,9.10,11,12 are the related prices. if the user enters 46 as the make qty, then this value is between 40 and 50, and so I would use the 4th price 8. if the make qty was 77 then I would use the price 11 and so on. the code I posted does this fine , provided the values are ascending as I said, but if the are descending or mixed then the code fails."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1460500210, "post_id": 36583949, "comment_id": 60769297, "body": "Let&#39;s make sure I understand... you want to find the field on the form that contains either an exact match, or the field that is LESS than AND the CLOSEST match?"}], "answers": [{"comments": [{"owner": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "edited": false, "score": 0, "creation_date": 1460502343, "post_id": 36585581, "comment_id": 60770123, "body": "hi wayne - thanks for this - i&#39;ll need to try it out tomorrow and get back to you"}, {"owner": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "edited": false, "score": 0, "creation_date": 1460572237, "post_id": 36585581, "comment_id": 60810248, "body": "Ive modified the above code slightly and it works fine, however I need a small tweak if you can advise.  If I have quantities of 20 and 30, and the user enters a make qty of 27, I need the raw qty to be that associated with 20 not 30. The above code will pick 20 for values from 20 to 25, and then will pick 30 for values between 26 and 30. can you suggest how to achieve this. - thanks"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "edited": false, "score": 0, "creation_date": 1460573269, "post_id": 36585581, "comment_id": 60810881, "body": "Well, now I need more info. Will the QTY values always be MOD 10, or can they be any value? If MOD 10, then easy, if not MOD 10, then define when you take a &#39;20&#39; instead of a &#39;21&#39;."}, {"owner": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "edited": false, "score": 0, "creation_date": 1460574580, "post_id": 36585581, "comment_id": 60811732, "body": "the qty&#39;s can be any value. - think of them as break qty and prices from a supplier. eg. 10 off &#163;2.50 20 off &#163;2.20 30 off &#163;2.10 - the supplier gives a better price for greater qty&#39;s, and so if the user then needs a 15 off, then the 10off price is valid aka &#163;2.50  equally if the user enters 19 off, then the price will still be &#163;2.50 as the second break qty hasn&#39;t been reached. Though the qty&#39;s are usually in 10&#39;s, this isn&#39;t always true, as you could have break qty&#39;s of 1,3,5,10,25 or whatever, so there is need to handle all these variations. - I hope this helps to explain what i&#39;m trying to do"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "edited": false, "score": 0, "creation_date": 1460576112, "post_id": 36585581, "comment_id": 60812640, "body": "OK, what value is supposed to be returned if &#39;Make Quantity&#39; is less than ALL &#39;qty&#39; fields? Or will there always be a qty of 1?"}, {"owner": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "edited": false, "score": 0, "creation_date": 1460583471, "post_id": 36585581, "comment_id": 60816757, "body": "if the make qty is less than all the qty&#39;s then default to smallest [qty]"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "edited": false, "score": 0, "creation_date": 1460585701, "post_id": 36585581, "comment_id": 60817743, "body": "I modified the code so that if you look for a QTY that is less than the lowest qty listed on the form, it will use the price associated with the lowest QTY; and if looking for a QTY greater than highest QTY on form, use the price for that one. Let me know if you have questions..."}, {"owner": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "edited": false, "score": 0, "creation_date": 1460642275, "post_id": 36585581, "comment_id": 60846675, "body": "just finished testing and its great - works like a charm - thanks for your support"}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": true, "score": 2, "last_activity_date": 1460585567, "last_edit_date": 1460585567, "creation_date": 1460501901, "answer_id": 36585581, "question_id": 36583949, "link": "https://stackoverflow.com/questions/36583949/how-can-i-make-the-following-code-work-with-both-ascending-and-descending-number/36585581#36585581", "title": "how can i make the following code work with both ascending and descending numbers", "body": "<p>UPDATED!! Changed code so that if QTY &lt; lowest, default to lowest; if > highest, use highest.</p>\n\n<p>Here's some code I threw together... since I don't have your data, i loaded test data into 8 pairs of textboxes (using your field names).  Note that I used the 'CHANGE' event for the 'Make Quantity' textbox to invoke the code. You can force execution however you like...</p>\n\n<p>Once satisfied, comment out the Debug statements and the MsgBox.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Sub Form_Load()\nDim i   As Integer\nDim MakeQuantity    As Integer\nDim materialprice    As Double\n\nMe.qty1 = 30: Me.qty2 = 20: Me.qty3 = 70: Me.qty4 = 50: Me.qty5 = 10: Me.qty6 = 60: Me.qty7 = 80: Me.qty8 = 70\nMe.raw1 = 3.3: Me.raw2 = 2.2: Me.raw3 = 7.7: Me.raw4 = 5.5: Me.raw5 = 1.1: Me.raw6 = 6.6: Me.raw7 = 8.8: Me.raw8 = 7.7\n\nEnd Sub\n\n\n    Private Sub Make_Quantity_AfterUpdate()\nDim i       As Integer\nDim iDiff   As Integer\nDim iLow    As Integer\nDim iMatch  As Integer\nDim iHigh   As Integer\nDim dPriceL As Double\nDim dPriceH As Double\nDim dPriceM As Double\nDim iQtyL   As Integer\nDim iQtyH   As Integer\n\n    iLow = 30000\n    iHigh = 0\n    iMatch = 10\n    Debug.Print \"Find Qty of: \" &amp; Me.[Make Quantity]\nFor i = 1 To 8\n    If Int(Me(\"qty\" &amp; i)) &lt;= iLow Then\n        iLow = Int(Me(\"qty\" &amp; i))\n        dPriceL = Me(\"raw\" &amp; i)\n        iQtyL = Int(Me(\"qty\" &amp; i))\n    End If\n    If Int(Me(\"qty\" &amp; i)) &gt;= iHigh Then\n        iHigh = Int(Me(\"qty\" &amp; i))\n        dPriceH = Me(\"raw\" &amp; i)\n        iQtyH = Int(Me(\"qty\" &amp; i))\n    End If\n\n    iDiff = Abs(Me.[Make Quantity] - Me(\"qty\" &amp; i))\n    If Int(Me(\"qty\" &amp; i)) &lt;= Int(Me.[Make Quantity]) Then\n        If iDiff &lt;= iMatch Then\n            iMatch = iDiff\n            dPriceM = Me(\"raw\" &amp; i)\n        End If\n    End If\n    Debug.Print \"i: \" &amp; i &amp; vbTab &amp; \"Qty: \" &amp; Me(\"qty\" &amp; i) &amp; vbTab &amp; \"Diff: \" &amp; iDiff &amp; vbTab &amp; \"Raw: \" &amp; Me(\"raw\" &amp; i)\nNext i\n\n    If dPriceM &lt;&gt; 0 Then    ' Did we find a suitable match?\n        MsgBox \"Make Quantity: \" &amp; Me.[Make Quantity] &amp; vbCrLf &amp; \"Price: \" &amp; dPriceM\n    Else        ' Didn't find a good match; must be &lt; lowest or &gt; highest\n        If iQtyL &gt; Int(Me.[Make Quantity]) Then     ' Greater than lowest QTY, use Lowest QTY price...\n            MsgBox \"Make Quantity: \" &amp; Me.[Make Quantity] &amp; vbCrLf &amp; \"Price: \" &amp; dPriceL\n        ElseIf iQtyH &lt; Int(Me.[Make Quantity]) Then     ' Greater than highest QTY, use highest QTY price...\n            MsgBox \"Make Quantity: \" &amp; Me.[Make Quantity] &amp; vbCrLf &amp; \"Price: \" &amp; dPriceH\n        Else\n            MsgBox \"Impossible? Asked for Qty of: \" &amp; Me.[Make Quantity] &amp; vbCrLf &amp; _\n                \"Lowest Qty: \" &amp; iQtyL &amp; vbTab &amp; _\n                \"Highest Qty: \" &amp; iQtyH\n\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 585, "user_id": 818763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3a7b02ee0519cf881c40d84340333292?s=128&d=identicon&r=PG", "display_name": "superllanboy", "link": "https://stackoverflow.com/users/818763/superllanboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 36585581, "answer_count": 1, "score": 0, "last_activity_date": 1460585567, "creation_date": 1460494837, "last_edit_date": 1460494935, "question_id": 36583949, "link": "https://stackoverflow.com/questions/36583949/how-can-i-make-the-following-code-work-with-both-ascending-and-descending-number", "title": "how can i make the following code work with both ascending and descending numbers", "body": "<p>I am using the code below to find a value in 8 [qty] fields which is closest in value to the value in [make quantity] field.\nThe code works as I want provided the value in the [qty] fields are ascending values. eg. 10,20,30,40,50,60,70,80</p>\n\n<p>The code fails if the values are descending, or mixed  eg. 80,70,60,50,40,30,20,10 or 10,30,50,40,70,20,80 etc</p>\n\n<p>can anyone suggest how to handle this in a better way</p>\n\n<pre><code>If Me![Make Quantity] &lt;= Me![qty1] Then\n    materialprice = Me![raw1]\n\nElseIf Me![Make Quantity] &lt;= Me![qty2] And Me![Make Quantity] &gt; Me![qty1] Then\n    materialprice = Me![raw1]\n\nElseIf Me![Make Quantity] &lt;= Me![qty3] And Me![Make Quantity] &gt; Me![qty2] Then\n    materialprice = Me![raw2]\n\nElseIf Me![Make Quantity] &lt;= Me![qty4] And Me![Make Quantity] &gt; Me![qty3] Then\n    materialprice = Me![raw3]\n\nElseIf Me![Make Quantity] &lt;= Me![qty5] And Me![Make Quantity] &gt; Me![qty4] Then\n    materialprice = Me![raw4]\n\nElseIf Me![Make Quantity] &lt;= Me![qty6] And Me![Make Quantity] &gt; Me![qty5] Then\n    materialprice = Me![raw5]\n\nElseIf Me![Make Quantity] &lt;= Me![qty7] And Me![Make Quantity] &gt; Me![qty6] Then\n    materialprice = Me![raw6]\n\nElseIf Me![Make Quantity] &lt;= Me![qty8] And Me![Make Quantity] &gt; Me![qty7] Then\n    materialprice = Me![raw7]\n\nElse\n    materialprice = Me![raw8]\n\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel", "timer"], "comments": [{"owner": {"reputation": 11, "user_id": 6193486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2698e5f0e7efef491dc1b980ea8aeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "TWalker", "link": "https://stackoverflow.com/users/6193486/twalker"}, "edited": false, "score": 0, "creation_date": 1460496163, "post_id": 36583915, "comment_id": 60767462, "body": "Here&#39;s a picture of the data sheet:"}, {"owner": {"reputation": 11, "user_id": 6193486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2698e5f0e7efef491dc1b980ea8aeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "TWalker", "link": "https://stackoverflow.com/users/6193486/twalker"}, "edited": false, "score": 0, "creation_date": 1460496421, "post_id": 36583915, "comment_id": 60767594, "body": "Okay...can&#39;t add a picture. But I have 8 data sheets that record the task time for 8 different tasks (the start time and the final duration). That&#39;s great, but I need to improve the usability of the tool. So, I would like to have one worksheet with the buttons to start/stop each macro, but I need the macro to still run on the individual worksheets. I hope that&#39;s a little clearer."}], "answers": [{"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1460509800, "creation_date": 1460509800, "answer_id": 36586802, "question_id": 36583915, "link": "https://stackoverflow.com/questions/36583915/macro-on-multiple-worksheets-need-summary-worksheet-to-control-macros-on-other/36586802#36586802", "title": "Macro on multiple worksheets: Need summary worksheet to control macros on other sheets", "body": "<p>I'm not sure you need to call your timer routine in each worksheet. You really only need one routine and knowledge of which worksheet to assign the times to. </p>\n\n<p>One way would be with a kind of control panel of buttons on a <code>UserForm</code>. It might look something like this (just 3 worksheets as example):</p>\n\n<p><a href=\"https://i.stack.imgur.com/vCLWd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vCLWd.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then you'd handle all of the click events within the <code>UserForm</code> code. In this example, I've created a collection of Worksheets and each item is accessed by a string key which is the button's name. Skeleton code would be:</p>\n\n<pre><code>Option Explicit\nPrivate Const START_COLOUR As Long = &amp;HFF00&amp;\nPrivate Const START_TEXT As String = \"Start\"\nPrivate Const STOP_COLOUR As Long = &amp;HFF&amp;\nPrivate Const STOP_TEXT As String = \"Stop\"\nPrivate mSheets As Collection\n\nPrivate Sub btnClock1_Click()\n    StartStopButton btnClock1\nEnd Sub\n\nPrivate Sub btnClock2_Click()\n    StartStopButton btnClock2\nEnd Sub\n\nPrivate Sub btnClock3_Click()\n    StartStopButton btnClock3\nEnd Sub\n\nPrivate Sub StartStopButton(btn As CommandButton, Optional initialise As Variant)\n    Dim ws As Worksheet\n    Dim v As Variant\n    Dim startTime As Date\n\n    Set ws = mSheets(btn.Name)\n    ws.Activate\n\n    If Not IsMissing(initialise) Then\n\n        'Initialise the button and sheet\n        SetProperties btn, CBool(initialise)\n        ws.Range(\"A1\").Value = \"Not yet actioned\"\n        ws.Range(\"B1:D1\").ClearContents\n\n    Else\n\n        If btn.BackColor = START_COLOUR Then\n            'Set clock running\n            SetProperties btn, True\n            ws.Range(\"A1\").Value = \"Running\"\n            ws.Range(\"B1\").Value = Now\n            ws.Range(\"C1:D1\").ClearContents\n        Else\n            'Stop clock and calculate difference\n            SetProperties btn, False\n            ws.Range(\"A1\").Value = \"Stopped\"\n            ws.Range(\"C1\").Value = Now\n            v = ws.Range(\"B1\").Value\n            If Not IsEmpty(v) And IsDate(v) Then\n                'For DateDiff, choose whichever unit you want, I've used seconds (\"s\")\n                ws.Range(\"D1\").Value = DateDiff(\"s\", v, Now)\n            End If\n        End If\n\n    End If\n\nEnd Sub\nPrivate Sub SetProperties(btn As CommandButton, running As Boolean)\n    With btn\n        If running Then\n            .Caption = STOP_TEXT\n            .BackColor = STOP_COLOUR\n        Else\n            .Caption = START_TEXT\n            .BackColor = START_COLOUR\n        End If\n    End With\n\nEnd Sub\nPrivate Sub UserForm_Initialize()\n    Dim ws As Worksheet\n\n    'Assign all worksheets to collection\n    Set mSheets = New Collection\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    mSheets.Add ws, btnClock1.Name\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet2\")\n    mSheets.Add ws, btnClock2.Name\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet3\")\n    mSheets.Add ws, btnClock3.Name\n\n    'Set all buttons to start\n    StartStopButton btnClock1, False\n    StartStopButton btnClock2, False\n    StartStopButton btnClock3, False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6193486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2698e5f0e7efef491dc1b980ea8aeb4c?s=128&d=identicon&r=PG&f=1", "display_name": "TWalker", "link": "https://stackoverflow.com/users/6193486/twalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1460509800, "creation_date": 1460494687, "last_edit_date": 1531164843, "question_id": 36583915, "link": "https://stackoverflow.com/questions/36583915/macro-on-multiple-worksheets-need-summary-worksheet-to-control-macros-on-other", "title": "Macro on multiple worksheets: Need summary worksheet to control macros on other sheets", "body": "<p>I have a timer macro on multiple, identical worksheets. My users will time their task time and each worksheet represents a different task. I need to have a summary sheet with the macros that start and stop time that is linked to each worksheet so that my users don't have to toggle back and forth between sheets to start the timers for each task. Can you help. Here is the timer code I'm using. It works well on each worksheet, but I don't know how to code the buttons on a summary worksheet to activate this code on a specific worksheet. Here's the code:</p>\n\n<pre><code> Sub startStopTimer()\n\nIf Range(\"j4\") = \"Start\" Then\n    Range(\"$b$8\").Offset(Range(\"j6\") + 1).Value = Now\n    Range(\"j4\") = \"Stop\"\nElse\n    Range(\"$b$8\").Offset(Range(\"j6\"), 1).Value = Now - Range(\"$b$8\").Offset(Range(\"j6\"))\n    Range(\"$j$4\") = \"Start\"\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 53, "user_id": 6121367, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/893dcf8a904862ae4e5f7cc4d2e5a780?s=128&d=identicon&r=PG&f=1", "display_name": "Shrewd1", "link": "https://stackoverflow.com/users/6121367/shrewd1"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1460495124, "post_id": 36583436, "comment_id": 60766943, "body": "Would it matter if there are other WorkSheet Macros that contain protect/unprotect commands within them?  Are they conflicting somehow?"}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1460495185, "post_id": 36583436, "comment_id": 60766975, "body": "Try adding <code>.EnableOutlining = True</code>"}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1460495281, "post_id": 36583436, "comment_id": 60767018, "body": "@Shrewd1 If the sheet is already protected, you would need to unprotect it first, with any password it may have."}, {"owner": {"reputation": 53, "user_id": 6121367, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/893dcf8a904862ae4e5f7cc4d2e5a780?s=128&d=identicon&r=PG&f=1", "display_name": "Shrewd1", "link": "https://stackoverflow.com/users/6121367/shrewd1"}, "edited": false, "score": 0, "creation_date": 1460495609, "post_id": 36583436, "comment_id": 60767187, "body": "Adding &quot;.EnableOutlining = True&quot; worked Demetri!"}, {"owner": {"reputation": 53, "user_id": 6121367, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/893dcf8a904862ae4e5f7cc4d2e5a780?s=128&d=identicon&r=PG&f=1", "display_name": "Shrewd1", "link": "https://stackoverflow.com/users/6121367/shrewd1"}, "edited": false, "score": 0, "creation_date": 1460496794, "post_id": 36583436, "comment_id": 60767762, "body": "Not able to use AutoFilters still?"}], "owner": {"reputation": 53, "user_id": 6121367, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/893dcf8a904862ae4e5f7cc4d2e5a780?s=128&d=identicon&r=PG&f=1", "display_name": "Shrewd1", "link": "https://stackoverflow.com/users/6121367/shrewd1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460492878, "creation_date": 1460492878, "last_edit_date": 1531164843, "question_id": 36583436, "link": "https://stackoverflow.com/questions/36583436/protect-sheets-while-allowing-user-to-access-some-formatting-functionality", "title": "Protect Sheets while allowing user to access some formatting functionality", "body": "<p>Have the following code at the Workbook object level, but it's not allowing for the autofilter or ungrouping of columns.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    For Each ws In Sheets\n        With ws\n            .Protect Password:=\"xxxxxxxx\", Userinterfaceonly:=True,      \n            AllowFormattingColumns:=True, AllowFormattingRows:=True, _\n            AllowFiltering:=True, AllowInsertingRows:=True,   \n            AllowSorting:=True, AllowDeletingRows:=True\n        End With\n\nNext ws\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-office"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1460535950, "post_id": 36583413, "comment_id": 60782514, "body": "What&#39;s the error message? That&#39;s much more understandable than an error number..."}, {"owner": {"reputation": 16, "user_id": 2770315, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e2bad2deecff0e19225f55d903956e5f?s=128&d=identicon&r=PG&f=1", "display_name": "VKid", "link": "https://stackoverflow.com/users/2770315/vkid"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1460552350, "post_id": 36583413, "comment_id": 60795246, "body": "Error #70 Permission denied."}], "owner": {"reputation": 16, "user_id": 2770315, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e2bad2deecff0e19225f55d903956e5f?s=128&d=identicon&r=PG&f=1", "display_name": "VKid", "link": "https://stackoverflow.com/users/2770315/vkid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460552374, "creation_date": 1460492772, "last_edit_date": 1531164843, "question_id": 36583413, "link": "https://stackoverflow.com/questions/36583413/chart-object-export-errors", "title": "Chart.Object.Export Errors", "body": "<p>I'm getting random #70 Permission denied errors when running this macro code at <code>.ChartObjects(1).Chart.Export</code>      </p>\n\n<p>Sometimes it works and sometimes it doesn't. I've also tried changing the path of the save image to desktop and sometimes that works. Could there be a process somewhere that is locking up the folder it is being saved to?</p>\n\n<pre><code>Dim TempFilename As String\nWith ActiveSheet\n\n        With .Shapes(MyChart)\n            .Width = PicWidth\n            .Height = PicHeight\n        End With\n\n        .Shapes(MyPicture).Copy\n\n        With ActiveChart\n            .ChartArea.Select\n            .Paste\n        End With\n\n        .ChartObjects(1).Chart.Export Filename:=ThisWorkbook.Path &amp; \"\\\" &amp; TempFilename, FilterName:=\"jpg\"\n        .Shapes(MyChart).Cut\n\nEnd With\n</code></pre>\n"}]