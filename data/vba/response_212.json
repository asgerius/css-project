[{"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1548898706, "post_id": 54451126, "comment_id": 95712687, "body": "Which statement causes the message that you do not like?  Its not clear whether Yes or No was responded to the prior question.  You should be able to set debug on the statement  Cancel = False  and then step thru until you find more info."}, {"owner": {"reputation": 863, "user_id": 8103207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c210559b7bccc6fdf9441e91c0df97ee?s=128&d=identicon&r=PG", "display_name": "YHoffman", "link": "https://stackoverflow.com/users/8103207/yhoffman"}, "edited": false, "score": 0, "creation_date": 1548906804, "post_id": 54451126, "comment_id": 95714348, "body": "I am not by a windows pc now, but I think your error is that you are trying to access the new record before you saved it, i,e, this code is still running in the <code>BeforeUpdate</code> time"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1548910984, "post_id": 54451126, "comment_id": 95715459, "body": "Why is a table open? Are you the only user of this db?"}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1548977417, "last_edit_date": 1548977417, "creation_date": 1548909508, "answer_id": 54453381, "question_id": 54451126, "link": "https://stackoverflow.com/questions/54451126/error-catching-a-form-in-access-using-vba/54453381#54453381", "title": "Error catching a form in Access using VBA", "body": "<p>Review <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Access.Form.BeforeUpdate(even)\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/Access.Form.BeforeUpdate(even)</a></p>\n\n<p>Instead of GoToControl, use SetFocus.\nI did a very simple test with the Undo question and it does work:</p>\n\n<pre><code>Private Sub Form_BeforeUpdate(Cancel As Integer)\nIf IsNull(Me.customer_f_name) Then\n    MsgBox \"Must enter customer name.\"\n    Cancel = True\n    If MsgBox(\"Do you want to undo edits?\", vbYesNo) = vbYes Then Me.Undo\n    Me.customer_f_name.SetFocus\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Suggest you put table code in AfterUpdate event.</p>\n"}, {"tags": [], "owner": {"reputation": 573, "user_id": 8497252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67538554b474d977f956003e2febeaf?s=128&d=identicon&r=PG&f=1", "display_name": "Cahaba Data", "link": "https://stackoverflow.com/users/8497252/cahaba-data"}, "is_accepted": false, "score": 0, "last_activity_date": 1549034162, "creation_date": 1549034162, "answer_id": 54482246, "question_id": 54451126, "link": "https://stackoverflow.com/questions/54451126/error-catching-a-form-in-access-using-vba/54482246#54482246", "title": "Error catching a form in Access using VBA", "body": "<p>so to supplement J7, with some big picture view: \"basically only want the form to be saved once everything has been filled in\" \u2026. that is swimming against the tide; which is why you are having to write a lot of code.  The product enters data as you go fundamentally.  that is it's core design.</p>\n\n<p>it is very normal to do field checks as you go - typically in the AfterUpdate event, the check code is applied and if invalid - generate a message box and invoke an Undo plus reset the focus back to the field they were attempting to leave.</p>\n\n<p>A totally different design, in some cases it may justify a temp local duplicate table just for the purposes of holding form input data - - this approach allows a very elaborate check(s) against data in the production database; where upon if valid an Append Query then writes the data into the permanent table.</p>\n"}], "owner": {"reputation": 1, "user_id": 10993117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bf473cb50bb2c8dfaad36dfbf9db506?s=128&d=identicon&r=PG&f=1", "display_name": "joeblogger12", "link": "https://stackoverflow.com/users/10993117/joeblogger12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1549034162, "creation_date": 1548890849, "last_edit_date": 1548906252, "question_id": 54451126, "link": "https://stackoverflow.com/questions/54451126/error-catching-a-form-in-access-using-vba", "title": "Error catching a form in Access using VBA", "body": "<p>So i have a form that's updating a table in Microsoft Access. I'm using a BeforeUpdate event call to stop the form from updating if the 'first name' hasn't been filled in. </p>\n\n<p>I basically only want the form to be saved once everything has been filled in, and then switch to see the updated table (the bit under If not cancel).</p>\n\n<p>Currently the popup box to say 'You must enter a First Name' correctly fires, the next pop up box asking if the user wants to undo any changes fires. But then a pop up box saying 'No current record' appears and then the view changes to the table. I'm not sure why this is all happening. </p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub Form_BeforeUpdate(Cancel As Integer)\n\n   Cancel = False\n\n' perform data validation\nIf IsNull(Me.customer_f_name) Then\n\n   MsgBox \"You must enter a First Name.\", vbCritical, \"Data entry error...\"\n   Me.customer_f_name.BorderColor = vbRed\n   DoCmd.GoToControl \"customer_f_name\"\n\n   Cancel = True\n\nEnd If\n\nIf Not Cancel Then\n\n    DoCmd.SelectObject acTable, \"ticket_tracker_table\"\n    DoCmd.Requery\n    DoCmd.GoToRecord acDataTable, \"ticket_tracker_table\", acLast\n\nEnd If\n\n' if the save has been canceled or did not pass the validation , then ask to Undo changes\nIf Cancel Then\n\n    If MsgBox(\"Do you want to undo any changes?\", vbYesNo, \"Confirm\") = vbYes Then\n        Me.Undo\n    End If\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548891644, "post_id": 54450949, "comment_id": 95710908, "body": "Are you updating the entire text content of the comment, or just a part of it?  The <code>Characters</code> collection is only really useful up to about 255 characters, but you don&#39;t need it if you&#39;re updating the full content."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548923652, "post_id": 54450949, "comment_id": 95720773, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1548906216, "creation_date": 1548906216, "answer_id": 54452966, "question_id": 54450949, "link": "https://stackoverflow.com/questions/54450949/trying-to-change-the-attributes-of-a-cells-comment-object-the-macro-generated/54452966#54452966", "title": "Trying to change the attributes of a Cell&#39;s Comment object. The macro generated by Excel does not work", "body": "<h1>A Small Comment Study</h1>\n\n<ul>\n<li>I couldn't find anything except the <code>AutoSize</code> property which will\nresize to the longest row of text, so you will have to write the text\ne.g. 40 characters maximally per line.</li>\n<li>To place the comment, use the properties of the cell range (<code>Top</code>,\n<code>Height</code>, <code>Left</code> and <code>Width</code>) to adjust the same properties of the\ncomment particularly the <code>Top</code> and <code>Left</code> properties, because the\nother will be changed by <code>AutoSize</code>.</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/vAIgo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vAIgo.jpg\" alt=\"enter image description here\"></a></p>\n\n<h2>The Code</h2>\n\n<pre><code>Sub CommentExample()\n\n    Const cSheet As String = \"Sheet1\"\n    Const cStrRange As String = \"H25\"\n    Const Sep As String = vbLf\n    Const cMargin As Single = 5\n\n    Dim Cell As Range\n    Dim CommEx As Comment\n    Dim str1 As String\n\n    Set Cell = ThisWorkbook.Worksheets(cSheet).Range(cStrRange)\n\n    ' Look in the Immediate Window\n    With Cell\n        str1 = \"Cell 'Area' Properties\"\n        str1 = str1 &amp; Sep &amp; Space(2) &amp; \"Top = \" &amp; .Top\n        str1 = str1 &amp; Sep &amp; Space(2) &amp; \"Height = \" &amp; .Height\n        str1 = str1 &amp; Sep &amp; Space(2) &amp; \"Left = \" &amp; .Left\n        str1 = str1 &amp; Sep &amp; Space(2) &amp; \"Width = \" &amp; .Width\n        Debug.Print str1\n    End With\n\n    Set CommEx = Cell.Comment\n\n    If CommEx Is Nothing Then\n        MsgBox \"No Comment in Cell '\" &amp; cStrRange &amp; \"'.\"\n        Cell.AddComment\n        Set CommEx = Cell.Comment\n    End If\n\n    With CommEx\n        .Visible = True\n        With .Shape.TextFrame.Characters\n            .Delete\n            With .Font\n                .Name = \"Times New Roman\"\n                .Size = 12\n                .Bold = True\n            End With\n        End With\n\n        ' Text Width:   \"======================================== \"\n        .Text _\n                        \"Simply place positive numbers in any of \" _\n                &amp; Sep &amp; \"the cells from G26 thru G43 directly \" _\n                &amp; Sep &amp; \"above the cell that displays the total \" _\n                &amp; Sep &amp; \"amount just to the right of the word \" _\n                &amp; Sep &amp; \"\"\"Total\"\". They will be added together \" _\n                &amp; Sep &amp; \"and displayed in the cell next to the \" _\n                &amp; Sep &amp; \"word \"\"Total\"\".\" _\n                &amp; Sep _\n                &amp; Sep &amp; \"If you want to subtract a number simply \" _\n                &amp; Sep &amp; \"place a negative sign in front of it.\"\n        ' Text Width:   \"======================================== \"\n\n        With .Shape\n\n           ' Look in the Immediate Window\n            str1 = \"Comment 'Area' Properties (Before AutoSize)\"\n            str1 = str1 &amp; Sep &amp; Space(2) &amp; \"Top = \" &amp; .Top\n            str1 = str1 &amp; Sep &amp; Space(2) &amp; \"Height = \" &amp; .Height\n            str1 = str1 &amp; Sep &amp; Space(2) &amp; \"Left = \" &amp; .Left\n            str1 = str1 &amp; Sep &amp; Space(2) &amp; \"Width = \" &amp; .Width\n            Debug.Print str1\n\n            With .TextFrame\n                ' To use margins you have to set AutoMargins to False.\n                .AutoMargins = False\n                .MarginBottom = cMargin\n                .MarginLeft = cMargin\n                .MarginRight = cMargin\n                .MarginTop = cMargin\n                ' Depending on vbLf, the Autosize property will 'resize to fit'.\n                .AutoSize = True\n            End With\n\n            ' Look in the Immediate Window\n            str1 = \"Comment 'Area' Properties (After AutoSize)\"\n            str1 = str1 &amp; Sep &amp; Space(2) &amp; \"Top = \" &amp; .Top\n            str1 = str1 &amp; Sep &amp; Space(2) &amp; \"Height = \" &amp; .Height\n            str1 = str1 &amp; Sep &amp; Space(2) &amp; \"Left = \" &amp; .Left\n            str1 = str1 &amp; Sep &amp; Space(2) &amp; \"Width = \" &amp; .Width\n            Debug.Print str1\n\n            With .TextFrame\n                ' Look in the Immediate Window\n                str1 = \"Margins\"\n                str1 = str1 &amp; Sep &amp; Space(2) &amp; \"MarginBottom = \" &amp; .MarginBottom\n                str1 = str1 &amp; Sep &amp; Space(2) &amp; \"MarginLeft = \" &amp; .MarginLeft\n                str1 = str1 &amp; Sep &amp; Space(2) &amp; \"MarginRight = \" &amp; .MarginRight\n                str1 = str1 &amp; Sep &amp; Space(2) &amp; \"MarginTop = \" &amp; .MarginTop\n                Debug.Print str1\n            End With\n\n        End With\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1548906557, "creation_date": 1548906557, "answer_id": 54453005, "question_id": 54450949, "link": "https://stackoverflow.com/questions/54450949/trying-to-change-the-attributes-of-a-cells-comment-object-the-macro-generated/54453005#54453005", "title": "Trying to change the attributes of a Cell&#39;s Comment object. The macro generated by Excel does not work", "body": "<p>Perhaps the sub below will solve part of your problem. Call it with code like, <code>SetComment Cells(1, 1), \"Comment text\", True</code> which would append \"Comment text\" to text already existing in a comment in cell A1. Define <em>Concat</em> as False to replace existing text.</p>\n\n<pre><code>Sub SetComment(Cell As Range, _\n               Optional ByVal Txt As String, _\n               Optional ByVal Concat As Boolean)\n    ' 12 Jul 2018\n    ' deletes existing comment if Txt = \"\" and Concat = False\n\n    Dim Cmt As String\n\n    With Cell\n        On Error Resume Next\n        Cmt = .Comment.Text\n        .Comment.Delete\n        On Error GoTo 0\n        If Concat Then\n            If Len(Cmt) Then Cmt = Cmt &amp; Chr(10)\n        Else\n            Cmt = \"\"\n        End If\n\n        Txt = Cmt &amp; Txt\n        If Len(Txt) Then .AddComment Cmt &amp; Txt\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10992372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20086ac5ba10c0e7a9e6607847fb289e?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/10992372/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1548923643, "creation_date": 1548889768, "last_edit_date": 1548923643, "question_id": 54450949, "link": "https://stackoverflow.com/questions/54450949/trying-to-change-the-attributes-of-a-cells-comment-object-the-macro-generated", "title": "Trying to change the attributes of a Cell&#39;s Comment object. The macro generated by Excel does not work", "body": "<p>I want to change the attributes of the text inside in Cell's  Comment object. The automatically generated macro that Excel produced does not work. When running that macro I get the error \"Object doesn't support this property or method\". I fixed this by changing \".ShapeRange\" to \".Shape\". Next the error \"Object doesn't support this action\" was produce by \"TextFrame2\". \nI am providing the following 2 procedures of code. The first is the original the second is my attempt to solve the problem. However my code is generating the error \"Method 'TextFrame' of object 'Shape' failed\".</p>\n\n<pre><code>Sub OriginalMacro()\n\n    Range(\"H25\").Select\n    Selection.ShapeRange.ScaleWidth 3.3647051779, msoFalse,   msoScaleFromTopLeft\n    Selection.ShapeRange.ScaleHeight 1.3800319525, msoFalse, msoScaleFromTopLeft\n    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(2, 322).Font\n        .NameComplexScript = \"Times New Roman\"\n        .NameFarEast = \"Times New Roman\"\n        .Name = \"Times New Roman\"\n    End With\n    Selection.ShapeRange(1).TextFrame2.TextRange.Characters(2, 322).Font.Size = 12\n    Selection.ShapeRange(1).TextFrame2.TextRange.Characters(2, 322).Font.Bold = _\n        msoTrue\n    Range(\"H25\").Comment.Text Text:= _\n        \"Simply place positive numbers in any of the cells from G26 thru G43 directly above the cell that displays the total amount just to the right of the word \"\"Total;\"\". They will be added together and dispa\"\n    Range(\"H25\").Comment.Text Text:= _\n        \"yed in the cell next to the word \"\"Total:\"\". \" &amp; Chr(10) &amp; \"\" &amp; Chr(10) &amp; \"If you want to subtract a number simply place a negative sign in front of it.\" &amp; Chr(10) &amp; \"\" _\n        , Start:=200\n    Selection.ShapeRange.ScaleHeight 1.1283545656, msoFalse, msoScaleFromTopLeft\n    Selection.ShapeRange.ScaleWidth 1.0731088187, msoFalse, msoScaleFromTopLeft\n    Selection.ShapeRange.ScaleWidth 1.0473934127, msoFalse, msoScaleFromTopLeft\n    Range(\"E32\").Select\nEnd Sub\n\nSub FormatCalcComment()\n\n    Range(\"H25\").Select\n    Range(\"H25\").Comment.Visible = True\n    Range(\"H25\").Comment.Shape.ScaleWidth 3.605455577, msoFalse, msoScaleFromTopLeft\n    Range(\"H25\").Comment.Shape.ScaleHeight 1.3080804104, msoFalse, msoScaleFromTopLeft\n    'Range(\"H25\").Comment.Select\n\n    Range(\"H25\").Comment.Shape.Select\n\n    '*********The following line generates the error.**********\n    Range(\"H25\").Comment.Shape.TextFrame.Characters(1, 323).Font.Name = \"Times New Roman\"\n\n        With Range(\"H25\").Comment.Shape.TextFrame.Characters(1, 323).Font\n            .NameComplexScript = \"Times New Roman\"\n            .NameFarEast = \"Times New Roman\"\n            .Name = \"Times New Roman\"\n        End With\n\n    Range(\"H25\").Comment.Shape.TextFrame2.TextRange.Characters(1, 323).Font.Size = 12\n    Range(\"H25\").Comment.Shape.TextFrame2.TextRange.Characters(1, 323).Font.Bold = _\n        msoTrue\n    Range(\"H25\").Comment.Text Text:= _\n        \"Simply place positive numbers in any of the cells from G26 thru G43 directly above the cell that displays the total amount just to the right of the word \"\"Total;\"\". They will be added together and displ\"\n    Range(\"H25\").Comment.Text Text:= _\n        \"ayed in the cell next to the word \"\"Total:\"\". \" &amp; Chr(10) &amp; \"\" &amp; Chr(10) &amp; \"If you want to subtract a number simply place a negative sign in front of it.\" &amp; Chr(10) &amp; \"\" _\n        , Start:=200\n    Range(\"H25\").Comment.Shape.ScaleWidth 1.055297049, msoFalse, msoScaleFromTopLeft\n    Range(\"H25\").Comment.Shape.ScaleHeight 1.2445311296, msoFalse, msoScaleFromTopLeft\n    Range(\"H26\").Select\nEnd Sub\n</code></pre>\n\n<p>Should be Bold faced and changed to New Times Roman. And the frame resized to fit.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 33, "user_id": 10992426, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pqoxzoSKmOY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOjry5RXTAISbIw1Q1v5_D1RwMpPQ/mo/photo.jpg?sz=128", "display_name": "Edoardo ", "link": "https://stackoverflow.com/users/10992426/edoardo"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548890063, "post_id": 54450923, "comment_id": 95710513, "body": "All the rows copied in the email are the result of the presence of the &quot;X&quot; in each sheet. Let&#39;s say that the Sheets are the Weeks of the year. I need to send an email with all the shipments still active (so the ones with the &quot;X&quot; in column A) in all the weeks! Hope that is more clear now"}, {"owner": {"reputation": 33, "user_id": 10992426, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pqoxzoSKmOY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOjry5RXTAISbIw1Q1v5_D1RwMpPQ/mo/photo.jpg?sz=128", "display_name": "Edoardo ", "link": "https://stackoverflow.com/users/10992426/edoardo"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548890322, "post_id": 54450923, "comment_id": 95710583, "body": "Yes, Imbut box NO more necessary in this way. I need a sheet with the data of the email addresses, that will be hidden: this sheet must no be considered (but since it won&#39;t have &quot;X&quot; in column A, maybe there&#39;s no reason to exclude it..?!)"}, {"owner": {"reputation": 33, "user_id": 10992426, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pqoxzoSKmOY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOjry5RXTAISbIw1Q1v5_D1RwMpPQ/mo/photo.jpg?sz=128", "display_name": "Edoardo ", "link": "https://stackoverflow.com/users/10992426/edoardo"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548890733, "post_id": 54450923, "comment_id": 95710686, "body": "For what concerns the Range [B:K], it may change, but it will change at the same time and in the samy way for all the sheets!"}, {"owner": {"reputation": 33, "user_id": 10992426, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pqoxzoSKmOY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOjry5RXTAISbIw1Q1v5_D1RwMpPQ/mo/photo.jpg?sz=128", "display_name": "Edoardo ", "link": "https://stackoverflow.com/users/10992426/edoardo"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548890847, "post_id": 54450923, "comment_id": 95710713, "body": "It may change because what I&#39;ve posted is only an example. My project needs some more columns for other data, now omitted to have a more simple sheet. (sorry for my english)"}, {"owner": {"reputation": 33, "user_id": 10992426, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pqoxzoSKmOY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOjry5RXTAISbIw1Q1v5_D1RwMpPQ/mo/photo.jpg?sz=128", "display_name": "Edoardo ", "link": "https://stackoverflow.com/users/10992426/edoardo"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548890991, "post_id": 54450923, "comment_id": 95710749, "body": "If you consider [B:O] as Range, it will be the range of my project! Thanks a lot undearboy"}], "owner": {"reputation": 33, "user_id": 10992426, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pqoxzoSKmOY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOjry5RXTAISbIw1Q1v5_D1RwMpPQ/mo/photo.jpg?sz=128", "display_name": "Edoardo ", "link": "https://stackoverflow.com/users/10992426/edoardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1592693460, "creation_date": 1548889586, "last_edit_date": 1592693460, "question_id": 54450923, "link": "https://stackoverflow.com/questions/54450923/excel-vba-how-to-run-the-same-macro-at-the-same-time-on-all-the-sheets-gener", "title": "Excel VBA - How to run the same macro at the same time on all the sheets - generating one email", "body": "<p>I continue my work starting from the 1st question here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/54448805/excel-vba-outlook-email-body-created-with-rows-having-a-particular-value\">Excel VBA - Outlook Email - Body created with rows having a particular value</a></p>\n\n<p>Now i have another problem.\nI want to repeat the below MACROs on all the SHEETS of my file.</p>\n\n<p>In particular, how can I repeat this function on different SHEETS by only clicking in 1 button present in all the sheets? \nAll the sheets have the same structure.</p>\n\n<p>I mean, the table resulting in the email must be implemented by adding the datas in all the sheets. </p>\n\n<p>The data should be copied starting from the 1st sheet, for ex. TEST(1) to the last sheet, TEST(9). </p>\n\n<p>The email generated after this process must be ONLY one.</p>\n\n<p><strong>Determine the body range</strong></p>\n\n<pre><code>Sub EmailRange()\n\nDim Initial As Range, Final As Range, nCell As Range\n\nOn Error Resume Next\n    Set Initial = Sheets(\"TEST\").Application.InputBox(\"Range\", xTitleId, \"B1:K20\", Type:=8)\nOn Error GoTo 0\n\nFor Each nCell In Initial.Resize(Initial.Rows.Count, 1)\n    If nCell.Offset(, -1) = \"X\" Then\n        If Not Final Is Nothing Then\n            Set Final = Union(Final, nCell.Resize(1, Initial.Columns.Count))\n        Else\n            Set Final = nCell.Resize(1, Initial.Columns.Count)\n        End If\n    End If\nNext nCell\n\nIf Not Final Is Nothing Then\n    MAIL Final\nElse\n    MsgBox \"ATTENZIONE!!!\" &amp; vbNewLine &amp; \"Seleziona un range di celle valido.\", vbOKOnly\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Send the email with the range</strong></p>\n\n<pre><code>Sub MAIL(Final as Range)\n\nDim OutApp As Object, OutMail As Object\nDim StrBodyIn As String, StrBodyEnd As String\n\nStrBodyIn = \"Bonjour,\" &amp; \"&lt;br&gt;\" &amp; \" \" &amp; \"&lt;br&gt;\" &amp; \"Buongiorno,\" &amp; \"&lt;br&gt;\"\nStrBodyEnd = \" \" &amp; \"&lt;br&gt;\" &amp; \"Cordialement\" &amp; \"&lt;br&gt;\" &amp; \" \" &amp; \"&lt;br&gt;\" &amp; Range(\"M2\") &amp; \"&lt;br&gt;\"\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\n  Set OutApp = CreateObject(\"Outlook.Application\")\n  Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n        With OutMail\n            .To = \"email@gmail.com\"\n            .CC = \"\"\n            .BCC = \"\"\n            .Subject = \"SITUATION\"\n            .HTMLBody = \"&lt;p style='font-family:calibri;font-size:16'&gt;\" &amp; StrBodyIn &amp; RangetoHTML(Final) &amp; \"&lt;p style='font-family:calibri;font-size:16'&gt;\" &amp; StrBodyEnd\n            .Display 'or use .Send\n        End With\n    On Error GoTo 0\n\n  Set OutMail = Nothing\n  Set OutApp = Nothing\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I've tried with something like this, but it does not work:</p>\n\n<pre><code>For I = 1 To Worksheets.Count\n    Sheets(I).Select\n\n\n***[...]CODE OF \"Determine the body range\"***\n\n    Next I\nSheets(\"TEST(I)\").Select\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "keypress"], "answers": [{"tags": [], "owner": {"reputation": 568, "user_id": 383423, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f1520ce9ef9f7a58192e40eefbb45b97?s=128&d=identicon&r=PG", "display_name": "mazoula", "link": "https://stackoverflow.com/users/383423/mazoula"}, "is_accepted": false, "score": 0, "last_activity_date": 1548934644, "last_edit_date": 1548934644, "creation_date": 1548934229, "answer_id": 54459625, "question_id": 54450747, "link": "https://stackoverflow.com/questions/54450747/how-can-i-simulate-a-keypress-event-on-a-combo-box-when-i-click-a-buton-on-the-s/54459625#54459625", "title": "How can I simulate a keyPress event on a combo box when I click a buton on the same form im MS Access", "body": "<p>This looks like a problem referring to a control on a sub form from the main form.  I still have trouble getting this right so I use a cheat sheet:</p>\n\n<p><a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow noreferrer\">http://access.mvps.org/access/forms/frm0031.htm</a></p>\n\n<p>I created a main form called main and put 10 buttons named button0 - button9 on the form and I dragged a form called mysubform onto the main form to create a subform.  mysubform has a textbox named projectID.  Then just set the click event to button0 to:</p>\n\n<pre><code>Private Sub button0_Click()\nMe!mysubform.Form!projectID = 0\nEnd Sub\n\n</code></pre>\n\n<p>Don't forget similar click events for buttons 1-9</p>\n\n<p>some things that may be helpful:\n! is the bang operator see:\n<a href=\"https://stackoverflow.com/questions/2923957/bang-notation-and-dot-notation-in-vba-and-ms-access\">Bang Notation and Dot Notation in VBA and MS-Access</a></p>\n\n<p>by default, when you drag a form to create a subform control on another form, access gives the subform control the same name as the dragged form.  so here mysubform refers to the subform control and not the original form used to make the subform.</p>\n\n<p>Then .Form gets the form wrapped by the subform control.  </p>\n\n<p>I hope this answers your question</p>\n"}], "owner": {"reputation": 41, "user_id": 3612239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cbffe15492318b4ea3d3382f47e5fb1?s=128&d=identicon&r=PG&f=1", "display_name": "Juanfran", "link": "https://stackoverflow.com/users/3612239/juanfran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548934644, "creation_date": 1548888581, "last_edit_date": 1548927185, "question_id": 54450747, "link": "https://stackoverflow.com/questions/54450747/how-can-i-simulate-a-keypress-event-on-a-combo-box-when-i-click-a-buton-on-the-s", "title": "How can I simulate a keyPress event on a combo box when I click a buton on the same form im MS Access", "body": "<p>I'm creating a form in MS Access with 10 butons simulatin a numeric keypad (only the values 0..9). </p>\n\n<p>I would like to change the value of a combobox control in a subform each time I click on one of these butons. The combo box control is named \"projectID\" </p>\n\n<p>I tried this but it is not the same as pressing the same key on a keypad.</p>\n\n<pre><code>Private Sub Buton3_Click()\n\n Call Me.frmServDedicacion_Subformulario.Form.projectID_KeyPress(51) 'Ansii code for 3\nend sub\n</code></pre>\n\n<p>I put this procedure as keypress event in order to verifiy the combobox method is executed, and it does (msgbox is ok) but the combobox doesn't receive the KeyAscii value.</p>\n\n<pre><code>Public Sub projectID_KeyPress(KeyAscii As Integer)\n    MsgBox Chr(KeyAscii)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1548887789, "post_id": 54450560, "comment_id": 95709845, "body": "You will need to loop the values in the target range and compare each one at a time."}, {"owner": {"reputation": 3, "user_id": 8877203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10a5f3f2305557d27fe328cd41b093be?s=128&d=identicon&r=PG&f=1", "display_name": "jalexmiller0", "link": "https://stackoverflow.com/users/8877203/jalexmiller0"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1548888990, "post_id": 54450560, "comment_id": 95710222, "body": "@ScottCraner could you give me a brief example of what it would look like? So that I may work off of your example"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1548889127, "post_id": 54450560, "comment_id": 95710255, "body": "<code>For each rng in Target</code>  Do your code <code>Next rng</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8877203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10a5f3f2305557d27fe328cd41b093be?s=128&d=identicon&r=PG&f=1", "display_name": "jalexmiller0", "link": "https://stackoverflow.com/users/8877203/jalexmiller0"}, "edited": false, "score": 0, "creation_date": 1548891054, "post_id": 54450915, "comment_id": 95710771, "body": "Great idea! I&#39;ve included this so it at least won&#39;t break. Thank you"}], "tags": [], "owner": {"reputation": 56, "user_id": 10991106, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OCK6SRwtNLQ/AAAAAAAAAAI/AAAAAAAAAMM/QYNFZoMDKS8/photo.jpg?sz=128", "display_name": "Max Russell", "link": "https://stackoverflow.com/users/10991106/max-russell"}, "is_accepted": false, "score": 0, "last_activity_date": 1548889553, "creation_date": 1548889553, "answer_id": 54450915, "question_id": 54450560, "link": "https://stackoverflow.com/questions/54450560/update-multiple-cells-in-a-column-if-multiple-cells-are-changed-in-another-colum/54450915#54450915", "title": "Update multiple cells in a column if multiple cells are changed in another column", "body": "<p>simplest solution would be to catch a mutiple selection and exit event before any of your code. I would recommend staying with the change event.</p>\n\n<pre><code>Sub worksheet_change(ByVal Target As Range)\nif Target.Cells.Count &gt; 1 then exit sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8877203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10a5f3f2305557d27fe328cd41b093be?s=128&d=identicon&r=PG&f=1", "display_name": "jalexmiller0", "link": "https://stackoverflow.com/users/8877203/jalexmiller0"}, "edited": false, "score": 0, "creation_date": 1548952222, "post_id": 54451534, "comment_id": 95738162, "body": "That was just an implementation so it wouldn&#39;t break for now. Definitely not a permanent fix. I see how my comment made it look like I was taking that as the solution.  I tried pasting in your code but it&#39;s not working. I don&#39;t fully understand what everything is doing in your code so I&#39;m not sure what could be the issue. I have it entered on the Sheet1 code. Is yours meant to be placed in a module perhaps?   Can you clarify what &quot;LCase&quot; means? How would the &quot;On error&quot; work in this situation? Finally, why is &quot;Exit Sub&quot; in the 3rd line of code?"}, {"owner": {"reputation": 3, "user_id": 8877203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10a5f3f2305557d27fe328cd41b093be?s=128&d=identicon&r=PG&f=1", "display_name": "jalexmiller0", "link": "https://stackoverflow.com/users/8877203/jalexmiller0"}, "edited": false, "score": 0, "creation_date": 1548952629, "post_id": 54451534, "comment_id": 95738391, "body": "EDIT: I removed the &quot;exit sub&quot; line and it worked beautifully!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "is_accepted": true, "score": 0, "last_activity_date": 1548957477, "last_edit_date": 1548957477, "creation_date": 1548893583, "answer_id": 54451534, "question_id": 54450560, "link": "https://stackoverflow.com/questions/54450560/update-multiple-cells-in-a-column-if-multiple-cells-are-changed-in-another-colum/54451534#54451534", "title": "Update multiple cells in a column if multiple cells are changed in another column", "body": "<p>Don't run away from the problem with a bandaid solution. Deal with each changed cell in Target whether there is one cell or a thousand and one.</p>\n\n<pre><code>Option Explicit\n\nSub worksheet_change(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"E:E\"), UsedRange.Offset(1, 0)) Is Nothing Then\n        On Error GoTo bye_bye\n        Application.EnableEvents = False\n        Dim t As Range\n        For Each t In Intersect(Target, Range(\"E:E\"), UsedRange.Offset(1, 0))\n            'The offset is set to 3 columns to the right for now\n            ' because I don't want it to update the B column just yet.\n            'When this code is working properly I will switch the offset to -3.\n            Select Case LCase(t.Value)\n                Case vbNullString\n                    t.Offset(, 3) = vbNullString\n                Case \"x\"\n                    t.Offset(, 3) = Format(Now, \"ddd hh:mm:ss\")\n                Case Else\n                    'do nothing?\n            End Select\n        Next t\n\n    End If\n\nbye_bye:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Remember to disable event handling before changing any cell's value on the worksheet or the worksheet_change will run on top of itself.</p>\n"}], "owner": {"reputation": 3, "user_id": 8877203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10a5f3f2305557d27fe328cd41b093be?s=128&d=identicon&r=PG&f=1", "display_name": "jalexmiller0", "link": "https://stackoverflow.com/users/8877203/jalexmiller0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 54451534, "answer_count": 2, "score": 0, "last_activity_date": 1548957477, "creation_date": 1548887495, "last_edit_date": 1548923636, "question_id": 54450560, "link": "https://stackoverflow.com/questions/54450560/update-multiple-cells-in-a-column-if-multiple-cells-are-changed-in-another-colum", "title": "Update multiple cells in a column if multiple cells are changed in another column", "body": "<p>I am creating a task list in excel that will input the current day, date, and time into a column based on the user entering an \"x\" in another column to indicate the task is completed. </p>\n\n<p>From finding some code online, I have written a macro in the sheet code so that when a cell is updated to contain a value in <code>column E</code>. The current day, date, and time are populated in <code>column B</code>. It also clears the date if the cell content is deleted. This all works fine and dandy.</p>\n\n<p>Now I am having issues with if a user were to select a range in <code>column E</code> to delete multiple \"x\"s at a time. The macro errors out and says there is a <code>Type Mismatch</code> on the line:</p>\n\n<pre><code>If Target.Value = 0 Then\n</code></pre>\n\n<p>How can I edit my code to have it also consider if the user selects a region and deletes the \"x\"s from it? </p>\n\n<p>How can I make it so that just the input of \"x\" triggers the code to place the date info? Rather than any sort of content change. </p>\n\n<p><strong>Please note:</strong> The offset is set to 3 columns to the right for now because I don't want it to update the <code>B column</code> just yet. When this code is working properly I will switch the offset to -3.</p>\n\n<pre><code>    Sub worksheet_change(ByVal Target As Range)\n\n    Dim DayName As String\n    Dim lastrow As Long\n    Dim currentRow As Long\n\n    'Sets the current time as TimeNow\n    TimeNow = Now()\n    'Gets the first 3 characters of the weekday and set it as DayName\n    DayName = Left(Format(Date, \"dddd\"), 3)\n    'Gets the last row # of the \"TASK\" column that isn't blank. (Continuously updates as new tasks are added)\n    lastrow = Range(\"D\" &amp; Rows.Count).End(xlUp).row\n\n        If Not Intersect(Target, Range(\"E2:E\" &amp; lastrow)) Is Nothing Then\n\n            If Target.Value = 0 Then\n                ' The offset is set to 3 columns to the right for now because I don't want it to update the B column just yet. When this code is working properly I will switch the offset to -3.\n                Target.Offset(, 3) = vbNullString\n            Else\n                Target.Offset(, 3) = DayName &amp; \" \" &amp; TimeNow\n\n            End If\n\n        End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548887149, "post_id": 54450374, "comment_id": 95709592, "body": "You will get an error if there are no visible cells - you should consider splitting that line up into two - first get the range, then delete if there are any rows to remove.  You need to wrap up the first part in <code>On Error Resume Next</code>-<code>On Error Goto 0</code> or trap the error in the case of no visible rows."}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548887257, "post_id": 54450374, "comment_id": 95709642, "body": "True, but in this case I have 843 visible cells."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548887283, "post_id": 54450374, "comment_id": 95709658, "body": "Is the sheet protected at all?"}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548887396, "post_id": 54450374, "comment_id": 95709701, "body": "Neither the sheet nor the workbook are protected"}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548887453, "post_id": 54450374, "comment_id": 95709718, "body": "I have no issues manually deleting with the <code>delete sheet row</code> button"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548887569, "post_id": 54450374, "comment_id": 95709768, "body": "I&#39;d still try splitting the line to see if you can narrow down the problem."}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548887639, "post_id": 54450374, "comment_id": 95709794, "body": "I tried that with <code>.select</code> then <code>selection.delete</code> to no avail as well. the error remains on the delete line."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 10991106, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OCK6SRwtNLQ/AAAAAAAAAAI/AAAAAAAAAMM/QYNFZoMDKS8/photo.jpg?sz=128", "display_name": "Max Russell", "link": "https://stackoverflow.com/users/10991106/max-russell"}, "is_accepted": false, "score": 3, "last_activity_date": 1548963933, "last_edit_date": 1548963933, "creation_date": 1548888451, "answer_id": 54450726, "question_id": 54450374, "link": "https://stackoverflow.com/questions/54450374/vba-deleting-visible-rows-of-a-table-run-time-error-1004-delete-method-of/54450726#54450726", "title": "VBA Deleting Visible Rows of a Table - Run-time error &#39;1004&#39;: &#39;Delete method of Range class failed&#39;", "body": "<p>Try referencing the range from the list object. Also, remove the <code>EntireRow</code> element. I suddenly remember that causing me issues before!</p>\n\n<pre><code>wsLF.ListObjects(\"Table1\").DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 1, "creation_date": 1548942738, "post_id": 54451029, "comment_id": 95732237, "body": "Thanks, Tim! Is it safe to assume that <code>EntireRow.Delete</code> doesn&#39;t work because part of the row is contained within the object/table?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 1, "creation_date": 1548949660, "post_id": 54451029, "comment_id": 95736655, "body": "I&#39;d guess so, Yes."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1548890249, "creation_date": 1548890249, "answer_id": 54451029, "question_id": 54450374, "link": "https://stackoverflow.com/questions/54450374/vba-deleting-visible-rows-of-a-table-run-time-error-1004-delete-method-of/54451029#54451029", "title": "VBA Deleting Visible Rows of a Table - Run-time error &#39;1004&#39;: &#39;Delete method of Range class failed&#39;", "body": "<p>This works for me (Max Russell also has the same <code>EntireRow</code> comment) </p>\n\n<pre><code>Dim rngVis As Range, tbl As ListObject\n\nSet tbl = wsLF.ListObjects(1)\n\ntbl.Range.AutoFilter Field:=5, Criteria1:=Array(\"N\", \"V\", \"X\"), _\n                     Operator:=xlFilterValues\n\nOn Error Resume Next\nSet rngVis = tbl.DataBodyRange.SpecialCells(xlCellTypeVisible)\nOn Error GoTo 0\n\nApplication.DisplayAlerts = False\nIf Not rngVis Is Nothing Then rngVis.Delete 'no EntireRow\nApplication.DisplayAlerts = True\n\ntbl.Range.AutoFilter Field:=5\n</code></pre>\n"}], "owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1221, "favorite_count": 1, "accepted_answer_id": 54451029, "answer_count": 2, "score": 0, "last_activity_date": 1548963933, "creation_date": 1548886433, "last_edit_date": 1548887117, "question_id": 54450374, "link": "https://stackoverflow.com/questions/54450374/vba-deleting-visible-rows-of-a-table-run-time-error-1004-delete-method-of", "title": "VBA Deleting Visible Rows of a Table - Run-time error &#39;1004&#39;: &#39;Delete method of Range class failed&#39;", "body": "<p>I'm trying to delete all rows with a value of \"N\", \"X\", or \"V\" in column 5. The data is stored in a table called \"Table1\". The data set is quite large which is why I was trying to filter then mass delete instead of looping through each row. </p>\n\n<p>The below code is throwing the error Run-time error '1004': 'Delete method of Range class failed' and I can't for the life of me figure out why. Can anyone point me in the direction of what I'm missing here? I feel like I've successfully used similar code to do the same function before. </p>\n\n<pre><code>'Remove N/X/V records\nwsLF.ListObjects(\"Table1\").Range.AutoFilter Field:=5, Criteria1:= _\n        Array(\"N\", \"V\", \"X\"), Operator:=xlFilterValues\nLastRow = wsLF.Range(\"D\" &amp; wsLF.Rows.Count).End(xlUp).Row\nwsLF.Range(\"$A$1:$W$\" &amp; LastRow).Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete '~~~~~Error on this line\nwsLF.ListObjects(\"Table1\").Range.AutoFilter Field:=5\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1548886635, "post_id": 54450315, "comment_id": 95709417, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22645347/loop-through-all-subfolders-using-vba\">Loop Through All Subfolders Using VBA</a>. (If you go to that question, you can follow a couple other Duplicate questions that should get you where you need to go)."}, {"owner": {"reputation": 17, "user_id": 8343072, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156451924364625/picture?type=large", "display_name": "Endorium", "link": "https://stackoverflow.com/users/8343072/endorium"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1548887201, "post_id": 54450315, "comment_id": 95709617, "body": "I have seen this before  but I cannot adjust it to make it work with the above. I knows it something likely very basic but this is my first ever attempt at macros and struggling with it."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1548887242, "post_id": 54450315, "comment_id": 95709635, "body": "Can you please post the code you tried with?"}, {"owner": {"reputation": 17, "user_id": 8343072, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156451924364625/picture?type=large", "display_name": "Endorium", "link": "https://stackoverflow.com/users/8343072/endorium"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1548894583, "post_id": 54450315, "comment_id": 95711658, "body": "No code in particular. As stated I am completely new to this. I keep trying to mess around with the code but nothing I have tried has come close to running. I realise its the &#39;myPath&#39; section in the above code I need to adjust as its just setting it to one path currently. It does not help when people put up solutions with very little comments in the code."}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1548905230, "post_id": 54450315, "comment_id": 95714000, "body": "@Endorium - looping through sub-folders requires something called recursion.  The most common programming example is creating a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/creating-recursive-procedures\" rel=\"nofollow noreferrer\">function to calculate a factorial</a>.  The code BruceWayne linked to uses recursion.  The <code>Sub DoFolder</code> calls itself inside the <code>For each</code> loop.  Takes a bit to wrap your head around but once it clicks it opens a new world of programming prowess."}, {"owner": {"reputation": 17, "user_id": 8343072, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156451924364625/picture?type=large", "display_name": "Endorium", "link": "https://stackoverflow.com/users/8343072/endorium"}, "edited": false, "score": 0, "creation_date": 1548950098, "post_id": 54450315, "comment_id": 95736955, "body": "Thanks. I will have a go again tonight buy may need help. As you say getting my head around it is proving tricky."}, {"owner": {"reputation": 17, "user_id": 8343072, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156451924364625/picture?type=large", "display_name": "Endorium", "link": "https://stackoverflow.com/users/8343072/endorium"}, "edited": false, "score": 0, "creation_date": 1549127777, "post_id": 54450315, "comment_id": 95796331, "body": "Going to need help with this :( Really tried several ways. Most times it wont even run. I really am stuck where to integrate the loop within my function"}], "owner": {"reputation": 17, "user_id": 8343072, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156451924364625/picture?type=large", "display_name": "Endorium", "link": "https://stackoverflow.com/users/8343072/endorium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548924155, "creation_date": 1548886092, "last_edit_date": 1548923631, "question_id": 54450315, "link": "https://stackoverflow.com/questions/54450315/adjusting-code-to-look-in-sub-folders-for-beginner", "title": "Adjusting code to look in sub-folders for beginner", "body": "<p>I am very new to excel macros. I have the below macros which does what I need perfectly but it only looks in the folder I select and not in its sub-folders. I have had a good google but really having trouble adapting this so it works. Any pointers or help would be very appreciated.</p>\n\n<p>I have seen plenty of other people add the sub folder to there macros but I cannot seem to adapt it for the below. I have many other macros but if I can get it to work for the below making it work across the rest I could then do. Plus its also a very good learning exercise</p>\n\n<pre><code>\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\nDim LastRow As Long\nDim i As Long\n\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n      .Title = \"Select A Target Folder\"\n      .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n'In Case of Cancel\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\n  myExtension = \"*.xls*\"\n\n'Target Path with Ending Extention\n  myFile = Dir(myPath &amp; myExtension)\n\n'Loop through each Excel file in folder\n  Do While myFile &lt;&gt; \"\"\n    'Set variable equal to opened workbook\n      Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n    'Ensure Workbook has opened before moving on to next line of code\n      DoEvents\n\n    'Change First Worksheet's Background Fill Blue\n\n    With wb\n    wb.Worksheets(\"Tests\").Select\n    LastRow = Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To LastRow\n        If Range(\"E\" &amp; i).Value = \"\"\"fixednavigation22\"\"\" Then\n            Range(\"D\" &amp; i).Value = \"Click by id\"\n              End If\n        Next i\n    End With\n\n    'Save and Close Workbook\n      wb.Close SaveChanges:=True\n\n    'Ensure Workbook has closed before moving on to next line of code\n      DoEvents\n\n    'Get next file name\n      myFile = Dir\n  Loop\n\n'Message Box when tasks are completed\n  MsgBox \"Task Complete!\"\n\nResetSettings:\n  'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub```\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1548885666, "post_id": 54450172, "comment_id": 95709109, "body": "Please indent your code - for you and us. This goes a LONG way in trouble shooting."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "edited": false, "score": 1, "creation_date": 1548886052, "post_id": 54450172, "comment_id": 95709234, "body": "You&#39;re opening and closing the txt file for each search. Within each search you&#39;re searching line by line. Both of those will stagnate code execution."}, {"owner": {"reputation": 1352, "user_id": 10814503, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QsZ5pJcPoLg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jT3DgOvSVgL4Sa6iCfK8mLTYcOsw/mo/photo.jpg?sz=128", "display_name": "Angel M.", "link": "https://stackoverflow.com/users/10814503/angel-m"}, "edited": false, "score": 0, "creation_date": 1548886668, "post_id": 54450172, "comment_id": 95709432, "body": "Apart of identing code, it is a best practise to define first the Constants, then the Variables and then put your code. Also... the names for the variables... &quot;Dim x&quot; or &quot;Dim f As Integer&quot; don&#39;t help to understand the purpose."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "edited": false, "score": 0, "creation_date": 1548887168, "post_id": 54450172, "comment_id": 95709601, "body": "Use <code>Option Explicit</code> and you&#39;ll identify undeclared vars like <code>Text</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "edited": false, "score": 0, "creation_date": 1548889772, "post_id": 54450172, "comment_id": 95710434, "body": "Why <i>hex</i> and <i>reg</i> ? They appear to be the same thing."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10934098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2de20929fb43e7af005272c263626e?s=128&d=identicon&r=PG&f=1", "display_name": "JDB", "link": "https://stackoverflow.com/users/10934098/jdb"}, "edited": false, "score": 0, "creation_date": 1548972123, "post_id": 54452093, "comment_id": 95747616, "body": "Thanks. It now takes just over 5 mins to loop through 1000 rows. Is there a way to export all matches , as my code only matches the first match. As there are some instances where there are more than 1 match. could be up to 5 matches."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "reply_to_user": {"reputation": 19, "user_id": 10934098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2de20929fb43e7af005272c263626e?s=128&d=identicon&r=PG&f=1", "display_name": "JDB", "link": "https://stackoverflow.com/users/10934098/jdb"}, "edited": false, "score": 0, "creation_date": 1548980968, "post_id": 54452093, "comment_id": 95750201, "body": "Yes, there is an easy loop for InStr in a Do While Loop by advancing the starting position. Where would you put the additional returns? Column L on the same row is used for the first. Tbh, ~0.333 seconds per search isn&#39;t bad but I was expecting something a little better. It must be the sheer size of the TXT that gums it up the search as well as the initial load time."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "is_accepted": false, "score": 0, "last_activity_date": 1548898218, "creation_date": 1548898218, "answer_id": 54452093, "question_id": 54450172, "link": "https://stackoverflow.com/questions/54450172/text-match-based-on-looping-through-values-in-excel-matching-value-in-a-txt-file/54452093#54452093", "title": "Text Match based on looping through values in excel matching value in a txt file with 3 million rows [to slow]", "body": "<p>I've used a single static read from the text file to avoid repetitive open.read/close calls.</p>\n\n<p>I've removed the use of Sheet8 as a holding/transfer place for values by passing the important and necessary values into the SearchTextFile helper as parameters/arguments.</p>\n\n<p>You provided no information on verify_text_formulas so it is currently commented out.</p>\n\n<p><em>hex</em> and <em>reg</em> seemed to be the same thing; <em>hexa</em> was never used; <em>text</em> was never declared and seemed redundant. I've reduced the use of extraneous variables.</p>\n\n<pre><code>Option Explicit\n\nConst cFileName As String = \"T:\\Hex\\Hex_Codes.txt\"\n\nSub SearchTextFile(Optional hex As String, _\n                   Optional ln As Long = -1, _\n                   Optional closeOff As Boolean = False)\n\n    Static txt As String\n    Dim ff As Integer, p As Long, ps As Long, str As String\n    Dim blnFound As Boolean\n\n    If txt = vbNullString Then\n        'Debug.Print \"new read\"\n        ff = FreeFile(1)\n        Open cFileName For Binary As #ff\n        txt = Space$(LOF(ff))\n        Get #ff, , txt\n        Close #ff\n        txt = vbLf &amp; txt\n    End If\n\n    If closeOff Then\n        'Debug.Print \"closed\"\n        txt = vbNullString\n    Else\n        p = InStr(1, txt, hex, vbBinaryCompare)\n        If p &gt; 0 Then\n            ps = InStrRev(txt, vbLf, p, vbBinaryCompare)\n            str = Chr(39) &amp; Split(Mid(txt, ps + 1, p - ps + 1), \",\")(0)\n            Sheet1.Cells(ln, \"L\") = str\n            blnFound = True\n        End If\n    End If\n\n    If Not blnFound Then\n    End If\n\nerr:\n\nEnd Sub\n\nSub searchReg()\n\n    Dim y As Long\n\n    debug.print timer\n\n    'Application.ScreenUpdating = False\n    'Application.EnableEvents = False\n\n    For y = 2 To Sheet1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        SearchTextFile hex:=Sheet1.Cells(y, \"E\").Value, ln:=y\n    Next y\n\n    SearchTextFile closeOff:=True\n\n    'Call verify_text_formulas\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n    debug.print timer\n\nEnd Sub\n</code></pre>\n\n<p>Post back some timer counts for various record sets if you have a chance. This was tested on a small (30 rows) .TXT file but I would be interested in the time it takes to process larger files.</p>\n"}], "owner": {"reputation": 19, "user_id": 10934098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2de20929fb43e7af005272c263626e?s=128&d=identicon&r=PG&f=1", "display_name": "JDB", "link": "https://stackoverflow.com/users/10934098/jdb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548923617, "creation_date": 1548885465, "last_edit_date": 1548923617, "question_id": 54450172, "link": "https://stackoverflow.com/questions/54450172/text-match-based-on-looping-through-values-in-excel-matching-value-in-a-txt-file", "title": "Text Match based on looping through values in excel matching value in a txt file with 3 million rows [to slow]", "body": "<p>I have some VBA code that loops through all the cells in Column E , it then looks for a match in the text file and enters the first word from the line of text that is matched in the txt file. This works , but when I loop through over 10000 rows , it takes 3 hours to complete. </p>\n\n<p>Just checking if there was a more efficient way of doing this. To speed up the process. Any help would be much appreciated</p>\n\n<pre><code>Sub SearchTextFile()\nDim x\nDim hex, reg As String\nDim strsearch As String\nx = Sheet9.Range(\"Q1\").Value\nDim hexa As String\nConst strFileName = \"T:\\Hex\\Hex_Codes.txt\"\nhex = Sheet9.Range(\"P1\").Value\nreg = Sheet1.Range(\"E\" &amp; x).Value\nIf Right(reg, 1) = \"-\" Then GoTo err\nstrsearch = hex\nDim strLine As String\nDim f As Integer\nDim lngLine As Long\nDim blnFound As Boolean\nf = FreeFile\nOpen strFileName For Input As #f\nDo While Not EOF(f)\nlngLine = lngLine + 1\nLine Input #f, strLine\nIf InStr(1, strLine, strsearch, vbBinaryCompare) &gt; 0 Then\nText = Text &amp; strLine\nOn Error GoTo err\nSheet1.Range(\"L\" &amp; x).Value = Format(Split(Text, \",\")(0), \"@\")\nblnFound = True\nExit Do\nEnd If\nLoop\nClose #f\nIf Not blnFound Then\nEnd If\nerr:\nEnd Sub\n\nSub searchReg()\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nDim lr1\nlr1 = Sheet1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nDim y\nFor y = 2 To lr1\nSheet9.Range(\"P1\").Value = Sheet1.Range(\"E\" &amp; y).Value\nSheet9.Range(\"Q1\").Value = y\nCall SearchTextFile\nNext y\nCall verify_text_formulas\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548884730, "post_id": 54449842, "comment_id": 95708772, "body": "Can you give an example full url please and giver more detail on what not working means?"}, {"owner": {"reputation": 1, "user_id": 10992394, "user_type": "registered", "profile_image": "https://graph.facebook.com/2066011520156567/picture?type=large", "display_name": "Sohail Nasir", "link": "https://stackoverflow.com/users/10992394/sohail-nasir"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548885228, "post_id": 54449842, "comment_id": 95708936, "body": "I wants to create datamatrix barcode in ms access. The solution I found is that I ahould create onlime and then paaste it in access form. Now I am able to generate lknk online by using vba but unablee to paste that picture in my forms. I need changing variable each time user enter a new text. Code is not copying that image."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1548888199, "post_id": 54449842, "comment_id": 95709976, "body": "I think have to save image as an external file then load the file into OLEObject field or control. I don&#39;t use OLE, I save image filepath to text field then use Image control ControlSource set to that field. Saving images into db just uses up Access 2GB size limit. Images can be pasted to Excel sheet but AFAIK, not to Access field or control."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1548888589, "post_id": 54449842, "comment_id": 95710100, "body": "Well, maybe can paste from clipboard. <a href=\"https://groups.google.com/forum/#!topic/microsoft.public.access.formscoding/4EXv2d1f0mY\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10992394, "user_type": "registered", "profile_image": "https://graph.facebook.com/2066011520156567/picture?type=large", "display_name": "Sohail Nasir", "link": "https://stackoverflow.com/users/10992394/sohail-nasir"}, "edited": false, "score": 0, "creation_date": 1548929196, "post_id": 54456491, "comment_id": 95724061, "body": "I want too just display image in form directly from web don&#39;t want to save it"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 10992394, "user_type": "registered", "profile_image": "https://graph.facebook.com/2066011520156567/picture?type=large", "display_name": "Sohail Nasir", "link": "https://stackoverflow.com/users/10992394/sohail-nasir"}, "edited": false, "score": 0, "creation_date": 1548936601, "post_id": 54456491, "comment_id": 95728484, "body": "You won&#39;t. It&#39;s a temp file you don&#39;t have to worry about, and it operates exactly the same way the browser does behind the scene. Further, it is much faster than loading and operating a browser object."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1548924256, "creation_date": 1548924256, "answer_id": 54456491, "question_id": 54449842, "link": "https://stackoverflow.com/questions/54449842/image-scraping-in-access/54456491#54456491", "title": "Image scraping in access", "body": "<p>Grab the skeleton for the full URL to only the <em>generated picture</em> (as displayed on the site) - for example:</p>\n\n<pre><code>https://barcode.tec-it.com/barcode.ashx?data=12345678&amp;code=DataMatrix&amp;multiplebarcodes=false&amp;translate-esc=false&amp;unit=Fit&amp;dpi=96&amp;imagetype=Gif&amp;rotation=0&amp;color=%23000000&amp;bgcolor=%23ffffff&amp;qunit=Mm&amp;quiet=0&amp;dmsize=Default' alt='Barcode Generator TEC-IT\n</code></pre>\n\n<p>Then you can use my code and demo published in one of my articles:</p>\n\n<p><a href=\"https://www.experts-exchange.com/articles/29679/Show-pictures-directly-from-URLs-in-Access-forms-and-reports.html\" rel=\"nofollow noreferrer\">Show pictures directly from URLs in Access forms and reports</a></p>\n\n<p>The two main functions downloads pictures directly, one is caching the download:</p>\n\n<pre><code>' Download a file or a page with public access from the web as a cached file of Internet Explorer.\n' Returns the full path of the cached file if success, an empty string if not.\n'\n' Examples:\n'\n' Download a file:\n'   Url = \"https://www.codeproject.com/script/Membership/ProfileImages/%7Ba82bcf77-ba9f-4ec3-bbb3-1d9ce15cae23%7D.jpg\"\n'   Result = DownloadCacheFile(Url)\n'   Result -&gt; C:\\Users\\UserName\\AppData\\Local\\Microsoft\\Windows\\INetCache\\IE\\B2IHEJQZ\\{a82bcf77-ba9f-4ec3-bbb3-1d9ce15cae23}[2].png\n'\n' Download a page:\n'   Url = \"https://www.codeproject.com/Tips/1022704/Rounding-Values-Up-Down-By-Or-To-Significant-Figur?display=Print\"\n'   Result = DownloadCacheFile(Url)\n'   Result -&gt; C:\\Users\\UserName\\AppData\\Local\\Microsoft\\Windows\\INetCache\\IE\\B2IHEJQZ\\Rounding-Values-Up-Down-By-Or-To-Significant-Figur[1].htm\n'\n' 2017-05-25. Gustav Brock, Cactus Data ApS, CPH.\n'\nPublic Function DownloadCacheFile( _\n    ByVal Url As String) _\n    As String\n\n    Const BufferLength  As Long = 1024\n    Const BindFDefault  As Long = 0\n    Const ErrorNone     As Long = 0\n\n    Dim FileName        As String\n    Dim LocalFileName   As String\n    Dim Result          As Long\n\n    ' Create buffer for name of downloaded and/or cached file.\n    FileName = Space(BufferLength - 1) &amp; vbNullChar\n    ' Download file or page.\n    ' Return name of cached file in parameter FileName.\n    Result = URLDownloadToCacheFile(0, Url &amp; vbNullChar, FileName, BufferLength, BindFDefault, 0)\n\n    ' Trim file name.\n    LocalFileName = Split(FileName, vbNullChar)(0)\n\n    DownloadCacheFile = LocalFileName\n\nEnd Function\n</code></pre>\n\n<p>I tested with a few URLs, and the codes were displayed at once:</p>\n\n<p><a href=\"https://i.stack.imgur.com/f8HTw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f8HTw.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 10992394, "user_type": "registered", "profile_image": "https://graph.facebook.com/2066011520156567/picture?type=large", "display_name": "Sohail Nasir", "link": "https://stackoverflow.com/users/10992394/sohail-nasir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1549033468, "creation_date": 1548883870, "last_edit_date": 1548888003, "question_id": 54449842, "link": "https://stackoverflow.com/questions/54449842/image-scraping-in-access", "title": "Image scraping in access", "body": "<p>I have generated data matrix by using Access vba. Now I have to scrape that generated pic into my form each and everytime. Here is the code. Half part is generating barcode while half to scrape that picture in Access form is not working. </p>\n\n<pre><code>Private Sub Command24_Click()\n\nDim IE As New InternetExplorer\n\nIE.Visible = True\n\nIE.Navigate (\"https://barcode.tec-it.com/en/DataMatrix?data=\" &amp; Forms!QRcodes!Text)\nDo\nDoEvents\nLoop Until IE.ReadyState = READYSTATE_COMPLETE\nStatusBar = \"loading webpage....\"\n\nDim img As Object\nDim html As HTMLDocument\nSet html = IE.Document\nDim elementcol As Object, link As Object\nSet elementcol = html.getElementsByTagName(\"img\")\n\nDim doc As Object\n\nForms!QRcodes!OLEBound34 = elementcol\n\n'Set img = ele.getElementsByTagName(\"img\")\nSet Tables!QRcodes!Matrix = elementcol\n\nMsgBox \"Getting Code\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1548882391, "post_id": 54449498, "comment_id": 95707791, "body": "Isn&#39;t this basically the same question as <a href=\"https://stackoverflow.com/q/54408729/4088852\">your last one</a>?"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1548882522, "post_id": 54449498, "comment_id": 95707856, "body": "@Comintern no, because this is omittimg part of an array that&#39;s pulling into an overarching array. The last question was a whole set of data not being saved as a copy of the template, this question is different"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1548882560, "post_id": 54449498, "comment_id": 95707876, "body": "@Comintern and this script has a completely different use-case, this is combining files, not distributing them"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1548882623, "post_id": 54449498, "comment_id": 95707906, "body": "Have you checked to see if the underlying issue is the same? I.e., they are both off by one errors, they are both effecting the last item in the array, they both involve printing, etc."}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1548882746, "post_id": 54449498, "comment_id": 95707963, "body": "@Comintern the only thing I&#39;ve noticed is that I do not get an issue when I have the array printed into the first row <code>.Range(.Cells(1,1)</code>  but I don&#39;t know why that is.  instead of this line: <code>.Range(.Cells(2, 1), .Cells(UBound(varArray, 2), UBound(varArray, 1))) = varArray2</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1548883231, "post_id": 54449498, "comment_id": 95708170, "body": "You just answered your own question.  If the end of the <code>Range</code> is row <code>UBound(varArray, 2)</code> when you start at row 1, you can&#39;t use the same ending row when you start at row 2."}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1548884056, "post_id": 54449498, "comment_id": 95708520, "body": "@Comintern I understand that my revision says: <code>varArray2 = A1 to rows.count to columns.count</code> but why doesn&#39;t it offset it when I change <code>.Cells(1,1)</code> to <code>.Cells(2,1)</code> and forego the last row being omitted?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1548884848, "post_id": 54449498, "comment_id": 95708813, "body": "<code>.Cells(2, 1)</code> is the start of the <code>Range</code> you&#39;re writing to. <code>.Cells(UBound(varArray, 2), UBound(varArray, 1))</code> is the end of the <code>Range</code> you&#39;re writing to.  If you change the start without changing the end by the same amount, it gets smaller."}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1548886732, "post_id": 54449498, "comment_id": 95709453, "body": "I figured both Bound statements just described the dimensions of the array, why would the destination cell for the array to print matter? What would you suggest I change? I\u2019m just confused, my apologies if this is redundant"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 305, "user_id": 10785732, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RIiEj6LHpXQ/AAAAAAAAAAI/AAAAAAAAABU/tYGkN03PEsA/photo.jpg?sz=128", "display_name": "Peter Ksenak", "link": "https://stackoverflow.com/users/10785732/peter-ksenak"}, "edited": false, "score": 0, "creation_date": 1548922883, "post_id": 54449498, "comment_id": 95720313, "body": "@Peter <i>some</i> vba arrays are 0 based.  Actually vba arrays can be <i>any</i> base, not just 0 or 1.  The OP has all 1 based arrays."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1548923295, "post_id": 54449498, "comment_id": 95720555, "body": "@nick Comintern has given you the answer.  When you code <code>.Range(CellA, CellB) = SomeArray</code> if the specified range is smaller than the array, the array is truncated to fit in the specified range.  To get the whole array you need to ensure the range size equals the array size"}], "answers": [{"tags": [], "owner": {"reputation": 327, "user_id": 10397847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35fc42f3907aeeb72103e228c86cdf?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesPL", "link": "https://stackoverflow.com/users/10397847/charlespl"}, "is_accepted": true, "score": 0, "last_activity_date": 1548944910, "creation_date": 1548944910, "answer_id": 54462758, "question_id": 54449498, "link": "https://stackoverflow.com/questions/54449498/why-is-my-array-merge-printing-everything-but-the-last-row-in-my-index/54462758#54462758", "title": "Why is my array-merge printing everything but the last row in my index?", "body": "<p>As <a href=\"https://stackoverflow.com/users/10414376/nick-lanta\">Nick Landa</a> submitted, </p>\n\n<p><code>.Range(.Cells(2, 1), .Cells(UBound(varArray, 2), UBound(varArray, 1))) = varArray2</code></p>\n\n<p>Should be </p>\n\n<p><code>.Range(.Cells(2, 1), 1 + .Cells(UBound(varArray, 2), UBound(varArray, 1))) = varArray2</code></p>\n\n<p>Your array is 148 row. If you do not select a 148 rows range, you will only output what is selected and trunk everything else. In this case, it was 147 rows, since you started at row #2 and you are going up to row #148.</p>\n\n<p>Side notes : A better way of doing it would be to rename your iteration variables (instead of having <code>i</code> and <code>j</code>) to use RowIterator and ColumnIterator, this way you understand much better was is going on. </p>\n\n<p>Then finally to optimize the speed of your code instead of transposing your matrix in a dedicated step, then sending the value to the sheet, you should just send the value to the sheet in a dedicated instruction.</p>\n\n<pre><code>For RowIterator = 1 To UBound(varArray, 2)\n    For ColumnIterator = 1 To UBound(varArray, 1)\n        .Cells(1 + RowIterator, ColumnIterator) = varArray(ColumnIterator, RowIterator)\n    Next\n Next\n</code></pre>\n\n<p>Since this way doesn't involve selecting a range then copying the array in it, you wouldn't have run into this issue.</p>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 54462758, "answer_count": 1, "score": 0, "last_activity_date": 1548944910, "creation_date": 1548882230, "last_edit_date": 1548888378, "question_id": 54449498, "link": "https://stackoverflow.com/questions/54449498/why-is-my-array-merge-printing-everything-but-the-last-row-in-my-index", "title": "Why is my array-merge printing everything but the last row in my index?", "body": "<p>I have a script that cycles through a folder pathway and combined a bunch of single reports into a master report, and then it prints the whole compiled set of arrays onto a master worksheet. It's working well, printing after the header row, but it's printing the array up until the last row of data from the last compiled report. There are 148 rows in the arrays index, but it only prints 147 of them and exits out of the sub. </p>\n\n<p>Here's the area where I make a second array to print it at once, maybe somewhere in here is cutting it off?</p>\n\n<pre><code>ReDim varArray2(1 To UBound(varArray, 2), 1 To UBound(varArray, 1))\n\nWith Workbooks(\"Retail_Goal_Report.xlsm\").Worksheets(\"Merged Reports\")\n\n    For j = 1 To UBound(varArray, 2)\n        For k = 1 To UBound(varArray, 1)\n            varArray2(j, k) = varArray(k, j)\n        Next\n    Next\n\n    .Range(.Cells(2, 1), .Cells(UBound(varArray, 2), UBound(varArray, 1))) = varArray2\nEnd With\n</code></pre>\n\n<p>Whole code: </p>\n\n<pre><code>Option Explicit\nSub Sharepoint_Merge()\n\n\nDim k As Long, x As Long, j As Long ' counters\nDim varArray() As Variant\nDim varArray2() As Variant\nReDim varArray(1 To 23, 1 To 1)\nDim folderPath As String, filepath As String, filename As String\nDim wb As Workbook\n\nDim myvar As Variant\nDim myFolder As String\nDim i As Long\n\nfolderPath = \"C:\\merge\\\"\n\nfilepath = folderPath &amp; \"*.xlsx\"\n\nfilename = Dir(filepath)\n\nCall Ludicrous(True)\n\nDo While filename &lt;&gt; \"\"\n\n    Set wb = Workbooks.Open(folderPath &amp; filename)\n\n    With wb.Worksheets(\"Sheet1\")\n\n        For j = 2 To .UsedRange.Rows.Count + 1\n            If .Cells(j, 1) &lt;&gt; \"\" Then\n                x = x + 1\n                ReDim Preserve varArray(1 To UBound(varArray, 1), 1 To x)\n                    For k = 1 To UBound(varArray, 1)\n                        varArray(k, x) = .Cells(j, k)\n                    Next\n            End If\n        Next\n\n\n    End With\n    wb.Close\nfilename = Dir\nLoop\n\n    ReDim varArray2(1 To UBound(varArray, 2), 1 To UBound(varArray, 1))\n\n    With Workbooks(\"Retail_Goal_Report.xlsm\").Worksheets(\"Merged Reports\")\n\n        For j = 1 To UBound(varArray, 2)\n            For k = 1 To UBound(varArray, 1)\n                varArray2(j, k) = varArray(k, j)\n            Next\n        Next\n\n        .Range(.Cells(2, 1), .Cells(UBound(varArray, 2), UBound(varArray, 1))) = varArray2\n    End With\n\nmyFolder = \"C:\\Retail-Goal\\merge\\\"\nmyvar = FileList(myFolder, \"*.xlsx\")\nFor i = LBound(myvar) To UBound(myvar)\n    Kill myFolder &amp; myvar(i)\nNext\n\nCall Ludicrous(False)\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping", "powerquery"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557471078, "post_id": 54449531, "comment_id": 98783181, "body": "Did you try this?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1548884572, "last_edit_date": 1548884572, "creation_date": 1548882347, "answer_id": 54449531, "question_id": 54449100, "link": "https://stackoverflow.com/questions/54449100/referencing-cells-in-excel-web-power-query/54449531#54449531", "title": "Referencing Cells in Excel Web Power Query", "body": "<p>If you don't mind a little housekeeping and not having the charts you can use xmlhttp</p>\n\n<pre><code>Option Explicit\nPublic Sub GetTable()\n    Dim sResponse As String, html As HTMLDocument, clipboard As Object, ws As Worksheet, shp As Shape, wsSource As Worksheet\n    Set wsSource = ThisWorkbook.Worksheets(\"symbols\")\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    ws.Cells.Clear\n    ws.Cells.UnMerge\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.nseindia.com/live_market/dynaContent/live_watch/option_chain/optionKeys.jsp?segmentLink=17&amp;instrument=OPTSTK&amp;symbol=\" &amp; wsSource.Cells(1, 1) &amp; \"&amp;date=31JAN2019\", False\n        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n    Set html = New HTMLDocument\n    html.body.innerHTML = sResponse\n\n    clipboard.SetText html.querySelectorAll(\"table\").Item(2).outerHTML\n    clipboard.PutInClipboard\n    ws.Cells(1, 1).PasteSpecial\n    ClearCharts ws\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>A long winded way would be:</p>\n\n<pre><code>Option Explicit\nPublic Sub WriteOutTable()\n    Dim sResponse As String, html As HTMLDocument, ws As Worksheet, wsSource As Worksheet, hTable As HTMLTable\n    Set wsSource = ThisWorkbook.Worksheets(\"symbols\")\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    ws.Cells.Clear\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.nseindia.com/live_market/dynaContent/live_watch/option_chain/optionKeys.jsp?segmentLink=17&amp;instrument=OPTSTK&amp;symbol=\" &amp; wsSource.Cells(1, 1) &amp; \"&amp;date=31JAN2019\", False\n        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n    Set html = New HTMLDocument\n    html.body.innerHTML = sResponse\n    Set hTable = html.querySelector(\"#octable\")\n\n    Dim tr As Object, td As Object, i As Long, th As Object, r As Long, c As Long, lastRow As Long\n    lastRow = hTable.getElementsByTagName(\"tr\").Length\n    For Each tr In hTable.getElementsByTagName(\"tr\")\n        r = r + 1: c = 1\n        Select Case r\n        Case 1\n            ws.Cells(r, 1) = tr.getElementsByTagName(\"th\")(0).innerText\n            ws.Cells(r, 12) = tr.getElementsByTagName(\"th\")(2).innerText\n        Case 2\n            For Each th In tr.getElementsByTagName(\"th\")\n                If Not th.title = \"Chart\" Then\n                    c = c + 1\n                    ws.Cells(r, c) = th.title\n                End If\n            Next\n        Case lastRow\n            ws.Cells(r, 1) = \"Total\"\n            ws.Cells(r, 2) = tr.getElementsByTagName(\"td\")(1).innerText\n            ws.Cells(r, 3) = tr.getElementsByTagName(\"td\")(3).innerText\n            ws.Cells(r, 19) = tr.getElementsByTagName(\"td\")(5).innerText\n            ws.Cells(r, 21) = tr.getElementsByTagName(\"td\")(7).innerText\n        Case Else\n            c = 2\n            For Each td In tr.getElementsByTagName(\"td\")\n                If td.classname = \"ylwbg\" Or td.classname = \"nobg\" Or td.classname = \"grybg\" Then\n                    ws.Cells(r, c) = td.innerText\n                    c = c + 1\n                End If\n            Next\n        End Select\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": false, "score": 0, "last_activity_date": 1548925996, "creation_date": 1548925996, "answer_id": 54457021, "question_id": 54449100, "link": "https://stackoverflow.com/questions/54449100/referencing-cells-in-excel-web-power-query/54457021#54457021", "title": "Referencing Cells in Excel Web Power Query", "body": "<p>You can refer to a cell value using Power Query, by defining a named range.</p>\n\n<p>So your query may look something like:</p>\n\n<pre><code>let\n    Symbol = Excel.CurrentWorkbook(){[Name=\"MySymbol\"]}[Content]{0}[Column1],\n    Date = Text.Upper(DateTime.ToText(DateTime.LocalNow(),\"ddMMMyyyy\")),\n    Source = Web.Page(Web.Contents(\"https://www.nseindia.com/live_market/dynaContent/live_watch/option_chain/optionKeys.jsp?segmentLink=17&amp;instrument=OPTSTK&amp;symbol=\" &amp; Symbol &amp; \"&amp;date=\" &amp; Date)),\n    Data = Source{0}[Data],\n    #\"Change Type\" = Table.TransformColumnTypes(Data, List.Transform(Table.ColumnNames(Data), each {_, type number})),\n    #\"Replace Errors\" = Table.ReplaceErrorValues(#\"Change Type\", List.Transform(Table.ColumnNames(#\"Change Type\"), each {_, null}))\nin\n    #\"Replace Errors\"\n</code></pre>\n\n<p>Now you can change the Symbol in cell \"MySymbol\" and simply refresh the query.</p>\n"}], "owner": {"reputation": 13, "user_id": 8542216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f8cbf07abc4f2ebf772428966d34985?s=128&d=identicon&r=PG&f=1", "display_name": "sks15", "link": "https://stackoverflow.com/users/8542216/sks15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1548925996, "creation_date": 1548880505, "last_edit_date": 1548924654, "question_id": 54449100, "link": "https://stackoverflow.com/questions/54449100/referencing-cells-in-excel-web-power-query", "title": "Referencing Cells in Excel Web Power Query", "body": "<p>I'm trying to create an excel file which will automatically fetch data from this website \n  (<a href=\"https://www.nseindia.com/live_market/dynaContent/live_watch/option_chain/optionKeys.jsp?segmentLink=17&amp;instrument=OPTSTK&amp;symbol=SBIN&amp;date=31JAN2019\" rel=\"nofollow noreferrer\">https://www.nseindia.com/live_market/dynaContent/live_watch/option_chain/optionKeys.jsp?segmentLink=17&amp;instrument=OPTSTK&amp;symbol=SBIN&amp;date=31JAN2019</a>)</p>\n\n<p>where I can change the symbol based on excel cell value. Though I don't able to create it in from power query. I tried VBA macro but first attempt it works but later on it shows error due to the existing table. Here is the VBA code which I have done.</p>\n\n<pre><code>Sub OptionChain()\n'\n' OptionChain Macro\n'\nTICKER = Sheets(\"Sheet1\").Cells(1, 1)\n\nSheets(\"Sheet2\").Select\nCells.Clear\n'\nActiveWorkbook.Queries.Add Name:=\"Table 0\", Formula:= _\n    \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Source = Web.Page(Web.Contents(\"\"https://www.nseindia.com/live_market/dynaContent/live_watch/option_chain/optionKeys.jsp?segmentLink=17&amp;instrument=OPTSTK&amp;symbol=\" &amp; TICKER &amp; \"&amp;date=31JAN2019\"\")),\" &amp; Chr(13) &amp; \"\" &amp; Chr(8) &amp; \"    Data0 = Source{0}[Data],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\" = Table.TransformColumnTypes(Data0,{{\"\"CALLS OI\"\", type text}, {\"\"CALLS Chng in OI\"\", type\" &amp; _\n    \" text}, {\"\"CALLS Volume\"\", type text}, {\"\"CALLS IV\"\", type text}, {\"\"CALLS LTP\"\", type text}, {\"\"CALLS Net Chng\"\", type text}, {\"\"CALLS Bid Qty\"\", type text}, {\"\"CALLS Bid Price\"\", type text}, {\"\"CALLS Ask Price\"\", type text}, {\"\"CALLS Ask Qty\"\", type text}, {\"\"Strike Price\"\", type number}, {\"\"PUTS Bid Qty\"\", type text}, {\"\"PUTS Bid Price\"\", type text}, {\"\"PUTS Ask \" &amp; _\n    \"Price\"\", type text}, {\"\"PUTS Ask Qty\"\", type text}, {\"\"PUTS Net Chng\"\", type text}, {\"\"PUTS LTP\"\", type text}, {\"\"PUTS IV\"\", type text}, {\"\"PUTS Volume\"\", type text}, {\"\"PUTS Chng in OI\"\", type text}, {\"\"PUTS OI\"\", type text}})\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\"\"\n\n\nWith ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n    \"OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=\"\"Table 0\"\";Extended Properties=\"\"\"\"\" _\n    , Destination:=Range(\"$A$1\")).QueryTable\n    .CommandType = xlCmdSql\n    .CommandText = Array(\"SELECT * FROM [Table 0]\")\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .PreserveColumnInfo = True\n    .ListObject.DisplayName = \"Table_0\"\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<p>Can anyone please help me how can I create the web power query from cell paramerters.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "edited": false, "score": 1, "creation_date": 1548881534, "post_id": 54449085, "comment_id": 95707435, "body": "a) It should be <code>SheetS(CStr(cell.Value)).Copy</code> (you&#39;re missing an <i>s</i>) b) Your <code>For Each Sheet In ThisWorkbook</code> is out of place and has no <code>Next</code>."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "is_accepted": false, "score": 0, "last_activity_date": 1548883149, "creation_date": 1548883149, "answer_id": 54449697, "question_id": 54449085, "link": "https://stackoverflow.com/questions/54449085/copying-sheets-to-existing-workbook-workbook-name-is-cell-value/54449697#54449697", "title": "Copying sheets to existing workbook, workbook name is cell.value", "body": "<pre><code>Sheet(CStr(cell.Value)).Copy After:=wb.Sheets(wb.Sheets.Count)\n</code></pre>\n\n<p><code>Sheet</code> was assigned and iterated through ThisWorkbook as a single worksheet. You want to identify one of the worksheets in the ThisWorkbook.Worksheets collection\u00b9 by name.</p>\n\n<pre><code>'bunch of code\nSet wb = Workbooks.Open(\"C:\\Users\\hsush001\\Downloads\\test\\\" &amp; cell.Value &amp; \".xlsx\")\nThisWorkbook.Worksheets(cell.Value).Copy After:=wb.Sheets(wb.Sheets.Count)\nwb.Close SaveChanges:=True\n'more code\n</code></pre>\n\n<p>The <code>For Each Sheet In ThisWorkbook</code> serves no real purpose and is missing its <code>Next Sheet</code> to close the loop.</p>\n\n<hr>\n\n<p>\u00b9 <sub>I prefer to work within the Worksheets collection instead of the Sheets collection but you could use the latter; it is simply personal choice in this situation. However <em>after:=Sheets.Count</em> guarantees the end of the queue while <em>after:=WorksSheets.Count</em> only guarantees after the last worksheet.</sub></p>\n"}], "owner": {"reputation": 11, "user_id": 10992564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997b90a67dd092eddb752acd2831d655?s=128&d=identicon&r=PG&f=1", "display_name": "Daisy", "link": "https://stackoverflow.com/users/10992564/daisy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548924648, "creation_date": 1548880430, "last_edit_date": 1548924648, "question_id": 54449085, "link": "https://stackoverflow.com/questions/54449085/copying-sheets-to-existing-workbook-workbook-name-is-cell-value", "title": "Copying sheets to existing workbook, workbook name is cell.value", "body": "<p>Very new here. Having a hard time trying to debug. I am currently trying to make the macro work as the following:</p>\n\n<p>Create new sheets and rename it to cell. Value in range, and if there is a workbook (also named as the sale cell.Value) in the same folder as the macro, copy this sheet into the workbook; if not, create a new workbook, name it the cell.Value and copy the sheet into this new workbook.</p>\n\n<p>I am have trouble with copying the sheet into the existing workbook part: I'm guessing it's the way I'm putting the workbook name?</p>\n\n<pre><code>Sub SplitandFilterSheet()\n\nSheet2.Activate\n\nDim Splitcode As Range\n\nSet Splitcode = Range(\"Splitcode2\")\n\n'Use each cell in Splitcode to name each newly copied worksheet\n\nFor Each cell In Splitcode\nSheets(\"Realized\").Copy After:=Worksheets(Sheets.Count)\nActiveSheet.Name = cell.Value\n\n'In each newly created worksheet, filter ParentID by the worksheet name (for example, 004), and then fill in color in those cells\n\nWith ActiveWorkbook.Sheets(CStr(cell.Value)).Range(\"MasterData2\")\n.AutoFilter Field:=2, Criteria1:=\"=\" &amp; CStr(cell.Value), Operator:=xlFilterValues\n.Offset(1, 0).Interior.ColorIndex = 5\n\n'Unfilter\n\nActiveSheet.AutoFilter.ShowAllData\n\n'Now filter ParentID cells that do not have color (i.e. anything that is not 004, since rowsa where ParentID=004 has color) and then delete\n\n.AutoFilter Field:=2, Operator:=xlFilterNoFill\n.Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n\n'Unfilter, make color as blank, and rename sheet with Realize or Unrealized\n\nActiveSheet.AutoFilter.ShowAllData\n.Offset(1, 0).Interior.ColorIndex = 0\n\n\nDim FilePath As String, wb As Workbook\n\n    FilePath = \"\"\n    On Error Resume Next\n    FilePath = Dir(\"C:\\Users\\hsush001\\Downloads\\test\\\" &amp; cell.Value &amp; \".xlsx\")\n    On Error GoTo 0\n    If FilePath = \"\" Then\n    ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\hsush001\\Downloads\\test\\\" &amp; cell.Value &amp; \".xlsx\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n    ActiveWorkbook.Saved = True\n    ActiveWorkbook.Close SaveChanges:=False\n\n    Else\n    Set wb = Workbooks.Open(\"C:\\Users\\hsush001\\Downloads\\test\\\" &amp; cell.Value &amp; \".xlsx\")\n    For Each Sheet In ThisWorkbook\n    Sheet(CStr(cell.Value)).Copy After:=wb.Sheets(wb.Sheets.Count)\n    wb.Saved = True\n    wb.Close SaveChanges:=False\nEnd With\n\nNext cell\nMsgBox \"Macro Completed\"\n\nEnd Sub\n</code></pre>\n\n<p>This line: <code>Sheet(CStr(cell.Value)).Copy After:=wb.Sheets(wb.Sheets.Count)</code> keeps getting bugged out.. sometimes saying Subscript out of range, or object doesn't support this property or method.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 440, "user_id": 5128961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SEr4k.gif?s=128&g=1", "display_name": "DavidN", "link": "https://stackoverflow.com/users/5128961/davidn"}, "edited": false, "score": 0, "creation_date": 1548879707, "post_id": 54448867, "comment_id": 95706581, "body": "Is your worksheet protected?"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 1, "creation_date": 1548880122, "post_id": 54448867, "comment_id": 95706768, "body": "<code>xlBetween</code> can only be used if two formulas are provided for validation."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "edited": false, "score": 0, "creation_date": 1548880316, "post_id": 54448867, "comment_id": 95706849, "body": "Shouldn&#39;t that be <code>Range(&quot;N2&quot;).Address(False, True)</code> ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548882179, "post_id": 54448867, "comment_id": 95707690, "body": "<code>xlBetween</code> used with <code>xlValidateList</code> doesn&#39;t seem legal. Remove the <code>Operator</code> argument."}], "owner": {"reputation": 23, "user_id": 10952425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-156RpY-p7SU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbwgTkKHPD5CkNAB6lh8nPgmL227w/mo/photo.jpg?sz=128", "display_name": "m.rainey", "link": "https://stackoverflow.com/users/10952425/m-rainey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548924640, "creation_date": 1548879333, "last_edit_date": 1548924640, "question_id": 54448867, "link": "https://stackoverflow.com/questions/54448867/data-validation-in-macro-working-but-throws-1004-error-if-a-different-macro-is-r", "title": "Data validation in macro working but throws 1004 error if a different macro is run", "body": "<p>I have three macros, they all do quite a lot but the first one applies the formatting to the sheet and data. Within this macro it is supposed to apply a drop down to column 'C', with the drop downs values being dependent on what is in column 'N'. I have managed to do this with the simple formula for column 'C'.. </p>\n\n<pre><code>=INDIRECT($N2)\n</code></pre>\n\n<p>The macro seems to work as it creates the desired result. However, when I then run one other macro in particular I get a 1004 error on the data validation line of code in the macro that appears to have already been executed. (The macro that is leading to the first one getting an error is opening a new workbook.)</p>\n\n<p>Its the bottom two lines that are getting the error.</p>\n\n<pre><code>Range(\"C2:C1500\").Select\nWith Selection.Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:=\"=INDIRECT(\" &amp; Range(\"$N2\").Address &amp; \" )\"\n</code></pre>\n\n<p>Does anyone know why this is happening? The macro with the code getting the error runs fine, it only shows the error when one specific macro is run anytime after. However, if I step through the second macro that is triggering the first macro to error then nothing happens (no errors appear and the second macro runs fine). </p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 33, "user_id": 10992426, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pqoxzoSKmOY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOjry5RXTAISbIw1Q1v5_D1RwMpPQ/mo/photo.jpg?sz=128", "display_name": "Edoardo ", "link": "https://stackoverflow.com/users/10992426/edoardo"}, "edited": false, "score": 0, "creation_date": 1548885292, "post_id": 54449768, "comment_id": 95708961, "body": "FYI, this will break if the range they select does not start at column B. Well, it won&#39;t break, but it will just never find an <code>X</code> so there will never be a range to send."}, {"owner": {"reputation": 33, "user_id": 10992426, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pqoxzoSKmOY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOjry5RXTAISbIw1Q1v5_D1RwMpPQ/mo/photo.jpg?sz=128", "display_name": "Edoardo ", "link": "https://stackoverflow.com/users/10992426/edoardo"}, "edited": false, "score": 0, "creation_date": 1548886616, "post_id": 54449768, "comment_id": 95709411, "body": "PS: How can I repeat this function on different SHEETS by only clicking in 1 button present in all the sheets? I mean, the table in the email must be implemented by adding the datas in all the sheets (same rules with &quot;X&quot;). The data should be copied starting from the 1st sheet, for ex. TEST(1) to the last sheet, TEST(9). Thanks !!!"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 33, "user_id": 10992426, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pqoxzoSKmOY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOjry5RXTAISbIw1Q1v5_D1RwMpPQ/mo/photo.jpg?sz=128", "display_name": "Edoardo ", "link": "https://stackoverflow.com/users/10992426/edoardo"}, "edited": false, "score": 0, "creation_date": 1548886663, "post_id": 54449768, "comment_id": 95709430, "body": "That\u2019s an entirely different question so it deserves its own post. Please ask a new question - share the code you have, and explain what changes you are seeking"}, {"owner": {"reputation": 33, "user_id": 10992426, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pqoxzoSKmOY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOjry5RXTAISbIw1Q1v5_D1RwMpPQ/mo/photo.jpg?sz=128", "display_name": "Edoardo ", "link": "https://stackoverflow.com/users/10992426/edoardo"}, "edited": false, "score": 0, "creation_date": 1548889643, "post_id": 54449768, "comment_id": 95710397, "body": "<a href=\"https://stackoverflow.com/questions/54450923/excel-vba-how-to-run-the-same-macro-at-the-same-time-on-all-the-sheets-gener\" title=\"excel vba how to run the same macro at the same time on all the sheets gener\">stackoverflow.com/questions/54450923/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 10992426, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pqoxzoSKmOY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOjry5RXTAISbIw1Q1v5_D1RwMpPQ/mo/photo.jpg?sz=128", "display_name": "Edoardo ", "link": "https://stackoverflow.com/users/10992426/edoardo"}, "edited": false, "score": 0, "creation_date": 1548889675, "post_id": 54449768, "comment_id": 95710408, "body": "I created a new question, hope to have posted it correcly! Thanks"}, {"owner": {"reputation": 33, "user_id": 10992426, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pqoxzoSKmOY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOjry5RXTAISbIw1Q1v5_D1RwMpPQ/mo/photo.jpg?sz=128", "display_name": "Edoardo ", "link": "https://stackoverflow.com/users/10992426/edoardo"}, "edited": false, "score": 0, "creation_date": 1548921822, "post_id": 54449768, "comment_id": 95719795, "body": "Is there a solution for my 2nd problem? Thanks a lot"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1548884749, "last_edit_date": 1548884749, "creation_date": 1548883498, "answer_id": 54449768, "question_id": 54448805, "link": "https://stackoverflow.com/questions/54448805/create-outlook-email-body-with-rows-having-a-particular-value-using-excel-vba/54449768#54449768", "title": "Create Outlook Email Body with rows having a particular value using Excel VBA", "body": "<p>The two tasks here are separate so I would code them as such. Here would be my approach. Separate your sub into two logical procedures. </p>\n\n<ol>\n<li>Determine the body range</li>\n<li>Send the email with the range</li>\n</ol>\n\n<hr>\n\n<h2>Determine the body range</h2>\n\n<p>Link your button to this macro. The macro will take an input and convert it into a single column range (<code>Column B</code>). We will then loop through the selected range and look at <code>Column A</code> to determine if there is an <code>x</code> or not. If an <code>x</code> is present, we will resize the range back to it's original size and add it to a collection of cells (<code>Final</code>). </p>\n\n<p>Once the loop is complete, the macro will then do one of the following:</p>\n\n<ol>\n<li>If the range is empty, it will prompt your message box and end the sub (your email macro is never initiated)</li>\n<li>If the range is not empty, we will call your <code>EMAIL</code> macro and pass the range along to it.</li>\n</ol>\n\n<p></p>\n\n<pre><code>Sub EmailRange()\n\nDim Initial As Range, Final As Range, nCell As Range\n\nOn Error Resume Next\n    Set Initial = Sheets(\"TEST\").Application.InputBox(\"Range\", xTitleId, \"B1:K20\", Type:=8)\nOn Error GoTo 0\n\nFor Each nCell In Initial.Resize(Initial.Rows.Count, 1)\n    If nCell.Offset(, -1) = \"X\" Then\n        If Not Final Is Nothing Then\n            Set Final = Union(Final, nCell.Resize(1, Initial.Columns.Count))\n        Else\n            Set Final = nCell.Resize(1, Initial.Columns.Count)\n        End If\n    End If\nNext nCell\n\nIf Not Final Is Nothing Then\n    MAIL Final\nElse\n    MsgBox \"ATTENZIONE!!!\" &amp; vbNewLine &amp; \"Seleziona un range di celle valido.\", vbOKOnly\nEnd If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>Send the email with the range</h2>\n\n<p>Notice that the macro now has an input (On first line). If the sub is called, you no longer need to validate anything since this was all done in the original sub!</p>\n\n<pre><code>Sub MAIL(Final as Range)\n\nDim OutApp As Object, OutMail As Object\nDim StrBodyIn As String, StrBodyEnd As String\n\nStrBodyIn = \"Bonjour,\" &amp; \"&lt;br&gt;\" &amp; \" \" &amp; \"&lt;br&gt;\" &amp; \"Buongiorno,\" &amp; \"&lt;br&gt;\"\nStrBodyEnd = \" \" &amp; \"&lt;br&gt;\" &amp; \"Cordialement\" &amp; \"&lt;br&gt;\" &amp; \" \" &amp; \"&lt;br&gt;\" &amp; Range(\"M2\") &amp; \"&lt;br&gt;\"\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\n  Set OutApp = CreateObject(\"Outlook.Application\")\n  Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n        With OutMail\n            .To = \"email@gmail.com\"\n            .CC = \"\"\n            .BCC = \"\"\n            .Subject = \"SITUATION\"\n            .HTMLBody = \"&lt;p style='font-family:calibri;font-size:16'&gt;\" &amp; StrBodyIn &amp; RangetoHTML(Final) &amp; \"&lt;p style='font-family:calibri;font-size:16'&gt;\" &amp; StrBodyEnd\n            .Display 'or use .Send\n        End With\n    On Error GoTo 0\n\n  Set OutMail = Nothing\n  Set OutApp = Nothing\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10992426, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pqoxzoSKmOY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOjry5RXTAISbIw1Q1v5_D1RwMpPQ/mo/photo.jpg?sz=128", "display_name": "Edoardo ", "link": "https://stackoverflow.com/users/10992426/edoardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1709, "favorite_count": 0, "accepted_answer_id": 54449768, "answer_count": 1, "score": 2, "last_activity_date": 1592693474, "creation_date": 1548879044, "last_edit_date": 1592693474, "question_id": 54448805, "link": "https://stackoverflow.com/questions/54448805/create-outlook-email-body-with-rows-having-a-particular-value-using-excel-vba", "title": "Create Outlook Email Body with rows having a particular value using Excel VBA", "body": "<p>I've used an example to create code to send emails from Excel (with Outlook), using a \"Button\" (red in my file).</p>\n\n<p>The code works. There is a pre-selected range of rows [B1:K20], that can be manually modified thanks to the <em>Application.InputBox</em> function.</p>\n\n<pre><code>Sub MAIL()\n\nDim rng As Range\nDim OutApp As Object\nDim OutMail As Object\nDim StrBodyIn, StrBodyEnd As String\n\nStrBodyIn = \"Bonjour,\" &amp; \"&lt;br&gt;\" &amp; _\n           \" \" &amp; \"&lt;br&gt;\" &amp; _\n          \"Buongiorno,\" &amp; \"&lt;br&gt;\"\n\nStrBodyEnd = \" \" &amp; \"&lt;br&gt;\" &amp; _\n             \"Cordialement\" &amp; \"&lt;br&gt;\" &amp; _\n             \" \" &amp; \"&lt;br&gt;\" &amp; _\n             Range(\"M2\") &amp; \"&lt;br&gt;\"\n\nSet rng = Nothing\n\nOn Error Resume Next\nSet rng = Sheets(\"TEST\").Application.InputBox(\"Range\", xTitleId, \"B1:K20\", Type:=8)\nOn Error GoTo 0\n\nIf rng Is Nothing Then\n    MsgBox \"ATTENZIONE!!!\" &amp; _\n           vbNewLine &amp; \"Seleziona un range di celle valido.\", vbOKOnly\n    Exit Sub\nEnd If\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nOn Error Resume Next\nWith OutMail\n    .To = \"email@gmail.com\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"SITUATION\"\n    .HTMLBody = \"&lt;p style='font-family:calibri;font-size:16'&gt;\" &amp; StrBodyIn &amp; RangetoHTML(rng) &amp; \"&lt;p style='font-family:calibri;font-size:16'&gt;\" &amp; StrBodyEnd\n    .Display 'or use .Send\nEnd With\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p><strong>I want to add a condition.</strong></p>\n\n<p><em>The selected range of rows should be copied to the body of the email if the \"X\" symbol is written in the column \"A\".</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/GuSXd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GuSXd.png\" alt=\"Here the image\"></a></p>\n\n<p>In my example, rows n\u00b0 1, 2 and n\u00b0 5 should be copied.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1548882939, "post_id": 54448783, "comment_id": 95708054, "body": "Should they be in reverse order?  You are closing the active file first and it can&#39;t execute the last file save command."}, {"owner": {"reputation": 91, "user_id": 4751871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2izp.jpg?s=128&g=1", "display_name": "SoundWaves", "link": "https://stackoverflow.com/users/4751871/soundwaves"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1548934853, "post_id": 54448783, "comment_id": 95727422, "body": "@DarrellH If I change the order it will close the opposite workbook (B) and not the first"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 4751871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2izp.jpg?s=128&g=1", "display_name": "SoundWaves", "link": "https://stackoverflow.com/users/4751871/soundwaves"}, "edited": false, "score": 0, "creation_date": 1548935375, "post_id": 54450430, "comment_id": 95727732, "body": "I tried your suggestion but no code is executed after the Application.Run on the first Workbook."}, {"owner": {"reputation": 6216, "user_id": 10782538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd4ea4a840201c7d7ea5a86c46e558c?s=128&d=identicon&r=PG", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10782538/oliver"}, "reply_to_user": {"reputation": 91, "user_id": 4751871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2izp.jpg?s=128&g=1", "display_name": "SoundWaves", "link": "https://stackoverflow.com/users/4751871/soundwaves"}, "edited": false, "score": 0, "creation_date": 1548938308, "post_id": 54450430, "comment_id": 95729461, "body": "Hey SoundWaves That sounds strange, I have added the code in the original workbook that i am running, and on my end it closes both workbooks after execution."}, {"owner": {"reputation": 91, "user_id": 4751871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2izp.jpg?s=128&g=1", "display_name": "SoundWaves", "link": "https://stackoverflow.com/users/4751871/soundwaves"}, "edited": false, "score": 0, "creation_date": 1548943988, "post_id": 54450430, "comment_id": 95732959, "body": "Interestingly enough, I removed the calls to close either workbook and the code executes. Workbook B closes itself and Workbook A clears it&#39;s contents. So this is progress."}, {"owner": {"reputation": 6216, "user_id": 10782538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd4ea4a840201c7d7ea5a86c46e558c?s=128&d=identicon&r=PG", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10782538/oliver"}, "reply_to_user": {"reputation": 91, "user_id": 4751871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2izp.jpg?s=128&g=1", "display_name": "SoundWaves", "link": "https://stackoverflow.com/users/4751871/soundwaves"}, "edited": false, "score": 0, "creation_date": 1548948335, "post_id": 54450430, "comment_id": 95735778, "body": "If you are still closing the workbook in the second file, this will cause the first file to &#39;interrupt&#39;. This should end the application.run and it would never return.   I had a simple example on my end where i made the second workbook open a msgbox(&quot;Hello&quot;) and then get closed by the first workbook. This worked out without problems."}], "tags": [], "owner": {"reputation": 6216, "user_id": 10782538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd4ea4a840201c7d7ea5a86c46e558c?s=128&d=identicon&r=PG", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10782538/oliver"}, "is_accepted": true, "score": 1, "last_activity_date": 1548938376, "last_edit_date": 1548938376, "creation_date": 1548886748, "answer_id": 54450430, "question_id": 54448783, "link": "https://stackoverflow.com/questions/54448783/excel-run-macro-in-another-workbook-reference-data-on-the-first-then-close-them/54450430#54450430", "title": "Excel run macro in another workbook, reference data on the first then close them both. Only one will close", "body": "<p>Note that <code>Application.Run</code> executes the code in the same 'environment' as the current workbook. Basically the workbook executing <code>Application.Run</code> is the one running the code, and the new workbook will be linked to the same session. \nThis will result in the peculiar situation that you are observing. \nClosing the workbook executed by 'Run' will make any macro (sub, function, object, sheet) in this workbook go out of scope, and any code run will stop running in this workbook. In addition as the notebook was closed, the code will not 'finish' in the executed workbook and thus we will not return to the original workbook, effectively halting any execution in the original notebook. </p>\n\n<p>Additionaly as the code will try to return to the original workbook, to finish the original running sub (here Save_Inspection() in the original workbook), the two workbooks are linked to the same session (or environment), and thus closing this workbook first will Halt the original code running (going to the next line in Save_Inspection becomes effectively impossible as the workbook is now closed), and this will end the session as well.</p>\n\n<p>Thus closing all workbooks in a workbook opened and executed by <code>Application.Run</code> is not possible directly. Workarounds can be done. The simplest is closing all workbooks in the original workbook (placing <code>wb.close false: Thisworkbook.close false</code> after application.run). Alternatively making a sub in the second workbook that runs 'Application.Ontime' and saves the filename to a cell for use in the function run by 'ontime' should make certain that the two sessions wont be linked while running code in the second notebook. But this i am less certain is actually the case.</p>\n\n<p>Below is the code in the original notebook. If the original workbook finishes this should close the workbooks in the end.</p>\n\n<pre><code>Sub Save_Inspection()\n   Dim wb As Workbook\n   On Error Resume Next\n   Set wb = Workbooks(\"SaveInspectionData.xlsm\")\n   On Error GoTo 0\n   If wb Is Nothing Then\n    Set wb = Workbooks.Open(ThisWorkbook.Path &amp; \"SaveInspectionData.xlsm\")\n   End If\n   Dim FileName As String\n   FileName = ThisWorkbook.Name\n   Run \"SaveInspectionData.xlsm!sheet1.CloseBooks\", FileName\n   wb.Close False\n   ThisWorkbook.Close False\n   Set wb = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 4751871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2izp.jpg?s=128&g=1", "display_name": "SoundWaves", "link": "https://stackoverflow.com/users/4751871/soundwaves"}, "is_accepted": false, "score": 0, "last_activity_date": 1573212098, "last_edit_date": 1573212098, "creation_date": 1549028955, "answer_id": 54480861, "question_id": 54448783, "link": "https://stackoverflow.com/questions/54448783/excel-run-macro-in-another-workbook-reference-data-on-the-first-then-close-them/54480861#54480861", "title": "Excel run macro in another workbook, reference data on the first then close them both. Only one will close", "body": "<p>Above Oliver does a great job explaining why my procedures where not working properly. In order to fix this I removed the call's to close the workbooks, the code in workbook A handles that on it's own. I did make some small changes to the above code to handle closing Excel or the workbook based on the qty of instances open.</p>\n\n<pre><code>Sub Save_Inspection()\nDim wb As Workbook\nDim wb2 As Workbook\nOn Error Resume Next\nSet wb = Workbooks(\"SaveInspectionData.xlsm\")\nOn Error GoTo 0\nIf wb Is Nothing Then Set wb = Workbooks.Open(\"\\\\Server\\Cloud9\\Files\\XDomainDocs\\SaveInspectionData.xlsm\")\nDim FileName As String\nFileName = ThisWorkbook.Name\nRun \"SaveInspectionData.xlsm!sheet1.Save_Inspection\", FileName\nIf Application.Workbooks.Count &gt; 2 Then\n    wb.Close False\n    ThisWorkbook.Close False\n    Set wb = Nothing\nElse\n    Application.Quit\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 4751871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2izp.jpg?s=128&g=1", "display_name": "SoundWaves", "link": "https://stackoverflow.com/users/4751871/soundwaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 54450430, "answer_count": 2, "score": 0, "last_activity_date": 1573212098, "creation_date": 1548878979, "last_edit_date": 1573211861, "question_id": 54448783, "link": "https://stackoverflow.com/questions/54448783/excel-run-macro-in-another-workbook-reference-data-on-the-first-then-close-them", "title": "Excel run macro in another workbook, reference data on the first then close them both. Only one will close", "body": "<p>I have a templated Excel file that will be is used to save the cell values to SQL. There will be about a thousand of these all with different names that perform the same function. For this reason I wanted to remove my code from the template into another file allowing for global changes if needed.</p>\n\n<p>The User works from File A and hits the save button executing the following code to run the Macro contained in File B.</p>\n\n<pre><code>Sub Save_Inspection()\n   Dim wb As Workbook\n   On Error Resume Next\n   Set wb = Workbooks(\"SaveInspectionData.xlsm\")\n   On Error GoTo 0\n   If wb Is Nothing Then Set wb = Workbooks.Open(\"\\\\SERVER\\FOLDER\\Files\\XDomainDocs\\SaveInspectionData.xlsm\")\n   Dim FileName As String\n   FileName = ThisWorkbook.Name\n   Run \"SaveInspectionData.xlsm!sheet1.Save_Inspection\", FileName\n   wb.Close False\n   Set wb = Nothing\nEnd Sub\n</code></pre>\n\n<p>Below is the code used to save the data residing on File B. Note - it is undermentioned at this time how many rows or columns there will, so I am looping through to create the SQL query and qty of rows, columns etc. This all works fine.</p>\n\n<p>My problem is when I try to close the workbooks. I want them both to close and regardless or what I try only one of the two will close. The code below reflects the simplest close method, but I have tried several other techniques. </p>\n\n<p>After some searching it may be something to do with my use of \"With\" statements to reference File A, but I am not sure.</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>Sub Save_Inspection(FileName As String)\nOn Error GoTo errH\n\nDim strUserDomain As String\nDim cn As ADODB.Connection\nDim Server_Name As String\nDim Database_Name As String\nDim User_ID As String\nDim Password As String\n\nDim InspectionId As Integer 'Will use this Id to associate all results to this Inspection Instance\n\nDim Query As String\nDim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\n\n'Find proper connection string\nstrUserDomain = Environ$(\"UserDomain\")\n`If strUserDomain = \"A\" Then\n    Server_Name = \"ServerA\"\n    Database_Name = \"Inspection\"\n    User_ID = \"xxx\"\n    Password = \"xxx\"\nElseIf strUserDomain = \"B\" Then\n    Server_Name = \"ServerB\"\n    Database_Name = \"Inspection\"\n    User_ID = \"xxx\"\n    Password = \"xxx\"\nElseIf strUserDomain = \"C\" Then\n    Server_Name = \"ServerC\"\n    Database_Name = \"Inspection\"\n    User_ID = \"xxx\"\n    Password = \"xxx\"\nElse\n    'Something must be wrong\n    Exit Sub\nEnd If\n\nWorkbooks(FileName).Activate\nDim wb As Workbook\nDim ws As Worksheet\nSet wb = Workbooks(FileName)\nSet ws = wb.Sheets(1)\n\n'Let's Save this stuff!\nDim DateInspected, PartNumber, LotNumber, Revision As String\n'Set values\nWith ws\n    'DateInspected = .Range(\"Q5\").Value\n    PartNumber = .Range(\"K4\").Value\n    LotNumber = .Range(\"G3\").Value\n    Revision = .Range(\"Q4\").Value\nEnd With\nQuery = \"INSERT INTO InspectionCatalog (DateInspected, PartNumber, LotNumber, Revision) VALUES (GETDATE(), '\" &amp; PartNumber &amp; \"', '\" &amp; LotNumber &amp; \"', '\" &amp; Revision &amp; \"')\"\n\nSet cn = New ADODB.Connection\ncn.Open \"Provider=SQLOLEDB;Server=\" &amp; Server_Name &amp; \";Initial Catalog=\" &amp; Database_Name &amp; \";Uid=\" &amp; User_ID &amp; \";Pwd=\" &amp; Password &amp; \";\"\n\ncn.Execute (Query)\nrs.Open \"SELECT @@identity AS InspectionId\", cn\nInspectionId = rs.Fields(\"InspectionId\")\n'MsgBox (InspectionId)'For testing\n\n'Loop through all cells on sheet and save results\nCall LoopThroughResults(InspectionId, FileName, strUserDomain)\n\nExit Sub\n    errH:\n    MsgBox Err.Description\nEnd Sub\n\nSub LoopThroughResults(InspectionId As Integer, FileName As String, strUserDomain As String)\nOn Error GoTo errH\n\n'Declare Variables\nDim RowCount As Integer\nDim CollCount As Integer\nDim Coll_Count As Integer\n\nDim wb As Workbook\nDim ws As Worksheet\nSet wb = Workbooks(FileName)\nSet ws = wb.Sheets(1)\n\n'Find the number of rows in the sheet based on a value in Col U\nWith ws\n    RowCount = .Cells(.Rows.Count, \"G\").End(xlUp).Row\n    'MsgBox RowCount\nEnd With\n\n'Go through each row and find the number of columns that are filled\n'Set CollCount to the longest row - ignoring 1-9 these are header fields\nFor i = 10 To RowCount\nWith ws\n    Coll_Count = .Cells(i, .Columns.Count).End(xlToLeft).Column\n    If Coll_Count &gt; CollCount Then\n    'Find the length of the longest row\n    CollCount = Coll_Count\n    End If\n    'MsgBox \"Row \" &amp; i &amp; \" Has \" &amp; Coll_Count &amp; \" Columns!\"\nEnd With\nNext i\n'MsgBox \"The Row with the Most data has \" &amp; CollCount &amp; \" Columns!\"\n\n'Save Col Count to be used for retrieving the data later\nDim Query As String\nQuery = \"UPDATE InspectionCatalog SET CollCount='\" &amp; CollCount &amp; \"', [RowCount]='\" &amp; RowCount &amp; \"' WHERE InspectionId='\" &amp; InspectionId &amp; \"' \"\nCall SaveResults(Query, strUserDomain)\n\nDim QueryStart As String\nDim QueryEnd As String\n\n'Loop through each row starting at 2 (Not 10, this time we want to capture all data\nFor i = 2 To RowCount\n'Reset Query String befor hitting next row\nQueryStart = \"INSERT INTO InspectionResults (\"\nQueryEnd = \" VALUES (\"\n'Loop through each column to create insert query\n    For n = 1 To CollCount\n            QueryStart = QueryStart &amp; \"Col\" &amp; n &amp; \",\"\n            QueryEnd = QueryEnd &amp; \"N'\" &amp; Workbooks(FileName).Worksheets(\"Inspection Report\").Cells(i, n).Value &amp; \"',\"\n    Next n\n    QueryStart = QueryStart &amp; \"InspectionId)\"\n    QueryEnd = QueryEnd &amp; \"'\" &amp; InspectionId &amp; \"');\"\n    'MsgBox QueryStart &amp; QueryEnd\n    Call SaveResults(QueryStart &amp; QueryEnd, strUserDomain)\nNext i\n\nMsgBox \"Inspection Data Has Been Saved\"\nCall CloseWorkBooks(FileName)\n\nExit Sub\nerrH:\n    MsgBox Err.Description\nEnd Sub\n\nSub SaveResults(Query As String, strUserDomain As String)\nOn Error GoTo errH\nDim cn As ADODB.Connection\nDim Server_Name As String\nDim Database_Name As String\nDim User_ID As String\nDim Password As String\n\nDim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\n\n'Find proper connection string\nstrUserDomain = Environ$(\"UserDomain\")\n\nIf strUserDomain = \"A\" Then\n    Server_Name = \"ServerA\"\n    Database_Name = \"Inspection\"\n    User_ID = \"xxx\"\n    Password = \"xxx\"\nElseIf strUserDomain = \"B\" Then\n    Server_Name = \"ServerB\"\n    Database_Name = \"Inspection\"\n    User_ID = \"xxx\"\n    Password = \"xxx\"\nElseIf strUserDomain = \"C\" Then\n    Server_Name = \"ServerC\"\n    Database_Name = \"Inspection\"\n    User_ID = \"xxx\"\n    Password = \"xxx\"\nElse\n    'Something must be wrong\n    Exit Sub\nEnd If\n\nSet cn = New ADODB.Connection\ncn.Open \"Provider=SQLOLEDB;Server=\" &amp; Server_Name &amp; \";Initial Catalog=\" &amp; Database_Name &amp; \";Uid=\" &amp; User_ID &amp; \";Pwd=\" &amp; Password &amp; \";\"\ncn.Execute (Query)\nExit Sub\nerrH:\n    MsgBox Err.Description\nEnd Sub\n\nSub CloseWorkBooks(FileName As String)\n    Workbooks(FileName).Close SaveChanges:=False\n    Workbooks(\"SaveInspectionData.xlsm\").Close SaveChanges:=False\n    Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1548879582, "post_id": 54448721, "comment_id": 95706539, "body": "You need to use a for loop to determine when you need to end or you should look at using the END function from the range object which will ultimately give you the last cell and then you can copy in bulk. Also, using SELECT isn\u2019t a great idea, you should reference the cell directly. There are a few things you should look at but I think you know that. :-)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1548884605, "post_id": 54448721, "comment_id": 95708726, "body": "Hi, why do you need to loop? Why not just copy the whole range at once? You only need to loop if there is some criteria to what you copy. If you just want to copy the used range, just find the last used row and copy the entire range at once. No need for a loop"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548920895, "post_id": 54448721, "comment_id": 95719328, "body": "@urdearboy read my comment again man. I gave 2 options, one of them being bulk copy."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1548921099, "post_id": 54448721, "comment_id": 95719446, "body": "@BradDixon why?"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548922675, "post_id": 54448721, "comment_id": 95720214, "body": "@urdearboy your comment seemed like it was referring to mine. My mistake if it wasn\u2019t."}, {"owner": {"reputation": 1, "user_id": 10992442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06eaee97dd4ac0e1847ec59dec81c838?s=128&d=identicon&r=PG&f=1", "display_name": "PJC", "link": "https://stackoverflow.com/users/10992442/pjc"}, "edited": false, "score": 0, "creation_date": 1548939007, "post_id": 54448721, "comment_id": 95729925, "body": "I am setting this up to go through thousands of Additive Manufactured part candidates that could be converted from traditionally manufactured methods. Most will not make the cut. After I copy and paste the information into the specific cells of the model, my model will automatically run the calculation and then my macro will pull the conclusion and paste it in the Data page, Reset the model and then move to the next line of the Data page which contains the next parts information. I want this to repeat each of the 30 steps over and over again until it reaches the end of the list of parts."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10992442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06eaee97dd4ac0e1847ec59dec81c838?s=128&d=identicon&r=PG&f=1", "display_name": "PJC", "link": "https://stackoverflow.com/users/10992442/pjc"}, "edited": false, "score": 0, "creation_date": 1548939365, "post_id": 54456950, "comment_id": 95730143, "body": "I am not following, is the looping state &quot;For counter =3 To 10000&quot; and the statement &quot;Next counter&quot; that which stops it? Sorry I am a real novice at this. I have figured out how to copy and paste and the cells, I don&#39;t know how to tell it to go to the next line and repeat Step 1 after it gets to step 30."}, {"owner": {"reputation": 25, "user_id": 9216992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5lQBW.jpg?s=128&g=1", "display_name": "Ehsan", "link": "https://stackoverflow.com/users/9216992/ehsan"}, "reply_to_user": {"reputation": 1, "user_id": 10992442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06eaee97dd4ac0e1847ec59dec81c838?s=128&d=identicon&r=PG&f=1", "display_name": "PJC", "link": "https://stackoverflow.com/users/10992442/pjc"}, "edited": false, "score": 0, "creation_date": 1549009428, "post_id": 54456950, "comment_id": 95758195, "body": "use an &quot;Exit For&quot; statement as a condition for &quot;else if&quot; and explain if my conditions does not achieve exit from for loop; this is for stopping your loop. but for doing it after finish of 1st time looping, you have to use from a button to ignite it again (the faster and better way) or you have to add another for loop or do while as a upper loop (not recommended, make you macro so slow). any way, if you open view code in excel and press F1 button you will see many examples."}, {"owner": {"reputation": 25, "user_id": 9216992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5lQBW.jpg?s=128&g=1", "display_name": "Ehsan", "link": "https://stackoverflow.com/users/9216992/ehsan"}, "reply_to_user": {"reputation": 1, "user_id": 10992442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06eaee97dd4ac0e1847ec59dec81c838?s=128&d=identicon&r=PG&f=1", "display_name": "PJC", "link": "https://stackoverflow.com/users/10992442/pjc"}, "edited": false, "score": 0, "creation_date": 1549009502, "post_id": 54456950, "comment_id": 95758224, "body": "i described how to go to the next row with for loop and counter. please have another look on the my codes."}, {"owner": {"reputation": 25, "user_id": 9216992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5lQBW.jpg?s=128&g=1", "display_name": "Ehsan", "link": "https://stackoverflow.com/users/9216992/ehsan"}, "reply_to_user": {"reputation": 1, "user_id": 10992442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06eaee97dd4ac0e1847ec59dec81c838?s=128&d=identicon&r=PG&f=1", "display_name": "PJC", "link": "https://stackoverflow.com/users/10992442/pjc"}, "edited": false, "score": 0, "creation_date": 1549010050, "post_id": 54456950, "comment_id": 95758452, "body": "i also added and other example for you at the bottom of the previous sample codes. the last example is from the excel help that i have copied it for you."}, {"owner": {"reputation": 1, "user_id": 10992442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06eaee97dd4ac0e1847ec59dec81c838?s=128&d=identicon&r=PG&f=1", "display_name": "PJC", "link": "https://stackoverflow.com/users/10992442/pjc"}, "edited": false, "score": 0, "creation_date": 1549138152, "post_id": 54456950, "comment_id": 95799359, "body": "Thank you for your input, I am still having trouble understanding and probably explaining what I am trying to do. I edited my question above and input a new script draft that I hope better explains what I am trying to do. Again, thank you for your input and patience with me on this. Patrick"}], "tags": [], "owner": {"reputation": 25, "user_id": 9216992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5lQBW.jpg?s=128&g=1", "display_name": "Ehsan", "link": "https://stackoverflow.com/users/9216992/ehsan"}, "is_accepted": false, "score": 0, "last_activity_date": 1549009843, "last_edit_date": 1549009843, "creation_date": 1548925690, "answer_id": 54456950, "question_id": 54448721, "link": "https://stackoverflow.com/questions/54448721/copy-specific-cells-from-a-line-and-paste-in-another-sheet-repeat-on-next-line/54456950#54456950", "title": "Copy specific cells from a line and paste in another sheet, repeat on next line and repeat until cell in next line is blank", "body": "<p>'Specify Out-range Data</p>\n\n<p>For counter = 3 To 10000</p>\n\n<pre><code>'Conditions that you can change it. in the bellow codes (counter) is your cell number and the number after comma is your column index. you can also do not specify your column and only loop through cells. you can also use from (i,j) for looping through both cells and columns (means two (For) loops).\n</code></pre>\n\n<p>If Worksheets(\"2nd QC\").Cells(counter, 2).Value &lt; Worksheets(\"2nd QC\").Cells(counter, 3) _\n   Or Worksheets(\"2nd QC\").Cells(counter, 3).Value &lt; Worksheets(\"2nd QC\").Cells(counter, 4) _\n   Or Worksheets(\"2nd QC\").Cells(counter, 4).Value &lt; Worksheets(\"2nd QC\").Cells(counter, 5) Then</p>\n\n<p>Worksheets(\"2nd QC\").Rows(counter).Interior.Color = 65535</p>\n\n<p>Else\n   Worksheets(\"2nd QC\").Cells(counter).Value = Worksheets(\"2nd QC\").Cells(counter).Value</p>\n\n<p>End If</p>\n\n<p>Next counter</p>\n\n<p>'Exit Loop Example:</p>\n\n<p>Sub ExitStatementDemo()</p>\n\n<p>Dim I, MyNum</p>\n\n<pre><code>Do                ' Set up infinite loop.\n\n    For I = 1 To 1000    ' Loop 1000 times.\n\n        MyNum = Int(Rnd * 1000)    ' Generate random numbers.\n\n        Select Case MyNum    ' Evaluate random number.\n\n            Case 7: Exit For    ' If 7, exit For...Next.\n            Case 29: Exit Do    ' If 29, exit Do...Loop.\n            Case 54: Exit Sub    ' If 54, exit Sub procedure.\n        End Select\n    Next I\nLoop\n</code></pre>\n\n<p>End Sub</p>\n\n<p>'I hope it help</p>\n"}], "owner": {"reputation": 1, "user_id": 10992442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06eaee97dd4ac0e1847ec59dec81c838?s=128&d=identicon&r=PG&f=1", "display_name": "PJC", "link": "https://stackoverflow.com/users/10992442/pjc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549137960, "creation_date": 1548878733, "last_edit_date": 1549137960, "question_id": 54448721, "link": "https://stackoverflow.com/questions/54448721/copy-specific-cells-from-a-line-and-paste-in-another-sheet-repeat-on-next-line", "title": "Copy specific cells from a line and paste in another sheet, repeat on next line and repeat until cell in next line is blank", "body": "<p>Edited: 2/2/19 </p>\n\n<p>I am still struggling to understand this. I have done a little more reading and realize that I was heading down the wrong path. I have created a better explanation of what I am trying to do and a sample below. I need your help me with Steps 1-2, Steps 4-5 and Steps 7-9. \nThank you for your patience and understanding!</p>\n\n<pre><code>Sub Weeder_Repeater()\n'\n' 1) Copy Columns \"D:L\" Starting at Line 4 from Candidate Weeder sheet\n' 2) Special Paste, Values, Transpose, to Metal Powder Bed AM Calculator sheet Cell \"Q6\"\n' 3) Call Weeder_RAPID_Cal macro\n' 4) Copy solution from Metal Powder Bed AM Calculator sheet Cell \"Q15\"\n' 5) Special Paste, Values to Candidate Weeder sheet Column \"O\"\n' 6) Call Weeder_RAPID_Reset macro\n' 7) Move to next line in Candidate Weeder sheet\n' 8) Repeat Steps 1-7\n' 9) End when Blank in Column \"D\" encountered\n'\n\n'Step 1-2\n\n\n'Step 3\n    Call Weeder_RAPID_Calc\n\n'Step 4-5\n\n\n'Step 6\n    Call Weeder_RAPID_Reset\n\n'Step 7-9\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548891975, "post_id": 54451282, "comment_id": 95710993, "body": "Though it does look like you copied html during an error so the html may have been altered."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1548891838, "creation_date": 1548891838, "answer_id": 54451282, "question_id": 54448243, "link": "https://stackoverflow.com/questions/54448243/how-to-click-on-create-issue-button-in-excel-vba/54451282#54451282", "title": "How to click on &quot;Create Issue&quot; button in Excel VBA", "body": "<p>You can try a combination of css selectors</p>\n\n<pre><code>ie.document.querySelector(\"button[data-csm-counter=createViewTryAgainButton]\").click\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10992138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20877e98b7cb5309e3cc4e1009db88c?s=128&d=identicon&r=PG&f=1", "display_name": "KyoKevin85", "link": "https://stackoverflow.com/users/10992138/kyokevin85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548924562, "creation_date": 1548876927, "last_edit_date": 1548924562, "question_id": 54448243, "link": "https://stackoverflow.com/questions/54448243/how-to-click-on-create-issue-button-in-excel-vba", "title": "How to click on &quot;Create Issue&quot; button in Excel VBA", "body": "<p>Hi i'm trying to get the \"Create an Issue\" button to click after filling out a form online. The form fills correctly I just need it to do the final piece and click on the \"Create Issue\".</p>\n\n<p>Here's my setup and code\nMicrosoft Excel 2016 32bit</p>\n\n<p>VBA:</p>\n\n<pre><code>Option Explicit\nSub Waiting()\n       Application.Wait (Now + TimeValue(\"0:00:2\"))\nEnd Sub\n\nSub IE_Wait(IE As InternetExplorer)\n    With IE\n        While .Busy Or .ReadyState &lt;&gt; READYSTATE_COMPLETE\n            DoEvents\n            Call Waiting\n           ' SendKeys \"{ENTER}\"\n        Wend\n        While .Document.ReadyState &lt;&gt; \"complete\"\n            DoEvents\n           Call Waiting\n            'SendKeys \"{ENTER}\"\n        Wend\n    End With\nEnd Sub\n\nSub FindAndTerminate(ByVal strProcName As String)\n    Dim objWMIService, objProcess, colProcess\n    Dim strComputer, strList\n    strComputer = \".\"\n    Set objWMIService = GetObject(\"winmgmts:\" _\n    &amp; \"{impersonationLevel=impersonate}!\\\\\" _\n    &amp; strComputer &amp; \"\\root\\cimv2\")\n    Set colProcess = objWMIService.ExecQuery _\n    (\"Select * from Win32_Process Where Name = '\" &amp; strProcName &amp; \"'\")\n    If colProcess.Count &gt; 0 Then\n        For Each objProcess In colProcess\n        On Error Resume Next\n            objProcess.Terminate\n        Next objProcess\n    End If\nEnd Sub\n\nPublic Sub make_tickets_with_me()\n  Dim IE As InternetExplorer\n  Dim HTMLdoc As HTMLDocument\n  Dim x, Site, ASIN_1, ASIN_2, ASIN_3, ASIN_4, ASIN_5 As String\n  Dim ws As Worksheet\n  Dim e\n  Dim y, lLastRow As Long\n\n  ' Kill any currently running Explorer Windows\n  FindAndTerminate \"iexplore.exe\"\n\n  Application.DisplayAlerts = False\n  Application.EnableEvents = False\n  Application.ScreenUpdating = False\n\n  Set IE = New InternetExplorerMedium\n\n  With ThisWorkbook\n    lLastRow = Worksheets(\"ASINs\").Cells(Rows.Count, \"A\").End(xlUp).Row 'Count total Asins\n    x = 2\n    For x = 2 To lLastRow\n    Debug.Print x\n      ASIN_1 = Worksheets(\"ASINs\").Range(\"A\" &amp; x).Value\n      ASIN_2 = Worksheets(\"ASINs\").Range(\"A\" &amp; x + 1).Value\n      ASIN_3 = Worksheets(\"ASINs\").Range(\"A\" &amp; x + 2).Value\n      ASIN_4 = Worksheets(\"ASINs\").Range(\"A\" &amp; x + 3).Value\n      ASIN_5 = Worksheets(\"ASINs\").Range(\"A\" &amp; x + 4).Value\n\n      Site = \"https://sim.amazon.com/issues/create?assignedFolder=5aec25c2-1135-4d36-b751-37d967c0a83e&amp;title=Zappos+Unsellable+Test&amp;description=Below+is+a+list+of+5+asins+that+are+unsellable%3A%20%0D%0A%0D%0A\" + ASIN_1 + \"%0D%0A\" + ASIN_2 + \"%0D%0A\" + ASIN_3 + \"%0D%0A\" + ASIN_4 + \"%0D%0A\" + ASIN_5 + \"%0D%0A%0D%0A&amp;descriptionContentType=text%2Fplain&amp;extensions%5Btt%5D%5Bimpact%5D=4&amp;extensions%5Btt%5D%5Bcategory%5D=&amp;authorizations%5B%5D=BREAK&amp;authZCompression=v1\"\n      x = x + 4\n'      Debug.Print ASIN_1 &amp; ASIN_2 &amp; ASIN_3 &amp; ASIN_4 &amp; ASIN_5\n'      Debug.Print x\n'      Debug.Print Site\n''' BEGIN INTERACTION WITH IE\n      Set IE = New InternetExplorerMedium\n\n      With IE\n        .Visible = True\n        .Left = 25\n        .Top = 25\n        .Height = 700\n        .Width = 1300\n        AppActivate (\"Internet Explorer\")\n        .Navigate Site\n        IE_Wait IE\n        Call Waiting\n        IE_Wait IE\n        Call Waiting\n        Set e = IE.Document.getElementsByTagName(\"span\")\n        -&gt;&gt;&gt;&gt;&gt;&gt;&gt;If e.innerText = \"Create an issue In Zappos Unsellable: Tickets\" Then\n        e.parentElement.Click\n        Exit For\n        End If\n\n        'Set e = IE.Document.getElementsByClassName(\"create\")(0)\n        'e.Click\n'        SendKeys \"{NUMLOCK}\"\n        Call Waiting\n       .Quit\n      End With\n    Next 'Loop for x=2 to lLastRow, Adds 4 to x, then Next adds 1 to total of 5 per iteration\n    ThisWorkbook.Worksheets(\"Buttons\").Activate\n    MsgBox (\"Tickets Created :)\")\n  End With\n\n\nEnd Sub\n</code></pre>\n\n<p>I've added an arrow to where the error is.</p>\n\n<p>Here's the Inspect for the button I want to click</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>    &lt;/div&gt;\n      &lt;div class=\"clearfix\"&gt;&lt;/div&gt;\n    &lt;script type=\"jsv/50_\"&gt;&lt;/script&gt;&lt;/div&gt;&lt;/section&gt;\n\n      &lt;section class=\"wizard-step \" id=\"wizard-step-2\" data-wizard-step=\"2\"&gt;&lt;div data-module-name=\"App.Views.CreateWizardStep\" data-template=\"#create-wizard-step-template\"&gt;&lt;script type=\"jsv#112_\"&gt;&lt;/script&gt;\n      &lt;div class=\"form-actions\"&gt;\n        &lt;div class=\"view-state-initialized-visible\" data-view=\"create\"&gt;\n          &lt;button class=\"btn btn-primary btn-large\" type=\"submit\" data-csm-counter=\"createViewCreateButton\"&gt;\n            &lt;span style=\"display: inline;\" data-link=\"visible{:!~isUndefined(issue.assignedFolder)}\"&gt;&lt;span id=\"view-tag-157\" data-module-name=\"App.Views.FolderDisplayView\" data-template=\"undefined\"&gt;&lt;script type=\"jsv#170_\"&gt;&lt;/script&gt;&lt;span style=\"display: inline;\" data-name=\"folder-label-completed-text\" data-link=\"visible{:state == 'completed'}\"&gt;\n        &lt;script type=\"jsv#219^\"&gt;&lt;/script&gt;&lt;script type=\"jsv#308_\"&gt;&lt;/script&gt;\n        &lt;script type=\"jsv#388^\"&gt;&lt;/script&gt;Zappos Unsellable: Tickets\n              Create an issue in\n              &lt;script type=\"jsv/388^\"&gt;&lt;/script&gt;\n        &lt;script type=\"jsv/308_\"&gt;&lt;/script&gt;&lt;script type=\"jsv/219^\"&gt;&lt;/script&gt;\n      &lt;/span&gt;&lt;span style=\"display: none;\" data-link=\"visible{:state == 'loading'}\"&gt;\n        &lt;script type=\"jsv#172_\"&gt;&lt;/script&gt;&lt;i class=\"icon-spinner\"&gt;&lt;/i&gt;&lt;script type=\"jsv/172_\"&gt;&lt;/script&gt;\n        Loading folder...\n      &lt;/span&gt;&lt;span style=\"display: none;\" data-link=\"visible{:state == 'errored'}\"&gt;\n        Could not find folder\n      &lt;/span&gt;&lt;span style=\"display: none;\" data-link=\"visible{:state == 'empty'}\"&gt;\n        Folder not specified\n      &lt;/span&gt;&lt;script type=\"jsv/170_\"&gt;&lt;/script&gt;&lt;/span&gt;\n            &lt;/span&gt;\n            &lt;span style=\"display: none;\" data-link=\"visible{:~isUndefined(issue.assignedFolder)}\"&gt;\n              Create an issue\n            &lt;/span&gt;\n          &lt;/button&gt;\n          &lt;div class=\"alert alert-error pull-right\" style=\"display: none;\" data-link=\"visible{:!state.isValid}\"&gt;\n            Please correct the errors above\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"view-state-loading-visible alert alert-info\" data-view=\"create\"&gt;\n          &lt;script type=\"jsv#113_\"&gt;&lt;/script&gt;&lt;i class=\"icon-spinner\"&gt;&lt;/i&gt;&lt;script type=\"jsv/113_\"&gt;&lt;/script&gt;\n          Creating your issue...\n        &lt;/div&gt;\n        &lt;div class=\"view-state-errored-visible alert alert-error\" data-view=\"create\"&gt;\n          &lt;strong&gt;There was an error creating your issue:&lt;/strong&gt;\n          &lt;div data-link=\"html{&gt;state.createError}\"&gt;&lt;/div&gt;\n          &lt;button class=\"btn btn-primary pull-right\" type=\"submit\" data-csm-counter=\"createViewTryAgainButton\"&gt;\n            Try again\n          &lt;/button&gt;\n          &lt;div class=\"clearfix\"&gt;&lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"view-state-redirecting-visible alert alert-success\" data-view=\"create\"&gt;\n          Redirecting you to\n          &lt;a href=\"/issues/undefined\" data-link=\"href{:'/issues/' + issue.id}   data-issue-id{htmlAttr:issue.id}\" data-issue-id=\"\"&gt;\n            your new issue\n          &lt;/a&gt;\n        &lt;/div&gt;enter code here\n</code></pre>\n\n<p>Any help would be appreciated i'm trying to edit another persons VBA that left.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1548876991, "post_id": 54448210, "comment_id": 95705439, "body": "What&#39;s the value of the cell when it errors? Presumably not a number."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1548877195, "post_id": 54448210, "comment_id": 95705523, "body": "Have you tried the <code>Mod</code> operator?"}, {"owner": {"reputation": 1, "user_id": 10985869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420b87633906a1b9e2f7a0470a899844?s=128&d=identicon&r=PG&f=1", "display_name": "DBstone", "link": "https://stackoverflow.com/users/10985869/dbstone"}, "edited": false, "score": 0, "creation_date": 1548877732, "post_id": 54448210, "comment_id": 95705775, "body": "I thought the IF THEN function would be better since most of the measurements will fall within the 0-360 range so I only need a correction on those falling outside those ranges."}, {"owner": {"reputation": 1, "user_id": 10985869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420b87633906a1b9e2f7a0470a899844?s=128&d=identicon&r=PG&f=1", "display_name": "DBstone", "link": "https://stackoverflow.com/users/10985869/dbstone"}, "edited": false, "score": 0, "creation_date": 1548877842, "post_id": 54448210, "comment_id": 95705821, "body": "All of the values for that column are numbers"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "is_accepted": false, "score": 0, "last_activity_date": 1548877897, "creation_date": 1548877897, "answer_id": 54448492, "question_id": 54448210, "link": "https://stackoverflow.com/questions/54448210/if-then-statement-for-correcting-angular-measurements/54448492#54448492", "title": "If \u2026 Then statement for correcting angular measurements", "body": "<p>You can cover both corrections with Abs and Mod.</p>\n\n<pre><code>Dim k As Integer\nFor k = 4 To 1004\n    Cells(k, 5).Value = Abs(Cells(k, 5).Value Mod 360)\nNext k\n</code></pre>\n\n<p>If -15\u00b0 should be 345\u00b0 and not 15\u00b0 then,</p>\n\n<pre><code>Dim k As Integer\nFor k = 4 To 1004\n    Cells(k, 5).Value = Abs(Cells(k, 5).Value Mod 360 - (Cells(k, 5).Value &lt; 0) * 360)\nNext k\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10985869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420b87633906a1b9e2f7a0470a899844?s=128&d=identicon&r=PG&f=1", "display_name": "DBstone", "link": "https://stackoverflow.com/users/10985869/dbstone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1548924479, "creation_date": 1548876803, "last_edit_date": 1548924479, "question_id": 54448210, "link": "https://stackoverflow.com/questions/54448210/if-then-statement-for-correcting-angular-measurements", "title": "If \u2026 Then statement for correcting angular measurements", "body": "<p>I am trying to automate a script that automatically corrects angular orientation measurements to within the 0-360 range.  Every time I Run my code I get a run-time error 13 Type Mismatch though.  When I ask to debug it highlights the Then section of the function but I don't know specifically what it wants me to change.  </p>\n\n<pre><code> Dim k As Integer\n    For k = 4 To 1004\n    If Cells(k, 5).Value &gt; 360 Then Cells(k, 5).Value = Cells(k, 5).Value - 360\n    If Cells(k, 5).Value &lt; 0 Then Cells(k, 5).Value = Cells(k, 5).Value + 360\nNext k\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping", "drop-down-menu"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1549461067, "post_id": 54448250, "comment_id": 95910069, "body": "Did this answer your question please?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1548877268, "last_edit_date": 1548877268, "creation_date": 1548876958, "answer_id": 54448250, "question_id": 54448137, "link": "https://stackoverflow.com/questions/54448137/scrape-dependent-filled-drop-down-list/54448250#54448250", "title": "Scrape dependent filled Drop-down list", "body": "<p>You can use a css selector combination. The below use an id (<code>#</code>) selector to target the parent <code>select</code> tag element in descendant combination with <code>option</code> element selector to get all the child <code>option</code> tag elements.</p>\n\n<pre><code>Dim nodeList As Object, i As Long\nSet nodeList = HTMLDoc.querySelectorAll(\"#pkCodEstado option\")\nFor i = 0 To nodeList.Length-1\n    Debug.Print nodeList.item(i).innerText\nNext\n</code></pre>\n\n<p><code>i</code> is already declared at the top so you don't actually need to declare again. You should use <code>Option Explicit</code> at the top off all modules and thus declare all your variables. You have a number of undeclared variables in your code.</p>\n"}], "owner": {"reputation": 1, "user_id": 10990465, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_caRSCiIkhA/AAAAAAAAAAI/AAAAAAAAAAA/WE4-qeVyOP8/photo.jpg?sz=128", "display_name": "Ytribal", "link": "https://stackoverflow.com/users/10990465/ytribal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1609363360, "creation_date": 1548876490, "last_edit_date": 1609363360, "question_id": 54448137, "link": "https://stackoverflow.com/questions/54448137/scrape-dependent-filled-drop-down-list", "title": "Scrape dependent filled Drop-down list", "body": "<p>Using Excel VBA, I wish to scrape values from two Drop-down lists. One is filled with states' names, and another with cities.</p>\n<p>I can scrape the states names, but when I try to scrape the cities names I get nothing. The cities list is filled accordingly to state selected.</p>\n<p>How can I list every city on second drop-down list for each state in the first list?</p>\n<p>This query gives me only state names and the default value of the second list:</p>\n<pre><code>Sub ScrapDropDown()\n    Const URL As String = &quot;http://idebescola.inep.gov.br/ideb/consulta-publica&quot;\n    Dim XMLPage As New MSXML2.XMLHTTP60\n    Dim HTMLDoc As New MSHTML.HTMLDocument\n    XMLPage.Open &quot;GET&quot;, URL, False\n    XMLPage.send\n    HTMLDoc.body.innerHTML = XMLPage.responseText\n    Set HTMLDocment = HTMLDoc.getElementById(&quot;pkCodEstado&quot;)\n    For i = 1 To HTMLDocment.Length - 1\n        Set HTMLpkCodMunicipio = HTMLDoc.getElementById(&quot;pkCodMunicipio&quot;)\n        For Each HTMLMun In HTMLpkCodMunicipio.getElementsByTagName(&quot;option&quot;)\n            Debug.Print i &amp; &quot;-&quot; &amp; HTMLDocment(i).Value &amp; &quot;-&quot; &amp; HTMLDocment(i).innerText &amp; &quot;-&quot; &amp; HTMLMun.Value &amp; &quot;-&quot; &amp; HTMLMun.innerText\n        Next HTMLMun\n    Next i\nEnd Sub\n</code></pre>\n<p>Part of HTML with drop list i want to scrape (three dots I removed another unwanted lists), where selected (on site) a state from the first list, without selecting id=&quot;pkCodMunicipio&quot; have only one option</p>\n<pre><code>&lt;form method=&quot;post&quot; name=&quot;frm&quot; class=&quot;classForm&quot; id=&quot;frm&quot;&gt;\n&lt;label for=&quot;pkCodEntidade&quot;&gt;Por C\u00f3digo&lt;/label&gt;\n&lt;div class=&quot;divRequired&quot;&gt;\n&lt;/div&gt;\n&lt;input name=&quot;pkCodEntidade&quot; id=&quot;pkCodEntidade&quot; placeholder=&quot;C\u00f3digo da Escola&quot; title=&quot;Por C\u00f3digo&quot; class=&quot;onlynumbers&quot; maxlength=&quot;8&quot; tabindex=&quot;15&quot; type=&quot;text&quot; value=&quot;&quot;&gt;\n&lt;hr&gt;\n&lt;label id=&quot;lbl&quot;&gt;Por \u00e1rea de interesse&lt;/label&gt;\n&lt;div id=&quot;lblDivRequired&quot; class=&quot;divRequired&quot; style=&quot;display: ;&quot;&gt;\n&lt;/div&gt;\n&lt;select name=&quot;pkCodEstado&quot; id=&quot;pkCodEstado&quot; tabindex=&quot;16&quot;&gt;\n&lt;option value=&quot;&quot;&gt;UF&lt;/option&gt;\n&lt;option value=&quot;12&quot;&gt;ACRE&lt;/option&gt;\n&lt;option value=&quot;27&quot;&gt;ALAGOAS&lt;/option&gt;\n&lt;option value=&quot;16&quot;&gt;AMAP\u00c1&lt;/option&gt;\n&lt;option value=&quot;13&quot;&gt;AMAZONAS&lt;/option&gt;\n&lt;option value=&quot;29&quot;&gt;BAHIA&lt;/option&gt;\n&lt;option value=&quot;23&quot;&gt;CEAR\u00c1&lt;/option&gt;\n&lt;option value=&quot;53&quot;&gt;DISTRITO FEDERAL&lt;/option&gt;\n&lt;option value=&quot;32&quot;&gt;ESP\u00cdRITO SANTO&lt;/option&gt;\n&lt;option value=&quot;52&quot;&gt;GOI\u00c1S&lt;/option&gt;\n&lt;option value=&quot;21&quot;&gt;MARANH\u00c3O&lt;/option&gt;\n&lt;option value=&quot;51&quot;&gt;MATO GROSSO&lt;/option&gt;\n&lt;option value=&quot;50&quot;&gt;MATO GROSSO DO SUL&lt;/option&gt;\n&lt;option value=&quot;31&quot;&gt;MINAS GERAIS&lt;/option&gt;\n&lt;option value=&quot;15&quot;&gt;PAR\u00c1&lt;/option&gt;\n&lt;option value=&quot;25&quot;&gt;PARA\u00cdBA&lt;/option&gt;\n&lt;option value=&quot;41&quot;&gt;PARAN\u00c1&lt;/option&gt;\n&lt;option value=&quot;26&quot;&gt;PERNAMBUCO&lt;/option&gt;\n&lt;option value=&quot;22&quot;&gt;PIAU\u00cd&lt;/option&gt;\n&lt;option value=&quot;33&quot;&gt;RIO DE JANEIRO&lt;/option&gt;\n&lt;option value=&quot;24&quot;&gt;RIO GRANDE DO NORTE&lt;/option&gt;\n&lt;option value=&quot;43&quot;&gt;RIO GRANDE DO SUL&lt;/option&gt;\n&lt;option value=&quot;11&quot;&gt;ROND\u00d4NIA&lt;/option&gt;\n&lt;option value=&quot;14&quot;&gt;RORAIMA&lt;/option&gt;\n&lt;option value=&quot;42&quot;&gt;SANTA CATARINA&lt;/option&gt;\n&lt;option value=&quot;35&quot;&gt;S\u00c3O PAULO&lt;/option&gt;\n&lt;option value=&quot;28&quot;&gt;SERGIPE&lt;/option&gt;\n&lt;option value=&quot;17&quot;&gt;TOCANTINS&lt;/option&gt;\n&lt;/select&gt;\n&lt;select name=&quot;pkCodMunicipio&quot; id=&quot;pkCodMunicipio&quot; tabindex=&quot;17&quot;&gt;\n&lt;option value=&quot;&quot;&gt;Munic\u00edpios&lt;/option&gt;\n&lt;option value=&quot;1400050&quot;&gt;ALTO ALEGRE&lt;/option&gt;\n&lt;option value=&quot;1400027&quot;&gt;AMAJARI&lt;/option&gt;\n&lt;option value=&quot;1400100&quot;&gt;BOA VISTA&lt;/option&gt;\n&lt;option value=&quot;1400159&quot;&gt;BONFIM&lt;/option&gt;\n&lt;option value=&quot;1400175&quot;&gt;CANTA&lt;/option&gt;\n&lt;option value=&quot;1400209&quot;&gt;CARACARAI&lt;/option&gt;\n&lt;option value=&quot;1400233&quot;&gt;CAROEBE&lt;/option&gt;\n&lt;option value=&quot;1400282&quot;&gt;IRACEMA&lt;/option&gt;\n&lt;option value=&quot;1400308&quot;&gt;MUCAJAI&lt;/option&gt;\n&lt;option value=&quot;1400407&quot;&gt;NORMANDIA&lt;/option&gt;\n&lt;option value=&quot;1400456&quot;&gt;PACARAIMA&lt;/option&gt;\n&lt;option value=&quot;1400472&quot;&gt;RORAINOPOLIS&lt;/option&gt;\n&lt;option value=&quot;1400506&quot;&gt;SAO JOAO DA BALIZA&lt;/option&gt;\n&lt;option value=&quot;1400605&quot;&gt;SAO LUIZ&lt;/option&gt;\n&lt;option value=&quot;1400704&quot;&gt;UIRAMUTA&lt;/option&gt;\n&lt;/select&gt;\n...\n&lt;button name=&quot;btnSearch&quot; class=&quot;btnDefault btn btn-warning&quot; title=&quot;Buscar&quot; type=&quot;submit&quot; id=&quot;btnSearch&quot; onclick=&quot;void(0);&quot;&gt;Buscar&lt;/button&gt;\n&lt;/div&gt;\n&lt;input type=&quot;hidden&quot; name=&quot;undefined&quot; value=&quot;undefined&quot;&gt;\n&lt;/form&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10992236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf4bcd6ce0552f37d53a14e667674f1?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/10992236/victor"}, "edited": false, "score": 0, "creation_date": 1548918484, "post_id": 54450886, "comment_id": 95718277, "body": "thanks. I additionally  want to clear  table 2 before running the scrip.  There for I tried to include <code>Range .Clear</code> command. Is that right  ?"}, {"owner": {"reputation": 1, "user_id": 10992236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf4bcd6ce0552f37d53a14e667674f1?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/10992236/victor"}, "edited": false, "score": 0, "creation_date": 1548918749, "post_id": 54450886, "comment_id": 95718406, "body": "Also how to achieve if don&#39;t know the range length for <code>rcolor</code>. I want code to scroll down for   <code>rcolor</code> until it finds last entry.  ( Color column will contain no gaps)"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 1, "user_id": 10992236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf4bcd6ce0552f37d53a14e667674f1?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/10992236/victor"}, "edited": false, "score": 0, "creation_date": 1549123180, "post_id": 54450886, "comment_id": 95794881, "body": "I use <code>Range.ClearContents</code>."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 1, "user_id": 10992236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf4bcd6ce0552f37d53a14e667674f1?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/10992236/victor"}, "edited": false, "score": 0, "creation_date": 1549123267, "post_id": 54450886, "comment_id": 95794910, "body": "It kind of depends on your situation. Take a look at <code>Range.CurrentRegion</code> and <code>Range.End</code>"}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 0, "last_activity_date": 1548889366, "creation_date": 1548889366, "answer_id": 54450886, "question_id": 54448077, "link": "https://stackoverflow.com/questions/54448077/how-to-use-vba-to-generate-an-excel-table/54450886#54450886", "title": "How to use VBA to generate an Excel table", "body": "<p>It's kind of ugly, but it gets the job done.  Your code is close, you just have to check for empty cells.</p>\n\n<pre><code>Public Sub MakeComboTable()\n\n    Dim rColor As Range\n    Dim rModel As Range\n    Dim rYear As Range\n    Dim lCnt As Long\n\n    For Each rColor In Sheet1.Range(\"G4:G11\").Cells\n        If Not IsEmpty(rColor.Value) Then\n            For Each rModel In Sheet1.Range(\"H4:H11\").Cells\n                If Not IsEmpty(rModel.Value) Then\n                    For Each rYear In Sheet1.Range(\"I4:I11\").Cells\n                        If Not IsEmpty(rYear.Value) Then\n                            lCnt = lCnt + 1\n                            Sheet1.Range(\"B1\").Offset(lCnt, 0).Value = rColor.Value\n                            Sheet1.Range(\"B1\").Offset(lCnt, 1).Value = rModel.Value\n                            Sheet1.Range(\"B1\").Offset(lCnt, 2).Value = rYear.Value\n                        End If\n                    Next rYear\n                End If\n            Next rModel\n        End If\n    Next rColor\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10992236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cf4bcd6ce0552f37d53a14e667674f1?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/10992236/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548924469, "creation_date": 1548876199, "last_edit_date": 1548924469, "question_id": 54448077, "link": "https://stackoverflow.com/questions/54448077/how-to-use-vba-to-generate-an-excel-table", "title": "How to use VBA to generate an Excel table", "body": "<p>I an new to VBA. How I can I use VBA to generate a table based on data from another table? For example: generate table2  from table1, where I would get all possible combinations for Color key; </p>\n\n<p>table 1 consist of: color, model, year.</p>\n\n<p>In table 2 I want to generate all possible combinations for color+model+year</p>\n\n<p><a href=\"https://i.stack.imgur.com/W0gAM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W0gAM.png\" alt=\"excel sheet screenshot\"></a></p>\n\n<p>I manage to write this code</p>\n\n<pre><code>Sub generatedinput() \n    Dim listA As Range\n    Dim listB As Range\n    Dim listC As Range\n\n    Range(\"D11:F999\").Clear\n\n    Set listA = Range(\"I11\", Range(\"I11\").End(xlDown))\n    Set listB = Range(\"J11\", Range(\"J11\").End(xlDown))\n    Set listC = Range(\"K11\", Range(\"K11\").End(xlDown))\n\n    y = 11\n\n    For Each cellA In listA\n        For Each cellB In listB\n            For Each cellC In listC\n                Cells(y, 4).Value = cellA.Value\n                Cells(y, 5).Value = cellB.Value\n                Cells(y, 6).Value = cellC.Value\n                y = y + 1\n            Next\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>But generates for empties cells as well. How to skip blank cells?   </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1548877101, "post_id": 54448007, "comment_id": 95705483, "body": "I think you&#39;ll have to loop from row 1 until you find a number &gt;1."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1548877288, "creation_date": 1548877288, "answer_id": 54448320, "question_id": 54448007, "link": "https://stackoverflow.com/questions/54448007/code-to-copy-data-starting-at-a-specific-value-of-a-cell/54448320#54448320", "title": "Code to copy data starting at a specific value of a cell", "body": "<p>Don't think you can avoid a loop. I'd prefer <code>End(xlup)</code> in case you have only one value in column B after the chosen cell or blanks in the middle.</p>\n\n<pre><code>Sub x()\n\nDim r As Long\n\nDo\n    r = r + 1\nLoop Until Cells(r, 2).Value &gt; 1\n\nMsgBox \"Row \" &amp; r\n\nRange(Cells(r, \"B\"), Cells(r, \"B\").End(xlDown)).Copy\n'ETC\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10992266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XbAQIAiq-jY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPhOvQEJu_Psjspz7VnXm2FPKogag/mo/photo.jpg?sz=128", "display_name": "Dalton Wright", "link": "https://stackoverflow.com/users/10992266/dalton-wright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 54448320, "answer_count": 1, "score": 0, "last_activity_date": 1548877681, "creation_date": 1548875893, "last_edit_date": 1548877681, "question_id": 54448007, "link": "https://stackoverflow.com/questions/54448007/code-to-copy-data-starting-at-a-specific-value-of-a-cell", "title": "Code to copy data starting at a specific value of a cell", "body": "<p><a href=\"https://i.stack.imgur.com/jdWzT.png\" rel=\"nofollow noreferrer\">graph of data</a></p>\n\n<p>I am trying to write a code that copies data from multiple csv files into a master sheet.</p>\n\n<p>I have everything in the code correct but some of the data is offset by a thousand or so rows.\nI need a code that goes into column B scans the values of the cells until it reaches the first cell with a value greater than 1; Or looking at the graph starting at the first big jump of data, and copies the data from the value greater than 1 until the end of the column.\nI can't figure out a way to select the first cell in column B greater than 1 </p>\n\n<pre><code>ActiveSheet.Range(\"B1\", ActiveSheet.Range(\"B1\").End(xlDown)).Copy\n</code></pre>\n\n<p>This is the original code that I have but instead of a \"B1\" I want it to start at a certain cell value greater than 1</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1548876074, "post_id": 54447995, "comment_id": 95704955, "body": "Why do you need the loop at all?  You can use <code>SUM</code> on more than one column at the same time, i.e. <code>=SUM(A1:E10)</code>.  Also, if you&#39;re simply adding all the values in the range in VBA, just looping through and simply adding them is likely going to be much more performant that repeatedly calling <code>WorksheetFunction.Sum</code>."}, {"owner": {"reputation": 405, "user_id": 1100554, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dd1c1863bd1c9da58ede1932822cb99e?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/1100554/sam"}, "edited": false, "score": 0, "creation_date": 1548876902, "post_id": 54447995, "comment_id": 95705389, "body": "@pervis - Agree with Comintern; you are kind of over-complicating this by using VBA.  That said, your code for LastRow and LastColumn are a little excessive. Something like Range.End (see this question for similar: <a href=\"https://stackoverflow.com/questions/25056372/vba-range-row-count\">stackoverflow.com/questions/25056372/vba-range-row-count</a>)"}], "owner": {"reputation": 3, "user_id": 10992273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9977f6d08eb3611e9cf545ffe5f04e0?s=128&d=identicon&r=PG&f=1", "display_name": "pervis", "link": "https://stackoverflow.com/users/10992273/pervis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548875844, "creation_date": 1548875844, "question_id": 54447995, "link": "https://stackoverflow.com/questions/54447995/how-to-get-the-sum-of-the-whole-column", "title": "How to get the sum of the whole column?", "body": "<p>I have code that gives me the sum of the values from rows A - J but it only adds the values from row 1 - 2. I'm trying to get it to sum the values from row 1 - 10. </p>\n\n<pre><code>Sub addcol()\nDim i As Long, j As Long\nDim lastRow As Long\nlastRow = Cells.Find(What:=\"*\", _\nAfter:=Range(\"A1\"), _\nLookAt:=xlPart, _\nLookIn:=xlFormulas, _\nSearchOrder:=xlPrevious, _\nMatchCase:=False).Row\n\nDim LastColumn As Long\nLastColumn = Cells.Find(What:=\"*\", _\nAfter:=Range(\"A1\"), _\nLookAt:=xlPart, _\nLookIn:=xlFormulas, _\nSearchOrder:=xlByColumns, _\nSearchDirection:=xlPrevious, _\nMatchCase:=False).Column\n\nFor j = 1 To lastRow\n    For i = 1 To LastColumn\n    Cells(lastRow + 1, i) = Cells(lastRow + 1, i) + Application.WorksheetFunction.Sum(Cells(j, i))\n    Next i\nNext j\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548924411, "post_id": 54447869, "comment_id": 95721171, "body": "<i>&quot;I open one of my workbooks&quot;</i> Does this workbook run any code automatically? Is there a <code>Workbook_Open</code> event? If so please <a href=\"https://stackoverflow.com/posts/54447869/edit\">edit</a> your question and add the code of this event."}, {"owner": {"reputation": 85, "user_id": 6552440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d2dceb4d295622ab73c1a217867719?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6552440/ben"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1549044661, "post_id": 54447869, "comment_id": 95776926, "body": "No. I even copied the data to a separate workbook and re-saved it to no avail. I am wondering if this had to do with the last 365 update as one happened recently.."}, {"owner": {"reputation": 85, "user_id": 6552440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d2dceb4d295622ab73c1a217867719?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6552440/ben"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1549051588, "post_id": 54447869, "comment_id": 95779625, "body": "I may have stumbled on to something. I renamed the open document to .xslm and the issue instantly disappeared. I have to experiment further. I am not sure why that should effect the entire editor and specifically Personal.xlsb."}, {"owner": {"reputation": 85, "user_id": 6552440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d2dceb4d295622ab73c1a217867719?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6552440/ben"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1549054076, "post_id": 54447869, "comment_id": 95780543, "body": "When I said rename, I meant resaved. Also, from what I am seeing now, as long as there is one file open with the macro extension, .xlsm, then others with .xlsx can be open and the editor continues to work."}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 6552440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d2dceb4d295622ab73c1a217867719?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6552440/ben"}, "is_accepted": true, "score": 1, "last_activity_date": 1552932807, "last_edit_date": 1552932807, "creation_date": 1549383803, "answer_id": 54538771, "question_id": 54447869, "link": "https://stackoverflow.com/questions/54447869/excel-vba-editor-strange-behavior/54538771#54538771", "title": "Excel VBA editor strange behavior", "body": "<p>Whatever the reason for this behavior of not being ale to work on macros in Personal.xlsb, I found a work around. What I do is save an empty workbook to be macro enabled (.xlsm) and then when I want to use the editor properly I go to that workbook and that alt-tab to the editor and it works again as long as the active workbook in Excel is a macro enabled workbook. I don't know why this is but at least I get a working editor again.</p>\n"}], "owner": {"reputation": 85, "user_id": 6552440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d2dceb4d295622ab73c1a217867719?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6552440/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 54538771, "answer_count": 1, "score": 2, "last_activity_date": 1552932807, "creation_date": 1548875366, "last_edit_date": 1548924268, "question_id": 54447869, "link": "https://stackoverflow.com/questions/54447869/excel-vba-editor-strange-behavior", "title": "Excel VBA editor strange behavior", "body": "<p>I am having an issue with the Excel 365 VBA editor. When I first open Excel and go to to the editor, I can type as normal but if I open one of my workbooks it acts strangely.</p>\n\n<p>I cannot type spaces at the end of a line. If I type <code>function</code> it appears in red like something is wrong, when before opening the workbook it would appear black and let me continue to type. </p>\n\n<p>If I type a function <code>isTest</code> for example and I type <code>istest=</code> in the body of the function, it will appear in red without spaces but as soon as I type a character it will appear as <code>isTest = f</code> (typing the letter \"f\" for example) with the spaces automatically inserted and the cursor automatically placed after the \"t\" in isTest and formatted with an uppercase \"T\" like I already completed the line and it formatted it. </p>\n\n<p>Any idea what might be going on and how I can stop this behavior?</p>\n"}, {"tags": ["excel", "vba", "recordset"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1548874384, "post_id": 54447423, "comment_id": 95704115, "body": "Consider posting the full working code (the version you&#39;re actually using) on <a href=\"https://codereview.stackexchange.com\">Code Review</a>, where you would be getting feedback on any/all aspects of the code - including and not limited to performance tuning. Make sure the title describes the purpose of the code, as opposed to what you&#39;re hoping to get for answers (CR has different posting rules than SO)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1548874434, "post_id": 54447423, "comment_id": 95704137, "body": "Have you checked to see if the indentation is making it faster?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548874822, "post_id": 54447423, "comment_id": 95704347, "body": "Start by adding some timing, so you know <i>where</i> it&#39;s slow - for example if your database is slow your VBA is not going to make much difference.  In your second example you duplicate the Find() - there&#39;s no need for that.  It&#39;s not really that clear what you&#39;re doing, so it&#39;s difficult to make real suggestions.  Maybe try Match() instead of Find() - should be a little quicker.  Or create a row lookup using a Dictionary.  A single large DB query should (overall) be faster than multiple smaller ones."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1548875191, "post_id": 54447423, "comment_id": 95704531, "body": "Calling <code>rs.Clone</code> 998 times certainly can&#39;t be helping the performance."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548877125, "post_id": 54447423, "comment_id": 95705499, "body": "For myself I get a little tired of fixing the same old basic mistakes and like to see some variety in the types of questions posted - I would not consider this question off-topic if we define &quot;working code&quot; as &quot;functions to meet my requirements&quot;, since requirements can also include performance.  A &quot;totally new approach&quot; is pretty regularly suggested in answers here, so that shouldn&#39;t be off topic."}, {"owner": {"reputation": 1, "user_id": 10764316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783368a843eba0565285df04941a5945?s=128&d=identicon&r=PG&f=1", "display_name": "Wererty", "link": "https://stackoverflow.com/users/10764316/wererty"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1548940089, "post_id": 54447423, "comment_id": 95730603, "body": "@Comintern I know that and I am not cloning, my current code is the second one. The issue here is that it seems that cloning is better, that is why I am confused and asked this question. But for now I suspect it is indeed because of Find() as Tim Williams suggested."}], "owner": {"reputation": 1, "user_id": 10764316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783368a843eba0565285df04941a5945?s=128&d=identicon&r=PG&f=1", "display_name": "Wererty", "link": "https://stackoverflow.com/users/10764316/wererty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548873658, "creation_date": 1548873658, "question_id": 54447423, "link": "https://stackoverflow.com/questions/54447423/macro-for-excel-using-recordset-optimization", "title": "Macro for excel using recordset - optimization", "body": "<p>I\u2019ve been trying to optimize following code:</p>\n\n<pre><code>Public cn As New ADODB.Connection\nPublic rs As New ADODB.Recordset\nPublic rs2 As New ADODB.Recordset\nPublic strsQL$\n</code></pre>\n\n<p>\u2026</p>\n\n<pre><code>For c = 9 To 50\n\nstrsQL = \"some SQL query\"\nrs.Open strsQL, cn\nFor r = 2 To 1000\n        t = 0\n        If c &lt;&gt; 9 Then\n            For f = 9 To c - 1\n                t = t + Sheet9.Cells(8 + (r - 2) * 6, f)\n            Next f\n        End If\n\n        Set rs2 = rs.Clone\n        rs2.Find (\"x='\" &amp; Sheet9.Cells(r, 2) &amp; \"'\")\n        If rs2.EOF Then\n            Sheet9.Cells(r, c) = \"\"\n        Else\n            If rs2.Fields(\"Total\").Value - t &lt;&gt; 0 Then\n                Sheet9.Cells(r, c) = rs2.Fields(1).Value - t\n            End If\n        End If\n    Next r\n    rs.Close\n    rs2.Close\nNext c\ncn.Close\nClose Connection\nSet rs = Nothing\nSet cn = Nothing\nSet rs2 = Nothing\n</code></pre>\n\n<p>And here is my idea (or actually was because it is slower):</p>\n\n<p>\u2026</p>\n\n<pre><code>For c = 9 To 50        \nstrsQL = \"some SQL query \"\nrs.Open strsQL, cn\n\nDo While rs.EOF = False\nt = 0\nIf Not ThisWorkbook.Sheet9.Range(\"B:B\").Find(what:=rs.Fields(0).Value, \nLookIn:=xlValues, lookat:=xlWhole) Is Nothing Then\n\nP_row = ThisWorkbook.Sheet9.Range(\"B:B\").Find(what:=rs.Fields(0).Value, LookIn:=xlValues, lookat:=xlWhole).Row\nadr_1 = ThisWorkbook.Sheet9.Cells(P_row + 4, 9).Address\nadr_2 = ThisWorkbook.Sheet9.Cells(P_row + 4, c - 1).Address\nt = Application.WorksheetFunction.Sum(ThisWorkbook.Sheet9.Range(adr_1 &amp; \":\" &amp; adr_2))\n\nIf rs.Fields(1).Value - t &gt; 0 Then\nSheet9.Cells(P_row, c) = rs.Fields(1).Value - t\nEnd If\nEnd If\nrs.MoveNext\nLoop\nrs.Close\nNext c\n\ncn.Close\nSet rs = Nothing\nSet cn = Nothing\n</code></pre>\n\n<p>I do not understand why the runtime of second code is worse. First code goes through each column and for each column opens recordset and go through each row of column B from the worksheet in order to find if the row value is included in the recordset. So even if the searched row is not included in the recordset, the recordset is whole searched by command rs.find.\nAs each recordset has much less records than 1000 I was quite sure that it will be better for each column go through recordset and put the values only for found records as the rest can be left empty anyway . But it seems that it is not true. </p>\n\n<p>And I have also used application.worksheetfunction.sum instead of summing in the loop but I don't expect it to be relevant as much.</p>\n\n<p>Maybe anyone can help me to find what is wrong with my understanding?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1548873403, "post_id": 54447176, "comment_id": 95703586, "body": "Consider using a <code>Scripting.FileSystemObject</code> for a more robust solution. Also <code>fName</code> should probably be passed <code>ByVal</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548873540, "post_id": 54447176, "comment_id": 95703664, "body": "Try <code>sFName = Dir(fldName &amp; &quot;\\*.txt&quot;)</code> instead of <code>sFName = Dir(fldName)</code> - that&#39;ll eliminate the need to verify the extension, ...and could very well just fix it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1548875100, "post_id": 54447176, "comment_id": 95704490, "body": "Do you have any other VBA code running as event handlers that would be firing in response to your <code>SendasAttachment</code> function?  The state of <code>Dir</code> is application global, so if you&#39;re invoking it anywhere else that would cause this behavior."}, {"owner": {"reputation": 23, "user_id": 10991991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3808000329696092d00ee8a233988f79?s=128&d=identicon&r=PG&f=1", "display_name": "Willy Chen", "link": "https://stackoverflow.com/users/10991991/willy-chen"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548880521, "post_id": 54447176, "comment_id": 95706942, "body": "@MathieuGuindon Thanks for the suggestion, I did try that at first and had the same issue too."}, {"owner": {"reputation": 23, "user_id": 10991991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3808000329696092d00ee8a233988f79?s=128&d=identicon&r=PG&f=1", "display_name": "Willy Chen", "link": "https://stackoverflow.com/users/10991991/willy-chen"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1548880675, "post_id": 54447176, "comment_id": 95707003, "body": "@Comintern I think that&#39;s the problem! I didn&#39;t realize that until you suggested it, but there is indeed another module running in my Outlook (didn&#39;t think about it because I wasn&#39;t the one who set that up) and sure enough, it includes the Dir function. But then I wonder why the code works fine when I don&#39;t insert the string returned by the Dir function into the email subject..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1548881388, "post_id": 54447176, "comment_id": 95707350, "body": "Pretty sure the subject thing is a red herring: your princess is in another castle -- <code>Dir</code> working off whatever the current value of <code>CurDir</code> is, is a much more likely cause"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10991991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3808000329696092d00ee8a233988f79?s=128&d=identicon&r=PG&f=1", "display_name": "Willy Chen", "link": "https://stackoverflow.com/users/10991991/willy-chen"}, "edited": false, "score": 0, "creation_date": 1548880440, "post_id": 54448172, "comment_id": 95706906, "body": "Fantastic, thanks for the post! I did find a website showing the FileSystem Object method but couldn&#39;t get it to work, but your code works great. One basic question: if I wanted to pass another String object into the function, what&#39;s the right syntax for that? SendasAttachment(strfullPath, secondStr) gives compiler error, and Call SendasAttachment(...,...) gives a runtime error... (this is after I have correctly declared two String objects in Function SendasAttachment(fullPath As String, secondString As String)."}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": true, "score": 1, "last_activity_date": 1548876663, "creation_date": 1548876663, "answer_id": 54448172, "question_id": 54447176, "link": "https://stackoverflow.com/questions/54447176/send-all-files-in-folder-as-separate-attachments/54448172#54448172", "title": "Send all files in folder as separate attachments", "body": "<p>I would use a FileSystem object and then loop through all files in the directory like the following:</p>\n\n<pre><code>Sub SendFilesbyEmail()\n    Dim objFSO as object\n    Dim objFldr as Object\n    Dim objFile  as Object\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFldr = objFSO.GetFolder(\"C:\\Users\\Test\")\n\n    For Each objFile In objFldr.Files \n        strFullPath = objFldr.Path  &amp; \"\\\" &amp; objFile.Name\n\n        If LCase(Trim(objFSO.GetExtensionName(strFullPath))) = \"txt\" Then\n            SendasAttachment(strFullPath)\n        End If\n    Next\n\n\n    set objFldr = nothing\n    set objFSO = nothing\nEnd Sub\n\n\nFunction SendasAttachment(fullPath As String)\n\n    Dim olApp As Outlook.Application\n    Dim olMsg As Outlook.MailItem\n    Dim olAtt As Outlook.Attachments\n\n    Dim localfName As String\n    Dim localfldName As String\n\n    Set olApp = Outlook.Application\n    Set olMsg = olApp.CreateItem(0) ' email\n    Set olAtt = olMsg.Attachments\n\n    ' attach file\n    olAtt.Add (fullPath)\n    localfName = fName\n\n      '  send message\n    With olMsg\n      .Subject = \"PDF Import: \" &amp; Left(fullPath, Len(fullPath) - 4)\n      .To = \"test@test.com\"\n      .HTMLBody = \"Test\"\n      .Send\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10991991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3808000329696092d00ee8a233988f79?s=128&d=identicon&r=PG&f=1", "display_name": "Willy Chen", "link": "https://stackoverflow.com/users/10991991/willy-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "accepted_answer_id": 54448172, "answer_count": 1, "score": 2, "last_activity_date": 1592693487, "creation_date": 1548872765, "last_edit_date": 1592693487, "question_id": 54447176, "link": "https://stackoverflow.com/questions/54447176/send-all-files-in-folder-as-separate-attachments", "title": "Send all files in folder as separate attachments", "body": "<p>I am trying to attach all files in a folder in separate emails using a modified version of this code from <a href=\"https://www.slipstick.com/developer/macro-send-files-email/\" rel=\"nofollow noreferrer\">https://www.slipstick.com/developer/macro-send-files-email/</a>.</p>\n\n<pre><code>Dim fldName As String\n\nSub SendFilesbyEmail()\n' From http://slipstick.me/njpnx\nDim sFName As String\n\ni = 0\nfldName = \"C:\\Users\\Test\"\nsFName = Dir(fldName)\nDo While Len(sFName) &gt; 0\n'filter for only *.txt\n  If Right(sFName, 4) = \".txt\" Then\n      Call SendasAttachment(sFName)\n      i = i + 1\n  End If\n  sFName = Dir\nLoop\nMsgBox i &amp; \" files were sent\"\nEnd Sub\n\nFunction SendasAttachment(fName As String)\n\nDim olApp As Outlook.Application\nDim olMsg As Outlook.MailItem\nDim olAtt As Outlook.Attachments\n\nDim localfName As String\nDim localfldName As String\n\nSet olApp = Outlook.Application\nSet olMsg = olApp.CreateItem(0) ' email\nSet olAtt = olMsg.Attachments\n\n' attach file\nolAtt.Add (fldName &amp; fName)\nlocalfName = fName\n\n   ' send message\nWith olMsg\n  .Subject = \"PDF Import: \" &amp; Left(localfName, Len(localfName) - 4)\n  .To = \"test@test.com\"\n  .HTMLBody = \"Test\"\n  .Send\nEnd With\nEnd Function\n</code></pre>\n\n<p>The issue comes with trying to put the file name into the email subject.</p>\n\n<pre><code>.Subject = \"PDF Import: \" &amp; Left(localfName, Len(localfName) - 4)\n</code></pre>\n\n<p>If I remove localfName from the subject, to send a generic subject for all emails, the code works fine.</p>\n\n<p>When I put either fName or localfName (my attempt to debug the issue), the first email sends, but on the second iteration, the DIR function returns a file name from a different folder, and the code breaks because the file it's trying to attach can't be found.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 1401947, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8a3add9971eb64b5d92e053218050bad?s=128&d=identicon&r=PG", "display_name": "officemanager2", "link": "https://stackoverflow.com/users/1401947/officemanager2"}, "edited": false, "score": 0, "creation_date": 1548873605, "post_id": 54447308, "comment_id": 95703698, "body": "Yes, that worked great. I need to understand why AA.Cells(1) is necessary to achieve my end goal.  My understanding at this point is that AA as the range is &#39;set&#39; so I&#39;m not sure why I need to, as I&#39;m interpreting this, set the range for AA again?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 17, "user_id": 1401947, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8a3add9971eb64b5d92e053218050bad?s=128&d=identicon&r=PG", "display_name": "officemanager2", "link": "https://stackoverflow.com/users/1401947/officemanager2"}, "edited": false, "score": 0, "creation_date": 1548874054, "post_id": 54447308, "comment_id": 95703962, "body": "@officemanager2 - When you first set <code>AA</code>, you set it to a <code>CurrentRegion</code> which is more than one cell.  Let&#39;s say it&#39;s <code>C5:N15</code>.  When you do <code>AA.Cells(1)</code>, this refers to the first cell <i>within</i> the <code>AA</code> range.  This would be <code>C5</code>.  <code>AA.Cells(2)</code> would be <code>D5</code>, etc. (as you increase <code>Cells()</code>, it moves first by column, then row).  If you simply offset <code>AA</code>, then it&#39;s offsetting the <i>whole range</i>, where you just want a single cell to be offset."}, {"owner": {"reputation": 17, "user_id": 1401947, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8a3add9971eb64b5d92e053218050bad?s=128&d=identicon&r=PG", "display_name": "officemanager2", "link": "https://stackoverflow.com/users/1401947/officemanager2"}, "edited": false, "score": 0, "creation_date": 1548874728, "post_id": 54447308, "comment_id": 95704293, "body": "Ok, if I understand your feed back, the location of the final sum is arrived upon using offset, but I was not supplying the offset with the specific location to work from so instead the entire CurrentRegion was being used.  I&#39;ve been trying different locations with both the Cells(1) and the Offset. Thank you for the clear follow up."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 17, "user_id": 1401947, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8a3add9971eb64b5d92e053218050bad?s=128&d=identicon&r=PG", "display_name": "officemanager2", "link": "https://stackoverflow.com/users/1401947/officemanager2"}, "edited": false, "score": 0, "creation_date": 1548875613, "post_id": 54447308, "comment_id": 95704740, "body": "@officemanager2 - Yep! I added some code just for your testing, if you step through it with <code>F8</code>, it&#39;ll select the different ranges so you can see visually what it&#39;s referring to."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1548875400, "last_edit_date": 1548875400, "creation_date": 1548873237, "answer_id": 54447308, "question_id": 54447171, "link": "https://stackoverflow.com/questions/54447171/getting-repeats-using-offset-with-current-region/54447308#54447308", "title": "Getting repeats using offset with current region", "body": "<p>It's because you're offsetting a region.  Since you want to offset the first cell in that region, you should be able to do:</p>\n\n<pre><code>AA.Cells(1).Offset(, -1) = Total\n</code></pre>\n\n<p>Edit: To hopefully clarify the <code>Cells()</code> bit:</p>\n\n<pre><code>Sub AddAmounts()\nDim AA As Range\nSet AA = Cells(1, 3).CurrentRegion\n\nAA.Offset(, -1).Select ' Compare this, to the next line\nAA.Cells(1).Offset(,-1).Select ' ...and the next\nAA.Cells(3).Offset(,-1).Select    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 1401947, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8a3add9971eb64b5d92e053218050bad?s=128&d=identicon&r=PG", "display_name": "officemanager2", "link": "https://stackoverflow.com/users/1401947/officemanager2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 54447308, "answer_count": 1, "score": -1, "last_activity_date": 1548875400, "creation_date": 1548872759, "last_edit_date": 1548872954, "question_id": 54447171, "link": "https://stackoverflow.com/questions/54447171/getting-repeats-using-offset-with-current-region", "title": "Getting repeats using offset with current region", "body": "<p>I believe my issue is the use of <code>currentregion</code> but i'm not sure what the alternative is. I've worked a bit with areas and perhaps that is the way to go in the long run, but If I can get a clear answer to this repeat issue it would be greatly appreciated </p>\n\n<pre><code>Sub AddAmounts()\n\nDim AA As Range\nDim Total As Integer\n\nSet AA = Cells(1, 3).CurrentRegion\n\nTotal = WorksheetFunction.Sum(AA)\n    Debug.Print Total\n\nAA.Offset(, -1) = Total\n\nEnd Sub\n</code></pre>\n\n<p>I would like the total to end up in cell <code>B1</code>, which does occur, but unfortunatley I also get the result in cells <code>B2</code> &amp; <code>B3</code> &amp; <code>B4</code></p>\n\n<p>Image of result and desired result</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1548872347, "post_id": 54446845, "comment_id": 95703080, "body": "Do you mean that 91004 needs to be the last row used in column C? If so there is plenty online about how to find the last cell in a column."}, {"owner": {"reputation": 3, "user_id": 10963834, "user_type": "registered", "profile_image": "https://graph.facebook.com/2063424647069943/picture?type=large", "display_name": "Soumen Das", "link": "https://stackoverflow.com/users/10963834/soumen-das"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1548905354, "post_id": 54446845, "comment_id": 95714024, "body": "The last row is not fixed...it can be anything in between 75000 to 1000000. i want my code to check that last row in Column C and give me output in column V."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10963834, "user_type": "registered", "profile_image": "https://graph.facebook.com/2063424647069943/picture?type=large", "display_name": "Soumen Das", "link": "https://stackoverflow.com/users/10963834/soumen-das"}, "edited": false, "score": 0, "creation_date": 1548959659, "post_id": 54467145, "comment_id": 95742162, "body": "But Can anyone suggest if I don&#39;t want to see the Vlookup formula in Column &quot;V&quot; what should I use?"}], "tags": [], "owner": {"reputation": 3, "user_id": 10963834, "user_type": "registered", "profile_image": "https://graph.facebook.com/2063424647069943/picture?type=large", "display_name": "Soumen Das", "link": "https://stackoverflow.com/users/10963834/soumen-das"}, "is_accepted": false, "score": 0, "last_activity_date": 1548959639, "creation_date": 1548959639, "answer_id": 54467145, "question_id": 54446845, "link": "https://stackoverflow.com/questions/54446845/vlookup-with-worksheet-function-vba-without-fixing-the-range/54467145#54467145", "title": "vlookup with worksheet function vba without fixing the range", "body": "<p>I have found a way and its working fine.\n.range(\"V2:V91004\").formula can be replaced by <strong>.range(\"V2:V\" &amp; range(\"C\" &amp; rows.count).end(xlup).row).formula</strong>..</p>\n"}], "owner": {"reputation": 3, "user_id": 10963834, "user_type": "registered", "profile_image": "https://graph.facebook.com/2063424647069943/picture?type=large", "display_name": "Soumen Das", "link": "https://stackoverflow.com/users/10963834/soumen-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548959639, "creation_date": 1548871405, "last_edit_date": 1548871824, "question_id": 54446845, "link": "https://stackoverflow.com/questions/54446845/vlookup-with-worksheet-function-vba-without-fixing-the-range", "title": "vlookup with worksheet function vba without fixing the range", "body": "<p>I want to write a vba code to do vlookup with worksheet function where my range is changing every time.I have written the below code:</p>\n\n<pre><code>dim ws as worksheet\nset ws = thisworkbook.sheets(\"master sheet\")\nwith ws\n.range(\"V2:V91004\").formula = \"=vlookup(C2,sheet2!$A:$B,2,0)\"\nend with\n</code></pre>\n\n<p>I want to remove the Range ie <code>2:V91004</code> and let my code take the range itself because my lookupvalue (column C)row number varies from 75000 to 100000. Pls suggest..</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "edited": false, "score": 0, "creation_date": 1548870596, "post_id": 54446569, "comment_id": 95702222, "body": "Change to an xlR1C1 style formula and use .Range(&quot;L&quot; &amp; i).FormulaR1C1 ="}, {"owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "edited": false, "score": 0, "creation_date": 1548871414, "post_id": 54446569, "comment_id": 95702629, "body": "Are you sure you want to use J2, K2 when your loop starts at row 1?"}, {"owner": {"reputation": 27, "user_id": 10991847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z3UmPw3kSJ0/AAAAAAAAAAI/AAAAAAAABKI/06rVCJ0p-n4/photo.jpg?sz=128", "display_name": "Gavin", "link": "https://stackoverflow.com/users/10991847/gavin"}, "edited": false, "score": 0, "creation_date": 1548873353, "post_id": 54446569, "comment_id": 95703566, "body": "Thanks for your feedback. I am currently studying R1C1 reference based from your suggestion. I am just new into VBA and usually rely on the record macro button and modify the codes that comes up."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "edited": false, "score": 0, "creation_date": 1548873463, "post_id": 54446569, "comment_id": 95703620, "body": "See the ConvertFormula approach below. It still concerns me that your loop starts at L1 but the xlA1 formula references J2 and K2."}, {"owner": {"reputation": 27, "user_id": 10991847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z3UmPw3kSJ0/AAAAAAAAAAI/AAAAAAAABKI/06rVCJ0p-n4/photo.jpg?sz=128", "display_name": "Gavin", "link": "https://stackoverflow.com/users/10991847/gavin"}, "edited": false, "score": 0, "creation_date": 1548874972, "post_id": 54446569, "comment_id": 95704431, "body": "Sorry for that, the loop actually starts at L2, could this approach be also used in putting numbers 1-1000 for example beside each cell that has a value?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "edited": false, "score": 0, "creation_date": 1548875132, "post_id": 54446569, "comment_id": 95704504, "body": "L2 makes much more sense! :) The <code>.SpecialCells(xlCellTypeConstants, xlNumbers).Offset(0, 1)</code> can be used to identify typed numbers in the column then offset to another column and write numbers. There is also <code>.SpecialCells(xlCellTypeFormulas, xlNumbers).Offset(0, 1)</code> for formulas returning numbers."}, {"owner": {"reputation": 27, "user_id": 10991847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z3UmPw3kSJ0/AAAAAAAAAAI/AAAAAAAABKI/06rVCJ0p-n4/photo.jpg?sz=128", "display_name": "Gavin", "link": "https://stackoverflow.com/users/10991847/gavin"}, "edited": false, "score": 0, "creation_date": 1548887029, "post_id": 54446569, "comment_id": 95709551, "body": "Thanks again for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10991847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z3UmPw3kSJ0/AAAAAAAAAAI/AAAAAAAABKI/06rVCJ0p-n4/photo.jpg?sz=128", "display_name": "Gavin", "link": "https://stackoverflow.com/users/10991847/gavin"}, "edited": false, "score": 0, "creation_date": 1548873671, "post_id": 54446749, "comment_id": 95703745, "body": "Thanks for this. It has been working perfectly. Will look into R1C1 further. Have a great day!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "is_accepted": true, "score": 1, "last_activity_date": 1548873637, "last_edit_date": 1548873637, "creation_date": 1548871043, "answer_id": 54446749, "question_id": 54446569, "link": "https://stackoverflow.com/questions/54446569/vba-formula-adjustment-per-row-data/54446749#54446749", "title": "VBA Formula - Adjustment per Row Data", "body": "<p>Change to an xlR1C1 style formula and use <code>.Range(\"L\" &amp; i).FormulaR1C1 = ...</code></p>\n\n<pre><code>.Range(\"L\" &amp; i).Formular1c1 = \"=(NETWORKDAYS(rc10, rc11)-1)*(r1c16-r1c15)+IF(NETWORKDAYS(rc11, rc11), MEDIAN(MOD(rc11, 1), r1c16, r1c15), r1c16)-MEDIAN(NETWORKDAYS(rc10, rc10)*MOD(rc10,1), r1c16, r1c15)\"\n</code></pre>\n\n<p>If you are not too familiar with xlR1C1 syntax, let VBA do the work.</p>\n\n<pre><code> Sub Sample()\n\n     Dim i As Long, fA1 As String, fR1C1 As String\n\n     fA1 = \"=(NETWORKDAYS(J2, K2)-1)*($P$1-$O$1)+IF(NETWORKDAYS(K2,K2),MEDIAN(MOD(K2,1), $P$1, $O$1),$P$1)-MEDIAN(NETWORKDAYS(J2,J2)*MOD(J2,1), $P$1, $O$1)\"\n     fR1C1 = Application.ConvertFormula(Formula:=fA1, _\n                                        FromReferenceStyle:=xlA1, _\n                                        ToReferenceStyle:=xlR1C1, _\n                                        RelativeTo:=Range(\"L2\"))\n\n     Debug.Print fR1C1\n     '=(NETWORKDAYS(RC[-2], RC[-1])-1)*(R1C16-R1C15)+IF(NETWORKDAYS(RC[-1],RC[-1]),MEDIAN(MOD(RC[-1],1), R1C16, R1C15),R1C16)-MEDIAN(NETWORKDAYS(RC[-2],RC[-2])*MOD(RC[-2],1), R1C16, R1C15)\n\n     With Worksheets(\"Storage NSNR\")\n         With .Range(.Cells(2, \"K\"), .Cells(Rows.Count, \"K\").End(xlUp))\n            .SpecialCells(xlCellTypeConstants, xlNumbers).Offset(0, 1).FormulaR1C1 = fR1C1\n         End With\n     End With\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10991847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z3UmPw3kSJ0/AAAAAAAAAAI/AAAAAAAABKI/06rVCJ0p-n4/photo.jpg?sz=128", "display_name": "Gavin", "link": "https://stackoverflow.com/users/10991847/gavin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 54446749, "answer_count": 1, "score": 0, "last_activity_date": 1548924196, "creation_date": 1548870459, "last_edit_date": 1548924196, "question_id": 54446569, "link": "https://stackoverflow.com/questions/54446569/vba-formula-adjustment-per-row-data", "title": "VBA Formula - Adjustment per Row Data", "body": "<pre><code> Sub Sample()\n\n     Dim lastRow As Long, i As Long\n     Dim ws As Worksheet\n\n     Set ws = Sheets(\"Storage NSNR\")\n\n     lastRow = ws.Range(\"K\" &amp; Rows.Count).End(xlUp).Row\n\n     With ws\n         For i = 1 To lastRow\n             If Len(Trim(.Range(\"K\" &amp; i).Value)) &lt;&gt; 0 Then _\n             .Range(\"L\" &amp; i).Formula = \"=(NETWORKDAYS(J2, K2)-1)*($P$1-$O$1)+IF(NETWORKDAYS(K2,K2),MEDIAN(MOD(K2,1), $P$1,\n $O$1),$P$1)-MEDIAN(NETWORKDAYS(J2,J2)*MOD(J2,1), $P$1, $O$1)\"\n         Next i\n     End With\n\n End Sub\n</code></pre>\n\n<p>Hi, </p>\n\n<p>Can anyone help me on how can I adjust the formula:</p>\n\n<p><code>=(NETWORKDAYS(J2, K2)-1)*($P$1-$O$1)+IF(NETWORKDAYS(K2,K2),MEDIAN(MOD(K2,1), $P$1, $O$1),$P$1)-MEDIAN(NETWORKDAYS(J2,J2)*MOD(J2,1), $P$1, $O$1)</code></p>\n\n<p>I'm looking to automatically adjust \"J2\" and \"K2\" to \"J3\" and \"K3\" and so on, similar to dragging down the formula. I've looked everywhere but I can't seem to find the correct way of applying it.</p>\n\n<p>Basically, the formula from the next column, \"L1\", until the last available entry for \"K\".</p>\n\n<p>Any help would be appreciated. Thanks.</p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 2, "creation_date": 1548867974, "post_id": 54445780, "comment_id": 95700891, "body": "After <code>PasteSpecial</code> it should be <code>xlPasteValues</code>.  That is the letter L after the x, not the number 1."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1548868332, "post_id": 54445780, "comment_id": 95701083, "body": "And another error that could be easily prevented with <code>Option explicit</code>."}, {"owner": {"reputation": 59, "user_id": 10686696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07876c4563e4bee7c2e30298223740cc?s=128&d=identicon&r=PG&f=1", "display_name": "mdavis0510", "link": "https://stackoverflow.com/users/10686696/mdavis0510"}, "edited": false, "score": 0, "creation_date": 1548868371, "post_id": 54445780, "comment_id": 95701109, "body": "It is a number 1. The lowercase L and 1 look in the same."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1548868412, "post_id": 54445780, "comment_id": 95701134, "body": "It should be &quot;L&quot;"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1548868420, "post_id": 54445780, "comment_id": 95701139, "body": "yeah, but it must be an lowercase L"}, {"owner": {"reputation": 59, "user_id": 10686696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07876c4563e4bee7c2e30298223740cc?s=128&d=identicon&r=PG&f=1", "display_name": "mdavis0510", "link": "https://stackoverflow.com/users/10686696/mdavis0510"}, "edited": false, "score": 0, "creation_date": 1548868635, "post_id": 54445780, "comment_id": 95701258, "body": "The only error I have is when I add the <code>PasteSpecial x1PasteValues</code> if I keep just <code>Paste</code> it works fine. However, I need to copy the value in one column range instead of the formula."}, {"owner": {"reputation": 59, "user_id": 10686696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07876c4563e4bee7c2e30298223740cc?s=128&d=identicon&r=PG&f=1", "display_name": "mdavis0510", "link": "https://stackoverflow.com/users/10686696/mdavis0510"}, "edited": false, "score": 0, "creation_date": 1548868830, "post_id": 54445780, "comment_id": 95701334, "body": "I have tried it, no go. It says &#39;Compile Error:   Expected: end of statement&#39; and highlights where is reads <code>Destination:=</code>."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1548868920, "post_id": 54445780, "comment_id": 95701393, "body": "the parameter to copy values is <b><code>xlPasteValues</code></b>, not <b><code>x1PasteValues</code></b>. <code>x1PasteValues</code> is undefined, Excel will translate this to 0 unless you force it to correct such errors by using <code>Option explicit</code>."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1548869002, "post_id": 54445780, "comment_id": 95701433, "body": "You are missing a comma after <code>xlPasteValues</code> to separate the parameters"}], "answers": [{"comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1548869110, "post_id": 54446172, "comment_id": 95701478, "body": "still using this invalid <code>x1PasteValue</code>."}, {"owner": {"reputation": 59, "user_id": 10686696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07876c4563e4bee7c2e30298223740cc?s=128&d=identicon&r=PG&f=1", "display_name": "mdavis0510", "link": "https://stackoverflow.com/users/10686696/mdavis0510"}, "edited": false, "score": 0, "creation_date": 1548869451, "post_id": 54446172, "comment_id": 95701659, "body": "@Max Russell thank you, this worked after rearranging it."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1548870209, "post_id": 54446172, "comment_id": 95702012, "body": "@FunThomas - I edited to <code>xlPasteValue</code> (a lowercase &quot;L&quot; instead of a <code>1</code>)"}], "tags": [], "owner": {"reputation": 56, "user_id": 10991106, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OCK6SRwtNLQ/AAAAAAAAAAI/AAAAAAAAAMM/QYNFZoMDKS8/photo.jpg?sz=128", "display_name": "Max Russell", "link": "https://stackoverflow.com/users/10991106/max-russell"}, "is_accepted": true, "score": 1, "last_activity_date": 1548870184, "last_edit_date": 1548870184, "creation_date": 1548869049, "answer_id": 54446172, "question_id": 54445780, "link": "https://stackoverflow.com/questions/54445780/pasting-a-range-of-values-from-one-workbook-to-another/54446172#54446172", "title": "Pasting a range of values from one workbook to another", "body": "<p>I would always select the range to paste too first</p>\n\n<pre><code>Worksheets(\"Log\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValue\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 10686696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07876c4563e4bee7c2e30298223740cc?s=128&d=identicon&r=PG&f=1", "display_name": "mdavis0510", "link": "https://stackoverflow.com/users/10686696/mdavis0510"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 54446172, "answer_count": 1, "score": 0, "last_activity_date": 1548924191, "creation_date": 1548867696, "last_edit_date": 1548924191, "question_id": 54445780, "link": "https://stackoverflow.com/questions/54445780/pasting-a-range-of-values-from-one-workbook-to-another", "title": "Pasting a range of values from one workbook to another", "body": "<p>So everything was actually pasting correctly to the workbook, however, I added an extra column of data that has a formula entered in it. Now when I run the macro it is copying and pasting the formula rather than the value generated from the formula. </p>\n\n<p>I went in and changed <code>wbData.ActiveSheet.Paste</code> to <code>wbData.ActiveSheet.PasteSpecial x1PasteValue</code> but it is not working. Wondering if I inserted it into the wrong location?</p>\n\n<pre><code> Dim wbTime As Workbook\n   Set wbTime = ThisWorkbook\n   Dim wbData As Workbook\n   Dim LastRow As Long\n\n   Set wbTime = ActiveWorkbook\n   With wbTime.Sheets(\"Production Time Sheet\")\n       LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n   End With\n   wbTime.Sheets(\"Production Time Sheet\").Range(\"A6:O\" &amp; LastRow).Copy\n\n   Set wbData = Workbooks.Open(\"S:\\Lean Carrollton Initiative\\Michael\\Time Sheet Data - LT Test.xlsx\")\n\n   wbData.ActiveSheet.PasteSpecial x1PasteValue Destination:=Worksheets(\"Log\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\n\n   wbData.Close SaveChanges:=True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548872215, "post_id": 54445763, "comment_id": 95703028, "body": "hello elaine. It is hard to know exactly what you are asking. Could you please give more information with examples and perhaps a screenshot of what you want. Thx."}, {"owner": {"reputation": 3, "user_id": 10871451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QazW3.jpg?s=128&g=1", "display_name": "Elaine", "link": "https://stackoverflow.com/users/10871451/elaine"}, "reply_to_user": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548878358, "post_id": 54445763, "comment_id": 95706005, "body": "Thank Nerd2000, I have attached the screenshot as a link at the very beginning of my question. I want to be able to insert dropdowns in the cells outlined in red."}, {"owner": {"reputation": 3, "user_id": 10871451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QazW3.jpg?s=128&g=1", "display_name": "Elaine", "link": "https://stackoverflow.com/users/10871451/elaine"}, "reply_to_user": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548945002, "post_id": 54445763, "comment_id": 95733558, "body": "Thank you, Nerd2000. We\u2019re almost there. A copy of the A6 dropdown is only required if cell B5, B6, etc., have values &gt;=1.  (I am sorry I caused the confusion with the example I provided showing four offsets.) I need the insertion of additional dropdowns be dynamic based on whether the counta in row 5 indicates the need for the dropdown. How can this be accomplished?  Thanks! Your kind efforts are appreciated."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548947707, "post_id": 54445763, "comment_id": 95735324, "body": "Are you sure it is not cells on the 5th row that need to have values &gt;= 1 (ex. b5, c5, d5, etc...)?"}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548950591, "post_id": 54445763, "comment_id": 95737256, "body": "I updated the answer. that may be what you are looking for. Remember to upvote and accept as your answer if it is what you require. Thx."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10871451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QazW3.jpg?s=128&g=1", "display_name": "Elaine", "link": "https://stackoverflow.com/users/10871451/elaine"}, "edited": false, "score": 0, "creation_date": 1549058061, "post_id": 54449672, "comment_id": 95781869, "body": "Hi Nerd2000. I do appreciate your assistance. I do not want to copy cell A5, I do need to copy A6 and paste in subsequent row 6 cells &quot;IF&quot; the cell in row 5 above it is &gt;=1.  I used counta in Cell A5, etc so that the dropdowns in row 6 would not be created if there was nothing in the column below row 6. How can I make your formula include the consideration of the values in row 5? Am I looking for how to offset an If statement that includes an offset?"}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 3, "user_id": 10871451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QazW3.jpg?s=128&g=1", "display_name": "Elaine", "link": "https://stackoverflow.com/users/10871451/elaine"}, "edited": false, "score": 0, "creation_date": 1549088310, "post_id": 54449672, "comment_id": 95787091, "body": "Hey elaine. It should work for you now. I hope that satisfies what you need."}, {"owner": {"reputation": 3, "user_id": 10871451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QazW3.jpg?s=128&g=1", "display_name": "Elaine", "link": "https://stackoverflow.com/users/10871451/elaine"}, "edited": false, "score": 0, "creation_date": 1549312921, "post_id": 54449672, "comment_id": 95850498, "body": "Hey Nerd2000! This runs perfectly. I appreciate your brilliant assistance. Thanks for your patience, as well. I upvoted you, as well - and received the message that it won&#39;t show, since I&#39;m new."}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": true, "score": 0, "last_activity_date": 1549088236, "last_edit_date": 1549088236, "creation_date": 1548883016, "answer_id": 54449672, "question_id": 54445763, "link": "https://stackoverflow.com/questions/54445763/insert-data-validation-in-ever-changing-sheets-using-counta-and-offset-in-vba/54449672#54449672", "title": "Insert Data Validation in ever changing sheets using CountA and Offset in VBA", "body": "<p>If the dropdown you speak of is a data validation list then you need to perform the following:</p>\n\n<pre><code>    Private Sub CmdSubmit_Click()\n        Dim i As Integer\n        Dim rngCopy As Range\n\n       For i = 1 To 50\n\n        'ActiveSheet.Select\n        Set rngCopy = ActiveSheet.Range(\"A6\")\n\n        rngCopy.Copy\n\n        If rngCopy.Offset(-1, i).Value &gt;= 1 Then\n            'ActiveCell.Offset(1, 0).Select\n            rngCopy.Offset(0, i).PasteSpecial xlPasteAll\n        Else\n            Set rngCopy = rngCopy.End(xlToLeft).Offset(0, i)\n        End If\n        'rngCopy.Offset(0, i).PasteSpecial xlPasteAll\n        'rngCopy.Offset(0, 2).PasteSpecial xlPasteAll\n        'rngCopy.Offset(0, 3).PasteSpecial xlPasteAll\n        'rngCopy.Offset(0, 4).PasteSpecial xlPasteAll\n       Next i\n\n       Set rngCopy = Nothing\n\n    End Sub\n\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10871451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QazW3.jpg?s=128&g=1", "display_name": "Elaine", "link": "https://stackoverflow.com/users/10871451/elaine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 54449672, "answer_count": 1, "score": 0, "last_activity_date": 1549088236, "creation_date": 1548867649, "last_edit_date": 1549070723, "question_id": 54445763, "link": "https://stackoverflow.com/questions/54445763/insert-data-validation-in-ever-changing-sheets-using-counta-and-offset-in-vba", "title": "Insert Data Validation in ever changing sheets using CountA and Offset in VBA", "body": "<p>I receive data that is similar in content, yet varies in the number and order of columns. I installed a drop down permanently in A6, copying it to each column in row 6,of the other columns, then select the appropriate header from the list. How can I amend my macro so it would either copy the DV from A6 or create identical headers where required? (determined by countA in Row 5)</p>\n\n<p><a href=\"https://i.stack.imgur.com/wavPT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wavPT.jpg\" alt=\"See the different sheets here\"></a></p>\n\n<p>This VBA solution places text where I want the dropdowns. Please tell me what I should use to replace the text \"same dropdown as A6\" so that it will automatically insert a dropdown with the header choices. </p>\n\n<pre><code>Private Sub CmdSubmit_Click()\n    Dim i As Integer\n   For i = 1 To 50\n\n\n    ActiveSheet.Select\n    Range(\"A5\").Select\n\n    If ActiveCell.Offset(0, 1).Value &gt;= \"1\" Then\n        ActiveCell.Offset(1, 0).Select\n    Else\n        Selection.End(xlToLeft).Offset(0, 1).Select\n    End If\n    ActiveCell.Offset(0, 1).Value = \"same drop down as A6\"\n    ActiveCell.Offset(0, 2).Value = \"same drop down as A6\"\n    ActiveCell.Offset(0, 3).Value = \"same drop down as A6\"\n    ActiveCell.Offset(0, 4).Value = \"Same drop down as A6\"\n   Next i\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>This works, but it is not dynamic: Can we make it dynamic?\nSub Thiscopypaste()\nDim rngcopy As Range\nDim i As Integer</p>\n\n<p>Set rngcopy = ActiveSheet.Range(\"A6\")</p>\n\n<pre><code>    rngcopy.Copy\n\n\nRange(\"B5\").Select\nIf ActiveCell.Value &gt;= \"1\" Then\nActiveCell.Offset(1, 0).Select\nActiveCell.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\nEnd If\n\nRange(\"C5\").Select\nIf ActiveCell.Value &gt;= \"1\" Then\nActiveCell.Offset(1, 0).Select\nActiveCell.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\nEnd If\n Range(\"D5\").Select\nIf ActiveCell.Value &gt;= \"1\" Then\nActiveCell.Offset(1, 0).Select\nActiveCell.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\nEnd If\nRange(\"E5\").Select\nIf ActiveCell.Value &gt;= \"1\" Then\nActiveCell.Offset(1, 0).Select\n ActiveCell.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\nEnd If\nRange(\"F5\").Select\nIf ActiveCell.Value &gt;= \"1\" Then\nActiveCell.Offset(1, 0).Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>End If\nEnd Sub</p>\n"}, {"tags": ["ms-access", "selenium-webdriver", "vba", "frame"], "comments": [{"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1548871108, "post_id": 54445717, "comment_id": 95702481, "body": "Looking at the <a href=\"https://www.seleniumhq.org/download/\" rel=\"nofollow noreferrer\">seleniumhq.org/download</a> page, I can&#39;t find any COM/VBA bindings for WebDriver. How are you using this in Access? Are you using the C# driver? If so, how? Are you possibly trying to use the Selenium2Excel Converter?"}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1548872036, "post_id": 54445717, "comment_id": 95702933, "body": "Possibly this? <a href=\"https://github.com/florentbr/SeleniumBasic/releases\" rel=\"nofollow noreferrer\">github.com/florentbr/SeleniumBasic/releases</a>   Tutorial? <a href=\"https://codingislove.com/browser-automation-in-excel-selenium/\" rel=\"nofollow noreferrer\">codingislove.com/browser-automation-in-excel-selenium</a>   If so, please give complete code sample where you setup the WebDriver, and try to interact with the HTML"}, {"owner": {"reputation": 11, "user_id": 8539957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700c0d8d74ced10edcea6fb14d4a24d6?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando M.", "link": "https://stackoverflow.com/users/8539957/fernando-m"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 1, "creation_date": 1548956350, "post_id": 54445717, "comment_id": 95740464, "body": "That&#39;s right. I downloaded Selenium from <a href=\"https://github.com/florentbr/SeleniumBasic/releases\" rel=\"nofollow noreferrer\">github.com/florentbr/SeleniumBasic/releases</a> The tutorial page you mention is quite helpful too. To use it from Access VBA, you must go to the coding window (alt + F11) and then Tools - References and then search &quot;Selenium Type Library&quot; and tick it. I hope that helps you. Unfortunately, there isn&#39;t much help for Selenium in VBA, instead there is a lot for Java (which I don&#39;t know at all). And also Selenium offer more tools for that language."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1548956653, "post_id": 54445717, "comment_id": 95740633, "body": "OK, good. Please check out Anand&#39;s answer. If that doesn&#39;t help, please provide a complete code sample for your sample HTML. Also, explain further what you mean by &#39;None of them worked&#39;. Did you get an error? A wrong response? No response?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8539957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700c0d8d74ced10edcea6fb14d4a24d6?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando M.", "link": "https://stackoverflow.com/users/8539957/fernando-m"}, "edited": false, "score": 0, "creation_date": 1548956553, "post_id": 54451241, "comment_id": 95740577, "body": "In fact I did it. It was not my first try, but searching the web I found I site where someone recommended to switch to default content before going inside a frame. But it didn&#39;t work either. I did many attempts, but I didn&#39;t want the explanation to be so long."}, {"owner": {"reputation": 11, "user_id": 8539957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700c0d8d74ced10edcea6fb14d4a24d6?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando M.", "link": "https://stackoverflow.com/users/8539957/fernando-m"}, "edited": false, "score": 0, "creation_date": 1548956655, "post_id": 54451241, "comment_id": 95740636, "body": "I also found many places like your comments, where they refer to &quot;WebElement&quot;. What is selenium expecting to receive as a WebElement? I am asking you because I tried many times to declare a WebElement and use it but I didn&#39;t figure out how to do it. I am locating many thing by Id, name, XPath and by Css, according to the webpage characteristics."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1548957997, "post_id": 54451241, "comment_id": 95741340, "body": "In the Visual Basic IDE, hit F2 to open the Object Browser. Search for &quot;WebElement&quot;, and see if that returns any definitions."}, {"owner": {"reputation": 11, "user_id": 8539957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700c0d8d74ced10edcea6fb14d4a24d6?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando M.", "link": "https://stackoverflow.com/users/8539957/fernando-m"}, "edited": false, "score": 0, "creation_date": 1549032038, "post_id": 54451241, "comment_id": 95770351, "body": "Yes it does. Many methods and properties are shown, but the thing is that I don&#39;t know what to pass to a method when it is expecting a WebElement. In my automation I declared the &quot;driver&quot; object as Selenium.webdriver and then I call methods of that object or sendkeys or click elements found by name, id, etc. But I don&#39;t know what I should send to the &#39;SwitchToFrame&#39; method as a &#39;WebElement&#39;."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1549044289, "post_id": 54451241, "comment_id": 95776744, "body": "I&#39;m going to ask again, a complete code sample would be very helpful."}, {"owner": {"reputation": 11, "user_id": 8539957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700c0d8d74ced10edcea6fb14d4a24d6?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando M.", "link": "https://stackoverflow.com/users/8539957/fernando-m"}, "edited": false, "score": 0, "creation_date": 1549054902, "post_id": 54451241, "comment_id": 95780814, "body": "I tried to comment in reply to your request, kismert. But it didn&#39;t look well, so I edited the question. There you will find the steps that took me to the point of having to select an item on a menu that is inside two frames. One interesting thing I just noticed is that the line of HTML that defines the topFrameset, when inspected with Mozilla Firefox, shows like a small button on its right side which says &quot;HTML&quot;, and if I hover on it it says &quot;Events notification&quot;. Could this have something to do with the problem?"}, {"owner": {"reputation": 11, "user_id": 8539957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700c0d8d74ced10edcea6fb14d4a24d6?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando M.", "link": "https://stackoverflow.com/users/8539957/fernando-m"}, "edited": false, "score": 0, "creation_date": 1549055404, "post_id": 54451241, "comment_id": 95781023, "body": "Of course that when trying to click the menu item, my first try wasn&#39;t to switch to a frame, I just tried to click on the element which ID I got by inspecting the element with my browser. Once that didn&#39;t work, I tried to use another parameters (not ID). When that didn&#39;t work, I researched and found out that someone recommended to switch to the frame where the element is contained. So I am trying to do that since that moment, putting the name inside double quotes. The JAVA examples I found didn&#39;t help me because i guess JAVA has more methods available."}], "tags": [], "owner": {"reputation": 711, "user_id": 1729689, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b420ba3e312a4571f7ab8bbadb14e6e8?s=128&d=identicon&r=PG", "display_name": "Anand Somani", "link": "https://stackoverflow.com/users/1729689/anand-somani"}, "is_accepted": false, "score": 0, "last_activity_date": 1548891553, "creation_date": 1548891553, "answer_id": 54451241, "question_id": 54445717, "link": "https://stackoverflow.com/questions/54445717/how-can-i-click-a-button-inside-a-frame-with-selenium-webdriver-in-vba/54451241#54451241", "title": "How can I click a button inside a frame with selenium webdriver in VBA?", "body": "<p>In 'EXAMPLE TEST 2', Can you comment this line <code>driver.SwitchToDefaultContent</code>and try it?\nWhy you switch to defaultcontent before switching to frame?</p>\n\n<p>defaultContent \u2013> Switch back to default page</p>\n\n<p>Try other options as well: (In JAVA, we do.)</p>\n\n<p><code>switchTo().frame(int) \u2013 Switch to a frame with its index\nswitchTo().frame(\u201cname of the frame\u201d) \u2013 Switch to a frame with its name\nswitchTo().frame (WebElement) \u2013 Switch to a frame with its web element location</code></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8539957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700c0d8d74ced10edcea6fb14d4a24d6?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando M.", "link": "https://stackoverflow.com/users/8539957/fernando-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1556499218, "creation_date": 1556499218, "answer_id": 55895826, "question_id": 54445717, "link": "https://stackoverflow.com/questions/54445717/how-can-i-click-a-button-inside-a-frame-with-selenium-webdriver-in-vba/55895826#55895826", "title": "How can I click a button inside a frame with selenium webdriver in VBA?", "body": "<p>After working a lot with this, I found the solution by myself.\nI installed the app \"SideeX\" available at the Google Store. I then recorded the actions I needed to emulate with Selenium.\nThen, I noticed that the frames whose names I described in the original question (topFrameset, BodyFrameset, ButtonsFrame) where recorded by SideeX through their indexes.\nSo I just had to perform the same actions with Selenium. In my case, for example, I had the following sequence of actions:</p>\n\n<pre><code>driver.SwitchToFrame 0\ndriver.SwitchToFrame 1\ndriver.FindElementById(\"img_501\").Click\ndriver.SwitchToParentFrame\ndriver.SwitchToFrame 2\n</code></pre>\n\n<p>This is just my case, but the important thing that can be helpful for others with the same problem is to know that you can use SideeX to help you find the indexes of elements or sequence of actions needed to achieve your goal.</p>\n"}], "owner": {"reputation": 11, "user_id": 8539957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700c0d8d74ced10edcea6fb14d4a24d6?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando M.", "link": "https://stackoverflow.com/users/8539957/fernando-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1683, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594570463, "creation_date": 1548867518, "last_edit_date": 1594570463, "question_id": 54445717, "link": "https://stackoverflow.com/questions/54445717/how-can-i-click-a-button-inside-a-frame-with-selenium-webdriver-in-vba", "title": "How can I click a button inside a frame with selenium webdriver in VBA?", "body": "<p>I made an automation for a webpage which has frames, and I need to click on several menu links before returning to the maincontent to complete the tasks. This automation is run from Access-VBA. Here is a fragment of the HTML that shows the frame:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;frameset id=\"topFrameset\"&gt; \r\n  &lt;frameset id=\"BodyFrameset\" cols=\"0,177,*\"&gt;\r\n    &lt;frame name=\"ButtonsFrame\" id=\"ButtonsFrame\" target=\"main\" scrolling=\"NO\" noresize=\"\" src=\"MyMenu.action\"&gt;\r\n      #document\r\n      &lt;html&gt;\r\n      &lt;body&gt;\r\n        &lt;input type=\"hidden\" name=\"listParentsId\" value=\"[501, 502, 503]\" id=\"listParentsId\"&gt;\r\n        &lt;div id=\"menu_container\"&gt;\r\n          &lt;div id=\"menu_1\" onmouseover=\"MENU.ToolTipsCreate('501')\"&gt;\r\n            &lt;a onclick=\"MENU.showItems('501', '')\"&gt;My Account&lt;/a&gt;\r\n            &lt;img id=\"img_501\" src=\"/common/images/dropdown2_arrow.png\" onclick=\"MENU.showItems('501', '')\"&gt;\r\n          &lt;/div&gt;\r\n        &lt;/div&gt;\t\t\r\n      &lt;/body&gt;&lt;/html&gt;\r\n    &lt;/frame&gt;\r\n  &lt;/frameset&gt;\r\n&lt;/frameset&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I am using the <a href=\"https://github.com/florentbr/SeleniumBasic/releases\" rel=\"nofollow noreferrer\">SeleniumBasic v2.0.9.0</a> bindings for VBA. See <a href=\"https://codingislove.com/browser-automation-in-excel-selenium/\" rel=\"nofollow noreferrer\">Browser automation in Excel VBA using Selenium</a> for install and tutorial.</p>\n\n<p>I've tried webdriver.SwitchToFrame, among many other tests, all of them failed.</p>\n\n<pre><code>Dim driver As selenium.WebDriver\nSet driver = New ChromeDriver\ndriver.Get (URL)\n\n'Here goes the part of the code that logs in the page, it's irrelevant for this analysis...\n\ndriver.SwitchToFrame (\"topFrameset\") 'This line returns Error N\u00b0: 8 - NoSuchFrameError. Frame not be found. Identifier:topFrameset\n</code></pre>\n\n<p>Hope that someone could guide me to click the link or the img element inside \"menu_1\". Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548867577, "post_id": 54445692, "comment_id": 95700686, "body": "You <code>Range.Find</code> to locate your column header that is expected to change. Then build that in to your dynamic range"}, {"owner": {"reputation": 1, "user_id": 10991616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93018b6481d2b56649dc4a67d2bf76e0?s=128&d=identicon&r=PG&f=1", "display_name": "George Kimberly", "link": "https://stackoverflow.com/users/10991616/george-kimberly"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548878275, "post_id": 54445692, "comment_id": 95705969, "body": "Would I substitute that function in place of the &quot;R1:R1048576&quot;?"}], "owner": {"reputation": 1, "user_id": 10991616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93018b6481d2b56649dc4a67d2bf76e0?s=128&d=identicon&r=PG&f=1", "display_name": "George Kimberly", "link": "https://stackoverflow.com/users/10991616/george-kimberly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548874348, "creation_date": 1548867425, "last_edit_date": 1548874348, "question_id": 54445692, "link": "https://stackoverflow.com/questions/54445692/how-to-reference-an-entire-worksheet-in-another-workbook-as-my-table-array-in-a", "title": "How to reference an entire worksheet in another workbook as my table array in a VLookup?", "body": "<p>I am currently writing a macro to run a VLookup on a whole worksheet in another workbook. The VLookup itself is on B2 of the current worksheet, lookup value on A2. I am searching for values in Worksheet two \"Assigned List\".</p>\n\n<p>My main issue is that the \"Assigned List\" worksheet changes in size constantly as people add to it, and I need to avoid hardcoding the range. Is there any way I can choose the whole worksheet? It starts at A1, but I am unable to add the current region function. </p>\n\n<p>Also, is there a way to not need the second worksheet to be open simultaneously, for example, can I write in a path for the file?</p>\n\n<pre><code>Sub VlookupAgency()\n\n    Lastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Range(\"B2\").FormulaR1C1 = _\n        \"=VLOOKUP(RC[-1], '[Assigned List.xlsx]ALL LISTED'!R1:R1048576,2,0)\"\n    Selection.AutoFill Destination:=Range(\"B2:B\" &amp; Lastrow), Type:=xlFillDefault\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1548925719, "post_id": 54449606, "comment_id": 95721918, "body": "The only problem left is that Case &quot;table&quot; uses previous setting style. How to set own style for your code (Case &quot;table&quot;) for example &quot;Normal&quot;? This one does not work <code>.Paragraphs.Last.Style = .Styles(&quot;Normal&quot;)</code>"}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 1, "last_activity_date": 1548940196, "last_edit_date": 1548940196, "creation_date": 1548882730, "answer_id": 54449606, "question_id": 54445491, "link": "https://stackoverflow.com/questions/54445491/excel-vba-copy-range-all-cells-from-the-left-to-embedded-word-document/54449606#54449606", "title": "Excel VBA copy range (all cells from the left) to embedded Word document", "body": "<p>It appears you should be using:</p>\n\n<pre><code>  With wdRng\n    .Paragraphs.Last.Range.PasteExcelTable False, False, False\n    .Tables(.Tables.Count).AutoFitBehavior wdAutoFitWindow\n    .Tables(.Tables.Count).Range.Style = \"Normal\"\n  End With\n</code></pre>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 54449606, "answer_count": 1, "score": -1, "last_activity_date": 1548940196, "creation_date": 1548866704, "last_edit_date": 1548875198, "question_id": 54445491, "link": "https://stackoverflow.com/questions/54445491/excel-vba-copy-range-all-cells-from-the-left-to-embedded-word-document", "title": "Excel VBA copy range (all cells from the left) to embedded Word document", "body": "<p>(This question is a follow-up on <a href=\"https://stackoverflow.com/questions/54438992/excel-vba-input-text-and-bookmarks-to-embedded-word-template/54440735#54440735\">how to work with a document embedded in an Excel workbook</a> in the Word application interface (instead of in-place). The reason this is necessary is to be able to save the result as an independent document.)</p>\n\n<p>The problem I came up with is that some cells does not fit to criteria <code>cell.Offset(0, -3).Text</code>. So text is not only in one cell with <code>Offset(0, -3)</code> and in Word they should look like:</p>\n\n<pre><code>Legal             John Smith\n                  Telephone         +4854132155\n                  Email             john.smith@mail.com\n</code></pre>\n\n<p>In Excel they are in separate rows.</p>\n\n<ul>\n<li>\"Legal\" is in B50. </li>\n<li>\"John Smith\" is in C50. </li>\n<li>\"Telephone\" is in C51. </li>\n<li>\"+4854132155\" is in D51. </li>\n<li>\"Email\" is in C52. </li>\n<li>\"john.smith@mail.com\" is in C52.</li>\n</ul>\n\n<p>The idea is to have a \"Case\" called \"table\" so code will understand that it should copy everything from left of Case \"table\" row by row (word \"table\" is located in Column E). Paste to Word as a table and do <code>wdAutoFitWindow</code> so that table would fit perfectly to Word Document Window. </p>\n\n<p>How data looks in Excel:</p>\n\n<pre><code>   A    B                   C                   D                  E\n49    Paragraph with number 1                                    main\n48    Ok text is text and it is good to have here.. a lot of     normal\n50    Legal             John Smith                               table\n51                      Telephone         +4854132155            table \n52                      Email             john.smith@mail.com    table\n53    Paragraph with number 2                                    main\n54    Text again a lot of text again comes here                  normal\n</code></pre>\n\n<p>What is wrong with current code: Current code runs smoothly. However once it reaches Excel row with word \"table\" in Column E, it deletes everything already inserted and inserts only last row with parameter \"table\". So basically it is doing everything right until Case \"table\". Then as an output you will get:</p>\n\n<pre><code>              Email             john.smith@mail.com\n\n2   Paragraph with number                                   \n    Text again a lot of text again comes here     \n</code></pre>\n\n<p>Instead of:</p>\n\n<pre><code>1   Paragraph with number                                   \n    Ok text is text and it is good to have here.. a lot of \n    Legal          John Smith                             \n                   Telephone         +4854132155              \n                   Email             john.smith@mail.com\n2   Paragraph with number                                   \n    Text again a lot of text again comes here        \n</code></pre>\n\n<p>Here is the part I have been tried to implement:</p>\n\n<pre><code>Set xlSht = Sheets(\"Offer Letter\")\n  For Each cell In xlRng\n    wdRng.InsertAfter vbCr &amp; cell.Offset(0, -3).Text\n     Select Case LCase(cell.Value)\n        Case \"title\"\n          wdRng.Paragraphs.Last.Style = .Styles(\"Heading 1\")\n        Case \"main\"\n          wdRng.Paragraphs.Last.Style = .Styles(\"Heading 2\")\n        Case \"sub\"\n          wdRng.Paragraphs.Last.Style = .Styles(\"Heading 3\")\n        Case \"sub-sub\"\n          wdRng.Paragraphs.Last.Style = .Styles(\"Heading 4\")\n        Case \"normal\"\n          wdRng.Paragraphs.Last.Style = .Styles(\"Normal\")\n        Case \"contact\"\n          wdRng.Paragraphs.Last.Style = .Styles(\"Contact\")\n          Case \"attachment\"\n          wdRng.Paragraphs.Last.Style = .Styles(\"Attachment\")\n          Case \"table\"\n\n                  xlSht.Range(cell.Offset(0, -3), cell.Offset(0, -1)).Copy\n     wdRng.PasteExcelTable False, False, False\n\n      wdRng.Tables(1).AutoFitBehavior wdAutoFitWindow\n\n    End Select\n  Next cell\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 0, "creation_date": 1548866422, "post_id": 54445353, "comment_id": 95699989, "body": "I don&#39;t know the answer, but would guess that the problem is that <code>shNameOfTheSheetObject</code> is not a property of <code>WB</code>.  VB probably shims up the reference between <code>WS = shName...</code> and your sheet in the background"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1548866581, "post_id": 54445353, "comment_id": 95700095, "body": "You&#39;re missing the <code>Set ...</code> part of setting an object."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1548866612, "post_id": 54445353, "comment_id": 95700111, "body": "Use the code name, not the worksheet name.  Then you can just access it directly:  <code>SheetCodeName</code> without any qualifier is all you need assuming you&#39;re in the same project.  If you&#39;re in a different project, it would be <code>ProjectCodeName.SheetCodeName</code>."}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1548867205, "post_id": 54445353, "comment_id": 95700455, "body": "@Comintern: I am using the code name, and that&#39;s what I&#39;m trying to solve - how to use ProjectCodeName.SheetCodeName, but WITH using the qualifier. As I mentioned, I like over-building my code. If you know how to self-reference the ProjectCodeName, that + the second part of your comment would be enough for the answer I&#39;m looking for"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1548867230, "post_id": 54445353, "comment_id": 95700470, "body": "@VincentG: Sure, I&#39;m just writing a quick and dirty example"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1548867477, "post_id": 54445353, "comment_id": 95700625, "body": "What do you mean by &quot;self reference&quot;? When then project is loaded it&#39;s implicitly in scope within that project. The worksheet document objects belong to the project, not the workbook."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1548867788, "post_id": 54445353, "comment_id": 95700797, "body": "<code>ThisWorkbook.VBProject</code> is a reference to the project. And you can browse  <code>ThisWorkbook.VBProject.VBComponents</code> collection to get the sheets?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1548868221, "post_id": 54445353, "comment_id": 95701018, "body": "It might help if you provide a somewhat <i>less</i> minimal example of what you&#39;re doing. Maybe include the <code>Dim</code> statements and the assignment of <code>shNameOfTheSheetObject</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548868873, "post_id": 54445353, "comment_id": 95701359, "body": "FWIW if you like being very, very explicit, you&#39;ll want to use the <code>Worksheets</code> collection (which returns a <code>Worksheets</code> object - hint: worksheets are <i>items</i> of that collection object, not <i>members</i>), instead of the <code>Sheets</code> collection - <code>Sheets</code> includes <code>Chart</code> and about half a dozen other sheet types, not just <code>Worksheet</code> objects. The &quot;code name&quot; of a sheet is a <i>project</i>-scoped identifier, not a member of the <code>Workbook</code> it&#39;s defined in."}], "answers": [{"comments": [{"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1548875801, "post_id": 54446022, "comment_id": 95704808, "body": "A quick expansion - Selecting the highest-level object is where you can see and edit the VBAProject Name"}], "tags": [], "owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "is_accepted": true, "score": 3, "last_activity_date": 1548868496, "creation_date": 1548868496, "answer_id": 54446022, "question_id": 54445353, "link": "https://stackoverflow.com/questions/54445353/setting-a-worksheet-using-both-the-worksheet-name-as-defined-in-the-object-explo/54446022#54446022", "title": "Setting a Worksheet using both the worksheet name as defined in the object explorer with the workbook definition", "body": "<p>I think there is a slight confusion on how the access via the code name works. When you get a worksheet via <code>ThisWorkbook.Worksheets(\"SheetName\")</code> you query a collection on the workbook; when you use the code name, you get the corresponding component of the VBA project containing your project, which implements the <code>Worksheet</code> interface. </p>\n\n<p>Both are the same object, but the resolution of the identifier takes a different path: a workbook does not know about the VBA components. Consequently, as @Comintern mentioned in the comments, you can only use the project name of the containing VBA project as further qualifier. That name is whatever you set it to via the project properties dialog. If you do not change it, it will always be <code>VBAProject</code> in Excel, which is not very helpful. </p>\n"}], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 54446022, "answer_count": 1, "score": 1, "last_activity_date": 1548924160, "creation_date": 1548866271, "last_edit_date": 1548924160, "question_id": 54445353, "link": "https://stackoverflow.com/questions/54445353/setting-a-worksheet-using-both-the-worksheet-name-as-defined-in-the-object-explo", "title": "Setting a Worksheet using both the worksheet name as defined in the object explorer with the workbook definition", "body": "<p>So there are a few ways to set a worksheet in Excel.</p>\n\n<pre><code>set WS = Sheets(\"Name Here!\")\nset WS = WB.Sheets(\"Name Here!\")\nset WS = shNameOfTheSheetObject\n</code></pre>\n\n<p>However, there doesn't seem to be a way to do:</p>\n\n<pre><code>set WS = WB.shNameOfTheSheetObject\n</code></pre>\n\n<p>I'd like to know how, if it's possible, I can get this type of reference to work. I like being very, very explicit with my code (Perhaps too much so), and it'd be useful to know if I have multiple workbooks open that I'm handling. </p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1548871826, "post_id": 54445648, "comment_id": 95702844, "body": "Your code works fantastic but we are still having the issue whereby if a user enters 200 rows of numbers, then deletes the last 25 rows, its still printing 200 rows instead of 175 rows."}], "tags": [], "owner": {"reputation": 71, "user_id": 10979095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ExYvR0cQTaQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOkF2op--dwHp88vlYJ38RxKzNM_w/mo/photo.jpg?sz=128", "display_name": "Henrique Pessoa", "link": "https://stackoverflow.com/users/10979095/henrique-pessoa"}, "is_accepted": true, "score": 2, "last_activity_date": 1548867270, "creation_date": 1548867270, "answer_id": 54445648, "question_id": 54445292, "link": "https://stackoverflow.com/questions/54445292/troubleshoot-printing-macro/54445648#54445648", "title": "Troubleshoot printing macro", "body": "<blockquote>\n  <p>What I need help with is a script that will check row by row for data,\n  infinitely and then print when it comes to the first row with no data</p>\n</blockquote>\n\n<p>You can get the first row with no data with a method similar to the one used on the macro you found, like so:</p>\n\n<pre><code>With MySheet\n\n    Dim xFirstEmptyRow As Long\n    xFirstEmptyRow = .Cells(1, 1).End(xlDown).Row\n\nEnd With\n</code></pre>\n\n<p>Link to .End method here: \n<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.end\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.end</a></p>\n"}], "owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 54445648, "answer_count": 1, "score": 0, "last_activity_date": 1548951371, "creation_date": 1548866063, "last_edit_date": 1548951371, "question_id": 54445292, "link": "https://stackoverflow.com/questions/54445292/troubleshoot-printing-macro", "title": "Troubleshoot printing macro", "body": "<p>So with the help of the Stack Overflow community some time back, I created a printing macro for a worksheet that would read the worksheet and only print the number of pages that had information in it. It would read certain sections of rows and if not data had been entered, would print the correct number of pages. This allowed the user to just input the data and hit the print button to print the correct number of pages (rather than selecting File..Print...etc)  </p>\n\n<p>Here is the code that was used:</p>\n\n<pre><code>Sub LastRowInOneColumn()\n\n    Dim MySheet As Worksheet\n    Set MySheet = Worksheets(\"SIF Sheet\")\n\n    With MySheet\n\n        Dim xLastRow As Long\n        xLastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n        Select Case True\n\n            Case xLastRow &gt; 21 And xLastRow &lt; 46\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=1, Preview:=True\n\n            Case xLastRow &gt; 46 And xLastRow &lt; 97\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=2, Preview:=True\n\n            Case xLastRow &gt; 98 And xLastRow &lt; 149\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=3, Preview:=True\n\n            Case xLastRow &gt; 150 And xLastRow &lt; 201\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=4, Preview:=True\n\n            Case xLastRow &gt; 202 And xLastRow &lt; 253\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=5, Preview:=True\n\n            Case xLastRow &gt; 254 And xLastRow &lt; 305\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=6, Preview:=True\n\n            Case xLastRow &gt; 306 And xLastRow &lt; 357\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=7, Preview:=True\n\n            Case xLastRow &gt; 358 And xLastRow &lt; 409\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=8, Preview:=True\n\n            Case xLastRow &gt; 410 And xLastRow &lt; 461\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=9, Preview:=True\n\n            Case xLastRow &gt; 462 And xLastRow &lt; 513\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=10, Preview:=True\n\n        End Select\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This was fine as the data that was being entered was in sections (1 account per section) however we recently have had to redesign it so it is no longer in sections. The way it is now<br>\n<a href=\"https://i.stack.imgur.com/JU8QM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JU8QM.jpg\" alt=\"Example Picture\"></a></p>\n\n<p>What I need help with is a script that will check row by row for data, infinitely and then print when it comes to the first row with no data, only those pages that have data. </p>\n\n<p>Hope this makes sense.     </p>\n\n<p>I also found this bit of code so now I am super confused by which one I was using. </p>\n\n<pre><code>Sub LastRowInOneColumn()            \n    If Range(\"C19\") = \"Enter any special posting instruction here.\" Then\n        Range(\"C19:I26\").ClearContents\n    End If\n\n    Dim MySheet As Worksheet\n    Set MySheet = Worksheets(\"SIF Sheet\")\n\n    With MySheet\n        Dim xLastRow As Long\n        xLastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        Select Case True\n            Case xLastRow &lt; 500\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut\n        End Select\n    End With    \nEnd Sub\n</code></pre>\n\n<p>The part I need the most help with is this:\nThe issue they are having is that say they enter information on lines 1-200, then delete the information on lines 175-200, it is still printing through 200, rather than through 175</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1548866442, "post_id": 54445251, "comment_id": 95700008, "body": "<code>Format$(5.85 &#47; 100, &quot;#.####&quot;)</code>"}, {"owner": {"reputation": 586, "user_id": 3495713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SLYAw.jpg?s=128&g=1", "display_name": "Manpreet Singh Dhillon", "link": "https://stackoverflow.com/users/3495713/manpreet-singh-dhillon"}, "edited": false, "score": 0, "creation_date": 1548866750, "post_id": 54445251, "comment_id": 95700189, "body": "Use can use Format(5.85 / 100, &quot;0.000&quot;). Using 0 will ensure one zero before decimal."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1548871310, "post_id": 54445251, "comment_id": 95702575, "body": "Please include your code. How else can we know where / how it&#39;s displayed and test?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "is_accepted": false, "score": 0, "last_activity_date": 1548866906, "creation_date": 1548866906, "answer_id": 54445550, "question_id": 54445251, "link": "https://stackoverflow.com/questions/54445251/vba-division-with-4-decimal/54445550#54445550", "title": "VBA Division with 4 decimal", "body": "<p>Prints 0,0585 </p>\n\n<pre><code>Option Explicit\nSub test()\nDim a As Double\n\na = 5.85 / 100\nDebug.Print a\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1548889001, "post_id": 54446056, "comment_id": 95710224, "body": "It will work that way cuz the string format that is returned is gonna be automatically converted to double cuz it fits that format !!! And if I did this it was intentional to avoid declaring 2 variables and confuse him, he seems a beginner"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1548910590, "post_id": 54446056, "comment_id": 95715338, "body": "Good programming practices are just as important (if not more so) for beginners. Thanks to you with the sloppy answer here, there will be a future question &quot;Why does <code>Format(varA) + Format(varB)</code> give me a wrong answer?&quot; - and this will be because the OP not only did not pick up that <code>Format</code> returns a <code>String</code> but because your code is deliberately misleading in implying that <code>Format</code> returns a <code>Double</code>!"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1549272127, "post_id": 54446056, "comment_id": 95829203, "body": "His question was to print the result of 5.85 / 100, not to make aritmetic operations and compute values. Read the question, before criticizing an answer. What I provided is an answer to his problem. Following your logic, why not to each him how to make graphical functions in vba ? he may need that one day ! yes one day, but not for his question right above...a beginner who is not professionnal need something simple to solve his problem, not to complicate things by providing too much information that he may never use."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1549305377, "post_id": 54446056, "comment_id": 95847179, "body": "You have totally missed the point of my comment. Amd the point of my current downvote (which you still have  a chance to address). If you are going to teach someone a simple snippet, then teach it correctly. I am not asking you to embellish it and I didn&#39;t say anything about &quot;graphics&quot; - so why bring it up? All I am asking is that you correct your code snippet which has some obvious flaws."}], "tags": [], "owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "is_accepted": true, "score": 0, "last_activity_date": 1548868628, "creation_date": 1548868628, "answer_id": 54446056, "question_id": 54445251, "link": "https://stackoverflow.com/questions/54445251/vba-division-with-4-decimal/54446056#54446056", "title": "VBA Division with 4 decimal", "body": "<p>Try something like :</p>\n\n<pre><code>Dim MyNumber As Double\n\nMyNumber = Format$(5.85 / 100, \"#.####\")\n\nMsgBox MyNumber\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 1652167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z9FKH.png?s=128&g=1", "display_name": "SGomes", "link": "https://stackoverflow.com/users/1652167/sgomes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 54446056, "answer_count": 2, "score": -2, "last_activity_date": 1548871257, "creation_date": 1548865959, "last_edit_date": 1548871257, "question_id": 54445251, "link": "https://stackoverflow.com/questions/54445251/vba-division-with-4-decimal", "title": "VBA Division with 4 decimal", "body": "<p>i'm ripping my hair with the following problem:</p>\n\n<p>In Microsoft Word VBA, I have this division:</p>\n\n<p>5.85 / 100 , the result displayed it's 0,058</p>\n\n<p>The real result it's 0,0585.</p>\n\n<p>->>>>>> I need the result to display 0,0585 or 0,059</p>\n\n<p>What I need to do? Thank you in advance.</p>\n"}, {"tags": ["excel", "vba", "duplicates", "matching"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1548865223, "post_id": 54444598, "comment_id": 95699175, "body": "This is too lengthy and has too many parts (and no code at all).  Take the first task and <i>make a start</i> - see if you can code it, then post back if you run into problems (with your code) and people will help.  FYI a good guideline to consider is that  people here are happy to help <i>for free</i> but less keen to take on work for minimum wage....."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548865353, "post_id": 54444598, "comment_id": 95699267, "body": "Welcome to Stack Overflow! Please read <a href=\"https://meta.stackoverflow.com/q/284236/1188513\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a>"}, {"owner": {"reputation": 1, "user_id": 10976529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b43defe72a8e22417e0e30c27bfdcc84?s=128&d=identicon&r=PG&f=1", "display_name": "kltk7", "link": "https://stackoverflow.com/users/10976529/kltk7"}, "edited": false, "score": 0, "creation_date": 1548865525, "post_id": 54444598, "comment_id": 95699384, "body": "Thank you for your words of advice. I&#39;m new here and not sure how things work. I am considering hiring a freelancer on i.e. UpWork to write the code, however I&#39;d need to get approval from a higher-up in the company, whereas I&#39;m just an intern trying to automate data entry (the one thing I&#39;m doing right now that sucks). The 10$ would&#39;ve been from my own money - if I were to get approval the company would offer the freelancer a reasonable price. I will give a go at the first steps of this. Again, thank you!"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1548865850, "post_id": 54444598, "comment_id": 95699595, "body": "@kltk7 I admire your effort to seek a solution through compensation. Unfortunately this site is a little resistant to that approach."}, {"owner": {"reputation": 1, "user_id": 10976529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b43defe72a8e22417e0e30c27bfdcc84?s=128&d=identicon&r=PG&f=1", "display_name": "kltk7", "link": "https://stackoverflow.com/users/10976529/kltk7"}, "edited": false, "score": 0, "creation_date": 1548866091, "post_id": 54444598, "comment_id": 95699759, "body": "Would either of you or someone else have a reasonable estimate for cost of completion of this project at a fixed cost rate?"}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 10991081, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8b0887c62d6ed1fe2ace1772bd14316f?s=128&d=identicon&r=PG", "display_name": "David Clements", "link": "https://stackoverflow.com/users/10991081/david-clements"}, "is_accepted": false, "score": 0, "last_activity_date": 1548898134, "creation_date": 1548898134, "answer_id": 54452088, "question_id": 54444598, "link": "https://stackoverflow.com/questions/54444598/vba-matching-multiple-instances-of-the-same-name-to-see-if-salary-amount-matches/54452088#54452088", "title": "VBA Matching multiple instances of the same name to see if salary amount matches, and whether there are two or more that were paid same amount", "body": "<p>Based on your description and screenshots, it looks like you can solve this relatively easily with two COUNTIFS formulas (no VBA required). In the following example, I'm going to assume that your cleaned bank statement data is in a separate excel workbook named \"Bank Statement.xlsx\", and the period data in your master file is in column \"A\":</p>\n\n<p>The first step is to compare the First Name (column G) and Amount Paid (column AV) in your master file to the data range in your bank statement file (column D and E respectively) and count the number of times both are a match (anything greater than 0 indicates a match). In your master file, type the following formula in cell \"X2\":</p>\n\n<pre><code>=COUNTIFS('[Bank Statement.xlsx]Output'!$D$83:$D$88,G2,'[Bank Statement.xlsx]Output'!$E$83:$E$88,AV2)&gt;0\n</code></pre>\n\n<p>The second step is to find any duplicate records in your master file where the Period (column A), First Name (column G) and Amount Paid (column AV) are the same. In your master file, type the following formula in cell \"Y2\":</p>\n\n<pre><code>=COUNTIFS($A$2:$A$6340,A2,$G$2:$G$6340,G2,$AV$2:$AV$6340,AV2)&gt;1\n</code></pre>\n\n<p>The third step is to check if both conditions are TRUE. Insert another column in your master file (column Z) and type the following formula in cell \"Z2\"):</p>\n\n<pre><code>=AND(X2,Y2)\n</code></pre>\n\n<p>The final step is, of course, to copy the formulas in cells X2, Y2, and Z2 all the way down to the bottom of your data (row 6340). You can now filter by column Z to show only records with a value of TRUE.</p>\n\n<p>Please note the position of the dollar ($) signs in the above formulas. They are essential to maintain the proper range references when copying the formulas down to the bottom of your data.</p>\n\n<p>Hopefully you can adapt this example to fit your actual excel workbook.</p>\n\n<p>Cheers!</p>\n"}], "owner": {"reputation": 1, "user_id": 10976529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b43defe72a8e22417e0e30c27bfdcc84?s=128&d=identicon&r=PG&f=1", "display_name": "kltk7", "link": "https://stackoverflow.com/users/10976529/kltk7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1548898134, "creation_date": 1548863916, "last_edit_date": 1548864983, "question_id": 54444598, "link": "https://stackoverflow.com/questions/54444598/vba-matching-multiple-instances-of-the-same-name-to-see-if-salary-amount-matches", "title": "VBA Matching multiple instances of the same name to see if salary amount matches, and whether there are two or more that were paid same amount", "body": "<p>I am very new to VBA, having compiled my first two macros only two days ago for the purpose of bank statement reconciliation. My issue though is that I've realized the next step is too complex for me to code myself, and I can't seem to find adaptable code. </p>\n\n<p>I need to take a name, find it in a master file of about 600 names, and see whether it finds a match. The problem them is, frequently there will be two or more individuals with the same name that were either paid different amounts, or were paid the same amount. </p>\n\n<p>I am looking for some help on how to approach this, what functions I would need to use and whatnot. Alternatively, if someone were willing to write this macro for me, I would be happy to Venmo them $10 for the help (by sending your handle to a temp email), as well as of course put a tick next to their answer. I've laid out logical process as I envision it below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/OdJJD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OdJJD.png\" alt=\"enter image description here\"></a></p>\n\n<p>As the data is proprietary, above is a quick example of the data I made. On the left, we have the cleaned bank statement data, with the names in one column and their corresponding salary amounts in the next column. On the right is the master file where we want to reconcile. First off, we are searching only first names as that's how they show on the bank statement, they're Afghan names so the most duplicates we'd get is ~7. Second, a quick note is that the search needs to take place by period, which is a number from 1 to 9 in a column where a number corresponds to a month/bank statement. Here is the logical process:</p>\n\n<p>Take name, i.e. John, from column D in the left spreadsheet (AKA statement), and search through names in column G in the right spreadsheet (AKA master file). </p>\n\n<p>For each name (in period 1): does name match? \nIf no, keep cycling until a match is found. \nIf no match is found, move on to next name in statement. </p>\n\n<p>If yes, does the salary amount in column E of statement match with that name's corresponding salary amount in column AV of master file?\nIf no, keep cycling through all of the names in master file until either a salary amount match is found,  or move on to next name in statement.</p>\n\n<p>If yes, it does match, continue to cycle through all names in the master file to check whether there are any other individuals with the same name, and if so, whether one or more of them were paid the same amount.</p>\n\n<p>If an individual does not share their name with anyone else, and the salary amounts in both spreadsheets match, put an \"a\" in column X.\nIf an individual shares his/her name with one or more others but his/her salary is unique, put \"a\" in column X.</p>\n\n<p>If 2 or more individuals with the same name were paid the same amount, put the COUNT of these individuals in column Y. (just marking the instance with a \"b\" in column Y would be okay too). Ideally, this count would be put next to every instance that 2+ individuals with same name paid the same amount was found.</p>\n\n<p>It looks like the code might be pretty clunky and slow, but all I need is for it to work, doesn't need to be efficient, given that it's all terribly tedious to do manually.</p>\n\n<p>Any help with this would be extremely appreciated.</p>\n"}, {"tags": ["excel", "vba", "web-scraping", "proxy", "xmlhttprequest"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "edited": false, "score": 0, "creation_date": 1548874045, "post_id": 54445946, "comment_id": 95703957, "body": "thank you.  There is an issue with the following line of code which is not working with MSXML2.ServerXMLHTTP (by the way LOVE your script), please view the specific portion of your script in reference: [link]<a href=\"https://i.imgur.com/GPElqc6.png\" rel=\"nofollow noreferrer\">i.imgur.com/GPElqc6.png</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "edited": false, "score": 0, "creation_date": 1548874140, "post_id": 54445946, "comment_id": 95703995, "body": "Remove that and use the .responseText direct without the strconv"}, {"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "edited": false, "score": 0, "creation_date": 1548877021, "post_id": 54445946, "comment_id": 95705454, "body": "Excellent!, that resolved the run issue without adding the proxy configuration.  Thank you.  The remaining issue is the proxy line of code solution you shared with me above.  Have reviewed the links you shared. How can I confirm the proxy is actually being applied?  As your script runs but there is no indication that the proxy was actually used.  Here is the line of code for the proxy: &#39;<a href=\"http://api.scraperapi.com?key=YOURAPIKEY&amp;url=http://httpbin.org/ip\" rel=\"nofollow noreferrer\">api.scraperapi.com?key=YOURAPIKEY&amp;url=http://httpbin.org/ip</a>&zwnj;&#8203;&#39;  in relation to: &#39;XMLHTTP.setProxy 2, &quot;http=myProxyServer:8080&quot;, &quot;&quot;&#39; &#39;XMLHTTP.setProxyCredentials &quot;proxy_login&quot;, &quot;proxy_password&quot;&#39;"}, {"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "edited": false, "score": 0, "creation_date": 1548879072, "post_id": 54445946, "comment_id": 95706315, "body": "QHarr Should I mark the challenge resolved, as your script runs BUT I do not think it is actually using the proxy.  here is the line of code that I am trying to function: <code>curl &quot;http:&#47;&#47;api.scraperapi.com?key=YOURAPIKEY&amp;url=http:&#47;&#47;httpbin&zwnj;&#8203;.org&#47;ip&quot;</code> Any suggestions greatly appreciated, thank you."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "edited": false, "score": 0, "creation_date": 1548880859, "post_id": 54445946, "comment_id": 95707087, "body": "Not sure whether using the following url and examing the response would do the trick: &quot;<a href=\"http://www.whatismyproxy.com/\" rel=\"nofollow noreferrer\">whatismyproxy.com</a>&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "edited": false, "score": 0, "creation_date": 1548881012, "post_id": 54445946, "comment_id": 95707174, "body": "And no, you shouldn&#39;t accept if you are not satisfied or the problem is not properly resolved."}, {"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "edited": false, "score": 0, "creation_date": 1548883522, "post_id": 54445946, "comment_id": 95708293, "body": "thank you the balance of the issue is with the proxy provider.  The end solution of the above worked, thank you."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "edited": false, "score": 0, "creation_date": 1548884662, "post_id": 54445946, "comment_id": 95708754, "body": "end solution being? :-)"}, {"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "edited": false, "score": 1, "creation_date": 1549848281, "post_id": 54445946, "comment_id": 96038257, "body": "just now saw your message.  <code>&#39;XMLHTTP.setProxy 2, &quot;http=url or IP:port&quot; &#39;XMLHTTP.setProxyCredentials &quot;username&quot;, &quot;password&quot;</code>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1549861149, "last_edit_date": 1549861149, "creation_date": 1548868210, "answer_id": 54445946, "question_id": 54444427, "link": "https://stackoverflow.com/questions/54444427/modify-from-xmlhttp-to-serverxmlhttp-for-enabling-proxy-use/54445946#54445946", "title": "modify from XMLHTTP to ServerXMLHTTP for enabling proxy use", "body": "<p>Try the following</p>\n\n<pre><code>.setProxy 2, \"http=myProxyServer:8080\", \"\"\n</code></pre>\n\n<p>This is using MSXML2.ServerXMLHTTP. Taken from <a href=\"http://www.logikdev.com/2010/07/07/use-serverxmlhttp-through-proxy/\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Note the use of config</p>\n\n<pre><code>proxycfg -u\n</code></pre>\n\n<p>Also, see the link to <a href=\"https://support.microsoft.com/en-gb/help/289481/you-may-need-to-run-the-proxycfg-tool-for-serverxmlhttp-to-work\" rel=\"nofollow noreferrer\">proxycfg</a> and <a href=\"https://stackoverflow.com/questions/1041886/how-can-i-specify-a-proxy-configuration-using-microsoft-xmlhttp\">how can I specify a proxy configuration using Microsoft.XMLHTTP?</a></p>\n\n<p>If you decide to use a browser, see the following for using <a href=\"https://stackoverflow.com/a/51462806/6241235\">selenium and proxy</a>.</p>\n\n<p>Feedback from OP:</p>\n\n<pre><code>XMLHTTP.setProxy 2, \"http=url or IP:port\" \nXMLHTTP.setProxyCredentials \"username\", \"password\"\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2149, "favorite_count": 0, "accepted_answer_id": 54445946, "answer_count": 1, "score": 1, "last_activity_date": 1549861149, "creation_date": 1548863359, "last_edit_date": 1548884676, "question_id": 54444427, "link": "https://stackoverflow.com/questions/54444427/modify-from-xmlhttp-to-serverxmlhttp-for-enabling-proxy-use", "title": "modify from XMLHTTP to ServerXMLHTTP for enabling proxy use", "body": "<p>@Qharr How would one modify your wonderful script from XMLHTTP to ServerXMLHTTP for enabling proxy?</p>\n\n<p>REF:  <a href=\"https://stackoverflow.com/questions/54214459/google-search-via-vba-no-results-if-use-a-phone-number\">Google search via VBA no results if use a phone number</a></p>\n\n<p>Have reviewed this as without finding a solution:\n<a href=\"https://stackoverflow.com/questions/11605613/differences-between-xmlhttp-and-serverxmlhttp\">Differences between XMLHTTP and ServerXMLHTTP</a></p>\n\n<pre><code>    With CreateObject(\"MSXML2.XMLHTTP\")\n    .Open \"GET\", urlx, False\n    '.setProxy 2, \"proxy.net:8080\"\n    '.setProxyCredentials \"proxy_login\", \"proxy_password\"\n    .send\n    html.body.innerHTML = StrConv(.responseBody, vbUnicode)\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1548862876, "post_id": 54444192, "comment_id": 95697783, "body": "Have you tried a <code>CreateObject(&quot;Excel.Application&quot;)</code> instead of GetObject?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548862987, "post_id": 54444192, "comment_id": 95697842, "body": "I think that your problem is coming from the <code>Excel.xxxx</code> in variable declaration.  As with Excel object, dim as object and try???"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1548865090, "post_id": 54444192, "comment_id": 95699089, "body": "@fbueckert arguably <code>CreateObject</code> could be used in the <code>If Excel Is Nothing</code> branch, to create a new instance when an existing one doesn&#39;t exist"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1548864519, "last_edit_date": 1548864519, "creation_date": 1548863537, "answer_id": 54444484, "question_id": 54444192, "link": "https://stackoverflow.com/questions/54444192/how-can-i-open-excel-from-another-office-application-without-setting-references/54444484#54444484", "title": "How can I open Excel from another Office Application without setting references?", "body": "<p>If you're not adding the reference to the type library, you can't use the early-bound types defined in that type library.</p>\n\n<blockquote>\n<pre><code>Dim wkbkXLBook As Excel.Workbook\nDim wkSheet As Excel.worksheet\n</code></pre>\n</blockquote>\n\n<p><code>Excel</code> is the programmatic name of the Excel type library, and <code>Workbook</code> is the name of a class defined in that library. Same for <code>Worksheet</code>. Since Excel isn't referenced, VBA can't resolve these types, and you get a compile error.</p>\n\n<p>You need to work with late-bound code, i.e. in the dark, without <em>IntelliSense</em>, autocompletion, or parameter quick-info, and without making any typos - lest you run into run-time error 438 and 1004.</p>\n\n<p>\"Late-bound\" means \"resolved at run-time\". Whenever you declare something <code>As Object</code>, that's precisely what happens:</p>\n\n<pre><code>Dim wkbkXLBook As Object\nDim wkSheet As Object\n</code></pre>\n\n<p>You can't use any of the Excel types unless you reference the Excel type library. That includes any <code>xl*</code> constant, too.</p>\n\n<blockquote>\n<pre><code>Dim Excel As Object\n</code></pre>\n</blockquote>\n\n<p>I'd warmly recommend renaming this to e.g. <code>xlApp</code>.</p>\n\n<p>Watch out for implicit object references:</p>\n\n<pre><code>Dim someRange As Object\nSet someRange = xlApp.ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"A1\")\n</code></pre>\n\n<p>The above will work, but will also leak the <code>ActiveWorkbook</code> object, its <code>Worksheets</code> collection, and the <code>Worksheet</code> object retrieved; these leaked objects can (and often <em>do</em>) prevent the <code>EXCEL.EXE</code> process from correctly shutting down, even after executing <code>xlApp.Quit</code> and <code>Set xlApp = Nothing</code>: avoid double-dot referencing objects like this. Do this instead:</p>\n\n<pre><code>Dim books As Object\nSet books = xlApp.Workbooks\n\nDim wb As Object\nSet wb = books(\"workbook name\")\n\nDim wbSheets As Object\nSet wbSheets = wb.Worksheets\n\nDim ws As Object\nSet ws = wbSheets(\"sheet name\")\n\nDim rng As Object\nSet rng = ws.Range(\"A1\")\n</code></pre>\n\n<p>With every object involved explicitly scoped to the local procedure, everything should be fine.</p>\n"}], "owner": {"reputation": 11, "user_id": 6832825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0a4c595f7a973133fac1760eeb0693?s=128&d=identicon&r=PG&f=1", "display_name": "JSotelo", "link": "https://stackoverflow.com/users/6832825/jsotelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1582953745, "creation_date": 1548862582, "last_edit_date": 1582953745, "question_id": 54444192, "link": "https://stackoverflow.com/questions/54444192/how-can-i-open-excel-from-another-office-application-without-setting-references", "title": "How can I open Excel from another Office Application without setting references?", "body": "<p>From Word and Outlook, I'm trying to open open Excel using GetObject method but I need to set the references first.  I receive \"Compile error: User-defined type not defined\".  In order to manually fix this, I need to go to Tools>References>Microsoft Excel XX.X Object Library.  Is there a way to not have to do the manual step of setting the reference?  </p>\n\n<p>I access the same files from different sessions (local session, citrix, VM ware) that have different versions of Excel.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/excel/concepts/working-with-other-applications/controlling-one-microsoft-office-application-from-another\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/excel/concepts/working-with-other-applications/controlling-one-microsoft-office-application-from-another</a></p>\n\n<p>Code so far</p>\n\n<pre><code>Sub Macro1()\n'\n    Dim Excel As Object\n\n    Dim wkbkXLBook As Excel.Workbook\n    Dim wkSheet As Excel.worksheet\n\n    Set Excel = GetObject(, \"Excel.Application\")\n\n    If Excel Is Nothing Then\n\n        MsgBox (\"Excel was not found\")\n\n    End If\n\n    Selection.WholeStory\n    Selection.WholeStory\n    Selection.Copy\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548862305, "post_id": 54444012, "comment_id": 95697420, "body": "Why not just use the progress bar, set it&#39;s min and max and then increment?"}, {"owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548862418, "post_id": 54444012, "comment_id": 95697476, "body": "I dont know how to do that, also i need to combine everything"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1548862437, "post_id": 54444012, "comment_id": 95697488, "body": "Note that row counting variables must be of type <code>Long</code> because Excel has more rows than <code>Integer</code> can handle: <code>Dim i As Long</code> \u2022 I recommend <a href=\"https://stackoverflow.com/a/26409520/3219613\">always to use Long instead of Integer</a> in VBA since there is no benefit in <code>Integer</code> at all."}, {"owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "edited": false, "score": 0, "creation_date": 1548862533, "post_id": 54444012, "comment_id": 95697549, "body": "Thats part of an example from the progress bar tutorial, ill remove it"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548862741, "post_id": 54444012, "comment_id": 95697705, "body": "In <code>Sub CountUniqueValues</code> you declare <code>ListCount As Long</code> then set <code>ListCount = List.Count</code> and immediately <code>End Sub</code> so <code>ListCount</code> is never used. That doesn&#39;t make any sense."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1548862859, "post_id": 54444012, "comment_id": 95697777, "body": "Looks like you need a <a href=\"https://rubberduckvba.wordpress.com/2018/01/12/progress-indicator/\" rel=\"nofollow noreferrer\">better tutorial for a <i>much</i> better progress indicator</a> (I wrote that one) - also relevant: <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">UserForm1.Show</a>."}, {"owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "edited": false, "score": 0, "creation_date": 1548862902, "post_id": 54444012, "comment_id": 95697797, "body": "i created the sub to see if it would count the values, i originally had a msgbox appear with the listcount value, but i wanted to utilize that figure to set the progress bar slider"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1549013747, "post_id": 54444012, "comment_id": 95760327, "body": "James, don&#39;t forget to choose an answer"}, {"owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "edited": false, "score": 0, "creation_date": 1549977273, "post_id": 54444012, "comment_id": 96093071, "body": "I dont think any can help me unfortunatly"}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548862773, "post_id": 54444231, "comment_id": 95697726, "body": "Right click on the tool box, and select Additional Controls and then add Progress Bar control from there."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1548862713, "creation_date": 1548862713, "answer_id": 54444231, "question_id": 54444012, "link": "https://stackoverflow.com/questions/54444012/vba-to-copy-pdf-files-from-one-location-to-another-with-progress-bar/54444231#54444231", "title": "VBA to copy pdf files from one location to another with progress bar", "body": "<p>This is to support my comment about using the progress bar </p>\n\n<pre><code>Dim f As UserForm1\n\nSub SetUpAProgressBar()\n\nSet f = New UserForm1\nf.Show vbModeless\n\nf.ProgressBar1.Min = 0\nf.ProgressBar1.Max = Range(\"a\" &amp; Rows.Count).End(xlUp).Row\nf.ProgressBar1.Value = 0\n\nEnd Sub\n\n\nSub IncrementProgressBar()\n    f.ProgressBar1.Value = f.ProgressBar1.Value + 1\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 1, "last_activity_date": 1548862814, "creation_date": 1548862814, "answer_id": 54444267, "question_id": 54444012, "link": "https://stackoverflow.com/questions/54444012/vba-to-copy-pdf-files-from-one-location-to-another-with-progress-bar/54444267#54444267", "title": "VBA to copy pdf files from one location to another with progress bar", "body": "<p>Here's how I code my progress bar</p>\n\n<pre><code>Sub progress(percentComplete As Single)\nProgressBar.Text.Caption = percentComplete &amp; \"% Completed\"\nProgressBar.Bar.Width = percentComplete * 2\nDoEvents \nEnd Sub\n</code></pre>\n\n<p>And in my sub that does stuff:</p>\n\n<pre><code>'Update ProgressBar at certain points in the code\npercentComplete = 11\nprogress percentComplete\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>For each cell in Range(\"A1:A\" &amp; LRow)\n'Do stuff\n\n'Update ProgressBar in a loop\npercentComplete = 11 + Int(cell.Row / LRow * 60) 'where 11 is the starting value, and 60 the percentage to be added\nprogress percentComplete\nNext cell\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1548863452, "post_id": 54444420, "comment_id": 95698098, "body": "Beware that <code>progress(I&#47;(total&#47;100))</code> will NOT return integers, which is not preferred for progress bars"}], "tags": [], "owner": {"reputation": 56, "user_id": 10991106, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OCK6SRwtNLQ/AAAAAAAAAAI/AAAAAAAAAMM/QYNFZoMDKS8/photo.jpg?sz=128", "display_name": "Max Russell", "link": "https://stackoverflow.com/users/10991106/max-russell"}, "is_accepted": false, "score": 0, "last_activity_date": 1548863325, "creation_date": 1548863325, "answer_id": 54444420, "question_id": 54444012, "link": "https://stackoverflow.com/questions/54444012/vba-to-copy-pdf-files-from-one-location-to-another-with-progress-bar/54444420#54444420", "title": "VBA to copy pdf files from one location to another with progress bar", "body": "<p>you need to add some sort of reference to your current row number in PDFcopy() sub. then count the total amount of loops to be completed. and finally, work out the percentage to pass to the progress bar!  </p>\n\n<pre><code>Sub PDFcopy()\n\n  Dim R As Range\n  Dim I as long\n  Dim Total as long\n  Dim SourcePath As String, DestPath As String, FName As String\n\n  'Setup source and dest path (Note: must have a trailing backslash!)\n  SourcePath = \"G:\\test-copyfrom\\\" 'choose directory to copy from\n  DestPath = \"C:\\test-copyto\\\"     'choose directory to copy to\n\n  'Visit each used cell in column B\n  I = 0\n  Total = Range(\"B\" &amp; Rows.Count).End(xlUp)\n  For Each R In Range(\"B1\", Range(\"B\" &amp; Rows.Count).End(xlUp))\n    'Search the file with the file mask from the cell (Note: can contain wildcards like *.xls)\n    FName = Dir(SourcePath &amp; R.Value &amp; \".pdf\")\n    'Loop while files found\n    Do While FName &lt;&gt; \"\"\n      'Copy the file\n      FileCopy SourcePath &amp; FName, DestPath &amp; FName\n      'Search the next file\n      FName = Dir()\n    Loop\n\n   I = I + 1\n   call progress(I/(total/100))\n  Next\n\n  MsgBox (\"files copied\")\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1548863325, "creation_date": 1548862069, "last_edit_date": 1548862555, "question_id": 54444012, "link": "https://stackoverflow.com/questions/54444012/vba-to-copy-pdf-files-from-one-location-to-another-with-progress-bar", "title": "VBA to copy pdf files from one location to another with progress bar", "body": "<p>I have an imported CSV which will always put part numbers into Column B, the part drawing PDF is located in a central location.\nI am trying to copy each drawing from one folder location to another, this part i have been successful with, however some of the files can have up to 3000 lines which means the copy sub can take some time to complete and may seem like excel is not functioning. </p>\n\n<p>I have created a progress bar from some helpful tutorial, but i am struggling to combine them. \nI understand the progress bar needs to calculate something in order to move the slider so i included a sub to count the number of unique entries in column B ( this would be the number of drawing which need copied ) The figure can then be used to create a percentage of completion?</p>\n\n<pre><code>Sub start()\n    UserForm1.Show\nEnd Sub\n\n\nSub code()  \n    Dim i As Integer, j As Integer, pctCompl As Single\n    'Sheet1.Cells.Clear\n\n    For i = 1 To 100\n        For j = 1 To 1000\n            Cells(i, 1).Value = j\n        Next j\n        pctCompl = i\n        progress pctCompl\n    Next i \nEnd Sub\n\n\nSub progress(pctCompl As Single)    \n    UserForm1.Text.Caption = pctCompl &amp; \"% Completed\"\n    UserForm1.Bar.Width = pctCompl * 2\n    UserForm1.Caption = ListCount &amp; \"Files\"\n\n    DoEvents\nEnd Sub\n\n\nSub CountUniqueValues()\n    Dim LstRw As Long, Rng As Range, List As Object, ListCount As Long\n    LstRw = Cells(Rows.Count, \"B\").End(xlUp).Row\n    Set List = CreateObject(\"Scripting.Dictionary\")\n\n    For Each Rng In Range(\"B2:B\" &amp; LstRw)\n      If Not List.Exists(Rng.Value) Then List.Add Rng.Value, Nothing\n    Next\n\n    ListCount = List.Count\nEnd Sub\n\nSub PDFcopy()\n    Dim R As Range\n    Dim SourcePath As String, DestPath As String, FName As String\n\n    'Setup source and dest path (Note: must have a trailing backslash!)\n    SourcePath = \"G:\\test-copyfrom\\\" 'choose directory to copy from\n    DestPath = \"C:\\test-copyto\\\"     'choose directory to copy to\n\n    'Visit each used cell in column B\n    For Each R In Range(\"B1\", Range(\"B\" &amp; Rows.Count).End(xlUp))\n        'Search the file with the file mask from the cell (Note: can contain wildcards like *.xls)\n        FName = Dir(SourcePath &amp; R.Value &amp; \".pdf\")\n        'Loop while files found\n        Do While FName &lt;&gt; \"\"\n            'Copy the file\n            FileCopy SourcePath &amp; FName, DestPath &amp; FName\n            'Search the next file\n            FName = Dir()\n        Loop\n    Next\n\n    MsgBox (\"files copied\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1548862714, "post_id": 54444002, "comment_id": 95697686, "body": "Look in to <code>MID()</code> and increment a character by one each loop."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1548862747, "post_id": 54444002, "comment_id": 95697707, "body": "Looks like that function handles 1 character. You need to look at the code that&#39;s <i>invoking</i> that function."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1548862796, "post_id": 54444002, "comment_id": 95697738, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13778819/excel-2010-vba-step-through-a-string-and-place-one-char-into-each-cell-in-sequen\">Excel 2010 VBA step through a string and place one char into each cell in sequence</a>"}, {"owner": {"reputation": 11, "user_id": 10991159, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TkYfJnQ-7wE/AAAAAAAAAAI/AAAAAAAACEE/s5PwdqGcUZY/photo.jpg?sz=128", "display_name": "Masa-san", "link": "https://stackoverflow.com/users/10991159/masa-san"}, "edited": false, "score": 0, "creation_date": 1548864603, "post_id": 54444002, "comment_id": 95698769, "body": "OK, thx for help with MID. I made something like this and is working. <code>Function Text2LE(Character As String) Dim x As Long Dim a As String Dim i As Long c = Len(Character) For i = 1 To c a = Mid(Character, i, 1) x = AscW(a) If x &lt; 16 Then   LE = &quot;000&quot; &amp; Hex(AscW(a)) ElseIf x &lt; 256 Then   LE = &quot;00&quot; &amp; Hex(AscW(a)) Else   LE = &quot;0&quot; &amp; Hex(AscW(a)) End If   Text2 = Right(LE, 2) &amp; Left(LE, 2)   Text2LE = Text2LE + Text2 Next i End Function </code>"}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 10991106, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OCK6SRwtNLQ/AAAAAAAAAAI/AAAAAAAAAMM/QYNFZoMDKS8/photo.jpg?sz=128", "display_name": "Max Russell", "link": "https://stackoverflow.com/users/10991106/max-russell"}, "is_accepted": false, "score": 0, "last_activity_date": 1548864440, "creation_date": 1548864440, "answer_id": 54444760, "question_id": 54444002, "link": "https://stackoverflow.com/questions/54444002/excel-repeat-vba-script-after-word-is-finished/54444760#54444760", "title": "Excel: Repeat VBA script after word is finished", "body": "<p>you need something like to loop through the Character in the string and convert it using your function! Then Group the HEX together and display or consume! (Not to sure on the display of hex in debug window)</p>\n\n<pre><code>sub Convert()\n Dim i as long\n Dim string_to_convert as string\n Dim Hex as String\n\n For i = 1 to len(string_to_convert)\n   Hex = Hex + Text2LE(Mid(string_to_convert, i, 1))\n Next i\n\n debug.Print Hex\n\nend sub\n\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10991159, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TkYfJnQ-7wE/AAAAAAAAAAI/AAAAAAAACEE/s5PwdqGcUZY/photo.jpg?sz=128", "display_name": "Masa-san", "link": "https://stackoverflow.com/users/10991159/masa-san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548864440, "creation_date": 1548862052, "last_edit_date": 1548862174, "question_id": 54444002, "link": "https://stackoverflow.com/questions/54444002/excel-repeat-vba-script-after-word-is-finished", "title": "Excel: Repeat VBA script after word is finished", "body": "<p>I'm still learning how to make scripts in VBA.\nFor now I want to create script converting text from cell to Unicode Little Endian Hex. I have script that works now only for first character. How should i apply loop to switch to next letter, add it to print and finish script when text is over?</p>\n\n<pre><code>Function Text2LE(Character As String)    \nDim x As Long\nx = AscW(Character)\nIf x &lt; 16 Then\n  Text2LE = \"000\" &amp; Hex(AscW(Character))\n  Text2LE = Right(Text2LE, 2) &amp; Left(Text2LE, 2)\nElseIf x &lt; 256 Then\n  Text2LE = \"00\" &amp; Hex(AscW(Character))\n  Text2LE = Right(Text2LE, 2) &amp; Left(Text2LE, 2)\nElse\n  Text2LE = \"0\" &amp; Hex(AscW(Character))\n  Text2LE = Right(Text2LE, 2) &amp; Left(Text2LE, 2)\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "variant", "subscript"], "comments": [{"owner": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 2, "creation_date": 1548860615, "post_id": 54443417, "comment_id": 95696223, "body": "Subscript out of Range is obvious; you&#39;re going outside the bounds of the array.  The rest sounds like issues with your conditional.  I&#39;d step through it to see what&#39;s happening."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1548860765, "post_id": 54443417, "comment_id": 95696336, "body": "Don&#39;t use Select <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 10990895, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5pLguIZpDHc/AAAAAAAAAAI/AAAAAAAAAR8/5LRpu1g4Yf8/photo.jpg?sz=128", "display_name": "Chris Stuart", "link": "https://stackoverflow.com/users/10990895/chris-stuart"}, "edited": false, "score": 0, "creation_date": 1548860807, "post_id": 54443417, "comment_id": 95696363, "body": "So I tried the &quot;For b&quot; 1 to 13237 and it still managed to get to 13238 when the break hits."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1548860952, "post_id": 54443417, "comment_id": 95696466, "body": "I&#39;m not sure I understand the point of your code. Are you just trying to populate a cell dependent on a criteria? If so you could just use an <code>IF</code> statement in Excel. Also, your first loop doesn&#39;t seem to be doing anything, and lastly why use an array? You aren&#39;t really doing anything with it anyway."}, {"owner": {"reputation": 1, "user_id": 10990895, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5pLguIZpDHc/AAAAAAAAAAI/AAAAAAAAAR8/5LRpu1g4Yf8/photo.jpg?sz=128", "display_name": "Chris Stuart", "link": "https://stackoverflow.com/users/10990895/chris-stuart"}, "edited": false, "score": 0, "creation_date": 1548860955, "post_id": 54443417, "comment_id": 95696468, "body": "SJR - the .Select isnt the issue, that is the only bit working correctly at the moment.  Ultimately I want to load the list of users into another array rather than .Select but I&#39;m still trying the code."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1548860982, "post_id": 54443417, "comment_id": 95696479, "body": ".Select is almost always a performance issue"}, {"owner": {"reputation": 1, "user_id": 10990895, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5pLguIZpDHc/AAAAAAAAAAI/AAAAAAAAAR8/5LRpu1g4Yf8/photo.jpg?sz=128", "display_name": "Chris Stuart", "link": "https://stackoverflow.com/users/10990895/chris-stuart"}, "edited": false, "score": 0, "creation_date": 1548861068, "post_id": 54443417, "comment_id": 95696538, "body": "Tom - Hi! I want to use an array because the way its currently done (45,000ish COUNTIFS) takes the poor lady&#39;s spreadsheet and computer out of action for about 10 mins."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1548861195, "post_id": 54443417, "comment_id": 95696618, "body": "Have you addressed fbueckert&#39;s comment? Your question isn&#39;t very clear because we can&#39;t know anything about your set up, we don&#39;t eve know which line errors. You need to do some debugging yourself, step through, use the locals window."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1548861200, "post_id": 54443417, "comment_id": 95696626, "body": "@ChrisStuart I can understand why you&#39;d use an array, but in your code you&#39;re still doing everything using <code>Select</code> statements (very poor performance) and also referring to the sheet (again slow read write compared to the array). So you aren&#39;t really leveraging any performance gains by using it"}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1548861539, "creation_date": 1548861539, "answer_id": 54443855, "question_id": 54443417, "link": "https://stackoverflow.com/questions/54443417/variant-array-multiple-errors-and-failure/54443855#54443855", "title": "Variant Array multiple errors and failure", "body": "<p>A quick rewrite without using <code>Select</code>. This still isn't having any gains from the array though.</p>\n\n<pre><code>Sub createScore()\n    Dim loData As ListObject\n    Dim arrData() As Variant, arrSummary As Variant\n    Dim lRowCount As Long, a As Long, b As Long\n\n    Set loData = Sheets(\"DataMeasure\").ListObjects(\"tbl_g2Measure\")\n    arrData = loData.DataBodyRange\n    lRowCount = Range(\"A6\").Value\n\n    ' Update with correct sheet reference\n    With ActiveSheet.Range(\"A8\")\n        For a = 1 To lRowCount\n            For b = LBound(arrData, 1) To UBound(arrData, 1)\n                If arrData(b, 2) = .Offset(a, 0).Value2 And arrData(b, 8) = \"HIT\" Then\n                    .Offset(a, 3) = .Offset(a, 4)\n                End If\n            Next b\n        Next a\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "is_accepted": false, "score": 0, "last_activity_date": 1548862399, "creation_date": 1548862399, "answer_id": 54444128, "question_id": 54443417, "link": "https://stackoverflow.com/questions/54443417/variant-array-multiple-errors-and-failure/54444128#54444128", "title": "Variant Array multiple errors and failure", "body": "<p>I have needed to do something similar where the user list had duplicates so I created an array of unique usernames:</p>\n\n<pre><code>Dim arr() As String\nlrn = 13237 'ActiveSheet.Range(\"A1\").Range(\"A1\").SpecialCells(xlCellTypeLastCell).Row\nac = 0\nReDim arr(0 To ac) As String\nFor Each c In Range(\"L2:L\" &amp; lrn)\n    If Not IsEmpty(c.Value) Then\n        If Not (UBound(Filter(arr, c.Value)) &gt; -1) Then\n            If ac &gt; 0 Then ReDim Preserve arr(0 To ac)\n            arr(ac) = c.Value\n            ac = ac + 1\n        End If\n    End If\n    DoEvents\nNext c\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10990895, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5pLguIZpDHc/AAAAAAAAAAI/AAAAAAAAAR8/5LRpu1g4Yf8/photo.jpg?sz=128", "display_name": "Chris Stuart", "link": "https://stackoverflow.com/users/10990895/chris-stuart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1548862399, "creation_date": 1548860124, "last_edit_date": 1548860185, "question_id": 54443417, "link": "https://stackoverflow.com/questions/54443417/variant-array-multiple-errors-and-failure", "title": "Variant Array multiple errors and failure", "body": "<p>People of the internet, I need your help!  I am trying to use variant arrays to summarise a large dataset of performance data into individual scores.</p>\n\n<p>I have a table with about 13000 rows and about 1500 employees to loop through. </p>\n\n<p>I am not new to VBA and have used this method before so I do not know what is going wrong.</p>\n\n<p>I either get a \"Subscript out of Range\" when the for loop exceeds the UBound of the array or a bunch of \"Next without For\", \"End Select without Select\" regardless of whether the \"End\" or \"Next\" is there or not.</p>\n\n<p>Please help?</p>\n\n<pre><code>Sub createScore()\n\nDim loData As ListObject\nDim arrData() As Variant, arrSummary As Variant\nDim lRowCount As Long, a As Long, b As Long\n  Set loData = Sheets(\"DataMeasure\").ListObjects(\"tbl_g2Measure\")\n    arrData = loData.DataBodyRange\n    lRowCount = Range(\"A6\").Value\n\n    Range(\"A8\").Select\n    For a = 1 To lRowCount\n      Selection.Offset(1, 0).Select\n\n        For b = LBound(arrData) To UBound(arrData)\n          If arrData(b, 2) = Selection Then\n            Select Case arrData(b, 8)\n               Case \"HIT\"\n                Selection.Offset(0, 3) = Selection.Offset(0, 3) + 1\n            End Select\n          End If\n        Next b\n\n    Next a\n    Range(\"A8\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "range"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1548868371, "post_id": 54443364, "comment_id": 95701108, "body": "See if the explanation in this answer helps:  <a href=\"https://stackoverflow.com/questions/51925805/vba-how-to-start-a-selection-halfway-through-the-text-in-a-table/51932924#51932924\" title=\"vba how to start a selection halfway through the text in a table\">stackoverflow.com/questions/51925805/&hellip;</a>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1548868389, "post_id": 54443364, "comment_id": 95701119, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/51925805/vba-how-to-start-a-selection-halfway-through-the-text-in-a-table\">VBA - How to start a selection halfway through the text in a table</a>"}, {"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1548928421, "post_id": 54443364, "comment_id": 95723582, "body": "Thanks! I have gone with Macropod&#39;s <code>.Wrap = wdFindStop</code> solution."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "edited": false, "score": 0, "creation_date": 1548928289, "post_id": 54449715, "comment_id": 95723488, "body": "Thanks Macropod! <code>.Wrap = wdFindStop</code> was the silver bullet and it has saved me hours googling up the wrong tree! Also more concise code! Many thanks!"}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1548883225, "creation_date": 1548883225, "answer_id": 54449715, "question_id": 54443364, "link": "https://stackoverflow.com/questions/54443364/selection-find-within-a-range/54449715#54449715", "title": "Selection.Find within a range", "body": "<p>Given your problem description, your code can be reduced to:</p>\n\n<pre><code>Sub Replace_Percent_Separator()\n'Correct percent separator in row 6, table 2\nfile = Dir(\"C:\\xxx\\Word\\*.docx\")\n\nDo While file &lt;&gt; \"\"\n  Documents.Open FileName:=Path &amp; file, AddToRecentFiles:=False, Visible:=False\n  With ActiveDocument\n    With .Tables(2).Row(6).Range.Find\n      .Text = \",\"\n      .Replacement.Text = \".\"\n      .Forward = True\n      .Wrap = wdFindStop\n      .Format = False\n      .Execute Replace:=wdReplaceAll\n    End With\n    .Close SaveChanges:=True\n  End With\n  file = Dir()\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>As can be seen, there is no need to select anything and, by using wdFindStop instead of wdFindContinue, the Find/Replace stops where it should.</p>\n"}], "owner": {"reputation": 59, "user_id": 4919674, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uYKyeSSyg9s/AAAAAAAAAAI/AAAAAAAACmY/yAzPezr9oO4/photo.jpg?sz=128", "display_name": "cdfj", "link": "https://stackoverflow.com/users/4919674/cdfj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 54449715, "answer_count": 1, "score": 1, "last_activity_date": 1548883225, "creation_date": 1548859982, "question_id": 54443364, "link": "https://stackoverflow.com/questions/54443364/selection-find-within-a-range", "title": "Selection.Find within a range", "body": "<p>I am not familiar with Word VBA and am having a problem with Selection.Find. </p>\n\n<p>I want to replace commas by decimal points in a range of cells in a table. However I can only get Selection.Find to replace either all commas in the document or only the first comma in the range. </p>\n\n<p>What I would like is something like Selection.Replace What:=\".\", Replacement:=\",\" in Excel, but Word does not support that.</p>\n\n<p>Suggestions very gratefully received!</p>\n\n<p>CJ</p>\n\n<pre><code>Sub Replace_Percent_Separator()\n'Correct percent separator in row 6, table 2\n\nDim PcentCells As Range\n\nPath = \"C:\\xxx\\Word\\\"\nfile = Dir(Path &amp; \"*.docx\")\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nDo While file &lt;&gt; \"\"\n\n    Documents.Open Filename:=Path &amp; file\n\n    With ActiveDocument\n\n        Set PcentCells = .Range(Start:=.Tables(2).Cell(6, 2).Range.Start, _\n            End:=.Tables(2).Cell(6, 10).Range.End)\n        PcentCells.Select\n\n        With Selection.Find\n            .Text = \",\"\n            .Replacement.Text = \".\"\n            .Forward = True\n            .Wrap = wdFindContinue\n            .Format = False\n            .MatchCase = False\n            .MatchWholeWord = False\n            .MatchWildcards = False\n            .MatchSoundsLike = False\n            .MatchAllWordForms = False\n            .Execute Replace:=wdReplaceAll '&lt;-- replaces throughout document\n            '.Execute Replace:=wdReplaceOne '&lt;-- replaces in first cell but no other cells\n        End With\n\n    End With\n\n    ActiveDocument.Save\n\n    ActiveDocument.Close\n\n    file = Dir()\n\nLoop\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1548858811, "post_id": 54442892, "comment_id": 95694972, "body": "Look at the syntax of your <code>rng.copy</code> line (which is fine) and see if you can see the difference in the <code>rng2</code> line(s)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9167318"}, "edited": false, "score": 1, "creation_date": 1548860287, "post_id": 54442892, "comment_id": 95696006, "body": "Why the use of <code>.Offset(0)</code> ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548860513, "post_id": 54442892, "comment_id": 95696163, "body": "Also note the typo in <code>x1Up</code> which should be <code>xlUp</code>. It must be a lower case <code>XL</code> not a one <code>X1</code>. \u2022 I recommend to activate <code>Option Explicit</code> to avoid such typos: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i>."}, {"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "edited": false, "score": 0, "creation_date": 1548864039, "post_id": 54442892, "comment_id": 95698437, "body": "Thanks guys, I&#39;ve just spent the last hour working on this and amending both sheets to change ranges, to in effect make up one range, but will try the above and see if this works."}], "owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548860143, "creation_date": 1548858615, "last_edit_date": 1548860143, "question_id": 54442892, "link": "https://stackoverflow.com/questions/54442892/macro-to-paste-data-from-one-sheet-to-blank-column-in-the-last-populated-row-of", "title": "Macro to paste data from one sheet to blank column in the last populated row of another sheet", "body": "<p>Hi I have the following code, the first part of which works fine, but I cannot get the destination bit for rng2 to work - keep getting a \"application-defined or object-defined error\".  Wondered if anyone could help with where I am going wrong as I've tried a few different methods (destination being the neatest I know a little about).</p>\n\n<pre><code>Sub Assign_TN()\n\n' Assign_TN Macro\n\nDim ws As Worksheet\nDim wbk2 As Workbook\nDim ws2 As Worksheet\nDim Rng As Range\nDim rng2 As Range\n\nSet ws = ThisWorkbook.Worksheets(\"Check sheet\")\nSet wbk2 = Workbooks.Open(\"A Location\\TNG Register ongoing.xlsx\")\nSet ws2 = wbk2.Worksheets(\"TNG\")\n\n\n'This clears the TN has failed comment in the event the cannot generate Tn macro has been run\n\nws.Range(\"A83\").ClearContents\n\n' Copy the first set of data from the checksheet and paste into the first blank row of the TNG register\n\nSet Rng = ws.Range(\"B93:M93\")\n    Rng.Copy Destination:=ws2.Cells(Rows.Count, 2).End(xlUp).Offset(1)\n\n'copy second set of data from checksheet and paste into first blank cell in column 22\n\nSet rng2 = ws.Range(\"Q93:AM93\")\n    rng2.Copy\n    Destination = ws2.Cells(Rows.Count, 22).End(x1Up).Offset(0)\n</code></pre>\n\n<p>All I need this to do is copy two ranges data into two separate area's of the first unpopulated row in a second sheet.  This in effect generates an acceptance number which is subsequently copied and pasted into the first sheet (this bit of code hasn't been added and works well).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "reply_to_user": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1548858692, "post_id": 54442805, "comment_id": 95694889, "body": "Hi @fbueckert - I edited my post. THank you"}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1548868682, "last_edit_date": 1548868682, "creation_date": 1548866628, "answer_id": 54445469, "question_id": 54442805, "link": "https://stackoverflow.com/questions/54442805/why-does-uploading-same-file-caused-an-error/54445469#54445469", "title": "Why does uploading same file caused an error?", "body": "<p>You cannot open a file two times within Excel (you can even not open 2 different files that have the same name but live in different folder). If you try, Excel will close and reopen that file</p>\n\n<p>You can check this by modifying the file (e.g. write something in a cell) - Excel will ask you if you want to reopen the file and lose the modifications. However, if the file was not modified, Excel will reopen the file without further notification.</p>\n\n<p>Reopening the file will invalidate the reference of the first workbook variable (<code>wbCopyF1</code>) and also of the first worksheet variable (<code>wsCopyF1</code>). And if you access one of these variables, you will get the automation error.</p>\n"}], "owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1548868682, "creation_date": 1548858355, "last_edit_date": 1548860125, "question_id": 54442805, "link": "https://stackoverflow.com/questions/54442805/why-does-uploading-same-file-caused-an-error", "title": "Why does uploading same file caused an error?", "body": "<p>I'm doing a tool which need to compare 2 files. But, I got an error everytime I select or upload same file. Here is my code:</p>\n\n<pre><code>Dim File1 As String, File2 As String\nDim wbCopyF1 As Workbook, wbCopyF2 As Workbook, wbCopyT As Workbook\nDim wsCopyF1 As Worksheet, wsCopyF2 As Worksheet\nDim LR1 As Long, LR2 As Long\n\nSet wbCopyT = Workbooks.Add\n\nFile1 = txtBoxOld.Text\nFile2 = txtBoxNew.Text\n\n'Open the path location of selected file\nSet wbCopyF1 = Workbooks.Open(File1)\nSet wsCopyF1 = wbCopyF1.Sheets(1)\nSet wbCopyF2 = Workbooks.Open(File2)\nSet wsCopyF2 = wbCopyF2.Sheets(1)\n\n'Filter the application and copy Range from Previous file\nLR1 = wsCopyF1.Range(\"A\" &amp; Rows.count).End(xlUp).row\nwsCopyF1.Range(\"A2:D2\").AutoFilter Field:=1, Criteria1:=Me.txtBoxApplication, VisibleDropDown:=True\nwsCopyF1.Range(\"A2:D\" &amp; LR1).SpecialCells(xlCellTypeVisible).Copy\nwbCopyT.Sheets(\"Sheet1\").Range(\"A1\").PasteSpecial\nwbCopyF1.Close SaveChanges:=False\n\n'Filter the application and copy Range from Latest file\nLR2 = wsCopyF2.Range(\"A\" &amp; Rows.count).End(xlUp).row\nwsCopyF2.Range(\"A2:D2\").AutoFilter Field:=1, Criteria1:=Me.txtBoxApplication, VisibleDropDown:=True\nwsCopyF2.Range(\"A2:D\" &amp; LR2).SpecialCells(xlCellTypeVisible).Copy\nwbCopyT.Sheets(\"Sheet2\").Range(\"A1\").PasteSpecial\nwbCopyF2.Close SaveChanges:=False\n</code></pre>\n\n<p>I got an error like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2ENyr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2ENyr.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And, the error pointed in this code: <code>LR1 = wsCopyF1.Range(\"A\" &amp; Rows.count).End(xlUp).row</code></p>\n\n<p>The expected is that, whether I only have 1 file I can use the same file without experiencing any errors. Is there something wrong with my code?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1548859522, "creation_date": 1548859522, "answer_id": 54443208, "question_id": 54442800, "link": "https://stackoverflow.com/questions/54442800/how-to-remove-data-from-cells-where-the-data-is-equal-to-or-greater-than-9-chara/54443208#54443208", "title": "How to remove data from cells where the data is equal to or greater than 9 characters in length?", "body": "<p>One way is using <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">regular expressions</a>.</p>\n\n<pre><code>Sub x()\n\nDim r As Range\n\nWith CreateObject(\"VBScript.RegExp\")\n    .Global = True\n    .Pattern = \"\\d{9,}\"\n    For Each r In Range(\"A1:A10\")\n        r.Offset(, 1) = .Replace(r, \"\")\n    Next r\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1548859667, "creation_date": 1548859667, "answer_id": 54443259, "question_id": 54442800, "link": "https://stackoverflow.com/questions/54442800/how-to-remove-data-from-cells-where-the-data-is-equal-to-or-greater-than-9-chara/54443259#54443259", "title": "How to remove data from cells where the data is equal to or greater than 9 characters in length?", "body": "<p>You could achieve this quite easily with Regular Expressions. The following code will identify any part of your string that contains a number equal to or longer than 9 characters and remove them</p>\n\n<pre><code>Public Sub Demo()\n    Dim RegExp As Object\n    Dim rng As Range\n    Dim matches\n    Dim c\n\n    Set rng = Sheet1.Range(\"A1\")\n\n    Set RegExp = CreateObject(\"vbscript.regexp\")\n\n    With RegExp\n        .MultiLine = False\n        .Global = True\n        .IgnoreCase = False\n        .Pattern = \"[0-9]{9,}\"\n\n        For Each c In rng\n            If .test(c) Then\n                Set matches = .Execute(c)\n                MsgBox .Replace(c, vbNullString)\n            End If\n        Next c\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "is_accepted": false, "score": 1, "last_activity_date": 1548862580, "creation_date": 1548862580, "answer_id": 54444190, "question_id": 54442800, "link": "https://stackoverflow.com/questions/54442800/how-to-remove-data-from-cells-where-the-data-is-equal-to-or-greater-than-9-chara/54444190#54444190", "title": "How to remove data from cells where the data is equal to or greater than 9 characters in length?", "body": "<p>You could also use the <code>Len()</code> function with <code>Trim()</code> like so: </p>\n\n<pre><code>Sub DeleteBlanks()\n\nDim g As Long, RowNumber As Long\n\n    With Sheets(\"SheetName\")\n        'Finds the last row in the first column\n        RowNumber = .Cells(Rows.Count, 1).End(xlUp).Row\n\n        For g = 1 To RowNumber \n            'Note:Value2 reads cells W/O formatting and is faster\n            If Len(Trim(.Cells(g, 1).Value2)) &gt;= 9 Then\n                .Cells(g, 1).ClearContents\n            End If\n        Next g\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10933102, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8qoU.jpg?s=128&g=1", "display_name": "Sbrhbr", "link": "https://stackoverflow.com/users/10933102/sbrhbr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 54443208, "answer_count": 3, "score": 1, "last_activity_date": 1548862580, "creation_date": 1548858344, "last_edit_date": 1548859236, "question_id": 54442800, "link": "https://stackoverflow.com/questions/54442800/how-to-remove-data-from-cells-where-the-data-is-equal-to-or-greater-than-9-chara", "title": "How to remove data from cells where the data is equal to or greater than 9 characters in length?", "body": "<p>I need to remove data from cells that is 9 or more digits or characters. For example this should be deleted: 123456789, 987654321, 1234567898765, and so on.</p>\n\n<p>I already got the code that checks every single part of a cell to compare but I have a problem constructing the number specification.</p>\n\n<p>The sample line for code to work on will look like that:</p>\n\n<pre>Aegis Transformation Cycle 566609354 Agent 73849496753</pre>\n\n<p>My code:</p>\n\n<pre><code>For g = 2 to RowNumber\n    MyCell = \" \" &amp; Cells(g, 2).Value &amp; \" \"\n    Word = Split(MyCell, \" \")\n    For j = 0 To UBound(Word)\n        If Word &gt;= 100000000 Then\n            Cells(g, 2).Replace What:=Word(j), Replacement:=\"\"\n        End If \n    Next j\nNext g\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1548857936, "post_id": 54442540, "comment_id": 95694385, "body": "You need to keep the original values somewhere separate, then comparison testing is easy and so is reversion."}, {"owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "edited": false, "score": 0, "creation_date": 1548857958, "post_id": 54442540, "comment_id": 95694399, "body": "you can achieve this with a hidden column (or row) with all the default values. the rest is conditional formating to see if the value is unequal to the default"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548858194, "post_id": 54442540, "comment_id": 95694552, "body": "Use <code>Selection_Change</code> in the worksheet to record your current value, and then <code>Change</code> to check, so set say <code>varWas</code> in Selection_Change and <code>varTo</code> in Change, and then compare the two."}, {"owner": {"reputation": 13, "user_id": 8549026, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lt2EkeKCVcc/AAAAAAAAAAI/AAAAAAAAABc/xC4awlDjCWI/photo.jpg?sz=128", "display_name": "nate", "link": "https://stackoverflow.com/users/8549026/nate"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1548858616, "post_id": 54442540, "comment_id": 95694829, "body": "@SolarMike when you say somewhere separate in a different Sub? or just setting the Dim outside of a Sub?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8549026, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lt2EkeKCVcc/AAAAAAAAAAI/AAAAAAAAABc/xC4awlDjCWI/photo.jpg?sz=128", "display_name": "nate", "link": "https://stackoverflow.com/users/8549026/nate"}, "edited": false, "score": 0, "creation_date": 1548861274, "post_id": 54443134, "comment_id": 95696683, "body": "This works great except that it sets the varWas variable to whatever is initially in the cell <b>when clicked</b>, I need to set and store the variable only once. so if a cell&#39;s original value is &quot;xyz&quot; and a user edits it to &quot;abc&quot; it highlights, but if the user resets the value back to &quot;xyz&quot; then, and only then does the highlighting go away. So is there a way to set that varWas value only the first time the user clicks into the cell, and not every time?"}, {"owner": {"reputation": 13, "user_id": 8549026, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lt2EkeKCVcc/AAAAAAAAAAI/AAAAAAAAABc/xC4awlDjCWI/photo.jpg?sz=128", "display_name": "nate", "link": "https://stackoverflow.com/users/8549026/nate"}, "edited": false, "score": 0, "creation_date": 1548863272, "post_id": 54443134, "comment_id": 95698007, "body": "Thanks, this works even better. My only issue now is trying to run setup() on workbook_open is throwing errors.  I&#39;ve tried  Private Sub Workbook_Open() Call setup End Sub   and it throws an error on line 2 of the worksheet module, maybe not finding the rngChecked variable? Same result when I put the setup code directly in the workbook open Sub like this:  Private Sub Workbook_Open()     Set rngChecked = ActiveSheet.UsedRange     arrContentsAtStart = ActiveSheet.UsedRange End Sub"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 13, "user_id": 8549026, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lt2EkeKCVcc/AAAAAAAAAAI/AAAAAAAAABc/xC4awlDjCWI/photo.jpg?sz=128", "display_name": "nate", "link": "https://stackoverflow.com/users/8549026/nate"}, "edited": false, "score": 0, "creation_date": 1548863452, "post_id": 54443134, "comment_id": 95698097, "body": "You gave it 20mins :o)   What errors?  Maybe the activesheet references."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1548864137, "last_edit_date": 1548864137, "creation_date": 1548859332, "answer_id": 54443134, "question_id": 54442540, "link": "https://stackoverflow.com/questions/54442540/how-can-i-test-a-cells-edited-value-against-its-original-value/54443134#54443134", "title": "How can I test a cell&#39;s edited value against it&#39;s original value?", "body": "<p>Something like this as a base</p>\n\n<pre><code>Public varWas As Variant\nPublic varTo As Variant\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    varTo = Target.Value\n    If varTo = varWas Then\n        Target.Interior.Color = vbWhite\n        Target.Font.Bold = False\n    Else\n        Target.Interior.Color = vbRed\n        Target.Font.Bold = True\n    End If\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    varWas = Target.Value\nEnd Sub\n</code></pre>\n\n<p>**** UPDATE ****</p>\n\n<p>in a standard module, create the following</p>\n\n<pre><code>Public arrContentsAtStart As Variant\nPublic rngChecked As Range\n\nPublic Sub setup()\n    Set rngChecked = ActiveSheet.UsedRange\n    arrContentsAtStart = ActiveSheet.UsedRange.Value\nEnd Sub\n</code></pre>\n\n<p>and then in the worksheet module add the following, you will need to run set up on workbook open I imagine, it's up to you though when to get the \"as is\" data.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Target, rngChecked) Is Nothing Then\n\n        If Target.Value &lt;&gt; arrContentsAtStart(Target.Row, Target.Column) Then\n\n            '   Value change format accordingly\n            Target.Font.Bold = True\n\n        ElseIf Target.Value = arrContentsAtStart(Target.Row, Target.Column) Then\n\n            '   Reverted back to original value format accordingly\n\n            Target.Font.Bold = False\n\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1548860108, "creation_date": 1548860108, "answer_id": 54443410, "question_id": 54442540, "link": "https://stackoverflow.com/questions/54442540/how-can-i-test-a-cells-edited-value-against-its-original-value/54443410#54443410", "title": "How can I test a cell&#39;s edited value against it&#39;s original value?", "body": "<p>We can use column <strong>XFD</strong> as the \"memory\" of the original values in column <strong>A</strong>.</p>\n\n<p><strong>First</strong> enter all original values in column <strong>A</strong>.<br><br><strong>Second</strong> enter this into a standard module and run it:</p>\n\n<pre><code>Public A As Range\nPublic XFD As Range\nPublic setup As String\n\nPublic Sub Initialize()\n    Application.EnableEvents = False\n        Set A = Range(\"A:A\")\n        Set XFD = Range(\"XFD:XFD\")\n        A.Copy XFD\n        setup = \"done\"\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p><strong>Third</strong> enter this into the worksheet code area:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim Intersekt As Range, r As Range\n\n    If setup &lt;&gt; \"done\" Then Exit Sub\n    Set Intersekt = Intersect(A, Target)\n    If Intersekt Is Nothing Then Exit Sub\n\n    For Each r In Intersekt\n        If r.Value = XFD(r.Row) Then\n            r.ClearFormats\n        Else\n            r.Interior.Color = 65535\n            r.Font.Bold = True\n        End If\n    Next r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8549026, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lt2EkeKCVcc/AAAAAAAAAAI/AAAAAAAAABc/xC4awlDjCWI/photo.jpg?sz=128", "display_name": "nate", "link": "https://stackoverflow.com/users/8549026/nate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 54443134, "answer_count": 2, "score": 0, "last_activity_date": 1556680081, "creation_date": 1548857544, "last_edit_date": 1556680081, "question_id": 54442540, "link": "https://stackoverflow.com/questions/54442540/how-can-i-test-a-cells-edited-value-against-its-original-value", "title": "How can I test a cell&#39;s edited value against it&#39;s original value?", "body": "<p>I'm working on a spreadsheet where default values are provided to the user. I have these formatted plainly (white background/black text).</p>\n\n<p>I set up a macro to format cells as highlighted (yellow background/bold text) when the value has been edited.</p>\n\n<p>I'm trying to capture the original value (or Value2?) of each cell, upon entering it, so that if a user changes the value it will highlight the cell with the conditional formatting macro I set up BUT if they revert the value to what was there originally the highlighting goes away.</p>\n\n<p>For example, I have a \"First Name\" column with a \"Stephen\" cell in it. If the user edits that cell to say \"Joe\" it will become highlighted to show that it has been edited and is no longer the default value. If the user then edits the cell to once again say \"Stephen\" the new value would match the original, unedited value, and the conditional formatting (highlighting) will be removed.</p>\n\n<p>I've read some tutorials <a href=\"https://powerspreadsheets.com/excel-vba-value-value2/#VBA-code-to-get-cell-value\" rel=\"nofollow noreferrer\">here</a> but the tutorials without modifying to meet my needs were throwing errors.</p>\n\n<p>I tried setting the value to a variable but it doesn't seem to be helping.</p>\n\n<pre><code>Dim myCellValue As Variant\nmyCellSetValue.Value = Range.Value2\n</code></pre>\n\n<p>This is the macro I have in place now. It changes the formatting of every cell as soon as it's clicked into, regardless of editing. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Target.Interior.ColorIndex = 36\n    Target.Font.FontStyle = \"Bold\"\nEnd Sub\n</code></pre>\n\n<p>I need to<br>\n1. apply this formatting only if the value is changed<br>\n2. remove this formatting if the cell's value matches it's original value</p>\n\n<p>Also, is there a way to 'one click revert' the cell to it's original value?</p>\n"}, {"tags": ["vba", "outlook", "ms-word"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1548906852, "post_id": 54442521, "comment_id": 95714366, "body": "Are you trying to get the document name that\u2019s on the commandButton?"}, {"owner": {"reputation": 27, "user_id": 10617739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1574acc67062a036247b30ce0e162a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fane", "link": "https://stackoverflow.com/users/10617739/fane"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1549268516, "post_id": 54442521, "comment_id": 95827753, "body": "Hi, 0m3r, please, can you help me with my last request? Now my converted document in .pdf is saved to desktop, and last thing is to be attached to the body of e-mail, but HTML signature to remain. I see this line of code &quot;.Attachments.Add PdfFile.FullName&quot; but the .pdf still is not attached. Thank you so much!"}], "answers": [{"comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1548884024, "post_id": 54446008, "comment_id": 95708512, "body": "Wrong! That only references the document the code is being run from (e.g. a Word template), not the <i>active</i> document."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1548885478, "post_id": 54446008, "comment_id": 95709026, "body": "What if the op has  multiple active documents- this is the best option."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1548895738, "post_id": 54446008, "comment_id": 95711955, "body": "Even with multiple documents, the userform is liable to be in a template and the intention/expectation would be to employ the active document. Indeed, as the OP clearly stated: &quot;I want the Subject of the email to be <i>the name of the opened active Word document</i>&quot;."}, {"owner": {"reputation": 27, "user_id": 10617739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1574acc67062a036247b30ce0e162a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fane", "link": "https://stackoverflow.com/users/10617739/fane"}, "edited": false, "score": 1, "creation_date": 1549002878, "post_id": 54446008, "comment_id": 95755575, "body": "Can you help me please to modify the line of code .TO: in order to send an email to the Author of that active doc Wd,, to identify the Last modified by/Author name and based on that name convert it into firstname.secondname@xyz.ro? The Author will send an email to his superior, and that doc Wd will be reviewed by this person via that CommandButton.  Thank you very much for all your support!"}, {"owner": {"reputation": 27, "user_id": 10617739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1574acc67062a036247b30ce0e162a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fane", "link": "https://stackoverflow.com/users/10617739/fane"}, "edited": false, "score": 0, "creation_date": 1549008494, "post_id": 54446008, "comment_id": 95757793, "body": "Hi 0m3r, for initial question, it works fine with the changes made according to macroprod. Please, can you help me with my other issue? Thanks"}, {"owner": {"reputation": 27, "user_id": 10617739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1574acc67062a036247b30ce0e162a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fane", "link": "https://stackoverflow.com/users/10617739/fane"}, "edited": false, "score": 0, "creation_date": 1549010264, "post_id": 54446008, "comment_id": 95758551, "body": "Sorry, I&#39;m not allowed, only after 3 day, this is the message I receive when I want to post new question :("}, {"owner": {"reputation": 27, "user_id": 10617739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1574acc67062a036247b30ce0e162a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fane", "link": "https://stackoverflow.com/users/10617739/fane"}, "edited": false, "score": 0, "creation_date": 1549011672, "post_id": 54446008, "comment_id": 95759256, "body": "I&#39;m new to this, can u be more explicit where do I insert this code, before which line in my initial code? Pls"}, {"owner": {"reputation": 27, "user_id": 10617739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1574acc67062a036247b30ce0e162a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fane", "link": "https://stackoverflow.com/users/10617739/fane"}, "edited": false, "score": 0, "creation_date": 1549013380, "post_id": 54446008, "comment_id": 95760161, "body": "I&#39;ve inserted the lines before my initial macro line &quot;On Error Resume Next&quot;, I&#39;ve rune the macro with F8, but it doesn&#39;t brig back nothing into line .TO=&quot; &quot;"}, {"owner": {"reputation": 27, "user_id": 10617739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1574acc67062a036247b30ce0e162a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fane", "link": "https://stackoverflow.com/users/10617739/fane"}, "edited": false, "score": 0, "creation_date": 1549013769, "post_id": 54446008, "comment_id": 95760334, "body": "Ok, inserted new macro accordingly, it creates the email BUT without firestname.secondname, brings back only @email.com"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 27, "user_id": 10617739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1574acc67062a036247b30ce0e162a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fane", "link": "https://stackoverflow.com/users/10617739/fane"}, "edited": false, "score": 0, "creation_date": 1549014597, "post_id": 54446008, "comment_id": 95760794, "body": "@Fane does the document has author name?"}, {"owner": {"reputation": 27, "user_id": 10617739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1574acc67062a036247b30ce0e162a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fane", "link": "https://stackoverflow.com/users/10617739/fane"}, "edited": false, "score": 1, "creation_date": 1549016449, "post_id": 54446008, "comment_id": 95761750, "body": "Yes! With little tweaks it works wonderful! Thank you so much for helping me!! Your input and feedback was excellent!"}, {"owner": {"reputation": 27, "user_id": 10617739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1574acc67062a036247b30ce0e162a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fane", "link": "https://stackoverflow.com/users/10617739/fane"}, "edited": false, "score": 0, "creation_date": 1549017120, "post_id": 54446008, "comment_id": 95762125, "body": "One last thing, if I want this Active document.docx (opened) to be converted to .pdf and attached into this replied mail to Author?"}, {"owner": {"reputation": 27, "user_id": 10617739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1574acc67062a036247b30ce0e162a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fane", "link": "https://stackoverflow.com/users/10617739/fane"}, "edited": false, "score": 0, "creation_date": 1549031147, "post_id": 54446008, "comment_id": 95769831, "body": "I managed to insert some lines of code with which exports active doc to .pdf with same name, but doesn&#39;t attach it tot the body, and also to keep the HTML signature. Attached the new code above, initial post. Tks"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": -1, "last_activity_date": 1549233136, "last_edit_date": 1549233136, "creation_date": 1548868429, "answer_id": 54446008, "question_id": 54442521, "link": "https://stackoverflow.com/questions/54442521/add-file-name-to-email-subject-line-and-send-email-to-the-last-modified-by-autho/54446008#54446008", "title": "Add file name to email subject line and send email to the Last modified by/Author", "body": "<p><em>Should be.</em> </p>\n\n<pre><code>.Subject = ThisDocument.Name\n</code></pre>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/visio.document.name\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/visio.document.name</a></p>\n\n<p><em>If a document is not yet named, this property returns the document's temporary name</em></p>\n\n<hr>\n\n<p><strong>Edit</strong></p>\n\n<p><strong>Per Comment below</strong></p>\n\n<p><em>Example</em></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim LastAuthor As String\n        LastAuthor = ActiveDocument.BuiltInDocumentProperties(\"last Author\")\n\n        Debug.Print LastAuthor ' Print on Immediat Window, Crtl-G\n\n        Dim Email As String\n            Email = Replace(LastAuthor, \" \", \".\") &amp; \"@email.com\"\n\n        Debug.Print Email ' Print on Immediat Window, Crtl-G\n\nEnd Sub\n</code></pre>\n\n<p><em><a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.office.tools.excel.workbook.builtindocumentproperties?view=vsto-2017\" rel=\"nofollow noreferrer\">BuiltinDocumentProperties Property</a></em> </p>\n\n<p><em>This property returns the entire collection of built-in document properties</em></p>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1548884065, "creation_date": 1548884065, "answer_id": 54449892, "question_id": 54442521, "link": "https://stackoverflow.com/questions/54442521/add-file-name-to-email-subject-line-and-send-email-to-the-last-modified-by-autho/54449892#54449892", "title": "Add file name to email subject line and send email to the Last modified by/Author", "body": "<p>Use:</p>\n\n<pre><code>.Subject = ActiveDocument.Name\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10617739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1574acc67062a036247b30ce0e162a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Fane", "link": "https://stackoverflow.com/users/10617739/fane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "accepted_answer_id": 54446008, "answer_count": 2, "score": 1, "last_activity_date": 1582953763, "creation_date": 1548857467, "last_edit_date": 1582953763, "question_id": 54442521, "link": "https://stackoverflow.com/questions/54442521/add-file-name-to-email-subject-line-and-send-email-to-the-last-modified-by-autho", "title": "Add file name to email subject line and send email to the Last modified by/Author", "body": "<p>I have a Word document in which I placed a <code>CommandButton</code> on the document so that the user can send an Outlook email with a message, but I want the Subject of the email to be the name of the opened active Word document, so the Subject to be variable depending on the name of active document and email to the Author of that active doc Wd. </p>\n\n<p>To identify the Last modified by/Author name and based on that name convert it into firstname.secondname@xyz.ro? The Author will send an email to his superior, and that doc Wd will be reviewed by this person via that <code>CommandButton</code>.</p>\n\n<pre><code>Public Sub Mail()\n    Dim LastAuthor As String\n        LastAuthor = ActiveDocument.BuiltInDocumentProperties(\"last Author\")\n\n        Dim Email As String\n            Email = Replace(LastAuthor, \" \", \".\") &amp; \"@btrl.ro\"\n\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n        .Display\n        .Signature = \"HTMLbody\"\n        .To = Email\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = ActiveDocument.Name\n        '.Body = \"AVIZAT. Multumesc mult\"\n        '.Attachments.Add ActiveDocument.FullName\n        ' You can add other files by uncommenting the following line.\n        '.Attachments.Add (\"C:\\test.txt\")\n        ' In place of the following statement, you can use \".Display\" to\n        ' display the mail.\n        .HTMLbody = \"AVIZAT\" &amp; \"&lt;br&gt;\" &amp; .HTMLbody\n\n        Dim objDoc As Document\n        Set objDoc = ActiveDocument\n        objDoc.ExportAsFixedFormat _\n        OutputFileName:=Replace(objDoc.FullName, \".docx\", \".pdf\"), _\n        ExportFormat:=wdExportFormatPDF, OpenAfterExport:=False, OptimizeFor:=wdExportOptimizeForPrint, _\n        Range:=wdExportAllDocument, Item:=wdExportDocumentContent\n        ' Add the attachment first for correct attachment's name with non English symbols\n        .Attachments.Add PdfFile.FullName\n\n        .send\n        MsgBox \"E-mail trimis cu succes\"\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548857065, "post_id": 54442295, "comment_id": 95693816, "body": "<a href=\"http://idownvotedbecau.se/imageofcode\" rel=\"nofollow noreferrer\">An image of your code is not helpful</a> You might benefit from reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1548857321, "post_id": 54442295, "comment_id": 95694001, "body": "A quick search on here, see <a href=\"https://stackoverflow.com/q/27225857/4961700\">stackoverflow.com/q/27225857/4961700</a>  not saying it is the &quot;perfect&quot; answer, but should help..."}, {"owner": {"reputation": 53, "user_id": 10929101, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nTbRBspu6mI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZryBNd7voCgat3OQ2F3DFENVYezA/mo/photo.jpg?sz=128", "display_name": "Evan West", "link": "https://stackoverflow.com/users/10929101/evan-west"}, "edited": false, "score": 0, "creation_date": 1548857597, "post_id": 54442295, "comment_id": 95694169, "body": "Added code, I also have been searching for a while but wasn&#39;t able to get anything to work, hence why im asking."}, {"owner": {"reputation": 53, "user_id": 10929101, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nTbRBspu6mI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZryBNd7voCgat3OQ2F3DFENVYezA/mo/photo.jpg?sz=128", "display_name": "Evan West", "link": "https://stackoverflow.com/users/10929101/evan-west"}, "edited": false, "score": 0, "creation_date": 1548857737, "post_id": 54442295, "comment_id": 95694262, "body": "In addition to that im very new to this and do not understand very well what is going on in the thread linked"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10929101, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nTbRBspu6mI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZryBNd7voCgat3OQ2F3DFENVYezA/mo/photo.jpg?sz=128", "display_name": "Evan West", "link": "https://stackoverflow.com/users/10929101/evan-west"}, "edited": false, "score": 0, "creation_date": 1548860776, "post_id": 54443140, "comment_id": 95696344, "body": "Thank you, this was very helpful and solved my issue."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1548860669, "last_edit_date": 1548860669, "creation_date": 1548859341, "answer_id": 54443140, "question_id": 54442295, "link": "https://stackoverflow.com/questions/54442295/determining-the-last-cell-in-a-specific-range-and-filling-it-vba/54443140#54443140", "title": "Determining the last cell in a specific range and filling it, VBA", "body": "<p>To find the next free row in range <code>C82:F91</code> use something like the follwing so you don't need to loop.</p>\n\n<pre><code>Dim rng As Range\nSet rng = Worksheets(\"Monthly Status\").Range(\"C82:F91\")\n\nDim NextFreeRow As Long\nWith rng.Cells(rng.Rows.Count, 1)\n    If .Value = vbNullString Then 'test if range is full\n        NextFreeRow = .End(xlUp).Row + 1 'find next free row\n    Else\n        MsgBox \"range is full\"\n        Exit Sub\n    End If\nEnd With\n\n'add +1 to the previous value\nWorksheets(\"Monthly Status\").Cells(NextFreeRow, \"C\").Value = Worksheets(\"Monthly Status\").Cells(NextFreeRow - 1, \"C\").Value + 1\n</code></pre>\n\n<p>This example should help you to solve your issue.</p>\n"}], "owner": {"reputation": 53, "user_id": 10929101, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nTbRBspu6mI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZryBNd7voCgat3OQ2F3DFENVYezA/mo/photo.jpg?sz=128", "display_name": "Evan West", "link": "https://stackoverflow.com/users/10929101/evan-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 54443140, "answer_count": 1, "score": -4, "last_activity_date": 1548860669, "creation_date": 1548856734, "last_edit_date": 1548858780, "question_id": 54442295, "link": "https://stackoverflow.com/questions/54442295/determining-the-last-cell-in-a-specific-range-and-filling-it-vba", "title": "Determining the last cell in a specific range and filling it, VBA", "body": "<p>So I need to determine the first empty cell in each of the ranges \"Revision Level\" (\"C82:F91\"), \"Date of Revision\" (\"G82:G91\"), and \"Comments or Notes for Revision\"(\"H82:R91\"), and fill it with the correct information. For \"revlvl\" I need it to just add one to the previous value, the other information I know how to calculate. </p>\n\n<p>So what it needs to do here is on the line down from the 000 rev level it would put 001 in Revision level, todays date in  Date of revision, and the text input into the inputbox into comments and notes. Then if the loop is ran again it would put in 003, date, and notes in the 3rd line down. </p>\n\n<p>There are other references in the loop because it is comparing dates in two charts above, they work properly and dont need to be changed. The parts in question are highlighted, currently the locations are hard coded. </p>\n\n<p><a href=\"https://i.stack.imgur.com/iVrtE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iVrtE.png\" alt=\"This is the sheet im working with and the ranges\"></a> </p>\n\n<p><a href=\"https://i.stack.imgur.com/GCKn0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GCKn0.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>If Sheets(\"Monthly Status\").Range(\"G82\") = \"\" Then\n'do nothing\nElse\n\n    Dim i As Integer\n    Dim Revnotes As Range\n    Dim RevDate As Range\n    Dim revlvl As Range\n\n    Set Revnotes = Sheets(\"Monthly Status\").Range(\"H83:R83\")\n    Set RevDate = Sheets(\"Monthly Status\").Range(\"G83\")\n    Set revlvl = Sheets(\"Monthly Status\").Range(\"C83:F91\")\n\n    For i = 0 To 49\n\n    cRow = i + 23\n\n        For j = 0 To 2\n\n                If Sheets(\"Monthly Status\").Cells(cRow, j + 11) &lt;&gt; Sheets(\"Monthly Status\").Cells(cRow, j + 37) Then\n                    RevDate = Date\n                    Revnotes = InputBox(\"You Changed dates, you must imput notes for this revison!\", \"Notes\")\n                    revlvl = Sheets(\"Monthly Status\").Range(\"C83\") + 1\n\n                        Application.ScreenUpdating = False\n\n                        Sheets(\"Monthly Status\").Range(\"K23:M72\").Copy\n                        Sheets(\"Monthly Status\").Range(\"AK23:AM72\").PasteSpecial xlPasteValues\n\n                        Application.ScreenUpdating = True\n\n                    End\n                End If\n            Next j\n        Next i\n\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 10990482, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YVIcmj_1UxQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMH3LFwJg0ecjXdqp1JzLBtuC0tdg/mo/photo.jpg?sz=128", "display_name": "Mayokun ", "link": "https://stackoverflow.com/users/10990482/mayokun"}, "edited": false, "score": 0, "creation_date": 1548855666, "post_id": 54441912, "comment_id": 95692940, "body": "please note the summary sheet is in the same workbook"}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1548856248, "post_id": 54441912, "comment_id": 95693283, "body": "welcome!  Have you tried searching past vba questions?  <a href=\"https://stackoverflow.com/questions/1895616/how-to-get-the-excel-file-name-path-in-vba\">This looks like it will help</a>"}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1548856406, "post_id": 54442089, "comment_id": 95693377, "body": "and the <code>$</code> to return a string value :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1548856798, "post_id": 54442089, "comment_id": 95693656, "body": "@JvdV actually yes, but Excel is so dump, that it if the result of <code>Left$</code> is actually numeric like <code>0123456</code> it will automatically cast the string <code>Left$(&quot;0123456AAAA&quot;, 7)</code> back to a number even if I use <code>Left$</code>. So in that case the cell value will be numeric <code>123456</code> anyway :( and the <code>$</code> has no effect to the cell."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1548857244, "post_id": 54442089, "comment_id": 95693963, "body": "@Peh, interesting! So would <code>ThisWorkbook.Worksheet(&quot;Summary&quot;).Range(&quot;G2:G6&quot;).Value = CStr(Left$(ThisWorkbook.Name, 7))</code> work?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1548857604, "post_id": 54442089, "comment_id": 95694171, "body": "@JvdV obviously not. Excel also casts this string into a number. <code>.Text</code> does also not work on a multi cell range so the only solution is <code>Range(&quot;G2:G6&quot;).NumberFormat = &quot;@&quot;</code> before inserting the values. Otherwise numbers as string always automatically cast into numbers."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1548857811, "post_id": 54442089, "comment_id": 95694308, "body": "@Peh, bummer! I guess in that case one can also resort to the <code>&quot;&#39;&quot;</code>tactics. <code>ThisWorkbook.Worksheet(&quot;Summary&quot;).Range(&quot;G2:G6&quot;).Value = &quot;&#39;&quot; &amp; Left$(ThisWorkbook.Name, 7)</code>"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1548856151, "creation_date": 1548856151, "answer_id": 54442089, "question_id": 54441912, "link": "https://stackoverflow.com/questions/54441912/is-there-a-way-i-can-copy-the-first-characters-of-an-excel-filename-and-paste-it/54442089#54442089", "title": "is there a way i can copy the first characters of an excel filename and paste it in the worksheet?", "body": "<ul>\n<li>Use <code>ThisWorkbook.Name</code> to get the workbook name.</li>\n<li>Use the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/left-function\" rel=\"nofollow noreferrer\">Left function</a> to get the left 7 characters of that name</li>\n<li><p>Write it to the range in your desired worksheet</p>\n\n<pre><code>ThisWorkbook.Worksheet(\"Summary\").Range(\"G2:G6\").Value = Left$(ThisWorkbook.Name, 7)\n</code></pre></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 3, "user_id": 10990482, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YVIcmj_1UxQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMH3LFwJg0ecjXdqp1JzLBtuC0tdg/mo/photo.jpg?sz=128", "display_name": "Mayokun ", "link": "https://stackoverflow.com/users/10990482/mayokun"}, "edited": false, "score": 0, "creation_date": 1548856840, "post_id": 54442147, "comment_id": 95693683, "body": "Glad to hear that."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 3, "user_id": 10990482, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YVIcmj_1UxQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMH3LFwJg0ecjXdqp1JzLBtuC0tdg/mo/photo.jpg?sz=128", "display_name": "Mayokun ", "link": "https://stackoverflow.com/users/10990482/mayokun"}, "edited": false, "score": 0, "creation_date": 1548858926, "post_id": 54442147, "comment_id": 95695063, "body": "@Mayokun, if you feel your question has been answered, than please mark this as such!"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1548856303, "creation_date": 1548856303, "answer_id": 54442147, "question_id": 54441912, "link": "https://stackoverflow.com/questions/54441912/is-there-a-way-i-can-copy-the-first-characters-of-an-excel-filename-and-paste-it/54442147#54442147", "title": "is there a way i can copy the first characters of an excel filename and paste it in the worksheet?", "body": "<pre><code>Option Explicit\n\nSub Test()\n\n    Dim strName As String\n    Dim wsSummary As Worksheet\n\n    With ThisWorkbook\n\n        Set wsSummary = .Worksheets(\"Summary\")\n\n        strName = Left(.Name, 7)\n\n        wsSummary.Range(\"G2:G6\").Value = strName\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10990482, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YVIcmj_1UxQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMH3LFwJg0ecjXdqp1JzLBtuC0tdg/mo/photo.jpg?sz=128", "display_name": "Mayokun ", "link": "https://stackoverflow.com/users/10990482/mayokun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 54442147, "answer_count": 2, "score": -2, "last_activity_date": 1548856303, "creation_date": 1548855596, "last_edit_date": 1548856028, "question_id": 54441912, "link": "https://stackoverflow.com/questions/54441912/is-there-a-way-i-can-copy-the-first-characters-of-an-excel-filename-and-paste-it", "title": "is there a way i can copy the first characters of an excel filename and paste it in the worksheet?", "body": "<p>i want to copy the the first 7 characters of my excel file name into a column in my summary sheet. my file name typically goes  something like \"PR_0001_nil_officer.xls\". i want to copy the \"PR_0001\" and paste it in column range G2:G6 of my worksheet. Also Im very new to VBA so which makes this seemingly simple task more complex to me lol</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1548855916, "post_id": 54441838, "comment_id": 95693086, "body": "I don&#39;t understand when &quot;sometimes&quot; is, and what you mean by &quot;pages&quot;. Please clarify in your post"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1548856164, "post_id": 54441838, "comment_id": 95693233, "body": "Loop through your sheets and see if name <code>Like &quot;*(2)&quot;</code> to check if pages have been replicated. That&#39;s the answer to your last sentence. Rest of your question is unclear."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1548856606, "post_id": 54441838, "comment_id": 95693524, "body": "I&#39;d disagree, that merely shows whether a file exists with a name ending on <code>(2)</code>. This is not unlikely to result in a false positive. A better way would be to check if a sheet name exists more than once, using wildcards."}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1548856714, "creation_date": 1548856714, "answer_id": 54442288, "question_id": 54441838, "link": "https://stackoverflow.com/questions/54441838/how-to-print-a-duplicated-sheet-with-vba/54442288#54442288", "title": "How to print a duplicated sheet with VBA?", "body": "<p>If you copy a sheet, it gets automatically the <em>active</em> sheet. Assign this to a variable, after that you can do whatever you want:</p>\n\n<pre><code>Dim oldWs As Worksheet\nSet oldWs = ThisWorkbook.Sheets(\"DB_Main\")\noldWs.Copy After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\nDim newWs As Worksheet\nSet newWs = ActiveSheet\n' Rename the sheet if you want\nnewWs.Name = \"I am brand new\"\n' Print out old Main and copy\nwb.Worksheets(Array(oldWs.Name, newWs.Name)).PrintOut\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6886470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee876d28f5fab2da185ce5c983e3254?s=128&d=identicon&r=PG&f=1", "display_name": "Savvas Antoniou", "link": "https://stackoverflow.com/users/6886470/savvas-antoniou"}, "is_accepted": false, "score": 0, "last_activity_date": 1548874702, "creation_date": 1548874702, "answer_id": 54447723, "question_id": 54441838, "link": "https://stackoverflow.com/questions/54441838/how-to-print-a-duplicated-sheet-with-vba/54447723#54447723", "title": "How to print a duplicated sheet with VBA?", "body": "<p>I try to loop all sheets and compare the cell A1 if its equal to 1.\nIts work like that.</p>\n\n<pre><code>Private Sub CommandButton6_Click()\nDim allshts As Worksheet\nFor Each allshts In ActiveWorkbook.Worksheets\nIf allshts .Range(\"A1\").Value = 1 Then\nallshts .PrintOut From:=1, To:=1\nEnd If\nNext allshts \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6886470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ee876d28f5fab2da185ce5c983e3254?s=128&d=identicon&r=PG&f=1", "display_name": "Savvas Antoniou", "link": "https://stackoverflow.com/users/6886470/savvas-antoniou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548874702, "creation_date": 1548855340, "last_edit_date": 1548856256, "question_id": 54441838, "link": "https://stackoverflow.com/questions/54441838/how-to-print-a-duplicated-sheet-with-vba", "title": "How to print a duplicated sheet with VBA?", "body": "<p>When I use the code below</p>\n\n<pre><code>ThisWorkbook.Sheets(\"DB_Main\").Copy _\nAfter:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n</code></pre>\n\n<p>I end up with a new sheet named <code>DB_Main (2)</code></p>\n\n<p>I am looking for a way to print these 2 sheets from my \"Main\" sheet using a button.\nFrom sheet <code>DB_Main</code>the pages 4 and 5, and from sheet <code>DB_Main (2)</code>the pages 4,5,6 and 7.</p>\n\n<p>How can I detect a copied sheet?\nAny ideas how to get this to work?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1548854995, "post_id": 54441728, "comment_id": 95692540, "body": "Don&#39;t anthropomorphize VBA."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548855936, "post_id": 54441728, "comment_id": 95693098, "body": "Office 2007 exceeded extended support in 2017 already. Update to a more recent version."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548856446, "post_id": 54441728, "comment_id": 95693405, "body": "On your old machine did you have an older version of Office installed? say 2003?"}, {"owner": {"reputation": 39, "user_id": 6474754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae30e5476f9fa44e48062bd6904aa8a5?s=128&d=identicon&r=PG&f=1", "display_name": "John L", "link": "https://stackoverflow.com/users/6474754/john-l"}, "edited": false, "score": 0, "creation_date": 1548857065, "post_id": 54441728, "comment_id": 95693815, "body": "IAmNerd2000: No - the old machine was not that old!"}, {"owner": {"reputation": 39, "user_id": 6474754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae30e5476f9fa44e48062bd6904aa8a5?s=128&d=identicon&r=PG&f=1", "display_name": "John L", "link": "https://stackoverflow.com/users/6474754/john-l"}, "edited": false, "score": 0, "creation_date": 1548857124, "post_id": 54441728, "comment_id": 95693872, "body": "Peh - I know. I am checking out 2019 for compatibility with my solutions."}, {"owner": {"reputation": 39, "user_id": 6474754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae30e5476f9fa44e48062bd6904aa8a5?s=128&d=identicon&r=PG&f=1", "display_name": "John L", "link": "https://stackoverflow.com/users/6474754/john-l"}, "edited": false, "score": 0, "creation_date": 1548857239, "post_id": 54441728, "comment_id": 95693959, "body": "rory ap - attribute human characteristics or behavior to (a god, animal, or object). &quot;people&#39;s tendency to anthropomorphize their dogs&quot; ???"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548857303, "post_id": 54441728, "comment_id": 95693992, "body": "@JohnL So make it compatible to the new version then. Put your effort in updating your code to the new version instead of trying to fix a dying software. You will run into issues with your old Excel soon or later anyway. Then you have wasted your time."}, {"owner": {"reputation": 39, "user_id": 6474754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae30e5476f9fa44e48062bd6904aa8a5?s=128&d=identicon&r=PG&f=1", "display_name": "John L", "link": "https://stackoverflow.com/users/6474754/john-l"}, "edited": false, "score": 0, "creation_date": 1548857410, "post_id": 54441728, "comment_id": 95694050, "body": "Peh (2) That&#39;s my plan."}], "owner": {"reputation": 39, "user_id": 6474754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae30e5476f9fa44e48062bd6904aa8a5?s=128&d=identicon&r=PG&f=1", "display_name": "John L", "link": "https://stackoverflow.com/users/6474754/john-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548855577, "creation_date": 1548854954, "last_edit_date": 1548855577, "question_id": 54441728, "link": "https://stackoverflow.com/questions/54441728/vba-refuses-to-launch", "title": "VBA refuses to launch", "body": "<p>I have several Excel 2007 VBA solutions which have been running fine for years. In mid-December 2018 I got a new computer and installed Office 2007 and all was fine until about three days ago, when as soon as I tried to run a solution or enter the VBA or macro section under the developer tab, I get a message \"Unable to load VBE6EXT.OLB\", and then a message saying \"Out of memory\", but the Excel (non-VBA) part continues to function. I have tried every \"solution\" I found on the web, including uninstalling and reinstalling Office, checking the register for entries said be necessary (they were there - no problem), copying said file from its location in Program Files (x86) to same location in Program Files, checking that Office executables are all running under Windows 7 compatibility, and maybe more that I can't remember. Has anyone encountered this issue? I can't think of anything else to try!</p>\n"}, {"tags": ["excel", "vba", "auto-increment"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10974266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pdesNa_L5D4/AAAAAAAAAAI/AAAAAAAAJqE/ru5mWZ8ltYE/photo.jpg?sz=128", "display_name": "Fahad Nasif", "link": "https://stackoverflow.com/users/10974266/fahad-nasif"}, "edited": false, "score": 0, "creation_date": 1548912299, "post_id": 54441441, "comment_id": 95715879, "body": "Thank you so much for the help, your code works perfectly if I change the value manually but when I apply vlookup function on column &quot;E&quot; then the moves are not counted in column F. Is there any way to count when vlookup is applied on column E."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1548855854, "last_edit_date": 1548855854, "creation_date": 1548853917, "answer_id": 54441441, "question_id": 54440938, "link": "https://stackoverflow.com/questions/54440938/maintain-count-of-each-change-to-cell-value/54441441#54441441", "title": "Maintain count of each change to cell value", "body": "<p>Consider:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Static OldVal(2 To 709) As Variant\n    Dim E As Range, F As Range, r As Range, Intersekt As Range\n    Dim rw As Long\n\n    Set E = Range(\"E2:E709\")\n    Set F = Range(\"F2:F709\")\n\n    Set Intersekt = Intersect(E, Target)\n    If Intersekt Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False\n        For Each r In Intersekt\n            rw = r.Row\n            If r.Value &lt;&gt; OldVal(rw) Then\n                r.Offset(0, 1).Value = r.Offset(0, 1).Value + 1\n                OldVal(rw) = r.Value\n            End If\n        Next r\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>We use an <strong>array</strong> for <code>OldVal</code> rather than a <strong>single item</strong>.<br>We use a <em>(potentially)</em> multi-cell <code>Intersekt</code>Range` to facilitate changing more than one cell at a time.</p>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1548853950, "creation_date": 1548853950, "answer_id": 54441451, "question_id": 54440938, "link": "https://stackoverflow.com/questions/54440938/maintain-count-of-each-change-to-cell-value/54441451#54441451", "title": "Maintain count of each change to cell value", "body": "<p>Try code below:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    ' If change was outside range we are interested in, then quit Sub\n    If Intersect(Target, Range(\"E2:E709\")) Is Nothing Then Exit Sub\n\n   ' store reference to cell in F column for simplicity\n    Dim c As Range: Set c = Target.Offset(0, 1)\n    ' check if cell in F column has any value, if not, then assign it 1\n    If c.Value = \"\" Then\n        c.Value = 1\n    ' else increment it by one\n    Else\n        c.Value = c.Value + 1\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10974266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pdesNa_L5D4/AAAAAAAAAAI/AAAAAAAAJqE/ru5mWZ8ltYE/photo.jpg?sz=128", "display_name": "Fahad Nasif", "link": "https://stackoverflow.com/users/10974266/fahad-nasif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548855854, "creation_date": 1548852200, "last_edit_date": 1548855627, "question_id": 54440938, "link": "https://stackoverflow.com/questions/54440938/maintain-count-of-each-change-to-cell-value", "title": "Maintain count of each change to cell value", "body": "<p>Suppose I have a value in cell A1 and everytime the cell value of <code>A1</code> changes, the cell on b1 counts the change. </p>\n\n<p>I have a code it works just with A1(value)cell and b1(count on change) cell. i would like to apply this function on cell <code>E2:E709</code> (value) cells and <code>F2:F709</code> (count on change) cell. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nStatic OldVal As Variant\nIf Target.Address(False, False) = \"A1\" Then\nApplication.EnableEvents = False\nIf Target.Value &lt;&gt; OldVal Then\n    Target.Offset(, 1).Value = Target.Offset(, 1).Value + 1\n    OldVal = Target.Value\nEnd If\nApplication.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1548848830, "post_id": 54439817, "comment_id": 95688928, "body": "Do you have any code for us to assist with?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 3, "creation_date": 1548850263, "post_id": 54439817, "comment_id": 95689777, "body": "Yes. It&#39;s possible. It takes a little figuring how to do it though. Did you know that 80% of programming is in preparation? At this site we will help you with the encoding, the last 20% - and that only after you tried yourself."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1548855311, "post_id": 54439817, "comment_id": 95692733, "body": "@Variatus it is a bit more complicatet then it looks like if you have a look at the duplicated <code>AAA-S</code> and <code>AAA-T</code> values. So it took a bit more then a <i>&quot;little figuring&quot;</i> to solve this."}], "answers": [{"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1549416779, "post_id": 54441388, "comment_id": 95891647, "body": "Nice one PEH.  Yeah, at a quick glance, it looks pretty simple, but when you stop and see what&#39;s really going on, this is actually a bit challenging."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1548855422, "last_edit_date": 1548855422, "creation_date": 1548853759, "answer_id": 54441388, "question_id": 54439817, "link": "https://stackoverflow.com/questions/54439817/transpose-data-in-excel-based-on-number-of-rows-using-vba/54441388#54441388", "title": "Transpose data in Excel based on number of rows using VBA", "body": "<p><em>I poste an answer, because this is obviously not as trivial as it looks like.</em> </p>\n\n<p>The tricky part here is that the headers <code>AAA</code> and footers <code>ZZZ</code> are occuring only once while the data <code>BBB</code> can have multiple lines. So if the data <code>BBB</code> is more than 1 line we also need to expand the headers and footers to the amount of data lines to get the OP's desired output.</p>\n\n<p>My solution will not care about how the header, footer and data values are. It just assumes the following structure:</p>\n\n<ul>\n<li><code>1</code> line header e.g. <code>AAA</code></li>\n<li><code>n</code> lines data e.g. <code>BBB</code></li>\n<li><code>1</code> line footer e.g. <code>ZZZ</code></li>\n</ul>\n\n<p>If the raw data follows this structure the code works.</p>\n\n<p>This solution will read data from your sheet <code>Data</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/OZ2d0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OZ2d0.png\" alt=\"enter image description here\"></a></p>\n\n<p>and write it to the sheet <code>Output</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/Dx5FS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dx5FS.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nPublic Sub ReorganizeData()\n    Dim wsData As Worksheet 'data sheet\n    Set wsData = ThisWorkbook.Worksheets(\"Data\")\n\n    Dim wsOutput As Worksheet 'output sheet\n    Set wsOutput = ThisWorkbook.Worksheets(\"Output\")\n\n    Dim Lastrow As Long 'find the end of the data\n    Lastrow = wsData.Cells(wsData.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim iRowOutput As Long\n    iRowOutput = 1 'this is where the output starts\n\n    Dim HeaderRow As Long\n    Dim StartRow As Long\n    Dim EndRow As Long\n    Dim FooterRow As Long\n\n    Dim iRow As Long\n    For iRow = 2 To Lastrow 'loop throug data\n        If HeaderRow = 0 Then\n            HeaderRow = iRow 'remember header row\n        ElseIf StartRow = 0 Then\n            StartRow = iRow 'remember where data BBB starts\n        ElseIf Not wsData.Cells(iRow, \"A\").Value = wsData.Cells(iRow - 1, \"A\").Value Then\n            EndRow = iRow - 1 'remeber where BBB ended\n            FooterRow = iRow 'remember footer row\n\n            'copy data to output sheet\n            wsOutput.Cells(iRowOutput, \"A\").Resize(RowSize:=EndRow - StartRow + 1, ColumnSize:=2).Value = wsData.Cells(HeaderRow, \"A\").Resize(ColumnSize:=2).Value\n            wsOutput.Cells(iRowOutput, \"C\").Resize(RowSize:=EndRow - StartRow + 1, ColumnSize:=2).Value = wsData.Cells(StartRow, \"A\").Resize(RowSize:=EndRow - StartRow + 1, ColumnSize:=2).Value\n            wsOutput.Cells(iRowOutput, \"E\").Resize(RowSize:=EndRow - StartRow + 1, ColumnSize:=2).Value = wsData.Cells(FooterRow, \"A\").Resize(ColumnSize:=2).Value\n\n            'calculate new output row\n            iRowOutput = iRowOutput + EndRow - StartRow + 1\n\n            'reset row finder variables\n            HeaderRow = 0\n            StartRow = 0\n            EndRow = 0\n            FooterRow = 0\n        End If\n    Next iRow\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 843, "user_id": 1936588, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/22a788eff656461afb21f08e3c3a815c?s=128&d=identicon&r=PG", "display_name": "bd528", "link": "https://stackoverflow.com/users/1936588/bd528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 54441388, "answer_count": 1, "score": -2, "last_activity_date": 1548871643, "creation_date": 1548848477, "last_edit_date": 1548851663, "question_id": 54439817, "link": "https://stackoverflow.com/questions/54439817/transpose-data-in-excel-based-on-number-of-rows-using-vba", "title": "Transpose data in Excel based on number of rows using VBA", "body": "<p>I have the following sample data in Excel :-</p>\n\n<pre><code>Type    Reference  \nAAA     R  \nBBB     A  \nZZZ     R  \nAAA     S  \nBBB     A  \nBBB     A  \nZZZ     S  \nAAA     T  \nBBB     A  \nBBB     A  \nZZZ     T  \nAAA     U  \nBBB     A  \nZZZ     U  \n</code></pre>\n\n<p>Type AAA is a header, and ZZZ is a footer.</p>\n\n<p>I'd like to know if, using VBA, it is possible to output this sample data as such :-</p>\n\n<pre><code>AAA R   BBB A   ZZZ R  \nAAA S   BBB A   ZZZ S  \nAAA S   BBB A   ZZZ S  \nAAA T   BBB A   ZZZ T  \nAAA T   BBB A   ZZZ T  \nAAA U   BBB A   ZZZ U\n</code></pre>\n\n<p>The logic being that the number of transposed rows for each header to footer group should equal the number of BBB rows between the header and footer</p>\n"}, {"tags": ["excel", "vba", "pivot"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1548847235, "post_id": 54439320, "comment_id": 95688003, "body": "How about changing all cells necessary to date fields before proceeding with the pivot table, would that be a possibility?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548848295, "post_id": 54439320, "comment_id": 95688606, "body": "Can you show what values are going in causing the errors please?"}, {"owner": {"reputation": 85, "user_id": 7890335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155242848103276/picture?type=large", "display_name": "Craig Johnstone", "link": "https://stackoverflow.com/users/7890335/craig-johnstone"}, "edited": false, "score": 0, "creation_date": 1548850408, "post_id": 54439320, "comment_id": 95689851, "body": "values like &quot;N/A&quot; and &quot;TBC&quot; are causing the 1004 error."}, {"owner": {"reputation": 393, "user_id": 1197934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49888a0530e8444121435d2486107224?s=128&d=identicon&r=PG", "display_name": "fbueckert", "link": "https://stackoverflow.com/users/1197934/fbueckert"}, "edited": false, "score": 0, "creation_date": 1548857503, "post_id": 54439320, "comment_id": 95694118, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/54424922/filtering-pivot-table-by-cell-values-error-1004-vba\">Filtering Pivot table by cell values, error 1004 VBA</a>"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 7890335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155242848103276/picture?type=large", "display_name": "Craig Johnstone", "link": "https://stackoverflow.com/users/7890335/craig-johnstone"}, "edited": false, "score": 0, "creation_date": 1548855839, "post_id": 54441329, "comment_id": 95693052, "body": "hi @Variatus.  This code doesnt work as the Function GetDate only checks the start and end date that is a fixed cell value.. the issue is with the data being returned from .PivotFilters where it pulls the data in from the data source.. this is the sheet that requires checking each value."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 85, "user_id": 7890335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155242848103276/picture?type=large", "display_name": "Craig Johnstone", "link": "https://stackoverflow.com/users/7890335/craig-johnstone"}, "edited": false, "score": 0, "creation_date": 1548859330, "post_id": 54441329, "comment_id": 95695329, "body": "You can use the same function within a loop to check the source data."}, {"owner": {"reputation": 85, "user_id": 7890335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155242848103276/picture?type=large", "display_name": "Craig Johnstone", "link": "https://stackoverflow.com/users/7890335/craig-johnstone"}, "edited": false, "score": 0, "creation_date": 1548863483, "post_id": 54441329, "comment_id": 95698123, "body": "could you provide an example?"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1548900558, "last_edit_date": 1548900558, "creation_date": 1548853590, "answer_id": 54441329, "question_id": 54439320, "link": "https://stackoverflow.com/questions/54439320/filtering-pivot-table-vb-error-due-to-non-date-values/54441329#54441329", "title": "Filtering Pivot table VB error due to non date values", "body": "<p>The code below calls a function which will return Not True if the value retrieved from the Dispatch Template isn't a date, and that causes the row not to be processed. I have constructed it to perform in a loop but you will probably be able to adapt the methods for slightly different applications.</p>\n\n<pre><code>Private Sub CheckDate()\n\n    Dim Dstart As Variant                       ' invoice start date\n    Dim Dend As Variant\n\n    If GetDate(17, 6, Dstart) Then\n        If GetDate(17, 7, Dend) Then\n            With Worksheets(\"Despatch Template\").PivotTables(\"PivotTable1\")\n                .PivotCache.Refresh\n                ' does this field name really have a blank at its end?\n                With .PivotFields(\"DESPATCH Date \")\n                    .ClearAllFilters \"\"\n                    .PivotFilters.Add2 Type:=xlDateBetween, _\n                                       Value1:=Dstart, _\n                                       Value2:=Dend\n                End With\n            End With\n        End If\n    End If\nEnd Sub\n\nPrivate Function GetDate(R As Long, _\n                         Clm As Long, _\n                         Dat As Variant) As Boolean\n\n    Dat = Worksheets(\"Despatch Template\").Cells(R, Clm).Value\n    If IsDate(Dat) Then\n        Dat = CLng(Dat)\n        GetDate = True\n    End If\nEnd Function\n</code></pre>\n\n<p>The above code is untested.\nEdit 31/01/2019 =================\nThe code below will identify cells that don't contain a date. Instead of showing a message box you could take rectifying action.</p>\n\n<pre><code>Private Sub CorrectDates()\n\n    Const Clm As Long = 3               ' your dates column (3 = C)\n    Const FirstDataRow As Long = 2      ' presuming row 1 to hold captions\n\n    Dim Ws As Worksheet\n    Dim Dat As Variant\n    Dim Rl As Long                      ' last used row in column Clm\n    Dim R As Long\n\n    Set Ws = ActiveSheet                ' change as appropriate\n    With Ws\n        Rl = .Cells(.Rows.Count, Clm).End(xlUp).Row\n        For R = FirstDataRow To Rl\n            If Not GetDate(.Cells(R, Clm), Dat) Then\n                MsgBox \"Cell \" &amp; .Cells(R, Clm).Address &amp; \" is not a date.\" &amp; vbCr &amp; Dat\n            End If\n        Next R\n    End With\nEnd Sub\nPrivate Function GetDate(Cell As Range, _\n                         Dat As Variant) As Boolean\n\n    Dat = Cell.Value\n    If IsDate(Dat) Then\n        Dat = CLng(Dat)\n        GetDate = True\n    End If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 7890335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155242848103276/picture?type=large", "display_name": "Craig Johnstone", "link": "https://stackoverflow.com/users/7890335/craig-johnstone"}, "edited": false, "score": 0, "creation_date": 1548859299, "post_id": 54442716, "comment_id": 95695307, "body": "Do you have any examples of the <b>PivotItem.Visible</b> option?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 85, "user_id": 7890335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155242848103276/picture?type=large", "display_name": "Craig Johnstone", "link": "https://stackoverflow.com/users/7890335/craig-johnstone"}, "edited": false, "score": 0, "creation_date": 1548859586, "post_id": 54442716, "comment_id": 95695480, "body": "@CraigJohnstone Something like <code>Dim pItem AS PivotItem: For Each pItem In PivotTable(1).PivotFields(&quot;FieldName&quot;).PivotItems: pItem.Visible = Not IsDate(pItem.Value): Next pItem</code> to unselect all non-date values"}, {"owner": {"reputation": 85, "user_id": 7890335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155242848103276/picture?type=large", "display_name": "Craig Johnstone", "link": "https://stackoverflow.com/users/7890335/craig-johnstone"}, "edited": false, "score": 0, "creation_date": 1548863448, "post_id": 54442716, "comment_id": 95698093, "body": "thanks, but how do I get only the dates between the 2 entered values (invoice_Start_date and invoice_end_date) to show using this method?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 85, "user_id": 7890335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155242848103276/picture?type=large", "display_name": "Craig Johnstone", "link": "https://stackoverflow.com/users/7890335/craig-johnstone"}, "edited": false, "score": 0, "creation_date": 1548864346, "post_id": 54442716, "comment_id": 95698619, "body": "@CraigJohnstone Change the <code>pItem.Visible = Not IsDate(pItem.Value)</code> line.  You can use an <code>If</code> statement, or an <code>IIF</code> statement, or a <code>Select Case</code> statement, et cetera"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 0, "last_activity_date": 1548866275, "last_edit_date": 1548866275, "creation_date": 1548858085, "answer_id": 54442716, "question_id": 54439320, "link": "https://stackoverflow.com/questions/54439320/filtering-pivot-table-vb-error-due-to-non-date-values/54442716#54442716", "title": "Filtering Pivot table VB error due to non date values", "body": "<p>You can filter for <code>\"*\"</code> in your Source Data to find the non-date values, and use <code>WorksheetFunction.CountIf</code> with a criteria of <code>\"*\"</code> to check how many there are in the column.</p>\n\n<p>If it is more than 1 (the header) then you can display an error message, show the Source Data filtered for the invalid rows, and tell the user to fix it.</p>\n\n<p>If all else fails, loop through each <code>PivotItem</code> in the <code>PivotField</code>, and set the <code>PivotItem.Visible</code> value manually.  You may want to ensure that <code>PivotTable.ManualUpdate</code> is <code>True</code> while you do this, so that it does not try to recalculate the PivotTable for every item in the field.</p>\n\n<p>Example code:</p>\n\n<pre><code>Dim pTable AS PivotTable, pItem As PivotItem\n\nSet pTable = ActiveSheet.PivotTables(\"PivotTable1\")\n\npTable.ManualUpdate = True\n\npTable.PivotFields(\"DESPATCH DATE\").ClearAllFilters\nFor Each pItem In pTable.PivotFields(\"DESPATCH DATE\")\n    If IsDate(pItem.Value) Then\n        If pItem.Value &gt;= Invoice_Start_Date AND pItem.Value &lt;= Invoice_End_Date Then\n            pItem.Visible = True\n        Else\n            pItem.Visible = False\n        End If\n    Else\n        pItem.Visible = False\n    End If\nNext pItem\n\npTable.ManualUpdate = False\npTable.Update\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 7890335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155242848103276/picture?type=large", "display_name": "Craig Johnstone", "link": "https://stackoverflow.com/users/7890335/craig-johnstone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 54442716, "answer_count": 2, "score": 0, "last_activity_date": 1548900558, "creation_date": 1548846930, "question_id": 54439320, "link": "https://stackoverflow.com/questions/54439320/filtering-pivot-table-vb-error-due-to-non-date-values", "title": "Filtering Pivot table VB error due to non date values", "body": "<p>I have a Pivot table and a button to filter between 2 dates.  When I click the button I get an error <strong>1004 Application Defined or Object Defined error</strong></p>\n\n<p>I found the error was due to some non date values in the source cells on some rows.. when I change them to date values the code works correctly.  </p>\n\n<p>What I would like to know is there I way I can ignore these values, ie so non date values are ignored and not used in the filter?  Currently the error stops the macro from continuing.</p>\n\n<p>here's the code I have </p>\n\n<pre><code>Dim Invoice_Start_Date As Date\nDim Invoice_End_Date As Date\nInvoice_Start_Date = CDate(Worksheets(\"Despatch Template\").Cells(17, \"F\").Value)\nInvoice_End_Date = CDate(Worksheets(\"Despatch Template\").Cells(17, \"G\").Value)\nSheets(\"Despatch Template\").Select\n\nMsgBox IsDate(Invoice_End_Date)\nMsgBox IsDate(Invoice_Start_Date)\n\nActiveSheet.PivotTables(\"PivotTable1\").PivotCache.Refresh\nActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"DESPATCH \nDATE\").ClearAllFilters\nActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"DESPATCH \nDATE\").PivotFilters.Add2 _\nType:=xlDateBetween, Value1:=CLng(Invoice_Start_Date), \nValue2:=CLng(Invoice_End_Date)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1548847010, "post_id": 54439231, "comment_id": 95687871, "body": "(1) Autofilter or Find would be better than looping (2) Remove the On Error lines as they mask errors and do not appear to do anything anyway (3) If you are selecting only the last selection will show as you are looping through. What should happen that isn&#39;t? Selecting things anyway is usually unnecessary and inefficient."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1548847196, "post_id": 54439231, "comment_id": 95687967, "body": "I suppose the bottom line is what is the point of the selecting? The only real thing your code does is put something in column J. Why not use a formula?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548847414, "post_id": 54439231, "comment_id": 95688112, "body": "Use some of the functions available to you, such as <code>application.worksheetfunction.match(&quot;x&quot;</code>    also, may be worth thinking of X and x, you are only checking for lower case."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1548849420, "post_id": 54439231, "comment_id": 95689298, "body": "Please use the <a href=\"https://stackoverflow.com/posts/54439231/edit\">edit</a> link below the question to add information to it, rather than in comments. This goes for the picture link as well as the additional explanation. If you want to answer someone who has commented type a <code>@</code> followed by their name. This will put a message in the person&#39;s Inbox so that they see you&#39;ve replied."}, {"owner": {"reputation": 3, "user_id": 10695778, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2tRgUazdThg/AAAAAAAAAAI/AAAAAAAAALs/wPoFtAMl-uY/photo.jpg?sz=128", "display_name": "Shivansh Joshi", "link": "https://stackoverflow.com/users/10695778/shivansh-joshi"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1548878014, "post_id": 54439231, "comment_id": 95705866, "body": "@SJR Please see the updated post and guide me."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1548878669, "creation_date": 1548878669, "answer_id": 54448700, "question_id": 54439231, "link": "https://stackoverflow.com/questions/54439231/i-am-looking-for-a-code-that-selects-the-specified-range-in-a-row-where-column-a/54448700#54448700", "title": "I am looking for a code that selects the specified range in a row where column A has value of x", "body": "<p>jsheeran posted the bulk of this, but deleted his answer because it wasn't finished. </p>\n\n<p>As previously stated, there is probably no reason to select anything.</p>\n\n<pre><code>Sub Button3_Click()\n\nDim lRow As Long\nDim i As Long\nDim toDate As Date\nDim Sheets As Worksheet\nDim r1 As Range\n\nlRow = Cells(Rows.Count, 2).End(xlUp).Row\n\nFor i = 2 To lRow\n    If Cells(i, 1).Value = \"x\" Then\n        Set r1 = Union(IIf(r1 Is Nothing, Cells(i, 2).Resize(, 3), r1), Cells(i, 2).Resize(, 3))\n        Cells(i, 10).Value = \"Selected \" &amp; Date + Time\n    End If\nNext i\n\nIf Not r1 Is Nothing Then r1.Select\n\nActiveWorkbook.Save\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10695778, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2tRgUazdThg/AAAAAAAAAAI/AAAAAAAAALs/wPoFtAMl-uY/photo.jpg?sz=128", "display_name": "Shivansh Joshi", "link": "https://stackoverflow.com/users/10695778/shivansh-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 54448700, "answer_count": 1, "score": 0, "last_activity_date": 1548878669, "creation_date": 1548846637, "last_edit_date": 1548850575, "question_id": 54439231, "link": "https://stackoverflow.com/questions/54439231/i-am-looking-for-a-code-that-selects-the-specified-range-in-a-row-where-column-a", "title": "I am looking for a code that selects the specified range in a row where column A has value of x", "body": "<p><img src=\"https://i.stack.imgur.com/dNwWv.png\" alt=\"screenshot\">\nIdeally, what i need is to email the sepcified range rows with \"x\" in their column, i tried a code and it's working grand but the only problem is that it's sending 3 emails for 3 rows, but i want to send all the records in one email. I was able to do that using a vba code that converts the selected range in HTML and email it out. Now i want to automate the selection part.So basically i need to select the specified range of any row which have \"x\" in first column.</p>\n\n<p>I tried a code but it's only selecting the last row that contains \"x\".\nLink for the image showing what i am exactly looking for - <a href=\"https://imgur.com/a/Zq97ukL\" rel=\"nofollow noreferrer\">https://imgur.com/a/Zq97ukL</a></p>\n\n<pre><code>Sub Button3_Click()\nDim lRow As Integer\nDim i As Integer\nDim toDate As Date\nDim Sheets As Worksheet\nDim r1 As Range\n\nlRow = Cells(Rows.Count, 2).End(xlUp).Row\n\nFor i = 2 To lRow\n  If (Cells(i, 1)) = \"x\" Then  'change this range\n\n      Set r1 = Range(Cells(i, 2), Cells(i, 4))\n      r1.Select\n\n    On Error Resume Next\n\n    On Error GoTo 0\n    Cells(i, 10) = \"Selected \" &amp; Date + Time 'column J\nEnd If\nNext i\nActiveWorkbook.Save\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1548853924, "post_id": 54439187, "comment_id": 95691829, "body": "It looks like that using simple formula like:<code>=INDEX($I$15:$I$100000,ROW(A1)*3-3+COLUMN(A1),1)</code> in D9 and dragging it right and down should give exactly the same results."}], "answers": [{"tags": [], "owner": {"reputation": 586, "user_id": 9149934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ff11850461a5d4b495f04c3b895010?s=128&d=identicon&r=PG&f=1", "display_name": "earthling", "link": "https://stackoverflow.com/users/9149934/earthling"}, "is_accepted": false, "score": 0, "last_activity_date": 1548850250, "creation_date": 1548850250, "answer_id": 54440353, "question_id": 54439187, "link": "https://stackoverflow.com/questions/54439187/easy-loop-to-repeat-a-transpose-formula/54440353#54440353", "title": "Easy loop to repeat a transpose formula", "body": "<p>Try this:</p>\n\n<pre><code>    dim i as Integer\n    for i = 1 to 20 'adjust as you need it\n        Range(\"D\" &amp; i &amp; \":F\" &amp; i).FormulaArray = \"=TRANSPOSE(R[\" &amp; ?? &amp; \"]C[5]:R[\" &amp; ?? &amp; \"]C[5])\"\n    next i\n</code></pre>\n\n<p>I replaced the integer for yor transpose fuction with ??, I was nor sure what logic to apply.</p>\n"}], "owner": {"reputation": 11, "user_id": 10989810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a973229233b43a5687726ddfcd82fed?s=128&d=identicon&r=PG&f=1", "display_name": "LBOI", "link": "https://stackoverflow.com/users/10989810/lboi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548922885, "creation_date": 1548846501, "last_edit_date": 1548851704, "question_id": 54439187, "link": "https://stackoverflow.com/questions/54439187/easy-loop-to-repeat-a-transpose-formula", "title": "Easy loop to repeat a transpose formula", "body": "<p>I am trying to repeat the same formula over again for a column of data that I need to transpose. I have a macro which does the whole thing once. I have tried to create a simple loop, but I do not know how to increment the ranges.</p>\n\n<p>I have tried a Do while loop, but with no luck on the incrementing part</p>\n\n<pre><code>Range(\"D9:F9\").Select\nSelection.FormulaArray = \"=TRANSPOSE(R[6]C[5]:R[8]C[5])\"\n</code></pre>\n\n<p>So this code does the right thing, but I need it to repeat but the next time it should be Range D10:F10 and the Transpose should be R8 C5 R10 C5. It is this incrementation that I have problems with.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1548883659, "post_id": 54438992, "comment_id": 95708352, "body": "Yet another cross-post: <a href=\"https://www.mrexcel.com/forum/general-excel-discussion-other-questions/1085420-word-vba-give-number-heading-post5216778.html#post5216778\" rel=\"nofollow noreferrer\">mrexcel.com/forum/general-excel-discussion-other-questions/&hellip;</a> It is getting rather tiresome finding the same question in multiple forums with no cross-referencing... For cross-posting etiquette, kindly read: <a href=\"http://www.excelguru.ca/content.php?184\" rel=\"nofollow noreferrer\">excelguru.ca/content.php?184</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1549297616, "post_id": 54440735, "comment_id": 95843422, "body": "I don&#39;t know if it should be a new question. However it is related to this question. I have set two of these codes in a row and call from the same macro (by call). First code runs OK but on second one I am getting Error that points to seconds code <code>sh.OLEFormat.Activate</code>. I tried to set everything to <code>= Nothing</code>. But still can&#39;t run two same functions in a row for different sheets and different templates."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "edited": false, "score": 0, "creation_date": 1549297972, "post_id": 54440735, "comment_id": 95843624, "body": "@user7202022 Make it a new question, with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. At some point, it&#39;s necessary to have a <i>reproducible</i> example we can set up quickly and easily. Only so much can be done using guess work and duct tape..."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 2, "last_activity_date": 1548851516, "creation_date": 1548851516, "answer_id": 54440735, "question_id": 54438992, "link": "https://stackoverflow.com/questions/54438992/write-text-and-bookmarks-to-a-word-template-embedded-in-a-workbook/54440735#54440735", "title": "Write text and bookmarks to a Word template embedded in a workbook", "body": "<p>When automating another Office application memory can get \"tied up\" for various reasons. One important factor is managing <em>objects</em> the code has been using. At some point, these need to be \"released\" in order to free up memory. If they aren't properly disposed of, they can keep the application open (even if it's not visible) and cause problems.</p>\n\n<p>One possible problem <em>could be</em> the multiple instantiation of <code>xlSheet</code>. Since it's always being assigned the same worksheet, this only needs to be done once. If you want to re-use an object (for a different object) and the code has problems, first set the object to <code>Nothing</code> before assigning a different object to it. (This is usually not necessary but sometimes it helps.)</p>\n\n<p>The code in the question is running in Excel and uses a number of Word objects. These Word objects can become a problem (the Excel objects will \"go out of scope\" when the procedure ends). Therefore, it's good coding practice to set the object so <code>Nothing</code> as soon as they are no longer needed. </p>\n\n<p>Sample code from the question to illustrate:</p>\n\n<pre><code>  With objWord  'a Word document\n     objUndo.EndCustomRecord\n    .Undo\n    Set objUndo = Nothing '&lt;---- Release Word objects in Excel code\n    Set objRng = Nothing\n    .Application.Quit False '&lt;---- Please close Word application\n  End With\n  Set objWord = Nothing '&lt;---- Please free up objWord\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 54440735, "answer_count": 1, "score": 1, "last_activity_date": 1549281210, "creation_date": 1548846004, "last_edit_date": 1549281210, "question_id": 54438992, "link": "https://stackoverflow.com/questions/54438992/write-text-and-bookmarks-to-a-word-template-embedded-in-a-workbook", "title": "Write text and bookmarks to a Word template embedded in a workbook", "body": "<p>(This question is a follow-up on <a href=\"https://stackoverflow.com/q/54419143/3077495\">how to work with a document embedded in an Excel workbook</a> in the Word application interface (instead of in-place). The reason this is necessary is to be able to save the result as an independent document.)</p>\n\n<p>This code is doing what is needed to do. Opening embedded Word template, filling it in and saving it as new copy. The only part that is not working is <code>.Application.Quit False</code>. Getting Word error: \"Microsoft Word has stopped working\". What can be the possible reason of this failure? </p>\n\n<pre><code>Sub opentemplateWord()\nDim sh As Shape\nDim objOLE As OLEObject\nDim objWord As Object 'Word.Document\nDim objRng As Object 'Word.Range\nDim objUndo As Object 'Word.UndoRecord\nDim cell As Excel.Range\nDim xlRng As Excel.Range\nDim xlSht As Worksheet\n\n\nSet xlSht = Sheets(\"Main\")\n\nWith xlSht\n  Set xlRng = .Range(\"E1\", .Range(\"E\" &amp; Rows.Count).End(xlUp))\nEnd With\n\n''The shape holding the object from 'Create from file'\n''Object 2 is the name of the shape\nSet sh = Worksheets(\"Templates\").Shapes(\"WordFile\")\n''Activate the contents of the object\nsh.OLEFormat.Activate\nSet objOLE = sh.OLEFormat.Object\nSet objWord = objOLE.Object\n\nWith objWord\n  Set objRng = .Range.Characters.Last\n  Set objUndo = .Application.UndoRecord\n  objUndo.StartCustomRecord (\"Doc Data\")\n  Set xlSht = Sheets(\"Main\")\n  .Bookmarks(\"ProjectName1\").Range.Text = xlSht.Range(\"B10\").Value\n  .Bookmarks(\"ProjectName2\").Range.Text = xlSht.Range(\"B11\").Value\n  .Bookmarks(\"ProjectName3\").Range.Text = xlSht.Range(\"B12\").Value\n  .Bookmarks(\"ProjectName4\").Range.Text = xlSht.Range(\"B13\").Value\n  .Bookmarks(\"ProjectName5\").Range.Text = xlSht.Range(\"B14\").Value\n\n  For Each cell In xlRng\n    objRng.InsertAfter vbCr &amp; cell.Offset(0, -1).Text\n     Select Case LCase(cell.Value)\n        Case \"title\"\n          objRng.Paragraphs.Last.Style = .Styles(\"Heading 1\")\n        Case \"main\"\n          objRng.Paragraphs.Last.Style = .Styles(\"Heading 2\")\n        Case \"sub\"\n          objRng.Paragraphs.Last.Style = .Styles(\"Heading 3\")\n        Case \"sub-sub\"\n          objRng.Paragraphs.Last.Style = .Styles(\"Heading 4\")\n        Case \"par\"\n          objRng.Paragraphs.Last.Style = .Styles(\"Normal\")\n    End Select\n  Next cell\n  Set xlSht = Sheets(\"Main\")\n  .SaveAs2 ActiveWorkbook.Path &amp; \"\\\" &amp; _\n    xlSht.Range(\"B2\").Value &amp; \", \" &amp; _\n    xlSht.Range(\"B3\").Value &amp; \"_\" &amp; _\n    xlSht.Range(\"B4\").Value &amp; \"_\" &amp; _\n    xlSht.Range(\"B5\").Value &amp; \".docx\"\n  objUndo.EndCustomRecord\n  .Undo\n  .Application.Quit False '&lt;---- Please close Word application\nEnd With\nSet objWord = Nothing '&lt;---- Please free up objWord\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "report", "height"], "comments": [{"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1548859905, "post_id": 54438927, "comment_id": 95695725, "body": "Did you try <code>On Current</code> event?"}], "answers": [{"tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": false, "score": 1, "last_activity_date": 1548896064, "creation_date": 1548896064, "answer_id": 54451851, "question_id": 54438927, "link": "https://stackoverflow.com/questions/54438927/how-can-i-dynamically-change-record-textbox-hieghts-in-my-report-to-the-same-as/54451851#54451851", "title": "How can I dynamically change record textbox hieghts in my report to the same as the highest for each record?", "body": "<p>Here's some code I found on tek-tips that gives a general idea of how to make textboxes look the same height by drawing rectangles around them. The controls themselves are not resizable. </p>\n\n<pre><code>Private Sub Detail_Print(Cancel As Integer, PrintCount As Integer)\n    Dim intMaxHeight As Integer\n    Dim ctl As Control\n    'Find highest control in Detail section that has a tag property of \"Border\"\n    For Each ctl In Me.Section(0).Controls\n        If ctl.Tag = \"Border\" Then\n            If ctl.Height &gt; intMaxHeight Then\n                intMaxHeight = ctl.Height\n            End If\n        End If\n    Next\n    'Draw a box around each control in Detail that has a tag property of \"Border\"\n    For Each ctl In Me.Section(0).Controls\n        If ctl.Tag = \"Border\" Then\n            Me.Line (ctl.Left, ctl.Top) - Step(ctl.Width, intMaxHeight), vbBlack, B\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Reference:\n<a href=\"https://www.tek-tips.com/viewthread.cfm?qid=1676341\" rel=\"nofollow noreferrer\">https://www.tek-tips.com/viewthread.cfm?qid=1676341</a></p>\n"}], "owner": {"reputation": 11, "user_id": 9167033, "user_type": "registered", "profile_image": "https://graph.facebook.com/1623872694302175/picture?type=large", "display_name": "Anthony Williams", "link": "https://stackoverflow.com/users/9167033/anthony-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594619903, "creation_date": 1548845815, "last_edit_date": 1594619903, "question_id": 54438927, "link": "https://stackoverflow.com/questions/54438927/how-can-i-dynamically-change-record-textbox-hieghts-in-my-report-to-the-same-as", "title": "How can I dynamically change record textbox hieghts in my report to the same as the highest for each record?", "body": "<p>I have a report with two fields (txtQuestion &amp; txtLookingFor) which is populated via a query. Sometimes txtQuestion is much longer than txtLookingFor (or vice versa) and I want the printed report to appear even, by making the shorter of the two equal in height to the longer of the two - for each record on this report. </p>\n\n<p>I have some VBA which is triggered by even \"Detail OnFormat\" which is supposed to retrive the \"height\" values of each of the text boxes, find the maximum, and set both heights to this value. I cannot seem to get (read) the height values (from each record). But I can manually set the height values (per record) to some arbitrary value via VBA if I want.</p>\n\n<p>I have tried all the \"Can Grow\" and \"Can Shrink\" options. My text boxes do grow to their own height (per record), but I cannot seem to read what that value is, for use in my VBA code.</p>\n\n<pre><code>Private Sub Detail_Format(Cancel As Integer, FormatCount As Integer)\n    maxheight = 100\n    If (Me.txtQuestion.Height &gt; maxheight) Then \n         maxheight = Me.txtQuestion.Height\n    End If\n    If (Me.txtLookingFor.Height &gt; maxheight) Then \n         maxheight = Me.txtLookingFor.Height\n    End If\n    Me.txtQuestion.Height = maxheight\n    Me.txtLookingFor.Height = maxheight\n    Me.txtNotes.Height = maxheight\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1548844831, "post_id": 54438253, "comment_id": 95686490, "body": "Take a look here: <a href=\"https://stackoverflow.com/questions/12861909/how-to-create-a-pivot-table-in-vba\" title=\"how to create a pivot table in vba\">stackoverflow.com/questions/12861909/&hellip;</a>"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1548845168, "post_id": 54438253, "comment_id": 95686689, "body": "I would suspect this line of your code <code>TableDestination:=DSheet.Cells(Table1_Start_Line, Column_Line)</code>. Inserting a pivot table into a table may not be acceptable to Excel. However, no definite answer to your question can be given without looking at the ranges and variables declared before you come to the error line. The item I highlight is the only one I can see. If it doesn&#39;t cause the error then the source of the error must be in the previous declarations."}, {"owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1548847030, "post_id": 54438253, "comment_id": 95687882, "body": "@Variatus I tried that way also. But getting the same error."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1548849099, "post_id": 54438253, "comment_id": 95689100, "body": "Your code works for me (vers 14 instead of 15 for Excel 2010) but I get the same error if I try to run it before deleting the PT previously created. Are you sure your Destination range is free and available?"}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1548850029, "creation_date": 1548850029, "answer_id": 54440281, "question_id": 54438253, "link": "https://stackoverflow.com/questions/54438253/run-time-error-1004-when-creating-pivot-chart-from-macro/54440281#54440281", "title": "Run time error 1004 when creating Pivot chart from macro", "body": "<p>I think this code will do what you want. In essence, it deletes an existing table before inserting a new one.</p>\n\n<pre><code>Private Sub RenewPivotTable()\n\n    Dim DSheet As Worksheet\n    Dim PTable As PivotTable\n    Dim LastRow As Long, LastCol As Long\n    Dim PRange As Range\n    Dim Table1_Start_Line As Long, Column_line As Long\n\n    Set DSheet = ActiveWorkbook.Worksheets(\"Sheet1\")\n    With DSheet\n        If .PivotTables.Count Then\n            .PivotTables(1).TableRange2.Clear\n        End If\n        LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        Set PRange = .Cells(1, 1).Resize(LastRow, LastCol)\n    End With\n\n    Table1_Start_Line = 2\n    Column_line = LastCol + 2\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, _\n                                      SourceData:=PRange, _\n                                      Version:=xlPivotTableVersion15).CreatePivotTable _\n                                      TableDestination:=DSheet.Cells(Table1_Start_Line, Column_line), _\n                                      TableName:=\"PivotTable\", _\n                                      DefaultVersion:=xlPivotTableVersion15\nEnd Sub\n</code></pre>\n\n<p>I tested the Version14 version of it in Excel 2010</p>\n"}], "owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548850029, "creation_date": 1548843700, "last_edit_date": 1548846029, "question_id": 54438253, "link": "https://stackoverflow.com/questions/54438253/run-time-error-1004-when-creating-pivot-chart-from-macro", "title": "Run time error 1004 when creating Pivot chart from macro", "body": "<p>I have written a macro to add a pivot chart in my Excel. I am getting an </p>\n\n<blockquote>\n  <p>Application-defined or object-defined error </p>\n</blockquote>\n\n<p>in the following line.\nCan anybody help me with this?</p>\n\n<pre><code>Set DSheet = ActiveWorkbook.Worksheets(\"Sheet1\")\nWorksheets(\"Sheet1\").Activate\nLastRow = DSheet.Cells(DSheet.Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, DSheet.Columns.Count).End(xlToLeft).Column\nSet PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\nTable1_Start_Line = 2\nTable1_End_Line = Table1_Start_Line + LastRow\nColumn_Line = LastCol + 2\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRange, Version:=xlPivotTableVersion15).CreatePivotTable TableDestination:=DSheet.Cells(Table1_Start_Line, Column_Line), TableName:=\"PivotTable\", DefaultVersion:=xlPivotTableVersion15\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10417531"}, "edited": false, "score": 0, "creation_date": 1548841873, "post_id": 54437183, "comment_id": 95684673, "body": "you can also do <code>MyArr4 = array()</code> without <code>Dim</code> if you&#39;re not using <code>Option Explicit</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548842653, "post_id": 54437183, "comment_id": 95685143, "body": "@reportgunner ehhm we should <i>not</i> recommend to switch off <code>Option Explicit</code> we actually should recommend to always turn it <i>on</i>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10417531"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548844824, "post_id": 54437183, "comment_id": 95686487, "body": "@P\u1d07\u029c I am of the opposing opinion, but I was by no means recommending to turn it off."}, {"owner": {"reputation": 300, "user_id": 1978495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ccacccf34d5d2a9c0668b3b734bb09f?s=128&d=identicon&r=PG", "display_name": "drgs", "link": "https://stackoverflow.com/users/1978495/drgs"}, "edited": false, "score": 0, "creation_date": 1548845001, "post_id": 54437183, "comment_id": 95686583, "body": "A typed array as 4th &quot;style&quot;: Dim MyArr2() As Double"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548846382, "post_id": 54437183, "comment_id": 95687475, "body": "The difference is that <code>Dim MyArr()</code> is definitly an array, and you cannot assign a value to it <code>MyArr = 5</code> will fail. But <code>Dim MyArr</code> is completely undefined and can either assigned a value <code>MyArr = 5</code> will work or an array <code>MyArr = Range(&quot;a1:c10&quot;).Value</code> or a range <code>Set MyArr = Range(&quot;a1:c10&quot;)</code>. So be as specific als possible if you declare a variable. That means if you want to do <code>MyArr = Range(&quot;a1:c10&quot;).Value</code> then always make sure it is declared as array <code>Dim MyArr() As Variant</code> which is the most specific option here. So no one can put something else than an array into it."}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1548847184, "post_id": 54437183, "comment_id": 95687963, "body": "@PEH Your comment is accepted answer to my question."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548850085, "post_id": 54437183, "comment_id": 95689684, "body": "@PrzemyslawRemin posted it as an anwser, so you can mark it as solved."}], "answers": [{"comments": [{"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1548841444, "post_id": 54437282, "comment_id": 95684397, "body": "Can you please explain your sentence <code>But last two means that you are declaring Array of &quot;anythings&quot;, but only the first can be anything :)</code>? It sound philosophical:-)"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 1, "creation_date": 1548841659, "post_id": 54437282, "comment_id": 95684546, "body": "@PrzemyslawRemin Think of <code>Variant</code> as &quot;anything&quot;, even as array of <code>Variant</code> or any other datatype. But last two are arrays of variants, so they cannot be <code>Integer</code> etc., but they can be array of <code>Integer</code>, they can be array of anythings, but they cannot be anything (thay are arrays)."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1548840659, "last_edit_date": 1592644375, "creation_date": 1548840659, "answer_id": 54437282, "question_id": 54437183, "link": "https://stackoverflow.com/questions/54437183/declaring-array-variable-in-vba/54437282#54437282", "title": "Declaring array variable in VBA", "body": "<p><code>Variant</code> can be anything, as we can read in <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/variant-data-type\" rel=\"nofollow noreferrer\">Variant data type</a>:</p>\n<blockquote>\n<p>The Variant data type is the data type for all variables that are not explicitly declared as some other type (using statements such as Dim, Private, Public, or Static).</p>\n<p>The Variant data type has no type-declaration character.</p>\n<p>You can use the Variant data type in place of any data type</p>\n</blockquote>\n<p>This basically means that <code>Dim MyArr1 As Variant</code> implies that <code>MyArr1</code> can also be array of variants.</p>\n<p>But last two means that you are declaring <code>Array</code> of &quot;anythings&quot;, but only the first can be anything :)</p>\n"}, {"comments": [{"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1548841067, "post_id": 54437302, "comment_id": 95684159, "body": "Do you mean that MyArr1 is not an array? I can fill it with <code>MyArr1=[NamedRange].Value</code> And NamedRange can consist of any rectangular size of cells, say A1:B10."}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1548841150, "post_id": 54437302, "comment_id": 95684208, "body": "<code>MyArr1</code> is a variable with variant data type"}, {"owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1548841267, "post_id": 54437302, "comment_id": 95684273, "body": "Is it an <b>array</b> variable or not?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1548841712, "post_id": 54437302, "comment_id": 95684569, "body": "@PrzemyslawRemin <code>MyArr1</code> is <code>Variant</code> that means it can be <b>anything</b>, depending what you put into it. If you put in a string <code>MyArr1 = &quot;ABC&quot;</code> then it is a <code>Variant&#47;String</code>. If you put in an array <code>MyArr1 = Array(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)</code> then it is a <code>Variant&#47;Array</code>. You cannot tell just by its declaration."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10417531"}, "reply_to_user": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "edited": false, "score": 0, "creation_date": 1548841731, "post_id": 54437302, "comment_id": 95684582, "body": "@PrzemyslawRemin variant by definition can accept any type. if you assign an array or a result of a function that returns an array to MyArr1 it will be an array."}], "tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1548841806, "last_edit_date": 1548841806, "creation_date": 1548840756, "answer_id": 54437302, "question_id": 54437183, "link": "https://stackoverflow.com/questions/54437183/declaring-array-variable-in-vba/54437302#54437302", "title": "Declaring array variable in VBA", "body": "<p><code>Dim MyArr1 As Variant</code> - MyArr1 is variable with variant type<br>\nVariant type can hold any data type or object</p>\n\n<p>Below two are one and same. Its dynamic array whose size is not know at design time. <br></p>\n\n<pre><code>Dim MyArr2() As Variant\nDim MyArr3()\n</code></pre>\n\n<hr>\n\n<pre><code>Sub ArayTest()\n\n    Dim MyArr1 As Variant\n    Dim MyArr2() As Variant\n    Dim MyArr3()\n\n    MyArr1 = 10\n    MyArr1 = #1/30/2019#\n\n    '--&gt; You cannot directly assign value to array\n    'MyArr2 = 20\n    'MyArr3 = 30\n\n    '--&gt; Use Redim to set the size of array\n\n    ReDim MyArr2(1)\n    MyArr2(0) = \"abc\"\n    MyArr2(1) = 1324\n\n    '--&gt; variant can hold object\n    MyArr1 = Array(1, \"s\", #1/30/2019#)\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/fOaCs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fOaCs.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1548850062, "creation_date": 1548850062, "answer_id": 54440292, "question_id": 54437183, "link": "https://stackoverflow.com/questions/54437183/declaring-array-variable-in-vba/54440292#54440292", "title": "Declaring array variable in VBA", "body": "<p>The difference between \u2026</p>\n\n<ul>\n<li><code>Dim MyArr()</code> or<br>\n<code>Dim MyArr() As Variant</code> (which are the same) and</li>\n<li><code>Dim MyArr</code> or<br>\n<code>Dim MyArr As Variant</code> (which are also the same)</li>\n</ul>\n\n<p>\u2026 is that <code>Dim MyArr()</code> is <strong>definitly</strong> an array, and you cannot assign a value to it: <code>MyArr = 5</code> will fail.<br>\nWhile <code>Dim MyArr</code> is completely undefined and can either assigned \u2026</p>\n\n<ul>\n<li>a value <code>MyArr = 5</code> (will work)</li>\n<li>or an array <code>MyArr = Range(\"a1:c10\").Value</code> </li>\n<li>or a range <code>Set MyArr = Range(\"a1:c10\")</code></li>\n</ul>\n\n<p>So be as specific als possible if you declare a variable. That means if you want to do </p>\n\n<pre><code>MyArr = Range(\"a1:c10\").Value\n</code></pre>\n\n<p>then always make sure it is declared as array <code>Dim MyArr() As Variant</code> which is the most specific option here. So no one can put something else than an array into it. The more specific you are the more save is your code. </p>\n\n<p>Also every coder sees that in a variable <code>Dim MyVar()</code> should be an array while in <code>Dim MyVar</code> they don't know what is expected.</p>\n"}], "owner": {"reputation": 4549, "user_id": 1903793, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/nHYOz.jpg?s=128&g=1", "display_name": "Przemyslaw Remin", "link": "https://stackoverflow.com/users/1903793/przemyslaw-remin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 54440292, "answer_count": 3, "score": 3, "last_activity_date": 1548850062, "creation_date": 1548840302, "last_edit_date": 1548845531, "question_id": 54437183, "link": "https://stackoverflow.com/questions/54437183/declaring-array-variable-in-vba", "title": "Declaring array variable in VBA", "body": "<p>What is the difference in declaring array variable as of these three styles:</p>\n\n<pre><code>Dim MyArr1 As Variant\nDim MyArr2() As Variant\nDim MyArr3()\n</code></pre>\n\n<p>Are all these three dynamic variables?</p>\n\n<p>I cannot find a link to documentation where those three are compared.</p>\n\n<p><strong>Update.</strong>\nI really cannot see a difference when these two codes are executed:</p>\n\n<p>code 1</p>\n\n<pre><code>Dim MyArr\nMyArr = Range(\"a1:c10\").Value\n</code></pre>\n\n<p>code 2</p>\n\n<pre><code>Dim MyArr() As Variant\nMyArr = Range(\"a1:c10\").Value\n</code></pre>\n\n<p>Does it really matter if we declare array in any of the three ways listed above, as long as we want to assign values to array reading them from a range?</p>\n\n<pre><code>MyArr=Range(\"A1:C10\").Value\n</code></pre>\n\n<p>Is it so that when the line above is being executed then declaring variable happens just before filling it with values. Just as if we had a hidden line of code:</p>\n\n<pre><code>Dim MyArr(10,3) As Variant '10 rows, and 3 columns\n</code></pre>\n\n<p>So does <code>MyArr</code> become a static array variable when we read data to it from a range?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10417531"}, "edited": false, "score": 3, "creation_date": 1548839869, "post_id": 54437018, "comment_id": 95683415, "body": "which row is throwing the error ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548840188, "post_id": 54437018, "comment_id": 95683646, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> \u2022 Avoid using <code>Select</code> and <code>ActiveSheet</code> instead specify your worksheet directly with <code>Sheets(&quot;Dashboard&quot;).Unprotect</code> etc."}, {"owner": {"reputation": 47, "user_id": 8199567, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XioKyP7Rr0s/AAAAAAAAAAI/AAAAAAAADPw/SFYzEnwi9nk/photo.jpg?sz=128", "display_name": "Carmel Jacob", "link": "https://stackoverflow.com/users/8199567/carmel-jacob"}, "edited": false, "score": 0, "creation_date": 1548840985, "post_id": 54437018, "comment_id": 95684106, "body": "@reportgunner     ActiveSheet.PivotTables(&quot;PivotTable3&quot;).PivotFields(&quot;Responsi&zwnj;&#8203;ble Station&quot;). _         CurrentPage = &quot;ABC&quot;"}], "owner": {"reputation": 47, "user_id": 8199567, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XioKyP7Rr0s/AAAAAAAAAAI/AAAAAAAADPw/SFYzEnwi9nk/photo.jpg?sz=128", "display_name": "Carmel Jacob", "link": "https://stackoverflow.com/users/8199567/carmel-jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548840095, "creation_date": 1548839720, "last_edit_date": 1548840095, "question_id": 54437018, "link": "https://stackoverflow.com/questions/54437018/how-to-copy-an-excel-sheet-with-vba-macros-from-one-sheet-to-another-sheet-in-th", "title": "How to copy an excel sheet with VBA macros from one sheet to another sheet in the same workbook", "body": "<p>I am new to VBA and need some help in this.I have an excel workbook with multiple sheets with VBA codes and macros,I would like to replicate the same set of sheet and only change the button values,for eg.,if the previous button (ABC) in the sheet has code like this:</p>\n\n<pre><code>Sub ABC()\n    Application.ScreenUpdating = False\n    Sheets(\"Trend\").Select\n    ActiveSheet.Unprotect\n    ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Responsible Station\"). _\n        CurrentPage = \"ABC\"\n\n    Call ResetTrendColors\n\n    Dim btnt As Shape\n    Set btnt = ActiveSheet.Shapes(2)\n        With btnt.ThreeD\n            .Visible = True\n        End With\n            btnt.Fill.ForeColor.RGB = RGB(205, 48, 57)\n            btnt.TextFrame.Characters.Font.Color = RGB(252, 196, 37)\n\n    ActiveSheet.Protect AllowUsingPivotTables:=True\n\n    Sheets(\"Dashboard\").Select\n    ActiveSheet.Unprotect\n    ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"Responsible Station\"). _\n        CurrentPage = \"ABC\"\n    ActiveSheet.PivotTables(\"PivotTable5\").PivotFields(\"Responsible Station\"). _\n        CurrentPage = \"ABC\"\n    ActiveSheet.PivotTables(\"PivotTable6\").PivotFields(\"Responsible Station\"). _\n        CurrentPage = \"ABC\"\n    ActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Responsible Station\"). _\n        CurrentPage = \"ABC\"\n\n    Call ResetDashboardColors\n\n    Dim btnd As Shape\n    Set btnd = ActiveSheet.Shapes(3)\n        With btnd.ThreeD\n            .Visible = True\n        End With\n            btnd.Fill.ForeColor.RGB = RGB(205, 48, 57)\n            btnd.TextFrame.Characters.Font.Color = RGB(252, 196, 37)\n\n    ActiveSheet.Protect AllowUsingPivotTables:=True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I was able to copy the sheet to another sheet in the same workbook,but when i try to edit the buttons from ABC to say 'XYZ',it throws an error:</p>\n\n<blockquote>\n  <p>Run-time error 1004:Application-defined or object-defined error</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1548840162, "post_id": 54436903, "comment_id": 95683630, "body": "May refer <a href=\"https://stackoverflow.com/questions/53789201/about-multipage-unless-all-pages-have-input-commandbuttom2-is-disabled/53789939#53789939\">link1</a> and <a href=\"https://stackoverflow.com/questions/53123046/implementing-a-change-event-to-check-for-changes-to-textbox-values-and-enabling\">link2</a>"}, {"owner": {"reputation": 3, "user_id": 10948736, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7979y-s6OFI/AAAAAAAAAAI/AAAAAAAAAAk/jq8r9Soh3fE/photo.jpg?sz=128", "display_name": "Nirmalen Narrainapillay", "link": "https://stackoverflow.com/users/10948736/nirmalen-narrainapillay"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1548840368, "post_id": 54436903, "comment_id": 95683758, "body": "@AhmedAU Can you please elaborate? I&#39;m not an expert."}, {"owner": {"reputation": 1772, "user_id": 2421817, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GFWOi.jpg?s=128&g=1", "display_name": "kerwei", "link": "https://stackoverflow.com/users/2421817/kerwei"}, "edited": false, "score": 0, "creation_date": 1548840605, "post_id": 54436903, "comment_id": 95683895, "body": "Actually, you would only need to bind your code to the listener only once if you use the dropdown combo box instead (I think that&#39;s what it&#39;s called.. It&#39;s been awhile since I did VBA)"}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1548840747, "creation_date": 1548840747, "answer_id": 54437296, "question_id": 54436903, "link": "https://stackoverflow.com/questions/54436903/textbox-value-to-be-pulled-from-a-list-depending-on-2-other-textboxes/54437296#54437296", "title": "Textbox value to be pulled from a list depending on 2 other textboxes", "body": "<p>Not clear how, exactly, you are set up but please consider a variation of I demonstrate below.</p>\n\n<pre><code>Private Sub Textbox1_Change()\n\n    SetPrice 25\nEnd Sub\n\nPrivate Sub SetPrice(TbxNumber As Integer)\n\n    Dim Sizes As String\n    Dim Price As Variant\n    Dim Clm As Long\n\n    Sizes = Me.Textbox1.Value\n    Clm = IIf(TextboxSize.Value = \"SMALL\", 2, 3)\n\n    On Error Resume Next\n    Price = Application.WorksheetFunction.VLookup(Sizes, _\n            Worksheets(\"PRICELIST\").Range(\"A2:C100000\"), Clm, 0)\n    Me.Controls(\"TextBox\" &amp; TbxNumber).Value = Price\nEnd Sub\n</code></pre>\n\n<p>You would need a Change event procedure for each TextBox. That procedure would call the Sub SetPrice, passing the number of the TextBoxto write to (not sure that it is always different, and therefore not sure that it is required at all). The Sub will retrieve the price and write it to the TextBox. If it's always the same, scrap the parameter and just specify the TextBox directly in the sub.</p>\n\n<p>Note that the Iif function will return 3 if the size isn't \"SMALL\". By comparison, your code would return a blank if it's neither \"SMALL\" nor \"MEDIUM\". If you need that result consider <code>Select Case</code> rather than If/Else.</p>\n"}], "owner": {"reputation": 3, "user_id": 10948736, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7979y-s6OFI/AAAAAAAAAAI/AAAAAAAAAAk/jq8r9Soh3fE/photo.jpg?sz=128", "display_name": "Nirmalen Narrainapillay", "link": "https://stackoverflow.com/users/10948736/nirmalen-narrainapillay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548841156, "creation_date": 1548839364, "last_edit_date": 1548841156, "question_id": 54436903, "link": "https://stackoverflow.com/questions/54436903/textbox-value-to-be-pulled-from-a-list-depending-on-2-other-textboxes", "title": "Textbox value to be pulled from a list depending on 2 other textboxes", "body": "<p>I have a user form (Userform1) that allows users to select items(max 24 items) from check boxes. (Checkbox1 to checkbox24)</p>\n\n<p>Each check box is linked to a different text box so that users can select more than 1 item.</p>\n\n<p>If checkbox 1 is selected, then textbox 1 = \"A\"</p>\n\n<p>If checkbox 2 is selected, then textbox 2 = \"B\"\nand it goes on like this.</p>\n\n<p>Now these items are available in Small and Medium.</p>\n\n<p>I have a list of all the items and their different prices per size.</p>\n\n<p>Example of My list:</p>\n\n<pre><code>Items   Price (Small)   Price (Medium)\nA       10              15\nB       7               12\nand it goes on.\n</code></pre>\n\n<p>I want the userform to pull up the prices of the items based on their sizes.</p>\n\n<p>So that when a user selects item \"A\" in small - a text box will show the price 10.</p>\n\n<p>I tried:</p>\n\n<pre><code>Private Sub Textbox1_change()\nDim sizes As String\nsizes = Me.TextBox1.Value\n\nOn Error Resume Next\n\nIf textboxsize.Value = \"SMALL\" Then Me.TextBox25.Value = \napplication.worksheetfunction.vlookup(sizes, sheets(\"PRICE \nLIST\").range(\"A2:C100000\"),2,0)\nEnd If\n\nIf textboxsize.Value = \"MEDIUM\" Then Me.TextBox25.Value = \napplication.worksheetfunction.vlookup(sizes, sheets(\"PRICE \nLIST\").range(\"A2:C100000\"),3,0)  \nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>It is working but the constraint is that i have to copy the code to every textbox of the userform and change the ids.</p>\n\n<p>Is there any easier way to do this?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1549461027, "post_id": 54436422, "comment_id": 95910050, "body": "Did this answer your question please?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1548838407, "last_edit_date": 1548838407, "creation_date": 1548837734, "answer_id": 54436422, "question_id": 54436366, "link": "https://stackoverflow.com/questions/54436366/vba-web-scraping-and-displaying-results-in-excel-spreadsheet/54436422#54436422", "title": "VBA: Web scraping and displaying results in Excel spreadsheet", "body": "<p>You can use a css class selector</p>\n\n<pre><code>HTMDoc.querySelector(\".status\").innerText\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/a/52570764/6241235\">here</a> for an example of looping urls.</p>\n"}], "owner": {"reputation": 11, "user_id": 7586817, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oKspOujsM4o/AAAAAAAAAAI/AAAAAAAAUnQ/TIHlaUD_a2o/photo.jpg?sz=128", "display_name": "Matthew", "link": "https://stackoverflow.com/users/7586817/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548844058, "creation_date": 1548837521, "last_edit_date": 1548844058, "question_id": 54436366, "link": "https://stackoverflow.com/questions/54436366/vba-web-scraping-and-displaying-results-in-excel-spreadsheet", "title": "VBA: Web scraping and displaying results in Excel spreadsheet", "body": "<p>I have a VBA code that successfully searches a house on Zillow, however I'm trying to extract the part of the website that shows the status (class=\"status\") and display the results on an excel spreadsheet.</p>\n\n<pre><code>Sub getHTMLdocument()\n\nDim IE As New SHDocVw.InternetExplorer\nDim HTMLDoc As MSHTML.HTMLDocument\nDim HTMLInput As MSHTML.IHTMLElement\nDim HTMLButtons As MSHTML.IHTMLElementCollection\nDim HTMLButton As MSHTML.IHTMLElement\nDim stat As MSHTML.IHTMLElement\n\nIE.Visible = True\nIE.navigate \"zillow.com/homes\"\n\nDo While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\nLoop\n\nSet HTMLDoc = IE.Document\nSet HTMLInput = HTMLDoc.getElementById(\"citystatezip\")\nHTMLInput.Value = \"21371 Estepa Circle Huntington Beach\"\n\nSet HTMLButtons = HTMLDoc.getElementsByTagName(\"button\")\nHTMLButtons(0).Click\n\nSet stat = HTMLDoc.getElementById(\"yui_3_18_1_1_1548832597156_4287\")\n    Debug.Print stat.getAttribute(\"href\")\n\nEnd Sub\n</code></pre>\n\n<p>Eventually I also want the VBA to pull data from a spreadsheet and load each automatically at the push of a button.</p>\n\n<p>Ex:</p>\n\n<p>111 Main st [Button that loads Zillow for 111]</p>\n\n<p>211 Main st [Button that loads Zillow for 211]</p>\n\n<p>311 Main st [Button that loads Zillow for 311]...</p>\n\n<p>However, I'd really appreciate it if I could at least get it to display the class=\"status\" part on excel</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548837376, "post_id": 54436298, "comment_id": 95681894, "body": "Remove <code>On Error Resume Next</code>. This line just hides <b>all</b> error messages, but the errors still occur (you just cannot see them). If you don&#39;t see them you cannot fix them, if you don&#39;t fix them your code does not work! \u2022 Remove <code>On Error Resume Next</code> and fix your errors is the solution to your issue."}, {"owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548838488, "post_id": 54436298, "comment_id": 95682528, "body": "When I am running the macro the same workbook it is working fine."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548838681, "post_id": 54436298, "comment_id": 95682642, "body": "Did you remove <code>On Error Resume Next</code>? What happend?"}, {"owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548838759, "post_id": 54436298, "comment_id": 95682694, "body": "Yes. I am getting Application defined or object defined error."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548838834, "post_id": 54436298, "comment_id": 95682743, "body": "Where? In which line? So you must fix that error."}, {"owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548838922, "post_id": 54436298, "comment_id": 95682809, "body": "In LastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row"}, {"owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548838980, "post_id": 54436298, "comment_id": 95682845, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/187553/discussion-between-naveen-prakash-and-p\">continue this discussion in chat</a>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548839935, "post_id": 54436298, "comment_id": 95683460, "body": "Specify the worksheet for <code>DSheet.Rows.Count</code> in <code>LastRow = DSheet.Cells(DSheet.Rows.Count, 1).End(xlUp).Row</code>"}, {"owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548842770, "post_id": 54436298, "comment_id": 95685222, "body": "Thank You so much."}], "owner": {"reputation": 130, "user_id": 6856873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a197de4d77d938c792db2fbd855e103d?s=128&d=identicon&r=PG&f=1", "display_name": "NAVEEN PRAKASH", "link": "https://stackoverflow.com/users/6856873/naveen-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548837311, "creation_date": 1548837292, "last_edit_date": 1548837311, "question_id": 54436298, "link": "https://stackoverflow.com/questions/54436298/finding-last-row-and-last-column-of-excel-sheet-in-macro", "title": "Finding last row and last column of excel sheet in Macro", "body": "<p>I am writing a macro in excel to add Pivot Chart in one workbook. And I am trying to run that macro on another workbook.The variables ACTST and ActWB are getting the proper values. But LastRow and LastCol variables are getting the values as 0. Can anybody tell where I am wrong?</p>\n\n<pre><code>ACTST = ActiveSheet.Name\nActWB = ActiveWorkbook.Name\n\n'Insert a New Blank Worksheet\n On Error Resume Next\n Set DSheet = Worksheets(\"Sheet1\")\n Worksheets(\"Sheet1\").Activate\n\n 'Define Data Range\n LastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\n LastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n Set PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548838845, "post_id": 54436187, "comment_id": 95682753, "body": "yes it is possible.Try and code something and share where you are stuck. It looks like an unpivot on the end columns (months) then removal of blanks rows (within those unpivoted columns). You could likely use powerquery for this."}, {"owner": {"reputation": 1, "user_id": 10988923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6715f4468e94ab6b5f0fe2f4b893ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tempo A", "link": "https://stackoverflow.com/users/10988923/tempo-a"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548917140, "post_id": 54436187, "comment_id": 95717677, "body": "Thanks, as powerquery is not an option I can try, I used this:Dim myRow As Long Dim rowPointer, columnPointer,lastColumn,LastRowIndex As Long myRow = 1 LastRowIndex = Worksheets(&quot;sheet1&quot;).Cells(Rows.Count, 1).End(xlUp).Row For rowPointer = 2 To LastRowIndex lastColumn = Sheet1.Cells(rowPointer, Columns.Count).End(xlToLeft).Column For columnPointer = 2 To lastColumn Sheet2.Cells(myRow, 1).Value = Sheet1.Cells(rowPointer, 1).Value Sheet2.Cells(myRow, 3).Value = Sheet1.Cells(rowPointer, columnPointer).Value myRow = myRow + 1 Next columnPointer Next rowPointer This did not helped"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548921745, "post_id": 54436187, "comment_id": 95719762, "body": "hi, use the <a href=\"https://stackoverflow.com/posts/54436187/edit\">edit</a> link to insert your code between code tags in your question."}], "owner": {"reputation": 1, "user_id": 10988923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6715f4468e94ab6b5f0fe2f4b893ef?s=128&d=identicon&r=PG&f=1", "display_name": "Tempo A", "link": "https://stackoverflow.com/users/10988923/tempo-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548928641, "creation_date": 1548836945, "last_edit_date": 1548928641, "question_id": 54436187, "link": "https://stackoverflow.com/questions/54436187/copy-horizontal-data-vertically-in-a-dynamic-range", "title": "Copy horizontal data vertically in a dynamic range", "body": "<p>This is first time I got stuck after taking all help from this site for last 5 years. This is my first question so might not be to the point, however, I will try my best. My source data is something like in image Snip1, where Column A, B and C are merged and contains some values, from Column D to K it have corresponding values of the month. </p>\n\n<p>Snip1<br>\n<a href=\"https://i.stack.imgur.com/wpeso.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wpeso.jpg\" alt=\"Snip1\"></a></p>\n\n<p>The output will be as given in Snip2 where the value of column A,B and C remains the same, then in D will be the corresponding month where there is some value and then Column E will have that value. If there is a value in another month then in row 2 it will put the same value of Column A,B and C and the corresponding Month where there is value followed by the value in column E. </p>\n\n<p>Snip2<br>\n<a href=\"https://i.stack.imgur.com/FieqH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FieqH.jpg\" alt=\"Snip2\"></a></p>\n\n<p>This will continue till the last filled cell of Column A, B and C. Is this possible with Macro?</p>\n\n<pre><code>Sub Example()\n</code></pre>\n\n<p>Dim myRow As Long\nDim rowPointer As Long\nDim columnPointer As Long\nDim lastColumn As Long\nDim LastRowIndex As Long</p>\n\n<p>myRow = 1</p>\n\n<p>LastRowIndex = Worksheets(\"sheet1\").Cells(Rows.Count, 1).End(xlUp).Row</p>\n\n<pre><code>For rowPointer = 2 To LastRowIndex\n    lastColumn = Sheet1.Cells(rowPointer, Columns.Count).End(xlToLeft).Column\nFor columnPointer = 2 To lastColumn\n    Sheet2.Cells(myRow, 1).Value = Sheet1.Cells(rowPointer, 1).Value\n    Sheet2.Cells(myRow, 3).Value = Sheet1.Cells(rowPointer, columnPointer).Value\n    myRow = myRow + 1\nNext columnPointer\nNext rowPointer\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548836324, "post_id": 54435934, "comment_id": 95681369, "body": "Have you tried recording a macro for starters? Or looked up ListObject and ListColumn? <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.listcolumn.databodyrange\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>, <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.listcolumn,https://docs.microsoft.com/en-us/office/vba/api/excel.listobject\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.listcolumn,htt&zwnj;&#8203;ps:/&hellip;</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548836437, "post_id": 54435934, "comment_id": 95681429, "body": "For a good start have a look at <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">The VBA Guide To ListObject Excel Tables</a>. Try something and come back if you got stuck or errors and <a href=\"https://stackoverflow.com/posts/54435934/edit\">edit</a> your question to show your code."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10988939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QIUexFUNL8U/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNesaa4FU-3a2Ld3jiGLwt3jz9sYw/mo/photo.jpg?sz=128", "display_name": "user10988939", "link": "https://stackoverflow.com/users/10988939/user10988939"}, "edited": false, "score": 0, "creation_date": 1548932308, "post_id": 54456097, "comment_id": 95725926, "body": "Thanks for your response, and apologies if it appears that I have not researched this enough.  I&#39;m not a programmer/coder so this is quite new to me. The tip regarding referencing the table column name that is great, however i still couldn&#39;t get the code you wrote above to work. I am getting &quot;Run-time error 1004 Method Range of Object _Global failed&quot;"}, {"owner": {"reputation": 625, "user_id": 2880342, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/917a1ca96bd067832d2b7e4d8967d336?s=128&d=identicon&r=PG&f=1", "display_name": "GoodJuJu", "link": "https://stackoverflow.com/users/2880342/goodjuju"}, "reply_to_user": {"reputation": 13, "user_id": 10988939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QIUexFUNL8U/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNesaa4FU-3a2Ld3jiGLwt3jz9sYw/mo/photo.jpg?sz=128", "display_name": "user10988939", "link": "https://stackoverflow.com/users/10988939/user10988939"}, "edited": false, "score": 0, "creation_date": 1548939127, "post_id": 54456097, "comment_id": 95730004, "body": "It sounds like the code does not know what sheet you are referencing.  I have modified the sample and wrapped it with a &quot;With, End With&quot;.  Hopefully this will resolve your issue."}, {"owner": {"reputation": 13, "user_id": 10988939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QIUexFUNL8U/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNesaa4FU-3a2Ld3jiGLwt3jz9sYw/mo/photo.jpg?sz=128", "display_name": "user10988939", "link": "https://stackoverflow.com/users/10988939/user10988939"}, "edited": false, "score": 0, "creation_date": 1549348422, "post_id": 54456097, "comment_id": 95859294, "body": "Yes it worked (Thank You) but... it took more than 1 hour to complete (I&#39;d been CTRL-Breaking for the past 2 days after 20-30 mins believing the application had hung).  Is there any way to speed this up with more efficient code? my PC is Intel i7-4510U CPU, 12GB RAM, 500MB SSD HD. The excel file is rather large at 17MB having 9 worksheets (total of 110 columns and 53,200 rows) the largest worksheet which is the one I want this code to run against is 78 columns and 32,000 rows."}, {"owner": {"reputation": 625, "user_id": 2880342, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/917a1ca96bd067832d2b7e4d8967d336?s=128&d=identicon&r=PG&f=1", "display_name": "GoodJuJu", "link": "https://stackoverflow.com/users/2880342/goodjuju"}, "reply_to_user": {"reputation": 13, "user_id": 10988939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QIUexFUNL8U/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNesaa4FU-3a2Ld3jiGLwt3jz9sYw/mo/photo.jpg?sz=128", "display_name": "user10988939", "link": "https://stackoverflow.com/users/10988939/user10988939"}, "edited": false, "score": 0, "creation_date": 1549377672, "post_id": 54456097, "comment_id": 95875033, "body": "Try putting <code>Application.ScreenUpdating = False</code> before the <code>&#39;With&#39;</code> and <code>Application.ScreenUpdating = True</code> after the <code>&#39;End with&#39;</code>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1549475283, "post_id": 54456097, "comment_id": 95918668, "body": "The With statements in your code samples don&#39;t do anything without <code>.</code> (for example <code>If .Range</code>). Also, Excel Table names and structured references are global to the whole workbook and don&#39;t need sheet name. As a side note, <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/timer-function\" rel=\"nofollow noreferrer\"><code>Timer</code></a> can be used instead of <code>Now()</code> for better precision."}, {"owner": {"reputation": 625, "user_id": 2880342, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/917a1ca96bd067832d2b7e4d8967d336?s=128&d=identicon&r=PG&f=1", "display_name": "GoodJuJu", "link": "https://stackoverflow.com/users/2880342/goodjuju"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1549490570, "post_id": 54456097, "comment_id": 95925387, "body": "@Slai, thanks for the information.  I had left the &#39;With&#39; in as I was originally looping through all sheets.  I can see now it is superfluous.  I was using Now() instead of Timer to keep it all as dates rather than introducing a double.  I was only interested in precision to the nearest 1-2 seconds."}], "tags": [], "owner": {"reputation": 625, "user_id": 2880342, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/917a1ca96bd067832d2b7e4d8967d336?s=128&d=identicon&r=PG&f=1", "display_name": "GoodJuJu", "link": "https://stackoverflow.com/users/2880342/goodjuju"}, "is_accepted": true, "score": 0, "last_activity_date": 1549441626, "last_edit_date": 1549441626, "creation_date": 1548922762, "answer_id": 54456097, "question_id": 54435934, "link": "https://stackoverflow.com/questions/54435934/macro-to-replace-values-within-a-table/54456097#54456097", "title": "Macro to replace values within a table", "body": "<p>I see this is your first post on Stackoverflow, so, welcome.</p>\n\n<p>I also see you have been marked down for your question which can be disheartening as a first introduction the the site.</p>\n\n<p>On SO there is an expectation that you will have researched and tried a number of things first and posted that information with the question.</p>\n\n<p>You are very close, but your code is failing because you are searching for a literal string \">0\" (What:=\">0\").  >0 obviously does not exist as a literal string.</p>\n\n<p>The built in replace function limits the find to a literal string.  Therefore I would use this approach:</p>\n\n<pre><code>Sub replaceTest()\n\n    Dim dblCnt As Double\n    dblCnt = 0\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        For i = 1 To Range(\"Table1\").Rows.Count\n            If Range(\"Table1[Salary]\")(i) &gt; 1 Then\n                Range(\"Table1[Salary]\")(i) = \"2\"\n                dblCnt = dblCnt + 1\n            End If\n        Next i\n    End With\n\nMsgBox \"Finished replacing \" &amp; CStr(dblCnt) &amp; \" items\", vbOKOnly, \"Complete\"\n\nEnd Sub\n</code></pre>\n\n<p>FYI, your code sample was referencing Column 61, but you said the column was called 'Salary'. You can reference the column name by changing your sample from:</p>\n\n<pre><code>ActiveSheet.ListObjects(\"Table1\").ListColumns(61).DataBodyRange.Replace _\n</code></pre>\n\n<p>to</p>\n\n<pre><code>ActiveSheet.ListObjects(\"Table1\").ListColumns(\"Salary\").DataBodyRange.Replace _\n</code></pre>\n\n<p>I have added another code section below and credit must go to @Slai  His approach using the 'Evaluate' function is instantaneous compared to my original answer:</p>\n\n<pre><code>Sub replaceTest001()\n\n    Dim StartTime As Date\n    StartTime = Now()\n\n    Dim dblCnt As Double\n    dblCnt = 0\n\n    Application.ScreenUpdating = False\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        [Table1[Salary]] = [if(Table1[Salary] &gt; 1, 2, Table1[Salary])]\n    End With\n\n    Application.ScreenUpdating = True\n\n    MsgBox \"Finished updating \" &amp; CStr(dblCnt) &amp; \" items\" &amp; vbCrLf &amp; _\n    \"Time taken: \" &amp; Format((Now() - StartTime), \"hh:mm:ss\"), vbOKOnly, \"Complete\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 1, "last_activity_date": 1548925018, "creation_date": 1548925018, "answer_id": 54456738, "question_id": 54435934, "link": "https://stackoverflow.com/questions/54435934/macro-to-replace-values-within-a-table/54456738#54456738", "title": "Macro to replace values within a table", "body": "<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.evaluate\" rel=\"nofollow noreferrer\">Evaluate</a> can be used to replace all at once :</p>\n\n<pre><code>[Table1[Salary]] = [if(Table1[Salary] &gt; 1, 2, Table1[Salary])]\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10988939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QIUexFUNL8U/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNesaa4FU-3a2Ld3jiGLwt3jz9sYw/mo/photo.jpg?sz=128", "display_name": "user10988939", "link": "https://stackoverflow.com/users/10988939/user10988939"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2404, "favorite_count": 0, "accepted_answer_id": 54456097, "answer_count": 2, "score": 0, "last_activity_date": 1549441626, "creation_date": 1548835956, "last_edit_date": 1548919637, "question_id": 54435934, "link": "https://stackoverflow.com/questions/54435934/macro-to-replace-values-within-a-table", "title": "Macro to replace values within a table", "body": "<p>I have a large amount of data (approx 60 columns and 60,000 rows) formatted as a table in Excel. I'm looking to use a macro to replace all the values greater than 1 which reside in a column titled 'Salary' in the table with a value of '2'. the table is dynamic so I need to reference the replace to the  Tables column name rather than a column range like D:D.</p>\n\n<p><strong>Update:</strong>\nI have put together the following code but cannot get it to work when i use What:=\">0\" however it will work if what=\"5\". What am I doing wrong?</p>\n\n<pre><code>Sub FindReplace3()\nActiveSheet.ListObjects(\"Table1\").ListColumns(61).DataBodyRange.Replace _\n What:=\"&gt;0\", replacement:=\"7\", _\n SearchOrder:=xlByColumns, MatchCase:=True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "countif", "find-occurrences"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 0, "creation_date": 1548836960, "post_id": 54435992, "comment_id": 95681684, "body": "Sorry for not providing clear enough info.  Column B can change as well."}, {"owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 0, "creation_date": 1548837095, "post_id": 54435992, "comment_id": 95681754, "body": "So might have 2172223333 further down the column with a different number in Column B, so I can&#39;t use a traditional COUNTIFS statement because it will count all of the times 2172223333 occurs in Column A, not just the # of times that 2172223333 occurs in relation to 2172245555. Then further down the column I would need to know how many times 2172223333 occurs again with a different number in column B, say 2172287777."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "edited": false, "score": 0, "creation_date": 1548837609, "post_id": 54435992, "comment_id": 95682007, "body": "@BonnieZ No, it does exactly what you want. It only coun&#39;t the rows that have the same combination of column A and column B. Test it please. Note that <code>COUNTIFS</code> is not <code>COUNTIF</code>. <code>COUNTIFS</code> can check multiple criterias. See my edit for a proof."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1548837732, "last_edit_date": 1548837732, "creation_date": 1548836142, "answer_id": 54435992, "question_id": 54435869, "link": "https://stackoverflow.com/questions/54435869/vba-find-number-of-occurrences-in-one-column-based-on-number-of-occurrences-in/54435992#54435992", "title": "VBA: Find number of occurrences in one column based on number of occurrences in a second column", "body": "<p>Just use the following formula in column C</p>\n\n<pre><code>=COUNTIFS(A:A,A:A,B:B,B:B)\n</code></pre>\n\n<p>to get the occurences of the combinations.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XIO2Q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XIO2Q.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Alternatively you can use in cell C2</p>\n\n<pre><code>=COUNTIFS(A:A,A2,B:B,B2)\n</code></pre>\n\n<p>\u2026 and copy it down.</p>\n\n<hr>\n\n<p>Edit to proof my comment below:\n<a href=\"https://i.stack.imgur.com/SS6uj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SS6uj.png\" alt=\"enter image description here\"></a>\nsee the last line here. <code>2172223333</code> occurs but the combination counts only the occurences of combinations of column A and B.</p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548920723, "post_id": 54441302, "comment_id": 95719236, "body": "Actually the reason why there is a <code>COUNTIFS</code> is that you don&#39;t have to do this ;)"}, {"owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548937846, "post_id": 54441302, "comment_id": 95729208, "body": "@P\u1d07\u029c You are correct! Your answer was exactly what OP needed, but I just thought it may be useful for them to see the idea behind it. <code>Countis</code> while very powerful have always been a bit daunting to me (I am a simple fellow lol). Additionally, the concept of <i>composite keys</i> can spark ideas for other useful tasks that readers may need and would find after coming across this post."}], "tags": [], "owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "is_accepted": false, "score": 0, "last_activity_date": 1548853516, "creation_date": 1548853516, "answer_id": 54441302, "question_id": 54435869, "link": "https://stackoverflow.com/questions/54435869/vba-find-number-of-occurrences-in-one-column-based-on-number-of-occurrences-in/54441302#54441302", "title": "VBA: Find number of occurrences in one column based on number of occurrences in a second column", "body": "<p>You can also use a helper column that concatenates Columns A and B. This creates a <em>Composite Key</em> which you can then use in the <code>CountIf</code> function like so: </p>\n\n<p><a href=\"https://i.stack.imgur.com/KLE4s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KLE4s.png\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li>Column C Formula: <code>=A2&amp;B2</code></li>\n<li>Column D Formula: <code>=COUNTIF($C$2:$C6,$C2)</code> </li>\n<li>Column E Formula: <code>=COUNTIF($C$2:$C2,$C2)</code></li>\n</ul>\n\n<p><strong>Note:</strong> I added the running count Column (Column E) for kicks, so its not necessary, just another option you might want to pull out in the future. </p>\n"}], "owner": {"reputation": 39, "user_id": 10977740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YeeSxbW5K4M/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOCanHLPKup64monLqGYtYxGGd5Bg/mo/photo.jpg?sz=128", "display_name": "Bonnie Z", "link": "https://stackoverflow.com/users/10977740/bonnie-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 54435992, "answer_count": 2, "score": 0, "last_activity_date": 1548853516, "creation_date": 1548835672, "last_edit_date": 1548835921, "question_id": 54435869, "link": "https://stackoverflow.com/questions/54435869/vba-find-number-of-occurrences-in-one-column-based-on-number-of-occurrences-in", "title": "VBA: Find number of occurrences in one column based on number of occurrences in a second column", "body": "<p>I need to figured out a way to count the number of times a number appears in Column B based on it matching a value in column A.</p>\n\n<p>Example:</p>\n\n<pre><code>Column A       Column B    \n2172223333    2172245555    \n2172223333    2172245555    \n2172234444    2172245555    \n2172234444    2172245555    \n2172285544    2172245555\n</code></pre>\n\n<p>So in this example I would need to calculate that </p>\n\n<p><code>2172245555</code> occurs 2 times in relation to <code>2172223333</code></p>\n\n<p><code>2172245555</code> occurs 2 times in relation to <code>2172234444</code></p>\n\n<p><code>2172245555</code> occurs 1 time in relation to <code>2172285544</code></p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 172, "user_id": 10627624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q24pnMMCBhM/AAAAAAAAAAI/AAAAAAAAAI0/9V6VmJktiDI/photo.jpg?sz=128", "display_name": "Alexey C", "link": "https://stackoverflow.com/users/10627624/alexey-c"}, "edited": false, "score": 0, "creation_date": 1548834457, "post_id": 54435367, "comment_id": 95680533, "body": "Read this about using Select <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548834742, "post_id": 54435367, "comment_id": 95680668, "body": "You can only do it in a loop if you can make your code find the source range and determine where the destination range will be. We cannot tell you <b>how</b> exactly to do that because it highly depends on how your data looks like. So think about how <i>you</i> manually decide which data needs to be copied (how do you find it as a human) and then try to use these criterias to write your code to determine this range."}, {"owner": {"reputation": 1, "user_id": 10988519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb10f646508813b9997067e73eb6302a?s=128&d=identicon&r=PG&f=1", "display_name": "mylittlepony", "link": "https://stackoverflow.com/users/10988519/mylittlepony"}, "edited": false, "score": 0, "creation_date": 1548938532, "post_id": 54435367, "comment_id": 95729619, "body": "Ok thank you! I figured out its simpler to make my datasets look alike or similar then continue doing my copy pasting"}], "owner": {"reputation": 1, "user_id": 10988519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb10f646508813b9997067e73eb6302a?s=128&d=identicon&r=PG&f=1", "display_name": "mylittlepony", "link": "https://stackoverflow.com/users/10988519/mylittlepony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548834514, "creation_date": 1548833537, "last_edit_date": 1548834514, "question_id": 54435367, "link": "https://stackoverflow.com/questions/54435367/vba-copy-and-paste-from-irregular-columns", "title": "vba copy and paste from irregular columns", "body": "<p>I just started learning vba/macro to simplify some task. </p>\n\n<p>The code below works fine but I am wondering if it can be simplified by adding some <code>For</code> loops or editing some parts.</p>\n\n<p><strong>Problem:</strong><br>\nTo copy from workbook 1 then paste in to workbook 2. \nThere are irregularitie. For example, Workbook1-Column3 C will paste into W2C5, then W1C6 into W2C6. Etc.</p>\n\n<p>this is my current macro/vba code</p>\n\n<pre><code>Sub copypaste_openPO()\n\n    Sheets(\"Open PO\").Select\n    Windows(\"Open Purchase Orders.xlsx\").Activate\n    Range(\"E5:F9999\").Select\n    Selection.Copy\n    Windows(\"Action Tool.xlsm\").Activate\n    Range(\"B2\").Select\n    ActiveSheet.Paste\n\n    Windows(\"Open Purchase Orders.xlsx\").Activate\n    Application.CutCopyMode = False\n    Range(\"H5:P9999\").Select\n    Selection.Copy\n    Windows(\"Action Tool.xlsm\").Activate\n    Range(\"D2\").Select\n    ActiveSheet.Paste\n</code></pre>\n\n<p>This goes on for about 20+ times. and it quite inefficient.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 116, "user_id": 5982062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFQvV.jpg?s=128&g=1", "display_name": "wallyeye", "link": "https://stackoverflow.com/users/5982062/wallyeye"}, "edited": false, "score": 0, "creation_date": 1548833860, "post_id": 54435322, "comment_id": 95680270, "body": "You need to supply the dimensions of your array before you reference them, I.e. redim arr(1 to 50).  Assigning the array to a range of values would work as well, but with two dimensions: arr = wbthis.sheets(\u201csheet1\u201d).cells(6, 1).resize(1,50).value, then reference it as arr(1,I)"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "is_accepted": true, "score": 0, "last_activity_date": 1548834930, "last_edit_date": 1548834930, "creation_date": 1548833688, "answer_id": 54435403, "question_id": 54435322, "link": "https://stackoverflow.com/questions/54435322/vba-macro-function-out-of-range/54435403#54435403", "title": "VBA Macro function out of range", "body": "<p>You need to assign some size to the variant array.</p>\n\n<pre><code>Function getNames()\n    Dim wbThis As Workbook, i As Long\n\n    Set wbThis = ThisWorkbook\n\n    redim arr(1 to 50) As Variant\n\n    For i = lbound(arr) To ubound(arr)\n        arr(i) = wbThis.Sheets(\"Sheet1\").Cells(6, i).Value\n    Next i\n\n    For i = lbound(arr) To ubound(arr)\n        MsgBox \"employee names are***** .\" &amp; arr(i)\n    Next i\nEnd Function\n</code></pre>\n\n<p><code>ReDim</code> can be used without <code>Dim</code> first. <code>LBound</code> to <code>UBound</code> is a more versatile method of looping through a static array from the lower boundary to the upper boundary. The ampersand <code>&amp;</code> is the preferred operator for string concatenation.</p>\n\n<p>Functions are intended to return a value. This may be better as a <code>sub</code> procedure.</p>\n\n<p>You can 'seed' an array by calling the function from a sub.</p>\n\n<pre><code>sub main()\n\n    dim i as long, nms as variant\n\n    nms = getNames()\n\n    For i = lbound(nms) To ubound(nms)\n        MsgBox \"employee names are***** .\" &amp; nms(i)\n    Next i\n\nend sub\n\nFunction getNames()\n    Dim  wbThis As Workbook,  i As Long\n\n    Set wbThis = ThisWorkbook\n\n    redim arr(1 to 50) As Variant\n\n    For i = lbound(arr) To ubound(arr)\n        arr(i) = wbThis.Sheets(\"Sheet1\").Cells(6, i).Value\n    Next i\n\n    getnames = arr\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10673064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6528e58ca0a74769d74a4bb19075640e?s=128&d=identicon&r=PG&f=1", "display_name": "uservba12", "link": "https://stackoverflow.com/users/10673064/uservba12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 54435403, "answer_count": 1, "score": 0, "last_activity_date": 1548834930, "creation_date": 1548833357, "last_edit_date": 1548834781, "question_id": 54435322, "link": "https://stackoverflow.com/questions/54435322/vba-macro-function-out-of-range", "title": "VBA Macro function out of range", "body": "<pre><code>Function getNames()\n    Dim  wbThis As Workbook,  arr() As Variant, i As Long\n    Set wbThis = ThisWorkbook\n    For i = 1 To 50\n        arr(i) = wbThis.Sheets(\"Sheet1\").Cells(6, i).Value\n    Next i\n\n    For i = 1 To 50\n        MsgBox \"employee names are***** .\" + arr(i)\n    Next i\nEnd Function\n</code></pre>\n\n<p>I have above my VBA macro code in Sheet1 .In sheet1 I have one click button .on clicking the buttton,i called the getNames function. In sheet1 I have all row and column values .But when i run it shows </p>\n\n<blockquote>\n  <p>subscript out of range/run time error '9'</p>\n</blockquote>\n\n<p>I tried a lot.Anyone have any idea on this .</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016", "subform"], "comments": [{"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1548836627, "post_id": 54435078, "comment_id": 95681512, "body": "have you tried to refresh the subform ? because Me.refresh refers to the Main Form not the subform."}, {"owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 1, "creation_date": 1548836829, "post_id": 54435078, "comment_id": 95681614, "body": "try like this  <code>Me.subform.Form.Requery</code>"}, {"owner": {"reputation": 45, "user_id": 6099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48c2360355552872c6febf41272808c3?s=128&d=identicon&r=PG&f=1", "display_name": "Rang", "link": "https://stackoverflow.com/users/6099830/rang"}, "reply_to_user": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "edited": false, "score": 0, "creation_date": 1548869663, "post_id": 54435078, "comment_id": 95701769, "body": "Thanks Tarun. I tried Me.subformname.Form.Requery and the subform still comes up blank."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1548936228, "post_id": 54435078, "comment_id": 95728267, "body": "What about <code>Me.Requery</code>?"}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1548969763, "post_id": 54435078, "comment_id": 95746685, "body": "Is the subform also connected to SQL Server? If so, the Parent and Child controls in the SubForm control won&#39;t work. Refresh simply writes any changes to the current record to the database. Requery forces all the records meeting the criteria to be fetched again from the database."}, {"owner": {"reputation": 45, "user_id": 6099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48c2360355552872c6febf41272808c3?s=128&d=identicon&r=PG&f=1", "display_name": "Rang", "link": "https://stackoverflow.com/users/6099830/rang"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1548976385, "post_id": 54435078, "comment_id": 95749019, "body": "@kismert: subform has a recordsource made of a query connected to local tables only. The problem as I see it, the subform on the main form can&#39;t see ID of the mainform right after me.refresh. If I open the main form on any already existing records, then the subform reflects data correction."}, {"owner": {"reputation": 45, "user_id": 6099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48c2360355552872c6febf41272808c3?s=128&d=identicon&r=PG&f=1", "display_name": "Rang", "link": "https://stackoverflow.com/users/6099830/rang"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1548976637, "post_id": 54435078, "comment_id": 95749109, "body": "@FoxfireAndBurnsAndBurns: me.requery just requeries the combo box that has an after update event which triggers a new record created. If I add it, then nothing happens - it just perpetually requeries the combo box."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 1, "creation_date": 1548982324, "post_id": 54435078, "comment_id": 95750515, "body": "@Rang - show us the code! Perpetual requerying is definitely  <i>not</i> normal Access behavior. You&#39;ve likely accidentally setup a loop in your event code. But we&#39;re all just guessing until you give us specifics."}], "owner": {"reputation": 45, "user_id": 6099830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48c2360355552872c6febf41272808c3?s=128&d=identicon&r=PG&f=1", "display_name": "Rang", "link": "https://stackoverflow.com/users/6099830/rang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548832331, "creation_date": 1548832331, "question_id": 54435078, "link": "https://stackoverflow.com/questions/54435078/ms-access-subform-comes-up-blank-after-main-form-refreshed", "title": "MS Access subform comes up blank after main form refreshed", "body": "<p>I'm having a strange problem with my form that contains a subform (continuous view) with a visible property set to false unless a specific button is clicked. The main form is connected to a SQL table backend and when a new record is initiated the main form doesn't add an ID value right away (unless you use me.refresh). Once I put me.refresh in the code, and then make the subform visible it comes up as blank (i.e. no records found). However, if I were to open the same subform simultaneously as a regular form (outside of the main form), then it shows up fine. Also, when I remove me.refresh on the main form and toggle around by clicking on various fields in the datasheet section of a form(I use a split view) until the ID number is properly assigned and then make the subform visible, then it works fine. </p>\n\n<p>Also, initially when I tested the database with all tables being local (no SQL backend connected), the subform was showing up correctly each time (because main form ID was generated right away).</p>\n\n<p>Does anyone have any suggestions as to what workaround I can use for this problem? Or perhaps if you could suggest a code one can use to push a form to generate autonumber ID without the use of Me.Refresh. Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1548831482, "post_id": 54434738, "comment_id": 95679060, "body": "<a href=\"https://stackoverflow.com/a/30393989/4539709\">stackoverflow.com/a/30393989/4539709</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "is_accepted": true, "score": 1, "last_activity_date": 1548832595, "creation_date": 1548832595, "answer_id": 54435138, "question_id": 54434738, "link": "https://stackoverflow.com/questions/54434738/how-will-i-get-rid-of-this-error-messages/54435138#54435138", "title": "How will I get rid of this error messages?", "body": "<p>An XLM is not a FileFormat:=xlOpenXMLWorkbook. Omit the extenstion and let the FileFormat argument add the correct extension.</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=\"C:\\book1\", FileFormat:=xlOpenXMLWorkbook 'XLSX type\n</code></pre>\n\n<p>For a complete list of FileFormat types, see <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlfileformat\" rel=\"nofollow noreferrer\">xlFileFormat enumeration</a>.</p>\n"}], "owner": {"reputation": 41, "user_id": 10968889, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rvo5kNECNi8/AAAAAAAAAAI/AAAAAAAAAA8/nye7GpNeifw/photo.jpg?sz=128", "display_name": "mij nivek", "link": "https://stackoverflow.com/users/10968889/mij-nivek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 1, "accepted_answer_id": 54435138, "answer_count": 1, "score": 0, "last_activity_date": 1548833858, "creation_date": 1548830796, "last_edit_date": 1548833858, "question_id": 54434738, "link": "https://stackoverflow.com/questions/54434738/how-will-i-get-rid-of-this-error-messages", "title": "How will I get rid of this error messages?", "body": "<p>I would like to ask how to get rid of this error notification? Please see picture attached.</p>\n\n<p>I am using this VBA Code:</p>\n\n<pre><code>  Sub Sample()\n'~~&gt; Change Sheet1 to the relevant sheet\n'~~&gt; This will create a new workbook with the relevant sheet\nThisWorkbook.Sheets(\"Fuels_Slips_Issued\").Copy\n\n'~~&gt; Save the new workbook\nActiveWorkbook.SaveAs \"C:\\book1.xlm\", FileFormat:=xlOpenXMLWorkbook\n End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Pcjwa.png\" rel=\"nofollow noreferrer\">This a screen grab with the error code</a></p>\n"}, {"tags": ["excel", "vba", "copy", "paste"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 1, "creation_date": 1548829802, "post_id": 54434048, "comment_id": 95678360, "body": "You need to match the destination range area with the source area."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548832133, "post_id": 54434048, "comment_id": 95679393, "body": "You don&#39;t need to match the areas when using Selection/ActiveCell for the destination - the copied range will be copied in full."}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1548830323, "creation_date": 1548830323, "answer_id": 54434620, "question_id": 54434048, "link": "https://stackoverflow.com/questions/54434048/paste-data-into-active-cells/54434620#54434620", "title": "paste data into active cells", "body": "<p>Use</p>\n\n<pre><code>Worksheets(\"source\").Range(\"a8:c8\").CopY Destination:= Selection\n</code></pre>\n\n<p>This will work as expected provided Selection has same number of columns of copied range</p>\n"}], "owner": {"reputation": 3, "user_id": 10988371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EYpqp0tSqVw/AAAAAAAAAAI/AAAAAAAAHQE/fFN1gJPsTFU/photo.jpg?sz=128", "display_name": "Mohamed Shoman", "link": "https://stackoverflow.com/users/10988371/mohamed-shoman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 54434620, "answer_count": 1, "score": 0, "last_activity_date": 1548830323, "creation_date": 1548827410, "last_edit_date": 1548829866, "question_id": 54434048, "link": "https://stackoverflow.com/questions/54434048/paste-data-into-active-cells", "title": "paste data into active cells", "body": "<p>I write a very simple code</p>\n\n<pre><code>Sub copy_unibeton_muss()\nWorksheets(\"source\").Range(\"a8:c8\").Copy\nEnd Sub\n</code></pre>\n\n<p>The code will copy the range <code>A8:C8</code>. I added another portion to paste active cells in the active selected range.</p>\n\n<pre><code>Destination:=ActiveCell\n</code></pre>\n\n<p>But unfortunately the code paste only the data in the first row onlly. I need to paste data in all selected range may be <strong>5x3</strong> or <strong>6x3</strong> whatever I needed.</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 1135, "user_id": 8880204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c01a3a55a3ca5f25a5bdedb2777d1e4e?s=128&d=identicon&r=PG", "display_name": "Saad Ahmed", "link": "https://stackoverflow.com/users/8880204/saad-ahmed"}, "edited": false, "score": 0, "creation_date": 1548828835, "post_id": 54433845, "comment_id": 95678022, "body": "<a href=\"https://stackoverflow.com/questions/6838437/how-to-check-whether-certain-sheets-exist-or-not-in-excel-vba\">Click here</a> Hope the answer on this link helps"}, {"owner": {"reputation": 1, "user_id": 10988281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76af78d5df08617835f4924c9a716e6?s=128&d=identicon&r=PG&f=1", "display_name": "Sravani", "link": "https://stackoverflow.com/users/10988281/sravani"}, "reply_to_user": {"reputation": 1135, "user_id": 8880204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c01a3a55a3ca5f25a5bdedb2777d1e4e?s=128&d=identicon&r=PG", "display_name": "Saad Ahmed", "link": "https://stackoverflow.com/users/8880204/saad-ahmed"}, "edited": false, "score": 0, "creation_date": 1548831464, "post_id": 54433845, "comment_id": 95679056, "body": "@saad , Thank You. It helped me."}, {"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1556274669, "post_id": 54433845, "comment_id": 98391438, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6838437/how-to-check-whether-certain-sheets-exist-or-not-in-excel-vba\">How to check whether certain sheets exist or not in Excel-VBA?</a>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1556276420, "post_id": 54433845, "comment_id": 98392285, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6688131/test-or-check-if-sheet-exists\">Test or check if sheet exists</a>"}], "owner": {"reputation": 1, "user_id": 10988281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76af78d5df08617835f4924c9a716e6?s=128&d=identicon&r=PG&f=1", "display_name": "Sravani", "link": "https://stackoverflow.com/users/10988281/sravani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593588960, "creation_date": 1548826237, "last_edit_date": 1593588960, "question_id": 54433845, "link": "https://stackoverflow.com/questions/54433845/do-we-have-exists-function-to-search-for-the-excel-sheets-using-vba", "title": "Do we have &#39;Exists&#39; function to search for the excel sheets using VBA", "body": "<p>My excel workbook sheets are named with the dates(\"DD-MMM-YYYY\") and I have to get the data from each sheet in to another excel. When i use for loop(from date to date), the date for which the sheet is not available is holding back my script.Do we have something called not exists in VBA?</p>\n\n<pre><code>Sub gettheTips()\n Dim fromDate As Date\n Dim toDate As Date\n\n fromDate = InputBox(\"Enter the From date for the tips\")\n toDate = InputBox(\"Enter the To date for the tips\")\n\n    'Ensure that from date less than the to date\n    If (fromDate &lt; toDate) Then\n\n       'Select all the tips from date todate\n        For i = fromDate To toDate\n         dt = Format(i, \"d-mmm-yyyy\")\n         'MsgBox (dt)\n            'copy paste the tips from all the days to the Report sheet\n            If Worksheet(dt &lt;&gt; \"\") Then\n\n               Sheets(dt).Select\n                Range(\"E9\").Select\n                Selection.Copy\n                Sheets(\"Report\").Select\n                Range(\"E17\").Select\n                ActiveSheet.Paste\n            Else\n             MsgBox (\"The worksheet named\" &amp; dt &amp; \"does not exists\")\n            End If\n\n          Next\n    Else\n    MsgBox (\"From Date is greater than the todate entered\")\n\nEnd Sub\n</code></pre>\n\n<p>I expect the code to display messagebox worksheet named \"\" doesnot exists when the dated sheet is not available in workbook</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1548824979, "post_id": 54433625, "comment_id": 95676793, "body": "Use sumifs() to calculate the sum, based on the criteria used to calculate the original values in B3 and D3. As you don\u2019t show or explain that detail...."}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1548829607, "post_id": 54433968, "comment_id": 95678290, "body": "Nice. This works. Is there a vba solution to this without having to change the formula in the cell?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "is_accepted": true, "score": 1, "last_activity_date": 1548832333, "last_edit_date": 1548832333, "creation_date": 1548826948, "answer_id": 54433968, "question_id": 54433625, "link": "https://stackoverflow.com/questions/54433625/ref-cell-error-after-deleting-pivot-table/54433968#54433968", "title": "#REF! cell error after deleting pivot table", "body": "<p>INDEX can reference a location of the worksheet that will not change when the referenced cell is deleted.</p>\n\n<pre><code>=index(B:B, 3)+D3\n</code></pre>\n\n<p>If you want to drag that formula down, get the <em>3</em> from a cell that won't be deleted.</p>\n\n<pre><code>=index(B:B, row(D3))+D3\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 54433968, "answer_count": 1, "score": 0, "last_activity_date": 1548834380, "creation_date": 1548824613, "last_edit_date": 1548834380, "question_id": 54433625, "link": "https://stackoverflow.com/questions/54433625/ref-cell-error-after-deleting-pivot-table", "title": "#REF! cell error after deleting pivot table", "body": "<p>How do I retain a formula in a cell after deleting a pivot table? </p>\n\n<p>The scenario I am facing:</p>\n\n<p>I have a worksheet with a pivot table ranging from A3 to B13. In cell D3 to D13 I would have static values in the cell. For each row from row 4 to 13 I would be adding values from B to D and would be storing the results in column E. </p>\n\n<p>So for example, the E4 cell would contain the formula <code>=B4+D4</code>. If I were to delete the pivot table the formula in cell E4 would change to <code>=#REF!+D4</code>. </p>\n\n<p><a href=\"https://i.stack.imgur.com/RaoRD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RaoRD.png\" alt=\"enter image description here\"></a></p>\n\n<p>After I run a macro where I delete the pivot table, the formula in column E replaces values in column B with <code>#REF!</code>. The macro is simply this.</p>\n\n<pre><code>Sub DltPivotTablesFromWS()\n    Dim pt As PivotTable\n\n    For Each pt In ActiveWorkbook.ThisWorksheet.PivotTables\n        TheWS.Range(pt.TableRange2.Address).Delete Shift:=xlUp\n    Next\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/N5Kch.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N5Kch.png\" alt=\"enter image description here\"></a></p>\n\n<p>The problem occurs after deleting the pivot table. How do we avoid this problem where it changes the formula inside the cell?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1548825907, "post_id": 54433478, "comment_id": 95677044, "body": "Does your code produce errors?"}, {"owner": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1548830365, "post_id": 54433478, "comment_id": 95678565, "body": "@BradDixon no it does not"}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1548831074, "post_id": 54433478, "comment_id": 95678892, "body": "Number 2 is too broad. What kind of value? Where? Should it be done automatically when user provides certain value? What if the value is not correct for coping values? For number 3 you can just use <code>Cut</code> instead of <code>Copy</code> or delete the entire column."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1548831195, "post_id": 54433478, "comment_id": 95678933, "body": "I can\u2019t see any \u201ccertain\u201d cell value check in your code"}, {"owner": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1548831811, "post_id": 54433478, "comment_id": 95679229, "body": "@EganWolf Sorry for being unable to express it more clearly, so regarding no. 2, the cell is currently within the range of cells to be copied and it&#39;s either left blank or &quot;Y&quot;. It doesn&#39;t have to be automatic at the time of filling in the cell just when the commandbutton is pressed. Thanks for your suggestion regarding  <code>cut</code> and <code>delete</code> however for me only the latter seemed to work. Replacing <code>copy</code> with <code>cut</code> gave me a run-time error 1004 (PasteSpecial method of Range class failed)"}], "answers": [{"tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": true, "score": 0, "last_activity_date": 1548832881, "creation_date": 1548832881, "answer_id": 54435216, "question_id": 54433478, "link": "https://stackoverflow.com/questions/54433478/excel-macro-vba-copy-cell-range-to-another-sheet-transposed-and-based-on-ano/54435216#54435216", "title": "Excel Macro &amp; VBA, Copy Cell Range to another sheet (transposed and based on another value)", "body": "<p>Check this one. It checks the value of E10. If it's \"Y\", then data is copied and deleted from original place. Otherwise, it shows a message to the user.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Application.ScreenUpdating = False\n    Dim xSheet As Worksheet\n    Set xSheet = ActiveSheet\n        If xSheet.Name &lt;&gt; \"Definitions\" And xSheet.Name &lt;&gt; \"fx\" And xSheet.Name &lt;&gt; \"Needs\" Then\n            If xSheet.Range(\"E10\")=\"Y\"\n                xSheet.Range(\"E6:E200\").Copy\n                Worksheets(\"Sheet1\").Range(\"E6:AZ6\").PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True\n                xSheet.Columns(\"E\").Delete\n            Else\n                MsgBox(\"Data entry not ready!\")\n            End If\n        End If\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 54435216, "answer_count": 1, "score": 0, "last_activity_date": 1548832881, "creation_date": 1548823434, "last_edit_date": 1548830323, "question_id": 54433478, "link": "https://stackoverflow.com/questions/54433478/excel-macro-vba-copy-cell-range-to-another-sheet-transposed-and-based-on-ano", "title": "Excel Macro &amp; VBA, Copy Cell Range to another sheet (transposed and based on another value)", "body": "<p>I have tried to frankenstein a solution from different threads but I am very much a newbie to VBA and programming, so it has not been going too well...</p>\n\n<p>Here's some basic info:</p>\n\n<ul>\n<li>I have 2 Sheets within the same workbook (Database and Data entry)</li>\n<li>They contain the same headers, but are transposed (Database has the headers in the columns while Data entry has them in the rows)</li>\n</ul>\n\n<p>Now, I am looking for 3 things (ideally in one compact solution)</p>\n\n<ol>\n<li><p>Have a Command Button that copies and transposes the most recent range (leftmost column) from Data Entry to Database. (This is done in the code below)</p></li>\n<li><p>This should be done depending on a certain cell value on the data entry sheet (ideally that cell could stay part of the copied range, however this is not crucial)</p></li>\n<li><p>Delete  the original range from the data entry sheet.</p></li>\n</ol>\n\n<p>As I said I'm just starting to work with VBA so I am completely unsure how to go about this, I have attached what I gathered so far (excludes Nr.2 and feels very cumbersome overall). Any help is very much appreciated!</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Application.ScreenUpdating = False\n    Dim xSheet As Worksheet\n    Set xSheet = ActiveSheet\n        If xSheet.Name &lt;&gt; \"Definitions\" And xSheet.Name &lt;&gt; \"fx\" And xSheet.Name &lt;&gt; \"Needs\" Then\n            xSheet.Range(\"E6:E200\").Copy\n            Worksheets(\"Sheet1\").Range(\"E6:AZ6\").PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True\n        End If\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548821228, "post_id": 54433203, "comment_id": 95675937, "body": "A <code>Worksheet_Change</code> event only works when a cell is physically changed. Changes made by links or formulas do not constitute a physical change"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1548822866, "post_id": 54433203, "comment_id": 95676301, "body": "here&#39;s a possible workaround for firing an event on change. <a href=\"https://stackoverflow.com/a/39260908/3961708\">stackoverflow.com/a/39260908/3961708</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 0, "last_activity_date": 1548833644, "creation_date": 1548833644, "answer_id": 54435394, "question_id": 54433203, "link": "https://stackoverflow.com/questions/54433203/execute-a-macro-automatically-when-the-linked-cell-of-a-combo-box-changes/54435394#54435394", "title": "Execute a macro automatically when the linked cell of a combo box changes", "body": "<p>As mentioned before, a <code>Worksheet_Change</code> event will only be triggered by physically changing a cell, and thus your linked cell won't have any effect.</p>\n\n<p>If it's a cell in another <code>wb</code> that needs to trigger your <code>Generate</code> Sub, then I'd advise using a Worksheet_Change event for said wb.</p>\n\n<p>In my own project, I have a sub in a <code>regular module</code>:</p>\n\n<pre><code>Dim AddNew As Workbook\nSet AddNew = Workbooks(\"\") 'change this\nSet oWb.Workbook = AddNew\n</code></pre>\n\n<p>Then, in a <code>class module</code>:</p>\n\n<pre><code>Public WithEvents m_wb As Workbook\nPublic Property Set Workbook(wb As Workbook)\nSet m_wb = wb\nEnd Property\n\nPublic Property Get Workbook() As Workbook\nSet Workbook = m_wb\nEnd Property\n\nPublic Sub m_wb_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n'In here, you could trigger the Generate Sub if a specific cell changes\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 10916457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e1084489e013729ee33130bb5c2b137?s=128&d=identicon&r=PG&f=1", "display_name": "ZDene", "link": "https://stackoverflow.com/users/10916457/zdene"}, "is_accepted": true, "score": 0, "last_activity_date": 1548889323, "creation_date": 1548889323, "answer_id": 54450882, "question_id": 54433203, "link": "https://stackoverflow.com/questions/54433203/execute-a-macro-automatically-when-the-linked-cell-of-a-combo-box-changes/54450882#54450882", "title": "Execute a macro automatically when the linked cell of a combo box changes", "body": "<p>The simplest solution was to give the first combo box an input range and also assign it the <code>Generate</code> macro</p>\n"}], "owner": {"reputation": 3, "user_id": 10916457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e1084489e013729ee33130bb5c2b137?s=128&d=identicon&r=PG&f=1", "display_name": "ZDene", "link": "https://stackoverflow.com/users/10916457/zdene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 54450882, "answer_count": 2, "score": 0, "last_activity_date": 1548889323, "creation_date": 1548820993, "last_edit_date": 1548821162, "question_id": 54433203, "link": "https://stackoverflow.com/questions/54433203/execute-a-macro-automatically-when-the-linked-cell-of-a-combo-box-changes", "title": "Execute a macro automatically when the linked cell of a combo box changes", "body": "<p>I have a series of 2 combo boxes. I have a macro called <code>Generate</code> which will change the options in the second combo box based on the number the first combo box returns. However this requires the user to press a button to execute this macro. I would like this macro to execute automatically when the number in the first combo box's linked cell changes. </p>\n\n<p>This is the code I have previously tried, however the change in the link cell which is <code>B2</code> doesn't seem to trigger the event.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"B2\")) Is Nothing Then Generate\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548821521, "post_id": 54432975, "comment_id": 95676001, "body": "Interesting problem. You can use a <code>Change_Event</code> of some sorts and then change the displayed text to <code>Right(Combobox, 2)</code>. I&#39;m not sure if this will preserve the drop down though. What if they click the wrong state? I&#39;m not sure what it will look like when they go back in without writing out all the code myself so you can test this and see how it goes"}], "answers": [{"tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 2, "last_activity_date": 1548830391, "creation_date": 1548830391, "answer_id": 54434642, "question_id": 54432975, "link": "https://stackoverflow.com/questions/54432975/how-do-i-format-a-combobox-in-order-to-display-a-selection-but-abbreviate-that-s/54434642#54434642", "title": "How do I format a combobox in order to display a selection but abbreviate that selection after its made?", "body": "<p>Make sure the states are in two columns, first column the abbreviation, second column the full name. Set the following properties for the combobox:</p>\n\n<ul>\n<li>BoundColumn: 2 (or 1 if you want the linkedcell to receive the<br>\nabbreviated state name)</li>\n<li>ColumnCount: 2 </li>\n<li>ListSource: A1:B55 (or wherever your states are    located)</li>\n<li>ColumnWidths: 30;100</li>\n</ul>\n\n<p>Now if the dropdown is \"dropped\" you see both abbreviation and full state name. If the state is chosen, it only displays the abbreviation.</p>\n"}], "owner": {"reputation": 33, "user_id": 9701145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "D Brown", "link": "https://stackoverflow.com/users/9701145/d-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548834257, "creation_date": 1548819101, "last_edit_date": 1548834257, "question_id": 54432975, "link": "https://stackoverflow.com/questions/54432975/how-do-i-format-a-combobox-in-order-to-display-a-selection-but-abbreviate-that-s", "title": "How do I format a combobox in order to display a selection but abbreviate that selection after its made?", "body": "<p>I have loaded a combobox with all the states in the union with their respective abbreviations...(example \"Florida - FL\").  And it shows this in this format when the user is selecting a state from this combo-box.  I want the user to see the state in this format but when the user selects the state, I would like the field to only read \"FL\" and not the entire name as stated before the selection is made.  So when the drop down activates you see the name but after selected only the abbreviation is displayed.  Please help.</p>\n\n<p>I have tried field formatting</p>\n\n<p>I want the user to see the state in this format but when the user selects the state, I would like the field to only read \"FL\" and not the entire name as stated before the selection is made.  So when the drop down activates you see the name but after selected only the abbreviation is displayed.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1548821315, "post_id": 54432958, "comment_id": 95675961, "body": "What does not work about the provided code? Be specific so we can help"}, {"owner": {"reputation": 1, "user_id": 10741848, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gXEsKsfnibc/AAAAAAAAAAI/AAAAAAAAAPs/WEle7Bjjnjg/photo.jpg?sz=128", "display_name": "Muhammad Hazrin", "link": "https://stackoverflow.com/users/10741848/muhammad-hazrin"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548834596, "post_id": 54432958, "comment_id": 95680602, "body": "@urdearboy the output seems to be incorrect. i already update the output."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10741848, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gXEsKsfnibc/AAAAAAAAAAI/AAAAAAAAAPs/WEle7Bjjnjg/photo.jpg?sz=128", "display_name": "Muhammad Hazrin", "link": "https://stackoverflow.com/users/10741848/muhammad-hazrin"}, "edited": false, "score": 0, "creation_date": 1548906180, "post_id": 54441028, "comment_id": 95714205, "body": "Sir, thanks for the code and i totally understand the code. There is no error in coding when i run but the output is not showing (blank). i will update the( results ) as picture above. Do you know what error i could make?"}, {"owner": {"reputation": 586, "user_id": 9149934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ff11850461a5d4b495f04c3b895010?s=128&d=identicon&r=PG&f=1", "display_name": "earthling", "link": "https://stackoverflow.com/users/9149934/earthling"}, "reply_to_user": {"reputation": 1, "user_id": 10741848, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gXEsKsfnibc/AAAAAAAAAAI/AAAAAAAAAPs/WEle7Bjjnjg/photo.jpg?sz=128", "display_name": "Muhammad Hazrin", "link": "https://stackoverflow.com/users/10741848/muhammad-hazrin"}, "edited": false, "score": 0, "creation_date": 1548933219, "post_id": 54441028, "comment_id": 95726425, "body": "Hello Muhammad, I made an error. It is not possible to make this reference: workbook.worksheet. I will correct my answer later"}, {"owner": {"reputation": 1, "user_id": 10741848, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gXEsKsfnibc/AAAAAAAAAAI/AAAAAAAAAPs/WEle7Bjjnjg/photo.jpg?sz=128", "display_name": "Muhammad Hazrin", "link": "https://stackoverflow.com/users/10741848/muhammad-hazrin"}, "edited": false, "score": 0, "creation_date": 1549610196, "post_id": 54441028, "comment_id": 95971625, "body": "sir can you help?"}, {"owner": {"reputation": 586, "user_id": 9149934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ff11850461a5d4b495f04c3b895010?s=128&d=identicon&r=PG&f=1", "display_name": "earthling", "link": "https://stackoverflow.com/users/9149934/earthling"}, "reply_to_user": {"reputation": 1, "user_id": 10741848, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gXEsKsfnibc/AAAAAAAAAAI/AAAAAAAAAPs/WEle7Bjjnjg/photo.jpg?sz=128", "display_name": "Muhammad Hazrin", "link": "https://stackoverflow.com/users/10741848/muhammad-hazrin"}, "edited": false, "score": 0, "creation_date": 1552901560, "post_id": 54441028, "comment_id": 97171523, "body": "Hello Muhammad, do you still need help or did you figure it out?"}], "tags": [], "owner": {"reputation": 586, "user_id": 9149934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ff11850461a5d4b495f04c3b895010?s=128&d=identicon&r=PG&f=1", "display_name": "earthling", "link": "https://stackoverflow.com/users/9149934/earthling"}, "is_accepted": false, "score": 0, "last_activity_date": 1548933258, "last_edit_date": 1548933258, "creation_date": 1548852584, "answer_id": 54441028, "question_id": 54432958, "link": "https://stackoverflow.com/questions/54432958/vba-how-to-copy-corresponding-column-values-from-another-workbook-if-values-matc/54441028#54441028", "title": "VBA how to copy corresponding column values from another workbook if values matches", "body": "<p>try this:</p>\n\n<p>WIP\nWIP: reference workbook.worksheet ist not possible\nWIP</p>\n\n<pre><code>    Dim i as Integer 'will run through workbook 2\n    Dim j as Integer 'will run through workbook 1\n\n    Dim wbOne as Workbook\n    Set wbOne = Workbook(\"WorkbookOne\")\n    Dim wbTwo as Workbook\n    Set wbTwo = Workbook(\"WorkbookTwo\") 'replace with correct naming\n\n    Dim wsOne as Worksheet\n    Set wsOne = Worksheets(\"WorksheetOne\")\n    Dim wsTwo as Worksheet\n    Set wsTwo = Worksheets(\"WorksheetTwo\")\n\n\n    for i = 1 to 1000 'length wb1\n        for j = 1 to 10000 'length wb2\n            if wbTwo.wsTwo.cells(i,1).value = wbOne.wsOne.cells(j,1).value then \n                wbTwo.wsTwo.cells(i,3).value = wbOne.wsOne.cells(j,8).value\n                exit for 'exit j loop because match was found\n            end if\n        next j\n    next i\n\n</code></pre>\n\n<p>you can adjust the length of your workbooks dynamically. If the if-statement is not clear, just ask.\nAnother tip: you seem to have a large amount of data, so a double-loop might take a long time to compute. You can make this program <strong>drastically</strong> faster by saving all of the data in arrays and then execute the double loop on the arrays.</p>\n"}], "owner": {"reputation": 1, "user_id": 10741848, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gXEsKsfnibc/AAAAAAAAAAI/AAAAAAAAAPs/WEle7Bjjnjg/photo.jpg?sz=128", "display_name": "Muhammad Hazrin", "link": "https://stackoverflow.com/users/10741848/muhammad-hazrin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1548933258, "creation_date": 1548818917, "last_edit_date": 1548906244, "question_id": 54432958, "link": "https://stackoverflow.com/questions/54432958/vba-how-to-copy-corresponding-column-values-from-another-workbook-if-values-matc", "title": "VBA how to copy corresponding column values from another workbook if values matches", "body": "<p>I have done several research regarding the excel vba. But i still coudn't find the solution to my problem.</p>\n\n<p>The reason i use macros is because it have to be done weekly. What the macros should do is when the values matches column A (column <strong><em>item</em></strong>) from both workbook, it will copy the Unallocation stock from workbook 2 (column H) to (column C) in workbook 1.</p>\n\n<p>Workbook 2<br>\n<a href=\"https://i.stack.imgur.com/judcw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/judcw.png\" alt=\"IMAGE of workbook 2 \"></a></p>\n\n<p>Workbook 1<br>\n<a href=\"https://i.stack.imgur.com/l87hb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l87hb.png\" alt=\"IMAGE of workbook 1\"></a></p>\n\n<p>Below, partial code that is not working. Feel free to share your own code because i'm not good in VBA as well. (if possible please include comment so i easy to understand)</p>\n\n<pre><code>  FindString = ws1.Range(\"A\" &amp; j) 'stock item number\n  If Trim(FindString) &lt;&gt; \"\" Then ' if item number not equal to blank\n    With ws3.Range(\"A:A\") 'searches all of column A of sum up sheet\n        Set Rng = .Find(What:=FindString, _\n                        After:=.Cells(.Cells.count), _\n                       LookIn:=xlValues, _\n                        LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False)\n        If Not Rng Is Nothing Then\n         '---If intersite exists in ws3\n                '---------VLOOKUP ------------\n\n        'If (ws1.Range(\"H\" &amp; j).Value &gt; ws3.Range(\"B\" &amp; j).Value) Then\n\n          ' here = Rng.Row\n\n\n            'ws1.Range(\"A\" &amp; j &amp; \":R\" &amp; j).Copy ws4.Range(\"A\" &amp; lrow4)              'Copy stockworkbook range A(j) until R(j)  until paste to worksheet Output\n            'lrow4 = ws4.Cells(ws4.Rows.count, \"A\").End(xlUp).Row + 1                 'lastrow tambah 1\n\n          ws1.Range(\"H\" &amp; j).Copy ws3.Range(\"c\" &amp; lrow4)\n          lrow4 = ws3.Cells(ws4.Rows.count, \"c\").End(xlUp).Row + 1\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/001CA.png\" rel=\"nofollow noreferrer\">Image: No error in coding but the output is wrong</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/3oymh.png\" rel=\"nofollow noreferrer\">Image: Result of blank output in column C</a></p>\n"}, {"tags": ["vba", "powerpoint", "ribbonx"], "comments": [{"owner": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "edited": false, "score": 0, "creation_date": 1551657411, "post_id": 54432885, "comment_id": 96709082, "body": "I&#39;ve added a link to code for two minimal add-ins which will show the error messages (from time to time)."}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "edited": false, "score": 0, "creation_date": 1548983402, "post_id": 54445204, "comment_id": 95750721, "body": "I&#39;ve tried to get the error message to re-appear by referencing <code>Application.ActiveWindow.Selection.Type</code> and <code>Application.ActivePresentation.Path</code> in Auto_Open, getEnabled and onLoad calls  but have failed to get the error message to re-appear when PowerPoint opens (in fact no error messages appear). Logging to a file shows that where these errors occur the rest of the Auto_Open (or whatever) function is skipped. Error messages only occur if you then close PowerPoint without opening/creating a document. Have you been able to get the error message to re-appear once it had gone?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "edited": false, "score": 0, "creation_date": 1549045999, "post_id": 54445204, "comment_id": 95777449, "body": "@neilt17 No, once the error occurred and I dismissed it, everything worked as expected. In my case, it&#39;s either something to do with accessing ActivePresentation.Path while PPT is still initializing (so there IS no active presentation) or it&#39;s do do with subsequent processing of the alleged path string (but that&#39;s in fact null)."}, {"owner": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "edited": false, "score": 0, "creation_date": 1549133672, "post_id": 54445204, "comment_id": 95798039, "body": "Thank you for this. Just to clarify, if you were to put back the version of the ppam where you saw the error message (&quot;PowerPoint can&#39;t start this feature because...&quot;) you do or you don&#39;t still see that error message?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "edited": false, "score": 0, "creation_date": 1549139936, "post_id": 54445204, "comment_id": 95799864, "body": "The problem PPAM produces the error messages every time I start PPT up with the add-in loaded (in this case via an entry in the registry)."}, {"owner": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "edited": false, "score": 0, "creation_date": 1549151124, "post_id": 54445204, "comment_id": 95802248, "body": "That&#39;s great. What&#39;s frustrating about this is problem is that I can work on it until it goes away - but when I re-introduce the allegedly offending code, there&#39;s a point where the problem does not come back: and reloading an earlier version of the ppam that was producing errors no longer produces them. I am not convinced that I&#39;m ever finding the source of the error. Could something else be going on in the start-up process that I&#39;m not seeing and perhaps some clean-up of something is needed (via Auto_Open or onLoad say) - but what? Could you post some code that will always produce this error?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "edited": false, "score": 0, "creation_date": 1549212379, "post_id": 54445204, "comment_id": 95813953, "body": "I&#39;ll try to cobble something up but right now I&#39;m juggling too many other balls, knives and chainsaws."}, {"owner": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "edited": false, "score": 0, "creation_date": 1549222201, "post_id": 54445204, "comment_id": 95817098, "body": "Thank you very much Steve."}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1559915709, "post_id": 54445204, "comment_id": 99580292, "body": "I too am facing this issue and have noticed that the start up behviour is inconsistent. Sometimes I get the error, sometimes I don&#39;t. Sometimes the orange PowerPoint startup splash screen doesn&#39;t show &quot;Loading Add-ins (X of Y) + add-in name&quot; and sometimes it does. I have the Microsoft PowerPoint Code Compatibility Inspector add-in installed and sometimes I see that loading and sometimes I don&#39;t. When I do, the VBA error is always triggered."}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1560202724, "post_id": 54445204, "comment_id": 99650816, "body": "Another observation having added a custom modeless MsgBox to my pair of add-ins is that &#39;sometimes&#39; Presentations.Count = 0 as the add-ins are initialised but more often this is 1. So there is a random timing issue in the add-in loader to be considered. As Neil points out, this feels like it&#39;s related to cutomUI callbacks rather than Auto_Open or onLoad events."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1560436757, "post_id": 54445204, "comment_id": 99743910, "body": "@JamieGarroch How do you start PPT? If by locating a particular presentation and doubleclicking it AND if you have the Win Explorer preview pane open, then there will be a hidden instance of PPT open with at least one presentation added to its presentations.count"}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1548865829, "creation_date": 1548865829, "answer_id": 54445204, "question_id": 54432885, "link": "https://stackoverflow.com/questions/54432885/periodically-getting-vba-break-mode-error-messages-when-loading-ribbon-controls/54445204#54445204", "title": "Periodically getting VBA break mode error messages when loading ribbon controls on PowerPoint start up", "body": "<p>I ran into this same situation just yesterday, and from your description, we may have encountered something similar. </p>\n\n<p>You can get this error when you reference e.g. the current presentation's path or the current selection while the add-in is loading ... ie, there IS no open presentation and by extension there can be no current selection.</p>\n\n<p>I was able to track down the exact line of code that triggered the error by writing a little function that pops a message box with some descriptive text and optionally the name of the current subroutine in the title:</p>\n\n<pre><code>Public Sub UberMsg(sMsgString As String, Optional sRoutine As String = \"Debug Msg\")\n    If UberMsg Then\n        Call MsgBox(sMsgString, vbOKOnly, sRoutine)\n    End If\nEnd Sub\n</code></pre>\n\n<p>Declared as globals a string called sRoutine and a bool called UberMsg (set to True)</p>\n\n<p>Then at various points in my AutoOpen sub and subs called from it:</p>\n\n<p>This, once at the begging of the routine:</p>\n\n<pre><code>sRoutine = \"{the current procedure name}\"\n</code></pre>\n\n<p>And copy/paste/edit this just before every suspect code point:</p>\n\n<pre><code>UberMsg \"AppInit entry point\", sRoutine\n</code></pre>\n\n<p>It only took a few iterations of saving PPAMs and retesting to locate the problem area and fix it.</p>\n\n<p>I'll set the UberMsg boolean to false and leave all of this in place in case it's needed later.  </p>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "is_accepted": false, "score": 1, "last_activity_date": 1557028193, "creation_date": 1557028193, "answer_id": 55988674, "question_id": 54432885, "link": "https://stackoverflow.com/questions/54432885/periodically-getting-vba-break-mode-error-messages-when-loading-ribbon-controls/55988674#55988674", "title": "Periodically getting VBA break mode error messages when loading ribbon controls on PowerPoint start up", "body": "<p>Unfortunately I have been unable to make it so this problem will always appear - whatever set up I have, the problem seems to appear randomly and to disappear randomly. </p>\n\n<p>My solution is to sidestep the problem completely and not to use Auto_Open (this problem never occurs if Auto_Open is not used) and not to use _onLoad <a href=\"http://www.vbaexpress.com/forum/showthread.php?59676-Events-handlers-not-firing-on-new-presentations-in-Windows-7&amp;highlight=\" rel=\"nofollow noreferrer\">which can also be problematic</a>. This means that the buttons will always be available even for contexts where they won't work. </p>\n\n<p>To make this situation a bit more user friendly (and not just have some irritating message box error popping up to tell people they've clicked on an invalid button), I have arranged it so that if a user selects a button which doesn't apply to the current context - for example the operation requires them to select some text for it to work but they haven't - a modeless dialog will pop up which contains an explanation of what they need to do to get the button to work (e.g. select some text) plus an exact replica of the buttons from the group in the ribbon in which the buttons enable/disable themselves correctly according to the context.</p>\n\n<p>I've created these buttons by cropping screenshots of each button in each of their three states (hover, enabled, disabled) and layering them on top of each other in a userform. I use the App_WindowSelectionChange event to change the ZOrder of the relevant buttons so that when the appropriate thing is selected the enabled button comes to the top, and, given that the right thing is selected, the hover version of the button will come to the top when the mouse is over it (MouseMove trigger in the userform) - this is also the version of the button which will trigger any code when clicked.</p>\n\n<p>I think this is not a bad solution because the user gets more information about when they can use the buttons and they can have a dialog present that works in the same way as the ribbon should have worked if they so wish. Our button groups are quite small (no more than four buttons) so the dialog is quite small too and easy to have displayed and pushed out of the way - it might not be so satisfactory for groups with lots of buttons in them.</p>\n"}], "owner": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 959, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1557028193, "creation_date": 1548818347, "last_edit_date": 1551657229, "question_id": 54432885, "link": "https://stackoverflow.com/questions/54432885/periodically-getting-vba-break-mode-error-messages-when-loading-ribbon-controls", "title": "Periodically getting VBA break mode error messages when loading ribbon controls on PowerPoint start up", "body": "<p>I have created an add-in for PowerPoint which creates a grid of objects from a selection of objects that you select.</p>\n\n<p>The add-in uses a context-sensitive control in the ribbon so that the control is only available when one or more shapes are selected (otherwise it is greyed out).</p>\n\n<p>When I open PowerPoint (with this add-in enabled), I may get the following error message: \"PowerPoint can't start this feature because you currently have a Visual Basic for Applications project in break mode.\"</p>\n\n<p>The message repeats as each custom control is loaded onto the ribbon (the controls progressively appear as you click ok to each error), and once PowerPoint has started the controls are present in the ribbon but are greyed out, and do not get activated when a shape is selected.</p>\n\n<p>The error is very hard to fault find: it may just disappear and not re-appear on a particular machine, but then may be present on a different machine for the same set-up (and exactly the same add-in code). It may occur if this add-in is loaded on its own, or it might only occur if it is loaded with other add-ins.</p>\n\n<p>When the error messages appear, I may fault-find by commenting out sections of code, save and re-add it as a ppam add-in until the error messages disappear: and then to try and verify that I'd found the source of the problem, uncomment out the code I'd commented out until the error re-appears - except that usually the error does not re-appear.</p>\n\n<p>The error is not seen if PowerPoint starts with an open document. Also the error might only be seen when PowerPoint is set up to start up with its welcome screen rather than a new document.</p>\n\n<p>My current office version is: 1812 (office 365 - desktop), build 11126.20196 (but I have seen this on other versions) and Windows 10 version 1803.</p>\n\n<p>I have tried:</p>\n\n<ul>\n<li><p>Exporting all my code to text files and importing it back using a version of Rob Bovey's code cleaner adapted for PowerPoint: <a href=\"http://www.tushar-mehta.com/powerpoint/vba_codecleaner/index.htm\" rel=\"nofollow noreferrer\">http://www.tushar-mehta.com/powerpoint/vba_codecleaner/index.htm</a></p></li>\n<li><p>Trying to force the error messages to appear to try and work out what a possible source of the errors could be - but have so far been unable to do this:</p>\n\n<ul>\n<li><p>Deliberately inserting an error in any of the code run when PowerPoint loads (such as divide by zero) results in the usual debug error messages and not the error messages that I am having a problem with.</p></li>\n<li><p>Introducing delays in Auto_Open, onLoad and getEnabled calls to try and get any of these calls that might run asynchronously to overlap following a <a href=\"https://social.msdn.microsoft.com/Forums/en-US/e3226183-de21-43cf-944c-32fc97410f52/break-mode-error-messages-when-loading-ribbon-controls-on-powerpoint-start-up#7ddce645-5bf5-4ef9-a8ed-eb09e9c0fbd3\" rel=\"nofollow noreferrer\">suggestion that Auto_Open and onLoad calls may be fighting with each other</a>: but although I can get Auto_Open and onLoad calls to overlap, <a href=\"https://social.msdn.microsoft.com/Forums/en-US/e3226183-de21-43cf-944c-32fc97410f52/break-mode-error-messages-when-loading-ribbon-controls-on-powerpoint-start-up#5c54ed9b-f5b7-438f-80b3-7f84dc488b2f\" rel=\"nofollow noreferrer\">this hasn't caused the re-appearance of the error messages</a>.</p></li>\n<li><p>Seeing if the problem might happen due to a problem when PowerPoint was last closed: I put PowerPoint in break mode, then forced it to stop with the task manager and then re-started PowerPoint - but no errors seen. Also I have tried having another office VBA project in break mode (Excel) and then start PowerPoint - again no errors seen.</p></li>\n</ul></li>\n<li><p>I've tried comparing the registry (HKCU) for when PowerPoint is in break mode and when it isn't to see if that might give a clue - but there was nothing significant that was different.  </p></li>\n</ul>\n\n<p>The XML for the GridMaker add-in looks like this (in customUI.xml - I open the pptm file in Visual Studio with the Open XML Package Editor extension):</p>\n\n<pre><code>&lt;customUI onLoad=\"GMApplicationEventsModule.gmRibbonUI_onLoad\" xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\" xmlns:nsCommtap=\"CommtapNamespace\"&gt;\n  &lt;ribbon startFromScratch=\"false\"&gt;\n    &lt;tabs&gt;\n      &lt;tab idMso=\"TabHome\"&gt;\n        &lt;group id=\"gridMakerGroup\" label=\"Grid Maker\"&gt;\n          &lt;button id=\"gmMakeGrid\"\n                  label=\"Make Into Grid\"\n                  imageMso=\"TableInsert\"\n                  size=\"normal\"\n                  onAction=\"MainModule.makeGrid\"\n                  getEnabled=\"GMApplicationEventsModule.gm_GetEnabled\" /&gt;\n        &lt;/group&gt;\n      &lt;/tab&gt;\n    &lt;/tabs&gt;\n  &lt;/ribbon&gt;\n&lt;/customUI&gt;\n</code></pre>\n\n<p>The GMApplicationEventsModule looks like this:</p>\n\n<pre><code>Option Explicit\n\nPrivate m_oMyRibbon As IRibbonUI\nPrivate m_boolShapeSelected As Boolean\nPrivate m_oAppEvents As CGMApplicationEvents\n\nPublic Function get_m_oMyRibbon() As IRibbonUI\n  Set get_m_oMyRibbon = m_oMyRibbon\nEnd Function\n\nPublic Sub set_m_boolShapeSelected(value As Boolean)\n  m_boolShapeSelected = value\nEnd Sub\n\nPublic Function get_m_boolShapeSelected() As Boolean\n  get_m_boolShapeSelected = m_boolShapeSelected\nEnd Function\n\nPublic Sub gm_GetEnabled(control As IRibbonControl, ByRef returnedVal)\n  returnedVal = True\n  If control.Id = \"gmMakeGrid\" Then\n    returnedVal = GMApplicationEventsModule.get_m_boolShapeSelected\n  End If\nEnd Sub\n\nPublic Sub gmRibbonUI_onLoad(Ribbon As IRibbonUI)\n  Set m_oMyRibbon = Ribbon\nEnd Sub\n\nPublic Sub Auto_Open()\n  If m_oAppEvents Is Nothing Then\n    Set m_oAppEvents = New CGMApplicationEvents\n  End If\n  Set m_oAppEvents.App = Application\nEnd Sub\n</code></pre>\n\n<p>Class CGMApplicationEvents:</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents App As Application\n\nPrivate Sub App_WindowSelectionChange(ByVal Sel As Selection)\n\n  If Application.ActiveWindow.Selection.Type &lt;&gt; ppSelectionShapes Then\n    GMApplicationEventsModule.set_m_boolShapeSelected False\n  Else\n    GMApplicationEventsModule.set_m_boolShapeSelected True\n  End If\n\n  If Not GMApplicationEventsModule.get_m_oMyRibbon Is Nothing Then\n    Dim oRibbon As IRibbonUI\n    Set oRibbon = GMApplicationEventsModule.get_m_oMyRibbon\n    oRibbon.InvalidateControl \"gmMakeGrid\"\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>I have another two add-ins which look like this. The onAction on the gmMakeGrid button (above) runs some code which creates a grid of shapes from a shape selection. The other two add-ins simply show a message when their buttons are clicked. But it should be possible (or not - as the errors seem to be intermittent) to see the errors if the code shown here is just linked to showing a message box.</p>\n\n<h2>Making the error message appear</h2>\n\n<p>I am now able to make the error message (\"PowerPoint can't start this feature...\") appear, which also shows that the source of the error could originate from somewhere other than the add-in where the error is seen.</p>\n\n<p>I have one add-in - app1-basic (using the code as described above) which is enabled. I have a second macro (app2-basic.pptm) file (also as described above) in which I have put a \"Stop\" statement in the onLoad procedure. With PowerPoint closed, open app2-basic.pptm. Whilst opening, the VBE will open and code execution will stop at the stop statement. Now close PowerPoint (by clicking on the \"X\" in the partially opened PowerPoint). This will display the error message.</p>\n\n<p>The error message appears to be triggered because PowerPoint is trying to call the getEnabled procedure in the add-in but is unable to because the macro being opened has put it in break mode. Logging seems to support this:</p>\n\n<pre>\nTime                    Time tick       VBA Project     Module                  Procedure               Comment\n\nStop in app2-basic onLoad which is opened as pptm (not add-in), one other add-in enabled (app1-basic)                   \n25/02/19 15:17:58:258   158,650,603,696 app1-basic      ApplicationEventsModule Auto_Open               Called\n25/02/19 15:17:58:258   158,650,619,479 app1-basic      ApplicationEventsModule Auto_Open               Completed\n25/02/19 15:17:59:259   158,653,089,479 app1-basic      ApplicationEventsModule set_m_boolShapeSelected Called\n25/02/19 15:17:59:259   158,653,105,936 app1-basic      ApplicationEventsModule get_m_oMyRibbon         Called\n25/02/19 15:17:59:259   158,653,421,625 app1-basic      ApplicationEventsModule gmRibbonUI_onLoad       Called.\n25/02/19 15:17:59:259   158,653,477,892 app1-basic      ApplicationEventsModule gmRibbonUI_onLoad       Completed\n25/02/19 15:17:59:259   158,653,560,560 app2-basic      ApplicationEventsModule gmRibbonUI_onLoad       Called.\n\nNormal open then close - app1 - with no errors                  \n25/02/19 15:34:45:245   161,505,047,523 app1-basic      ApplicationEventsModule Auto_Open               Called\n25/02/19 15:34:45:245   161,505,061,039 app1-basic      ApplicationEventsModule Auto_Open               Completed\n25/02/19 15:34:54:254   161,531,088,269 app1-basic      ApplicationEventsModule gmRibbonUI_onLoad       Called.\n25/02/19 15:34:54:254   161,531,110,752 app1-basic      ApplicationEventsModule gmRibbonUI_onLoad       Completed\n25/02/19 15:34:54:254   161,531,169,707 app1-basic      ApplicationEventsModule app1_GetEnabled Called: Control.id: app1ShapeSelectedMsg\n25/02/19 15:34:54:254   161,531,200,726 app1-basic      ApplicationEventsModule get_m_boolShapeSelected Called\n25/02/19 15:34:54:254   161,531,215,706 app1-basic      ApplicationEventsModule app1_GetEnabled         Completed: Control.id: app1ShapeSelectedMsg\n</pre>\n\n<p>Further comments:</p>\n\n<ul>\n<li><p>From time to time, after a number of rounds of making errors appear and then correcting them, this error message can then appear when loading add-ins where there are no errors. I've still not been able to come up with a repeatable sequence of actions that causes this to happen.</p></li>\n<li><p>It <em>is</em> looking like the error is likely to be arising from somewhere else other than the add-in which is failing to load properly because of the error. It also seems possible that the error could be due to a problem with the state in which PowerPoint is opened - perhaps due to a problem encountered when it was last closed.</p></li>\n</ul>\n\n<h2>Code to demonstrate the errors</h2>\n\n<p><a href=\"http://code.commtap.org/vba/break-mode-error-tests/test-code.html.php\" rel=\"nofollow noreferrer\">Full code which produces this error message from time to time</a>. </p>\n"}, {"tags": ["excel", "vba", "autofill"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1548818895, "post_id": 54432765, "comment_id": 95675433, "body": "You don&#39;t seem to need code as much as you need a plan. (A) From your drop-down you select 1 of 7 items. (B) In A6:A11 you wish to enter 6 presumably different values. (C) If these six values should be different for each of the possible 7 selections in the drop-down you would need 7 lists of 6 items each. Where are they? (D) Depending upon which item is selected from the drop-down a different list would be applied to A6:A11. How do you intend to identify the 7 lists by means of the selection made?"}, {"owner": {"reputation": 745, "user_id": 1382244, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/8wVu8.jpg?s=128&g=1", "display_name": "Giovanni Di Toro", "link": "https://stackoverflow.com/users/1382244/giovanni-di-toro"}, "edited": false, "score": 0, "creation_date": 1548818968, "post_id": 54432765, "comment_id": 95675450, "body": "I advise not using <code>select</code> since it will slow down your project."}, {"owner": {"reputation": 13, "user_id": 8217468, "user_type": "registered", "profile_image": "https://graph.facebook.com/1169266229785397/picture?type=large", "display_name": "Houeto", "link": "https://stackoverflow.com/users/8217468/houeto"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1548820068, "post_id": 54432765, "comment_id": 95675681, "body": "@Variatus To your question (C) I wanted to hard code the 6 items to be autopopulated for each selection in 7 ListItems(They are not in a given table).7 lists is identified by ListItem1,ListItem2,...ListItem7"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548834187, "post_id": 54432765, "comment_id": 95680408, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}], "owner": {"reputation": 13, "user_id": 8217468, "user_type": "registered", "profile_image": "https://graph.facebook.com/1169266229785397/picture?type=large", "display_name": "Houeto", "link": "https://stackoverflow.com/users/8217468/houeto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548834164, "creation_date": 1548817101, "last_edit_date": 1548834164, "question_id": 54432765, "link": "https://stackoverflow.com/questions/54432765/autofill-cells-when-selecting-item-in-dropdown-list-from-another-cell", "title": "autofill cells when selecting item in dropdown list from another cell", "body": "<p>I'm pretty new to VBA .Here is my problem:\nI have a dropdown list in A4 with ListItem1 to ListItem7.I want to autofill A6 t0 A11 when selecting ListItem1,ListItem2 ect...I've recorded the Macro:</p>\n\n<pre><code>    Range(\"A6\").Select\n    ActiveCell.FormulaR1C1 = \"67\"\n    Range(\"A7\").Select\n    ActiveCell.FormulaR1C1 = \"87\"\n    Range(\"A8\").Select\n    ActiveCell.FormulaR1C1 = \"rty-u\"\n    Range(\"A9\").Select\n    ActiveCell.FormulaR1C1 = \"kjty\"\n    Range(\"A10\").Select\n    ActiveCell.FormulaR1C1 = \"erty\"\n    Range(\"A11\").Select\n    ActiveCell.FormulaR1C1 = \"u\"\n    Range(\"A6:A11\").Select\n    Selection.ClearContents\n    Range(\"A6\").Select\n    ActiveCell.FormulaR1C1 = \"9867\"\n    Range(\"A7\").Select\n    ActiveCell.FormulaR1C1 = \"4567\"\n    Range(\"A8\").Select\n    ActiveCell.FormulaR1C1 = \"ghty\"\n    Range(\"A9\").Select\n    ActiveCell.FormulaR1C1 = \"3454\"\n    Range(\"A10\").Select\n    ActiveCell.FormulaR1C1 = \"klii\"\n    Range(\"A6:A10\").Select\n    Selection.ClearContents\n    Range(\"A6\").Select\n    ActiveCell.FormulaR1C1 = \"23567\"\n    Range(\"A7\").Select\n    ActiveCell.FormulaR1C1 = \"9867\"\n    Range(\"A8\").Select\n    ActiveCell.FormulaR1C1 = \"hjytrer\"\n    Range(\"A9\").Select\n    ActiveCell.FormulaR1C1 = \"bnjg\"\n    Range(\"A10\").Select\n    ActiveCell.FormulaR1C1 = \"987\"\n    Range(\"A6:A10\").Select\n    Selection.ClearContents\n    Range(\"A6\").Select\n    ActiveCell.FormulaR1C1 = \"56456\"\n    Range(\"A7\").Select\n    ActiveCell.FormulaR1C1 = \"9876\"\n    Range(\"A8\").Select\n    ActiveCell.FormulaR1C1 = \"45678\"\n    Range(\"A9\").Select\n    ActiveCell.FormulaR1C1 = \"mjtyu\"\n    Range(\"A10\").Select\n    ActiveCell.FormulaR1C1 = \"nbvc\"\n    Range(\"A11\").Select\n    ActiveCell.FormulaR1C1 = \"fgtre\"\n    Range(\"A6:A11\").Select\n    Selection.ClearContents\nEnd Sub\n</code></pre>\n\n<p>Any helps?</p>\n"}, {"tags": ["sql", "vba", "datetime", "ms-access"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 2, "creation_date": 1548817300, "post_id": 54432551, "comment_id": 95675103, "body": "A date is a number (long integer for date, double for date/time). Today is day 43495 (<code>? CLng(Date)</code>)and there is no right or wrong to this value.` Format(43495, &quot;dddd&quot;)` will display <i>Wednesday</i>. You can format the date as <code>Format(Date, &quot;dd&#47;mm&#47;yyyy&quot;)</code> or any other format but bear in mind that the <code>Format</code> function returns a string. When storing a date as a number the display format would be in the field formatting."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1548818801, "post_id": 54432551, "comment_id": 95675414, "body": "Save date in a date/time field as normal, use formatting in textbox to display as short date."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1548820250, "post_id": 54432551, "comment_id": 95675726, "body": "If you are seeing time part, then must have Format property set as general date. Don&#39;t assign any format in table and should default to short date."}], "answers": [{"tags": [], "owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "is_accepted": false, "score": 0, "last_activity_date": 1548838989, "creation_date": 1548838989, "answer_id": 54436797, "question_id": 54432551, "link": "https://stackoverflow.com/questions/54432551/vba-sql-string-saving-short-date-as-general-date-instead-of-short/54436797#54436797", "title": "VBA SQL string saving short date as General date instead of short", "body": "<p>When implicitly converting a date to a string, your regional settings are used, but in a SQL string, a date must be in the American format.</p>\n\n<p>To avoid this, I suggest to do the update in just one query:</p>\n\n<pre><code>Dim strSql As String\n\nstrSql = \"UPDATE Accounts \" &amp; _\n    \"INNER JOIN tblfrequency ON Accounts.freqid = tblfrequency.FrequencyID SET \" &amp; _\n    \"AccStart = Date(), \" &amp; _\n    \"AccEND = DateAdd(\"\"w\"\", tblfrequency.freqvalue, Accounts.Accend), \" &amp; _\n    \"AccCurValue = 0.00 WHERE ID = \" &amp; Me.ID\n\nMsgBox strSql\nDoCmd.RunSQL strSql\n</code></pre>\n"}], "owner": {"reputation": 284, "user_id": 6718302, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/10153620613372096/picture?type=large", "display_name": "Glenn Angel", "link": "https://stackoverflow.com/users/6718302/glenn-angel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548838989, "creation_date": 1548815309, "question_id": 54432551, "link": "https://stackoverflow.com/questions/54432551/vba-sql-string-saving-short-date-as-general-date-instead-of-short", "title": "VBA SQL string saving short date as General date instead of short", "body": "<p>I'm trying to do something basic:\nTake 2 dates [startD] and [endD] from a accdb file.\nMove them forward one month each\nsave the new dates as short dates in the respective record.</p>\n\n<p>I'm doing this all by VBA</p>\n\n<p>The issue is that it is showing the correct SQL String (if i do msgbox sql) however when it saves, it is saving as a general date with time and is the wrong value!\n*Note: I'm in Australia so I have a format section to make sure the date saves correctly.</p>\n\n<p>I have tried using DateValue() and Formatting the date too.</p>\n\n<pre><code>Dim frq As Integer\nDim wks As Integer\nDim CurAcc As Integer\nDim CurAccEnd As Date\nDim Days As Integer\nDim curaccvalue As Currency\nDim cardtype As Integer\nDim cardcharged As Integer\n\n\n\n\ncardtype = 0\ncardcharged = 0\n\nCurAcc = Me.ID\n\ncurraccvalue = DLookup(\"Acccurvalue\", \"Accounts\", \"[ID] = \" &amp; CurAcc)\nCurraccend = DLookup(\"Accend\", \"Accounts\", \"[ID] = \" &amp; CurAcc)\n\nfrq = DLookup(\"freqid\", \"Accounts\", \"[ID] = \" &amp; CurAcc)\n\nwks = DLookup(\"freqvalue\", \"tblfrequency\", \"FrequencyID = \" &amp; frq)\nDays = wks * 7\n\n\n\n\nstrsql = \"UPDATE Accounts SET AccStart = \" &amp; Date &amp; \" , AccEND = \" &amp;             \nCurraccend     + Days &amp; \" , AccCurValue = 0.00 WHERE ID = \" &amp; CurAcc\nMsgBox strsql\nDoCmd.RunSQL strsql\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6606182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e0f7ec8738dd502b6cd1b558619442b?s=128&d=identicon&r=PG&f=1", "display_name": "din2345", "link": "https://stackoverflow.com/users/6606182/din2345"}, "edited": false, "score": 0, "creation_date": 1548816419, "post_id": 54432628, "comment_id": 95674933, "body": "Hi CharlesPL, I want the user to be prompted through an plain input box. If possible, I&#39;d want them to be able to enter multiple dates (not necessarily a date range). Can you please show me how I&#39;d be able to do that? Thanks!"}], "tags": [], "owner": {"reputation": 327, "user_id": 10397847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35fc42f3907aeeb72103e228c86cdf?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesPL", "link": "https://stackoverflow.com/users/10397847/charlespl"}, "is_accepted": false, "score": 0, "last_activity_date": 1548815888, "creation_date": 1548815888, "answer_id": 54432628, "question_id": 54432508, "link": "https://stackoverflow.com/questions/54432508/copy-rows-with-specific-columns-based-on-entered-date-to-other-sheet/54432628#54432628", "title": "Copy rows with specific columns based on entered date to other sheet", "body": "<p>You need to modify your if Statement.</p>\n\n<pre><code>If InStr(1, wsSource.Cells(x, 19), \"X\") Then\n</code></pre>\n\n<p>Will become</p>\n\n<pre><code>If wsSource.Cells(x, ColumnThatContainsTheDate).value &gt; OlderDate and wsSource.Cells(x, 19).value &lt; NewerDate Then\n</code></pre>\n\n<p>Now, your problem will become how do you want the user to select the dates? A form that he could dynamically select (using a calendar), just a plain input box or based on a value of a cell? Do you want everything that is older or newer to this date or do you want between two dates? Just adjust the statement to whatever suits your needs.</p>\n"}], "owner": {"reputation": 31, "user_id": 6606182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e0f7ec8738dd502b6cd1b558619442b?s=128&d=identicon&r=PG&f=1", "display_name": "din2345", "link": "https://stackoverflow.com/users/6606182/din2345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1548830315, "creation_date": 1548814909, "last_edit_date": 1548830315, "question_id": 54432508, "link": "https://stackoverflow.com/questions/54432508/copy-rows-with-specific-columns-based-on-entered-date-to-other-sheet", "title": "Copy rows with specific columns based on entered date to other sheet", "body": "<p>I have an existing VBA code that copies rows if an identifier column is marked with 'X'. Now I want it to be based off a date range entered by the user. Can somebody please help me convert the existing code to my required one? Thanks!</p>\n\n<pre><code>Sub CopyRow()\n\nApplication.ScreenUpdating = False\nDim x As Long, MaxRowList As Long, MaxRowList2 As Long, S As String, wsSource As Worksheet, wsTarget As Worksheet, S2 As Long\n\nSet wsSource = ThisWorkbook.Worksheets(\"Sheet 1 - RAW\")\nSet wsTarget = ThisWorkbook.Worksheets(\"Staging\")\niCol = 1\nMaxRowList = wsSource.Cells(Rows.Count, iCol).End(xlUp).Row\nMaxRowList2 = wsTarget.Cells(Rows.Count, iCol).End(xlUp).Row\n    S2 = 8\n\nwsTarget.Range(\"A8:H22\").ClearContents\n\nFor x = 4 To MaxRowList\n    If InStr(1, wsSource.Cells(x, 19), \"X\") Then\n        wsTarget.Cells(S2, 1).Value = wsSource.Cells(x, 1).Value\n        wsTarget.Cells(S2, 4).Value = wsSource.Cells(x, 2).Value\n        wsTarget.Cells(S2, 5).Value = wsSource.Cells(x, 10).Value\n        wsTarget.Cells(S2, 6).Value = wsSource.Cells(x, 16).Value\n        wsTarget.Cells(S2, 7).Value = wsSource.Cells(x, 18).Value\n        wsTarget.Cells(S2, 8).Value = wsSource.Cells(x, 17).Value\n        S2 = S2 + 1\n        End If\nNext\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 1, "creation_date": 1548818208, "post_id": 54432485, "comment_id": 95675285, "body": "Why you are executing double loop through <code>ws1Row</code> first with <code>For</code> and second with <code>Do</code>.  I think instead of <code>Do loop</code> it will be &#39;If  ws1.Cells(ws1Row, 4) &lt;&gt; &quot;&quot; then` and like."}, {"owner": {"reputation": 5, "user_id": 7411280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5f13b2806ea5315031b429d6bdc6a73?s=128&d=identicon&r=PG&f=1", "display_name": "Raudert", "link": "https://stackoverflow.com/users/7411280/raudert"}, "edited": false, "score": 0, "creation_date": 1548859703, "post_id": 54432485, "comment_id": 95695569, "body": "Please only input productive comments. Saying &quot;this is a bad idea&quot; and not offering a solution is in no way helpful."}, {"owner": {"reputation": 5, "user_id": 7411280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5f13b2806ea5315031b429d6bdc6a73?s=128&d=identicon&r=PG&f=1", "display_name": "Raudert", "link": "https://stackoverflow.com/users/7411280/raudert"}, "edited": false, "score": 0, "creation_date": 1548859818, "post_id": 54432485, "comment_id": 95695663, "body": "First comment the variable ws1Row is not defined anywhere in the code before then so that is why the For loop is included. Is it best practice? Probably not. Your solution will not work."}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548856125, "post_id": 54432839, "comment_id": 95693214, "body": "Some feedback on the downvote would be appreciated as this answers the question"}, {"owner": {"reputation": 5, "user_id": 7411280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5f13b2806ea5315031b429d6bdc6a73?s=128&d=identicon&r=PG&f=1", "display_name": "Raudert", "link": "https://stackoverflow.com/users/7411280/raudert"}, "edited": false, "score": 0, "creation_date": 1548860295, "post_id": 54432839, "comment_id": 95696014, "body": "Works great. You are my hero and also the only one who left a productive comment. Thank you very much for your feedback."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": -1, "last_activity_date": 1548817837, "creation_date": 1548817837, "answer_id": 54432839, "question_id": 54432485, "link": "https://stackoverflow.com/questions/54432485/collecting-multiple-column-values-on-a-variable-row/54432839#54432839", "title": "Collecting Multiple Column Values on a Variable Row", "body": "<h2><code>Range.Resize(Rows, Columns)</code></h2>\n\n<hr>\n\n<pre><code>ws2.Range(\"J\" &amp; y).Resize(, 3).Value = ws1.Range(\"J\" &amp; x).Resize(, 3).Value\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7411280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5f13b2806ea5315031b429d6bdc6a73?s=128&d=identicon&r=PG&f=1", "display_name": "Raudert", "link": "https://stackoverflow.com/users/7411280/raudert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 54432839, "answer_count": 1, "score": 0, "last_activity_date": 1548834144, "creation_date": 1548814777, "last_edit_date": 1548834144, "question_id": 54432485, "link": "https://stackoverflow.com/questions/54432485/collecting-multiple-column-values-on-a-variable-row", "title": "Collecting Multiple Column Values on a Variable Row", "body": "<p>I am trying to figure out how to set the value of a range of columns on one sheet to the value of a range of columns on another sheet. I don't want to copy the entire row I only want to target specific columns as to not potentially overwrite important information inside the other cells.</p>\n\n<p>Currently my code starts at the top of Sheet 1 and loops to the bottom. With each value > 0 in column 4 it searches for the identical value in column 4 of Sheet 2. If a match is found I want to copy the values from column 10-13 on x row of Sheet 1 to column 10-13 on y row of Sheet 2.</p>\n\n<p>I can make this work by matching the value in each column individually but I cannot seem to find the proper method for assigning the value for a range of columns. The first line of code is what I have that currently works. The second line is what I am attempting to copy a range of column values.</p>\n\n<pre><code>ws2.Cells(y, 4).Value = ws1.Cells(x, 4).Value\nws2.Range(y, 10:13).Value = ws1.Range(x, 10:13).Value\n</code></pre>\n\n<p>I have tried using the Union() method but perhaps I am not sure how to implement it in this situation. Below is the rest of my code. </p>\n\n<pre><code>Sub Upload()\n\nDim wb1 As Workbook, wb2 As Workbook\nDim ws1 As Worksheet, ws2 As Worksheet\nDim ws1LastRow As Long, ws2LastRow As Long\nDim ws1Row As Long, ws2Row As Long\nDim FindRow2 As Range\n\nApplication.ScreenUpdating = False\n\nSet wb1 = ThisWorkbook\nSet ws1 = wb1.Worksheets(\"Sheet1\")\n\nSet wb2 = Application.Workbooks.Open(\"Sheet Address\")\nSet ws2 = wb2.Worksheets(\"Master\")\n\nws1LastRow = ws1.Cells(Rows.Count, \"A\").End(xlUp).Row\nws2LastRow = ws2.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nFor ws1Row = 2 To ws1LastRow\n\n    Do While ws1.Cells(ws1Row, 4) &lt;&gt; \"\"\n\n        ws2.Range(\"D:D\").Find(What:=ws1.Cells(ws1Row, 4).Text, _\n        LookIn:=xlValues).Select\n\n        r = ActiveCell.Row  \n\n        ws2.Cells(r, \"B\").Value = ws1.Cells(ws1Row, \"B\").Value\n\n        ws1Row = ws1Row + 1\n\n    Loop   \n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1548812483, "post_id": 54432133, "comment_id": 95674050, "body": "Are there more than those subs in the module? (In other words, would removing the module/clearing all text, then adding new code be an option?)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1548812653, "post_id": 54432133, "comment_id": 95674080, "body": "See <a href=\"https://stackoverflow.com/a/14764383/4088852\">this answer</a> for the basic method. You can either use <code>VBComponents.Import</code> to add the new code, or you can get rid of the deletes and re-write the code in place via the <code>VBComponent.CodeModule</code> itself."}, {"owner": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 0, "creation_date": 1548817951, "post_id": 54432133, "comment_id": 95675232, "body": "Yes there are two other subs in that module"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 1, "creation_date": 1548821612, "post_id": 54432462, "comment_id": 95676013, "body": "Coming along, I&#39;m stuck on an undefined error on this line <code>Vbc.ProcStartLine(&quot;Auto_Open&quot;, vbext_pk_Proc)= &lt;Sub or Function not defined</code>  any ideas?  Thank you"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 1, "creation_date": 1548821975, "post_id": 54432462, "comment_id": 95676105, "body": "if reference to Microsoft visual basic for applications extensibility is already added, this may indicating <code>Sub Auto_Open()</code> is not available in the module <code>ArchiveHistoricalData</code>. Please check  in the file. Also on second run it is to give error as <code>Sub Auto_Open</code> was being deleted in first run. Please make a copy of few files in a folder and then only try. I tried the code on few files in a folder .and it is running fine"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 1, "creation_date": 1548822554, "post_id": 54432462, "comment_id": 95676239, "body": "In short Module <code>ArchiveHistoricalData</code>, Worksheet <code>Data Dump</code> and procedure <code>Auto_Open</code> must be present in Module <code>ArchiveHistoricalData</code> in the target file to avoid error."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 0, "creation_date": 1548824260, "post_id": 54432462, "comment_id": 95676621, "body": "I am Editing Answer with Error Handling. Hope it will help"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1548824475, "last_edit_date": 1548824475, "creation_date": 1548814585, "answer_id": 54432462, "question_id": 54432133, "link": "https://stackoverflow.com/questions/54432133/adding-new-and-removing-old-vba-to-all-workbooks-in-a-folder/54432462#54432462", "title": "Adding new and removing old VBA to all workbooks in a folder", "body": "<p>Try the code from any workbook (not in the same target folder) module. Add reference to Microsoft visual basic for applications extensibility. and/or make <code>vbext_pk_Proc</code> as 0.</p>\n\n<pre><code>Sub test3()\nDim ws As Workbook\nDim Vbc As CodeModule\nDim Path As String, Fname As String\n\nDim Wx As Worksheet\nDim HaveAll As Boolean\nDim VbComp As VBComponent\n\n\nPath = \"C:\\Users\\User\\Documents\\TestFolder\\\"\nFname = Dir(Path &amp; \"*.xlsm\")\n\n    Do While Fname &lt;&gt; \"\"\n'    Debug.Print Fname\n    Set ws = Application.Workbooks.Open(Path &amp; Fname)\n    HaveAll = False\n\n         For Each VbComp In ws.VBProject.VBComponents\n            If VbComp.Name = \"ArchiveHistoricalData\" Then\n                'used erron handler instead of iterating through all the lines for keeping code short\n                On Error GoTo failex\n                If VbComp.CodeModule.ProcStartLine(\"Auto_Open\", 0) &gt; 0 Then\n                HaveAll = True\nfailex:         Resume failex2\nfailex2:        On Error GoTo 0\n                Exit For\n                End If\n             End If\n         Next VbComp\n\n\n         If HaveAll Then\n         HaveAll = False\n         For Each Wx In ws.Worksheets\n            If Wx.Name = \"Data Dump\" Then\n            HaveAll = True\n            Exit For\n            End If\n         Next Wx\n         End If\n\n\n        If HaveAll Then\n        Set Vbc = ws.VBProject.VBComponents(\"ArchiveHistoricalData\").CodeModule\n        Vbc.DeleteLines Vbc.ProcStartLine(\"Auto_Open\", vbext_pk_Proc), Vbc.ProcCountLines(\"Auto_Open\", vbext_pk_Proc)\n        Set Vbc = ws.VBProject.VBComponents(ws.Worksheets(\"Data Dump\").CodeName).CodeModule\n        Vbc.InsertLines 1, \"Private Sub Worksheet_SelectionChange(ByVal Target As Range)\"\n        Vbc.InsertLines 2, \"AskArchive\"\n        Vbc.InsertLines 3, \"End Sub\"\n        ws.Close True\n        Else\n        ws.Close False\n        End If\n    Debug.Print Fname, HaveAll\n\n    Fname = Dir\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>However code will encounter error if the stated Worksheets, code modules and procedures are not available. Please take due care, if not confirmed about availability of the stated Worksheets, code modules and procedures in all the target files. <em>(may use error handler or check for existence  for the Sheets, code modules and procedures by iterating through after opening the target file and skip accordingly)</em>. Also Trust Access To Visual Basics Project must be enabled.</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 0, "creation_date": 1548871099, "post_id": 54436670, "comment_id": 95702477, "body": "Ahmed, Thank you, Thank you, Thank you!!!!  Works like a charm.  I can&#39;t tell you how much I appreciate this.  Saved me so much.  Every year I have changes to make and in the past I wrote the new code in the master and rebuilt each workbook from the master.  This just saved me hours of work."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "edited": false, "score": 0, "creation_date": 1548874197, "post_id": 54436670, "comment_id": 95704027, "body": "( @ErikOtterholt - You can mark this as The Answer by clicking the check mark left of the post)"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 2, "last_activity_date": 1548838577, "creation_date": 1548838577, "answer_id": 54436670, "question_id": 54432133, "link": "https://stackoverflow.com/questions/54432133/adding-new-and-removing-old-vba-to-all-workbooks-in-a-folder/54436670#54436670", "title": "Adding new and removing old VBA to all workbooks in a folder", "body": "<p>Posting another answer structured as generalized tools to delete and/or add or replace any number of procedures from any number of files. As mentioned earlier it is assumed that Trust Access to Visual Basics Project must be enabled.</p>\n\n<p>In a new excel file with added reference to Microsoft Visual Basic for Application extensibility, add a module named \u201cCopy_Module\u201d. Specifically in your case, copy <code>Worksheet_SelectionChange</code> code in a module named \u201cCopy_Module\u201d.  </p>\n\n<p>Its <code>AddReplaceProc</code> function would copy any procedure from a module named \u201cCopy_Module\u201d  in the source workbook while <code>DeleteProc</code> function would delete a procedure. </p>\n\n<pre><code>Sub test4()\nDim Wb As Workbook, ws As Worksheet\nDim Path As String, Fname As String\nDim Fno As Long\n\nPath = \"C:\\Users\\User\\Documents\\TestFolder\\\"\nFname = Dir(Path &amp; \"*.xlsm\")\n\n    Fno = 1\n    Do While Fname &lt;&gt; \"\"\n    Set Wb = Application.Workbooks.Open(Path &amp; Fname)\n\n        If Wb.VBProject.Protection = vbext_pp_none Then\n        Set ws = ThisWorkbook.ActiveSheet\n        Fno = Fno + 1\n        ws.Cells(Fno, 1).Value = Fname\n        'ws.Cells(Fno, 2).Value = AddReplaceProc(Wb, \"ArchiveHistoricalData\", \"DoStuff2\")\n        ws.Cells(Fno, 2).Value = DeleteProc(Wb, \"ArchiveHistoricalData\", \"Auto_Open\")\n        ws.Cells(Fno, 3).Value = AddReplaceProc(Wb, Wb.Worksheets(\"Data Dump\").CodeName, \"Worksheet_SelectionChange\")\n        Wb.Close True\n        Else\n        Wb.Close False\n        End If\n\n    Fname = Dir\n    Loop\nEnd Sub\nPrivate Function DeleteProc(Wb As Workbook, CompName As String, ProcName As String) As Boolean\nDim Vbc As CodeModule, Vbcomp As VBComponent\nDeleteProc = False\n    For Each Vbcomp In Wb.VBProject.VBComponents\n        If Vbcomp.Name = CompName Then\n        Set Vbc = Vbcomp.CodeModule\n            On Error GoTo XExit\n            If Vbc.ProcStartLine(ProcName, 0) &gt; 0 Then\n            Vbc.DeleteLines Vbc.ProcStartLine(ProcName, 0), Vbc.ProcCountLines(ProcName, 0)\n            DeleteProc = True\n            Exit For\n            End If\n        End If\n    Next Vbcomp\nXExit: On Error GoTo 0\nEnd Function\nPrivate Function AddReplaceProc(Wb As Workbook, CompName As String, ProcName As String) As Boolean\nDim Vbc As CodeModule, Vbcomp As VBComponent\nDim VbcSrc As CodeModule, StLine As Long, EndLine As Long\nDim i As Long, X As Long\n'Check for older version of the procedure and delete the same before coping new version\nAddReplaceProc = DeleteProc(Wb, CompName, ProcName)\nDebug.Print \"Old Proc \" &amp; ProcName &amp; \" Found and Deleted : \" &amp; AddReplaceProc\nAddReplaceProc = False\n\n    For Each Vbcomp In Wb.VBProject.VBComponents\n        If Vbcomp.Name = CompName Then\n        Set Vbc = Vbcomp.CodeModule\n        Set VbcSrc = ThisWorkbook.VBProject.VBComponents(\"Copy_Module\").CodeModule\n        StLine = VbcSrc.ProcStartLine(ProcName, 0)\n        EndLine = StLine + VbcSrc.ProcCountLines(ProcName, 0) - 1\n            X = 0\n            For i = StLine To EndLine\n            X = X + 1\n            Vbc.InsertLines X, VbcSrc.Lines(i, 1)\n            Next i\n        AddReplaceProc = True\n        Exit For\n        End If\n    Next Vbcomp\n\nEnd Function\n</code></pre>\n\n<p>Proper caution is a must for this type of remote changes. It is always wise to try the code first only to copies of target files and confirm proper working etc.<br>\nIt only works with files with unprotected VBA projects. For files with protected VBA files refer SO post <a href=\"https://stackoverflow.com/questions/16174469/unprotect-vbproject-from-vb-code\">Unprotect VBProject from VB code</a>.</p>\n"}], "owner": {"reputation": 39, "user_id": 4593008, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9ac07d864bb5322cb974b0f8c23aa7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Otterholt", "link": "https://stackoverflow.com/users/4593008/erik-otterholt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1548838577, "creation_date": 1548811830, "last_edit_date": 1548834138, "question_id": 54432133, "link": "https://stackoverflow.com/questions/54432133/adding-new-and-removing-old-vba-to-all-workbooks-in-a-folder", "title": "Adding new and removing old VBA to all workbooks in a folder", "body": "<p>I have about 60 workbooks with several modules and I need to remove one sub routine in one module then add code to a specific worksheet. </p>\n\n<p>I currently have code running every time you open the workbook asking to run and archive data to another worksheet, it works. Problem is we are in the workbooks several times, so every time we open them, we have to answer the question.  </p>\n\n<p>I found a more elegant way to ask to archive when I go to the first worksheet where we go to change data at the end of the month.  Only when we open this are we needing to archive the old data.  Some times we go here to look at the data, but it's not the usual.  I have new code now for the specific worksheet using on select, that works.</p>\n\n<p>I'm trying to update the code across all my workbooks without having to open them up 1 by 1 and make the changes, copy, paste, delete, save, open next file, repeat.  </p>\n\n<pre><code>'code to remove from module named ArchiveHistoricalData  \nSub Auto_Open()\nAskArchive\nEnd Sub\n\n\n'Code to add to worksheet named Data Dump\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nAskArchive\nEnd Sub\n</code></pre>\n\n<p>I'd like to remove the first sub, then add the second sub to a specific worksheet (Named the same across all workbooks).  Then if I have changes in the future, I can easily update all my workbooks with other changes. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1548810581, "post_id": 54431934, "comment_id": 95673600, "body": "Without the code we can&#39;t help. Please edit your qustion providing the code."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 10952425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-156RpY-p7SU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbwgTkKHPD5CkNAB6lh8nPgmL227w/mo/photo.jpg?sz=128", "display_name": "m.rainey", "link": "https://stackoverflow.com/users/10952425/m-rainey"}, "is_accepted": true, "score": 1, "last_activity_date": 1548812849, "creation_date": 1548812849, "answer_id": 54432239, "question_id": 54431934, "link": "https://stackoverflow.com/questions/54431934/macro-enabled-template-keeps-opening-original-document-when-macro-is-run/54432239#54432239", "title": "Macro-Enabled Template keeps opening original document when macro is run", "body": "<p>Discovered it was because I was accessing the macros from the ribbon as I customized it. Unsure why but if I trigger the macros from the Developer tab they work. </p>\n"}], "owner": {"reputation": 23, "user_id": 10952425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-156RpY-p7SU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbwgTkKHPD5CkNAB6lh8nPgmL227w/mo/photo.jpg?sz=128", "display_name": "m.rainey", "link": "https://stackoverflow.com/users/10952425/m-rainey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 54432239, "answer_count": 1, "score": 0, "last_activity_date": 1548834101, "creation_date": 1548810297, "last_edit_date": 1548834101, "question_id": 54431934, "link": "https://stackoverflow.com/questions/54431934/macro-enabled-template-keeps-opening-original-document-when-macro-is-run", "title": "Macro-Enabled Template keeps opening original document when macro is run", "body": "<p>I made a series of macros on a document called 'Prac.xlsm'. I then saved the document as a Macro-Enabled template. When I run the first macro in the template it works but it also opens my original document titled Prac. The macro doesn't do anything to that original document though. </p>\n\n<p>I tried to step through the templates macro and that works without opening up the original. </p>\n\n<p>I then tried renaming the original file which resulted in an Excel popup saying \"Sorry, we couldn't find ..file path &amp; name for the Prac file.. Is it possible it was moved, renamed or deleted?\" I can't see anywhere in the code where it refers to the file name Prac.xlsm. And because stepping through the code works without opening up the original file it has me stumped. </p>\n\n<p>Any help would be appreciated.\nThank you.</p>\n"}, {"tags": ["excel", "vba", "excel-2010", "excel-2007"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548812010, "post_id": 54431827, "comment_id": 95673955, "body": "It sounds like there may be a language barrier getting in the way clearly explaining your problem. No need be alarmed, this is when <code>photos with sample data</code> help. Please add a screen shot showing your starting point with sample data and desired output"}, {"owner": {"reputation": 1, "user_id": 9459543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5910e654872be985f0e83ea62dff65db?s=128&d=identicon&r=PG", "display_name": "Alvin Dao", "link": "https://stackoverflow.com/users/9459543/alvin-dao"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548830431, "post_id": 54431827, "comment_id": 95678583, "body": "Hi. I have already add picture to show my problem. Sr about my bad english anyway."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548834091, "post_id": 54431827, "comment_id": 95680376, "body": "<i>&quot;I would like to find the next AA-i&quot;</i> The next <code>AA-i</code> to what? What is your current <code>AA-i</code>? Is it always <code>AA</code> or will there also be others? Please give us more information about what the overall goal of all this is. Therefore <a href=\"https://stackoverflow.com/posts/54431827/edit\">edit</a> your question."}, {"owner": {"reputation": 1, "user_id": 9459543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5910e654872be985f0e83ea62dff65db?s=128&d=identicon&r=PG", "display_name": "Alvin Dao", "link": "https://stackoverflow.com/users/9459543/alvin-dao"}, "edited": false, "score": 0, "creation_date": 1548835779, "post_id": 54431827, "comment_id": 95681125, "body": "Hi Peh. Thanks for your help. AA will not change. I want to find the next code. For example in my picture, if column B have: AA-a, AA-b, AA-c. I want the result is AA-d, and make sure AA-d not available in column B. In onother case, if column B have AA-a...AA-z, aslo have AA-1 to AA-10 (because after a-z was gernerated, number will be used), my expexted result is AA-11."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548844154, "post_id": 54431827, "comment_id": 95686089, "body": "Are the values in column B always sorted this way or could they be mixed up like <code>AA-a, AA-b, AA-15, AA-3, AA-c</code> etc? And are they continous, that means if there is a <code>AA-c</code> that there <b>must</b> be a <code>AA-a, AA-b</code> already? \u2022 If they are sorted and continous, you would just need find the last used cell in column B (google) and use the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/split-function\" rel=\"nofollow noreferrer\">Split function</a> with <code>-</code> as delimiter and analyse the second part of the split result to generate the next value. Give it a try."}], "answers": [{"tags": [], "owner": {"reputation": 102, "user_id": 10221059, "user_type": "registered", "profile_image": "https://graph.facebook.com/2342338789117339/picture?type=large", "display_name": "Sapan Gupta", "link": "https://stackoverflow.com/users/10221059/sapan-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1551264660, "last_edit_date": 1551264660, "creation_date": 1551263125, "answer_id": 54903236, "question_id": 54431827, "link": "https://stackoverflow.com/questions/54431827/check-duplicate-and-return-the-next-value/54903236#54903236", "title": "Check duplicate and return the next value", "body": "<p>I think you want to return A-12 next in your result column and A-13 once A-12 is used. If so you can use the formula in your result column : It will give you the next AA- followed by number and checks the value if it was used earlier...</p>\n\n<p>=IF((\"AA-\"&amp; VALUE(RIGHT(OFFSET(A1,COUNTA(A:A)-1,0,1,1),(LEN(OFFSET(A1,COUNTA(A:A)-1,0,1,1)))-(FIND(\"@\",SUBSTITUTE(OFFSET(A1,COUNTA(A:A)-1,0,1,1),\"-\",\"@\")))))+1)=A2:A4,\"AA-\"&amp; VALUE(RIGHT(OFFSET(A1,COUNTA(A:A)-1,0,1,1),(LEN(OFFSET(A1,COUNTA(A:A)-1,0,1,1)))-(FIND(\"@\",SUBSTITUTE(OFFSET(A1,COUNTA(A:A)-1,0,1,1),\"-\",\"@\")))))+2,\"AA-\"&amp; VALUE(RIGHT(OFFSET(A1,COUNTA(A:A)-1,0,1,1),(LEN(OFFSET(A1,COUNTA(A:A)-1,0,1,1)))-(FIND(\"@\",SUBSTITUTE(OFFSET(A1,COUNTA(A:A)-1,0,1,1),\"-\",\"@\")))))+1)</p>\n\n<p>The formula gone very messy so let me explain : \nFind the last entry in your column : =OFFSET(A1,COUNTA(A:A)-1,0,1,1)\nfind position of \"-\" in string : =FIND(\"@\",SUBSTITUTE(OFFSET(A1,COUNTA(A:A)-1,0,1,1),\"-\",\"@\"))\nfind length of your string : =LEN(OFFSET(A1,COUNTA(A:A)-1,0,1,1))\nUse right and valu function to find out the last number used.\nadd one to the result and concatenate \"AA-\" with the result.\nuse IF array function to find if the final output was used earlier and return next number if true else use the same.</p>\n\n<p>DO not FOrget to press CTRL+SHFT+Enter as it is an array Formula\nAssumption that your data is sorted as you have shown above. </p>\n\n<p>I hope it resolved your query.</p>\n"}], "owner": {"reputation": 1, "user_id": 9459543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5910e654872be985f0e83ea62dff65db?s=128&d=identicon&r=PG", "display_name": "Alvin Dao", "link": "https://stackoverflow.com/users/9459543/alvin-dao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1551264660, "creation_date": 1548809448, "last_edit_date": 1548867702, "question_id": 54431827, "link": "https://stackoverflow.com/questions/54431827/check-duplicate-and-return-the-next-value", "title": "Check duplicate and return the next value", "body": "<p>Here is my explanation of my problems. I have 30k rows with 2 columns as below:</p>\n\n<ul>\n<li>Column A: code. Form: AA. </li>\n<li>Column B: code. Form: AA-i. With <code>i</code> run from <code>a</code> to <code>z</code>, then <code>1</code> - <code>100</code>.</li>\n</ul>\n\n<p>I would like to find the next AA-i, and do not duplicate with any AA-i in column B. </p>\n\n<p>How can I do it? I really need help. Much thanks any idea to help a lots. </p>\n\n<p><a href=\"https://i.stack.imgur.com/PVcZ6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PVcZ6.png\" alt=\"Example\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1548802211, "post_id": 54430746, "comment_id": 95671448, "body": "You&#39;re missing the wildcards in your <code>Like</code> statement - what you currently have will only match &quot;CAT&quot;.  Like is also case sensitive with the default comparison method (<code>Option Compare ...</code>). I&#39;d suggest using <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">a regular expression</a> for this instead though."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10987273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfa4abc6f63913e73f85a82cb2278c?s=128&d=identicon&r=PG&f=1", "display_name": "Wesker", "link": "https://stackoverflow.com/users/10987273/wesker"}, "edited": false, "score": 0, "creation_date": 1548802864, "post_id": 54430808, "comment_id": 95671631, "body": "@urdearboy perfect i will keep a note of that.  How do i make that code &#39;Not Like&#39; &quot;<i>CAT</i>&quot;&#39;?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 13, "user_id": 10987273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfa4abc6f63913e73f85a82cb2278c?s=128&d=identicon&r=PG&f=1", "display_name": "Wesker", "link": "https://stackoverflow.com/users/10987273/wesker"}, "edited": false, "score": 0, "creation_date": 1548803533, "post_id": 54430808, "comment_id": 95671817, "body": "@Wesker if you see my second method, you can use <code>Not Like</code> by adding <code>Not</code> in front of <code>InStr</code>. Soooo <code>If Not InStr(......)</code>"}, {"owner": {"reputation": 13, "user_id": 10987273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfa4abc6f63913e73f85a82cb2278c?s=128&d=identicon&r=PG&f=1", "display_name": "Wesker", "link": "https://stackoverflow.com/users/10987273/wesker"}, "edited": false, "score": 0, "creation_date": 1548804157, "post_id": 54430808, "comment_id": 95671960, "body": "wow thanks very much for your help! So the 2nd method basically marks those rows to be moved at the very end of the sub instead of there and then.  Is that right?  If so that may be a game changer as the rest of my VBA is very similar to that and is very very slow."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 13, "user_id": 10987273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfa4abc6f63913e73f85a82cb2278c?s=128&d=identicon&r=PG&f=1", "display_name": "Wesker", "link": "https://stackoverflow.com/users/10987273/wesker"}, "edited": false, "score": 0, "creation_date": 1548804298, "post_id": 54430808, "comment_id": 95672000, "body": "&amp; yes. Your code will have 2 actions every time a row meets your criteria (1 instance of copy, and 1 instance of delete). So say 500 rows meet your criteria. That means you have will 1,000 actions.The code I provided has 2 actions (1 instance of copy and 1 instance of delete) no matter how many rows meet your criteria."}, {"owner": {"reputation": 13, "user_id": 10987273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfa4abc6f63913e73f85a82cb2278c?s=128&d=identicon&r=PG&f=1", "display_name": "Wesker", "link": "https://stackoverflow.com/users/10987273/wesker"}, "edited": false, "score": 0, "creation_date": 1548805694, "post_id": 54430808, "comment_id": 95672374, "body": "im getting a invalid procedure call or argument for:  Set DeleteMe = Union(DeleteMe, ws.Range(&quot;C&quot; &amp; i))"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 13, "user_id": 10987273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfa4abc6f63913e73f85a82cb2278c?s=128&d=identicon&r=PG&f=1", "display_name": "Wesker", "link": "https://stackoverflow.com/users/10987273/wesker"}, "edited": false, "score": 0, "creation_date": 1548807940, "post_id": 54430808, "comment_id": 95672949, "body": "Did you check the sheet names \ud83e\udd14"}, {"owner": {"reputation": 13, "user_id": 10987273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfa4abc6f63913e73f85a82cb2278c?s=128&d=identicon&r=PG&f=1", "display_name": "Wesker", "link": "https://stackoverflow.com/users/10987273/wesker"}, "edited": false, "score": 0, "creation_date": 1548809459, "post_id": 54430808, "comment_id": 95673316, "body": "Yes they are correct. If I delete it all and repaste it and change the sheet name it works fine. I also tried to change If Not Instr &amp; it just cuts everything."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 13, "user_id": 10987273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfa4abc6f63913e73f85a82cb2278c?s=128&d=identicon&r=PG&f=1", "display_name": "Wesker", "link": "https://stackoverflow.com/users/10987273/wesker"}, "edited": false, "score": 0, "creation_date": 1548809584, "post_id": 54430808, "comment_id": 95673343, "body": "Can you post some sample strings so I can test. Reading it, it looks fine. I made up some test strings and this worked"}, {"owner": {"reputation": 13, "user_id": 10987273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfa4abc6f63913e73f85a82cb2278c?s=128&d=identicon&r=PG&f=1", "display_name": "Wesker", "link": "https://stackoverflow.com/users/10987273/wesker"}, "edited": false, "score": 0, "creation_date": 1548811125, "post_id": 54430808, "comment_id": 95673729, "body": "I will post some tomorrow. Thanks for your interest &amp; support."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "edited": false, "score": 0, "creation_date": 1548835527, "post_id": 54430808, "comment_id": 95681010, "body": "Your InStr requires vbtextcompare to be case-insensitive. The default is vbbinarycompare which is  case-sensitive."}, {"owner": {"reputation": 13, "user_id": 10987273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfa4abc6f63913e73f85a82cb2278c?s=128&d=identicon&r=PG&f=1", "display_name": "Wesker", "link": "https://stackoverflow.com/users/10987273/wesker"}, "edited": false, "score": 0, "creation_date": 1548871810, "post_id": 54430808, "comment_id": 95702836, "body": "@user10981853 thanks for the tip, that works a treat. I only get the above error on this code when i put &#39;Not&#39; infront of the &#39;InStr&#39;.  How do i get the above code to function with the &#39;Not&#39;, find everything that doesn&#39;t have &#39;Cat&#39; excluding blank cells?"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 2, "last_activity_date": 1548803269, "last_edit_date": 1548803269, "creation_date": 1548802223, "answer_id": 54430808, "question_id": 54430746, "link": "https://stackoverflow.com/questions/54430746/find-cell-containing-text-in-column-and-does-not-contain-certain-word-in-first-6/54430808#54430808", "title": "Find Cell containing text in column and does NOT contain certain word in first 6 characters of string", "body": "<p>Regardless of how you decide to implement the macro, your test to see if a cell is blank is entirely redundant. You can just test if the cell meets your <code>CAT</code> criteria. If it does, it is definitely not blank so no need to test it. </p>\n\n<hr>\n\n<h2>Method 1</h2>\n\n<p>You can look at the first 6 characters with <code>LEFT(Range, 6)</code> </p>\n\n<pre><code>If Left(Range(\"C\" &amp; i), 6) Like \"*CAT*\" Then\n</code></pre>\n\n<p>This needs <code>Option Compare</code> to work (Thanks @Comintern)</p>\n\n<hr>\n\n<h2>Method 2</h2>\n\n<p>I would prefer this method. Its explicit and does not delete or shift anything inside the loop so your action statements are greatly minimized. </p>\n\n<pre><code>Sub Cat()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\") '&lt;--UPDATE\nDim ps As Worksheet: Set ps = ThisWorkbook.Sheets(\"AWP DEFECTS\")\n\nDim LR As Long, DeleteMe As Range, i As Long\nLR = ws.Range(\"C\" &amp; ws.Rows.Count).End(xlUp).Row\n\nFor i = 2 To LR\n    If InStr(Left(ws.Range(\"C\" &amp; i), 6), \"CAT\") Then\n        If Not DeleteMe Is Nothing Then\n            Set DeleteMe = Union(DeleteMe, ws.Range(\"C\" &amp; i))\n        Else\n            Set DeleteMe = ws.Range(\"C\" &amp; i)\n        End If\n    End If\nNext i\n\nApplication.ScreenUpdating = False\n    If Not DeleteMe Is Nothing Then\n        LR = ps.Range(\"A\" &amp; ps.Rows.Count).End(xlUp).Row\n        DeleteMe.EntireRow.Copy ps.Range(\"A\" &amp; LR)\n        DeleteMe.EntireRow.Delete\n    End If\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10987273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfa4abc6f63913e73f85a82cb2278c?s=128&d=identicon&r=PG&f=1", "display_name": "Wesker", "link": "https://stackoverflow.com/users/10987273/wesker"}, "edited": false, "score": 0, "creation_date": 1548871915, "post_id": 54430986, "comment_id": 95702877, "body": "Thanks for this answer!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10981853"}, "is_accepted": false, "score": 0, "last_activity_date": 1548803288, "creation_date": 1548803288, "answer_id": 54430986, "question_id": 54430746, "link": "https://stackoverflow.com/questions/54430746/find-cell-containing-text-in-column-and-does-not-contain-certain-word-in-first-6/54430986#54430986", "title": "Find Cell containing text in column and does NOT contain certain word in first 6 characters of string", "body": "<p>If <em>cat</em> is within the first 6 characters then InStr will report its position being less than 5.</p>\n\n<pre><code>Sub CATDEFECTS()\n    dim UsdRws  as long, pos as long\n\n    UsdRws = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = UsdRws To 2 Step -1\n\n        pos =instr(1, cells(i, \"C\").value2, \"cat\", vbtextcompare)\n\n        If pos &gt; 0 and pos &lt; 5 Then\n            Rows(i).Cut Sheets(\"AWP DEFECTS\").Range(\"A\" &amp; rows.Count).End(xlUp).Offset(1)\n            Rows(i).Delete\n        End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10987273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfa4abc6f63913e73f85a82cb2278c?s=128&d=identicon&r=PG&f=1", "display_name": "Wesker", "link": "https://stackoverflow.com/users/10987273/wesker"}, "edited": false, "score": 0, "creation_date": 1548870309, "post_id": 54442664, "comment_id": 95702059, "body": "Perfect thanks! That is a lot of code and will need to get my head around it."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1548859535, "last_edit_date": 1548859535, "creation_date": 1548857914, "answer_id": 54442664, "question_id": 54430746, "link": "https://stackoverflow.com/questions/54430746/find-cell-containing-text-in-column-and-does-not-contain-certain-word-in-first-6/54442664#54442664", "title": "Find Cell containing text in column and does NOT contain certain word in first 6 characters of string", "body": "<h1>Criteria Backup (Hide/Delete)</h1>\n\n<p>To enable the deletion of the rows in the Source Worksheet you have to set <code>cDEL</code> to <code>True</code> in the constants section. Adjust the other constants to fit you needs.</p>\n\n<h2>The Code</h2>\n\n<pre><code>Option Explicit\n'Option Compare Text\n\nSub CATDEFECTS()\n\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n    On Error GoTo ProcedureExit\n\n    ' Source Constants\n    Const cSource As Variant = \"Sheet1\"       ' Worksheet Name/Index\n    Const cCol As Variant = \"C\"               ' Search Column Letter/Number\n    Const cFirstR As Long = 2                 ' First Row Number\n    Const cChars As Long = 6                  ' Number of Chars\n    Const cSearch As String = \"CAT\"           ' Search String\n    ' Target Constants\n    Const cTarget As Variant = \"AWP DEFECTS\"  ' Worksheet Name/Index\n    Const cColTgt As Variant = \"A\"            ' Column Letter/Number\n    Const cFirstRTgt As Long = 2              ' First Row Number\n    Const cDEL As Boolean = False             ' Enable Delete (True)\n    ' Variables\n    Dim rngH As Range     ' Help Range\n    Dim rngU As Range     ' Union Range\n    Dim vntS As Variant   ' Source Array\n    Dim i As Long         ' Source Range Row Counter\n\n    ' The Criteria\n    ' When the first \"cChars\" characters do not contain the case-INsensitive\n    ' string \"cSearch\", the criteria is met.\n\n    ' Source Worksheet\n    With ThisWorkbook.Worksheets(cSource)\n        ' Calculate Last Cell in Search Column using the Find method and\n        ' assign it to Help (Cell) Range.\n        Set rngH = .Columns(cCol).Find(\"*\", , xlFormulas, _\n                xlWhole, xlByColumns, xlPrevious)\n        ' Calculate Source Column Range from Help (Cell) Range.\n        If Not rngH Is Nothing Then   ' Last Cell was found.\n            ' Calculate Source Column Range and assign it to\n            ' Help (Column) Range using the Resize method.\n            Set rngH = .Cells(cFirstR, cCol).Resize(rngH.Row - cFirstR + 1)\n            ' Copy Help (Column) Range into 2D 1-based 1-column Source Array.\n            vntS = rngH\n            ' Show hidden rows to prevent  the resulting rows (the rows to be\n            ' hidden or deleted) to appear hidden in Target Worksheet.\n            rngH.EntireRow.Hidden = False\n          Else                        ' Last Cell was NOT found (unlikely).\n            MsgBox \"Empty Column '\" &amp; cCol &amp; \"'.\"\n            GoTo ProcedureExit\n        End If\n        ' Loop through rows of Source Array.\n        For i = 1 To UBound(vntS)\n            ' Check if current Source Array value doesn't meet Criteria.\n            If InStr(1, Left(vntS(i, 1), cChars), cSearch, vbTextCompare) = 0 _\n                    Then ' \"vbUseCompareOption\" if \"Option Compare Text\"\n\n            ' Note: To use the Like operator instead of the InStr function\n            ' you have to use (uncomment) \"Option Compare Text\" at the beginning\n            ' of the module for a case-INsensitive search and then outcomment\n            ' the previous and uncomment the following line.\n'            If Not Left(vntS(i, 1), cChars) Like \"*\" &amp; cSearch &amp; \"*\" Then\n\n                Set rngH = .Cells(i + cFirstR - 1, cCol)\n                If Not rngU Is Nothing Then\n                    ' Union Range contains at least one range.\n                    Set rngU = Union(rngU, rngH)\n                  Else\n                    ' Union Range does NOT contain a range (only first time).\n                    Set rngU = rngH\n                End If\n            End If\n        Next\n    End With\n\n    ' Target Worksheet\n    If Not rngU Is Nothing Then ' Union Range contains at least one range.\n        With ThisWorkbook.Worksheets(cTarget)\n            ' Calculate Last Cell in Search Column using the Find method and\n            ' assign it to Help Range.\n            Set rngH = .Columns(cColTgt).Find(\"*\", , xlFormulas, _\n                    xlWhole, xlByColumns, xlPrevious)\n            ' Calculate Last Cell from Help Range, but in column 1 (\"A\").\n            If Not rngH Is Nothing Then   ' Last Cell was found.\n                Set rngH = .Cells(rngH.Row + 1, 1)\n              Else                        ' Last Cell was NOT found.\n                Set rngH = .Cells(cFirstRTgt - 1, 1)\n            End If\n            ' Copy the entire Union Range to Target Worksheet starting from\n            ' Help Range Row + 1 i.e. the first empty row (in one go).\n            ' Note that you cannot Cut/Paste on multiple selections.\n            rngU.EntireRow.Copy rngH\n        End With\n        ' Hide or delete the transferred rows (in one go).\n        If cDEL Then  ' Set the constant cDEL to True to enable Delete.\n            rngU.EntireRow.Delete\n          Else        ' While testing the code it is better to use Hidden.\n            rngU.EntireRow.Hidden = True\n        End If\n    End If\n\nProcedureExit:\n\n    With Application\n        .Calculation = xlCalculationAutomatic\n        .ScreenUpdating = True\n    End With\n\nEnd Sub\n</code></pre>\n\n<h2>Remarks</h2>\n\n<ul>\n<li>The use of the array did not speed up considerably.</li>\n<li>The <code>InStr</code> function was a few milliseconds faster than the <code>Like</code> operator in my data set.</li>\n<li>Calculating the Real Used Range and copying it into a Source Array\nand then writing the data that meets the criteria from Source Array\nto a Target Array and copying the Target Array to the Target\nWorksheet, might be faster, and/but would additionally copy the data without formulas or formatting.</li>\n</ul>\n"}], "owner": {"reputation": 13, "user_id": 10987273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cfa4abc6f63913e73f85a82cb2278c?s=128&d=identicon&r=PG&f=1", "display_name": "Wesker", "link": "https://stackoverflow.com/users/10987273/wesker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 54430808, "answer_count": 3, "score": 1, "last_activity_date": 1548859535, "creation_date": 1548801904, "question_id": 54430746, "link": "https://stackoverflow.com/questions/54430746/find-cell-containing-text-in-column-and-does-not-contain-certain-word-in-first-6", "title": "Find Cell containing text in column and does NOT contain certain word in first 6 characters of string", "body": "<p>I am searching a column for cell that contains text and does not contain the word \"cat\" in the first 6 characters (needs to be case insensitive).  This will then cut that entire row to another sheet. Cannot get the code to run without compile errors.  the below code is before i try to change it.  I do not know how to code it to look at the first 6 characters.</p>\n\n<p>tried instr &amp; iserror but i think my existing code just needs a small alteration which escapes me.</p>\n\n<pre><code>Sub CATDEFECTS()\n\nUsdRws = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = UsdRws To 2 Step -1\n        If Range(\"C\" &amp; i).Value Like \"&lt;&gt;\"\"\" And Range(\"c\" &amp; i).Value Like \"CAT\" Then\n            Rows(i).Cut Sheets(\"AWP DEFECTS\").Range(\"A\" &amp; rows.Count).End(xlUp).Offset(1)\n            Rows(i).Delete\n        End If\n        Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1548800973, "post_id": 54430568, "comment_id": 95671106, "body": "As a related note to OP - if you ever want to loop through an array, I suggest using <code>For x = Lbound(myArray) to Ubound(myArray)</code> instead of say <code>For x = 0 to 3</code>, as it&#39;s a little more dynamic and makes sure you use the entire array."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1548800974, "last_edit_date": 1548800974, "creation_date": 1548800782, "answer_id": 54430568, "question_id": 54430542, "link": "https://stackoverflow.com/questions/54430542/how-to-find-length-of-string-variable/54430568#54430568", "title": "How to find length of string variable?", "body": "<p><code>i</code> is not a string but an array.  <code>Len()</code> returns the <strong>Len</strong>gth of a string.</p>\n\n<p>You want <code>UBound()</code></p>\n\n<pre><code>Debug.Print Ubound(i)+1\n</code></pre>\n\n<p>We add <code>1</code> because <code>Split()</code> creates an <code>0</code> base array.</p>\n\n<p>Also it will be 4 as there are three <code>l</code> and split will see an empty string at the end of the string.</p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1548874260, "post_id": 54431292, "comment_id": 95704060, "body": "+1 for the Watch Window trick, I never knew that but it&#39;ll be a godsend when analyzing arrays!  No longer do I have to make temporary <code>For</code> loops just to check their contents! :D"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1548875021, "post_id": 54431292, "comment_id": 95704452, "body": "@BruceWayne - thanks! :) The watch window really saves hours in some other scenarios - xml objects, Excel, Worksheet, Workbook objects. All the properties and values are just a click away - give it a try."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1548805116, "creation_date": 1548805116, "answer_id": 54431292, "question_id": 54430542, "link": "https://stackoverflow.com/questions/54430542/how-to-find-length-of-string-variable/54431292#54431292", "title": "How to find length of string variable?", "body": "<p>Actually <code>i</code> has 4 elements if you take a look at them at the Watch window. To get the window in debug-mode, select <code>i</code> and press <kbd>Shift</kbd>+<kbd>F9</kbd> or from View>Watch Window.</p>\n\n<p><a href=\"https://i.stack.imgur.com/sBWJO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sBWJO.png\" alt=\"enter image description here\"></a></p>\n\n<p>Back to the point, if you want to see the count of the elements of the array, then <code>Debug.Print UBound(i)+1</code> would be ok.</p>\n"}], "owner": {"reputation": 79, "user_id": 8091097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae2d10bcdc22616335c3899dc17c9db?s=128&d=identicon&r=PG&f=1", "display_name": "attemptingpython", "link": "https://stackoverflow.com/users/8091097/attemptingpython"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 54430568, "answer_count": 2, "score": 1, "last_activity_date": 1548805173, "creation_date": 1548800644, "last_edit_date": 1548805173, "question_id": 54430542, "link": "https://stackoverflow.com/questions/54430542/how-to-find-length-of-string-variable", "title": "How to find length of string variable?", "body": "<p>I'm trying to find the length of <code>i</code>, which should be 3:</p>\n\n<pre><code>Dim k As String\nDim i() As String\n\nk = \"test1 l test2 l test3 l\"\n\ni() = Split(k, \"l\")\nDebug.Print len(i())\n</code></pre>\n"}, {"tags": ["excel", "vba", "selenium-webdriver", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1548804293, "post_id": 54430482, "comment_id": 95671998, "body": "Please explain what doesn&#39;t work means?"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 1, "creation_date": 1549302251, "post_id": 54430651, "comment_id": 95845747, "body": "I apologize for the delay !! The following code worked for me thank you !!! //span[contains(text(), &#39;GT - ALL&#39;)]"}], "tags": [], "owner": {"reputation": 2335, "user_id": 6657098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/571d38df0ecf7797079379672cb75612?s=128&d=identicon&r=PG&f=1", "display_name": "cullzie", "link": "https://stackoverflow.com/users/6657098/cullzie"}, "is_accepted": true, "score": 2, "last_activity_date": 1548801284, "creation_date": 1548801284, "answer_id": 54430651, "question_id": 54430482, "link": "https://stackoverflow.com/questions/54430482/unable-to-select-check-box-from-dropdown-in-webpage-using-selenium-with-vba/54430651#54430651", "title": "Unable to select check box from dropdown in webpage using Selenium with VBA", "body": "<p>There appears to be two elements with that xpath when you use the * to identify the selector to target. Since this returns more than one element it is in a list and so you cannot call click on it.</p>\n\n<p>In order for the click to work you need to only get the element you want to click. Not sure which one is the button but these are the explicit xpaths for both:</p>\n\n<pre><code>//option[contains(text(), 'GT - ALL')] \n</code></pre>\n\n<p>Or</p>\n\n<pre><code>//span[contains(text(), 'GT - ALL')]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1549302318, "post_id": 54431128, "comment_id": 95845774, "body": "I apologize for the delay !! The following code worked for me thank you !!! bot.findElementByCss(&quot;option[value=&#39;GT1&#39;]&quot;).click"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "edited": false, "score": 0, "creation_date": 1549302600, "post_id": 54431128, "comment_id": 95845928, "body": "Only one can be accepted. When you have over 20 points (or something like that) you can upvote other answers you found helpful. The idea being you accept the answer you feel was the best for you and over time, hopefully, the rest of Stackoverflow votes and ensures the most useful answer rises to the top."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1548811344, "last_edit_date": 1548811344, "creation_date": 1548804162, "answer_id": 54431128, "question_id": 54430482, "link": "https://stackoverflow.com/questions/54430482/unable-to-select-check-box-from-dropdown-in-webpage-using-selenium-with-vba/54431128#54431128", "title": "Unable to select check box from dropdown in webpage using Selenium with VBA", "body": "<p>You can use an attribute = value css selector which is faster than xpath. Note that text value appears to be: <code>(1) GT - ALL</code></p>\n\n<p>Your dropdown and checkboxes are distinct. </p>\n\n<hr>\n\n<p><strong>input checkbox element</strong> (indicated by <code>type</code> attribute with value <code>checkbox</code> and that is part of an <code>input</code> tag element)</p>\n\n<p>For the checkbox you can use</p>\n\n<pre><code>bot.findElementByCss(\"input[type=checkbox][value='GT1']\").click\n</code></pre>\n\n<p>You can likely shorten that to:</p>\n\n<pre><code>bot.findElementByCss(\"input[value='GT1']\").click\n</code></pre>\n\n<hr>\n\n<p><strong>dropdown</strong> (indicated by parent <code>select</code> tag and child <code>option</code> tag elements):</p>\n\n<p>There is a non checkbox which you would use the following for:</p>\n\n<pre><code>bot.findElementByCss(\"option[value='GT1']\").click\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>bot.findElementByCss(\"option[value='GT1']\").Selected = True\n</code></pre>\n\n<p>You can swop the GT1 for other values if required. </p>\n"}], "owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 54430651, "answer_count": 2, "score": 2, "last_activity_date": 1548833578, "creation_date": 1548800275, "last_edit_date": 1548833578, "question_id": 54430482, "link": "https://stackoverflow.com/questions/54430482/unable-to-select-check-box-from-dropdown-in-webpage-using-selenium-with-vba", "title": "Unable to select check box from dropdown in webpage using Selenium with VBA", "body": "<p>Hi I am new to selenium via VBA, I am trying to select the dropdown and from the dropdown I need to select a option which is checkbox. Unfortunately I cannot share the link.</p>\n\n<p>I have trie few codes but it does not work, below are the code I tried</p>\n\n<pre><code>bot.FindElementByXPath(\"//*[contains(text(),'GT - ALL')]\").Click\n</code></pre>\n\n<p>Here is the web element </p>\n\n<pre><code>&lt;div class=\"form-group\"&gt;\n&lt;label for=\"billerId\"&gt; Mid &lt;/label&gt;&lt;br&gt;\n&lt;select name=\"billerId\" id=\"billerId\" class=\"billerId form-control\" multiple=\"multiple\" style=\"display: none;\"&gt;\n&lt;option value=\"7\"&gt;(7) Pay&lt;/option&gt;\n&lt;option value=\"11\"&gt;(11)&lt;/option&gt;\n&lt;option value=\"GT1\"&gt;(1) GT - ALL&lt;/option&gt;\n&lt;option value=\"GT7\"&gt;(7) GT - S1- LB&lt;/option&gt;\n&lt;option value=\"GT8\"&gt;(8) GT - S2 - LB&lt;/option&gt;\n&lt;option value=\"GT9\"&gt;(9) GT - S3&lt;/option&gt;\n&lt;option value=\"GT6\"&gt;(6) GT Whistle&lt;/option&gt;\n&lt;option value=\"GT4\"&gt;(4) GT -LB&lt;/option&gt;\n&lt;option value=\"1\"&gt;(1) Main - PP (2)&lt;/option&gt;\n&lt;option value=\"4\"&gt;(4) MTEST&lt;/option&gt;\n&lt;option value=\"2\"&gt;(2) test&lt;/option&gt;\n&lt;option value=\"12\"&gt;(12) RR1&lt;/option&gt;\n&lt;option value=\"10\"&gt;(10) RR Data&lt;/option&gt;\n&lt;option value=\"8\"&gt;(8) RR 2Mid&lt;/option&gt;\n&lt;option value=\"9\"&gt;(9) RR 3&lt;/option&gt;\n&lt;option value=\"6\"&gt;(6) Silver New PP &lt;/option&gt;\n&lt;option value=\"5\"&gt;(5) SILVER &lt;/option&gt;\n&lt;option value=\"3\"&gt;(3) Strike&lt;/option&gt;\n&lt;/select&gt;\n&lt;div class=\"ms-parent billerId form-control\"&gt;&lt;button type=\"button\" class=\"ms-choice\"&gt;&lt;span class=\"placeholder\"&gt;All&lt;/span&gt;&lt;div class=\"\"&gt;&lt;/div&gt;&lt;/button&gt;\n&lt;div class=\"ms-drop bottom\" style=\"display: none;\"&gt;\n  &lt;div class=\"ms-search\"&gt;&lt;input type=\"text\" autocomplete=\"off\" autocorrect=\"off\" autocapitilize=\"off\" spellcheck=\"false\"&gt;&lt;/div&gt;\n  &lt;ul style=\"max-height: 250px;\"&gt;\n    &lt;li class=\"ms-select-all\"&gt;&lt;label&gt;&lt;input type=\"checkbox\" data-name=\"selectAllbillerId\"&gt;[Select All]&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"7\"&gt;&lt;span&gt;(7) &lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"11\"&gt;&lt;span&gt;(11) &lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"GT1\"&gt;&lt;span&gt;(1) GT - ALL&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"GT7\"&gt;&lt;span&gt;(7) GT - LB&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"GT8\"&gt;&lt;span&gt;(8) GT - S2 - 02/11/17 LB&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"GT9\"&gt;&lt;span&gt;(9) GT - S3&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"GT6\"&gt;&lt;span&gt;(6) GT Whistle&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"GT4\"&gt;&lt;span&gt;(4) GT -LB&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"1\"&gt;&lt;span&gt;(1) Main - PP (2)&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"4\"&gt;&lt;span&gt;(4) MTEST&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"2\"&gt;&lt;span&gt;(2) test&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"12\"&gt;&lt;span&gt;(12) RR1&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"10\"&gt;&lt;span&gt;(10) RR Data&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"8\"&gt;&lt;span&gt;(8) RR 2Mid&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"9\"&gt;&lt;span&gt;(9) RR 3&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"6\"&gt;&lt;span&gt;(6) Silver New PP &lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"5\"&gt;&lt;span&gt;(5) SILVER &lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"\" style=\"false\"&gt;&lt;label class=\"\"&gt;&lt;input type=\"checkbox\" data-name=\"selectItembillerId\" value=\"3\"&gt;&lt;span&gt;(3) Strike&lt;/span&gt;&lt;/label&gt;&lt;/li&gt;\n    &lt;li class=\"ms-no-results\" style=\"display: none;\"&gt;No matches found&lt;/li&gt;\n  &lt;/ul&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>\n</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1548799978, "post_id": 54430394, "comment_id": 95670823, "body": "Use math, not the Excel object model. Find the last row with data in the sheet, then subtract the last row number of the named range."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1548802683, "last_edit_date": 1548802683, "creation_date": 1548800737, "answer_id": 54430553, "question_id": 54430394, "link": "https://stackoverflow.com/questions/54430394/find-row-count-of-consecutive-used-cells-below-a-range/54430553#54430553", "title": "Find row count of consecutive used cells below a range", "body": "<p>Your description of what you want to do doesn't quite match your line of code but something like this should work:</p>\n\n<pre><code>With Range(\"MyRange\")\n    endRow = IIf(Len(.Offset(1, 0)) = 0, .End(xlDown).Row, .Row)\nEnd With\n</code></pre>\n\n<p>...assuming \"MyRange\" is a single-cell range, not multi-row etc</p>\n"}], "owner": {"reputation": 1285, "user_id": 2565416, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/074185fbe5cd084acfb93d014b8f2939?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey Kramer", "link": "https://stackoverflow.com/users/2565416/jeffrey-kramer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 54430553, "answer_count": 1, "score": 0, "last_activity_date": 1548802683, "creation_date": 1548799887, "question_id": 54430394, "link": "https://stackoverflow.com/questions/54430394/find-row-count-of-consecutive-used-cells-below-a-range", "title": "Find row count of consecutive used cells below a range", "body": "<p>Say I have a named range in a sheet.  I need to count the number of consecutive rows with a value directly below the range.  I tried this:</p>\n\n<pre><code>endRow = Range(\"MyRange\").End(xlDown).Row\n</code></pre>\n\n<p>This works well unless there are no rows below the range, in which case it returns the last row in the sheet (1048576).  Is there a better approach I can use?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "edited": false, "score": 1, "creation_date": 1548799484, "post_id": 54430274, "comment_id": 95670654, "body": "I would check your data type before and after adding the validation. Is it text ? Is it numeric ? If its working when you enter it manually, I would suspect your dropdown is pulling text values but your data lookup is numeric."}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1548800102, "post_id": 54430274, "comment_id": 95670853, "body": "You&#39;re probably trying to do something like matching a string to a number"}, {"owner": {"reputation": 23, "user_id": 10952425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-156RpY-p7SU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbwgTkKHPD5CkNAB6lh8nPgmL227w/mo/photo.jpg?sz=128", "display_name": "m.rainey", "link": "https://stackoverflow.com/users/10952425/m-rainey"}, "edited": false, "score": 0, "creation_date": 1548800878, "post_id": 54430274, "comment_id": 95671074, "body": "You&#39;re right it does appear that they are different data types, selecting from the drop down isn&#39;t resulting in a text data type. Is there anything I can do about that?"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 10952425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-156RpY-p7SU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbwgTkKHPD5CkNAB6lh8nPgmL227w/mo/photo.jpg?sz=128", "display_name": "m.rainey", "link": "https://stackoverflow.com/users/10952425/m-rainey"}, "is_accepted": false, "score": 0, "last_activity_date": 1548802130, "creation_date": 1548802130, "answer_id": 54430793, "question_id": 54430274, "link": "https://stackoverflow.com/questions/54430274/vlookup-match-index-not-working-when-the-lookup-value-is-from-a-dropdown/54430793#54430793", "title": "VLOOKUP/ MATCH INDEX not working when the lookup value is from a dropdown", "body": "<p>Had to retype the name values which my drop downs were referencing. Although they looked the same they were somehow different to the list of name values I was using in the INDEX/MATCH formula. After this it all worked.</p>\n"}], "owner": {"reputation": 23, "user_id": 10952425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-156RpY-p7SU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbwgTkKHPD5CkNAB6lh8nPgmL227w/mo/photo.jpg?sz=128", "display_name": "m.rainey", "link": "https://stackoverflow.com/users/10952425/m-rainey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548802130, "creation_date": 1548799260, "last_edit_date": 1548799991, "question_id": 54430274, "link": "https://stackoverflow.com/questions/54430274/vlookup-match-index-not-working-when-the-lookup-value-is-from-a-dropdown", "title": "VLOOKUP/ MATCH INDEX not working when the lookup value is from a dropdown", "body": "<p>In column 'C' there are employee names and some blanks that will later have names assigned. In column 'J' there are the corresponding employees ID numbers. In column 'J' I have a MATCH/INDEX formula so that when an employees name is entered in column 'C', the other cell is also populated with the employees ID. </p>\n\n<p>This was working fine until I added data validation in the form of a dependent drop down in column 'C'. After that the MATCH/INDEX works fine if you type in a value, but it returns the error #N/A if you use the drop down to select a value. I then tried using VLOOKUP but that also has the same results.</p>\n\n<p>Does anybody know what I can do to solve this. So that when value from the drop down is selected the INDEX/MATCH works, without having to type it?</p>\n\n<p>All this formatting is also achieved through a macro (Not sure if that makes a difference). </p>\n\n<p>Heres the forumla currently in column 'J'..</p>\n\n<pre><code>=INDEX('Employee Details'!L:L,MATCH(C6,'Employee Details'!M:M,0))\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1548800676, "post_id": 54430219, "comment_id": 95671019, "body": "Does the UDF always perform the same query on the same data? Or is the query result likely to change frequently? One possibility is to make a somewhat more general query and hold the results in the xlam workbook (on it&#39;s own hidden worksheet) and then perform subsequent lookups on that data -- if that&#39;s possible given your situation."}, {"owner": {"reputation": 1, "user_id": 10987132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a236ce57f50ea6cfc67b10652f8e5c?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/10987132/john"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1548807098, "post_id": 54430219, "comment_id": 95672705, "body": "No the data can reference one of multiple databases or tables. Also the criteria of the query that is specified through a number of parameters can be different. The idea for the udf, is to use that instead of dumping in a series of large result files produced by a a software into Excel. Then only using a very small subset of the data. Given how how general the UDF is, having the data in hidden tabs on the xlam workbook would be hard. Therefore I am hoping that I can somehow determine the value of the cell before the Recalculation."}, {"owner": {"reputation": 1, "user_id": 10987132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a236ce57f50ea6cfc67b10652f8e5c?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/10987132/john"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1548807479, "post_id": 54430219, "comment_id": 95672809, "body": "Also with multiple users using the workbook and checking the results, storing the results on the xlam won&#39;t work I think. This is because the xlam is stored on each users computer not on a shared network."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1548882423, "post_id": 54430219, "comment_id": 95707802, "body": "What is the code and do you use <code>Application.Volatile</code> at all?"}], "owner": {"reputation": 1, "user_id": 10987132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a236ce57f50ea6cfc67b10652f8e5c?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/10987132/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548833401, "creation_date": 1548799011, "last_edit_date": 1548833401, "question_id": 54430219, "link": "https://stackoverflow.com/questions/54430219/excel-vba-udf-recalculation-indicator-parameter", "title": "Excel VBA UDF Recalculation Indicator Parameter", "body": "<p>I have a UDF function within a xlam workbook that connects to a database and executes a query, based on the parameters entered. This function is going to be used hundreds of times within different workbooks. Since it is going to be used in a series of different workbooks, that is the reason why I used a xam workbook.</p>\n\n<p>The issue is that using the UDF function so many times, slows the Recalculation down to much since it is recalculating when it doesn't need to. I was thinking about adding another indicator parameter in the UDF that if set to zero, it will just return the value of the cell before the Recalculation started. Is there anyway to do this? I was thinking about adding a conditional statement that would use something like application.caller.value to get the value. </p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 440, "user_id": 5128961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SEr4k.gif?s=128&g=1", "display_name": "DavidN", "link": "https://stackoverflow.com/users/5128961/davidn"}, "edited": false, "score": 0, "creation_date": 1548799247, "post_id": 54430206, "comment_id": 95670571, "body": "To get a userform to open use <code>userformname.show</code>.  Look up Userform_Initialize event for the code that executes when a userform opens.  In this sub you can write the things you want to happen such as filling in the default data."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1548799301, "post_id": 54430206, "comment_id": 95670590, "body": "Research the use of <code>Private Sub UserForm_Initialize</code>...it is this routine that would hold your text box default value assignment code (as in <code>Me.myTextBox.value = &quot;test&quot;</code>)"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1548799419, "post_id": 54430206, "comment_id": 95670633, "body": "<code>Private Sub btnOK_Click()</code> (replacing btnOK with the actual name of your OK button) would hold the code that moves the value of <code>Me.myTextBox</code> into your cell of choice."}, {"owner": {"reputation": 11, "user_id": 10987131, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QamS-KscIkM/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPZB_LHaZj-q7l8ydyNTTKjDneJbQ/mo/photo.jpg?sz=128", "display_name": "John Hoel", "link": "https://stackoverflow.com/users/10987131/john-hoel"}, "edited": false, "score": 0, "creation_date": 1548808667, "post_id": 54430206, "comment_id": 95673149, "body": "I tried using the userform_Initialize sub. It did not set the initial value. Then I tried setting it immediately before invoking .show; that worked. Sorry, I would attach the code but I see no way to do it."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1548859752, "post_id": 54430206, "comment_id": 95695600, "body": "Add your code to your original question (not in a comment). Add your code, select it, then click the <code>{}</code> in the toolbar. Or, if it&#39;s just a few lines, indent your lines of code with 4 spaces. There are question-posting instructions somewhere here on the site."}, {"owner": {"reputation": 11, "user_id": 10987131, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QamS-KscIkM/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPZB_LHaZj-q7l8ydyNTTKjDneJbQ/mo/photo.jpg?sz=128", "display_name": "John Hoel", "link": "https://stackoverflow.com/users/10987131/john-hoel"}, "edited": false, "score": 0, "creation_date": 1548870543, "post_id": 54430206, "comment_id": 95702191, "body": "Thanks for the advice. As it turns out, my eyesight is not what it once was, and I did not see the 2 drop down lists at the top of the code window when I selected &#39;View Code&#39; for the object. Once I got there I was able to follow the flow and used stackoverflow to find how to use global variables to pass values into the form from the invoking macro and back out of the form. Also, thanks for the tip on including code. I had searched stackoverflow for advice on how to do it and I must have misunderstood what I found. Again, many thanks all."}], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 0, "last_activity_date": 1549225237, "last_edit_date": 1549225237, "creation_date": 1548837512, "answer_id": 54436361, "question_id": 54430206, "link": "https://stackoverflow.com/questions/54430206/how-can-i-run-a-userform-from-a-macro/54436361#54436361", "title": "How can I run a userform from a macro?", "body": "<p>There is an example of how you can pass the value to a form and get the result back. The approach uses <code>Scripting.Dictionary</code> object created within standard module scope and passed to userform to allow values to be changed. So it makes possible to send the default values to userform, and keep the result values in the dictionary even after the userform is closed and unloaded. You may have multiple values, just add the necessary quantity of keys to the dictionary, e. g. <code>oData(\"property1\")</code>, <code>oData(\"property2\")</code>, etc.</p>\n\n<p>Add a standard module to the project and put the below code into it:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub Test()\n\n    Dim oData\n\n    ' Set default value and show form\n    Set oData = CreateObject(\"Scripting.Dictionary\")\n    oData(\"\") = \"Some default text\"\n    UserForm1.ShowForm oData\n    ' Wait until user close form\n    Do While IsUserFormLoaded(\"UserForm1\")\n        DoEvents\n    Loop\n    ' Output returned value\n    MsgBox oData(\"\")\n\nEnd Sub\n\nFunction IsUserFormLoaded(UserFormName As String) As Boolean\n\n    Dim oUF As Object\n\n    For Each oUF In UserForms\n        If LCase(oUF.Name) = LCase(UserFormName) Then\n            IsUserFormLoaded = True\n            Exit Function\n        End If\n    Next\n\nEnd Function\n</code></pre>\n\n<p>Add a userform module named <code>UserForm1</code> to the project, place controls as shown:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pPHRk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pPHRk.png\" alt=\"userform\"></a></p>\n\n<p>And put the below code into the userform module :</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private opData\n\nPublic Sub ShowForm(oData)\n\n    Set opData = oData\n    Me.TextBox1.Value = opData(\"\")\n    Me.Show\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\n    If TypeName(opData) &lt;&gt; \"Dictionary\" Then Set opData = CreateObject(\"Scripting.Dictionary\")\n\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n\n    Unload Me\n\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n\n    opData(\"\") = Me.TextBox1.Value\n    Unload Me\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 0, "last_activity_date": 1548883189, "creation_date": 1548883189, "answer_id": 54449703, "question_id": 54430206, "link": "https://stackoverflow.com/questions/54430206/how-can-i-run-a-userform-from-a-macro/54449703#54449703", "title": "How can I run a userform from a macro?", "body": "<p>Add a Property to your user form. For this answer, let us use the following code within the user form.</p>\n\n<pre><code>Public Property Get MyResult() As String\n    ' You may want to do any manipulation here\n    ' including converting to a number, in which case the return type should be changed (*)\n    MyResult = TextBox1.Text\nEnd Property\n</code></pre>\n\n<p>(*) If you are doing conversion, you can have another function in your user form to disable the \"OK\" button until they have valid convertible data in the text box.</p>\n\n<p>You also want to know if they have hit \"Cancel\"</p>\n\n<pre><code>Public Property Get Cancelled() As Boolean\n    Cancelled = pCancelled ' Declare pCancelled as a Boolean in the scope of the form\nEnd Property\n\nPublic Sub CancelButton_Click() ' Standard click event for the button\n    pCancelled = True\n    Me.Hide\nEnd Sub\n\nPublic Sub OKButton_Click() ' Standard click event for the button\n    pCancelled = False\n    Me.Hide\nEnd Sub\n</code></pre>\n\n<p>In your calling macro</p>\n\n<pre><code>MyForm.Show ' This is modal, so will block execution until a response is provided\nIf Not MyForm.Cancelled Then\n    Debug.Print MyForm.MyResult\n    'Do something with MyForm.MyResult\nEnd If\nUnLoad MyForm ' assuming you do not want to re-use this form as part of your logic.\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10987131, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QamS-KscIkM/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPZB_LHaZj-q7l8ydyNTTKjDneJbQ/mo/photo.jpg?sz=128", "display_name": "John Hoel", "link": "https://stackoverflow.com/users/10987131/john-hoel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1320, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1549225237, "creation_date": 1548798951, "last_edit_date": 1548807418, "question_id": 54430206, "link": "https://stackoverflow.com/questions/54430206/how-can-i-run-a-userform-from-a-macro", "title": "How can I run a userform from a macro?", "body": "<p>I developed many UDFs and macros in VBA for Excel 2016. One of my macros uses an Inputbox to get data used subsequently by the macro. I want to replace the Inputbox with a user form. I have created the user form, with one text box. I want to activate the user form, populating the text box with the default data, and return the text box data to the macro when OK is selected. I have searched extensively for an end-to-end example for all the the code needed to do this, with no luck. Does an example for this simple problem exist?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1548798526, "post_id": 54430007, "comment_id": 95670281, "body": "Silly question - you&#39;re <b>positive</b> that a sheet with whatever <code>cell.Value</code> resolves to, does indeed have a named range <code>MasterData</code>?  From your comment (&quot;For context, ...&quot;) it doesn&#39;t seem that the <i>non</i>-<code>MasterSheet</code> does <i>not</i> have a range named &quot;MasterData&quot;?  Note: Semantically, you do not have a variable called <code>MasterData</code>, you have a <b>Named Range</b> called <code>MasterData</code>."}, {"owner": {"reputation": 485, "user_id": 9500059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b487dfdd86416890e3dee745990cd2?s=128&d=identicon&r=PG&f=1", "display_name": "db702", "link": "https://stackoverflow.com/users/9500059/db702"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1548798748, "post_id": 54430007, "comment_id": 95670376, "body": "So before the macro runs, the workbook only has one sheet; &#39;Master Sheet&#39;. When the code runs, I am expecting it to create a sheet called NY and a sheet called WA, as those values are stored in &#39;Splitcode&#39;."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1548802010, "post_id": 54430007, "comment_id": 95671389, "body": "&quot;Somebody&quot; smh I never get any credit"}, {"owner": {"reputation": 485, "user_id": 9500059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b487dfdd86416890e3dee745990cd2?s=128&d=identicon&r=PG&f=1", "display_name": "db702", "link": "https://stackoverflow.com/users/9500059/db702"}, "edited": false, "score": 0, "creation_date": 1548803417, "post_id": 54430007, "comment_id": 95671791, "body": "sorry, it was showing that you deleted your comment. thanks! I marked your answer as correct."}], "answers": [{"comments": [{"owner": {"reputation": 485, "user_id": 9500059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b487dfdd86416890e3dee745990cd2?s=128&d=identicon&r=PG&f=1", "display_name": "db702", "link": "https://stackoverflow.com/users/9500059/db702"}, "edited": false, "score": 0, "creation_date": 1548799119, "post_id": 54430165, "comment_id": 95670512, "body": "This is giving me all the same data in every tab."}, {"owner": {"reputation": 485, "user_id": 9500059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b487dfdd86416890e3dee745990cd2?s=128&d=identicon&r=PG&f=1", "display_name": "db702", "link": "https://stackoverflow.com/users/9500059/db702"}, "edited": false, "score": 0, "creation_date": 1548803444, "post_id": 54430165, "comment_id": 95671797, "body": "was able to figure it out from this. Thanks!"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 485, "user_id": 9500059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b487dfdd86416890e3dee745990cd2?s=128&d=identicon&r=PG&f=1", "display_name": "db702", "link": "https://stackoverflow.com/users/9500059/db702"}, "edited": false, "score": 0, "creation_date": 1548804118, "post_id": 54430165, "comment_id": 95671949, "body": "Glad you got it working - was answering this before leaving work and thought I caught it all. You fixed it before I got home and had time to take a look  :)"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 2, "last_activity_date": 1548812450, "last_edit_date": 1548812450, "creation_date": 1548798735, "answer_id": 54430165, "question_id": 54430007, "link": "https://stackoverflow.com/questions/54430007/looping-through-a-column-in-excel-and-creating-an-identical-sheet-that-is-filter/54430165#54430165", "title": "Looping through a column in excel and creating an identical sheet that is filtered for each value found", "body": "<p><em>sorry for the code dump. I tried to edit a macro I used to use a work that was very close to your needs but I seem to have missed something along the way</em>   </p>\n\n<p><strong>Props for getting it to work yourself though!!</strong></p>\n\n<pre><code>Sub parse_data()\n\nDim lr As Long, icol As Long, i As Long, vcol As Long, titlerow As Long\nDim ws As Worksheet\nDim myarr As Variant\nDim title As Range\n\nvcol = 1\nSet ws = Sheets(\"Sheet1\")\nlr = ws.Cells(ws.Rows.Count, vcol).End(xlUp).Row\n\nSet title = ws.Range(\"A1:C\" &amp; lr)\ntitlerow = title.Cells(1).Row\nicol = ws.Columns.Count\nws.Cells(1, icol) = \"Unique\"\n\nFor i = 2 To lr\nOn Error Resume Next\n    If ws.Cells(i, vcol) &lt;&gt; \"\" And Application.WorksheetFunction.Match(ws.Cells(i, vcol), ws.Columns(icol), 0) = 0 Then\n        ws.Cells(ws.Rows.Count, icol).End(xlUp).Offset(1) = ws.Cells(i, vcol)\n    End If\nNext\n\nmyarr = Application.WorksheetFunction.Transpose(ws.Columns(icol).SpecialCells(xlCellTypeConstants))\nws.Columns(icol).Clear\n\nFor i = 2 To UBound(myarr)\n  title.AutoFilter field:=vcol, Criteria1:=myarr(i) &amp; \"\"\n    If Not Evaluate(\"=ISREF('\" &amp; myarr(i) &amp; \"'!A1)\") Then\n        Sheets.Add(after:=Worksheets(Worksheets.Count)).Name = myarr(i) &amp; \"\"\n    Else\n        Sheets(myarr(i) &amp; \"\").Move after:=Worksheets(Worksheets.Count)\n    End If\n  ws.Range(\"A\" &amp; titlerow &amp; \":A\" &amp; lr).EntireRow.Copy Sheets(myarr(i) &amp; \"\").Range(\"A1\")\n  Sheets(myarr(i) &amp; \"\").Columns.AutoFit\nNext\n\nws.AutoFilterMode = False\nws.Activate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 485, "user_id": 9500059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b487dfdd86416890e3dee745990cd2?s=128&d=identicon&r=PG&f=1", "display_name": "db702", "link": "https://stackoverflow.com/users/9500059/db702"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 54430165, "answer_count": 1, "score": 0, "last_activity_date": 1548812450, "creation_date": 1548797981, "last_edit_date": 1548803392, "question_id": 54430007, "link": "https://stackoverflow.com/questions/54430007/looping-through-a-column-in-excel-and-creating-an-identical-sheet-that-is-filter", "title": "Looping through a column in excel and creating an identical sheet that is filtered for each value found", "body": "<p>Imagine I have an master excel sheet in the following format:</p>\n\n<pre><code>store, date, total sales\nNY, 1/1, 10\nNY, 1/2, 15\nWA, 1/1, 12\nWA, 1/2, 14\n</code></pre>\n\n<p>Now, using VBA, I want to create a separate tab for each store, where the tab contains the same columns and all the rows where that store is mentioned. For example, there would be a tab called NY with the following:</p>\n\n<pre><code>store, sate, total sales\nNY, 1/1, 10\nNY, 1/2, 15\n</code></pre>\n\n<p>There would also be another tab for WA, and for any other store name found in the master sheet. </p>\n\n<p>Here is the code that I have so far: </p>\n\n<pre><code>Sub SplitandFilterSheet()\n'Step 1 - Name your ranges and Copy sheet\n'Step 2 - Filter by Department and delete rows not applicable\n'Step 3 - Loop until the end of the list\n\nDim Splitcode As Range\nSheets(\"Master Sheet\").Select\nSet Splitcode = Range(\"Splitcode\")\n\nFor Each cell In Splitcode\nSheets(\"Master Sheet\").Copy After:=Worksheets(Sheets.Count)\nActiveSheet.Name = cell.Value\n\nWith ActiveWorkbook.Sheets(cell.Value).Range(\"MasterData\")\n.AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\" &amp; cell.Value, Operator:=xlFilterValues\n.Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\nEnd With\n\nActiveSheet.AutoFilter.ShowAllData\nNext cell\nEnd Sub\n</code></pre>\n\n<p>The error I am getting is on the line starting with \".Offset()\". The error is the following: </p>\n\n<pre><code>Run-time error '1004':\n\nApplication-defined or object-defined error\n</code></pre>\n\n<p>For context, the master sheet is called 'Master Sheet', all the data in the master table is in a range called 'MasterData', which includes the first row of headers. Finally, there is a list of possible store names stored in the variable 'Splitcode'.</p>\n\n<p>I would rather do this in VBA than in python or R for a number of reasons, but am struggling to understand this error. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1548799999, "post_id": 54429888, "comment_id": 95670829, "body": "If you have new questions, you are welcome and always encouraged to ask a new question, but if you got an answer for your previous question ( <a href=\"https://stackoverflow.com/q/54374884/10908769\">stackoverflow.com/q/54374884/10908769</a> ) , please consider to accept that as answer also like described here: <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548833312, "post_id": 54429888, "comment_id": 95679977, "body": "Please <a href=\"https://stackoverflow.com/posts/54429888/edit\">edit</a> your question and format/indent your code. It&#39;s almost not readable. Also <code>Subject = &quot;\u201d</code> contains a wrong (fancy) quote <code>\u201d</code> but VBA only allows the normal quotes <code>&quot;</code>. \u2022 You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}], "owner": {"reputation": 15, "user_id": 10760940, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0O8Ze99_Qaw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gcsdFgxTK3ACZR-_YF8K-3XIyhIA/mo/photo.jpg?sz=128", "display_name": "Max Herring", "link": "https://stackoverflow.com/users/10760940/max-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548895249, "creation_date": 1548797399, "last_edit_date": 1548895249, "question_id": 54429888, "link": "https://stackoverflow.com/questions/54429888/vba-search-for-email-in-outlook-and-create-a-new-one-if-not-found", "title": "VBA Search for email in Outlook and create a new one if not found", "body": "<p>I'm trying to have VBA search a folder in Outlook for an email with a specific subject line. So far I've got it to search for the email and reply back to it with the desired info in the body, but I'm having trouble creating a new email if the email isn't found in the folder. In other words, each day I have an email that contains relevant work information for the given day, and several teams go back and forth on this email throughout the day. Each day a new email is created. So, I'm trying to either find the most recent email, or create one if it's the first email for the day. I've got the following code:</p>\n\n<pre><code>(extra code) \n    For i = 1 to olItems. Count\nSet olMail = olItem(i) \n\nIf instr(olMail.subject, \"email subject\") &gt; 0 then\n    Found = true\n    If Not olMail.categories = \"Executed\" Then\n    Set olReply = olMail.ReplyAll\n    With olReply\n    .Display\n    Dim wdDoc As Word.Document\n    Set wdDoc = .GetInspector.WordEditor\n\n        If Not wdDoc Is Nothing Then\n             With wdDoc.Range\n             .Collapse wdCollapseStart\n             .InsertBefore \"Round\" &amp; vbCrLf &amp; vbCrLf\n             .Collapse wdCollapseEnd\n             .Collapse wdCollapseStart\n             ActiveWorkbook.ActiveSheet.Range(\"A25\").Select\n             Range(Selection, Selection.End(xlToRight)).Select\n             Range(Selection, Selection.End(xlDown)).Select\n             Selection.Copy\n             .Paste\n             End With\n             End If\n             Set wdDoc = Nothing\n           End With\n           Exit For\n           olMail.categories = \"Executed\"\nElseIf Found = False Then\n   strbody = \"GM Team,\" &amp; vbNewLine &amp; vbNewLine &amp; \"Round 1\"\n   With OutMail\n       .To = \"\"\n       .CC = \"\"\n       .Subject = \"\"\n       .Body = strbody\n       .Display\n    End With\n End If\n End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>This is working if the email already exists, but I doesn't seem to work to create a new email if it doesn't. </p>\n"}, {"tags": ["excel", "vba", "range", "locking", "cell"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1548797254, "post_id": 54429775, "comment_id": 95669765, "body": "The <code>Target</code> parameter is the range that had been changed.  You should be testing that instead retrieving it from the worksheet."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1548798009, "post_id": 54429948, "comment_id": 95670086, "body": "<code>Cells(Target.Row, &quot;A&quot;)</code> is... odd.  You already have the range, so just use it:  <code>Target.EntireRow.Cells(1, 1)</code>.  Note that while &quot;a range can be a single cell&quot;, in this case <code>Target</code> can be more than one cell, and anything in a change handler needs to account for that."}, {"owner": {"reputation": 440, "user_id": 5128961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SEr4k.gif?s=128&g=1", "display_name": "DavidN", "link": "https://stackoverflow.com/users/5128961/davidn"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1548799046, "post_id": 54429948, "comment_id": 95670483, "body": "Cells(Target.Row, &quot;A&quot;) is to ensure it only factors in the change in column A. In theory &quot;Yes&quot; could be written anywhere on the sheet which would trigger the changes in that row. This is an undesired effect.  I suppose I could have written <code>If Target.Column=1</code> but tomato to..mato?   And yes you&#39;re correct about Target potentially referring to more than one cell but the error handling is outside the scope of this question IMO. Feel free to write a more robust solution if you disagree"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1548799335, "post_id": 54429948, "comment_id": 95670599, "body": "I wasn&#39;t referring to the method for getting column A from a given <code>Range</code> - I was commenting on retrieving it from the Worksheet instead of the <code>Target</code>.  The parameter is there to supply you with a <code>Range</code> - you shouldn&#39;t ever have to request a new one from the host worksheet with an unqualified <code>Range</code> or <code>Cells</code> call. Remember, this is one of the hottest code paths in Excel so efficiency matters."}, {"owner": {"reputation": 79, "user_id": 4646246, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153647923720744/picture?type=large", "display_name": "James Pritchard", "link": "https://stackoverflow.com/users/4646246/james-pritchard"}, "edited": false, "score": 0, "creation_date": 1548800485, "post_id": 54429948, "comment_id": 95670963, "body": "Thank you this worked. Now I just have to deal with the 1004 error. I have tried <code>myWorksheet.Protect contents:=True, userinterfaceonly:=True</code> but I&#39;m not 100% sure where to put it (Sorry very new to VBA)."}, {"owner": {"reputation": 440, "user_id": 5128961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SEr4k.gif?s=128&g=1", "display_name": "DavidN", "link": "https://stackoverflow.com/users/5128961/davidn"}, "edited": false, "score": 0, "creation_date": 1548869161, "post_id": 54429948, "comment_id": 95701501, "body": "@ Comintern.  Ah I see what you&#39;re saying now and that&#39;s a very good point.  I&#39;ll change the code to reflect that."}, {"owner": {"reputation": 440, "user_id": 5128961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SEr4k.gif?s=128&g=1", "display_name": "DavidN", "link": "https://stackoverflow.com/users/5128961/davidn"}, "reply_to_user": {"reputation": 79, "user_id": 4646246, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153647923720744/picture?type=large", "display_name": "James Pritchard", "link": "https://stackoverflow.com/users/4646246/james-pritchard"}, "edited": false, "score": 0, "creation_date": 1548870607, "post_id": 54429948, "comment_id": 95702228, "body": "@JamesPritchard, it seems the runtime error is due to trying to run a macro on a protected sheet.  The only workaround I&#39;ve found is to unprotect the sheet at the beginning of the macro, and reprotect it after. I&#39;ve modified my a solution above to cover this."}], "tags": [], "owner": {"reputation": 440, "user_id": 5128961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SEr4k.gif?s=128&g=1", "display_name": "DavidN", "link": "https://stackoverflow.com/users/5128961/davidn"}, "is_accepted": true, "score": 2, "last_activity_date": 1548870716, "last_edit_date": 1548870716, "creation_date": 1548797685, "answer_id": 54429948, "question_id": 54429775, "link": "https://stackoverflow.com/questions/54429775/locking-selected-cells-in-row-when-a-column-of-the-row-is-yes-for-all-rows/54429948#54429948", "title": "Locking selected cells in row when A column of the row is Yes for all rows", "body": "<p>Try the following code (untested). As @Comintern mentioned, <code>Target</code> is the range that has been changed.  Note, a range can be a single cell.  Using the <code>.Row</code> property returns the row of the changed cell.</p>\n\n<p><code>Cells</code> allows you to define the row and column as two separate values.  And <code>Range</code> can be used in conjunction with <code>Cells</code> to get a range of cells.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nOn Error GoTo esub   'If an error occurs reprotect the sheet\nMe.Unprotect   'Remove sheet protection to avoid runtime error\n\nIf Target.Column=1 and Target.Value=\"Yes\" Then\n    Range(Cells(Target.Row,\"C\"),Cells(Target.Row,\"E\")).Locked=False\n    Cells(Target.Row,\"J\").Locked=False\n\nElseIf Target.Column=1 and Target.Value=\"Refusing\" Then\n    Range(Cells(Target.Row,\"C\"),Cells(Target.Row,\"E\")).Locked=True\n    Cells(Target.Row,\"J\").Locked=True\nEnd If\n\nesub:\nMe.Protect    'Reprotect sheet\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 4646246, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153647923720744/picture?type=large", "display_name": "James Pritchard", "link": "https://stackoverflow.com/users/4646246/james-pritchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 54429948, "answer_count": 1, "score": 1, "last_activity_date": 1548870716, "creation_date": 1548796989, "question_id": 54429775, "link": "https://stackoverflow.com/questions/54429775/locking-selected-cells-in-row-when-a-column-of-the-row-is-yes-for-all-rows", "title": "Locking selected cells in row when A column of the row is Yes for all rows", "body": "<p>I have a spreadsheet where column A asks a Yes/No question, I need the spreadsheet to lock cell columns C, D, E and J for that row. I need this action to be performed on every row. </p>\n\n<p>So every row starts with the same Yes/No question then some cells are locked or left unlocked depending on the answer to Yes/No.</p>\n\n<p>I have been working with some sample code I found online however it only works for a specific row and I am unsure how to make if apply to all rows. The sample code I found was:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Range(\"A*\") = \"Yes\" Then\n        Range(\"B1:B4\").Locked = False\n    ElseIf Range(\"A1\") = \"Refusing\" Then\n        Range(\"B1:B4\").Locked = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>What I would like to know if how to create a wildcard to apply this code to a range, and also how to have a range such as cells C*:E*, J* to be locked, I am not sure how to have both a range and another cell that is not in the same direct range included.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1548797774, "post_id": 54429582, "comment_id": 95669984, "body": "Okay, what have you tried? You should just need to change the <code>.Copy</code> line then, no?   (Full Disclosure: The OP is not my mirrored self.)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1548797903, "post_id": 54429582, "comment_id": 95670036, "body": "This is copying the whole row. Does this not work for you? Do you have data past column Q that you do not want to carry over?"}, {"owner": {"reputation": 11, "user_id": 10986994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aecf1f8a7f5a0e4997ab1a8f8711f46?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne B", "link": "https://stackoverflow.com/users/10986994/wayne-b"}, "edited": false, "score": 0, "creation_date": 1548802132, "post_id": 54429582, "comment_id": 95671427, "body": "Hi All - I am using R as the reference to splitting out the Sheets - I do not want Column R in the New Sheets - only Data from A to Q - hope this Clarifies."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10986994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aecf1f8a7f5a0e4997ab1a8f8711f46?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne B", "link": "https://stackoverflow.com/users/10986994/wayne-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1548963991, "creation_date": 1548963991, "answer_id": 54468184, "question_id": 54429582, "link": "https://stackoverflow.com/questions/54429582/excel-vba-splitting-data-into-sheets/54468184#54468184", "title": "Excel VBA Splitting Data into Sheets", "body": "<p>thanks for your help - finally sussed out an Answer which works but slow for 30000 rows</p>\n\n<pre><code>Sub SplitData_ToPLCSheets()\n\n'Split KEPServerCombined Column r into Separate Sheets ready for Export (PLC Name)\n\n  Const SrcCol_PLC = \"R\"\n  Const SrcRow_Headers = 1\n  Const SrcRow_FirstRow = 2\n  Dim SrcSheet As Worksheet\n  Dim TrgSheet As Worksheet\n  Dim SrcRow As Long\n\n\n  Set TrgSheet = Worksheets.Add(After:=Worksheets(Worksheets.Count))\n  TrgSheet.name = TrgName\n  SrcRange = \"A\" &amp; Trim(Str(SrcRow_Headers)) &amp; \":Q\" &amp; Trim(Str(SrcRow_Headers))\n  TrgRange = \"A1\"\n  SrcSheet.Range(SrcRange).Copy Destination:=TrgSheet.Range(TrgRange)\n\nEnd If\n\n' update the target row number to the first empty row on the target worksheet and copy data across\n\nSet TrgSheet = Nothing\nSet TrgSheet = Worksheets(TrgName)\nTrgRow = TrgSheet.Cells(TrgSheet.Rows.Count, 1).End(xlUp).Offset(1).Row\nSrcRange = \"A\" &amp; Trim(Str(SrcRow)) &amp; \":Q\" &amp; Trim(Str(SrcRow))\nTrgRange = \"A\" &amp; Trim(Str(TrgRow))\nSrcSheet.Range(SrcRange).Copy Destination:=TrgSheet.Range(TrgRange)\n\nSrcRow = SrcRow + 1\nDoEvents\nLoop\n Excel_Tools.TurnEverythingOn ' Turn on Calc , Screen Updating and Calcs\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10986994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aecf1f8a7f5a0e4997ab1a8f8711f46?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne B", "link": "https://stackoverflow.com/users/10986994/wayne-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1548963991, "creation_date": 1548796059, "last_edit_date": 1548867864, "question_id": 54429582, "link": "https://stackoverflow.com/questions/54429582/excel-vba-splitting-data-into-sheets", "title": "Excel VBA Splitting Data into Sheets", "body": "<p>I am new to VBA Coding but have managed to fumble my way through.</p>\n\n<p>I have found this and modified to my requirements but I want to specify the range of columns to copy which are A to Q.</p>\n\n<p>Any help would be appreciated.</p>\n\n<pre><code>Sub SplitData_ToPLCSheets()\n    'Split KEPServerCombined Column r into Separate Sheets ready for Export   (PLC Name)\n    Const NameCol = \"R\"\n    Const HeaderRow = 1\n    Const FirstRow = 2\n    Dim SrcSheet As Worksheet\n    Dim TrgSheet As Worksheet\n    Dim SrcRow As Long\n    Dim LastRow As Long\n    Dim TrgRow As Long\n    Dim PLC As String\n    Excel_Tools.TurnEverythingOff ' Turn off Calc , Screen Updating and `enter code here`Calcs\n    Set SrcSheet = ThisWorkbook.Sheets(\"KEPServerCombined\")\n    'Set SrcSheet = ActiveSheet\n    LastRow = SrcSheet.Cells(SrcSheet.Rows.Count, NameCol).End(xlUp).row\n    For SrcRow = FirstRow To LastRow\n        PLC = SrcSheet.Cells(SrcRow, NameCol).value\n        Set TrgSheet = Nothing\n        On Error Resume Next\n        Set TrgSheet = Worksheets(PLC)\n        On Error GoTo 0\n        If TrgSheet Is Nothing Then\n            Set TrgSheet = Worksheets.Add(After:=Worksheets(Worksheets.Count))\n            TrgSheet.name = PLC\n            SrcSheet.Rows(HeaderRow).Copy Destination:=TrgSheet.Rows(HeaderRow)\n        End If\n        TrgRow = TrgSheet.Cells(TrgSheet.Rows.Count, NameCol).End(xlUp).row + 1\n        SrcSheet.Rows(SrcRow).Copy Destination:=TrgSheet.Rows(TrgRow)\n    Next SrcRow\n    Excel_Tools.TurnEverythingOn ' Turn on Calc , Screen Updating and Calcs\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement", "search", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1548797148, "post_id": 54429365, "comment_id": 95669722, "body": "Why not use a lookup table and shorten the formula to a more palatable size?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1548797568, "post_id": 54429365, "comment_id": 95669897, "body": "Can you give us a sample of data that you have to search and what you&#39;re looking for? That would be easier to work with than starting with your formula and working backwards."}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1548806589, "post_id": 54429365, "comment_id": 95672571, "body": "I agree with Scott, use a lookup table.  That way, anyone can update the table and get the result they need.  The vast minority will NOT be able to update the VBA if things need to change.  Abstract the logic from the code where you can."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10782710, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lyMptrg2ELs/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hQxfnC3Bx4DOavoZeZcTTqjrdoEA/mo/photo.jpg?sz=128", "display_name": "Jon Dee", "link": "https://stackoverflow.com/users/10782710/jon-dee"}, "edited": false, "score": 0, "creation_date": 1548802531, "post_id": 54430851, "comment_id": 95671536, "body": "I believe for your case a Select Case is better then a nested if statement, it reads much easier in VBA coding. The order in which you evaluate is not as important either, if you are truly looking for a value."}, {"owner": {"reputation": 31, "user_id": 10782710, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lyMptrg2ELs/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hQxfnC3Bx4DOavoZeZcTTqjrdoEA/mo/photo.jpg?sz=128", "display_name": "Jon Dee", "link": "https://stackoverflow.com/users/10782710/jon-dee"}, "edited": false, "score": 0, "creation_date": 1548894431, "post_id": 54430851, "comment_id": 95711615, "body": "@user10986956 Which Column are you evaluating, and which Column did you need the information in? Is the age always displayed with the left 2 characters being age? So 20 YR OLD, or 20 YR, but always 20 is the left 2?"}], "tags": [], "owner": {"reputation": 31, "user_id": 10782710, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lyMptrg2ELs/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hQxfnC3Bx4DOavoZeZcTTqjrdoEA/mo/photo.jpg?sz=128", "display_name": "Jon Dee", "link": "https://stackoverflow.com/users/10782710/jon-dee"}, "is_accepted": false, "score": 0, "last_activity_date": 1548894153, "last_edit_date": 1548894153, "creation_date": 1548802454, "answer_id": 54430851, "question_id": 54429365, "link": "https://stackoverflow.com/questions/54429365/turn-nested-if-formula-into-vba/54430851#54430851", "title": "Turn nested if formula into VBA", "body": "<p>You could try this, I tested it and it worked for me utilizing whole numbers as you stated (10,15,5,1,30,20) and changed it to the \"word1\" etc. If you were looking for a range, i.e. 1 but less than 10, the select case can be updated. You have to insert your workbook name and extension as well as worksheet name where indicated in the code. </p>\n\n<pre><code>Sub Select_Case()\nDim RNG As Range\nDim ws As Worksheet\nDim TextTest As String\nDim AllColumn As Variant\n\nSet ws = Workbooks(\"&lt;EnterYourWorkbookName.Extension_Here&gt;\").Worksheets(\"&lt;EnterYourSheetNameHere&gt;\")\nAllColumn = ws.Range(ws.Cells(2, 4), ws.Cells(1, 4).End(xlDown).Offset(1, 0)) 'assumes heading in row 1 and no breaks in data\n\n    For i = 2 To UBound(AllColumn) 'assumes heading, no headin i = 1\n        TextTest = ws.Cells(i, 4).Value\n        Set RNG = ws.Cells(i, 4) 'rows then columns if you need to change it later, this should be where you want to output your data\n        Select Case TextTest\n            Case Is = 10\n                RNG = \"word1\"\n            Case Is = 15\n                RNG = \"word2\"\n            Case Is = 1\n                RNG = \"word3\"\n            Case Is = 20\n                RNG = \"word4\"\n            Case Is = 30\n                RNG = \"word5\"\n            'Case else (utilize if you have a catch all just in case it is something not predicted)\n                'what to do\n        End Select\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Let me know if you need some small tweaks. </p>\n"}], "owner": {"reputation": 9, "user_id": 10986956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddadccb9c6ecc8d117d02733b1ead762?s=128&d=identicon&r=PG&f=1", "display_name": "user10986956", "link": "https://stackoverflow.com/users/10986956/user10986956"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560122066, "creation_date": 1548795036, "last_edit_date": 1560122066, "question_id": 54429365, "link": "https://stackoverflow.com/questions/54429365/turn-nested-if-formula-into-vba", "title": "Turn nested if formula into VBA", "body": "<p>I would like to turn my formula into a macro. I want to look up values on column A and return a different value to column D depending on conditions.</p>\n\n<p>My formula is :</p>\n\n<pre><code>=IF(ISNUMBER(SEARCH(\"*10*\",D2,6)),\"word1\",IF(ISNUMBER(SEARCH(\"*15*\",D2,1)),\"word2\",IF(ISNUMBER(SEARCH(\"*1*\",D2,1)),\"word3\",IF(ISNUMBER(SEARCH(\"*20*\",D2,1)),\"word4\",IF(ISNUMBER(SEARCH(\"*30*\",D2,1)),\"word5\")))))\n</code></pre>\n\n<p>I need to make sure that search for <em>1</em> comes after 10 or 15 so that formula doesn't return word3 for all cells containing \"1\".</p>\n\n<p>Column A contains a text that is at times is misspelled so the only common value is the numbers. That is why I want to search the numbers within text to return word12345.</p>\n\n<p>Below is an example- I get a different excel file with age name and last name every week and need to fill out the program classification manually.</p>\n\n<pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557  \n\u2551    AGE    \u2551  NAME   \u2551 LAST NAME \u2551 PROGRAM \u2551  \n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563  \n\u2551 10 YE OLD \u2551 ANNE    \u2551 BROWN     \u2551 word1   \u2551  \n\u2551 AGE 10    \u2551 ALLY    \u2551 SMITH     \u2551 word1   \u2551  \n\u2551 15 YO     \u2551 MATT    \u2551 JANES     \u2551 word2   \u2551  \n\u2551 15        \u2551 DENNIS  \u2551 JOHNSON   \u2551 word2   \u2551  \n\u2551 10Y OLD   \u2551 DIANA   \u2551 WILLIAMS  \u2551 word1   \u2551  \n\u2551 20yr      \u2551 JORDAN  \u2551 BROWN     \u2551 word4   \u2551  \n\u2551 30 YR OLD \u2551 MELISSA \u2551 RODRIGUEZ \u2551 word5   \u2551  \n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d  \n</code></pre>\n\n<p>The data that I need to get the result from is exampled below:</p>\n\n<pre><code>10 YE OLD\nAGE 10\n15 YO\n15\n10Y OLD\n20yr\n30 YR OLD\n</code></pre>\n"}, {"tags": ["vba", "forms", "ms-access", "move"], "owner": {"reputation": 11, "user_id": 10985840, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bHN-OeOWV2k/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNXJUrcyd6dGSPmb__ZFa_KmAFQdg/mo/photo.jpg?sz=128", "display_name": "buddymartin71", "link": "https://stackoverflow.com/users/10985840/buddymartin71"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 892, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548793872, "creation_date": 1548793872, "question_id": 54429132, "link": "https://stackoverflow.com/questions/54429132/vba-form-move-method-access-not-working-for-split-forms", "title": "VBA Form.Move method (Access) - Not working for Split Forms", "body": "<p>Form.Move Method is not working for Split Forms</p>\n\n<p>In my MS Access 2016 database, I have a lot of forms that open in dialog mode.  The main Access window has no tabs.  The main window displays one form and sometimes changes sizes when going to a different main form.  The dialog style forms popup relative to the main window.</p>\n\n<p>I use the Form.Move method to position and resize the forms relative to the location of the Access Main Application Window.  The Move method works great!  However, the move method seems to do nothing for Split forms.</p>\n\n<p>I have also tried docmd.movesize since it does move and size split forms.  It also works great, except that, in my situation, docmd.movesize positions the form relative to the Main Monitor's Top-Left corner and cannot use negative numbers.  By \"Main Monitor\" i mean the monitor that is setup as the Main Monitor in Windows display settings.</p>\n\n<pre><code>DoCmd.MoveSize( _Right_, _Down_, _Width_, _Height_ )\n</code></pre>\n\n<p>Some of the users of my database use 3 monitors.  They use their laptop as their main monitor and have it position below their two bigger monitors.  Any of the desktop real estate above their laptop has negative \"<em>Down</em>\" location values as a paramater for DoCmd.MoveSize to apply.  The Form.Move method handles negative locations wonderfully, but it isn't working for my Split Forms.  For me, the DoCmd.MoveSize causes an error when using negative values.\nThe \"<em>Right</em>\" value could also be negative when the main monitor is position between the two bigger monitors.</p>\n\n<p>Here are my current form settings.  I am pretty sure I have tried every combination.</p>\n\n<pre><code>Pop Up = No\nModal = No\nDefault View = Split Form\nAuto Center = Yes\nAuto Resize = No\nFit to Screen = Yes\nBorder Style = Sizeable\n</code></pre>\n\n<p>The forms are opened with this code which overrides some of the setting above.</p>\n\n<pre><code>DoCmd.OpenForm \"frmWorkGroupList\", , , , , acDialog\n</code></pre>\n\n<p>Form Size code</p>\n\n<pre><code>DoCmd.MoveSize xPosMax, yPosMax, vWidth, vHeight\nMe.Move Left:=xPosMax, Top:=yShiftTwips, Width:=vWidth, Height:=vHeight\n</code></pre>\n\n<p>I have searched for a good solution for many hours and I have tried everything I can think of.  The only solution I can find online was to re-create my forms into sub-forms inside of main forms to simulate a split form.  I don't wan to do that.  I want Split Forms to work if possible.</p>\n\n<p>Currently I am using DoCmd.MoveSize with a check for negative values.  If there are any negative values for x and/or y I move to a default x and y location that will land on the main monitor.</p>\n\n<p>Are there any solutions that will Move/Size Split Forms to desktop locations that have negative \"<em>Down</em>\" location values?  </p>\n\n<p>Thank all of you in advance!</p>\n\n<p>Buddy Martin</p>\n"}]