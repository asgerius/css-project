[{"tags": ["vba", "for-loop", "type-mismatch"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1530149480, "post_id": 51073468, "comment_id": 89136516, "body": "I was thinking the parameter should have been cashFlows.Cells(i) but I was worried about the recursion as well."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530149681, "post_id": 51073468, "comment_id": 89136547, "body": "I bet that you are right <code>pvCf = cashFlows (i, 1) &#47; Exp(r * i)</code> makes since.  No recursion like that. +1 Comment ..lol"}, {"owner": {"reputation": 1, "user_id": 10002676, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_wTqsfBkc0c/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0vV3JUaz_4OLRHFfr1QoLRcUUGwQ/mo/photo.jpg?sz=128", "display_name": "user10002676", "link": "https://stackoverflow.com/users/10002676/user10002676"}, "edited": false, "score": 0, "creation_date": 1530158392, "post_id": 51073468, "comment_id": 89138318, "body": "Thanks so much!  long day entering formulas, the proposed fix did it."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1530162533, "post_id": 51073468, "comment_id": 89139268, "body": "@Jeeped should get half the credit.  But I&#39;m keeping the Rep..lol"}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 1, "last_activity_date": 1530150710, "last_edit_date": 1592644375, "creation_date": 1530149291, "answer_id": 51073468, "question_id": 51072882, "link": "https://stackoverflow.com/questions/51072882/vba-byref-argument-type-mismatch-of-i-within-a-for-loop/51073468#51073468", "title": "VBA ByRef argument type mismatch of &#39;i&#39; within a For Loop", "body": "<p><code>Function pvCf</code> is expecting a <code>Range</code> for its first argument:</p>\n<p>This line is passing in an <code>Integer</code> to a function that is expecting a <code>Range</code></p>\n<blockquote>\n<p>pvCf = pvCf(i, 1) / Exp(r * i)</p>\n</blockquote>\n<p>The other caveat is that <code>Function pvCf</code> is making a recursive call to itself without a way to stop the recursion.   Once you fix the <code>Data Type Mismatch</code> and run the code, it will crash Excel.</p>\n<p>As per Jeeped comments:</p>\n<p>It appears that second appearance of <code>pvCf</code> should be changed to <code>cashFlows(i, 1)</code></p>\n<blockquote>\n<pre><code>pvCf = pvCf(i, 1) / Exp(r * i) \n\npvCf = cashFlows(i, 1) / Exp(r * i) \n</code></pre>\n</blockquote>\n<pre><code>Function pvCf(cashFlows As Range, r)\nDim i As Integer\nDim n As Integer\n    n = cashFlows.Rows.Count\n        For i = 1 To n\n            pvCf = pvCf(i, 1) / Exp(r * i)\n        Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10002676, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_wTqsfBkc0c/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0vV3JUaz_4OLRHFfr1QoLRcUUGwQ/mo/photo.jpg?sz=128", "display_name": "user10002676", "link": "https://stackoverflow.com/users/10002676/user10002676"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1530150710, "creation_date": 1530143409, "question_id": 51072882, "link": "https://stackoverflow.com/questions/51072882/vba-byref-argument-type-mismatch-of-i-within-a-for-loop", "title": "VBA ByRef argument type mismatch of &#39;i&#39; within a For Loop", "body": "<p>I'm calculating the present value of cash flows input by user in a column.  Column is of any length, so using .Rows.Count object as n parameter in the For Loop.</p>\n\n<p>My question how to correct the type mismatch error:</p>\n\n<p>ByRef argument type mismatch error pops when program gets to the i of the (r,c) identifier, line 6 of the following code:</p>\n\n<pre><code>    Function pvCf(cashFlows As Range, r)\n    Dim i As Integer\n    Dim n As Integer\n        n = cashFlows.Rows.Count\n            For i = 1 To n\n                pvCf = pvCf(i, 1) / Exp(r * i)\n            Next i\n    End Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "edited": false, "score": 0, "creation_date": 1530159171, "post_id": 51072505, "comment_id": 89138517, "body": "What purpose does the <code>Combo24.SetFocus</code> serve?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10002598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4d2140dd294f0856c4b7c783924a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/10002598/don"}, "edited": false, "score": 0, "creation_date": 1530145356, "post_id": 51072935, "comment_id": 89135752, "body": "Thanks for helping.  I entered this code and tested.  When I run it, I get no results and the form seems to lock up and not allow me to try again.  The fields go blank as soon as you select a drop down selection.  Not sure why??"}, {"owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "reply_to_user": {"reputation": 1, "user_id": 10002598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4d2140dd294f0856c4b7c783924a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/10002598/don"}, "edited": false, "score": 0, "creation_date": 1530159102, "post_id": 51072935, "comment_id": 89138499, "body": "I&#39;m not sure about whether this is the issue, but the only thing I can see that&#39;s different from the original SQL (aside from the added <code>Date</code> <code>WHERE</code> statement) is the parentheses. Does it work without those @Don?"}, {"owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "edited": false, "score": 0, "creation_date": 1530159433, "post_id": 51072935, "comment_id": 89138572, "body": "Also, maybe make sure that the <code>Combo24</code> has the right bound column, so that it&#39;s <code>.value</code> isn&#39;t the PK of your [Type], but rather is the name thereof."}, {"owner": {"reputation": 1, "user_id": 10002598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4d2140dd294f0856c4b7c783924a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/10002598/don"}, "edited": false, "score": 0, "creation_date": 1530192519, "post_id": 51072935, "comment_id": 89156676, "body": "You are right.  Your code was good. I was bound to the wrong column.  I changed that and it is working.  Thanks for your help."}], "tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": false, "score": 0, "last_activity_date": 1530143894, "creation_date": 1530143894, "answer_id": 51072935, "question_id": 51072505, "link": "https://stackoverflow.com/questions/51072505/vba-code-to-add-a-date-range-to-a-form-to-refine-search/51072935#51072935", "title": "VBA code to add a date range to a form to refine search", "body": "<p>It's easier to show than describe, but I would expand your routine like this:</p>\n\n<pre><code>Private Sub SearchRecords_Click()\n    Dim strSQL As String\n    Dim strWhere As String\n    Dim strOp As String\n\n    On Error Resume Next\n\n    DoCmd.Hourglass True\n    strSQL = \"SELECT * FROM tblAGV_Log\"\n\n    strWhere = \"\"\n    strOp = \"\"\n    If Not IsNull(Me.Combo24.Value) Then\n        strWhere = strWhere &amp; strOp &amp; \"([Type] = '\" &amp; Me.Combo24.Value &amp; \"')\"\n        strOp = \" And \"\n    End If\n    If Not IsNull(Me.StartDate.Value) Then\n        strWhere = strWhere &amp; strOp &amp; \"([Date] &gt;= #\" &amp; Me.StartDate.Value &amp; \"#)\"\n        strOp = \" And \"\n    End If\n    If Not IsNull(Me.EndDate.Value) Then\n        strWhere = strWhere &amp; strOp &amp; \"([Date] &lt;= #\" &amp; Me.EndDate.Value &amp; \"#)\"\n        strOp = \" And \"\n    End If\n\n    If Len(strWhere) &gt; 0 then\n        strSQL = strSQL &amp; \" WHERE \" &amp; strWhere\n    End If\n    strSQL = strSQL &amp; \" Order by [Date] DESC\"\n\n    Me.RecordSource = strSQL\n    DoCmd.Hourglass False\n\nEnd Sub\n</code></pre>\n\n<p>This will get you pretty close.</p>\n"}], "owner": {"reputation": 1, "user_id": 10002598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4d2140dd294f0856c4b7c783924a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/10002598/don"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1594632569, "creation_date": 1530140178, "last_edit_date": 1594632569, "question_id": 51072505, "link": "https://stackoverflow.com/questions/51072505/vba-code-to-add-a-date-range-to-a-form-to-refine-search", "title": "VBA code to add a date range to a form to refine search", "body": "<p>I already have a form with a Combo drop down list for \"Type\" (this is the Antibody field records I am searching). A \"SearchRecords\" button starts the code.\nI want to add a start and end date to the form to refine the search. I have created date text boxes for <code>StartDate</code> and <code>EndDate</code>.\nMy current code is below. I need help with the VB code to get the date range.</p>\n\n<pre><code>Private Sub SearchRecords_Click()\n    Dim strSQL As String\n    On Error Resume Next\n    Combo24.SetFocus\n    DoCmd.Hourglass True\n    strSQL = \"SELECT * FROM tblAGV_Log WHERE [Type] = '\" &amp; Me.Combo24.Text &amp; \"' Order by Date DESC\"\n    Me.RecordSource = \"\"\n    Me.RecordSource = strSQL\n    DoCmd.Hourglass False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1530140858, "last_edit_date": 1530140858, "creation_date": 1530140384, "answer_id": 51072531, "question_id": 51072354, "link": "https://stackoverflow.com/questions/51072354/splitting-the-data-in-excel-2013/51072531#51072531", "title": "splitting the data in Excel 2013", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub aljali()\n    Dim i As Long, N As Long\n\n    Range(\"A:E\").NumberFormat = \"@\"\n    N = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 1 To N\n        Cells(i, \"B\").Value = Replace(Cells(i, \"B\").Value, \"-\", \"\")\n        Cells(i, \"C\").Value = Left(Cells(i, \"B\").Value, 3)\n        Cells(i, \"D\").Value = Right(Cells(i, \"B\").Value, 3)\n    Next i\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE:</strong></p>\n\n<p>The key to this is setting the format of the cells to <em>Text</em>.  This facilitates the preservation of those leading zeros.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1530140448, "creation_date": 1530140448, "answer_id": 51072538, "question_id": 51072354, "link": "https://stackoverflow.com/questions/51072354/splitting-the-data-in-excel-2013/51072538#51072538", "title": "splitting the data in Excel 2013", "body": "<p>Try,</p>\n\n<pre><code>With Worksheets(\"sheet8\")\n    For i = 2 To .Cells(.Rows.Count, \"B\").End(xlUp).Row\n        With .Cells(i, \"B\")\n            .Resize(1, 3).NumberFormat = \"@\"\n            .Resize(1, 3) = Array(Replace(.Value2, Chr(45), vbNullString), _\n                           Split(.Value2, Chr(45))(0), _\n                           Split(.Value2, Chr(45))(1))\n        End With\n    Next i\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 2, "last_activity_date": 1530141287, "last_edit_date": 1530141287, "creation_date": 1530140747, "answer_id": 51072584, "question_id": 51072354, "link": "https://stackoverflow.com/questions/51072354/splitting-the-data-in-excel-2013/51072584#51072584", "title": "splitting the data in Excel 2013", "body": "<p>Assuming <code>Col1</code> is in A1: Move ColumnB to ColumnC, split Text to Columns with <code>-</code> as delimiter (choose Text for both columns) then in B2 and copied down to suit:</p>\n\n<pre><code>=C2&amp;D2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1530141242, "last_edit_date": 1530141242, "creation_date": 1530140906, "answer_id": 51072609, "question_id": 51072354, "link": "https://stackoverflow.com/questions/51072354/splitting-the-data-in-excel-2013/51072609#51072609", "title": "splitting the data in Excel 2013", "body": "<p>If doing this outside of VBA is an option (<em>tagged</em> <code>Excel-Formula</code>), you could make use of the following three functions: <code>Left</code>, <code>Right</code>, and <code>Substitute</code>. </p>\n\n<p>You will need to add an extra column to implement this. </p>\n\n<p><a href=\"https://i.stack.imgur.com/9Blaz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9Blaz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Which will yield the following results: </p>\n\n<p><a href=\"https://i.stack.imgur.com/jtYTJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jtYTJ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1815, "user_id": 5775000, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2631983573dd739e6fa13e65c92c55f1?s=128&d=identicon&r=PG&f=1", "display_name": "Anjali", "link": "https://stackoverflow.com/users/5775000/anjali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 51072531, "answer_count": 4, "score": 0, "last_activity_date": 1530147720, "creation_date": 1530139049, "last_edit_date": 1531161705, "question_id": 51072354, "link": "https://stackoverflow.com/questions/51072354/splitting-the-data-in-excel-2013", "title": "splitting the data in Excel 2013", "body": "<p>I am very new to Excel macros. I have below data in Excel:</p>\n\n<pre><code>Col1 Col2       col3    col4  Col5\n32    000-001                   1\n32    002-001                   100\n32    005-000                   20\n</code></pre>\n\n<p>and so on. I have 6313 rows in my excel spreadsheet. </p>\n\n<p>I want to split col2 and put the first three numbers before hyphen in col3 and last three numbers in col4. I also want to remove hyphen from col2 so my final output will be like this:</p>\n\n<pre><code>col1   col2     col3    col4    col5\n32    000001    000      001    1\n32    002001    002      001    100\n332   005000    005      000    20\n</code></pre>\n\n<p>This is what I already tried. I tried to replace Hyphen with empty space and then I lost all the leading zeros. I don't want to lose all the leading zero from col2.</p>\n\n<p>Any help will be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1530138670, "post_id": 51072191, "comment_id": 89134326, "body": "What do you get with a <code>debug.print Application.Match(PO_Checker.Label1.Caption, Range(&quot;po_s&quot;), 0)</code> ? (within the worksheet&#39;s private code sheet)"}, {"owner": {"reputation": 1, "user_id": 10002508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUGrp.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/10002508/chris"}, "edited": false, "score": 0, "creation_date": 1530201899, "post_id": 51072191, "comment_id": 89162968, "body": "i put this into the private worksheet code                                                              &quot;Private Sub Worksheet_SelectionChange() Debug.Print Application.Match(PO_Checker.Label1.Caption, Range(&quot;po_s&quot;), 0) End Sub&quot;                                                                                                                   I then get a &quot;compile error:     procedure declaration does not match description of event or procedure having the same name&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530201976, "post_id": 51072191, "comment_id": 89163014, "body": "... and what was in the VBE&#39;s Immediate window after you did that?"}, {"owner": {"reputation": 1, "user_id": 10002508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUGrp.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/10002508/chris"}, "edited": false, "score": 0, "creation_date": 1530206390, "post_id": 51072191, "comment_id": 89165237, "body": "it just opened VBA and highlighted :Private Sub Worksheet_SelectionChange()  in blue"}], "owner": {"reputation": 1, "user_id": 10002508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUGrp.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/10002508/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593629178, "creation_date": 1530137913, "last_edit_date": 1593629178, "question_id": 51072191, "link": "https://stackoverflow.com/questions/51072191/application-goto-run-time-error-5", "title": "Application.Goto Run-Time Error 5", "body": "<p>I have been an active user of the information on this site and it has generally served me very well. I am struggling with this one however... I built an excel document a while back with this code:\nApplication.Goto Range(\"PART_NUMBERS\").Cells(Application.Match(ROP_UPDATE.Label5.Caption, Range(\"PART_NUMBERS\"), 0))</p>\n\n<p>and it works beautifully! Basically it checks to see if a checkmark on a userform is checked and if it is it then finds the label associated with that checkmark and it finds it in a range where i can use other lines of code to do stuff. anyway... I am building another document where i need to do essentially the same thing and i built the code accordingly:</p>\n\n<p>Application.Goto Range(\"po_s\").Cells(Application.Match(PO_Checker.Label1.Caption, Range(\"po_s\"), 0))</p>\n\n<p>it gives me run-time error 5 every time. Identical code basically and i have looked over my named ranges and changed them a few times. I am stumped. Why does this code work good on my first document but not the one i am working on now? both are macro enabled. Any suggestions help. Thank you!</p>\n"}, {"tags": ["xml", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 1, "creation_date": 1530187361, "post_id": 51072054, "comment_id": 89153233, "body": "Do you only want to import the CDATA in the report body (into an existing table)? How is the data delimited? Could you let us know how you expect the above XML to be parsed into the table structure you need?"}, {"owner": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "reply_to_user": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1530300194, "post_id": 51072054, "comment_id": 89203397, "body": "I would like to import the items in the header nodes into their own fields, and then have those values repeat in front of the CDATA.  In my minds eye this is what the first row of data would look like, with each field marked out by a &quot;/&quot;.  A5A1ED/UNKNOWN/1/12/2016/18/36/58/COL3A-0072-001N/BCG3F-CMCM&zwnj;&#8203;-002K/MSG/2158513/01&zwnj;&#8203;DEC16/1714/TO/A 1"}, {"owner": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "reply_to_user": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1530300532, "post_id": 51072054, "comment_id": 89203549, "body": "Then the following row would be   A5A1ED/UNKNOWN/1/12/2016/18/36/58/COL3A-0072-001N/BCG3F-CMCM&zwnj;&#8203;-002K/FDE/21500944/0&zwnj;&#8203;1DEC16/1713/TA/A  Where the first 10 fields have repeated."}, {"owner": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "reply_to_user": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1530312098, "post_id": 51072054, "comment_id": 89207450, "body": "The data in the CDATA section is delimited by blank spaces"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530301180, "post_id": 51090550, "comment_id": 89203845, "body": "I did reply to zack with how I want to store this, at least with the initial thought I had.  Let&#39;s say I only need to extract the infomation in the CDATA &lt;storagereport&gt; section, and starting with &quot;MSG&quot; I wanted the fields be MSG, FAULT_CODE, REC_DATE, REC_TIME, PHASE, PRI_CODE, with each row delimited by spaces.  MSG, REC_DATE, and REC_TIME would have fixed lengths, while FAULT_CODE, PHASE, PRI_CODE, could vary between 7-10, 2-5, and 1-5 characters respectively.  It would be nice to have the fields in the header and the first row of the CDATA repeat in fields in front of each of those records"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530304008, "post_id": 51090550, "comment_id": 89205006, "body": "The <i>don&#39;t ask multibarreled questions</i> message isn&#39;t really getting through, is it? As previously said, string splitting is a different task than parsing XML."}, {"owner": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530311887, "post_id": 51090550, "comment_id": 89207401, "body": "Well I apologize, responding to where you asked for more information as to how I wanted to store this data.  Without asking about splitting the string under &lt;storagereport&gt;, I am trying to store each of the text nodes in a separate field.  Parfait&#39;s transformation should make that fairly straightforward once I figure out the syntax to say &quot;store &lt;timestamp/day&gt; into field name REC_DAY in tblFAULT_CODE&quot;."}, {"owner": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530575129, "post_id": 51090550, "comment_id": 89274134, "body": "I was finally able to try your code in the database I&#39;m working on, I get an &quot;unknown method&quot; on the query string.  Was there something I needed to changed there? Sorry I&#39;m pretty new to this."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1530216524, "creation_date": 1530216524, "answer_id": 51090550, "question_id": 51072054, "link": "https://stackoverflow.com/questions/51072054/append-xml-file-to-existing-access-table/51090550#51090550", "title": "Append XML file to existing Access table", "body": "<p>While Zack has a point (you need to share a bit more if you want us to really help you), I can try to help you further along.</p>\n\n<p>First, you need to turn <code>ValidateOnParse</code> on if you're going to parse that XML document without the xsd.</p>\n\n<p>Then, you can iterate through all text nodes containing actual text by using the following XPATH query:</p>\n\n<pre><code>//*[string-length(normalize-space(text())) &gt; 0]/text()\n</code></pre>\n\n<p>You will still have to fill in the specifics about how you're going to store this, but this should get you started. It gives you the node name and value for each node containing text. </p>\n\n<p>You still have to add some logic for storing them in the appropriate fields in your table.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub btn_Import_Click()\n   Dim StrFileName As String\n   Dim fd As FileDialog\n   Dim vrtSelectedItem As Variant\n   Dim oDoc As MSXML2.DOMDocument60\n   Set oDoc = New MSXML2.DOMDocument60\n   oDoc.async = False\n   oDoc.validateOnParse = True\n   Set fd = Application.FileDialog(msoFileDialogFilePicker)\n   With fd\n        .InitialFileName = \"c:\\sample\\*.xml\"\n        If .Show = -1 Then\n            For Each vrtSelectedItem In .selectedItems\n                If oDoc.Load(vrtSelectedItem) Then\n                    Dim textNodes As IXMLDOMNodeList\n                    Set textNodes = oDoc.SelectNodes(\"//*[string-length(normalize-space(text())) &gt; 0]/text()\")\n                    Dim l As Long\n                    For l = 0 To textNodes.length - 1\n                        Debug.Print textNodes(l).ParentNode.nodeName 'Node name\n                        Debug.Print textNodes(l).NodeValue 'Node value\n                    Next\n                End If\n\n            Next vrtSelectedItem\n        Else\n        End If\n    End With\n    Set fd = Nothing\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530300627, "post_id": 51091083, "comment_id": 89203604, "body": "Thanks, I will take a look at this later this evening; my government computer doesn&#39;t like the link to see how this looks."}, {"owner": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530301327, "post_id": 51091083, "comment_id": 89203907, "body": "Ok, I found a viewer to see what this would look like, all of the fields would import the way I want using this except the field containing the CDATA.  If I defined that node as a text object, could I then delimit it into different fields?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530301606, "post_id": 51091083, "comment_id": 89204013, "body": "Correct, all nodes are on same level now to import into one table."}, {"owner": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530313920, "post_id": 51091083, "comment_id": 89207820, "body": "Trying the code you wrote, I&#39;m getting a compile error for &quot;TransformXML = outputfile&quot; Argument not optional"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530315168, "post_id": 51091083, "comment_id": 89208054, "body": "Whoops! See edit should read <code>CombineNodesXML = outputfile</code>. I had changed the a function name since Access has a <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/application-transformxml-method-access\" rel=\"nofollow noreferrer\">TransformXML</a> method."}, {"owner": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530344695, "post_id": 51091083, "comment_id": 89212367, "body": "Thanks, I&#39;ll try this Monday when I&#39;m back at my desk. I think you&#39;ve got me most of the way to solving this."}, {"owner": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530575153, "post_id": 51091083, "comment_id": 89274139, "body": "Finally got a chance to get back into access and try this.  I was getting an error on the newdoc.save output file line, do I added  = &quot; &quot; and now I&#39;m getting &quot;The parameter is incorrect&quot; on the Application.ImportXML StrFileName, acAppendData line"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530581381, "post_id": 51091083, "comment_id": 89275286, "body": "What is the error you get? Possibly <i>newDoc</i> is not a proper XML output. Are you sure XML files are same structure as what you posted? If any differ, transformation may not work."}, {"owner": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530677610, "post_id": 51091083, "comment_id": 89314446, "body": "I&#39;m getting &quot;Run-time error &#39;-2147024809 (80070057)&#39;: The parameter is incorrect&quot;.  The outputfile seems to need a path defined afterwards, because when I add an = &quot;c:\\path_transformed.xml&quot; the error moves to the .ImportXML line on the first sub"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "edited": false, "score": 0, "creation_date": 1530719149, "post_id": 51091083, "comment_id": 89337139, "body": "Nope. <code>Save</code> is a method and not property so it is not assigning a value requiring <code>=</code>. I have added error handlers for a more informative message. Try importing just one XML and not many to test process. One again, I think the issue is your XML files are coming in as different format where XSLT is not transforming correctly, so <i>newDoc</i> is an empty object."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 2, "last_activity_date": 1530719048, "last_edit_date": 1530719048, "creation_date": 1530219275, "answer_id": 51091083, "question_id": 51072054, "link": "https://stackoverflow.com/questions/51072054/append-xml-file-to-existing-access-table/51091083#51091083", "title": "Append XML file to existing Access table", "body": "<p><em>I don't have the option of restructuring this XML</em> ... actually you do with <a href=\"https://www.w3.org/Style/XSL/\" rel=\"nofollow noreferrer\">XSLT</a>, the special purpose language designed to transform XML files and <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ms767600(v%3dvs.85)\" rel=\"nofollow noreferrer\">MSXML</a> can run XSLT 1.0 scripts. </p>\n\n<p>Simply combine <em>HEADER</em> and <em>ReportBody</em> into one node, such as <em>REPORT</em> (which will be name of Access table). Then import this transformed XML with Access' <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/application-importxml-method-access\" rel=\"nofollow noreferrer\">Application.ImportXML</a>.</p>\n\n<p><strong>XSLT</strong> <em>(save as .xsl file, a special .xml file)</em></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n                xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n                xsi:noNameSpaceSchemaLocation=\"CMCReports.xsd\" \n                version=\"1.0\"&gt;\n  &lt;xsl:output method=\"xml\" indent=\"yes\"/&gt;\n  &lt;xsl:strip-space elements=\"*\"/&gt;\n\n  &lt;xsl:template match=\"/*\"&gt;\n    &lt;data&gt;\n      &lt;xsl:apply-templates select=\"HEADER\"/&gt;\n    &lt;/data&gt;\n  &lt;/xsl:template&gt;\n\n    &lt;xsl:template match=\"HEADER|ReportBody\"&gt;\n        &lt;REPORT&gt;\n            &lt;xsl:copy-of select=\"ModeS|TailNumber\"/&gt;\n            &lt;xsl:copy-of select=\"Timestamp/*\"/&gt;\n            &lt;xsl:copy-of select=\"following-sibling::ReportBody/*\"/&gt;\n        &lt;/REPORT&gt;\n    &lt;/xsl:template&gt;\n\n&lt;/xsl:stylesheet&gt;\n</code></pre>\n\n<p><a href=\"https://xsltfiddle.liberty-development.net/pPqsHTr/1\" rel=\"nofollow noreferrer\">XSLT Fiddle Demo</a> <em>(see result in lower left)</em></p>\n\n<p><strong>VBA</strong> <em>(separates file picker iteration and transform process, assumes all XMLs are same structure)</em></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub btn_Import_Click()\nOn Error GoTo ErrHandle\n    Dim StrFileName As String\n    Dim fd As FileDialog\n    Dim vrtSelectedItem As Variant\n\n    ' ITERATE THROUGH MULTIPLE FILE PICKER\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n    With fd.InitialFileName = \"c:\\sample\\*.xml\"\n        If .Show = -1 Then\n            For Each vrtSelectedItem In .SelectedItems\n                ' TRANSFORM XML FILE\n                StrFileName = CombineNodesXML(vrtSelectedItem)\n\n                ' IMPORT TRANSFORMED XML (APPENDING TO EXISTING)                     \n                Application.ImportXML StrFileName, acAppendData    \n            Next vrtSelectedItem\n        End If\n    End With\n\nExitHandle:\n    Set fd = Nothing\n    Exit Sub\n\nErrHandle:\n    Msgbox Err.Number &amp; \" - \" &amp; Err.Description, \"RUNTIME ERROR\", vbCritical\n    Resume ExitHandle\nEnd Sub\n\nPublic Function CombineNodesXML(xmlfile As Variant) As String\nOn Error GoTo ErrHandle\n    Dim xmldoc As New MSXML2.DOMDocument, xslDoc As New MSXML2.DOMDocument, newDoc As New MSXML2.DOMDocument\n    Dim outputfile As String         \n\n    outputfile = Replace(xmlfile, \".xml\", \"_transformed.xml\")\n\n    ' LOAD XML AND XSL FILES\n    xmlDoc.async = False\n    xmlDoc.Load xmlfile\n\n    xslDoc.async = False    \n    xslDoc.Load \"C:\\Path\\To\\XSLT_Script.xml\"        ' REPLACE WITH ABOVE XSLT PATH     \n\n    ' TRANSFORM AND SAVE XML \n    xmldoc.transformNodeToObject xslDoc, newDoc\n    newDoc.Save outputfile\n\n    ' RETURN OUTPUT PATH\n    CombineNodesXML = outputfile\n\nExitHandle:\n    ' RELEASE OBJECTS\n    Set xmlDoc = Nothing: Set xslDoc = Nothing: Set newDoc = Nothing\n    Exit Function\n\nErrHandle:\n    Msgbox Err.Number &amp; \" - \" &amp; Err.Description, \"RUNTIME ERROR\", vbCritical\n    Resume ExitHandle\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9837723, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Quigley", "link": "https://stackoverflow.com/users/9837723/kyle-quigley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1199, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1530719048, "creation_date": 1530136983, "last_edit_date": 1530217269, "question_id": 51072054, "link": "https://stackoverflow.com/questions/51072054/append-xml-file-to-existing-access-table", "title": "Append XML file to existing Access table", "body": "<p>I have an XML file I need to import into an Access table.  The XML file contains a Header with several fields, and a report body with a CDATA field containing repeating information (delimited text within the CDATA).  Here is the basic version of what it looks like:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;CMCFReport      \nxsi:noNameSpaceSchemaLocation=\"CMCReports.xsd\"\n xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n   &lt;HEADER&gt;\n      &lt;ModeS&gt;A5A1ED&lt;/ModeS&gt;\n      &lt;TailNumber&gt;UNKNOWN&lt;/TailNumber&gt;\n      &lt;Timestamp&gt;\n         &lt;Day&gt;1&lt;/Day&gt;\n         &lt;Month&gt;12&lt;/Month&gt;\n         &lt;Year&gt;2016&lt;/Year&gt;\n         &lt;Hour&gt;18&lt;/Hour&gt;\n         &lt;Minute&gt;36&lt;/Minute&gt;\n         &lt;Second&gt;58&lt;/Second&gt;\n       &lt;/Timestamp&gt;\n   &lt;/HEADER&gt;\n   &lt;ReportBody&gt;\n      &lt;StorageReport&gt;\n         &lt;![CDATA[PLF 01DEC16 1835 --------- L\nCOL3A-0072-001N BCG3F-CMCM-002K\nMSG 2158513 01DEC16 1714 TO           A 1  \nFDE 21500944 01DEC16 1713 TA           A\nFDE 21502445 01DEC16 1713 TA           A\nMSG 2158512 01DEC16 1714 TO           A 1\nEOR\n]]&gt;\n    &lt;/StorageReport&gt;\n  &lt;/ReportBody&gt;\n&lt;/CMCFReport&gt;\n</code></pre>\n\n<p>When I run the import utility, Access tries to put the HEADER data and the REPORT body data into separate tables.  What is the VBA script for importing XML where you designate what field each item goes into?  This is as far as I've gotten so far:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub btn_Import_Click()\nDim StrFileName As String\n   Dim fd As FileDialog\n   Dim vrtSelectedItem As Variant\n   Dim oDoc As MSXML2.DOMDocument60\n   Set oDoc = New MSXML2.DOMDocument60\n   Set fd = Application.FileDialog(msoFileDialogFilePicker)\n   With fd.InitialFileName = \"c:\\sample\\*.xml\"\n        If .Show = -1 Then\n            For Each vrtSelectedItem In .SelectedItems\n                If oDoc.Load(vrtSelectedItem) Then\n                    Dim oNodes As MSXML2.IXMLDOMNodeList\n                    oNodes = oDoc.Nodes\n\n                    Dim oNode As MSXML2.IXMLDOMNode\n                    For Each oNode In oNodes \n                    'This is where I imagine the code would be to pull the relevant data out of each node and assign it to a field, I just don't know how to do that`\n                    Next oNode\n                End If\n\n            Next vrtSelectedItem\n        Else\n        End If\n    End With\n    Set fd = Nothing\nEnd Sub\n</code></pre>\n\n<p>I've never imported XML before, and I don't have the option of restructuring this XML, as I would be receiving a file from an outside source and importing it on a regular basis.  Any help would be appreciated.  Thanks.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10002278, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OTf8k0k24WU/AAAAAAAAAAI/AAAAAAAAAU0/ER99niHHEvk/photo.jpg?sz=128", "display_name": "iGRiK", "link": "https://stackoverflow.com/users/10002278/igrik"}, "edited": false, "score": 0, "creation_date": 1530136482, "post_id": 51071714, "comment_id": 89133684, "body": "Thanks, it worked. Once add dbFailOnError and debug I noticed that I had 1-1 relationship between tables and after I switched to 1-m everything started to work smoothly."}], "tags": [], "owner": {"reputation": 3203, "user_id": 430567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5c53d9384850093ebc925e896629b1?s=128&d=identicon&r=PG", "display_name": "Lord Peter", "link": "https://stackoverflow.com/users/430567/lord-peter"}, "is_accepted": true, "score": 2, "last_activity_date": 1530135061, "creation_date": 1530135061, "answer_id": 51071714, "question_id": 51071516, "link": "https://stackoverflow.com/questions/51071516/ms-access-vba-skip-insert-to-one-of-the-table/51071714#51071714", "title": "MS Access VBA skip insert to one of the table", "body": "<p>It may help you to evaluate the SQL statement you are executing so you can see exactly what is going on:-</p>\n\n<pre><code>Private Sub cmdAdd_Click()\ndim sSQL as string\nsSQL = \" INSERT INTO Apartment(Apartment, Account_ID, Total_area, Heated_area, People) \" &amp; _\n       \" VALUES ( \" &amp; Me.txtApt &amp; \",'\" &amp; Me.txtAcc &amp; \"','\" &amp; _\n       Me.txtTotal_area &amp; \"','\" &amp; Me.txtHeated_area &amp; \"','\" &amp; Me.txtPeople &amp; \"')\"\n'add to apartment\ndebug.print sSQL\nCurrentDb.Execute sSQL, dbFailOnError\n'add to owner\nsSQL = \" INSERT INTO Owner (Account, FName, LName, MName) \" &amp; _\n       \" VALUES ( \" &amp; Me.txtAcc &amp; \",'\" &amp; Me.txtFName &amp; \"','\" &amp; _\n       Me.txtLName &amp; \"','\" &amp; Me.txtMName &amp; \"')\"\ndebug.print sSQL\nCurrentDb.Execute sSQL, dbFailOnError '... etc\n</code></pre>\n\n<p>Note also the use of dbFailOnError, so if there is something preventing insert into Apartment table (constraint, key violation etc) then an error will be raised so you can check details.</p>\n"}], "owner": {"reputation": 3, "user_id": 10002278, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OTf8k0k24WU/AAAAAAAAAAI/AAAAAAAAAU0/ER99niHHEvk/photo.jpg?sz=128", "display_name": "iGRiK", "link": "https://stackoverflow.com/users/10002278/igrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 51071714, "answer_count": 1, "score": 0, "last_activity_date": 1530135061, "creation_date": 1530134082, "question_id": 51071516, "link": "https://stackoverflow.com/questions/51071516/ms-access-vba-skip-insert-to-one-of-the-table", "title": "MS Access VBA skip insert to one of the table", "body": "<p>I was writing a VBA code for a button on a form. The purpose of it should be, Add data to table Apartment and table Owner. However, it skips the Apartment table and just add to data to Owner table. I also don't receive any bug alerts, everything looks that it went through but Apartment table is still empty. Here is my code.</p>\n\n<pre><code>Private Sub cmdAdd_Click()\n    'add to apartment\n    CurrentDb.Execute \" INSERT INTO Apartment(Apartment, Account_ID, Total_area, Heated_area, People) \" &amp; _\n           \" VALUES ( \" &amp; Me.txtApt &amp; \",'\" &amp; Me.txtAcc &amp; \"','\" &amp; _\n           Me.txtTotal_area &amp; \"','\" &amp; Me.txtHeated_area &amp; \"','\" &amp; Me.txtPeople &amp; \"')\"\n    'add to owner\n    CurrentDb.Execute \" INSERT INTO Owner (Account, FName, LName, MName) \" &amp; _\n           \" VALUES ( \" &amp; Me.txtAcc &amp; \",'\" &amp; Me.txtFName &amp; \"','\" &amp; _\n           Me.txtLName &amp; \"','\" &amp; Me.txtMName &amp; \"')\"\n    'clear\n    cmdClear_Click\n\n    'subform requery\n    frmAptSub.Form.Requery\nEnd Sub    \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1530133718, "post_id": 51071297, "comment_id": 89132650, "body": "Get rid of the loop and use <code>UniqueArray = TempArray</code> to return the array."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5565219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec22882abd0e31e4844f5ca6a746ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Dooey", "link": "https://stackoverflow.com/users/5565219/dooey"}, "edited": false, "score": 0, "creation_date": 1530204343, "post_id": 51071519, "comment_id": 89164273, "body": "Thanks for the answer, I am afraid it says redim is invalid. If you do the dim within the function you get the error multiple declaration."}], "tags": [], "owner": {"reputation": 1, "user_id": 9587797, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ccacAgAQDXY/AAAAAAAAAAI/AAAAAAAAlqs/roNmX_XQnoI/photo.jpg?sz=128", "display_name": "Sean", "link": "https://stackoverflow.com/users/9587797/sean"}, "is_accepted": false, "score": -1, "last_activity_date": 1530134092, "creation_date": 1530134092, "answer_id": 51071519, "question_id": 51071297, "link": "https://stackoverflow.com/questions/51071297/setting-the-return-value-in-vba-function-invokes-the-function-itself/51071519#51071519", "title": "Setting the return value in vba function invokes the function itself", "body": "<p>I believe you would need to redim <em>UniqueArray</em> not <em>MyArray</em> since <em>MyArray</em> is the input for the function.  Since you have not declared it as an array yet.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1530148435, "last_edit_date": 1530148435, "creation_date": 1530134135, "answer_id": 51071523, "question_id": 51071297, "link": "https://stackoverflow.com/questions/51071297/setting-the-return-value-in-vba-function-invokes-the-function-itself/51071523#51071523", "title": "Setting the return value in vba function invokes the function itself", "body": "<p>Pass the TempArray array back as a whole. You shouldn't need to rely on 'helper' functions to determine uniqueness as an Excel.Application has multiple options.</p>\n\n<pre><code>Sub main()\n    Dim arr As Variant\n\n    arr = Array(1, 2, 2, 3, 4, 5, 5)\n\n    Debug.Print Join(arr, \",\")    '1,2,2,3,4,5,5\n\n    arr = UniqueArray(arr)\n\n    Debug.Print Join(arr, \",\")    '1,2,3,4,5\n\nEnd Sub\n\nFunction UniqueArray(MyArray) As Variant\n\n    Dim i As Long, TempArray As Variant\n\n    ReDim TempArray(0)\n    TempArray(0) = MyArray(LBound(MyArray))\n\n    For i = LBound(MyArray) + 1 To UBound(MyArray)\n          If IsError(Application.Match(MyArray(i), TempArray, 0)) Then\n                ReDim Preserve TempArray(UBound(TempArray) + 1)\n                TempArray(UBound(TempArray)) = MyArray(i)\n          End If\n    Next i\n\n    UniqueArray = TempArray\n\nEnd Function\n</code></pre>\n\n<p>If the function is to be used outside of Excel, then you will likely want to retain the IsInArray companion function.</p>\n"}], "owner": {"reputation": 35, "user_id": 5565219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec22882abd0e31e4844f5ca6a746ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Dooey", "link": "https://stackoverflow.com/users/5565219/dooey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1530148435, "creation_date": 1530133087, "last_edit_date": 1531164843, "question_id": 51071297, "link": "https://stackoverflow.com/questions/51071297/setting-the-return-value-in-vba-function-invokes-the-function-itself", "title": "Setting the return value in vba function invokes the function itself", "body": "<p>I use the following function to get unique values in the array. However in the second last line, UniqueArray(i) = TempArray(i), it invokes the function itself again instead of assigning the array value.\nThanks for any help.</p>\n\n<pre><code>Function UniqueArray(MyArray) As Variant\n\nDim TempArray As Variant\nReDim TempArray(0)\nTempArray(0) = MyArray(LBound(MyArray))\nFor i = LBound(MyArray) To UBound(MyArray)\n      If Not IsInArray(TempArray, MyArray(i)) Then\n            ReDim Preserve TempArray(UBound(TempArray) + 1)\n            TempArray(UBound(TempArray)) = MyArray(i)\n      End If\nNext i\n\nReDim MyArray(UBound(TempArray))\nFor i = LBound(TempArray) To UBound(TempArray)\n    UniqueArray(i) = TempArray(i)\nNext i\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530132773, "post_id": 51071131, "comment_id": 89132284, "body": "For starters this should be Set MatchName = Sheets(&quot;Sheet1&quot;).Cells(i, 3) if column C"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530133094, "post_id": 51071263, "comment_id": 89132403, "body": "Thanks, however I&#39;m getting the same result even after making these changes. Nothing happens.."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530133203, "post_id": 51071263, "comment_id": 89132456, "body": "It definitely does if column A = B for a row greater than  2 then column C gets column B &#39;s value."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530133279, "post_id": 51071263, "comment_id": 89132492, "body": "Can you show some data otherwise? Try the bottom version aswell which is a reduced version."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530133349, "post_id": 51071263, "comment_id": 89132514, "body": "Have you got screenupdating turned off or something?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530133415, "post_id": 51071263, "comment_id": 89132537, "body": "And step through the code with F8 and verify loop is entered and value of .Range(&quot;B&quot; &amp; .Rows.Count).End(xlUp).Row"}, {"owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530133723, "post_id": 51071263, "comment_id": 89132652, "body": "screenupdating is on.. would a massive amount of rows affect the macro? All data is text and the way you describe the function in your first comment is how it should be."}, {"owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530133979, "post_id": 51071263, "comment_id": 89132746, "body": "could it be an issue with macro security?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530134048, "post_id": 51071263, "comment_id": 89132768, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/173922/discussion-between-qharr-and-carter\">continue this discussion in chat</a>."}, {"owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530191308, "post_id": 51071263, "comment_id": 89155758, "body": "thanks for your help.. for some reason none of these did anything but the answer above did.."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530191582, "post_id": 51071263, "comment_id": 89155961, "body": "Not sure what to say. Did you try running them again today? At least you have a solution :-)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530191748, "post_id": 51071263, "comment_id": 89156070, "body": ":-( sad face then. Sorry."}, {"owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530201423, "post_id": 51071263, "comment_id": 89162689, "body": "don&#39;t be! I am really confused why your initial code didn&#39;t modify anything - any ideas?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 3, "last_activity_date": 1530135309, "last_edit_date": 1530135309, "creation_date": 1530132885, "answer_id": 51071263, "question_id": 51071131, "link": "https://stackoverflow.com/questions/51071131/extract-and-list-matching-cells/51071263#51071263", "title": "Extract and List Matching Cells", "body": "<p>Here is a tidied version with correctly using column C i.e.</p>\n\n<p><code>Set MatchName = Sheets(\"Sheet1\").Cells(i, 3) if column C</code>.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub matching()\n    Dim LastRow As Long, i As Long, Row2Name As Range, Row1Name  As Range, MatchName As Range\n\n    With Worksheets(\"Sheet1\")\n        LastRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n\n        For i = 3 To LastRow\n\n            Set Row2Name = .Cells(i, 2)\n            Set Row1Name = .Cells(i, 1)\n            Set MatchName = .Cells(i, 3)\n\n            If .Cells(i, 2) = Row1Name Then\n                Row2Name.Copy\n                MatchName.PasteSpecial Paste:=xlPasteValues\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Which is essentially this:</p>\n\n<pre><code>Option Explicit\nPublic Sub matching()\n    Dim i As Long\n    Application.ScreenUpdating = False\n    With Worksheets(\"Sheet1\")\n        For i = 3 To .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n            If .Cells(i, 1) = .Cells(i, 2) Then .Cells(i, 3) = .Cells(i, 2)\n        Next i\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>For large numbers of rows you could do this all in memory using an array.</p>\n\n<pre><code>Public Sub matching()\n    Dim arr(), i As Long\n    With Worksheets(\"Sheet1\")\n        .Columns(3).ClearContents\n        arr = .Range(\"A3:C\" &amp; .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row).Value\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            If arr(i, 1) = arr(i, 2) Then arr(i, 3) = arr(i, 2)\n        Next i\n        .Cells(3, 1).Resize(UBound(arr, 1), UBound(arr, 2)) = arr\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530195073, "post_id": 51072136, "comment_id": 89158493, "body": "What is the appropriate way to ask a follow up question? I intended to use a method similar to my original code and modify it to do something more complex. I am not familiar with arrays so modifying the code is a bit daunting"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530195356, "post_id": 51072136, "comment_id": 89158709, "body": "Just ask your new question with updated code and/or sample data. If you feel it would help, link back to this question with a note that says &#39;follow up to this&#39;."}, {"owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "edited": false, "score": 0, "creation_date": 1530197394, "post_id": 51072136, "comment_id": 89160045, "body": "<a href=\"https://stackoverflow.com/questions/51085540/filter-and-modify-database-with-array\" title=\"filter and modify database with array\">stackoverflow.com/questions/51085540/&hellip;</a> - thanks again"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1530137502, "creation_date": 1530137502, "answer_id": 51072136, "question_id": 51071131, "link": "https://stackoverflow.com/questions/51071131/extract-and-list-matching-cells/51072136#51072136", "title": "Extract and List Matching Cells", "body": "<p>Try to process in memory with arrays and avoid loops when faster 'prove existence' methods are available..</p>\n\n<pre><code>Sub matchComps()\n    Dim i As long, j As long, arrA as variant, arrB as variant, arrC as variant\n\n    with workSheets(\"Sheet1\")\n        arrA = .range(.cells(3, \"A\"), .cells(.rows.count, \"A\").end(xlup)).value2\n        arrb = .range(.cells(3, \"B\"), .cells(.rows.count, \"B\").end(xlup)).value2\n        redim arrc(1 to application.min(ubound(arra, 1) ,ubound(arrb, 1)), 1 to 1)\n\n        for i= lbound(arra, 1) to ubound(arra, 1) \n            if not iserror(application.match(arra(i, 1), arrb, 0)) then\n                j=j+1\n                arrc(j,1) = arra(i, 1)\n            end if\n        next i\n\n        .cells(3, \"C\").resize(ubound(arrc, 1), ubound(arrc, 2)) = arrc\n    end with\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8711248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f062d93c5397ff299fb0902ab3ad6d7?s=128&d=identicon&r=PG&f=1", "display_name": "carter", "link": "https://stackoverflow.com/users/8711248/carter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 51072136, "answer_count": 2, "score": 1, "last_activity_date": 1530137502, "creation_date": 1530132273, "last_edit_date": 1531164843, "question_id": 51071131, "link": "https://stackoverflow.com/questions/51071131/extract-and-list-matching-cells", "title": "Extract and List Matching Cells", "body": "<p>I'm trying to compare two columns (A and B) containing company names, find any names that are an exact match, and list them in column C. With the code below I don't get an error but nothing happens. If someone could point me in the right direction it would be appreciated. </p>\n\n<pre><code>Sub match()\nDim LastRow As Integer\nDim i As Integer\n\nLastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 3 To LastRow\n\nSet Row2Name = Sheets(\"Sheet1\").Cells(i, 2)\nSet Row1Name = Sheets(\"Sheet1\").Cells(i, 1)\nSet MatchName = Sheets(\"Sheet1\").Cells(i, 1)\n\nIf Cells(i, 2) = Row1Name Then\nRow2Name.Copy\nMatchName.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\nEnd If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1530132839, "post_id": 51071025, "comment_id": 89132304, "body": "Before you paste, trying changing to edit mode by using <code>SendKeys &quot;{F2}&quot;</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1530133369, "post_id": 51071025, "comment_id": 89132520, "body": "How are you importing? Copy/Paste? Macro? If a macro, please post the relevant code."}, {"owner": {"reputation": 59, "user_id": 9973122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3436823e20785f2347cf2f7e7891d63f?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cole", "link": "https://stackoverflow.com/users/9973122/b-cole"}, "edited": false, "score": 0, "creation_date": 1530194874, "post_id": 51071025, "comment_id": 89158345, "body": "Code added to original post."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1530156939, "creation_date": 1530156939, "answer_id": 51074330, "question_id": 51071025, "link": "https://stackoverflow.com/questions/51071025/how-can-i-import-a-word-table-into-excel-and-keep-formatting/51074330#51074330", "title": "How can I import a word table into excel and keep formatting?", "body": "<p>This should do what you want.</p>\n\n<pre><code>Sub WordToExcel()\nDim wdApp As Word.Application\nDim wdDoc As Word.Document\nDim x As Integer\nDim strFilename As String\nDim strFolder As String\nDim temp As String\n\nSet wdApp = New Word.Application\n'initialise counter\nx = 1\n'search for first file in directory\nstrFolder = \"C:\\Users\\Excel\\Desktop\\test\\\"\nstrFilename = Dir(strFolder &amp; \"*.doc\")\n'amemd folder name\nDo While strFilename &lt;&gt; \"\"\nSet wdDoc = wdApp.Documents.Open(strFolder &amp; strFilename)\ntemp = wdDoc.Tables(1).Cell(2, 1).Range.Text 'read word cell\nRange(\"A2\").Offset(x, 0) = temp\ntemp = wdDoc.Tables(1).Cell(2, 2).Range.Text 'read word cell\nRange(\"A2\").Offset(x, 1) = temp\n'etc\ntemp = wdDoc.Tables(1).Cell(2, 3).Range.Text 'read word cell\nRange(\"A2\").Offset(x, 2) = temp\ntemp = wdDoc.Tables(1).Cell(2, 4).Range.Text 'read word cell\nRange(\"A2\").Offset(x, 3) = temp\n\nwdDoc.Close\nx = x + 1\nstrFilename = Dir\nLoop\nwdApp.Quit\nSet wdDoc = Nothing\nSet wdApp = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9973122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3436823e20785f2347cf2f7e7891d63f?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cole", "link": "https://stackoverflow.com/users/9973122/b-cole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1530194899, "creation_date": 1530131757, "last_edit_date": 1530194899, "question_id": 51071025, "link": "https://stackoverflow.com/questions/51071025/how-can-i-import-a-word-table-into-excel-and-keep-formatting", "title": "How can I import a word table into excel and keep formatting?", "body": "<p>I am looking to import a word table into excel and keep the formatting; sample text.</p>\n\n<blockquote>\n  <p>HERE IS SOME SAMPLE TEXT</p>\n  \n  <p>MORE TEXT\n  MORE TEXT</p>\n  \n  <p>MORETEXT</p>\n</blockquote>\n\n<p>The above text is in a single cell in the word table, but when I import into excel it places this text in three separate cells. I need to import the word table (i.e., this word cell) into excel in a single cell.</p>\n\n<p>Not all of my cells/rows are formatted this way,. But some are. So if I could pull in the word table format directly into excel this would be ideal.</p>\n\n<p>Sorry if this is confusing, would be glad to clarify</p>\n\n<p>Thanks</p>\n\n<p>Here is the code that I am currently using:</p>\n\n<pre><code>Sub ImportWordTable()\nDim wdDoc As Object\nDim wdFileName As Variant\nDim TableNo As Integer 'table number in Word\nDim iRow As Long 'row index in Excel\nDim iCol As Integer 'column index in Excel\n\nwdFileName = Application.GetOpenFilename(\"Word files ,*.doc;*.docx;*.docm\", , _\n\"Browse for file containing table to be imported\")\n\nIf wdFileName = False Then Exit Sub '(user cancelled import file browser)\n\nSet wdDoc = GetObject(wdFileName) 'open Word file\n\nWith wdDoc\n    TableNo = wdDoc.TAbles.Count\n    If TableNo = 0 Then\n        MsgBox \"This document contains no tables\", _\n        vbExclamation, \"Import Word Table\"\n    ElseIf TableNo &gt; 1 Then\n        TableNo = InputBox(\"This Word document contains \" &amp; TableNo &amp; \" tables.\" &amp; vbCrLf &amp; _\n        \"Enter table number of table to import\", \"Import Word Table\", \"1\")\n    End If\n    With .TAbles(TableNo).Range.Copy\nRange(\"A1\").Activate\nApplication.CommandBars.ExecuteMso \"PasteSourceFormatting\"\n    End With\nEnd With\n\nSet wdDoc = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vb.net", "vba", "visual-studio", "vsto"], "comments": [{"owner": {"reputation": 1257, "user_id": 9908376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTKOS.png?s=128&g=1", "display_name": "AndrewE", "link": "https://stackoverflow.com/users/9908376/andrewe"}, "edited": false, "score": 0, "creation_date": 1530132114, "post_id": 51071005, "comment_id": 89131957, "body": "I think you need to show more effort, rather than here is my working VBA code, now what would it look like in VB.NET, what have you tried so far? add your vb.net code you have tried to your question."}, {"owner": {"reputation": 1257, "user_id": 9908376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTKOS.png?s=128&g=1", "display_name": "AndrewE", "link": "https://stackoverflow.com/users/9908376/andrewe"}, "edited": false, "score": 0, "creation_date": 1530135046, "post_id": 51071005, "comment_id": 89133145, "body": "No, add your code to your question as its to do with your original post"}, {"owner": {"reputation": 1, "user_id": 10002169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99feb923db6605ac18aca978824ad60?s=128&d=identicon&r=PG&f=1", "display_name": "stopiamwarren", "link": "https://stackoverflow.com/users/10002169/stopiamwarren"}, "reply_to_user": {"reputation": 1257, "user_id": 9908376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTKOS.png?s=128&g=1", "display_name": "AndrewE", "link": "https://stackoverflow.com/users/9908376/andrewe"}, "edited": false, "score": 0, "creation_date": 1530135080, "post_id": 51071005, "comment_id": 89133158, "body": "essentially i&#39;m trying to use the same package that excel uses for it&#39;s find and replace in vba in vb.net via vsto in visual studio, but I don&#39;t really know how to use it."}, {"owner": {"reputation": 1257, "user_id": 9908376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTKOS.png?s=128&g=1", "display_name": "AndrewE", "link": "https://stackoverflow.com/users/9908376/andrewe"}, "edited": false, "score": 0, "creation_date": 1530135635, "post_id": 51071005, "comment_id": 89133359, "body": "You mentioned you are getting errors, what are the errors? Add them to your question."}, {"owner": {"reputation": 1, "user_id": 10002169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99feb923db6605ac18aca978824ad60?s=128&d=identicon&r=PG&f=1", "display_name": "stopiamwarren", "link": "https://stackoverflow.com/users/10002169/stopiamwarren"}, "reply_to_user": {"reputation": 1257, "user_id": 9908376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTKOS.png?s=128&g=1", "display_name": "AndrewE", "link": "https://stackoverflow.com/users/9908376/andrewe"}, "edited": false, "score": 0, "creation_date": 1530135873, "post_id": 51071005, "comment_id": 89133459, "body": "I&#39;m not getting any errors, it&#39;s just crashing excel."}, {"owner": {"reputation": 1, "user_id": 10002169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99feb923db6605ac18aca978824ad60?s=128&d=identicon&r=PG&f=1", "display_name": "stopiamwarren", "link": "https://stackoverflow.com/users/10002169/stopiamwarren"}, "reply_to_user": {"reputation": 1257, "user_id": 9908376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTKOS.png?s=128&g=1", "display_name": "AndrewE", "link": "https://stackoverflow.com/users/9908376/andrewe"}, "edited": false, "score": 0, "creation_date": 1530138275, "post_id": 51071005, "comment_id": 89134233, "body": "Nevermind, fixed it!!!!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10002169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99feb923db6605ac18aca978824ad60?s=128&d=identicon&r=PG&f=1", "display_name": "stopiamwarren", "link": "https://stackoverflow.com/users/10002169/stopiamwarren"}, "is_accepted": false, "score": 0, "last_activity_date": 1530138251, "creation_date": 1530138251, "answer_id": 51072254, "question_id": 51071005, "link": "https://stackoverflow.com/questions/51071005/replace-in-vb-vsto-add-in-for-excel/51072254#51072254", "title": ".replace in VB VSTO add in for Excel", "body": "<pre><code>Private Sub charKill_Click(sender As Object, e As RibbonControlEventArgs) Handles charKill.Click\n\n    Dim activeWorkSheet As Microsoft.Office.Interop.Excel.Worksheet =\n        Globals.ThisAddIn.Application.ActiveWorkbook.Worksheets(1)\n    Dim workSheet As Microsoft.Office.Tools.Excel.Worksheet =\n        Globals.Factory.GetVstoObject(activeWorkSheet)\n    Dim workRange As Excel.Range = workSheet.Cells\n\n    workRange.Replace(vbLf, vbVerticalTab, SearchOrder:=2, MatchCase:=True)\n    workRange.Replace(\"^\", vbVerticalTab, SearchOrder:=2, MatchCase:=True)\n    workRange.Replace(vbCr, \"\", SearchOrder:=2, MatchCase:=True)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10002169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99feb923db6605ac18aca978824ad60?s=128&d=identicon&r=PG&f=1", "display_name": "stopiamwarren", "link": "https://stackoverflow.com/users/10002169/stopiamwarren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1530138251, "creation_date": 1530131696, "last_edit_date": 1530136154, "question_id": 51071005, "link": "https://stackoverflow.com/questions/51071005/replace-in-vb-vsto-add-in-for-excel", "title": ".replace in VB VSTO add in for Excel", "body": "<p>I'm trying to search an excel workbook for specific char values and replace them with other char values.<br><br>I am able to do this in VBA in Excel, but I am trying to code an add-in in VS 2017 with VSTO.</p>\n\n<p>My VBA code, which works is:</p>\n\n<pre><code>Sub charFix(control As IRibbonControl)\n\nCells.Replace What:=\"^\", Replacement:=Chr(11), LookAt:=xlPart, SearchOrder _\n    :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\nCells.Replace What:=Chr(10), Replacement:=Chr(11), LookAt:=xlPart, SearchOrder _\n    :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\nCells.Replace What:=Chr(13), Replacement:=\"\", LookAt:=xlPart, SearchOrder _\n    :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\nEnd Sub\n</code></pre>\n\n<p>This is how I am trying to do it, and it is pretty wrong, haha.  But i'm not getting compile errors, so I'm lost.</p>\n\n<pre><code>Private Sub charKill_Click(sender As Object, e As RibbonControlEventArgs) Handles charKill.Click\n\n        Dim ActiveWorkSheet As Microsoft.Office.Interop.Excel.Worksheet =\n            Globals.ThisAddIn.Application.ActiveWorkbook.Worksheets(1)\n        Dim worksheet As Microsoft.Office.Tools.Excel.Worksheet =\n            Globals.Factory.GetVstoObject(ActiveWorkSheet)\n        Dim cellA1 As Excel.Range = ActiveWorkSheet.replace(Chr(10), Chr(11), Excel.XlLookAt.xlPart, Excel.XlSearchOrder.xlByRows, False, , False, False)\n\nEnd Sub\n</code></pre>\n\n<p>I'm certain that everything before the 3rd Dim statement is correct, and I'm certain that everything from .replace, on is correct...I think the issue is how I'm trying to call it.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1530133074, "post_id": 51070963, "comment_id": 89132391, "body": "Can you just use a formula to determine the day of the week?"}, {"owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "edited": false, "score": 0, "creation_date": 1530133780, "post_id": 51070963, "comment_id": 89132676, "body": "This indicates something&#39;s wrong with your code, doesn&#39;t it? So please add it to your post if you want assistance. Based only on the current information you&#39;ve provided, it is practically impossible to tell exactly why your macro is not working."}], "answers": [{"comments": [{"owner": {"reputation": 784, "user_id": 6686925, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1b72cf30f0e2e490d2dcf157c6a7bcf?s=128&d=identicon&r=PG&f=1", "display_name": "SilverFish", "link": "https://stackoverflow.com/users/6686925/silverfish"}, "edited": false, "score": 0, "creation_date": 1530189883, "post_id": 51071688, "comment_id": 89154823, "body": "the code worked beautifully except for in column D it just added weekdays and the for loop didn&#39;t add numbers. But I could get around by changing to days(1) = &quot;Sunday+1&quot; and so on. Thanks"}], "tags": [], "owner": {"reputation": 31, "user_id": 7263837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613c35be4b7ee14d6feef44d37a7b94c?s=128&d=identicon&r=PG&f=1", "display_name": "stew", "link": "https://stackoverflow.com/users/7263837/stew"}, "is_accepted": false, "score": 1, "last_activity_date": 1530137422, "last_edit_date": 1530137422, "creation_date": 1530134957, "answer_id": 51071688, "question_id": 51070963, "link": "https://stackoverflow.com/questions/51070963/how-to-record-combo-box-values-using-macro-in-excel/51071688#51071688", "title": "How to record combo box values using Macro in Excel", "body": "<p>Edited my answer and tested the code below.  Seems to work:</p>\n\n<pre><code>Sub AList()\n    Dim c As Range\n    Dim x As Integer\n    Dim days(1 To 7) As Variant\n\n    days(1) = \"Sunday\"\n    days(2) = \"Monday\"\n    days(3) = \"Tuesday\"\n    days(4) = \"Wednesday\"\n    days(5) = \"Thursday\"\n    days(6) = \"Friday\"\n    days(7) = \"Saturday\"\n\n    Range(\"A4:A10\").Value = Range(\"A4\").Value\n    Range(\"B4:B10\").Value = Range(\"B4\").Value\n    Range(\"C4:C10\").Value = Range(\"C4\").Value\n\n    x = 1\n    For Each c In Range(\"D4:D10\")\n        c.Value = days(x)\n        x = x + 1\n    Next c\n\n    Range(\"E4:E10\").Value = Range(\"E4\").Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 784, "user_id": 6686925, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1b72cf30f0e2e490d2dcf157c6a7bcf?s=128&d=identicon&r=PG&f=1", "display_name": "SilverFish", "link": "https://stackoverflow.com/users/6686925/silverfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530137422, "creation_date": 1530131478, "last_edit_date": 1530136188, "question_id": 51070963, "link": "https://stackoverflow.com/questions/51070963/how-to-record-combo-box-values-using-macro-in-excel", "title": "How to record combo box values using Macro in Excel", "body": "<p>In an existing Excel spreadsheet, I am creating a macro to autofill rows based on what is entered in the first row. There are going to be 7 rows in all based on days of the week. So far I am successful in doing rest of the fields, however one cell is having a combobox with values.</p>\n\n<pre><code>Sunday=1\nMonday=2\nTuesday=3\nWednesday=4\nThursday=5\nFriday=6\nSaturday=7\n</code></pre>\n\n<p>Each row has to get one of each value. I record these values one by one when I record Macro, but when I run Macro with click of button, it does not create these values. Any suggestions? \nBTW, in absence of combobox, I can create these values in other cells and copy then in this column via macro, but when I use combo box I am not being able to do so. </p>\n\n<p>Here is the VBA generated by Macro:</p>\n\n<pre><code>Sub AList()\n'\n' AList Macro\n'\n\n'\n    Selection.AutoFill Destination:=Range(\"A4:A10\"), Type:=xlFillCopy\n    Range(\"A4:A10\").Select\n    Range(\"B4\").Select\n    Selection.AutoFill Destination:=Range(\"B4:B10\"), Type:=xlFillCopy\n    Range(\"B4:B10\").Select\n    Range(\"C4\").Select\n    Selection.AutoFill Destination:=Range(\"C4:C10\"), Type:=xlFillCopy\n    Range(\"C4:C10\").Select\n    Range(\"E4\").Select\n    Selection.AutoFill Destination:=Range(\"E4:E10\"), Type:=xlFillCopy\n    Range(\"E4:E10\").Select\n    Range(\"D10\").Select\nEnd Sub\n</code></pre>\n\n<p>Col D, which has the Days of week in Combobox, as previously listed is not recorded.\nPlease guide if and how I need to modify this vba code.</p>\n"}, {"tags": ["vba", "pdf", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 1728544, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6ee6246ee1e45221eb7a542ae98d75db?s=128&d=identicon&r=PG", "display_name": "Adam Jacobs", "link": "https://stackoverflow.com/users/1728544/adam-jacobs"}, "edited": false, "score": 0, "creation_date": 1530192321, "post_id": 51074983, "comment_id": 89156508, "body": "I think that also uses the built-in Word pdf creation rather than the Adobe version, doesn&#39;t it?"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 233, "user_id": 1728544, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6ee6246ee1e45221eb7a542ae98d75db?s=128&d=identicon&r=PG", "display_name": "Adam Jacobs", "link": "https://stackoverflow.com/users/1728544/adam-jacobs"}, "edited": false, "score": 0, "creation_date": 1530221806, "post_id": 51074983, "comment_id": 89171298, "body": "Yes, but it&#39;s an entirely different method and produces different results."}, {"owner": {"reputation": 233, "user_id": 1728544, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6ee6246ee1e45221eb7a542ae98d75db?s=128&d=identicon&r=PG", "display_name": "Adam Jacobs", "link": "https://stackoverflow.com/users/1728544/adam-jacobs"}, "edited": false, "score": 0, "creation_date": 1530267832, "post_id": 51074983, "comment_id": 89186430, "body": "OK, I&#39;ve just tried that, and in one way it certainly produces different results. It does not convert my headings to pdf bookmarks, which the ExportAsFixedFormat method does.  I need to have my headings converted to pdf bookmarks, so unless there is some secret option to make the SaveAs2 method do that, then I fear that this method isn&#39;t going to work for me."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1530161841, "creation_date": 1530161841, "answer_id": 51074983, "question_id": 51070906, "link": "https://stackoverflow.com/questions/51070906/creating-a-pdf-using-word-vba-and-adobe-acrobat/51074983#51074983", "title": "Creating a pdf using Word VBA and Adobe Acrobat", "body": "<p>You can use the SaveAs or SaveAs2 method to save as a PDF instead of ExportAsFixedFormat. For example:</p>\n\n<p>ActiveDocument.SaveAs FileName:=\"Filename.pdf\", FileFormat:=wdFormatPDF</p>\n"}, {"tags": [], "owner": {"reputation": 233, "user_id": 1728544, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6ee6246ee1e45221eb7a542ae98d75db?s=128&d=identicon&r=PG", "display_name": "Adam Jacobs", "link": "https://stackoverflow.com/users/1728544/adam-jacobs"}, "is_accepted": false, "score": 0, "last_activity_date": 1530279536, "creation_date": 1530279536, "answer_id": 51103107, "question_id": 51070906, "link": "https://stackoverflow.com/questions/51070906/creating-a-pdf-using-word-vba-and-adobe-acrobat/51103107#51103107", "title": "Creating a pdf using Word VBA and Adobe Acrobat", "body": "<p>On a bit more playing around, I did come up with one method which is an official supported method and uses the Adobe PDF creator:</p>\n\n<pre><code>ActivePrinter = \"Adobe PDF\"\nActiveDocument.PrintOut\n</code></pre>\n\n<p>The problem with that is that it doesn't turn my Word headings into PDF bookmarks.</p>\n\n<p>Does anyone know if it's possible to set some options in that code so that it does?</p>\n"}], "owner": {"reputation": 233, "user_id": 1728544, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6ee6246ee1e45221eb7a542ae98d75db?s=128&d=identicon&r=PG", "display_name": "Adam Jacobs", "link": "https://stackoverflow.com/users/1728544/adam-jacobs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 615, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530279536, "creation_date": 1530131187, "last_edit_date": 1530276892, "question_id": 51070906, "link": "https://stackoverflow.com/questions/51070906/creating-a-pdf-using-word-vba-and-adobe-acrobat", "title": "Creating a pdf using Word VBA and Adobe Acrobat", "body": "<p>I am trying to write a macro that creates a pdf of a Word document.</p>\n\n<p>The code I have been using to do this uses ActiveDocument.ExportAsFixedFormat. This works up to a point, but it tends to fail when creating a pdf of a large document (and some of the documents I'll be processing with this macro run to thousands of pages).</p>\n\n<p>My understanding is that the ExportAsFixedFormat method uses Word's built-in PDF creation methods. What I really want to do is use Adobe Acrobat to do the PDF conversion. If I do that manually by clicking on the export as pdf buttons within Word (I have Adobe Acrobat installed on my machine) then everything is fine. It uses the actual Adobe Acrobat PDF conversion, and my PDF gets created without errors even on documents large enough to cause the ExportAsFixedFormat method to fail.</p>\n\n<p>I've been trying to figure out how to automate the conversion to PDF from VBA using Acrobat, and banging my head against a brick wall.</p>\n\n<p>I discovered the CreatePDFEx method, which in theory looks like it should do what I want, but I also discovered warnings that this is not a supported method and is not recommended. See here:</p>\n\n<p><a href=\"https://forums.adobe.com/thread/286431\" rel=\"nofollow noreferrer\">https://forums.adobe.com/thread/286431</a></p>\n\n<p>And indeed when I tried it, it didn't work.</p>\n\n<p>I then discovered the AcroExch.AVDoc and AcroExch.PDDoc objects, which looked like it might be another way. See, for example, here:</p>\n\n<p><a href=\"https://forums.adobe.com/thread/301714\" rel=\"nofollow noreferrer\">https://forums.adobe.com/thread/301714</a></p>\n\n<p>That also came with a warning that it wasn't supported. When I tried it, it worked, but it was painfully slow, even with documents of just a few pages. I hate to think what it would be like with a 5000 page document.</p>\n\n<p>Is it actually possible to do this? It doesn't seem like it should be rocket science, but I am failing to find anything that works.</p>\n\n<p>All I want to be able to do is to reliably create pdfs from large Word docs. I think that probably the way to do that is to figure out how to use Adobe's tools via VBA (is there a supported method?), but I'd be perfectly happy with the built in Word method if I could solve the problem of it failing with large documents.</p>\n\n<p>Many thanks for any help.</p>\n\n<p>Edit: I should also have mentioned that I need my Word headings to end up as PDF bookmarks. The ExportAsFixedFormat method does that, but some other methods don't.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1530131588, "post_id": 51070814, "comment_id": 89131694, "body": "You need to copy to each sheet, one at a time. There will be a macro for it as soon as you write it. If you run into problems writing it, come back and show us your code and we&#39;ll be able to help."}, {"owner": {"reputation": 455, "user_id": 5252949, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/51e476c6462a055b9156541fb7d9467c?s=128&d=identicon&r=PG", "display_name": "StatsScared", "link": "https://stackoverflow.com/users/5252949/statsscared"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1530131955, "post_id": 51070814, "comment_id": 89131881, "body": "@cybernetic.nomad, see my update above. Thanks in advance!"}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1530150141, "post_id": 51071895, "comment_id": 89136635, "body": "I updated your code to avoid the Select/Activate.  Feel free to roll back if you don&#39;t like it"}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 1, "last_activity_date": 1530150098, "last_edit_date": 1530150098, "creation_date": 1530136079, "answer_id": 51071895, "question_id": 51070814, "link": "https://stackoverflow.com/questions/51070814/paste-same-hyperlink-to-all-sheets/51071895#51071895", "title": "Paste same hyperlink to all sheets", "body": "<p>I think you are making this more complicated than it needs to be:</p>\n\n<pre><code>    Dim ws As Worksheet\n\n    For Each ws In ActiveWorkbook.Worksheets\n        If ws.Name &lt;&gt; \"Sheet1\" Then\n            ws.Hyperlinks.Add _\n              Anchor:=ws.Range(\"B1\"), _\n              Address:=\"\", _\n              SubAddress:=\"Sheet1!A1\", _\n              TextToDisplay:=\"return to sheet1\"\n        End If\n    Next ws\n</code></pre>\n\n<p>Should be enough to do the job</p>\n"}], "owner": {"reputation": 455, "user_id": 5252949, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/51e476c6462a055b9156541fb7d9467c?s=128&d=identicon&r=PG", "display_name": "StatsScared", "link": "https://stackoverflow.com/users/5252949/statsscared"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1530150098, "creation_date": 1530130849, "last_edit_date": 1531161705, "question_id": 51070814, "link": "https://stackoverflow.com/questions/51070814/paste-same-hyperlink-to-all-sheets", "title": "Paste same hyperlink to all sheets", "body": "<p>I have a hyperlink on cell B1 of Sheet1. I would like to copy this exact hyperlink to cell B1 of all sheets in my workbook.</p>\n\n<p>I tried copying the link, selecting all sheets and pasting, but this is not working for some reason. I also have over 50 sheets.</p>\n\n<p><strong>Update</strong>: Here's what I tried. It pastes the 'hyperlink' on all sheets in the workbook, but the hyperlink does not work for some reason.</p>\n\n<pre><code>Sub ReturnToSheet1()\n\nDim ws As Worksheet\n\nFor Each ws In Worksheets\nIf ws.Name &lt;&gt; \"Sheet1\" Then\n    ws.Activate\n\nRows(\"1:1\").Select\nSelection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nSelection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"B1\").Select\nActiveCell.FormulaR1C1 = \"return to sheet1\"\nRows(\"2:2\").Select\nSelection.RowHeight = 7.5\nRange(\"B1\").Select\nActiveCell.FormulaR1C1 = \"return to sheet1\"\nRange(\"B1\").Select\nActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:= _\n    \"Sheet1!A1\", TextToDisplay:=\"return to sheet1\"\nWith Selection.Font\n    .Name = \"Calibri\"\n    .Size = 10\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleSingle\n    .ThemeColor = xlThemeColorHyperlink\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nSelection.Font.Size = 11\nRange(\"A3\").Select\n\nEnd If\nNext ws\nEnd Sub\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1530132966, "post_id": 51070711, "comment_id": 89132349, "body": "Have you confirmed <code>sqe(Me.HWND)</code> returns the value you expect?  Out of curiosity, what is that value?"}, {"owner": {"reputation": 391, "user_id": 5865620, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CzvJd.jpg?s=128&g=1", "display_name": "Joshua M. Moore", "link": "https://stackoverflow.com/users/5865620/joshua-m-moore"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1530134250, "post_id": 51070711, "comment_id": 89132839, "body": "Just MessageBoxed it, It returns a Window handle, a numeric string."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1530134448, "post_id": 51070711, "comment_id": 89132909, "body": "I understood window handle.  What does your <code>sqe()</code> function do?"}, {"owner": {"reputation": 391, "user_id": 5865620, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CzvJd.jpg?s=128&g=1", "display_name": "Joshua M. Moore", "link": "https://stackoverflow.com/users/5865620/joshua-m-moore"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1530134715, "post_id": 51070711, "comment_id": 89133013, "body": "Sorry, it returns an escaped string from whatever you pass into it."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1530134989, "post_id": 51070711, "comment_id": 89133128, "body": "I suspect we may need to see the text of the <code>INSERT</code> statement you&#39;re asking the db engine to execute.  Store it in a string: <code>strSQL = &quot;INSERT INTO My_Table_Temp \u2026.</code> and <code>Debug.Print</code> the string.  Then you can execute the string: <code>CurrentDb.Execute strSQL, dbFailonerror</code>  Make sure <code>SetWarnings</code> is <code>True</code>"}, {"owner": {"reputation": 391, "user_id": 5865620, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CzvJd.jpg?s=128&g=1", "display_name": "Joshua M. Moore", "link": "https://stackoverflow.com/users/5865620/joshua-m-moore"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1530136837, "post_id": 51070711, "comment_id": 89133813, "body": "Where will I see the Debug output?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1530136892, "post_id": 51070711, "comment_id": 89133838, "body": "In the Immediate window.  You can use <code>Ctrl + g</code> to go there."}, {"owner": {"reputation": 391, "user_id": 5865620, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CzvJd.jpg?s=128&g=1", "display_name": "Joshua M. Moore", "link": "https://stackoverflow.com/users/5865620/joshua-m-moore"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1530137158, "post_id": 51070711, "comment_id": 89133925, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/173927/discussion-between-joshua-moore-and-hansup\">continue this discussion in chat</a>."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1530180188, "post_id": 51070711, "comment_id": 89148565, "body": "<code>Form.Hwnd</code> is a Long Int, there is nothing to escape."}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 5865620, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CzvJd.jpg?s=128&g=1", "display_name": "Joshua M. Moore", "link": "https://stackoverflow.com/users/5865620/joshua-m-moore"}, "edited": false, "score": 0, "creation_date": 1530199182, "post_id": 51075638, "comment_id": 89161308, "body": "Hi @donPablo, I see all the results except for the hwnd."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "reply_to_user": {"reputation": 391, "user_id": 5865620, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CzvJd.jpg?s=128&g=1", "display_name": "Joshua M. Moore", "link": "https://stackoverflow.com/users/5865620/joshua-m-moore"}, "edited": false, "score": 0, "creation_date": 1530199993, "post_id": 51075638, "comment_id": 89161830, "body": "In my temp table HWND is int, what is the type for HWND in your table? string or int or ???  Then, when you open the table do you see zero, blank, ??? Can you cut/paste sample rows?  Can you debug.print Me.HWND to see its value? and debug.print sqe(Me.HWND)"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "reply_to_user": {"reputation": 391, "user_id": 5865620, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CzvJd.jpg?s=128&g=1", "display_name": "Joshua M. Moore", "link": "https://stackoverflow.com/users/5865620/joshua-m-moore"}, "edited": false, "score": 0, "creation_date": 1530372444, "post_id": 51075638, "comment_id": 89218582, "body": "Just another thought -- the INSERT happens only when the WHERE is true.  So lets look at the WHERE for a moment...   WHERE TrainingID=2 AND TrainingLevelID NOT IN (SELECT TrainingLevelID FROM HR_Training_Levels_Temp WHERE TrainingID=2)   ... ... What are these values? and is there a chance that the Insert never happens?"}], "tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1530165549, "creation_date": 1530165549, "answer_id": 51075638, "question_id": 51070711, "link": "https://stackoverflow.com/questions/51070711/access-select-me-hwnd/51075638#51075638", "title": "Access SELECT Me.HWND", "body": "<p>I created a msaccess MDB, and then created a \"hr_training_levels_temp\" table.\nI do not have the \"FROM\" table, \nso I hard-coded some values (and changed values suffixing with '2')... as in this sql -- </p>\n\n<pre><code>INSERT INTO hr_training_levels_temp\n            (traininglevel,\n             trainingleveldesc,\n             traininglevelid,\n             trainingid,\n             isdirty,\n             hwnd)\nSELECT 'lvla', \n       'lvla-desc', \n       'lvla-id',  \n       'tr-id',  \n       0        AS IsDirty,\n       '920902' AS HWND\n</code></pre>\n\n<p>And in msaccess, when I double-click on the table I got this result --</p>\n\n<pre><code>traininglevel   trainingleveldesc   traininglevelid trainingid  isdirty HWND\nlvla            lvla-desc           lvla-id         tr-id       0       920902\nlvla2           lvla2-desc          lvla2-id        tr-id2      0       920903\n</code></pre>\n\n<p>Do you see such a result in the msaccess table itself?</p>\n\n<p>Then when your display screen comes back and does a select using HWND, is it the same HWND that was used to do the Insert?</p>\n"}], "owner": {"reputation": 391, "user_id": 5865620, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/CzvJd.jpg?s=128&g=1", "display_name": "Joshua M. Moore", "link": "https://stackoverflow.com/users/5865620/joshua-m-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 1, "accepted_answer_id": 51075638, "answer_count": 1, "score": 0, "last_activity_date": 1594632549, "creation_date": 1530130384, "last_edit_date": 1594632549, "question_id": 51070711, "link": "https://stackoverflow.com/questions/51070711/access-select-me-hwnd", "title": "Access SELECT Me.HWND", "body": "<p>I'm working in an MS Access Database, and have the following query:</p>\n\n<pre><code>DoCmd.RunSQL \"INSERT INTO My_Table_Temp (Value1, Value2, IsDirty, HWND)\" _\n&amp; \" SELECT Value1, Value2, 0 as IsDirty, \" &amp; sqe(Me.HWND) &amp; \" as HWND\" _\n&amp; \" FROM My_Table; \"\n</code></pre>\n\n<p>The idea is that I load values from the database into a temporary table, which I can then bind to a control, so I can add and remove values from it, before writing the values back into the database. </p>\n\n<p>My problem is that HWND never gets set, so that when I filter by it to save the records, nothing gets picked up. The values already in the database show up, it's just the HWND that never gets set. Am I missing something completely obvious?</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1530130292, "post_id": 51070423, "comment_id": 89131161, "body": "Yes, that would be possible, but your question is way too broad for this forum."}, {"owner": {"reputation": 1, "user_id": 10001280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea6390f3affaca7fb0871cc167b7ad1?s=128&d=identicon&r=PG&f=1", "display_name": "T.KLACK", "link": "https://stackoverflow.com/users/10001280/t-klack"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1530132367, "post_id": 51070423, "comment_id": 89132090, "body": "please help me narrow down. What should be the question so as to fil it the term &quot;precise&quot; ??"}, {"owner": {"reputation": 1, "user_id": 10001280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea6390f3affaca7fb0871cc167b7ad1?s=128&d=identicon&r=PG&f=1", "display_name": "T.KLACK", "link": "https://stackoverflow.com/users/10001280/t-klack"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1530132457, "post_id": 51070423, "comment_id": 89132133, "body": "can anyone suggest a sample sql code or maybe some other method ???"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10001280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea6390f3affaca7fb0871cc167b7ad1?s=128&d=identicon&r=PG&f=1", "display_name": "T.KLACK", "link": "https://stackoverflow.com/users/10001280/t-klack"}, "edited": false, "score": 0, "creation_date": 1530153599, "post_id": 51073271, "comment_id": 89137351, "body": "Hi Zack, Thanks for the reply. Will try and tell you whether the same worked for me. However there aren&#39;t 1000 <b>identical tables</b>. Each table relates to a product and its corresponding sale/purchase history starting from day 1.  Most of the products didn&#39;t start trading from day 1 and were introduced later at random dates. Moreover it is not necessary that each and every product is bought/sold everyday, therefore data content is not equal. Pardon me but in my opinion approx. 2000 tables can be made. So I am way short to that number."}, {"owner": {"reputation": 1, "user_id": 10001280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea6390f3affaca7fb0871cc167b7ad1?s=128&d=identicon&r=PG&f=1", "display_name": "T.KLACK", "link": "https://stackoverflow.com/users/10001280/t-klack"}, "edited": false, "score": 0, "creation_date": 1530153802, "post_id": 51073271, "comment_id": 89137390, "body": "The excel spreadsheet merely contains sale/purchase data for 1 single date, whereas Access tables contain sale/purchase data for the entire history of the shop. Logically they are way different, hence cannot be equated."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 1, "creation_date": 1530154603, "post_id": 51073271, "comment_id": 89137556, "body": "I would support @Zack, this table structure is bad. You cannot for instance easy rename product or make a report with sales statistics.  Much better if you have in Access just two tables - one with product description and second one with sales, structure like your columns in Excel, but instead of Item Name - Item ID. In this case all operations will be much easier. Don&#39;t mix up data structure and data content. Proposed structure will be able to keep data for any random dates."}], "tags": [], "owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "is_accepted": false, "score": 1, "last_activity_date": 1530147130, "creation_date": 1530147130, "answer_id": 51073271, "question_id": 51070423, "link": "https://stackoverflow.com/questions/51070423/updating-multiple-ms-access-tables-with-1-spreadsheet/51073271#51073271", "title": "updating multiple MS ACCESS tables with 1 spreadsheet", "body": "<p>My first question to you is why can't the Access database match the data structure of the Excel spreadsheet? Updating 1 Access table from 1 spreadsheet is a lot simpler than what you're trying to do. Having 1,000 tables with the same data structure, where each table is named after a product, seems pretty fishy to me.</p>\n\n<p>That being said, if you need to keep your 1,000 tables (I'm honestly surprised you're not hitting the DB maximum threshold for Access), there are ways you can make it work. I would suggest having a lookup table that matches the product (as it appears on the spreadsheet) to the table in Access it goes to. Then, you'd import the Excel data into a staging table, and run some VBA code to loop through the lookup table, running a query to append all the data from Excel into the appropriate Access table. Something like this:</p>\n\n<pre><code>private const STAGING_TABLE_NAME as string = \"tDataFromExcel\"\nprivate Const LOOKUP_TABLE_NAME as String = \"tGoodsToTableNames\"\n\npublic sub AddData()\n\n    Dim db as DAO.Database\n    Dim rsItemLookup as DAO.Database\n    Dim strSQL as string\n    Dim GoodName as string, TableName as string\n\n    set db = CurrentDB\n    set rsItemLookup = db.OpenRecordset(\"select good_name, table_name from \" &amp; LOOKUP_TABLE_NAME)\n\n    do while not rsItemLookup.EOF\n        GoodName = rsItemLookup.fields(\"good_name\").Value\n        TableName = rsItemLookup.fields(\"table_name\").value\n\n        strSQL = _\n            \"insert into \" &amp; TableName &amp; \" (\" &amp; _\n                \"[date], \" &amp; _\n                \"[Daily Opening Stock], \" &amp; _\n                \"[Daily Sales], \" &amp; _\n                \"[Daily Purchases], \" &amp; _\n                \"[Daily Closing Stock]) \"\n            \"select \" &amp; _\n                \"[date], \" &amp; _\n                \"[Daily Opening Stock], \" &amp; _\n                \"[Daily Sales], \" &amp; _\n                \"[Daily Purchases], \" &amp; _\n                \"[Daily Closing Stock]) \" &amp; _\n            \"from \" &amp; STAGING_TABLE_NAME &amp; \" \" &amp; _\n            \"where [Item Name] = \"\"\" &amp; GoodName &amp; \"\"\"\"\n\n        db.Execute strSQL\n\n        rsItemLookup.MoveNext\n    loop\n\nend sub\n</code></pre>\n\n<p>Again, I'm certainly not advocating you take this approach: If you can, I would strongly implore you to refactor your database to not have 1,000 virtually identical tables.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10001280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea6390f3affaca7fb0871cc167b7ad1?s=128&d=identicon&r=PG&f=1", "display_name": "T.KLACK", "link": "https://stackoverflow.com/users/10001280/t-klack"}, "edited": false, "score": 0, "creation_date": 1530183442, "post_id": 51077563, "comment_id": 89150584, "body": "I&#39;m really thankful to both Zack &amp; you for your immense help. I really understand your concern in refactoring the database to a minimum logical level. I am thankful for your efforts. However, the reason I have to have 1000 different tables is because the access database is again refed to generate/calculate Moving Average Stock Levels, Re-Ordering Levels &amp; Stock Chart, in the same accounting software which also generates statistical reports. The accounting software of its own data calculates only upto using past 1 year&#39;s data. This is a limitation of the software... contd.."}, {"owner": {"reputation": 1, "user_id": 10001280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea6390f3affaca7fb0871cc167b7ad1?s=128&d=identicon&r=PG&f=1", "display_name": "T.KLACK", "link": "https://stackoverflow.com/users/10001280/t-klack"}, "edited": false, "score": 0, "creation_date": 1530183940, "post_id": 51077563, "comment_id": 89150904, "body": "To calculate various statistics and generate various costing-based decision reports, based on larger pool of data (i.e. using data for more than 1 year data points), I need to maintain a Ms-Access database, which is fed into the accounting software for various calculation. While I can always run a query to generate a report based on just 2 tables, the said accounting software cant. It needs to have table by table data, which it uses to generate Item by Item calculation/report, when any particular item is clicked. This calculation is also sometimes used for automatic ordering for .. contd.."}, {"owner": {"reputation": 1, "user_id": 10001280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea6390f3affaca7fb0871cc167b7ad1?s=128&d=identicon&r=PG&f=1", "display_name": "T.KLACK", "link": "https://stackoverflow.com/users/10001280/t-klack"}, "edited": false, "score": 0, "creation_date": 1530184255, "post_id": 51077563, "comment_id": 89151094, "body": "goods which are hot selling items. The software automatically sends an order to the Company distributor when a particular stock level is breached. Since many goods are seasonal in nature, 1 year data for calculation of the same is not enough. It needs to have several years data for the calculation to be normalized and avoid unnecessary ordering in lean seasons. For this reason, I have to connect the Ms-Access database containing multiple year history of stock movements with the accounting software. Hope it clarifies. Once again immensely thankful."}, {"owner": {"reputation": 1, "user_id": 10001280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea6390f3affaca7fb0871cc167b7ad1?s=128&d=identicon&r=PG&f=1", "display_name": "T.KLACK", "link": "https://stackoverflow.com/users/10001280/t-klack"}, "edited": false, "score": 0, "creation_date": 1530184880, "post_id": 51077563, "comment_id": 89151537, "body": "By optimising the order quantity, no.of orders &amp; re-ordering levels, I minimize the Stock Holding costs, Stock Ordering costs &amp; many a times, I also get a larger discount from the distributor based on order size &amp; order frequency. This helps me save about INR 1,200,000/- (about $ 20,000) annually. With the saving I can afford to give employment to 2-3 more young people, who help me out with various activities, which originally I had to do it myself and caused immense burden. My effort does not make a large difference but in my small way &amp; establishment, I contribute my help to the society.  ."}, {"owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "reply_to_user": {"reputation": 1, "user_id": 10001280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea6390f3affaca7fb0871cc167b7ad1?s=128&d=identicon&r=PG&f=1", "display_name": "T.KLACK", "link": "https://stackoverflow.com/users/10001280/t-klack"}, "edited": false, "score": 0, "creation_date": 1530227117, "post_id": 51077563, "comment_id": 89172756, "body": "Do you mind me asking what accounting software you&#39;re using? I&#39;d have expected that you could export data using SQL to create individual tables of data/move data to individual tables from Access to your accounting software so that the latter need never &quot;know&quot; the specifics of how you store the data in Access - it just gets it in it&#39;s language. Your <code>SELECT</code> statements essentially aught to be able to translate the schema from Access to accounting whenever you need to export it."}, {"owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "reply_to_user": {"reputation": 1, "user_id": 10001280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea6390f3affaca7fb0871cc167b7ad1?s=128&d=identicon&r=PG&f=1", "display_name": "T.KLACK", "link": "https://stackoverflow.com/users/10001280/t-klack"}, "edited": false, "score": 0, "creation_date": 1530227121, "post_id": 51077563, "comment_id": 89172759, "body": "It seems like a strange connection between the two pieces of software where one &quot;knows&quot; and relies upon the others structure, rather than just the data therein..."}], "tags": [], "owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "is_accepted": false, "score": 0, "last_activity_date": 1530172472, "creation_date": 1530172472, "answer_id": 51077563, "question_id": 51070423, "link": "https://stackoverflow.com/questions/51070423/updating-multiple-ms-access-tables-with-1-spreadsheet/51077563#51077563", "title": "updating multiple MS ACCESS tables with 1 spreadsheet", "body": "<p>Zack's answer provides a way to do what you're asking, but recommends that you do something else. I'm going to try to demonstrate that what he recommends would work for your situation, and show you how to achieve it.</p>\n\n<p>You want to transfer data in an excel spreadsheet into a relational database that holds the same data - usually to give better access/manipulation. The data is in a big table of one day, with a separate line for each product, and you want to be able to view the entire history of a single product, so you have separated out the tables.</p>\n\n<p>This is going to significantly slow down the automatic transfer process - that long loop that re-writes and processes the SQL over and over. You <em>can</em> look at the data in that way without this setup though. Lets call this tblProductDetails</p>\n\n<p>One table has your product information - things like the name of the product, how much it costs... The other has the in/out records of what was bought and sold, keeping track of stock on hand at any point. This second table is going to have a LOT of records, as it's a new record for each product that was bought and/or sold each and every day. We might call this tblInOut.</p>\n\n<p>With a <code>Select</code> query you can save in Access, you can look at the history of any one product at any time - you can even set this as a variable so that when you open <em>the only query you save</em> it prompts you for the name of the product you want to look up.</p>\n\n<p>I've mocked up a <a href=\"http://sqlfiddle.com/#!18/2b3bb/8\" rel=\"nofollow noreferrer\">4 product sample schema</a> for you with a query to show <em>all</em> the data, and another to show just the one product's history. You can use the second query exactly as is in Access' query builder (SQL view) where <code>'125g Soap'</code> (on the second last line) is mentioned in the query name so you know which query is which.</p>\n\n<p>If you want to use just one query, do the same thing with one exception: on the second last line, where it says <code>'125g Soap'</code> replace the whole thing with <code>Product_Name</code> (without the inverted commas) and when you open the query, Access will give you a message box asking you to type in a product name. </p>\n\n<p>This feature will only work if you type the name exactly right though, so you might prefer just to build a form so you can give the user a combo box with which to select the exact product name.</p>\n"}], "owner": {"reputation": 1, "user_id": 10001280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea6390f3affaca7fb0871cc167b7ad1?s=128&d=identicon&r=PG&f=1", "display_name": "T.KLACK", "link": "https://stackoverflow.com/users/10001280/t-klack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1530172472, "creation_date": 1530129107, "last_edit_date": 1530153735, "question_id": 51070423, "link": "https://stackoverflow.com/questions/51070423/updating-multiple-ms-access-tables-with-1-spreadsheet", "title": "updating multiple MS ACCESS tables with 1 spreadsheet", "body": "<p>I have a MS Access database with about 1000 tables. The Tables are independent of each other, that is they are <strong>not</strong> linked to each other. Basically each table contains records of stock of a particular good. The Names of each table is the name of the item, for example 125 gm Soap, 200 ml Oil, etc. and contains the following columns : - </p>\n\n<ol>\n<li>Date</li>\n<li>Daily Opening Stock</li>\n<li>Daily Sales </li>\n<li>Daily Purchases</li>\n<li>Daily Closing Stock</li>\n</ol>\n\n<p>Each day, sales/purchases of all the goods are recorded in accounting software. The End of Day report summary is generated in Excel Format. This report is a consolidated report of daily Sales/Purchases of all the goods, <strong>row-wise</strong>. The Columns in Excel are : </p>\n\n<ol>\n<li>Date</li>\n<li>Item Name</li>\n<li>Daily Opening Stock</li>\n<li>Daily Sales</li>\n<li>Daily Purchases</li>\n<li>Daily Closing Stock</li>\n</ol>\n\n<p>Presently I have to manually open each table in Access &amp; copy-paste the respective daily sales/purchases data from the excel report. I want to automate this process so that the record is automatically appended to each of the respective table, basis the Item Name. </p>\n\n<p>In summary, I want to update multiple tables in Ms Access database file, from data contained in <strong>1</strong> Ms Excel spreadsheet. </p>\n\n<p>Is that possible ? Your help would be highly appreciated.</p>\n\n<p>Thanks, \nThiru V. Klack</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23, "user_id": 10001961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9e9f513c381843d4b84ec580e0b983b?s=128&d=identicon&r=PG&f=1", "display_name": "ap5", "link": "https://stackoverflow.com/users/10001961/ap5"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1530129040, "post_id": 51070296, "comment_id": 89130640, "body": "does your code, place all selected sheets in a single pdf, because that is what the code I found does as well. I need them to be separate pdf&#39;s...."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1530136140, "post_id": 51070296, "comment_id": 89133543, "body": "Then once you have this completed pdf, get a script to produce separated pdf&#39;s   - I found an applescript one that works a treat but some must exist for the &quot;other&quot; side... Or you can look on here as that type of question has been asked before.."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10001961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9e9f513c381843d4b84ec580e0b983b?s=128&d=identicon&r=PG&f=1", "display_name": "ap5", "link": "https://stackoverflow.com/users/10001961/ap5"}, "edited": false, "score": 0, "creation_date": 1530157221, "post_id": 51073408, "comment_id": 89138040, "body": "Thanks but I keep getting &quot;Run Time Error 1004&quot; document not saved.... when I run this code."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 23, "user_id": 10001961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9e9f513c381843d4b84ec580e0b983b?s=128&d=identicon&r=PG&f=1", "display_name": "ap5", "link": "https://stackoverflow.com/users/10001961/ap5"}, "edited": false, "score": 0, "creation_date": 1530184977, "post_id": 51073408, "comment_id": 89151600, "body": "Did you change the path to your local HDD?  The code works fine for me."}, {"owner": {"reputation": 23, "user_id": 10001961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9e9f513c381843d4b84ec580e0b983b?s=128&d=identicon&r=PG&f=1", "display_name": "ap5", "link": "https://stackoverflow.com/users/10001961/ap5"}, "edited": false, "score": 0, "creation_date": 1530198366, "post_id": 51073408, "comment_id": 89160740, "body": "Yup and it still doesnt work.. maybe my path is incorrect?"}, {"owner": {"reputation": 23, "user_id": 10001961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9e9f513c381843d4b84ec580e0b983b?s=128&d=identicon&r=PG&f=1", "display_name": "ap5", "link": "https://stackoverflow.com/users/10001961/ap5"}, "edited": false, "score": 0, "creation_date": 1530199439, "post_id": 51073408, "comment_id": 89161482, "body": "Just saying Run-Time error &#39;1004&#39;.. Method &#39;Select of Object&#39;_&#39;Worksheet&#39; failed."}, {"owner": {"reputation": 23, "user_id": 10001961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9e9f513c381843d4b84ec580e0b983b?s=128&d=identicon&r=PG&f=1", "display_name": "ap5", "link": "https://stackoverflow.com/users/10001961/ap5"}, "edited": false, "score": 0, "creation_date": 1530199851, "post_id": 51073408, "comment_id": 89161722, "body": "When I step through the code it saying that this line is bad: ws.select.."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 23, "user_id": 10001961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9e9f513c381843d4b84ec580e0b983b?s=128&d=identicon&r=PG&f=1", "display_name": "ap5", "link": "https://stackoverflow.com/users/10001961/ap5"}, "edited": false, "score": 0, "creation_date": 1530217901, "post_id": 51073408, "comment_id": 89169901, "body": "Well &#39;ws.Select&#39; simply selects a worksheet.  I&#39;m not sure what&#39;s going on over there.  I tested the code on my home machine; it worked fine.  I just tested it on my office machine; it works fine.  The only possible thing that I can think of is that this part: &#39;C:\\Users\\Excel\\Desktop\\test\\&#39; needs to be set to your local hard-drive."}, {"owner": {"reputation": 23, "user_id": 10001961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9e9f513c381843d4b84ec580e0b983b?s=128&d=identicon&r=PG&f=1", "display_name": "ap5", "link": "https://stackoverflow.com/users/10001961/ap5"}, "edited": false, "score": 0, "creation_date": 1530300196, "post_id": 51073408, "comment_id": 89203399, "body": "I am running this code in a workbook that has about 12 sheets in it. When I select sheets, for example, sheet 3 and 4 and I run this marco only sheet 1 is being saved to PDF format (even though I did not select that sheet) and then I get an error &quot;Method &#39;select of Object&#39;_worksheet failed."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1530148629, "creation_date": 1530148629, "answer_id": 51073408, "question_id": 51070296, "link": "https://stackoverflow.com/questions/51070296/vba-code-help-generate-separate-pdf-from-sheets/51073408#51073408", "title": "VBA Code Help -- Generate Separate PDF from Sheets", "body": "<p>Separate sheets to separate PDF files</p>\n\n<pre><code>Sub ExportToPDFs()\n' PDF Export Macro\n' Change C:\\Exports\\ to your folder path where you need the diles saved\n' Save Each Worksheet to a separate PDF file.\n\nDim ws As Worksheet\n\nFor Each ws In Worksheets\nws.Select\nnm = ws.Name\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\nFilename:=\"C:\\Users\\Excel\\Desktop\\test\\\" &amp; nm &amp; \".pdf\", _\nQuality:=xlQualityStandard, IncludeDocProperties:=True, _\nIgnorePrintAreas:=False, OpenAfterPublish:=False\n\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10001961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9e9f513c381843d4b84ec580e0b983b?s=128&d=identicon&r=PG&f=1", "display_name": "ap5", "link": "https://stackoverflow.com/users/10001961/ap5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 917, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1530148629, "creation_date": 1530128499, "question_id": 51070296, "link": "https://stackoverflow.com/questions/51070296/vba-code-help-generate-separate-pdf-from-sheets", "title": "VBA Code Help -- Generate Separate PDF from Sheets", "body": "<p>I am trying to create a macro that will generate separate PDF files for Selected Worksheets in a Workbook. I found this code on line, which works great, it puts all selected sheets in ONE PDF. I need to have each seleceted sheet as a separate PDF. Any help will be so greatly appreciated!!</p>\n\n<p>I am a beginner to VBA.. Thanks again!</p>\n\n<pre><code>    Sub PDFActiveSheet()\n\nDim wsA As Worksheet\nDim wbA As Workbook\nDim strTime As String\nDim strName As String\nDim strPath As String\nDim strFile As String\nDim strPathFile As String\nDim myFile As Variant\nOn Error GoTo errHandler\n\nSet wbA = ActiveWorkbook\nSet wsA = ActiveSheet\nstrTime = Format(Now(), \"yyyymmdd\\_hhmm\")\n\n'get active workbook folder, if saved\nstrPath = wbA.Path\nIf strPath = \"\" Then\n  strPath = Application.DefaultFilePath\nEnd If\nstrPath = strPath &amp; \"\\\"\n\n'replace spaces and periods in sheet name\nstrName = Replace(wsA.Name, \" \", \"\")\nstrName = Replace(strName, \".\", \"_\")\n\n'create default name for savng file\nstrFile = strName &amp; \"_\" &amp; strTime &amp; \".pdf\"\nstrPathFile = strPath &amp; strFile\n\n'use can enter name and\n' select folder for file\nmyFile = Application.GetSaveAsFilename _\n    (InitialFileName:=strPathFile, _\n        FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n        Title:=\"Select Folder and FileName to save\")\n\n'export to PDF if a folder was selected\nIf myFile &lt;&gt; \"False\" Then\n    wsA.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=myFile, _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=False\n    'confirmation message with file info\n    MsgBox \"PDF file has been created: \" _\n      &amp; vbCrLf _\n      &amp; myFile\nEnd If\n\nexitHandler:\n    Exit Sub\nerrHandler:\n    MsgBox \"Could not create PDF file\"\n    Resume exitHandler\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530127255, "post_id": 51069944, "comment_id": 89129933, "body": "And &quot;C&quot; is capital C?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530127825, "post_id": 51069944, "comment_id": 89130145, "body": "Without being quite specific I would worry about some cases slipping through the net. I am not a regex guru but will be interested to see what the regex gurus have to say. I would probably have written quite a few separate expressions that I felt secure with and use those in a loop. What have you tried? Any code?"}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530128359, "post_id": 51069944, "comment_id": 89130371, "body": "C is capital, yes. I have not started code yet, loops would work if I can marry up reg ex to cover a series of formats, which is what I am working on now. I suspect that if I could get away with say 3 - 5 loops for various formats then speed would be acceptable since I would drop out once I get a match."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1530129845, "post_id": 51069944, "comment_id": 89130988, "body": "<code>(?&lt;!\\S)(?:CC\\d(?:-\\d{5}(?:-\\d{2,3}|\\d(?:-\\d{2})?)?|\\d(?:-\\d{&zwnj;&#8203;5}(?:-\\d{2,3}|\\d(?:-&zwnj;&#8203;\\d{2})?)?|\\d(?:-\\d{5&zwnj;&#8203;}(?:-\\d{3}|\\d)?|\\d{3&zwnj;&#8203;})))|\\d(?:-\\d{5}(?:-&zwnj;&#8203;\\d{2,3}|\\d(?:-\\d{2})&zwnj;&#8203;?)?|\\d(?:-\\d{5}(?:-\\&zwnj;&#8203;d{2,3}|\\d(?:-\\d{2})?&zwnj;&#8203;)?|\\d(?:-\\d{5}-)?\\d{&zwnj;&#8203;3})))(?!\\S)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530129927, "post_id": 51069944, "comment_id": 89131028, "body": "Have you tried anything? If so, is it failing? Or it&#39;s just more complex than it needs to be?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1530129955, "post_id": 51069944, "comment_id": 89131033, "body": "A regex <i>trie</i> is the fastest search in the world. What are the input conditions ? I.e. is each an independent string, or do you have many items in 1 string ? Do you want the ones that match the form, or ones that don&#39;t ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530130014, "post_id": 51069944, "comment_id": 89131053, "body": "First thing to do is to break down the pattern and specify it formally. There&#39;s something that&#39;s common to most of these acceptable inputs - write it down. Start with <code>If...Else...</code> then narrow it down until each branch is its definitive own alternative - then encode it in a regex."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1530130084, "post_id": 51069944, "comment_id": 89131079, "body": "You can&#39;t just use alternations with your forms, it&#39;s way too slow."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530130138, "post_id": 51069944, "comment_id": 89131102, "body": "@sln depends how many inputs there are to process and how slow is unacceptably slow though."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530130347, "post_id": 51069944, "comment_id": 89131187, "body": "VBA also doesn&#39;t support some of the features more generally found with regex. And heuristically I believe regex with Excel can be quite slow."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530130889, "post_id": 51069944, "comment_id": 89131410, "body": "@MathieuGuindon - I think in this case, it&#39;s only about %25 slower if no trie. Either way is fast, matching a low of 190K matches/sec without trie,  to a high of 270K matches/sec with a full blown trie."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530131046, "post_id": 51069944, "comment_id": 89131469, "body": "@QHarr well, there&#39;s no need for backrefs or named groups in this instance, and VBScript RegEx doesn&#39;t really care whether it&#39;s running in a ASP-Classic environment, Excel host, or VB6 application."}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1530131552, "post_id": 51069944, "comment_id": 89131677, "body": "Here is one I am using and this works fine on the character count I have:  RegexCountMatches(&quot;6-48757-01&quot;, &quot;\\-\\d{5}\\-\\d{2}&quot;, but i would like to expand some."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530131644, "post_id": 51069944, "comment_id": 89131724, "body": "@MathieuGuindon Are those the key unsupported features? I have yet to see them listed and explained anywhere for VBA. I just generally write a regex and then pull a little sad face when .Test doesn&#39;t like it in VBA."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1530131767, "post_id": 51069944, "comment_id": 89131776, "body": "you can try something like <a href=\"https://regex101.com/r/W7T3Js/1\" rel=\"nofollow noreferrer\"><code>^(CC)?(\\d{1,3}-)?\\d{5,6}(-\\d{2,3})?$</code></a>"}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1530131829, "post_id": 51069944, "comment_id": 89131805, "body": "to sln: I want to capture ones that don&#39;t match the given examples. I will pass a single string to the test routine at a time. Not a series."}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1530131917, "post_id": 51069944, "comment_id": 89131855, "body": "Hmmm, that looks promising Slai.  Let me noodle through that one for a bit. That looks like I could have just two passes to test for match. One with CC, one without."}, {"owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "edited": false, "score": 0, "creation_date": 1530132301, "post_id": 51069944, "comment_id": 89132055, "body": "Slai, I am having success thus far with this pattern of reg ex. Thanks, I will post final code shortly."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1530132953, "post_id": 51069944, "comment_id": 89132345, "body": "@QHarr I&#39;d have to dig up the code for <a href=\"https://github.com/rubberduck-vba/Rubberduck/tree/next/Rubberduck.RegexAssistant\" rel=\"nofollow noreferrer\">Rubberduck&#39;s Regex Assistant</a> feature, which pretty much literally implemented the specs for VBScript-Regex."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530133129, "post_id": 51069944, "comment_id": 89132416, "body": "@MathieuGuindon - I&#39;d check again, that regex matches <code>CC000000-00</code> is that one of your forms? It also matches a couple others that I don&#39;t see in the forms."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1530133164, "post_id": 51069944, "comment_id": 89132437, "body": "if I am counting correctly it&#39;s matching 2^7 = 128 combinations, so it&#39;s probably matching a lot more than needed."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530133541, "post_id": 51069944, "comment_id": 89132582, "body": "@MathieuGuindon Please don&#39;t go to any bother. If anything useful is to hand feel free to mention in VBA-RD room and tag me. I should get off my a** and have a look myself for something."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1530136427, "post_id": 51069944, "comment_id": 89133666, "body": "updated to match only the 26 specified cases, but seems a bit slower <a href=\"https://regex101.com/r/W7T3Js/2\" rel=\"nofollow noreferrer\">regex101.com/r/W7T3Js/2</a>"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530131937, "post_id": 51071035, "comment_id": 89131871, "body": "As a matter of interest how do you test timings on this? A tool? Your own script?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530133629, "post_id": 51071035, "comment_id": 89132613, "body": "@QHarr - I use a tool to develop regex. Screenshot of the bench generator <a href=\"http://www.regexformat.com/scrn7/s7_b1.jpg\" rel=\"nofollow noreferrer\">regexformat.com/scrn7/s7_b1.jpg</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530133684, "post_id": 51071035, "comment_id": 89132633, "body": "Many thanks. I had wondered. So this is your  home grown tool so to speak?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1530133741, "post_id": 51071035, "comment_id": 89132663, "body": "@QHarr - Hahh, in a sence. I charge $29 for it, but for you, it&#39;s free.. download it ."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530133889, "post_id": 51071035, "comment_id": 89132713, "body": "@QHarr -  Email support for the key, I&#39;ll send you one."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530162994, "post_id": 51071035, "comment_id": 89139397, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/173938/discussion-between-qharr-and-sln\">continue this discussion in chat</a>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "is_accepted": false, "score": 2, "last_activity_date": 1530131805, "creation_date": 1530131805, "answer_id": 51071035, "question_id": 51069944, "link": "https://stackoverflow.com/questions/51069944/using-vba-regex-to-find-range-of-formats-and-maintain-speed/51071035#51071035", "title": "Using VBA RegEx to find range of formats and maintain speed", "body": "<p>I've used a utility to generate a full blown regex trie (below), but you could<br>\njust put your forms into an alternation list if you want.  </p>\n\n<p><code>(?:CC\\d\\d\\d\\d\\d\\d|CC\\d-\\d\\d\\d\\d\\d-\\d\\d|CC\\d-\\d\\d\\d\\d\\d\\d-\\d\\d|CC\\d\\d-\\d\\d\\d\\d\\d-\\d\\d|CC\\d\\d-\\d\\d\\d\\d\\d\\d-\\d\\d|CC\\d-\\d\\d\\d\\d\\d|CC\\d-\\d\\d\\d\\d\\d\\d|CC\\d\\d-\\d\\d\\d\\d\\d|CC\\d\\d-\\d\\d\\d\\d\\d\\d|CC\\d\\d\\d-\\d\\d\\d\\d\\d|CC\\d\\d\\d-\\d\\d\\d\\d\\d\\d|CC\\d-\\d\\d\\d\\d\\d-\\d\\d\\d|CC\\d\\d-\\d\\d\\d\\d\\d-\\d\\d\\d|CC\\d\\d\\d-\\d\\d\\d\\d\\d-\\d\\d\\d|\\d\\d\\d\\d\\d\\d|\\d-\\d\\d\\d\\d\\d-\\d\\d|\\d-\\d\\d\\d\\d\\d\\d-\\d\\d|\\d\\d-\\d\\d\\d\\d\\d-\\d\\d|\\d\\d-\\d\\d\\d\\d\\d\\d-\\d\\d|\\d-\\d\\d\\d\\d\\d|\\d-\\d\\d\\d\\d\\d\\d|\\d\\d-\\d\\d\\d\\d\\d|\\d\\d-\\d\\d\\d\\d\\d\\d|\\d-\\d\\d\\d\\d\\d-\\d\\d\\d|\\d\\d-\\d\\d\\d\\d\\d-\\d\\d\\d|\\d\\d\\d-\\d\\d\\d\\d\\d-\\d\\d\\d)</code>  </p>\n\n<p>and it's fast as well, generating about 190K matches/sec.   </p>\n\n<p>Below is a full blown regex trie and is faster, about 270K matches/sec.  </p>\n\n<p>I'm not sure about your input structure, but if checking a single string/value<br>\nat a time -   </p>\n\n<p>This will match NON-Compliance forms:  </p>\n\n<p><code>^(?!(?:CC\\d(?:-\\d{5}(?:-\\d{2,3}|\\d(?:-\\d{2})?)?|\\d(?:-\\d{5}(?:-\\d{2,3}|\\d(?:-\\d{2})?)?|\\d(?:-\\d{5}(?:-\\d{3}|\\d)?|\\d{3})))|\\d(?:-\\d{5}(?:-\\d{2,3}|\\d(?:-\\d{2})?)?|\\d(?:-\\d{5}(?:-\\d{2,3}|\\d(?:-\\d{2})?)?|\\d(?:-\\d{5}-)?\\d{3})))$)[\\S\\s]+$</code>  </p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "is_accepted": false, "score": 0, "last_activity_date": 1534274188, "last_edit_date": 1534274188, "creation_date": 1534271485, "answer_id": 51847761, "question_id": 51069944, "link": "https://stackoverflow.com/questions/51069944/using-vba-regex-to-find-range-of-formats-and-maintain-speed/51847761#51847761", "title": "Using VBA RegEx to find range of formats and maintain speed", "body": "<p>Here is the code I ended up using.          </p>\n\n<p>For Each ws In Worksheets:</p>\n\n<pre><code>If ws.Name = \"ASSEMBLY LIST\" Then\nColPos = 1\nElse  '------------ALL OTHER SHEETS THIS ROUTINE WILL ACCESS\nColPos = 2\nEnd If\n'--------------------------THE FOLLOWING LOOP TESTS THE NAME HANDED IN TO SEE IF MEETS ANY OF THE REGULAR EXPRESSION TEST FOR PROPERLY FORMATED NAMES\n'--------------------------IF THE NAME DROPS THROUGH THE 4 TESTS THEN IT PASSED TO THE BAD NAME LISTING PAGE\nIf Left(ws.Name, 3) &lt;&gt; \"BOM\" And ws.Name &lt;&gt; \"ITEM MASTER\" And ws.Name &lt;&gt; \"BAD NAMES LIST\" Then\n    theSheetRowCount = ws.Cells(Rows.Count, \"A\").End(xlUp).Row\n    For i = 4 To theSheetRowCount\n        theCount = 0\n            Do While theCount &lt; 4\n\n                    If theCount &lt; 4 Then\n\n                    theResult = RegexCountMatches(ws.Cells(i, ColPos), \"^(CC)?(\\d{1,3}-)?\\d{5,6}(-\\d{2,3})?$\")\n                            If theResult = 1 Then\n                                'Debug.Print \"This Is Valid Number \" &amp; ws.Cells(i, colpos)\n                                Exit Do\n                            Else\n                                theCount = theCount + 1\n                            End If\n\n                    theResult = RegexCountMatches(ws.Cells(i, ColPos), \"^(CC)?(\\d{1,3}-)?\\d{5,6}(-\\d{2,3})(_ITEM)(\\s)(\\w)?$\")\n                            If theResult = 1 Then\n                                'Debug.Print \"This Is Valid Number \" &amp; ws.Cells(i, colpos)\n                                Exit Do\n                            Else\n                                theCount = theCount + 1\n                            End If\n\n\n                    theResult = RegexCountMatches(ws.Cells(i, 2), \"(CC)?(\\d{1,3}-)?\\d{5,6}(-\\d{2,3})(_ITEM)(\\s)(\\w)?$\")\n                            If theResult = 1 Then\n                                'Debug.Print \"This Is Valid Number \" &amp; ws.Cells(i, colpos)\n                                Exit Do\n                            Else\n                                theCount = theCount + 1\n                            End If\n\n                    theResult = RegexCountMatches(ws.Cells(i, ColPos), \"(CC)?(\\d{1,3}-)?\\d{5,6}(-\\d{2,3})?$\")\n                            If theResult = 1 Then\n                                'Debug.Print \"This Is Valid Number \" &amp; ws.Cells(i, colpos)\n                                Exit Do\n                            Else\n                                theCount = theCount + 1\n                            End If\n                End If\n            Loop\n\n                    If theCount = 4 And i &lt;= theSheetRowCount Then\n                        'Debug.Print \"This Is an Invalid Number: \" &amp; ws.Cells(i, colpos) &amp; \" found on sheet \" &amp; ws.Name\n                        RowCount = wsBadlist.Cells(Rows.Count, \"A\").End(xlUp).Row\n                            Sheets(\"BAD NAMES LIST\").Cells(RowCount + 1, 1) = \"This Is an Invalid Number:\"\n                            Sheets(\"BAD NAMES LIST\").Cells(RowCount + 1, 2) = ws.Cells(i, ColPos)  'ADDING NAME OF ITEM\n                            Sheets(\"BAD NAMES LIST\").Cells(RowCount + 1, 3) = ws.Cells(i, ColPos + 1)  'ADDING DESCRIPTION OF ITEM\n                            Sheets(\"BAD NAMES LIST\").Cells(RowCount + 1, 4) = \"found on sheet \" &amp; ws.Name 'ADDING SHEET FOUND ON\n\n                        theCount = 0\n                    End If\n    Next\nEnd If\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5220795, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/q0AD3.png?s=128&g=1", "display_name": "CodeWriter", "link": "https://stackoverflow.com/users/5220795/codewriter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 2, "answer_count": 2, "score": -1, "last_activity_date": 1534274188, "creation_date": 1530126892, "question_id": 51069944, "link": "https://stackoverflow.com/questions/51069944/using-vba-regex-to-find-range-of-formats-and-maintain-speed", "title": "Using VBA RegEx to find range of formats and maintain speed", "body": "<p>I am using Excel to build a sophisticated Bill of Materials generated by another program. There are acceptable names for each of the items found in the BoM. However, often the item names fall outside the accepted naming convention. I would like to build a list of those poorly named items. Here is the acceptable formats. X's are numbers only. C's are indeed the letter C.</p>\n\n<p>XXXXXX<br/>\nX-XXXXX-XX<br/>\nX-XXXXXX-XX<br/>\nXX-XXXXX-XX<br/>\nXX-XXXXXX-XX<br/>\nX-XXXXX<br/>\nX-XXXXXX<br/>\nXX-XXXXX<br/>\nXX-XXXXXX<br/>\nX-XXXXX-XXX<br/>\nXX-XXXXX-XXX<br/>\nXXX-XXXXX-XXX<br/>\nCCXXXXXX<br/>\nCCX-XXXXX-XX<br/>\nCCX-XXXXXX-XX<br/>\nCCXX-XXXXX-XX<br/>\nCCXX-XXXXXX-XX<br/>\nCCX-XXXXX<br/>\nCCX-XXXXXX<br/>\nCCXX-XXXXX<br/>\nCCXX-XXXXXX<br/>\nCCXXX-XXXXX<br/>\nCCXXX-XXXXXX<br/>\nCCX-XXXXX-XXX<br/>\nCCXX-XXXXX-XXX<br/>\nCCXXX-XXXXX-XXX<br/> </p>\n\n<p>Any other string or character in these strings would fail, ie. 24-03995-01 would be accepted, but 24-03995-D1 would not. 24-03995-01 would again be ok and so would 24-03995-01 ITEM A, 24-03995-D1 ITEM A would not. </p>\n\n<p>I am not an expert at regular expression syntax, but can manage. My question is what would be the most efficient manner for any given input (a file name) to find that it does or does not match the given patterns? Are regular expressions the best approach? I am thinking I need to compare the input to all the above formats, but somehow that seems incredibly inefficient. Is there a way to narrow the reg ex syntax (again not my forte) to catch say 5 of the above pattens in a one statement and another 5 in the next, etc.? A big Select Case statement perhaps?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10000192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IJG7I.jpg?s=128&g=1", "display_name": "Razzmania", "link": "https://stackoverflow.com/users/10000192/razzmania"}, "edited": false, "score": 0, "creation_date": 1530128966, "post_id": 51070120, "comment_id": 89130613, "body": "It seems to delete everything"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 11, "user_id": 10000192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IJG7I.jpg?s=128&g=1", "display_name": "Razzmania", "link": "https://stackoverflow.com/users/10000192/razzmania"}, "edited": false, "score": 0, "creation_date": 1530130717, "post_id": 51070120, "comment_id": 89131336, "body": "I had another look and it appears I should have used xlOr rather than xlAnd."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1530130677, "last_edit_date": 1530130677, "creation_date": 1530127703, "answer_id": 51070120, "question_id": 51069926, "link": "https://stackoverflow.com/questions/51069926/speed-up-delete-rows-between-dates-based-on-cells-in-another-sheet/51070120#51070120", "title": "Speed up Delete rows between dates based on cells in another sheet", "body": "<p>Use an autofilter to identify the rows to remove.</p>\n\n<pre><code>With ActiveSheet\n    if .autofiltermode then .autofiltermode= false\n    with .range(.cells(1, \"C\"), .Cells(.Rows.Count, \"C\").End(xlUp))\n        .autofilter field:=1, criteria1:=\"&lt;\"&amp;dteStart, criteria2:=\"&gt;\"&amp;dteEnd , operator:=xlor\n        with .resize(.rows.count-1, 1).offset(1, 0)\n            if cbool(application.subtotal(103, .cells)) then\n                .cells.entirerow.delete\n            end if\n        end with\n    end with\n    if .autofiltermode then .autofiltermode= false\nend with\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10000192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IJG7I.jpg?s=128&g=1", "display_name": "Razzmania", "link": "https://stackoverflow.com/users/10000192/razzmania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1530130677, "creation_date": 1530126806, "question_id": 51069926, "link": "https://stackoverflow.com/questions/51069926/speed-up-delete-rows-between-dates-based-on-cells-in-another-sheet", "title": "Speed up Delete rows between dates based on cells in another sheet", "body": "<p>I have a routine that works but seems to take long. Basically I want to delete any row in the sheet \"data\" column C that does not fall in the range of the two dates I input in sheet \"Dashboard\" start date H13 and end date H14</p>\n\n<pre><code>Sub dateDelete()\nSheets(\"Data\").Select\nConst TEST_COLUMN As String = \"C\"    '&lt;=== change to suit\nDim i As Long\nDim lastRow As Long\nDim dteStart As Date\nDim dteEnd As Date\n\n    dteStart = Worksheets(\"Dashboard\").Range(\"H13\")\n    dteEnd = Worksheets(\"Dashboard\").Range(\"H14\")\n\n    With Application\n    '    .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n    With ActiveSheet\n\n        lastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n        For i = lastRow To 2 Step -1\n\n            If .Cells(i, \"C\").Value &lt; dteStart Or .Cells(i, \"C\").Value &gt; dteEnd Then\n\n                .Rows(i).Delete\n            End If\n        Next i\n\n    End With\n\n    With Application\n\n        .Calculation = xlCalculationAutomatic\n        .ScreenUpdating = True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1530126390, "post_id": 51069806, "comment_id": 89129507, "body": "Welcome to the site!  Check out the <a href=\"https://stackoverflow.com/tour\">tour</a> and the <a href=\"https://stackoverflow.com/help/how-to-ask\">how-to-ask page</a> for more about asking questions that will attract quality answers.  You can <a href=\"https://stackoverflow.com/posts/51069806/edit\">edit your question</a> to include more information."}], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 8114974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956d76981f60ce06a7894e30760f68d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Huang", "link": "https://stackoverflow.com/users/8114974/bruce-huang"}, "is_accepted": false, "score": 0, "last_activity_date": 1530128831, "last_edit_date": 1530128831, "creation_date": 1530128336, "answer_id": 51070256, "question_id": 51069806, "link": "https://stackoverflow.com/questions/51069806/how-to-make-a-chart-that-automatically-selects-range-based-on-available-data/51070256#51070256", "title": "How to make a chart that automatically selects range based on available data", "body": "<ol>\n<li>Put your data in one sheet</li>\n<li>Then use <code>rngSourceData = Sheets(index).UsedRange</code> to get the data automatically.</li>\n<li><p>Draw your chart by VBA codes. The chart creation normally need the source data range as input, then pass the <code>rngSourceData</code> to the function. Such as below demo:</p>\n\n<pre><code>Set PTCache = ActiveWorkbook.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=rngSourceData, _\n    Version:=xlPivotTableVersion14)\n</code></pre></li>\n<li><p>Then you can rerun the step 2-3 and refresh the chart if your data changed.</p></li>\n</ol>\n\n<p>You may record the macro codes to get the example on how to create your specific chart then change the codes a little bit.</p>\n"}], "owner": {"reputation": 1, "user_id": 10001526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cbfc564b75e02dbee0027cc08cf7b16?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/10001526/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1530128831, "creation_date": 1530126308, "question_id": 51069806, "link": "https://stackoverflow.com/questions/51069806/how-to-make-a-chart-that-automatically-selects-range-based-on-available-data", "title": "How to make a chart that automatically selects range based on available data", "body": "<p>I have a table of process measurements. Rows are measurements and columns are different variables. I have a macro that copies the data from another worksheet. The number on measurements can vary, and I'd like to write a macro that automatically selects range based on the number on measurements and plots the variable values as a function of time. I'd also like to have a macro that moves the source column of the chart one to the right, so every time that I run the macro, it plots different variable as a function of time(measurement). How should I approach this problem? Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 1, "creation_date": 1530127224, "post_id": 51069707, "comment_id": 89129915, "body": "You need to identify your sheet references, just putting Range() references the ActiveSheet."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9927541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5996463ebd335a0c85ccaf93eeceeb89?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/9927541/steve"}, "edited": false, "score": 0, "creation_date": 1530227792, "post_id": 51070413, "comment_id": 89172890, "body": "Thank you so much, that worked perfectly!!!  Is it possible to concatenate data from sheet 1 into sheet2 using this same format?  The excel code would be =CONCATENATE(Sheet1!I9,&quot;, &quot;,Sheet1!I10,&quot;, &quot;,Sheet1!I11,&quot;, &quot;,Sheet1!I12)"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 37, "user_id": 9927541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5996463ebd335a0c85ccaf93eeceeb89?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/9927541/steve"}, "edited": false, "score": 0, "creation_date": 1530279511, "post_id": 51070413, "comment_id": 89193386, "body": "Don&#39;t forget to \u2713 an answer that helped solve your problem\u2026 You&#39;ll get +2 reputation, and the individual that answered your question will get +15 rep. <a href=\"https://stackoverflow.com/questions/15888353/concatenate-multiple-ranges-using-vba\">This SO question</a> may help you accomplish your concatenate question. If you want to ask a different question it is best to start another question in its own thread. This helps other users to research answers that my help them answer their own similar questions."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 0, "last_activity_date": 1530129059, "creation_date": 1530129059, "answer_id": 51070413, "question_id": 51069707, "link": "https://stackoverflow.com/questions/51069707/excel-data-replication-automated-saving-pt-2/51070413#51070413", "title": "Excel Data Replication + Automated Saving PT 2", "body": "<p>Here is a sample of your code with the additions and changes.</p>\n\n<p>1-Create worksheet variables\n2-Make the last row a variable\n3-Since your are writing to sheet2, put your code inside a <code>With - End With</code> statement\n4-Ensue you put the ws1 variable in front of the range you are copying from </p>\n\n<pre><code>Dim dTime As Date\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\n\nSet ws1 = ActiveWorkbook.Worksheets(\"Sheet1\")\nSet ws2 = ActiveWorkbook.Worksheets(\"Sheet2\")\n\nDim lRow As Long\n    lRow = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nWith ws2\n    Range(\"A1:A\" &amp; lRow).Offset(1).Value = ws1.Range(\"A2\").Value\n    Range(\"B1:B\" &amp; lRow).Offset(1).Value = ws1.Range(\"B2\").Value\n    Range(\"C1:C\" &amp; lRow).Offset(1).Value = ws1.Range(\"C2\").Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9927541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5996463ebd335a0c85ccaf93eeceeb89?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/9927541/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 51070413, "answer_count": 1, "score": 0, "last_activity_date": 1530129059, "creation_date": 1530125855, "question_id": 51069707, "link": "https://stackoverflow.com/questions/51069707/excel-data-replication-automated-saving-pt-2", "title": "Excel Data Replication + Automated Saving PT 2", "body": "<p>I am trying to replicate data entered from one worksheet(sheet1) into another(sheet2) and then have it save hourly on a separate line each time on sheet2. I am pulling unique cells from each row rather than the entire row from sheet1 to be saved to sheet 2 with all data being in a specific order and outputting to a single row with one value per cell and creating a new line each time it is saved.  For my usage, Sheet 1 will always stay open as the active sheet where changes will be made and the data will periodically save to Sheet2 while sheet1 remains selected.  I am saving every 5 seconds at this stage for troubleshooting purposes.</p>\n\n<p>I need assistance on pulling values from unique cells on approximately 30 rows from sheet1 and saving it to specific cells on sheet2 while sheet1 remains open and active.</p>\n\n<p>I am having the following issues so far:\n1. the data will replicate on sheet1 instead of sheet2 when i have sheet1 selected and open instead of writing to sheet2 as i need it to when sheet1 is being viewed/modified actively.</p>\n\n<p>here is my code so far:</p>\n\n<pre><code>Option Explicit\nPublic dTime As Date\n\nSub ValueStore()\nDim dTime As Date\n    Range(\"A\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"A2\").Value\n    Range(\"B\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"B2\").Value\n    Range(\"C\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"C2\").Value\n    Range(\"D\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"D2\").Value\n    Range(\"E\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"E2\").Value\n    Range(\"F\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"F2\").Value\n    Range(\"G\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"G2\").Value\n    Range(\"H\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"H2\").Value\n    Range(\"I\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"I2\").Value\n    Range(\"J\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"J2\").Value\n    Range(\"K\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"K2\").Value\n    Range(\"L\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"L2\").Value\n    Range(\"M\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"M2\").Value\n    Range(\"N\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"N2\").Value\n    Range(\"O\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"O2\").Value\n    Range(\"P\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"P2\").Value\n    Range(\"Q\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"Q2\").Value\n    Range(\"R\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"R2\").Value\n    Range(\"S\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"S2\").Value\n    Range(\"T\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"T2\").Value\n    Range(\"U\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"U2\").Value\n    Range(\"V\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"V2\").Value\n    Range(\"W\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"W2\").Value\n    Range(\"X\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"X2\").Value\n    Range(\"Y\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"Y2\").Value\n    Range(\"Z\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"Z2\").Value\nRange(\"AA\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"AA2\").Value\nRange(\"AB\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"AB2\").Value\nRange(\"AC\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"AC2\").Value\nRange(\"AD\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"AD2\").Value\nRange(\"AE\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"AE2\").Value\n\n\n  Call StartTimer1\nEnd Sub\n\n\nSub StartTimer1()\n    dTime = Now + TimeValue(\"00:00:05\")\n    Application.OnTime dTime, \"ValueStore\", Schedule:=True\nEnd Sub\n\nSub StopTimer1()\n    On Error Resume Next\n    Application.OnTime dTime, \"ValueStore\", Schedule:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1530125449, "post_id": 51069543, "comment_id": 89129066, "body": "Can you give some sample input and expected output?"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1530129933, "creation_date": 1530129933, "answer_id": 51070598, "question_id": 51069543, "link": "https://stackoverflow.com/questions/51069543/vba-code-to-split-cells-based-on-parenthesis-and-spaces-before-and-after-parenth/51070598#51070598", "title": "Vba code to split cells based on parenthesis and spaces before and after parenthesis", "body": "<p>I found a pattern that works.  (I cheat, and use <code>Replace()</code>, but it seems to do the trick):</p>\n\n<pre><code>Sub StripCells()\n\nDim r As Range, i As Long\nWith CreateObject(\"VBScript.RegExp\")\n    .Global = True\n    '.Pattern = \"\\(([^\\)]+)\\)\"\n    .Pattern = \"((\\(([^\\)]+)\\))|[\\w+ ]+)\"\n    For Each r In Range(\"a1\", Range(\"a\" &amp; Rows.Count).End(xlUp))\n        If .test(r.Value) Then\n            For i = 0 To .Execute(r.Value).Count - 1\n                r(, i + 2).Value = \"'\" &amp; Replace(Replace(.Execute(r.Value)(i).submatches(0), \")\", \"\"), \"(\", \"\")\n            Next\n        End If\n    Next\nEnd With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/aVIzo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aVIzo.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1530131574, "creation_date": 1530131574, "answer_id": 51070982, "question_id": 51069543, "link": "https://stackoverflow.com/questions/51069543/vba-code-to-split-cells-based-on-parenthesis-and-spaces-before-and-after-parenth/51070982#51070982", "title": "Vba code to split cells based on parenthesis and spaces before and after parenthesis", "body": "<p>If all your cells begin with an \" <strong>(</strong> \" then:</p>\n\n<pre><code>Sub fracture()\n    Dim r As Range, a, arr, i As Long\n\n    For Each r In Range(\"a1\", Range(\"a\" &amp; Rows.Count).End(xlUp))\n        arr = Split(Replace(r.Value, \"(\", \")\"), \")\")\n        i = 0\n        For Each a In arr\n            If i &lt;&gt; 0 Then\n                r.Offset(0, i).Value = a\n            End If\n            i = i + 1\n        Next a\n    Next r\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/kzQ8T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kzQ8T.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 7676625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a12745589e5c2737a6df6ffde1bb95b?s=128&d=identicon&r=PG&f=1", "display_name": "Bangi", "link": "https://stackoverflow.com/users/7676625/bangi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530131574, "creation_date": 1530125130, "last_edit_date": 1530126491, "question_id": 51069543, "link": "https://stackoverflow.com/questions/51069543/vba-code-to-split-cells-based-on-parenthesis-and-spaces-before-and-after-parenth", "title": "Vba code to split cells based on parenthesis and spaces before and after parenthesis", "body": "<p>I have an excel file that has some cells with several text in parenthesis and outside parenthesis. I would like to split the cells. For example , I have some cells appearing like this </p>\n\n<p><code>(some text in) parenthesis and (others outside)</code> </p>\n\n<p>I would to split the cells so that the <code>some text in</code> is in a different cell, <code>parenthesis and</code> also in a different cell and <code>others outside</code> also in a different cell.  What I have so far only splits what's in parenthesis. Thanks in advance. Here's my code below</p>\n\n<pre><code>Sub StripCells()\n\nDim r As Range, i As Long\nWith CreateObject(\"VBScript.RegExp\")\n    .Global = True\n    .Pattern = \"\\(([^\\)]+)\\)\"\n    For Each r In Range(\"a1\", Range(\"a\" &amp; Rows.Count).End(xlUp))\n        If .test(r.Value) Then\n            For i = 0 To .Execute(r.Value).Count - 1\n                r(, i + 2).Value = \"'\" &amp; .Execute(r.Value)(i).submatches(0)\n            Next\n        End If\n    Next\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9660986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d99ab89146b7c6880373891c280957f?s=128&d=identicon&r=PG&f=1", "display_name": "Deshaun Smantty", "link": "https://stackoverflow.com/users/9660986/deshaun-smantty"}, "edited": false, "score": 0, "creation_date": 1530125562, "post_id": 51069531, "comment_id": 89129136, "body": "thanks, but i still get the same error i have been getting"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 9660986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d99ab89146b7c6880373891c280957f?s=128&d=identicon&r=PG&f=1", "display_name": "Deshaun Smantty", "link": "https://stackoverflow.com/users/9660986/deshaun-smantty"}, "edited": false, "score": 0, "creation_date": 1530130176, "post_id": 51069531, "comment_id": 89131115, "body": "Have in mind, that the <i>names</i> must be the names of the subform <i>controls</i>, not the names of the subforms."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1530125096, "creation_date": 1530125096, "answer_id": 51069531, "question_id": 51069460, "link": "https://stackoverflow.com/questions/51069460/proper-way-to-reference-a-forms-property-that-is-two-navigation-subforms-deep/51069531#51069531", "title": "Proper way to reference a forms property that is two navigation subforms deep?", "body": "<p>Try with:</p>\n\n<pre><code>[Forms]![MainNavigationForm]![NavigationSubform].[Form]![SubNavigationForm].Form![NavigationSubform].Form![Form1].Refresh\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9660986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d99ab89146b7c6880373891c280957f?s=128&d=identicon&r=PG&f=1", "display_name": "Deshaun Smantty", "link": "https://stackoverflow.com/users/9660986/deshaun-smantty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530125096, "creation_date": 1530124796, "question_id": 51069460, "link": "https://stackoverflow.com/questions/51069460/proper-way-to-reference-a-forms-property-that-is-two-navigation-subforms-deep", "title": "Proper way to reference a forms property that is two navigation subforms deep?", "body": "<p>I have this statement that i want to execute after a button has been clicked in a pop up dialog box:</p>\n\n<pre><code>[Forms]![MainNavigationForm].[NavigationSubform].[Form]![SubNavigationForm].[NavigationSubform].Form![Form1].Refresh\n</code></pre>\n\n<p>I keep getting an error that Access cannot recognize SubNavigationForm and thinks I am referring to a field rather than a form.\nForm1 is open and when i try and run this command</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 405, "user_id": 1100554, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dd1c1863bd1c9da58ede1932822cb99e?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/1100554/sam"}, "edited": false, "score": 0, "creation_date": 1530128950, "post_id": 51069346, "comment_id": 89130607, "body": "Your question is unclear as to exactly what you are trying to do and why your recorded code is not working. Charts require data series and selecting a single cell will not give you sufficient data for your chart.  It appears that in your code, you want to select multiple cells but even that is vague.  Fix the question and identify goals and errors."}], "answers": [{"tags": [], "owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "is_accepted": true, "score": 1, "last_activity_date": 1530173219, "creation_date": 1530173219, "answer_id": 51077776, "question_id": 51069346, "link": "https://stackoverflow.com/questions/51069346/vba-chart-active-cell/51077776#51077776", "title": "VBA Chart Active Cell", "body": "<p>You were very close to achieving your goal, the only issue with your code is that it references the active cell of the active sheet, in your case the worksheet \"tester\".</p>\n\n<p>What you need to do is get the row reference from sheet1 using a varable and then pass this onto the code that creates the chart:</p>\n\n<pre><code>Sub createchart()\n\nDim wb As Workbook: Set wb = ThisWorkbook\nDim ws As Worksheet: Set ws = wb.Sheets(\"tester\")\nDim CellRow As Integer    ' create a variable to hold the cell row\n\nwb.Sheets(\"Sheet1\").Select   ' select \"sheet1\" before we get the active cell row\nCellRow = ActiveCell.Row   ' get the row number from the active cell in \"sheet1\"\n\n\nws.Activate\n    ActiveSheet.Shapes.AddChart2(251, xlBarClustered).Select\n\n   'Change the code from ActiveCell.Row to our new variable CellRow\n   ActiveChart.SetSourceData Source:=ws.Range(\"E\" &amp; CellRow &amp; \",G\" &amp; CellRow &amp; \",H\" &amp; CellRow)\nActiveChart.FullSeriesCollection(1).XValues = \"=tester!$E$9,tester!$G$9,tester!$H$9\"\n    ActiveChart.SetElement (msoElementDataLabelOutSideEnd)\n    ActiveChart.SetElement (msoElementPrimaryCategoryGridLinesNone)\n    ActiveChart.Axes(xlValue).MajorGridlines.Format.Line.Visible = msoFalse\n    ActiveChart.FullSeriesCollection(1).DataLabels.ShowCategoryName = False\n\nWith ActiveChart\n    .HasTitle = True\n    .ChartTitle.Characters.Text = \"Analysis for \" &amp; ws.Range(\"C\" &amp; ActiveCell.Row)\n    ActiveChart.HasAxis(xlValue) = False\n    ActiveChart.HasLegend = False\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 9700724, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GSIvnYFb2pw/AAAAAAAAAAI/AAAAAAAAHoo/3ULpSXRsKP8/photo.jpg?sz=128", "display_name": "Jose Cortez", "link": "https://stackoverflow.com/users/9700724/jose-cortez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 51077776, "answer_count": 1, "score": 0, "last_activity_date": 1530173219, "creation_date": 1530124264, "question_id": 51069346, "link": "https://stackoverflow.com/questions/51069346/vba-chart-active-cell", "title": "VBA Chart Active Cell", "body": "<p>I'm having trouble trying to figure out how to create a vba chart from an active cell on a separate sheet. Essentially what I'm trying to do is create a vba chart from an active cell on Sheet 1, all the information resides on a sheet called \"Tester\" so say i click on cell $C12 on Sheet1 the vba code would then create a chart based off $C12 on the information that lives on \"Tester\". I would then like that charts destination to be on a Sheet called Analysis. Here is my code so far:</p>\n\n<pre><code>Sub createchart()\n\nDim wb As Workbook: Set wb = ThisWorkbook\nDim ws As Worksheet: Set ws = wb.Sheets(\"tester\")\n\n\nws.Activate\n    ActiveSheet.Shapes.AddChart2(251, xlBarClustered).Select\n   ActiveChart.SetSourceData Source:=ws.Range(\"E\" &amp; ActiveCell.Row &amp; \",G\" &amp; ActiveCell.Row &amp; \",H\" &amp; ActiveCell.Row)\nActiveChart.FullSeriesCollection(1).XValues = \"=tester!$E$9,tester!$G$9,tester!$H$9\"\n    ActiveChart.SetElement (msoElementDataLabelOutSideEnd)\n    ActiveChart.SetElement (msoElementPrimaryCategoryGridLinesNone)\n    ActiveChart.Axes(xlValue).MajorGridlines.Format.Line.Visible = msoFalse\n    ActiveChart.FullSeriesCollection(1).DataLabels.ShowCategoryName = False\n\nWith ActiveChart\n    .HasTitle = True\n    .ChartTitle.Characters.Text = \"Analysis for \" &amp; ws.Range(\"C\" &amp; ActiveCell.Row)\n    ActiveChart.HasAxis(xlValue) = False\n    ActiveChart.HasLegend = False\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1530124385, "post_id": 51069310, "comment_id": 89128556, "body": "change <code>Sub Ct1()</code> to <code>Sub Ct1(X as Long)</code> then when you call it use <code>Ct1(X)</code> which will pass the value."}, {"owner": {"reputation": 1, "user_id": 10001621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-J8HavI4sZVw/AAAAAAAAAAI/AAAAAAAADkU/rbGFogud_Sg/photo.jpg?sz=128", "display_name": "IceBurnHex", "link": "https://stackoverflow.com/users/10001621/iceburnhex"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1530124599, "post_id": 51069310, "comment_id": 89128667, "body": "Awesome, worked like a charm. I guess I have another issue entirely with the Cells(X+2, 2).PasteSpecial function still giving the Paste into First Cell error."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1530124742, "post_id": 51069310, "comment_id": 89128733, "body": "<code>Cells.Copy</code> is copying the entire active sheet.  You need to specify a range to copy.  You can&#39;t paste an entire sheet into any cell but A1."}, {"owner": {"reputation": 1, "user_id": 10001621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-J8HavI4sZVw/AAAAAAAAAAI/AAAAAAAADkU/rbGFogud_Sg/photo.jpg?sz=128", "display_name": "IceBurnHex", "link": "https://stackoverflow.com/users/10001621/iceburnhex"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1530124817, "post_id": 51069310, "comment_id": 89128765, "body": "Thanks again! Looks like I can close this one up."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1530124905, "post_id": 51069310, "comment_id": 89128813, "body": "@IceBurnHex - reading about <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoiding select</a> will take you very far in your programming endeavors"}], "owner": {"reputation": 1, "user_id": 10001621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-J8HavI4sZVw/AAAAAAAAAAI/AAAAAAAADkU/rbGFogud_Sg/photo.jpg?sz=128", "display_name": "IceBurnHex", "link": "https://stackoverflow.com/users/10001621/iceburnhex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530124748, "creation_date": 1530124143, "last_edit_date": 1530124748, "question_id": 51069310, "link": "https://stackoverflow.com/questions/51069310/excel-vba-multiple-subroutine-with-counter", "title": "Excel VBA Multiple Subroutine with Counter", "body": "<p>So, I've been at this for a bit trying to figure out how to proceed on this, and just a heads up, I\"m still in the process of learning VBA, but am turning here for advice / help on this problem.</p>\n\n<p>I'm basically using a counter in my main routine and then calling to a subroutine which needs to use the counter from the main to properly do what I need. Below is the code I have so far.</p>\n\n<pre><code>Sub Main()\n\nDim Count As Integer\nDim X As Integer\nWorksheets(\"Main Sched.\").Activate\nX = 2\nCount = Cells(2, Columns.Count).End(xlToLeft).Column\n\nDo While X &lt; Count + 2\nCells(X, 2).Select\nCtype = ActiveCell\n\nIf Ctype = \"3/C #6\" Then Call Ct1\nIf Ctype = \"2/C #6\" Then Call Ct2\n\nX = X + 1\nLoop\nEnd Sub\n\nSub Ct1()\n\nCells.Copy\nWorksheets(\"Test\").Activate\nCells(X + 2, 2).Select\nCells(X + 2, 2).PasteSpecial xlPasteValuesAndNumberFormats\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>It ends as a Run-time error '1004', to paste cells from excel worksheet into current, paste into first cell (A1 or R1C1).\nI'm needing to take that data and paste it into B4, and later on in the loop based on the \"Count\" will adjust it accordingly to be something like B8, B13, etc. </p>\n\n<p>The reason I need to split it up, is because it is going to have many different \"Ctype\" values to reference, and each one has a different scheme on how it takes the data from the \"Main Sched.\" Sheet to the \"Test\" sheet. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1530137948, "post_id": 51069101, "comment_id": 89134148, "body": "@JohnColeman I guess you&#39;re not familiar with what underscore does.  Matt is calling <code>Hyperlinks.Add</code> (see the next line)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1530138099, "post_id": 51069101, "comment_id": 89134184, "body": "@NickSlash I didn&#39;t see the <code>Add</code> in the next line. It seems stylistically odd to split the line after the dot so that the next line contains the method call but all subsequent continued lines contain simply arguments."}, {"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1530138835, "post_id": 51069101, "comment_id": 89134370, "body": "Your code works fine for me @Matt. The only issue I get is on subsequent calls of the function with/without <code>Jeff</code>. The text in the cells doesn&#39;t change although the link does."}, {"owner": {"reputation": 1, "user_id": 10001572, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nl2q5aE_rQs/AAAAAAAAAAI/AAAAAAAAAWQ/HYyQyi59i9U/photo.jpg?sz=128", "display_name": "Matt Lane", "link": "https://stackoverflow.com/users/10001572/matt-lane"}, "reply_to_user": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1530142164, "post_id": 51069101, "comment_id": 89135106, "body": "@NickSlash That&#39;s very curious indeed. I wrote this code on my work computer and it works on all of my colleagues computer&#39;s as well. My laptop running excel can use it as it is written, but my desktop somehow gives me error 91.   I guess there&#39;s some external factor on my desktop affecting this. Any idea on what could cause that?"}, {"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1530190282, "post_id": 51069101, "comment_id": 89155079, "body": "Nothing that I can think of really. Have you tried copying the code to a new workbook?"}], "owner": {"reputation": 1, "user_id": 10001572, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nl2q5aE_rQs/AAAAAAAAAAI/AAAAAAAAAWQ/HYyQyi59i9U/photo.jpg?sz=128", "display_name": "Matt Lane", "link": "https://stackoverflow.com/users/10001572/matt-lane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530136827, "creation_date": 1530123382, "last_edit_date": 1531164843, "question_id": 51069101, "link": "https://stackoverflow.com/questions/51069101/vba-error-91-code-works-where-it-was-written-but-error-when-using-new-computer", "title": "VBA Error 91 - Code works where it was written but error when using new computer", "body": "<p>I was wanting to inquire about the error code 91 for VBA. I tried to google the solution and search this first, but the example and situations seemed to all be about declaring objects as values and I'm not sure how my code fits into that.</p>\n\n<p>The following code works on the computer it was written at, but when I tried to run it at my home computer the error occurs. The function is part of a collection of functions that makes changes based on the user putting their name into a specific cell and make changes based on need:</p>\n\n<pre><code>Sub CaseGuide_Jeff(Name As String)\n\n    'Checks for Name to make changes based on input\n    If Name = \"Jeff\" Then 'change hyperlink subaddress to custom\n       ThisWorkbook.Sheets(\"Case Guide\").Hyperlinks. _\n            Add Anchor:=Cells(3, 2), _\n            Address:=\"\", _\n            SubAddress:=\"'Case Guide'!C45\", _\n            ScreenTip:=\"Case Guide\"\n\n        ThisWorkbook.Sheets(\"Case Guide\").Hyperlinks. _\n            Add Anchor:=Cells(9, 3), _\n            Address:=\"\", _\n            SubAddress:=\"'Case Guide'!C45\", _\n            ScreenTip:=\"Case Guide\"\n\n    Else 'default hyperlink subaddress to standard location\n        ThisWorkbook.Sheets(\"Case Guide\").Hyperlinks. _\n            Add Anchor:=Cells(3, 2), _\n            Address:=\"\", _\n            SubAddress:=\"'Case Guide'!C50:C55\", _\n            ScreenTip:=\"Case Guide\"\n\n        ThisWorkbook.Sheets(\"Case Guide\").Hyperlinks. _\n            Add Anchor:=Cells(9, 3), _\n            Address:=\"\", _\n            SubAddress:=\"'Case Guide'!C50:C55\", _\n            ScreenTip:=\"Case Guide\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>The highlighted sections in debugger are only on the \"else\" section of the code. I'm not sure why it would be an okay format in the \"if\" section, but have the error in the \"else\" when the code is the same with no new types of objects being declared.</p>\n\n<p>Thank you for your time and for looking into this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1530123161, "post_id": 51069026, "comment_id": 89127970, "body": "all the <code>Range()</code> inside the other <code>Range()</code> need to be allocated to the same parent sheet: <code>Sheets(&quot;Media by Copy Lookup&quot;).Range(&quot;b1&quot;,Sheets(&quot;Media by Copy Lookup&quot;).Range(&quot;b1&quot;)...</code>"}, {"owner": {"reputation": 1, "user_id": 9660773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZAbmLSbGT7k/AAAAAAAAAAI/AAAAAAAACD8/BsI6vasaXFM/photo.jpg?sz=128", "display_name": "Jakebd", "link": "https://stackoverflow.com/users/9660773/jakebd"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1530123394, "post_id": 51069026, "comment_id": 89128070, "body": "Well that was simple. Thanks!"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1530123701, "post_id": 51069026, "comment_id": 89128205, "body": "You can simplify this using <code>With Sheets(&quot;Media by Copy Lookup&quot;)</code> &amp; <code>End With</code>"}, {"owner": {"reputation": 1, "user_id": 9660773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZAbmLSbGT7k/AAAAAAAAAAI/AAAAAAAACD8/BsI6vasaXFM/photo.jpg?sz=128", "display_name": "Jakebd", "link": "https://stackoverflow.com/users/9660773/jakebd"}, "edited": false, "score": 0, "creation_date": 1530218928, "post_id": 51069026, "comment_id": 89170274, "body": "That would definitely keep me from having super long lines of code. Thanks!"}], "owner": {"reputation": 1, "user_id": 9660773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZAbmLSbGT7k/AAAAAAAAAAI/AAAAAAAACD8/BsI6vasaXFM/photo.jpg?sz=128", "display_name": "Jakebd", "link": "https://stackoverflow.com/users/9660773/jakebd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530123057, "creation_date": 1530123057, "question_id": 51069026, "link": "https://stackoverflow.com/questions/51069026/sheet-inaccessible-to-macro-error-1004-application-object-defined-error", "title": "Sheet inaccessible to macro: Error 1004: Application/Object Defined Error", "body": "<p>This is happening in several of my macros, but this is the one in from of me:</p>\n\n<pre><code>Private Sub resettool()\n'''resets step 2 input and user input on MPP tabs\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nCall showsheets 'makes all of these sheets .Visible = True\n\n'clear data from lookups and data corrals\nSheets(\"Media by Copy Lookup\").Range(\"b1\",Range(\"b1\").End(xlToRight).End(xlDown)).ClearContents\nSheets(\"Total Media Lookup\").Range(\"d1\",Range(\"d1\").End(xlToRight).End(xlDown)).ClearContents\nSheets(\"Total Media Lookup\").Range(\"b2:c100\").ClearContents\nSheets(\"Media by Copy Data\").Range(\"a1\",Range(\"a1\").End(xlToRight).End(xlDown)).ClearContents\n'etc etc\nEnd Sub\n</code></pre>\n\n<p>It continues with similar data-clearing lines for a while. This started happening when I took someone else's code and cleaned it by removing the .Select usages as people on here have suggested. It seems that the macro isn't able to access the sheets I'm referencing, because a line runs successfully if I step into the code, manually select the referenced sheet, and then hit go (but then of course I get the same error when I try to edit another sheet).</p>\n\n<p>Any ideas why the macro wouldn't be able to access these sheets unless I explicitly activate/select them? The sheets are all visible, so that shouldn't be the problem.</p>\n\n<p>P.S. I've seen the guide on using .Rows.Count).End(xlUp) instead of End(xlDown) to find the bottom of my data and will implement that soon, but this issue is occurring no matter how I define the range; it's about the sheet.</p>\n"}, {"tags": ["vba", "excel", "batch-file", "cmd"], "comments": [{"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 2, "creation_date": 1530122934, "post_id": 51068829, "comment_id": 89127853, "body": "First thing I noticed, you need to add a space in your first one <code>val = &quot;path\\mybat.bat &quot; &amp; r</code>"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1530123322, "creation_date": 1530123322, "answer_id": 51069089, "question_id": 51068829, "link": "https://stackoverflow.com/questions/51068829/passing-a-variable-from-vba-to-bat-file/51069089#51069089", "title": "Passing a variable from vba to .bat file", "body": "<blockquote>\n<pre><code>val = \"path\\mybat.bat r\"\n</code></pre>\n</blockquote>\n\n<p><code>r</code> is just another character in the string literal <code>\"path\\mybat.bat r\"</code> here - how is VBA supposed to know that you meant <em>that</em> <code>r</code> to refer to that local <code>r</code> variable?</p>\n\n<pre><code>val = \"path\\mybat.bat \" &amp; r 'note the trailing space in the string literal\n</code></pre>\n\n<p>Use it as a variable: pull it out of the string literal, concatenate it.</p>\n\n<p>Error 53 is \"File not Found\". By forgetting the trailing space you're invoking <code>mybat.batAndWhateverRcontains</code>, which likely isn't an existing file name. Hence, \"file not found\".</p>\n\n<p>Also note this common trap:</p>\n\n<blockquote>\n<pre><code>Dim val, r As String\n</code></pre>\n</blockquote>\n\n<p>That declares <code>r</code> as a <code>String</code>, and leaves <code>val</code> as an implicit <code>Variant</code>.</p>\n\n<pre><code>Dim val As String, r As String\n</code></pre>\n\n<p>Declares both as <code>String</code> variables.</p>\n"}], "owner": {"reputation": 37, "user_id": 10001403, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eqiGhDUgDGI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0FMxfwFicMegTGFZTU33ejZXc-lQ/mo/photo.jpg?sz=128", "display_name": "Nicolas Klebusits", "link": "https://stackoverflow.com/users/10001403/nicolas-klebusits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "accepted_answer_id": 51069089, "answer_count": 1, "score": 1, "last_activity_date": 1530123322, "creation_date": 1530122163, "last_edit_date": 1531164843, "question_id": 51068829, "link": "https://stackoverflow.com/questions/51068829/passing-a-variable-from-vba-to-bat-file", "title": "Passing a variable from vba to .bat file", "body": "<p>I'm trying to pass a variable from word VBA to a batch file. The variable is an input box that the user has to type their username into. The batch file is then supposed to take that username and check it against an AD group in our directory. I must present the variable in the VBA first as I need to manipulate it in the VBA script after the batch file runs (unless it would be easier to pass a batch variable into word vba). All of the research I've done leads me to something along these lines:</p>\n\n<pre><code>Dim val, r As String\nr = InputBox(\"Please enter your username:\")\nval = \"path\\mybat.bat\" &amp; r\nCall Shell(val, vbNormalFocus)\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>Dim val, r As String\nr = InputBox(\"Please enter your username:\")\nval = \"path\\mybat.bat r\"\nCall Shell(val, vbNormalFocus)\n</code></pre>\n\n<p>I keep getting a run-time error 53 in VBA. I'm also not sure how to call the variable once it's passed into the .bat file.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1530122490, "post_id": 51068824, "comment_id": 89127644, "body": "Did you do any research? <code>Google</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9974523, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iaJkhC-FiIs/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq01sr2gM20b9TanuVFfJp0rYD2rDA/mo/photo.jpg?sz=128", "display_name": "kandha raj", "link": "https://stackoverflow.com/users/9974523/kandha-raj"}, "edited": false, "score": 0, "creation_date": 1530162339, "post_id": 51069985, "comment_id": 89139234, "body": "thanks @BigBen ! Can you explain me why you are making rng(my input E28 from my expression) as a Range and not a Double ?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 1, "user_id": 9974523, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iaJkhC-FiIs/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq01sr2gM20b9TanuVFfJp0rYD2rDA/mo/photo.jpg?sz=128", "display_name": "kandha raj", "link": "https://stackoverflow.com/users/9974523/kandha-raj"}, "edited": false, "score": 0, "creation_date": 1530185079, "post_id": 51069985, "comment_id": 89151664, "body": "Because <code>rng</code> is a <code>Range</code> with a <code>.value</code> that may or may not be a <code>Double</code>."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1530131052, "last_edit_date": 1530131052, "creation_date": 1530127106, "answer_id": 51069985, "question_id": 51068824, "link": "https://stackoverflow.com/questions/51068824/how-to-define-a-formula-in-vba/51069985#51069985", "title": "How to define a formula in vba?", "body": "<p>Maybe something like this? I took the liberty of changing the \"&lt;\" to \"&lt;=\", making a guess at what you wanted the value to be when your input exactly equals 250000, 500000, or 1000000.</p>\n\n<pre><code>Option Explicit\n\nFunction KandhasFormula(rng As Range) As Double\n\n    If rng.Count &gt; 1 Or Not VarType(rng.Value) = vbDouble Then Exit Function\n\n    If rng.Value &lt;= 250000 Then\n        KandhasFormula = 0\n    ElseIf rng.Value &gt; 250000 And rng.Value &lt;= 500000 Then\n        KandhasFormula = rng.Value\n    ElseIf rng.Value &gt; 500000 And rng.Value &lt;= 1000000 Then\n        KandhasFormula = 12500 + 0.2 * (rng.Value - 500000)\n    Else\n        KandhasFormula = 112500 + 0.3 * (rng.Value - 1000000)\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9974523, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iaJkhC-FiIs/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq01sr2gM20b9TanuVFfJp0rYD2rDA/mo/photo.jpg?sz=128", "display_name": "kandha raj", "link": "https://stackoverflow.com/users/9974523/kandha-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1530131052, "creation_date": 1530122129, "last_edit_date": 1530122428, "question_id": 51068824, "link": "https://stackoverflow.com/questions/51068824/how-to-define-a-formula-in-vba", "title": "How to define a formula in vba?", "body": "<p>I want to define a Function of the following expression and Use it like how i use SUM,AVERAGE etc. This formula, as you can see, has only 1 arguement (Cell value of E28) However, if someone can help me for a function with more than 1 argument it will be great ! </p>\n\n<p>I'm new to VBA, kindly excuse my flaws,if any.</p>\n\n<pre><code>KandhasFormula=IF(AND(E28&lt;250000),0,IF(AND(E28&gt;250000,E28&lt;500000),E28,IF(AND(E28&gt;500000,E28&lt;1000000),12500+0.2*(-500000+E28),112500+0.3*(-1000000+E28))))\n</code></pre>\n"}, {"tags": ["excel", "vba", "list", "random", "colors"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1530122120, "post_id": 51068733, "comment_id": 89127443, "body": "Does target actually have .column = 1 and .column=3 properties? Didn&#39;t think that was possible."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1530123620, "creation_date": 1530123620, "answer_id": 51069162, "question_id": 51068733, "link": "https://stackoverflow.com/questions/51068733/how-to-assign-random-interior-color-of-cells-as-i-add-names-to-a-list/51069162#51069162", "title": "How to assign random interior color of cells as I add names to a list?", "body": "<ol>\n<li>Never use Application.WorksheetFunction.Match or WorksheetFunction.Match. Use Application.Match and pass the result back to a variant type var which can be checked with IsError without breaking anything.</li>\n<li>Don't use <code>On Error Resume Next</code> if you can easily avoid it. See #1.</li>\n<li>Declare your vars. Better yet, go into the VBE's Tools, Options and put a check beside Require variable declaration. This will put Option Explicit at the top of every new code sheet. After that has been enabled, go and put <code>Option Explicit</code> at the top of every existing code sheet.</li>\n<li>Target could easily be more than a single cell and your routine will fail if it is. Apply some error control and deal with a Target that is more than a single cell.</li>\n<li>I honestly do not understand how Target.Cells.Column = 1 and Target.Column = 3 at the same time so I'll just work with the latter since you are trying to match that column.</li>\n<li><p>In your case, you can look for the target value in the entire column and it will always be found. If it is found in a row above the target, then you have a duplicate value.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Columns(3)) Is Nothing Then\n        Dim t As Range, x As Long\n        For Each t In Intersect(Target, Columns(3))\n            Debug.Print t.Address(0, 0)\n            'looking in the entire column means it will ALWAYS be found\n            x = Application.Match(t.Value, Columns(3), 0)\n            If x &lt; t.Row Then\n                ' duplicate value...copy the old color\n                t.Interior.Color = Cells(x, 3).Interior.Color\n            Else\n                ' choose a new color\n                t.Interior.Color = RGB( _\n                    Application.RandBetween(0, 255), _\n                    Application.RandBetween(0, 255), _\n                    Application.RandBetween(0, 255))\n            End If\n        Next t\n    End If\nEnd Sub\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 21, "user_id": 10001430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ce792ed73c054d062ff597a1feb7ba3?s=128&d=identicon&r=PG&f=1", "display_name": "Cryu0214", "link": "https://stackoverflow.com/users/10001430/cryu0214"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530123620, "creation_date": 1530121756, "question_id": 51068733, "link": "https://stackoverflow.com/questions/51068733/how-to-assign-random-interior-color-of-cells-as-i-add-names-to-a-list", "title": "How to assign random interior color of cells as I add names to a list?", "body": "<p>This is my first time posting so please have mercy!\nI have tried to assign random colors to a name list so I can later recall and populate another list of a staffing sheet.</p>\n\n<p>This is my code so far but it doesn't work for some odd reason.\nI'm not sure if someone already asked this question but my search has turned up empty handed.</p>\n\n<p>Thanks!</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Set WF = Application.WorksheetFunction\n    If Target.Cells.Column = 1 Then\n        If Target.Column = 3 Then\n            x = 0\n            On Error Resume Next\n            x = WF.Match(Target.Value, _\n                Range(\"C1\").Resize(Target.Row - 1), _\n                0)\n            On Error GoTo 0\n            If x &gt; 0 Then\n                ' duplicate value...copy the old color\n                Target.Interior.Color = Cells(x, 3).Interior.Color\n            Else\n                ' choose a new color\n                Target.Interior.Color = RGB( _\n                    WF.RandBetween(0, 255), _\n                    WF.RandBetween(0, 255), _\n                    WF.RandBetween(0, 255))\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2016"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1530121690, "post_id": 51068650, "comment_id": 89127247, "body": "Use <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/sheets-add-method-excel\" rel=\"nofollow noreferrer\">Worksheets.Add</a> method. After 2010, every workbook has at least one worksheet (so you never added it to begin)."}, {"owner": {"reputation": 57, "user_id": 4241006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TrAqL.jpg?s=128&g=1", "display_name": "John Ring", "link": "https://stackoverflow.com/users/4241006/john-ring"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1530122678, "post_id": 51068650, "comment_id": 89127730, "body": "So would I just set a new variable like: <code>Set WKS2 = WB.Worksheets.Add</code>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1530123926, "post_id": 51068650, "comment_id": 89128312, "body": "Correct. Did you try it?"}, {"owner": {"reputation": 57, "user_id": 4241006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TrAqL.jpg?s=128&g=1", "display_name": "John Ring", "link": "https://stackoverflow.com/users/4241006/john-ring"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1530126580, "post_id": 51068650, "comment_id": 89129610, "body": "Yes.  that was the answer.  Thank You"}], "answers": [{"tags": [], "owner": {"reputation": 2682, "user_id": 2662901, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7c91dbe3c7fdf96369fe85bf22f9fc29?s=128&d=identicon&r=PG", "display_name": "feetwet", "link": "https://stackoverflow.com/users/2662901/feetwet"}, "is_accepted": false, "score": 0, "last_activity_date": 1578282624, "creation_date": 1578282624, "answer_id": 59606459, "question_id": 51068650, "link": "https://stackoverflow.com/questions/51068650/ms-access-vba-creating-excel-workbook-with-multiple-worksheets/59606459#59606459", "title": "MS Access VBA: Creating Excel Workbook with multiple Worksheets", "body": "<p>The workbook starts with one sheet.  You can append a sheet and name it via a line like this:</p>\n\n<pre><code>WB.Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"Fred\"\n</code></pre>\n\n<p>You can assign a variable on creation, or you can reference the new sheet be name: E.g., <code>WB.Sheets(\"Fred\")</code></p>\n"}], "owner": {"reputation": 57, "user_id": 4241006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TrAqL.jpg?s=128&g=1", "display_name": "John Ring", "link": "https://stackoverflow.com/users/4241006/john-ring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1556, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594278487, "creation_date": 1530121418, "last_edit_date": 1594278487, "question_id": 51068650, "link": "https://stackoverflow.com/questions/51068650/ms-access-vba-creating-excel-workbook-with-multiple-worksheets", "title": "MS Access VBA: Creating Excel Workbook with multiple Worksheets", "body": "<p>I can create a workbook that contains a single worksheet using the following code:</p>\n\n<pre><code>'Create Custom Excel Report\nSet XL = New Excel.Application\nXL.Visible = True\nSet WB = XL.Workbooks.Add\nSet WKS = WB.Worksheets(1)\nWKS.Name = \"Fred\"\n\n'Set Report Headers\nWKS.Cells(2, 1).value = \"Name\"\nWKS.Cells(2, 2).value = \"Address\"\nWKS.Cells(2, 3).value = \"Hat Size\"\n</code></pre>\n\n<p>How can I create a workbook that has 3 worksheets?  How do I set the values for the individual worksheets?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "edited": false, "score": 0, "creation_date": 1530123152, "post_id": 51068993, "comment_id": 89127963, "body": "That crashed my userform.. I had to ctrl+break it. Also seconds did not tick down."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "edited": false, "score": 0, "creation_date": 1530123218, "post_id": 51068993, "comment_id": 89127993, "body": "@OdaySalim - Still, making a ticking endless loop is expected to crash some time... You should come up with some logic when and how to stop."}, {"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "edited": false, "score": 0, "creation_date": 1530123614, "post_id": 51068993, "comment_id": 89128163, "body": "I will be able to put together logical expressions to make it stop. What I am unable to do is make the clock tick..."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "edited": false, "score": 0, "creation_date": 1530123857, "post_id": 51068993, "comment_id": 89128273, "body": "@OdaySalim - in the updated code it is ticking. I have added <code>Me.Repaint</code> and the Waiting. Still, after some time enjoying the ticking, you&#39;ll have to stop it with Ctrl+Break."}, {"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "edited": false, "score": 1, "creation_date": 1530124078, "post_id": 51068993, "comment_id": 89128386, "body": "Thanks - perhaps there is no need to make it tick per second. I would just do a countdown in days without a loop and not having to break it. Thanks"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1530123242, "last_edit_date": 1530123242, "creation_date": 1530122955, "answer_id": 51068993, "question_id": 51068622, "link": "https://stackoverflow.com/questions/51068622/excel-userform-live-time-countdown/51068993#51068993", "title": "Excel Userform live time countdown", "body": "<p>Put it in an endless loop and it would start ticking every second:</p>\n\n<pre><code>Private Sub UserForm_Activate()\n\n    Dim remTime As Date\n\n    While True\n        remTime = DateValue(\"28 Jun 2018\") + TimeValue(\"18:37:00\") - Now\n        Me.Label1 = Int(remTime) &amp; \" Days \" &amp; Format(remTime - Int(remTime), \"HH:MM:SS\")\n        Me.Repaint\n        Application.Wait Now + #12:00:01 AM#\n    Wend\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 51068993, "answer_count": 1, "score": 1, "last_activity_date": 1530123242, "creation_date": 1530121307, "question_id": 51068622, "link": "https://stackoverflow.com/questions/51068622/excel-userform-live-time-countdown", "title": "Excel Userform live time countdown", "body": "<p>I have created a simple userform with a text label. I have put this code on activation of userform to run remaining time from target time. It is good once it runs, but it does not count down... Seconds do not flick down ... etc.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Private Sub UserForm_activate()\ntargtime = DateValue(\"28 Jun 2018\") + TimeValue(\"18:37:00\")\nremtime = targtime - Now\nMe.Label1 = Int(remtime) &amp; \" Days \" &amp; Format(remtime - Int(remtime), \"HH:MM:SS\")\nEnd Sub\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["excel", "vba", "apply"], "comments": [{"owner": {"reputation": 454, "user_id": 9034642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zj2lq.png?s=128&g=1", "display_name": "Uncle Ben Ben", "link": "https://stackoverflow.com/users/9034642/uncle-ben-ben"}, "edited": false, "score": 2, "creation_date": 1530120644, "post_id": 51068415, "comment_id": 89126748, "body": "Could you describe the error you obtained, please? &quot;Issues in VBA .apply&quot; is not that explicit unfortunately"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 454, "user_id": 9034642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zj2lq.png?s=128&g=1", "display_name": "Uncle Ben Ben", "link": "https://stackoverflow.com/users/9034642/uncle-ben-ben"}, "edited": false, "score": 0, "creation_date": 1530121443, "post_id": 51068415, "comment_id": 89127112, "body": "@UncleBenBen you&#39;re right, but my money is on a useless &quot;1004: Application-defined error&quot; message ;-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530121976, "post_id": 51068415, "comment_id": 89127371, "body": "You say that you want to sort the individual columns one at a time without affecting the other columns but defining <code>LastColumn = sht.Cells(StartCell.Row, sht.Columns.Count).End(xlToLeft).Column</code> then using to set a range with <code>.SetRange ActiveCell.Range(StartCell, sht.Cells(LastRow, LastColumn))</code> is not operating on a single column."}, {"owner": {"reputation": 1, "user_id": 10001331, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jv7-mmsgLfw/AAAAAAAAAAI/AAAAAAAAAJA/l1jBgxNbE4Y/photo.jpg?sz=128", "display_name": "Jacqueline Scalzo", "link": "https://stackoverflow.com/users/10001331/jacqueline-scalzo"}, "edited": false, "score": 0, "creation_date": 1530123282, "post_id": 51068415, "comment_id": 89128024, "body": "It is the 1004 error, sorry!!!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10001331, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jv7-mmsgLfw/AAAAAAAAAAI/AAAAAAAAAJA/l1jBgxNbE4Y/photo.jpg?sz=128", "display_name": "Jacqueline Scalzo", "link": "https://stackoverflow.com/users/10001331/jacqueline-scalzo"}, "edited": false, "score": 0, "creation_date": 1530123115, "post_id": 51068732, "comment_id": 89127947, "body": "So, it works on the first few columns on my sheet, sometimes it works on more than others, I haven&#39;t figured out the reason yet. How would I make sure it works for the entire sheet? This is my first time trying to write code for VBA."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 10001331, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jv7-mmsgLfw/AAAAAAAAAAI/AAAAAAAAAJA/l1jBgxNbE4Y/photo.jpg?sz=128", "display_name": "Jacqueline Scalzo", "link": "https://stackoverflow.com/users/10001331/jacqueline-scalzo"}, "edited": false, "score": 0, "creation_date": 1530124086, "post_id": 51068732, "comment_id": 89128389, "body": "Sorry, but you&#39;ve left too many questions unanswered for me to provide a definitive response. Maybe catch up on the comment section in your question and edit your question to include the error number and what line of your code it actually occurs on."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1530121739, "creation_date": 1530121739, "answer_id": 51068732, "question_id": 51068415, "link": "https://stackoverflow.com/questions/51068415/issues-in-vba-apply/51068732#51068732", "title": "Issues in VBA &quot;.Apply&quot;", "body": "<p>You're trying to work with the Sort code version that recording uses. This is very verbose and 'remembers' parameter values from previous operations. There is a much more concise syntax available that is just as effective.</p>\n\n<pre><code>dim c as long\n\nwith activesheet\n    for c=1 to .cells(1, .columns.count).end(xltoleft).column\n        if .cells(.rows.count, c).end(xlup).row &gt;1 then\n            with .columns(c).Cells\n                .Sort Key1:=.cells(1), Order1:=xlAscending, _\n                      Orientation:=xlTopToBottom, Header:=xlNo\n            end with\n        end if\n    next c\nend with\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10001331, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jv7-mmsgLfw/AAAAAAAAAAI/AAAAAAAAAJA/l1jBgxNbE4Y/photo.jpg?sz=128", "display_name": "Jacqueline Scalzo", "link": "https://stackoverflow.com/users/10001331/jacqueline-scalzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530121739, "creation_date": 1530120406, "question_id": 51068415, "link": "https://stackoverflow.com/questions/51068415/issues-in-vba-apply", "title": "Issues in VBA &quot;.Apply&quot;", "body": "<p>Trying to make a dynamic sort macro, works on first column, then I get an error when I try to run on new column (trying to sort each column A-Z without changing the order of the other columns). </p>\n\n<pre><code>Sub SortCell()\nDim sht As Worksheet\nDim LastRow As Long\nDim LastColumn As Long\nDim StartCell As Range\n\nSet sht = ActiveSheet\nSet StartCell = ActiveCell\n\nActiveCell.Columns(\"A:A\").EntireColumn.Select\nLastRow = sht.Cells(sht.Rows.Count, StartCell.Column).End(xlUp).Row\nLastColumn = sht.Cells(StartCell.Row, sht.Columns.Count).End(xlToLeft).Column\nActiveSheet.Sort.SortFields.Clear\nActiveSheet.Sort.SortFields.Add Key:= _\n    ActiveCell, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveSheet.Sort\n    .SetRange ActiveCell.Range(StartCell, sht.Cells(LastRow, LastColumn))\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\n\nEnd With\nMsgBox \"Action complete.\", vbInformation\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530120306, "post_id": 51068315, "comment_id": 89126566, "body": "<code>If...Then</code> is a control flow statement, it doesn&#39;t have an &quot;output&quot;. Can you clarify your title? As for awfulness, try <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenting</a> the function, should help ;-)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1530120779, "post_id": 51068315, "comment_id": 89126808, "body": "There&#39;s no such thing as <code>{Range}.String</code>. Invoke that function from the immediate pane (Ctrl+G), you&#39;ll get an actual VBA error. also note that a function meant to be invoked from a worksheet cell (i.e. a UDF) <b>cannot modify any other cells</b>, so <code>.ClearContents</code> can&#39;t be something the function does (not to mention <code>.ClearContents</code> isn&#39;t a function so that <code>Else</code> branch is assigning the return value to ...a method call, which won&#39;t compile."}, {"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "edited": false, "score": 0, "creation_date": 1530122119, "post_id": 51068315, "comment_id": 89127442, "body": "All of your If Statements except the last one end in <code>CONNECTOR1 = Connector</code> which is just returning the value of the Connector parameter you are inputing into the function."}, {"owner": {"reputation": 1, "user_id": 10001236, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_chne6SwKF0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3LJTEsOWldvDreVMasHYRltbgRew/mo/photo.jpg?sz=128", "display_name": "Curt Kronback", "link": "https://stackoverflow.com/users/10001236/curt-kronback"}, "edited": false, "score": 0, "creation_date": 1530124307, "post_id": 51068315, "comment_id": 89128518, "body": "I want the If, then, to return the value of Connector if the conditions are met. What I want is for the function to output the Connector variable if any of the sets of conditions are met. I don&#39;t know how to accomplish that. Thank you all for your comments!"}], "owner": {"reputation": 1, "user_id": 10001236, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_chne6SwKF0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3LJTEsOWldvDreVMasHYRltbgRew/mo/photo.jpg?sz=128", "display_name": "Curt Kronback", "link": "https://stackoverflow.com/users/10001236/curt-kronback"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530120474, "creation_date": 1530120033, "last_edit_date": 1530120474, "question_id": 51068315, "link": "https://stackoverflow.com/questions/51068315/how-do-i-make-a-vba-function-output-the-result-of-an-if-then-statement-to-a-cel", "title": "How do I make a VBA function output the result of an If, then statement to a cell?", "body": "<p>This is my first time ever doing any coding, so I am sorry if it is awful and could be much better. My problem is that I just get a #VALUE error in the cell when I try to use this function and I do not know why.\nThe program is supposed to take whichever information that the user inputs and decide whether or not this specific connector will work for the designated inputs. Whether the connector works is based on which cables can be used and the type of connector input by the user.</p>\n\n<pre><code>Function CONNECTOR1(Cable As Double, Connector As String, Row As Double) As String\n    CableI = Worksheets(\"Sheet1\").Range(\"A4\").String\n    ConnectorI = Worksheets(\"Sheet1\").Range(\"B4\").String\n    MaxdBLossI = Worksheets(\"Sheet1\").Range(\"D4\").Value\n    ConnectorTypeI = Worksheets(\"Sheet1\").Range(\"E4\").String\n    If IsEmpty(CableI) = True And IsEmpty(ConnectorI) = True And Not IsEmpty(MaxdBLossI) And Not IsEmpty(ConnectorTypeI) Then\n        If ConnectorTypeI = Worksheets(\"Sheet1\").Range(\"I\" &amp; Row).Value And Application.WorksheetFunction.CountIf(Range(\"N3:N500\"), Cable) Then\n            CONNECTOR1 = Connector\n        End If\n    ElseIf IsEmpty(ConnectorTypeI) = True And CableI = Cable Then\n        CONNECTOR1 = Connector\n    ElseIf CableI = \"\" Then\n        If Application.WorksheetFunction.CountIf(Range(\"N3:N500\"), Cable) Then\n            CONNECTOR1 = Connector\n        End If\n    ElseIf ConnectorTypeI = Worksheets(\"Sheet1\").Range(\"I\" &amp; Row).Value And CableI = Cable Then\n        CONNECTOR1 = Connector\n    Else\n        CONNECTOR1 = Worksheets(\"Sheet2\").Range(\"O\" &amp; Row).ClearContents\n    End If\nEnd Function\n'The goal of this code is for it to decide based on which inputs the user has given, if a certain connector will satisfy the criteria\n'Connectors only work for a specific number of cables, so this set of code is only for a connector that works with one cable\n'CableI is a cable part number input by the user\n'ConnectorI is a connector part number input by the user\n'MaxdBLossI is an input amount of acceptable signal loss\n'ConnectorTypeI is an input for the specific type of connector needed`\n</code></pre>\n"}, {"tags": ["excel", "combobox", "vba"], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1530124634, "post_id": 51068946, "comment_id": 89128679, "body": "Hi Stew! Thank you so much for your response. This might be close, but let me explain more about what I am trying to do: The combo box is to select a material. The cells in range Location_C18 tell how much of each material is located in that space (warehouse management) ... The location C18 can only hold one type of material, so if the user decides to change it, they must verify, because it will clear the cells; but if they say no, I actually dont want to change it, the combobox should not change, it should display the material value that was there before they tried to change it."}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1530124757, "post_id": 51068946, "comment_id": 89128738, "body": "The problem I run into is if they try to change the combobox to Material B (previously Material A) when they say &quot;No&quot; on the msgbox prompt, the number of materials doesnt change (which is good) but the combobox stays on Material B, when it should have reverted back to Material A."}, {"owner": {"reputation": 31, "user_id": 7263837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613c35be4b7ee14d6feef44d37a7b94c?s=128&d=identicon&r=PG&f=1", "display_name": "stew", "link": "https://stackoverflow.com/users/7263837/stew"}, "reply_to_user": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1530132901, "post_id": 51068946, "comment_id": 89132326, "body": "Okay, I think I am starting to follow.  Is the ComboBox an ActiveX object?"}, {"owner": {"reputation": 31, "user_id": 7263837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613c35be4b7ee14d6feef44d37a7b94c?s=128&d=identicon&r=PG&f=1", "display_name": "stew", "link": "https://stackoverflow.com/users/7263837/stew"}, "reply_to_user": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1530132946, "post_id": 51068946, "comment_id": 89132342, "body": "And it sounds like the range you are working with to get the material counts is contingent on the selection made within the ComboBox right?"}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1530275069, "post_id": 51068946, "comment_id": 89190481, "body": "Hey stew- it is an ActiveX object. And yes, the range is contingent on the selection of that combobox. I appreciate your follow up!"}], "tags": [], "owner": {"reputation": 31, "user_id": 7263837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613c35be4b7ee14d6feef44d37a7b94c?s=128&d=identicon&r=PG&f=1", "display_name": "stew", "link": "https://stackoverflow.com/users/7263837/stew"}, "is_accepted": false, "score": 0, "last_activity_date": 1530125059, "last_edit_date": 1530125059, "creation_date": 1530122673, "answer_id": 51068946, "question_id": 51067940, "link": "https://stackoverflow.com/questions/51067940/vba-undo-combobox-change/51068946#51068946", "title": "VBA - Undo ComboBox change", "body": "<p>I wasn't able to test this but I think this is close to what you are looking for.  Let me know if I am totally off base here:</p>\n\n<pre><code>Private Sub ComboBox_UPC_C18_Change()\n    Dim RngLocation     As Range\n    Dim PrevLocation    As String\n\n    Application.EnableEvents = False\n\n    PrevLocation = Range(\"Location_C18\").Value\n\n    If PrevLocation = \"\" Then\n        Range(\"Location_C18\").Value = ComboBox_UPC_C18.Value\n    Else\n        If MsgBox(\"Are you sure you want to change this?\", vbYesNo) = vbYes Then\n            Range(\"Location_C18\").Value = ComboBox_UPC_C18.Value\n        Else\n            ComboBox_UPC_C18.Value = PrevLocation\n        End If\n    End If\n\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530125059, "creation_date": 1530118495, "last_edit_date": 1531164843, "question_id": 51067940, "link": "https://stackoverflow.com/questions/51067940/vba-undo-combobox-change", "title": "VBA - Undo ComboBox change", "body": "<p>I cannot seem to get this code to work... I am trying to basically say, if the combo box changes and the range is not empty ask if the user really does want to clear the range and make the change. If they say no, then undo the combobox change back to what it was. My options for the Sub do not display a BeforeUpdate, only the Change and some others. </p>\n\n<p>I tried to capture the value beforehand and set it back to that, but it doesnt work.</p>\n\n<p>Any ideas welcome!!</p>\n\n<pre><code>Sub ComboBox_UPC_C18_Change()\n\n    Dim ComboBox_UPC_C18_Value As String\n\n    Dim Location As Range\n    Set Location = Range(\"Location_C18\")\n\n        If Application.WorksheetFunction.CountA(Location) = 0 Then\n\n            Exit Sub\n\n        ElseIf MsgBox(\"Are you sure you want change the UPC (clearing the row's data)?\", vbYesNo, \"User Confirmation\") = vbYes Then\n\n            Location.Value = \"\"\n\n        ElseIf MsgBox(\"Are you sure you want change the UPC (clearing the row's data)?\", vbYesNo, \"User Confirmation\") = vbNo Then\n\n            ComboBox_UPC_C18.Value = ComboBox_UPC_C18_Value\n            MsgBox (ComboBox_UPC_C18_Value)\n\n            Exit Sub\n\n        End If\n\n    ComboBox_UPC_C18_Value = ComboBox_UPC_C18.Value\n    MsgBox (ComboBox_UPC_C18_Value)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word", "mailmerge", "docx-mailmerge"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1530118518, "post_id": 51067899, "comment_id": 89125728, "body": "What&#39;s the table look like? Do it&#39;s dimensions vary?"}, {"owner": {"reputation": 45, "user_id": 4707025, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9423d944fbc890dae379cef116f91b10?s=128&d=identicon&r=PG&f=1", "display_name": "Riek Rudolph", "link": "https://stackoverflow.com/users/4707025/riek-rudolph"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1530118596, "post_id": 51067899, "comment_id": 89125763, "body": "It has a fixed number of 5 columns but the rows vary on how many items each customer bought."}], "answers": [{"tags": [], "owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "is_accepted": true, "score": 1, "last_activity_date": 1530129018, "creation_date": 1530129018, "answer_id": 51070403, "question_id": 51067899, "link": "https://stackoverflow.com/questions/51067899/vba-table-in-merged-letter/51070403#51070403", "title": "VBA Table in Merged Letter", "body": "<p>If you're creating Word documents from a template (that's generally the easiest way I've found to do it), you can add a table to the template document with the header rows you need, and 1 blank row for the data. Then, after populating the basic mergefields, you could loop through the current customer fields, adding new rows to the Word table as you went. Something like this:</p>\n\n<pre><code>Dim exWs as Excel.Worksheet\nDim CurrentCustomerFirstCell as Excel.Range\nDim CurrentCustomerActiveCell as Excel.Range\nDim EmpRowOffset as integer\nDim wdDoc as Word.Document\nDim wdTable as Word.Table, wdCell as Word.Cell\n\n' set up your existing references, including (I assume) to the Word document you're updating\n\nset exWs = exWb.Sheets(\"Table1\")\n\n' initialize row for current employee\nCurrentCustomerFirstCell = exWs.Cells(2,1)\n\ndo while CurrentCustomerFirstCell.Row &lt;= noData ' consider renaming noData to somthing like \"numberOfRows\"\n    ' populate basic mergefields\n    wdDoc.Fields(1).Result.Text = CurrentCustomerFirstCell.Value\n    ' etc.\n\n    ' populate table in Word document\n    set wdTable = wdDoc.Tables(1)\n\n    EmpRowOffset = 0\n    set CurrentCustomerActiveCell = CurrentCustomerFirstCell.Offset(Rowoffset:=EmpRowOffset)\n\n    set wdTable = wdDoc.Tables(1)\n\n    do while CurrentCustomerActiveCell.Value = CurrentCustomerFirstCell.Value\n        ' this code would update the first \"data\" row in the existing Word table\n        ' to the 6th column of the active employee row\n        set wdCell = wdTable.Cell(Row:=2 + EmpRowOffset, Column:=1)\n        wdCell.Range.Text = _\n                CurrentCustomerActiveCell.Offset(columnoffset:=5).Value\n        wdTable.Rows.Add\n\n        EmpRowOffset = EmpRowOffset + 1\n        set CurrentCustomerActiveCell = CurrentCustomerFirstCell.Offset(RowOffset:=EmpRowOffset)\n    Loop\n\n    ' now that we're finished processing the employee, update CurrentCustomerFirstCell\n    set CurrentCustomerFirstCell = CurrentCustomerActiveCell\nloop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 1, "last_activity_date": 1530161573, "creation_date": 1530161573, "answer_id": 51074927, "question_id": 51067899, "link": "https://stackoverflow.com/questions/51067899/vba-table-in-merged-letter/51074927#51074927", "title": "VBA Table in Merged Letter", "body": "<p>You can use Word's Catalogue/Directory Mailmerge facility for this (the terminology depends on the Word version). To see how to do so with any mailmerge data source supported by Word, check out my <strong>Microsoft Word Catalogue/Directory Mailmerge Tutorial</strong> at:</p>\n\n<p><a href=\"http://www.msofficeforums.com/mail-merge/38721-microsoft-word-catalogue-directory-mailmerge-tutorial.html\" rel=\"nofollow noreferrer\">http://www.msofficeforums.com/mail-merge/38721-microsoft-word-catalogue-directory-mailmerge-tutorial.html</a> </p>\n\n<p>or:</p>\n\n<p><a href=\"http://www.gmayor.com/Zips/Catalogue%20Mailmerge.zip\" rel=\"nofollow noreferrer\">http://www.gmayor.com/Zips/Catalogue%20Mailmerge.zip</a></p>\n\n<p>The tutorial covers everything from list creation to the insertion &amp; calculation of values in multi-record tables in letters. Do read the tutorial before trying to use the mailmerge document included with it.</p>\n\n<p>Depending on what you're trying to achieve, the field coding for this can be complex. However, since the tutorial document includes working field codes for all of its examples, most of the hard work has already been done for you - you should be able to do little more than copy/paste the relevant field codes into your own mailmerge main document, substitute/insert  your own field names and adjust the formatting to get the results you desire. For some worked examples, see the attachments to the posts at:</p>\n\n<p><a href=\"http://www.msofficeforums.com/mail-merge/9180-mail-merge-duplicate-names-but-different-dollar.html#post23345\" rel=\"nofollow noreferrer\">http://www.msofficeforums.com/mail-merge/9180-mail-merge-duplicate-names-but-different-dollar.html#post23345</a></p>\n\n<p><a href=\"http://www.msofficeforums.com/mail-merge/11436-access-word-creating-list-multiple-records.html#post30327\" rel=\"nofollow noreferrer\">http://www.msofficeforums.com/mail-merge/11436-access-word-creating-list-multiple-records.html#post30327</a> </p>\n\n<p>Another option would be to use a DATABASE field in a normal \u2018letter\u2019 mailmerge main document and a macro to drive the process. An outline of this approach can be found at: </p>\n\n<p><a href=\"http://answers.microsoft.com/en-us/office/forum/office_2010-word/many-to-one-email-merge-using-tables/8bce1798-fbe8-41f9-a121-1996c14dca5d\" rel=\"nofollow noreferrer\">http://answers.microsoft.com/en-us/office/forum/office_2010-word/many-to-one-email-merge-using-tables/8bce1798-fbe8-41f9-a121-1996c14dca5d</a></p>\n\n<p>Conversely, if you're using a relational database or, Excel workbook with a separate table with just a single instance of each of the grouping criteria, a DATABASE field in a normal \u2018letter\u2019 mailmerge main document could be used without the need for a macro. An outline of this approach can be found at:</p>\n\n<p><a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_word-mso_winother-mso_2010/mail-merge-to-a-word-table-on-a-single-page/4edb4654-27e0-47d2-bd5f-8642e46fa103\" rel=\"nofollow noreferrer\">https://answers.microsoft.com/en-us/msoffice/forum/msoffice_word-mso_winother-mso_2010/mail-merge-to-a-word-table-on-a-single-page/4edb4654-27e0-47d2-bd5f-8642e46fa103</a> </p>\n\n<p>For a working example, see:</p>\n\n<p><a href=\"http://www.msofficeforums.com/mail-merge/37844-mail-merge-using-one-excel-file-multiple.html\" rel=\"nofollow noreferrer\">http://www.msofficeforums.com/mail-merge/37844-mail-merge-using-one-excel-file-multiple.html</a></p>\n\n<p>Alternatively, you may want to try one of the Many-to-One Mail Merge add-ins, from:</p>\n\n<p>Graham Mayor at <a href=\"http://www.gmayor.com/ManyToOne.htm\" rel=\"nofollow noreferrer\">http://www.gmayor.com/ManyToOne.htm</a>; or</p>\n\n<p>Doug Robbins at <a href=\"https://onedrive.live.com/?cid=5AEDCB43615E886B&amp;id=5AEDCB43615E886B!566\" rel=\"nofollow noreferrer\">https://onedrive.live.com/?cid=5AEDCB43615E886B&amp;id=5AEDCB43615E886B!566</a></p>\n"}], "owner": {"reputation": 45, "user_id": 4707025, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9423d944fbc890dae379cef116f91b10?s=128&d=identicon&r=PG&f=1", "display_name": "Riek Rudolph", "link": "https://stackoverflow.com/users/4707025/riek-rudolph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 921, "favorite_count": 1, "accepted_answer_id": 51070403, "answer_count": 2, "score": 0, "last_activity_date": 1530161573, "creation_date": 1530118309, "last_edit_date": 1592644375, "question_id": 51067899, "link": "https://stackoverflow.com/questions/51067899/vba-table-in-merged-letter", "title": "VBA Table in Merged Letter", "body": "<p>I have an Excel Sheet with a lot of customer Data. All customers have common data (address, name etc.) that I implemented as simple mergefields. Some Customers have multiple Datasets that should be added as a Table at the end of the merged letter.\nTo find the Data from my excel Sheet I already came up with the following code.\nnoInt is the number of customers while noData is the number of different datasets (all customers together, some multiples). exWb is the excel workbook my data comes from and the data I want to display in the table lays in columns 5 to 9.</p>\n<pre><code>For i = 2 To noInt\n    \n    For k = 2 To noData\n        \n        If exWb.Sheets(&quot;Table1&quot;).Cells(k, 1) = exWb.Sheets(&quot;Table2&quot;).Cells(i, 1) Then\n            For j = 5 To 9\n            \n</code></pre>\n<p>Insert into Table exWb.Sheets(&quot;Table1&quot;).Cells(k, j)</p>\n<pre><code>            Next j\n        End If\n    Next k\nNext i\n</code></pre>\n<p>Now my questions:</p>\n<ol>\n<li><p>How can I insert this data into a newly created table after the placeholder &quot;insert_table_here&quot;?</p>\n</li>\n<li><p>How can I make sure that for every letterin the mail merge series there is only the data of the customer the letter is about included in this table?</p>\n<p>To find a solution to this, I already thought about if there was maybe a function that gives the current &quot;Mail Merge Number&quot;. In that case I could compare the field (MailMergeNumber, 1) with (k,1) to only show the results that include the current customer.</p>\n</li>\n</ol>\n<p>Example to make it more understandable:</p>\n<p>Dear Mr A,</p>\n<p>...</p>\n<p>Table of items Mr. A bought</p>\n<p>-End of document-</p>\n<p>Dear Mr. B,</p>\n<p>...</p>\n<p>Table of items Mr. B bought</p>\n<p>-End of document-</p>\n<p>And so on...</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530118278, "post_id": 51067840, "comment_id": 89125592, "body": "Where&#39;s <code>Delcolumnbreaks</code> defined? In a standard procedural module? Is it <code>Public</code>? Try qualifying it with the module name, e.g. <code>Module1.Delcolumnbreaks</code>. If the macro is written in a document module, or in some class module, then it&#39;s not a macro. Move it to a standard module."}, {"owner": {"reputation": 59, "user_id": 9973122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3436823e20785f2347cf2f7e7891d63f?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cole", "link": "https://stackoverflow.com/users/9973122/b-cole"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530119000, "post_id": 51067840, "comment_id": 89125946, "body": "I tried running with module1.delcolumbreaks but that did not work either.I have it under Normal in project in word....i am not sure the reference to standard module, but im a beginner"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530119038, "post_id": 51067840, "comment_id": 89125968, "body": "Okay but give us something now - your question is unanswerable without knowing where the macro is written in, what it&#39;s called, and how accessible it is."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1530119398, "post_id": 51067840, "comment_id": 89126133, "body": "&quot;I have it under Normal in project in word&quot; - see <i>that</i> is <i>the</i> critical piece of information that&#39;s missing from your post (you should <a href=\"https://stackoverflow.com/posts/51067840/edit\">edit</a> your question to include this information). <code>Normal.dot</code> is just a document template that Word opens at start-up, <i>it&#39;s not the document you&#39;re opening</i>. It&#39;s also a document module, i.e. an object, which isn&#39;t where a macro is written in. Right-click the project, add module (.bas), cut the procedure from Normal and paste it in that module, then save."}, {"owner": {"reputation": 59, "user_id": 9973122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3436823e20785f2347cf2f7e7891d63f?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cole", "link": "https://stackoverflow.com/users/9973122/b-cole"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530120454, "post_id": 51067840, "comment_id": 89126638, "body": "ok, thank you. I will update"}, {"owner": {"reputation": 59, "user_id": 9973122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3436823e20785f2347cf2f7e7891d63f?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cole", "link": "https://stackoverflow.com/users/9973122/b-cole"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530120796, "post_id": 51067840, "comment_id": 89126817, "body": "in addition, this document is huge. Is there a way to only execute this macro after the word file has finished opening?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530120928, "post_id": 51067840, "comment_id": 89126885, "body": "VBA code runs synchronously. The instruction that follows the opening of the document will run after the <code>Open</code> method has returned. That said, Your code gets a filename to open, but doesn&#39;t <i>actually</i> open the selected file."}, {"owner": {"reputation": 59, "user_id": 9973122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3436823e20785f2347cf2f7e7891d63f?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cole", "link": "https://stackoverflow.com/users/9973122/b-cole"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530121113, "post_id": 51067840, "comment_id": 89126958, "body": "Ah I see, so the code has already &quot;ran&quot; before I actually open the file? The reason I have it where I can select the file to open and then run the script, is because the filename will never be the same, so I can&#39;t hard code that in"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530121186, "post_id": 51067840, "comment_id": 89126989, "body": "Yes I know that. What I&#39;m saying is that <code>GetOpenFileName</code> prompts for a filename, but doesn&#39;t <i>open</i> the file. There&#39;s no instruction in your code that <i>opens the file</i> - so even if the macro existed in that file, Word couldn&#39;t run it, because the host document isn&#39;t even open"}, {"owner": {"reputation": 59, "user_id": 9973122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3436823e20785f2347cf2f7e7891d63f?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cole", "link": "https://stackoverflow.com/users/9973122/b-cole"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530121415, "post_id": 51067840, "comment_id": 89127100, "body": "Gotcha. Can you advise on how to fix this disconnect?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530121509, "post_id": 51067840, "comment_id": 89127151, "body": "You need <code>WordApp.Open wdFileName</code> somewhere between the part that prompts for a filename (and heck, validate if it&#39;s a valid one, too!), and the part that attempts to run the macro."}, {"owner": {"reputation": 59, "user_id": 9973122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3436823e20785f2347cf2f7e7891d63f?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cole", "link": "https://stackoverflow.com/users/9973122/b-cole"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530121818, "post_id": 51067840, "comment_id": 89127296, "body": "Got it. Thanks for the help!"}], "owner": {"reputation": 59, "user_id": 9973122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3436823e20785f2347cf2f7e7891d63f?s=128&d=identicon&r=PG&f=1", "display_name": "B.Cole", "link": "https://stackoverflow.com/users/9973122/b-cole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 638, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1530130558, "creation_date": 1530118083, "last_edit_date": 1530130558, "question_id": 51067840, "link": "https://stackoverflow.com/questions/51067840/cant-execute-word-macro-from-excel", "title": "Can&#39;t execute word macro from excel", "body": "<p>I simply cannot get this to work. I am trying to run a word Macro from excel (before importing a table). Here is the code:</p>\n\n<pre><code>Option Explicit\n\nSub RunWdMacro()\n\n  Dim WordApp As Word.Application\n  Dim WordDoc As Word.Document\n  Dim wdFileName As Variant\n  Set WordApp = CreateObject(\"Word.Application\")\n\n  wdFileName = Application.GetOpenFilename(\"Word files ,*.doc;*.docx;*.docm\", , _\n    \"Browse for file containing table to be imported\")\n  WordApp.Visible = True\n  'change TEST to the name of your macro in word\n  WordApp.Run \"Delcolumnbreaks\"\n\n  WordApp.Quit SaveChanges:=wdDoNotSaveChanges\n  Set WordApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>I am prompting for a word file to open, but it errors out at:</p>\n\n<pre><code> WordApp.Run \"Delcolumnbreaks\"\n</code></pre>\n\n<p>With error \"Run-time error '-2147352573 (800200003) Can't run the specified macro. The macro is in the normal section as module 1</p>\n\n<p>Any thoughts?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1530118095, "post_id": 51067787, "comment_id": 89125494, "body": "<a href=\"https://www.rondebruin.nl/win/s3/win026.htm\" rel=\"nofollow noreferrer\"><code>FileCopy &quot;C:\\source\\...&quot;, &quot;D:\\destination&quot;</code></a>"}, {"owner": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1530118249, "post_id": 51067787, "comment_id": 89125569, "body": "Nope... this will not help... As the file is created at run time and the filename of the new file can be different each time the macro is run."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1530118727, "post_id": 51067787, "comment_id": 89125823, "body": "you would just change the <code>&quot;D:\\destination...&quot;</code> to <code>filename</code> to copy the file. Then you would say <code>Kill &quot;C:\\source\\...&quot;</code> to effectively &quot;move&quot; it. However, if you click on my first comment it is a link to a site with several functions you can use - one of which is named <code>Move_Certain_Files_To_New_Folder()</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1530118985, "post_id": 51067787, "comment_id": 89125935, "body": "Doesn&#39;t your code know what the file name is?"}, {"owner": {"reputation": 154, "user_id": 1571939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ALT2O.png?s=128&g=1", "display_name": "LittleBoxOfSunshine", "link": "https://stackoverflow.com/users/1571939/littleboxofsunshine"}, "edited": false, "score": 0, "creation_date": 1530119077, "post_id": 51067787, "comment_id": 89125991, "body": "If you know the folder the macro will dump the file into, you could determine its name by finding the most recently created file in that folder. See <a href=\"https://stackoverflow.com/questions/25490868/finding-latest-file-in-a-folder-and-opening-it-vba-access\">this question</a> for an example of determining the most recently created file in VBA. It&#39;s a less than ideal solution but if you can&#39;t change the legacy macro it should be a reasonable workaround."}, {"owner": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "edited": false, "score": 0, "creation_date": 1530129411, "post_id": 51067787, "comment_id": 89130800, "body": "Hi Chris, I tried the second code in the link you provided and its is giving error &quot;Overflow&quot;. I replaced &#39;~&#39; with a valid name."}], "owner": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530117917, "creation_date": 1530117917, "question_id": 51067787, "link": "https://stackoverflow.com/questions/51067787/move-a-file-created-by-a-macro", "title": "Move a file created by a macro", "body": "<p>I have a macro file, which on opening will create a file and save it in a folder.</p>\n\n<p>I have created another macro to open the above macro file.</p>\n\n<p>My question here is to move the file created by the above macro to a different folder.</p>\n\n<p>Please help.</p>\n\n<p>Below is my code:</p>\n\n<pre><code>    Sub fcr_macro()\n\n    Dim wb As Workbook\n    Dim clname, compname As String\n    clname = Range(\"D2\").Value\n    compname = Range(\"D3\").Value\n    Set wb = Workbooks.Open(filename)\n\n    wb.Close\n    End Sub\n</code></pre>\n\n<p>Just to give a little more description:</p>\n\n<p>the codeline: </p>\n\n<pre><code>    Set wb = Workbooks.Open(filename) \n</code></pre>\n\n<p>will open a file that contains a macro. And this macro will create a file in a folder.</p>\n\n<p>I want this file created by above macro to be moved to a destination folder. And I want this to be accomplished in the above code.</p>\n\n<p>Please Note: The macro that runs upon file open cant be changed due to some issues.</p>\n\n<p>Could you please throw some light on this</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ms-access", "if-statement", "vba", "with-statement", "user-defined-types"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1530117761, "post_id": 51067401, "comment_id": 89125346, "body": "You should show your research, including your errors."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1530118721, "post_id": 51067401, "comment_id": 89125820, "body": "@jdv I don&#39;t understand that comment. <i>I get a compiler error that says Else without if</i> is an acceptable way to describe an error imo. The only thing I miss is the line causing the error, but that&#39;s not always present with compile errors. The question is well-asked in my opinion."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1530121506, "post_id": 51067401, "comment_id": 89127150, "body": "Show, don&#39;t tell. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. There are reasons we like to see what you have tried, and what results you get. Do you really think a sentence fragment describing an  error message is clear enough? Because it is not."}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 2, "last_activity_date": 1530116763, "creation_date": 1530116763, "answer_id": 51067490, "question_id": 51067401, "link": "https://stackoverflow.com/questions/51067401/vba-nested-with-statements-within-if-statements/51067490#51067490", "title": "VBA - Nested &quot;With Statements&quot; within &quot;IF Statements&quot;", "body": "<p>You can't work with <code>With</code> that way. The compiler doesn't allow this kind of conditionally nested code. Not with <code>With</code>, not with <code>For</code>, not with anything else.</p>\n\n<p>You can, however, use a variable to determine which value you're going to use in your with:</p>\n\n<pre><code>Sub QuestionableCode()\n    Dim UDT(0 To 0) as MyType\n    Dim State as String\n    ReDim Preserve UDT(0).X(0 to 0) as MyOtherType\n    ReDim Preserve UDT(0).Y(0 to 0) as MyOtherType\n    ReDim Preserve UDT(0).Z(0 to 0) as MyOtherType\n\n    State = \"B\"\n    Dim myWithVariable\n    If State = \"A\" Then\n        myWithVariable = UDT(0).X(0)\n    ElseIf State = \"B\" Then\n        myWithVariable = UDT(0).Y(0)\n    Else \n        myWithVariable = UDT(0).Z(0)\n    End If\n    With myWithVariable \n        .Name = \"George\"\n        .Age = 30\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10000671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6c158ecc67f65c2098b9aca7d25b55?s=128&d=identicon&r=PG&f=1", "display_name": "JustinAndrews", "link": "https://stackoverflow.com/users/10000671/justinandrews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 988, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1594632590, "creation_date": 1530116434, "last_edit_date": 1594632590, "question_id": 51067401, "link": "https://stackoverflow.com/questions/51067401/vba-nested-with-statements-within-if-statements", "title": "VBA - Nested &quot;With Statements&quot; within &quot;IF Statements&quot;", "body": "<p>Language: VBA - MS Access</p>\n\n<p>I am using User-Defined-Types (UDT) within my code.\nI would like to be able determine which section of the UDT i'm loading data into based on a state variable.  My first attempt was to use \"With\" statements nested into an \"IF\" statement.  This doesn't work (I get a compiler error that says Else without if).  Is there a way to make this work? or another way of going about using a state variable to determine which section of the UDT i'm loading?</p>\n\n<pre><code>Type MyOtherType\n    Name as String\n    Age as Integer    \nEnd Type\n\nType MyType\n    aMyOtherType() as MyOtherType\n    X as Integer\n    Y as Integer\n    Z as Integer  \nEnd Type\n\nSub QuestionableCode()\nDim UDT(0 To 0) as MyType\nDim State as String\nReDim Preserve UDT(0).X(0 to 0) as MyOtherType\nReDim Preserve UDT(0).Y(0 to 0) as MyOtherType\nReDim Preserve UDT(0).Z(0 to 0) as MyOtherType\n\n    State = \"B\"\n\n    If State = \"A\" Then\n        With UDT(0).X(0)\n    ElseIf State = \"B\" Then\n        With UDT(0).Y(0)\n    Else \n        With UDT(0).Z(0)\n    End If\n            .Name = \"George\"\n            .Age = 30\n        End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1530116188, "post_id": 51067171, "comment_id": 89124490, "body": "care to share what isnt working exactly?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1530116266, "post_id": 51067171, "comment_id": 89124530, "body": "What is your question? Please describe at least what you want to archive with the code. And I don&#39;t really understand why it should be hard to make one routine out of it."}, {"owner": {"reputation": 3, "user_id": 10000989, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mw1p2DlozOE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2fpOnBF3RBU_AWQ-IJid9cyrZnGA/mo/photo.jpg?sz=128", "display_name": "Diogo Melo", "link": "https://stackoverflow.com/users/10000989/diogo-melo"}, "edited": false, "score": 0, "creation_date": 1530116308, "post_id": 51067171, "comment_id": 89124557, "body": "My 1st code works but 2nd code is not working, i have tried numerous ways to combine but to no avail."}, {"owner": {"reputation": 3, "user_id": 10000989, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mw1p2DlozOE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2fpOnBF3RBU_AWQ-IJid9cyrZnGA/mo/photo.jpg?sz=128", "display_name": "Diogo Melo", "link": "https://stackoverflow.com/users/10000989/diogo-melo"}, "edited": false, "score": 0, "creation_date": 1530116538, "post_id": 51067171, "comment_id": 89124696, "body": "I am new to VBA, sorry if my question was unclear. I understand there cannot be 2 Worksheet_Change in the same procedure, so i tried to combine it into one, however the 2nd code is not picking up anything."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530116856, "post_id": 51067386, "comment_id": 89124887, "body": "Upvoted, but the infinite loop would be caused by <code>Application.EnableEvents</code> being toggled on and <code>Worksheet_Change</code> re-entering when a cell is modified. Disabling alerts won&#39;t fix that ;-)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530117598, "post_id": 51067386, "comment_id": 89125263, "body": "AGH brain lag on my part. thats what I meant* updating"}, {"owner": {"reputation": 3, "user_id": 10000989, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mw1p2DlozOE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2fpOnBF3RBU_AWQ-IJid9cyrZnGA/mo/photo.jpg?sz=128", "display_name": "Diogo Melo", "link": "https://stackoverflow.com/users/10000989/diogo-melo"}, "edited": false, "score": 0, "creation_date": 1530117763, "post_id": 51067386, "comment_id": 89125351, "body": "Thank you both, much appreciated!"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1530117632, "last_edit_date": 1530117632, "creation_date": 1530116384, "answer_id": 51067386, "question_id": 51067171, "link": "https://stackoverflow.com/questions/51067171/vba-private-sub-worksheet-change/51067386#51067386", "title": "#VBA Private Sub Worksheet_Change", "body": "<p>You can try this as a combined method: </p>\n\n<p>You need do disable alerts when making changes while you have a worksheet_change event loaded on a macro, else you may find yourself in a infinite loop. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"A:A\")) Is Nothing Or Target.Column &lt;&gt; 12 Then Exit Sub\n\n    If Len(Target) = 10 Then\n        Application.EnableEvents = False\n            Range(Cells(Target.Row, \"I\"), Cells(Target.Row, \"K\")) = \"N\"\n            Range(\"M\" &amp; Target.Row) = \"N\"\n        Application.EnableEvents = True\n    End If\n\n    If Target.Column = 12 And Target.Value = \"Y\" Then\n        Application.EnableEvents = False\n            Target.Offset(0, 1) = Date\n        Application.EnableEvents = True\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1530117773, "post_id": 51067585, "comment_id": 89125358, "body": "Excellent. Only thing missing is some error-handling, so that if <code>.Value</code> contains an error value, when e.g. <code>If .Value = &quot;Y&quot; Then</code> throws a <i>type mismatch</i> error and execution exits abruptly, leaving <code>Application.EnableEvents</code> toggled off."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1530173355, "last_edit_date": 1530173355, "creation_date": 1530117144, "answer_id": 51067585, "question_id": 51067171, "link": "https://stackoverflow.com/questions/51067171/vba-private-sub-worksheet-change/51067585#51067585", "title": "#VBA Private Sub Worksheet_Change", "body": "<p>You could use the code below.<br>\nDisable events to stop the Change event firing when you update the values in columns <code>I:K</code> &amp; <code>N</code>. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    On Error GoTo ERR_HANDLE\n\n    Application.EnableEvents = False\n\n    With Target\n\n        If .Column = 12 Then\n            If .Value = \"Y\" Then\n                .Offset(, 1) = Date\n            End If\n        ElseIf .Column = 1 Then\n            If Len(.Value) = 10 Then\n                Cells(.Row, 9).Resize(, 3) = \"N\" 'Column I:K\n                Cells(.Row, 13) = \"N\" 'Column M\n            End If\n        End If\n\n    End With\n\nEXIT_PROC:\n\n    Application.EnableEvents = True\n    On Error GoTo 0\n\nExit Sub\n\nERR_HANDLE:\n    Select Case Err.Number\n        Case 13 'Type mismatch.\n            Resume EXIT_PROC\n        Case Else 'Any unhandled errors.\n            MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n                Err.Description, vbOKOnly, \"Error in \" &amp; ThisWorkbook.Name\n            Resume EXIT_PROC\n    End Select\nEnd Sub\n</code></pre>\n\n<p><strong>Edit after accepted:</strong><br>\nI've added an error handler to the code at the suggestion of @MathieuGuindon.  After dealing with the error the code jumps back to the <code>EXIT_PROC</code> label so there's only a single exit point to the procedure.</p>\n"}], "owner": {"reputation": 3, "user_id": 10000989, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mw1p2DlozOE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2fpOnBF3RBU_AWQ-IJid9cyrZnGA/mo/photo.jpg?sz=128", "display_name": "Diogo Melo", "link": "https://stackoverflow.com/users/10000989/diogo-melo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 51067585, "answer_count": 2, "score": -1, "last_activity_date": 1530173355, "creation_date": 1530115553, "last_edit_date": 1530116780, "question_id": 51067171, "link": "https://stackoverflow.com/questions/51067171/vba-private-sub-worksheet-change", "title": "#VBA Private Sub Worksheet_Change", "body": "<p>Could any kind soul help me, I have spent a considerable amount of time searching and trying to get these 2 pieces of code to work, but couldn't.</p>\n\n<p>Is there any way I can combine these 2 snippets? They serve two different purposes.</p>\n\n<p>1.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"A:A\")) Is Nothing Then Exit Sub\n    If Len(Target) = 10 Then\n        Range(\"I\" &amp; Target.Row &amp; \":J\" &amp; Target.Row &amp; \", K\" &amp; Target.Row &amp; \", M\" &amp; Target.Row) = \"N\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 12 And Target.Value = \"Y\" Then\n        Target.Offset(0, 1) = Date\n    End If\nEnd Sub\n</code></pre>\n\n<p>I am at a loss....</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "edited": false, "score": 0, "creation_date": 1530287729, "post_id": 51096174, "comment_id": 89198066, "body": "are you sure that the filtering is really the problem though? I ask that only because my understanding of my code is that the filter is applied once before any items are moved, not reapplied after each move. When I watch this run, items start to be moved immediately. its just that there is time between item 1....then 2....then 3. Sometimes 2 or 3 seconds between each. So I think the slowness is happening during the item.move and not the filtering....maybe"}, {"owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "edited": false, "score": 0, "creation_date": 1530287791, "post_id": 51096174, "comment_id": 89198097, "body": "But if I manually select all the items and drop them in the subfolder, it takes like 3 seconds to move all 200+, but it would take like 5 minutes for the code to do it all."}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "reply_to_user": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "edited": false, "score": 0, "creation_date": 1530290889, "post_id": 51096174, "comment_id": 89199524, "body": "@TBoulz In that case I misunderstood where your code was lagging. I thought it was the whole process not only the moving part. Please note, though, that filtering is always slow anyway. I\u2019ll edit my answer if something comes to mind, that you could try!"}, {"owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "edited": false, "score": 0, "creation_date": 1530297268, "post_id": 51096174, "comment_id": 89202205, "body": "thanks for taking a look, I put a debug timer in, and really nothing seems to take that long. filter was 1 sec. Moving each item was under a second, sometimes took a little more. Main issue is that sometimes when moving the item, it gets hungup and takes 2 or 3 seconds. Then after moving about 40 emails it seems to completely freeze. Even without the hangups and freezing, if it continue at 1 second per item that is still really slow considering I can drag and drop 200 items and it takes probably less than 2 seconds. Frustrating that it is so much quicker manually"}, {"owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "edited": false, "score": 0, "creation_date": 1530297356, "post_id": 51096174, "comment_id": 89202236, "body": "is there a way, in Outlook, to select the first email showing from a date, and then select all the email items below it? like a shift+control+down function? it doesnt seem to work in outlook, but maybe something like that so i would only be doing 1 move, instead of 200+ moves."}], "tags": [], "owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "is_accepted": false, "score": 1, "last_activity_date": 1530256259, "creation_date": 1530256259, "answer_id": 51096174, "question_id": 51067106, "link": "https://stackoverflow.com/questions/51067106/can-i-speed-up-this-vba-to-move-emails/51096174#51096174", "title": "Can I Speed-Up This VBA to Move Emails?", "body": "<p>Instead of filtering your mails before you look at and move them, try simply looking at them and then deciding whether to move them or not.</p>\n\n<p>For example a simple for Loop like this could do the trick:</p>\n\n<pre><code>For Each item In Inbox.Items\n     If TypeOf item Is MailItem Then\n         If item.ReceivedTime &lt; Date And item.ReceivedTime &gt; Date - 1 Then\n             item.Move myNewFolder\n         End If\n     End If\n Next\n</code></pre>\n\n<p>Filtering something is incredibly slow.</p>\n\n<p>Note however that I am not 100% certain that <code>Date - 1</code> works for mails received shortly after midnight though.</p>\n"}], "owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592950254, "creation_date": 1530115293, "last_edit_date": 1592950254, "question_id": 51067106, "link": "https://stackoverflow.com/questions/51067106/can-i-speed-up-this-vba-to-move-emails", "title": "Can I Speed-Up This VBA to Move Emails?", "body": "<p>I have Outlook VBA that does exactly what I want it to do. It moves the previous workday's emails to a new folder, and it does this within a secondary email inbox. </p>\n\n<p>What I'm looking for is advice on how to make it move the emails faster. </p>\n\n<p>If I manually copied all the emails to another folder it would take a few seconds. When I run the code it takes minutes. Here is my code:</p>\n\n<pre><code>Option Explicit\n\nSub Move_Yesterdays_Emails()\n\n'***Creates a new folder named yesterdays date under the inbox***\n\n Dim myNameSpace As Outlook.NameSpace\n Dim strMailboxName As String\n Dim myFolder As Outlook.Folder\n Dim myNewFolder As Outlook.Folder\n Dim xDay As String\n Dim XDate As Date\n Dim thatDay As String\n strMailboxName = \"Deductions Backup\"\n\n\n    If Weekday(Now()) = vbMonday Then\n        XDate = Date - 3\n    Else\n        XDate = Date - 1\n    End If\n\n    thatDay = WeekdayName(Weekday(XDate))\n\n Set myNameSpace = Application.GetNamespace(\"MAPI\")\n Set myFolder = Session.Folders(strMailboxName)\n Set myFolder = myFolder.Folders(\"Inbox\")\n Set myNewFolder = myFolder.Folders.Add(XDate &amp; \" \" &amp; thatDay)\n\n'***Finds all emails in the inbox from yesterday and moves them to the created folder***\n\n    Dim Inbox As Outlook.MAPIFolder\n    Dim Items As Outlook.Items\n    Dim Item As Object\n    Dim Filter As String\n    Dim i As Long\n\n        Filter = \"[ReceivedTime] &gt;= '\" &amp; _\n              CStr(XDate) &amp; _\n             \" 12:00AM' AND [ReceivedTime] &lt; '\" &amp; _\n              CStr(XDate + 1) &amp; \" 12:00AM'\"\n\n        Debug.Print Filter\n\n    Set myNameSpace = Application.GetNamespace(\"MAPI\")\n    Set myFolder = Session.Folders(strMailboxName)\n    Set Inbox = myFolder.Folders(\"Inbox\")\n    Set Items = Inbox.Items.Restrict(Filter)\n        Items.Sort \"[ReceivedTime]\"\n\n    For i = Items.Count To 1 Step -1\n        DoEvents\n        If TypeOf Items(i) Is MailItem Then\n            Debug.Print Items(i)\n            Set Item = Items(i)\n            Item.Move myNewFolder\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Any idea why this is so much slower than manually moving the items, or how to make this run quicker? I don't see why it should take any longer than if it was being done manually.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1530115649, "post_id": 51067024, "comment_id": 89124205, "body": "<code>ActiveSheet.Range(&quot;B8&quot;).Value = repdata.Value</code>? If that doesn&#39;t work, <code>ActiveSheet.Range(&quot;B8&quot;).Resize</code> first, to match the destination number of rows, and assign the <code>.Value</code> of the resized range. <code>{Range}.Copy Destination:={target}</code>  works just like manual pasting: it pastes the values, the formats, the borders, the conditional formats, everything."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1530115967, "post_id": 51067024, "comment_id": 89124357, "body": "<i>&#39;This is not working. Its giving error&#39;</i> is not considered an actual error code nor an accurate description of the problem."}], "answers": [{"comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "edited": false, "score": 0, "creation_date": 1530117493, "post_id": 51067279, "comment_id": 89125208, "body": "@user3228901 No problem. Mark the answer as the &quot;Solution&quot;  then please, so the question will get closed in a sense."}], "tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": true, "score": 1, "last_activity_date": 1530115969, "creation_date": 1530115969, "answer_id": 51067279, "question_id": 51067024, "link": "https://stackoverflow.com/questions/51067024/paste-special-without-using-clipboard/51067279#51067279", "title": "Paste special without using clipboard", "body": "<p>It's hard to give you a definitive answer, because you didn't post your question with a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete and Verifiable Example</a> - should be something you should keep in mind in future questions.</p>\n\n<hr>\n\n<p>To answer your question, the axe most likely lies here - Don't use <code>Destination</code> with <code>PasteSpecial</code><br>\nThis should work fine, presuming everything else in your code is functional.</p>\n\n<pre><code>Dim repdata As Range\nDim wb1 as Workbook, wb2 As Workbook\n\nSet wb1 = Workbooks.Open(\"file name\")\nSet wb2 = Workbooks.Open(\"file2\")\nSet repdata = wb1.Range(\"A2\", Cells(lastrow, lastcol))\n\nrepdata.Copy\nwb2.Range(\"B8\").PasteSpecial xlPasteValues\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "edited": false, "score": 0, "creation_date": 1530117448, "post_id": 51067510, "comment_id": 89125187, "body": "Hi Jeeped... Thanks for your help. Will try this one as well for a different file."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1530116819, "creation_date": 1530116819, "answer_id": 51067510, "question_id": 51067024, "link": "https://stackoverflow.com/questions/51067024/paste-special-without-using-clipboard/51067510#51067510", "title": "Paste special without using clipboard", "body": "<p>This is an example of direct value transfer that will not affect the destination formatting.</p>\n\n<pre><code>dim wb as workbook, wb1 as workbook\nDim repdata As Range, lastrow as long, lastcol as long\n\nSet wb1 = Workbooks.Open(\"file name\")\n\nwith wb1.worksheets(\"sheet\")\n    lastrow = .cells(.rows.count, \"A\").end(xlup).row\n    lastcol = .cells(2, .columns.count).end(xltoleft).column\n\n    with .Range(.cells(2, \"A\"), .Cells(lastrow, lastcol))\n        Set wb = Workbooks.Open(\"file2\")\n        wb.worksheets(\"sheetx\").cells(8, \"B\").resize(.rows.count..columns.count) = .value\n    end with\nend with\n</code></pre>\n\n<p>It's not considered 'best practice' to rely on the activesheet property of a newly opened workbook. Reference your worksheets properly, even if that means using worksheets(1) for a single worksheet workbook.</p>\n"}], "owner": {"reputation": 9, "user_id": 3228901, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3aaadef38874dc9e726fb6fa06f8ea93?s=128&d=identicon&r=PG&f=1", "display_name": "user3228901", "link": "https://stackoverflow.com/users/3228901/user3228901"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 51067279, "answer_count": 2, "score": 1, "last_activity_date": 1530116819, "creation_date": 1530114992, "last_edit_date": 1530116163, "question_id": 51067024, "link": "https://stackoverflow.com/questions/51067024/paste-special-without-using-clipboard", "title": "Paste special without using clipboard", "body": "<p>I am trying to paste a range of data from one file to another. but this is affecting the format of the destination file. Request your help.</p>\n\n<p>Below is a part of the code that I am using:</p>\n\n<pre><code>    Dim repdata As Range\n\n    Set wb1 = Workbooks.Open(\"file name\")\n\n    Set repdata = Range(\"A2\", Cells(lastrow, lastcol))\n\n    Set wb = Workbooks.Open(\"file2\")\n\n    repdata.Copy Destination:=Range(\"B8\")\n</code></pre>\n\n<p>But this is overwriting the format in the destination.</p>\n\n<p>I tried : </p>\n\n<pre><code>    repdata.Copy Destination:=Range(\"B8\").PasteSpecial(xlPasteValues).\n</code></pre>\n\n<p>This is not working. Its giving error</p>\n\n<p>I also tried </p>\n\n<pre><code>    repdata.Copy Destination:=Range(\"B8\").PasteSpecial xlPasteValues. \n</code></pre>\n\n<p>Even this is not working. Its giving error</p>\n"}, {"tags": ["html", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 1, "creation_date": 1530117680, "post_id": 51067381, "comment_id": 89125309, "body": "Hey Gustavo, thanks for the quick reply.  To be more specific, I am trying to &quot;click&quot; a button on that downloads a csv file from a website.   Once I click the button &quot;run&quot; which queues the csv file to downloadable ,  a separate window pops up from which I need to click &quot;download.&quot; That&#39;s href is the only link I see when I inspect the element tied to the button &quot;download.&quot;   Apologies for any confusion and mix up in terminology as I am very new to this."}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 1, "creation_date": 1530118489, "post_id": 51067381, "comment_id": 89125714, "body": "Gustavo, thank you for your reply! I was actually able to resolve the issue by paying closer attention to the href text due to your suggestion.   I had the preceding portion of the link incorrect and therefore had duplicate &quot;/assistant...&quot; in the link."}], "tags": [], "owner": {"reputation": 156, "user_id": 9864710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jmzeI.jpg?s=128&g=1", "display_name": "Baccan", "link": "https://stackoverflow.com/users/9864710/baccan"}, "is_accepted": false, "score": 1, "last_activity_date": 1530116363, "creation_date": 1530116363, "answer_id": 51067381, "question_id": 51066984, "link": "https://stackoverflow.com/questions/51066984/vba-click-download-from-html-w-masked-button-by-anchor/51067381#51067381", "title": "VBA - Click &quot;Download&quot; from html w/ masked button by anchor", "body": "<p>What link are you trying to access? Is it a folder included in your project, or the one from an external server?\nFrom what I understand, you're trying to access the \"assistant\" folder is this?\nThe \"/\" before \"assistant\" (/ assistant) can affect the location because it indicates the entry in another folder.</p>\n\n<p>Try if the folder is in the project, without a previous \"/\":</p>\n\n<p>\"assistant/newRunReport?parameterId=de9498-1643e6f7969-5tv0\"</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530134865, "post_id": 51069928, "comment_id": 89133083, "body": "Hello QHarr, I have resolved the issue however I would still like to understand your solutions. During my research I came across this method but did not get it to work. Currently I am getting an error saying &quot;invalid or unqualified reference&quot; when entering your proposed code."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530135534, "post_id": 51069928, "comment_id": 89133326, "body": "You can&#39;t have just .document. You either need IE.document (IE being the variable representing the instance of IE used for the scraping, or you need to execute against an htmldocument variable."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530135613, "post_id": 51069928, "comment_id": 89133351, "body": "So IE.document.querySelector  or HTMLDoc.querySelector,  where Dim IE As InternetExplorer and Dim HTMLDoc As HTMLDocument."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530135895, "post_id": 51069928, "comment_id": 89133465, "body": "I don&#39;t whether you can run this as well to have a look at some CSS questions I have explained before <a href=\"https://data.stackexchange.com/stackoverflow/query/edit/867896\" rel=\"nofollow noreferrer\">data.stackexchange.com/stackoverflow/query/edit/867896</a>"}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530136139, "post_id": 51069928, "comment_id": 89133542, "body": "Got it. Yes I am using IE. I have IE defined as an object &quot;objIE&quot; so ... ObjIE.document...etc.   I used the code however I get the error 424: object required.  I added a &quot;Wait&quot; command prior to this line just in case it was a loading issue but it doesn&#39;t seem to be the case."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530136309, "post_id": 51069928, "comment_id": 89133613, "body": "How many items are there on that page with that className? Can you do .querySelector(&quot;.alignLeft.nowrap&quot;).Click    If there is more than one then find which number it is at and .querySelectorAll(&quot;.alignLeft.nowrap&quot;)(n).Click  where n is the appropriate index. Sometimes the sytnax is  .querySelectorAll(&quot;.alignLeft.nowrap&quot;).Item(n).Click"}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530137099, "post_id": 51069928, "comment_id": 89133900, "body": "That particular class is only present in one instance. However &quot;alignLeft nowrap&quot; shows up within the text of another class as &quot;gwt-Label alignLeft nowrap link&quot;."}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530137164, "post_id": 51069928, "comment_id": 89133928, "body": "Sorry can you elaborate on what you meant by narrow down CSS with ...(&quot;a.alignleft...) Thank you in advance for all your help. I really appreciate this."}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530137775, "post_id": 51069928, "comment_id": 89134101, "body": "It seems I am still getting the same object error with both commands &quot;objIE.querySelector(&quot;a.alignLeft.nowrap&quot;).Click&quot; &amp; sans &quot;a&quot;.   I think this may be what you&#39;re alluding to but is there a way for me to drill down to that specific instance of &quot;alignleft.nowrap&quot; other than counting the number instances and entering that as the (N) in your example?"}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530137927, "post_id": 51069928, "comment_id": 89134142, "body": "AH , please excuse the ignorance. I literally put the code you instructed and omitted the &quot;document&quot; portion.       objIE.Document.querySelector(&quot;a.alignLeft.nowrap&quot;).Click did the trick.  Can you elaborate as to what the preceding &quot;a&quot; indicates?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530137963, "post_id": 51069928, "comment_id": 89134156, "body": "It means elements with a tag. If you look towards the bottom of my answer I mention this. The query I have put in the comments shows you some of the answers I have given where I use CSS selectors. Also, you can learn here: <a href=\"https://www.w3schools.com/cssref/css_selectors.asp\" rel=\"nofollow noreferrer\">w3schools.com/cssref/css_selectors.asp</a> and practice both there and here is quite fun <a href=\"https://flukeout.github.io/\" rel=\"nofollow noreferrer\">flukeout.github.io</a>"}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530138189, "post_id": 51069928, "comment_id": 89134210, "body": "QHarr Thanks a ton for your time and knowledge. I will certainly look at these resources!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530138215, "post_id": 51069928, "comment_id": 89134215, "body": "Not a problem :-)"}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530138251, "post_id": 51069928, "comment_id": 89134228, "body": "Do you have any other practice websites you recommend?"}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530138432, "post_id": 51069928, "comment_id": 89134270, "body": "Anything really! I&#39;m looking to get my hands dirty as much as I can. I&#39;m looking forward to selecting the plates here shortly. haha."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530138496, "post_id": 51069928, "comment_id": 89134287, "body": "When you are ready for the big game.... <a href=\"https://learn.shayhowe.com/advanced-html-css/complex-selectors/\" rel=\"nofollow noreferrer\">learn.shayhowe.com/advanced-html-css/complex-selectors</a>     <a href=\"https://www.w3schools.com/css/css_combinators.asp\" rel=\"nofollow noreferrer\">w3schools.com/css/css_combinators.asp</a>"}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530138891, "post_id": 51069928, "comment_id": 89134393, "body": "Great, thank you for sharing this. Once I build enough rep I&#39;ll go ahead and jump on. I plan to devote some serious time to this.   Thanks again!"}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530642298, "post_id": 51069928, "comment_id": 89305162, "body": "Hi again! I&#39;ve been looking through the resources you provided and have found them very helpful ...thanks again! I was hoping you could clarify something for me. In your original response you linked the keywords &quot;document&quot; and &quot;.queryselector.&quot;   I saw that the keyword &quot;document&quot; is used to access a webpage. Is this through the perspective of VBA only? Or are these general? I&#39;m a bit confused as to what I&#39;m looking at. Are these terms interchangeable between VBA and HTML?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530642582, "post_id": 51069928, "comment_id": 89305303, "body": "So you are interacting with the <a href=\"https://en.wikipedia.org/wiki/Document_Object_Model\" rel=\"nofollow noreferrer\">Document Object Model (DOM)</a> when you scrape a webpage.  VBA has libraries which replicate many  of the methods you find shown in those links. So HTML Object library for example gives you access to querySelector. Late bound &quot;HTMLfile&quot; has an interface that may also offer this. I find those links well documented and a good place to learn more about scraping. You can enter the same terms into MSDN and see what is returns for VBA."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530642676, "post_id": 51069928, "comment_id": 89305344, "body": "In my answers I generally try to show the appropriate syntax for VBA but expose OPs to the wider DOM. Does that make sense? Think about libraries in vba like MSXML2.XMLHTTP library"}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530643243, "post_id": 51069928, "comment_id": 89305578, "body": "Thank you. Yes that makes sense! From what perspective are the methods in the links written if VBA has an &quot;equivalent&quot; command?  Would an HTML user be using those commands as written? As to your last comment, I take MSDN would translate the terminology included in the links to the VBA equivalent. Is there a way to access all the functions housed in the &quot;HTML Object Library&quot; for example?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530643824, "post_id": 51069928, "comment_id": 89305842, "body": "It depends on the language. Most of those links I think are written from a javascript point of view. It is not usually too difficult to do an internet search for the VBA equivalent syntax especially on SO or MSDN.  If using early binding then when you add a reference to the appropriate library and create an instance of a class e.g. HTMLDocument you will get intellisense showing available methods/properties.  I generally Google the class/object and aim for more reputable links like MSDN."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530643984, "post_id": 51069928, "comment_id": 89305905, "body": "MSDN often has C# or VB.net example. SO will have implementations in lots of languages. I frequently look to javascript, java, python and C# in particular to get a feel for what might be possible in VBA. The javascript user would be using as per the examples in the links. I am guessing there were example further down. If not, I can dig some up for you. Remember YouTube is awesome for this stuff."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530644204, "post_id": 51069928, "comment_id": 89306020, "body": "I quite like this guy&#39;s tutorials <a href=\"https://www.youtube.com/user/shiffman/search?query=web+scraping\" rel=\"nofollow noreferrer\">youtube.com/user/shiffman/search?query=web+scraping</a>. I used them for beginner regex for example even though in a different language. You learn the limitations and differences through research and some trial and error."}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530644654, "post_id": 51069928, "comment_id": 89306217, "body": "Thanks QHarr! I was deep in reading here. I&#39;ll take it from here as I understand the connection now. It sounds like in order to be fluent with this I will need to obtain familiarity with other languages. Lastly, what is SO? I was able to look up the other ones on google but can&#39;t come across this one. Is MSDN something I can access? I was reading it&#39;s something like $20K. I may be mistaken."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530644777, "post_id": 51069928, "comment_id": 89306267, "body": "MSDN developer network is free. You don&#39;t need to be a member to browse the library. SO is Stack Overflow. Any other questions let me know, I have advised as I understand but I am still relatively &quot;green&quot;. You will definitely benefit from looking at other languages. Searching MSDN for example: <a href=\"https://social.msdn.microsoft.com/search/en-US?ral=1&amp;query=DOM\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/search/en-US?ral=1&amp;query=DOM</a>"}, {"owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530971663, "post_id": 51069928, "comment_id": 89428032, "body": "Not being able to reply in the chatroom is giving me anxiety haha. Thanks for all the help as always."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "edited": false, "score": 0, "creation_date": 1530972063, "post_id": 51069928, "comment_id": 89428120, "body": "And you can ping from anywhere I have commented with @qharr remembering the @"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1530138198, "last_edit_date": 1530138198, "creation_date": 1530126829, "answer_id": 51069928, "question_id": 51066984, "link": "https://stackoverflow.com/questions/51066984/vba-click-download-from-html-w-masked-button-by-anchor/51069928#51069928", "title": "VBA - Click &quot;Download&quot; from html w/ masked button by anchor", "body": "<p>Have you also tried a CSS selector of <code>a[href='/assistant/newRunReport?parameterId=de9498-1643e6f7969-5tv0']</code></p>\n\n<p>Which would be </p>\n\n<pre><code>.document.querySelector(\"a[href='/assistant/newRunReport?parameterId=de9498-1643e6f7969-5tv0']\").Click\n</code></pre>\n\n<p>If those fail try:</p>\n\n<pre><code>.document.querySelector(\".alignLeft.nowrap\").Click or\n</code></pre>\n\n<p>or</p>\n\n<pre><code>.document.querySelector(\"a.alignLeft.nowrap\")\n</code></pre>\n\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector\" rel=\"nofollow noreferrer\"><code>.querySelector</code></a> is the method of <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/Document\" rel=\"nofollow noreferrer\"><code>document</code></a> that applies a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">CSS selector</a>. You select an element by its styling.</p>\n\n<p><code>a.alignLeft.nowrap</code>, for example, is <code>a</code> tags with className of <code>alignLeft nowrap</code>. The <code>\".\"</code> means className. You are not allowed compound names when using <code>.querySelector</code> so you add another dot where the space is to get <code>a.alignLeft.nowrap</code>.</p>\n\n<p><code>.querySelector</code> returns a single matching item i.e. the first. <code>.querySelectorAll</code> will return a <code>nodeList</code> of all matching elements which you then traverse the <code>.Length</code> of to get to individual items by index.</p>\n"}], "owner": {"reputation": 21, "user_id": 10000915, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211879623047920/picture?type=large", "display_name": "Edwin Hwang", "link": "https://stackoverflow.com/users/10000915/edwin-hwang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1530138198, "creation_date": 1530114821, "last_edit_date": 1530116717, "question_id": 51066984, "link": "https://stackoverflow.com/questions/51066984/vba-click-download-from-html-w-masked-button-by-anchor", "title": "VBA - Click &quot;Download&quot; from html w/ masked button by anchor", "body": "<p>I'm new to this website and just begun my journey in HTML. My hope is that I can provide to the community as much as I have received lurking in the answers! </p>\n\n<p>I am currently working on automating some navigation on IE using VBA. All has gone to plan with the exception of the following:</p>\n\n<p>There's a \"button\" I am trying to click...here is the HTML:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;a class=\"alignLeft nowrap\" href=\"/assistant/newRunReport?parameterId=de9498-1643e6f7969-5tv0\"&gt;Download&lt;/a&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>In the past, I have simply used the href to navigate directly to the page. However this particular request returns an error page in the browser so that doesn't seem to be an option.</p>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1530115424, "post_id": 51066922, "comment_id": 89124074, "body": "Use <code>c = ActiveCell</code> rather than <code>c = ActiveCell.Select</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1530134826, "post_id": 51066922, "comment_id": 89133064, "body": "@DarrenBartrup-Cook&#39;s point is absolutely correct, don&#39;t <code>Select</code> the <code>ActiveCell</code>. I&#39;d go a step further and say change <code>ActiveWorkbook.ActiveSheet</code> to <code>ThisWorkbook.Sheets(&quot;YourSheetName&quot;)</code> And if your function <code>=MAX(IF...</code> is in a specific range (e.g. &quot;V16&quot;), refer to that range directly instead of using <code>ActiveCell</code>."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1530174396, "post_id": 51066922, "comment_id": 89144853, "body": "Something to consider - are they definitely the same number?  Is one <i>-15.0</i> and the other <i>-15.01</i>.  Also it&#39;s worth setting some of the other <code>FIND</code> parameters: <code>LookIn:=xlValues, LookAt:=xlWhole</code>.  <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel\" rel=\"nofollow noreferrer\">The settings for LookIn, LookAt, SearchOrder, and MatchByte are saved each time you use this method. If you do not specify values for these arguments the next time you call the method, the saved values are used.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5331747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a2b734e6e39b9c20286cd86e61ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Nui", "link": "https://stackoverflow.com/users/5331747/nui"}, "edited": false, "score": 0, "creation_date": 1530117016, "post_id": 51067209, "comment_id": 89124976, "body": "Darren many thanks. Neither of the two changes to the line you mentioned made a difference. I had played with that beforehand."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1530116152, "last_edit_date": 1530116152, "creation_date": 1530115713, "answer_id": 51067209, "question_id": 51066922, "link": "https://stackoverflow.com/questions/51066922/excel-vba-make-cell-active-in-a-specified-range/51067209#51067209", "title": "Excel VBA Make Cell Active in a Specified Range", "body": "<p>I hope this is the correct reason:  </p>\n\n<p><code>c = ActiveCell.Select</code> is returning the value <code>-1</code> which equates to <code>TRUE</code> in VBA.</p>\n\n<p>So, <em>I think</em>, the line is asking the question <code>c = ActiveCell is Selected?</code> which returns a boolean TRUE/FALSE converted to a double which equals -1.</p>\n\n<p><code>c = ActiveCell</code> returns the default property of the <code>ActiveCell</code> which is <code>Value</code>.</p>\n\n<p>So that line should read <code>c = ActiveCell</code> or <code>c = ActiveCell.Value</code> rather than <code>c = ActiveCell.Select</code>.  </p>\n\n<p><strong>Edit:</strong><br>\nNot so sure of my reasoning now - <code>c= Range(\"A1\").Select</code> selects cell A1 and returns -1 still.<br>\nI guess that why you should avoid <code>Select</code> like the plague unless you want to actually select a cell rather than just reference it.  Have a read of <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n"}], "owner": {"reputation": 19, "user_id": 5331747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a2b734e6e39b9c20286cd86e61ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Nui", "link": "https://stackoverflow.com/users/5331747/nui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530475825, "creation_date": 1530114627, "last_edit_date": 1530475825, "question_id": 51066922, "link": "https://stackoverflow.com/questions/51066922/excel-vba-make-cell-active-in-a-specified-range", "title": "Excel VBA Make Cell Active in a Specified Range", "body": "<p>I'm not sure why the following code gives a \"Not found\" Message when the value in the initial active cell (-15.0) is also a value within the specified range.</p>\n\n<pre><code>Sub Test()\nDim c As Double\nDim srchRng As Range\nWith ActiveWorkbook.ActiveSheet\n    c = ActiveCell.Select\n    Set srchRng = .Range(\"V17:V37\").Find(what:=c)\n    If srchRng Is Nothing Then\n        MsgBox \"Not found\"\n    End If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Note sometimes a value of 0 exists within the specified range. If so I don't need to do anything but if 0 does not exist, I first need to find the least negative value (I use separately within the worksheet <code>=MAX(IF(V17:V37&lt;=0,V17:V37),MIN(V17:V37))</code> and this becomes my initial active cell value [eg -15.0] to look for in the specified range), and this least negative value will then be set to zero (by using a goal seek function in this cell)</p>\n\n<p>So this macro will ultimately incorporate an <code>If</code> statement or conditional <code>lookup</code></p>\n\n<p>Any feedback appreciated. </p>\n\n<p>I made suggested changes but revised code below still returns \"Not found\".\nCell V38 has the value -15.0 but this number does appear in the range V17:V37.\nThis simple macro should result in the cell in the range corresponding to the c value being selected. Any further help appreciated.</p>\n\n<pre><code>Dim c As Double\nDim srchRng As Range\nWith ThisWorkbook.Sheets(\"Reel_Pack\")\nc = Range(\"V38\")\nSet srchRng = .Range(\"V17:V37\").Find(what:=c)\nIf srchRng Is Nothing Then\n    MsgBox \"Not found\"\nEnd If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I found the following code to do the above.</p>\n\n<pre><code>    Dim c As Double\n    c = ThisWorkbook.Sheets(\"Sheet1\").Range(\"V58\").Value\n    Dim cel As Range\n    For Each cel In ThisWorkbook.Sheets(\"Sheet1\").Range(\"V17:V57\")\n        With cel\n            If .Value = c Then\n                .Select\n            End If\n        End With\n    Next cel\n    End Sub\n</code></pre>\n\n<p>But can someone suggest please how to improve this by actually incorporating the equation I have in cell V58 within this macro? As mentioned that equation is <code>=MAX(IF(V17:V37&lt;=0,V17:V37),MIN(V17:V37))</code>.</p>\n\n<p>So the macro would look into the range V17:V37 and if there is an exact zero then Do Nothing otherwise locate the cell with the least negative number (which is what the equation above does) and select that cell.</p>\n"}, {"tags": ["vba", "excel", "loops", "ms-word", "selection"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1530112895, "post_id": 51066145, "comment_id": 89122664, "body": "the way that your code is set up, it would be: <code>result (tab) (paragraph) result (tab) (paragraph) ...</code> To get the formatting the way you would like, you have to put the <code>Selection.InsertParagraph</code> line just below the <code>Next j</code> line"}, {"owner": {"reputation": 45, "user_id": 4707025, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9423d944fbc890dae379cef116f91b10?s=128&d=identicon&r=PG&f=1", "display_name": "Riek Rudolph", "link": "https://stackoverflow.com/users/4707025/riek-rudolph"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1530114318, "post_id": 51066145, "comment_id": 89123449, "body": "Changed that. It still first prints all results and then all paragraphs."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4707025, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9423d944fbc890dae379cef116f91b10?s=128&d=identicon&r=PG&f=1", "display_name": "Riek Rudolph", "link": "https://stackoverflow.com/users/4707025/riek-rudolph"}, "edited": false, "score": 0, "creation_date": 1530117134, "post_id": 51067438, "comment_id": 89125033, "body": "Thanks! Is there a possibility to insert something after a certain Placeholder String with range? And could I also for example insert a Table with the data after this placeholder string? Thanks in advance."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 45, "user_id": 4707025, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9423d944fbc890dae379cef116f91b10?s=128&d=identicon&r=PG&f=1", "display_name": "Riek Rudolph", "link": "https://stackoverflow.com/users/4707025/riek-rudolph"}, "edited": false, "score": 0, "creation_date": 1530117530, "post_id": 51067438, "comment_id": 89125231, "body": "@RiekRudolph You&#39;re welcome!  Those are good questions, but they are separate questions.  If this answer helped you, would you please upvote or accept as you see fit?  (See the <a href=\"https://stackoverflow.com/tour\">tour</a>.)  Then try to do what you are asking, and if you have trouble, ask a new question linking to this one and showing the code that&#39;s not working (just like you did here).  Thanks, and good luck!"}, {"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 1, "creation_date": 1530120845, "post_id": 51067438, "comment_id": 89126844, "body": "You could also use the <code>VbNewLine</code> constant instead of <code>Chr(13)</code>. Another thought: If the text is being inserted at a specific place in the document, you could add a bookmark there, and then use the <code>Bookmark(&quot;bookmark_name&quot;).Range</code> property."}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 2, "last_activity_date": 1530116580, "creation_date": 1530116580, "answer_id": 51067438, "question_id": 51066145, "link": "https://stackoverflow.com/questions/51066145/word-vba-selection-typetext-and-selection-insertparagraph-inserting-text-in-the/51067438#51067438", "title": "Word VBA Selection.TypeText and Selection.InsertParagraph inserting text in the wrong order", "body": "<p>Instead of using <code>Selection</code>, use a <code>Range</code>.  Then you can reliably append text using <code>Range.InsertAfter</code>.  The below examples are in Word VBA; I can't put them in your Excel context since I don't have all the details.</p>\n\n<h3>MCVE of your code (not working)</h3>\n\n<pre><code>Option Explicit\nOption Base 0\n\n' A function just to display i, k, and j in a comprehensible manner\nPublic Function ijk(i As Long, j As Long, k As Long)\n    ijk = \"[I: \" &amp; CStr(i) &amp; \"; K: \" &amp; CStr(k) &amp; \"; J: \" &amp; CStr(j) &amp; \"]\"\nEnd Function\n\nPublic Sub NotWorking()\n    Dim noInt As Long\n    noInt = 3\n\n    Dim noData As Long\n    noData = 4\n\n    Dim i As Long, k As Long, j As Long\n\n    For i = 2 To noInt\n        For k = 2 To noData\n            For j = 5 To 9\n                Selection.TypeText ijk(i, j, k) &amp; vbTab\n            Next j\n            Selection.InsertParagraph\n        Next k\n    Next i\nEnd Sub\n</code></pre>\n\n<h3>A working version</h3>\n\n<p>Replace Sub <code>NotWorking</code> above with this:</p>\n\n<pre><code>Public Sub Working()\n    Dim noInt As Long\n    noInt = 3\n\n    Dim noData As Long\n    noData = 4\n\n    Dim i As Long, k As Long, j As Long\n\n    ' *** Create a Range to refer to wherever the Selection is now\n    Dim rDest As Range\n    Set rDest = Selection.Range.Duplicate\n\n    For i = 2 To noInt\n        For k = 2 To noData\n            For j = 5 To 9\n                rDest.InsertAfter ijk(i, j, k) &amp; vbTab    ' ***\n            Next j\n            rDest.InsertAfter Chr(13)                     ' ***\n        Next k\n    Next i\nEnd Sub\n</code></pre>\n\n<p><code>Chr(13)</code> is a paragraph marker, so inserting it creates a new paragraph.</p>\n\n<p><strong>Results</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1grj3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1grj3.png\" alt=\"screenshot\"></a></p>\n"}], "owner": {"reputation": 45, "user_id": 4707025, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9423d944fbc890dae379cef116f91b10?s=128&d=identicon&r=PG&f=1", "display_name": "Riek Rudolph", "link": "https://stackoverflow.com/users/4707025/riek-rudolph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 857, "favorite_count": 0, "accepted_answer_id": 51067438, "answer_count": 1, "score": 1, "last_activity_date": 1530116851, "creation_date": 1530112048, "last_edit_date": 1530116851, "question_id": 51066145, "link": "https://stackoverflow.com/questions/51066145/word-vba-selection-typetext-and-selection-insertparagraph-inserting-text-in-the", "title": "Word VBA Selection.TypeText and Selection.InsertParagraph inserting text in the wrong order", "body": "<p>I am trying to print certain columns from an Excel file with the <code>Selection.TypeText</code> function.\nUnfortunately, the following code first prints all the results, and after that all the paragraphs.  I want the result: </p>\n\n<pre><code>result (tab) result (tab) result (tab) result (tab) result (paragraph)\n</code></pre>\n\n<p>The order of the results is correct, but the macro jumps to the end of the data to insert a paragraph, and then \"jumps back\" to fill in more data.</p>\n\n<p><code>noInt</code> and <code>noData</code> are two variables that are filled beforehand and are working.</p>\n\n<pre><code>For i = 2 To noInt\n    For k = 2 To noData\n        If exWb.Sheets(\"Table1\").Cells(k, 1) = exWb.Sheets(\"Table2\").Cells(i, 1) Then\n            For j = 5 to 9\n                Selection.TypeText exWb.Sheets(\"Table1\").Cells(k, j) &amp; vbTab\n            Next j\n       Selection.InsertParagraph\n       End If\n    Next k\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba", "dictionary", "coordinates", "formula"], "comments": [{"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 1, "creation_date": 1530111918, "post_id": 51066021, "comment_id": 89122045, "body": "You would use a For or While loop to process all cells."}, {"owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "reply_to_user": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 0, "creation_date": 1530112134, "post_id": 51066021, "comment_id": 89122181, "body": "How would I implement the looping into the second code at the bottom of the link? <a href=\"https://support.microsoft.com/en-us/help/213449/how-to-convert-degrees-minutes-seconds-angles-to-or-from-decimal-angle\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/213449/&hellip;</a>"}, {"owner": {"reputation": 18880, "user_id": 4283581, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a6JjK.jpg?s=128&g=1", "display_name": "Grant Miller", "link": "https://stackoverflow.com/users/4283581/grant-miller"}, "edited": false, "score": 1, "creation_date": 1530112912, "post_id": 51066021, "comment_id": 89122675, "body": "What have you tried so far?"}, {"owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "edited": false, "score": 0, "creation_date": 1530113061, "post_id": 51066021, "comment_id": 89122772, "body": "I\u2019m not too familiar with looping, I understand the concept but not where to start or end the loops in the code"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "edited": false, "score": 0, "creation_date": 1530112998, "post_id": 51066242, "comment_id": 89122726, "body": "How would I add this to the code from Microsoft? I want to be able to just run a tool after clicking some sort of \u201cconvert\u201d button that will return all the values in columns C as D."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1530113123, "post_id": 51066242, "comment_id": 89122818, "body": "<a href=\"https://support.office.com/en-us/article/assign-a-macro-to-a-form-or-a-control-button-d58edd7d-cb04-4964-bead-9c72c843a283\" rel=\"nofollow noreferrer\">Assign a macro to a Form or a Control button</a>"}], "tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": false, "score": 2, "last_activity_date": 1530114703, "last_edit_date": 1530114703, "creation_date": 1530112335, "answer_id": 51066242, "question_id": 51066021, "link": "https://stackoverflow.com/questions/51066021/mass-convert-latitude-longitude-to-decimal-format-as-an-excel-vba/51066242#51066242", "title": "Mass convert latitude/longitude to decimal format as an excel VBA?", "body": "<p>This is covered in detail in <a href=\"https://support.microsoft.com/en-gb/help/213449/how-to-convert-degrees-minutes-seconds-angles-to-or-from-decimal-angle\" rel=\"nofollow noreferrer\">this Microsoft article</a></p>\n\n<p>To apply to all cells in a range, you could simply use:</p>\n\n<pre><code>Sub foo()\n    With Sheet1.Range(\"C2:D\" &amp; Cells(Rows.count, \"A\").End(xlUp).row)\n        .FormulaR1C1 = \"=Convert_Decimal(RC[-2])\"\n        .Value = .Value\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530115717, "post_id": 51066808, "comment_id": 89124243, "body": "I just had a thought that you will have to adjust the maths if you typically use negative numbers for lons; e.g. <code>-85&#176; 32&#39; 4.3243</code>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1530114294, "creation_date": 1530114294, "answer_id": 51066808, "question_id": 51066021, "link": "https://stackoverflow.com/questions/51066021/mass-convert-latitude-longitude-to-decimal-format-as-an-excel-vba/51066808#51066808", "title": "Mass convert latitude/longitude to decimal format as an excel VBA?", "body": "<p>I wouldn't bother with a button; just let the paste operation trigger an event. Put this into the worksheet's private code sheet with right-click name tab, View Code.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"A:B\")) Is Nothing Then\n        On Error GoTo safe_exit\n        Application.EnableEvents = False\n        Dim t As Range, latlon As Variant\n        For Each t In Intersect(Target, Range(\"A:B\"))\n            If CBool(InStr(1, t.Value2, Chr(176))) And CBool(InStr(1, t.Value2, Chr(39))) And _\n                     InStr(1, t.Value2, Chr(176)) &lt; InStr(1, t.Value2, Chr(39)) Then\n                latlon = Split(t.Value2, Chr(176))\n                Debug.Print CInt(latlon(0))\n                Debug.Print CInt(Split(latlon(1), Chr(39))(0))\n                Debug.Print CDbl(Split(latlon(1), Chr(39))(1))\n                t.Offset(0, 2) = CDbl(CInt(latlon(0)) + _\n                                      CInt(Split(latlon(1), Chr(39))(0)) / 60 + _\n                                      CDbl(Split(latlon(1), Chr(39))(1)) / 3600)\n                t.Offset(0, 2).NumberFormat = \"0.00000000\"\n            End If\n        Next t\n    End If\n\nsafe_exit:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>This will react to data pasted into columns A and/or B and convert to decimal lat/lons in columns C and D.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4OKDk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4OKDk.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 51066808, "answer_count": 2, "score": -2, "last_activity_date": 1530114703, "creation_date": 1530111665, "last_edit_date": 1530112019, "question_id": 51066021, "link": "https://stackoverflow.com/questions/51066021/mass-convert-latitude-longitude-to-decimal-format-as-an-excel-vba", "title": "Mass convert latitude/longitude to decimal format as an excel VBA?", "body": "<p>I have a spreadsheet that has latitude in column A and longitude in column B, in the format: 34\u00b0 3' 8.0460.</p>\n\n<p>I want to be able to run a tool that when you press a button (after pasting data into columns A and B), will return columns C and D, which are the decimal values of A and B, respectively.</p>\n\n<p>I\u2019ve seen some functions that you can call individual cells to get results, but I need to be able to convert hundreds of cells in one click. Maybe include a \u201cconvert\u201d button that runs the script?</p>\n\n<p>Any ideas on a VBA code that could do the trick?</p>\n\n<p>I\u2019m fairly new to using coding.</p>\n"}, {"tags": ["html", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10000640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z0sSf5U4mjA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2w-IZSVdOPQsUcWYb4MKFrxDjpBg/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10000640/anonymous"}, "edited": false, "score": 1, "creation_date": 1530113470, "post_id": 51066367, "comment_id": 89122986, "body": "Thank you for the assistance, would you be able to explain a bit more what you did just so I can try to tailor it to mine? Thank you!"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "reply_to_user": {"reputation": 1, "user_id": 10000640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z0sSf5U4mjA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2w-IZSVdOPQsUcWYb4MKFrxDjpBg/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10000640/anonymous"}, "edited": false, "score": 0, "creation_date": 1530114008, "post_id": 51066367, "comment_id": 89123276, "body": "I don&#39;t think this answers the full scope of your question, but I thought it might point you in the right direction in regards to dynamically building an HTML table.  Basically you tell this function what sheet your working on, what row and column your data starts on, and optionally what row and column your data ends on.  for example: <code>StringVariable = BuildHTMLTable(Sheet1, 2, 2, 5, 5)</code> will build html table based on the data on Sheet1, between B2 to E5."}, {"owner": {"reputation": 1, "user_id": 10000640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z0sSf5U4mjA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2w-IZSVdOPQsUcWYb4MKFrxDjpBg/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10000640/anonymous"}, "edited": false, "score": 0, "creation_date": 1530114651, "post_id": 51066367, "comment_id": 89123633, "body": "Ok thank you, sorry these questions are so stupid, I&#39;m just very new to VBA. Where would I put that stringvariable element you just mentioned"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "reply_to_user": {"reputation": 1, "user_id": 10000640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z0sSf5U4mjA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2w-IZSVdOPQsUcWYb4MKFrxDjpBg/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10000640/anonymous"}, "edited": false, "score": 0, "creation_date": 1530115122, "post_id": 51066367, "comment_id": 89123922, "body": "Sorry, that was just a generic name.  I see you have a variable ready to use for it.  <code>mail_body_table = BuildHTMLTable(sheet1, 2, 5)</code>  This populate your mail_body_table variable with an HTML table of all cells between E2 and the last used column and row."}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "reply_to_user": {"reputation": 1, "user_id": 10000640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z0sSf5U4mjA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2w-IZSVdOPQsUcWYb4MKFrxDjpBg/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10000640/anonymous"}, "edited": false, "score": 0, "creation_date": 1530122137, "post_id": 51066367, "comment_id": 89127455, "body": "Updated answer to more directly answer your questions"}, {"owner": {"reputation": 1, "user_id": 10000640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z0sSf5U4mjA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2w-IZSVdOPQsUcWYb4MKFrxDjpBg/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10000640/anonymous"}, "edited": false, "score": 0, "creation_date": 1530131139, "post_id": 51066367, "comment_id": 89131512, "body": "Thank you I appreciate your help, but for some reason with this code I keep getting 404 error so I&#39;m not sure what could be causing that"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "reply_to_user": {"reputation": 1, "user_id": 10000640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z0sSf5U4mjA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2w-IZSVdOPQsUcWYb4MKFrxDjpBg/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10000640/anonymous"}, "edited": false, "score": 0, "creation_date": 1530188848, "post_id": 51066367, "comment_id": 89154204, "body": "Updated answer again, missed a couple declarations.  In your e-mail SendEmail procedure, you don&#39;t need <code>set olApp = CreateObject(&quot;Outlook.application&quot;)</code> line if you&#39;ve already setup your reference and change <code>Dim olApp as New Outlook.application</code>  Reference: Tools --&gt; References.  Select: Microsoft Outlook 14.0 Object Library"}, {"owner": {"reputation": 1, "user_id": 10000640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z0sSf5U4mjA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2w-IZSVdOPQsUcWYb4MKFrxDjpBg/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10000640/anonymous"}, "edited": false, "score": 0, "creation_date": 1530193028, "post_id": 51066367, "comment_id": 89157062, "body": "Thank you, it appears Excel is trying to run that function but it is continuing to crash. I have all of the rows pre filled with a formula so that it auto populates and I am thinking that excel is trying to read all of those rows even though I don&#39;t need that data. Any advice?"}], "tags": [], "owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "is_accepted": false, "score": 1, "last_activity_date": 1530188282, "last_edit_date": 1530188282, "creation_date": 1530112739, "answer_id": 51066367, "question_id": 51065917, "link": "https://stackoverflow.com/questions/51065917/dynamically-generate-html-table-enbedded-in-vba-email-generation/51066367#51066367", "title": "Dynamically Generate HTML Table enbedded in VBA Email Generation", "body": "<p>Wrote something similar to this a while ago.</p>\n\n<p>This function will return a string with an HTML table containing the data within the specified area.</p>\n\n<pre><code>Private Function BuildHTMLTable(ByRef wSheet As Worksheet, ByVal StartRow As Long, ByVal StartCol As Long, Optional ByVal EndRow As Long = -1, Optional ByVal EndCol As Long = -1) As String\n\n    If EndRow = -1 Then EndRow = wSheet.UsedRange.Rows.Count + 1\n    If EndCol = -1 Then EndCol = wSheet.UsedRange.Columns.Count + 1\n\n    BuildHTMLTable = \"&lt;TABLE&gt;\"\n\n    Dim iCurRow, iCurCol As Long\n    For iCurRow = StartRow To EndRow\n        BuildHTMLTable = BuildHTMLTable &amp; \"&lt;TR&gt;\"\n\n        For iCurCol = StartCol To EndCol\n            BuildHTMLTable = BuildHTMLTable &amp; \"&lt;TD&gt;\" &amp; wSheet.Cells(iCurRow, iCurCol) &amp; \"&lt;/TD&gt;\"\n        Next\n\n        BuildHTMLTable = BuildHTMLTable &amp; \"&lt;/TR&gt;\"\n    Next\n\n    BuildHTMLTable = BuildHTMLTable &amp; \"&lt;/TABLE&gt;\"\nEnd Function\n</code></pre>\n\n<p>[EDIT]</p>\n\n<p>This will integrate the concepts in my function above into your code.  Made some assumptions on your code like that in B2 you somewhere you have text that says \"replace_body_table\".  And wasn't sure exactly where in F column you had your email address so I have it looking in F2 for it.</p>\n\n<pre><code>Sub SendMassEmail()\n\n    Dim StartRow, Endrow As Long\n    StartRow = 3\n    Endrow = Sheet1.UsedRange.Rows.Count + 1\n\n    Dim mail_body_message As String\n    Dim mail_body_table As String\n\n    mail_body_message = Sheet2.Range(\"B2\")\n\n    mail_body_table = \"&lt;TABLE&gt;\"\n    Dim iCurRow As Long\n    For iCurRow = StartRow To Endrow\n            mail_body_table = mail_body_table &amp; \"&lt;TR&gt;\"\n            mail_body_table = mail_body_table &amp; \"&lt;TD&gt;\" &amp; Sheet1.Range(\"E\" &amp; iCurRow) &amp; \"&lt;/TD&gt;\"\n            mail_body_table = mail_body_table &amp; \"&lt;TD&gt;\" &amp; Sheet1.Range(\"G\" &amp; iCurRow) &amp; \"&lt;/TD&gt;\"\n            mail_body_table = mail_body_table &amp; \"&lt;TD&gt;\" &amp; Format(Sheet1.Range(\"K\" &amp; iCurRow), \"Currency\") &amp; \"&lt;/TD&gt;\"\n            mail_body_table = mail_body_table &amp; \"&lt;/TR&gt;\"\n    Next\n    mail_body_table = mail_body_table &amp; \"&lt;/TABLE&gt;\"\n\n    mail_body_message = Replace(mail_body_message, \"replace_body_table\", mail_body_table)\n\n\n    Call SendEmail(Sheet1.Range(\"F2\"), \"Test 2018\", mail_body_message)\n    'MsgBox \"Email Send Complete\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10000640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z0sSf5U4mjA/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2w-IZSVdOPQsUcWYb4MKFrxDjpBg/mo/photo.jpg?sz=128", "display_name": "Anonymous", "link": "https://stackoverflow.com/users/10000640/anonymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530188282, "creation_date": 1530111322, "last_edit_date": 1530114948, "question_id": 51065917, "link": "https://stackoverflow.com/questions/51065917/dynamically-generate-html-table-enbedded-in-vba-email-generation", "title": "Dynamically Generate HTML Table enbedded in VBA Email Generation", "body": "<p>I am trying to create an email with body text and a table that automatically generates from a given set of data. Right now, I have the data pulling from a separate sheet with all the inputs, then you can simply select a persons name from the drop down list and the data auto populates. I was hoping to pull the data from the columns needed into a table in the middle of the email body. However, I don't know how to make the table formatted in HTML dynamic so that it can either have 2,3,1 row of data depending on what shows up. </p>\n\n<p>The other option I would want is for VBA to automatically find alike data based on names in a list and automatically pull the data based on that but I don't know if that is possible. </p>\n\n<p>I am very knew to VBA - only taught myself about 2 weeks ago for the purpose of this email, so I'm not 100% familiar with all the options. However, the one issue I was having with the loop on the drop-down layout was that to have the information auto-generate the formulas had to be pasted into the columns so technically they are not blank rows. </p>\n\n<p>I also have the message that I need inserted pulling from a cell in a separate sheet because I need to be able to HTML format it. Again I'm not sure if any of the stuff I am doing is the best way, but I couldn't figure out a better way.</p>\n\n<p>here is my code: </p>\n\n<pre><code>Sub SendEmail(what_address As String, subject_line As String, mail_body As String)\nDim olApp As Outlook.Application\n\nSet olApp = CreateObject(\"Outlook.application\")\n\n    Dim olMail As Outlook.MailItem\n    Set olMail = olApp.CreateItem(olMailItem)\n\n    olMail.To = what_address\n    olMail.Subject = subject_line\n    olMail.BodyFormat = olFormatHTML\n    olMail.HTMLBody = mail_body\n    olMail.Display\n    'olMail.Send\nEnd Sub\n\n\nSub SendMassEmail()\nrow_number = 1\n\n    row_number = row_number + 1\n    Dim mail_body_message As String\n    Dim full_name As String\n    Dim amount As String\n    Dim name_two As String\n    Dim mail_body_table As String\n\n    mail_body_message = Sheet2.Range(\"B2\")\n    full_name = Sheet1.Range(\"E\" &amp; row_number + 1)\n    name_2= Sheet1.Range(\"G\" &amp; row_number + 1)\n    amount = Format(Sheet1.Range(\"K\" &amp; row_number + 1), \"Currency\")\n\n    mail_body_message = Replace(mail_body_message, \"replace_name_here\", full_name)\n    mail_body_message = Replace(mail_body_message, \"nametwo_here\", name_two)\n    mail_body_message = Replace(mail_body_message, \"replace_amount\", amount)\n\n    Call SendEmail(Sheet1.Range(\"F\" &amp; row_number + 1), \"Test 2018\", mail_body_message)\n\n'MsgBox \"Email Send Complete\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1530111249, "post_id": 51065872, "comment_id": 89121614, "body": "What are you passing for books() ?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1530111465, "post_id": 51065872, "comment_id": 89121753, "body": "How are you calling the function? It&#39;s advisable to put <code>Option Explicit</code> at the top of your module so it lets you know you haven&#39;t declared <code>Fnum</code> or <code>i</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530111551, "post_id": 51065872, "comment_id": 89121808, "body": "Is LBound(books) 1 or 0? The LBound(workbookarray) is 1."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1530111702, "post_id": 51065872, "comment_id": 89121897, "body": "is &quot;set&quot; necessary in the offending line?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1530111835, "post_id": 51065872, "comment_id": 89121988, "body": "If you set the books to workbooks then it should be <code>Set worksheetarray(i) = books(i).Worksheets(name)</code>. You&#39;re treating the elements of books as workbook names, not workbook objects."}, {"owner": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "edited": false, "score": 0, "creation_date": 1530111950, "post_id": 51065872, "comment_id": 89122060, "body": "I&#39;m passing an array of workbooks.  They&#39;re defined as objects and I&#39;ve verified that they&#39;re being stored as objects.  The lower bound for books() is 1, so no worries there.    I&#39;ve added Option Explicit.  FNum and i are defined as Public variables, and they have been successfully defined and are being called.  I&#39;m not sure what you mean by &#39;How are you calling your function?&#39;  In the main sub I&#39;ve created an array to store worksheets, with type object, and set it equal to the return of this function, which should be an array of worksheets.  Does that answer your question?"}, {"owner": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "edited": false, "score": 0, "creation_date": 1530112041, "post_id": 51065872, "comment_id": 89122116, "body": "Jeeped, that did it, thanks!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1530112406, "post_id": 51065872, "comment_id": 89122372, "body": "Sorry, by <i>how are you calling your function</i> I meant some of the code that&#39;s calling it - how are the object and string that <code>books()</code> and <code>name</code> receive set up.  Jeeped sorted the problem now, so all good."}], "answers": [{"tags": [], "owner": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1530112596, "creation_date": 1530112596, "answer_id": 51066320, "question_id": 51065872, "link": "https://stackoverflow.com/questions/51065872/type-mismatch-assigning-worksheets-to-array/51066320#51066320", "title": "Type Mismatch assigning worksheets to array", "body": "<p>Thanks to Jeeped for the comment, he's really the one who answered my question! </p>\n\n<p>First mistake: ReDim workbookarray(1 To FNum) should be ReDim worksheetarray(1 To FNum)</p>\n\n<p>Second Mistake: As Jeeped noted, and I quote: </p>\n\n<p>\"If you set the books to workbooks then it should be Set worksheetarray(i) = books(i).Worksheets(name). You're treating the elements of books as workbook names, not workbook objects\"</p>\n\n<p>Here's the corrected code:</p>\n\n<pre><code>Function AssignSheets(books() As Object, name As String) As Object()\nDim worksheetarray() As Object\nReDim worksheetarray(1 To FNum)\n\nFor i = LBound(books) To UBound(books)\n    Set worksheetarray(i) = books(i).Worksheets(name)\nNext i\n\nAssignSheets = worksheetarray\n\nEnd Function\n</code></pre>\n\n<p>Thanks for the quick replies everyone!</p>\n"}], "owner": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530112596, "creation_date": 1530111181, "last_edit_date": 1531164843, "question_id": 51065872, "link": "https://stackoverflow.com/questions/51065872/type-mismatch-assigning-worksheets-to-array", "title": "Type Mismatch assigning worksheets to array", "body": "<p>Quick Question: I have a function that accepts an array of workbooks and the name of a worksheet to look for.  I'm getting a type mismatch when trying to add each worksheet to the array.  Here's the function:</p>\n\n<pre><code>Function AssignSheets(books() As Object, name As String) As Object()\nDim worksheetarray() As Object\nReDim workbookarray(1 To FNum)\n\nFor i = LBound(books) To UBound(books)\n    Set worksheetarray(i) = workbooks(books(i)).Worksheets(name)\nNext i\n\nAssignSheets = worksheetarray\n\nEnd Function\n</code></pre>\n\n<p>Shouldn't workbooks(books(i)).Worksheets(name) return an object?  Any insight would be greatly appreciated, thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1530110555, "post_id": 51065566, "comment_id": 89121147, "body": "You release memory and avoid errors. Usually this is performed with objects that load into memory (userforms for example, dictionaries). Ranges, charts, workbooks, I haven&#39;t seen a problem that they don&#39;t go into &quot;waste&quot; after code execution. Thus, I don&#39;t see why to do it with these kind of variables."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1530111341, "post_id": 51065566, "comment_id": 89121665, "body": "In most cases you don&#39;t need to do it. Look for a discussion <a href=\"https://blogs.msdn.microsoft.com/ericlippert/2004/04/28/when-are-you-required-to-set-objects-to-nothing/\" rel=\"nofollow noreferrer\">here</a> or <a href=\"https://stackoverflow.com/questions/517006/is-there-a-need-to-set-objects-to-nothing-inside-vba-functions\">here</a>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1530111382, "post_id": 51065566, "comment_id": 89121684, "body": "Page not found @Storax. Sounds like the consensus is that I can just delete here :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530113111, "post_id": 51065566, "comment_id": 89122808, "body": "VBA has garbage collection so this should not be a problem.... However..... I have seen this cause problems when people forget to quit instances of things... they at times appear to keep running in the background sucking up memory."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 4, "creation_date": 1530113446, "post_id": 51065566, "comment_id": 89122972, "body": "@QHarr VBA isn&#39;t garbage-collected, it&#39;s reference-counted. <i>In theory</i> the refcount gets depleted proper when the scope exits. In practice... it depends on who wrote the library for the object being cleared - if it&#39;s a VBA class or something in the host application (like a <code>Range</code>), don&#39;t bother. If it&#39;s a 3rd-party class from some reference type library, it can&#39;t hurt - but it&#39;s probably redundant.  Also worth noting, if the object was declared with <code>As New {class-name}</code>, then setting it to <code>Nothing</code> has no effect whatsoever."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530115044, "post_id": 51065566, "comment_id": 89123882, "body": "@MathieuGuindon Oh no......Thank you for correcting. It is a really useful comment. I hope it is all in the answer below as I will be bookmarking."}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1530114258, "post_id": 51066727, "comment_id": 89123408, "body": "Thank you for clearing this up. I kept seeing it and was beginning to wonder if I was making a newbie mistake by not doing so. All instances of <b>Set Nothing</b> have been removed!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530115267, "post_id": 51066727, "comment_id": 89123995, "body": "So how does this fit with IE instances for example grinding a PC to a halt even though out of scope when coders haven&#39;t quit the application. Is this a distinction on a process over an object?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 6, "creation_date": 1530115436, "post_id": 51066727, "comment_id": 89124080, "body": "@QHarr I don&#39;t do IE stuff in VBA, but if I did, I&#39;d probably enclose the instance in a <code>With</code> block, e.g. <code>With New InternetExplorer</code> or whatever the class name is: when the <code>With</code> blocks owns the instance, the object dies when <code>End With</code> is reached."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530115556, "post_id": 51066727, "comment_id": 89124142, "body": "Ok. Thank you ."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 1, "creation_date": 1547840758, "post_id": 51066727, "comment_id": 95345112, "body": "That&#39;s a really nice note on the <code>With</code> blocks"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 17, "last_activity_date": 1530114037, "creation_date": 1530114037, "answer_id": 51066727, "question_id": 51065566, "link": "https://stackoverflow.com/questions/51065566/what-are-the-benefits-of-setting-objects-to-nothing/51066727#51066727", "title": "What are the benefits of setting objects to &quot;Nothing&quot;", "body": "<p>If this was managed .NET code (which is <em>garbage-collected</em>), you'd have to <code>Release</code> every single COM object you ever accessed, lest the host process (EXCEL.EXE) would likely remain running in the background, consuming memory and unable to completely tear down.</p>\n\n<p>But this is VBA code (which is <em>reference-counted</em>), moreover VBA code that uses objects that the host application controls - these objects will die when the host application shuts down, and when that happens the VBA execution context is long gone.</p>\n\n<p>In other words, all these <code>Set ... = Nothing</code> instructions are completely redundant.</p>\n\n<hr>\n\n<p>In some specific cases, when you're dealing with a 3rd-party API / type library, it's possible that objects don't entirely clean up. For example you might be creating an <code>Access.Application</code> instance, and find that a \"ghost\" ACCESS.EXE process remains open in Task Manager well after Excel exited: that's a sign that you're leaking an object reference somehow, somewhere, and <code>Set ... = Nothing</code> can help prevent that.</p>\n\n<p>However I wouldn't recommend systematically nulling all object references like that. Only when <em>not</em> doing it causes a problem. And even then, it's going to be one or two objects dragging everything down, not <em>all of them</em>. If ACCESS.EXE shuts down properly, there's no reason to clutter up your code with such instructions.</p>\n\n<p>Avoiding storing object references in global state helps, too. If everything is local, in theory all objects involved are destroyed as soon as the local scope exits.</p>\n"}], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 5, "accepted_answer_id": 51066727, "answer_count": 1, "score": 12, "last_activity_date": 1614095232, "creation_date": 1530110239, "last_edit_date": 1614095232, "question_id": 51065566, "link": "https://stackoverflow.com/questions/51065566/what-are-the-benefits-of-setting-objects-to-nothing", "title": "What are the benefits of setting objects to &quot;Nothing&quot;", "body": "<p>I've noticed that some members of the Stack Overflow community will use <code>Set Object = Nothing</code> in closing procedures. I was able to find why this is useful for instances of Access, but no answer has been satisfying when it comes to doing this for Excel, so my question is\n<strong>What are the benefits of setting objects to Nothing in VBA?</strong></p>\n<p>In the sample code below, is setting my objects <code>ws</code> and <code>Test</code> equal to <code>Nothing</code> a waste of space? <strong>Else, if doing so is in fact good practice, why?</strong></p>\n<pre><code>Dim ws as Worksheet\nDim Test as Range\n\nSet ws = Sheets(\u201cSheet1\u201d)\nSet Test = ws.Range(\u201cA1\u201d)\n\n    'Utilize Test variable (copy, paste, etc)\n\nSet Test = Nothing\nSet ws = Nothing\n\nExit Sub \n</code></pre>\n"}, {"tags": ["sql", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1530118389, "creation_date": 1530118389, "answer_id": 51067913, "question_id": 51065495, "link": "https://stackoverflow.com/questions/51065495/display-results-of-sql-query-horizontally-in-multicolumn-listbox/51067913#51067913", "title": "Display results of SQL query horizontally in multicolumn listbox", "body": "<p><code>rs.GetRows</code> returns the data in a 2-dimensional array with the first index is the field (column) and the second index is the row.<br>\nThe <code>listbox.list</code> expects the data as 2-dimensional array, but with the first index as row, the second as the columns.</p>\n\n<p>So all you have to do is to transpose the data:</p>\n\n<pre><code>.list =  Application.Transpose(arr)\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 51067913, "answer_count": 1, "score": 0, "last_activity_date": 1530118389, "creation_date": 1530110044, "question_id": 51065495, "link": "https://stackoverflow.com/questions/51065495/display-results-of-sql-query-horizontally-in-multicolumn-listbox", "title": "Display results of SQL query horizontally in multicolumn listbox", "body": "<p>I have a SQL query that pulls in five columns of information from a table as an array then feeds the results to a Listbox in a tool I've written in Excel with VBA. </p>\n\n<p>Right now it is displaying the results vertically, and I need them to display horizontally. One column in the Listbox should display one column from the SQL table. The listbox properties give it five columns of equal width, and I'm not sure why this isn't working. </p>\n\n<pre><code>Sub searchall()\nDim Cn As ADODB.Connection\nDim Server_Name As String\nDim Database_Name As String\nDim SQLStr As String\nDim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\nDim list As Object\nSet list = SearchForm.Results\nServer_Name = \"SDL02-VM25\"\nDatabase_Name = \"PIA\"\nSQLStr = \"select [Agentname],[position],[employeegroup],[supervisor],[manager] from dbo.[HistoricalMasterStaffing] [FirstName] ='\" &amp; SearchForm.firstname.value &amp; \"' or [LastName] ='\" &amp; SearchForm.lastname.value &amp; \"' or [Date] = '\" &amp; SearchForm.DateSearch.value &amp; \"' or [year] = '\" &amp; SearchForm.Year.value &amp; \"' or [employeegroup] = '\" &amp; SearchForm.EmployGroup.value &amp; \"' or [position] = '\" &amp; SearchForm.Position.value &amp; \"' or [ftpt] = '\" &amp; SearchForm.PTFT.value &amp; \"' or [Contractagency] = '\" &amp; SearchForm.Agency.value &amp; \"' or [termcode] = '\" &amp; SearchForm.TermCode.value &amp; \"'\nSet Cn = New ADODB.Connection\nCn.Open \"Driver={SQL Server};Server=\" &amp; Server_Name &amp; \";Database=\" &amp; Database_Name &amp; vbNullString\nrs.Open SQLStr, Cn, adOpenStatic\nWith list\nDim arr()\narr() = rs.GetRows\n.list = arr()\nEnd With\nrs.Close\nCn.Close\nSet rs = Nothing\nSet Cn = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1530118870, "post_id": 51065410, "comment_id": 89125887, "body": "I <i>really</i> start to think you should read more into data normalization. Considering your previous question and this question, it&#39;s likely you&#39;re storing things in different columns that should actually sit in different rows."}, {"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1530200826, "post_id": 51065410, "comment_id": 89162330, "body": "I had actually explored that avenue until I realized how I wanted to use the data in the tables later in my program.  I appreciate how you looked at the situation from a different prespective, and I will reconsider that approach."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1530111351, "post_id": 51065842, "comment_id": 89121668, "body": "i just started programming in Access and I am not familiar with SQL in any manner.  Is there any other declarations I must make at the begining of my function to use SQL Methods/ Operations?"}, {"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1530112518, "post_id": 51065842, "comment_id": 89122439, "body": "When the line &quot;Set rs = dB.OpenRecordSet(strSQL)&quot; runs I get  a &quot;Data type mismiatch in criteria expression.&quot;  Error 3464., and your internal for loop doesn&#39;t end so I closed it.  Any thoughts on the error?"}, {"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1530112547, "post_id": 51065842, "comment_id": 89122457, "body": "I have the strSQL declared as a String."}, {"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1530113083, "post_id": 51065842, "comment_id": 89122791, "body": "Might it have something to do with having rs As a DAO.Recordset earlier in my function?"}, {"owner": {"reputation": 689, "user_id": 4731063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RNPgT.png?s=128&g=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/4731063/pants"}, "reply_to_user": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1530114799, "post_id": 51065842, "comment_id": 89123731, "body": "@HarmLeastOne please review my answer again. I have updated it with clarifications as well as a suggestion. Sounds like you issue is just in your query syntax/data type issue"}, {"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1530116969, "post_id": 51065842, "comment_id": 89124952, "body": "I have tried the strSQL method above and tried the suggested syntax corrections.  Still no luck and still the same error.  As I mentioned in the query answer, what I am trying to accomplish to much more complex.  Take a look if you have the time and see what I am really trying to do."}, {"owner": {"reputation": 689, "user_id": 4731063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RNPgT.png?s=128&g=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/4731063/pants"}, "reply_to_user": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1530117819, "post_id": 51065842, "comment_id": 89125378, "body": "My suggestion of making a MS Access Query was to ensure you that those were the results you wanted your VBA to concatenate. Also to make sure the query worked. Did you make the query and verify the results? if your getting the same error THERE (Data type mismatch), then you either need to change the datatype of your field, or cast you &quot;i&quot; as a matching data type. SQL wont automatically detect datatype differences"}], "tags": [], "owner": {"reputation": 689, "user_id": 4731063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RNPgT.png?s=128&g=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/4731063/pants"}, "is_accepted": false, "score": 0, "last_activity_date": 1530114523, "last_edit_date": 1530114523, "creation_date": 1530111094, "answer_id": 51065842, "question_id": 51065410, "link": "https://stackoverflow.com/questions/51065410/looping-through-multiple-access-2016-tables-to-create-a-concatenated-string-base/51065842#51065842", "title": "Looping Through Multiple Access 2016 Tables to Create a Concatenated String Based on a Common Key In Each Table", "body": "<p>If your problem seems to lie in the find first, then here is a similar modification to a OpenRecordset that I have in one of my applications. </p>\n\n<pre><code>Dim dB As Database\nDim rs As DAO.Recordset\nDim strSQL As String\n\nSet dB = CurrentDB()    \nstrSQL = \"SELECT * FROM TableOne WHERE Key = \" &amp; i\n\nSet rs = dB.OpenRecordset(strSQL)\n\nWith rs\n    If Not .BOF And Not .EOF Then\n        .MoveFirst\n        While (Not .EOF)\n            For Each fld In rs.Fields\n                If outputTextstring = \"\" then\n                    outputTextstring = fld.Value\n                Else\n                    outputTextString = outputTextString &amp; \"|\" &amp; fld.Value\n                End If\n            .MoveNext\n        Wend\n    End If\n    .Close\nEnd With\n</code></pre>\n\n<p>If the end result is to just find the FIRST record, then you can simply change the SQL Statement to only look for the first one it finds</p>\n\n<pre><code>strSQL = \"SELECT TOP 1 * FROM TableOne WHERE Key = \" &amp; i\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I have updated my answer to include the declarations. However whenever working with SQL queries in VBA, I would highly suggest to first create your query as an Access Query, testing and verifying the results, then copy the SQL Text in your VBA after you have verified. This is to remove the headache of figuring out if its a VBA problem or SQL Syntax issue.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1530115449, "post_id": 51066770, "comment_id": 89124090, "body": "It would be my first time creating a query but I will give it a try.  I will let you know if it works."}, {"owner": {"reputation": 689, "user_id": 4731063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RNPgT.png?s=128&g=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/4731063/pants"}, "edited": false, "score": 0, "creation_date": 1530116316, "post_id": 51066770, "comment_id": 89124565, "body": "This solution could work, however i don&#39;t think it would scale very well. Any additions or deletions of fields would have to be edited in the query EVERY time you made a change."}, {"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1530116656, "post_id": 51066770, "comment_id": 89124760, "body": "At this point if I use a query I must explain the situation a little further.  I am looking to make my string from three tables, compare it to existing string, then if it doesn&#39;t match, compare it to the next record or concatenated string from the same process.  I am unsure if I can query within a loop like that.  Any thoughts?"}, {"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1530116773, "post_id": 51066770, "comment_id": 89124834, "body": "It would be a static table used to compare an existing string to what is in the three tables.  The existing table entries would not change.  Existing stings that do no match the concatenated entries would then become new entries in all three tables."}, {"owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "edited": false, "score": 0, "creation_date": 1530117159, "post_id": 51066770, "comment_id": 89125045, "body": "This all comes about due to the limit of 255 fields in a table.  I should just use Excel and make one large table."}, {"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1530117412, "post_id": 51066770, "comment_id": 89125173, "body": "<b>HarmLeastOne</b>,  where is the &quot;existing string&quot; coming from that you&#39;re comparing to values in the tables? There might be a better way to do this comparison than concatenating fields in all 3 tables."}], "tags": [], "owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "is_accepted": false, "score": 1, "last_activity_date": 1530114167, "creation_date": 1530114167, "answer_id": 51066770, "question_id": 51065410, "link": "https://stackoverflow.com/questions/51065410/looping-through-multiple-access-2016-tables-to-create-a-concatenated-string-base/51066770#51066770", "title": "Looping Through Multiple Access 2016 Tables to Create a Concatenated String Based on a Common Key In Each Table", "body": "<p>I think you might be better off creating a query in Access to give you the results you need. If you know that all 3 tables are always to going to have a record with the given <code>ID</code>, you can create 1 query that has the fields concatenated as you need:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lOHxs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lOHxs.png\" alt=\"Query\"></a>\n<a href=\"https://i.stack.imgur.com/iqP7E.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iqP7E.png\" alt=\"Query Results\"></a></p>\n\n<p>If it's possible that some tables don't have a value for the given key, then that makes the problem a bit more complex, but your job is still easier with queries that concatenate the fields as you need.</p>\n\n<p>Another thing to consider: Your current code will include the key 3 times in your output text. If that's not necessary, you can exclude the key from your output (as I did in the query above, or you can start your VBA field-looping at 1, to exclude the first Key field).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "is_accepted": true, "score": 0, "last_activity_date": 1530273430, "creation_date": 1530273430, "answer_id": 51101228, "question_id": 51065410, "link": "https://stackoverflow.com/questions/51065410/looping-through-multiple-access-2016-tables-to-create-a-concatenated-string-base/51101228#51101228", "title": "Looping Through Multiple Access 2016 Tables to Create a Concatenated String Based on a Common Key In Each Table", "body": "<p>So I started searching around for other methods of identifying records to avoid using the methods that I received an error for, and despite having not found the \"why\" the error occured int he first place, I fixed the problem indirectly.  Below is my soultion after I added a primary key to each table:</p>\n\n<pre><code>Dim dB As DAO.Database\nDim rs As DAO.Recordset\nDim fld As DAO.Field\n\n'I used this to skip the first two fields (the primary key and a group tag)\nx = 0\n\nSet rs = dB.OpenRecordset(\"TableOne\")\nrs.Index = \"PrimaryKey\"\nrs.MoveFirst\nrs.MoveLast\n'iStr is a loop incrementor turned into a string each loop to identify the key #\nrs.Seek \"=\", Val(iStr)\n\nFor Each fld In rs.Fields\n    If x &gt; 1 Then\n        If outputStr = \"\" Then\n            outputStr = fld.Value\n        Else\n            outputStr = outputStr &amp; \"|\" &amp; fld.Value\n        End if\n    End If\n    If Not fld.Value = \"\" Then\n        x = x + 1\n    End If\nNext fld\nrs.Close\n'repeat for the other two tables to concatenate all three strings\n</code></pre>\n\n<p>Its simple and it works, but I do appreciate all the help and feedback.  Thanks much everyone!</p>\n"}], "owner": {"reputation": 1, "user_id": 9995826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add214928df16ac964bb779692f27967?s=128&d=identicon&r=PG&f=1", "display_name": "HarmLeastOne", "link": "https://stackoverflow.com/users/9995826/harmleastone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 51101228, "answer_count": 3, "score": 0, "last_activity_date": 1530273430, "creation_date": 1530109761, "last_edit_date": 1530202983, "question_id": 51065410, "link": "https://stackoverflow.com/questions/51065410/looping-through-multiple-access-2016-tables-to-create-a-concatenated-string-base", "title": "Looping Through Multiple Access 2016 Tables to Create a Concatenated String Based on a Common Key In Each Table", "body": "<p>The Situation:</p>\n\n<p>I have three tables of which each entry in each table holds a common value in column 1, named <strong>Key</strong> (begining at 0 and incremented by +1 each entry).  I am trying to concatenate a string consisting of each field value, in each table, at a specific row <strong>(i)</strong> based on the common \"key\" value in all three tables.</p>\n\n<pre><code>Dim dB As DAO.Database\nDim rs As DAO.Recordset\nDim fld As DAO.Field\n\nDim outputTextstring As String\n\nSet dB = CurrentDb\n\n    i = 4\n\n    Set rs = dB.OpenRecordset(\"TableOne\")\n    rs.FindFirst \"[Key] = \" &amp; i\n    For Each fld In rs.Fields\n        If outputTextstring = \"\" then\n            outputTextstring = fld.Value\n        Else\n            outputTextString = outputTextString &amp; \"|\" &amp; fld.Value\n        End If\n    Next\n    rs.Close\n\n    Set rs = dB.OpenRecordset(\"TableTwo\")\n    rs.FindFirst \"[Key] = \" &amp; i\n    For Each fld In rs.Fields\n        If outputTextstring = \"\" then\n            outputTextstring = fld.Value\n        Else\n            outputTextString = outputTextString &amp; \"|\" &amp; fld.Value\n        End If\n    Next\n    rs.Close\n\n    Set rs = dB.OpenRecordset(\"TableThree\")\n    rs.FindFirst \"[Key] = \" &amp; i\n    For Each fld In rs.Fields\n        If outputTextstring = \"\" then\n            outputTextstring = fld.Value\n        Else\n            outputTextString = outputTextString &amp; \"|\" &amp; fld.Value\n        End If\n    Next\n    rs.Close\n</code></pre>\n\n<p>I get a Run-time error '3251' on the .FindFirst line, stating \"Operation is not supported for this type of object.\"  I am guessing this is a syntax error but any help would be appreciated.</p>\n\n<p><strong>Edit: (Additional Question)</strong>\nAfter searching several other threads the problem might be the fact that the field \"<strong>Key</strong>\" is a Short Text Data type when viewed in the Design View of the Table, and data I am searching for or \"<strong>i</strong>\" is an integer or a string when I declare it.  Is it true like I have read in other threads that \"Access sucks\" and the two data types cannot intermingle?</p>\n"}, {"tags": ["javascript", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 19955, "user_id": 101087, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/646f0fa3075659904242cf6f576ed2e9?s=128&d=identicon&r=PG", "display_name": "NineBerry", "link": "https://stackoverflow.com/users/101087/nineberry"}, "edited": false, "score": 0, "creation_date": 1530110399, "post_id": 51065371, "comment_id": 89121046, "body": "What exactly is your environment (VB.net, VBA in some Office application, VBScript inside the Browser or something else)? Please show code what you have tried so far, so we can see how you get access to the HTML document in the first place."}], "answers": [{"comments": [{"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1530110152, "post_id": 51065441, "comment_id": 89120867, "body": "I receive the answer: &quot;Method &#39;querySelector&#39; of object &#39;JScriptTypeInfo&#39; failed&quot;."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1530111143, "post_id": 51065441, "comment_id": 89121540, "body": "It doesn&#39;t like the partial javascript line. Hang on."}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1530111293, "post_id": 51065441, "comment_id": 89121638, "body": "Hi QHarr, thanks for help but neither worked for me, whereas SIM&#39;s line was a success. I am certain that your approach is as efficient but perhaps my inability to work with querySelector prevented me from succeeding. Cheers"}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1530125308, "post_id": 51065441, "comment_id": 89129003, "body": "I&#39;ll review in the morning. Thanks (I will respond)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1530126504, "post_id": 51065441, "comment_id": 89129565, "body": "No worries but kind of you to say. SIM is awesome so you are in good hands."}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1530174626, "post_id": 51065441, "comment_id": 89144989, "body": "Hi @SIM , I have posted new (similar) question. Please feel free to take a look at it - maybe you can help."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1530126584, "last_edit_date": 1530126584, "creation_date": 1530109871, "answer_id": 51065441, "question_id": 51065371, "link": "https://stackoverflow.com/questions/51065371/how-to-engage-java-type-button-on-ie-with-vba/51065441#51065441", "title": "How to engage Java type button on IE with VBA", "body": "<p><strong>CSS selector:</strong></p>\n\n<p>You could use a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">CSS selector</a> of: <code>a[onclick='javascript:doSubmit('Edit-1');']</code> .</p>\n\n<p>This says get element(s) with <code>a</code> tag that have an attribute <code>onclick</code> whose value contains <code>'javascript:doSubmit('Edit-1');'</code></p>\n\n<hr>\n\n<p><strong>CSS query:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/h2ppD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h2ppD.png\" alt=\"CSS query\"></a></p>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<p>A CSS selector, for a single element, is applied via the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector\" rel=\"nofollow noreferrer\"><code>.querySelector</code></a> method of document. So you need to have an <code>HTMLDocument</code> to query. Either by the <code>.document</code> of an IE instance, when using IE to browse to the page and it has loaded, or by loading an <code>HTMLDocument</code> object with <code>responseText</code> from <code>HTTPrequest/WinHTTP</code>.</p>\n\n<p>E.g. After page loaded:</p>\n\n<pre><code>ie.document.querySelector(\"a[onclick='javascript:doSubmit('Edit-1');']\").Click\n</code></pre>\n\n<p>Here, <code>ie</code> is your Internet Explorer browser instance.</p>\n\n<hr>\n\n<p><strong>querySelectorAll:</strong></p>\n\n<p>I am assuming this will match a single element, or that the first is the one required. It looks pretty specific. You can use <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorall\" rel=\"nofollow noreferrer\"><code>.querySelectorAll</code></a> method to return a <code>nodeList</code>, if there is more than one element that matches. You would then index by position (from 0) into that <code>nodeList</code> e.g.</p>\n\n<pre><code>.document.querySelectorAll(\"a[onclick='javascript:doSubmit('Edit-1');']\").item(1).Click\n</code></pre>\n\n<p>or potentially,</p>\n\n<pre><code>.document.querySelectorAll(\"a[onclick='javascript:doSubmit('Edit-1');']\")(1).Click\n</code></pre>\n\n<p>The 1 above is an example index which would be at position 2 in a 0 based nodeList.</p>\n"}, {"comments": [{"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1530111190, "post_id": 51065684, "comment_id": 89121573, "body": "This one worked. IE.Document.querySelector(&quot;a[title=&#39;PressHERE&#39;]&quot;).Click"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1530111296, "post_id": 51065684, "comment_id": 89121640, "body": "That was more sensible +1"}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": true, "score": 4, "last_activity_date": 1530110616, "creation_date": 1530110616, "answer_id": 51065684, "question_id": 51065371, "link": "https://stackoverflow.com/questions/51065371/how-to-engage-java-type-button-on-ie-with-vba/51065684#51065684", "title": "How to engage Java type button on IE with VBA", "body": "<p>Try this and let us know the feedback.</p>\n\n<pre><code>Dim IE As New InternetExplorer, Html As HTMLDocument\nSet Html = IE.document  'consider adding this line in your script in order for `.querySelector()` to run successfully\nHtml.querySelector(\"a[title='PressHERE']\").Click\n</code></pre>\n"}], "owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 1, "accepted_answer_id": 51065684, "answer_count": 2, "score": 2, "last_activity_date": 1530126584, "creation_date": 1530109665, "last_edit_date": 1530110466, "question_id": 51065371, "link": "https://stackoverflow.com/questions/51065371/how-to-engage-java-type-button-on-ie-with-vba", "title": "How to engage Java type button on IE with VBA", "body": "<p>Can you please advise how can I initiate .click [or alternative] on \"PressHERE\" button on IE website [VBA]? I have tried calling it by classname, tagname and even Id which is not stated in the websites source. </p>\n\n<pre><code>&lt;tr&gt;\n    &lt;td class=\"center edl_checkbox\" style=\"padding-left: 15px;\"&gt;\n        &lt;input type=\"hidden\" name=\"_orgSearchResultList[1].isSelected\"&gt;\n        &lt;label class=\"edl_chb\"&gt;\n            &lt;input type=\"checkbox\" id=\"1\" name=\"orgSearchResultList[1].isSelected\" value=\"true\" /&gt;\n            &lt;span&gt;&lt;/span&gt;\n        &lt;/label&gt;\n    &lt;/td&gt;\n    &lt;td class=\"center\"&gt;\n        &lt;a href=\"#\" onclick=\"javascript:doSubmit('Edit-1');\" title=\"PressHERE\"&gt;\n            PressHERE\n        &lt;/a&gt;\n        &lt;input type=\"hidden\" id=\"Org1\" value=\"PressHERE\"/&gt;\n    &lt;/td&gt;\n    &lt;td class=\"center\" title=\"PressHERE\"&gt;\n        PressHERE\n</code></pre>\n\n<p>The specific line that is highlighted when \"inspecting elements\" on the site is this:</p>\n\n<pre><code>&lt;td class=\"center\"&gt;&lt;a href=\"#\" onclick=\"javascript:doSubmit('Edit-1');\" title=\"PressHERE\"&gt;PressHERE\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10000462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c16dda41087669c7076741d3e542087?s=128&d=identicon&r=PG&f=1", "display_name": "F Hortas", "link": "https://stackoverflow.com/users/10000462/f-hortas"}, "edited": false, "score": 0, "creation_date": 1530110618, "post_id": 51065434, "comment_id": 89121196, "body": "I tried this and i get a syntax error (comma) in query expression &#39;t1.acct between t1.from, t1.to&#39;"}, {"owner": {"reputation": 1812, "user_id": 3416648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qsynr.png?s=128&g=1", "display_name": "DDS", "link": "https://stackoverflow.com/users/3416648/dds"}, "reply_to_user": {"reputation": 21, "user_id": 10000462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c16dda41087669c7076741d3e542087?s=128&d=identicon&r=PG&f=1", "display_name": "F Hortas", "link": "https://stackoverflow.com/users/10000462/f-hortas"}, "edited": false, "score": 0, "creation_date": 1530110990, "post_id": 51065434, "comment_id": 89121435, "body": "fixed: added semicolon at the end and <code>and</code> in <code>between</code> clause"}], "tags": [], "owner": {"reputation": 1812, "user_id": 3416648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qsynr.png?s=128&g=1", "display_name": "DDS", "link": "https://stackoverflow.com/users/3416648/dds"}, "is_accepted": false, "score": 0, "last_activity_date": 1530112034, "last_edit_date": 1530112034, "creation_date": 1530109858, "answer_id": 51065434, "question_id": 51065283, "link": "https://stackoverflow.com/questions/51065283/need-to-create-a-sql-statement-in-ms-access-2010-to-count-multiple-records-in/51065434#51065434", "title": "Need to create a SQL statement in MS Access (2010) to count multiple records in a range", "body": "<p>I'll do something like this:</p>\n\n<pre><code>select count(*) as count, table1.tfrom, table1.to\nfrom table2, table1\nwhere table2.acct between table1.tfrom and table1.to\ngroup by table1.tfrom, table1.to;\n</code></pre>\n\n<p>please avoid \"SQL\" words like from and to in table/column names</p>\n"}, {"tags": [], "owner": {"reputation": 47907, "user_id": 5529445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-QDYZSTy6VIw/AAAAAAAAAAI/AAAAAAAAAAA/tRnSAB9slkM/photo.jpg?sz=128", "display_name": "Yogesh Sharma", "link": "https://stackoverflow.com/users/5529445/yogesh-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1530111084, "creation_date": 1530111084, "answer_id": 51065835, "question_id": 51065283, "link": "https://stackoverflow.com/questions/51065283/need-to-create-a-sql-statement-in-ms-access-2010-to-count-multiple-records-in/51065835#51065835", "title": "Need to create a SQL statement in MS Access (2010) to count multiple records in a range", "body": "<p>Use <em>correlated</em> subquery :</p>\n\n<pre><code>select *, (select count(*) \n           from table2 t2 \n           where t2.acct &gt;= t1.from and \n                 t2.acct &lt;= t1.to\n          ) as Count\nfrom table1 t1;\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10000462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c16dda41087669c7076741d3e542087?s=128&d=identicon&r=PG&f=1", "display_name": "F Hortas", "link": "https://stackoverflow.com/users/10000462/f-hortas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1530112034, "creation_date": 1530109400, "last_edit_date": 1530109459, "question_id": 51065283, "link": "https://stackoverflow.com/questions/51065283/need-to-create-a-sql-statement-in-ms-access-2010-to-count-multiple-records-in", "title": "Need to create a SQL statement in MS Access (2010) to count multiple records in a range", "body": "<p>I have two tables in MS access.  Need to create a table that lookups the ranges in table1 and counts the records in table2, within that range.  </p>\n\n<p>Table1</p>\n\n<pre><code>FROM        TO\n00100000    00799999\n00800000    00899999\n00900000    01599999\n01600000    01899999\n</code></pre>\n\n<p>Table2</p>\n\n<pre><code>Acct\n00103614\n00103615\n00103624\n00103626\n00104001\n00104002\n00104003\n00104004\n00104302\n00104400\n00104401\n00104404\n00104406\n00104407\n01622345\n01622347\n01622353\n01622357\n01622359\n01622362\n01622365\n01622366\n01622368\n</code></pre>\n\n<p>Desired output:</p>\n\n<pre><code>FROM        TO          Count\n00100000    00799999    50\n00800000    00899999    10\n00900000    01599999     0\n01600000    01899999    42\n</code></pre>\n\n<p>Thanks\nFrank</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530109494, "post_id": 51065193, "comment_id": 89120428, "body": "Depending on what you need to do with them. If you need to <b>remove any extra leading or trailing whitespaces</b>, instead of checking them through regex, why not just <a href=\"https://www.techonthenet.com/excel/formulas/trim.php\" rel=\"nofollow noreferrer\"><code>Trim()</code></a> them instead?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530109571, "post_id": 51065193, "comment_id": 89120477, "body": "@Rawrplus - I don&#39;t think Trim works on ChrW(8203)."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530109754, "post_id": 51065193, "comment_id": 89120606, "body": "No it doesn&#39;t, though it is a place to start. Might want to trim it initially, and then remove any extra unwanted characters such as hairspace with <a href=\"https://www.techonthenet.com/excel/formulas/replace_vba.php\" rel=\"nofollow noreferrer\"><code>REPLACE()</code></a> I am however too lazy to re-create a working replace condition / regexp for all the unwanted characters you provided above. <i>sorry...</i>"}], "answers": [{"tags": [], "owner": {"reputation": 37436, "user_id": 1215106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/615ff12525dbd5868b7c78d9754aed72?s=128&d=identicon&r=PG", "display_name": "\u2126mega", "link": "https://stackoverflow.com/users/1215106/%e2%84%a6mega"}, "is_accepted": false, "score": 2, "last_activity_date": 1566910508, "last_edit_date": 1566910508, "creation_date": 1530109839, "answer_id": 51065426, "question_id": 51065193, "link": "https://stackoverflow.com/questions/51065193/how-to-match-all-whitespace-in-vba/51065426#51065426", "title": "How to match all whitespace in VBA", "body": "<p>There is no perfect alternative, therefore I suggest to use exact values/codes.</p>\n\n<p>You should be safe with this regex pattern:</p>\n\n<pre><code>[\\s\\n\\r\\t \\xA0\\u1680\\u180E\\u2000-\\u200B\\u202F\\u205F\\u3000\\uFEFF]+\n</code></pre>\n"}], "owner": {"reputation": 2000, "user_id": 2828611, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ef0750630716bedbe40a67e834728a1?s=128&d=identicon&r=PG&f=1", "display_name": "inetphantom", "link": "https://stackoverflow.com/users/2828611/inetphantom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "closed_date": 1530272576, "answer_count": 1, "score": -1, "last_activity_date": 1566910508, "creation_date": 1530109136, "last_edit_date": 1564570542, "question_id": 51065193, "link": "https://stackoverflow.com/questions/51065193/how-to-match-all-whitespace-in-vba", "closed_reason": "Duplicate", "title": "How to match all whitespace in VBA", "body": "<p>I am having a similar issue <a href=\"https://stackoverflow.com/questions/8501586/vba-6-regex-not-recognizing-complicated-string\">as this question here</a>. <code>\\s</code> is not matching all white spaces in VBA.</p>\n\n<p>But I want to catch <a href=\"https://en.wikipedia.org/wiki/Whitespace_character#Definition_and_ambiguity\" rel=\"nofollow noreferrer\">all kinds of whitespace - spaces, tabs, newlines, thin space, hair space etc.</a> and not only one of them.</p>\n\n<p>Is there another possibility than hard coding every unicode value like the following?</p>\n\n<pre><code>With regEx\n    .Global = True\n    .Pattern = \"(\\s|\\u2009|\\u2008|.............)\"\nEnd With\n</code></pre>\n\n<blockquote>\n  <p><a href=\"https://stackoverflow.com/questions/28617616/how-do-i-isolate-a-space-using-regexp-in-vba-s-vs-pzs\">How do I isolate a space using RegExp in VBA (\\s vs. \\p{Zs})?</a> wants to isolate spaces - I want readable and reliable way to match any whitespace without needing to list the unicode values for them as proposed by the one who closed the question.</p>\n</blockquote>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010", "outlook-2010", "outlook-redemption"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530109253, "post_id": 51064636, "comment_id": 89120251, "body": "Can you reference the Outlook and Redemption type libraries instead of late-binding?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1530294713, "post_id": 51064636, "comment_id": 89201132, "body": "Is it just this box that is running Access 64 bit? You might have to distribute and register the 64 bit version of Redemption"}], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 9437110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb42963fea25acac17f39c7f3738bd25?s=128&d=identicon&r=PG&f=1", "display_name": "user525966", "link": "https://stackoverflow.com/users/9437110/user525966"}, "edited": false, "score": 0, "creation_date": 1530112460, "post_id": 51065015, "comment_id": 89122403, "body": "The bitnesses do match, yes (both are 64-bit)"}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 0, "creation_date": 1530112546, "post_id": 51065015, "comment_id": 89122456, "body": "Interesting - this might explain why my VB 6 (32-bit) application has stopped working with Outlook 2016.  Unfortunately I don&#39;t think there&#39;s a corresponding CPU option in my VB6 compiler - I may have to uninstall Office 64-bit and install the 32-bit version, if there&#39;s even one available.  That would also explain why I&#39;m not hearing of the problem from my customers, only me."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1530117860, "post_id": 51065015, "comment_id": 89125397, "body": "Your VBA code should still work fine. Try to re-register the 64 bit version of Redemption (redemption64.dll) with regsvr32.exe."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1530108670, "creation_date": 1530108670, "answer_id": 51065015, "question_id": 51064636, "link": "https://stackoverflow.com/questions/51064636/outlook-redemption-error-in-ms-access-activex-component-cant-create-object/51065015#51065015", "title": "Outlook Redemption error in MS Access: ActiveX component can&#39;t create object", "body": "<p>Make sure the bitness of Outlook marches the bitness of Access - see <a href=\"http://www.dimastr.com/redemption/faq.htm#ErrorCreatingRedemptionObject\" rel=\"nofollow noreferrer\">http://www.dimastr.com/redemption/faq.htm#ErrorCreatingRedemptionObject</a> for more details.</p>\n"}], "owner": {"reputation": 305, "user_id": 9437110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb42963fea25acac17f39c7f3738bd25?s=128&d=identicon&r=PG&f=1", "display_name": "user525966", "link": "https://stackoverflow.com/users/9437110/user525966"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530108670, "creation_date": 1530107625, "question_id": 51064636, "link": "https://stackoverflow.com/questions/51064636/outlook-redemption-error-in-ms-access-activex-component-cant-create-object", "title": "Outlook Redemption error in MS Access: ActiveX component can&#39;t create object", "body": "<p>Code:</p>\n\n<pre><code>    Dim Application As Object, namespace As Object\n    Set Application = CreateObject(\"Outlook.Application\")\n    Set namespace = Application.GetNamespace(\"MAPI\")\n    namespace.Logon\n\n    Set safeItem = CreateObject(\"Redemption.SafeMailItem\") ' Error here!\n</code></pre>\n\n<p>Normally this code works fine on most of my boxes -- but in this case I am running this in MS Access 2010 (64-bit) if it matters.</p>\n\n<p>But the line where safeItem is assigned, I get the error that \"ActiveX component cannot create object.\" What does this even mean? Why can't I create the object? The reference to Redemption seems to be okay / doesn't show as MISSING or anything.</p>\n\n<p>I Google this error and there seems to be numerous possible causes since the error is so vague. Is there a well-known reason for this particular instance?</p>\n"}, {"tags": ["xml", "vba", "xml-parsing"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530108725, "post_id": 51064342, "comment_id": 89119896, "body": "Why not use the Microsoft XML Library to parse? <a href=\"https://stackoverflow.com/a/11406/9912714\">How to parse XML using vba</a>"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1530108946, "post_id": 51064342, "comment_id": 89120043, "body": "It would probably be even easier and more flexible to setup an <code>ADODB.Connection</code> to the files and query them. <a href=\"http://www.vb-helper.com/howto_url_recordset.html\" rel=\"nofollow noreferrer\">Connect an ADO Recordset to an XML file located at a URL</a>"}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530109651, "post_id": 51064342, "comment_id": 89120532, "body": "@TinMan - I&#39;ve already been through this post and attempted the same. I guess I&#39;m unable to enter the name of the node correctly. Can you advise how the same code can be implemented in this piece?"}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530109746, "post_id": 51064342, "comment_id": 89120593, "body": "@TinMan - Reading the XML is not really the problem, I&#39;ve been able to get that bit for uploading multiple XMLs into Excel. My problem is more along the lines of how the amount of information that is uploaded into Excel can be limited to just the nodes I require."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1530111598, "post_id": 51064342, "comment_id": 89121830, "body": "That is precisely my point.  Parse or Query the XML and load the results.  You can even Query the files with an <code>ADODB.Connection</code> and it create a new XML File containing only the relevant data."}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530113496, "post_id": 51064342, "comment_id": 89123004, "body": "@TinMan My apologies, I&#39;m lost and my brain&#39;s fried :( Would you be able to replicate it here?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530113904, "post_id": 51064342, "comment_id": 89123222, "body": "I&#39;m working on it.  Your XML snippet is invalid.  I am assuming that you added the <code>***</code>.  I also think that it is an incomplete snippet which means that I will have to close the tags before it will work."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530114231, "post_id": 51064342, "comment_id": 89123393, "body": "The tags seem correct to me. Can you teset this  <a href=\"https://drive.google.com/open?id=1mFtvfGkOzoFnMee1Iico955kQu3fh4vV\" rel=\"nofollow noreferrer\">parse xml.txt</a> code for me?  I am refactoring <a href=\"http://www.vb-helper.com/howto_url_recordset.html\" rel=\"nofollow noreferrer\">Connect an ADO Recordset to an XML file located at a URL</a>."}, {"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530137479, "post_id": 51064342, "comment_id": 89134013, "body": "I get a runtime error 3001. Is a reference to be added?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530137681, "post_id": 51064342, "comment_id": 89134076, "body": "It looks like you have duplicate constant values.  Comment out the consrants"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1588026869, "post_id": 51457090, "comment_id": 108737254, "body": "I&#39;m sorry I never responded, you&#39;ve been a help and mentor throughout my VBA journey and I&#39;m grateful. Your code here was not exactly what I was looking for, but got me started in the right direction. Many thanks again!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "edited": false, "score": 0, "creation_date": 1588059015, "post_id": 51457090, "comment_id": 108746246, "body": "No worries. You can always add your solution remember! :-)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1532184083, "creation_date": 1532184083, "answer_id": 51457090, "question_id": 51064342, "link": "https://stackoverflow.com/questions/51064342/unable-to-parse-xml-to-get-specific-information-in-vba/51457090#51457090", "title": "Unable to parse XML to get specific information in VBA", "body": "<p>After removing the <code>\"***\"</code>, I then loaded your XML from file (<code>test.xml</code>). Provided you include the reference to the required namespace you can access as follows:</p>\n\n<pre><code>Option Explicit\nPublic Sub testing()\n    Dim xmlDoc As New MSXML2.DOMDocument60\n    xmlDoc.validateOnParse = True\n    xmlDoc.setProperty \"SelectionNamespaces\", \"xmlns:abcd=\"\"urn:lu:etat:acd:abcd_omn:v2.0\"\"\"\n    If xmlDoc.Load(\"C:\\Users\\User\\Desktop\\test.xml\") Then\n        Dim node As Object\n        Debug.Print xmlDoc.SelectNodes(\"//abcd:AddressReportingPerson\").Length\n        Debug.Print xmlDoc.SelectNodes(\"//abcd:NameReportingPerson\").Length\n        For Each node In xmlDoc.SelectNodes(\"//abcd:AddressReportingPerson\")\n            Debug.Print node.Text\n        Next node\n        For Each node In xmlDoc.SelectNodes(\"//abcd:NameReportingPerson\")\n            Debug.Print node.Text\n        Next node\n    Else\n        Debug.Print \"Houston, we have a problem!\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5154215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bij71.jpg?s=128&g=1", "display_name": "Renin Mathew", "link": "https://stackoverflow.com/users/5154215/renin-mathew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 51457090, "answer_count": 1, "score": 0, "last_activity_date": 1532184083, "creation_date": 1530106891, "question_id": 51064342, "link": "https://stackoverflow.com/questions/51064342/unable-to-parse-xml-to-get-specific-information-in-vba", "title": "Unable to parse XML to get specific information in VBA", "body": "<p>I've been building a little bot for my business and it is essential that multiple XML files are uploaded at once into Excel to perform the remainder of the bot. I've successfully been able to upload multiple XML's using a loop however, as all the XMLs are not in the same format, it is necessary that only the required information is uploaded into Excel. I've looked up different sources but looks like I am doing it incorrectly. The relevant VBA code I have so far to upload multiple XMLs is this,</p>\n\n<pre><code>Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    With Sheets(\"Working Notes\")\n        lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).row\n        For i = 1 To lastrow\n            strTargetFile = .Cells(i, \"A\")\n            Set Wb = Workbooks.OpenXML(FileName:=strTargetFile, LoadOption:=xlXmlLoadImportToList)\n            'wb.Sheets(1).UsedRange.Copy ThisWorkbook.Sheets(\"Working Notes\").Cells(Rows.Count, \"B\").End(xlUp).Offset(1, 0)\n            Wb.Sheets(1).UsedRange.Copy ThisWorkbook.Sheets(\"Working Notes\").Range(\"B\" &amp; i)\n            Wb.Close False\n        Next i\n    End With\n</code></pre>\n\n<p>The XML page I am looking at is this,</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;abcd_omn_gatca:abcd_omn xmlns:abcd=\"urn:lu:etat:acd:abcd_omn:v2.0\" xmlns:ftc=\"urn:lu:etat:acd:gatca:v2.0\" xmlns:sfa=\"urn:oecd:ties:stfgatcatypes:v2\" xmlns:abcd_omn_gatca=\"urn:lu:etat:acd:abcd_gatca:v2.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" version=\"2.0\" xsi:schemaLocation=\"urn:lu:etat:acd:abcd_gatca:v2.0 abcd_gatca_V2.0.xsd\"&gt;\n    &lt;abcd_omn_gatca:abcd_gatca&gt;\n        &lt;abcd_omn_gatca:abcd_RefId&gt;XXXXX&lt;/abcd_omn_gatca:abcd_RefId&gt;\n        &lt;abcd_omn_gatca:abcd_Depositor&gt;\n            &lt;abcd:NameDepositor&gt;XXXXX&lt;/abcd:NameDepositor&gt;\n            &lt;abcd:PersonalIdentificationNumberDepositor&gt;XXXXX&lt;/abcd:PersonalIdentificationNumberDepositor&gt;\n            &lt;abcd:AddressDepositor&gt;\n                &lt;abcd:StreetPhysical&gt;XXXXX&lt;/abcd:StreetPhysical&gt;\n                &lt;abcd:NumberPhysical&gt;XXXXX&lt;/abcd:NumberPhysical&gt;\n                &lt;abcd:PostalCodePhysical&gt;XXXXX&lt;/abcd:PostalCodePhysical&gt;\n                &lt;abcd:CityPhysical&gt;XXXXX&lt;/abcd:CityPhysical&gt;\n                &lt;abcd:CountryPhysical&gt;XXXXX&lt;/abcd:CountryPhysical&gt;\n            &lt;/abcd:AddressDepositor&gt;\n            &lt;abcd:PersonDepositor&gt;\n                &lt;abcd:Name&gt;XXXXX&lt;/abcd:Name&gt;\n                &lt;abcd:FirstName&gt;XXXXX&lt;/abcd:FirstName&gt;\n                &lt;abcd:EmailPersonal&gt;XXXXX&lt;/abcd:EmailPersonal&gt;\n                &lt;abcd:TelephoneDirect&gt;XXXXX&lt;/abcd:TelephoneDirect&gt;\n            &lt;/abcd:PersonDepositor&gt;\n        &lt;/abcd_omn_gatca:abcd_Depositor&gt;\n        &lt;abcd_omn_gatca:abcd_Declarer&gt;\n            &lt;abcd:NameDeclarer&gt;XXXXX&lt;/abcd:NameDeclarer&gt;\n            &lt;abcd:PersonalIdentificationNumberDeclarer&gt;XXXXX&lt;/abcd:PersonalIdentificationNumberDeclarer&gt;\n            &lt;abcd:AddressDeclarer&gt;\n                &lt;abcd:StreetPhysical&gt;XXXXX&lt;/abcd:StreetPhysical&gt;\n                &lt;abcd:NumberPhysical&gt;XXXXX&lt;/abcd:NumberPhysical&gt;\n                &lt;abcd:PostalCodePhysical&gt;XXXXX&lt;/abcd:PostalCodePhysical&gt;\n                &lt;abcd:CityPhysical&gt;XXXXX&lt;/abcd:CityPhysical&gt;\n                &lt;abcd:CountryPhysical&gt;XXXXX&lt;/abcd:CountryPhysical&gt;\n            &lt;/abcd:AddressDeclarer&gt;\n            &lt;abcd:PersonDeclarer&gt;\n                &lt;abcd:Name&gt;XXXXX&lt;/abcd:Name&gt;\n                &lt;abcd:FirstName&gt;XXXXX&lt;/abcd:FirstName&gt;\n                &lt;abcd:EmailPersonal&gt;XXXXX&lt;/abcd:EmailPersonal&gt;\n                &lt;abcd:EmailOrganisation&gt;XXXXX&lt;/abcd:EmailOrganisation&gt;\n                &lt;abcd:TelephoneDirect&gt;XXXXX&lt;/abcd:TelephoneDirect&gt;\n            &lt;/abcd:PersonDeclarer&gt;\n        &lt;/abcd_omn_gatca:abcd_Declarer&gt;\n        &lt;abcd_omn_gatca:abcd_ReportingPerson&gt;\n            ***&lt;abcd:NameReportingPerson&gt;RENIN III S.A R.L.&lt;/abcd:NameReportingPerson***&gt;\n            &lt;abcd:IdentificationNumber&gt;XXXXX&lt;/abcd:IdentificationNumber&gt;\n            &lt;abcd:IdentificationNumberExtension&gt;XXXXX&lt;/abcd:IdentificationNumberExtension&gt;\n            &lt;***abcd:AddressReportingPerson&gt;\n                &lt;abcd:StreetPhysical&gt;Avenue M.F. Brady&lt;/abcd:StreetPhysical&gt;\n                &lt;abcd:NumberPhysical&gt;45&lt;/abcd:NumberPhysical&gt;\n                &lt;abcd:PostalCodePhysical&gt;1234&lt;/abcd:PostalCodePhysical&gt;\n                &lt;abcd:CityPhysical&gt;Somethingburg&lt;/abcd:CityPhysical&gt;\n                &lt;abcd:CountryPhysical&gt;SB&lt;/abcd:CountryPhysical&gt;\n            &lt;/abcd:AddressReportingPerson&gt;***\n            &lt;abcd:PersonContactReportingPerson&gt;\n                &lt;abcd:Name&gt;XXXXX&lt;/abcd:Name&gt;\n                &lt;abcd:FirstName&gt;XXXXX&lt;/abcd:FirstName&gt;\n                &lt;abcd:EmailPersonal&gt;XXXXX&lt;/abcd:EmailPersonal&gt;\n                &lt;abcd:EmailOrganisation&gt;XXXXX&lt;/abcd:EmailOrganisation&gt;\n                &lt;abcd:TelephoneDirect&gt;XXXXX&lt;/abcd:TelephoneDirect&gt;\n            &lt;/abcd:PersonContactReportingPerson&gt;\n        &lt;/abcd_omn_gatca:abcd_ReportingPerson&gt;\n        &lt;abcd_omn_gatca:RFI_Identifier&gt;XXXXX&lt;/abcd_omn_gatca:RFI_Identifier&gt;\n        &lt;abcd_omn_gatca:ReportContent&gt;\n            &lt;abcd_omn_gatca:ReportingPeriod&gt;XXXXX&lt;/abcd_omn_gatca:ReportingPeriod&gt;\n            &lt;abcd_omn_gatca:ZeroReporting&gt;XXXXX&lt;/abcd_omn_gatca:ZeroReporting&gt;\n        &lt;/abcd_omn_gatca:ReportContent&gt;\n    &lt;/abcd_omn_gatca:abcd_gatca&gt;\n&lt;/abcd_omn_gatca:abcd_omn&gt;\n</code></pre>\n\n<p>The only piece of information I require is the name of the reporting person \"RENIN III S.A R.L.\" and the Address of the Reporting Person on the Excel sheet. Forgive me for my very immature knowledge of VBA. I will be much obliged for any help. Many thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "is_accepted": false, "score": 0, "last_activity_date": 1530107854, "creation_date": 1530107854, "answer_id": 51064714, "question_id": 51064306, "link": "https://stackoverflow.com/questions/51064306/excel-macro-to-delete-rows-in-a-sheet-based-on-a-roster-in-another-sheet/51064714#51064714", "title": "Excel Macro to delete rows in a sheet based on a roster in another sheet", "body": "<p>Try adding: </p>\n\n<pre><code>Application.ScreenUpdating = False 'Turn off screen updating. Code runs faster without screen flicker\nApplication.Calculation = xlManual  'Turns auto calc to manual\n</code></pre>\n\n<p>at the beginning of your code and :</p>\n\n<pre><code>Application.Calculation = xlAutomatic   'turns auto calc back on\nApplication.ScreenUpdating = True 'Turn on screen updating\n</code></pre>\n\n<p>at the end of your code, just before End Sub.</p>\n\n<p>I tackled this problem in the past by adding a 'cheater column' with a vlookup to a remote closed reference list.  Then I would place an AutoFilter using VBA on the data, deleting only the visible rows using <code>.SpecialCells(xlCellTypeVisible).EntireRow.Delete</code> ... then clear the helper lookup column.  Very fast!  Hope this helps and good luck.</p>\n"}], "owner": {"reputation": 11, "user_id": 10000192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IJG7I.jpg?s=128&g=1", "display_name": "Razzmania", "link": "https://stackoverflow.com/users/10000192/razzmania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530113539, "creation_date": 1530106794, "last_edit_date": 1531164843, "question_id": 51064306, "link": "https://stackoverflow.com/questions/51064306/excel-macro-to-delete-rows-in-a-sheet-based-on-a-roster-in-another-sheet", "title": "Excel Macro to delete rows in a sheet based on a roster in another sheet", "body": "<p>I import a lot of Raw data into a sheet \"data\" and I have another sheet called \"Roster\" (self-explanatory). I would like to Delete all of the rows in \"data\" that does not contain any of the names in \"Roster\". The information in Data is Column J and column A in \"roster\". I am currently using the code below but it takes a long time. </p>\n\n<pre><code>Sub roster_cleanup()\n\n    Const sh1Col As String = \"J\" \n    Const sh2Col As String = \"A\"\n\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim r1 As Long, r2 As Long\n\n    Set ws1 = Sheets(\"Data\")\n    Set ws2 = Sheets(\"Roster\")\n\n    r1 = ws1.Cells(Rows.Count, sh1Col).End(xlUp).Row\n    r2 = ws2.Cells(Rows.Count, sh2Col).End(xlUp).Row\n\n    For i = r1 To 2 Step -1\n        For Each r In ws2.Range(sh2Col &amp; \"2:\" &amp; sh2Col &amp; r2)\n            If ws1.Cells(i, sh1Col).Value = r.Value Then GoTo myNext\n        Next r\n\n        ws1.Cells(i, sh1Col).EntireRow.Delete\nmyNext:\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "csv", "export", "vba"], "comments": [{"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 0, "creation_date": 1530135296, "post_id": 51064229, "comment_id": 89133232, "body": "We are missing the code you are already using in order to propose solutions. Also, the exact data format you are receiving (you probably aren&#39;t receiving html with tables like you wrote in your question, are you?)"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 3550117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4fe400bf2c415e7e3137986d99b41d6?s=128&d=identicon&r=PG&f=1", "display_name": "user3550117", "link": "https://stackoverflow.com/users/3550117/user3550117"}, "edited": false, "score": 0, "creation_date": 1530107441, "post_id": 51064343, "comment_id": 89118987, "body": "Thanks @Olly the first option did the job perfectly fine. Thank a lot for your contribution!"}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "reply_to_user": {"reputation": 71, "user_id": 3550117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4fe400bf2c415e7e3137986d99b41d6?s=128&d=identicon&r=PG&f=1", "display_name": "user3550117", "link": "https://stackoverflow.com/users/3550117/user3550117"}, "edited": false, "score": 0, "creation_date": 1530107525, "post_id": 51064343, "comment_id": 89119051, "body": "You may consider marking this as your answer."}], "tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": false, "score": 1, "last_activity_date": 1530106896, "creation_date": 1530106896, "answer_id": 51064343, "question_id": 51064229, "link": "https://stackoverflow.com/questions/51064229/extracting-data-from-a-csv-file/51064343#51064343", "title": "Extracting Data from a CSV file", "body": "<p><strong>Data > Text to Columns</strong> should suffice, using comma as delimiter.</p>\n\n<p>Or you could use <strong>Power Query</strong> (Get &amp; Transform Data):</p>\n\n<pre><code>let\n    Source = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content],\n    #\"Split Column by Delimiter\" = Table.SplitColumn(Source, \"Column1\", Splitter.SplitTextByDelimiter(\",\", QuoteStyle.Csv), {\"First Name\", \"Last Name\", \"Email\", \"Company\", \"Positionn\"})\nin\n    #\"Split Column by Delimiter\"\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 3550117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4fe400bf2c415e7e3137986d99b41d6?s=128&d=identicon&r=PG&f=1", "display_name": "user3550117", "link": "https://stackoverflow.com/users/3550117/user3550117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1530136158, "answer_count": 1, "score": -1, "last_activity_date": 1530106896, "creation_date": 1530106588, "last_edit_date": 1531161705, "question_id": 51064229, "link": "https://stackoverflow.com/questions/51064229/extracting-data-from-a-csv-file", "closed_reason": "Not suitable for this site", "title": "Extracting Data from a CSV file", "body": "<p>I have a data export from Linkedin (from my connections) and I want to extract the data into a usable format.</p>\n\n<p><strong>This is how the columns are set (note that it's all positioned in in one colunm):</strong></p>\n\n<pre><code>First Name,Last Name,Email Address,Company,Position,Connected\n</code></pre>\n\n<p>So, it oviously looks like this:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;table&gt;\r\n  &lt;tr&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;Column A&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;Column B&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;Column C&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;Column D&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;Column E&lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;Markus,Lanz,markus.lanz@example.com,Example CompanyCEO&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;empty&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;empty&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;empty&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;empty&lt;/td&gt;\r\n  &lt;/tr&gt;\r\n&lt;/table&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><strong>But I want to export the data into a usable format to add it to my database (note that I am trying to replicate colums and lines with the table)</strong></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;table&gt;\r\n  &lt;tr&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;First Name&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;Last Name&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;Email Address&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;Company&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;Position&lt;/td&gt;\r\n  &lt;/tr&gt;\r\n  &lt;tr&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;Markus&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;Lanz&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;markus.lanz@example.com&lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;Example Company &lt;/td&gt;\r\n    &lt;td style=\"border:1px solid black\"&gt;CEO&lt;/td&gt;\r\n  &lt;/tr&gt;\r\n&lt;/table&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Would be amazing, if you could help me out on this one and how to solve it. \nWhat ways would you suggest? Using Excels framework itself or VBA?</p>\n\n<p>Thakns in Advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1530106162, "post_id": 51064040, "comment_id": 89118051, "body": "No need to use activate, use the worksheets collection"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530108766, "post_id": 51064040, "comment_id": 89119924, "body": "<a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">Indentation</a> would go a long way towards making your code much easier to read/follow."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530108686, "post_id": 51064101, "comment_id": 89119861, "body": "I was going to comment about why I upvoted this answer, but seeing that the explanation actually fit better in the answer itself I went ahead and edited it in - hope you don&#39;t mind =)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530109517, "post_id": 51064101, "comment_id": 89120443, "body": "@MathieuGuindon np, the detail is better in the answer."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 4, "last_activity_date": 1530108604, "last_edit_date": 1530108604, "creation_date": 1530106187, "answer_id": 51064101, "question_id": 51064040, "link": "https://stackoverflow.com/questions/51064040/loop-with-if-condition/51064101#51064101", "title": "Loop with If condition", "body": "<p>Use a <code>For Each</code> loop to efficiently iterate all items in an object collection. The <code>Worksheets</code> collection only contains <code>Worksheet</code> objects, so prefer it over the <code>Sheets</code> collection, which can contain charts and other sheet types that don't have a <code>Range</code> member:</p>\n\n<pre><code>Option Explicit\n\nSub LoopAndPrint()\n    Dim ws As Worksheet        \n    For Each ws In ThisWorkbook.Worksheets\n        If ws.Range(\"I6\") = \"Print\" Then\n            ws.Range(\"A1:H6\").PrintOut\n        End If\n    Next ws\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1530106342, "creation_date": 1530106342, "answer_id": 51064144, "question_id": 51064040, "link": "https://stackoverflow.com/questions/51064040/loop-with-if-condition/51064144#51064144", "title": "Loop with If condition", "body": "<p><strong><em>UNTESTED</em></strong>:</p>\n\n<pre><code>Sub LoopSheets()\n    For i = 1 To Sheets.Count\n        With Sheets(i)\n            If .Range(\"I6\") = \"Print\" Then .Range(\"a1:h16\").PrintOut\n        End With\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10000235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f2e2634c27ce28c00a82ca2633385c3?s=128&d=identicon&r=PG&f=1", "display_name": "AOIFE", "link": "https://stackoverflow.com/users/10000235/aoife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530108604, "creation_date": 1530106038, "question_id": 51064040, "link": "https://stackoverflow.com/questions/51064040/loop-with-if-condition", "title": "Loop with If condition", "body": "<p>I am trying to print a number of sheets in a workbook, but only if a cell has Print on that sheet in a certain cell. I cant get the loop to work through the tabs and stopping at the last one. here are a few attemps </p>\n\n<p>1) <strong>checking 1st tab, then moving on to next - but how do I end the loop at the final sheet? same name on sheet all the time</strong></p>\n\n<pre><code>Worksheets(\"name of 1st worksheet\").Activate  \nIf Range(\"I6\") = \"Print\" Then\nRange(\"a1:h16\").PrintOut\nEnd If    \nDo\nActiveSheet.Next.Activate\n\nIf Range(\"I6\") = \"Print\" Then\n Range(\"a1:h16\").PrintOut\n End If\n\n Loop\n</code></pre>\n\n<p><strong>2) ('attempting to choose sheet 8-45)</strong> \n     Dim i As Long\n    For i = 8 To 45\n    If Range(\"I6\") = \"Print\" Then\n    End If</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1530105321, "post_id": 51063681, "comment_id": 89117400, "body": "If you drag the yellow arrow that Debug uses to indicate where the error occurs to <code>Next i</code> then press F5 again, to continue the macro (which would skip the problematical image) does it continue with no problem? If yes, then there&#39;s something &quot;odd&quot; about this image/InlineShape. Can you see how it differs from others, such as where it&#39;s located / what surrounds it?"}, {"owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1530105929, "post_id": 51063681, "comment_id": 89117858, "body": "I did as you said and the code seems to worked fine, I tested it on 4 images and all were replaced with the correct image, however I had to get the error then run script from next i each time. What could be the cause of this? As I thought it doesn&#39;t seem like there is any issue and yet it cannot cannot run fluidly."}, {"owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1530105977, "post_id": 51063681, "comment_id": 89117906, "body": "Also the only other content in the document are captions underneath each image"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1530110246, "post_id": 51063681, "comment_id": 89120936, "body": "The problem is almost certainly the target range (<code>rg</code>)... Put <code>rg.Select</code> just before the line of code to add the image. Click in the gray area to the left of that line of code (add a break point - you should get a red dot and the line should be highlighted red). Now when you run the macro execution will stop before executing the line add an image. The range should be selected. Look at the document and compare what is selected for this problem image and compare that to other selections."}, {"owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1530185944, "post_id": 51063681, "comment_id": 89152199, "body": "I tried this and it didn&#39;t seem to change anything. To clarify it isn&#39;t &quot;a problem image&quot;, the last image of the document (first in the for - step) will be replaced effectively, however even though it works it seems as though the code reaches an error on the same line (as observed when I step through the lines and the add image line will add the image in the correct position, but at the same time bring up the error)."}, {"owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1530186344, "post_id": 51063681, "comment_id": 89152482, "body": "Hopefully the above makes it clear that my problem isn&#39;t a single image, but rather that only the first image in the for - step is replaced before the error occurs.What I was trying to say before is that if I run the code and receive the error then drag the yellow arrow to next i and run it will replace the next image and reach error. I can repeat this process and effectively change all images in the document. I just don&#39;t understand what the error is because it seems like the error occurs even though the add image line works..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1530200426, "post_id": 51063681, "comment_id": 89162106, "body": "I see it, now. It&#39;s this: <code>rg = doc.InlineShapes...</code> Why are you trying to set the new InlineShape to a Range object (and without the <code>Set</code> command, in addition)? Remove the <code>rg = </code> and it should run OK."}, {"owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1530225455, "post_id": 51063681, "comment_id": 89172358, "body": "That wasn&#39;t the issue the add picture line must be equal to something, but you make a good point that I was setting the new Inlineshape as a range, so to get it working I just set the add picture line to equal an Inlineshape object. Thanks for the help"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1530244662, "post_id": 51063681, "comment_id": 89176142, "body": "The line doesn&#39;t need to be set to anything - just remove the parentheses around the arguments."}, {"owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1530247942, "post_id": 51063681, "comment_id": 89176852, "body": "You are correct, it works either way, I guess setting the Inlineshape object is just an unnecessary step. Can you explain why adding parantheses requires an object to be set? When should I use parantheses and when shouldn&#39;t I?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1530275157, "post_id": 51063681, "comment_id": 89190536, "body": "If you use parentheses you need to assign the result to a variable of the correct data type. This is generally the case, not just with <code>Set</code>. So if you don&#39;t have <code>variable =</code> in front of it, no parentheses."}], "owner": {"reputation": 3, "user_id": 9834916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ba8668afbc8e6422d2aa32146d10c8f?s=128&d=identicon&r=PG&f=1", "display_name": "Steve-O", "link": "https://stackoverflow.com/users/9834916/steve-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1232, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530105029, "creation_date": 1530105029, "question_id": 51063681, "link": "https://stackoverflow.com/questions/51063681/replace-inlineshapes-using-word-vba", "title": "replace inlineshapes using word VBA", "body": "<p>I have a word document with many images in it and I wish to be able to select a file path (in which the new images are located and numbered i.e. 1 to 100) to then replace the existing images with the new images. </p>\n\n<p>I have read a few posts of others retrieving the properties of existing inlineshapes to achieve this, but I have also read people succeeding with the following method which seems much simpler (I just haven't been able to get the code working fully yet). Currently the code will run and replace the last image perfectly fine, but then stops with error '438' - Object doesn't support this property or method when it tries to replace the second last image. </p>\n\n<p>The code is as follows:</p>\n\n<pre><code>Sub Replace_images()\n  Dim rg As Word.Range\n  Dim i As Long\n  Dim doc As Word.Document\n  Dim path As String\n\n 'Ensure pictures are numbered with no leading zeros (in folder) &amp; are .jpg\n  path = \"C:\\filepathtopictures\\\"\n\n   Set doc = ActiveDocument\n\nFor i = doc.InlineShapes.Count To 1 Step -1\n\n  Set rg = doc.InlineShapes(i).Range\n  doc.InlineShapes(i).Delete\n  rg = doc.InlineShapes.AddPicture(path &amp; i &amp; \".jpg\", False, True, rg)\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I don't understand how the using the addpicture doesn't work for the next image when nothing has change from the last image. If someone could please explain why it doesn't work or tell me what needs to be changed that would be great!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1530105049, "post_id": 51063668, "comment_id": 89117188, "body": "<a href=\"http://www.cpearson.com/excel/optionalargumentstoprocedures.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/optionalargumentstoprocedures.aspx</a>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1530105988, "post_id": 51063668, "comment_id": 89117916, "body": "Do you really need an &quot;unlimited number&quot; of parameters? And if so, can you give some use-case with expected outputs? (this is part of <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>).  It&#39;s possible this is an X/Y problem, and perhaps rather than re-creating the <code>Switch</code> function in VBA, you could simply use the <code>Select Case</code> operator in VBA, which is more or less equivalent to the <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/switch\" rel=\"nofollow noreferrer\">c# <code>switch</code> statement</a>. But if you need to take an arbitrary set of pairs from the user, maybe you do need to recreate Switch."}], "answers": [{"tags": [], "owner": {"reputation": 392, "user_id": 8239268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ec70961cef7b5ab8684f1490c5d903a?s=128&d=identicon&r=PG&f=1", "display_name": "igorsp7", "link": "https://stackoverflow.com/users/8239268/igorsp7"}, "is_accepted": true, "score": 3, "last_activity_date": 1530105232, "creation_date": 1530105232, "answer_id": 51063752, "question_id": 51063668, "link": "https://stackoverflow.com/questions/51063668/vba-multiple-optional-function-parameters/51063752#51063752", "title": "VBA Multiple Optional Function Parameters", "body": "<p>You need to use <code>ParamArray</code>, e.g.</p>\n\n<pre><code>Public Function TestSum(ParamArray a())\n    Dim i As Long\n    For i = LBound(a) To UBound(a)\n        TestSum = TestSum + a(i)\n    Next i\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530111078, "post_id": 51065227, "comment_id": 89121504, "body": "I was actually have a little fun with the post.  I was, however, thinking of a hard coded <code>Switch()</code> statement."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530111415, "post_id": 51065227, "comment_id": 89121716, "body": "A VBA <code>Switch()</code> statement uses an index.  I don&#39;t think that you actually need a <code>Dictionary</code> because you only need to find a single value. Simply return the value when found.  Or an error is not found.  In any case, there really isn&#39;t much need to optimise something like this. +1"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530112242, "post_id": 51065227, "comment_id": 89122258, "body": "@TinMan You don&#39;t <i>need</i> a dictionary, you could do this with a pair of Arrays, or a pair ArrayLists, and I think you <i>could</i> do it within a Select Case if you defined all 124 optional pairs of value/resul;t, but it gets <i>really</i> messy when needing to check parameters exist. The problem with doing a straight <i>index</i> against the <code>ParamArray</code> is that you won&#39;t differentiate the <i>values</i> from the <i>results</i> and could end up with some wrong results that way."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530112671, "post_id": 51065227, "comment_id": 89122531, "body": "This is the best that I can do in under 5 minutes <a href=\"https://drive.google.com/open?id=18Yy0nCxJbFbpAO8-2ekWhN7qwokdNTpV\" rel=\"nofollow noreferrer\">fswitch.txt</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530112872, "post_id": 51065227, "comment_id": 89122645, "body": "@TinMan yes that might work. The <code>Step 2</code> is what I was overlooking when I was doing the same thing..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530112881, "post_id": 51065227, "comment_id": 89122651, "body": "@TinMan no, I can&#39;t. I spoke to soon :D"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1530113012, "post_id": 51065227, "comment_id": 89122736, "body": "No worries, I posted a complete answer too soon.  The only reason that I was able to write it so fast was that your answer is quite well structured.  Copy, paste, refactor..life of a VBA Hack..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530113013, "post_id": 51065227, "comment_id": 89122737, "body": "@TinMan shooot. I even had <code>Step 2</code> in my code for the same reason. But I was over-thinking it ..."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 2, "last_activity_date": 1530113406, "last_edit_date": 1530113406, "creation_date": 1530109223, "answer_id": 51065227, "question_id": 51063668, "link": "https://stackoverflow.com/questions/51063668/vba-multiple-optional-function-parameters/51065227#51065227", "title": "VBA Multiple Optional Function Parameters", "body": "<p>An interesting question, here's my attempt at replicating the <code>Switch</code> functionality. </p>\n\n<p>You will need to use a <code>ParamArray</code> argument: </p>\n\n<blockquote>\n  <p>Optional. Used only as the last argument in arglist to indicate that the final argument is an Optional array of Variant elements. The ParamArray keyword allows you to provide an arbitrary number of arguments. It may not be used with ByVal, ByRef, or Optional. (<a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/function-statement\" rel=\"nofollow noreferrer\">source</a>)</p>\n</blockquote>\n\n<p>Revised, thanks to the comments with @TinMan, we no longer use a Dictionary so this will be compatible with Mac OS without further tweaks.</p>\n\n<pre><code>Function FSwitch2(ValueToMatch As Variant, ParamArray ValuesToMatchAndReturn())\n' example of replicating the Switch function available in Office 365, etc.\n' https://support.office.com/en-us/article/switch-function-47ab33c0-28ce-4530-8a45-d532ec4aa25e\nDim i As Integer\nDim retVal As Variant\nDim default As Variant\n\nIf (UBound(ValuesToMatchAndReturn) + 1) Mod 2 &lt;&gt; 0 Then\n    ' if the array is not evenly sized, assume the last argument is the default value.\n    default = ValuesToMatchAndReturn(UBound(ValuesToMatchAndReturn))\nElse\n    ' Otherwise, default to #N/A error if no match.\n    default = CVErr(2042)\nEnd If\n\nFor i = LBound(ValuesToMatchAndReturn) To UBound(ValuesToMatchAndReturn) Step 2\n    If ValueToMatch = ValuesToMatchAndReturn(i) Then\n        retVal = ValuesToMatchAndReturn(i + 1)\n        Exit For\n    End If\nNext\n\nFSwitch2 = IIf(IsEmpty(retVal), default, retVal)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1518, "user_id": 10000141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac09f6a889c1f8aa3cc060d30be17b7?s=128&d=identicon&r=PG&f=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/10000141/joel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 51063752, "answer_count": 2, "score": 1, "last_activity_date": 1530113406, "creation_date": 1530105001, "question_id": 51063668, "link": "https://stackoverflow.com/questions/51063668/vba-multiple-optional-function-parameters", "title": "VBA Multiple Optional Function Parameters", "body": "<p>I'm trying to write the <a href=\"https://support.office.com/en-us/article/switch-function-47ab33c0-28ce-4530-8a45-d532ec4aa25e\" rel=\"nofollow noreferrer\">SWITCH function</a> in VBA for my coworker who has Excel 2013. I feel that my VBA is strong enough to code this function once I set up all my function parameters. However, I'm not sure how to have an unlimited number of optional parameters in a function (similar to <code>*args</code> in Python). How can I set up a function so that it may have an unlimited number of optional arguments?</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 5, "creation_date": 1530104873, "post_id": 51063595, "comment_id": 89117061, "body": "<code>Dim AN As Worksheet</code>"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1530104930, "post_id": 51063595, "comment_id": 89117106, "body": "I&#39;m quite sure It didn&#39;t work last week either ^^, at least not exactly as it."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530105080, "post_id": 51063595, "comment_id": 89117213, "body": "<code>On Error Resume Next</code> and <code>Err.Clear</code> ...Voila Err fixed!!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7988718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9860eb5b6ccf229b59e61e183566276?s=128&d=identicon&r=PG&f=1", "display_name": "R3DSTON3R", "link": "https://stackoverflow.com/users/7988718/r3dston3r"}, "edited": false, "score": 0, "creation_date": 1530106307, "post_id": 51063755, "comment_id": 89118170, "body": "I tried this and it gave me runtime error -2147418113(8000ffff). It said it was a automation error and catastrophic failure Dim AN As Worksheet Dim wb As Workbook      Set wb = ThisWorkbook Set AN = wb.Sheets(&quot;ANData&quot;)"}, {"owner": {"reputation": 1, "user_id": 7988718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9860eb5b6ccf229b59e61e183566276?s=128&d=identicon&r=PG&f=1", "display_name": "R3DSTON3R", "link": "https://stackoverflow.com/users/7988718/r3dston3r"}, "edited": false, "score": 0, "creation_date": 1530106559, "post_id": 51063755, "comment_id": 89118356, "body": "I did try it and it didnt pop up a message box, my GUI opened though"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7988718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9860eb5b6ccf229b59e61e183566276?s=128&d=identicon&r=PG&f=1", "display_name": "R3DSTON3R", "link": "https://stackoverflow.com/users/7988718/r3dston3r"}, "edited": false, "score": 0, "creation_date": 1530106850, "post_id": 51063755, "comment_id": 89118574, "body": "@R3DSTON3R - Can you restart the PC, open a new Excel, name one of the steets &quot;ANData&quot; and try again?"}, {"owner": {"reputation": 1, "user_id": 7988718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9860eb5b6ccf229b59e61e183566276?s=128&d=identicon&r=PG&f=1", "display_name": "R3DSTON3R", "link": "https://stackoverflow.com/users/7988718/r3dston3r"}, "edited": false, "score": 0, "creation_date": 1530107004, "post_id": 51063755, "comment_id": 89118686, "body": "I can give it a shot"}, {"owner": {"reputation": 1, "user_id": 7988718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9860eb5b6ccf229b59e61e183566276?s=128&d=identicon&r=PG&f=1", "display_name": "R3DSTON3R", "link": "https://stackoverflow.com/users/7988718/r3dston3r"}, "edited": false, "score": 0, "creation_date": 1530107562, "post_id": 51063755, "comment_id": 89119077, "body": "So I had to change Dim ws As Sheet to Dim ws As Worksheet but it did post the message\\"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530107574, "post_id": 51063755, "comment_id": 89119081, "body": "@Vityata shouldn&#39;t it say <code>Worksheet</code> rather than <code>Sheet</code> ?"}, {"owner": {"reputation": 1, "user_id": 7988718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9860eb5b6ccf229b59e61e183566276?s=128&d=identicon&r=PG&f=1", "display_name": "R3DSTON3R", "link": "https://stackoverflow.com/users/7988718/r3dston3r"}, "edited": false, "score": 0, "creation_date": 1530109681, "post_id": 51063755, "comment_id": 89120546, "body": "Well I dont know how but my excel spreadsheet added a secondary woorkbook and I couldnt delete it. So I moved the entire database over to a new spreadsheet along with the GUI and now it works. I think the program was confused about having two workbooks"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530111186, "post_id": 51063755, "comment_id": 89121567, "body": "@Rawrplus - then it is a good idea to change it here as well - <code>Set ws = wb.Sheets(&quot;ANData&quot;)</code>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1530107673, "last_edit_date": 1530107673, "creation_date": 1530105247, "answer_id": 51063755, "question_id": 51063595, "link": "https://stackoverflow.com/questions/51063595/error-13-type-mismatch-in-assigning-sheet-variable-in-vba/51063755#51063755", "title": "Error 13 Type-Mismatch in Assigning Sheet Variable in VBA", "body": "<p>As mentioned in the comments <code>Sheet</code> is a variable and <code>WorkBook</code> is another variable:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim ws As Worksheet\n    Dim wb As Workbook\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Sheets(\"ANData\")\n\n    MsgBox ws.Name &amp; \" is in \" &amp; wb.Name\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7988718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9860eb5b6ccf229b59e61e183566276?s=128&d=identicon&r=PG&f=1", "display_name": "R3DSTON3R", "link": "https://stackoverflow.com/users/7988718/r3dston3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 521, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1530107673, "creation_date": 1530104833, "last_edit_date": 1530105105, "question_id": 51063595, "link": "https://stackoverflow.com/questions/51063595/error-13-type-mismatch-in-assigning-sheet-variable-in-vba", "title": "Error 13 Type-Mismatch in Assigning Sheet Variable in VBA", "body": "<pre><code>Dim AN As Workbook\nSet AN = Sheets(\"ANData\")\n</code></pre>\n\n<p>Okay so the second line is the line that gets highlighted when I try to run the GUI. It worked last week but now I am getting a error 13 type mismatch. I am trying to have it reference the spreadsheet named \"ANData\".</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1530103011, "post_id": 51062897, "comment_id": 89115725, "body": "Use the <a href=\"https://support.office.com/en-us/article/automate-tasks-with-the-macro-recorder-974ef220-f716-4e01-b015-3ea70e64937b\" rel=\"nofollow noreferrer\"><i>Macro Recorder</i></a> and do it manually once then look in the VB Editor how that code looks like. If that doesn&#39;t solve your question show what you have tried so far."}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 3, "last_activity_date": 1530103269, "creation_date": 1530103269, "answer_id": 51063074, "question_id": 51062897, "link": "https://stackoverflow.com/questions/51062897/how-to-format-numbers-in-a-column-as-per-currency-standards-using-excel-vba/51063074#51063074", "title": "How to Format numbers in a column as per currency standards using excel vba?", "body": "<p>The following will format a given column as Currency:</p>\n\n<pre><code>Sheets(\"Sheet1\").Columns(\"A\").NumberFormat = \"\u00a3#,##0.00\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1530105019, "creation_date": 1530105019, "answer_id": 51063674, "question_id": 51062897, "link": "https://stackoverflow.com/questions/51062897/how-to-format-numbers-in-a-column-as-per-currency-standards-using-excel-vba/51063674#51063674", "title": "How to Format numbers in a column as per currency standards using excel vba?", "body": "<p>Macro recorder is a bit dangerous in this case, because if you use it, your code would look like this (from the other answer):</p>\n\n<p><code>Sheets(\"Sheet1\").Columns(\"A\").NumberFormat = \"\u00a3#,##0.00\"</code></p>\n\n<p>However, this is only ok in UK. If you want to write code, which formats currency based on the local settings of the PC, then it is a good idea to use the currency there:</p>\n\n<p><code>Sheets(\"Sheet1\").Columns(\"A\").Style = \"Currency\"</code></p>\n\n<p>Then a UK person would get pounds format and a US one dollars.</p>\n"}], "owner": {"reputation": 19, "user_id": 9148893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647fc9710321d0a49dd3cbb9e93b9140?s=128&d=identicon&r=PG&f=1", "display_name": "Anurag", "link": "https://stackoverflow.com/users/9148893/anurag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6590, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530105019, "creation_date": 1530102761, "last_edit_date": 1531164843, "question_id": 51062897, "link": "https://stackoverflow.com/questions/51062897/how-to-format-numbers-in-a-column-as-per-currency-standards-using-excel-vba", "title": "How to Format numbers in a column as per currency standards using excel vba?", "body": "<p>I want to format all cells of a column. The data is a number and I want to add a decimal from left keeping only two digits after that. Then format it as per currency standards. For eg:</p>\n\n<pre><code>Data:       Output:\n10000       100.00\n112233      1,122.33\n123456789   1,234,567.89\n</code></pre>\n\n<p>The requirement is normal and output is in italics. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1138, "user_id": 1770778, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6d871ac3e8253dcc4fe15b0d5707dd2a?s=128&d=identicon&r=PG", "display_name": "ffonz", "link": "https://stackoverflow.com/users/1770778/ffonz"}, "edited": false, "score": 3, "creation_date": 1530103735, "post_id": 51062788, "comment_id": 89116219, "body": "MUST it be done with VBA? It is also very simple in Excel itself. Just open both workbooks, right-click on the sheet-tab of the old &quot;file 2&quot; sheet and select <code>Delete</code>. Now go to the new &quot;file 2&quot;, right-click and select <code>Move or Copy...</code>."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1530103818, "post_id": 51062788, "comment_id": 89116286, "body": "Do you end up with both books open?  Do both books have sheets called <code>NEOCOP</code>?  On the two answers so far you&#39;ve just said &quot;still doesn&#39;t work&quot;.  How is it not working?  Do both books open ok but the values don&#39;t transfer?   Does it give any kind of error message?  Does a giant unicorn fly out of the back of your computer... ok, I&#39;ve only had that happen once and I don&#39;t think it was the code."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 2, "creation_date": 1530103885, "post_id": 51062788, "comment_id": 89116332, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/43374442/vba-copy-paste-values-from-one-workbook-to-another\">VBA Copy / paste values from one workbook to another</a>"}, {"owner": {"reputation": 1, "user_id": 9999936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSdKt.jpg?s=128&g=1", "display_name": "NOOB", "link": "https://stackoverflow.com/users/9999936/noob"}, "edited": false, "score": 0, "creation_date": 1530117228, "post_id": 51062788, "comment_id": 89125076, "body": "Yes, both workbooks open. Though one of them has the macro in it so I think it&#39;s re-opening the same file. Then no pasting happens at all."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9999936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSdKt.jpg?s=128&g=1", "display_name": "NOOB", "link": "https://stackoverflow.com/users/9999936/noob"}, "edited": false, "score": 0, "creation_date": 1530106029, "post_id": 51062837, "comment_id": 89117955, "body": "By not working it&#39;s not pasting or overwriting the data I want to the destination file. The destination file has the same values as originally started with."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 9999936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSdKt.jpg?s=128&g=1", "display_name": "NOOB", "link": "https://stackoverflow.com/users/9999936/noob"}, "edited": false, "score": 0, "creation_date": 1530111223, "post_id": 51062837, "comment_id": 89121598, "body": "@NOOB - can you restart your PC and try again?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 9999936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSdKt.jpg?s=128&g=1", "display_name": "NOOB", "link": "https://stackoverflow.com/users/9999936/noob"}, "edited": false, "score": 0, "creation_date": 1530111485, "post_id": 51062837, "comment_id": 89121769, "body": "@NOOB - write <code>On Error GoTo 0</code> after the first line of the code and give it a try. It is up to you whether to do it, thus I guess you have no reason to lie :)"}, {"owner": {"reputation": 1, "user_id": 9999936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSdKt.jpg?s=128&g=1", "display_name": "NOOB", "link": "https://stackoverflow.com/users/9999936/noob"}, "edited": false, "score": 0, "creation_date": 1530113348, "post_id": 51062837, "comment_id": 89122933, "body": "I just don&#39;t understand, this doesn&#39;t make any sense. Sorry I keep responding. I figured this would have been much simpler than this has turned out to be. Just opening both workbooks and doing nothing."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1530102974, "last_edit_date": 1530102974, "creation_date": 1530102570, "answer_id": 51062837, "question_id": 51062788, "link": "https://stackoverflow.com/questions/51062788/how-can-i-copy-data-from-one-worksheet-to-another-workbook/51062837#51062837", "title": "How can I copy data from one worksheet to another workbook?", "body": "<p>First:\n<code>Set x = Workbooks.Open(\"H:\\GTF COP June 25 2018.xlsx\")</code></p>\n\n<p>Then write:</p>\n\n<pre><code>x.Sheets(\"NEOCOP\").Range(\"A1:AH20000\").Value2= y.Sheets(\"NEOCOP\").Range(\"A1:AH20000\").Value2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "reply_to_user": {"reputation": 1, "user_id": 9999936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSdKt.jpg?s=128&g=1", "display_name": "NOOB", "link": "https://stackoverflow.com/users/9999936/noob"}, "edited": false, "score": 0, "creation_date": 1530104981, "post_id": 51062861, "comment_id": 89117137, "body": "Try the second solution and let me know ;)"}, {"owner": {"reputation": 1, "user_id": 9999936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSdKt.jpg?s=128&g=1", "display_name": "NOOB", "link": "https://stackoverflow.com/users/9999936/noob"}, "edited": false, "score": 0, "creation_date": 1530105857, "post_id": 51062861, "comment_id": 89117808, "body": "Sub CopyNewData() Dim x As Workbook Dim y As Workbook  &#39;## Open both workbooks first: Set x = Workbooks.Open(&quot;H:\\GTF COP June 25 2018.xlsx&quot;) Set y = Workbooks.Open(&quot;H:\\CSA Spreadsheets\\PW1100 Inventory at CSA_Revised.xlsm&quot;)  &#39;Now, transfer values from x to y: x.Sheets(&quot;NEOCOP&quot;).Range(&quot;A1:AH20000&quot;).Copy y.Sheets(&quot;NEOCOP&quot;).Range(&quot;A1:AH20000&quot;).PasteSpecial   &#39;Close x: x.Close  End Sub"}, {"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "reply_to_user": {"reputation": 1, "user_id": 9999936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSdKt.jpg?s=128&g=1", "display_name": "NOOB", "link": "https://stackoverflow.com/users/9999936/noob"}, "edited": false, "score": 0, "creation_date": 1530107706, "post_id": 51062861, "comment_id": 89119181, "body": "It&#39;s weird. I copy/paste your code in a new worbook. I change the path of x and y workbooks and it&#39;s working."}, {"owner": {"reputation": 1, "user_id": 9999936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSdKt.jpg?s=128&g=1", "display_name": "NOOB", "link": "https://stackoverflow.com/users/9999936/noob"}, "edited": false, "score": 0, "creation_date": 1530110559, "post_id": 51062861, "comment_id": 89121150, "body": "Hmmmm. I&#39;ve tried that as well. Maybe because it&#39;s on a Network drive?"}, {"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "reply_to_user": {"reputation": 1, "user_id": 9999936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSdKt.jpg?s=128&g=1", "display_name": "NOOB", "link": "https://stackoverflow.com/users/9999936/noob"}, "edited": false, "score": 0, "creation_date": 1530110913, "post_id": 51062861, "comment_id": 89121376, "body": "Probably. We find the reason why the sub didn&#39;t work. Check configuration and path of your network drive. Probably add the IP address instead of the letter in the paths."}, {"owner": {"reputation": 1, "user_id": 9999936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSdKt.jpg?s=128&g=1", "display_name": "NOOB", "link": "https://stackoverflow.com/users/9999936/noob"}, "edited": false, "score": 0, "creation_date": 1530111060, "post_id": 51062861, "comment_id": 89121485, "body": "It does say that the file is already open. I have the macro stored in the file I wish to paste the data into. Currently there are 5,168 line items. The source file only has 5,127 in it. After the macro runs there&#39;s still 5,168. I double checked and it didn&#39;t paste the new data anywhere. It&#39;s as though it&#39;s just opening the file and that&#39;s all that it&#39;s doing."}, {"owner": {"reputation": 1, "user_id": 9999936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSdKt.jpg?s=128&g=1", "display_name": "NOOB", "link": "https://stackoverflow.com/users/9999936/noob"}, "edited": false, "score": 0, "creation_date": 1530111096, "post_id": 51062861, "comment_id": 89121513, "body": "Not sure how to obtain the IP address of a mapped network drive."}], "tags": [], "owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1530104957, "last_edit_date": 1530104957, "creation_date": 1530102635, "answer_id": 51062861, "question_id": 51062788, "link": "https://stackoverflow.com/questions/51062788/how-can-i-copy-data-from-one-worksheet-to-another-workbook/51062861#51062861", "title": "How can I copy data from one worksheet to another workbook?", "body": "<p>You forget the <code>.open</code> :</p>\n\n<pre><code>Set x = Workbooks.Open(\"H:\\GTF COP June 25 2018.xlsx\")\n</code></pre>\n\n<p><strong>EDIT try this way :</strong></p>\n\n<pre><code>x.Sheets(\"NEOCOP\").Range(\"A1:AH20000\").Copy\ny.Sheets(\"NEOCOP\").Range(\"A1:AH20000\").PasteSpecial\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9999936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSdKt.jpg?s=128&g=1", "display_name": "NOOB", "link": "https://stackoverflow.com/users/9999936/noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1530104957, "creation_date": 1530102422, "last_edit_date": 1531161705, "question_id": 51062788, "link": "https://stackoverflow.com/questions/51062788/how-can-i-copy-data-from-one-worksheet-to-another-workbook", "title": "How can I copy data from one worksheet to another workbook?", "body": "<p>I believe this should be very simple for someone to assist me with. </p>\n\n<p>I have two workbooks. One is a workbook that we use as a tracker as it has conditional formatting, etc. setup already I'll refer to this as \"file 1\"</p>\n\n<p>Each week we get emailed another workbook with the latest and greatest data \"file 2\". </p>\n\n<p>All I want to do is copy the latest and greatest \"file 2\" to our working workbook or \"file 1\".</p>\n\n<p>This is what I've tried but it's not working:</p>\n\n<pre><code> Sub CopyNewData()\nDim x As Workbook\nDim y As Workbook\n\n'## Open both workbooks first:\nSet x = Workbooks.Open(\"H:\\GTF COP June 25 2018.xlsx\")\nSet y = Workbooks.Open(\"H:\\CSA Spreadsheets\\PW1100 Inventory at CSA_Revised.xlsm\")\n\n'Now, transfer values from x to y:\nx.Sheets(\"NEOCOP\").Range(\"A1:AH20000\").Value = y.Sheets(\"NEOCOP\").Range(\"A1:AH20000\")\n\n'Close x:\nx.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1530101255, "post_id": 51062229, "comment_id": 89114525, "body": "Do you have <i>dates</i> or <i>strings</i> ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1530101594, "post_id": 51062229, "comment_id": 89114757, "body": "What does <code>31.07.18</code> become?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1530102206, "post_id": 51062229, "comment_id": 89115192, "body": "See <a href=\"https://stackoverflow.com/q/20375233/78522\">stackoverflow.com/q/20375233/78522</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1530101304, "creation_date": 1530101304, "answer_id": 51062447, "question_id": 51062229, "link": "https://stackoverflow.com/questions/51062229/excel-date-formatting-changes-after-using-find-replace/51062447#51062447", "title": "Excel Date Formatting changes after using Find/Replace", "body": "<p>After the replace, you can try to clear the date format and apply the NumberFormat method:</p>\n\n<pre><code>.Range(yourRange).ClearFormats\n.Range(yourRange).NumberFormat = \"dd/mm/yyyy\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1530101562, "creation_date": 1530101562, "answer_id": 51062515, "question_id": 51062229, "link": "https://stackoverflow.com/questions/51062229/excel-date-formatting-changes-after-using-find-replace/51062515#51062515", "title": "Excel Date Formatting changes after using Find/Replace", "body": "<p>Easier to change the \" <strong>.</strong> \" in the <em>format</em> rather than in the <em>value</em>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DGacm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DGacm.png\" alt=\"enter image description here\"></a></p>\n\n<p>the code:</p>\n\n<pre><code>Sub formatfixer()\n    Dim r As Range, formt As String\n    For Each r In Intersect(Selection, ActiveSheet.UsedRange)\n        formt = r.NumberFormat\n        If InStr(1, formt, \".\") &gt; 0 Then\n            r.NumberFormat = \"dd/mm/yyyy\"\n        End If\n    Next r\nEnd Sub\n</code></pre>\n\n<p>the result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ID8Ho.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ID8Ho.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "edited": false, "score": 0, "creation_date": 1530102559, "post_id": 51062634, "comment_id": 89115422, "body": "This works! I have no idea what it means but thanks!"}, {"owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "edited": false, "score": 0, "creation_date": 1530102789, "post_id": 51062634, "comment_id": 89115578, "body": "This seems like a stupid question, but I want to repeat this for Range H5:H120. I changed your code above from (\u201cB10\u201d) to (\u201cH5:H120\u201d) and it doesn\u2019t work? Ideas?"}, {"owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "edited": false, "score": 0, "creation_date": 1530130224, "post_id": 51062634, "comment_id": 89131138, "body": "That worked a treat and thank you for expanding on your answer. Top Man"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 3, "last_activity_date": 1530103162, "last_edit_date": 1530103162, "creation_date": 1530102004, "answer_id": 51062634, "question_id": 51062229, "link": "https://stackoverflow.com/questions/51062229/excel-date-formatting-changes-after-using-find-replace/51062634#51062634", "title": "Excel Date Formatting changes after using Find/Replace", "body": "<p>You could try splitting into a <code>DateSerial</code>:  </p>\n\n<pre><code>Sub Test()\n\n    Dim r As Range\n    Set r = Sheet1.Range(\"B10\")\n\n    r = DateSerial(Split(r, \".\")(2), Split(r, \".\")(1), Split(r, \".\")(0))\n\n    r.NumberFormat = \"dd/mm/yyyy\"\n\nEnd Sub\n</code></pre>\n\n<p>Split <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/split-function\" rel=\"nofollow noreferrer\">returns a zero-based, one-dimensional array containing a specified number of substrings.</a>.  </p>\n\n<p>What this means in plain English is that it takes your text string of <code>03.07.18</code>and splits it into three parts using the <code>.</code>.<br>\nSo you end up with <code>03</code>, <code>07</code> and <code>18</code> within an array.  </p>\n\n<p>It might be easier to read as: </p>\n\n<pre><code>v = Split(r, \".\")\nr = DateSerial(v(2), v(1), v(0))\n</code></pre>\n\n<p><code>DateSerial</code> takes three numbers (year, month and day) and returns a date.  The three parts of the Split are passed into this to create the date.  </p>\n\n<p>To process on a number of cells use:  </p>\n\n<pre><code>Sub formatfixer()\n    Dim r As Range\n    For Each r In Range(\"H5:H120\")\n        r = DateSerial(Split(r, \".\")(2), Split(r, \".\")(1), Split(r, \".\")(0))\n        r.NumberFormat = \"dd/mm/yyyy\"\n    Next r\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 51062634, "answer_count": 3, "score": 1, "last_activity_date": 1530103162, "creation_date": 1530100684, "last_edit_date": 1530101355, "question_id": 51062229, "link": "https://stackoverflow.com/questions/51062229/excel-date-formatting-changes-after-using-find-replace", "title": "Excel Date Formatting changes after using Find/Replace", "body": "<p>I have a bunch of dates in a volume which are in UK format but separated by dots not forward slashes. </p>\n\n<p>Every time I run a macro to replace dots with dashes and use the line of code below, excel always seems to think that the months and day are the other way round</p>\n\n<pre><code>Replace What:=\".\", Replacement:=\"/\"\nNumberFormat = \"dd/mm/yyyy\"\n</code></pre>\n\n<p>As an example:\n03.07.18\nWill become 07/03/2018 despite formatting as UK.</p>\n\n<p>How can I keep the date as 03/07/2018</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530100242, "post_id": 51062035, "comment_id": 89113822, "body": "Read up on <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-change-event-excel\" rel=\"nofollow noreferrer\"><b><code>Worksheet_Change(ByVal Target as Range)</code></b></a> Event (procedure) please."}, {"owner": {"reputation": 249, "user_id": 6537508, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/637b5e769b1db0435d3bbfb5529b75b1?s=128&d=identicon&r=PG&f=1", "display_name": "hsquared", "link": "https://stackoverflow.com/users/6537508/hsquared"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530100846, "post_id": 51062035, "comment_id": 89114229, "body": "I have tried that before posting this. I am new to VBA and couldn&#39;t get this working, I&#39;m obviously doing something simple wrong which is why I posted the question."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1530101846, "post_id": 51062035, "comment_id": 89114954, "body": "The <code>Application.Volatile</code> already leads to &quot;update when changes are made on the sheet&quot; which triggers recalculation. Problem is that changing a color is not the kind of changing which triggers recalculation. Only recalculating on every selection change would be possible. But not a good idea in my opinion, at least not for sheets having great amount of formulas."}, {"owner": {"reputation": 249, "user_id": 6537508, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/637b5e769b1db0435d3bbfb5529b75b1?s=128&d=identicon&r=PG&f=1", "display_name": "hsquared", "link": "https://stackoverflow.com/users/6537508/hsquared"}, "edited": false, "score": 0, "creation_date": 1530102356, "post_id": 51062035, "comment_id": 89115291, "body": "So is what I am after not possible? I am aware how that could be an issue for larger/multiple sheets with lots of formulas. However I am working on a single sheet with not many of them, which is why I was wanting this idea."}, {"owner": {"reputation": 117, "user_id": 7499014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01cd9cb72d37fb8ffa70e0bfe7f05c09?s=128&d=identicon&r=PG&f=1", "display_name": "Denyo", "link": "https://stackoverflow.com/users/7499014/denyo"}, "edited": false, "score": 0, "creation_date": 1530102565, "post_id": 51062035, "comment_id": 89115426, "body": "@hsquared: it is recommended that &quot;Worksheet_Change(ByVal Target As Range)&quot; macro is in the &quot;table modul&quot; where the changing occurs. I can not describe it better, sry for my bad english."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530102993, "post_id": 51062035, "comment_id": 89115716, "body": "@Rawrplus, @Denyo: Changing a color also will not trigger <code>Worksheet_Change</code>. So this is dead end here."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1530103201, "post_id": 51062035, "comment_id": 89115852, "body": "@AxelRichter If I got the question right, he wants to change the color on the data change of the cell (it&#39;s <code>.Value</code>), not on color change. I mean, color change upon color change sounds pretty counter-intuitive within itself - unless there is something that&#39;s flying over my head here"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530103464, "post_id": 51062035, "comment_id": 89116029, "body": "@Rawrplus: The function counts the cells in <code>rData</code> which are colored the same as <code>cellRefColor</code> and returns the count then. And I suspect the returned count shall change if one of the colors in <code>rData</code> changes."}], "answers": [{"comments": [{"owner": {"reputation": 249, "user_id": 6537508, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/637b5e769b1db0435d3bbfb5529b75b1?s=128&d=identicon&r=PG&f=1", "display_name": "hsquared", "link": "https://stackoverflow.com/users/6537508/hsquared"}, "edited": false, "score": 0, "creation_date": 1530104808, "post_id": 51062921, "comment_id": 89117010, "body": "That&#39;s exactly what I wanted, thank you very much! I know it sounds like a odd thing to need practicality wise, but in the instance it is needed for it works perfectly. (its basically needed for people to use who are not that familiar with excel, or computers for that matter, to highlight different exceptions within a month over a few of lists of items.)"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1530105986, "post_id": 51062921, "comment_id": 89117913, "body": "You also could use the CommandBars_OnUpdate event, which could trigger your function, even when you only change your Cell Color. (Will need a bit more coding than Axel&#39;s solution)"}, {"owner": {"reputation": 249, "user_id": 6537508, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/637b5e769b1db0435d3bbfb5529b75b1?s=128&d=identicon&r=PG&f=1", "display_name": "hsquared", "link": "https://stackoverflow.com/users/6537508/hsquared"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1530110203, "post_id": 51062921, "comment_id": 89120905, "body": "@EvR That sounds interesting, Had a brief look around for CommandBars_OnUpdate but have&#39;t been able to find much detail on how to use it (That I understand anyway!)"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 249, "user_id": 6537508, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/637b5e769b1db0435d3bbfb5529b75b1?s=128&d=identicon&r=PG&f=1", "display_name": "hsquared", "link": "https://stackoverflow.com/users/6537508/hsquared"}, "edited": false, "score": 0, "creation_date": 1530156734, "post_id": 51062921, "comment_id": 89137952, "body": "@hsquared: Don&#39;t bother. The <a href=\"https://msdn.microsoft.com/en-us/vba/office-shared-vba/articles/commandbars-onupdate-event-office\" rel=\"nofollow noreferrer\">CommandBars.OnUpdate Event</a> triggers every time if some command will be taken. But since you are using the function as a <code>UDF</code> in a cell, the only thing you could do is also recalculating the whole sheet then (How would you trigger your function else?). But now on every command instead of on selection change as in my solution. That would lead to nor more recalculations."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1530169753, "post_id": 51062921, "comment_id": 89142253, "body": "Yes the OnUpdate is an &#39;even more &#39;expensive&#39; event as the selectionchange event, but you could exit the event when conditions aren&#39;t true. I&#39;ll post an example."}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 2, "last_activity_date": 1530102829, "creation_date": 1530102829, "answer_id": 51062921, "question_id": 51062035, "link": "https://stackoverflow.com/questions/51062035/getting-vba-function-to-auto-update-when-a-change-is-made-on-sheet-excel/51062921#51062921", "title": "Getting VBA Function to auto update when a change is made on sheet - excel", "body": "<p>If you are sure that the sheet has not as much amount of formulas that recalculating on every selection change leads to an crash, then the following would be possible:</p>\n\n<p>The <code>Application.Volatile</code> in your function already leads to \"update when changes are made on the sheet\" which triggers recalculation. Problem is that changing a color is not the kind of changing which triggers recalculation. </p>\n\n<p>So do a </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n Me.Calculate\nEnd Sub\n</code></pre>\n\n<p>into the <code>SheetN</code> VBA module.</p>\n\n<p>This leads to recalculating on every selection change in that sheet. And because your function is volatile already this also will be recalculated then.</p>\n"}, {"comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1530172237, "post_id": 51077080, "comment_id": 89143705, "body": "Well done example. But it should be mentioned that the main approach here is that <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-dirty-method-excel\" rel=\"nofollow noreferrer\">Range.Dirty Method</a> forces a recalculation of the cells which are in <code>Selection</code> while <code>objCommandBars_OnUpdate</code>. And if this are cells which are referenced in the <code>UDF</code> formula (<code>=CountCellsByColor(A1:A10,B1)</code> for example) then this formula also will be recalculated - and not needs to be volatile, which is pretty good."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1530172813, "post_id": 51077080, "comment_id": 89144015, "body": "Thanks, yes I also mentioned to leave the application.volatile out. You could also store the interior color of the cells in sRanges and only continu when a change is made to the color. For simplicity left out (and with big ranges to monitor not the quickest solution)"}], "tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 2, "last_activity_date": 1530170854, "creation_date": 1530170854, "answer_id": 51077080, "question_id": 51062035, "link": "https://stackoverflow.com/questions/51062035/getting-vba-function-to-auto-update-when-a-change-is-made-on-sheet-excel/51077080#51077080", "title": "Getting VBA Function to auto update when a change is made on sheet - excel", "body": "<p>CommandBars.OnUpdate Event example:</p>\n\n<p>In a Module: Your function but leave Application.Volatile out of it\nIn a Class named: \"ClsMonitorOnupdate\" :</p>\n\n<pre><code> Option Explicit\n\nPrivate WithEvents objCommandBars As Office.CommandBars\nPrivate rMonitor As Range\n\nPublic Property Set Range(ByRef r As Range): Set rMonitor = r: End Property\nPublic Property Get Range() As Range: Set Range = rMonitor: End Property\n\nPrivate Sub Class_Initialize()\n    Set objCommandBars = Application.CommandBars\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set objCommandBars = Nothing\nEnd Sub\n\nPrivate Sub objCommandBars_OnUpdate()\nDim cl As Range\nOn Error GoTo einde\n    If ActiveWorkbook.Name &lt;&gt; ThisWorkbook.Name Then Exit Sub\n    If ActiveSheet.Name &lt;&gt; rMonitor.Parent.Name Then Exit Sub\n    If TypeName(Selection) &lt;&gt; \"Range\" Then Exit Sub\n    If Intersect(Selection, rMonitor) Is Nothing Then Exit Sub\n        For Each cl In Selection\n            cl.Dirty\n        Next cl\neinde:\n\nEnd Sub\n</code></pre>\n\n<p>In the ThisWorkBook Module:</p>\n\n<pre><code>Option Explicit\nPrivate sRanges As String\nPrivate cMonitor As ClsMonitorOnupdate\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Set cMonitor = Nothing\nEnd Sub\nPrivate Sub Workbook_Open()\n  Zetaan ActiveSheet\nEnd Sub\nSub Zetuit()\n Set cMonitor = Nothing\nEnd Sub\nSub Zetaan(sht As Worksheet)\n    Select Case sht.Name\n        Case \"Sheet1\": sRanges = \"A1:A10, B5:C12\" 'adjust Sheetnames and monitor-range\n        Case \"Sheet2\": sRanges = \"A1:A10\"\n        Case Else: Exit Sub\n    End Select\n     Set cMonitor = New ClsMonitorOnupdate\n    Set cMonitor.Range = Sheets(sht.Name).Range(sRanges)\nEnd Sub\nPrivate Sub Workbook_SheetActivate(ByVal Sh As Object)\nZetaan Sh\nEnd Sub\nPrivate Sub Workbook_SheetDeactivate(ByVal Sh As Object)\nSet cMonitor = Nothing\nEnd Sub\n</code></pre>\n\n<p>Adjust to Your SheetNames and Range(s) in the Sub Zetaan\n(At least the range(s) your function is referring to) </p>\n"}], "owner": {"reputation": 249, "user_id": 6537508, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/637b5e769b1db0435d3bbfb5529b75b1?s=128&d=identicon&r=PG&f=1", "display_name": "hsquared", "link": "https://stackoverflow.com/users/6537508/hsquared"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6338, "favorite_count": 0, "accepted_answer_id": 51062921, "answer_count": 2, "score": 2, "last_activity_date": 1530170854, "creation_date": 1530100078, "last_edit_date": 1531161705, "question_id": 51062035, "link": "https://stackoverflow.com/questions/51062035/getting-vba-function-to-auto-update-when-a-change-is-made-on-sheet-excel", "title": "Getting VBA Function to auto update when a change is made on sheet - excel", "body": "<p>I have a VBA function which counts cells of a certain colour:</p>\n\n<pre><code>Function CountCellsByColor(rData As Range, cellRefColor As Range) As Long\nDim indRefColor As Long\nDim cellCurrent As Range\nDim cntRes As Long\n\nApplication.Volatile\ncntRes = 0\nindRefColor = cellRefColor.Cells(1, 1).Interior.Color\nFor Each cellCurrent In rData\n    If cellCurrent.Value &gt; 0 Then\n        If indRefColor = cellCurrent.Interior.Color Then\n        cntRes = cntRes + 1\n        End If\n    End If\nNext cellCurrent\n\nCountCellsByColor = cntRes\nEnd Function\n</code></pre>\n\n<p>My problem is that this doesn't update when changes are made on the sheet (only when F9 is pressed) - I'm new to VBA and would like it to auto update/execute the function when any change happens on the sheet. \nI'm sure there are many ways to do this but a bit stuck on how to actually achieve it.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "internet-explorer-11", "browser-automation"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530103961, "post_id": 51061914, "comment_id": 89116388, "body": "Please include your code and indicate on which line there is a problem and what that problem is. <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> Note that for debugging help we have to be able to reproduce your problem generally speaking."}], "owner": {"reputation": 31, "user_id": 9995801, "user_type": "registered", "profile_image": "https://graph.facebook.com/1802463909838045/picture?type=large", "display_name": "B&#225;thori Zolt&#225;n", "link": "https://stackoverflow.com/users/9995801/b%c3%a1thori-zolt%c3%a1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1530099684, "creation_date": 1530099684, "question_id": 51061914, "link": "https://stackoverflow.com/questions/51061914/excel-macro-vba-image-upload-to-internet-explorer-with-open-twebst", "title": "Excel Macro (VBA) Image upload to Internet Explorer with Open Twebst", "body": "<p>I've successfully automatized a process with Open Twebst. (Go through some links, fill the forms and upload images..) So, it helped me to upload images to a HTML page in Internet Explorer 10. </p>\n\n<p>I've just changed my laptop and It has Windows 10 (64bit) and it enables to use only Internet Explorer 11 instead of 10. - Previously the macro was running on Win7 - excel 2013 and IE10 - it was worked perfectly.</p>\n\n<p>Somehow the macro stops when the upload browser window appears. I've already installed the program and added its reference in VBA but I had no luck. I was trying to simulate IE10 but it didn't work. I was also trying to do it in Excel 2013 instead of 2016 but it was the same.</p>\n\n<p>Could someone help me to solve this issue? I searched a lot in this topic and as I can see everyone has the same issue: the VBA can't be able to control that window on his own. </p>\n\n<p>This link contains a tutorial for the method I used:\n<a href=\"http://codecentrix.blogspot.com/2009/11/automate-html-file-upload-control.html\" rel=\"nofollow noreferrer\">http://codecentrix.blogspot.com/2009/11/automate-html-file-upload-control.html</a></p>\n\n<p>HTML tag where I upload: ....input type=\"file\"....</p>\n\n<p>I was trying to modify the security settings in IE11, but it wasn't helped me - I'm not an expert in IE, maybe someone knows how to set it.</p>\n\n<p>I would really appreciate any ideas/ codes.\nMany thanks!\nZolt\u00e1n B\u00e1thori</p>\n"}, {"tags": ["vba", "shapes", "visio"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1530099637, "post_id": 51061741, "comment_id": 89113468, "body": "How do you know when to open the userform? In other words, what event are you handling? Also, some code would be helpful."}, {"owner": {"reputation": 23, "user_id": 5326348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e86378ebc8e52349c2a7b434013dae4?s=128&d=identicon&r=PG&f=1", "display_name": "Kamran64", "link": "https://stackoverflow.com/users/5326348/kamran64"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1530100533, "post_id": 51061741, "comment_id": 89114015, "body": "Hi Zev, I have edited my post to show that the user form macro runs when the shape is dropped onto the screen. (EventDrop). I have also attached my current code."}], "answers": [{"comments": [{"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1552671241, "post_id": 51063692, "comment_id": 97113967, "body": "For others like me finding this answer helpful, <a href=\"http://guides.wmlcloud.com/office/Microsoft-Visio-2010---Introducing-Automation-and-VBA-Code-(part-3)---Calling-VBA-Code-from-a-SmartShape-.aspx\" rel=\"nofollow noreferrer\">this link</a> provides some additional example material."}], "tags": [], "owner": {"reputation": 2368, "user_id": 683606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YugId.jpg?s=128&g=1", "display_name": "JohnGoldsmith", "link": "https://stackoverflow.com/users/683606/johngoldsmith"}, "is_accepted": false, "score": 4, "last_activity_date": 1530105057, "creation_date": 1530105057, "answer_id": 51063692, "question_id": 51061741, "link": "https://stackoverflow.com/questions/51061741/finding-id-of-shape-dragged-onto-screen-in-visio-using-vba-macro/51063692#51063692", "title": "Finding id of shape dragged onto screen in Visio using VBA macro", "body": "<p>I wonder if the <code>CALLTHIS</code> ShapeSheet function might be more useful here as it passes a reference to the calling shape.  So, for example, in the <code>EventDrop</code> cell add this formula:</p>\n\n<pre><code>CALLTHIS(\"ThisDocument.OnMyShapeDrop\",\"Drawing001\")\n</code></pre>\n\n<p>and then add this backing code:</p>\n\n<pre><code>Public Sub OnMyShapeDrop(shp As Visio.Shape)\n    MsgBox \"Shape dropped - ID = \" &amp; shp.ID, vbOKOnly, \"Shape Dropped\"\nEnd Sub\n</code></pre>\n\n<p>Note, that I've put the code in the <code>ThisDocument</code> class, but it can live in any accessable module.  Also note the project name (Drawing001) which will likely be the file name without the extension.</p>\n"}], "owner": {"reputation": 23, "user_id": 5326348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e86378ebc8e52349c2a7b434013dae4?s=128&d=identicon&r=PG&f=1", "display_name": "Kamran64", "link": "https://stackoverflow.com/users/5326348/kamran64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593541940, "creation_date": 1530099155, "last_edit_date": 1593541940, "question_id": 51061741, "link": "https://stackoverflow.com/questions/51061741/finding-id-of-shape-dragged-onto-screen-in-visio-using-vba-macro", "title": "Finding id of shape dragged onto screen in Visio using VBA macro", "body": "<p>I currently have a program in Visio that when a specific shape in my custom stencil is dragged onto the screen, a user form comes up and asks the user a question with a combo box used for the user to select an answer.</p>\n\n<p>Based on the answer selected, the shape data should change for that object.</p>\n\n<p>The problem that I am facing is that I am not sure how to target the ID of the shape automatically to then change its shape data. Since multiple of these shapes may be placed, I can not manually write a new piece of code for every ID.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Pusle.jpg\" rel=\"nofollow noreferrer\">Image: Shapesheet of the shape running the macro on drop. \"Form\" is the user form.</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/iCPCA.jpg\" rel=\"nofollow noreferrer\">Image: Userform macro</a></p>\n\n<p>I would be very grateful if someone could help me with this problem.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "edited": false, "score": 5, "creation_date": 1530096643, "post_id": 51060858, "comment_id": 89111655, "body": "How about conditional formatting?? much faster than looping through each cell."}, {"owner": {"reputation": 11114, "user_id": 1712135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cErYR.png?s=128&g=1", "display_name": "deHaar", "link": "https://stackoverflow.com/users/1712135/dehaar"}, "reply_to_user": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "edited": false, "score": 0, "creation_date": 1530096909, "post_id": 51060858, "comment_id": 89111836, "body": "What @NagarajanND wrote is totally right, you just don&#39;t need VBA for this task."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1530097345, "post_id": 51060858, "comment_id": 89112120, "body": "<code>Application.EnableAnimations = False</code> on the second line would speed it up about 10 to 100 times."}, {"owner": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "reply_to_user": {"reputation": 11114, "user_id": 1712135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cErYR.png?s=128&g=1", "display_name": "deHaar", "link": "https://stackoverflow.com/users/1712135/dehaar"}, "edited": false, "score": 0, "creation_date": 1530097348, "post_id": 51060858, "comment_id": 89112123, "body": "@deHaar this is just a function but I have a massive macro that runs with it."}, {"owner": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "reply_to_user": {"reputation": 685, "user_id": 6187845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc90c985e2d7b81ba79c02313aeeefd?s=128&d=identicon&r=PG&f=1", "display_name": "nagarajannd", "link": "https://stackoverflow.com/users/6187845/nagarajannd"}, "edited": false, "score": 0, "creation_date": 1530097403, "post_id": 51060858, "comment_id": 89112153, "body": "@NagarajanND that is a good idea, I&#39;ll try and let you know!"}, {"owner": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1530097465, "post_id": 51060858, "comment_id": 89112189, "body": "@Vityata I wasn&#39;t aware of this line. Thanks ! (I did disable the screening update tho)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1530097507, "post_id": 51060858, "comment_id": 89112220, "body": "@Chris - this is the idea. Before the End Sub, write <code>Application.EnableAnimations = True</code> to have them back."}, {"owner": {"reputation": 11114, "user_id": 1712135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cErYR.png?s=128&g=1", "display_name": "deHaar", "link": "https://stackoverflow.com/users/1712135/dehaar"}, "edited": false, "score": 0, "creation_date": 1530097526, "post_id": 51060858, "comment_id": 89112230, "body": "@Chris you can apply conditional formatting via VBA, I just thought about minimizing your code in order to make it faster."}, {"owner": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "reply_to_user": {"reputation": 11114, "user_id": 1712135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cErYR.png?s=128&g=1", "display_name": "deHaar", "link": "https://stackoverflow.com/users/1712135/dehaar"}, "edited": false, "score": 0, "creation_date": 1530105725, "post_id": 51060858, "comment_id": 89117696, "body": "@deHaar you guys were right, conditional formatting seems, by far, the fastest way to do it (I didn&#39;t even think about it earlier, shame on me :/). Thanks!"}, {"owner": {"reputation": 11114, "user_id": 1712135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cErYR.png?s=128&g=1", "display_name": "deHaar", "link": "https://stackoverflow.com/users/1712135/dehaar"}, "edited": false, "score": 0, "creation_date": 1530105812, "post_id": 51060858, "comment_id": 89117778, "body": "@Chris very good! I like things working as desired..."}], "answers": [{"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1530098160, "creation_date": 1530098160, "answer_id": 51061392, "question_id": 51060858, "link": "https://stackoverflow.com/questions/51060858/excel-vba-efficient-way-to-colorize-a-large-number-of-cells/51061392#51061392", "title": "Excel VBA - Efficient way to colorize a large number of cells", "body": "<p>If you want a VBA solution, then you can search by format and process the relevant cells. This should be significantly quicker.</p>\n\n<pre><code>Sub FindFormatting()\n\n    Dim Found As Range\n\n    Application.FindFormat.Clear\n\n    Application.FindFormat.Interior.Color = RGB(0, 106, 130)\n    Set Found = FindAll(What:=\"\", SearchWhat:=ActiveSheet, LookIn:=xlFormulas, LookAt:=xlPart, SearchFormat:=True)\n    If Not Found Is Nothing Then Found.Font.Color = RGB(255, 255, 255)\n\n    Application.FindFormat.Interior.Color = RGB(0, 138, 170)\n    Set Found = FindAll(What:=\"\", SearchWhat:=ActiveSheet, LookIn:=xlFormulas, LookAt:=xlPart, SearchFormat:=True)\n    If Not Found Is Nothing Then Found.Font.Color = RGB(255, 255, 255)\n\n    Application.FindFormat.Interior.Color = RGB(177, 209, 217)\n    Set Found = FindAll(What:=\"\", SearchWhat:=ActiveSheet, LookIn:=xlFormulas, LookAt:=xlPart, SearchFormat:=True)\n    If Not Found Is Nothing Then Found.Font.Color = RGB(0, 0, 0)\n\n    Application.FindFormat.Interior.Color = RGB(204, 225, 230)\n    Set Found = FindAll(What:=\"\", SearchWhat:=ActiveSheet, LookIn:=xlFormulas, LookAt:=xlPart, SearchFormat:=True)\n    If Not Found Is Nothing Then Found.Font.Color = RGB(0, 0, 0)\n\nEnd Sub\n\nFunction FindAll(What, _\n    Optional SearchWhat As Variant, _\n    Optional LookIn, _\n    Optional LookAt, _\n    Optional SearchOrder, _\n    Optional SearchDirection As XlSearchDirection = xlNext, _\n    Optional MatchCase As Boolean = False, _\n    Optional MatchByte, _\n    Optional SearchFormat) As Range\n\n    'LookIn can be xlValues or xlFormulas, _\n     LookAt can be xlWhole or xlPart, _\n     SearchOrder can be xlByRows or xlByColumns, _\n     SearchDirection can be xlNext, xlPrevious, _\n     MatchCase, MatchByte, and SearchFormat can be True or False. _\n     Before using SearchFormat = True, specify the appropriate settings for the Application.FindFormat _\n     object; e.g. Application.FindFormat.NumberFormat = \"General;-General;\"\"-\"\"\"\n\n    Dim SrcRange As Range\n    If IsMissing(SearchWhat) Then\n        Set SrcRange = ActiveSheet.UsedRange\n    ElseIf TypeOf SearchWhat Is Range Then\n        Set SrcRange = IIf(SearchWhat.Cells.Count = 1, SearchWhat.Parent.UsedRange, SearchWhat)\n    ElseIf TypeOf SearchWhat Is Worksheet Then\n        Set SrcRange = SearchWhat.UsedRange\n    Else: SrcRange = ActiveSheet.UsedRange\n    End If\n    If SrcRange Is Nothing Then Exit Function\n\n    'get the first matching cell in the range first\n    With SrcRange.Areas(SrcRange.Areas.Count)\n        Dim FirstCell As Range: Set FirstCell = .Cells(.Cells.Count)\n    End With\n\n    Dim CurrRange As Range: Set CurrRange = SrcRange.Find(What:=What, After:=FirstCell, LookIn:=LookIn, LookAt:=LookAt, _\n        SearchDirection:=SearchDirection, MatchCase:=MatchCase, MatchByte:=MatchByte, SearchFormat:=SearchFormat)\n\n    If Not CurrRange Is Nothing Then\n        Set FindAll = CurrRange\n        Do\n            Set CurrRange = SrcRange.Find(What:=What, After:=CurrRange, LookIn:=LookIn, LookAt:=LookAt, _\n            SearchDirection:=SearchDirection, MatchCase:=MatchCase, MatchByte:=MatchByte, SearchFormat:=SearchFormat)\n            If CurrRange Is Nothing Then Exit Do\n            If Application.Intersect(FindAll, CurrRange) Is Nothing Then\n                Set FindAll = Application.Union(FindAll, CurrRange)\n            Else: Exit Do\n            End If\n        Loop\n    End If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "edited": false, "score": 1, "creation_date": 1530101884, "post_id": 51061464, "comment_id": 89114979, "body": "First, thanks a lot for your time ! I tried the code version you did before the edit and for some reason, it worked with only one value in the sheet. I&#39;ll try with this FindAll() version (that, from what I read, would certainly work)"}, {"owner": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "edited": false, "score": 0, "creation_date": 1530105654, "post_id": 51061464, "comment_id": 89117630, "body": "It works great for a VBA solution! I really like the idea! But as the other persons said earlier in the comments, it seems that conditional formatting is the fastest solution. Thx again!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "edited": false, "score": 0, "creation_date": 1530105784, "post_id": 51061464, "comment_id": 89117751, "body": "@Chris - conditional formatting is probably easier to manipulate for non-VBA people as well."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1530101443, "last_edit_date": 1530101443, "creation_date": 1530098365, "answer_id": 51061464, "question_id": 51060858, "link": "https://stackoverflow.com/questions/51060858/excel-vba-efficient-way-to-colorize-a-large-number-of-cells/51061464#51061464", "title": "Excel VBA - Efficient way to colorize a large number of cells", "body": "<p>Instead of going cell by cell in a column, thus 1 million+ cells per column, you may decide to define the used range of that column and color only it. </p>\n\n<p>This is doable through this:</p>\n\n<pre><code>Private Sub ApplyQtlColor(ByRef ws As Worksheet, ByVal qtlColumns As String)\n\n    Dim myRange As Range\n    Set myRange = ws.Range(qtlColumns)\n\n    Dim i As Long\n    Dim foundRange As Range\n    For i = 1 To 4\n        Set foundRange = FindAll(myRange, i)\n        If Not foundRange Is Nothing Then\n            'foundRange.Interior.Color = PickInteriorColor(i)\n            foundRange.Font.Color = PickFontColor(i)\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>You can PickFontColor and InteriorColor through some kind of a function:</p>\n\n<pre><code>Public Function PickFontColor(i) As Long\n\n    Select Case i\n        Case 1\n            PickFontColor = RGB(255, 255, 255)\n        Case 2\n            PickFontColor = RGB(255, 255, 255)\n        Case Else\n            PickFontColor = RGB(0, 0, 0)\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>The whole code is called this way: <code>ApplyQtlColor ActiveSheet, \"C:E\"</code></p>\n\n<p>The code uses the <code>FindAll()</code> function, <a href=\"http://www.cpearson.com/excel/findall.aspx\" rel=\"nofollow noreferrer\">from CPearson</a>. Thus, add this function somewhere:</p>\n\n<pre><code>Function FindAll(SearchRange As Range, _\n                 FindWhat As Variant, _\n                 Optional LookIn As XlFindLookIn = xlValues, _\n                 Optional LookAt As XlLookAt = xlWhole, _\n                 Optional SearchOrder As XlSearchOrder = xlByRows, _\n                 Optional MatchCase As Boolean = False, _\n                 Optional BeginsWith As String = vbNullString, _\n                 Optional EndsWith As String = vbNullString, _\n                 Optional BeginEndCompare As VbCompareMethod = vbTextCompare) As Range\n\n    Dim FoundCell As Range\n    Dim FirstFound As Range\n    Dim LastCell As Range\n    Dim ResultRange As Range\n    Dim XLookAt As XlLookAt\n    Dim Include As Boolean\n    Dim CompMode As VbCompareMethod\n    Dim Area As Range\n    Dim MaxRow As Long\n    Dim MaxCol As Long\n    Dim BeginB As Boolean\n    Dim EndB As Boolean    \n\n    CompMode = BeginEndCompare\n    If BeginsWith &lt;&gt; vbNullString Or EndsWith &lt;&gt; vbNullString Then\n        XLookAt = xlPart\n    Else\n        XLookAt = LookAt\n    End If\n\n    For Each Area In SearchRange.Areas\n        With Area\n            If .Cells(.Cells.Count).Row &gt; MaxRow Then\n                MaxRow = .Cells(.Cells.Count).Row\n            End If\n            If .Cells(.Cells.Count).Column &gt; MaxCol Then\n                MaxCol = .Cells(.Cells.Count).Column\n            End If\n        End With\n    Next Area\n    Set LastCell = SearchRange.Worksheet.Cells(MaxRow, MaxCol)\n\n    On Error GoTo 0\n    Set FoundCell = SearchRange.Find(what:=FindWhat, _\n                                     after:=LastCell, _\n                                     LookIn:=LookIn, _\n                                     LookAt:=XLookAt, _\n                                     SearchOrder:=SearchOrder, _\n                                     MatchCase:=MatchCase)\n\n    If Not FoundCell Is Nothing Then\n        Set FirstFound = FoundCell\n        Do Until False    ' Loop forever. We'll \"Exit Do\" when necessary.\n            Include = False\n            If BeginsWith = vbNullString And EndsWith = vbNullString Then\n                Include = True\n            Else\n                If BeginsWith &lt;&gt; vbNullString Then\n                    If StrComp(Left(FoundCell.Text, Len(BeginsWith)), BeginsWith, BeginEndCompare) = 0 Then\n                        Include = True\n                    End If\n                End If\n                If EndsWith &lt;&gt; vbNullString Then\n                    If StrComp(Right(FoundCell.Text, Len(EndsWith)), EndsWith, BeginEndCompare) = 0 Then\n                        Include = True\n                    End If\n                End If\n            End If\n            If Include = True Then\n                If ResultRange Is Nothing Then\n                    Set ResultRange = FoundCell\n                Else\n                    Set ResultRange = Application.Union(ResultRange, FoundCell)\n                End If\n            End If\n            Set FoundCell = SearchRange.FindNext(after:=FoundCell)\n            If (FoundCell Is Nothing) Then\n                Exit Do\n            End If\n            If (FoundCell.Address = FirstFound.Address) Then\n                Exit Do\n            End If\n\n        Loop\n    End If\n\n    Set FindAll = ResultRange\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 114, "user_id": 8016581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b4ba0552a842984c69fe35c744476e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8016581/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 0, "accepted_answer_id": 51061464, "answer_count": 2, "score": 1, "last_activity_date": 1530101443, "creation_date": 1530096423, "question_id": 51060858, "link": "https://stackoverflow.com/questions/51060858/excel-vba-efficient-way-to-colorize-a-large-number-of-cells", "title": "Excel VBA - Efficient way to colorize a large number of cells", "body": "<p>I am working on a piece of code that colors the background and the font value of a cell regarding its possible values. The code I wrote works well but is slow as I have a large number of cells to process (about 10 * 150k cells).</p>\n\n<pre><code>Private Sub ApplyQtlColor(ByRef ws As Worksheet, ByVal qtlColumns As String)\n\nDim cell As Range\n\nFor Each cell In ws.Range(qtlColumns).Cells\n    Select Case cell.value\n\n        Case 1\n            cell.Interior.Color = RGB(0, 106, 130)\n            cell.Font.Color = RGB(255, 255, 255)\n        Case 2\n            cell.Interior.Color = RGB(0, 138, 170)\n            cell.Font.Color = RGB(255, 255, 255)\n        Case 3\n            cell.Interior.Color = RGB(177, 209, 217)\n            cell.Font.Color = RGB(0, 0, 0)\n        Case 4\n            cell.Interior.Color = RGB(204, 225, 230)\n            cell.Font.Color = RGB(0, 0, 0)\n\n    End Select\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>To improve the program, I would like to speed up the function. </p>\n\n<p>The only idea I got is that I could get the values in a variant, loop into the variant to get the corresponding rows of the values and apply the colors in one line (for one case) within a defined range. But regarding the number of cells, it seems a bit complex to define the range (I didn't try yet). </p>\n\n<p>So I was wondering if someone has been in the same situation and found a solution.</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1530095810, "post_id": 51060608, "comment_id": 89111093, "body": "How about a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 451, "user_id": 2432555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d274251c72f4dc0081bfcafa9807f05b?s=128&d=identicon&r=PG&f=1", "display_name": "JonTout", "link": "https://stackoverflow.com/users/2432555/jontout"}, "edited": false, "score": 0, "creation_date": 1530095918, "post_id": 51060608, "comment_id": 89111173, "body": "what are the values for MyPath and MyFilename and do you have access to write to that location?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1530096118, "post_id": 51060608, "comment_id": 89111301, "body": "Sounds like the (a) report is not open."}, {"owner": {"reputation": 107, "user_id": 9410048, "user_type": "registered", "profile_image": "https://graph.facebook.com/990260100984145/picture?type=large", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9410048/stefano"}, "reply_to_user": {"reputation": 451, "user_id": 2432555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d274251c72f4dc0081bfcafa9807f05b?s=128&d=identicon&r=PG&f=1", "display_name": "JonTout", "link": "https://stackoverflow.com/users/2432555/jontout"}, "edited": false, "score": 0, "creation_date": 1530097513, "post_id": 51060608, "comment_id": 89112225, "body": "@JonTout right question :) I have edited the post to answer to your question"}, {"owner": {"reputation": 107, "user_id": 9410048, "user_type": "registered", "profile_image": "https://graph.facebook.com/990260100984145/picture?type=large", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9410048/stefano"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1530097539, "post_id": 51060608, "comment_id": 89112238, "body": "@Gustav sorry, I don&#39;t undestrand. may you explain better?"}, {"owner": {"reputation": 451, "user_id": 2432555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d274251c72f4dc0081bfcafa9807f05b?s=128&d=identicon&r=PG&f=1", "display_name": "JonTout", "link": "https://stackoverflow.com/users/2432555/jontout"}, "edited": false, "score": 1, "creation_date": 1530097900, "post_id": 51060608, "comment_id": 89112456, "body": "Assuming this will run on a local PC... My_Path would equal to &quot;C:\\Users\\Public\\Music\\&quot; (without the quotes) and My_Filename would be &quot;File_name.pdf&quot; (again, without the quotes).  Can you post the VBA that creates those variables?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1530097977, "post_id": 51060608, "comment_id": 89112495, "body": "<code>&quot;File_name&quot;</code> must be the report name. -- And: which Access version?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1530196943, "post_id": 51060608, "comment_id": 89159745, "body": "This happened once at my office with and old version of Access and the problem was that the PC did not have installed any Add-In or Adobe able to create PDF files, not even manually. Could be that?"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1531948764, "post_id": 51060608, "comment_id": 89793751, "body": "Please add a Debug.Print MyPath,   MyFilename   and determine if MyFilename has a &quot;.PDF&quot; suffix"}], "owner": {"reputation": 107, "user_id": 9410048, "user_type": "registered", "profile_image": "https://graph.facebook.com/990260100984145/picture?type=large", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9410048/stefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 531, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594653135, "creation_date": 1530095704, "last_edit_date": 1594653135, "question_id": 51060608, "link": "https://stackoverflow.com/questions/51060608/acess-vba-runtime-error-2282", "title": "Acess VBA: Runtime error 2282", "body": "<p>I get the following error</p>\n\n<pre><code>VB Runtime Error 2282: The format in which you are attempting to output the current object is not available\n</code></pre>\n\n<p>when I try to run this VBA string:</p>\n\n<pre><code>Private Sub Print_Click()\n    DoCmd.OutputTo acOutputReport, \"File_name\", acFormatPDF, MyPath &amp; MyFilename, True\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p><code>MyPath</code> comes from the Red arrow.\n<code>MyFilename</code> comes from the Blue arrow.</p>\n\n<p><a href=\"https://i.stack.imgur.com/9HNw0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9HNw0.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "multiple-columns"], "answers": [{"comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 3, "user_id": 9999240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1738d8e3a349c4c0ac482b7154f5ea0?s=128&d=identicon&r=PG&f=1", "display_name": "hMur", "link": "https://stackoverflow.com/users/9999240/hmur"}, "edited": false, "score": 0, "creation_date": 1530102691, "post_id": 51060769, "comment_id": 89115503, "body": "Nothing to be ashamed about, sometimes the easiest of solutions are the ones that takes us the longest to realize ;)"}], "tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": true, "score": 1, "last_activity_date": 1530096178, "creation_date": 1530096178, "answer_id": 51060769, "question_id": 51060289, "link": "https://stackoverflow.com/questions/51060289/excel-vba-how-to-copy-row-from-one-worksheet-to-another-based-on-data-range-wit/51060769#51060769", "title": "Excel VBA: How to copy row from one worksheet to another based on data range with additional criteria to narrow down results?", "body": "<p>Use offset to compare the data in column C.<br>\nAdd the following condition inside your <code>If</code> statement, appended with <code>And</code></p>\n\n<pre><code>For Each c In rng.Cells\n  If c.Value &gt;= startdate And c.Value &lt;= enddate And c.Offset(0, 1) &lt;&gt; \"Action\" Then\n     '....code.... \n  End If\nNext c \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9999240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1738d8e3a349c4c0ac482b7154f5ea0?s=128&d=identicon&r=PG&f=1", "display_name": "hMur", "link": "https://stackoverflow.com/users/9999240/hmur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 51060769, "answer_count": 1, "score": 0, "last_activity_date": 1530096178, "creation_date": 1530094774, "question_id": 51060289, "link": "https://stackoverflow.com/questions/51060289/excel-vba-how-to-copy-row-from-one-worksheet-to-another-based-on-data-range-wit", "title": "Excel VBA: How to copy row from one worksheet to another based on data range with additional criteria to narrow down results?", "body": "<p>I have the below code that copies rows from one worksheet to another based on a date range in column B. However, struggling to add a second condition that would eliminate results based on another column (C) containing text \"Action\". Can anyone help on this? </p>\n\n<pre><code>Private Sub CommandButton3_Click()\n    Dim startdate As Date, enddate As Date\n    Dim rng As Range, destRow As Long\n    Dim shtSrc As Worksheet, shtDest As Worksheet\n    Dim c As Range\n\n    Set shtSrc = Sheets(\"Tier2\")\n    Set shtDest = Sheets(\"Parameters\")\n\n    destRow = 74 \n\n    startdate = DateSerial(Year(Now), Month(Now), 1)\n    enddate = DateSerial(Year(Now), Month(Now) + 3, 0)\n\n\n    Set rng = Application.Intersect(shtSrc.Range(\"B:B\"), shtSrc.UsedRange)\n\n\n    For Each c In rng.Cells\n        If c.Value &gt;= startdate And c.Value &lt;= enddate Then\n\n            c.Offset(0, 1).Resize(1, 10).Copy _\n                          shtDest.Cells(destRow, 1)\n\n            destRow = destRow + 1\n\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1530095433, "post_id": 51059999, "comment_id": 89110861, "body": "See this: <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">rubberduckvba.wordpress.com/2017/10/25/userform1-show</a>"}, {"owner": {"reputation": 1, "user_id": 9999149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d37a0ef36aab467dd08361b21b6eec?s=128&d=identicon&r=PG&f=1", "display_name": "Weierstrass94", "link": "https://stackoverflow.com/users/9999149/weierstrass94"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1530099215, "post_id": 51059999, "comment_id": 89113223, "body": "@KostasK. Ok thank you for the link, I&#39;ll see what I can do."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9999149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d37a0ef36aab467dd08361b21b6eec?s=128&d=identicon&r=PG&f=1", "display_name": "Weierstrass94", "link": "https://stackoverflow.com/users/9999149/weierstrass94"}, "edited": false, "score": 0, "creation_date": 1530098832, "post_id": 51060568, "comment_id": 89112991, "body": "Ok thank you for your answer. Yet the quick answer does not really do what I want since it closes everything when I press the &#39;X&#39; button... I guess I have to think about OOP then. Thanks"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1530095573, "creation_date": 1530095573, "answer_id": 51060568, "question_id": 51059999, "link": "https://stackoverflow.com/questions/51059999/vba-issue-when-reopening-a-form/51060568#51060568", "title": "VBA issue when reopening a form", "body": "<p>There are two options :</p>\n\n<p>Answer 1 (the quick way) - Just add this to your code and live further:</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    End\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Answer 2 (the tough way, which would need about 2 months to learn some OOP basics):</p>\n\n<ul>\n<li>Read about OOP</li>\n<li>Rebuild the form, following the good practices, defining the form as an object and not working with the default instance:\n\n<ul>\n<li><a href=\"https://codereview.stackexchange.com/questions/154401/handling-dialog-closure-in-a-vba-user-form\">https://codereview.stackexchange.com/questions/154401/handling-dialog-closure-in-a-vba-user-form</a></li>\n<li><a href=\"http://www.vitoshacademy.com/vba-the-perfect-userform-in-vba/\" rel=\"nofollow noreferrer\">http://www.vitoshacademy.com/vba-the-perfect-userform-in-vba/</a> (disclaimer - my site)</li>\n</ul></li>\n<li>Enjoy</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 9999149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d37a0ef36aab467dd08361b21b6eec?s=128&d=identicon&r=PG&f=1", "display_name": "Weierstrass94", "link": "https://stackoverflow.com/users/9999149/weierstrass94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530101489, "creation_date": 1530093955, "last_edit_date": 1530101489, "question_id": 51059999, "link": "https://stackoverflow.com/questions/51059999/vba-issue-when-reopening-a-form", "title": "VBA issue when reopening a form", "body": "<p>I am creating a user interface with VBA and have an issue when I close a form with the <code>X</code> button.</p>\n\n<ol>\n<li><p>A main window has several buttons; one of them call a form for the user to identify. The code, very simple, is below:</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n    Main_Form.Hide\n    Identification_Form.Show\nEnd Sub\n</code></pre></li>\n<li><p>Then the Identification form opens; It has a textbox in which the user enters his name and a <code>OK</code> button to validate and follow the process.\nYet I want the user to be able to close this window with the <code>X</code> button and go back to the main form.\nThe code is below:</p>\n\n<pre><code>Public how_closing As Integer\n\nPrivate Sub UserForm_Terminate()\n    If how_closing = 0 Then\n        Main_Form.Show\n    End If\nEnd Sub\n\nPrivate Sub UserForm_Activate()\n    how_closing = 0\nEnd Sub\n\nPrivate Sub OK_Id_Click()\n    If TextBox1.Text = \"\" Then\n        MsgBox \"Please enter your name.\"\n        Exit Sub\n    End If\n    user_name = TextBox1.Text\n    how_closing = 1\n    Unload Identification_Form\n    Third_Form.Show\nEnd Sub\n</code></pre>\n\n<p>The <code>how_closing</code> variable is used to know if the unloading of the form is due to the press of the <code>OK</code> button or the <code>X</code> button (the behaviour should not be the same of course).</p></li>\n</ol>\n\n<p>My issue is the following:\nIf I launch the identification a first time, everything works fine. But if I close it (<code>X</code> button) and then relaunch it, nothing works; the <code>OK</code> button doesn't react, neither does the <code>X</code> button. All I can do is stop all the <code>macros</code>.</p>\n\n<p>Have you ever seen this kind of bug ?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1530092245, "creation_date": 1530092245, "answer_id": 51059351, "question_id": 51058974, "link": "https://stackoverflow.com/questions/51058974/disable-delete-insert-option-of-rows-columns-cells-in-a-workbook/51059351#51059351", "title": "Disable delete/insert option of rows/columns/cells in a workbook", "body": "<p>You can use the sheet protection with VBA code like this :</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim sh As Variant\nFor Each sh In Sheets\n    sh.Protect AllowInsertingColumns:=False, AllowInsertingRows:=False, UserInterfaceOnly:=True\nNext sh\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1530092302, "creation_date": 1530092302, "answer_id": 51059378, "question_id": 51058974, "link": "https://stackoverflow.com/questions/51058974/disable-delete-insert-option-of-rows-columns-cells-in-a-workbook/51059378#51059378", "title": "Disable delete/insert option of rows/columns/cells in a workbook", "body": "<p>The classical answer for <em>disable delete/insert option of rows/columns/cells in a workbook</em> is simply to protect the worksheet with a password and to define what can be done in the parameters. </p>\n\n<p>This is an example, not allowing inserting columns and rows:</p>\n\n<pre><code>Worksheets(1).Protect AllowInsertingColumns:=True, AllowInsertingRows:=True\n</code></pre>\n"}], "owner": {"reputation": 513, "user_id": 7760065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664b02c10f8e6947e912bdfe62b18bdb?s=128&d=identicon&r=PG&f=1", "display_name": "J.Mapz", "link": "https://stackoverflow.com/users/7760065/j-mapz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1228, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530092591, "creation_date": 1530091220, "last_edit_date": 1530091674, "question_id": 51058974, "link": "https://stackoverflow.com/questions/51058974/disable-delete-insert-option-of-rows-columns-cells-in-a-workbook", "title": "Disable delete/insert option of rows/columns/cells in a workbook", "body": "<p>I'm currently trying to figure out how to disable the delete/insert options of cells/rows/columns in a workbook. Currently, I'm working with the following VBA code to disable the delete option for rows and columns. However, this still allows me to delete cells (not clear content, but the \"delete\" where other cells need to shift). Also, I want to also disable the insert option for rows/columns/cells. Here's the code I'm currently using:</p>\n\n<pre><code>Private Sub Workbook_open()\nDim dis As CommandBarControl\nFor Each dis In Application.CommandBars.FindControls(ID:=293)\n    dis.Enabled = False\nNext\nFor Each dis In Application.CommandBars.FindControls(ID:=294)\n    dis.Enabled = False\nNext\nEnd Sub\n</code></pre>\n\n<p>I was trying to search for the \"ID\" of the delete cell and insert options so I could just replicate the above code, but I can't seem to find it. Any help will be greatly appreciated, thanks! :)</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 1737, "user_id": 8261341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eyDTc.jpg?s=128&g=1", "display_name": "Ivan Kaloyanov", "link": "https://stackoverflow.com/users/8261341/ivan-kaloyanov"}, "edited": false, "score": 0, "creation_date": 1530091983, "post_id": 51058942, "comment_id": 89108593, "body": "If you use T-SQL you can check the count of your select and then <code>RAISERROR</code> if it is 0."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9946692"}, "reply_to_user": {"reputation": 1737, "user_id": 8261341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eyDTc.jpg?s=128&g=1", "display_name": "Ivan Kaloyanov", "link": "https://stackoverflow.com/users/8261341/ivan-kaloyanov"}, "edited": false, "score": 0, "creation_date": 1530092752, "post_id": 51058942, "comment_id": 89109093, "body": "Dim count As Integer count = .Execute(&quot;select COUNT(*) from [values$S8:S8]&quot;) something like that?"}, {"owner": {"reputation": 1737, "user_id": 8261341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eyDTc.jpg?s=128&g=1", "display_name": "Ivan Kaloyanov", "link": "https://stackoverflow.com/users/8261341/ivan-kaloyanov"}, "edited": false, "score": 0, "creation_date": 1530092996, "post_id": 51058942, "comment_id": 89109242, "body": "No that way you will get the count only. You need to select as &#39;smth&#39; and then check count(smth)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9946692"}, "reply_to_user": {"reputation": 1737, "user_id": 8261341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eyDTc.jpg?s=128&g=1", "display_name": "Ivan Kaloyanov", "link": "https://stackoverflow.com/users/8261341/ivan-kaloyanov"}, "edited": false, "score": 0, "creation_date": 1530093509, "post_id": 51058942, "comment_id": 89109564, "body": "Do you have an example with my values pleasE?"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1530093400, "creation_date": 1530093400, "answer_id": 51059769, "question_id": 51058942, "link": "https://stackoverflow.com/questions/51058942/do-sql-request-if-there-are-no-erros-retrieve-data/51059769#51059769", "title": "Do sql request if there are no erros / Retrieve data", "body": "<p>If your idea is to check whether a worksheet exists, then do it. And forget about the SQL, it is non-relevant:</p>\n\n<pre><code>Public Function worksheetExists(wb As Workbook, sh As Worksheet) As Boolean    \n    worksheetExists = IsError(wb.sh.Range(\"A1\"))    \nEnd Function\n</code></pre>\n\n<p>And if you want to put the openning of the file in the function, then:</p>\n\n<pre><code>Public Function worksheetExists(path As String, sh As Worksheet) As Boolean\n\n    On Error GoTo worksheetExists_Error\n\n    Dim wb As Workbook\n    Set wb = Workbooks.Open(path)\n    worksheetExists = IsError(wb.sh.Range(\"A1\"))\n\n    wb.Close False\n\n    On Error GoTo 0\n    Exit Function\n\nworksheetExists_Error:\n\n    MsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") \"\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1530094858, "creation_date": 1530094858, "answer_id": 51060318, "question_id": 51058942, "link": "https://stackoverflow.com/questions/51058942/do-sql-request-if-there-are-no-erros-retrieve-data/51060318#51060318", "title": "Do sql request if there are no erros / Retrieve data", "body": "<p>Another option is to use <code>On Error Resume Next</code> really carefully, because it would ignore any error. However, you can do it on one line and put <code>On Error GoTo 0</code>, which stops the action. At the end, before assigning values to the new worksheet, check whether <code>rs is not Nothing</code>:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim path As String: path = \"C:\\Source.xlsx\"\n    Dim rs As Object\n\n    With CreateObject(\"ADODB.Connection\")\n        .CommandTimeout = 500\n        .ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" _\n                    &amp; path &amp; \";\" &amp; _\n                    \"Extended Properties=\"\"Excel 12.0;HDR=NO;Readonly=true\"\";\"\n        .Open\n\n        On Error Resume Next\n        Set rs = .Execute(\"SELECT * FROM [Sheet12$A1:B4]\")\n        On Error GoTo 0\n    End With\n\n    If Not rs Is Nothing Then\n        With ThisWorkbook.Worksheets(1).Range(\"A1\")\n            .CopyFromRecordset rs\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9946692"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1530094858, "creation_date": 1530091121, "question_id": 51058942, "link": "https://stackoverflow.com/questions/51058942/do-sql-request-if-there-are-no-erros-retrieve-data", "title": "Do sql request if there are no erros / Retrieve data", "body": "<p>In my Excel VBA code, I open a connection with other workbook.</p>\n\n<pre><code>  With CreateObject(\"ADODB.Connection\")\n        .CommandTimeout = 500\n        .ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" _\n        &amp; path &amp; \";\" &amp; \"Extended Properties=\"\"Excel 12.0;HDR=NO;Readonly=true\"\";\"\n    .Open\n</code></pre>\n\n<p>I want to do this kind of line :</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Test\").Range(\"H306:307\").CopyFromRecordset .Execute(\"select * from [values$S8:S8]\")\n</code></pre>\n\n<p>But, it is possible that the sheet \"values\" doesn't exist, it is why I want to do this line only if there are no erros or if \"values\" exist, but I don't know how do that.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1530090369, "post_id": 51058640, "comment_id": 89107583, "body": "And what have you tried to make it work?"}, {"owner": {"reputation": 1, "user_id": 9998858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CKZ4yMFxOAw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2-Da3eKNLPKGrSqQNhEdLo8e3pPg/mo/photo.jpg?sz=128", "display_name": "Edward", "link": "https://stackoverflow.com/users/9998858/edward"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1530090695, "post_id": 51058640, "comment_id": 89107769, "body": "I changed the way in which I copy between the sheets. I recorded a macro just copying and used it instead, won&#39;t work same thing happen."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1530091202, "post_id": 51058640, "comment_id": 89108071, "body": "Refrain from using .select/.copy/.paste and just refer to cell values if you need to simply have the value in another cell like so: Cells(1, 2).value = Cells(1, 1).value"}], "answers": [{"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 0, "last_activity_date": 1530092153, "creation_date": 1530092153, "answer_id": 51059314, "question_id": 51058640, "link": "https://stackoverflow.com/questions/51058640/how-to-copy-between-sheets-in-vba-i-tried-to-record-macro-but-it-doesnt-work/51059314#51059314", "title": "How to copy between sheets In vba, I tried to record macro but it doesn&#39;t work", "body": "<p>There are multiple things which are not inheritly wrong, but a bad coding practice in your code. </p>\n\n<p><strong>You should avoid using <code>Select, ActiveSheet, Active...</code> like a plague</strong> as it comes with a <em>\"nice bundle of unforeseen issues which will end up hurting your program in a long run\"</em>. I would definitely recommend reading this <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">question here</a>, before even doing any further coding yourself: </p>\n\n<p>Also, utitilize the procedures. Don't just dump everything into huge chunks of code. Your future self will thank you later for readability (or anyone who tries to update the code after you, even more).</p>\n\n<blockquote>\n  <p><em>I'm not exactly sure, if what I'm about to do is right, as it's not exactly clear from your original question, what the expected result would be, but this should serve as at least as some form of template of what your code should look like:</em></p>\n</blockquote>\n\n<pre><code>Private Sub update_table()\n\nSheets(2).Cells.Clear\n\nDim qurl As String\nDim ticker As Long\n\nFor i = 2 To Sheets(1).Cells(1, 1).End(xlToRight).Column\n    ticker = Sheets(1).Cells(1, i)\n    qurl = \"https://finance.yahoo.com/quote/\" &amp; ticker &amp; \"/key-statistics?p=\" &amp; ticker &amp; \"\"\n\n    With Sheets(2).QueryTables.Add(Connection:=\"URL;\" &amp; qurl, Destination:=Sheets(2).Range(\"A1\"))\n        .BackgroundQuery = True\n        .Refresh BackgroundQuery = False\n    End With\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>and the copy_paste which invokes <code>update_table()</code></p>\n\n<pre><code>Private Sub cp_table()\n\n    Call update_table\n    Sheets(2).Range(\"B1\").CurrentRegion.Copy\n    Sheets(1).Range(\"A2\").PasteSpecial\n\nEnd Sub\n</code></pre>\n\n<p>If you can update your question with expected input data and expected output, I can edit my answer accordingly to make sure the code works and doesn't only serve as a pseudo-code. </p>\n"}], "owner": {"reputation": 1, "user_id": 9998858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CKZ4yMFxOAw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2-Da3eKNLPKGrSqQNhEdLo8e3pPg/mo/photo.jpg?sz=128", "display_name": "Edward", "link": "https://stackoverflow.com/users/9998858/edward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530092153, "creation_date": 1530090129, "question_id": 51058640, "link": "https://stackoverflow.com/questions/51058640/how-to-copy-between-sheets-in-vba-i-tried-to-record-macro-but-it-doesnt-work", "title": "How to copy between sheets In vba, I tried to record macro but it doesn&#39;t work", "body": "<p>Hello I have this program that will get data from yahoo finance in one sheet then choose the numerical data and then paste it in the my first sheet under the ticker. </p>\n\n<pre><code>Sub fundamentals()\n\nFor i = 2 To Sheets(1).Cells(1, 1).End(xlToRight).Column\n\nticker = Sheets(1).Cells(1, i)\n\nqurl = \"https://finance.yahoo.com/quote/\" &amp; ticker &amp; \"/key-statistics?p=\" &amp; ticker &amp; \"\"\n\nSheets(2).Select\nSheets(2).Cells.Clear\n\nWith ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; qurl,       Destination:=Sheets(2).Range(\"A1\"))\n.BackgroundQuery = True\n.Refresh BackgroundQuery = False\nEnd With\n\n\nSheets(2).Range(\"B1:B67\").Copy\nSheets(1).Select\nCells(2, i).Select\nActiveSheet.Paste\nCutCopyMode = False\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>It works fine but until it should paste it self to my first sheet, it does not work but in the left corner it says press enter to select destination or paste. I want to make it work automatically so it paste by itself.</p>\n\n<p>Kind regards</p>\n"}, {"tags": ["vba", "directory"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1530088645, "post_id": 51058113, "comment_id": 89106588, "body": "You cannot use twice in row the Dir command with parameters. Dir use an internal status that is reset each time."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1530088669, "post_id": 51058113, "comment_id": 89106593, "body": "Invert the two first Dir lines."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8873848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8bfef06b7b582be03910df3f9fd6586?s=128&d=identicon&r=PG&f=1", "display_name": "ilyasse B.", "link": "https://stackoverflow.com/users/8873848/ilyasse-b"}, "edited": false, "score": 0, "creation_date": 1530090301, "post_id": 51058229, "comment_id": 89107537, "body": "OMG, that explains why it worked with another code. So stupid of me. I will have time tonight to try this out. Thanks in advance."}, {"owner": {"reputation": 3, "user_id": 8873848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8bfef06b7b582be03910df3f9fd6586?s=128&d=identicon&r=PG&f=1", "display_name": "ilyasse B.", "link": "https://stackoverflow.com/users/8873848/ilyasse-b"}, "edited": false, "score": 0, "creation_date": 1530167054, "post_id": 51058229, "comment_id": 89140864, "body": "Thanks, It worked like a charm. Also thanks for the explaination."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 2, "last_activity_date": 1530088776, "creation_date": 1530088776, "answer_id": 51058229, "question_id": 51058113, "link": "https://stackoverflow.com/questions/51058113/vba-dir-returns-empty-string/51058229#51058229", "title": "VBA dir() returns empty string", "body": "<p>You should simple change the order of the two Dir-statements:</p>\n\n<pre><code>controlFile = Dir(directory &amp; \"control.xlsm\")\nfileName = Dir(directory &amp; \"*.xlsx\")\n</code></pre>\n\n<p>When you issue a <code>Dir</code>-command with parameter, a new search is started according to the pattern you pass. <code>Dir</code>-command without parameter fetches the next file matching that pattern. In your code, you started first a search with wildcards and then a second search with a fixed filename. When you start your loop, the <code>dir</code>-command will try to find another file with name <code>control.xlsm</code> and of course fails.</p>\n"}], "owner": {"reputation": 3, "user_id": 8873848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8bfef06b7b582be03910df3f9fd6586?s=128&d=identicon&r=PG&f=1", "display_name": "ilyasse B.", "link": "https://stackoverflow.com/users/8873848/ilyasse-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3610, "favorite_count": 0, "accepted_answer_id": 51058229, "answer_count": 1, "score": 0, "last_activity_date": 1530088776, "creation_date": 1530088290, "question_id": 51058113, "link": "https://stackoverflow.com/questions/51058113/vba-dir-returns-empty-string", "title": "VBA dir() returns empty string", "body": "<p>I'm trying to get this vba working. It reads the correct filestructure and it does find the first .xlsx and it import the needed data to the control.xlsm.</p>\n\n<p>I notice that after it gets to fileName = dir() the fileName becomes empty. I read that it does this because it cannot find files that match the criteria, but what am i doing wrong?</p>\n\n<p>Here is the code</p>\n\n<pre><code>     Sub test_werk_final()\n   Application.ScreenUpdating = False\n   Application.CutCopyMode = False\n   Application.DisplayAlerts = False\n\n  Dim directory, fileName As String, sheet As Worksheet\n\n directory = ThisWorkbook.Path &amp; \"\\\"\n\nfileName = Dir(directory &amp; \"*.xlsx\")\ncontrolFile = Dir(directory &amp; \"control.xlsm\")\n  lijn = 2\n  MsgBox \"1\" &amp; directory &amp; \"2\" &amp; fileName &amp; \"3\" &amp; controlFile\n  Do Until fileName = \"\"\n    MsgBox \"1\" &amp; directory &amp; \"2\" &amp; fileName &amp; \"3\" &amp; controlFile\n\n       Workbooks.Open fileName:=(directory &amp; fileName)\n         MsgBox \"1\" &amp; directory &amp; \"2\" &amp; fileName &amp; \"3\" &amp; controlFile\nnaam = Sheets(\"Sheet2\").Range(\"A1\").Value\n\nleeftijd = Sheets(\"Sheet2\").Range(\"A2\").Value\n\nWorkbooks(controlFile).Worksheets(\"control\").Cells(lijn, 1) = naam\nWorkbooks(controlFile).Worksheets(\"control\").Cells(lijn, 2) = leeftijd\nFor Each sheet In Workbooks(fileName).Worksheets\nnaam = Workbooks(fileName).Worksheets.Range(\"A1\").Value\nleeftijd = Workbooks(fileName).Worksheets.Range(\"A2\").Value\n\nWorkbooks(controlFile).Worksheets(\"control\").Cells(lijn, 1) = naam\nWorkbooks(controlFile).Worksheets(\"control\").Cells(lijn, 2) = leeftijd\nNext sheet\nWorkbooks(fileName).Close\n  MsgBox \"1\" &amp; directory &amp; \"2\" &amp; fileName &amp; \"3\" &amp; controlFile\nlijn = lijn + 1\n         MsgBox \"1\" &amp; directory &amp; \"2\" &amp; fileName &amp; \"3\" &amp; controlFile\n\n\n       fileName = Dir() ' volgende\n         MsgBox \"1\" &amp; directory &amp; \"2\" &amp; fileName &amp; \"3\" &amp; controlFile\n Loop\n    Application.ScreenUpdating = True\n</code></pre>\n\n<p>I'm not an expert coding guru, but i do posses basic programming skills. </p>\n\n<p>P.S: i already looked for the questone on differnt fora en didn't find anything that could help me. Maybe i used the wrong search string. </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel", "vbscript", "sap"], "answers": [{"tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": true, "score": 0, "last_activity_date": 1530166398, "creation_date": 1530166398, "answer_id": 51075836, "question_id": 51057922, "link": "https://stackoverflow.com/questions/51057922/vbscript-click-save-to-continue-script/51075836#51075836", "title": "VBScript, click save to continue Script", "body": "<p>First, I would record the missing piece of vbs program. Then you have to recognize where in the main program this piece must be installed. But I suspect it will happen after saving. The rough structure might look like this:</p>\n\n<pre><code>. . .\nSession.findById(\"wnd[0]/tbar[0]/btn[11]\").press\n'------------------------------ new ---------------------------\non error resume next\n'Suppose that's the missing piece of program\nsession.findById(\"wnd[1]/usr/btnSPOP-OPTION1\").press\non error goto 0\n'------------------------------ new ---------------------------\n'we make sure the loop goes through every row and then end it\nj = j + 1\nWend\n. . .\n</code></pre>\n\n<p>Regards,\nScriptMan</p>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 9049645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ad355ee09213e1ffad1d0406f730ed?s=128&d=identicon&r=PG&f=1", "display_name": "M_Delineshev", "link": "https://stackoverflow.com/users/9049645/m-delineshev"}, "is_accepted": false, "score": 0, "last_activity_date": 1530260859, "creation_date": 1530260859, "answer_id": 51097412, "question_id": 51057922, "link": "https://stackoverflow.com/questions/51057922/vbscript-click-save-to-continue-script/51097412#51097412", "title": "VBScript, click save to continue Script", "body": "<p>I added the solution proposed by Script man above!\nIt worked perfectly!</p>\n"}], "owner": {"reputation": 85, "user_id": 9049645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ad355ee09213e1ffad1d0406f730ed?s=128&d=identicon&r=PG&f=1", "display_name": "M_Delineshev", "link": "https://stackoverflow.com/users/9049645/m-delineshev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 51075836, "answer_count": 2, "score": 0, "last_activity_date": 1530260859, "creation_date": 1530087614, "last_edit_date": 1531164843, "question_id": 51057922, "link": "https://stackoverflow.com/questions/51057922/vbscript-click-save-to-continue-script", "title": "VBScript, click save to continue Script", "body": "<p>i have a certain problem with A VBScript when i try to automate a procedure with VBA/VBS macro.</p>\n\n<p>It enters a contract number in VBS and does some standardized changes in VA03, but for some there are some incoplete information, then this pop-up window appears:</p>\n\n<p><a href=\"https://i.stack.imgur.com/42GNY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/42GNY.png\" alt=\"enter image description here\"></a></p>\n\n<p>I only want my script to click Save and continue in case this happens for a certain contract number. </p>\n\n<p>It did not work with Applications.DisplayAlerts = False, and also i guess it will not work with Error Handler as practically this is not an Error. </p>\n\n<p>It should be with a simple IF statement, but i do not know how i should put the wording. </p>\n\n<p>Can anyone please help, my research in the net got me nowhere :(</p>\n\n<p>Code (Although it is working, i only need a piece which will handle the above stopper):</p>\n\n<pre><code>today = Format(Date, \"dd.mm.yyyy\")\n   Application.DisplayAlerts = False\n   'We declared the variables for the while function in excel\n    Dim cont As String\n    Dim row As Integer\nDim rep As String\n\nDim j As Integer\nj = 2\n\n'Those are the commands with which we make SAP available for the VBA code\nSet SapGuiAuto = GetObject(\"SAPGUI\")\n  Set SAPApp = SapGuiAuto.GetScriptingEngine\n  Set SAPCon = SAPApp.Children(0)\n  Set Session = SAPCon.Children(0)\n\n  If IsObject(WScript) Then\n   WScript.ConnectObject Session, \"on\"\n   WScript.ConnectObject Application, \"on\"\n End If\n\nSession.findById(\"wnd[0]\").maximize\nSession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\nSession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\nSession.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"va42\"\nSession.findById(\"wnd[0]\").sendVKey 0\n\n\n'We start the loop inside the macro book and give values to our variables\nWith ThisWorkbook\nWhile Cells(j, 1) &lt;&gt; \"\"\ncont = Cells(j, 1).Value\nrow = Cells(j, 3).Value\nrep = Cells(j, 4).Value\n\n' enter VBS code\n'In this part we change the inst to REMV\nSession.findById(\"wnd[0]\").maximize\nSession.findById(\"wnd[0]/usr/ctxtVBAK-VBELN\").Text = cont\nSession.findById(\"wnd[0]/usr/ctxtVBAK-VBELN\").caretPosition = 8\nSession.findById(\"wnd[0]\").sendVKey 0\nSession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4426/subSUBSCREEN_TC:SAPMV45A:4908/tblSAPMV45ATCTRL_U_ERF_KONTRAKT/ctxtVBAP-KDMAT[5,\" &amp; CStr(row) &amp; \"]\").SetFocus\nSession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4426/subSUBSCREEN_TC:SAPMV45A:4908/tblSAPMV45ATCTRL_U_ERF_KONTRAKT/ctxtVBAP-KDMAT[5,\" &amp; CStr(row) &amp; \"]\").caretPosition = 6\nSession.findById(\"wnd[0]\").sendVKey 2\n\n'change date\nSession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_ITEM/tabpT\\03\").Select\nSession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP/tabpT\\03/ssubSUBSCREEN_BODY:SAPLV45W:4201/ctxtVEDA-VDEMDAT\").Text = today\nSession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP/tabpT\\03/ssubSUBSCREEN_BODY:SAPLV45W:4201/ctxtVEDA-VDEMDAT\").SetFocus\nSession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP/tabpT\\03/ssubSUBSCREEN_BODY:SAPLV45W:4201/ctxtVEDA-VDEMDAT\").caretPosition = 10\n\n'change INST to REMV\nSession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP/tabpT\\10\").Select\nSession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_ITEM/tabpT\\10/ssubSUBSCREEN_BODY:SAPMV45A:4454/ctxtVBAP-KDMAT\").Text = rep\n\n'Deletes the first line in Technical Objects and saves the changes\nSession.findById(\"wnd[0]/mbar/menu[3]/menu[9]\").Select\nSession.findById(\"wnd[0]/usr/tblSAPLIWOLOBJK_220\").getAbsoluteRow(0).Selected = True\nSession.findById(\"wnd[0]/tbar[1]/btn[19]\").press\nSession.findById(\"wnd[1]/usr/btnSPOP-OPTION1\").press\nSession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\nSession.findById(\"wnd[0]/tbar[0]/btn[11]\").press\n\n'we make sure the loop goes through every row and then end it\nj = j + 1\nWend\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Best regards,\nMihail</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1530088349, "post_id": 51057812, "comment_id": 89106412, "body": "I&#39;m not saying there&#39;s definitely not one there, but I&#39;ve never come across it. Use the Watches pane of the VBE to examine the properties and see what you can find."}, {"owner": {"reputation": 234, "user_id": 6418109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3feb28dbc24648307695697d147c76a4?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude", "link": "https://stackoverflow.com/users/6418109/the-dude"}, "edited": false, "score": 0, "creation_date": 1530118072, "post_id": 51057812, "comment_id": 89125484, "body": "Your question is not specific enough. Are you trying to put the same formula in every column of the table? Do you want to put the formula in every row of a specific column? Or in a new column that has just been added to the table?"}], "owner": {"reputation": 91, "user_id": 3484847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46e3c9d266c2d76b8201c534eddbe991?s=128&d=identicon&r=PG&f=1", "display_name": "jw0ng", "link": "https://stackoverflow.com/users/3484847/jw0ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530087275, "creation_date": 1530087275, "question_id": 51057812, "link": "https://stackoverflow.com/questions/51057812/vba-excel-table-formula-reference", "title": "VBA Excel Table Formula reference", "body": "<p>I am trying to construct a long excel TABLE formula, using VBA and inject it into a new column of the table.</p>\n\n<p>I can do it with a long winding method by referencing the \"Name\" property of each column. just wondering if there is a quicker syntax to referencing them?</p>\n\n<p>e.g. a property that can give me the string :</p>\n\n<pre><code>  Table1[column1] \n</code></pre>\n\n<p>without me referencing to:</p>\n\n<pre><code>with Worksheets(\"Sheet1\").ListObjects(\"Table1\")\n    Str = .DisplayName &amp; \"[\" &amp; .ListColumns(1).Name &amp; \"]\"\nend with \n</code></pre>\n"}, {"tags": ["vba", "excel", "regional-settings"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1530087214, "post_id": 51057671, "comment_id": 89105739, "body": "With any value really, you should loop through the code and see where the mismatch starts to appear! It&#39;s very likely you can tweak around the values to your needs."}, {"owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "edited": false, "score": 1, "creation_date": 1530087335, "post_id": 51057671, "comment_id": 89105827, "body": "check this post - <a href=\"https://stackoverflow.com/questions/35724156/different-languages-issue-when-inserting-formula-from-vba\" title=\"different languages issue when inserting formula from vba\">stackoverflow.com/questions/35724156/&hellip;</a>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1530088326, "post_id": 51057671, "comment_id": 89106398, "body": "Also check this post if it could be a time thing <a href=\"https://stackoverflow.com/questions/51042654/converting-now-in-vba-to-est/51043302#51043302\">Converting \u201c= Now\u201d in VBA to EST</a>"}], "answers": [{"tags": [], "owner": {"reputation": 62, "user_id": 6863844, "user_type": "registered", "profile_image": "https://graph.facebook.com/989745891147306/picture?type=large", "display_name": "Shyam Pandey", "link": "https://stackoverflow.com/users/6863844/shyam-pandey"}, "is_accepted": false, "score": 2, "last_activity_date": 1530089629, "creation_date": 1530089629, "answer_id": 51058498, "question_id": 51057671, "link": "https://stackoverflow.com/questions/51057671/vba-macro-regional-issues/51058498#51058498", "title": "VBA Macro Regional issues", "body": "<p>May be currency setting would be there. if you are able to share the code that is easy to understand and help full to get the solution.</p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 8114974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956d76981f60ce06a7894e30760f68d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Huang", "link": "https://stackoverflow.com/users/8114974/bruce-huang"}, "edited": false, "score": 0, "creation_date": 1530102922, "post_id": 51062835, "comment_id": 89115667, "body": "Another idea is that you may comment out the codes like <b>On Error Resume Next</b> to look for more clues. Though it is tough..."}, {"owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1530103401, "post_id": 51062835, "comment_id": 89115981, "body": "The code doesn&#39;t give any errors, but due to the different formats the end result is different. I did do some research around changing the PC&#39;s region setting in VBA but the code goes way over my head, i did see another method which change a regex file."}, {"owner": {"reputation": 133, "user_id": 8114974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956d76981f60ce06a7894e30760f68d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Huang", "link": "https://stackoverflow.com/users/8114974/bruce-huang"}, "reply_to_user": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1530103728, "post_id": 51062835, "comment_id": 89116214, "body": "Could you share the codes on region setting you are trying? Or how about the solution here: <a href=\"https://stackoverflow.com/questions/42077145/type-mismatch-on-one-pc-but-not-other-run-time-error-13/42434556#42434556\" title=\"type mismatch on one pc but not other run time error 13\">stackoverflow.com/questions/42077145/&hellip;</a>"}, {"owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1530108015, "post_id": 51062835, "comment_id": 89119405, "body": "I&#39;ve been looking at this post <a href=\"https://www.mrexcel.com/forum/excel-questions/41533-controlling-windows-regional-settings-vba.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1530111163, "post_id": 51062835, "comment_id": 89121547, "body": "I have faced this since sometimes decimal may be &quot;,&quot; instead of &quot;.&quot; too, thus, this will give errors in calculations and your code will need to satisfy both regions effectively and VBA will likely work different if you change your regional settings. I think you may want to try the approach on the forum that you posted, you need to either change the regional code for the code, or test for every known configuration"}, {"owner": {"reputation": 133, "user_id": 8114974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956d76981f60ce06a7894e30760f68d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Huang", "link": "https://stackoverflow.com/users/8114974/bruce-huang"}, "reply_to_user": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 1, "creation_date": 1530114579, "post_id": 51062835, "comment_id": 89123595, "body": "@Tony, that&#39;s calling the Windows API. I found another post with more info here <a href=\"http://www.andreavb.com/forum/viewtopic_6845.html\" rel=\"nofollow noreferrer\">andreavb.com/forum/viewtopic_6845.html</a>"}, {"owner": {"reputation": 133, "user_id": 8114974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956d76981f60ce06a7894e30760f68d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Huang", "link": "https://stackoverflow.com/users/8114974/bruce-huang"}, "edited": false, "score": 0, "creation_date": 1530114773, "post_id": 51062835, "comment_id": 89123713, "body": "One more thing, Excel supports to read the settings via VBA, however, it&#39;s read only... Application.International(xlCountrySetting) will return your current setting."}, {"owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1530117756, "post_id": 51062835, "comment_id": 89125342, "body": "@BruceHuang Thanks for the pointers! May resort to changing the format in regional by calling on the API!"}, {"owner": {"reputation": 133, "user_id": 8114974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956d76981f60ce06a7894e30760f68d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Huang", "link": "https://stackoverflow.com/users/8114974/bruce-huang"}, "reply_to_user": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1530118091, "post_id": 51062835, "comment_id": 89125489, "body": "@Tony Glad to help :)"}], "tags": [], "owner": {"reputation": 133, "user_id": 8114974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956d76981f60ce06a7894e30760f68d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Huang", "link": "https://stackoverflow.com/users/8114974/bruce-huang"}, "is_accepted": false, "score": 0, "last_activity_date": 1530102565, "creation_date": 1530102565, "answer_id": 51062835, "question_id": 51057671, "link": "https://stackoverflow.com/questions/51057671/vba-macro-regional-issues/51062835#51062835", "title": "VBA Macro Regional issues", "body": "<p>I had similar experience when working on some European projects. The <strong>list separator</strong> may differs. In some regions it is comma, while in others it is semicolon. If this is not the case, then maybe you can create a function to change the PC's region setting to UK before your reports generation and then retrieve it back to the host region.</p>\n"}], "owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1530102565, "creation_date": 1530086866, "last_edit_date": 1530091306, "question_id": 51057671, "link": "https://stackoverflow.com/questions/51057671/vba-macro-regional-issues", "title": "VBA Macro Regional issues", "body": "<p>To give some background, I made some upgrades to an existing macro written by an ex-employee. As such, I didn't touch any of the core functions that were existing. Essentially the macro creates a bunch of reports based on the input. </p>\n\n<p>The macro runs perfectly fine in the UK, however we are trying to expand it to some  some teams in Europe. Testing this has resulted in some issues which are dependent on regional settings e.g. when the macro is run in Sweden it provides different result to when it is run in the UK on the same source data, however when the regional settings on the computer in Sweden are changed to the UK the output report matches that in the UK.</p>\n\n<p>I've tried looking at system separators but unfortunately this doesn't seem to be making much of a difference to the results (commas and decimal separators).</p>\n\n<p>I've looked at changing the region settings to the UK and then back to the host country but can't find anything on this. Any ideas or help on how to do this would be great.</p>\n\n<p>Thanks!</p>\n\n<p>EDIT: It's difficult to share the code due to the amount of modules (50). I think the best way may be to look at the format settings for different countries vs. UK and see if there is a way to set the excel workbook to run on the UK settings.</p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1530085854, "post_id": 51057225, "comment_id": 89104953, "body": "Can you build a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>? And check the value of <code>z</code>, by writing <code>MsgBox z</code> on the line before the error. Probably it is more or less than the rows of <code>Tabela20</code>."}, {"owner": {"reputation": 31, "user_id": 8103280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a1dff8c8fa9cef7fb9c4bc9fd2c7811?s=128&d=identicon&r=PG&f=1", "display_name": "HammerUser", "link": "https://stackoverflow.com/users/8103280/hammeruser"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1530086216, "post_id": 51057225, "comment_id": 89105183, "body": "z it&#39;s ok, even if I put any number instead of it I get an error"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1530086321, "post_id": 51057225, "comment_id": 89105239, "body": "That&#39;s good. Now really, try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, and post it. Post a screenshot of how <code>Tabela20</code> and your question would be solved pretty quickly."}, {"owner": {"reputation": 31, "user_id": 8103280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a1dff8c8fa9cef7fb9c4bc9fd2c7811?s=128&d=identicon&r=PG&f=1", "display_name": "HammerUser", "link": "https://stackoverflow.com/users/8103280/hammeruser"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1530086466, "post_id": 51057225, "comment_id": 89105336, "body": "it worked when i added 2 more rows to table. Why it didn&#39; work with one row table(+headers)?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1530086519, "post_id": 51057225, "comment_id": 89105370, "body": "No idea. The best case for you is to build a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "owner": {"reputation": 31, "user_id": 8103280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a1dff8c8fa9cef7fb9c4bc9fd2c7811?s=128&d=identicon&r=PG&f=1", "display_name": "HammerUser", "link": "https://stackoverflow.com/users/8103280/hammeruser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530086010, "creation_date": 1530085511, "last_edit_date": 1531164843, "question_id": 51057225, "link": "https://stackoverflow.com/questions/51057225/438-error-with-listobjecttable1-databodyrange-pastespecial", "title": "438 error with ListObject(&quot;Table1&quot;).DataBodyRange.PasteSpecial", "body": "<p>I get runtime error on:  </p>\n\n<pre><code>z = lr1 + x - 1\nWith Worksheets(\"b\")\n    .Activate\n    .Cells(2 + i, 2).Copy\n     '(error in here)---------------v\n    .ListObjects(\"Tabela20\").DataBodyRange(z, 1).PasteSpecial Paste:=xlPasteValues\n End With\n</code></pre>\n\n<p>i've tried with just \".paste\" or changeing Worksheets(\"b\") to ActiveSheet\nor</p>\n\n<pre><code>z = lr1 + x - 1\nWith Worksheets(\"b\")\n    .Activate\n    .Cells(2 + i, 2).Copy Destination:=.ListObjects(\"Tabela20\").DataBodyRange(z, 1)\n End With\n</code></pre>\n\n<p>This macro worked a week ago.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1530084805, "post_id": 51056875, "comment_id": 89104345, "body": "This is the issue: For Each cell In Columns(&quot;B&quot;).Cells.SpecialCells(xlCellTypeConstants).... You loop through Constant values while you use formula&#39;s. Why use specialcells anyway?"}, {"owner": {"reputation": 3, "user_id": 9998391, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qKOhXN83cGg/AAAAAAAAAAI/AAAAAAAAAQ0/7SxqNVG3OlM/photo.jpg?sz=128", "display_name": "MCheney", "link": "https://stackoverflow.com/users/9998391/mcheney"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1530085454, "post_id": 51056875, "comment_id": 89104733, "body": "JvdV, I am new to VBA, so I adapted an example after much searching! When I remove the piece you mention, I seem to run into more issues. If I replace the &#39;.To = &#39; to &#39;cell.row, &quot;B&quot;).Value&#39; again, nothing happens."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1530086198, "post_id": 51056875, "comment_id": 89105176, "body": "@MCheney copy-pasting code is one of the biggest disservices you can do to yourself. Not only there will almost always be something you need to adjust your own project accordingly, but you will miss out on most of the learning experience and even deeper understanding of how your program works. Creating issues like this, where you yourself have confusion in what the code is even supposed to really do. I personally would suggest starting over and writing it yourself from the scratch."}, {"owner": {"reputation": 3, "user_id": 9998391, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qKOhXN83cGg/AAAAAAAAAAI/AAAAAAAAAQ0/7SxqNVG3OlM/photo.jpg?sz=128", "display_name": "MCheney", "link": "https://stackoverflow.com/users/9998391/mcheney"}, "edited": false, "score": 0, "creation_date": 1530086479, "post_id": 51056875, "comment_id": 89105344, "body": "Thanks, I may well just do that as this clearly isn&#39;t working out!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9998391, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qKOhXN83cGg/AAAAAAAAAAI/AAAAAAAAAQ0/7SxqNVG3OlM/photo.jpg?sz=128", "display_name": "MCheney", "link": "https://stackoverflow.com/users/9998391/mcheney"}, "edited": false, "score": 1, "creation_date": 1530087681, "post_id": 51057595, "comment_id": 89106021, "body": "Many thanks, this worked and solved the issue. Lesson learnt! I was using this as a basis to learn from, but I think you are all right in that going back to basics might be the better option. Thanks again."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1530086642, "creation_date": 1530086642, "answer_id": 51057595, "question_id": 51056875, "link": "https://stackoverflow.com/questions/51056875/vba-not-working-with-vlookup/51057595#51057595", "title": "vba not working with vlookup", "body": "<p>Agreed with @Rawrplus, It really makes sense to try and understand the code. Anyway, if you are happy with your code then replace: </p>\n\n<pre><code>SpecialCells(xlCellTypeConstants)\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>SpecialCells(xlCellTypeFormulas)\n</code></pre>\n\n<p>As I said before, I wouldn't use SpecialCells but again, you are happy wit the code.</p>\n\n<p>One more thing; do you have a formula in column C stating true or false? Then also remove the \"true\" and just type True in your code.</p>\n\n<p>Good luck</p>\n"}], "owner": {"reputation": 3, "user_id": 9998391, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qKOhXN83cGg/AAAAAAAAAAI/AAAAAAAAAQ0/7SxqNVG3OlM/photo.jpg?sz=128", "display_name": "MCheney", "link": "https://stackoverflow.com/users/9998391/mcheney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 51057595, "answer_count": 1, "score": -1, "last_activity_date": 1530086642, "creation_date": 1530084429, "question_id": 51056875, "link": "https://stackoverflow.com/questions/51056875/vba-not-working-with-vlookup", "title": "vba not working with vlookup", "body": "<p>I am trying to write a document which automatically fires an email to certain people based on certain conditions. I have the code working, and am happy with what I have.</p>\n\n<p>But....</p>\n\n<p>When I change the email addresses on the worksheet into a vlookup, the coding I have no longer picks up the email addresses.</p>\n\n<p>Is there any way that this can be fixed? Thanks in advance. Code as is, below.</p>\n\n<pre><code>Sub Button1_Click()\n\nDim OutApp As Object\nDim OutMail As Object\nDim cell As Range\nDim StrBody As String\n\nApplication.ScreenUpdating = False\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nOn Error GoTo cleanup\nFor Each cell In Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants) \n    If cell.Value Like \"?*@?*.?*\" And _\n       LCase(Cells(cell.Row, \"C\").Value) = \"true\" Then \n\n        Set OutMail = OutApp.CreateItem(0)\n        On Error Resume Next\n        With OutMail\n            .To = cell.Value\n            .Subject = \"Urgent Training Notification  - Action Required\"\n            .Body = \"Dear \" &amp; Cells(cell.Row, \"A\").Value _\n                  &amp; vbNewLine &amp; vbNewLine &amp; _\n                    \"Please be aware, \" &amp; Cells(cell.Row, \"D\") &amp; \" is required to update the following training:\" &amp; vbNewLine &amp; _\n                    \" \" &amp; vbNewLine &amp; _\n                    Cells(cell.Row, \"E\") &amp; vbNewLine &amp; _\n                    \" \" &amp; vbNewLine &amp; _\n                    \"This must be rectified within 14 Days.\" &amp; vbNewLine &amp; _\n                    \" \" &amp; vbNewLine &amp; _\n                    \" \" &amp; vbNewLine &amp; _\n                    \"Any issues, please escalate as required.\" &amp; vbNewLine &amp; _\n                    \"Many thanks.\"\n\n            .Send  'Or use Display\n        End With\n        On Error GoTo 0\n        Set OutMail = Nothing\n    End If\nNext cell\n\ncleanup:\nSet OutApp = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1530084133, "post_id": 51056666, "comment_id": 89103981, "body": "please include your code"}, {"owner": {"reputation": 51, "user_id": 9561979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4be121668575a3501ff531509a0a5e29?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan", "link": "https://stackoverflow.com/users/9561979/ishan"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1530086478, "post_id": 51056666, "comment_id": 89105342, "body": "I have not written any code for scheduling as I am not aware as to how to do it."}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1530087749, "post_id": 51056666, "comment_id": 89106070, "body": "Use a Form&#39;s<a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/form-timer-event-access\" rel=\"nofollow noreferrer\">Timer</a> event. Note you should set <code>TimerInterval</code> to 600000 Miliseconds/"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9561979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4be121668575a3501ff531509a0a5e29?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan", "link": "https://stackoverflow.com/users/9561979/ishan"}, "edited": false, "score": 0, "creation_date": 1530091785, "post_id": 51058324, "comment_id": 89108457, "body": "I did Use this but its not doing anything. Its still the same."}, {"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1530108920, "post_id": 51058324, "comment_id": 89120029, "body": "Before you set the timer to 10 minutes, you might want to have it run every 10 seconds (<code>Me.TimerInterval = 1000 * 10</code>). That way, you&#39;re not waiting 10 minutes to test your code. Also, as a point of clarification: You can&#39;t schedule a <b>module</b> to run every so often, but only a sub-routine or function within that module. What does your <code>Split</code> sub do?"}, {"owner": {"reputation": 51, "user_id": 9561979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4be121668575a3501ff531509a0a5e29?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan", "link": "https://stackoverflow.com/users/9561979/ishan"}, "edited": false, "score": 0, "creation_date": 1530113256, "post_id": 51058324, "comment_id": 89122884, "body": "Hi Zack, My split function splits the multivalued data which is stored in single column into different rows."}, {"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1530118313, "post_id": 51058324, "comment_id": 89125614, "body": "That might be a bigger issue than your timer: You shouldn&#39;t be storing multi-valued data in a single field in Access, or any other database. Could you include a screenshot of your form, so we can maybe have an idea of what you&#39;re expecting to do?"}], "tags": [], "owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "is_accepted": false, "score": 0, "last_activity_date": 1530089045, "creation_date": 1530089045, "answer_id": 51058324, "question_id": 51056666, "link": "https://stackoverflow.com/questions/51056666/scheduling-msaccess-db-vba-module-automatically-for-every-10-minutes/51058324#51058324", "title": "Scheduling MSAccess DB VBA module automatically for every 10 minutes", "body": "<p>Create a form to b opened in the background, and in it's code section paste this code:</p>\n\n<pre><code>Sub Form_Load() \n    Me.TimerInterval = 600000 \nEnd Sub \n\nSub Form_Timer() \n    Split\nEnd Sub\n</code></pre>\n\n<p>Open the Form, and <code>Split</code> will run every 10 minutes.</p>\n"}], "owner": {"reputation": 51, "user_id": 9561979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4be121668575a3501ff531509a0a5e29?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan", "link": "https://stackoverflow.com/users/9561979/ishan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530089045, "creation_date": 1530083662, "question_id": 51056666, "link": "https://stackoverflow.com/questions/51056666/scheduling-msaccess-db-vba-module-automatically-for-every-10-minutes", "title": "Scheduling MSAccess DB VBA module automatically for every 10 minutes", "body": "<p>I have a module created \"Sub Split()\" in MSAccess DB VBA and I want to schedule this module to execute automatically after every 10 minutes . I did check out the code which says Application.OnTime Now + TimeValue(\"00:00:10\"), \"Split\" but its throwing an error . Is it that this function is applicable only in Excel and not in Access and If I want the same function in Access is there any way to do it?</p>\n"}, {"tags": ["vba", "excel", "user-defined-functions"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530084898, "post_id": 51056476, "comment_id": 89104397, "body": "UDF : You could for example walk the length of the cell value summing if isnumeric."}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1, "user_id": 9998322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348300107f2980e05b19717317db5724?s=128&d=identicon&r=PG&f=1", "display_name": "Umesh", "link": "https://stackoverflow.com/users/9998322/umesh"}, "edited": false, "score": 0, "creation_date": 1530168368, "post_id": 51057299, "comment_id": 89141489, "body": "@Umesh, for real? On my machine this works like a treat. Whether values are text or numeric...."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1530168492, "last_edit_date": 1530168492, "creation_date": 1530085731, "answer_id": 51057299, "question_id": 51056476, "link": "https://stackoverflow.com/questions/51056476/live-data-cell-split-and-add/51057299#51057299", "title": "Live data cell split and add", "body": "<p>You can do this with a formula like so in B1:</p>\n\n<pre><code>=SUMPRODUCT(1*MID(SUBSTITUTE(A1,\".\",\"\"),ROW(INDIRECT(\"1:\"&amp;LEN(SUBSTITUTE(A1,\".\",\"\")))),1))\n</code></pre>\n\n<p>Confirm with: <code>CTLR+SHIFT+ENTER</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/vgPx9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vgPx9.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1530087094, "creation_date": 1530087094, "answer_id": 51057759, "question_id": 51056476, "link": "https://stackoverflow.com/questions/51056476/live-data-cell-split-and-add/51057759#51057759", "title": "Live data cell split and add", "body": "<p>An UDF might look like</p>\n\n<pre><code>Public Function GetSum(ByRef rng As Range) As Long\n    Dim i As Long\n    For i = 1 To Len(rng.Value)\n        If IsNumeric(Mid(rng.Value, i, 1)) Then GetSum = GetSum + Mid(rng.Value, i, 1)\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9998322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348300107f2980e05b19717317db5724?s=128&d=identicon&r=PG&f=1", "display_name": "Umesh", "link": "https://stackoverflow.com/users/9998322/umesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1530344055, "creation_date": 1530082980, "last_edit_date": 1530344055, "question_id": 51056476, "link": "https://stackoverflow.com/questions/51056476/live-data-cell-split-and-add", "title": "Live data cell split and add", "body": "<p>I am using live data sheet in which I want to split each cell number into individual number and add them.</p>\n\n<pre><code>Example: \ncell A1 contains number 265.96\nInto 26596 and add these number\nie 2+6+5+9+6\n</code></pre>\n"}, {"tags": ["xml", "excel", "vba", "list", "duplicates"], "comments": [{"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1530082674, "post_id": 51056114, "comment_id": 89103234, "body": "u can use excel functions like count if and remove duplicates instead of VBA."}, {"owner": {"reputation": 3, "user_id": 4635137, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QiQtmZt68jM/AAAAAAAAAAI/AAAAAAAAQjI/vh_L7STL2Ag/photo.jpg?sz=128", "display_name": "Benjamin Sow", "link": "https://stackoverflow.com/users/4635137/benjamin-sow"}, "reply_to_user": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1530083328, "post_id": 51056114, "comment_id": 89103567, "body": "@techie I&#39;m using VBA to import the XML so it&#39;d be nice if I could just macro everything. Count if is interesting but I should add that the data in each cell is pretty long and I wouldn&#39;t know what they are exactly (not as simple as AAA or BBB) but I do know that there will be duplicates."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1530083956, "post_id": 51056114, "comment_id": 89103885, "body": "Have a quick look around for examples like here: <a href=\"https://stackoverflow.com/questions/36044556/quicker-way-to-get-all-unique-values-of-a-column-in-vba\" title=\"quicker way to get all unique values of a column in vba\">stackoverflow.com/questions/36044556/&hellip;</a> or here <a href=\"https://analysistabs.com/vba/find-duplicate-values-column/\" rel=\"nofollow noreferrer\">analysistabs.com/vba/find-duplicate-values-column</a>. Try something with these pieces of code and come back to tell us where in your code you have issues."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530086328, "post_id": 51056114, "comment_id": 89105243, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18932/how-can-i-remove-duplicate-rows\">How can I remove duplicate rows?</a> Questions like these get posted here every day. Do a bit of research please"}, {"owner": {"reputation": 3, "user_id": 4635137, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QiQtmZt68jM/AAAAAAAAAAI/AAAAAAAAQjI/vh_L7STL2Ag/photo.jpg?sz=128", "display_name": "Benjamin Sow", "link": "https://stackoverflow.com/users/4635137/benjamin-sow"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530089057, "post_id": 51056114, "comment_id": 89106791, "body": "@Rawrplus As mentioned in the question I have done my research and found methods for removing duplicate rows but that&#39;s not what I&#39;m looking for."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530089345, "post_id": 51056114, "comment_id": 89106949, "body": "@BenjaminSow With all due to respect, I don&#39;t think replacing two lines of code, where instead of deleting the row you <code>PasteSpecial</code> to your set <code>Range</code> is all that difficult that would warrant a new question."}, {"owner": {"reputation": 3, "user_id": 4635137, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QiQtmZt68jM/AAAAAAAAAAI/AAAAAAAAQjI/vh_L7STL2Ag/photo.jpg?sz=128", "display_name": "Benjamin Sow", "link": "https://stackoverflow.com/users/4635137/benjamin-sow"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530089863, "post_id": 51056114, "comment_id": 89107277, "body": "@Rawrplus I understand where you are coming from, but I&#39;m looking to not only copy the rows, but also obtain the number of occurances and paste that value. I started vba yesterday without any prior knowledge and did pretty much a whole day of trial and error and Googling before asking this. As seen by Sean&#39;s answer it is more than two lines two get both of the items working. Sorry if this is unwarranted."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530090123, "post_id": 51056114, "comment_id": 89107439, "body": "@BenjaminSow Alright. Thanks for clearing it up. Maybe to simplify the question for you, <b>it would be better to look at your question as two seperate issues - tasks</b>, rather than a one big issue: <b>1) Implement an algorithm that detects and prints duplicities</b> and <b>2) Create an algorithm that counts the amount of occurances.</b>  When you dissect your problems like so, the question gets divided into two very trivial issues that you can find easily on the internet - which was my point to begin with. Though given you&#39;re new to VBA I understand this may not occur to you naturally, so fair game."}, {"owner": {"reputation": 3, "user_id": 4635137, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QiQtmZt68jM/AAAAAAAAAAI/AAAAAAAAQjI/vh_L7STL2Ag/photo.jpg?sz=128", "display_name": "Benjamin Sow", "link": "https://stackoverflow.com/users/4635137/benjamin-sow"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530090302, "post_id": 51056114, "comment_id": 89107540, "body": "@Rawrplus Yeah after I posted this question I realized the word instances and occurrence would fit better and I did find some sites that helped with counting them. Thanks for the suggestion."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1530090817, "post_id": 51056114, "comment_id": 89107837, "body": "Glad it helped. By the way, what I described here is usually a very good (if not the best) approach to think of any coding tasks you&#39;re about to do. If you try to think of something as one giant issue, it will almost always end up overwhelming you. However, if you divide your issue into multiple ones, not only this helps you simplify the entire matter at hand, but actually helps you create a bettter code structure (eg. you think of using functions rather than one giant block) and suddenly, the insurmountable slope becomes few easy steps towards achievement - definitely a practice to live by :)"}], "answers": [{"tags": [], "owner": {"reputation": 62, "user_id": 6863844, "user_type": "registered", "profile_image": "https://graph.facebook.com/989745891147306/picture?type=large", "display_name": "Shyam Pandey", "link": "https://stackoverflow.com/users/6863844/shyam-pandey"}, "is_accepted": false, "score": -1, "last_activity_date": 1530084496, "creation_date": 1530084496, "answer_id": 51056899, "question_id": 51056114, "link": "https://stackoverflow.com/questions/51056114/how-to-find-duplicates-and-list-them-separately-using-vba-in-excel/51056899#51056899", "title": "How to find duplicates and list them separately using VBA in Excel?", "body": "<p>You can use range(\"a:a\").RemoveDuplicates in vba code. This will remove all the duplicates. \nOr you can use conditional formatting to color duplicates.</p>\n\n<p><a href=\"https://i.stack.imgur.com/M6OSJ.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4635137, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QiQtmZt68jM/AAAAAAAAAAI/AAAAAAAAQjI/vh_L7STL2Ag/photo.jpg?sz=128", "display_name": "Benjamin Sow", "link": "https://stackoverflow.com/users/4635137/benjamin-sow"}, "edited": false, "score": 0, "creation_date": 1530453569, "post_id": 51057078, "comment_id": 89232983, "body": "Thanks for the comprehensive answer @SeanW333. It worked perfectly although it took me sometime to go through the code, didn&#39;t think it would be a lengthy one. However, I&#39;m curious as to how would one go about checking duplicates over two columns? As in only count as a duplicate if there are more than one set of two cells adjacent to each other. As a beginner the easiest way for me is to to concatenate each row in the two columns into one column and then use the above code but I&#39;m guessing there should be a better way?"}, {"owner": {"reputation": 449, "user_id": 9981075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2GnFk.jpg?s=128&g=1", "display_name": "SeanW333", "link": "https://stackoverflow.com/users/9981075/seanw333"}, "reply_to_user": {"reputation": 3, "user_id": 4635137, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QiQtmZt68jM/AAAAAAAAAAI/AAAAAAAAQjI/vh_L7STL2Ag/photo.jpg?sz=128", "display_name": "Benjamin Sow", "link": "https://stackoverflow.com/users/4635137/benjamin-sow"}, "edited": false, "score": 0, "creation_date": 1530465801, "post_id": 51057078, "comment_id": 89235758, "body": "Actually, the concatenation method is perfectly valid. However, if that feels hacky to you, you could also replace this: <code>If rngData.Cells(lngRowIndexData, 1).Value = clData.Value Then</code> with this: <code>If rngData.Cells(lngRowIndexData, 1).Value = clData.Value AND rngData.Cells(lngRowIndexData, 2).Value = clData.Offset(0,1).Value Then</code> (assuming the additional column is the one to the right of the main column), which achieves the same thing."}], "tags": [], "owner": {"reputation": 449, "user_id": 9981075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2GnFk.jpg?s=128&g=1", "display_name": "SeanW333", "link": "https://stackoverflow.com/users/9981075/seanw333"}, "is_accepted": true, "score": 0, "last_activity_date": 1530085769, "last_edit_date": 1530085769, "creation_date": 1530085048, "answer_id": 51057078, "question_id": 51056114, "link": "https://stackoverflow.com/questions/51056114/how-to-find-duplicates-and-list-them-separately-using-vba-in-excel/51057078#51057078", "title": "How to find duplicates and list them separately using VBA in Excel?", "body": "<p>Tested and working: </p>\n\n<pre><code>Option Explicit\n\nSub find_dups()\n\n    ' Create and set variable for referencing workbook\n    Dim wb As Workbook\n    Set wb = ThisWorkbook\n\n    ' Create and set variable for referencing worksheet\n    Dim ws As Worksheet\n    Set ws = wb.Worksheets(\"Data\")\n\n    ' Find current last rows\n    ' For this example, the data is in column A and the duplicates are in column C\n    Dim lngLastRowData As Long\n    lngLastRowData = ws.Range(\"a1048576\").End(xlUp).Row\n    Dim lngLastRowDups As Long\n    lngLastRowDups = ws.Range(\"c1048576\").End(xlUp).Row\n\n    ' Create and set a variable for referencing data range\n    Dim rngData As Range\n    Set rngData = ws.Range(\"a2:a\" &amp; lngLastRowData)\n\n    Dim lngRowCount As Long\n    lngRowCount = 0\n\n    Dim clData As Variant\n    Dim lngCount As Long\n\n    Dim lngRowIndexData As Long\n    Dim lngRowIndexDups As Long\n    lngRowIndexDups = lngLastRowDups + 1\n\n    ' Variable to store those values we've already checked\n    Dim strAlreadySearched As String\n\n\n    For Each clData In rngData.Cells\n\n        ' Reset variables\n        lngCount = 0\n\n\n        ' See if we've already searched this value\n        If InStr(1, strAlreadySearched, \"|\" &amp; clData.Value &amp; \"|\") = 0 Then\n\n            ' We haven't, so proceed to compare to each row\n            For lngRowIndexData = 1 To lngLastRowData\n\n                ' If we have a match, count it\n                If rngData.Cells(lngRowIndexData, 1).Value = clData.Value Then\n                    lngCount = lngCount + 1\n                End If\n\n            Next lngRowIndexData\n\n            ' If more than 1 instance\n            If lngCount &gt; 1 Then\n                ' Dup's were found, fill in values under duplicates\n                ws.Cells(lngRowIndexDups, 3).Value = clData.Value\n                ws.Cells(lngRowIndexDups, 4).Value = lngCount\n\n                ' Drop down a row\n                lngRowIndexDups = lngRowIndexDups + 1\n\n                ' Capture this value so we don't search it again\n                strAlreadySearched = strAlreadySearched &amp; \"|\" &amp; clData.Value &amp; \"|\"\n\n\n            End If\n        End If\n\n    Next clData\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4635137, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-QiQtmZt68jM/AAAAAAAAAAI/AAAAAAAAQjI/vh_L7STL2Ag/photo.jpg?sz=128", "display_name": "Benjamin Sow", "link": "https://stackoverflow.com/users/4635137/benjamin-sow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4555, "favorite_count": 0, "accepted_answer_id": 51057078, "answer_count": 2, "score": -2, "last_activity_date": 1532733677, "creation_date": 1530081674, "last_edit_date": 1530083443, "question_id": 51056114, "link": "https://stackoverflow.com/questions/51056114/how-to-find-duplicates-and-list-them-separately-using-vba-in-excel", "title": "How to find duplicates and list them separately using VBA in Excel?", "body": "<p>I have a worksheet which I use to import XML data. I'd like to use VBA to find the duplicates within the data range (only in one column) and extract duplicates along with the number of times it appears as shown in the picture below. The original data should be retained as I will continuously add on to the column with new XML data. As for now I only found ways to highlight or remove duplicates but I want to visualize the data better by having a separate list to see data that is repeated the most. I'm only interested in the duplicates so data that only appears once can be ignored.</p>\n\n<p>EDIT: I have thousands or rows of data to work with and I won't be sure which ones will have duplicates so I think using countif with every row would be pretty inefficient.</p>\n\n<p>Thanks!</p>\n\n<p><a href=\"https://i.stack.imgur.com/9Ju98.png\" rel=\"nofollow noreferrer\">This is how it should look</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1530081580, "post_id": 51056035, "comment_id": 89102655, "body": "You determine the last rows before you delete the rows. Should be the other way round: 1. Delete 2. determine last row I think. Also I would use <code>wsS.Rows(&quot;4:&quot; &amp; wsS.Rows.Count).EntireRow.Delete</code> to make it independent from any Excel version."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1530093655, "post_id": 51056035, "comment_id": 89109651, "body": "Did it solve your issue?"}, {"owner": {"reputation": 61, "user_id": 9942913, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GBy0iPVjG1A/AAAAAAAAAAI/AAAAAAAABXM/bdKr81HjWaw/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9942913/daniel"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1530186670, "post_id": 51056035, "comment_id": 89152737, "body": "Hi Peh, it worked indeed. My previous &quot;thanks&quot; message was after I have tested the new code. Sorry I wasn&#39;t that clear. Cheers and thanks again"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 8105566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sdpWG.jpg?s=128&g=1", "display_name": "iAdesanyaDaniel", "link": "https://stackoverflow.com/users/8105566/iadesanyadaniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1530099132, "last_edit_date": 1530099132, "creation_date": 1530096683, "answer_id": 51060940, "question_id": 51056035, "link": "https://stackoverflow.com/questions/51056035/after-deleting-entire-rows-newly-copied-data-is-shifted-down-x-rows/51060940#51060940", "title": "After deleting entire rows, newly copied data is shifted down x rows", "body": "<p>The issue you are experiencing, is due to the fact that <strong>all variable prefixed with <code>lr</code></strong> are storing the <strong>index number</strong> <em>(invariably)</em> of <strong>last row</strong> that contained data, before you all delete them.</p>\n\n<p>Based on  how the code is written, when you paste new data, it starts from the index number stored in the <code>lr</code>-s.</p>\n\n<p>The solution is to recalculate the value of the <code>lr</code>-s after deleting the data.</p>\n\n<p>Replace the top of your code with the modified codes below, and the codes should work as your expect.</p>\n\n<pre><code>Private Sub CopyDataAtoF()\nDim wsR As Worksheet:       Set wsR = ThisWorkbook.Worksheets(\"Data Raw\")\nDim wsS As Worksheet:       Set wsS = ThisWorkbook.Worksheets(\"Scatter Raw\")\n\nApplication.ScreenUpdating = False\nwsS.Rows(\"4:1048560\").EntireRow.Delete Shift:=xlUp\n\nDim lrR As Long:            lrR = wsR.Cells(wsR.Rows.count, \"A\").End(xlUp).Row\nDim lrS1 As Long:           lrS1 = wsS.Cells(wsS.Rows.count, \"A\").End(xlUp).Row + 1\nDim lrS2 As Long:           lrS2 = wsS.Cells(wsS.Rows.count, \"C\").End(xlUp).Row + 1\nDim lrS3 As Long:           lrS3 = wsS.Cells(wsS.Rows.count, \"E\").End(xlUp).Row + 1\n\nWith wsR\n    Dim fRng As Range:      Set fRng = .Range(.Cells(1, \"A\"), .Cells(lrR, \"AN\"))\n    Dim rngN As Range:      Set rngN = .Range(.Cells(2, \"N\"), .Cells(lrR, \"N\"))\n    Dim rngY As Range:      Set rngY = .Range(.Cells(2, \"Y\"), .Cells(lrR, \"Y\"))\n    Dim cRng As Range:      Set cRng = Union(rngN, rngY)\nEnd With\n\nfRng.AutoFilter field:=25, Criteria1:=\"&lt;&gt;\", Operator:=xlFilterValues\nfRng.AutoFilter field:=1, Criteria1:=\"criteria1\", Operator:=xlFilterValues\nIf fRng.SpecialCells(xlCellTypeVisible).CountLarge &gt; 2 Then\n</code></pre>\n\n<p>The change I made in the code was to move;   </p>\n\n<pre><code> Application.ScreenUpdating = False\n wsS.Rows(\"4:1048560\").EntireRow.Delete Shift:=xlUp\n</code></pre>\n\n<p>above;</p>\n\n<pre><code>Dim lrR As Long:            lrR = wsR.Cells(wsR.Rows.count, \"A\").End(xlUp).Row\nDim lrS1 As Long:           lrS1 = wsS.Cells(wsS.Rows.count, \"A\").End(xlUp).Row + 1\n        ...                               ...       \n</code></pre>\n\n<p>i.e. After deleting the necessary rows, the <code>lr</code>-s are then defined and calculated.</p>\n\n<p>Thank you.</p>\n"}], "owner": {"reputation": 61, "user_id": 9942913, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GBy0iPVjG1A/AAAAAAAAAAI/AAAAAAAABXM/bdKr81HjWaw/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9942913/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530099132, "creation_date": 1530081319, "last_edit_date": 1531164843, "question_id": 51056035, "link": "https://stackoverflow.com/questions/51056035/after-deleting-entire-rows-newly-copied-data-is-shifted-down-x-rows", "title": "After deleting entire rows, newly copied data is shifted down x rows", "body": "<p>Before I copy a new set of data into a set of columns I want to delete everything but the headers, which I do using the following code:<br>\nwsS.Rows(\"4:1048560\").EntireRow.Delete</p>\n\n<p>I do it like this because the data spreads over column A to AZ and it's not the same rows lenght.</p>\n\n<p>But somehow, the comand leaves cells that contained data previously and are now empty selected, but only for columns A to F (I have 9 blocks of data that are copied and for each block I used a different sub() that are later called within a button). I also apply a filter before on the sheet where I copy the data from.</p>\n\n<p>My problem is that the new copy somehow starts where the other data should have ended. The more ofther I run the code, the more rows down the copy will start. The code for copying was suggested by someone here and I only adapted it slightly to my needs.</p>\n\n<p>The weird thing is that if I run the delete command above in the Immediate Window (or I do a manual delete) and then I run the full code again, the copied data will start as it should in cell A4.</p>\n\n<p>I have also tried to do a select on cell A4 after I delete and then copy the new data. Still no success. And this happens only on the first set of data I copy (columns A to F) -> I used the same code to copy more ranges (A to F, H to M, O to T and so on)</p>\n\n<p>This is the code for one block, namely A to F:</p>\n\n<pre><code>Private Sub CopyDataAtoF()\nDim wsR As Worksheet:       Set wsR = ThisWorkbook.Worksheets(\"Data Raw\")\nDim wsS As Worksheet:       Set wsS = ThisWorkbook.Worksheets(\"Scatter Raw\")\nDim lrR As Long:            lrR = wsR.Cells(wsR.Rows.count, \"A\").End(xlUp).Row\nDim lrS1 As Long:           lrS1 = wsS.Cells(wsS.Rows.count, \"A\").End(xlUp).Row + 1\nDim lrS2 As Long:           lrS2 = wsS.Cells(wsS.Rows.count, \"C\").End(xlUp).Row + 1\nDim lrS3 As Long:           lrS3 = wsS.Cells(wsS.Rows.count, \"E\").End(xlUp).Row + 1\n\nWith wsR\n    Dim fRng As Range:      Set fRng = .Range(.Cells(1, \"A\"), .Cells(lrR, \"AN\"))\n    Dim rngN As Range:      Set rngN = .Range(.Cells(2, \"N\"), .Cells(lrR, \"N\"))\n    Dim rngY As Range:      Set rngY = .Range(.Cells(2, \"Y\"), .Cells(lrR, \"Y\"))\n    Dim cRng As Range:      Set cRng = Union(rngN, rngY)\nEnd With\n\nApplication.ScreenUpdating = False\nwsS.Rows(\"4:1048560\").EntireRow.Delete Shift:=xlUp\n\nfRng.AutoFilter field:=25, Criteria1:=\"&lt;&gt;\", Operator:=xlFilterValues\nfRng.AutoFilter field:=1, Criteria1:=\"criteria1\", Operator:=xlFilterValues\nIf fRng.SpecialCells(xlCellTypeVisible).CountLarge &gt; 2 Then\n    cRng.Copy\n    wsS.Cells(lrS1, \"A\").PasteSpecial xlPasteValues\n    With wsS\n        Dim vis1 As Long:    vis1 = .Cells(.Rows.count, \"A\").End(xlUp).Row\n        Dim lcS1 As Long:    lcS1 = .Cells(lrS1, \"A\").End(xlToRight).Column + 1\n        Dim divA As Range:   Set divA = .Range(.Cells(lrS1, \"A\"), .Cells(vis1, \"A\"))\n        Dim divY1 As Range:  Set divY1 = .Range(.Cells(lrS1, lcS1), .Cells(vis1, lcS1))\n\n        divY1.Formula = \"=\" &amp; .Cells(lrS1, 1).Address(RowAbsolute:=False) &amp; \" / 1000\"\n        divA.Value2 = divY1.Value2\n        divY1.ClearContents\n    End With\nEnd If\n\nfRng.AutoFilter field:=1, Criteria1:=\"criteria2\", Operator:=xlFilterValues\nIf fRng.SpecialCells(xlCellTypeVisible).CountLarge &gt; 2 Then\n    cRng.Copy\n    wsS.Cells(lrS2, \"C\").PasteSpecial xlPasteValues\n    With wsS\n        Dim vis2 As Long:    vis2 = .Cells(.Rows.count, \"C\").End(xlUp).Row\n        Dim lcS2 As Long:    lcS2 = .Cells(lrS2, \"C\").End(xlToRight).Column + 1\n        Dim divC As Range:   Set divC = .Range(.Cells(lrS2, \"C\"), .Cells(vis2, \"C\"))\n        Dim divY2 As Range:  Set divY2 = .Range(.Cells(lrS2, lcS2), .Cells(vis2, lcS2))\n\n        divY2.Formula = \"=\" &amp; .Cells(lrS2, 3).Address(RowAbsolute:=False) &amp; \" / 1000\"\n        divC.Value2 = divY2.Value2\n        divY2.ClearContents\n    End With\nEnd If\n\nfRng.AutoFilter field:=1, Criteria1:=\"criteria3\", Operator:=xlFilterValues\nIf fRng.SpecialCells(xlCellTypeVisible).CountLarge &gt; 2 Then\n    cRng.Copy\n    wsS.Cells(lrS3, \"E\").PasteSpecial xlPasteValues\n    With wsS\n        Dim vis3 As Long:    vis3 = .Cells(.Rows.count, \"E\").End(xlUp).Row\n        Dim lcS3 As Long:    lcS3 = .Cells(lrS3, \"E\").End(xlToRight).Column + 1\n        Dim divE As Range:  Set divE = .Range(.Cells(lrS3, \"E\"), .Cells(vis3, \"E\"))\n        Dim divY3 As Range:  Set divY3 = .Range(.Cells(lrS3, lcS3), .Cells(vis3, lcS3))\n\n        divY3.Formula = \"=\" &amp; .Cells(lrS3, 5).Address(RowAbsolute:=False) &amp; \" / 1000\"\n        divE.Value2 = divY3.Value2\n        divY3.ClearContents\n    End With\nEnd If\n\nwsS.Range(\"A1\").Select\nwsR.AutoFilter.ShowAllData\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 361, "user_id": 7750399, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/03ef02687a1c76445f99f533230a1184?s=128&d=identicon&r=PG&f=1", "display_name": "diem_L", "link": "https://stackoverflow.com/users/7750399/diem-l"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1530082861, "post_id": 51056014, "comment_id": 89103324, "body": "@QHarr i added the rest of the code"}, {"owner": {"reputation": 361, "user_id": 7750399, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/03ef02687a1c76445f99f533230a1184?s=128&d=identicon&r=PG&f=1", "display_name": "diem_L", "link": "https://stackoverflow.com/users/7750399/diem-l"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530083649, "post_id": 51056014, "comment_id": 89103721, "body": "@QHarr i changed the question so that it maybe gets clear what i want. All the rest of my VBA Code works fine. The only problem i have, is that the do loop won&#180;t stop when it reaches row 10"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1530083693, "post_id": 51056014, "comment_id": 89103753, "body": "Loop Until ActiveCell.Row = 10"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1530083724, "creation_date": 1530083724, "answer_id": 51056683, "question_id": 51056014, "link": "https://stackoverflow.com/questions/51056014/vba-leave-do-until-when-specific-row-is-reached/51056683#51056683", "title": "VBA - Leave Do Until when specific row is reached", "body": "<p>Assuming rest of code is correct use:</p>\n\n<pre><code>Loop Until ActiveCell.Row = 10 \n</code></pre>\n\n<p>If that fails you problem is logic in other parts of your code ie. ActiveCell never reaches row 10.</p>\n"}, {"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 1, "last_activity_date": 1530089607, "last_edit_date": 1530089607, "creation_date": 1530087841, "answer_id": 51057985, "question_id": 51056014, "link": "https://stackoverflow.com/questions/51056014/vba-leave-do-until-when-specific-row-is-reached/51057985#51057985", "title": "VBA - Leave Do Until when specific row is reached", "body": "<p>To answer your question in more theoretical fashion. There are multiple ways of exiting <code>Do</code> loops in VBA.</p>\n\n<ol>\n<li><p><strong>The proper way</strong>  </p>\n\n<p>1.1.  <strong>While or Until at the begining</strong>  </p>\n\n<p>This checks the condition first, if the condition is met, it enters the loop and repeat with the condition being met at the start of every loop.</p>\n\n<pre><code>Do While i &lt;= 5\n  '#code here\nLoop\n</code></pre>\n\n<p><em>These two are equivalent.</em> </p>\n\n<pre><code>Do Until i &gt; 5\n  '#code here\nLoop\n</code></pre>\n\n<p>1.2. <strong>While or until at the end</strong></p>\n\n<p>This is almost the same as what is described above. The only difference being, with sole <code>Do</code> statement at the beginning, your code-block always gets executed at least once! This can be particularly useful, when you want to execute something at least once, but don't want it to  repeat unless a condition is met.</p>\n\n<pre><code>Do \n  '#code here\nLoop While i &lt;= 5\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Do \n  '#code here\nLoop Until i &gt; 5\n</code></pre></li>\n<li><p><strong>The enforced way</strong><br>\nYou can exit out of any loop, including <code>Do</code> with the so called <code>Exit</code> statement. This escapes the currently ongoing <code>Do</code> loop upon reaching the statement <em>no questions asked</em>. While you usually should try to avoid using the <code>Exit</code> statement, as in majority of cases it is possible to avoid using it with a proper condition at the <code>While</code> or <code>Until</code> portion of your code, it can come in handy in some cases.</p>\n\n<p>Additionally, keep in mind, inside nested <code>Do</code> loops, <code>Exit</code> always exits only the innermost loop. This means, this would exit only the loop inside and let the others run, acting as a weird form of <code>Continue</code></p>\n\n<pre><code>Do While (handler = True)\n   Do\n      '# execute me\n       If weird_condition = True Then\n           Exit Do\n           ' i return to the \"handler\" loop\n       End If\n       field = field + 1 \n   Loop Until field = field_amount\nLoop\n</code></pre></li>\n<li><p><strong>The not so nice enforced way</strong></p>\n\n<p>Alternatively, you can stop the entire exution, with the <code>Stop</code> statement. I would strongly advise against doing this, but technically it is a possibility so I'm listing it here. Similarly like <code>End</code> it ends the execution, but unlike <code>End</code> (eg. <code>End Sub</code>), it does not close any files or clear any variables - so technically this means you could use it to exit a loop. I would however recommend simply using the <code>Exit</code> statement instead. Can't really think of a case when I would ever use this. </p></li>\n</ol>\n"}], "owner": {"reputation": 361, "user_id": 7750399, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/03ef02687a1c76445f99f533230a1184?s=128&d=identicon&r=PG&f=1", "display_name": "diem_L", "link": "https://stackoverflow.com/users/7750399/diem-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1095, "favorite_count": 0, "accepted_answer_id": 51056683, "answer_count": 2, "score": 2, "last_activity_date": 1530089607, "creation_date": 1530081218, "last_edit_date": 1530083580, "question_id": 51056014, "link": "https://stackoverflow.com/questions/51056014/vba-leave-do-until-when-specific-row-is-reached", "title": "VBA - Leave Do Until when specific row is reached", "body": "<p>In my VBA Code i go from the last row in my table to the top of my table. But i want that the Do Until Loop ends when it reached Row 10.</p>\n\n<p>Right now I am using this Do Until Loop:</p>\n\n<pre><code>Do \n    ' Do Something\nLoop Until ActiveCell.Address = \"$N$10:$BI$10\"\n</code></pre>\n\n<p>How do i have to change my code that it will stop when it reached row 10?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 458, "user_id": 1676889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0976ef4bdcbfd36179fdf864d36f22f3?s=128&d=identicon&r=PG", "display_name": "eren", "link": "https://stackoverflow.com/users/1676889/eren"}, "edited": false, "score": 0, "creation_date": 1530079979, "post_id": 51055604, "comment_id": 89101907, "body": "Take a look at this <a href=\"https://stackoverflow.com/questions/23655251/decimal-tryparse-in-vba\" title=\"decimal tryparse in vba\">stackoverflow.com/questions/23655251/decimal-tryparse-in-vba</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1530080978, "post_id": 51055604, "comment_id": 89102391, "body": "You can use <code>IsNumeric(Res.Value)</code> to check if it is a number and if it is a number you can check afterwards <code>If Res.Value =&gt; 1.99 And Res.Value  &lt; 3.00</code> or something similar."}, {"owner": {"reputation": 1, "user_id": 9967012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9154927a3e21ed0d85fc5d96d774815e?s=128&d=identicon&r=PG&f=1", "display_name": "Jg112", "link": "https://stackoverflow.com/users/9967012/jg112"}, "edited": false, "score": 0, "creation_date": 1530097674, "post_id": 51055604, "comment_id": 89112313, "body": "This worked, thank you for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 8114974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956d76981f60ce06a7894e30760f68d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Huang", "link": "https://stackoverflow.com/users/8114974/bruce-huang"}, "is_accepted": false, "score": 0, "last_activity_date": 1530095270, "creation_date": 1530095270, "answer_id": 51060463, "question_id": 51055604, "link": "https://stackoverflow.com/questions/51055604/fat-fingered-decimal-entry-vba-for-excel/51060463#51060463", "title": "Fat fingered decimal entry VBA for excel", "body": "<p>Maybe you could add Data Validation rules on the typical ranges. Try this: <strong>Data > Data Tools > Data Validation</strong></p>\n"}], "owner": {"reputation": 1, "user_id": 9967012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9154927a3e21ed0d85fc5d96d774815e?s=128&d=identicon&r=PG&f=1", "display_name": "Jg112", "link": "https://stackoverflow.com/users/9967012/jg112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "closed_date": 1530097615, "answer_count": 1, "score": 0, "last_activity_date": 1530095270, "creation_date": 1530079604, "last_edit_date": 1530080728, "question_id": 51055604, "link": "https://stackoverflow.com/questions/51055604/fat-fingered-decimal-entry-vba-for-excel", "closed_reason": "Duplicate", "title": "Fat fingered decimal entry VBA for excel", "body": "<p>I made a simple vba application that allows a user to enter data into excel. The data that's being entered had to be >= 1.99 ohms and can be 3.00 or higher.  Everything works great and it's been in use for over a year now. However, recently a user fat fingered a decimal point and didn't catch it until they entered the number.  VBA didn't like that and errored out. The format they entered looked like so: '.2.34'. I can't seem to figure out how to avoid this. Any suggestions? </p>\n\n<p>I've tried using: </p>\n\n<pre><code>If Res.value &lt;&gt; Format(Number, \"#.##\") Then\n    Msgbox (\"blah blah\")\n    Res.Value = \"\"\n    Exit Sub\nEnd if\n</code></pre>\n\n<p>This blocks those entries, but it also blocks correct entries. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3, "user_id": 9997971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307872a34ec1e3a07d6955376ecaa549?s=128&d=identicon&r=PG&f=1", "display_name": "user9997971", "link": "https://stackoverflow.com/users/9997971/user9997971"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530079980, "post_id": 51055464, "comment_id": 89101909, "body": "Yes, I found this formula: &quot;=MOD(INT(MOD(RC[-1],1000)/100),2)&quot;. 0=F og 1=M., but I struggle to put it togheter With conditional formatting and so on."}, {"owner": {"reputation": 3, "user_id": 9997971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307872a34ec1e3a07d6955376ecaa549?s=128&d=identicon&r=PG&f=1", "display_name": "user9997971", "link": "https://stackoverflow.com/users/9997971/user9997971"}, "edited": false, "score": 0, "creation_date": 1530092829, "post_id": 51055464, "comment_id": 89109134, "body": "@TinMan. How can I change Your formula OR(AND(LEN(B9)=11,N9=&quot;M&quot;),AND(LEN(B9)=9,N9=&quot;F&quot;)) to be based on the 3.rd last digit? I&#39;m so sorry I didn&#39;t see that problem before."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530093111, "post_id": 51055464, "comment_id": 89109320, "body": "I misread the question.  You should probably use James Cooke&#39;s answer to work out your solution."}, {"owner": {"reputation": 3, "user_id": 9997971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307872a34ec1e3a07d6955376ecaa549?s=128&d=identicon&r=PG&f=1", "display_name": "user9997971", "link": "https://stackoverflow.com/users/9997971/user9997971"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530094156, "post_id": 51055464, "comment_id": 89110030, "body": "Your formula worked beautifully when I have 11 digits in the birth number. But in some cases I can see that there is only 10 digits when the birth number starts at 0 (0 is skipped). So how can I modify Your formula to take this in to consideration? I think I have to look at the 3rd last digit (or digit 9 when there&#39;s 11 digits in total). James Cook&#39;s answer will give me the same problem."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530094310, "post_id": 51055464, "comment_id": 89110137, "body": "<code>LEN(TEXT(B9,&quot;00000000000&quot;))</code> will return a 11 digit string that with lead zeros."}], "answers": [{"tags": [], "owner": {"reputation": 945, "user_id": 4219600, "user_type": "registered", "profile_image": "https://graph.facebook.com/511041755/picture?type=large", "display_name": "James Cooke", "link": "https://stackoverflow.com/users/4219600/james-cooke"}, "is_accepted": false, "score": 1, "last_activity_date": 1530081380, "creation_date": 1530081380, "answer_id": 51056047, "question_id": 51055464, "link": "https://stackoverflow.com/questions/51055464/vba-check-for-odd-even-numbers-in-a-column-and-then-check-for-correct-value-in/51056047#51056047", "title": "VBA: Check for odd/even numbers in a column and then check for correct value in another column", "body": "<p>Cant you just do this with an excel formula for example and reference the ID; =IF(ISODD(MID(D3,9,1)),\"M\",\"F\")</p>\n\n<p>if the 9th value in cell D3 is odd then Male, else Female</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 8105566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sdpWG.jpg?s=128&g=1", "display_name": "iAdesanyaDaniel", "link": "https://stackoverflow.com/users/8105566/iadesanyadaniel"}, "edited": false, "score": 0, "creation_date": 1530094715, "post_id": 51059732, "comment_id": 89110392, "body": "@user9997971 You know... technically it&#39;s against stackoverflow&#39;s policy to post bare questions as-your-question-is right now. It should be accompanied with what you have personally done so far(most times --code sample). But you provided most of those in your comments, it would be helpful if you edit your question and add them."}, {"owner": {"reputation": 3, "user_id": 9997971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307872a34ec1e3a07d6955376ecaa549?s=128&d=identicon&r=PG&f=1", "display_name": "user9997971", "link": "https://stackoverflow.com/users/9997971/user9997971"}, "edited": false, "score": 0, "creation_date": 1530102467, "post_id": 51059732, "comment_id": 89115349, "body": "Ok,I understand. This is the first time I use the web page. I have a lot to learn=)"}, {"owner": {"reputation": 31, "user_id": 8105566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sdpWG.jpg?s=128&g=1", "display_name": "iAdesanyaDaniel", "link": "https://stackoverflow.com/users/8105566/iadesanyadaniel"}, "reply_to_user": {"reputation": 3, "user_id": 9997971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307872a34ec1e3a07d6955376ecaa549?s=128&d=identicon&r=PG&f=1", "display_name": "user9997971", "link": "https://stackoverflow.com/users/9997971/user9997971"}, "edited": false, "score": 0, "creation_date": 1530105169, "post_id": 51059732, "comment_id": 89117291, "body": "@user9997971 Okay. I would like to know if you found my answer useful. If there is any challenge adpating it, I would be glad to help out."}], "tags": [], "owner": {"reputation": 31, "user_id": 8105566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sdpWG.jpg?s=128&g=1", "display_name": "iAdesanyaDaniel", "link": "https://stackoverflow.com/users/8105566/iadesanyadaniel"}, "is_accepted": true, "score": 0, "last_activity_date": 1530093631, "last_edit_date": 1530093631, "creation_date": 1530093300, "answer_id": 51059732, "question_id": 51055464, "link": "https://stackoverflow.com/questions/51055464/vba-check-for-odd-even-numbers-in-a-column-and-then-check-for-correct-value-in/51059732#51059732", "title": "VBA: Check for odd/even numbers in a column and then check for correct value in another column", "body": "<p>Check this out:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub FormatConditionally()\n    Dim i As Integer\n    Dim birthNumbers As String\n    Dim gender As String\n    Dim genderCell As Range\n\n    For i = 1 To Range(\"Table1\").Rows.Count\n        birthNumbers = Range(\"Table1[Birth number]\")(i).Value\n        Set genderCell = Range(\"Table1[F/M]\")(i)\n        gender = genderCell.Value\n\n        If GenderIsValid(birthNumbers, gender) Then\n            Call FormatAsValid(genderCell)\n        Else\n            Call FormatAsNotValid(genderCell)\n        End If\n\n    Next i\n\nEnd Sub\n\nPrivate Function GenderIsValid(birthNumbers As String, gender As String) As Boolean\n\n    Dim lengthOfBirthNo As Integer\n    Dim posOfGenderIdentifier As Integer\n    Dim genderIdenfier As Integer\n    Dim validGender As String\n\n    lengthOfBirthNo = Len(birthNumbers)\n    posOfGenderIdentifier = lengthOfBirthNo - 3\n\n    genderIdenfier = Mid(birthNumbers, posOfGenderIdentifier, 1)\n\n    If WorksheetFunction.IsEven(genderIdenfier) Then\n        validGender = \"F\"\n    Else\n        validGender = \"M\"\n    End If\n\n    If (validGender = gender) Then\n        GenderIsValid = True\n    Else\n        GenderIsValid = False\n    End If\n\nEnd Function\n\nPrivate Sub FormatAsValid(rng As Range)\n    rng.Interior.Color = RGB(255, 0, 0)\n    'sets fill color to RED\nEnd Sub\nPrivate Sub FormatAsNotValid(rng As Range)\n    rng.Interior.Color = RGB(255, 255, 255)\n    'sets fill color to WHITE\nEnd Sub\n</code></pre>\n\n<p>Don't mind the size of the code. The public subroutine <strong>(FormatConditionally)</strong> is what needs to be run, and the column name should remain as-it-is, in the attached caption(or, be changed as appropriate).</p>\n\n<p>And also it works with the <em>3rd-last</em> digit</p>\n\n<p>I hope you would find it useful. Thank you.</p>\n"}], "owner": {"reputation": 3, "user_id": 9997971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307872a34ec1e3a07d6955376ecaa549?s=128&d=identicon&r=PG&f=1", "display_name": "user9997971", "link": "https://stackoverflow.com/users/9997971/user9997971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2473, "favorite_count": 1, "accepted_answer_id": 51059732, "answer_count": 2, "score": 0, "last_activity_date": 1530172046, "creation_date": 1530079030, "last_edit_date": 1531164843, "question_id": 51055464, "link": "https://stackoverflow.com/questions/51055464/vba-check-for-odd-even-numbers-in-a-column-and-then-check-for-correct-value-in", "title": "VBA: Check for odd/even numbers in a column and then check for correct value in another column", "body": "<p><a href=\"https://i.stack.imgur.com/R9zM0.jpg\" rel=\"nofollow noreferrer\">Macro</a>    <a href=\"https://i.stack.imgur.com/KSBdR.jpg\" rel=\"nofollow noreferrer\">Image of table</a>I could need your help with this one:</p>\n\n<p>I have birth numbers (11 or 10 digits) in column D(9). And I have a column N(9) with sex (M and F). I want to check if the text in column N is correct based on the birthnumber. If the 3rd last digit in the birthnumber contain an even number then it's female. If the 3rd digit is an odd number it's a male.\nI want to use conditional formatting (mark the cell red) if M or F is wrong in column N.</p>\n\n<p>Does anyone have a vba code for this? Thank you in advance.</p>\n"}, {"tags": ["excel", "vba", "dictionary", "type-mismatch"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530079347, "post_id": 51055318, "comment_id": 89101597, "body": "Not really enough code there for us to do a quick debug. Though someone may spot easily what is wrong."}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530079839, "post_id": 51055318, "comment_id": 89101845, "body": "@QHarr It occurs at &quot; If Not target.SearchItem(sKey) Is Nothing Then&quot; It returns a integer/long if value exists and it cant check if it&#39;s nothing. Is there any value like nothing that works for long?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530079867, "post_id": 51055318, "comment_id": 89101854, "body": "What kind of dictionary are you using?"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530079914, "post_id": 51055318, "comment_id": 89101873, "body": "@TinMan I&#39;m using Private data As Scripting.dictionary if that&#39;s what you mean?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530079985, "post_id": 51055318, "comment_id": 89101913, "body": "Is it possible that sKey = CStr(key)  is the source of the problem? I set up a test case with a string I knew was in the dictionary (i added it in the class initialize) and it ran fine."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1530079999, "post_id": 51055318, "comment_id": 89101924, "body": "I don&#39;t think you can use <code>Set</code> to assign an integer, so the property will fail when there is an integer in the dictionary. Perhaps use <code>SearchItem = data(name)</code>."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1530080007, "post_id": 51055318, "comment_id": 89101928, "body": "It&#39;s hard to tell from your code because you wrapped the dictionary.  I susupect that changing <code>aList.getArray(1).getKeys</code> to <code>aList.getArray(1).getKeys()</code> will solve the problem."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530080102, "post_id": 51055318, "comment_id": 89101987, "body": "@TinMan That sounds promising!"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530080194, "post_id": 51055318, "comment_id": 89102034, "body": "@QHarr That is not the problem unfortunately. As an input to SearchItem I take a string, key is currently a variant that I need to convert."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530080230, "post_id": 51055318, "comment_id": 89102053, "body": "I just realised that when looking at Zev&#39;s answer."}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1530080246, "post_id": 51055318, "comment_id": 89102058, "body": "@ZevSpitz That will solve the error but the problem is that if the item doesn&#39;t exist I don&#39;t want to return any valid number."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1530080282, "post_id": 51055318, "comment_id": 89102076, "body": "@Fredrik So in that case, return <code>Nothing</code>. Either one can be returned if the property type is <code>Variant</code>."}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530080310, "post_id": 51055318, "comment_id": 89102093, "body": "@TinMan VBA will automatically remove () if no argument is given."}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1530080342, "post_id": 51055318, "comment_id": 89102108, "body": "@ZevSpitz I think so too but it doesn&#39;t work"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530080492, "post_id": 51055318, "comment_id": 89102177, "body": "But sKey is  a string, no? If passing an Int in you would get ByRef type mismatch at signature level."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530080620, "post_id": 51055318, "comment_id": 89102238, "body": "Can we see your declarations as well?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530080710, "post_id": 51055318, "comment_id": 89102277, "body": "And if you do Debug.Print TypeName(key) what are you handling?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530080845, "post_id": 51055318, "comment_id": 89102343, "body": "You have your class set up wrong.  It would be better to test if the item exists then to return nothing from the search.  The Search should only use <code>Set</code> if it is returning an <code>Object</code>.  If you don&#39;t mind emailing it to me I will review your design.  If it was a working example I would recommend posting it on <a href=\"https://codereview.stackexchange.com/\">CodeReview</a>"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530081023, "post_id": 51055318, "comment_id": 89102409, "body": "@Qharr yes, sKey is a String. I&#39;m using a string because I got no integer values as keys for the dictionary. Any specific declaration? Key is a String but when using it directly I get ByRef argument type mismatch"}, {"owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1530081209, "post_id": 51055318, "comment_id": 89102486, "body": "@TinMan How do you mean? So if an item exists I should return Nothing? If I understand correctly I shouldn&#39;t return the value until I have received if the value exists? Unfortunately I can&#39;t share the code at the current state due to company/school rules."}], "answers": [{"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1530080127, "creation_date": 1530080127, "answer_id": 51055727, "question_id": 51055318, "link": "https://stackoverflow.com/questions/51055318/vba-dictionary-search-type-mismatch/51055727#51055727", "title": "VBA - Dictionary search - type mismatch", "body": "<p>I don't think you can use <code>Set</code> to assign an integer, so the property will fail when the dictionary item is an <code>Integer</code>. Perhaps use:</p>\n\n<pre><code>Property Get SearchItem(name As String) As Variant\n    If data.exists(name) Then\n        'becomes a Variant/Integer - data(name) is a Variant/long\n        SearchItem = data(name)\n        ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 1, "last_activity_date": 1530083895, "creation_date": 1530083895, "answer_id": 51056728, "question_id": 51055318, "link": "https://stackoverflow.com/questions/51055318/vba-dictionary-search-type-mismatch/51056728#51056728", "title": "VBA - Dictionary search - type mismatch", "body": "<ol>\n<li><code>If Not target.SearchItem(sKey) Is Nothing Then</code>\n\n<ul>\n<li>This implies that the stored item is an Object</li>\n</ul></li>\n<li><code>cData.setData(sKey) = CLng(target.SearchItem(sKey))</code>\n\n<ul>\n<li>The only way that this line will work on an Object is that the Object has a default value that can be converted to long.  If the Object's default value is returning a value that can be converted to long.  </li>\n</ul></li>\n</ol>\n\n<p>Does <code>Clng(Object)</code> work on the actual Object that is being stored in the Dictionary?</p>\n\n<p>If you are storing mixed data type then <code>SearchItem</code> check if the return data is an Object.    </p>\n\n<pre><code>Property Get SearchItem(name As String) As Variant\n    If isObject(data(name)) Then\n        Set SearchItem = data(name)\n    Else\n        SearchItem = data(name)\n    End If\nEnd Property\n</code></pre>\n\n<p>I would not convert the datatype in this method. I would instead create one or more separate methods or convert the data type at the point of use.</p>\n\n<blockquote>\n<pre><code>Function getTypedItem(Key as Variant, DataType as VbVarType) as Variant\n</code></pre>\n</blockquote>\n\n<p>IsNumeric(Obj)</p>\n\n<p>Since you are using actual Keys of the Dictionary we know that it will return something and there is not a need for <code>.Exists</code> in this context.  What you will need to do is test if it is returning an Object before you test whether the <code>Object Is Nothing</code>.</p>\n\n<pre><code>If IsObject(Target.SearchItem(sKey)) Then\n    If IsNumeric(Target.SearchItem(sKey)) Then\n        cData.setData(sKey) = CLng(Target.SearchItem(sKey))\n    End If\nElseIf IsNumeric(Target.SearchItem(sKey)) Then\n    cData.setData(sKey) = CLng(Target.SearchItem(sKey))\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 392, "user_id": 8239268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ec70961cef7b5ab8684f1490c5d903a?s=128&d=identicon&r=PG&f=1", "display_name": "igorsp7", "link": "https://stackoverflow.com/users/8239268/igorsp7"}, "is_accepted": false, "score": 0, "last_activity_date": 1530102933, "creation_date": 1530102933, "answer_id": 51062959, "question_id": 51055318, "link": "https://stackoverflow.com/questions/51055318/vba-dictionary-search-type-mismatch/51062959#51062959", "title": "VBA - Dictionary search - type mismatch", "body": "<p>Unfortunately, VBA does not have nullable primitive types such as a nullable Long. A usual workaround is to use a Variant, which can be assigned the value of Empty and which can also hold a Long natively.</p>\n\n<p>I would rewrite your property as follows:</p>\n\n<pre><code>Property Get SearchItem(name As String) As Variant\n    If Data.exists(name) Then\n        SearchItem = Data(name)\n    Else\n        SearchItem = Empty\n    End If\nEnd Property\n</code></pre>\n\n<p>And the test for empty would be:</p>\n\n<pre><code>If Not IsEmpty(target.SearchItem(sKey)) Then ...\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 9603997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a46321ffcb5c79093991713400a44855?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9603997/fredrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 836, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1530102933, "creation_date": 1530078377, "last_edit_date": 1530080612, "question_id": 51055318, "link": "https://stackoverflow.com/questions/51055318/vba-dictionary-search-type-mismatch", "title": "VBA - Dictionary search - type mismatch", "body": "<p>So I'm learning how to use Dictionaries but I have encountered a type problem. In the code below I get an error. </p>\n\n<blockquote>\n  <p>Type mismatch</p>\n</blockquote>\n\n<p>Each time I try to call <code>If Not target.SearchItem(sKey) Is Nothing Then</code>. I want it to return a object then if it isn't <code>Nothing</code> I can convert it back to long.</p>\n\n<pre><code>For Each target In dList.getArray\n    For Each key In aList.getArray(1).getKeys\n        sKey = CStr(key)\n            'Error occurs here - as Type mismatch\n            If Not target.SearchItem(sKey) Is Nothing Then\n                cData.setData(sKey) = CLng(target.SearchItem(sKey))\n                target.removeData = sKey\n             Else\n                 'if value doesn't exists it will just be 0\n                  cData.setData(sKey) = 0\n              End If\n    Next key\nNext target\n</code></pre>\n\n<p><code>data</code> is my dictionary that is in a separate class:</p>\n\n<pre><code>Property Get SearchItem(name As String) As Variant\n    If data.exists(name) Then\n        'becomes a Variant/Integer - data(name) is a Variant/long\n        Set SearchItem = CVar(data(name))\n    Else\n        'Should return Nothing if item doesnt exist\n        Set SearchItem = Nothing\n    End If\nEnd Property\n</code></pre>\n\n<p>Update: To explain the problem I bit more. Even though I return it as a variant it will still be partly Integer and therefor If Not <code>target.SearchItem(sKey) Is Nothing Then</code> will return mismatch as it needs an object and VBA doesn't read is as a variant or something. Is there anything like Nothing, null or equally that works for a long? That would solve the problem.</p>\n\n<p>This code below returns a long as I want it to, but I can't use -99 as it would corrupt the data analyse. It needs to be something that isn't a value</p>\n\n<pre><code>Property Get SearchItem(name As String)\n    If data.exists(name) Then\n        SearchItem = data(name)\n    Else\n        'SearchItem = Nothing\n         SearchItem = -99\n    End If\nEnd Property\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1530078117, "post_id": 51055150, "comment_id": 89101120, "body": "Your code is really only a single line?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1530078414, "post_id": 51055150, "comment_id": 89101237, "body": "Maybe look at: <a href=\"https://social.msdn.microsoft.com/Forums/Lync/en-US/260ebc8f-14d9-49d2-9742-a39351d4ce7e/excel-applicationdefined-or-objectdefined-error-32809?forum=exceldev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/Lync/en-US/&hellip;</a>"}, {"owner": {"reputation": 391, "user_id": 2194463, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/206d7d3f2b8570783bc0838ba4ad22ea?s=128&d=identicon&r=PG", "display_name": "surendra", "link": "https://stackoverflow.com/users/2194463/surendra"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1530079974, "post_id": 51055150, "comment_id": 89101903, "body": "@TimWilliams not really but I am getting the error at that line."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530082734, "post_id": 51055150, "comment_id": 89103268, "body": "This could be caused by an update for the Office application. Please take a look at this thread:  <a href=\"https://social.technet.microsoft.com/Forums/en-US/473b1980-56b3-49ff-be71-3a60c0db048b/form-controls-stop-working-after-december-2014-updates?forum=excel\" rel=\"nofollow noreferrer\">social.technet.microsoft.com/Forums/en-US/&hellip;</a>  and <a href=\"https://social.msdn.microsoft.com/Forums/Lync/en-US/260ebc8f-14d9-49d2-9742-a39351d4ce7e/excel-applicationdefined-or-objectdefined-error-32809?forum=exceldev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/Lync/en-US/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530084279, "post_id": 51055150, "comment_id": 89104052, "body": "For fixes see <a href=\"http://excelmatters.com/2014/12/10/office-update-breaks-activex-controls/\" rel=\"nofollow noreferrer\">excelmatters.com/2014/12/10/&hellip;</a>"}, {"owner": {"reputation": 391, "user_id": 2194463, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/206d7d3f2b8570783bc0838ba4ad22ea?s=128&d=identicon&r=PG", "display_name": "surendra", "link": "https://stackoverflow.com/users/2194463/surendra"}, "edited": false, "score": 0, "creation_date": 1530093714, "post_id": 51055150, "comment_id": 89109695, "body": "I just Created the same file in the system where it is not working and copied the content....now the newly created file it is working fine."}], "owner": {"reputation": 391, "user_id": 2194463, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/206d7d3f2b8570783bc0838ba4ad22ea?s=128&d=identicon&r=PG", "display_name": "surendra", "link": "https://stackoverflow.com/users/2194463/surendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530077663, "creation_date": 1530077663, "last_edit_date": 1531164843, "question_id": 51055150, "link": "https://stackoverflow.com/questions/51055150/32809-application-defined-or-object-defined-error", "title": "32809 Application defined or object defined error", "body": "<p>I am facing an error only in few systems. error is \" 32809 Application defined or object defined error\"</p>\n\n<p>my code is very simple</p>\n\n<pre><code>n_rows = worksheets(\"Sheet1\").UsedRange.Rows.Count\n</code></pre>\n\n<p>In MS Office 2010 Standalone machines code is working fine but in MS Offcie 2010 professional versions it is not working Properly.  </p>\n\n<p>Can any one help me on how to resolve the issue</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530077732, "post_id": 51055125, "comment_id": 89100987, "body": "Continuing search through the entire document or just column C sheet 3?"}, {"owner": {"reputation": 458, "user_id": 1676889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0976ef4bdcbfd36179fdf864d36f22f3?s=128&d=identicon&r=PG", "display_name": "eren", "link": "https://stackoverflow.com/users/1676889/eren"}, "edited": false, "score": 0, "creation_date": 1530077981, "post_id": 51055125, "comment_id": 89101074, "body": "It seems that you are not incrementing your b variable. You always select b+1 and b is always 0."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7232433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894659e02617e3c908d4233489890408?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy F", "link": "https://stackoverflow.com/users/7232433/jeremy-f"}, "edited": false, "score": 0, "creation_date": 1530078592, "post_id": 51055284, "comment_id": 89101317, "body": "Oh my god... I cant believe I wasn&#39;t kicking the variable b to the next value.... Thank you SO MUCH! Seriously. I feel kind of like an idiot now haha."}, {"owner": {"reputation": 458, "user_id": 1676889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0976ef4bdcbfd36179fdf864d36f22f3?s=128&d=identicon&r=PG", "display_name": "eren", "link": "https://stackoverflow.com/users/1676889/eren"}, "reply_to_user": {"reputation": 1, "user_id": 7232433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894659e02617e3c908d4233489890408?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy F", "link": "https://stackoverflow.com/users/7232433/jeremy-f"}, "edited": false, "score": 0, "creation_date": 1530079220, "post_id": 51055284, "comment_id": 89101551, "body": "You are welcome, glad i could help. But to be honest take a look at answer from @QHarr. Doing things more efficiently should be your goal :)"}, {"owner": {"reputation": 458, "user_id": 1676889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0976ef4bdcbfd36179fdf864d36f22f3?s=128&d=identicon&r=PG", "display_name": "eren", "link": "https://stackoverflow.com/users/1676889/eren"}, "reply_to_user": {"reputation": 1, "user_id": 7232433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894659e02617e3c908d4233489890408?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy F", "link": "https://stackoverflow.com/users/7232433/jeremy-f"}, "edited": false, "score": 0, "creation_date": 1530079510, "post_id": 51055284, "comment_id": 89101691, "body": "@JeremyF Btw you can mark the answer if it solved your problem ;) <a href=\"https://meta.stackexchange.com/questions/147531/how-mark-my-question-as-answered-on-stackoverflow\" title=\"how mark my question as answered on stackoverflow\">meta.stackexchange.com/questions/147531/&hellip;</a>"}], "tags": [], "owner": {"reputation": 458, "user_id": 1676889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0976ef4bdcbfd36179fdf864d36f22f3?s=128&d=identicon&r=PG", "display_name": "eren", "link": "https://stackoverflow.com/users/1676889/eren"}, "is_accepted": false, "score": 1, "last_activity_date": 1530078239, "creation_date": 1530078239, "answer_id": 51055284, "question_id": 51055125, "link": "https://stackoverflow.com/questions/51055125/vba-code-in-excel-operates-inconsistently-with-very-simple-code/51055284#51055284", "title": "VBA code in excel operates inconsistently with very simple code", "body": "<p>This should solve your problem : </p>\n\n<pre><code>  If Worksheets(\"Sheet1\").Cells(i, 3).Value = \"AMC\" Then    \n        Worksheets(\"Sheet1\").Rows(i).Copy  \n        Worksheets(\"Sheet2\").Activate   \n        Worksheets(\"Sheet2\").Cells(b + 1, 1).Select    \n        b = b + 1    \n        ActiveSheet.Paste   \n        Worksheets(\"Sheet1\").Activate        \n  End If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7232433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894659e02617e3c908d4233489890408?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy F", "link": "https://stackoverflow.com/users/7232433/jeremy-f"}, "edited": false, "score": 1, "creation_date": 1530078665, "post_id": 51055309, "comment_id": 89101348, "body": "Thank you so much for your input but the former person had already figured it out. Thank you so much for trying :) Seriously, I appreciate you both very much."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 7232433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894659e02617e3c908d4233489890408?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy F", "link": "https://stackoverflow.com/users/7232433/jeremy-f"}, "edited": false, "score": 0, "creation_date": 1530078749, "post_id": 51055309, "comment_id": 89101378, "body": "I&#39;m pleased. I would give some serious thought to the points I raise above if you want to write more efficient code."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1530079490, "last_edit_date": 1530079490, "creation_date": 1530078350, "answer_id": 51055309, "question_id": 51055125, "link": "https://stackoverflow.com/questions/51055125/vba-code-in-excel-operates-inconsistently-with-very-simple-code/51055309#51055309", "title": "VBA code in excel operates inconsistently with very simple code", "body": "<p>You could use <code>Instr</code> and <code>Union</code>. </p>\n\n<ol>\n<li><code>Union</code> is very efficient as you store all the qualifying ranges in memory and then write out only once to the sheet. Much less expensive operation than continually writing out to the sheet. </li>\n<li><code>Instr</code> allows you to use <code>vbBinaryCompare</code> which means you are doing a case sensitive match i.e. only <code>AC</code> not <code>ac</code> will be matched on.</li>\n<li>The code belows avoids <code>.Activate</code>, which is again an expensive operation that isn't required.</li>\n<li><code>UsedRange</code> means you may be looping many more rows than required. You only want to loop to the last populated row in column C of sheet 1, as that is the column you are testing. Hence, I use <code>.Cells(.Rows.Count, C\").End(xlUp).Row</code> to find that last row.</li>\n<li>Use <code>Option Explicit</code> - research why! It will make your VBA life soooooo much better.</li>\n</ol>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit    \nSub CommandButton1_Click()\n\n    Dim lastRow As Long, sSht As Worksheet, tSht As Worksheet, loopRange As Range\n    Set sSht = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set tSht = ThisWorkbook.Worksheets(\"Sheet2\")\n\n    With sSht\n        Set loopRange = .Range(\"C2:C\" &amp; .Cells(.Rows.Count, C\").End(xlUp).Row)\n    End With\n\n    Dim rng As Range, unionRng As Range\n    For Each rng In loopRange\n        If InStr(1, rng.Value, \"AC\", vbBinaryCompare) &gt; 0 Then\n            If Not unionRng Is Nothing Then\n                Set unionRng = Union(unionRng, rng)\n            Else\n                Set unionRng = rng\n            End If\n        End If\n    Next rng\n    If Not unionRng Is Nothing Then unionRng.EntireRow.Copy tSht.Cells(1, 1)    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7232433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/894659e02617e3c908d4233489890408?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy F", "link": "https://stackoverflow.com/users/7232433/jeremy-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530086194, "creation_date": 1530077553, "last_edit_date": 1530086194, "question_id": 51055125, "link": "https://stackoverflow.com/questions/51055125/vba-code-in-excel-operates-inconsistently-with-very-simple-code", "title": "VBA code in excel operates inconsistently with very simple code", "body": "<p>I wrote some pretty simple VBA (excel macros) code to manage my audio licencing excel experience. The code is supposed to look through the excel sheet in column 3, look for any that have \"AMC\" in their column, and then copy and paste the row to sheet 2 and continue searching through entire excel document. This code is very simple and worked once right before it stopped working right. It only takes the very last AMC value and puts that on sheet 2 but not the other 5 rows that have AMC in their column 3 value.</p>\n\n<p>Please help! I would appreciate it very much :)</p>\n\n<p>-Jeremy</p>\n\n<p>VBA Code:</p>\n\n<pre><code>Sub CommandButton1_Click()\n\n    a = Worksheets(\"Sheet1\").UsedRange.Rows.Count\n\n    b = 0\n\n    For i = 2 To a\n\n        If Worksheets(\"Sheet1\").Cells(i, 3).Value = \"AMC\" Then\n\n            Worksheets(\"Sheet1\").Rows(i).Copy\n\n            Worksheets(\"Sheet2\").Activate\n\n           ' b = ActiveSheet.UsedRange.Rows.Count\n\n            Worksheets(\"Sheet2\").Cells(b + 1, 1).Select\n\n            ActiveSheet.Paste\n\n            Worksheets(\"Sheet1\").Activate\n\n        End If\n\n    Next\n\n    Application.CutCopyMode = False\n\n    ThisWorkbook.Worksheets(\"Sheet1\").Cells(1, 1).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "excel", "ribbon", "vba"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 5157483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6e6a11590bca35445f52eddecd38b9a?s=128&d=identicon&r=PG", "display_name": "Kamolga", "link": "https://stackoverflow.com/users/5157483/kamolga"}, "is_accepted": false, "score": 0, "last_activity_date": 1548602240, "creation_date": 1548602240, "answer_id": 54389652, "question_id": 51055048, "link": "https://stackoverflow.com/questions/51055048/excel-ribbon-dropdown-items-no-onaction/54389652#54389652", "title": "excel ribbon dropdown items - no onAction?", "body": "<p>There is an 'onaction' with the dropdown. You get an index for the item. In my example, you can chose between 3 languages in a dropdown in Excel UI ribbon. First item \"English\" is 0, second item \"Fran\u00e7ais\" is 1, and my third item \"Nederlands\" is 2. In blue what I adapt in xml:    <a href=\"https://i.stack.imgur.com/hX8Hf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hX8Hf.png\" alt=\"enter image description here\"></a></p>\n\n<p>and in VBA, like for a button, I change my named constant value (or do whatever you want).</p>\n\n<p><code>Sub DDonAction(control As IRibbonControl, id As String, index As Variant)\n    Select Case control.id 'Case dropdown if multiple dropdowns\n        Case \"DDLanguage\"\n           Select Case index\n                Case 0 'Action if English is selected\n                  ActiveWorkbook.Names(\"Language\").RefersToR1C1 = \"=\"\"Eng\"\"\"\n                Case 1 'Action if 'Fran\u00e7ais' is selected\n                  ActiveWorkbook.Names(\"Language\").RefersToR1C1 = \"=\"\"Fr\"\"\"\n                Case 2 'Action if Nederlands is selected\n                  ActiveWorkbook.Names(\"Language\").RefersToR1C1 = \"=\"\"Nl\"\"\"\n           End Select 'item\n    End Select 'Dropdown\nEnd Sub</code></p>\n"}], "owner": {"reputation": 1, "user_id": 9975759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38bffb486dd5bcfe5a635c0041b85f4?s=128&d=identicon&r=PG&f=1", "display_name": "CHM", "link": "https://stackoverflow.com/users/9975759/chm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 879, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548602240, "creation_date": 1530077082, "last_edit_date": 1531164843, "question_id": 51055048, "link": "https://stackoverflow.com/questions/51055048/excel-ribbon-dropdown-items-no-onaction", "title": "excel ribbon dropdown items - no onAction?", "body": "<p>I have created a custom tab with a dropdown that has both items and buttons in it. I can get the onAction macro to run for a button, but cannot do the same for an item. Should this be possible? I have seen plenty of examples with onAction macros specified for items, but none seem to work. I also have an add-in witten in visual studio that has what appear to be items in a dropdown that call macros.</p>\n\n<p>My code:</p>\n\n<pre><code>Private Sub Workbook_Activate()\n\n' copied from here:\n' https://stackoverflow.com/questions/8850836/how-to-add-a-custom-ribbon-tab-using-vba\n\n\nDim hFile As Long\nDim path As String, fileName As String, ribbonXML As String, user As String\n\nhFile = FreeFile\nuser = Environ(\"Username\")\npath = \"C:\\Users\\\" &amp; user &amp; \"\\AppData\\Local\\Microsoft\\Office\\\"\nfileName = \"Excel.officeUI\"\n\nribbonXML = \"&lt;mso:customUI      xmlns:mso='http://schemas.microsoft.com/office/2009/07/customui'&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"&lt;mso:ribbon&gt;&lt;mso:qat/&gt;&lt;mso:tabs&gt;&lt;mso:tab id='x' label='Development' insertBeforeQ='mso:TabFormat'&gt;\" &amp; vbNewLine 'insertAfterQ='x1:IDC_TEAM_TAB' id='mso_c1.1C4ECC7'\nribbonXML = ribbonXML + \"&lt;mso:group id='mso_c2.1C4ECD7' label='Group1' imageMso='Risks' autoScale='true'&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"&lt;mso:dropDown id='dropDown' label='Test Menu:' onAction='test_macro'&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"   &lt;mso:item id='item1' label='Item 1' onAction='test_macro'/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"   &lt;mso:item id='item2' label='Item 2'  onAction='test_macro'/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"   &lt;mso:item id='item3' label='Item 3'  onAction='test_macro'/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"   &lt;mso:button id='button' label='Button...' onAction='test_macro'/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \" &lt;/mso:dropDown&gt;\" &amp; vbNewLine\n\nribbonXML = ribbonXML + \"&lt;/mso:group&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"&lt;mso:group id='mso_c3.1C56531' label='Group 2' imageMso='ListMacros' autoScale='true'/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"&lt;/mso:tab&gt;&lt;/mso:tabs&gt;&lt;/mso:ribbon&gt;&lt;/mso:customUI&gt;\"\n\nribbonXML = Replace(ribbonXML, \"\"\"\", \"\")\n\nOpen path &amp; fileName For Output Access Write As hFile\nPrint #hFile, ribbonXML\nClose hFile\n\nEnd Sub\n\nPrivate Sub Workbook_Deactivate()\n\nDim hFile As Long\nDim path As String, fileName As String, ribbonXML As String, user As String\n\nhFile = FreeFile\nuser = Environ(\"Username\")\npath = \"C:\\Users\\\" &amp; user &amp; \"\\AppData\\Local\\Microsoft\\Office\\\"\nfileName = \"Excel.officeUI\"\n\nribbonXML = \"&lt;mso:customUI           xmlns:mso=\"\"http://schemas.microsoft.com/office/2009/07/customui\"\"&gt;\" &amp; _\n\"&lt;mso:ribbon&gt;&lt;/mso:ribbon&gt;&lt;/mso:customUI&gt;\"\n\nOpen path &amp; fileName For Output Access Write As hFile\nPrint #hFile, ribbonXML\nClose hFile\n\nEnd Sub\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>Sub test_macro()\n    Sheets(\"Sheet1\").Select\n    Cells(1, 1) = \"test\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1530084352, "post_id": 51054736, "comment_id": 89104096, "body": "Have you tried <code>PivotTable Tools</code> &gt; <code>Design</code> &gt; <code>Report Layout</code> &gt; <code>Repeat All Item Labels</code>, or do you want the PivotTable to remain showing the blanks?"}, {"owner": {"reputation": 404, "user_id": 3588062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b9250510a2f466aa15f79d46c32c112?s=128&d=identicon&r=PG&f=1", "display_name": "visu-l", "link": "https://stackoverflow.com/users/3588062/visu-l"}, "edited": false, "score": 0, "creation_date": 1530105802, "post_id": 51054736, "comment_id": 89117767, "body": "why not to work with the data source of your pivot table? Transform the data into another table, in a way that you only get distinct rows of all possible occurences of panel | category | skill | Level. You may use <a href=\"https://support.office.com/en-us/article/get-transform-in-excel-2016-881c63c6-37c5-4ca2-b616-59e18d75b4de\" rel=\"nofollow noreferrer\">Get &amp; Transform</a> for that."}], "answers": [{"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1530085835, "creation_date": 1530085835, "answer_id": 51057340, "question_id": 51054736, "link": "https://stackoverflow.com/questions/51054736/extracting-hidden-data-from-expanding-collapsing-pivot-table-excel/51057340#51057340", "title": "Extracting &quot;hidden&quot; data from expanding/collapsing pivot table - Excel", "body": "<p>This answer assumes that you don't want to just Repeat All Item Labels in the PivotTable from the \"Report Layout\" drop-down on the Pivt Table Tools \"Design\" tab.</p>\n\n<p>A formula to get the first non-blank value on or above the same row as the current cell from Column B can be constructed with a combination of <code>AGGREGATE</code>, <code>SUMPRODUCT</code> and <code>OFFSET</code>, like so:</p>\n\n<pre><code>=OFFSET($B2,SUMPRODUCT(AGGREGATE(14,6,ROW($B$1:$B$100)*--(ROW($B$1:$B$100)&lt;=ROW())*--(LEN($B$1:$B$100)&gt;0),1))-ROW(),0)\n</code></pre>\n\n<h2>How does it work?</h2>\n\n<p>Starting with the outermost part, <code>OFFSET($B2, VALUE, 0)</code> - this will start in cell <code>B2</code>, then look up or down by <code>VALUE</code> rows to get the value.</p>\n\n<p>Next we need to know <em>how many</em> rows we will need to look up-or-down.  Now, if we can work out the bottom-most row with data, we can subtract the current <code>ROW()</code> from that, giving us <code>OFFSET($B2, NON_BLANK-ROW(),0)</code></p>\n\n<p>So, to finish up we need to work out which rows are not blank, AND which rows are on-or-above our current row, then take the largest of those.  This is going to take an ArrayFormula, but we can use <code>SUMPRODUCT</code> to make that calculate properly.  To find the largest number we <em>could</em> use <code>MAX</code> or <code>LARGE</code> - but we get less errors if we pick <code>AGGREGATE(14,6,..,1)</code>.  (The <code>14</code> means \"we want the <em>k</em>th largest number\", the <code>6</code> means \"ignore error values\", and the <code>1</code> is <em>k</em> - so \"we want the largest number, ignoring errors\")</p>\n\n<p>But, what list of numbers are we going to look at, I don't hear you ask.  Well, we want the <code>ROW</code> for output from our range (I'm using <code>$B$1:$B$100</code>, because using the whole column B would take <em>far</em> to long to calculate repeatedly), a comparison against the current <code>ROW()</code>, and check that the <code>LEN</code>gth is > 0.  Those last two are comparisons, so let's write them out first:</p>\n\n<pre><code>ROW($B$1:$B100)&lt;=ROW() \n</code></pre>\n\n<p>and</p>\n\n<pre><code>LEN($B$1:$B$100)&gt;0\n</code></pre>\n\n<p>We want to use <code>--</code> to convert <code>TRUE</code> and <code>FALSE</code> to <code>1</code> and <code>0</code> - this means that any \"bad\" values become 0, and any \"good\" values are larger than 0:</p>\n\n<pre><code>ROW($B$1:$B$100)*--(ROW($B$1:$B$100)&lt;=ROW())*--(LEN($B$1:$B$100)&gt;0)\n</code></pre>\n\n<p>This gives us the Row number when the Row is on-or-before the current row AND Column B is not blank - if either of those are False, then we get 0 instead.  Stick that in the <code>AGGREGATE</code> to find the largest number:</p>\n\n<pre><code>AGGREGATE(14, 6, ROW($B$1:$B$100)*--(ROW($B$1:$B$100)&lt;=ROW())*--(LEN($B$1:$B$100)&gt;0), 1)\n</code></pre>\n\n<p>Then put it in a <code>SUMPRODUCT</code> to force Excel to treat it as an ArrayFormula, and that's your <code>NON_BLANK</code>.  This then gives you that first formula right at the top of the post</p>\n"}], "owner": {"reputation": 25, "user_id": 9959257, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ozo2Od47c0I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3hSgfTIW1H0fw376z17PhHeIFYzA/mo/photo.jpg?sz=128", "display_name": "T Wilken", "link": "https://stackoverflow.com/users/9959257/t-wilken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 422, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530085835, "creation_date": 1530075106, "last_edit_date": 1530084521, "question_id": 51054736, "link": "https://stackoverflow.com/questions/51054736/extracting-hidden-data-from-expanding-collapsing-pivot-table-excel", "title": "Extracting &quot;hidden&quot; data from expanding/collapsing pivot table - Excel", "body": "<p>I'm not sure if this is possible but as you can see I have a pivot table with multiple dependent and expandable fields. I am trying to concatenate the data from columns A:D into one cell which works fine in row 2 but doesn't work with blank parent cells, as you can see in column F.</p>\n\n<p>Any ideas for how to achieve this? </p>\n\n<p><strong>Pivot table</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/bpFjn.jpg\" alt=\"pivottable\"></p>\n"}, {"tags": ["vba", "excel", "templates", "worksheet"], "comments": [{"owner": {"reputation": 2953, "user_id": 5133088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0efad94ced5dcd194c0a482cafd4f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Heier", "link": "https://stackoverflow.com/users/5133088/jeroen-heier"}, "edited": false, "score": 1, "creation_date": 1530071860, "post_id": 51054300, "comment_id": 89099410, "body": "Hi, welcome to stack overflow. Please refer the <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> link for  more details on how to ask a question and update your question accordingly."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1530147889, "creation_date": 1530147889, "answer_id": 51073336, "question_id": 51054300, "link": "https://stackoverflow.com/questions/51054300/best-way-to-create-multiple-excel-workbooks-from-a-master-file-and-the-files-mus/51073336#51073336", "title": "Best way to create multiple Excel workbooks from a master file and the files must use an existing template with mutiple worksheets", "body": "<p>Something like this should be pretty close.</p>\n\n<pre><code>Sub Copy_With_AutoFilter2()\n'Note: This macro use the function LastRow\n'Important: The DestSh must exist\n    Dim My_Range As Range\n    Dim DestSh As Worksheet\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n    Dim FilterCriteria As String\n    Dim CCount As Long\n    Dim rng As Range\n\n    'Set filter range on ActiveSheet: A1 is the top left cell of your filter range\n    'and the header of the first column, D is the last column in the filter range.\n    'You can also add the sheet name to the code like this :\n    'Worksheets(\"Sheet1\").Range(\"A1:D\" &amp; LastRow(Worksheets(\"Sheet1\")))\n    'No need that the sheet is active then when you run the macro when you use this.\n    Set My_Range = Range(\"A1:D\" &amp; LastRow(ActiveSheet))\n    My_Range.Parent.Select\n\n    'Set the destination worksheet\n    'Note: the sheet \"RecordsOfTheNetherlands\" must exist in your workbook\n    Set DestSh = Sheets(\"RecordsOfTheNetherlands\")\n\n    If ActiveWorkbook.ProtectStructure = True Or _\n       My_Range.Parent.ProtectContents = True Then\n        MsgBox \"Sorry, not working when the workbook or worksheet is protected\", _\n               vbOKOnly, \"Copy to new worksheet\"\n        Exit Sub\n    End If\n\n    'Change ScreenUpdating, Calculation, EnableEvents, ....\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    ActiveSheet.DisplayPageBreaks = False\n\n    'Firstly, remove the AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n    'Filter and set the filter field and the filter criteria :\n    'This example filter on the first column in the range (change the field if needed)\n    'In this case the range starts in A so Field 1 is column A, 2 = column B, ......\n    'Use \"&lt;&gt;Netherlands\" as criteria if you want the opposite\n    My_Range.AutoFilter Field:=1, Criteria1:=\"=Netherlands\"\n\n    'If you want to filter on a cell value you can use this, use \"&lt;&gt;\" for the opposite\n    'This example uses the activecell value\n    'My_Range.AutoFilter Field:=1, Criteria1:=\"=\" &amp; ActiveCell.Value\n\n    'This will use the cell value from A2 as criteria\n    'My_Range.AutoFilter Field:=1, Criteria1:=\"=\" &amp; Range(\"A2\").Value\n\n    ''If you want to filter on a Inputbox value use this\n    'FilterCriteria = InputBox(\"What text do you want to filter on?\", _\n     '                          \"Enter the filter item.\")\n    'My_Range.AutoFilter Field:=1, Criteria1:=\"=\" &amp; FilterCriteria\n\n\n    'Check if there are not more then 8192 areas(limit of areas that Excel can copy)\n    CCount = 0\n    On Error Resume Next\n    CCount = My_Range.Columns(1).SpecialCells(xlCellTypeVisible).Areas(1).Cells.Count\n    On Error GoTo 0\n    If CCount = 0 Then\n        MsgBox \"There are more than 8192 areas:\" _\n             &amp; vbNewLine &amp; \"It is not possible to copy the visible data.\" _\n             &amp; vbNewLine &amp; \"Tip: Sort your data before you use this macro.\", _\n               vbOKOnly, \"Copy to worksheet\"\n    Else\n        'Copy the visible data and use PasteSpecial to paste to the Destsh\n        With My_Range.Parent.AutoFilter.Range\n            On Error Resume Next\n            ' Set rng to the visible cells in My_Range without the header row\n            Set rng = .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count) _\n                      .SpecialCells(xlCellTypeVisible)\n            On Error GoTo 0\n            If Not rng Is Nothing Then\n                'Copy and paste the cells into DestSh below the existing data\n                rng.Copy\n                With DestSh.Range(\"A\" &amp; LastRow(DestSh) + 1)\n                    ' Paste:=8 will copy the columnwidth in Excel 2000 and higher\n                    ' Remove this line if you use Excel 97\n                    .PasteSpecial Paste:=8\n                    .PasteSpecial xlPasteValues\n                    .PasteSpecial xlPasteFormats\n                    Application.CutCopyMode = False\n                End With\n                'Delete the rows in the My_Range.Parent worksheet\n                'rng.EntireRow.Delete\n            End If\n        End With\n    End If\n\n    'Close AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n    'Restore ScreenUpdating, Calculation, EnableEvents, ....\n    ActiveWindow.View = ViewMode\n    Application.Goto DestSh.Range(\"A1\")\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n\nEnd Sub\n\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlValues, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p><a href=\"https://www.rondebruin.nl/win/s3/win006_2.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s3/win006_2.htm</a></p>\n"}], "owner": {"reputation": 1, "user_id": 9997610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ffd50f0a5f32f1f6d3c9a258511f7ab?s=128&d=identicon&r=PG&f=1", "display_name": "ASpirit", "link": "https://stackoverflow.com/users/9997610/aspirit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1004, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1613406193, "creation_date": 1530071485, "question_id": 51054300, "link": "https://stackoverflow.com/questions/51054300/best-way-to-create-multiple-excel-workbooks-from-a-master-file-and-the-files-mus", "title": "Best way to create multiple Excel workbooks from a master file and the files must use an existing template with mutiple worksheets", "body": "<p>I am trying to write code for a project.  There is a preexisting template from the client.  I need to create new files by dividing one master excel file into new files.  The files must use the template which has multiple worksheets.  The data will be separated by Identification numbers, but some files will have thousands of data rows.  I am trying to write visual basic code to create the files, but am having some difficulty.  Any suggestions are greatly appreciated.  </p>\n"}, {"tags": ["vba", "excel", "sharepoint"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1530068044, "post_id": 51053825, "comment_id": 89098677, "body": "If they&#39;re opening it from Sharepoint then why wouldn&#39;t it be the latest version?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530068882, "post_id": 51053825, "comment_id": 89098850, "body": "Which version of Excel is it? <a href=\"https://support.office.com/en-us/article/collaborate-on-excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104\" rel=\"nofollow noreferrer\">365 has full-blown co-authoring support</a>"}, {"owner": {"reputation": 11, "user_id": 9997217, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-E6iD7601k2w/AAAAAAAAAAI/AAAAAAAAABA/BHnlSajk0EI/photo.jpg?sz=128", "display_name": "Andrew Savvas", "link": "https://stackoverflow.com/users/9997217/andrew-savvas"}, "edited": false, "score": 0, "creation_date": 1530080336, "post_id": 51053825, "comment_id": 89102104, "body": "Hi Tim, I have found instances, where they are saving versions on their computers and use outdated versions. They are all in the habit of enabling macros for this document so not concerned with them disabling."}, {"owner": {"reputation": 11, "user_id": 9997217, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-E6iD7601k2w/AAAAAAAAAAI/AAAAAAAAABA/BHnlSajk0EI/photo.jpg?sz=128", "display_name": "Andrew Savvas", "link": "https://stackoverflow.com/users/9997217/andrew-savvas"}, "edited": false, "score": 0, "creation_date": 1530080360, "post_id": 51053825, "comment_id": 89102117, "body": "Hi Mathieu, I am using Excel 2013."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1530142278, "post_id": 51053825, "comment_id": 89135126, "body": "What you&#39;re suggesting (referencing a separate source for the current version information) seems fine to me."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 8114974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956d76981f60ce06a7894e30760f68d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Huang", "link": "https://stackoverflow.com/users/8114974/bruce-huang"}, "edited": false, "score": 0, "creation_date": 1530098761, "post_id": 51061444, "comment_id": 89112948, "body": "To answer @Tim &#39;s comments : Maybe the users always download the Excel file and run it locally... So they wouldn&#39;t pay attention to the latest version."}], "tags": [], "owner": {"reputation": 133, "user_id": 8114974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956d76981f60ce06a7894e30760f68d2?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Huang", "link": "https://stackoverflow.com/users/8114974/bruce-huang"}, "is_accepted": false, "score": 0, "last_activity_date": 1530098303, "creation_date": 1530098303, "answer_id": 51061444, "question_id": 51053825, "link": "https://stackoverflow.com/questions/51053825/vba-coding-help-checking-version/51061444#51061444", "title": "VBA Coding Help - Checking Version", "body": "<p>I think this is feasible if you write some codes in <strong>Sub auto_open()</strong> to compare the version in your shared workbook and the version stored in another place, say, an URL for a plain text file.</p>\n"}], "owner": {"reputation": 11, "user_id": 9997217, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-E6iD7601k2w/AAAAAAAAAAI/AAAAAAAAABA/BHnlSajk0EI/photo.jpg?sz=128", "display_name": "Andrew Savvas", "link": "https://stackoverflow.com/users/9997217/andrew-savvas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 434, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530098303, "creation_date": 1530067387, "last_edit_date": 1530084644, "question_id": 51053825, "link": "https://stackoverflow.com/questions/51053825/vba-coding-help-checking-version", "title": "VBA Coding Help - Checking Version", "body": "<p>I manage a Excel document that is loaded onto a SharePoint that approx. 60 users access each day.</p>\n\n<p>The document has several references to other workbooks, at times I need to make changes to the references as well as normal changes in the document and I would like the ability for a VBA code that checks if the user is using the most current file version before allowing them to open the document.</p>\n\n<p>I currently have a version number and date in 'V3.6 / 27-06-2018' format in a cell in the document. So ideally I could load another workbook on a share drive, reference that to match the cell (Hope that makes sense) - where the version doesn't match, a text box would appear advising the version is outdated and for the document to force close.</p>\n\n<p>I am open to other suggestions if it makes it easier.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1530067438, "post_id": 51053755, "comment_id": 89098539, "body": "Load one of the arrays into a dictionary, using a concatenated key, then loop over the other array and check the <code>dictionary.Exists</code> method to find the matches.  Also you have a typo here:  <code>de = dee + 1</code>"}, {"owner": {"reputation": 449, "user_id": 9981075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2GnFk.jpg?s=128&g=1", "display_name": "SeanW333", "link": "https://stackoverflow.com/users/9981075/seanw333"}, "edited": false, "score": 0, "creation_date": 1530078838, "post_id": 51053755, "comment_id": 89101408, "body": "I think you were on the right track just putting the data directly into a worksheet, be it the final one or an intermediary from which you copy and paste to the final. Check out my answer here: <a href=\"https://stackoverflow.com/a/51031753/9981075\">stackoverflow.com/a/51031753/9981075</a> , specifically the parts at the top and bottom in which I disable then re-enable the screen updating, and calculations. That should help a lot with the freezing problem. I start and end every big sub with those commands for exactly that reason."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1530167402, "last_edit_date": 1530167402, "creation_date": 1530142125, "answer_id": 51072750, "question_id": 51053755, "link": "https://stackoverflow.com/questions/51053755/vba-loop-inside-a-loop-freezes-excel/51072750#51072750", "title": "vba - loop inside a loop freezes excel", "body": "<p>Here's some code showing how to use a Dictionary:</p>\n\n<pre><code>Sub Tester()\n\n    Const SZ As Long = 10000 'size of test arrays\n\n    Dim arr1(1 To SZ, 1 To 2)\n    Dim arr2(1 To SZ, 1 To 2)\n    Dim arr3(1 To SZ, 1 To 2) '&lt;&lt;matches go here\n    Dim n As Long, m As Long, i As Long, t, dict, k\n\n    t = Timer\n    'fill test arrays with random data\n    For n = 1 To SZ\n        arr1(n, 1) = CLng(Rnd * 200)\n        arr1(n, 2) = CLng(Rnd * 200)\n        arr2(n, 1) = CLng(Rnd * 200)\n        arr2(n, 2) = CLng(Rnd * 200)\n    Next n\n\n    Debug.Print \"Filled test arrays\", Timer - t\n    t = Timer\n    'test the nested loop approach\n    For n = 1 To SZ\n    For m = 1 To SZ\n        If arr1(n, 1) = arr2(m, 1) And arr1(n, 2) = arr2(m, 2) Then\n            i = i + 1\n            arr3(i, 1) = arr1(n, 1)\n            arr3(i, 2) = arr1(n, 2)\n        End If\n    Next m\n    Next n\n\n    Debug.Print \"Finished nested loop\", Timer - t, i &amp; \" matches\"\n    t = Timer\n\n    'create a lookup using a dictionary\n    Set dict = CreateObject(\"scripting.dictionary\")\n    For n = 1 To SZ\n        k = arr1(n, 1) &amp; \"|\" &amp; arr1(n, 2)\n        dict(k) = dict(k) + 1\n    Next n\n    Debug.Print \"Filled dictionary\", Timer - t\n    t = Timer\n\n    i = 0\n    Erase arr3\n\n    'Perform the match against arr2 using the dictionary\n    For m = 1 To SZ\n        k = arr2(m, 1) &amp; \"|\" &amp; arr2(m, 2)\n        If dict.exists(k) Then\n            i = i + 1\n            arr3(i, 1) = arr2(m, 1)\n            arr3(i, 2) = arr2(m, 2)\n        End If\n    Next m\n\n    Debug.Print \"Finished dictionary loop\", Timer - t, i &amp; \" matches\"\n\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Filled test arrays           0 \nFinished nested loop         9.101563     2452 matches\nFilled dictionary            0.03125 \nFinished dictionary loop     0.0078125    2177 matches\n</code></pre>\n\n<p>Note the # of matches is slightly different - the nested loop catches duplicate matches but the Dictionary only counts <em>unique</em> matches.  You might need to make adjustments depending on your use case.</p>\n"}], "owner": {"reputation": 5, "user_id": 9970482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dcb97800663d485e9ab1f2e3951ec5a?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/9970482/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530167402, "creation_date": 1530066895, "last_edit_date": 1530074489, "question_id": 51053755, "link": "https://stackoverflow.com/questions/51053755/vba-loop-inside-a-loop-freezes-excel", "title": "vba - loop inside a loop freezes excel", "body": "<p>i am trying to make a loop to go through an array(47193, 4) and an array 2 named attack(41892,1). The idea here is that the attack array has the values in order from the sheet i want to later on add the values to the next column, this is why i add the values to a third array. So the loop is going to go one by one the value from attack array while looping through arr array to find the common data. i tried copying the values directly to the sheet but excel freezes a lot. Now with this way, excel still freezes at this point. Is there anything wrong with it?</p>\n\n<pre><code>Dim arr3() As Variant\nDim dee As Long\n\nReDim arr3(UBound(attacks, 1), 1)\n\nFor k = 0 To UBound(attacks, 1)\n   j = 0\n\n   For j = 0 To UBound(arr, 1)\n\n       If attacks(k, 0) = arr(j, 0) And attacks(k, 1) = arr(j, 2) Then\n           arr3(dee, 0) = attacks(k, 0)\n           arr3(dee, 1) = attacks(k, 1)\n           de = dee + 1\n       End If\n\n    Next j\n\nNext k\n</code></pre>\n"}, {"tags": ["vba", "excel", "sum"], "answers": [{"comments": [{"owner": {"reputation": 11606, "user_id": 173909, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e4409e8dd5adeaaf258b97aa90ada30f?s=128&d=identicon&r=PG", "display_name": "GiH", "link": "https://stackoverflow.com/users/173909/gih"}, "edited": false, "score": 0, "creation_date": 1530071798, "post_id": 51053882, "comment_id": 89099398, "body": "thanks, my excel knowledge is very limited so I know nothing about pivot tables, and didn&#39;t know about sumif... I&#39;ll read up on it and try it out!  Definitely easier than trying to code without that knowledge as well!"}, {"owner": {"reputation": 11606, "user_id": 173909, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e4409e8dd5adeaaf258b97aa90ada30f?s=128&d=identicon&r=PG", "display_name": "GiH", "link": "https://stackoverflow.com/users/173909/gih"}, "edited": false, "score": 0, "creation_date": 1530072885, "post_id": 51053882, "comment_id": 89099640, "body": "after playing around with only the table link you sent me, I&#39;ve already solved the issue with filters and the total row, although I can&#39;t view them all at the same time which will be a little annoying... I&#39;m going to check out the other two links to see if I can get all totals to display at the same time (without the filter), thanks for your help!  Scrapped VB module, haha, it was fun though...."}], "tags": [], "owner": {"reputation": 655, "user_id": 3097981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6776097221ad67f371357aaf72cbc775?s=128&d=identicon&r=PG&f=1", "display_name": "Hila DG", "link": "https://stackoverflow.com/users/3097981/hila-dg"}, "is_accepted": true, "score": 1, "last_activity_date": 1530067883, "creation_date": 1530067883, "answer_id": 51053882, "question_id": 51053730, "link": "https://stackoverflow.com/questions/51053730/how-to-sum-up-rows-in-excel-using-vba/51053882#51053882", "title": "How to sum up rows in excel using VBA", "body": "<p>I think you're heading completely at the wrong path. \nI wouldn't do that unless I totally and utterly HAVE TO  </p>\n\n<p>Why?</p>\n\n<p>Because you're putting the data together with the report. What happens when someone need to insert a row? What happens when someone has to maintain your code?</p>\n\n<p>Look at the following options:\n 1. Use the source as a <a href=\"http://www.contextures.com/xlExcelTable01.html\" rel=\"nofollow noreferrer\">table</a> and summarize with a <a href=\"http://www.contextures.com/xlPivot01.html\" rel=\"nofollow noreferrer\">pivot table</a>\n 2. Add a column and use the <a href=\"http://www.contextures.com/xlFunctions01.html\" rel=\"nofollow noreferrer\">SUMIF</a> function</p>\n\n<p>These ways you avoid using VBA altogether and still manage to get the reports you need. Good luck!</p>\n"}], "owner": {"reputation": 11606, "user_id": 173909, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e4409e8dd5adeaaf258b97aa90ada30f?s=128&d=identicon&r=PG", "display_name": "GiH", "link": "https://stackoverflow.com/users/173909/gih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "accepted_answer_id": 51053882, "answer_count": 1, "score": 0, "last_activity_date": 1530067883, "creation_date": 1530066664, "question_id": 51053730, "link": "https://stackoverflow.com/questions/51053730/how-to-sum-up-rows-in-excel-using-vba", "title": "How to sum up rows in excel using VBA", "body": "<p>I'm creating my first module, using VBA, and not sure how to sum up rows.  I was wondering if someone could help me.  I have a file of transactions, picture attached:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gPqJJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gPqJJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm trying to insert a break (blank row) in between date groups (group all transaction from a specific date), and then a sum of each total in the break under each column for the corresponding date.  My code is as follows, but I'm stuck on how to create the sum as I'm not sure the syntax.  Here is the code I came up with: </p>\n\n<pre><code>    Sub InsertRowsBetweenDates()\n'\n' InsertRowsBetweenDates Macro\n' Insert Rows in between two dates that are not equal\n'\nDim x As Integer\nDim y As Integer\nDim row1 As Range\nDim row2 As Range\nDim t As Integer 'tracking how many cells to add together\n\n\n'define x as cell row value\nx = 2\n'define y as cell row value\ny = 3\n'start tracker at 0\nt = 0\n'row 1 and row 2 get their values\nSet row1 = Cells(x, 4)\nSet row2 = Cells(y, 4)\n\n'Do until there are no more entries in the worksheet (or really until row 1 has no value)\nDo Until row1.Value = False\n    x = x + 1\n    y = y + 1\n    Set row1 = Cells(x, 4)\n    Set row2 = Cells(y, 4)\n    t = t + 1\n\n    'If row 1 and 2 don't equal each other, insert a row above row 2\n    If row1 &lt;&gt; row2 Then\n        row2.EntireRow.Insert Shift:=xlDown\n\n        'sum up t rows for subtotal and tax [THIS IS WHAT IM STUCK ON]\n\n\n        'skip the break            \n        x = x + 2\n        y = y + 2\n        Set row1 = Cells(x, 4)\n        Set row2 = Cells(y, 4)\n        t = 0\n\n    End If\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>As you can see, I got the break to work, albeit it only works for this file as the rows and column positions are hardcoded, but its a start.  At this point I have a tracker to track how many rows have been counted, and I think I just need to insert code to sum up the rows.  How would I go about achieving this?</p>\n"}, {"tags": ["excel", "vba", "selenium", "selenium-webdriver", "xpath"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9997364, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YQYFqZjE-Ic/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1RN-Xg857mGUi9AMumIGtVEr7Qhg/mo/photo.jpg?sz=128", "display_name": "patoigle20", "link": "https://stackoverflow.com/users/9997364/patoigle20"}, "edited": false, "score": 0, "creation_date": 1530113609, "post_id": 51053965, "comment_id": 89123066, "body": "Hi rajeshkt, thanks. But i keep getting the same error"}], "tags": [], "owner": {"reputation": 1, "user_id": 9954667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c818141ad24cf8de2ffc44570e8a561?s=128&d=identicon&r=PG&f=1", "display_name": "rajeshkt", "link": "https://stackoverflow.com/users/9954667/rajeshkt"}, "is_accepted": false, "score": 0, "last_activity_date": 1530068672, "creation_date": 1530068672, "answer_id": 51053965, "question_id": 51053631, "link": "https://stackoverflow.com/questions/51053631/how-to-locate-the-element-as-per-the-html-through-findelementbyxpath-in-selenium/51053965#51053965", "title": "How to locate the element as per the HTML through FindElementByXPath in Selenium Basic", "body": "<p>XPath might be incorrect. Please try the following syntax:</p>\n\n<pre><code>FindElementByXPath(\"//input[@value='Company 1']\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 5649747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10df78fab916834fd9856009cf9d9f40?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth Shishulkar", "link": "https://stackoverflow.com/users/5649747/siddharth-shishulkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1530068745, "creation_date": 1530068745, "answer_id": 51053971, "question_id": 51053631, "link": "https://stackoverflow.com/questions/51053631/how-to-locate-the-element-as-per-the-html-through-findelementbyxpath-in-selenium/51053971#51053971", "title": "How to locate the element as per the HTML through FindElementByXPath in Selenium Basic", "body": "<p>First of all, use CSS selectors whenever possible. They are much easier to handle.\nNow if you are using CSS selectors try to find the second button using something like</p>\n\n<p><code>input[value=\"Company 2\"]</code></p>\n\n<p>For more info on this selector, look at <a href=\"https://www.w3schools.com/cssref/sel_attribute_value.asp\" rel=\"nofollow noreferrer\">https://www.w3schools.com/cssref/sel_attribute_value.asp</a></p>\n"}, {"tags": [], "owner": {"reputation": 4194, "user_id": 8164333, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lCAZ3.jpg?s=128&g=1", "display_name": "iamsankalp89", "link": "https://stackoverflow.com/users/8164333/iamsankalp89"}, "is_accepted": false, "score": 0, "last_activity_date": 1530072519, "creation_date": 1530072519, "answer_id": 51054409, "question_id": 51053631, "link": "https://stackoverflow.com/questions/51053631/how-to-locate-the-element-as-per-the-html-through-findelementbyxpath-in-selenium/51054409#51054409", "title": "How to locate the element as per the HTML through FindElementByXPath in Selenium Basic", "body": "<p>You can use any xpath, in first look I found your xpath is incorrect, try this:</p>\n\n<pre><code>//input[@type='button'][@value='Company 2']\n//input[@type='button'&amp;&amp; @value='Company 2']\n//input[@role='button'][@value='Company 2']\n</code></pre>\n\n<p>You can also use <code>findelements()</code> to store are all buttons and using if else you can extract the company 2 button</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9997364, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YQYFqZjE-Ic/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1RN-Xg857mGUi9AMumIGtVEr7Qhg/mo/photo.jpg?sz=128", "display_name": "patoigle20", "link": "https://stackoverflow.com/users/9997364/patoigle20"}, "edited": false, "score": 0, "creation_date": 1530114107, "post_id": 51054577, "comment_id": 89123336, "body": "Hi! In both cases i get NoSuchElementError. I think it has something to do with the first input being hidden"}], "tags": [], "owner": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "is_accepted": false, "score": 0, "last_activity_date": 1530074526, "last_edit_date": 1530074526, "creation_date": 1530073935, "answer_id": 51054577, "question_id": 51053631, "link": "https://stackoverflow.com/questions/51053631/how-to-locate-the-element-as-per-the-html-through-findelementbyxpath-in-selenium/51054577#51054577", "title": "How to locate the element as per the HTML through FindElementByXPath in Selenium Basic", "body": "<p>As per the <em>HTML</em> you have shared to invoke <code>click()</code> on the desired elements you can use the following solution:</p>\n\n<ul>\n<li><p>To click on the element with text as <strong>Company 1</strong>:</p>\n\n<pre><code>bot.FindElementByXPath(\"//input[@class='btn_empresa ui-button ui-widget ui-state-default ui-corner-all' and @value='Company 1']\").Click\n</code></pre></li>\n<li><p>To click on the element with text as <strong>Company 2</strong>:</p>\n\n<pre><code>bot.FindElementByXPath(\"//input[@class='btn_empresa ui-button ui-widget ui-state-default ui-corner-all' and @value='Company 2']\").Click\n</code></pre></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9997364, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YQYFqZjE-Ic/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1RN-Xg857mGUi9AMumIGtVEr7Qhg/mo/photo.jpg?sz=128", "display_name": "patoigle20", "link": "https://stackoverflow.com/users/9997364/patoigle20"}, "edited": false, "score": 0, "creation_date": 1530115304, "post_id": 51054715, "comment_id": 89124013, "body": "Hi Grim, how can i tell if the buttons are created from javascript? And is there a way i could click on them if so?"}], "tags": [], "owner": {"reputation": 31, "user_id": 9996861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1810255ab3235f485c7f54197afc2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Grim", "link": "https://stackoverflow.com/users/9996861/grim"}, "is_accepted": false, "score": 0, "last_activity_date": 1530074914, "creation_date": 1530074914, "answer_id": 51054715, "question_id": 51053631, "link": "https://stackoverflow.com/questions/51053631/how-to-locate-the-element-as-per-the-html-through-findelementbyxpath-in-selenium/51054715#51054715", "title": "How to locate the element as per the HTML through FindElementByXPath in Selenium Basic", "body": "<p>Have you tried right-clicking the HTML in inspect and going to Copy>Copy XPath? That might give you something different. Maybe the buttons are created from Javascript and so the WebDriver can't actually see them?</p>\n\n<p>Or try</p>\n\n<pre><code>Company_1 = bot.find_element_by_xpath(\"//input[@value='Company 1']\")\nCompany_1.click()\n\nCompany_2 = bot.find_element_by_xpath(\"//input[@value='Company 2']\")\nCompany_2.click()\n</code></pre>\n\n<p>And change the syntax with the ' ' quotes like someone else mentioned.</p>\n"}, {"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1530078657, "post_id": 51055072, "comment_id": 89101342, "body": "Selectors are less prone to break as they are very specific. Your one seem promising."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1530078946, "post_id": 51055072, "comment_id": 89101449, "body": "Hi @SIM. Nice to see you. A little simplistic but you might enjoy 5 minutes on the following: <a href=\"https://flukeout.github.io/\" rel=\"nofollow noreferrer\">flukeout.github.io</a>   32 levels. See how you score :-) Just read the right hand side first - which I forgot to do!"}, {"owner": {"reputation": 1, "user_id": 9997364, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YQYFqZjE-Ic/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1RN-Xg857mGUi9AMumIGtVEr7Qhg/mo/photo.jpg?sz=128", "display_name": "patoigle20", "link": "https://stackoverflow.com/users/9997364/patoigle20"}, "edited": false, "score": 0, "creation_date": 1530113756, "post_id": 51055072, "comment_id": 89123137, "body": "Hi QHarr, unluckily that didn&#39;t resolve the issue. I think it has something to do with the previous input being hidden.  <code>input[value=&#39;Company 1&#39;] -&gt; NuSuchElementError</code> <code>input[value=&#39;Company 2&#39;] -&gt; ElementNotVisibleError</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530113867, "post_id": 51055072, "comment_id": 89123205, "body": "Can you try looping until visible? It may be beyond the implicit selenium wait time?"}, {"owner": {"reputation": 1, "user_id": 9997364, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YQYFqZjE-Ic/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1RN-Xg857mGUi9AMumIGtVEr7Qhg/mo/photo.jpg?sz=128", "display_name": "patoigle20", "link": "https://stackoverflow.com/users/9997364/patoigle20"}, "edited": false, "score": 0, "creation_date": 1530114707, "post_id": 51055072, "comment_id": 89123670, "body": "I had a 10sec before that line. I can see the button but i keep getting <code>ElementNotVisibleError</code> --- Is there a possiblity that the first input that is hidden has something to do?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530114770, "post_id": 51055072, "comment_id": 89123710, "body": "Are there any events/javascripts attached?"}, {"owner": {"reputation": 1, "user_id": 9997364, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YQYFqZjE-Ic/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1RN-Xg857mGUi9AMumIGtVEr7Qhg/mo/photo.jpg?sz=128", "display_name": "patoigle20", "link": "https://stackoverflow.com/users/9997364/patoigle20"}, "edited": false, "score": 0, "creation_date": 1530115077, "post_id": 51055072, "comment_id": 89123895, "body": "I dont really know, I&#39;m mostly a newbie. Can you tell me how can i know?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530115472, "post_id": 51055072, "comment_id": 89124104, "body": "Sorry. I can actually see that there are. You might want to inspect the page and have a look at what those javascript functions do."}, {"owner": {"reputation": 1, "user_id": 9997364, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YQYFqZjE-Ic/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1RN-Xg857mGUi9AMumIGtVEr7Qhg/mo/photo.jpg?sz=128", "display_name": "patoigle20", "link": "https://stackoverflow.com/users/9997364/patoigle20"}, "edited": false, "score": 0, "creation_date": 1530117029, "post_id": 51055072, "comment_id": 89124982, "body": "I think i found the function: $(function(){$(&#39;input.btn_empresa&#39;).button();});"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1530077547, "last_edit_date": 1530077547, "creation_date": 1530077203, "answer_id": 51055072, "question_id": 51053631, "link": "https://stackoverflow.com/questions/51053631/how-to-locate-the-element-as-per-the-html-through-findelementbyxpath-in-selenium/51055072#51055072", "title": "How to locate the element as per the HTML through FindElementByXPath in Selenium Basic", "body": "<p>Might help you to know you can also use <code>ByCss</code> in most circumstances, in which case you can use:</p>\n\n<pre><code>bot.FindElementByCss(\"input[value='Company 1']\").Click\n</code></pre>\n\n<p>That is nice and short.</p>\n\n<p>The <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">CSS selector</a> is <code>input[value='Company 1']</code>. This says find element with <code>input</code> tag having attribute <code>value</code> with value of <code>'Company 1'</code>. </p>\n"}], "owner": {"reputation": 1, "user_id": 9997364, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YQYFqZjE-Ic/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1RN-Xg857mGUi9AMumIGtVEr7Qhg/mo/photo.jpg?sz=128", "display_name": "patoigle20", "link": "https://stackoverflow.com/users/9997364/patoigle20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1427, "favorite_count": 0, "answer_count": 6, "score": -1, "last_activity_date": 1530077547, "creation_date": 1530065914, "last_edit_date": 1530074462, "question_id": 51053631, "link": "https://stackoverflow.com/questions/51053631/how-to-locate-the-element-as-per-the-html-through-findelementbyxpath-in-selenium", "title": "How to locate the element as per the HTML through FindElementByXPath in Selenium Basic", "body": "<p>I'm writing a VBA code to login into a webpage and load some information i have in an excel worksheet.</p>\n\n<p>I'm new in Selenium. I already got the login part right, but now i need to click in an element and i keep getting errors.</p>\n\n<p>I need to click in the <code>Company 2</code> button.</p>\n\n<p><img src=\"https://i.stack.imgur.com/zoJAd.png\" alt=\"Example of the page\"></p>\n\n<p>This is what i've got so far:</p>\n\n<pre><code>bot.FindElementByXPath(\"//input[@value=\"\"Company 1\"\"]\").Click\n</code></pre>\n\n<p>Outputs <code>NoSuchElementError</code></p>\n\n<pre><code>bot.FindElementByXPath(\"//input[@value=\"\"Company 2\"\"]\").Click\n</code></pre>\n\n<p>Outputs <code>ElementNotVisible</code></p>\n\n<p>I don't know what i'm doing wrong, i think that the first input being hidden has something to do. Hope anyone can help me.</p>\n"}, {"tags": ["excel", "vba", "filter"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1530066462, "post_id": 51053507, "comment_id": 89098315, "body": "\u201con error resume next\u201d hides errors. Remove that line and then re run your code."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9028251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/988ca9148a5072d62327f357893b4403?s=128&d=identicon&r=PG&f=1", "display_name": "Biggusdoggus", "link": "https://stackoverflow.com/users/9028251/biggusdoggus"}, "edited": false, "score": 0, "creation_date": 1530070100, "post_id": 51053795, "comment_id": 89099072, "body": "Thank you - works great! However, a bit of a spanner in the works sorry. It turns out the workbook I&#39;ve been sent has hidden sheets - some of which are not in the same format as the unhidden sheets. As in, they only have 3 columns, for example. How do get it to ignore hidden sheets please, or at least not worry if they aren&#39;t of the same format? I deleted all the hidden sheets and the macro worked fine - however some of them are needed as there are VLOOKUP&#39;s involved."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 5, "user_id": 9028251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/988ca9148a5072d62327f357893b4403?s=128&d=identicon&r=PG&f=1", "display_name": "Biggusdoggus", "link": "https://stackoverflow.com/users/9028251/biggusdoggus"}, "edited": false, "score": 0, "creation_date": 1530070739, "post_id": 51053795, "comment_id": 89099217, "body": "If you want to ignore hidden sheets, change <code>If ws.Name &lt;&gt; &quot;Sheet2&quot; Then</code> to <code>If ws.Name &lt;&gt; &quot;Sheet2&quot; And ws.Visible Then</code>."}, {"owner": {"reputation": 5, "user_id": 9028251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/988ca9148a5072d62327f357893b4403?s=128&d=identicon&r=PG&f=1", "display_name": "Biggusdoggus", "link": "https://stackoverflow.com/users/9028251/biggusdoggus"}, "edited": false, "score": 0, "creation_date": 1530071499, "post_id": 51053795, "comment_id": 89099357, "body": "Thanks BB - really appreciate your help. One more thing sorry - if I want it to also ignore a sheet called &quot;Summary&quot; - it doesn&#39;t like <code>If ws.Name &lt;&gt; &quot;Sheet2&quot; Or ws.Name &lt;&gt; &quot;Summary&quot; And ws.Visible Then</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 5, "user_id": 9028251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/988ca9148a5072d62327f357893b4403?s=128&d=identicon&r=PG&f=1", "display_name": "Biggusdoggus", "link": "https://stackoverflow.com/users/9028251/biggusdoggus"}, "edited": false, "score": 0, "creation_date": 1530071560, "post_id": 51053795, "comment_id": 89099364, "body": "Make that <code>And ws.Name &lt;&gt; &quot;Summary&quot;</code>, not <code>Or</code>."}, {"owner": {"reputation": 5, "user_id": 9028251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/988ca9148a5072d62327f357893b4403?s=128&d=identicon&r=PG&f=1", "display_name": "Biggusdoggus", "link": "https://stackoverflow.com/users/9028251/biggusdoggus"}, "edited": false, "score": 0, "creation_date": 1530071891, "post_id": 51053795, "comment_id": 89099424, "body": "Thank you - 100% perfect. Truly appreciate your help!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1530071421, "last_edit_date": 1530071421, "creation_date": 1530067138, "answer_id": 51053795, "question_id": 51053507, "link": "https://stackoverflow.com/questions/51053507/filter-multiple-sheets-using-variable-cell-value/51053795#51053795", "title": "Filter multiple sheets using variable cell value", "body": "<p>As mentioned in the comments, <code>On Error Resume Next</code> hides errors, but does not deal with them. Using <code>Clng</code> definitely causes an error - this would try to convert the value in C2 to type <code>Long</code> when you're dealing with a <code>String</code>. Also, you need to specifically <strong>not</strong> filter Sheet2. </p>\n\n<p>How about something like this? (assumes your data begins in A1 on each Sheet.)</p>\n\n<p>Edited to only autofilter visible sheets.</p>\n\n<pre><code>Sub apply_autofilter_across_worksheets()\n    Dim ws As Worksheet\n    Dim clientManager As String\n    Dim lastCol As Long, lastRow As Long\n    Dim filterRng As Range\n\n    clientManager = Sheets(\"Sheet2\").Range(\"C1\").Value\n\n    For Each ws In Worksheets\n        If ws.Name &lt;&gt; \"Sheet2\" And ws.Visible Then\n            With ws\n                If .AutoFilterMode Then .AutoFilter.ShowAllData\n\n                lastCol = .Cells(1, Columns.Count).End(xlToLeft).Column\n                lastRow = .Cells(Rows.Count, 1).End(xlUp).Row\n\n                Set filterRng = .Range(.Cells(1, 1), .Cells(lastRow, lastCol))\n                filterRng.AutoFilter 11, clientManager\n            End With\n        End If\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9028251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/988ca9148a5072d62327f357893b4403?s=128&d=identicon&r=PG&f=1", "display_name": "Biggusdoggus", "link": "https://stackoverflow.com/users/9028251/biggusdoggus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 51053795, "answer_count": 1, "score": 0, "last_activity_date": 1530071421, "creation_date": 1530064720, "question_id": 51053507, "link": "https://stackoverflow.com/questions/51053507/filter-multiple-sheets-using-variable-cell-value", "title": "Filter multiple sheets using variable cell value", "body": "<p>I have a workbook with multiple sheets.</p>\n\n<p>Every sheet with data has a common column, K, which contains Client Manager names.\nIn Sheet2 I have used a Data Validation field in C1 using a list, so creating a drop down where I can select a Client Manager.\nSo if I select Charlie Brown, and run a macro, I would like all sheets to be filtered to only show Charlie Brown\u2019s data.</p>\n\n<p>I am an absolute VBA beginner, so I have harassed Mr Google mercilessly \u2013 the majority of suggestions involve hard-coding the filter value, rather than making it a variable cell value.\nThe best I have found is this:</p>\n\n<p><strong>Sub apply_autofilter_across_worksheets()<br>\nDim xWs As Worksheet<br>\nOn Error Resume Next<br>\nFor Each xWs In Worksheets<br>\nxWs.Range(\"K\").AutoFilter 1, CLng(Sheets(\"Sheet2\").Range(\"C1\").Value)<br>\nNext<br>\nEnd Sub</strong></p>\n\n<p>When I run the macro:</p>\n\n<p>\u2022   Positive - no error!<br>\n\u2022   Negative - nothing happens</p>\n\n<p>I'm not sure what this does: <strong>xWs.Range(\"K\")</strong> - the original script had a number after the column letter, but no matter what number I put after it, it makes no difference.</p>\n\n<p>I also simply typed a Client Manager name into C1, with no impact. So clearly it's just all busted.\nThere are 8 data worksheets, plus Sheet2. The number of columns vary sheet to sheet, but none are more than AZ.</p>\n\n<p>Any help would be greatly appreciated please!</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 841258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff18e762b15824c05cbe6712552a9446?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/841258/dave"}, "edited": false, "score": 0, "creation_date": 1530082116, "post_id": 51056191, "comment_id": 89102934, "body": "When I do an Access query with <code>SELECT ... FROM ... WHERE IDcol = {guid {753DA23E-D9B5-4570-BFD8-30F7B9B4F450}}</code> i get no results, but when I do <code>SELECT ... FROM ... WHERE IDcol = &#39;753DA23E-D9B5-4570-BFD8-30F7B9B4F450&#39;</code> I get results."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 137, "user_id": 841258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff18e762b15824c05cbe6712552a9446?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/841258/dave"}, "edited": false, "score": 0, "creation_date": 1530082432, "post_id": 51056191, "comment_id": 89103110, "body": "Well, if so, the ODBC driver simply converts the Guid to text. Should be simple to manage, so what is your trouble really?"}, {"owner": {"reputation": 137, "user_id": 841258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff18e762b15824c05cbe6712552a9446?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/841258/dave"}, "edited": false, "score": 0, "creation_date": 1530082622, "post_id": 51056191, "comment_id": 89103201, "body": "Problem is the value is passed and stored as <code>{guid {753DA23E-D9B5-4570-BFD8-30F7B9B4F450}}</code>. I can use MID to extract it, but I was hoping for a more elegant solution designed for handling GUIDs. If not, I&#39;ll go ahead with MID."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 137, "user_id": 841258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff18e762b15824c05cbe6712552a9446?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/841258/dave"}, "edited": false, "score": 0, "creation_date": 1530083270, "post_id": 51056191, "comment_id": 89103538, "body": "I see. I use a subfunction for this. See edited answer, please."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1530083222, "last_edit_date": 1530083222, "creation_date": 1530081953, "answer_id": 51056191, "question_id": 51052805, "link": "https://stackoverflow.com/questions/51052805/access-guid-value-stored-in-textbox-cant-be-used-in-select-statements/51056191#51056191", "title": "Access - GUID value stored in textbox, can&#39;t be used in SELECT statements", "body": "<p>This works for me - using an Access table:</p>\n\n<pre><code>SELECT \n    GuidField As GuidKey, \n    GuidField As GuidText, \n    [Code]\nFROM \n    tblGuid\nWHERE\n    GuidField = {guid {D8A01BE9-2387-452A-9CF4-30A970E0F078}} \n    AND \n    GuidField = GUIDFromString(\"{D8A01BE9-2387-452A-9CF4-30A970E0F078}\")\n</code></pre>\n\n<p>So either method for filtering should work. And no matter what ODBC driver you use, as Access has been able to handle GUIDs since version 95.</p>\n\n<p><a href=\"https://i.stack.imgur.com/C9cAr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C9cAr.png\" alt=\"enter image description here\"></a></p>\n\n<p>To strip a text Guid:</p>\n\n<pre><code>' Private constants.\n'\n' Length of GUID string per definition.\nPrivate Const GuidLength    As Integer = 38\n' Converted Access Guid header.\nPrivate Const GuidHeader    As String = \"{guid \"\n' Lenght of Access Guid header.\nPrivate Const HeaderLength  As Integer = 6\n\nPublic Sub StripTextGuidHeader(ByRef TextGuid As String)\n\n    Const Start As Integer = 1 + HeaderLength\n\n    If InStr(TextGuid, GuidHeader) = 1 Then\n        ' This is a converted byte Guid:\n        ' \"{guid {00000000-0000-0000-0000-000000000000}}\"\n        ' Strip the header and the trailing curly bracket.\n        TextGuid = Mid(TextGuid, Start, GuidLength)\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 841258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff18e762b15824c05cbe6712552a9446?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/841258/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 0, "accepted_answer_id": 51056191, "answer_count": 1, "score": 0, "last_activity_date": 1530083222, "creation_date": 1530057377, "question_id": 51052805, "link": "https://stackoverflow.com/questions/51052805/access-guid-value-stored-in-textbox-cant-be-used-in-select-statements", "title": "Access - GUID value stored in textbox, can&#39;t be used in SELECT statements", "body": "<p>I have a form that can be called from a number of places. So I'm using openargs to pull the value over that I need. That value is a GUID. When the open form command is issued, I use <code>stringfromguid(parameter)</code> to pass the GUID along. I tried without the stringfromguid() and that didn't work for anything. The value is stored in a hidden control on the form. It ends up having a value like <code>{guid {753DA23E-D9B5-4570-BFD8-30F7B9B4F450}}</code> which is the correct GUID. </p>\n\n<p>However, when I try to use that value in any further select statements (setting the record source on a subform in this instance) it doesn't work. I know the select statement works, I can copy and paste it in manually but use <code>'xxx'</code> where <code>xxx</code> in the <code>753...F450</code>portion of the value and it works. So, I know that:</p>\n\n<pre><code>SELECT ... FROM ... WHERE IDcol = '753DA23E-D9B5-4570-BFD8-30F7B9B4F450'\n</code></pre>\n\n<p>pulls what I want. But not matter what I do, various stringfromguid() or guidfromstring() attempts, it doesn't work. It ends up trying to use </p>\n\n<pre><code>SELECT ... FROM ... WHERE IDcol = {guid {753DA23E-D9B5-4570-BFD8-30F7B9B4F450}}\n</code></pre>\n\n<p>Which doesn't evalueate to anything.</p>\n\n<p>The data is hosted on a SQL 2012 server. Access is just the front end.</p>\n"}, {"tags": ["sql", "excel", "azure", "vba"], "comments": [{"owner": {"reputation": 20708, "user_id": 9833314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a638e705b9034f9863a91a6a2f95db?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Xiong", "link": "https://stackoverflow.com/users/9833314/nancy-xiong"}, "edited": false, "score": 0, "creation_date": 1530084600, "post_id": 51052768, "comment_id": 89104228, "body": "Can you telnet AzuresqlserverIPaddress 1433 from Clients?"}, {"owner": {"reputation": 1, "user_id": 9997065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fbaef2f2370cb94e430afae400f7de7?s=128&d=identicon&r=PG&f=1", "display_name": "Toban", "link": "https://stackoverflow.com/users/9997065/toban"}, "reply_to_user": {"reputation": 20708, "user_id": 9833314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a638e705b9034f9863a91a6a2f95db?s=128&d=identicon&r=PG&f=1", "display_name": "Nancy Xiong", "link": "https://stackoverflow.com/users/9833314/nancy-xiong"}, "edited": false, "score": 0, "creation_date": 1530096943, "post_id": 51052768, "comment_id": 89111858, "body": "I ran this from powershell - and it returns success:  powershell -Command echo ((new-object Net.Sockets.TcpClient).Client.Connect(&#39;yourazuresqldatabases&zwnj;&#8203;erver.database.windo&zwnj;&#8203;ws.net&#39;, 1433)) &#39;success&#39;"}], "owner": {"reputation": 1, "user_id": 9997065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fbaef2f2370cb94e430afae400f7de7?s=128&d=identicon&r=PG&f=1", "display_name": "Toban", "link": "https://stackoverflow.com/users/9997065/toban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 230, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530057587, "creation_date": 1530056977, "last_edit_date": 1531164843, "question_id": 51052768, "link": "https://stackoverflow.com/questions/51052768/connection-loss-connecting-to-azure-from-excel-vba", "title": "Connection Loss connecting to Azure from Excel VBA", "body": "<p>I have an application I built using excel VBA - it uses Azure SQL as a database. \nI am able to connect to the database in VBA using provider: SQLOLEDB</p>\n\n<pre><code>Example Connection String:\nProvider=SQLOLEDB;\nServer=tcp:ServerName,1433;\nDatabase=DatabaseName;\nUid=Username@ServerName;\nPwd={Password};\nEncrypt=yes;\nConnection Timeout=60;\n</code></pre>\n\n<p>Everything works find - I am able to retrieve the data from the database into ADODB recordsets and work with the recordset data in VBA.\nAfter about 10-15 minutes when I try to update the recordset in any way I get the following error:</p>\n\n<pre><code>[DBNETLIB][ConnectionWrite (send()).]General network error. Check your network documentation.\n</code></pre>\n\n<p>This error persists accross different computers using different internet connections using different Azure SQL databases.\nI first thought it might be resolved by telling VBA to automatically run a query every 5 minutes (i.e. prevent the connection from being idle for too long) and if the query failed then re connect the ADODB connection. \nI then get a VBA 'Connection Failure' error when I try to update the recordset.</p>\n\n<p>What can I do to fix this issue? \nHow can I force the ADODB recordset to stay connected to Azure Database?</p>\n"}]