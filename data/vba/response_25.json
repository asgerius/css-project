[{"tags": ["mysql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1435795437, "post_id": 31173572, "comment_id": 50354830, "body": "Is the <i>date_messaged</i> field&#39;s datatype Date/Time or text according to Access?"}, {"owner": {"reputation": 1533, "user_id": 2588860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/66c08b30d390176ba34dc80f6f677e23?s=128&d=identicon&r=PG", "display_name": "rodrigocf", "link": "https://stackoverflow.com/users/2588860/rodrigocf"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1435798464, "post_id": 31173572, "comment_id": 50355492, "body": "it is a DATE field in MySQL workbench, Access says Date/Time"}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1435798833, "creation_date": 1435798833, "answer_id": 31174050, "question_id": 31173572, "link": "https://stackoverflow.com/questions/31173572/mysql-query-not-working-on-access/31174050#31174050", "title": "MySQL query not working on Access", "body": "<p>Find out why your <code>INSERT</code> fails with no error message.</p>\n\n<p>Execute it with <code>CurrentDb.Execute</code> and its <em>dbFailOnError</em> option.  That combination will alert you to a key violation error which could otherwise cause a silent failure.</p>\n\n<p>Also make sure <code>SetWarnings</code> is not switched off.  When it is off, Access suppresses information.  Make sure you get to see every possible tidbit of information which could aid your troubleshooting efforts.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>'DoCmd.RunSQL the_query_above\nDoCmd.SetWarnings True\nCurrentDb.Execute the_query_above, dbFailOnError\n</code></pre>\n\n<p>I also suggest you revise the <code>INSERT</code> statement.  Enclose <code>[user]</code> in square brackets because it's a <a href=\"http://allenbrowne.com/AppIssueBadWord.html\" rel=\"nofollow\">reserved word</a>.  Since <em>date_messaged</em> is Date/Time datatype, use <code>#</code> characters instead of <code>'</code> quotes around the value you wish to insert there.</p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO parts \n(part_id, source, [user], decision, reason, date_messaged, date_suppress_message) \nVALUES ('IRUDHE3456','Escalation','john','fail','advertising',#2015-07-01#,NULL);\n</code></pre>\n"}], "owner": {"reputation": 1533, "user_id": 2588860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/66c08b30d390176ba34dc80f6f677e23?s=128&d=identicon&r=PG", "display_name": "rodrigocf", "link": "https://stackoverflow.com/users/2588860/rodrigocf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 31174050, "answer_count": 1, "score": 1, "last_activity_date": 1435811167, "creation_date": 1435795133, "last_edit_date": 1435798962, "question_id": 31173572, "link": "https://stackoverflow.com/questions/31173572/mysql-query-not-working-on-access", "title": "MySQL query not working on Access", "body": "<p>I have the following MySQL query:</p>\n\n<pre><code>INSERT INTO parts \n(part_id, source, user, decision, reason, date_messaged, date_suppress_message) \nVALUES ('IRUDHE3456','Escalation','john','fail','advertising','2015-07-01',NULL);\n</code></pre>\n\n<p>It inserts rows perfectly via MySQL Workbench. If I try to run this query via VBA in Access, nothing happens, I get no error message at all, nothing. And the row doesn't get inserted. The VBA looks like this:</p>\n\n<pre><code>DoCmd.RunSQL the_query_above\n</code></pre>\n\n<p>Any ideas of what I'm doing wrong? how does the syntax change in this case?</p>\n\n<p>This is a linked table via ODBC, in case it matters, or is the issue more related to Access itself?</p>\n"}, {"tags": ["excel", "internet-explorer", "powershell", "powershell-ise", "vba"], "comments": [{"owner": {"reputation": 13788, "user_id": 698583, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e856bc0ddf6d12d48ca9e3f43c30b85f?s=128&d=identicon&r=PG", "display_name": "wullxz", "link": "https://stackoverflow.com/users/698583/wullxz"}, "edited": false, "score": 0, "creation_date": 1435795252, "post_id": 31173175, "comment_id": 50354773, "body": "hallo ;) what do you mean exactly by &quot;i would like the excel document to be writeable&quot;? do you want to write the comment directly into the excel sheet or into, say, an input box spawned by your ps script?"}, {"owner": {"reputation": 30007, "user_id": 3245749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYDwR.jpg?s=128&g=1", "display_name": "TheMadTechnician", "link": "https://stackoverflow.com/users/3245749/themadtechnician"}, "edited": false, "score": 0, "creation_date": 1435796340, "post_id": 31173175, "comment_id": 50355041, "body": "I would import the info into PowerShell with <a href=\"https://gallery.technet.microsoft.com/office/17bcabe7-322a-43d3-9a27-f3f96618c74b\" rel=\"nofollow noreferrer\">Import-Xls from the Microsoft Script Gallery</a>. Then visit your sites, update comments, and paste your updated info back into the Excel book."}], "answers": [{"comments": [{"owner": {"reputation": 30007, "user_id": 3245749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYDwR.jpg?s=128&g=1", "display_name": "TheMadTechnician", "link": "https://stackoverflow.com/users/3245749/themadtechnician"}, "edited": false, "score": 0, "creation_date": 1435800755, "post_id": 31174055, "comment_id": 50356012, "body": "Excel is wonky in that you may have issues trying to set the <code>Value</code> property of a cell. I have had better luck setting the <code>Value2</code> property instead."}, {"owner": {"reputation": 13788, "user_id": 698583, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e856bc0ddf6d12d48ca9e3f43c30b85f?s=128&d=identicon&r=PG", "display_name": "wullxz", "link": "https://stackoverflow.com/users/698583/wullxz"}, "reply_to_user": {"reputation": 30007, "user_id": 3245749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xYDwR.jpg?s=128&g=1", "display_name": "TheMadTechnician", "link": "https://stackoverflow.com/users/3245749/themadtechnician"}, "edited": false, "score": 0, "creation_date": 1435801069, "post_id": 31174055, "comment_id": 50356081, "body": "yeah, I was thinking about Value2 vs Value... for this purpose, Value should be ok because it&#39;s just text that gets inserted. I guess you need to try which works best. The question I mentioned in my answer might help. Couldn&#39;t test it myself. The OP has to test and maybe change Value to Value2."}], "tags": [], "owner": {"reputation": 13788, "user_id": 698583, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e856bc0ddf6d12d48ca9e3f43c30b85f?s=128&d=identicon&r=PG", "display_name": "wullxz", "link": "https://stackoverflow.com/users/698583/wullxz"}, "is_accepted": false, "score": 0, "last_activity_date": 1435798860, "last_edit_date": 1495539829, "creation_date": 1435798860, "answer_id": 31174055, "question_id": 31173175, "link": "https://stackoverflow.com/questions/31173175/read-domains-froms-excel-file-and-open-in-ie/31174055#31174055", "title": "Read Domains Froms Excel File and Open in IE", "body": "<p>I guess by \"I would like the excel document to be writeable\" you mean, the PS script should do the job for you.</p>\n\n<p>For that, we have to solve 2 problems:</p>\n\n<ol>\n<li><p>How do we write into excel cells:<br>\nFirst of all, you probably don't want to use the <code>Text</code> property of the <code>Range</code> object returned by <code>$Sheet.Cells.Item($row, 1)</code> because it always returns what would be displayed if you had the excel sheet open (and that includes the hashes you could get if the text doesn't fit in the cell). For more information, see <a href=\"https://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\">this</a> question.<br>\nMy guess is, that <code>Value</code> will be ok instead of <code>Text</code> - and because it's a property, you can also use it to write information.<br>\nMy suggestion for your script would be to move the logic from your ForEach loop into your Do loop as you could use the $row index to also address the Visited and Comment column.<br>\nTo set a Column to visited you could write for example:  </p>\n\n<pre><code>Do {\n    $domain += $Sheet.Cells.Item($row,2).Text\n\n    # (browser magic here!)\n\n    # edit exel sheet:\n    $Sheet.Cells.Item($row, 1).Value = 'yes'\n\n    $row = $row + [int]1\n} until (!$Sheet.Cells.Item($row,1).Text)\n</code></pre></li>\n<li><p>How do we ask the user for the comment?<br>\nYou can use the <code>InputBox</code> method from the <code>Microsoft.VisualBasic.Interaction</code> class:</p>\n\n<pre><code># this will import the Microsoft.VisualBasic assembly and make\n# the Interaction class available in $vbi\n# add those two lines to the top of your script\n[void][System.Reflection.Assembly]::LoadWithPartialName('Microsoft.VisualBasic')\n$vbi = [Microsoft.VisualBasic.Interaction] # convenience variable\n\n# ask the user for a comment\n$comment = $vbi::InputBox(\"Write a comment about that website:\", \"Comment\")\nif ($comment -eq \"\") {\n    echo \"input box was cancelled!\"\n}\nelse {\n    echo \"comment:`t$comment\"\n}\n</code></pre></li>\n</ol>\n\n<p>At the end, your code might look like this:</p>\n\n<pre><code>    [void][System.Reflection.Assembly]::LoadWithPartialName('Microsoft.VisualBasic')\n    $vbi = [Microsoft.VisualBasic.Interaction] # convenience variable\n    $ExcelObject = New-Object -comobject Excel.Application\n    $ExcelObject.Visible = $true\n    $ExcelObject.DisplayAlerts = $False\n\n    $excelFile = \"C:\\Users\\muafzal\\Documents\\Files\\EMIE\\Analyzing\\list.xlsx\"\n\n    $Workbook = $ExcelObject.workbooks.open($excelFile)\n    $Sheet = $Workbook.Worksheets.Item(1)\n\n    $row = [int]2\n    $domain = @() # beginnt bei 2,1... 3,1... 4,1\n    Do {\n        $domain += $Sheet.Cells.Item($row,2).Text \n\n        # browser magic here:\n        #Start IE and make it visible\n        $ie = new-object -com \"InternetExplorer.Application\"\n        $ie.Visible = $true\n\n        #Navigate to the URL\n        $ie.Navigate($url)\n\n        # Output URL that have been visited to a text file.\n        $url |  Out-File $done -Append\n\n        #Sleep while IE is running\n        while($ie.visible){\n                start-sleep -s 1\n        }\n\n        # ask the user for a comment\n        $comment = $vbi::InputBox(\"Write a comment about that website:\", \"Comment\")\n        if ($comment -eq \"\") {\n            # cancel was pressed, so maybe revisit later?\n            $Sheet.Cells.Item($row, 1).Value = 'no'\n        }\n        else {\n            # edit exel sheet:\n            $Sheet.Cells.Item($row, 1).Value = 'yes'\n            $sheet.Cells.Item($row, 3).Value = $comment\n        }\n\n        # next row...\n        $row = $row + [int]1\n    } until (!$Sheet.Cells.Item($row,1).Text)\n</code></pre>\n\n<p>PS: I don't have an excel installed to test the code but I think it should work right away. I hope that is what you really wanted to know ;)</p>\n"}], "owner": {"reputation": 831, "user_id": 4970524, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/2f7266815f5b1f1b12e97d31e5db62cb?s=128&d=identicon&r=PG&f=1", "display_name": "Imsa", "link": "https://stackoverflow.com/users/4970524/imsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435798860, "creation_date": 1435792431, "last_edit_date": 1531161705, "question_id": 31173175, "link": "https://stackoverflow.com/questions/31173175/read-domains-froms-excel-file-and-open-in-ie", "title": "Read Domains Froms Excel File and Open in IE", "body": "<p>I have a Excel file which which looks like this:</p>\n\n<pre><code>Visted     Domains        Comments\n           yahoo.com\n           google.com\n           hotmail.com\n</code></pre>\n\n<p>All of columns are already populated.</p>\n\n<p>I am trying to read the domain from Excel file, open in IE. <strong>Once it's visited, write 'yes' under 'Visited' column.</strong></p>\n\n<p>So far, this current script read from the Excel file, and opens in IE. Once I close the current IE Window, it opens the next URL.</p>\n\n<pre><code>$ExcelObject = New-Object -comobject Excel.Application\n$ExcelObject.Visible = $true\n$ExcelObject.DisplayAlerts = $False\n\n$excelFile = \"C:\\Users\\muafzal\\Documents\\Files\\EMIE\\Analyzing\\list.xlsx\"\n\n$Workbook = $ExcelObject.workbooks.open($excelFile)\n$Sheet = $Workbook.Worksheets.Item(1)\n\n$row = [int]2\n$domain = @() # beginnt bei 2,1... 3,1... 4,1\nDo {\n    $domain += $Sheet.Cells.Item($row,2).Text ; $row = $row + [int]1\n} until (!$Sheet.Cells.Item($row,1).Text)\n\nForEach($url in $domain){\n    #Start IE and make it visible\n    $ie = new-object -com \"InternetExplorer.Application\"\n    $ie.Visible = $true\n\n    #Navigate to the URL\n    $ie.Navigate($url)\n\n    # Output URL that have been visited to a text file.\n    $url |  Out-File $done -Append\n\n    #Sleep while IE is running\n    while($ie.visible){\n            start-sleep -s 1\n        }\n}\n</code></pre>\n\n<p>I would like the Excel document to be writable, so I can enter comments about the website.</p>\n"}, {"tags": ["vba", "compiler-errors", "return"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "edited": false, "score": 0, "creation_date": 1435786485, "post_id": 31172031, "comment_id": 50351925, "body": "I actually found quite a few posts on google trying to find it, but not that one. I promise I tried. lol That&#39;s dumb. I don&#39;t like VBA. But, Thank you. It worked."}], "tags": [], "owner": {"reputation": 1827, "user_id": 1303827, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/46c6fe34f1fdce3edc463169a9b03763?s=128&d=identicon&r=PG", "display_name": "Tim S.", "link": "https://stackoverflow.com/users/1303827/tim-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1435786208, "last_edit_date": 1495539829, "creation_date": 1435786208, "answer_id": 31172031, "question_id": 31171886, "link": "https://stackoverflow.com/questions/31171886/compile-error-expected-end-of-statment/31172031#31172031", "title": "Compile error Expected: end of statment", "body": "<p>Duplicate of <a href=\"http://Duplicate%20of%20[this%20post](https://stackoverflow.com/questions/2781689/how-to-return-a-result-from-a-vba-function)\" rel=\"nofollow noreferrer\">this post</a>, but basically you need to assign the function name the value, for example:</p>\n\n<pre><code>Addresses = 1\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>return 1\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 1282755, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1c391d44a9848604ee924b6ed9725b13?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1282755/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 31172031, "answer_count": 1, "score": 0, "last_activity_date": 1435786208, "creation_date": 1435785578, "question_id": 31171886, "link": "https://stackoverflow.com/questions/31171886/compile-error-expected-end-of-statment", "title": "Compile error Expected: end of statment", "body": "<p>I've got some code that works perfectly fine, but I wanted to add something to it. So I made one of my functions return a value. But, no matter what I return, I get the \"Compile error Expected: end of statment\" msgbox appearing.</p>\n\n<p>I eventually did this to my code, and I still get the error.\nCan someone please explain this?</p>\n\n<pre><code>Public Function Addresses() As Integer\n return 1\n\nEnd Function \n</code></pre>\n"}, {"tags": ["excel", "excel-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4994987, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-cxfsTMZRTXw/AAAAAAAAAAI/AAAAAAAAAGs/J_3Go32rwLg/photo.jpg?sz=128", "display_name": "Ryan Hubbard", "link": "https://stackoverflow.com/users/4994987/ryan-hubbard"}, "edited": false, "score": 0, "creation_date": 1435842203, "post_id": 31172953, "comment_id": 50376077, "body": "I looked at the two links you posted to schedule the macro. The thing is that the page will be open every day, so no need to use a task scheduler. Think this would work? <code>Private Sub Workbook_Open()      Application.OnTime TimeValue(&quot;11:00:00&quot;), &quot;MyMacro&quot;  End Sub</code>"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1435791225, "last_edit_date": 1495541164, "creation_date": 1435790908, "answer_id": 31172953, "question_id": 31171493, "link": "https://stackoverflow.com/questions/31171493/copy-and-paste-to-next-available-column/31172953#31172953", "title": "Copy and Paste to next available column", "body": "<p>You can work out the column number of the last column like this:</p>\n\n<pre><code>Sub CopyPaste()\n'\n' CopyPaste Macro\n'\nDim lastCol As Long\n' this finds the number of the last column\nlastCol = Cells(35, Columns.Count).End(xlToLeft).Column\n\n   Range(\"G4:G33\").Copy\n\n'   Range(\"B35\").Select\n' no need to select. paste into the cell in row 35, one to the right of the last column\n   Cells(35, lastCol + 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nEnd Sub\n</code></pre>\n\n<p>You could also add the 1 right in the lastCol definition, like</p>\n\n<pre><code>   lastCol = Cells(35, Columns.Count).End(xlToLeft).Column + 1\n   Range(\"G4:G33\").Copy\n   Cells(35, lastCol).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n      :=False, Transpose:=False\n</code></pre>\n\n<p>For scheduling the macro look at these two questions <a href=\"https://stackoverflow.com/questions/20202706/running-a-vba-excel-macro-at-a-certain-time?rq=1\">here</a> and <a href=\"https://stackoverflow.com/questions/18358214/excel-ontime-events-scheduler\">here</a></p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 4994987, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-cxfsTMZRTXw/AAAAAAAAAAI/AAAAAAAAAGs/J_3Go32rwLg/photo.jpg?sz=128", "display_name": "Ryan Hubbard", "link": "https://stackoverflow.com/users/4994987/ryan-hubbard"}, "edited": false, "score": 0, "creation_date": 1435842296, "post_id": 31173264, "comment_id": 50376150, "body": "Thank you for your reply. So far i&#39;ve only used Teylyn response. If it fails, i will give yours a try."}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "reply_to_user": {"reputation": 29, "user_id": 4994987, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-cxfsTMZRTXw/AAAAAAAAAAI/AAAAAAAAAGs/J_3Go32rwLg/photo.jpg?sz=128", "display_name": "Ryan Hubbard", "link": "https://stackoverflow.com/users/4994987/ryan-hubbard"}, "edited": false, "score": 0, "creation_date": 1435850980, "post_id": 31173264, "comment_id": 50382538, "body": "No problem Ryan - this is just an alternative approach. I have some slightly complicated, and repetitive macros, and found that the clipboard wasn&#39;t always a reliable tool to use."}, {"owner": {"reputation": 29, "user_id": 4994987, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-cxfsTMZRTXw/AAAAAAAAAAI/AAAAAAAAAGs/J_3Go32rwLg/photo.jpg?sz=128", "display_name": "Ryan Hubbard", "link": "https://stackoverflow.com/users/4994987/ryan-hubbard"}, "edited": false, "score": 0, "creation_date": 1435861991, "post_id": 31173264, "comment_id": 50389080, "body": "I ended up using yours instead. You were correct about the Clipboard deal. Plus it was a little easier to adjust. For instance, i had to make sure the macro switched to the correct sheet and pasted it to the correct one."}], "tags": [], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "is_accepted": false, "score": 1, "last_activity_date": 1435793132, "creation_date": 1435793132, "answer_id": 31173264, "question_id": 31171493, "link": "https://stackoverflow.com/questions/31171493/copy-and-paste-to-next-available-column/31173264#31173264", "title": "Copy and Paste to next available column", "body": "<p>At first sight maybe slightly more complex, but in a way a more pretty way of tackling the movement of values is to avoid using the clipboard with code like this:</p>\n\n<pre><code>Sub CopyPaste()\n'\n' CopyPaste Macro\n'\n'\nDim targetRng As Excel.Range\nDim destRng As Excel.Range\nSet targetRng = Range(\"G4:G33\")\n\nDim lc As Long\nWith Excel.ThisWorkbook.Sheets(\"Sheet1\")\n    lc = .Cells(35, .Columns.Count).End(Excel.xlToLeft).Column\n    Set destRng = .Range(.Cells(35, lc), .Cells(35, lc)).Offset(0, 1).Resize(targetRng.Rows.Count, targetRng.Columns.Count)\n    destRng.Value = targetRng.Value\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>The above can be simplified to the following so you don't need to worry about using the last row variable:</p>\n\n<pre><code>Sub CopyPaste()\n'\n' CopyPaste Macro\n'\n'\nDim targetRng As Excel.Range\nDim destRng As Excel.Range\nSet targetRng = Range(\"G4:G33\")\n\nWith Excel.ThisWorkbook.Sheets(\"Sheet1\")\n    Set destRng = .Cells(35, .Columns.Count).End(Excel.xlToLeft).Offset(0, 1).Resize(targetRng.Rows.Count, targetRng.Columns.Count)\n    destRng.Value = targetRng.Value\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4994987, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-cxfsTMZRTXw/AAAAAAAAAAI/AAAAAAAAAGs/J_3Go32rwLg/photo.jpg?sz=128", "display_name": "Ryan Hubbard", "link": "https://stackoverflow.com/users/4994987/ryan-hubbard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16250, "favorite_count": 0, "accepted_answer_id": 31172953, "answer_count": 2, "score": 0, "last_activity_date": 1435793132, "creation_date": 1435784077, "last_edit_date": 1531164843, "question_id": 31171493, "link": "https://stackoverflow.com/questions/31171493/copy-and-paste-to-next-available-column", "title": "Copy and Paste to next available column", "body": "<p>I'm trying to track weekly quantities I have in my spread sheet. So far I've made a macro to copy and paste the info where I need it. But it will only paste it to the spot I chose while recording the macro. I'd like it to paste the info into the next available column.</p>\n\n<p>I'd also like to schedule the macro to run once a week on Friday morning.</p>\n\n<p>Macro I'm using now.</p>\n\n<pre><code>Sub CopyPaste()\n'\n' CopyPaste Macro\n'\n\n'\n   Range(\"G4:G33\").Select\n   Selection.Copy\n   Range(\"B35\").Select\n   Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nEnd Sub\n</code></pre>\n\n<p>I've tried putting &amp; lastrow into the range, but it gets a compile error. Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "printing"], "answers": [{"tags": [], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "is_accepted": false, "score": 1, "last_activity_date": 1435848689, "last_edit_date": 1435848689, "creation_date": 1435784514, "answer_id": 31171607, "question_id": 31171316, "link": "https://stackoverflow.com/questions/31171316/set-number-of-copies-per-worksheet/31171607#31171607", "title": "Set number of copies per worksheet", "body": "<p>After looking at Omar's answer and my previous answer, I think you don't need an array at all. Put the number of copies you want to print on each sheet in Cell A2:</p>\n\n<pre><code>Sub PrintSheets()\nDim ws As Worksheet\n\nFor Each ws In Worksheets\n    If ws.Range(\"A1\") = \"print\" Then\n        ws.PrintOut Copies:= ws.Range(\"A2\").Value2\n    End If\nNext ws\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1435848526, "post_id": 31171672, "comment_id": 50380830, "body": "This answer is great, much better than my previous attempt, but I think it is still incomplete as far as efficiency so I am going to combine your answer into mine and make a final change. Good work!"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1435849195, "post_id": 31171672, "comment_id": 50381268, "body": "@puzzlepiece87 sure no problem"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1435786721, "last_edit_date": 1435786721, "creation_date": 1435784739, "answer_id": 31171672, "question_id": 31171316, "link": "https://stackoverflow.com/questions/31171316/set-number-of-copies-per-worksheet/31171672#31171672", "title": "Set number of copies per worksheet", "body": "<p>Try this</p>\n\n<pre><code>Sheets(arrWS).PrintOut Copies:=Range(\"A2\").Value\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5071286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/976325071c2f719d793c93fd94c94637?s=128&d=identicon&r=PG&f=1", "display_name": "excelstack12", "link": "https://stackoverflow.com/users/5071286/excelstack12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1112, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1435848689, "creation_date": 1435783451, "last_edit_date": 1435791380, "question_id": 31171316, "link": "https://stackoverflow.com/questions/31171316/set-number-of-copies-per-worksheet", "title": "Set number of copies per worksheet", "body": "<p>I have a workbook that combines multiple reports. Currently, I am using a piece of vba code to determine which worksheets are printed based on a cell value in each worksheet. </p>\n\n<p>Is there a way to add to the existing code to set each worksheet to print a specific number of times per sheet? example, print sheet1 2 times, print sheet2 1 time, and so on, using a cell reference on that worksheet. The code </p>\n\n<p>I have for printing so far is:</p>\n\n<pre><code>Sub PrintSheets()\nDim ws As Worksheet\nDim arrWS()\nDim I As Long\n    For Each ws In Worksheets\n        If ws.Range(\"A1\") = \"print\" Then\n            ReDim Preserve arrWS(I)\n            arrWS(I) = ws.Name\n            I = I + 1\n        End If\n    Next ws\n\n    Sheets(arrWS).PrintOut\nEnd Sub\n</code></pre>\n\n<p>I've tried a couple different items, but they each look to one sheet to determine how many times everything is printed, instead of allowing each page to have its own specific number of copies. </p>\n"}, {"tags": ["excel", "vba", "excel-2007"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1435785779, "creation_date": 1435785779, "answer_id": 31171942, "question_id": 31171249, "link": "https://stackoverflow.com/questions/31171249/button-that-will-hide-and-unhide-row-one-at-a-time-something-similar-to-spin-bu/31171942#31171942", "title": "button that will hide and unhide row one at a time. Something similar to spin button", "body": "<p><code>SpinButton1</code> is an ActiveX spinbutton the worksheet (Min=0, Max=10 or however many rows you want to show/hide)</p>\n\n<p>A7 here will be the top row of the set of rows to be shown/hidden</p>\n\n<p>Code goes in the sheet module.</p>\n\n<pre><code>Private Sub SpinButton1_Change()\n\n    Dim r As Long, mx As Long\n    r = Me.SpinButton1.Value\n    mx = Me.SpinButton1.Max\n\n    With Me.Range(\"A7\")\n        If r &gt; 0 Then .Resize(r).EntireRow.Hidden = False\n        If r &lt; mx Then .Offset(r, 0).Resize(mx - r).EntireRow.Hidden = True\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4879383, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/afb1f0ce5aec52975208cbafc0dae011?s=128&d=identicon&r=PG&f=1", "display_name": "ruby", "link": "https://stackoverflow.com/users/4879383/ruby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 799, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1436197272, "creation_date": 1435783209, "question_id": 31171249, "link": "https://stackoverflow.com/questions/31171249/button-that-will-hide-and-unhide-row-one-at-a-time-something-similar-to-spin-bu", "title": "button that will hide and unhide row one at a time. Something similar to spin button", "body": "<p>I have searched threw many questions but can't find any answer to what i cam looking to do.<br>\n    I would like to hide and unhide rows.  I like spin button where you can click up and down arrow but If that doesn't work then one button to hide and other to unhide.</p>\n\n<pre><code>I have tried few VBA codes but none of them worked the way I want.\n\n**1st VBA code**:  following code works to hide multiple rows but all at once not one at a time.  \nIf ToggleButton1.Value = True Then\n 'This area contains the things you want to happen\n'when the toggle button is not depressed\nRows(4).EntireRow.Hidden = True\nRows(5).EntireRow.Hidden = True\nRows(6).EntireRow.Hidden = True\nElse\n'This area contains the things you want to happen\n'when the toggle button is depressed\nRows(4).EntireRow.Hidden = False\nRows(5).EntireRow.Hidden = False\nRows(6).EntireRow.Hidden = False\n End If\n2nd VBA code: Hide and unhides just one row.\nIf ToggleButton1.Value = True Then\n 'This area contains the things you want to happen\n'when the toggle button is not depressed\nRows(4).EntireRow.Hidden = True\nElse\n'This area contains the things you want to happen\n'when the toggle button is depressed\n Rows(4).EntireRow.Hidden = False\n  End If\n\n\n\nSomeone please help!\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 3264432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/32cb40290324ba87c607e07dd43137fd?s=128&d=identicon&r=PG&f=1", "display_name": "user3264432", "link": "https://stackoverflow.com/users/3264432/user3264432"}, "edited": false, "score": 0, "creation_date": 1435866281, "post_id": 31171517, "comment_id": 50391417, "body": "I thank you for your answer --- but what if the user enters a lowercase instead of uppercase?      Does this mean I need to have 4 CASE statements or 4 IF statements?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 19, "user_id": 3264432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/32cb40290324ba87c607e07dd43137fd?s=128&d=identicon&r=PG&f=1", "display_name": "user3264432", "link": "https://stackoverflow.com/users/3264432/user3264432"}, "edited": false, "score": 0, "creation_date": 1435866740, "post_id": 31171517, "comment_id": 50391669, "body": "Have a look at <code>Select Case</code> statement... I&#39;m using <code>UCase()</code> function which returns upper case. So you don&#39;t need to use 4 if statements."}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": true, "score": 0, "last_activity_date": 1435784162, "creation_date": 1435784162, "answer_id": 31171517, "question_id": 31170837, "link": "https://stackoverflow.com/questions/31170837/word-vba-input-box-to-set-document-orientation-if-with-or/31171517#31171517", "title": "Word Vba Input Box to set Document Orientation - IF with OR", "body": "<p>I'm not sure is there a better (more efficient) way to develop MS Word page orientation... I would not use <code>InputBox</code>, but if you want to use it i'd do something like this:</p>\n\n<pre><code>AskAgain:\n    Orientation = InputBox(Prompt:=\"Enter P for Portriait, L for Landscape\")\n\n    Select Case UCase(Orientation) \n         Case \"L\"\n            Selection.PageSetup.Orientation = wdOrientLandscape\n         Case \"P\"\n            Selection.PageSetup.Orientation = wdOrientPortrait\n         Case Else\n            GoTo AskAgain\n    End Select\n</code></pre>\n\n<p>To be honest... leave the decision to the user and do not prevent user to set page orientation from VBA code, but call print preview window. This is best way - in my opinion.</p>\n"}], "owner": {"reputation": 19, "user_id": 3264432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/32cb40290324ba87c607e07dd43137fd?s=128&d=identicon&r=PG&f=1", "display_name": "user3264432", "link": "https://stackoverflow.com/users/3264432/user3264432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 31171517, "answer_count": 1, "score": 0, "last_activity_date": 1435784162, "creation_date": 1435781809, "question_id": 31170837, "link": "https://stackoverflow.com/questions/31170837/word-vba-input-box-to-set-document-orientation-if-with-or", "title": "Word Vba Input Box to set Document Orientation - IF with OR", "body": "<p>In my macro I want to prompt for the page Orientation -- P or p for portrait, L or l for landscape.  </p>\n\n<p>Here is what I developed.    It works - but want to know if there is a better/more efficient way to develop If statements for \"OR\" --- do I have to use a \"nested\" If??</p>\n\n<pre><code>    Dim i As Integer\n    Dim oTbl As Table\n    Dim rng As Range\n    Dim Orientation As String\n\n  With Selection.PageSetup\n        .LineNumbering.Active = False\n        .Orientation = wdOrientPortrait\n        .TopMargin = InchesToPoints(1)\n        .BottomMargin = InchesToPoints(1)\n        .LeftMargin = InchesToPoints(0.4)\n        .RightMargin = InchesToPoints(0.4)\n        .Gutter = InchesToPoints(0)\n        .HeaderDistance = InchesToPoints(0.5)\n        .FooterDistance = InchesToPoints(0.6)\n        .PageWidth = InchesToPoints(8.5)\n        .PageHeight = InchesToPoints(11)\n        .FirstPageTray = wdPrinterDefaultBin\n        .OtherPagesTray = wdPrinterDefaultBin\n        .SectionStart = wdSectionNewPage\n        .OddAndEvenPagesHeaderFooter = False\n        .DifferentFirstPageHeaderFooter = False\n        .VerticalAlignment = wdAlignVerticalTop\n        .SuppressEndnotes = False\n        .MirrorMargins = False\n        .TwoPagesOnOne = False\n        .BookFoldPrinting = False\n        .BookFoldRevPrinting = False\n        .BookFoldPrintingSheets = 1\n        .GutterPos = wdGutterPosLeft\n    End With\n\n\n' set Orientation\n\n\n    Orientation = InputBox(Prompt:=\"Enter P for Portriait, L for Landscape\")\n\n    If Orientation = \"L\" Then\n        With Selection.PageSetup\n              .Orientation = wdOrientLandscape\n        End With\n    ElseIf Orientation = \"l\" Then\n        With Selection.PageSetup\n              .Orientation = wdOrientLandscape\n        End With\n    Else\n        With Selection.PageSetup\n              .Orientation = wdOrientPortrait\n        End With\n    End If\n</code></pre>\n"}, {"tags": ["vba", "excel", "error-handling", "rename"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4552638, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153063761844347/picture?type=large", "display_name": "Amit Agarwal", "link": "https://stackoverflow.com/users/4552638/amit-agarwal"}, "edited": false, "score": 0, "creation_date": 1435839637, "post_id": 31170717, "comment_id": 50374223, "body": "Marked as correct because of clarity in what is being done and multiple ways to handle the situation."}], "tags": [], "owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "is_accepted": true, "score": 1, "last_activity_date": 1435788972, "last_edit_date": 1435788972, "creation_date": 1435781366, "answer_id": 31170717, "question_id": 31170484, "link": "https://stackoverflow.com/questions/31170484/check-sheet-names-to-avoid-duplicates/31170717#31170717", "title": "Check sheet names to avoid duplicates", "body": "<p>There are two ways to handle this.</p>\n\n<p>First, trap the error, check if there was an error, and advise, then put the error trapping back to what it was</p>\n\n<pre><code>Dim sheetname As String\n\nsheetname = InputBox(Prompt:=\"Enter Model Code (eg 2SV)\", _\n      Title:=\"Model Code\", Default:=\"Model Code here\")\n\nOn Error Resume next\nErr.Clear 'ensure previously unhandled errors do not give a false positive on err.number\nwsCopyTo.Name = sheetname\nIf Err.Number = ?? then 'go back and ask for another name\nOn Error Goto 0\n</code></pre>\n\n<p>Second, check all the current sheet names, and see if there is a match</p>\n\n<pre><code>Dim sheetname As String\nDim sh 'as Sheet\n\nsheetname = InputBox(Prompt:=\"Enter Model Code (eg 2SV)\", _\n      Title:=\"Model Code\", Default:=\"Model Code here\")\n\nfor each sh in ActiveWorkbook.Sheets\n     If lower(sh.name)=lower(sheetname) then\n         'Goback and ask for another name\nNext\n\nwsCopyTo.Name = sheetname\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1435781630, "post_id": 31170759, "comment_id": 50349356, "body": "For proper error trapping, I do not suggest Err.Clear. See this guide I received a few weeks ago: <a href=\"http://stackoverflow.com/questions/30489035/vba-excel-simple-error-handling\" title=\"vba excel simple error handling\">stackoverflow.com/questions/30489035/&hellip;</a> It is the highest voted answer."}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1435788858, "post_id": 31170759, "comment_id": 50352911, "body": "I think your comment is on the wrong answer, and the reason I use <code>err.clear</code> is that if there is a previously unhandled error on the stack, then that could cause the <code>err.number</code> check to fail, as the value only gets changed on an error, or when Err.Clear is executed"}, {"owner": {"reputation": 457, "user_id": 11832197, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-U8ZO6LVb3x8/AAAAAAAAAAI/AAAAAAAAAWg/8gxyuHZSKdA/photo.jpg?sz=128", "display_name": "Antonio Santos", "link": "https://stackoverflow.com/users/11832197/antonio-santos"}, "edited": false, "score": 0, "creation_date": 1618511446, "post_id": 31170759, "comment_id": 118630239, "body": "Just like a glove!"}], "tags": [], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1435781496, "creation_date": 1435781496, "answer_id": 31170759, "question_id": 31170484, "link": "https://stackoverflow.com/questions/31170484/check-sheet-names-to-avoid-duplicates/31170759#31170759", "title": "Check sheet names to avoid duplicates", "body": "<p>Start by looping through the ones you have and compare their names with the one the user gave. If it matches, write a message saying that's used already. Exit the sub afterwards.</p>\n\n<pre><code>For i = 1 To ActiveWorkbook.Worksheets.Count\n        If Worksheets(i).Name = sheetname then\n             msgbox \"This name is already in use!\"\n             exit sub\n        End if\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 4552638, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153063761844347/picture?type=large", "display_name": "Amit Agarwal", "link": "https://stackoverflow.com/users/4552638/amit-agarwal"}, "edited": false, "score": 0, "creation_date": 1435839453, "post_id": 31174418, "comment_id": 50374091, "body": "But this wouldn&#39;t handle the error with invalid characters or the length being too long, right?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 5, "user_id": 4552638, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153063761844347/picture?type=large", "display_name": "Amit Agarwal", "link": "https://stackoverflow.com/users/4552638/amit-agarwal"}, "edited": false, "score": 0, "creation_date": 1435878249, "post_id": 31174418, "comment_id": 50396467, "body": "I have added 1 more check when attempt to change the worksheet name."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1435878147, "last_edit_date": 1435878147, "creation_date": 1435801717, "answer_id": 31174418, "question_id": 31170484, "link": "https://stackoverflow.com/questions/31170484/check-sheet-names-to-avoid-duplicates/31174418#31174418", "title": "Check sheet names to avoid duplicates", "body": "<p>The simplest way is to create a Worksheet variable and Set it to what user has input (you might want to <strong>Trim()</strong> as well to remove leading and trailing spaces).</p>\n\n<p>If it's Nothing then name is safe to use. If <strong>Not Is Nothing</strong> then it already exists.</p>\n\n<pre><code>Dim oWS As Worksheet\n\nOn Error Resume Next\nSet oWS = ThisWorkbook.Worksheets(sheetname)\n\nIf oWS Is Nothing Then\n    ' Safe to use the name\n    Debug.Print \"\"\"\" &amp; sheetname &amp; \"\"\" is save to use.\"\n    Err.Clear\n    wsCopyTo.Name = sheetname\n    If Err.Number &lt;&gt; 0 Then\n        MsgBox \"Cannot use \"\"\" &amp; sheetname &amp; \"\"\" as worksheet name.\"\n        Err.Clear\n    End If\nElse\n    Debug.Print \"\"\"\" &amp; sheetname &amp; \"\"\" exists already! Cannot use.\"\n    ' worksheet with same name already!\n    ' handle it here\n\nEnd If\nSet oWS = Nothing\nOn Error GoTo 0\n</code></pre>\n\n<p>You could also put it into a loop until a unused sheetname is found.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 4552638, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153063761844347/picture?type=large", "display_name": "Amit Agarwal", "link": "https://stackoverflow.com/users/4552638/amit-agarwal"}, "edited": false, "score": 0, "creation_date": 1435839343, "post_id": 31174494, "comment_id": 50373983, "body": "This is very helpful. Is there a way I could modify what it says? I&#39;d like the dialog box to say <b>&quot;Enter Model Code (eg 2SV)&quot;</b>."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "reply_to_user": {"reputation": 5, "user_id": 4552638, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153063761844347/picture?type=large", "display_name": "Amit Agarwal", "link": "https://stackoverflow.com/users/4552638/amit-agarwal"}, "edited": false, "score": 0, "creation_date": 1435842418, "post_id": 31174494, "comment_id": 50376251, "body": "Good question. Alas, no there&#39;s not, at least that I know of."}], "tags": [], "owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "is_accepted": false, "score": 1, "last_activity_date": 1435802292, "creation_date": 1435802292, "answer_id": 31174494, "question_id": 31170484, "link": "https://stackoverflow.com/questions/31170484/check-sheet-names-to-avoid-duplicates/31174494#31174494", "title": "Check sheet names to avoid duplicates", "body": "<p>I just wrote a post about using Excel's native Rename Sheet dialog to do this. That way you get error-checking for duplicates, illegal characters and names that are too long. Here's a routine that adds a sheet and calls the dialog. If the user doesn't rename it, then the new sheet is deleted:</p>\n\n<pre><code>Sub PromptForNewSheetWithName()\nDim DefaultSheetName As String\n\nActiveWorkbook.Worksheets.Add\nDefaultSheetName = ActiveSheet.Name\nApplication.Dialogs(xlDialogWorkbookName).Show\nIf ActiveSheet.Name = DefaultSheetName Then\n    MsgBox \"You didn't name the new sheet.\" &amp; vbCrLf &amp; _\n           \"Processing cancelled\", vbExclamation\n    Application.DisplayAlerts = False\n    ActiveSheet.Delete\n    Application.DisplayAlerts = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The whole post is at: <a href=\"http://yoursumbuddy.com/prompt-to-name-new-sheet/\" rel=\"nofollow\">http://yoursumbuddy.com/prompt-to-name-new-sheet/</a></p>\n"}], "owner": {"reputation": 5, "user_id": 4552638, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153063761844347/picture?type=large", "display_name": "Amit Agarwal", "link": "https://stackoverflow.com/users/4552638/amit-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5737, "favorite_count": 0, "accepted_answer_id": 31170717, "answer_count": 4, "score": 0, "last_activity_date": 1435878147, "creation_date": 1435780490, "last_edit_date": 1435814787, "question_id": 31170484, "link": "https://stackoverflow.com/questions/31170484/check-sheet-names-to-avoid-duplicates", "title": "Check sheet names to avoid duplicates", "body": "<p>I am working on a macro, a part of which takes input from the user asking what he/she would like to rename the sheet. It works fine, but I run into a runtime error if the name provided by the user is already being used by a different sheet. I understand why the error occurs but am not sure as to how I could warn the user and handle the error. </p>\n\n<p>My code is as follows:-</p>\n\n<pre><code>'Change sheet name\n\nDim sheetname As String\n\nsheetname = InputBox(Prompt:=\"Enter Model Code (eg 2SV)\", _\n      Title:=\"Model Code\", Default:=\"Model Code here\")\n\nwsCopyTo.Name = sheetname\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 318, "user_id": 4721565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700af168e5e09a36b844328770337189?s=128&d=identicon&r=PG&f=1", "display_name": "Lumigraphics", "link": "https://stackoverflow.com/users/4721565/lumigraphics"}, "edited": false, "score": 0, "creation_date": 1435782420, "post_id": 31170428, "comment_id": 50349772, "body": "Have you tried duplicating the worksheet, sorting by city, and then deleting what you don&#39;t need in order? That way you don&#39;t have to worry about copying anything."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 3525049, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/614448508/picture?type=large", "display_name": "Matthew Cremona", "link": "https://stackoverflow.com/users/3525049/matthew-cremona"}, "edited": false, "score": 0, "creation_date": 1435788171, "post_id": 31170980, "comment_id": 50352668, "body": "Hey david! Thanks for your reply, I encountered a runtime error posted below, any tips? Sorry If I may be asking silly questions but I am trying to simplify some very hectic tasks at work with my very limited knowledge."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 17, "user_id": 3525049, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/614448508/picture?type=large", "display_name": "Matthew Cremona", "link": "https://stackoverflow.com/users/3525049/matthew-cremona"}, "edited": false, "score": 0, "creation_date": 1435843252, "post_id": 31170980, "comment_id": 50376879, "body": "The loop likely went too far. Probably assigning an empty value to strName, which causes Sheets(strname) to crash. If you try it with i = 1 To Sheets(&quot;[TableSheet]&quot;).Cells(Rows.Count, &quot;B&quot;).End(xlUp).Row - 1, does it work? And does it work even for the LAST values or does it skip one? If it doesn&#39;t i suggest adding a &lt; debug.print i &amp; &quot;  &quot; &amp; strname &gt; at the end of the code to see where it falls out. Cheers!"}], "tags": [], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1435782281, "creation_date": 1435782281, "answer_id": 31170980, "question_id": 31170428, "link": "https://stackoverflow.com/questions/31170428/excel-vba-to-copy-list-to-new-worksheet/31170980#31170980", "title": "Excel VBA to copy list to new worksheet", "body": "<p>Once all the sheets are created, you just need to scour the list in search for cities. For each line, look at the city, and write it in the corresponding sheet. The sheets need to have the same names as the cities for my code to work. </p>\n\n<p>I assume you started in column A, row 1.</p>\n\n<pre><code>dim strCity as string\ndim strAdd as string\ndim strName as string\nfor i = 1 to Sheets(\"[TableSheet]\").Cells(Rows.Count, \"A\").End(xlUp).row\n     strCity = Sheets(\"[TableSheet]\").range(\"A\" &amp; i)\n     strAdd = Sheets(\"[TableSheet]\").range(\"B\" &amp; i)\n     strName = Sheets(\"[TableSheet]\").range(\"C\" &amp; i)\n\n     Sheets(strCity).Range(\"A\" &amp; i) = strCity\n     Sheets(strCity).Range(\"B\" &amp; i) = strAdd\n     Sheets(strCity).Range(\"C\" &amp; i) = strName\nnext\n</code></pre>\n\n<p>[tableSheet] of course is the name of the sheet with your information.If you don't udnerstand and have questions I can gladly answer.</p>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 3525049, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/614448508/picture?type=large", "display_name": "Matthew Cremona", "link": "https://stackoverflow.com/users/3525049/matthew-cremona"}, "is_accepted": false, "score": 0, "last_activity_date": 1435788113, "creation_date": 1435788113, "answer_id": 31172457, "question_id": 31170428, "link": "https://stackoverflow.com/questions/31170428/excel-vba-to-copy-list-to-new-worksheet/31172457#31172457", "title": "Excel VBA to copy list to new worksheet", "body": "<p>thanks for your swift reply. I used it on a simple list and it worked fine. However, I applied it to a slightly more complex scenario and edited the code as follows:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Dim strDB As String\r\nDim strName As String\r\nDim strDate As String\r\nDim strHour As String\r\nDim strMin As String\r\nDim strGR As String\r\n\r\nFor i = 1 To Sheets(\"[TableSheet]\").Cells(Rows.Count, \"B\").End(xlUp).Row\r\n     strDB = Sheets(\"[TableSheet]\").Range(\"A\" &amp; i)\r\n     strName = Sheets(\"[TableSheet]\").Range(\"B\" &amp; i)\r\n     strDate = Sheets(\"[TableSheet]\").Range(\"C\" &amp; i)\r\n     strHour = Sheets(\"[TableSheet]\").Range(\"D\" &amp; i)\r\n     strMin = Sheets(\"[TableSheet]\").Range(\"E\" &amp; i)\r\n     strGR = Sheets(\"[TableSheet]\").Range(\"F\" &amp; i)\r\n\r\n     Sheets(strName).Range(\"A\" &amp; i) = strDB\r\n     Sheets(strName).Range(\"B\" &amp; i) = strName\r\n     Sheets(strName).Range(\"C\" &amp; i) = strDate\r\n     Sheets(strName).Range(\"D\" &amp; i) = strHour\r\n     Sheets(strName).Range(\"E\" &amp; i) = strMin\r\n     Sheets(strName).Range(\"F\" &amp; i) = strGR\r\nNext</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I need to sort by column B. Whenever I run it I keep getting a runtime error '9' Subscript out of range. I know what this means but I can't find where I went wrong in the code.</p>\n"}], "owner": {"reputation": 17, "user_id": 3525049, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/614448508/picture?type=large", "display_name": "Matthew Cremona", "link": "https://stackoverflow.com/users/3525049/matthew-cremona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1264, "favorite_count": 0, "accepted_answer_id": 31170980, "answer_count": 2, "score": 0, "last_activity_date": 1435814860, "creation_date": 1435780282, "last_edit_date": 1435814860, "question_id": 31170428, "link": "https://stackoverflow.com/questions/31170428/excel-vba-to-copy-list-to-new-worksheet", "title": "Excel VBA to copy list to new worksheet", "body": "<p>I have a list in Excel containing details of people This contains City, Address and name</p>\n\n<p>I need to grab the City column and create a worksheet for each city, then copy the data from sheet1 to that new worksheet. </p>\n\n<p>So if for example I have a city named Dublin, I need the macro to create a new worksheet named dublin, go to the list, grab all the cities named dublin, copy and paste them in the dublin worksheet (as well as the other columns of course)</p>\n\n<p>I am using the macro form this link: <a href=\"http://www.mrexcel.com/forum/excel-questions/727407-visual-basic-applications-split-data-into-multiple-worksheets-based-column.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/727407-visual-basic-applications-split-data-into-multiple-worksheets-based-column.html</a> created by mirabeau.</p>\n\n<p>The code is as follows:</p>\n\n<pre><code>Sub columntosheets() \n\nConst sname As String = \"Sheet1\" 'change to whatever starting sheet\nConst s As String = \"A\" 'change to whatever criterion column\nDim d As Object, a, cc&amp;\nDim p&amp;, i&amp;, rws&amp;, cls&amp;\nSet d = CreateObject(\"scripting.dictionary\")\nWith Sheets(sname)\n    rws = .Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n    cls = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n    cc = .Columns(s).Column\nEnd With\nFor Each sh In Worksheets\n    d(sh.Name) = 1\nNext sh\n\nApplication.ScreenUpdating = False\nWith Sheets.Add(after:=Sheets(sname))\n    Sheets(sname).Cells(1).Resize(rws, cls).Copy .Cells(1)\n    .Cells(1).Resize(rws, cls).Sort .Cells(cc), 2, Header:=xlYes\n    a = .Cells(cc).Resize(rws + 1, 1)\n    p = 2\n    For i = 2 To rws + 1\n        If a(i, 1) &lt;&gt; a(p, 1) Then\n            If d(a(p, 1)) &lt;&gt; 1 Then\n                Sheets.Add.Name = a(p, 1)\n                .Cells(1).Resize(, cls).Copy Cells(1)\n                .Cells(p, 1).Resize(i - p, cls).Copy Cells(2, 1)\n            End If\n            p = i\n        End If\n    Next i\n    Application.DisplayAlerts = False\n    .Delete\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\nEnd With\nSheets(sname).Activate\n\nEnd Sub\n</code></pre>\n\n<p>The above is able to create worksheets for each city, but doesn't copy the data into the newly created worksheets. How can this be done? I have very limited knowledge of VBA and am totally lost on this.</p>\n"}, {"tags": ["vba", "excel", "fonts", "outlook"], "comments": [{"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "reply_to_user": {"reputation": 12348, "user_id": 64046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a86a311e34d94a802e8bf88e2807ede3?s=128&d=identicon&r=PG", "display_name": "JasonMArcher", "link": "https://stackoverflow.com/users/64046/jasonmarcher"}, "edited": false, "score": 0, "creation_date": 1435845775, "post_id": 31170346, "comment_id": 50378786, "body": "@JasonMArcher  Thanks for the save!  Looks like I missed a few things."}], "answers": [{"comments": [{"owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "edited": false, "score": 0, "creation_date": 1435869056, "post_id": 31170532, "comment_id": 50392916, "body": "My line <code>OutMail.SendUsingAccount = &quot;myname@account.com&quot;</code> does seem to be doing what it should."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1435780653, "creation_date": 1435780653, "answer_id": 31170532, "question_id": 31170346, "link": "https://stackoverflow.com/questions/31170346/vba-change-outlook-from-and-font-size/31170532#31170532", "title": "VBA: Change Outlook &quot;From&quot; and font size", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869311(v=office.15).aspx\" rel=\"nofollow\">SendUsingAccount</a> property of the MailItem class allows to set an Account object that represents the account under which the MailItem is to be sent. For example:</p>\n\n<pre><code> Sub SendUsingAccount() \n  Dim oAccount As Outlook.account  \n  For Each oAccount In Application.Session.Accounts \n  If oAccount.AccountType = olPop3 Then  \n   Dim oMail As Outlook.MailItem  \n   Set oMail = Application.CreateItem(olMailItem)  \n   oMail.Subject = \"Sent using POP3 Account\"  \n   oMail.Recipients.Add (\"someone@example.com\")  \n   oMail.Recipients.ResolveAll  \n   oMail.SendUsingAccount = oAccount  \n   oMail.Send  \n  End If  \n Next  \nEnd Sub \n</code></pre>\n\n<p>Try to use the Word object model to change the font size in emails. See <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a> for more information. </p>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 1, "last_activity_date": 1435886081, "last_edit_date": 1495542586, "creation_date": 1435886081, "answer_id": 31197052, "question_id": 31170346, "link": "https://stackoverflow.com/questions/31170346/vba-change-outlook-from-and-font-size/31197052#31197052", "title": "VBA: Change Outlook &quot;From&quot; and font size", "body": "<p>SentOnBehalfOfName is a little tricky. See here where it works when it precedes Display. <a href=\"https://stackoverflow.com/questions/26432256/sentonbehalfof-not-working-in-excel-2010-vba-code\">SentOnBehalfOf not working in Excel 2010 VBA Code</a></p>\n\n<p>You can use \"style=font-size:11pt\" as described here <a href=\"https://stackoverflow.com/questions/22200910/change-html-email-body-font-type-and-size-in-vba\">Change HTML email body font type and size in VBA</a></p>\n"}], "owner": {"reputation": 444, "user_id": 4730778, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/698ec16b61164c94aee6a20da396f0f3?s=128&d=identicon&r=PG&f=1", "display_name": "Tawm", "link": "https://stackoverflow.com/users/4730778/tawm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5704, "favorite_count": 0, "accepted_answer_id": 31197052, "answer_count": 2, "score": 0, "last_activity_date": 1435886081, "creation_date": 1435779959, "last_edit_date": 1435853025, "question_id": 31170346, "link": "https://stackoverflow.com/questions/31170346/vba-change-outlook-from-and-font-size", "title": "VBA: Change Outlook &quot;From&quot; and font size", "body": "<p>I'm trying to send an Outlook email from VBA Excel.  I've got everything declared correctly, as far as I can tell.  I'm having issues with changing the sender and the font size.</p>\n\n<p>The from is a secondary email, also on Outlook, which I have access to.\nThe font issue is that I can't seem to achieve font size 11 when using the below code.</p>\n\n<hr>\n\n<p><strong>Sender:</strong></p>\n\n<pre><code>With OutMail\n        .Display\n        .Sender = \"someone@example.com\"\n        '.SentOnBehalfOfName = \"someoneelse@example.com\"\n        .To = origintext\n        .Subject = \"Location Verification\"\n\n        .BodyFormat = 2 'olFormatHTML\n        .HTMLBody = fMsg &amp; fMsg2 &amp; fMsg3 &amp; signature\n        '.Body = signature\n\n        .Display\nEnd With\n</code></pre>\n\n<p>Where <code>fMsg</code>, <code>fMsg2</code>, and <code>fMsg3</code> are strings. The signature is declared earlier in the code with:</p>\n\n<pre><code>Set OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\nOutMail.Display\nsignature = OutMail.HTMLBody\n</code></pre>\n\n<p>I do this to get the signature as it seems to be impossible to use something such as <code>OutMail.Signature = *Signature1*</code>.</p>\n\n<p>I understand there is an <code>OutMail.SentOnBehalfOf = hello@world.com</code> but that does not seem to work with <code>OutMail.BodyFormat = 2</code> which sets the body to HTML format.</p>\n\n<hr>\n\n<p><strong>Font:</strong></p>\n\n<p>An example of my HTML body is as follows:</p>\n\n<pre><code>fMsg = \"&lt;p&gt;&lt;font face = \"\"Calibri(Body)\"\" font size=\"\"3\"\" color=\"\"black\"\"&gt;Hello,&lt;/font&gt;&lt;/p&gt;\"\n</code></pre>\n\n<p>However, the issue that comes with this is <code>font size=\"\"3\"\"</code> does not actually give font size 3, it gives font size 10.  I'm trying to get to 11.  <code>font size=\"\"4\"\"</code> produces size 13.5.</p>\n\n<hr>\n\n<p><strong>TL;DR:</strong></p>\n\n<p>What's the VBA code to send an Outlook email from my second email account?</p>\n\n<p>What's the VBA code to get font size 11 using HTML format?</p>\n"}, {"tags": ["vba", "excel", "variable-variables"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5071061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2d5a80807d66db99bb95ae5aeea8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Raman", "link": "https://stackoverflow.com/users/5071061/raman"}, "edited": false, "score": 0, "creation_date": 1435960298, "post_id": 31170398, "comment_id": 50430333, "body": "Thanks @Pira! I made it a public function, but I can&#39;t call it in a cell within the worksheet, for some reason."}, {"owner": {"reputation": 46, "user_id": 5042346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e05145b1008f86e36a29ba632d0b6e?s=128&d=identicon&r=PG", "display_name": "Pira", "link": "https://stackoverflow.com/users/5042346/pira"}, "reply_to_user": {"reputation": 13, "user_id": 5071061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2d5a80807d66db99bb95ae5aeea8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Raman", "link": "https://stackoverflow.com/users/5071061/raman"}, "edited": false, "score": 0, "creation_date": 1435972895, "post_id": 31170398, "comment_id": 50432767, "body": "Hi @Raman, are you sure you have used <code>Function</code> instead of <code>Sub</code> as in your question? (You stated that you have very littlt programming experience :)  If you have used <code>Function</code> and it doesnt works, look here: <a href=\"http://stackoverflow.com/questions/12351339/cant-use-vba-functions-in-a-spreadsheet-formula-in-excel-2010\">Can&#39;t use VBA functions in a spreadsheet formula in Excel 2010</a>  (By the way: I think you have to put the second paragraph of your code example into either <code>Sub</code> or <code>Function</code>"}, {"owner": {"reputation": 13, "user_id": 5071061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2d5a80807d66db99bb95ae5aeea8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Raman", "link": "https://stackoverflow.com/users/5071061/raman"}, "edited": false, "score": 0, "creation_date": 1435991036, "post_id": 31170398, "comment_id": 50435760, "body": "Thanks for the tip, @Pira! I changed the code, but I have a new problem (see &quot;UPDATE&quot;). What do you think?"}, {"owner": {"reputation": 46, "user_id": 5042346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e05145b1008f86e36a29ba632d0b6e?s=128&d=identicon&r=PG", "display_name": "Pira", "link": "https://stackoverflow.com/users/5042346/pira"}, "reply_to_user": {"reputation": 13, "user_id": 5071061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2d5a80807d66db99bb95ae5aeea8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Raman", "link": "https://stackoverflow.com/users/5071061/raman"}, "edited": false, "score": 0, "creation_date": 1435998426, "post_id": 31170398, "comment_id": 50437532, "body": "Ok, take a look at my update. I&#39;m sorry, but I have no solution for the recalculation problem..."}, {"owner": {"reputation": 13, "user_id": 5071061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2d5a80807d66db99bb95ae5aeea8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Raman", "link": "https://stackoverflow.com/users/5071061/raman"}, "edited": false, "score": 0, "creation_date": 1436046900, "post_id": 31170398, "comment_id": 50450715, "body": "I tried SUMIF like you said, and it works like a charm; no VBA necessary. Oops, haha. Thank you so much for your help, @Pira!"}], "tags": [], "owner": {"reputation": 46, "user_id": 5042346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e05145b1008f86e36a29ba632d0b6e?s=128&d=identicon&r=PG", "display_name": "Pira", "link": "https://stackoverflow.com/users/5042346/pira"}, "is_accepted": true, "score": 0, "last_activity_date": 1436001203, "last_edit_date": 1436001203, "creation_date": 1435780150, "answer_id": 31170398, "question_id": 31170251, "link": "https://stackoverflow.com/questions/31170251/variable-variables-and-sums-of-them-in-excel-vba/31170398#31170398", "title": "Variable Variables and Sums of Them in Excel VBA", "body": "<p>You are looking for arrays:</p>\n\n<pre><code>Dim varSum(1 To 10) As Variant\n'Access it like this:\nvarSum(i) = xyz\n</code></pre>\n\n<hr>\n\n<p><strong>Updated Answer</strong><br>\nI see several improveable points:  </p>\n\n<ol>\n<li>You are giving <code>i</code> as parameter for your function, but reassign values later. Name your parameter better <code>iPlayer</code> (what I assume it is needed for)  </li>\n<li>You want to calculate the sum for a specific player? Then you dont need an array and calculate the sums for all players.<br>\nEDIT (To be honest: You dont need VBA for this. Take a look at <a href=\"https://support.office.com/en-ca/article/SUMIF-function-169b8c99-c05c-4483-a712-1697a653039b\" rel=\"nofollow\">SUMIF</a>)</li>\n<li>You want to calculate the sum for all players, say one big sum? Then you have to write <code>monopolySum = sum(i)</code> in the last For-Loop.<br>\nEDIT (Here you could use <a href=\"https://support.office.com/en-CA/article/sum-function-043e1c7d-7726-4e80-8f32-07b23e057f89\" rel=\"nofollow\">SUM</a>, but I think you know that)</li>\n<li>You could give the desired range as parameter to the function, so you dont have to set it \"hard\" by the function. Try this <code>Public Function monopolySum(iPlayer As Integer, rngGame As Range) As Variant</code></li>\n<li>The answer for your initial question was correct? Then it should be accepted :)</li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 5071061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2d5a80807d66db99bb95ae5aeea8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Raman", "link": "https://stackoverflow.com/users/5071061/raman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 1, "accepted_answer_id": 31170398, "answer_count": 1, "score": 1, "last_activity_date": 1436001203, "creation_date": 1435779641, "last_edit_date": 1435990820, "question_id": 31170251, "link": "https://stackoverflow.com/questions/31170251/variable-variables-and-sums-of-them-in-excel-vba", "title": "Variable Variables and Sums of Them in Excel VBA", "body": "<p>To alleviate my summer boredom, I decided to try to make an Excel program that keeps track of how much money someone would owe based on properties owned and number of houses on those properties in the board game Monopoly (some new rules I'm experimenting with). I set up the spreadsheet such that every property is in its own row. I want the Excel program to do this:</p>\n\n<p>Let's say you're looking at a cell. Then, For i=1 To 10 (since I doubt more than 10 players in Monopoly is feasible), if the value of the cell to the right is i, then add the value of the cell you're actually looking at to a sum for player i.</p>\n\n<p>Can I generate variables variables sum1, sum2, sum3, ... , sum10? And then can I say something like</p>\n\n<p>sum'i' = sum'i' + cell.Value</p>\n\n<p>within a for loop if the condition in paragraph 2 is met? </p>\n\n<p>UPDATE: I have tried this code, and it works in getting Player 1's sum. However, it gives Player 1's sum for all players, and it's cumbersome to update whenever someone buys new property or upgrades current property (I need to re-type the formula with each update).</p>\n\n<pre><code>Public Function monopolySum(i As Integer) As Variant\n\n   Dim sum(1 To 10) As Variant, rng As Range, cell As Range\n\n    For i = 1 To 10\n        sum(i) = 0\n    Next i\n\n    Set rng = Range(\"C2:C29\")\n\n    For Each cell In rng\n        For i = 1 To 10\n            If cell.Offset(0, 1).Value = i Then\n                sum(i) = sum(i) + cell.Value\n            End If\n        Next i\n    Next cell\n\n    For i = 1 To 10\n        monopolySum = sum\n    Next i\n\nEnd Function\n</code></pre>\n\n<p>Thanks in advance everyone! I have very little experience programming and would greatly appreciate any guidance :)</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1435780084, "creation_date": 1435780084, "answer_id": 31170384, "question_id": 31170078, "link": "https://stackoverflow.com/questions/31170078/text-selected-right-click-event-outlook-2007-vba/31170384#31170384", "title": "Text selected / right click event (Outlook 2007 VBA)", "body": "<p>The Outlook object model doesn't provide anything for that.</p>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 2195860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3fca2f521287cff9aba2da19a1fb6c?s=128&d=identicon&r=PG", "display_name": "JustADude", "link": "https://stackoverflow.com/users/2195860/justadude"}, "edited": false, "score": 0, "creation_date": 1436190568, "post_id": 31170497, "comment_id": 50492448, "body": "Thanks Dmitry. Marking this as the answer as I think it&#39;s the closest I&#39;ll get.   Unfortunately, using Redemption is not an option as this will be distributed team-wide, and I don&#39;t have Administrator access to machines. There&#39;s the registry-free Redemption, which is cool, but I think I should stay away from these kind of workarounds. I&#39;ll have to explore creating a custom menu programmatically on new item select / creating an input box which the user can paste things into, etc."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 115, "user_id": 2195860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3fca2f521287cff9aba2da19a1fb6c?s=128&d=identicon&r=PG", "display_name": "JustADude", "link": "https://stackoverflow.com/users/2195860/justadude"}, "edited": false, "score": 0, "creation_date": 1436202365, "post_id": 31170497, "comment_id": 50500270, "body": "Redemption can be installed in HKCU - it is smart enough to check if HKLM is not accessible. RedemptionLoader is not really a hack, it is essentially COM-system-light - it does exactly what COM does."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 115, "user_id": 2195860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3fca2f521287cff9aba2da19a1fb6c?s=128&d=identicon&r=PG", "display_name": "JustADude", "link": "https://stackoverflow.com/users/2195860/justadude"}, "edited": false, "score": 0, "creation_date": 1436202406, "post_id": 31170497, "comment_id": 50500291, "body": "Keep in mind that Accessibility API is still an option."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1435780526, "creation_date": 1435780526, "answer_id": 31170497, "question_id": 31170078, "link": "https://stackoverflow.com/questions/31170078/text-selected-right-click-event-outlook-2007-vba/31170497#31170497", "title": "Text selected / right click event (Outlook 2007 VBA)", "body": "<p>Outlook Object Model does not expose the preview pane at all. You can get to the Word's Document object in the preview pane using creative window searching and the Accessibility API. </p>\n\n<p>If using <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow\">Redemption</a> is an option, it exposes the <a href=\"http://www.dimastr.com/redemption/SafeExplorer.htm\" rel=\"nofollow\">SafeExplorer</a> object, which has a ReadingPane property. Once you have the Word.Document object, you can read the Document.Application property and use Application.WindowSelectionChange event. Selected text can be accessed using <code>SafeExplorer.ReadingPane.SelText property</code>. Word.Application can be retrieved from <code>SafeExplorer.ReadingPane.WordEditor.Application</code>.</p>\n\n<pre><code> set sExplorer = CreateObject(\"Redemption.SafeExplorer\")\n sExplorer.Item = Application.ActiveExplorer\n MsgBox sExplorer.ReadingPane.SelText\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 2195860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3fca2f521287cff9aba2da19a1fb6c?s=128&d=identicon&r=PG", "display_name": "JustADude", "link": "https://stackoverflow.com/users/2195860/justadude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 31170497, "answer_count": 2, "score": 0, "last_activity_date": 1435780526, "creation_date": 1435779064, "question_id": 31170078, "link": "https://stackoverflow.com/questions/31170078/text-selected-right-click-event-outlook-2007-vba", "title": "Text selected / right click event (Outlook 2007 VBA)", "body": "<p>I'm looking for an event that's raised when a user selects text in the preview pane of an email. E.g. you're viewing an email in the preview pane and select some text. I didn't see anything in the object reference to this effect, but the namespace is so large, it seems like there's always some object somewhere that does exactly what I need, which I'm not aware of.</p>\n\n<p>Overall, what I'd like to do is see if the selected text matches a pattern and if so, insert a sub-menu in the right click menu (the one that says Copy, Who Is, Synonyms, Translate..). Help with this would be appreciated too. I believe the CommandBar is \"text\", but I'm unsure how to go about accessing this via name.</p>\n"}, {"tags": ["excel", "vba", "split", "substring"], "comments": [{"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1435775935, "post_id": 31169009, "comment_id": 50346091, "body": "Can&#39;t you just use For example: <code>strKeepLeft=LEFT(TextToSearch,Mid(TextToSearch,&quot;TL&quot;,3)-1)</code>  Mid finds occurrence of a string in a string so we tell it to start at position 3 (assuming first TL occurrence is always in 1,2 position)... on error, we take the whole TextToSearch string as there is no 2nd TL statement."}, {"owner": {"reputation": 91, "user_id": 5029563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b7c4d47d0efaeab1583c6cabcb14928?s=128&d=identicon&r=PG&f=1", "display_name": "user4888", "link": "https://stackoverflow.com/users/5029563/user4888"}, "reply_to_user": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1435776194, "post_id": 31169009, "comment_id": 50346246, "body": "Looks like it makes sense but I am unsure how to implement it. I tried using <code>set</code> and your code but then am unsure how I would reference it later ... I am new to VBA so I am still unsure of how to call everything @xQbert"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5029563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b7c4d47d0efaeab1583c6cabcb14928?s=128&d=identicon&r=PG&f=1", "display_name": "user4888", "link": "https://stackoverflow.com/users/5029563/user4888"}, "edited": false, "score": 0, "creation_date": 1435777569, "post_id": 31169389, "comment_id": 50347094, "body": "wow beautiful! Thank you @tmh8885 . If you have a second to explain, what do the 3 and the -1 do to make it eliminate those values?"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 91, "user_id": 5029563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b7c4d47d0efaeab1583c6cabcb14928?s=128&d=identicon&r=PG&f=1", "display_name": "user4888", "link": "https://stackoverflow.com/users/5029563/user4888"}, "edited": false, "score": 1, "creation_date": 1435777874, "post_id": 31169389, "comment_id": 50347262, "body": "Sure.  When looking for string &quot;TL&quot; in <code>str</code>, we want to start at 3 to avoid the first instance.  As far as the -1, I edited it to change to -2 instead, it was an oversight on my part.  What it&#39;s doing is finding that second instance of &quot;TL&quot; and excluding it from <code>str</code>.  But we want to exclude more than just from &quot;TL&quot; on, we also want to exclude the space, giving us a trimmed <code>str</code>."}], "tags": [], "owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "is_accepted": true, "score": 1, "last_activity_date": 1435777704, "last_edit_date": 1435777704, "creation_date": 1435776710, "answer_id": 31169389, "question_id": 31169009, "link": "https://stackoverflow.com/questions/31169009/vba-find-second-occurrence-of-substring-tl-and-delete-everything-after/31169389#31169389", "title": "VBA - find second occurrence of substring &quot;TL&quot; and delete everything after", "body": "<p>It looks like you could just redefine str if you find a second \"TL\".  After the line:<br>\n<code>If InStr(str, \"TL\") &gt; 0 Then</code><br>\nadd another IF statement:<br>\n<code>If InStr(3, str, \"TL\") &gt; 0 Then str = Mid(str, 1, Instr(3, str, \"TL\") - 2)</code>  </p>\n\n<p>Then continue with the rest of your code using the new <code>str</code>.</p>\n"}], "owner": {"reputation": 91, "user_id": 5029563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b7c4d47d0efaeab1583c6cabcb14928?s=128&d=identicon&r=PG&f=1", "display_name": "user4888", "link": "https://stackoverflow.com/users/5029563/user4888"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2305, "favorite_count": 0, "accepted_answer_id": 31169389, "answer_count": 1, "score": 1, "last_activity_date": 1435777704, "creation_date": 1435775437, "last_edit_date": 1435775845, "question_id": 31169009, "link": "https://stackoverflow.com/questions/31169009/vba-find-second-occurrence-of-substring-tl-and-delete-everything-after", "title": "VBA - find second occurrence of substring &quot;TL&quot; and delete everything after", "body": "<p><strong>What it does:</strong> I have a section of code which finds a substring TL in a cell, and forces the numbers following it to be of length 6 by adding or deleting 0s immediately following \"TL-\". (ie <code>TL-00072 -&gt; TL-000072</code>, <code>TL-034 -&gt; TL-000034</code>, <code>TL-000000789 -&gt; TL-000789</code>)</p>\n\n<p><strong>What I want it to do:</strong> However, sometimes there are multiple TL values in one cell. I need to find if there is a second occurance of TL, and, if yes, delete that second occurance and everything following it.</p>\n\n<p>Example:</p>\n\n<pre><code>Start:                           Output:\nTL-000789 TL-000187 TL-000773  -&gt;   TL-000789\nTL-000689 TL -000787           -&gt;   TL-000689\nTL-000982 TL - 980819          -&gt;   TL-000982\n</code></pre>\n\n<hr>\n\n<p>This is the attempt at code I have been working on (incorrect and not working) using split (maybe trim would work too?) that would find the second occurence of TL and delete everything after it. Full working code below that.</p>\n\n<p><strong>CURRENT ATTEMPT AT CODE</strong></p>\n\n<pre><code>Dim splitValues As Variant\n        If Str(str, \"TL\" + 1) 'do not know how to get SECOND occurrence\n            splitValues = Split(theValue, \"TL\")\n            theValue = splitValues(0)\n        End If\n</code></pre>\n\n<p><strong>WORKING CODE</strong></p>\n\n<p>[will add new code to beginning] (explanation at top of question)</p>\n\n<p>NOTE: StartSht is the workbook where the values are as well as the code.\n      All values being altered are in column \"C\"</p>\n\n<pre><code>'force length of TL/CT to be 6/4 numbers long, eliminate spaces\n    Dim str As String, ret As String, tmp As String, j As Integer, k As Integer\n    For k = 2 To StartSht.Range(\"C2\").End(xlDown).Row\n        ret = \"\"\n        str = StartSht.Range(\"C\" &amp; k).Value\n        'for TL numbers\n\n ''''''''''''''new code goes here''''''''''''''''''\n\n        If InStr(str, \"TL\") &gt; 0 Then\n            For j = 1 To Len(str)\n                tmp = Mid(str, j, 1)\n                If IsNumeric(tmp) Then ret = ret + tmp\n            Next j\n            'force to 6 numbers if too short; add 0s immediately after \"TL-\"\n            For j = Len(ret) + 1 To 6\n                ret = \"0\" &amp; ret\n            Next j\n            'force to 6 numbers if too long; eliminate 0s immediately after \"TL-\"\n            If Len(ret) &gt; 6 Then\n                Debug.Print Len(ret)\n                For j = Len(ret) To 7 Step -1\n                If Mid(ret, 1, 1) = \"0\" Then\n                    ret = Right(ret, j - 1)\n                End If\n                Next j\n            End If\n            'eliminate superfluous spaces around \"TL-\"\n            ret = \"TL-\" &amp; ret\n            StartSht.Range(\"C\" &amp; k).Value = ret\n        'for CT numbers\n        ElseIf InStr(str, \"CT\") &gt; 0 Then\n            For j = 1 To Len(str)\n                tmp = Mid(str, j, 1)\n                If IsNumeric(tmp) Then ret = ret + tmp\n            Next j\n        'force to 4 numbers if too short; add 0s immediately after \"CT-\"\n        For j = Len(ret) + 1 To 4\n            ret = \"0\" &amp; ret\n        Next j\n        'force to 4 numbers if too long; eliminate 0s immediately after \"CT-\"\n        If Len(ret) &gt; 4 Then\n            Debug.Print Len(ret)\n            For j = Len(ret) To 5 Step -1\n            If Mid(ret, 1, 1) = \"0\" Then\n                ret = Right(ret, j - 1)\n        End If\n        Next j\n    End If\n    'eliminate superfluous spaces around \"CT-\"\n    ret = \"CT-\" &amp; ret\n    StartSht.Range(\"C\" &amp; k).Value = ret\n End If\nNext k\n</code></pre>\n"}, {"tags": ["excel", "vba", "delimiter"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1435780419, "last_edit_date": 1435780419, "creation_date": 1435779241, "answer_id": 31170123, "question_id": 31168860, "link": "https://stackoverflow.com/questions/31168860/join-function-not-working-for-horizontal-ranges/31170123#31170123", "title": "Join function not working for horizontal ranges?", "body": "<pre><code>Join(Application.Transpose(Application.Transpose( _\n      Workbooks(\"Book3\").Sheets(1).Range(\"A1:D1\").value)), \";\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 841, "user_id": 3633799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3c5795e0c55e5c31ed7fa75abc8da5?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/3633799/jane"}, "edited": false, "score": 0, "creation_date": 1435832146, "post_id": 31171167, "comment_id": 50369347, "body": "This is a good answer, but I&#39;d suggest using ElseIf to check that there is a single column:     ElseIf (UBound(arr, 2)) = 1 Then"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 841, "user_id": 3633799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3c5795e0c55e5c31ed7fa75abc8da5?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/3633799/jane"}, "edited": false, "score": 0, "creation_date": 1435833763, "post_id": 31171167, "comment_id": 50370308, "body": "@Jane I went back and forth over whether to test for multiple rows/columns.  As written, it will return a <code>#VALUE!</code> error if there are multiple columns or rows.  I don&#39;t know if that is sufficient for the OP&#39;s purpose, but it is easily changed."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1435782948, "creation_date": 1435782948, "answer_id": 31171167, "question_id": 31168860, "link": "https://stackoverflow.com/questions/31168860/join-function-not-working-for-horizontal-ranges/31171167#31171167", "title": "Join function not working for horizontal ranges?", "body": "<p>As long as you don't run into limits on the number of cells that can be Transposed, you can try a function like this:</p>\n\n<pre><code>Function JoinRange(rg As Range, Optional Delim As String = \" \")\nDim V As Variant\n\nV = rg\nIf UBound(V, 1) = 1 Then 'One Row\n    JoinRange = Join(WorksheetFunction.Index(V, 1, 0), Delim)\nElse\n    JoinRange = Join(WorksheetFunction.Transpose(V), Delim)\nEnd If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 27294, "user_id": 535967, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/02c46fb58177c19c7a1b57f670bddbd1?s=128&d=identicon&r=PG", "display_name": "lisovaccaro", "link": "https://stackoverflow.com/users/535967/lisovaccaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 31170123, "answer_count": 2, "score": 0, "last_activity_date": 1435782948, "creation_date": 1435774979, "last_edit_date": 1435776048, "question_id": 31168860, "link": "https://stackoverflow.com/questions/31168860/join-function-not-working-for-horizontal-ranges", "title": "Join function not working for horizontal ranges?", "body": "<p>I'm want to convert a range to a string with a custom delimiter with the Join function, while this worked for a vertical range I haven't been able to do it for an horizontal one. This what worked for a column/vertical range:</p>\n\n<pre><code>Join(Application.Transpose(Workbooks(\"Book3\").Sheets(1).Range(\"A1:A5\").value), \";\")\n</code></pre>\n\n<p>Now when I try the same with a horizontal range I get the error \"Invalid procedure call or argument\"</p>\n\n<pre><code>Join(Application.Transpose(Workbooks(\"Book3\").Sheets(1).Range(\"A1:D1\").value), \";\")\nJoin(Workbooks(\"Book3\").Sheets(1).Range(\"A1:D1\").value, \";\")\n</code></pre>\n\n<p>How can this be done?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 0, "creation_date": 1435780541, "post_id": 31168612, "comment_id": 50348711, "body": "Try with <code>wsPaste.Range(&quot;F&quot; &amp; j) = &quot;KN Market Rates June 2&quot;</code>.  Maybe when your <code>i</code> is big, you don&#39;t see it in your screen.  And I think it is more consistent with the rest of your code to use <code>j</code> instead."}, {"owner": {"reputation": 1, "user_id": 5070822, "user_type": "registered", "profile_image": "https://graph.facebook.com/1121858611161353/picture?type=large", "display_name": "Thu Anh Diem", "link": "https://stackoverflow.com/users/5070822/thu-anh-diem"}, "reply_to_user": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "edited": false, "score": 1, "creation_date": 1435867678, "post_id": 31168612, "comment_id": 50392214, "body": "Oh. It works! I can&#39;t believe I missed that. Thank you so much!"}], "owner": {"reputation": 1, "user_id": 5070822, "user_type": "registered", "profile_image": "https://graph.facebook.com/1121858611161353/picture?type=large", "display_name": "Thu Anh Diem", "link": "https://stackoverflow.com/users/5070822/thu-anh-diem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448572567, "creation_date": 1435774041, "last_edit_date": 1531161705, "question_id": 31168612, "link": "https://stackoverflow.com/questions/31168612/find-2-values-in-2-columns-paste-the-row-to-the-new-spreadsheet-then-input-dat", "title": "Find 2 values in 2 columns, paste the row to the new spreadsheet, then input data in the next column based on certain conditions", "body": "<p>I tried to find a 2 different values in 2 columns, then paste the entire row to the new spreadsheet. Then based on the row number in the original sheet, I will input different category to the next column in the new spreadsheet. This is the code I have, but somehow I could not get the inputting part right.</p>\n\n<pre><code>Sub CommandButton1_Click()\n\n    Dim strFind As String\n    Dim strFind2 As String\n    Dim i As Long, j As Long\n    Dim wsFind As Worksheet\n    Dim wsPaste As Worksheet\n\n    'Get value to search for\n    strFind = InputBox(\"Please enter the Base Origin:\", \"Enter Value\")\n    strFind2 = InputBox(\"Please enter the Base Destination:\", \"Enter Value\")\n\n    'Create object reference to the current worksheet\n    Set wsFind = ActiveSheet\n\n    'Create a new worksheet with object reference and then rename it\n    Set wsPaste = Worksheets.Add\n    wsPaste.Name = strFind\n    wsPaste.Range(\"A1\") = \"Base Origin\"\n    wsPaste.Range(\"B1\") = \"Base Destination\"\n    wsPaste.Range(\"C1\") = \"20'\"\n    wsPaste.Range(\"D1\") = \"40'\"\n    wsPaste.Range(\"E1\") = \"40'HQ\"\n\n    'Paste starting at row 2 in wsPaste\n    j = 2\n\n    'Start searching from row 2 of wsFind, continue to end of worksheet\n    For i = 2 To wsFind.UsedRange.Rows.Count\n        If wsFind.Range(\"A\" &amp; i) = strFind Then\n        If wsFind.Range(\"B\" &amp; i) = strFind2 Then\n            'Copy row i of wsFind to row j of wsPaste then increment j\n            wsFind.Range(i &amp; \":\" &amp; i).Copy\n            Worksheets(wsPaste.Name).Range(j &amp; \":\" &amp; j).PasteSpecial xlPasteValues\n            If i &lt; 194 Then\n            wsPaste.Range(\"F\" &amp; i) = \"KN Fixed Rates\"\n                Else\n                If i &lt; 386 Then\n                wsPaste.Range(\"F\" &amp; i) = \"KN Market Rates June 2\"\n                    Else\n                    If i &lt; 574 Then\n                    wsPaste.Range(\"F\" &amp; i) = \"Shapiro 6.30.15\"\n                        Else\n                        If i &lt; 825 Then\n                        wsPaste.Range(\"F\" &amp; i) = \"Mode 6.30.15 Revised 3\"\n                        End If\n                    End If\n                End If\n            End If\n            j = j + 1\n        End If\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>When my <code>i</code> is bigger then 194 and smaller than 386, my next column is blank instead of \"<code>KN Market Rates June 2</code>\"</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1435774247, "post_id": 31168532, "comment_id": 50345052, "body": "Make sure the text in $I2 has no spaces or extra parts that may make the reference break.  Use Trim() - <code>=VLOOKUP(trim($A2),INDIRECT($I2 &amp; &quot;!$A:$P&quot;),11,FALSE)</code>"}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 0, "creation_date": 1435774426, "post_id": 31168532, "comment_id": 50345143, "body": "I don&#39;t know what your data looks like, but keep in mind that vlookup only functions left to right. If your &quot;lookup ID&quot; is to the right of the value that you are looking up, your function will not work."}, {"owner": {"reputation": 17, "user_id": 4663699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f27b7bb42b4170df453c309089bb584?s=128&d=identicon&r=PG&f=1", "display_name": "caldrop", "link": "https://stackoverflow.com/users/4663699/caldrop"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1435775215, "post_id": 31168532, "comment_id": 50345667, "body": "@user3578951, there are no leading or trailing spaces so I don&#39;t think trim would work"}, {"owner": {"reputation": 17, "user_id": 4663699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f27b7bb42b4170df453c309089bb584?s=128&d=identicon&r=PG&f=1", "display_name": "caldrop", "link": "https://stackoverflow.com/users/4663699/caldrop"}, "reply_to_user": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 1, "creation_date": 1435775267, "post_id": 31168532, "comment_id": 50345697, "body": "@Dr.Trey the first parameter for the VLOOKUP is in Column A, and I&#39;m trying to return the info in Column K, so I should be ok with that. Thanks though!"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4663699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f27b7bb42b4170df453c309089bb584?s=128&d=identicon&r=PG&f=1", "display_name": "caldrop", "link": "https://stackoverflow.com/users/4663699/caldrop"}, "edited": false, "score": 0, "creation_date": 1435775180, "post_id": 31168659, "comment_id": 50345643, "body": "You&#39;re correct in that there are spaces in the sheet name, didn&#39;t think of that! However, the code still isn&#39;t working for some reason. I&#39;ll keep playing with it and let you know if I can figure it out. Someone else recommended using trim, but there are no leading or trailing spaces, just spaces in between first and last name, so I think you&#39;re on the right track with single quotes"}, {"owner": {"reputation": 17, "user_id": 4663699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f27b7bb42b4170df453c309089bb584?s=128&d=identicon&r=PG&f=1", "display_name": "caldrop", "link": "https://stackoverflow.com/users/4663699/caldrop"}, "edited": false, "score": 0, "creation_date": 1435775790, "post_id": 31168659, "comment_id": 50346018, "body": "I know that this code works:  =VLOOKUP($A2,INDIRECT(&quot;&#39;John Smith&#39;&quot; &amp; &quot;!$A:$P&quot;),11,FALSE) I just need to make John Smith reference a cell value"}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "reply_to_user": {"reputation": 17, "user_id": 4663699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f27b7bb42b4170df453c309089bb584?s=128&d=identicon&r=PG&f=1", "display_name": "caldrop", "link": "https://stackoverflow.com/users/4663699/caldrop"}, "edited": false, "score": 0, "creation_date": 1435775990, "post_id": 31168659, "comment_id": 50346122, "body": "So that being said you are getting #REF! error for all managers I assume, because if not then my next bet would be that there are some spelling differences between cells and sheet names, in which case user3578951&#39;s suggestion might be of help as an check for trailling spaces."}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "reply_to_user": {"reputation": 17, "user_id": 4663699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f27b7bb42b4170df453c309089bb584?s=128&d=identicon&r=PG&f=1", "display_name": "caldrop", "link": "https://stackoverflow.com/users/4663699/caldrop"}, "edited": false, "score": 0, "creation_date": 1435776026, "post_id": 31168659, "comment_id": 50346150, "body": "also were you able to check if it is the <code>INDIRECT</code> or <code>VLOOKUP</code> that throws an error?"}, {"owner": {"reputation": 17, "user_id": 4663699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f27b7bb42b4170df453c309089bb584?s=128&d=identicon&r=PG&f=1", "display_name": "caldrop", "link": "https://stackoverflow.com/users/4663699/caldrop"}, "edited": false, "score": 0, "creation_date": 1435776198, "post_id": 31168659, "comment_id": 50346248, "body": "It&#39;s the INDIRECT that is giving me an error. I know because the vlookup works fine when I put the name in single quotes and join it to &quot;!$A:$P&quot;"}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "reply_to_user": {"reputation": 17, "user_id": 4663699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f27b7bb42b4170df453c309089bb584?s=128&d=identicon&r=PG&f=1", "display_name": "caldrop", "link": "https://stackoverflow.com/users/4663699/caldrop"}, "edited": false, "score": 0, "creation_date": 1435776311, "post_id": 31168659, "comment_id": 50346321, "body": "Ok I didn&#39;t catch that from your previous message, I&#39;ll try to think of what else might go wrong."}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "reply_to_user": {"reputation": 17, "user_id": 4663699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f27b7bb42b4170df453c309089bb584?s=128&d=identicon&r=PG&f=1", "display_name": "caldrop", "link": "https://stackoverflow.com/users/4663699/caldrop"}, "edited": false, "score": 0, "creation_date": 1435776809, "post_id": 31168659, "comment_id": 50346613, "body": "Check following question to see if your sheets don&#39;t break any of the follwoing rules. <a href=\"http://stackoverflow.com/questions/451452/valid-characters-for-excel-sheet-names\" title=\"valid characters for excel sheet names\">stackoverflow.com/questions/451452/&hellip;</a>"}, {"owner": {"reputation": 17, "user_id": 4663699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f27b7bb42b4170df453c309089bb584?s=128&d=identicon&r=PG&f=1", "display_name": "caldrop", "link": "https://stackoverflow.com/users/4663699/caldrop"}, "edited": false, "score": 0, "creation_date": 1435777388, "post_id": 31168659, "comment_id": 50346975, "body": "I&#39;ve also tried using CONCATENATE(I2, &quot;$A:$P) as the second parameter in the VLOOKUP function but with that I just get #VALUE!"}, {"owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "reply_to_user": {"reputation": 17, "user_id": 4663699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f27b7bb42b4170df453c309089bb584?s=128&d=identicon&r=PG&f=1", "display_name": "caldrop", "link": "https://stackoverflow.com/users/4663699/caldrop"}, "edited": false, "score": 0, "creation_date": 1435777902, "post_id": 31168659, "comment_id": 50347282, "body": "could you give us maybe a little sample of the manager names that you have? maybe mix the first names with last name to maintain their privacy. It just sounds to me that their names are not valid for sheet names or something."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1435779610, "post_id": 31168659, "comment_id": 50348208, "body": "One suggestion - temporarily rename a spreadsheet to something like &quot;THIS&quot;.  Then set the cell you want to point INDIRECT to do &quot;THIS&quot;.  That should at least let you know if it&#39;s an error caused by punctuation (spaces, etc.) or if it&#39;s a formula issue."}, {"owner": {"reputation": 17, "user_id": 4663699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f27b7bb42b4170df453c309089bb584?s=128&d=identicon&r=PG&f=1", "display_name": "caldrop", "link": "https://stackoverflow.com/users/4663699/caldrop"}, "edited": false, "score": 0, "creation_date": 1435780060, "post_id": 31168659, "comment_id": 50348440, "body": "Thanks all for the help! I found a workaround. I created a new column that used a formula to isolate the last word in Column I, which was, in this case, the last name of the Manager. All of the other sheets are titled with the last name of the Manager, so I directed the Indirect column to the new last name column instead of Column I"}], "tags": [], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "is_accepted": true, "score": 3, "last_activity_date": 1435776168, "last_edit_date": 1435776168, "creation_date": 1435774210, "answer_id": 31168659, "question_id": 31168532, "link": "https://stackoverflow.com/questions/31168532/complex-vlookup-with-dynamic-sheet-name/31168659#31168659", "title": "Complex VLOOKUP with dynamic sheet name", "body": "<p>I can't see your spreadsheet but if your sheets are named after managers I am willing to bet that those sheet names have some kind of character( like space) that forces referencing sheets in single quotes.</p>\n\n<p>Assuming that is correct simply change your formula to:</p>\n\n<p><code>=VLOOKUP($A2,INDIRECT(\"'\" &amp; $I2 &amp; \"'!$A:$P\"),11,FALSE)</code></p>\n\n<p>Also you can diagnose this issue with \"Evaluate Formula\" located in \"Formulas>Formula Auditing\", in there step through all steps that this formula has, and note when does that error shows up.</p>\n"}], "owner": {"reputation": 17, "user_id": 4663699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f27b7bb42b4170df453c309089bb584?s=128&d=identicon&r=PG&f=1", "display_name": "caldrop", "link": "https://stackoverflow.com/users/4663699/caldrop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2715, "favorite_count": 0, "accepted_answer_id": 31168659, "answer_count": 1, "score": 0, "last_activity_date": 1435776168, "creation_date": 1435773778, "last_edit_date": 1435774165, "question_id": 31168532, "link": "https://stackoverflow.com/questions/31168532/complex-vlookup-with-dynamic-sheet-name", "title": "Complex VLOOKUP with dynamic sheet name", "body": "<p>I'm trying to perform a vlookup across multiple sheets in an elegant way, rather than with a vlookup nested in an IF function.</p>\n\n<p>Column A has the account number and Column I has the manager responsible for that account. Each Manager has their own sheet. I was hoping to make vlookup look at a specific manager's sheet, find the account number in Column A, and return the info in Column K. I tried to use INDIRECT to make it do that:</p>\n\n<pre><code>=VLOOKUP($A2,INDIRECT($I2 &amp; \"!$A:$P\"),11,FALSE)\n</code></pre>\n\n<p>With this code, I keep getting #REF instead of what is in Column K in the manager's sheet. How can I fix this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "is_accepted": true, "score": 1, "last_activity_date": 1435774041, "creation_date": 1435774041, "answer_id": 31168611, "question_id": 31168407, "link": "https://stackoverflow.com/questions/31168407/using-xlup-to-count-rows-in-a-named-column/31168611#31168611", "title": "Using xlUp to count rows in a named Column", "body": "<pre><code>f_liens.Cells(Rows.Count, Range(\"col_pc\").Column).End(xlUp).row\n</code></pre>\n"}], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 31168611, "answer_count": 1, "score": 0, "last_activity_date": 1435780593, "creation_date": 1435773349, "question_id": 31168407, "link": "https://stackoverflow.com/questions/31168407/using-xlup-to-count-rows-in-a-named-column", "title": "Using xlUp to count rows in a named Column", "body": "<p>It is very easy to know the last row in which a cell has a value by using</p>\n\n<pre><code>f_liens.Cells(Rows.Count, \"A\").End(xlUp).row\n</code></pre>\n\n<p>However, when using the assigned column names instead of the letters, I get a error. Here is what I want to do, but I get errors:</p>\n\n<pre><code> f_liens.Cells(Rows.Count, \"col_pc\").End(xlUp).row\n</code></pre>\n\n<p>I am pretty sure, once I know how to make it work, i will then be able to use</p>\n\n<pre><code>f_liens.Cells(Rows.Count, \"col_\" &amp; strtype ).End(xlUp).row\n</code></pre>\n\n<p>Where strType will depend on previous code. </p>\n\n<p>Does anyone know how to refer to the last entry in a named column? If not this way, I'll accept any other working way.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 73682, "user_id": 2097240, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/JskU5.jpg?s=128&g=1", "display_name": "Daniel M&#246;ller", "link": "https://stackoverflow.com/users/2097240/daniel-m%c3%b6ller"}, "is_accepted": true, "score": 0, "last_activity_date": 1435773276, "creation_date": 1435773276, "answer_id": 31168392, "question_id": 31168303, "link": "https://stackoverflow.com/questions/31168303/vba-run-as-query-in-a-sheet-of-the-same-book/31168392#31168392", "title": "VBA: Run as query in a Sheet of the same Book", "body": "<p>I suggest the <code>sumif</code> forumla. (So, you don't need a macro for that):</p>\n\n<pre><code>=SUMIF(B2:B8;\"BBBBBB\";A2:A8)\n</code></pre>\n\n<p>This sums the numbers in A2 to A8 if the mathching rown in B2 to B8 contains \"BBBBBB\"</p>\n"}], "owner": {"reputation": 117, "user_id": 2977500, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8fa402309d6f3dd0d5e47bc2b2b4fc07?s=128&d=identicon&r=PG&f=1", "display_name": "user2977500", "link": "https://stackoverflow.com/users/2977500/user2977500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 31168392, "answer_count": 1, "score": 0, "last_activity_date": 1435814933, "creation_date": 1435772949, "last_edit_date": 1435814933, "question_id": 31168303, "link": "https://stackoverflow.com/questions/31168303/vba-run-as-query-in-a-sheet-of-the-same-book", "title": "VBA: Run as query in a Sheet of the same Book", "body": "<p>I have a macro in file, and what I need to do is to run a query in it, as it was a SQL table, or find a similar code in VBA. Almost everything I found about it, was about running a query in Access database using VBA in an Excel file.</p>\n\n<p>In my file I have a Sheet that I need to use as database, and a second Sheet that need to show some information when I run a macro. Imagine that I have a sheet like this:</p>\n\n<pre><code>|Number|Field1|\n|  5   |AAAAAA|\n|  4   |BBBBBB|\n|  8   |CCCCCC|\n|  3   |AAAAAA|\n|  4   |BBBBBB|\n|  2   |AAAAAA|\n|  1   |CCCCCC|\n</code></pre>\n\n<p>This query should sum only the numbers where Field1 has a determined value, and should sum all the lines in the sheet. The number of lines vary depending the day.</p>\n\n<p>Is it possible to do something like this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1435772628, "post_id": 31168031, "comment_id": 50344147, "body": "OK. What is your question? What&#39;s wrong with your code? Why do you call explorer app?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5070674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8633d0091c76c83e67ac0907001a3dc9?s=128&d=identicon&r=PG&f=1", "display_name": "mcpepster", "link": "https://stackoverflow.com/users/5070674/mcpepster"}, "edited": false, "score": 0, "creation_date": 1435868473, "post_id": 31171422, "comment_id": 50392641, "body": "Worked perfectly. This solved another issue I was having where I couldn&#39;t use Set/With on pivot tables using .Cells().Formula = .Cells().Value. Thanks for your help! Much appreciated"}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": true, "score": 0, "last_activity_date": 1435783825, "creation_date": 1435783825, "answer_id": 31171422, "question_id": 31168031, "link": "https://stackoverflow.com/questions/31168031/splitting-and-hardcoding-worksheets-containing-pivot-tables/31171422#31171422", "title": "Splitting and Hardcoding worksheets containing pivot tables", "body": "<p>You already have the code looping through the sheets of your workbook so you do not need to copy from the <code>ActiveSheet</code> but from the <code>ws</code> worksheet variable.</p>\n\n<p>You also do not need to use <code>Select</code> to get data copied.</p>\n\n<pre><code>Dim ws As Worksheet\nDim newBook As Workbook\nFor Each ws In ThisWorkbook.Worksheets\n    ws.UsedRange.Copy\n    Set newBook = Workbooks.Add\n    With newBook.Worksheets(1).Range(\"A1\")\n        .PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n        .PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n            SkipBlanks:=False, Transpose:=False\n    End With\n    newBook.SaveAs Path &amp; ws.Name, Excel.XlFileFormat.xlOpenXMLWorkbook\n    newBook.Close SaveChanges:=False\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5070674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8633d0091c76c83e67ac0907001a3dc9?s=128&d=identicon&r=PG&f=1", "display_name": "mcpepster", "link": "https://stackoverflow.com/users/5070674/mcpepster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 31171422, "answer_count": 1, "score": 0, "last_activity_date": 1435783825, "creation_date": 1435772015, "question_id": 31168031, "link": "https://stackoverflow.com/questions/31168031/splitting-and-hardcoding-worksheets-containing-pivot-tables", "title": "Splitting and Hardcoding worksheets containing pivot tables", "body": "<p>I am new to using VBA code. I have a workbook with manually created tables as well as pivot tables. For each worksheet in this book, I want to hard-code the data into a new workbook and save it as the name of the worksheet that is being hard-coded. I have the code below. It is saving each workbook properly, but the contents of the workbook are not correct. It is hard-coding the contents of the first worksheet in my original workbook every time. I've tried to set the next ActiveSheet at the end of the code but it fails. Did I mention I am not a programmer? Please help! </p>\n\n<pre><code>Sub Splitbook()\n\nDim path As String\nDim dt As String\npath = CreateObject(\"WScript.Shell\").specialfolders(\"Desktop\") &amp; \"\\SLF\\ \"\nCall Shell(\"explorer.exe\" &amp; \" \" &amp; path, vbNormalFocus)\n\nDim ws As Worksheet\nFor Each ws In ThisWorkbook.Worksheets \n    ActiveSheet.UsedRange.Select\n    Selection.Copy\n    Workbooks.Add\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    ActiveWorkbook.SaveAs path &amp; ws.Name, Excel.XlFileFormat.xlOpenXMLWorkbook\n    ActiveWorkbook.Close SaveChanges:=False\nNext ws\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 1, "creation_date": 1435772654, "post_id": 31168028, "comment_id": 50344160, "body": "Isn&#39;t there a .ListCount property you could use?"}, {"owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1435850051, "post_id": 31168028, "comment_id": 50381866, "body": "There is! And it does the job! Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1435803976, "post_id": 31168518, "comment_id": 50356681, "body": "I upvoted this, but I&#39;d change your counter to a <code>Long</code> as a ComboBox can have more than 32k items."}, {"owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "edited": false, "score": 0, "creation_date": 1435843911, "post_id": 31168518, "comment_id": 50377341, "body": "Amazing! .ListCount was what I was after! Cheers!"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 1, "last_activity_date": 1435823384, "last_edit_date": 1435823384, "creation_date": 1435773735, "answer_id": 31168518, "question_id": 31168028, "link": "https://stackoverflow.com/questions/31168028/how-can-i-use-vba-to-tell-if-an-active-x-combobox-on-an-excel-sheet-has-an-a-lis/31168518#31168518", "title": "How can I use vba to tell if an Active X combobox on an excel sheet has an a list", "body": "<p>The following code with check if there are items in the ComboBox1 and list all the items it finds:</p>\n\n<pre><code>Dim lngRow As Long\n\nIf ComboBox1.ListCount &gt; 0 Then\n    For lngRow = 0 To ComboBox1.LineCount - 1\n        Debug.Print ComboBox1.List(lngRow , 0)\n    Next intRow\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 31168518, "answer_count": 1, "score": 0, "last_activity_date": 1435823384, "creation_date": 1435772004, "question_id": 31168028, "link": "https://stackoverflow.com/questions/31168028/how-can-i-use-vba-to-tell-if-an-active-x-combobox-on-an-excel-sheet-has-an-a-lis", "title": "How can I use vba to tell if an Active X combobox on an excel sheet has an a list", "body": "<p>How can I use vba to tell if an Active X combobox on an excel sheet has a list with items in it.</p>\n\n<p>The following returns an error if the combobox has nothing in it's list:</p>\n\n<pre><code>if UBound(MyComboBox.List, 1) &gt; 1 then\n</code></pre>\n\n<p>and the following returns an error if there are items in the list:</p>\n\n<pre><code>if MyComboBox.List &lt;&gt; Null then\n</code></pre>\n\n<p>Cheers!</p>\n\n<p>Oliver.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1435784391, "post_id": 31167814, "comment_id": 50350840, "body": "What formatting gets lost? Copying the whole sheet normally keeps all the formats intact."}, {"owner": {"reputation": 197, "user_id": 2438237, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/731ace4390a70f831c8c8b24b9f766c5?s=128&d=identicon&r=PG", "display_name": "user2438237", "link": "https://stackoverflow.com/users/2438237/user2438237"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1435784634, "post_id": 31167814, "comment_id": 50350990, "body": "@ChipsLetten  Formatting like the header color gets chaged"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 1, "creation_date": 1435784930, "post_id": 31167814, "comment_id": 50351162, "body": "Gets changed? So it goes from yellow to blue for example? That sounds like you need to copy the Theme from the source workbook as well as the sheets. Take a look at <a href=\"http://stackoverflow.com/a/17911701/4243498\">this answer</a>"}], "owner": {"reputation": 197, "user_id": 2438237, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/731ace4390a70f831c8c8b24b9f766c5?s=128&d=identicon&r=PG", "display_name": "user2438237", "link": "https://stackoverflow.com/users/2438237/user2438237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1435772593, "creation_date": 1435771214, "last_edit_date": 1435772593, "question_id": 31167814, "link": "https://stackoverflow.com/questions/31167814/use-paste-special-in-excel-macro-while-copying-multiple-workbooks-in-one-master", "title": "Use Paste special in excel macro while copying multiple workbooks in one master workbook", "body": "<p>I am trying to use a macro to copy multiple workbooks into one integrated workbook. I am able to do it; however I am not finding a way to use paste special to kee the formatting of source worksheets intact. I would really appreciate if someone could please help/guide</p>\n\n<p>here is the code:</p>\n\n<pre><code>Sub GetSheets()\nPath = \"C:\\Users\\ssehgal\\Documents\\Excel-Files-For-Macro\\\"\nFilename = Dir(Path &amp; \"*.xls\")\n  Do While Filename &lt;&gt; \"\"\n  Workbooks.Open Filename:=Path &amp; Filename, ReadOnly:=True\n     For Each Sheet In ActiveWorkbook.Sheets\n     Sheet.Copy After:=ThisWorkbook.Sheets(1)\n  Next Sheet\n     Workbooks(Filename).Close\n     Filename = Dir()\n  Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5050173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c4606540ef587db55a240d0b6c4a16?s=128&d=identicon&r=PG&f=1", "display_name": "topher", "link": "https://stackoverflow.com/users/5050173/topher"}, "edited": false, "score": 0, "creation_date": 1435778295, "post_id": 31168401, "comment_id": 50347473, "body": "Thanks, I was able to find what I was looking for in terms of referencing our public inbox and was able to figure out the rest from there."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1435773326, "creation_date": 1435773326, "answer_id": 31168401, "question_id": 31167748, "link": "https://stackoverflow.com/questions/31167748/creating-folders-in-outlook-2010/31168401#31168401", "title": "Creating folders in Outlook 2010", "body": "<p>Well, I'd suggest starting from the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article in MSDN to learn the basics. From the Outlook object model there is no difference where the folder is located. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff862204(v=office.15).aspx\" rel=\"nofollow\">Add</a> method of the Folders class creates a new folder in the Folders collection.</p>\n\n<p>You may use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff864790(v=office.15).aspx\" rel=\"nofollow\">Stores</a> property of the Namespace class which returns a Stores collection object that represents all the Store objects in the current profile. Also the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869575(v=office.15).aspx\" rel=\"nofollow\">GetSharedDefaultFolder</a> method of the Namespace class returns a Folder object that represents the specified default folder for the specified user.</p>\n"}], "owner": {"reputation": 35, "user_id": 5050173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9c4606540ef587db55a240d0b6c4a16?s=128&d=identicon&r=PG&f=1", "display_name": "topher", "link": "https://stackoverflow.com/users/5050173/topher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 31168401, "answer_count": 1, "score": 0, "last_activity_date": 1593516865, "creation_date": 1435770959, "last_edit_date": 1593516865, "question_id": 31167748, "link": "https://stackoverflow.com/questions/31167748/creating-folders-in-outlook-2010", "title": "Creating folders in Outlook 2010", "body": "<p>I have a folder containing many subfolders on my desktop that I need to recreate in outlook 2010. The folders are empty and I have it as a template. There is something like 400 folders so I am trying to avoid manually creating every one of them in outlook.</p>\n\n<p>The issue I have is that these folders aren't being put under my inbox, they are going to be created under a common mailbox accessible by my coworkers. We are using this for archiving purposes. Most of the codes I have found are for creating folders under your inbox.</p>\n\n<p>How would I go about recreating the directory under this public mailbox? I have very little experience in VBA programming. I also have all the folder names in excel if that makes it any easier to accomplish this.</p>\n\n<p>Thanks in advance for any help.</p>\n"}, {"tags": ["vba", "excel", "messagebox", "msgbox"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1435771122, "post_id": 31167698, "comment_id": 50343381, "body": "what are these <code>TextBox1AM180</code> things that they have a <code>Value</code> property?  Are you sure this is VB.NET?  The event signature looks like VB6.  Whatever the case, it seems unlikely that .Value could be both number (<code>...&gt;12000</code>) and string (<code>...&lt;&gt; &quot;&quot;</code>)"}, {"owner": {"reputation": 152, "user_id": 2788820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0e355b5aa0b43621c8a09c9b9cbbe6a?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/2788820/jay"}, "edited": false, "score": 0, "creation_date": 1435771380, "post_id": 31167698, "comment_id": 50343540, "body": "NB i think you are comparing strings and integers TextBox1AM180.Value &gt; 12000 And TextBox1AM180.Value &lt;&gt; &quot;&quot;"}, {"owner": {"reputation": 1053, "user_id": 4815352, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/l4JDS.png?s=128&g=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/4815352/josh"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1435773453, "post_id": 31167698, "comment_id": 50344615, "body": "As @Plutonix pointed out, this does not appear to be VB.NET. The context and comparisons of strings to integers lead me to believe this is an Excel VBA Macro. An Excel cell value <i>can</i> hold a string/integer/etc. and using this property as @Kate does is valid, but not best practice; it is generally preferable to use .Text for strings because an empty cell has a value of 0 but a text of &quot;&quot;. Anyway, I don&#39;t see anything causing the extra message boxes in this code. Do you also have a worksheet_change sub that displays one? If so, you trigger it 4 times in your <code>With Range(&quot;B4&quot;)</code> block."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1435774839, "post_id": 31167698, "comment_id": 50345403, "body": "You are getting all the message boxes because your code is triggering those lines.  It&#39;s not clear from your question why you would expect something different to happen?  What is the distinction between <code>first pass</code> and <code>checking a formula...</code>?  @Plutonix, this is Excel VBA... I updated the tags.  <code>Range</code> and <code>Offset</code> give it away that this is Excel specific"}, {"owner": {"reputation": 11, "user_id": 5070636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a8d9410fb8478ae0613b6aa458e8c29?s=128&d=identicon&r=PG&f=1", "display_name": "Kate", "link": "https://stackoverflow.com/users/5070636/kate"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435779362, "post_id": 31167698, "comment_id": 50348063, "body": "@byron Sorry for the confusion, my issue is with the code: { If Range(&quot;MaxSpeed1&quot;).Value &gt; 30 Then MsgBox } I&#39;m having to click ok on the same message boxes 5 times and I only want it to pop up once"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 2, "creation_date": 1435779815, "post_id": 31167698, "comment_id": 50348322, "body": "You should only see it once unless you have other events in place that would trigger this code or other code.  Do you have other events in play that we cannot see?  Like <code>Worksheet_Change</code>?  If not, what happens if you add a breakpoint to the line below <code>With Range...</code> and use F8 to step through?  How many times do you arrive at the <code>MsgBox</code> code before it hits an <code>Exit Sub</code>?  Does the execution of the code go somewhere unexpected while stepping through?"}, {"owner": {"reputation": 11, "user_id": 5070636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a8d9410fb8478ae0613b6aa458e8c29?s=128&d=identicon&r=PG&f=1", "display_name": "Kate", "link": "https://stackoverflow.com/users/5070636/kate"}, "edited": false, "score": 0, "creation_date": 1435780078, "post_id": 31167698, "comment_id": 50348449, "body": "I do have Worksheet_Calculate, how do I need to get around this? The msgbox comes up 5 times."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1435795393, "post_id": 31167698, "comment_id": 50354817, "body": "Unrelated, but I&#39;d move the validation code to the Textbox events."}], "answers": [{"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 1, "last_activity_date": 1435802171, "creation_date": 1435802171, "answer_id": 31174478, "question_id": 31167698, "link": "https://stackoverflow.com/questions/31167698/msgbox-appears-multiple-times-after-data-is-pulled-from-a-sheet/31174478#31174478", "title": "MsgBox appears multiple times after data is pulled from a sheet", "body": "<p>Use the <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff821508.aspx\" rel=\"nofollow\">Application.EnableEvents property</a> to temporarily disable events from firing and then re-enable them when you're done.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Application.EnableEvents = False\nWith Range(\"B4\")\n   .Offset(0, 0).Value = Me.TextBox1AM180.Value\n   .Offset(1, 0).Value = Me.TextBox2AM180.Value\n   .Offset(5, 0).Value = Me.TextBox3AM180.Value\n   .Offset(6, 0).Value = Me.TextBox4AM180.Value\n End With\nApplication.EnableEvents = True\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5070636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a8d9410fb8478ae0613b6aa458e8c29?s=128&d=identicon&r=PG&f=1", "display_name": "Kate", "link": "https://stackoverflow.com/users/5070636/kate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1435802171, "creation_date": 1435770838, "last_edit_date": 1435774635, "question_id": 31167698, "link": "https://stackoverflow.com/questions/31167698/msgbox-appears-multiple-times-after-data-is-pulled-from-a-sheet", "title": "MsgBox appears multiple times after data is pulled from a sheet", "body": "<p>I'd like to get some help with the following code. I am very new to this but I think it's an easy solution I'm just unable to retrofit suggestions from other searches into my code.</p>\n\n<p>The msgboxes are working fine on the first pass to check if the text box values are correct but when I am checking to see if a formula result from a sheet is correct I'm getting 5 message boxes popping up.</p>\n\n<p>Hope this makes sense, let me know if you have any suggestions! </p>\n\n<pre><code>`Private Sub SpeedCommand_Click()\n Dim ctl As Control\n\n If TextBox1AM180.Value &gt; 12000 And TextBox1AM180.Value &lt;&gt; \"\" Then\n   MsgBox \"Rate Value is out of range for this boom. Ensure rate value is less than 12,000 lbs./acre\", vbExclamation, \"Main Bin Application Rate\"\n    Me.TextBox1AM180.SetFocus\n   Exit Sub\n End If\n\n If (TextBox2AM180.Value &gt; 120 Or TextBox2AM180.Value &lt; 20) And TextBox2AM180.Value &lt;&gt; \"\" Then\n MsgBox \"Density Value is out of range. Ensure density value is between 20 and 120 lbs./cu ft.\", vbExclamation, \"Main Bin Density\"\n  Me.TextBox2AM180.SetFocus\n  Exit Sub\n End If\n\n If TextBox3AM180.Value &gt; 12000 And TextBox3AM180.Value &lt;&gt; \"\" Then\n  MsgBox \"Rate Value is out of range for this boom. Ensure rate value is less than 12,000 lbs./acre\", vbExclamation, \"Granular Bin Application Rate\"\n  Me.TextBox3AM180.SetFocus\n  Exit Sub\n End If\n\n If (TextBox4AM180.Value &gt; 120 Or TextBox4AM180.Value &lt; 20) And       TextBox4AM180.Value &lt;&gt; \"\" Then\n  MsgBox \"Density Value is out of range. Ensure density value is between 20 and 120 lbs./cu ft.\", vbExclamation, \"Granular Bin Density\"\n  Me.TextBox4AM180.SetFocus\n  Exit Sub\n End If\n\n ' Write data to worksheet\n\n With Range(\"B4\")\n   .Offset(0, 0).Value = Me.TextBox1AM180.Value\n   .Offset(1, 0).Value = Me.TextBox2AM180.Value\n   .Offset(5, 0).Value = Me.TextBox3AM180.Value\n   .Offset(6, 0).Value = Me.TextBox4AM180.Value\n End With\n\n If Range(\"MaxSpeed1\").Value &gt; 30 Then\n     MsgBox \"Based upon rate and density, speed is restricted by machine top end application speed.\"\n  Exit Sub\n End If\n\n If Range(\"MaxSpeed2\").Value &gt; 30 Then\n    MsgBox \"Based upon rate and density, speed is restricted by machine top end application speed.\"\n    Exit Sub\n  End If\n\n ' Hide the form\n frmAirmax.Hide\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5903, "user_id": 790107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4de1c480ed937e9291c4dcbf252e6d1f?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/790107/david"}, "edited": false, "score": 0, "creation_date": 1435770727, "post_id": 31167519, "comment_id": 50343114, "body": "This statement from you seems contradictory:  &quot;The function works nicely except it doesn&#39;t capitalize the first letter of the first word.&quot;  Isn&#39;t &quot;capitalize the first letter of the first word&quot; the same as &quot;first letter of each sentence capitalized&quot;?  How can it work nicely if it fails to perform it&#39;s intended fundamental operation?"}, {"owner": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "reply_to_user": {"reputation": 5903, "user_id": 790107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4de1c480ed937e9291c4dcbf252e6d1f?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/790107/david"}, "edited": false, "score": 0, "creation_date": 1435771027, "post_id": 31167519, "comment_id": 50343315, "body": "Ok, it does have some flaws and I&#39;m looking for assistance in correcting it. Can you help?"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "edited": false, "score": 0, "creation_date": 1435774433, "post_id": 31168257, "comment_id": 50345146, "body": "Paul it still does not capitalize the first letter of the first sentence."}, {"owner": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "edited": false, "score": 0, "creation_date": 1435840161, "post_id": 31168257, "comment_id": 50374585, "body": "i did some testing and came up with another issue.  Your new code capitalizes the first letter of the first sentence but only in a message box not in the cell itself.  Your new code also capitalizes the first letter of each line whether it is the beginning of a sentence or not."}, {"owner": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "edited": false, "score": 0, "creation_date": 1435844788, "post_id": 31168257, "comment_id": 50378005, "body": "I used the following to capitalize the first letter of the first sentence. {If myrange2.Value &lt;&gt; &quot;&quot; Then        For Each myrange2 In Target             myrange2.Value = UCase(Left(myrange2.Value, 1)) &amp; Mid(myrange2.Value, 2)        Next     End If}"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "edited": false, "score": 0, "creation_date": 1435873591, "post_id": 31168257, "comment_id": 50394918, "body": "I&#39;ll test it with ranges, but I have a quick question: a new line is not a new sentence? Can you upload a screen shot highlighting the issue(s)?"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1435879373, "last_edit_date": 1435879373, "creation_date": 1435772806, "answer_id": 31168257, "question_id": 31167519, "link": "https://stackoverflow.com/questions/31167519/excel-vba-sentence-case-funtion-needs-fine-tuning/31168257#31168257", "title": "Excel VBA Sentence Case Funtion Needs Fine Tuning", "body": "<p>I renamed the function to SentenceCase() and made a few more adjustments:</p>\n\n<hr>\n\n<pre><code>Public Function SentenceCase(ByVal str As String) As String\n    Dim regEx As Object, regExM As Object, indx As Object, indxs As Object\n    Set regEx = CreateObject(\"VBScript.RegExp\")\n    str = Replace$(str, vbNullChar, vbLf)\n    str = Replace$(str, vbBack, vbLf)\n    str = LTrim$(LCase$(str))\n    With regEx\n        .IgnoreCase = True\n        .MultiLine = True\n        .Global = True\n        .Pattern = \"(^|[\\n\\f\\r\\t\\v\\.\\!\\?]\\s*)(\\w)\"\n        If .Test(str) Then\n            Set indxs = .Execute(str)\n            For Each indx In indxs\n                Mid$(str, indx.FirstIndex + 1, indx.Length) = UCase$(indx)\n            Next\n        End If\n    End With\n    SentenceCase = str\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>This is what I tested it with:</p>\n\n<pre><code>MsgBox SentenceCase(\" UPPER CASE SENTENCE.\" &amp; _\n                    vbCrLf &amp; \"next line!nEXT sENTENCE\" &amp; _\n                    vbCr &amp; \"cr ! lower case\" &amp; _\n                    vbLf &amp; \"lf .new sentence\" &amp; _\n                    vbNullChar &amp; \" null?null char\" &amp; _\n                    vbNullString &amp; \"nullString  spaces\" &amp; _\n                    vbTab &amp; \"TAB CHAR.ttt\" &amp; _\n                    vbBack &amp; \"back?  back char\" &amp; _\n                    vbFormFeed &amp; \"ff  ff words\" &amp; _\n                    vbVerticalTab &amp; \"vertical tab.| lower .case words\")\n</code></pre>\n\n<p>Results:</p>\n\n<p><img src=\"https://i.stack.imgur.com/wWyAZ.png\" alt=\"test 1\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/GDsx4.png\" alt=\"test 2\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/rmQfW.png\" alt=\"test 3\"></p>\n\n<p>You can find more details here: <a href=\"https://msdn.microsoft.com/en-us/library/ms974570.aspx\" rel=\"nofollow noreferrer\">Microsoft - Regular Expressions</a></p>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "is_accepted": false, "score": 0, "last_activity_date": 1435899484, "creation_date": 1435899484, "answer_id": 31198794, "question_id": 31167519, "link": "https://stackoverflow.com/questions/31167519/excel-vba-sentence-case-funtion-needs-fine-tuning/31198794#31198794", "title": "Excel VBA Sentence Case Funtion Needs Fine Tuning", "body": "<p>Paul thank you  for taking the time to help.  I gave up and searched the net some more found a workable sub, received help from another bulletin board and came up with the following: </p>\n\n<pre><code>Sub SentenceCase(rng As Range) \nDim V       As Variant \nDim s       As String \nDim Start   As Boolean \nDim i       As Long \nDim ch      As String \n\nApplication.ScreenUpdating = False \nApplication.EnableEvents = False \nActiveSheet.Unprotect \n\nWith rng \n    V = .Value \n    If IsDate(V) Or IsNumeric(V) Then Exit Sub \n    s = CStr(V) \n    Start = True \n\n    For i = 1 To Len(s) \n        ch = Mid$(s, i, 1) \n        Select Case ch \n        Case \".\" \n            Start = True \n        Case \"?\" \n            Start = True \n        Case \"!\" \n            Start = True \n        Case \"a\" To \"z\" \n            If Start Then ch = UCase$(ch) \n            Start = False \n        Case \"A\" To \"Z\" \n            If Start Then \n                Start = False \n            Else \n                ch = LCase$(ch) \n            End If \n        End Select \n        Mid$(s, i, 1) = ch \n    Next i \n    .Value = s \nEnd With \n\nActiveSheet.Protect \nApplication.ScreenUpdating = True \nApplication.EnableEvents = True \n</code></pre>\n\n<p>End Sub </p>\n\n<p>This code is doing what I needed.  Again thank you for your help. </p>\n\n<p>Gary</p>\n"}], "owner": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1435899484, "creation_date": 1435770152, "last_edit_date": 1531164843, "question_id": 31167519, "link": "https://stackoverflow.com/questions/31167519/excel-vba-sentence-case-funtion-needs-fine-tuning", "title": "Excel VBA Sentence Case Funtion Needs Fine Tuning", "body": "<p>Below is a function built by others that changes text into sentence case (first letter of each sentence capitalized).  The function works nicely except it doesn't capitalize the first letter of the first word.  Another issue is that if a sentence is entered in all caps, the function does nothing.  I'm looking for some assistance in tweaking the function to correct these issues. </p>\n\n<pre><code>Option Explicit \nFunction ProperCaps(strIn As String) As String\n\nDim objRegex As Object\nDim objRegMC As Object\nDim objRegM As Object\n\nSet objRegex = CreateObject(\"vbscript.regexp\")\nstrIn = LCase$(strIn)\n\nWith objRegex\n    .Global = True\n    .ignoreCase = True\n    .Pattern = \"(^|[\\.\\?\\!\\r\\t]\\s?)([a-z])\"\n\n    If .test(strIn) Then\n        Set objRegMC = .Execute(strIn)\n\n        For Each objRegM In objRegMC\n            Mid$(strIn, objRegM.firstindex + 1, objRegM.Length) = UCase$(objRegM)\n        Next\n    End If\nEnd With\n\nProperCaps = strIn\nEnd Function\n</code></pre>\n\n<p>Thanks,\nGary</p>\n"}, {"tags": ["vba", "checkin", "vcs-checkout"], "comments": [{"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1491057303, "post_id": 31167462, "comment_id": 73391221, "body": "Can you access the file any other way (e.g. by pasting the url into a web browser)?"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1491057377, "post_id": 31167462, "comment_id": 73391240, "body": "Are you sure that you want to check in the file at the end of the Sub even if you failed to check it out at the beginning?"}], "answers": [{"comments": [{"owner": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 1, "creation_date": 1452028496, "post_id": 34621259, "comment_id": 56988335, "body": "Please format your answer properly as explained in <a href=\"http://stackoverflow.com/help/formatting\">this help page</a>."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1491057512, "post_id": 34621259, "comment_id": 73391280, "body": "This code is essentially the same as the line that causes error in the OP&#39;s Sub."}], "tags": [], "owner": {"reputation": 11, "user_id": 5749589, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/36eb2f08f19ad2af1a23a068d40467c0?s=128&d=identicon&r=PG", "display_name": "excelexpert", "link": "https://stackoverflow.com/users/5749589/excelexpert"}, "is_accepted": false, "score": -1, "last_activity_date": 1482019461, "last_edit_date": 1482019461, "creation_date": 1452028069, "answer_id": 34621259, "question_id": 31167462, "link": "https://stackoverflow.com/questions/31167462/checkout-and-checkin-sharepoint-file/34621259#34621259", "title": "Checkout and checkin sharepoint file", "body": "<p>I tried a lot of way to resolve this, finally this method worked for me</p>\n\n<pre><code>Dim URL as String\nDim wb as Workbook\n\nURL = \"http://your.com/path/to/doc.xlsx\"          \n\nIf Workbooks.CanCheckOut(URL) = True Then\n    Workbooks.CheckOut URL\n    Set wb = Workbooks.Open(URL, , False)\nElse\n    MsgBox (\"Unable to checkout document\")\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10128186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c72f016531ef7b977000ef766ea4d99?s=128&d=identicon&r=PG", "display_name": "Joao Ramos", "link": "https://stackoverflow.com/users/10128186/joao-ramos"}, "is_accepted": false, "score": 1, "last_activity_date": 1532447632, "last_edit_date": 1532447632, "creation_date": 1532438491, "answer_id": 51499731, "question_id": 31167462, "link": "https://stackoverflow.com/questions/31167462/checkout-and-checkin-sharepoint-file/51499731#51499731", "title": "Checkout and checkin sharepoint file", "body": "<p>Try changing <code>ChkFile = \"http://new1....com/Shared%20Documents/file.xlsm\"</code> to <code>ChkFile = \"http://new1....com/Shared Documents/file.xlsm\"</code>, i.e. replacing <code>%20</code> for a space since the whole path is already within brackets</p>\n"}], "owner": {"reputation": 41, "user_id": 2009839, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/017ec66cadd1d07c44be2ead70cc95f2?s=128&d=identicon&r=PG", "display_name": "Prash", "link": "https://stackoverflow.com/users/2009839/prash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9674, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1532447632, "creation_date": 1435769994, "last_edit_date": 1526911978, "question_id": 31167462, "link": "https://stackoverflow.com/questions/31167462/checkout-and-checkin-sharepoint-file", "title": "Checkout and checkin sharepoint file", "body": "<p>I am getting Runtime error 1004: cancheckout method failed near cancheckout and</p>\n\n<p>Compile error: Method or data member not found in line</p>\n\n<pre><code>If Workbooks.CanCheckIn(ChkFile) = True Then\n</code></pre>\n\n<p>How do I resolve the issue?</p>\n\n<pre><code>Sub ToCheck()\n    Dim xlApp As Excel.Application\n    Dim wb As Workbook\n    Dim ChkFile As String\n    ChkFile = \"http://new1....com/Shared%20Documents/file.xlsm\"\n\n    If Workbooks.CanCheckOut(ChkFile) = True Then 'getting error here\n        Workbooks.CheckOut ChkFile\n\n        Set xlApp = New Excel.Application\n        xlApp.Visible = True\n\n        Set wb = xlApp.Workbooks.Open(ChkFile, , False)\n    End If\n\n    ThisWorkbook.Activate\n    Application.Run (\"'file.xlsm'!Macro1\")\n\n    ThisWorkbook.Save\n\n    Workbooks(ChkFile).Activate\n\n    If Workbooks.CanCheckIn(ChkFile) = True Then 'Getting error here\n        Workbooks(ChkFile).CheckIn\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer", "window"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1435770468, "post_id": 31167200, "comment_id": 50342958, "body": "<code>IE.navigate &quot;http:&#47;&#47;www.google.com&quot;</code>"}, {"owner": {"reputation": 2248, "user_id": 246070, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5a15876f920242f88d2642a89b270303?s=128&d=identicon&r=PG", "display_name": "Crays", "link": "https://stackoverflow.com/users/246070/crays"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1435771502, "post_id": 31167200, "comment_id": 50343616, "body": "Thanks Tim, that helped solved that part, but now it highlights to getIE = True, i&#39;m familiar with PHP and calling function from there, but am i doing the call right in VBA?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1435773620, "post_id": 31167200, "comment_id": 50344714, "body": "You can&#39;t assign a value to a function - I&#39;m not clear what you mean to do with that line."}], "answers": [{"comments": [{"owner": {"reputation": 2248, "user_id": 246070, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5a15876f920242f88d2642a89b270303?s=128&d=identicon&r=PG", "display_name": "Crays", "link": "https://stackoverflow.com/users/246070/crays"}, "edited": false, "score": 0, "creation_date": 1435806830, "post_id": 31169311, "comment_id": 50357265, "body": "Thanks Tim, got close, but what i want is to have the existing opened IE window to go to the new URL yahoo.com, which i found from some other discussion is the code i posted above as the function."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 2248, "user_id": 246070, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5a15876f920242f88d2642a89b270303?s=128&d=identicon&r=PG", "display_name": "Crays", "link": "https://stackoverflow.com/users/246070/crays"}, "edited": false, "score": 0, "creation_date": 1435807140, "post_id": 31169311, "comment_id": 50357329, "body": "That&#39;s exactly what that did when I ran it."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1435776464, "creation_date": 1435776464, "answer_id": 31169311, "question_id": 31167200, "link": "https://stackoverflow.com/questions/31167200/navigate-to-new-url-in-existing-internet-explorer-window/31169311#31169311", "title": "Navigate to new URL in existing Internet Explorer window", "body": "<pre><code>Sub TestGetIE()\n\n    Dim IE As Object\n    Set IE = CreateObject(\"Internetexplorer.Application\")\n    IE.Visible = True\n    IE.navigate \"https://www.yahoo.com\"\n    WaitFor IE\n\n    Set IE = GetIE(\"https://www.yahoo.com\")\n\n    IE.navigate \"http://www.google.com\"\n\n\nEnd Sub\n\nSub WaitFor(IE)\n    Do\n    Loop Until IE.readyState = READYSTATE_COMPLETE\nEnd Sub\n\n\nFunction GetIE(sLocation As String) As Object\n\nDim objShell As Object, objShellWindows As Object, o As Object\nDim sURL As String\nDim retVal As Object\n\n    Set retVal = Nothing\n    Set objShell = CreateObject(\"Shell.Application\")\n    Set objShellWindows = objShell.Windows\n\n    For Each o In objShellWindows\n        sURL = \"\"\n        'check the URL and if it's the one you want then\n        ' assign it to the return value\n        sURL = o.LocationURL\n        If sURL Like sLocation &amp; \"*\" Then\n            Set retVal = o\n            Exit For\n        End If\n    Next o\n\n    Set GetIE = retVal\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 2, "last_activity_date": 1558078359, "creation_date": 1558078359, "answer_id": 56181681, "question_id": 31167200, "link": "https://stackoverflow.com/questions/31167200/navigate-to-new-url-in-existing-internet-explorer-window/56181681#56181681", "title": "Navigate to new URL in existing Internet Explorer window", "body": "<p>As a similar/adapted alternative, here's a favorite function of mine. </p>\n\n<p>This function returns an object representing the <em>existing</em> <code>InternetExplorer</code> instance if there is one, otherwise a <em>newly-created</em> instance.</p>\n\n<pre><code>Function GetIE() As Object\n'return an object for the open Internet Explorer window, or create new one\n  For Each GetIE In CreateObject(\"Shell.Application\").Windows() 'Loop to find\n    If (Not GetIE Is Nothing) And GetIE.Name = \"Internet Explorer\" Then Exit For 'Found!\n  Next GetIE\n  If GetIE Is Nothing Then Set GetIE=CreateObject(\"InternetExplorer.Application\")'Create\n  GetIE.Visible = True 'Make IE window visible\nEnd Function\n</code></pre>\n\n<p>More information and example <a href=\"https://stackoverflow.com/a/53348077/8112776\">here</a>.</p>\n"}], "owner": {"reputation": 2248, "user_id": 246070, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5a15876f920242f88d2642a89b270303?s=128&d=identicon&r=PG", "display_name": "Crays", "link": "https://stackoverflow.com/users/246070/crays"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7195, "favorite_count": 1, "accepted_answer_id": 31169311, "answer_count": 2, "score": 3, "last_activity_date": 1558078359, "creation_date": 1435769146, "last_edit_date": 1556577029, "question_id": 31167200, "link": "https://stackoverflow.com/questions/31167200/navigate-to-new-url-in-existing-internet-explorer-window", "title": "Navigate to new URL in existing Internet Explorer window", "body": "<p>I am trying to get an existing (open) IE window to load a new URL via <code>ie.Navigate</code>.</p>\n\n<p>Below is my worksheet code which loads a website on click of a button:</p>\n\n<pre><code>Private Sub Sendit_Click()\n    Dim IE As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n    IE.navigate \"https://www.yahoo.com\"\n    Do\n    Loop Until IE.ReadyState = READYSTATE_COMPLETE\n\n    GetIE\n\n    Err_Clear:\n    If Err &lt;&gt; 0 Then\n        Err.Clear\n        Resume Next\n    End If\nEnd Sub\n</code></pre>\n\n<p>This code is in my module:</p>\n\n<pre><code>Function GetIE()\n    Dim shellWins As ShellWindows\n    Dim IE As InternetExplorer\n\n    Set shellWins = New ShellWindows\n\n    If shellWins.Count &gt; 0 Then\n        ' Get IE\n        Set IE = shellWins.Item(0)\n    Else\n        ' Create IE\n        Set IE = New InternetExplorer\n        IE.Visible = True\n    End If\n\n    IE.navigate \"http://www.google.com\"\n\n    Set shellWins = Nothing\n    Set IE = Nothing\nEnd Function\n</code></pre>\n\n<p>IE doesn't navigate to <a href=\"http://www.google.com\" rel=\"nofollow noreferrer\">http://www.google.com</a>.</p>\n"}, {"tags": ["vba", "excel", "global-variables", "userform", "compile-time-constant"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4921340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea183f7ca7214eee7b0193096602e70?s=128&d=identicon&r=PG&f=1", "display_name": "ashvn", "link": "https://stackoverflow.com/users/4921340/ashvn"}, "edited": false, "score": 0, "creation_date": 1435836676, "post_id": 31167319, "comment_id": 50372160, "body": "Thank u so much for the reply.is it possible to give an example for this? because i am new to vba"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 11, "user_id": 4921340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea183f7ca7214eee7b0193096602e70?s=128&d=identicon&r=PG&f=1", "display_name": "ashvn", "link": "https://stackoverflow.com/users/4921340/ashvn"}, "edited": false, "score": 0, "creation_date": 1435837388, "post_id": 31167319, "comment_id": 50372684, "body": "@ashvn  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 11, "user_id": 4921340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea183f7ca7214eee7b0193096602e70?s=128&d=identicon&r=PG&f=1", "display_name": "ashvn", "link": "https://stackoverflow.com/users/4921340/ashvn"}, "edited": false, "score": 0, "creation_date": 1435842710, "post_id": 31167319, "comment_id": 50376485, "body": "But i want to get the value from the userform and assign it to  the constant .how can i do that?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 11, "user_id": 4921340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea183f7ca7214eee7b0193096602e70?s=128&d=identicon&r=PG&f=1", "display_name": "ashvn", "link": "https://stackoverflow.com/users/4921340/ashvn"}, "edited": false, "score": 0, "creation_date": 1435844291, "post_id": 31167319, "comment_id": 50377639, "body": "@ashvn I don&#39;t know how to that."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1435837366, "last_edit_date": 1435837366, "creation_date": 1435769532, "answer_id": 31167319, "question_id": 31167151, "link": "https://stackoverflow.com/questions/31167151/assigning-a-text-box-value-to-a-constant-variable-in-vba/31167319#31167319", "title": "assigning a Text box value to a constant variable in VBA", "body": "<p>You can create a <strong>Const</strong> and make it <strong>Public</strong>, but it can only be \"initialized\" where it is declared.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>For example:</p>\n\n<pre><code>Sub dural()\n    Public Const Boltzmann = 1.3806488E-23\n    a = b * Boltzmann\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4921340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea183f7ca7214eee7b0193096602e70?s=128&d=identicon&r=PG&f=1", "display_name": "ashvn", "link": "https://stackoverflow.com/users/4921340/ashvn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1232, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1435837366, "creation_date": 1435768999, "last_edit_date": 1435770196, "question_id": 31167151, "link": "https://stackoverflow.com/questions/31167151/assigning-a-text-box-value-to-a-constant-variable-in-vba", "title": "assigning a Text box value to a constant variable in VBA", "body": "<p>I want to assign a Constant global variable value dynamically from a user form input.This value will be used to declare the Typedef functions and other variables initially before running the actual Macro</p>\n\n<p>my code looks like this</p>\n\n<pre><code>Const Imax\n\ndim sys (0 to imax) as type computer.\n</code></pre>\n\n<p>I want the value for the Imax to be taken from the userform and retain that value constant\nany suggestion or help please. Thank you so much for taking time to read my problem.</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1435768807, "post_id": 31166212, "comment_id": 50342066, "body": "Wouldn&#39;t SelRange be a range rather than an integer?"}, {"owner": {"reputation": 81, "user_id": 5039812, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/97af98a6b4824b717b6fbe61c8297c59?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5039812/sam"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435769104, "post_id": 31166212, "comment_id": 50342217, "body": "I tried that and it gives me a &quot;Object variable or with block variable not set&quot; error and won&#39;t run."}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1435769501, "post_id": 31166212, "comment_id": 50342439, "body": "if <code>SelRange</code> is a <code>Range</code> you need to assign to it using <code>Set</code> - <code>Set SelRange = Selection</code>."}, {"owner": {"reputation": 81, "user_id": 5039812, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/97af98a6b4824b717b6fbe61c8297c59?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5039812/sam"}, "edited": false, "score": 0, "creation_date": 1435770090, "post_id": 31166212, "comment_id": 50342749, "body": "I see. However when I do that with a number of cells I get an error from: Selection= ScrollBar1.Value + SelRange. It also makes this increases and decrease very erratic when I try to alter only one cell."}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1435771316, "post_id": 31166212, "comment_id": 50343506, "body": "you&#39;re trying to add a number to an object.  That doesn&#39;t make sense - you need to think more carefully about <i>what kind of thing</i> each variable or element represents.  It doesn&#39;t help that VBA will try and automatically convert in some circumstances.  See my answer below for more details."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5039812, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/97af98a6b4824b717b6fbe61c8297c59?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5039812/sam"}, "edited": false, "score": 0, "creation_date": 1435777942, "post_id": 31167769, "comment_id": 50347297, "body": "Done that now, thanks for your help. I will post what I did in full later for other people who may have a similar issue in future."}], "tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": true, "score": 0, "last_activity_date": 1435786441, "last_edit_date": 1435786441, "creation_date": 1435771031, "answer_id": 31167769, "question_id": 31166212, "link": "https://stackoverflow.com/questions/31166212/using-a-userform-to-adjust-a-range-of-cells/31167769#31167769", "title": "Using a userform to adjust a range of cells", "body": "<p>Your current code is working for one cell because the default property of the <code>Range</code> object is <code>Value</code>.  So you are putting the <em>value</em> in the selected cell into your variable.  But for multiple cells, the <code>Value</code> property will return an <code>Array</code> - which won't fit into the <code>Integer</code>.</p>\n\n<p>It looks like you need to declare <code>selRange</code> as a <code>Range</code> then work with that:</p>\n\n<pre><code>Public selRange as Range\n'...\nIf TypeName(Selection) = \"Range\" Then\n        Set selRange = Selection\nElse\n        'handle case when something other than cell(s) are selected here\nEnd If\n'rest of your code here\n</code></pre>\n\n<p>Look up the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object reference in MSDN</a> for info on working with <code>Range</code>.  The <code>Cells</code> and  <code>Value</code> properties will be particularly useful.  In particular, to increment each cell in a range you can do:</p>\n\n<pre><code>Dim getAllValuesAtOnceAsArray As Variant\ngetAllValuesAtOnceAsArray = selRange.Value\n\nDim singleCell As Range\nFor Each singleCell In selRange.Cells\n        singleCell.Value = singleCell.Value + 1\nNext singleCell\n\n'Now write back the original values\nselRange.Value = getAllValuesAtOnceAsArray\n</code></pre>\n\n<p>One thing to note is that <code>Range.Value</code> always returns a 2D array if there is more than one cell (even if the range has only one row or one column).  So <code>getAllValuesAtOnceAsArray(rowNumber,columnNumber)</code> gets a single element of the array - and you need both indices even if one is always 1.  In practice it's usually easier to just use the <code>Range</code> object as there are more flexible ways of accessing the individual cells (<code>Cells</code>, <code>Offset</code>, <code>Rows</code>, <code>Columns</code> etc).</p>\n"}], "owner": {"reputation": 81, "user_id": 5039812, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/97af98a6b4824b717b6fbe61c8297c59?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5039812/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 31167769, "answer_count": 1, "score": 1, "last_activity_date": 1435786441, "creation_date": 1435766153, "last_edit_date": 1435772257, "question_id": 31166212, "link": "https://stackoverflow.com/questions/31166212/using-a-userform-to-adjust-a-range-of-cells", "title": "Using a userform to adjust a range of cells", "body": "<p>I am hoping someone can help me with a query. So far I have an excel spreadsheet and you select a cell and then click a button, the button opens a userform with a scroll bar on and as you use the scroll bar this edits the number in cell by +-1 up/down to bounds that you type into text boxes. This moves the graphs associated with each cell in real time. When I close the userform, the original values are populated back in the cells.</p>\n\n<p>My hope is that when using the spreadsheet, eventually, people will be able to select a number of cells (a random number of cells, sometimes you might select 2 or 7 or 10 to change) and the userform will impact all of them in the same way above however I am having trouble with this. This will enable people to see the impact of the interaction between these items.</p>\n\n<p>To make it work for one cell I have defined the variable as public outside the user form as so:</p>\n\n<pre><code>Public SelRange As Integer\n</code></pre>\n\n<p>Then within <code>UserForm_Initialize</code>:</p>\n\n<pre><code>SelRange = Selection\n</code></pre>\n\n<p>Then there is code for max, min, increments etc and when the scroll bar is used, the value is deposited in the active cell by the code:</p>\n\n<pre><code>Selection = SelRange\n</code></pre>\n\n<p>However if I select numerous cells and try do this I get a type mismatch which would suggest I should define the <code>SelRange</code> in a different way but I can't figure out what this is or even if that will actually help the situation. </p>\n\n<p>Thanks for your help.</p>\n\n<p>Full code below:</p>\n\n<p>Code for Button:</p>\n\n<pre><code>        Public SelRange As Integer\n\n        Sub Button1_Click()\n        UserForm1.Show\n        End Sub\n</code></pre>\n\n<p>Code for Scroll Bar within userform:</p>\n\n<pre><code>        Option Explicit\n        ' Sets default values for when the Userform is opened\n        Public Sub UserForm_Initialize()\n\n        MinBox.Value = -100\n        MaxBox.Value = 100\n        IncBox.Value = 5\n\n        SelRange = Selection\n\n        End Sub\n\n        'Ensures that the default starting point is midway between the min and max values specified\n\n        Sub scrollbar1_enter()\n\n        Dim x As Double\n        Dim y As Double\n        y = MaxBox.Value\n        x = MinBox.Value\n        ScrollBar1.Value = (x + y) / 2\n\n        Selection = SelRange\n\n        End Sub\n\n        'Sets all parameters in the scroll bar\n        Private Sub Scrollbar1_Change()\n\n        ScrollBar1.Max = MaxBox.Value\n        ScrollBar1.Min = MinBox.Value\n\n        ScrollBar1.LargeChange = IncBox.Value\n        ScrollBar1.SmallChange = IncBox.Value\n\n        Selection = ScrollBar1 + SelRange\n\n        End Sub\n\n        'Default on exit of userform\n        Private Sub ScrollBar1_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n\n        Dim x As Double\n        Dim y As Double\n\n        y = MaxBox.Value\n        x = MinBox.Value\n\n        ScrollBar1.Value = (x + y) / 2\n\n        End Sub\n\n        'ensures activecell is updated in real time with dragging of mouse\n        Private Sub ScrollBar1_Scroll()\n\n        Selection.Value = ScrollBar1.Value + SelRange\n\n        End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "is_accepted": false, "score": 0, "last_activity_date": 1435767645, "last_edit_date": 1435767645, "creation_date": 1435767101, "answer_id": 31166568, "question_id": 31166041, "link": "https://stackoverflow.com/questions/31166041/vba-timevalue-and-spreadsheet-formula-timevalue/31166568#31166568", "title": "VBA TimeValue() and Spreadsheet Formula TimeValue()", "body": "<p>You can use the formula:</p>\n\n<pre><code>=TIMEVALUE(TEXT(A1,\"hh:mm:ss\"))\n</code></pre>\n\n<p>and keep the text you have there.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5070337, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153422446792171/picture?type=large", "display_name": "HotFuzz", "link": "https://stackoverflow.com/users/5070337/hotfuzz"}, "edited": false, "score": 1, "creation_date": 1435772434, "post_id": 31166812, "comment_id": 50344047, "body": "Seems like I don&#39;t have enough reputation to upvote your comment, but thanks, that works perfectly, i only need to fit it in an array and it&#39;ll be done!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 35, "user_id": 5070337, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153422446792171/picture?type=large", "display_name": "HotFuzz", "link": "https://stackoverflow.com/users/5070337/hotfuzz"}, "edited": false, "score": 0, "creation_date": 1435772591, "post_id": 31166812, "comment_id": 50344130, "body": "@HotFuzz  Thanks for the feedback!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1435767841, "creation_date": 1435767841, "answer_id": 31166812, "question_id": 31166041, "link": "https://stackoverflow.com/questions/31166041/vba-timevalue-and-spreadsheet-formula-timevalue/31166812#31166812", "title": "VBA TimeValue() and Spreadsheet Formula TimeValue()", "body": "<p>With data in <strong>B1</strong>, this will convert it into a usable <strong>time</strong></p>\n\n<pre><code>Sub OutOfTime()\n    Dim s As String\n    s = Range(\"B1\").Text\n    ary = Split(s, \" \")\n    Range(\"B1\").Formula = \"=timevalue(\"\"\" &amp; ary(1) &amp; \" \" &amp; ary(2) &amp; \"\"\")\"\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/IOo81.png\" alt=\"enter image description here\"></p>\n"}, {"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1435768104, "creation_date": 1435768104, "answer_id": 31166900, "question_id": 31166041, "link": "https://stackoverflow.com/questions/31166041/vba-timevalue-and-spreadsheet-formula-timevalue/31166900#31166900", "title": "VBA TimeValue() and Spreadsheet Formula TimeValue()", "body": "<p>The problem is that your time is too specific for Excel. Excel recognizes only time down to the second. But you have afterwards milliseconds. This is what is causing the problem and why Excel does not recognize it. You need to rid yourself of the milliseconds in the source (the dot after the seconds and what follows before the PM).</p>\n\n<p>Doesn't work:</p>\n\n<pre><code>Debug.Pring IsDate(\"6/23/2015 1:05:37.7 PM\")\n</code></pre>\n\n<p>Works:</p>\n\n<pre><code>Debug.Pring IsDate(\"6/23/2015 1:05:37 PM\")\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5070337, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153422446792171/picture?type=large", "display_name": "HotFuzz", "link": "https://stackoverflow.com/users/5070337/hotfuzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "accepted_answer_id": 31166812, "answer_count": 3, "score": 2, "last_activity_date": 1435768104, "creation_date": 1435765648, "question_id": 31166041, "link": "https://stackoverflow.com/questions/31166041/vba-timevalue-and-spreadsheet-formula-timevalue", "title": "VBA TimeValue() and Spreadsheet Formula TimeValue()", "body": "<p>Good morning all,</p>\n\n<p>I have over 20,000 time inputs in a column such as <code>6/23/2015 1:05:37.7 PM</code> and need to transfer it in a time value Excel can manage.</p>\n\n<p>I managed to find a workaround:</p>\n\n<pre><code>Set wrTB = Worksheets(\"TEST BENCH Data\")\nwrTB.UsedRange\nlastRowTB = wrTB.UsedRange.Rows.Count\nlastColumnTB = wrTB.UsedRange.Columns.Count\n\nIf lastRowTB &gt; 1 Then 'makes sure there is data on the worksheet\n    If wrTB.Cells(7, lastColumnTB) &lt;&gt; \"\" Then 'makes sure time has not already been formated\n        Dim aTempsTB As Variant, TempsTB() As String\n        ReDim TempsTB(lastRowTB - 7, 1)\n        aTempsTB = wrTB.Range(wrTB.Cells(8, 2), wrTB.Cells(lastRowTB, 2))\n        For i = 1 To lastRowTB - 7\n            TempsTB(i - 1, 0) = Right(aTempsTB(i, 1), 13)\n        Next i\n        wrTB.Range(wrTB.Cells(8, lastColumnTB + 2), wrTB.Cells(lastRowTB, lastColumnTB + 2)).NumberFormat = \"[h]:mm:ss.000\"\n        wrTB.Cells(8, lastColumnTB + 2).FormulaR1C1 = \"=TIMEVALUE(RC[-1])\"\n        wrTB.Cells(8, lastColumnTB + 2).AutoFill Destination:=wrTB.Range(wrTB.Cells(8, lastColumnTB + 2), Cells(lastRowTB, lastColumnTB + 2)), Type:=xlFillDefault\n        wrTB.Range(wrTB.Cells(8, lastColumnTB + 1), wrTB.Cells(lastRowTB, lastColumnTB + 1)) = TempsTB\n        Columns(lastColumnTB + 2).Copy\n        Columns(lastColumnTB + 2).PasteSpecial Paste:=xlPasteValues\n        Columns(lastColumnTB + 1).Delete\n        wrTB.UsedRange\n        lastColumnTB = wrTB.UsedRange.Columns.Count\n    End If\nEnd If\n</code></pre>\n\n<p>Basically, it works, but it is some ugly workaround I'd like to change to something more \"professional\"</p>\n\n<p>If I change the code to:</p>\n\n<pre><code>For i = 1 To lastRowTB - 7\n    TempsTB(i - 1, 0) = TimeValue(Right(aTempsTB(i, 1), 13))\nNext i\n</code></pre>\n\n<p>I get a Type Mismatch error, I also tried setting temporary variables to make sure the arrays weren't causing the trouble, but it still doesn't work...</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["linq", "excel", "epplus", "linq-to-excel", "vba"], "comments": [{"owner": {"reputation": 12593, "user_id": 1324284, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/6bsvn.jpg?s=128&g=1", "display_name": "Ernie S", "link": "https://stackoverflow.com/users/1324284/ernie-s"}, "edited": false, "score": 0, "creation_date": 1435793005, "post_id": 31165959, "comment_id": 50354199, "body": "What happens if you open and save the worksheet in excel after you exported from epplus but before you open with linq2excel?  It could be be epp just generates the raw xml but the sheets are not really generated until excel processes everything."}, {"owner": {"reputation": 127, "user_id": 4885998, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c16f4fe02cb0917da6db06a0c456ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Ajay A", "link": "https://stackoverflow.com/users/4885998/ajay-a"}, "reply_to_user": {"reputation": 12593, "user_id": 1324284, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/6bsvn.jpg?s=128&g=1", "display_name": "Ernie S", "link": "https://stackoverflow.com/users/1324284/ernie-s"}, "edited": false, "score": 0, "creation_date": 1435801631, "post_id": 31165959, "comment_id": 50356192, "body": "What should I do to get all the column names @Ernie"}, {"owner": {"reputation": 12593, "user_id": 1324284, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/6bsvn.jpg?s=128&g=1", "display_name": "Ernie S", "link": "https://stackoverflow.com/users/1324284/ernie-s"}, "edited": false, "score": 0, "creation_date": 1435838532, "post_id": 31165959, "comment_id": 50373414, "body": "Does that solve the problem?  Be good to know either way.  If it does, there may not a practical solutions.  Could you use EPPlus to reopen the excel file instead of Ole?"}, {"owner": {"reputation": 127, "user_id": 4885998, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c16f4fe02cb0917da6db06a0c456ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Ajay A", "link": "https://stackoverflow.com/users/4885998/ajay-a"}, "reply_to_user": {"reputation": 12593, "user_id": 1324284, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/6bsvn.jpg?s=128&g=1", "display_name": "Ernie S", "link": "https://stackoverflow.com/users/1324284/ernie-s"}, "edited": false, "score": 0, "creation_date": 1435841852, "post_id": 31165959, "comment_id": 50375776, "body": "Actually the problem arises because the columns are not fitted properly, if arranged the column width manually it is working good,I want to know how to do it programatically. I have tried <code>worksheet.Cells[worksheet.Dimension.Address].AutoFitColumns(&zwnj;&#8203;);</code> @Ernie"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 4885998, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c16f4fe02cb0917da6db06a0c456ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Ajay A", "link": "https://stackoverflow.com/users/4885998/ajay-a"}, "edited": false, "score": 0, "creation_date": 1436760278, "post_id": 31191778, "comment_id": 50729358, "body": "Hey,sorry for the late reply! If I do as u mentioned it is throwing me an exception @Ernie"}, {"owner": {"reputation": 12593, "user_id": 1324284, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/6bsvn.jpg?s=128&g=1", "display_name": "Ernie S", "link": "https://stackoverflow.com/users/1324284/ernie-s"}, "reply_to_user": {"reputation": 127, "user_id": 4885998, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c16f4fe02cb0917da6db06a0c456ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Ajay A", "link": "https://stackoverflow.com/users/4885998/ajay-a"}, "edited": false, "score": 0, "creation_date": 1436782504, "post_id": 31191778, "comment_id": 50739205, "body": "@Ajay what is the exception and which line?  Best if you can Paste all of the code by editing your question above."}, {"owner": {"reputation": 127, "user_id": 4885998, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c16f4fe02cb0917da6db06a0c456ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Ajay A", "link": "https://stackoverflow.com/users/4885998/ajay-a"}, "edited": false, "score": 0, "creation_date": 1436804941, "post_id": 31191778, "comment_id": 50753993, "body": "I meant to say the same exception arises when reading the values, if I even do this @Ernie"}, {"owner": {"reputation": 12593, "user_id": 1324284, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/6bsvn.jpg?s=128&g=1", "display_name": "Ernie S", "link": "https://stackoverflow.com/users/1324284/ernie-s"}, "reply_to_user": {"reputation": 127, "user_id": 4885998, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c16f4fe02cb0917da6db06a0c456ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Ajay A", "link": "https://stackoverflow.com/users/4885998/ajay-a"}, "edited": false, "score": 0, "creation_date": 1436812972, "post_id": 31191778, "comment_id": 50758656, "body": "@AjayA if you are trying to read the EPPlus generated file using Linq2Excel I doubt it will work.  Since EPPlus does not generate a fully executed XLSX (just the raw xml for that excel needs to complete) Linq2Excel must not be able to read it.  Best if you can do all of your manipulation in one technology or the other."}, {"owner": {"reputation": 127, "user_id": 4885998, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c16f4fe02cb0917da6db06a0c456ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Ajay A", "link": "https://stackoverflow.com/users/4885998/ajay-a"}, "edited": false, "score": 0, "creation_date": 1436846842, "post_id": 31191778, "comment_id": 50770407, "body": "I have to do some manipulations. which I think Linq2Excel is a best approach for it @Ernie"}], "tags": [], "owner": {"reputation": 12593, "user_id": 1324284, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/6bsvn.jpg?s=128&g=1", "display_name": "Ernie S", "link": "https://stackoverflow.com/users/1324284/ernie-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1436126971, "last_edit_date": 1436126971, "creation_date": 1435860908, "answer_id": 31191778, "question_id": 31165959, "link": "https://stackoverflow.com/questions/31165959/how-to-retrieve-column-names-from-a-excel-sheet/31191778#31191778", "title": "How to retrieve column names from a excel sheet?", "body": "<p>(Based on OP's Comments)</p>\n\n<p>The <code>AutoFitColumn</code> function has always been a little touchy.  The important thing to remember is to call it AFTER you load the cell data.  </p>\n\n<p>But if you want a use a minimum width (when columns are very narrow and you want to use a minimum) I find EPP to be unreliable.  It seems to always use <code>DefualtColWidth</code> of the worksheet even if you pass in a <code>minimumWidth</code> to one of the function overloads.</p>\n\n<p>Here is how I get around it:</p>\n\n<pre><code>[TestMethod]\npublic void Autofit_Column_Range_Test()\n{\n    //http://stackoverflow.com/questions/31165959/how-to-retrieve-column-names-from-a-excel-sheet\n\n    //Throw in some data\n    var datatable = new DataTable(\"tblData\");\n    datatable.Columns.Add(new DataColumn(\"Nar\", typeof(int))); //This would not be autofitted without the workaround since the default width of a new ws, usually 8.43\n    datatable.Columns.Add(new DataColumn(\"Wide Column\", typeof(int)));\n    datatable.Columns.Add(new DataColumn(\"Really Wide Column\", typeof(int)));\n\n    for (var i = 0; i &lt; 20; i++)\n    {\n        var row = datatable.NewRow();\n        row[0] = i;\n        row[1] = i * 10;\n        row[2] = i * 100;\n        datatable.Rows.Add(row);\n    }\n\n    var existingFile2 = new FileInfo(@\"c:\\temp\\temp.xlsx\");\n    if (existingFile2.Exists)\n        existingFile2.Delete();\n\n    using (var package = new ExcelPackage(existingFile2))\n    {\n        //Add the data\n        var ws = package.Workbook.Worksheets.Add(\"Sheet1\");\n        ws.Cells.LoadFromDataTable(datatable, true);\n\n        //Keep track of the original default of 8.43 (excel default unless the user has changed it in their local Excel install)\n        var orginaldefault = ws.DefaultColWidth;\n        ws.DefaultColWidth = 15;\n\n        //Even if you pass in a miniumWidth as the first parameter like '.AutoFitColumns(15)' EPPlus usually ignores it and goes with DefaultColWidth\n        ws.Cells[ws.Dimension.Address].AutoFitColumns();\n\n        //Set it back to what it was so it respects the user's local setting\n        ws.DefaultColWidth = orginaldefault;\n\n        package.Save();\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 4885998, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6c16f4fe02cb0917da6db06a0c456ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Ajay A", "link": "https://stackoverflow.com/users/4885998/ajay-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1581, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436126971, "creation_date": 1435765460, "last_edit_date": 1531161705, "question_id": 31165959, "link": "https://stackoverflow.com/questions/31165959/how-to-retrieve-column-names-from-a-excel-sheet", "title": "How to retrieve column names from a excel sheet?", "body": "<p>Using <code>EPPlus</code> I'm writing data to multiple sheets. If a sheet is not created I'm adding a sheet else I'm retrieving the used rows and adding data from that row and saving it </p>\n\n<pre><code> FileInfo newFile = new FileInfo(\"Excel.xlsx\");\nusing (ExcelPackage xlPackage = new ExcelPackage(newFile))\n{\n  var ws = xlPackage.Workbook.Worksheets.FirstOrDefault(x =&gt; x.Name == language.Culture);\n  if (ws == null)\n  {\n     worksheet = xlPackage.Workbook.Worksheets.Add(language.Culture);\n     //writing data\n  }\n  else\n  {\n    worksheet = xlPackage.Workbook.Worksheets[language.Culture];\n    colCount = worksheet.Dimension.End.Column;\n    rowCount = worksheet.Dimension.End.Row;\n    //write data\n   }\n   worksheet.Cells[worksheet.Dimension.Address].AutoFitColumns();\n   xlPackage.Save();\n</code></pre>\n\n<p>And it is working great.</p>\n\n<p>Now I want to retrieve the column names of each sheet in the excel using <code>LinqToExcel</code> and this is my code</p>\n\n<pre><code>  string sheetName = language.Culture;\n  var excelFile = new ExcelQueryFactory(excelPath);\n  IQueryable&lt;Row&gt; excelSheetValues = from workingSheet in            excelFile.Worksheet(sheetName) select workingSheet;\n  string[] headerRow = excelFile.GetColumnNames(sheetName).ToArray();\n</code></pre>\n\n<p>At header row it is throwing me an exception</p>\n\n<pre><code>An OleDbException exception was caught\nExternal table is not in the expected format.\n</code></pre>\n\n<p>But I don't want to use Oledb and want to work with Linq To Excel.</p>\n\n<blockquote>\n  <p>Note: When I'm working with single sheet rather than multiple sheets\n  it is working fine and retrieving all columns. Where am I going wrong.</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1435765861, "post_id": 31165909, "comment_id": 50340237, "body": "What line has the error?"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 1, "creation_date": 1435765874, "post_id": 31165909, "comment_id": 50340253, "body": "I don&#39;t think those with statements are necessary.  Neither the dot infront of <code>SL</code> and <code>RL</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1435766029, "post_id": 31165909, "comment_id": 50340346, "body": "This has been answered before many times: qualify both Range and Cells with the worksheet: <code>S.Range(S.Cells(Counter1, 1), S.Cells(Counter1, 10))</code> and so on"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1435770795, "post_id": 31165909, "comment_id": 50343156, "body": "@Rory&#39;s got it -- when you&#39;re using ranges, it&#39;s best (if not required) to qualify each part of that range.  Otherwise, while the Range might be &quot;S.Range&quot; reference, the Cells() part of that might refer to the activesheet, or some other sheet.  Best to be explicit."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435774172, "post_id": 31165909, "comment_id": 50345009, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/18962890/2-ways-for-clearcontents-on-vba-excel-but-1-work-fine-why\">2 ways for &quot;ClearContents&quot; on VBA Excel, but 1 work fine. Why?</a>"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435786236, "post_id": 31165909, "comment_id": 50351820, "body": "@Byron. No, not a duplicate."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1435790071, "post_id": 31165909, "comment_id": 50353284, "body": "@ChipsLetten, this question has multiple sets of errors.  It&#39;s definitely a duplicate w/ the unqualified reference to <code>Cells</code>.  After that, the code won&#39;t run with the improper usage of <code>With S</code> and <code>.SL</code> and <code>.RL</code> which don&#39;t exist under that object.  This is also pointed out by chancea in the second comment.  I suspect misusing a variable like that is a duplicate somewhere.  I&#39;ll see if I can find one.  Regardless, this isn&#39;t a great question because the issue on <code>With</code> is a <code>Compile error</code> and OP is reporting a runtime <code>Application error</code> which would come from <code>Range</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435790312, "post_id": 31172023, "comment_id": 50353359, "body": "It&#39;s worth noting that this is not about Excel &quot;knowing&quot; which <code>Worksheet</code> contains the <code>Range</code>.  The problem is that a <code>Worksheet</code> like <code>S</code> or <code>R</code> does not contain an object called <code>SL</code> or <code>RL</code>.  Even if <code>SL</code> and <code>RL</code> were not defined variables, this code would still error because Excel knows those objects don&#39;t exist for a <code>Worksheet</code>.  It throws the compile time error since it knows before running that this is not valid code."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435790429, "post_id": 31172023, "comment_id": 50353397, "body": "I agree with your other changes and the good practice of using <code>Set</code> outside the loop to avoid resetting those variables constantly when they don&#39;t change.  It&#39;s also possible to pull <code>RL</code> out of the <code>Counter1</code> loop.  The simplified usage of <code>Copy</code> is also a good idea."}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 1, "last_activity_date": 1435786169, "creation_date": 1435786169, "answer_id": 31172023, "question_id": 31165909, "link": "https://stackoverflow.com/questions/31165909/avoiding-select-in-vba-excel-macros-with-variable-ranges/31172023#31172023", "title": "Avoiding Select in VBA Excel macros with variable ranges", "body": "<p>The errors are probably being caused by the <code>Copy</code> and <code>PasteSpecial</code> lines in this block of code:</p>\n\n<blockquote>\n<pre><code>        With S\n            .SL.Copy\n        End With  \n        With R\n            .RL.PasteSpecial\n        End With\n</code></pre>\n</blockquote>\n\n<p>Once you have <code>Set</code> a range variable, Excel knows which worksheet and which workbook contains that range variable. If you want to do something to the range then you do not need to include the worksheet. So, in your code, you just use</p>\n\n<pre><code>SL.Copy\nRL. PasteSpecial\n</code></pre>\n\n<p>It is always a good idea to think if you have any code inside a loop that should be outside. In your code you <code>Set</code> your worksheet variables within the loop but this should be done once before the loop. Adding in the comments made to your post, your code should be changed to:</p>\n\n<pre><code>Dim S As Worksheet\nDim R As Worksheet\nSet R = Sheets(\"Front\")\nSet S = Sheets(\"CHECK LIST\")\n\nCounter2 = 17\nFor Counter1 = 12 To 150\n\n    Dim SL As Range\n    Dim RL As Range\n    Set SL = S.Range(S.Cells(Counter1, 1), S.Cells(Counter1, 10))\n    Set RL = R.Range(R.Cells(Counter2, 1), R.Cells(Counter2, 10))\n\n    Set curCell = Worksheets(\"CHECK LIST\").Cells(Counter1, 6)\n    Set checkCell = Worksheets(\"Front\").Cells(3, 5)\n    If curCell.Value = checkCell.Value Then\n\n        SL.Copy\n        RL.PasteSpecial\n\n        Counter2 = Counter2 + 1\n    End If\nNext Counter1\n</code></pre>\n\n<p>The <code>PasteSpecial</code> method has several parameters:</p>\n\n<pre><code>.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks:=False, _\n            Transpose:=False\n</code></pre>\n\n<p>If you are not using these, then maybe you can do a \"normal\" copy &amp; paste?</p>\n\n<pre><code>SL.Copy RL\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5070257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef03b16d4849d1a680b7925d88f15a6?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Gusev", "link": "https://stackoverflow.com/users/5070257/anton-gusev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435786169, "creation_date": 1435765308, "last_edit_date": 1495539829, "question_id": 31165909, "link": "https://stackoverflow.com/questions/31165909/avoiding-select-in-vba-excel-macros-with-variable-ranges", "title": "Avoiding Select in VBA Excel macros with variable ranges", "body": "<p>I was following suggestions under question <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a>, but still getting  \"Application-defined or object-defined error\".</p>\n\n<p>My macro suppose to check value in one of lines, compare it with set value, and if values equals, then copy line to another sheet. I tried to avoid usage of .Select command, but no matter what I try I'm getting errors.</p>\n\n<p>This is my last version:</p>\n\n<pre><code>    Counter2 = 17\n    For Counter1 = 12 To 150\n\n    Dim S As Worksheet\n    Dim R As Worksheet\n    Dim SL As Range\n    Dim RL As Range\n    Set R = Sheets(\"Front\")\n    Set S = Sheets(\"CHECK LIST\")\n    Set SL = S.Range(Cells(Counter1, 1), Cells(Counter1, 10))\n    Set RL = R.Range(Cells(Counter2, 1), Cells(Counter2, 10))\n\n    Set curCell = Worksheets(\"CHECK LIST\").Cells(Counter1, 6)\n    Set checkCell = Worksheets(\"Front\").Cells(3, 5)\n        If curCell.Value = checkCell.Value Then\n\n            With S\n                .SL.Copy\n            End With\n\n            With R\n                .RL.PasteSpecial\n            End With\n\n            Counter2 = Counter2 + 1\n\n        End If\nNext Counter1\n</code></pre>\n\n<p>Is this something to do with usage of variables (Counter1, Counter2) in Range?</p>\n"}, {"tags": ["vba", "excel", "match"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1435768046, "post_id": 31165707, "comment_id": 50341628, "body": "Related to the error: most likely is caused because the .Match function returns an error if it doesn&#39;t find anything, so you&#39;ll have to check for that: <code>If Not IsError(MI) Then</code>. Another way to get a partial match is to use the .Find() function"}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1435839206, "post_id": 31165707, "comment_id": 50373869, "body": "@paulbica - I&#39;ve tried this method, but it seems to have an issue with the fact that the block of code is within a WHILE loop. I am now getting an error message saying that I have a WEND without an WHILE."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1435873241, "post_id": 31165707, "comment_id": 50394791, "body": "Please update the code you provided in the question to include the full context (where is the While line). It&#39;s easier to spot issues if you include the full function"}], "answers": [{"comments": [{"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "edited": false, "score": 0, "creation_date": 1435839285, "post_id": 31166211, "comment_id": 50373939, "body": "This method works (a bit), but it is now returning the first row, which is a column header."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "edited": false, "score": 0, "creation_date": 1435928906, "post_id": 31166211, "comment_id": 50416995, "body": "That should only happen if the header includes your search data."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1435766151, "creation_date": 1435766151, "answer_id": 31166211, "question_id": 31165707, "link": "https://stackoverflow.com/questions/31165707/excel-vba-how-to-return-a-partial-match/31166211#31166211", "title": "Excel VBA: How to return a partial match", "body": "<p>If I have understood what you are matching to what, you can use:</p>\n\n<pre><code>MI = WorksheetFunction.Match(\"*\" &amp; MH &amp; \"*\", Range(\"HC:HC\"), 0)\n</code></pre>\n"}], "owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1075, "favorite_count": 0, "accepted_answer_id": 31166211, "answer_count": 1, "score": 0, "last_activity_date": 1435915394, "creation_date": 1435764739, "last_edit_date": 1435915394, "question_id": 31165707, "link": "https://stackoverflow.com/questions/31165707/excel-vba-how-to-return-a-partial-match", "title": "Excel VBA: How to return a partial match", "body": "<p>I've looked through the questions and can't seem to find an answer. </p>\n\n<p>I have a list of receipt IDs in a spreadsheet, created by system 1. In another spreadsheet, I also have a list of the same receipts, created by system 2.</p>\n\n<p>90+% of the information is presented the same, and I can run a Match using worksheetfunction.match. However, there is a particular type of receipt (a refund and purchase) that has a different format in system 2.</p>\n\n<p>An example would be:</p>\n\n<p>System 1:</p>\n\n<ul>\n<li>AAAA0000001</li>\n<li>AAAA0000002 </li>\n<li>AAAA0000003 </li>\n<li>AAAA0000004 </li>\n<li>....</li>\n<li>ZZZZ9999999</li>\n</ul>\n\n<p>System 2:</p>\n\n<ul>\n<li>AAAA0000001</li>\n<li>AAAA0000002</li>\n<li>AAAA0000003 / AAAA000004      - this would be a refund and purchase</li>\n<li>AAAA0000005</li>\n<li>....</li>\n<li>ZZZZ9999999</li>\n</ul>\n\n<p>The code I am using is:</p>\n\n<pre><code>While MC &gt; MD\n\n    Worksheets(\"ID sheet\").Activate                             ' activate ID sheet\n\n    MF = WorksheetFunction.VLookup(MD, Range(\"U2:W\" &amp; Range(\"U1\")), 2, False)   ' Vlookup for System 1 letters\n    MG = WorksheetFunction.VLookup(MD, Range(\"U2:W\" &amp; Range(\"U1\")), 3, False)   ' Vlookup for System 1 numbers\n    MH = MF &amp; MG                                                ' combine GFAS and Fund IDs\n\n     Worksheets(\"System 1\").Activate                ' Activate System 1 screen\n        MI = WorksheetFunction.Match(MH, Range(\"HC:HC\"), 0)         ' Match combined letters and numbers for System 1\n        MK = Range(\"A\" &amp; MI)                                        ' Find deal ID\n\n        Worksheets(\"System 2\").Activate                         ' Activate System 2 screen\n        ML = WorksheetFunction.Match(MK, Range(\"W:W\"), 0)           ' Match deal ID in Range W\n        MM = Range(\"F\" &amp; ML)                                        ' Find Register ID\n\n        MD = MD + 1\n\n    Wend\n</code></pre>\n\n<p>The code returns a run time error 1004.</p>\n\n<p>Is there any way that I can get the code to accept the double entry as a match and return an answer?</p>\n\n<p>Any help is gratefully appreciated.</p>\n"}, {"tags": ["python", "excel", "vba", "win32com"], "comments": [{"owner": {"reputation": 8538, "user_id": 3059812, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/UaU9b.jpg?s=128&g=1", "display_name": "Morgan Thrapp", "link": "https://stackoverflow.com/users/3059812/morgan-thrapp"}, "edited": false, "score": 1, "creation_date": 1435764945, "post_id": 31165681, "comment_id": 50339667, "body": "It sounds like <code>xlapp.Workbooks.Open(xlpath)</code> returns a boolean indicating if the file opened or not. I don&#39;t know the API, but maybe you mean <code>xlapp.Save()</code>?"}, {"owner": {"reputation": 1233, "user_id": 240901, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/97ca67b977b576f2eac0d36c6d6c5e0f?s=128&d=identicon&r=PG", "display_name": "Unos", "link": "https://stackoverflow.com/users/240901/unos"}, "reply_to_user": {"reputation": 8538, "user_id": 3059812, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/UaU9b.jpg?s=128&g=1", "display_name": "Morgan Thrapp", "link": "https://stackoverflow.com/users/3059812/morgan-thrapp"}, "edited": false, "score": 0, "creation_date": 1435773431, "post_id": 31165681, "comment_id": 50344607, "body": "unfortunately, this tip didn&#39;t help. i double-checked and it is indeed wbook.Save() according to the api. see examples at <a href=\"http://pythonexcels.com/python-excel-mini-cookbook/\" rel=\"nofollow noreferrer\">pythonexcels.com/python-excel-mini-cookbook</a>."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 1, "creation_date": 1435832167, "post_id": 31165681, "comment_id": 50369361, "body": "Obvious question maybe but is the workbook referenced by <code>wbook</code> still open? You can also try doing the save as part of the close <code>wbook.Close(True)</code>"}, {"owner": {"reputation": 1233, "user_id": 240901, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/97ca67b977b576f2eac0d36c6d6c5e0f?s=128&d=identicon&r=PG", "display_name": "Unos", "link": "https://stackoverflow.com/users/240901/unos"}, "edited": false, "score": 0, "creation_date": 1435848495, "post_id": 31165681, "comment_id": 50380797, "body": "It finally worked! I started by keeping <code>time.sleep(20)</code> between each of the <code>wbook.*</code> calls. The script then succeeded a few times, but still kept failing now and then. I then discovered that the workbook had quite a few data connections, and for each of them, &#39;refresh data when opening the file&#39; was checked. Removed that condition and reran - it worked serenely. Rude excel learnings :-) Thanks for the <code>wbook.Close(True)</code> tip btw!"}], "owner": {"reputation": 1233, "user_id": 240901, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/97ca67b977b576f2eac0d36c6d6c5e0f?s=128&d=identicon&r=PG", "display_name": "Unos", "link": "https://stackoverflow.com/users/240901/unos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1576, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435764676, "creation_date": 1435764676, "question_id": 31165681, "link": "https://stackoverflow.com/questions/31165681/workbook-save-throwing-typeerror-bool-object-is-not-callable", "title": "workbook.Save() throwing TypeError: &#39;bool&#39; object is not callable", "body": "<p>I am trying to run an excel macro via python (v2.7). The macro function runs fine, but when I try to save the workbook, it errors out saying <code>TypeError: 'bool' object is not callable</code>. </p>\n\n<p>Here is the relevant code:</p>\n\n<pre><code>def run_vba(xlpath, fn):\n    xlapp = win32com.client.Dispatch('Excel.Application')\n    wbook = xlapp.Workbooks.Open(xlpath)\n    parent, xl = os.path.split(xlpath)\n    log = logging.getLogger()\n    log.info(\"Running fn %s at %s\" % (fn, xl))\n    xlapp.run(\"'%s'!%s\" % (xl, fn))\n    log.info('Ran macro, now saving...')\n    wbook.Save() # &lt;--- fails here\n    log.info('Saved, now closing...')\n    wbook.Close()\n    xlapp.quit()\n</code></pre>\n\n<p>I am new to windows programming in python, so would like some help on this error and how to debug and root cause.</p>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1435771824, "creation_date": 1435771824, "answer_id": 31167974, "question_id": 31165671, "link": "https://stackoverflow.com/questions/31165671/move-emails-from-subfolder-to-hard-drive/31167974#31167974", "title": "Move emails from subfolder to hard drive", "body": "<p>I bielive you can develop a VBA macro or add-in to get the job done. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> to get started. </p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868727(v=office.15).aspx\" rel=\"nofollow\">SaveAs</a> method of the MailItem class saves the Microsoft Outlook item to the specified path and in the format of the specified file type. If the file type is not specified, the MSG format (.msg) is used. The file type to save can be one of the following <em>OlSaveAsType</em> constants: olHTML, olMSG, olRTF, olTemplate, olDoc, olTXT, olVCal, olVCard, olICal, or olMSGUnicode. For example:</p>\n\n<pre><code> Sub SaveAsMSG() \n  Dim myItem As Outlook.Inspector \n  Dim objItem As Object \n\n  Set myItem = Application.ActiveInspector \n  If Not TypeName(myItem) = \"Nothing\" Then \n   Set objItem = myItem.CurrentItem \n   strname = objItem.Subject \n   'Prompt the user for confirmation \n   Dim strPrompt As String \n   strPrompt = \"Are you sure you want to save the item? \" &amp; _ \n   \"If a file with the same name already exists, \" &amp; _ \n   \"it will be overwritten with this copy of the file.\" \n   If MsgBox(strPrompt, vbYesNo + vbQuestion) = vbYes Then \n    objItem.SaveAs Environ(\"HOMEPATH\") &amp; \"\\My Documents\\\" &amp; strname &amp; \".msg\", olMSG \n   End If \n  Else \n   MsgBox \"There is no current active inspector.\" \n  End If \n End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "edited": false, "score": 0, "creation_date": 1435866259, "post_id": 31171260, "comment_id": 50391410, "body": "With this macro, how would I go about and setting up the rule for the emails that are already existing. The emails that I currently have in this specific sub folder, how would I create the rule so that it  says to just look at the folder now, rather than setting a rule for when an email arrives?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "edited": false, "score": 0, "creation_date": 1436116522, "post_id": 31171260, "comment_id": 50464523, "body": "@novicevba you don&#39;t need rule just run the macro as it is."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1435783283, "creation_date": 1435783283, "answer_id": 31171260, "question_id": 31165671, "link": "https://stackoverflow.com/questions/31165671/move-emails-from-subfolder-to-hard-drive/31171260#31171260", "title": "Move emails from subfolder to hard drive", "body": "<p>This should allow you to select outlook folder and hard drive folder, All emails in that folder and all sub folders will be saved to your HD</p>\n\n<pre><code>Option Explicit\nSub SaveMsgToFolders()\n    Dim i, j, n As Long\n    Dim sSubject As String\n    Dim sName As String\n    Dim sFile As String\n    Dim sReceived As String\n    Dim sPath As String\n    Dim sFolder As String\n    Dim sFolderPath As String\n    Dim SaveFolder As String\n    Dim Prompt As String\n    Dim Title As String\n    Dim iNameSpace As NameSpace\n    Dim olApp As Outlook.Application\n    Dim SubFolder As MAPIFolder\n    Dim olmItem As MailItem\n    Dim FSO, ChosenFolder As Object\n    Dim Folders As New Collection\n    Dim EntryID As New Collection\n    Dim StoreID As New Collection\n\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set olApp = Outlook.Application\n    Set iNameSpace = olApp.GetNamespace(\"MAPI\")\n    Set ChosenFolder = iNameSpace.PickFolder ' // Chose Outlook Folder\n    If ChosenFolder Is Nothing Then\nGoTo ExitSub:\n    End If\n\n    Prompt = \"Please enter the path to save all the emails to.\"\n    Title = \"Folder Specification\"\n    sPath = BrowseForFolder\n    If sPath = \"\" Then\nGoTo ExitSub:\n    End If\n    If Not Right(sPath, 1) = \"\\\" Then\n        sPath = sPath &amp; \"\\\"\n    End If\n\n    Call GetFolder(Folders, EntryID, StoreID, ChosenFolder)\n\n    For i = 1 To Folders.Count\n        sFolder = StripIllegalChar(Folders(i))\n        n = InStr(3, sFolder, \"\\\") + 1\n        sFolder = Mid(sFolder, n, 256)\n        sFolderPath = sPath &amp; sFolder &amp; \"\\\"\n        SaveFolder = Left(sFolderPath, Len(sFolderPath) - 1) &amp; \"\\\"\n        If Not FSO.FolderExists(sFolderPath) Then\n            FSO.CreateFolder (sFolderPath)\n        End If\n\n        Set SubFolder = olApp.Session.GetFolderFromID(EntryID(i), StoreID(i))\n        On Error Resume Next\n        For j = 1 To SubFolder.Items.Count\n            Set olmItem = SubFolder.Items(j)\n            sReceived = ArrangedDate(olmItem.ReceivedTime)\n            sSubject = olmItem.Subject\n            sName = StripIllegalChar(sSubject)\n            sFile = SaveFolder &amp; sReceived &amp; \"_\" &amp; sName &amp; \".msg\"\n            sFile = Left(sFile, 256)\n            olmItem.SaveAs sFile, 3\n        Next j\n        On Error GoTo 0\n    Next i\nExitSub:\nEnd Sub\n\nFunction StripIllegalChar(StrInput)\n    Dim RegX As Object\n\n    Set RegX = CreateObject(\"vbscript.regexp\")\n    RegX.Pattern = \"[\\\" &amp; Chr(34) &amp; \"\\!\\@\\#\\$\\%\\^\\&amp;\\*\\(\\)\\=\\+\\|\\[\\]\\{\\}\\`\\'\\;\\:\\&lt;\\&gt;\\?\\/\\,]\"\n    RegX.IgnoreCase = True\n    RegX.Global = True\n\n    StripIllegalChar = RegX.Replace(StrInput, \"\")\n\nExitFunction:\n    Set RegX = Nothing\nEnd Function\n\n\nFunction ArrangedDate(sDateInput)\n    Dim sFullDate As String\n    Dim sFullTime As String\n    Dim sAMPM As String\n    Dim sTime As String\n    Dim sYear As String\n    Dim sMonthDay As String\n    Dim sMonth As String\n    Dim sDay As String\n    Dim sDate As String\n    Dim sDateTime As String\n    Dim RegX As Object\n\n    Set RegX = CreateObject(\"vbscript.regexp\")\n\n    If Not Left(sDateInput, 2) = \"10\" And _\n    Not Left(sDateInput, 2) = \"11\" And _\n    Not Left(sDateInput, 2) = \"12\" Then\n        sDateInput = \"0\" &amp; sDateInput\n    End If\n\n    sFullDate = Left(sDateInput, 10)\n\n    If Right(sFullDate, 1) = \" \" Then\n        sFullDate = Left(sDateInput, 9)\n    End If\n\n    sFullTime = Replace(sDateInput, sFullDate &amp; \" \", \"\")\n\n    If Len(sFullTime) = 10 Then\n        sFullTime = \"0\" &amp; sFullTime\n    End If\n\n    sAMPM = Right(sFullTime, 2)\n    sTime = sAMPM &amp; \"-\" &amp; Left(sFullTime, 8)\n    sYear = Right(sFullDate, 4)\n    sMonthDay = Replace(sFullDate, \"/\" &amp; sYear, \"\")\n    sMonth = Left(sMonthDay, 2)\n    sDay = Right(sMonthDay, Len(sMonthDay) - 3)\n    If Len(sDay) = 1 Then\n        sDay = \"0\" &amp; sDay\n    End If\n    sDate = sYear &amp; \"-\" &amp; sMonth &amp; \"-\" &amp; sDay\n    sDateTime = sDate &amp; \"_\" &amp; sTime\n    RegX.Pattern = \"[\\:\\/\\ ]\"\n    RegX.IgnoreCase = True\n    RegX.Global = True\n\n    ArrangedDate = RegX.Replace(sDateTime, \"-\")\n\nExitFunction:\n    Set RegX = Nothing\nEnd Function\n\nSub GetFolder(Folders As Collection, EntryID As Collection, StoreID As Collection, Fld As MAPIFolder)\n    Dim SubFolder       As MAPIFolder\n    Folders.Add Fld.FolderPath\n    EntryID.Add Fld.EntryID\n    StoreID.Add Fld.StoreID\n    For Each SubFolder In Fld.Folders\n        GetFolder Folders, EntryID, StoreID, SubFolder\n    Next SubFolder\nExitSub:\n    Set SubFolder = Nothing\nEnd Sub\n\n\nFunction BrowseForFolder(Optional OpenAt As String) As String\n    Dim ShellApp As Object\n    Set ShellApp = CreateObject(\"Shell.Application\"). _\n    BrowseForFolder(0, \"Please choose a folder\", 0, OpenAt)\n\n    On Error Resume Next\n    BrowseForFolder = ShellApp.self.Path\n    On Error GoTo 0\n\n    Select Case Mid(BrowseForFolder, 2, 1)\n    Case Is = \":\"\n        If Left(BrowseForFolder, 1) = \":\" Then\n            BrowseForFolder = \"\"\n        End If\n    Case Is = \"\\\"\n        If Not Left(BrowseForFolder, 1) = \"\\\" Then\n            BrowseForFolder = \"\"\n        End If\n    Case Else\n        BrowseForFolder = \"\"\n    End Select\n\nExitFunction:\n    Set ShellApp = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2221, "favorite_count": 0, "closed_date": 1435896103, "answer_count": 2, "score": 0, "last_activity_date": 1592898296, "creation_date": 1435764652, "last_edit_date": 1592898296, "question_id": 31165671, "link": "https://stackoverflow.com/questions/31165671/move-emails-from-subfolder-to-hard-drive", "closed_reason": "Not suitable for this site", "title": "Move emails from subfolder to hard drive", "body": "<p>I am curious to know how to move emails from a specific subfolder to my hard drive. Basically, my inbox has about 20 subfolders. I want to be able to move all the emails from subfolder1 to my hard drive. </p>\n\n<p>Is there a macro to specifically go to that folder and move all the emails onto my hard drive? Granted I do want to keep all the emails in .msg rather than being a .txt file.</p>\n"}, {"tags": ["vba", "powerpoint-2010"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5070308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a9f393a9cc2fe27c5242595f1940038?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy 74897", "link": "https://stackoverflow.com/users/5070308/jimmy-74897"}, "edited": false, "score": 0, "creation_date": 1435934550, "post_id": 31186905, "comment_id": 50420564, "body": "Works fine. When no selection is made, it produce an error message <b>Selection ( unknown member) : Invalid request. This view doesn&#39;t support selection.</b> I tried add an if condition to check if a selection is made, can&#39;t find the proper method."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 13, "user_id": 5070308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a9f393a9cc2fe27c5242595f1940038?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy 74897", "link": "https://stackoverflow.com/users/5070308/jimmy-74897"}, "edited": false, "score": 0, "creation_date": 1435936132, "post_id": 31186905, "comment_id": 50421419, "body": "That was just a bit of example code to demonstrate how to split the text from a shape.  In your case, you&#39;d replace &quot;If .HasText Then MsgBox .TextRange.Text&quot; with &quot;If .HasText Then LineByLine(s)&quot;  (and change LineByLine to accept a shape reference as a parameter ... LineByLine(oSh as Shape)  ... and make any internal changes to the sub to use oSh instead of the current selection.  Use your CreateShape code within LineByLine to create a shape with the text that it&#39;s current displaying in a msgbox"}, {"owner": {"reputation": 13, "user_id": 5070308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a9f393a9cc2fe27c5242595f1940038?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy 74897", "link": "https://stackoverflow.com/users/5070308/jimmy-74897"}, "edited": false, "score": 0, "creation_date": 1435980772, "post_id": 31186905, "comment_id": 50433979, "body": "That worked. Inside HelloWorldMacro() , <b>If .HasText Then LineByLine(.TextRange) Exit Sub End If</b>. And accept the parameter as <b>LineByLine(oSh As TextRange)</b>. Inside LineByLine() call the <b>create_shape(.Lines(x).Text)</b>  to create shape with text."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1435846248, "creation_date": 1435846248, "answer_id": 31186905, "question_id": 31165622, "link": "https://stackoverflow.com/questions/31165622/how-to-split-the-content-placeholder-line-by-line-into-a-text-shape-powerpoint-2/31186905#31186905", "title": "How to split the content placeholder line by line into a text shape powerpoint 2010", "body": "<p>This shows you how to get each line or paragraph in a text box:</p>\n\n<pre><code>Sub LineByLine()\n    Dim oSh As Shape\n    Dim x As Long\n    ' for example only:\n    Set oSh = ActiveWindow.Selection.ShapeRange(1)\n\n    With oSh.TextFrame.TextRange\n        For x = 1 To .Paragraphs.Count\n            MsgBox .Paragraphs(x).Text\n        Next\n        For x = 1 To .Lines.Count\n            MsgBox .Lines(x).Text\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5070308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a9f393a9cc2fe27c5242595f1940038?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy 74897", "link": "https://stackoverflow.com/users/5070308/jimmy-74897"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1372, "favorite_count": 1, "accepted_answer_id": 31186905, "answer_count": 1, "score": 1, "last_activity_date": 1435846248, "creation_date": 1435764526, "last_edit_date": 1435803322, "question_id": 31165622, "link": "https://stackoverflow.com/questions/31165622/how-to-split-the-content-placeholder-line-by-line-into-a-text-shape-powerpoint-2", "title": "How to split the content placeholder line by line into a text shape powerpoint 2010", "body": "<p>I am new to vb and power point , trying to run a macro in <strong>power point 2010</strong>. What i am trying to achieve is, when the macros is run, it should <strong>split the contents in the content placeholder area line by line, and placing each line in a new text box shape.</strong> </p>\n\n<p>I had done some work, but not able to move forward. The macro function is below</p>\n\n<pre><code>Sub HelloWorldMacro()\n\nDim Sld As Slide\nDim Shp As Shape\n' Current slide\nSet Sld = ActivePresentation.Slides(ActiveWindow.View.Slide.SlideIndex)\n\nFor Each s In Sld.Shapes\n    ' Condition - not to grab contents from title area.\n    If s.Name &lt;&gt; \"Title 1\" Then\n        If s.HasTextFrame Then\n            With s.TextFrame\n                If .HasText Then MsgBox .TextRange.Text\n            End With\n        End If\n    End If\nNext\nEnd Sub \n</code></pre>\n\n<p>With this i been able to grab the text from content area into a msg box. But not able to split it and place it in a text shape area.</p>\n\n<p>Also done tried some shape create function, but not able to combine these.</p>\n\n<pre><code>Sub create_shape()\n\nDim Sld As Slide\nDim Shp As Shape\n\nSet Sld = ActivePresentation.Slides(ActiveWindow.View.Slide.SlideIndex)\n\nSet Shp = Sld.Shapes.AddShape(Type:=msoShapeRectangle, _\n    Left:=24, Top:=65.6, Width:=672, Height:=26.6)\n\n    Shp.Name = \"My Header\"\n    Shp.Line.Visible = msoFalse\n    Shp.Fill.ForeColor.RGB = RGB(184, 59, 29)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "printing", "compiler-errors"], "comments": [{"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1435765931, "post_id": 31165503, "comment_id": 50340289, "body": "I don&#39;t believe the Activate method accepts any parameters such as the &quot;&quot; you are applying here. I&#39;d also trim the space following the name, &quot;Stock.xlsm &quot;"}], "answers": [{"comments": [{"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1435790094, "post_id": 31166423, "comment_id": 50353289, "body": "Thanks for your answer, this may be where I have edited the code for use on stackoverflow though rather than the cause of the error, what else can you see wrong?"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1435792188, "last_edit_date": 1435792188, "creation_date": 1435766685, "answer_id": 31166423, "question_id": 31165503, "link": "https://stackoverflow.com/questions/31165503/excel-vba-print-sheet-code-not-working/31166423#31166423", "title": "Excel VBA: Print sheet code not working", "body": "<p>The error refers to this line:</p>\n\n<pre><code>Sheets(Array\"sheet1\", \"sheet2\", \"sheet3\", \"sheet4\", \"sheet5\", \"sheet6\")).Select\n</code></pre>\n\n<p>Replace it with this:</p>\n\n<pre><code>Sheets(Array(\"sheet1\", \"sheet2\", \"sheet3\", \"sheet4\", \"sheet5\", \"sheet6\")).Select\n</code></pre>\n\n<p>As @David W pointed out, this line generates the same error:</p>\n\n<pre><code>Windows(\"Stock.xlsm \").Activate \"\"\n</code></pre>\n\n<p>It should be:</p>\n\n<pre><code>Windows(\"Stock.xlsm\").Activate\n</code></pre>\n\n<p>The extra space in \"Stock.xlsm \" generates a Subscript out of range error</p>\n"}], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435792188, "creation_date": 1435764218, "question_id": 31165503, "link": "https://stackoverflow.com/questions/31165503/excel-vba-print-sheet-code-not-working", "title": "Excel VBA: Print sheet code not working", "body": "<p>Can someone please help me, I have the following code:</p>\n\n<pre><code>Sub CreateDealerCopy()\n    Dim centreid\n    Dim sheetno As Integer\n    Dim modelno\n    Dim modellist As New Collection\n\n    Application.ScreenUpdating = False\n    Sheets(\"-Summary\").Select\n    centreid = Range(\"B5\").Value\n    Sheets(\"-Summary\").Copy Before:=Sheets(1)\n    Cells.Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n    Application.CutCopyMode = False\n    Selection.Validation.Delete\n    ActiveSheet.Shapes.Range(Array(\"Rounded Rectangle 1\")).Select\n    Selection.Delete\n    ActiveSheet.Shapes.Range(Array(\"Rounded Rectangle 2\")).Select\n    Selection.Delete\n    ActiveSheet.Name = \"Summary\"\n    Range(\"A1\").Select\n\n    Sheets(\"Model Summary\").Select\n\n    modellist.Add \"field1\"\n    modellist.Add \"field2\"\n    modellist.Add \"field3\"\n    modellist.Add \"field3\"\n    modellist.Add \"field5\"\n\n    sheetno = 1\n\n    For Each modelno In modellist\n        Sheets(\"Model Summary\").Select\n        Range(\"B11\").Value = modelno\n        Sheets(\"Model Summary\").Copy After:=Sheets(sheetno)\n        Cells.Select\n        Selection.Copy\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n        Application.CutCopyMode = False\n        Selection.Validation.Delete\n        ActiveSheet.Name = modelno\n        Range(\"A1\").Select\n\n        sheetno = sheetno + 1\n\n    Next\n\n    Sheets(Array(\"sheet1\", \"sheet2\", \"sheet3\", \"sheet4\", \"sheet5\", \"sheet6\")).Copy\n\n    ActiveWorkbook.SaveAs Filename:=ThisWorkbook.Path &amp; \"\\NewFolder\\\" &amp; centreid &amp; \"_\" &amp; Format$(Date, \"(dd-mm-yyyy)\") &amp; \"_SP\" &amp; \".xlsx\", _\n    FileFormat:=51\n\n    ActiveWorkbook.Close\n\n    Windows(\"Stock.xlsm \").Activate \"\"\n    Sheets(Array\"sheet1\", \"sheet2\", \"sheet3\", \"sheet4\", \"sheet5\", \"sheet6\")).Select\n    Sheets(\"sheet1\").Activate\n    Application.DisplayAlerts = False\n    ActiveWindow.SelectedSheets.Delete\n    Application.DisplayAlerts = True\n\n    'Dim message As Integer\n    'message = MsgBox(\"Copy created\", vbOKOnly)\n\n    End Sub\n\n\nSub CreateAllPeople()\n\nDim people\n\nSheets(\"-sheet1\").Select\n\nRange(\"B5\").Select\n\nSet people = Range(\"B5\")\n\nRange(\"AE10\").Select\n\nDo While ActiveCell.Value &lt;&gt; \"\"\n\npeople = ActiveCell.Value\n\nRange(\"B5\").Value = people\n\nCreateDealerCopy\n\nActiveCell.Offset(1, 0).Select\n\nLoop            \nEnd Sub\n</code></pre>\n\n<p>And when I try to run it I get the following error:</p>\n\n<p><img src=\"https://i.stack.imgur.com/AgVoL.jpg\" alt=\"enter image description here\"></p>\n\n<p>I think it has something to do with the following line but am not sure how to solve the issue or what the issue is:</p>\n\n<pre><code>Windows(\"Stock.xlsm \").Activate \"\"\n</code></pre>\n"}, {"tags": ["html", "vba", "excel", "view-source"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1435766125, "post_id": 31165426, "comment_id": 50340407, "body": "Is it getting too many nodes?"}, {"owner": {"reputation": 5, "user_id": 5035847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jfOw2ohmR6U/AAAAAAAAAAI/AAAAAAAAABQ/4cV0NTNTqH4/photo.jpg?sz=128", "display_name": "gaurav koli", "link": "https://stackoverflow.com/users/5035847/gaurav-koli"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1435831915, "post_id": 31165426, "comment_id": 50369189, "body": "I am new to vba but after researching about nodes in google, i can say &#39;YES&#39; there are many nodes in the code. using my above code i can fetch all the text (for ex. EOL (product/component)) in a different sheet and then i can fetch the required text in my main sheet. But that doesnt seem to be the best way to make my macro work."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5035847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jfOw2ohmR6U/AAAAAAAAAAI/AAAAAAAAABQ/4cV0NTNTqH4/photo.jpg?sz=128", "display_name": "gaurav koli", "link": "https://stackoverflow.com/users/5035847/gaurav-koli"}, "edited": false, "score": 0, "creation_date": 1435921206, "post_id": 31195049, "comment_id": 50412343, "body": "the above code doesnt seems to be working. Is there any way to move on to the next Node. <code>codeSet hcol = ie.document.getElementsByTagName(&quot;td&quot;) For Each inps In hcol If inps.innerText = &quot;Requesting Group&quot; Then **&#39;move to next node** &#39;Sheets(&quot;Sheet2&quot;).Range(&quot;B&quot; &amp; j).Value = inps.innertext j = j + 1 End If Nextcode</code>"}, {"owner": {"reputation": 5, "user_id": 5035847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jfOw2ohmR6U/AAAAAAAAAAI/AAAAAAAAABQ/4cV0NTNTqH4/photo.jpg?sz=128", "display_name": "gaurav koli", "link": "https://stackoverflow.com/users/5035847/gaurav-koli"}, "edited": false, "score": 0, "creation_date": 1435921451, "post_id": 31195049, "comment_id": 50412492, "body": "it doesnt pull anything"}, {"owner": {"reputation": 5, "user_id": 5035847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jfOw2ohmR6U/AAAAAAAAAAI/AAAAAAAAABQ/4cV0NTNTqH4/photo.jpg?sz=128", "display_name": "gaurav koli", "link": "https://stackoverflow.com/users/5035847/gaurav-koli"}, "edited": false, "score": 0, "creation_date": 1435921688, "post_id": 31195049, "comment_id": 50412632, "body": "for <b>it</b> variable it pulls &quot;Catalog Manager/Sales&quot; and then it doesnt satisfy the IF condition mentioned and exits IF and searches for next inps.id = &quot;SPFieldChoice&quot;"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 5, "user_id": 5035847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jfOw2ohmR6U/AAAAAAAAAAI/AAAAAAAAABQ/4cV0NTNTqH4/photo.jpg?sz=128", "display_name": "gaurav koli", "link": "https://stackoverflow.com/users/5035847/gaurav-koli"}, "edited": false, "score": 0, "creation_date": 1435922292, "post_id": 31195049, "comment_id": 50412986, "body": "I made some changes, please try it now"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1435922263, "last_edit_date": 1435922263, "creation_date": 1435873005, "answer_id": 31195049, "question_id": 31165426, "link": "https://stackoverflow.com/questions/31165426/need-to-pull-details-specific-details-from-web-page-using-vba/31195049#31195049", "title": "Need to pull details specific details from web page using vba", "body": "<p>This is just a suggestion (I can't verify the answer) but I wanted to illustrate what you could try:</p>\n\n<pre><code>Set hcol = Set hcol = ie.document.getElementsByTagName(\"td\")\n\nFor Each inps In hcol\n    If inps.ID = \"SPFieldChoice\" Then\n        If InStr(1, inps.innerHTML, \"Requesting Group\") &gt; 0 Or InStr(1, it, \"Reason for change\") &gt; 0 Then\n            Sheets(\"Sheet2\").Range(\"A\" &amp; j).Value = inps.innerText\n        End If\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5035847, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jfOw2ohmR6U/AAAAAAAAAAI/AAAAAAAAABQ/4cV0NTNTqH4/photo.jpg?sz=128", "display_name": "gaurav koli", "link": "https://stackoverflow.com/users/5035847/gaurav-koli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 31195049, "answer_count": 1, "score": -1, "last_activity_date": 1436269265, "creation_date": 1435764040, "last_edit_date": 1436269265, "question_id": 31165426, "link": "https://stackoverflow.com/questions/31165426/need-to-pull-details-specific-details-from-web-page-using-vba", "title": "Need to pull details specific details from web page using vba", "body": "<p>I need to pull the text 'Catalog Manager/ Sales' &amp; 'EOL (product/component)' from the view source tab using VBA.</p>\n\n<p>Below is the view source code:</p>\n\n<pre><code>&lt;tr&gt;\n    &lt;td nowrap=\"true\" valign=\"top\" width=\"165px\" class=\"ms-formlabel\"&gt;&lt;h3 class=\"ms-standardheader\"&gt;&lt;a name=\"SPBookmark_Requesting_x0020_Group\"&gt;&lt;/a&gt;Requesting Group&lt;/h3&gt;&lt;/td&gt;\n    &lt;td valign=\"top\" class=\"ms-formbody\" width=\"450px\" id=\"SPFieldChoice\"&gt;\n        &lt;!-- FieldName=\"Requesting Group\"\n             FieldInternalName=\"Requesting_x0020_Group\"\n             FieldType=\"SPFieldChoice\"\n          --&gt;\n        Catalog Managers/ Sales\n    &lt;/td&gt;\n&lt;/tr&gt;\n\n&lt;tr&gt;\n    &lt;td nowrap=\"true\" valign=\"top\" width=\"165px\" class=\"ms-formlabel\"&gt;&lt;h3 class=\"ms-standardheader\"&gt;&lt;a name=\"SPBookmark_Reason_x0020_for_x0020_change\"&gt;&lt;/a&gt;Reason for change&lt;/h3&gt;&lt;/td&gt;\n    &lt;td valign=\"top\" class=\"ms-formbody\" width=\"450px\" id=\"SPFieldChoice\"&gt;\n        &lt;!-- FieldName=\"Reason for change\"\n             FieldInternalName=\"Reason_x0020_for_x0020_change\"\n             FieldType=\"SPFieldChoice\"\n          --&gt;\n        EOL (product/component)\n    &lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>There are multiple <code>id=\"SPFieldChoice\"</code> and i need to pull the details only for 'Requesting Group' and  'Reason for change'.</p>\n\n<p>I am writing below code to fetch the details in excel but it is not specific to my requirements.</p>\n\n<pre><code>Set hcol = ie.document.getElementsByTagName(\"td\")\n    For Each inps In hcol\n        If inps.ID = \"SPFieldChoice\" Then\n            Sheets(\"Sheet2\").Range(\"A\" &amp; j).Value = inps.innerText\n        End If\n    Next\n</code></pre>\n\n<p>Need a code which can pull only the required details mentioned above.</p>\n"}, {"tags": ["vba", "excel", "project", "notepad"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1435763724, "post_id": 31165161, "comment_id": 50338785, "body": "I would recommend browsing this: <a href=\"http://www.mrexcel.com/forum/excel-questions/46163-open-notepad-form-visual-basic-applications.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1435763771, "post_id": 31165161, "comment_id": 50338823, "body": "Also, this is not a forum for asking someone to write code for you.  You should provide the code that you have tried and the exact problem you are having with the code and someone will gladly help you pinpoint the issue and resolve it."}, {"owner": {"reputation": 8749, "user_id": 990750, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/nIvmG.jpg?s=128&g=1", "display_name": "Tarik", "link": "https://stackoverflow.com/users/990750/tarik"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1435764135, "post_id": 31165161, "comment_id": 50339090, "body": "@OpiesDad I think the question is focused enough on a particular issue he is facing for which he has no clue."}, {"owner": {"reputation": 153, "user_id": 4504918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6fcbe6855dc7a523bbb1b4e2c14d7cc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4504918/david"}, "edited": false, "score": 0, "creation_date": 1435765292, "post_id": 31165161, "comment_id": 50339874, "body": "I have the code but I want to modify it so I&#39;m not the one saving it one someone else&#39;s computer. I want them to be able to chose to save it or not. The code is very similar to the other posts so I didn&#39;t post it. My problem is not with fixing my code but rather the syntax on how to just open and view the file without saving it."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 4504918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6fcbe6855dc7a523bbb1b4e2c14d7cc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4504918/david"}, "edited": false, "score": 0, "creation_date": 1435765307, "post_id": 31165367, "comment_id": 50339880, "body": "Thanks! I will try it out"}], "tags": [], "owner": {"reputation": 8749, "user_id": 990750, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/nIvmG.jpg?s=128&g=1", "display_name": "Tarik", "link": "https://stackoverflow.com/users/990750/tarik"}, "is_accepted": false, "score": 2, "last_activity_date": 1435763878, "creation_date": 1435763878, "answer_id": 31165367, "question_id": 31165161, "link": "https://stackoverflow.com/questions/31165161/open-and-write-to-notepad-from-excel-vba/31165367#31165367", "title": "Open and Write to Notepad from excel VBA", "body": "<p>Use the following code to open notepad and type into it:</p>\n\n<pre><code>Dim myApp As String\nmyApp = Shell(\"Notepad\",    vbNormalFocus)\nSendKeys \"test\", True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153, "user_id": 4504918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6fcbe6855dc7a523bbb1b4e2c14d7cc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4504918/david"}, "edited": false, "score": 0, "creation_date": 1435765848, "post_id": 31165862, "comment_id": 50340233, "body": "Yes that is what I am having trouble with, if the focus gets off of the notepad for whatever reason the keys are being sent somewhere else. Very helpful code though! Thanks"}, {"owner": {"reputation": 2080, "user_id": 3100456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3749442ae7500c62ca244a0631024055?s=128&d=identicon&r=PG&f=1", "display_name": "Orphid", "link": "https://stackoverflow.com/users/3100456/orphid"}, "reply_to_user": {"reputation": 153, "user_id": 4504918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6fcbe6855dc7a523bbb1b4e2c14d7cc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4504918/david"}, "edited": false, "score": 0, "creation_date": 1435767263, "post_id": 31165862, "comment_id": 50341156, "body": "@David You could just write the message as a text file, and then pass its path to notepad on the command line."}], "tags": [], "owner": {"reputation": 2080, "user_id": 3100456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3749442ae7500c62ca244a0631024055?s=128&d=identicon&r=PG&f=1", "display_name": "Orphid", "link": "https://stackoverflow.com/users/3100456/orphid"}, "is_accepted": true, "score": 1, "last_activity_date": 1490293309, "last_edit_date": 1490293309, "creation_date": 1435765158, "answer_id": 31165862, "question_id": 31165161, "link": "https://stackoverflow.com/questions/31165161/open-and-write-to-notepad-from-excel-vba/31165862#31165862", "title": "Open and Write to Notepad from excel VBA", "body": "<p>Similar to Tarik's answer, I would probably use something like the following:</p>\n\n<pre><code>In a class module called NotepadManager:\n\n    Option Explicit\n\nPrivate Const CAPTION$ = \"Notepad\"\n\nPrivate MHwnd As Long\n\n'based on code lifted from:\n'http://www.pbdr.com/vbtips/api/FindCloseAPI.htm\n\n\n    Private Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" _\n      (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Long\n    Private Declare Function GetWindowText Lib \"user32\" Alias \"GetWindowTextA\" _\n      (ByVal hWnd As Long, ByVal lpString As String, _\n      ByVal aint As Long) As Long\n    Private Declare Function GetWindow Lib \"user32\" _\n      (ByVal hWnd As Long, ByVal wCmd As Long) As Long\n    Private Declare Function EnumWindows Lib \"user32\" _\n      (ByVal wndenmprc As Long, ByVal lParam As Long) As Long\n    Private Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" _\n      (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, _\n      lParam As Any) As Long\n    Private Declare Function SetForegroundWindow Lib \"user32\" ( _\n     ByVal hWnd As Long) As Long\n\n    Private Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\n   Private Const WM_CLOSE = &amp;H10\n   Private Const GW_HWNDFIRST = 0\n   Private Const GW_HWNDLAST = 1\n   Private Const GW_HWNDNEXT = 2\n   Private Const GW_HWNDPREV = 3\n   Private Const GW_OWNER = 4\n   Private Const GW_CHILD = 5\n   Private Const GW_MAX = 5\n\n   Private mstrTarget As String\n   Private mblnSuccess As Boolean\n\n\nPublic Sub writeMessageToNotepad(ByRef message As String)\n\nfocusNotepad\n\nSleep 2000\n\nSendKeys (message)\n\nEnd Sub\n\nPublic Sub startNotepad()\n\nDim ret\n\nret = Shell(\"notepad\", vbNormalFocus)\n\nEnd Sub\n\n\nPublic Sub focusNotepad()\n\n        If MHwnd = 0 Then\n            MHwnd = hwndFindWindow(CAPTION$)\n        End If\n\n        If MHwnd = 0 Then MsgBox \"Error: Cannot find notepad.\"\n\n        Debug.Print SetForegroundWindow(MHwnd)\n\nEnd Sub\n\n\n\nPrivate Function hwndFindWindow(strApplicationTitle As String) As Long\n\n   Dim hWndTmp As Long\n   Dim nRet As Integer\n   Dim TitleTmp As String\n   Dim TitlePart As String\n   Dim MyWholeTitle As String\n   Dim mCounter As Long\n   Dim hWndOver As Integer\n   Dim sClassName As String * 100\n\n   hwndFindWindow = False\n\n   TitlePart = UCase$(strApplicationTitle)\n\n   'loop through all the open windows\n   hWndTmp = FindWindow(0&amp;, 0&amp;)\n\n   Do Until hWndTmp = 0\n\n      TitleTmp = Space$(256)\n      nRet = GetWindowText(hWndTmp, TitleTmp, Len(TitleTmp))\n\n      If nRet Then\n         'retrieve window title\n         TitleTmp = UCase$(VBA.Left$(TitleTmp, nRet))\n         'compare window title &amp; strApplicationTitle\n         If InStr(TitleTmp, TitlePart) Then\n            hwndFindWindow = FindWindow(vbEmpty, TitleTmp)\n            Exit Do\n         End If\n      End If\n\n      hWndTmp = GetWindow(hWndTmp, GW_HWNDNEXT)\n      mCounter = mCounter + 1\n\n   Loop\n\n   End Function\n\n\nPrivate Function EnumCallback(ByVal app_hWnd As Long, _\n  ByVal param As Long) As Long\n\n   Dim buf As String * 256\n   Dim title As String\n   Dim length As Long\n\n   ' Checks a returned task to determine if App should be closed\n\n   ' get window's title.\n   length = GetWindowText(app_hWnd, buf, Len(buf))\n   title = Left$(buf, length)\n\n   ' determine if target window.\n   If InStr(UCase(title), UCase(mstrTarget)) &lt;&gt; 0 Then\n      ' Kill window.\n      SendMessage app_hWnd, WM_CLOSE, 0, 0\n      mblnSuccess = True\n   End If\n\n   ' continue searching.\n   EnumCallback = 1\n\nEnd Function\n</code></pre>\n\n<p>And in a normal module:</p>\n\n<pre><code>Private Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\nSub test()\n\n\nDim m As New NotepadManager\n\nm.startNotepad\n\nm.focusNotepad\n\nSleep 2000\n\nm.writeMessageToNotepad \"My message\"\n\nDebug.Print \"done\"\n\nEnd Sub\n</code></pre>\n\n<p>However, I've often found that ensuring you have window focus is the most difficult thing when you have a user interacting with the machine at the time.</p>\n"}], "owner": {"reputation": 153, "user_id": 4504918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6fcbe6855dc7a523bbb1b4e2c14d7cc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4504918/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17099, "favorite_count": 3, "accepted_answer_id": 31165862, "answer_count": 2, "score": 2, "last_activity_date": 1561622877, "creation_date": 1435763347, "last_edit_date": 1561622877, "question_id": 31165161, "link": "https://stackoverflow.com/questions/31165161/open-and-write-to-notepad-from-excel-vba", "title": "Open and Write to Notepad from excel VBA", "body": "<p>I need to open notepad and write my results from my macro to it. I want to open notepad and write to it, and have the user review and if he or she wants to save it then save it wherever they like. Instead of writing to it and saving on the computer all in the code.</p>\n\n<p>Thanks </p>\n"}, {"tags": ["excel", "vba", "debugging", "runtime-error"], "comments": [{"owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1435763541, "post_id": 31165028, "comment_id": 50338657, "body": "Why do you have <code>Target As Excel.Range</code> instead of <code>Target As Range</code>?"}, {"owner": {"reputation": 4133, "user_id": 3555155, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5c472b8a25188271f70a01c1827015ff?s=128&d=identicon&r=PG", "display_name": "CMPSoares", "link": "https://stackoverflow.com/users/3555155/cmpsoares"}, "reply_to_user": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1435764434, "post_id": 31165028, "comment_id": 50339311, "body": "I tried it out but none of both where working."}, {"owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1435767129, "post_id": 31165028, "comment_id": 50341083, "body": "Strange, I just tried both and they both work for me. Googling the error message doesn&#39;t help much either. Try something as simple as <code>Range(&quot;A1&quot;).Value = 5</code> and see if that gives you errors."}, {"owner": {"reputation": 4133, "user_id": 3555155, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5c472b8a25188271f70a01c1827015ff?s=128&d=identicon&r=PG", "display_name": "CMPSoares", "link": "https://stackoverflow.com/users/3555155/cmpsoares"}, "edited": false, "score": 0, "creation_date": 1435773614, "post_id": 31165028, "comment_id": 50344712, "body": "Don&#39;t consider it duplicate because after searching a lot I didn&#39;t come across that question. It is though related. Thank you a lot! ;-)"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1435773904, "post_id": 31165028, "comment_id": 50344878, "body": "Definitely a duplicate.  It&#39;s identical in cause, effect, and solution.  It is the 3rd result in votes when <a href=\"http://stackoverflow.com/search?tab=votes&amp;q=%5bexcel%5d%20worksheet_change\">searching for</a> <code>[excel] worksheet_change</code> on SO.  Of course I link to that answer several times a week so I know how to find it. :)"}, {"owner": {"reputation": 4133, "user_id": 3555155, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5c472b8a25188271f70a01c1827015ff?s=128&d=identicon&r=PG", "display_name": "CMPSoares", "link": "https://stackoverflow.com/users/3555155/cmpsoares"}, "edited": false, "score": 0, "creation_date": 1435775049, "post_id": 31165028, "comment_id": 50345543, "body": "That explains a lot! :-p"}], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 1, "last_activity_date": 1435773428, "last_edit_date": 1495539987, "creation_date": 1435773428, "answer_id": 31168438, "question_id": 31165028, "link": "https://stackoverflow.com/questions/31165028/excel-add-the-date-of-the-last-modification-on-a-row/31168438#31168438", "title": "Excel: Add the date of the last modification on a row", "body": "<p>You are creating an infinite loop by changing a value inside a <code>Worksheet_Change</code> event without disabling events first.  When I do something similar, I get a range of errors from <code>Out of stack space</code> first to <code>Method Range failed...</code>.</p>\n\n<p>Do this instead:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Application.EnableEvents = False\n\n    ThisRow = Target.Row\n    If Target.Row &gt; 1 Then Range(\"K\" &amp; ThisRow).Value = Now()\n\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Related post: <a href=\"https://stackoverflow.com/questions/13860894/ms-excel-crashes-when-vba-code-runs/13861640#13861640\">MS Excel crashes when vba code runs</a></p>\n"}], "owner": {"reputation": 4133, "user_id": 3555155, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5c472b8a25188271f70a01c1827015ff?s=128&d=identicon&r=PG", "display_name": "CMPSoares", "link": "https://stackoverflow.com/users/3555155/cmpsoares"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 1, "closed_date": 1435821626, "accepted_answer_id": 31168438, "answer_count": 1, "score": 0, "last_activity_date": 1489750425, "creation_date": 1435762990, "last_edit_date": 1489750425, "question_id": 31165028, "link": "https://stackoverflow.com/questions/31165028/excel-add-the-date-of-the-last-modification-on-a-row", "closed_reason": "Duplicate", "title": "Excel: Add the date of the last modification on a row", "body": "<p>I'm trying to add the date and time of the last time a row was modified to a specific column of that row with the following VBA Script:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n    ThisRow = Target.Row\n    If Target.Row &gt; 1 Then Range(\"K\" &amp; ThisRow).Value = Now()\nEnd Sub\n</code></pre>\n\n<p>But it keeps throwing the following error:</p>\n\n<blockquote>\n  <p>Run-time error '-2147417848 (80010108)':  </p>\n  \n  <p>Method 'Value' of object 'Range' failed  </p>\n</blockquote>\n\n<p>Can anyone explain why this is happening?</p>\n"}, {"tags": ["excel", "vba", "formulas"], "comments": [{"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1435762631, "post_id": 31164584, "comment_id": 50338032, "body": "Is column D the column with the currencies? I am not sure what you mean. It looks like <code>SUMIF</code> could be your solution? Do the stores vary regularly? In case they do not: On second sheet cell B1 enter <code>=SUMIF(Sheet1.RangeWithStores;Sheet2.Shop;Sheet1.RangeWithCu&zwnj;&#8203;rrencies)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "is_accepted": false, "score": 0, "last_activity_date": 1435762890, "creation_date": 1435762890, "answer_id": 31164983, "question_id": 31164584, "link": "https://stackoverflow.com/questions/31164584/excel-fill-in-cell-basd-on-cells-enters-on-worksheet-but-only-fill/31164983#31164983", "title": "Excel - fill in cell basd on cells enters on worksheet but only fill", "body": "<p>Try to use the <code>=SUMIF()</code>-formula. See example below.</p>\n\n<p><img src=\"https://i.stack.imgur.com/auvfK.png\" alt=\"SUMIF\"></p>\n"}], "owner": {"reputation": 1, "user_id": 5070100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3371d5229c250b482102d63612c5ac1c?s=128&d=identicon&r=PG&f=1", "display_name": "dreams for stars", "link": "https://stackoverflow.com/users/5070100/dreams-for-stars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435762890, "creation_date": 1435761847, "last_edit_date": 1435762098, "question_id": 31164584, "link": "https://stackoverflow.com/questions/31164584/excel-fill-in-cell-basd-on-cells-enters-on-worksheet-but-only-fill", "title": "Excel - fill in cell basd on cells enters on worksheet but only fill", "body": "<p>I have an excel sheet that has a sheet that our sales team have to fill in. There are 31 rows and column <code>d</code> may have the same text in multiple lines.</p>\n\n<p>I need then to take all the text from column <code>d</code> and have it automatically sum the total from each text in <code>d</code>. </p>\n\n<p>Column <code>d</code> is a dropdown list.</p>\n\n<p>I don't want it to automatically go line from line, for example,\nthe data entered is:</p>\n\n<pre><code>9/12/15   ABC Store   $10.00\n9/13/15   DEF Store   $15.00\n9/14/15   ABC Store   $5.00\n9/16/15   DEF Store   $50.00\n</code></pre>\n\n<p>I need it to automatically, as they enter the data to do the following on a different sheet.</p>\n\n<pre><code>A1= ABC Store  B1= $15.00\nA2= DEF Store  B2= $65.00\n</code></pre>\n\n<p>etc. The data they choose as the enter may vary per month so I need it to understand to pick what is entered and then combine those totals if that text is choose between rows <code>5:31</code>.</p>\n\n<p>I really appreciate anyone's help.</p>\n"}, {"tags": ["mysql", "sql-server", "vba", "excel"], "comments": [{"owner": {"reputation": 2745, "user_id": 2908279, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/9BnDY.jpg?s=128&g=1", "display_name": "TTeeple", "link": "https://stackoverflow.com/users/2908279/tteeple"}, "edited": false, "score": 0, "creation_date": 1435762038, "post_id": 31164518, "comment_id": 50337603, "body": "What is the purpose of removing those aliases?  If there are 2 tables with the same column name, your query will fail because it will be too ambiguous to the engine on which column to pull from which table.  The alias helps define which column is the proper one."}, {"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1435762102, "post_id": 31164518, "comment_id": 50337643, "body": "Your example SQL is misinformed.  Single quotes are not used for table and column aliases.  Also, tag your question with the database you are actually using."}, {"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1435762263, "post_id": 31164518, "comment_id": 50337773, "body": "I suppose I should have been more clear. I do know that the alias is important and needed when using the query, but I just need the <code>&#39;B&#39;,&#39;C&#39;,&#39;D&#39;</code> fields for other purposes. I apologize for the ambiguity. (still kind of new to this site)"}, {"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1435762452, "post_id": 31164518, "comment_id": 50337903, "body": "@GordonLinoff Thanks. I don&#39;t know too much about SQL. I just wrote that short example in the same format that the string I have is. I just replaced the sensitive information with simple letters."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "is_accepted": false, "score": 1, "last_activity_date": 1435762118, "creation_date": 1435762118, "answer_id": 31164703, "question_id": 31164518, "link": "https://stackoverflow.com/questions/31164518/using-vba-to-remove-the-alias-name-from-an-sql-query-string/31164703#31164703", "title": "Using VBA to remove the alias name from an SQL query string?", "body": "<p>Are you selecting straight from the table? Going straight from the table would give you the column name, unless you're performing some function in your query. Another option is:</p>\n\n<p>Select [A] AS columnName, [B] AS ColumnName2, etc</p>\n"}, {"comments": [{"owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "edited": false, "score": 0, "creation_date": 1435762985, "post_id": 31164793, "comment_id": 50338266, "body": "Thank you. I do believe this is what I needed."}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": true, "score": 1, "last_activity_date": 1435762408, "creation_date": 1435762408, "answer_id": 31164793, "question_id": 31164518, "link": "https://stackoverflow.com/questions/31164518/using-vba-to-remove-the-alias-name-from-an-sql-query-string/31164793#31164793", "title": "Using VBA to remove the alias name from an SQL query string?", "body": "<ol>\n<li>Recover the SQL under the QueryTable like this:</li>\n</ol>\n\n<p><strong>Recover SQL:</strong></p>\n\n<pre><code>Range(\"A1\").Select 'Your query worksheet\nWith Selection.QueryTable\n    queryText = .CommandText\nEnd With\n</code></pre>\n\n<ol start=\"2\">\n<li><p>Then replace the aliases with <code>LEFT</code>, <code>RIGHT</code>, <code>INSTR</code> or <code>RegExp</code> object (if you want to learn something useful and quick use <code>RegExp</code> - regular expressions). If you need an example regex let me know in the comments. If you want to learn Regex in VBA I made a <a href=\"http://www.analystcave.com/tutorials/excel-regex-tutorial/\" rel=\"nofollow\">tutorial here</a>.</p></li>\n<li><p>Replace the query and refresh the QueryTable</p></li>\n</ol>\n\n<p><strong>Replace and refresh query</strong></p>\n\n<pre><code>Range(\"A1\").Select 'Your query worksheet\nWith Selection.QueryTable\n    .CommandText = queryText\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 503, "user_id": 4970214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/6gTMV.jpg?s=128&g=1", "display_name": "Constuntine", "link": "https://stackoverflow.com/users/4970214/constuntine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 31164793, "answer_count": 2, "score": 0, "last_activity_date": 1435762408, "creation_date": 1435761686, "question_id": 31164518, "link": "https://stackoverflow.com/questions/31164518/using-vba-to-remove-the-alias-name-from-an-sql-query-string", "title": "Using VBA to remove the alias name from an SQL query string?", "body": "<p>I have an SQL query string. In this string are multiple different columns of data, all coming from the same table. For simplicities sake, here is a short example: <code>SELECT 'A'.'B', 'A'.'C', 'A'.'D'</code>\nWhere <code>'A'</code> is the alias name. My question is: Is there a way using VBA to take that query string, and remove all instances of the alias <code>'A'</code> and just return the data columns <code>'B', 'C', 'D'</code>?\nPlease no full code, I like starting points. I like to fill in the pieces on my own. It helps the learning process.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5070056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5254aa03dce1d1aa07acbd6d7e8e0d?s=128&d=identicon&r=PG&f=1", "display_name": "CennerB", "link": "https://stackoverflow.com/users/5070056/cennerb"}, "edited": false, "score": 0, "creation_date": 1435844198, "post_id": 31165730, "comment_id": 50377569, "body": "This would work fine if the rows on both worksheets were supposed to be the same, but the rows will vary. The rows can be anywhere on the worksheet and I will need to be able to delete them if they are old and highlight the new information."}, {"owner": {"reputation": 640, "user_id": 1249645, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d493682b92e96e45bb40e04927227399?s=128&d=identicon&r=PG", "display_name": "Punith GP", "link": "https://stackoverflow.com/users/1249645/punith-gp"}, "reply_to_user": {"reputation": 1, "user_id": 5070056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5254aa03dce1d1aa07acbd6d7e8e0d?s=128&d=identicon&r=PG&f=1", "display_name": "CennerB", "link": "https://stackoverflow.com/users/5070056/cennerb"}, "edited": false, "score": 0, "creation_date": 1436273152, "post_id": 31165730, "comment_id": 50532332, "body": "You can do it if data is anywhere in the sheet, and atlast you need to filter and keep required."}], "tags": [], "owner": {"reputation": 640, "user_id": 1249645, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d493682b92e96e45bb40e04927227399?s=128&d=identicon&r=PG", "display_name": "Punith GP", "link": "https://stackoverflow.com/users/1249645/punith-gp"}, "is_accepted": false, "score": 0, "last_activity_date": 1435764795, "creation_date": 1435764795, "answer_id": 31165730, "question_id": 31164470, "link": "https://stackoverflow.com/questions/31164470/excel-vba-creating-new-spreadsheet-with-only-new-information-and-changes-highl/31165730#31165730", "title": "Excel VBA - Creating New Spreadsheet With Only New Information and Changes Highlighted", "body": "<p>Try this,<br>\nI have done with formulas, you can do the same in VBA too dynamically.  </p>\n\n<p>It can be one solution but there may be better than this.  </p>\n\n<p>refer the image below.</p>\n\n<p>It is simple match and concatenate.\n<img src=\"https://i.stack.imgur.com/Wabnz.png\" alt=\"IMAGE\"></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5070056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5254aa03dce1d1aa07acbd6d7e8e0d?s=128&d=identicon&r=PG&f=1", "display_name": "CennerB", "link": "https://stackoverflow.com/users/5070056/cennerb"}, "is_accepted": false, "score": 0, "last_activity_date": 1435844530, "creation_date": 1435844530, "answer_id": 31186280, "question_id": 31164470, "link": "https://stackoverflow.com/questions/31164470/excel-vba-creating-new-spreadsheet-with-only-new-information-and-changes-highl/31186280#31186280", "title": "Excel VBA - Creating New Spreadsheet With Only New Information and Changes Highlighted", "body": "<p>Example of what I need to be able to do:</p>\n\n<p>Worksheet 1 \"Old Information\"</p>\n\n<p>A B C D</p>\n\n<p>E F G H </p>\n\n<p>Worksheet 2 \"New Information\"</p>\n\n<p>A B C D</p>\n\n<p>E F J H</p>\n\n<p>Runs Code....</p>\n\n<p>Worksheet 1 \"Old Information\"</p>\n\n<p>A B C D</p>\n\n<p>E F G H </p>\n\n<p>Worksheet 2 \"New Information\"</p>\n\n<p>E F J H (with J highlighted)    </p>\n"}], "owner": {"reputation": 1, "user_id": 5070056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5254aa03dce1d1aa07acbd6d7e8e0d?s=128&d=identicon&r=PG&f=1", "display_name": "CennerB", "link": "https://stackoverflow.com/users/5070056/cennerb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1435844530, "creation_date": 1435761551, "question_id": 31164470, "link": "https://stackoverflow.com/questions/31164470/excel-vba-creating-new-spreadsheet-with-only-new-information-and-changes-highl", "title": "Excel VBA - Creating New Spreadsheet With Only New Information and Changes Highlighted", "body": "<p>My goal: I need to be able to take two different worksheets from different workbooks  and combine them into one workbooks with two worksheets (already completed). One of the worksheets will be from older data and be used as a masterlist, while the other worksheet will contain the older data along with new data (and changes to old data). I need to be able to get rid of the old data already on the masterlist but still check to see if there is any changes in the older data (the information will be deleted from the new information worksheet). The end goal is to have two worksheets: 1 contains the old information (already done) and 1 contains the new information and any changes to the new information (need help with).</p>\n\n<p>What I have now:</p>\n\n<p>Sub DocumentInspector()</p>\n\n<pre><code>Dim RowCount As Integer\nDim Row As Integer\nDim Column As Integer\nDim ColumnCount As Integer\nDim wbDst As Workbook\nDim wbSrc As Workbook\nDim wsSrc As Worksheet\nDim MyPath As String\nDim strFilename As String\nDim i As Integer\nDim count As Integer\nDim count2 As Integer\n\ncount2 = 0\ni = 0\ncount = 0\n\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nMyPath = \"F:\\\u00a0\\Document Inspector\" ' change to suit\n\nSet wbDst = Workbooks(\"DocumentInspector.xlsm\")\nstrFilename = Dir(MyPath &amp; \"\\*.xlsx\", vbNormal)\nIf Len(strFilename) = 0 Then Exit Sub\n\nDo Until strFilename = \"\"\n        Set wbSrc = Workbooks.Open(Filename:=MyPath &amp; \"\\\" &amp; strFilename)\n        Set wsSrc = wbSrc.Worksheets(1)\n        wsSrc.Copy After:=wbDst.Worksheets(wbDst.Worksheets.count)\n        strFilename = Dir()\nLoop\n\nwbDst.Worksheets(2).Name = \"Old Information\"\nwbDst.Worksheets(3).Name = \"New Information\"\n\n'MUST CHANGE RANGES\nRowCount = Sheets(\"New Information\").UsedRange.Rows.count\nColumnCount = Sheets(\"New Information\").UsedRange.Columns.count\n'MUST CHANGE RANGE\nFor Each x In Sheets(\"Old Information\").Range(\"A1:E10\")\n\n    For Row = 2 To RowCount\n        For Column = 1 To ColumnCount\n            If x.Value = Sheets(\"New Information\").Cells(Row, Column).Value Then\n                    Sheets(\"New Information\").Cells(Row, Column).Interior.Color = RGB(255, 255, 0)\n            End If\n        Next Column\n    Next Row\nNext\n\nFor Row = 2 To RowCount\n    For Column = 1 To ColumnCount\n\n        If Sheets(\"New Information\").Cells(Row, Column).Interior.Color = RGB(255, 255, 0) Then\n            Sheets(\"New Information\").Cells(Row, Column).Interior.Color = xlNone\n            count = count + 1\n        Else\n            Sheets(\"New Information\").Cells(Row, Column).Interior.Color = RGB(255, 255, 0)\n            count2 = count2 + 1\n        End If\n     Next Column\n\n    If count = ColumnCount Then\n        Sheets(\"New Information\").Rows(Row).EntireRow.Interior.Color = xlNone\n        Sheets(\"New Information\").Rows(Row).EntireRow.Delete\n        Row = Row - 1\n    ElseIf count2 = ColumnCount Then\n        Sheets(\"New Information\").Rows(Row).EntireRow.Interior.Color = xlNone\n        Sheets(\"New Information\").Rows(Row).EntireRow.Delete\n    End If\n    count2 = 0\n    count = 0\nNext Row\n\n\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "find"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5029563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b7c4d47d0efaeab1583c6cabcb14928?s=128&d=identicon&r=PG&f=1", "display_name": "user4888", "link": "https://stackoverflow.com/users/5029563/user4888"}, "edited": false, "score": 0, "creation_date": 1435764524, "post_id": 31165238, "comment_id": 50339375, "body": "works beautifully thank you! what exactly does tmp = Mid(str, j, 1) do? @prabukrishna"}, {"owner": {"reputation": 91, "user_id": 5029563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b7c4d47d0efaeab1583c6cabcb14928?s=128&d=identicon&r=PG&f=1", "display_name": "user4888", "link": "https://stackoverflow.com/users/5029563/user4888"}, "edited": false, "score": 0, "creation_date": 1435764664, "post_id": 31165238, "comment_id": 50339469, "body": "also, one more troubleshooting issue... is there a way to make it that if TL has MORE that 6 numbers following it, it DELETES the zero / zeros immediately following the &quot;TL-&quot;? I didn&#39;t know if that was a simple few lines or a more complex issue @PrabuKrishna"}, {"owner": {"reputation": 51, "user_id": 5012223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ba4f3b52431720a5ab72f09e37ed6d?s=128&d=identicon&r=PG&f=1", "display_name": "Prabu krishna", "link": "https://stackoverflow.com/users/5012223/prabu-krishna"}, "reply_to_user": {"reputation": 91, "user_id": 5029563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b7c4d47d0efaeab1583c6cabcb14928?s=128&d=identicon&r=PG&f=1", "display_name": "user4888", "link": "https://stackoverflow.com/users/5029563/user4888"}, "edited": false, "score": 0, "creation_date": 1435764832, "post_id": 31165238, "comment_id": 50339582, "body": "i didn&#39;t understand your second query, can you please expalin with the sample data?"}, {"owner": {"reputation": 91, "user_id": 5029563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b7c4d47d0efaeab1583c6cabcb14928?s=128&d=identicon&r=PG&f=1", "display_name": "user4888", "link": "https://stackoverflow.com/users/5029563/user4888"}, "edited": false, "score": 0, "creation_date": 1435765193, "post_id": 31165238, "comment_id": 50339818, "body": "I have added an EDIT section to the bottom of my original question to better explain with data @Prabukrishna"}, {"owner": {"reputation": 91, "user_id": 5029563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b7c4d47d0efaeab1583c6cabcb14928?s=128&d=identicon&r=PG&f=1", "display_name": "user4888", "link": "https://stackoverflow.com/users/5029563/user4888"}, "edited": false, "score": 0, "creation_date": 1435768311, "post_id": 31165238, "comment_id": 50341780, "body": "Thank you so very much for your beautiful code and explanation. Sorry if I am asking too much but even if you could give me a hint of how to do this, sometimes it will contain &quot;TL-000892 TL-000980&quot; in one cell and I just want it to grab the first section. I cannot specify by spaces because sometimes TL looks like &quot;TL - &quot;, could I have it that if it runs into a second &quot;TL&quot; it would ignore that and everything after it? @Prabukrishna"}, {"owner": {"reputation": 91, "user_id": 5029563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b7c4d47d0efaeab1583c6cabcb14928?s=128&d=identicon&r=PG&f=1", "display_name": "user4888", "link": "https://stackoverflow.com/users/5029563/user4888"}, "edited": false, "score": 0, "creation_date": 1435841272, "post_id": 31165238, "comment_id": 50375364, "body": "after trying this out with more files, if a cell contains <code>TL-000798 #3 1&#47;2&quot; Holder</code> it will output <code>TL-798312</code> . Do you know how I might alter the code so that it will not grab all of these numbers? I was thinking it could somehow fix any space issues around &quot;TL-&quot; (ie <code>TL -</code> -&gt; <code>TL-</code> , <code>TL - </code> -&gt; <code>TL-</code>, ` TL -` -&gt;<code>TL-</code> etc) and then if there is a space, &quot; &quot;, ignore everything after that... do you know a way to do this? @Prabukrishna"}, {"owner": {"reputation": 51, "user_id": 5012223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ba4f3b52431720a5ab72f09e37ed6d?s=128&d=identicon&r=PG&f=1", "display_name": "Prabu krishna", "link": "https://stackoverflow.com/users/5012223/prabu-krishna"}, "reply_to_user": {"reputation": 91, "user_id": 5029563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b7c4d47d0efaeab1583c6cabcb14928?s=128&d=identicon&r=PG&f=1", "display_name": "user4888", "link": "https://stackoverflow.com/users/5029563/user4888"}, "edited": false, "score": 0, "creation_date": 1435848193, "post_id": 31165238, "comment_id": 50380583, "body": "In the below line of code replcae the &quot;T&quot; with &quot; &quot; this                          ElseIf j &gt; 5 And tmp = &quot;T&quot; Then"}], "tags": [], "owner": {"reputation": 51, "user_id": 5012223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ba4f3b52431720a5ab72f09e37ed6d?s=128&d=identicon&r=PG&f=1", "display_name": "Prabu krishna", "link": "https://stackoverflow.com/users/5012223/prabu-krishna"}, "is_accepted": true, "score": 1, "last_activity_date": 1435820394, "last_edit_date": 1435820394, "creation_date": 1435763543, "answer_id": 31165238, "question_id": 31164466, "link": "https://stackoverflow.com/questions/31164466/vba-troubleshooting-with-find-method/31165238#31165238", "title": "VBA - troubleshooting with .Find method", "body": "<p>Replace your above code with the below one.</p>\n\n<p>Updated Code:</p>\n\n<pre class=\"lang-VBA prettyprint-override\"><code>Dim str As String, ret As String, tmp As String, j As Integer, k As Integer\n\nFor k = 2 To Sheets(\"Test\").Range(\"C2\").End(xlDown).Row\n        ret = \"\"\n        str = Sheets(\"Test\").Range(\"C\" &amp; k).Value\n\n        If InStr(str, \"TL\") &gt; 0 Then\n            For j = 1 To Len(str)\n                tmp = Mid(str, j, 1)\n                If IsNumeric(tmp) Then\n                    ret = ret + tmp\n                ElseIf j &gt; 5 And tmp = \"T\" Then\n                    Exit For\n                End If\n\n            Next j\n\n            For j = Len(ret) + 1 To 6\n                ret = \"0\" &amp; ret\n            Next j\n\n            If Len(ret) &gt; 6 Then\n                Debug.Print Len(ret)\n                For j = Len(ret) To 7 Step -1\n                If Mid(ret, 1, 1) = \"0\" Then\n                    ret = Right(ret, j - 1)\n                End If\n                Next j\n            End If\n\n            ret = \"TL-\" &amp; ret\n            Sheets(\"Test\").Range(\"C\" &amp; k).Value = ret\n        ElseIf InStr(str, \"CT\") Then\n            For j = 1 To Len(str)\n                tmp = Mid(str, j, 1)\n                If IsNumeric(tmp) Then ret = ret + tmp\n            Next j\n\n            For j = Len(ret) + 1 To 4\n                ret = \"0\" &amp; ret\n            Next\n            ret = \"CT-\" &amp; ret\n            Sheets(\"Test\").Range(\"C\" &amp; k).Value = ret\n        End If\n\n      Next k\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5029563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b7c4d47d0efaeab1583c6cabcb14928?s=128&d=identicon&r=PG&f=1", "display_name": "user4888", "link": "https://stackoverflow.com/users/5029563/user4888"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 31165238, "answer_count": 1, "score": 0, "last_activity_date": 1435820394, "creation_date": 1435761542, "last_edit_date": 1435765162, "question_id": 31164466, "link": "https://stackoverflow.com/questions/31164466/vba-troubleshooting-with-find-method", "title": "VBA - troubleshooting with .Find method", "body": "<p>I am using a .Find method to find cells in a row that contain part of the value \"TL\" and \"CT\". What the code currently does is look in every row in column C, trims any variation of \"TL-\" (ie \"TL- \", \"TL - \", \"TL -\") and then limits the numbers after it to only have 6 numbers. Example: if it has 5 numbers, it will add a 0 after the \"TL-\", if it has 4 numbers, it will add 2 0s after the \"TL-\" etc.</p>\n\n<p>I have other values in the cells so <strong>what it does now</strong> is change all the values to do the above method (as shown below)</p>\n\n<pre><code>Start:         Output:\nTL-000872  -&gt;  TL-000872\nTL-0786    -&gt;  TL-000786\nCT-74      -&gt;  TL-000074\nGS8; 278K  -&gt;  TL-008278\n</code></pre>\n\n<p><strong>What I need it to do</strong> is the code that is working but only on cells that contain some \"TL\" value, do the same code but with only 4 numbers on cells that contain some \"CT\" value, and skip over (leave as is) anything else.</p>\n\n<pre><code>Start:         Output:\nTL-000872  -&gt;  TL-000872\nTL-0786    -&gt;  TL-000786\nCT-74      -&gt;  CT-0074\nGS8; 278K  -&gt;  GS8; 278K\n</code></pre>\n\n<p>My .Find method is definitely not working. I believe that is the main problem; It is not correctly finding the cells with \"TL\" and \"CT\". Any suggestions?</p>\n\n<p>NOTE: StartSht is the workbook with the code where all of the values being changed exist.</p>\n\n<pre><code>Dim str As String, ret As String, tmp As String, j As Integer, k As Integer\n\nIf Not StartSht.Range(\"C2\").End(xlDown).Find(What:=\"TL\", LookAt:=xlPart, LookIn:=xlValues) Is Nothing Then\nFor k = 2 To StartSht.Range(\"C2\").End(xlDown).Row\n    ret = \"\"\n    str = StartSht.Range(\"C\" &amp; k).Value\n        For j = 1 To Len(str)\n            tmp = Mid(str, j, 1)\n            If IsNumeric(tmp) Then ret = ret + tmp\n        Next j\n\n        For j = Len(ret) + 1 To 6\n            ret = \"0\" &amp; ret\n        Next\n        ret = \"TL-\" &amp; ret\n        StartSht.Range(\"C\" &amp; k).Value = ret\n\n        Next k\n\nElseIf Not StartSht.Range(\"C2\").End(xlDown).Find(What:=\"CT\", LookAt:=xlPart, LookIn:=xlValues) Is Nothing Then\nFor k = 2 To StartSht.Range(\"C2\").End(xlDown).Row\n    ret = \"\"\n    str = StartSht.Range(\"C\" &amp; k).Value\n        For j = 1 To Len(str)\n            tmp = Mid(str, j, 1)\n            If IsNumeric(tmp) Then ret = ret + tmp\n        Next j\n\n        For j = Len(ret) + 1 To 4\n            ret = \"0\" &amp; ret\n        Next\n        ret = \"CT-\" &amp; ret\n        StartSht.Range(\"C\" &amp; k).Value = ret\n\nNext k\n\nElse\n\nEnd If\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>The code currently takes a TL that has LESS than 6 numbers following the \"TL-\" and adds a 0 immediately following \"TL-\" until the length is six. (ie TL-0098 -> TL-000098, two 0s are added). I need it to also catch if TL has MORE than 6 numbers and delete the zeros immediately following \"TL-\"  until the length is six\nEasier code might be to simply delete any number following the \"-\" until the length is six.</p>\n\n<p>EXAMPLE:</p>\n\n<pre><code>TL-0009999   -&gt;  delete one 0  -&gt; TL-009999\nTL-0948398   -&gt;  delete one 0  -&gt; TL-948398\nTL-00000008  -&gt;  delete two 0s -&gt; TL-000008\n</code></pre>\n"}, {"tags": ["vba", "excel", "spreadsheet"], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 4927169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8984e70979ff8e62437366209f87b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Etheur", "link": "https://stackoverflow.com/users/4927169/etheur"}, "is_accepted": true, "score": 1, "last_activity_date": 1435764328, "creation_date": 1435764328, "answer_id": 31165536, "question_id": 31164274, "link": "https://stackoverflow.com/questions/31164274/combine-sheets-into-one-sheet-horizontally/31165536#31165536", "title": "Combine sheets into one sheet horizontally", "body": "<p>I wrote this up and it seems to work well enough. It assumes that you'll always be copying from the same range in each sheet (set in the <code>strRange</code> variable). I was using range <code>A2:A10</code> in my test, but you can change it to be something like <code>A2:T10</code> depending on how far out your data goes. It also assumes you already have a \"Combined\" sheet as your Sheet1.</p>\n\n<pre><code>Sub combineSheets()\n\nDim rngPaste As Range 'range to paste to\nDim rngCopy As Range 'range to copy from\n\nDim strRange As String 'range in sheets to copy from\nstrRange = \"A2:A10\"\n\nSet rngPaste = ActiveWorkbook.Worksheets(\"Combined\").Range(strRange) 'initial range to paste into\n\nDim s As Integer\nFor s = 2 To Sheets.Count\n\n    Set rngCopy = ActiveWorkbook.Worksheets(s).Range(strRange) 'copy from same range in each sheet\n\n    rngPaste.Value = rngCopy.Value 'copy values into first sheet\n\n    Set rngPaste = rngPaste.Offset(10, 0) 'moves paste range for next copy\n\nNext s\n\nEnd Sub\n</code></pre>\n\n<p>As for why your code in particular doesn't work, it seems to be just copying in the same data from Sheet2 each time it iterates, so it might just not be changing its selection each time you move to a new sheet. I haven't used straight selections in a while so I can't tell which part is causing it, but that can be circumvented by copying the data more directly with something like the <code>rngPaste.Value = rngCopy.Value</code> above.</p>\n"}], "owner": {"reputation": 5083, "user_id": 2847689, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3e38b913ff0c83b7824342f2a1d3354d?s=128&d=identicon&r=PG", "display_name": "Carol.Kar", "link": "https://stackoverflow.com/users/2847689/carol-kar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 869, "favorite_count": 0, "accepted_answer_id": 31165536, "answer_count": 1, "score": 0, "last_activity_date": 1435764328, "creation_date": 1435761115, "last_edit_date": 1435761908, "question_id": 31164274, "link": "https://stackoverflow.com/questions/31164274/combine-sheets-into-one-sheet-horizontally", "title": "Combine sheets into one sheet horizontally", "body": "<p>I would like to merge all worksheets in a workbook below each other.</p>\n\n<p>My current code looks like the following:</p>\n\n<pre><code>Sub Combine()\n    Dim J As Integer\n    On Error Resume Next\n    Sheets(1).SelectWorksheets.Add\n    Sheets(1).Name = \"Combined\"\n    Sheets(2).Activate\n    Range(\"A1\").EntireRow.Select\n    Selection.Copy Destination:=Sheets(1).Range(\"A1\")\n    For J = 2 To Sheets.Count\n        Sheets(J).ActivateRange(\"A1\").Select\n        Selection.CurrentRegion.Select\n        Selection.Offset(1, 0).Resize(Selection.Rows.Count - 1).Select\n        Selection.Copy Destination:=Sheets(1).Range(\"A65536\").End(xlUp)(2)\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>However, my current output is:</p>\n\n<p><img src=\"https://i.stack.imgur.com/9LgmS.jpg\" alt=\"http://www.tiikoni.com/tis/view/?id=60ce910\"></p>\n\n<p>For this example I have three sheets and they look like the following:</p>\n\n<p><img src=\"https://i.stack.imgur.com/3gfre.jpg\" alt=\"http://www.tiikoni.com/tis/view/?id=e96939e\"></p>\n\n<p>All these sheets look like the same.</p>\n\n<p>My desired output should look like that:</p>\n\n<p><a href=\"http://www.tiikoni.com/tis/view/?id=1c03745\" rel=\"nofollow noreferrer\">Desired Output</a></p>\n\n<p>Any suggestion what I am doing wrong?</p>\n\n<p>I appreciate your answer!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1435761364, "post_id": 31164259, "comment_id": 50337100, "body": "What is the error message/ your output?"}], "answers": [{"tags": [], "owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "is_accepted": false, "score": 1, "last_activity_date": 1435761603, "creation_date": 1435761603, "answer_id": 31164493, "question_id": 31164259, "link": "https://stackoverflow.com/questions/31164259/removing-values-not-between-1910-2015-in-vba/31164493#31164493", "title": "Removing values not between 1910 - 2015 in VBA", "body": "<p>Your logic is wrong.</p>\n\n<p><code>(wsFinal.Cells(i, \"Q\").Value &lt;= 2015 Or wsFinal.Cells(i, \"Q\").Value &gt;= 1910)</code></p>\n\n<p>1909 returns <code>True</code> and 1910 returns <code>True</code>. You need to change <code>Or</code> to <code>And</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3809, "user_id": 3447515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cPyHf.png?s=128&g=1", "display_name": "Cohan", "link": "https://stackoverflow.com/users/3447515/cohan"}, "is_accepted": false, "score": 0, "last_activity_date": 1435763282, "last_edit_date": 1435763282, "creation_date": 1435762527, "answer_id": 31164843, "question_id": 31164259, "link": "https://stackoverflow.com/questions/31164259/removing-values-not-between-1910-2015-in-vba/31164843#31164843", "title": "Removing values not between 1910 - 2015 in VBA", "body": "<p>You may want to fix the logic so it's a bit more clear. You could make a truth table to determine if a value would go into the if statement. </p>\n\n<pre><code>        &lt;=2015  &gt;=1910  OR      Not\n1900    TRUE    FALSE   TRUE    FALSE\n2000    TRUE    TRUE    TRUE    FALSE\n2100    FALSE   TRUE    TRUE    FALSE\n\n        &lt;=2015  &gt;=1910  AND     Not\n1900    TRUE    FALSE   FALSE   TRUE\n2000    TRUE    TRUE    TRUE    FALSE\n2100    FALSE   TRUE    FALSE   TRUE\n</code></pre>\n\n<p>As a personal style, I prefer to make it so if the value is outside the range (as shown below) then perform the action rather than using the <code>Not</code> keyword and potentially adding confusion while reading.</p>\n\n<pre><code>        &gt;2015   &lt;1910   OR\n1900    FALSE   TRUE    TRUE\n2000    FALSE   FALSE   FALSE\n2100    TRUE    FALSE   TRUE\n</code></pre>\n\n<p>Other personal suggestions for keeping code easier to debug: </p>\n\n<ul>\n<li>if you only have one line within a <code>with</code> statement, then don't use the <code>with</code>.  </li>\n<li>If you are only performing one action in an if statement then the one line shortcut proves to be quite nice <code>if &lt;cond&gt; then &lt;action&gt;</code></li>\n<li>If you have two loops that do the same thing, you don't need to have two counters. You can reused them. Or if the actions can be performed at the same time, you can group them.</li>\n</ul>\n\n<p>The code below works for me even when the columns were formatted as text.</p>\n\n<pre><code>Dim wsFinal As Worksheet, LastRow As Integer\nSet wsFinal = ActiveSheet\nLastRow = wsFinal.UsedRange.Rows.count\n\nFor i = 3 To LastRow\n    If (wsFinal.Cells(i, \"Q\").value &gt; 2015 Or wsFinal.Cells(i, \"Q\").value &lt; 1910) Then wsFinal.Cells(i, \"Q\").ClearContents\n    If (wsFinal.Cells(i, \"R\").value &gt; 2015 Or wsFinal.Cells(i, \"R\").value &lt; 1910) Then wsFinal.Cells(i, \"R\").ClearContents\nNext i\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5066852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1910d55929a3b88bbf09a0d4b80a56?s=128&d=identicon&r=PG&f=1", "display_name": "AccessExcelVBA", "link": "https://stackoverflow.com/users/5066852/accessexcelvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1435763282, "creation_date": 1435761083, "last_edit_date": 1531164843, "question_id": 31164259, "link": "https://stackoverflow.com/questions/31164259/removing-values-not-between-1910-2015-in-vba", "title": "Removing values not between 1910 - 2015 in VBA", "body": "<p>Here is my code that should do what the title says (from row 3) but it doesn't work. Does anyone why it is not working? The numbers in the columns are formatted as text. Thanks</p>\n\n<pre><code>        Dim i As Long\n   For i = 3 To lastRow\n\n      If Not (wsFinal.Cells(i, \"Q\").Value &lt;= 2015 Or wsFinal.Cells(i, \"Q\").Value &gt;= 1910) Then\n        With wsFinal\n            .Cells(i, \"Q\").ClearContents\n        End With\n\n      End If\n   Next i\n\n   Dim j As Long\n      For j = 3 To lastRow\n\n      If Not (wsFinal.Cells(j, \"R\").Value &lt;= 2015 Or wsFinal.Cells(j, \"R\").Value &gt;= 1910) Then\n        With wsFinal\n            .Cells(j, \"R\").ClearContents\n        End With\n\n      End If\n\n   Next j\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1435759578, "creation_date": 1435759578, "answer_id": 31163663, "question_id": 31163591, "link": "https://stackoverflow.com/questions/31163591/programmatically-add-several-buttons-to-an-excel-worksheet-with-vba/31163663#31163663", "title": "Programmatically add several buttons to an Excel worksheet with VBA", "body": "<p>Your first two lines of each block should be one:</p>\n\n<pre><code>With newWorkBook.Worksheets(1).Buttons.Add(350, 15, 173.25, 41.25)\n</code></pre>\n\n<p>so you get a reference to the added <code>Button</code>, not to the <code>Buttons</code> collection.</p>\n"}], "owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 31163663, "answer_count": 1, "score": 0, "last_activity_date": 1435814974, "creation_date": 1435759405, "last_edit_date": 1435814974, "question_id": 31163591, "link": "https://stackoverflow.com/questions/31163591/programmatically-add-several-buttons-to-an-excel-worksheet-with-vba", "title": "Programmatically add several buttons to an Excel worksheet with VBA", "body": "<p>I managed to programmatically add a button to a worksheet with an associated macro, but I'm having a problem when I try to add more buttons with associated macros, here is the code I use :</p>\n\n<pre><code>'Adding the first button\n With newWorkBook.Worksheets(1).Buttons\n    .Add 350, 15, 173.25, 41.25\n    .Caption = \"Exporter\"\n    .OnAction = \"'\" &amp; ThisWorkbook.FullName &amp; \"'!export_Click_FCM\"\n End With\n\n 'Adding the second button\n With newWorkBook.Worksheets(1).Buttons\n    .Add 350, 66.25, 173.25, 41.25\n    .Caption = \"Ouvrir le fichier Export\"\n    .OnAction = \"'\" &amp; ThisWorkbook.FullName &amp; \"'!open_export_FCM\"\n End With\n</code></pre>\n\n<p>When using this code, the first button appears with the caption of the second one and with its macro associated, and the second button appears with the default caption \"button2\" and with no macro associated, how can I solve this problem?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1435759645, "post_id": 31163373, "comment_id": 50335745, "body": "What is RowCount? Is it a number (as the second line of code suggests) or is it a string (as the third line of code suggests where you add an &quot;S&quot; to the number of used rows)? What is TextBox1? Is it a form control or an ActiveX control from the developer tab or a simple shape?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1435759661, "post_id": 31163373, "comment_id": 50335761, "body": "What is your &quot;RowCount&quot; supposed to be? It looks like you need it to be an integer (to divide with), but have it as a string (adding &quot;S&quot;?).  If you want to count the number of used rows in column S, use this <code>RowCount = Range(&quot;S&quot; &amp; Rows.Count).End(xlUp).Row</code>"}, {"owner": {"reputation": 3, "user_id": 4123937, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AWetGL1_BIk/AAAAAAAAAAI/AAAAAAAACAU/yvwicwc1ki8/photo.jpg?sz=128", "display_name": "Venkaiah Gangavarapu", "link": "https://stackoverflow.com/users/4123937/venkaiah-gangavarapu"}, "edited": false, "score": 0, "creation_date": 1435818194, "post_id": 31163373, "comment_id": 50360575, "body": "RowCount will tells how many cells in a column(ex:S1-S5096). And TextBox1 is an ActiveX contol from developer tab, in that control i am giving value, based on that value result should come...!!!!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4123937, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AWetGL1_BIk/AAAAAAAAAAI/AAAAAAAACAU/yvwicwc1ki8/photo.jpg?sz=128", "display_name": "Venkaiah Gangavarapu", "link": "https://stackoverflow.com/users/4123937/venkaiah-gangavarapu"}, "edited": false, "score": 0, "creation_date": 1435818566, "post_id": 31163736, "comment_id": 50360758, "body": "Hi Sandesh, your piece of code is working, my intention is calculating the formula of percentage, for that I used var2=(RowCount*var1)/100, in this line I am getting error that &#39;Type mismatch&#39;."}, {"owner": {"reputation": 55, "user_id": 3370485, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/8de0de0a7945e53a6463399702eab893?s=128&d=identicon&r=PG&f=1", "display_name": "Sandesh Jadhav M", "link": "https://stackoverflow.com/users/3370485/sandesh-jadhav-m"}, "reply_to_user": {"reputation": 3, "user_id": 4123937, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AWetGL1_BIk/AAAAAAAAAAI/AAAAAAAACAU/yvwicwc1ki8/photo.jpg?sz=128", "display_name": "Venkaiah Gangavarapu", "link": "https://stackoverflow.com/users/4123937/venkaiah-gangavarapu"}, "edited": false, "score": 0, "creation_date": 1435834852, "post_id": 31163736, "comment_id": 50370954, "body": "use var2=(RowCount*cint(var1))/100.   Additionally you have to get a better understanding of datatypes.  :)"}], "tags": [], "owner": {"reputation": 55, "user_id": 3370485, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/8de0de0a7945e53a6463399702eab893?s=128&d=identicon&r=PG&f=1", "display_name": "Sandesh Jadhav M", "link": "https://stackoverflow.com/users/3370485/sandesh-jadhav-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1435759750, "creation_date": 1435759750, "answer_id": 31163736, "question_id": 31163373, "link": "https://stackoverflow.com/questions/31163373/calculate-percentage-of-cell-values-using-vba/31163736#31163736", "title": "Calculate percentage of cell values using VBA", "body": "<p>Try this</p>\n\n<p>var1 = 50 If cint(TextBox1.Value) = var1 Then</p>\n"}], "owner": {"reputation": 3, "user_id": 4123937, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AWetGL1_BIk/AAAAAAAAAAI/AAAAAAAACAU/yvwicwc1ki8/photo.jpg?sz=128", "display_name": "Venkaiah Gangavarapu", "link": "https://stackoverflow.com/users/4123937/venkaiah-gangavarapu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1976, "favorite_count": 0, "accepted_answer_id": 31163736, "answer_count": 1, "score": 0, "last_activity_date": 1435815010, "creation_date": 1435758839, "last_edit_date": 1531164843, "question_id": 31163373, "link": "https://stackoverflow.com/questions/31163373/calculate-percentage-of-cell-values-using-vba", "title": "Calculate percentage of cell values using VBA", "body": "<p>I am new to VBA, I am trying to calculate percentage of one cell value, but it is not working. I am giving percentage value from Textfield which I have designed for fetching values from excel using macros.</p>\n\n<p>Here I have written some piece of code,</p>\n\n<pre><code>Set sh = ThisWorkbook.Sheets(\"Requirements_Ranking\")\nRowCount = sh.UsedRange.Rows.Count\nRowCount = \"S\" &amp; RowCount\n\nvar1 = \"50\"\nIf TextBox1.Value = var1 Then\n\n    Sheets(\"Requirements_Ranking\").Range(\"B3:B10\").Copy\n    Sheets(\"Coverage\").Range(\"A3\").PasteSpecial xlPasteValues\n\n    var2=(RowCount*var1)/100\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1435760158, "post_id": 31163484, "comment_id": 50336135, "body": "Thanks, this works! However it seems to print &quot;#N/A&quot; at the end for some reason"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1435760981, "post_id": 31163484, "comment_id": 50336803, "body": "That would only happen if you resized the range to one larger than the actual array."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1435759099, "creation_date": 1435759099, "answer_id": 31163484, "question_id": 31163356, "link": "https://stackoverflow.com/questions/31163356/print-array-to-excel-sheet/31163484#31163484", "title": "Print array to excel sheet", "body": "<p>You can use:</p>\n\n<pre><code>Sheets(\"Summary\").Cells(47, 3).Resize(Ubound(difference) + 1).Value2 = Application.Transpose(difference)\n</code></pre>\n\n<p>If you declare the original array as 2D and start the indices at 1, you can simplify the output as you won't need the <code>Transpose</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1435759201, "creation_date": 1435759201, "answer_id": 31163515, "question_id": 31163356, "link": "https://stackoverflow.com/questions/31163356/print-array-to-excel-sheet/31163515#31163515", "title": "Print array to excel sheet", "body": "<p>You can try this loop:</p>\n\n<pre><code>Dim i\nfor i = 0 to to UBound(difference())\n Sheets(\"Summary\").Cells(47 + i,3).Value = difference(i)\nNext i\n</code></pre>\n\n<p>That's assuming you want to start pasting in cell 47.  Change that number to whatever cell you need to start with.</p>\n"}], "owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 673, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1435759664, "creation_date": 1435758804, "last_edit_date": 1435759664, "question_id": 31163356, "link": "https://stackoverflow.com/questions/31163356/print-array-to-excel-sheet", "title": "Print array to excel sheet", "body": "<p>I am trying to print an array to an excel sheet starting at a defined cell i.e C3 down until it is complete is there anyway to created a loop to print the array?</p>\n\n<p>Currently printing each value like this:</p>\n\n<pre><code>Dim difference(0 To 41) As Long\nFor Each mycell In ActiveWorkbook.Worksheets(\"Differences\").UsedRange\n    Dim col As Long\n    col = mycell.Column\n    If ActiveWorkbook.Worksheets(\"Differences\").Cells(mycell.Row,mycell.Column).Interior.Color = vbRed Then\n        difference(col) = difference(col) + 1\n    End If\nNext mycell\n\nSheets(\"Summary\").Cells(47, 3) = difference(0)\nSheets(\"Summary\").Cells(48, 3) = difference(1)\nSheets(\"Summary\").Cells(49, 3) = difference(2)\netc.\n</code></pre>\n\n<p>This becomes rather tedious when you are print out 42 different values! So I need an easier way to print the array from a starting cell down to the end cell.</p>\n"}, {"tags": ["vba", "import", "excel-2010"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1435758975, "post_id": 31163107, "comment_id": 50335246, "body": "Have you tried seeing what the macro recorder gives you when you do a remove duplicates on some fake data?"}, {"owner": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1435828046, "post_id": 31163107, "comment_id": 50366351, "body": "no I did not, I will try."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "edited": false, "score": 0, "creation_date": 1435827972, "post_id": 31164004, "comment_id": 50366284, "body": "I wanted to add this to my actual code if when importing the data would be duplicated it would delete the row."}, {"owner": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "edited": false, "score": 0, "creation_date": 1436163815, "post_id": 31164004, "comment_id": 50475813, "body": "I puted this in my code but it deletes all my format of the page.                                                                                   Cells.RemoveDuplicates Columns:=Array(1)"}], "tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": false, "score": 0, "last_activity_date": 1435760439, "creation_date": 1435760439, "answer_id": 31164004, "question_id": 31163107, "link": "https://stackoverflow.com/questions/31163107/delete-duplications-when-importing/31164004#31164004", "title": "Delete Duplications When Importing", "body": "<p>You could try exploring this avenue...</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff193823.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff193823.aspx</a></p>\n\n<p>Using the VBA side of Range.RemoveDuplicates instead of manually just doing Remove Duplicates from the Data ribbon.</p>\n"}], "owner": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435762201, "creation_date": 1435758177, "last_edit_date": 1435762201, "question_id": 31163107, "link": "https://stackoverflow.com/questions/31163107/delete-duplications-when-importing", "title": "Delete Duplications When Importing", "body": "<p>I'm doing this code for the company where I work as a internship. I did some part of it with the help of people from this forum and others but the code is big and I cannot find a place or the piece of code needed to do what I asked for, and that fits my code I'm newbie by the way.</p>\n\n<p>So I will explain the code IT will import from a target excel file and then paste in my main file, after that it will search in the main file for the data that is present in the column A and then copy the information that is linked to the names and paste it in the import sheet called (Status) so I wanted to put a delete duplications before searching the information in the main file.</p>\n\n<p>Sorry for the Big code. Forgot to mentioned the files come duplicated from the source file but I cannot change the source file, probably is easier if the import doesn't take duplicated rows ? </p>\n\n<pre><code>Sub ImportData()\nApplication.ScreenUpdating = False\nDim Path As String, Lstrw As Long\nDim SourceWb As Workbook\nDim TargetWb As Workbook\n\nPath = \"C:\\Users\\DZPH8SH\\Desktop\\Status 496 800 semana 12 2015.xls\"    'Change this to your company workbook path\nworkbook path\nSet SourceWb = Workbooks.Open(Path)\nSet TargetWb = ThisWorkbook\n\nDim n As Integer, targetRow As Long\ntargetRow = 3\n\nWith SourceWb.Sheets(1)\n    Lstrw = .Cells.Find(What:=\"*\", SearchOrder:=xlRows, SearchDirection:=xlPrevious, LookIn:=xlValues).Row\n    .Range(\"M1:M\" &amp; Lstrw).AutoFilter Field:=1, Criteria1:=\"496\"\n    .Application.Union(.Range(\"D2:D\" &amp; Lstrw), .Range(\"F2:F\" &amp; Lstrw), .Range(\"I2:I\" &amp; Lstrw), .Range(\"M2:M\" &amp; Lstrw)).Copy\n    TargetWb.Sheets(7).Cells(TargetWb.Sheets(7).Rows.Count, \"A\").End(xlUp)(2).PasteSpecial xlPasteValues\n    .ShowAllData\nEnd With\n\nWith SourceWb.Sheets(2)\n    Lstrw = .Cells.Find(What:=\"*\", SearchOrder:=xlRows, SearchDirection:=xlPrevious, LookIn:=xlValues).Row\n    .Application.Union(.Range(\"D2:D\" &amp; Lstrw), .Range(\"F2:F\" &amp; Lstrw), .Range(\"I2:I\" &amp; Lstrw), .Range(\"M2:M\" &amp; Lstrw)).Copy\n    TargetWb.Sheets(7).Cells(TargetWb.Sheets(7).Rows.Count, \"A\").End(xlUp)(2).PasteSpecial xlPasteValues\nEnd With\n\nSourceWb.Close savechanges:=False\nApplication.ScreenUpdating = True\n\n'====================================== Search in the main file code below \n\nOn Error Resume Next\n\nDim CurrWk As Worksheet\nDim wb As Workbook\nDim wk As Worksheet\nDim LRow As Integer\nDim myLRow As Integer\nDim myLCol As Integer\nDim F1 As Boolean\nDim f As Boolean\n\nSet wb = ActiveWorkbook\nSet CurrWk = wb.Sheets(7)\n\nLRow = LastRow(CurrWk)\n\nFor r = 3 To LRow\n\n    f = False\n\n    For Each wk In wb.Worksheets\n\n        If wk.Name = \"Status\" Or wk.Name = \"Gr\u00e1fico_2015\" Then GoTo abc 'Exit For\n        If wk.Visible = xlSheetHidden Then GoTo abc 'Exit For\n\n        myLRow = LastRow(wk)\n        myLCol = LastCol(wk)\n\n        For r1 = 3 To myLRow\n            For c1 = 1 To myLCol\n                If Trim(CurrWk.Cells(r, 1).Value) = Trim(wk.Cells(r1, c1).Value) Then\n                    f = True\n                    F1 = False\n                    If wk.Name = \"\u00c4A\" Then\n                        For I = 12 To 18\n                            If wk.Cells(r1, I).Value = 1 Then\n                                CurrWk.Cells(r, 6).Value = wk.Cells(2, I).Value\n                                F1 = True\n                                Exit For\n                            End If\n                        Next I\n                    Else\n                        For I = 14 To 20\n                            If wk.Cells(r1, I).Value = 1 Then\n                                CurrWk.Cells(r, 6).Value = wk.Cells(2, I).Value\n                                F1 = True\n                                Exit For\n                            End If\n                        Next I\n                    End If\n                    If F1 = False Then CurrWk.Cells(r, 6).Value = \"Set de equipa diferente\"\n                End If\n            Next c1\n        Next r1\n        'If f = True Then Exit For\nabc:\n    Next wk\n\n    If f = False Then\n        CurrWk.Cells(r, 12).Value = \"N\u00e3o est\u00e1 presente no ficheiro\"\n    End If\n\nNext r\n\nSet wk = Nothing\nSet wb = Nothing\n\nOn Error GoTo 0\n\nMsgBox \"Finished\"\n\nEnd Sub\n\n\nFunction LastRow(sh As Worksheet)\nOn Error Resume Next\nLastRow = sh.Cells.Find(What:=\"*\", _\n                        After:=sh.Range(\"A1\"), _\n                        Lookat:=xlPart, _\n                        LookIn:=xlFormulas, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Row\nOn Error GoTo 0\nEnd Function\n\nFunction LastCol(sh As Worksheet)\nOn Error Resume Next\nLastCol = sh.Cells.Find(What:=\"*\", _\n                        After:=sh.Range(\"A1\"), _\n                        Lookat:=xlPart, _\n                        LookIn:=xlFormulas, _\n                        SearchOrder:=xlByColumns, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Column\nOn Error GoTo 0\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1435757603, "post_id": 31162758, "comment_id": 50334140, "body": "When you get the error - goto the immediate window and what happens when you type ?Sheets(\u201cMonday\u201d).name does that error"}], "answers": [{"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 1, "last_activity_date": 1435757742, "creation_date": 1435757742, "answer_id": 31162958, "question_id": 31162758, "link": "https://stackoverflow.com/questions/31162758/excel-vba-run-time-error-9-subscript-out-of-range/31162958#31162958", "title": "EXCEL VBA : Run-Time error &#39;9&#39;: Subscript out of range", "body": "<p>Try to replace \u201cMonday\u201d with \"Monday\" and \u201cLINKED\u201d with \"LINKED\" (notice the different type of quotation mark \" instead of \u201c).</p>\n"}], "owner": {"reputation": 27, "user_id": 5069789, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10205300456045061/picture?type=large", "display_name": "Arun Noel Victor", "link": "https://stackoverflow.com/users/5069789/arun-noel-victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 31162958, "answer_count": 1, "score": 0, "last_activity_date": 1435757742, "creation_date": 1435757252, "last_edit_date": 1435757490, "question_id": 31162758, "link": "https://stackoverflow.com/questions/31162758/excel-vba-run-time-error-9-subscript-out-of-range", "title": "EXCEL VBA : Run-Time error &#39;9&#39;: Subscript out of range", "body": "<p>I am new to VBA Excel. I am trying to compare cells from two different sheets and if they are same, I need to perform the calculation as shown below. </p>\n\n<p>The problem is, when I run I get a <code>Run-Time error '9': Subscript out of range</code> on the following line <code>Set rng1 = Sheets(\u201cMonday\u201d).Range(\"K\" &amp; i)</code></p>\n\n<pre><code>Sub updateWOhrs()\nDim i As Integer\nDim j As Integer\nDim rng1 As Range, rng2 As Range\n\nFor i = 6 To 15\n\n    For j = 1 To 400\n    Set rng1 = Sheets(\u201cMonday\u201d).Range(\"K\" &amp; i)\n    Set rng2 = Sheets(\u201cLINKED\u201d).Range(\"C\" &amp; j)\n\n        If rng1.Value = rng2.Value Then\n            Sheets(\u201cLINKED\u201d).Cells(j, 4) = Sheets(\u201cLINKED\u201d).Cells(j, 4) + Sheets(\u201cMonday\u201d).Cells(i, 19)\n        End If\n\n\n    Next j\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sorting"], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1435760847, "post_id": 31163795, "comment_id": 50336696, "body": "I already have a list of the values with no duplicates, by type (letter). It could be a-z for the letters, you are right (frankly as long as they are separated i don&#39;t mind). I&#39;m working on a bubble sort to get the list in the order I want right now (the numbers consider 10 as being inferior to 1 right now...)"}, {"owner": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1435761284, "post_id": 31163795, "comment_id": 50337032, "body": "If you put the formula I&#39;ve given you in a column next to your data and then use that new column to sort by, does that give you the result you want?"}], "tags": [], "owner": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1435759908, "creation_date": 1435759908, "answer_id": 31163795, "question_id": 31162572, "link": "https://stackoverflow.com/questions/31162572/custom-sorting-in-vba-possibly-from-a-list/31163795#31163795", "title": "Custom sorting in VBA (possibly from a list)", "body": "<p>Personally, unless you need to do this as part of a larger piece of code, I wouldn't use VBA and would just do this by adding a column to your data sheet that gives you the correct sort order.</p>\n\n<p>To extract the relevant pieces of your ID (assuming it starts in cell \"A1\") you need to pull out the letters from your string:</p>\n\n<pre><code>=MID(A1,MIN(FIND({\"a\",\"b\",\"c\",\"s\"},A1&amp;\"abcs\")),IF(ISNUMBER(FIND(\"s\",A1)),2,1))\n</code></pre>\n\n<p>Next you need the first number:</p>\n\n<pre><code>=LEFT(A1,MIN(FIND({\"a\",\"b\",\"c\",\"s\"},A1&amp;\"abcs\"))-1)\n</code></pre>\n\n<p>Then you need to add on the second number if it exists:</p>\n\n<pre><code>=IF(ISNUMBER(FIND(\"_\",A1)),RIGHT(A1,LEN(A1)-FIND(\"_\",A1))*1,0)\n</code></pre>\n\n<p>Putting these all into a single formula and formatting the numbers to take account of single or double-digit numbers gives:</p>\n\n<pre><code>=MID(A1,MIN(FIND({\"a\",\"b\",\"c\",\"s\"},A1&amp;\"abcs\")),IF(ISNUMBER(FIND(\"s\",A1)),2,1))&amp;TEXT(LEFT(A1,MIN(FIND({\"a\",\"b\",\"c\",\"s\"},A1&amp;\"abcs\"))-1),\"00\")&amp;TEXT(IF(ISNUMBER(FIND(\"_\",A1)),RIGHT(A1,LEN(A1)-FIND(\"_\",A1))*1,0),\"00\")\n</code></pre>\n\n<p>Which is probably not the simplest way of achieving it, but will give you a column of strings which you can use as your sort order.</p>\n\n<p>The only thing I am confused about is that your question said that the letters needed to be sorted in the order that you listed them, but your example showed \"c\" coming before \"b\". If you need the letters to be in non-alphabetical order, we would need to adjust the first part of this formula.</p>\n"}, {"tags": [], "owner": {"reputation": 73682, "user_id": 2097240, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/JskU5.jpg?s=128&g=1", "display_name": "Daniel M&#246;ller", "link": "https://stackoverflow.com/users/2097240/daniel-m%c3%b6ller"}, "is_accepted": false, "score": 0, "last_activity_date": 1435761096, "creation_date": 1435761096, "answer_id": 31164262, "question_id": 31162572, "link": "https://stackoverflow.com/questions/31162572/custom-sorting-in-vba-possibly-from-a-list/31164262#31164262", "title": "Custom sorting in VBA (possibly from a list)", "body": "<p>If possible, to make it easier, the first thing I'd suggest is to keep the <code>fields</code> (type, first number, special parameter, optional numeric) all the same lenght, that would make the algorithm incredibly easier.</p>\n\n<ul>\n<li>1c2 becomes 01oc-02       </li>\n<li>23sa_13 keeps 23sa_13</li>\n</ul>\n\n<p>But if you don't have that possibility, here it goes:</p>\n\n<p>This separates all values in a new sheet, one by one, including repeated</p>\n\n<pre><code>Option Explicit\n\nSub SortData()\n\n\n    Dim MySheet As Worksheet, NewSheet As Worksheet\n    Set MySheet = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set NewSheet = ThisWorkbook.Worksheets.Add()\n\n    NewSheet.Range(\"A1\").value = \"Type\"\n    NewSheet.Range(\"B1\").value = \"First Number\"\n    NewSheet.Range(\"C1\").value = \"Underscore\"\n    NewSheet.Range(\"D1\").value = \"Last Number\"\n\n    Dim CurrentRange As Range\n    Dim i As Integer\n\n    For i = 2 To 2000 'the rows you are going to consider\n        'you may replace this for a while cell is not empty check\n        'considering the first row is a header, not a value\n\n        Set CurrentRange = MySheet.Cells(i, 1)  'gets the cell in row i and column 1\n        Dim CurrentValue As String\n        CurrentValue = CurrentRange.value   'gets the value of the cell\n\n        'if cell is empty, stop loop\n        If CurrentValue = \"\" Then\n            Exit For\n        End If\n\n        Dim FirstNumberSize As Integer\n        Dim TypeSize As Integer\n        Dim UnderscoreSize As Integer\n        Dim LastNumberSize As Integer\n\n        Dim StartChar As Integer\n        StartChar = 1\n        Call GetFieldSizes(CurrentValue, FirstNumberSize, TypeSize, UnderscoreSize, LastNumberSize)\n\n\n        'write the values in a new sheet\n        NewSheet.Cells(i, 2).value = Mid(CurrentValue, StartChar, FirstNumberSize) 'write firstnumber in the new sheet\n        StartChar = StartChar + FirstNumberSize 'advance to the next field\n\n        NewSheet.Cells(i, 1).value = Mid(CurrentValue, StartChar, TypeSize) 'write type in the new sheet\n        StartChar = StartChar + TypeSize\n\n        NewSheet.Cells(i, 3).value = Mid(CurrentValue, StartChar, UnderscoreSize) 'write underscore in the new sheet - nothing if size is zero\n        StartChar = StartChar + UnderscoreSize\n\n        NewSheet.Cells(i, 4).value = Mid(CurrentValue, StartChar, LastNumberSize) 'write lastNumber in the new sheet - nothing if size is zero\n    Next\n\nEnd Sub\n\nSub GetFieldSizes(value As String, ByRef firstNum As Integer, ByRef entryType As Integer, ByRef Underscore As Integer, ByRef lastNum As Integer)\n\n    'walk through each char of the value while it's a number\n\n\n    Dim Continue As Boolean\n    Dim charVal As String\n    Dim valLength As Integer\n    valLength = Len(value) 'the length of the string\n\n\n    'find first number size\n    firstNum = 0  'start from character zero\n    Continue = True 'to check if I can advance to the next char\n    Do\n        'if the next char is not a number, we found the letters\n        If Not IsNumeric(Mid(value, firstNum + 1, 1)) Then\n            Continue = False    'I say I cannot advance anymore, the size of our number is found\n        Else\n            firstNum = firstNum + 1 'advance one char\n        End If\n\n    Loop While Continue = True 'repeat while I can continue\n\n\n    'find first underscore or digit of last number\n\n    For Underscore = firstNum + 1 To valLength 'from the first char after the first number to the end of the string\n\n        charVal = Mid(value, Underscore, 1) 'get the value of the char in the current underscore position\n\n        If charVal = \"_\" Then   'if the char is an underscore\n            lastNum = valLength - Underscore 'the remaining chars are the last number\n            Underscore = 1 'the actual size of the underscore is 1\n            Exit For 'interrupt the loop\n        ElseIf IsNumeric(charVal) Then  'if the char is a number\n            lastNum = valLength - Underscore + 1 'the remaining chars, including this one are the last number\n            Underscore = 0 'if I find a number instead of the underscore, it doesn't exist, say it's length is zero\n            Exit For 'interrupt the loop\n        End If\n    Next\n\n    'if I advanced to the end of the string, I didn't find any number of underscore\n    If Underscore &gt; valLength Then\n        lastNum = 0\n        Underscore = 0\n    End If\n\n    entryType = valLength - firstNum - Underscore - lastNum 'the size of the letters is the remaining size when you remove the other sizes\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2967, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1435761096, "creation_date": 1435756801, "last_edit_date": 1495535207, "question_id": 31162572, "link": "https://stackoverflow.com/questions/31162572/custom-sorting-in-vba-possibly-from-a-list", "title": "Custom sorting in VBA (possibly from a list)", "body": "<p><strong>Table to sort:</strong></p>\n\n<p>I have a 2000-ish entry table. The first column contains an ID <strong>(non-unique)</strong> of the following type: [numeric 1-52][letters][optional underscore][optional numeric 1-10]. Letters will be either [a], [b], [c], [sa], [sb], [sc].</p>\n\n<p>Example: 1c, 10sb_3, 5a, 12c, 3sc, 21c_1, 22c_4, 22b_10, 14sb, 26sb.</p>\n\n<p><strong>How I want the sorting done</strong></p>\n\n<p>I want to sort by type (letter) first, in the order I named them before the example above. In case of same type, I want to sort by the first number. In case of same first number (both optional parameters will be present) I want to sort by the last number. The sorting should extend to the rest of the row (table) as well.</p>\n\n<p><strong>Desired end result</strong></p>\n\n<pre><code>1c\n1c\n1c\n2c\n3c\n3c\n4c_1\n4c_2\n4c_3\n5c\n6c_1\n.......\n1b\n2b\n2b\n3b\n4b_1\n4b_2\n5b\n5b\n.......\netc\n</code></pre>\n\n<p><strong>What I intended to do</strong> (may not be the best idea)</p>\n\n<p>Using the answer of this question as a starting point: <a href=\"https://stackoverflow.com/questions/6100944/code-an-excel-vba-sort-with-a-custom-order-and-a-value-containing-commas\">Code an Excel VBA sort with a custom order and a value containing commas</a>   </p>\n\n<p>I could make an algorithm which creates a second list, on the side, removing all duplicates, and order that list how I want manually. It would take a while, and is possibly incredibly inefficient. When it is done, I would use a piece of code similar to the answer's:</p>\n\n<pre><code>Dim oWorksheet As Worksheet\nSet oWorksheet = ActiveWorkbook.Worksheets(\"Sheet1\")\nDim oRangeSort As Range\nDim oRangeKey As Range\n\n' one range that includes all colums do sort\nSet oRangeSort = oWorksheet.Range(\"A1:J2000\") ' &lt;&lt;&lt;&lt;I'd set the range right, of course\n' start of column with keys to sort\nSet oRangeKey = oWorksheet.Range(\"B1\") '&lt;&lt;&lt;What is this for?\n\n' custom sort order\nDim sCustomList(x To y) As String\n'There would be a loop here filling the array in order with my manually sorted list\n\nApplication.AddCustomList ListArray:=sCustomList\n' use this if you want a list on the spreadsheet to sort by\n' Application.AddCustomList ListArray:=Range(\"D1:D3\")\n' ^^^^ for the record I'm not sure what this accomplishes in my case. Should I remove it? I feel it is just a different way to fill the array, using the range directly instead of filling with a loop. Maybe it suits me more?\n\noWorksheet.Sort.SortFields.Clear\noRangeSort.Sort Key1:=oRangeKey, Order1:=xlAscending, Header:=xlGuess, _\n    OrderCustom:=Application.CustomListCount + 1, MatchCase:=False, _\n    Orientation:=xlTopToBottom, DataOption1:=xlSortNormal\n\n' clean up\nApplication.DeleteCustomList Application.CustomListCount\nSet oWorksheet = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1435761015, "post_id": 31162554, "comment_id": 50336837, "body": "If you comment out the <code>MsgBox strIn</code> line in the <code>ProperCaps()</code> function, does it not do what you want? What does it do?"}, {"owner": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1435764073, "post_id": 31162554, "comment_id": 50339038, "body": "No, it clears the value in the cell whether {MsgBox strIn} is there or not.  I want to correct the string using ProperCaps and then put it back into that cell."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "edited": false, "score": 0, "creation_date": 1435765633, "post_id": 31165891, "comment_id": 50340082, "body": "One simple line that I couldn&#39;t figure out.  You solved my problem.  Thanks Paul"}, {"owner": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "edited": false, "score": 0, "creation_date": 1435767217, "post_id": 31165891, "comment_id": 50341130, "body": "One quick question, I&#39;m not familiar with this code so I don&#39;t understand it.  How do I tweak it to capitalize the first letter of the first word?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "edited": false, "score": 0, "creation_date": 1435767676, "post_id": 31165891, "comment_id": 50341408, "body": "Can you show me the text where the first letter doesn&#39;t get capitalized (I just need to see a few characters preceding the capitalized letter)"}, {"owner": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "edited": false, "score": 0, "creation_date": 1435768277, "post_id": 31165891, "comment_id": 50341758, "body": "This was entered as all lower case in the same large cell.  Each additional line after the first one is entered using Alt+Enter. &quot;the academy will include one day of training for county chief execs.  A total of three and one half days.  Each county can send up to  two individuals.  They may include the  county exec.&quot;"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "edited": false, "score": 0, "creation_date": 1435768453, "post_id": 31165891, "comment_id": 50341866, "body": "So the only one that should be capitalized is the first &quot;t&quot; in &quot;the&quot;?"}, {"owner": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "edited": false, "score": 0, "creation_date": 1435768675, "post_id": 31165891, "comment_id": 50341993, "body": "Yes that is correct.  In doing some more testing, if i enter a sentence in all caps, the text remains all caps.  I thought that the code puts everything to all lcase then capitalizes the appropriate letters.  Am I wrong?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "edited": false, "score": 0, "creation_date": 1435769100, "post_id": 31165891, "comment_id": 50342215, "body": "I think I found the issue: please open a new question and I&#39;ll provide a solution (still testing it) and more details related to it"}, {"owner": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "edited": false, "score": 0, "creation_date": 1435771188, "post_id": 31165891, "comment_id": 50343417, "body": "Paul, I posted a new and related question at: <a href=\"http://stackoverflow.com/questions/31167519/excel-vba-sentence-case-funtion-needs-fine-tuning\" title=\"excel vba sentence case funtion needs fine tuning\">stackoverflow.com/questions/31167519/&hellip;</a>"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 2, "last_activity_date": 1435765233, "creation_date": 1435765233, "answer_id": 31165891, "question_id": 31162554, "link": "https://stackoverflow.com/questions/31162554/excel-vba-sentence-case-function/31165891#31165891", "title": "Excel VBA Sentence Case Function", "body": "<p>Your function is missing the last part, but if the last part is just one more line <code>End Function</code> then all you need to do is replace <code>MsgBox strIn</code> with <code>ProperCaps = strIn</code>:</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nFunction ProperCaps(strIn As String) As String\n\n    Dim objRegex As Object\n    Dim objRegMC As Object\n    Dim objRegM As Object\n\n    Set objRegex = CreateObject(\"vbscript.regexp\")\n    strIn = LCase$(strIn)\n\n    With objRegex\n        .Global = True\n        .ignoreCase = True\n        .Pattern = \"(^|[\\.\\?\\!\\r\\t]\\s?)([a-z])\"\n\n        If .test(strIn) Then\n            Set objRegMC = .Execute(strIn)\n\n            For Each objRegM In objRegMC\n                Mid$(strIn, objRegM.firstindex + 1, objRegM.Length) = UCase$(objRegM)\n            Next\n        End If\n    End With\n\n    ProperCaps = strIn\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5003953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ac516227de0e289a92187dfd571b19?s=128&d=identicon&r=PG&f=1", "display_name": "zoom38", "link": "https://stackoverflow.com/users/5003953/zoom38"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "accepted_answer_id": 31165891, "answer_count": 1, "score": 4, "last_activity_date": 1435765233, "creation_date": 1435756755, "last_edit_date": 1531164843, "question_id": 31162554, "link": "https://stackoverflow.com/questions/31162554/excel-vba-sentence-case-function", "title": "Excel VBA Sentence Case Function", "body": "<p>I found an old post regarding a sentence case function at the following link. \n  <a href=\"https://stackoverflow.com/questions/10978560/converting-to-sentence-case-using-vba?answertab=active#tab-top\">Converting to sentence case using vba</a></p>\n\n<p>I happen to love the following function designed by bretdj</p>\n\n<pre><code>Function ProperCaps(strIn As String) As String\nDim objRegex As Object\nDim objRegMC As Object\nDim objRegM As Object\nSet objRegex = CreateObject(\"vbscript.regexp\")\nstrIn = LCase$(strIn)\nWith objRegex\n    .Global = True\n    .ignoreCase = True\n     .Pattern = \"(^|[\\.\\?\\!\\r\\t]\\s?)([a-z])\"\n    If .test(strIn) Then\n        Set objRegMC = .Execute(strIn)\n        For Each objRegM In objRegMC\n            Mid$(strIn, objRegM.firstindex + 1, objRegM.Length) = UCase$(objRegM)\n        Next\n    End If\n    MsgBox strIn\nEnd With\n</code></pre>\n\n<p>What i can't figure out is how to make the function to sentence case the string typed in a particular cell and then put the corrected sentence back into the original cell.  I don't need it in a message box. Something similar to the following:</p>\n\n<pre><code>If Not Intersect(Target, myrange2) Is Nothing Then\n    Target.Value = ProperCaps(Target.Value)\nEnd If\n</code></pre>\n\n<p>Any help would be appreciated.  Forgive me for reposting this, I'm not authorized to comment on posts. </p>\n\n<p>Thanks\nGary </p>\n"}, {"tags": ["c#", "vba", "outlook"], "comments": [{"owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "edited": false, "score": 1, "creation_date": 1435756798, "post_id": 31162334, "comment_id": 50333498, "body": "Just to offer an alternative, in case you didn&#39;t know: <a href=\"http://stackoverflow.com/questions/7594280/how-to-register-interop-net-asssembly-per-user-without-administrator-privileges\">You don&#39;t need admin permissions to register an interop .net assembly.</a> This might allow you to call your methods without all that unmanaged magic."}, {"owner": {"reputation": 115, "user_id": 2195860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3fca2f521287cff9aba2da19a1fb6c?s=128&d=identicon&r=PG", "display_name": "JustADude", "link": "https://stackoverflow.com/users/2195860/justadude"}, "reply_to_user": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "edited": false, "score": 0, "creation_date": 1435759600, "post_id": 31162334, "comment_id": 50335712, "body": "@Heinzi: thank you for that link. It seems interesting and I&#39;ll keep that option in mind, but I don&#39;t think it will fit my present needs. My current goal is to be able to distribute Outlook VBA modules &amp; Excel .xlm files which reference the .dll on a shared drive, or to distribute the code and library together. I&#39;m not presently working on creating a full-fledged application that would be installed via InstallShield."}], "owner": {"reputation": 115, "user_id": 2195860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3fca2f521287cff9aba2da19a1fb6c?s=128&d=identicon&r=PG", "display_name": "JustADude", "link": "https://stackoverflow.com/users/2195860/justadude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1593155146, "creation_date": 1435756253, "last_edit_date": 1593155146, "question_id": 31162334, "link": "https://stackoverflow.com/questions/31162334/returning-string-from-c-library-function-crashes-vba-calling-application", "title": "Returning string from C# library function crashes VBA calling application", "body": "<p>I've built an unmanaged C# library to consume a web service (tested, working). The web service takes a given project ID and returns the internal ID in the project management system. This is useful as I can then deep-link into projects in VBA, applications, etc.  </p>\n\n<p>I wanted to use this library in VBA using a Declare statement (I can't register it as I won't have access to the registry on client machines). This <em>somewhat</em> works. I used the RGiesecke.DllExport library to export functions instead of the class, and for the function that returns the internal ID (as an integer), this works great. What I am trying to do, however, is make a function that returns the fully built URL to VBA (or whatever the caller is). This would make it much more user friendly to use the library without having to muck with string concatenation and manipulation after getting an internal ID. This is what's causing trouble - the string comes back (I see it in the debug console), and then Outlook just hangs - no error, the screen will just go white and be non-responsive. </p>\n\n<p>To test, I replaced the GetLink function with a simple C# function with the same name &amp; prototype that returns \"Test\" and the same thing happens, so I don't think I'm overflowing the string or anything. I then made the same function return an int and returned 0, which worked fine. Therefore, it's definitely something with returning a string. I suspect it's something in how the function is being called, or how VBA is trying to clean up the stack (maybe string sizes are are different in C# and VBA and it's going into protected mem?), but I'm really not sure. Per some other threads, I also tried declaring the function in VBA as returning an Object, and had the same result.</p>\n\n<p>Code for C# lib and VBA sub follows.</p>\n\n<p><strong>Here's the C# library:</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Runtime.InteropServices;\n\nusing System.Threading.Tasks;\nusing System.Net;\nusing System.IO;\nusing RGiesecke.DllExport;\n\npublic class ClarityWebService \n{\n    [DllExport(\"GetInternalID\", CallingConvention = CallingConvention.StdCall)]\n    public static int GetInternalID(string projectID)\n    {\n        const String USERNAME = \"the_username\";\n        const String PASSWORD = \"the_password\";\n        int internalID;\n        projectID = projectID.Trim()\n\n        String encoded = System.Convert.ToBase64String(System.Text.Encoding.GetEncoding(\"ISO-8859-1\").GetBytes(USERNAME + \":\" + PASSWORD));\n        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(\"&lt;REST URL&gt;/\" + projectID);\n        HttpWebResponse response = null;\n        Boolean responseSuccess = true;\n\n        request.Method = \"GET\";    \n        request.Headers.Add(\"Authorization\", \"Basic \" + encoded);\n\n        // ACTUALLY HIT THE WEB SERVICE AND GET THE INTERNAL ID\n        try\n        {\n            response = (HttpWebResponse)request.GetResponse();\n        }\n        catch (Exception except)\n        {\n            responseSuccess = false;\n        }\n\n        /* \n        * Only return the Internal ID on success. If the try failed,\n        * there might be a network problem or an invalid Clarity ID was given, so return -1\n        */\n        Stream responseDataStream;\n        String responseFromServer = \"-1\";\n\n        if (responseSuccess)\n        {\n            // Get response as stream\n            responseDataStream = response.GetResponseStream();\n\n            // Read the stream\n            var reader = new StreamReader(responseDataStream);\n\n            // Parse through response\n            responseFromServer = reader.ReadToEnd();\n\n            bool resultofConv = Int32.TryParse(responseFromServer, out internalID);\n\n            // The server should have sent an internal ID, which is an integer\n            // If something else is returned, something is wrong\n            if (resultofConv != true)\n                internalID = -1;\n\n            // Cleanup\n            reader.Close();\n            responseDataStream.Close();\n            response.Close();            \n        }\n        else\n        {\n            internalID = -1;\n        }\n\n        return internalID;\n    }\n\n    [DllExport(\"GetLink\", CallingConvention = CallingConvention.StdCall)]\n    public static string GetLink(string projectID, string LinkType = \"Main\")\n    {\n        projectID = projectID.Trim();\n        int intId = GetInternalID(projectID);\n        string strIntId = intId.ToString();\n\n        if (intId != -1)\n            return BuildCorrectLink(strIntId,LinkType);\n        else\n            return \"Error getting internal id for project \" + projectID + \" - make sure project is valid\";\n    }\n\n    private static string BuildCorrectLink(string internalId, string LinkType = \"Main\")\n    {\n        // Generic deep links to various parts of a project\n        const string mainLink = \"&lt;URL&gt;&amp;id=&lt;INTERNAL ID&gt;\";\n        const string statusReportLink = \"&lt;URL&gt;&amp;id=&lt;INTERNAL ID&gt;;\n        const string dashboardLink = \"&lt;URL&gt;&amp;id=&lt;INTERNAL ID&gt;\";\n        const string auditLink = \"&lt;URL&gt;&amp;id=&lt;INTERNAL ID&gt;\";\n        const string hierarchyLink = \"&lt;URL&gt;&amp;id=&lt;INTERNAL ID&gt;\";\n        const string tasksLink = \"&lt;URL&gt;&amp;id=&lt;INTERNAL ID&gt;\";\n        const string ganttLink = \"&lt;URL&gt;&amp;id=&lt;INTERNAL ID&gt;\";\n\n        // Replace the &lt;INTERNAL ID&gt; in the generic link with the actual Internal ID and return it\n        switch (LinkType.Trim())\n        {\n            // If LinkType = \"Main\" or is blank\n            case \"Main\" : case \"\":\n                return mainLink.Replace(\"&lt;INTERNAL ID&gt;\", internalId);\n                break;\n            case \"Status Report\":\n                return statusReportLink.Replace(\"&lt;INTERNAL ID&gt;\", internalId);\n                break;\n            case \"Dashboard\":\n                return dashboardLink.Replace(\"&lt;INTERNAL ID&gt;\", internalId);\n                break;\n            case \"Audit\":\n                return auditLink.Replace(\"&lt;INTERNAL ID&gt;\", internalId);\n                break;\n            case \"Hierarchy\":\n                return hierarchyLink.Replace(\"&lt;INTERNAL ID&gt;\", internalId);\n                break;\n            case \"Tasks\":\n                return tasksLink.Replace(\"&lt;INTERNAL ID&gt;\", internalId);\n                break;\n            case \"Gantt\":\n                return ganttLink.Replace(\"&lt;INTERNAL ID&gt;\", internalId);\n                break;\n            default:\n                return \"Error - unknown subpage requested\";\n                break;\n        }\n    }\n\n}\n</code></pre>\n\n<p><strong>Here is the VBA code:</strong></p>\n\n<pre><code>Option Explicit\n' DEBUG function declarations\nDeclare Function GetInternalID Lib \"C:\\Users\\MyUserName\\Documents\\Visual Studio 2010\\Projects\\ClarityWebService\\ClarityWebService\\bin\\Debug\\ClarityWebService.dll\" (ByVal ProjectID As String) As Long\nDeclare Function GetLink Lib \"C:\\Users\\MyUserName\\Documents\\Visual Studio 2010\\Projects\\ClarityWebService\\ClarityWebService\\bin\\Debug\\ClarityWebService.dll\" (ByVal ProjectID As String, Optional ByVal LinkType As String) As String\n\n' Shared drive function declarations\n'Declare Function GetInternalID Lib \"Shared Network Drive\\ClarityWebService.dll\" (ByVal ProjectID As String) As Long\n'Declare Function GetLink Lib \"Shared Network Drive\\ClarityWebService.dll\" (ByVal ProjectID As String, Optional ByVal LinkType As String) As String\n\n\nSub TestClarityWebService()        \n    ' The line below works (I see a link in the debug console),\n    ' but Outlook crashes right after\n    Debug.Print (GetLink(\"ID_of_Project1\", \"Main\"))\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "edited": false, "score": 0, "creation_date": 1435755034, "post_id": 31161726, "comment_id": 50332072, "body": "Depending on how many names, you could use a list (hidden in your personal workbook?) in Excel and flag if not on that list using a For loop and an IF, or if there aren&#39;t many, you could write a CASE statement in VBA. Then you flag if they aren&#39;t on the &#39;approved&#39; list"}, {"owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "edited": false, "score": 0, "creation_date": 1435755283, "post_id": 31161726, "comment_id": 50332256, "body": "could you not design a outlook form querying data from centrally stored Excel? that way you have all outlook mail functions and  I believe this is much more realistic as querying outlook names require access grant on outlook (?)"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1435756663, "post_id": 31161726, "comment_id": 50333390, "body": "Where do you need to check names? In the Outlook Address Book or AD?"}], "answers": [{"comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 1, "creation_date": 1435763616, "post_id": 31161938, "comment_id": 50338706, "body": "Keep in mind that Namespace.CreateRecipient / Recipient.Resolve will not display ambiguous name dialog box."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1435764470, "post_id": 31161938, "comment_id": 50339338, "body": "I&#39;d never even considered that @Dmitry - I&#39;m going to have to work on that.  Found this link which may point me in the right direction - <a href=\"https://msdn.microsoft.com/en-us/library/bb646055(v=office.12).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb646055(v=office.12).aspx</a>"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1435764560, "post_id": 31161938, "comment_id": 50339406, "body": "Yes, that is for selecting the names, not for ambiguous names."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 5, "last_activity_date": 1435755325, "creation_date": 1435755325, "answer_id": 31161938, "question_id": 31161726, "link": "https://stackoverflow.com/questions/31161726/creating-a-check-names-button-in-excel/31161938#31161938", "title": "Creating a &quot;Check Names&quot; button in Excel", "body": "<p>A couple of answers here:</p>\n\n<p>Edit:  Created in Excel 2010 (no idea if it'll work in 2003).</p>\n\n<p>The first will return TRUE or FALSE if the name can be resolved in Outlook.</p>\n\n<pre><code>'----------------------------------------------------------------------------------\n' Procedure : ResolveDisplayNameToSMTP\n' Author    : Sue Mosher - updated by D.Bartrup-Cook to work in Excel late binding.\n'-----------------------------------------------------------------------------------\nPublic Function ResolveDisplayName(sFromName) As Boolean\n\n    Dim OLApp As Object 'Outlook.Application\n    Dim oRecip As Object 'Outlook.Recipient\n    Dim oEU As Object 'Outlook.ExchangeUser\n    Dim oEDL As Object 'Outlook.ExchangeDistributionList\n\n    Set OLApp = CreateObject(\"Outlook.Application\")\n    Set oRecip = OLApp.Session.CreateRecipient(sFromName)\n    oRecip.Resolve\n    If oRecip.Resolved Then\n        ResolveDisplayName = True\n    Else\n        ResolveDisplayName = False\n    End If\n\nEnd Function\n</code></pre>\n\n<p>The second will resolve the name and return the email address:</p>\n\n<pre><code>'----------------------------------------------------------------------------------\n' Procedure : ResolveDisplayNameToSMTP\n' Author    : Sue Mosher - updated by D.Bartrup-Cook to work in Excel late binding.\n'-----------------------------------------------------------------------------------\nPublic Function ResolveDisplayNameToSMTP(sFromName) As String\n    Dim OLApp As Object 'Outlook.Application\n    Dim oRecip As Object 'Outlook.Recipient\n    Dim oEU As Object 'Outlook.ExchangeUser\n    Dim oEDL As Object 'Outlook.ExchangeDistributionList\n\n    Set OLApp = CreateObject(\"Outlook.Application\")\n    Set oRecip = OLApp.Session.CreateRecipient(sFromName)\n    oRecip.Resolve\n    If oRecip.Resolved Then\n        Select Case oRecip.AddressEntry.AddressEntryUserType\n            Case 0, 5 'olExchangeUserAddressEntry &amp; olExchangeRemoteUserAddressEntry\n                Set oEU = oRecip.AddressEntry.GetExchangeUser\n                If Not (oEU Is Nothing) Then\n                    ResolveDisplayNameToSMTP = oEU.PrimarySmtpAddress\n                End If\n            Case 10, 30 'olOutlookContactAddressEntry &amp; 'olSmtpAddressEntry\n                    ResolveDisplayNameToSMTP = oRecip.AddressEntry.Address\n        End Select\n    End If\nEnd Function\n</code></pre>\n\n<p>Here's a test procedure showing how to use both functions:</p>\n\n<pre><code>Sub Test()\n\n    MsgBox ResolveDisplayName(\"Marty Moesta\")\n    MsgBox ResolveDisplayNameToSMTP(\"Marty Moesta\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5069647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c43d4e9296303a384a53f90ce0594ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marty Moesta", "link": "https://stackoverflow.com/users/5069647/marty-moesta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11257, "favorite_count": 1, "accepted_answer_id": 31161938, "answer_count": 1, "score": 1, "last_activity_date": 1435755325, "creation_date": 1435754754, "question_id": 31161726, "link": "https://stackoverflow.com/questions/31161726/creating-a-check-names-button-in-excel", "title": "Creating a &quot;Check Names&quot; button in Excel", "body": "<p>I am new to using VBA and Macros and am wondering if there is a way to add a \"check names\" function in Excel (similar to the function in Outlook).  Part of the form I am working on requires me to enter names of employees and I would like to be able to click a button to make sure I have spelled their names correctly and they are in our email system.  Any help or pointers in the right direction would be greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435754884, "post_id": 31161515, "comment_id": 50331981, "body": "Yes, you&#39;d need a class."}, {"owner": {"reputation": 12628, "user_id": 145757, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/T6ghe.png?s=128&g=1", "display_name": "Pragmateek", "link": "https://stackoverflow.com/users/145757/pragmateek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435755233, "post_id": 31161515, "comment_id": 50332223, "body": "@Rory Thanks for your quick answer. Can I expect an experience similar to standard modules and safely move to them or is there some limitations I should be aware of? Thanks."}, {"owner": {"reputation": 12628, "user_id": 145757, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/T6ghe.png?s=128&g=1", "display_name": "Pragmateek", "link": "https://stackoverflow.com/users/145757/pragmateek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435755392, "post_id": 31161515, "comment_id": 50332340, "body": "@Rory To be more specific I&#39;d need some kind of &quot;static&quot; methods. But IIRC this is not possible with class modules. I hope I&#39;m wrong..."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435755822, "post_id": 31161515, "comment_id": 50332693, "body": "What exactly do you mean by &quot;static&quot;? It is possible to create Static routines in class modules. As an aside, why exactly is this a problem for you?"}, {"owner": {"reputation": 12628, "user_id": 145757, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/T6ghe.png?s=128&g=1", "display_name": "Pragmateek", "link": "https://stackoverflow.com/users/145757/pragmateek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435763598, "post_id": 31161515, "comment_id": 50338695, "body": "&quot;static&quot; (&quot;shared&quot; in VB.Net) means the member can be accessed without an instance of the class: <code>MyClass.MyMember</code> instead of <code>Dim myInstance As New MyClass ... myInstance.MyMember</code>."}, {"owner": {"reputation": 12628, "user_id": 145757, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/T6ghe.png?s=128&g=1", "display_name": "Pragmateek", "link": "https://stackoverflow.com/users/145757/pragmateek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435763643, "post_id": 31161515, "comment_id": 50338729, "body": "So the &quot;problem&quot; is that you need additional useless code to invoke the member. :)"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435764107, "post_id": 31161515, "comment_id": 50339063, "body": "I mean what is the problem with the original module access (which requires <b>less</b> code)"}, {"owner": {"reputation": 12628, "user_id": 145757, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/T6ghe.png?s=128&g=1", "display_name": "Pragmateek", "link": "https://stackoverflow.com/users/145757/pragmateek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435764539, "post_id": 31161515, "comment_id": 50339385, "body": "The &quot;problem&quot; with the default behaviour of modules is that you clutter the global scope with plenty of names. Moreover I fear there is a risk of conflict so I&#39;d like to force users of my API to be clean and fully-qualify the names of the members they use. So this is not a blocking issue at all, just code quality. If a default module is the best I can do then I&#39;ll go for it. Thanks. :-)"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435765121, "post_id": 31161515, "comment_id": 50339761, "body": "What possible conflict could there be?"}, {"owner": {"reputation": 12628, "user_id": 145757, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/T6ghe.png?s=128&g=1", "display_name": "Pragmateek", "link": "https://stackoverflow.com/users/145757/pragmateek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435766883, "post_id": 31161515, "comment_id": 50340928, "body": "Say <code>module1</code> have Sub <code>Run</code>. User calls it with <code>Run()</code> and all is working fine. Later it imports an other module <code>module2</code> with a <code>Run</code> Sub too. The user code is broken as there is a conflict and it will see it only when compiling or running its previous code. Worst: without noticing the new Sub, the user removes <code>module1</code> (by mistake or deliberately) and it will inadvertently calls <code>Run</code> from <code>module2</code>. I imagine there is worse cases but you get the idea. :-/"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435767075, "post_id": 31161515, "comment_id": 50341043, "body": "That&#39;s not really API in any way. :) Users shouldn&#39;t be messing around with <b>your</b> code - that should be in a separate library, IMO."}, {"owner": {"reputation": 12628, "user_id": 145757, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/T6ghe.png?s=128&g=1", "display_name": "Pragmateek", "link": "https://stackoverflow.com/users/145757/pragmateek"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435768099, "post_id": 31161515, "comment_id": 50341654, "body": "You mean packaged as a protected XLA? AFAIK it won&#39;t avoid conflicts as what is public is still directly accessible without names qualification. But I may be wrong."}], "answers": [{"comments": [{"owner": {"reputation": 12628, "user_id": 145757, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/T6ghe.png?s=128&g=1", "display_name": "Pragmateek", "link": "https://stackoverflow.com/users/145757/pragmateek"}, "edited": false, "score": 0, "creation_date": 1435763768, "post_id": 31162090, "comment_id": 50338818, "body": "Thanks for the samples but as mentioned in my comments I&#39;d like to avoid creating additional objects by using &quot;static&quot;/&quot;shared&quot; methods. But seems like this is not possible with classes or types."}], "tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 2, "last_activity_date": 1435755699, "creation_date": 1435755699, "answer_id": 31162090, "question_id": 31161515, "link": "https://stackoverflow.com/questions/31161515/is-there-a-way-to-force-qualification-with-module-name-for-global-members/31162090#31162090", "title": "Is there a way to force qualification with module name for global members?", "body": "<p>You could use <code>Type</code> or <code>Class</code>.</p>\n\n<blockquote>\n  <p>Declare type in standard module</p>\n</blockquote>\n\n<pre><code>Public Type SomeType\n    SomeMember As String\nEnd Type\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>Declare class in class module named <em>SomeClass</em></p>\n</blockquote>\n\n<pre><code>Private m_someMember As String\n\nPublic Property Get SomeMember() As String\n    SomeMember = m_someMember\nEnd Property\n\nPublic Property Let SomeMember(ByVal newValue As String)\n    m_someMember = newValue\nEnd Property\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>How to use it in standard module</p>\n</blockquote>\n\n<pre><code>Sub TypeTest()\n    Dim x As SomeType\n    x.SomeMember = \"Hi\"\n    MsgBox x.SomeMember, vbInformation\nEnd Sub\n\nSub ClassTest()\n    Dim y As SomeClass\n    Set y = New SomeClass\n    y.SomeMember = \"Hello\"\n    MsgBox y.SomeMember, vbInformation\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 12628, "user_id": 145757, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/T6ghe.png?s=128&g=1", "display_name": "Pragmateek", "link": "https://stackoverflow.com/users/145757/pragmateek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435755699, "creation_date": 1435754186, "last_edit_date": 1531164843, "question_id": 31161515, "link": "https://stackoverflow.com/questions/31161515/is-there-a-way-to-force-qualification-with-module-name-for-global-members", "title": "Is there a way to force qualification with module name for global members?", "body": "<p>In a VBA module, say <code>mdlModule</code>, I can prevent a member (<code>Sub</code>, <code>Function</code> or variable), say <code>SomeMember</code>, from being globally visible from the outside by marking it as <code>Private</code>.</p>\n\n<p>If I want to expose the member externally I mark it <code>Public</code> and I can access it through <code>mdlModule.SomeMember</code>.</p>\n\n<p>The issue is that I can also access it directly with <code>SomeMember</code> which quickly creates a bunch of globally visible names.</p>\n\n<p>Is there a way to <strong>force scoping</strong> of the globally visible member so that <code>SomeMember</code> would not be valid to call it, but only <code>mdlModule.SomeMember</code>?</p>\n\n<p>Could I do that with <strong>class modules</strong> maybe?</p>\n"}, {"tags": ["vba", "userform", "catia"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1435752751, "post_id": 31160936, "comment_id": 50330445, "body": "Do you mean VBA? In what application?"}, {"owner": {"reputation": 67, "user_id": 3714887, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/89a942d05ae795b90703e6b6e985b8b9?s=128&d=identicon&r=PG&f=1", "display_name": "user3714887", "link": "https://stackoverflow.com/users/3714887/user3714887"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1435753248, "post_id": 31160936, "comment_id": 50330809, "body": "Yes VBA Im using to develop macro in CATIA"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1435753707, "post_id": 31160936, "comment_id": 50331126, "body": "Not sure about CATIA but in Excel VBA (and in VBA in general) there aren&#39;t static objects in classes and forms. You need to place global variables in a separate module."}, {"owner": {"reputation": 67, "user_id": 3714887, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/89a942d05ae795b90703e6b6e985b8b9?s=128&d=identicon&r=PG&f=1", "display_name": "user3714887", "link": "https://stackoverflow.com/users/3714887/user3714887"}, "edited": false, "score": 0, "creation_date": 1435753848, "post_id": 31160936, "comment_id": 50331231, "body": "I did declare the object variable as public in the main module as well. But still im not able to acess the object"}], "answers": [{"comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1435755186, "post_id": 31161687, "comment_id": 50332191, "body": "UserForm2  is just a UserForm, If its a VBA environment hosting Microsoft Forms (as it presumably is) then its fine."}, {"owner": {"reputation": 67, "user_id": 3714887, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/89a942d05ae795b90703e6b6e985b8b9?s=128&d=identicon&r=PG&f=1", "display_name": "user3714887", "link": "https://stackoverflow.com/users/3714887/user3714887"}, "edited": false, "score": 0, "creation_date": 1435755768, "post_id": 31161687, "comment_id": 50332653, "body": "Alex Thank you for your reply. But i could not understand your code. In the Userform1:                                                                                                                     I am declaring an object as &quot;Public object1 As Object&quot;  and settin a value. Which I am not able to get it                                                                                      Userform2:                                                                                                                 Here I am trying to get the value of the object1."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "reply_to_user": {"reputation": 67, "user_id": 3714887, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/89a942d05ae795b90703e6b6e985b8b9?s=128&d=identicon&r=PG&f=1", "display_name": "user3714887", "link": "https://stackoverflow.com/users/3714887/user3714887"}, "edited": false, "score": 0, "creation_date": 1435756091, "post_id": 31161687, "comment_id": 50332898, "body": "My <i>example</i> uses a <code>Collection</code>, substitute that with your object."}, {"owner": {"reputation": 67, "user_id": 3714887, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/89a942d05ae795b90703e6b6e985b8b9?s=128&d=identicon&r=PG&f=1", "display_name": "user3714887", "link": "https://stackoverflow.com/users/3714887/user3714887"}, "edited": false, "score": 0, "creation_date": 1435757150, "post_id": 31161687, "comment_id": 50333765, "body": "When i give.... &quot;Set Inner_V11 = New Object&quot;  I get a error message &quot;Expected: Identifier&quot;"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "reply_to_user": {"reputation": 67, "user_id": 3714887, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/89a942d05ae795b90703e6b6e985b8b9?s=128&d=identicon&r=PG&f=1", "display_name": "user3714887", "link": "https://stackoverflow.com/users/3714887/user3714887"}, "edited": false, "score": 0, "creation_date": 1435757252, "post_id": 31161687, "comment_id": 50333845, "body": "You will need to edit your question and add the relevant code"}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1435754620, "creation_date": 1435754620, "answer_id": 31161687, "question_id": 31160936, "link": "https://stackoverflow.com/questions/31160936/how-to-use-an-object-from-another-userform-in-vbscript/31161687#31161687", "title": "How to use an object from another userform in vbscript?", "body": "<p>Add a Property to the form containing the object.</p>\n\n<p>E.g.</p>\n\n<p><strong>UserForm1</strong></p>\n\n<pre><code>Private Sub UserForm_Click()\n    Dim uf2 As UserForm2\n    Set uf2 = New UserForm2\n\n    uf2.Col.Add Now, \"K\"\n\n    uf2.Show\nEnd Sub\n</code></pre>\n\n<p><strong>UserForm2</strong></p>\n\n<pre><code>Private mCol As Collection\n\nPrivate Sub UserForm_Initialize()\n    Set mCol = New Collection\nEnd Sub\n\nPublic Property Get Col() As Collection\n    Set Col = mCol\nEnd Property\n\nPrivate Sub UserForm_Activate()\n    MsgBox mCol(\"K\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 3714887, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/89a942d05ae795b90703e6b6e985b8b9?s=128&d=identicon&r=PG&f=1", "display_name": "user3714887", "link": "https://stackoverflow.com/users/3714887/user3714887"}, "is_accepted": true, "score": 0, "last_activity_date": 1435820081, "creation_date": 1435820081, "answer_id": 31177486, "question_id": 31160936, "link": "https://stackoverflow.com/questions/31160936/how-to-use-an-object-from-another-userform-in-vbscript/31177486#31177486", "title": "How to use an object from another userform in vbscript?", "body": "<p>The answer is simple I just have to call Userform1.Inner_V1</p>\n"}], "owner": {"reputation": 67, "user_id": 3714887, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/89a942d05ae795b90703e6b6e985b8b9?s=128&d=identicon&r=PG&f=1", "display_name": "user3714887", "link": "https://stackoverflow.com/users/3714887/user3714887"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1141, "favorite_count": 0, "accepted_answer_id": 31177486, "answer_count": 2, "score": 0, "last_activity_date": 1435820081, "creation_date": 1435752658, "last_edit_date": 1435757941, "question_id": 31160936, "link": "https://stackoverflow.com/questions/31160936/how-to-use-an-object-from-another-userform-in-vbscript", "title": "How to use an object from another userform in vbscript?", "body": "<p>I am working with multiple userforms in vbscript.</p>\n\n<p>I am creating an object in a userform and trying to call it in another userform.\nI tried declaring the object as Public in both the userforms but still I am not able to acess the object from another userform.</p>\n\n<p>Look Forward for your help.</p>\n\n<p>Thanks in advance.</p>\n\n<p>Userform1:</p>\n\n<pre><code>        Public Inner_V1 As Object\n        Private Sub Inner_V1_CD_Click()\n\n 'Auswahlfenster ausblenden\n  Input_selection2.Hide\n\n'Dim myDoc As Document\nSet myDoc = CATIA.ActiveDocument\n\nOn Error Resume Next\n\nSet ActivePart = CATIA.ActiveDocument.Part\n\n    If Err.Number &lt;&gt; 0 Then\n        On Error GoTo 0\n        Box = MsgBox(\"Das ge\u00f6ffnete Dokument ist kein CATPart!\" + Chr(10) + \"Das Makro wird beendet\", vbExclamation, \"Falscher Dateityp\")\n        Unload Input_selection2\n        Exit Sub\n    End If\n\n' Selektion definieren und leeren ----\nDim UserSel As Object\nSet UserSel = myDoc.Selection\nUserSel.Clear\n'-------------------------------------\n\n' User w\u00e4hlt die Fl\u00e4che aus #############################################################################\n\n    ' Auswahl festlegen -------------------\n    Dim Was1(0)\n    Was1(0) = \"HybridShape\"\n    '--------------------------------------\n\n    Dim Auswahl                                         'Wird f\u00fcr die SelectElement2 Methode ben\u00f6tigt (Auswahl durch User)\n    Auswahl = UserSel.SelectElement2(Was1, \"Bitte die Fl\u00e4che ausw\u00e4hlen.\", False)\n\n    If Auswahl = \"Normal\" Then\n        Set Inner_V1 = UserSel.Item(1).Value\n        Inner_V1.Value = Inner_V1.Name\n    Else\n        Unload Input_selection2\n        Exit Sub\n    End If\n\n    ' Selektion freigeben -----------------------------------------------------\n    UserSel.Clear                           'User-Auswahl l\u00f6schen\n\n  'Auswahlfenster anzeigen\n   Input_selection2.Show\n\n   End Sub\n</code></pre>\n\n<p>Userform2:</p>\n\n<pre><code>           Private Sub Weiter_Click()\n\n           Set hybridBodies1 = part1.HybridBodies\n\n           Set hybridBody1 = hybridBodies1.Add()\n           hybridBody1.Name = \"test\"\n\n           Set reference1 = part1.CreateReferenceFromObject(Inner_V1)\n           Set reference2 = part1.CreateReferenceFromObject(Guide_curve)\n\n           Set sweep_v1 = hybridShapeFactory1.AddNewSweepExplicit(reference1, reference2)\n           Set reference3 = part1.CreateReferenceFromObject(Support_V)\n\n           hybridBody1.AppendHybridShape sweep_v1\n\n           End Sub   \n</code></pre>\n\n<p>Here, Inner_V1 is the object which i Need to use from Userform1.</p>\n"}, {"tags": ["excel", "vba", "vbscript"], "comments": [{"owner": {"reputation": 197, "user_id": 3861575, "user_type": "registered", "accept_rate": 61, "profile_image": "https://graph.facebook.com/100001540040713/picture?type=large", "display_name": "Krish Krishna", "link": "https://stackoverflow.com/users/3861575/krish-krishna"}, "edited": false, "score": 0, "creation_date": 1435751765, "post_id": 31160562, "comment_id": 50329732, "body": "So far i have tried this code: <a href=\"http://www.experts-exchange.com/Programming/Languages/Visual_Basic/VB_Script/Q_28433393.html\" rel=\"nofollow noreferrer\">Click me</a> (appologies i could not paste the code here) .Bt this doesnot get close to the problem."}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 3861575, "user_type": "registered", "accept_rate": 61, "profile_image": "https://graph.facebook.com/100001540040713/picture?type=large", "display_name": "Krish Krishna", "link": "https://stackoverflow.com/users/3861575/krish-krishna"}, "edited": false, "score": 0, "creation_date": 1435753355, "post_id": 31161034, "comment_id": 50330892, "body": "any way to give the contents of fnc split() dynamically?"}, {"owner": {"reputation": 37163, "user_id": 603855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b541c001a51839aebfb1da088861b9?s=128&d=identicon&r=PG", "display_name": "Ekkehard.Horner", "link": "https://stackoverflow.com/users/603855/ekkehard-horner"}, "reply_to_user": {"reputation": 197, "user_id": 3861575, "user_type": "registered", "accept_rate": 61, "profile_image": "https://graph.facebook.com/100001540040713/picture?type=large", "display_name": "Krish Krishna", "link": "https://stackoverflow.com/users/3861575/krish-krishna"}, "edited": false, "score": 0, "creation_date": 1435753495, "post_id": 31161034, "comment_id": 50330984, "body": "@KrishKrishna - sorry, I don&#39;t understand &quot;give the contents of fnc split() dynamically&quot;."}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1435756332, "post_id": 31161034, "comment_id": 50333104, "body": "If you split on two spaces you could get the two groups separated, but if there are more than two spaces between <code>&quot;a a&quot;</code>  and <code>&quot;1&quot;</code> you would also get blank values inbetween: <code>Split(STRING, Space(2))</code>"}], "tags": [], "owner": {"reputation": 37163, "user_id": 603855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b541c001a51839aebfb1da088861b9?s=128&d=identicon&r=PG", "display_name": "Ekkehard.Horner", "link": "https://stackoverflow.com/users/603855/ekkehard-horner"}, "is_accepted": false, "score": 1, "last_activity_date": 1435752917, "creation_date": 1435752917, "answer_id": 31161034, "question_id": 31160562, "link": "https://stackoverflow.com/questions/31160562/vbscript-to-split-excel-column-data-inexcel-into-2-columns/31161034#31161034", "title": "Vbscript to split excel column data inexcel into 2 columns", "body": "<p>Use a RegExp that looks for </p>\n\n<ol>\n<li>a sequence of Not-\\ns non-greedily</li>\n<li>before a non-empty sequence of whitespace</li>\n<li>followed by digits</li>\n</ol>\n\n<p>As in:</p>\n\n<pre><code>Option Explicit\n\nFunction qq(s) : qq = \"\"\"\" &amp; s &amp; \"\"\"\" : End Function\n\nDim r : Set r = New RegExp\nr.Pattern = \"^(.+?)\\s+(\\d+)$\"\nDim s, m\nFor Each s In Split(\"a a    1|d d d  4\", \"|\")\n    Set m = r.Execute(s)(0)\n    WScript.Echo qq(m.Submatches(0)), qq(m.Submatches(1))\nNext\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>cscript 31160562.vbs\n\"a a\" \"1\"\n\"d d d\" \"4\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 184, "user_id": 4847664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d668097907d35b74564ed0365cf1b1f3?s=128&d=identicon&r=PG&f=1", "display_name": "Annette", "link": "https://stackoverflow.com/users/4847664/annette"}, "is_accepted": false, "score": 1, "last_activity_date": 1435761981, "creation_date": 1435761981, "answer_id": 31164645, "question_id": 31160562, "link": "https://stackoverflow.com/questions/31160562/vbscript-to-split-excel-column-data-inexcel-into-2-columns/31164645#31164645", "title": "Vbscript to split excel column data inexcel into 2 columns", "body": "<p>you can write a function which uses the Split function based on the space,</p>\n\n<p>below is the code snippet which feel will work for u </p>\n\n<pre><code>    Dim arrVar\n    strCelldata = Worksheets(\"Sheet1\").Cells(1, 1)\n    arrVar = Split(strCelldata, \"  \")\n    j = 2\n    For Each arrVal In arrVar\n        If Trim(arrVal) &lt;&gt; \"\" Then\n            Worksheets(\"Sheet1\").Cells(1, j) = arrVal\n            j = j + 1\n        End If\n    Next\n</code></pre>\n\n<p>you may need to add one more for loop to go thru all the data available on the excel sheet.</p>\n"}, {"comments": [{"owner": {"reputation": 197, "user_id": 3861575, "user_type": "registered", "accept_rate": 61, "profile_image": "https://graph.facebook.com/100001540040713/picture?type=large", "display_name": "Krish Krishna", "link": "https://stackoverflow.com/users/3861575/krish-krishna"}, "edited": false, "score": 0, "creation_date": 1435836138, "post_id": 31169331, "comment_id": 50371778, "body": "Works like a charm!! Accepted as answer!"}, {"owner": {"reputation": 197, "user_id": 3861575, "user_type": "registered", "accept_rate": 61, "profile_image": "https://graph.facebook.com/100001540040713/picture?type=large", "display_name": "Krish Krishna", "link": "https://stackoverflow.com/users/3861575/krish-krishna"}, "edited": false, "score": 0, "creation_date": 1435836473, "post_id": 31169331, "comment_id": 50372014, "body": "One more question here: I am actually trying to convert a text file to excel and then modify that excel with this code. In this process it does not save automatically ( I have added xl.ActiveWorkbook.Save) When i manually do it it says do you want to save filename.txt again.Can you help me on this"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "reply_to_user": {"reputation": 197, "user_id": 3861575, "user_type": "registered", "accept_rate": 61, "profile_image": "https://graph.facebook.com/100001540040713/picture?type=large", "display_name": "Krish Krishna", "link": "https://stackoverflow.com/users/3861575/krish-krishna"}, "edited": false, "score": 0, "creation_date": 1435836989, "post_id": 31169331, "comment_id": 50372395, "body": "You need to use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841185.aspx\" rel=\"nofollow noreferrer\"><code>SaveAs()</code></a> with the correct fileformat specifier if you want to save the file in a different format."}], "tags": [], "owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "is_accepted": true, "score": 1, "last_activity_date": 1435776519, "creation_date": 1435776519, "answer_id": 31169331, "question_id": 31160562, "link": "https://stackoverflow.com/questions/31160562/vbscript-to-split-excel-column-data-inexcel-into-2-columns/31169331#31169331", "title": "Vbscript to split excel column data inexcel into 2 columns", "body": "<p>I would use a regular expression to replace sequences of 2 or more consecutive spaces with a tab, and then use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193593.aspx\" rel=\"nofollow\"><code>TextToColumns</code></a> method to split the column in two:</p>\n\n<pre><code>Set xl = CreateObject(\"Excel.Application\")\nxl.Visible = True\n\nSet wb = xl.Workbooks.Open(\"C:\\path\\to\\your.xlsx\")\nSet ws = wb.Sheets(1)\n\nSet re = New RegExp\nre.Pattern = \"  +\"\n\nFor Each cell In ws.UsedRange\n  cell.Value = re.Replace(cell.Value, vbTab)\nNext\n\nws.UsedRange.TextToColumns\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 3861575, "user_type": "registered", "accept_rate": 61, "profile_image": "https://graph.facebook.com/100001540040713/picture?type=large", "display_name": "Krish Krishna", "link": "https://stackoverflow.com/users/3861575/krish-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1269, "favorite_count": 1, "accepted_answer_id": 31169331, "answer_count": 3, "score": 0, "last_activity_date": 1435776519, "creation_date": 1435751670, "question_id": 31160562, "link": "https://stackoverflow.com/questions/31160562/vbscript-to-split-excel-column-data-inexcel-into-2-columns", "title": "Vbscript to split excel column data inexcel into 2 columns", "body": "<p>I am trying to split the data in excel sheet which is like this: </p>\n\n<pre><code>|a a    1|\n|b b    2|\n|c c    3|\n|d d d  4|\n</code></pre>\n\n<p>to</p>\n\n<pre><code>|a a| 1|\n|b b| 2|\n|c c| 3|\n|d d d| 4|\n</code></pre>\n\n<p>I've observed a pattern like if there is more than one space in between the characters of any particular cell(or row), they should be split into seperate columns.</p>\n"}, {"tags": ["ms-access", "vba", "visibility"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1435755845, "post_id": 31160507, "comment_id": 50332708, "body": "Always include the full text of any error message which results from your code, and indicate which line in that code triggers the error.  Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 95, "user_id": 4281803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/apHwP.jpg?s=128&g=1", "display_name": "Mike Bradley", "link": "https://stackoverflow.com/users/4281803/mike-bradley"}, "is_accepted": false, "score": 0, "last_activity_date": 1435752600, "last_edit_date": 1435752600, "creation_date": 1435751911, "answer_id": 31160653, "question_id": 31160507, "link": "https://stackoverflow.com/questions/31160507/access-vba-code-button-visibility-not-working/31160653#31160653", "title": "ACCESS : VBA Code Button Visibility not working", "body": "<p>In similar cases, I've found that you need to specify the form reference (\"Me.\").</p>\n\n<p>So try (for example)</p>\n\n<pre><code>    Me.cmdCancel.Visible = True\n</code></pre>\n\n<p>In other words specify \"Me.\" in front of the control name.</p>\n"}, {"comments": [{"owner": {"reputation": 197, "user_id": 2800425, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001243010854/picture?type=large", "display_name": "Jei", "link": "https://stackoverflow.com/users/2800425/jei"}, "edited": false, "score": 0, "creation_date": 1436806540, "post_id": 31162111, "comment_id": 50754895, "body": "Thank you so much ^_^ It&#39;s been a big question in my mind."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1435755739, "creation_date": 1435755739, "answer_id": 31162111, "question_id": 31160507, "link": "https://stackoverflow.com/questions/31160507/access-vba-code-button-visibility-not-working/31162111#31162111", "title": "ACCESS : VBA Code Button Visibility not working", "body": "<p>This simplified version of your procedure will trigger error #2165, <em>\"You can't hide a control that has the focus.\"</em></p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdSave_Click()\n    Me.cmdSave.Visible = False\nEnd Sub\n</code></pre>\n\n<p>During <em>cmdSave_Click</em>, <em>cmdSave</em> has focus, so you can't hide it without first moving focus to another unhidden control.  This version will avoid that error:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdSave_Click()\n    Me.cmdSearch.Visible = True\n    Me.cmdSearch.SetFocus\n    Me.cmdSave.Visible = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 2800425, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100001243010854/picture?type=large", "display_name": "Jei", "link": "https://stackoverflow.com/users/2800425/jei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1891, "favorite_count": 0, "accepted_answer_id": 31162111, "answer_count": 2, "score": 1, "last_activity_date": 1435755784, "creation_date": 1435751517, "last_edit_date": 1435755784, "question_id": 31160507, "link": "https://stackoverflow.com/questions/31160507/access-vba-code-button-visibility-not-working", "title": "ACCESS : VBA Code Button Visibility not working", "body": "<p>I have a problem in hiding my buttons and not working mostly is when  the button itself was clicked, it supposed to be hidden. \nI have a code below from one of my buttons but most of the button visibility codes are not working. I tried to add:</p>\n\n<pre><code>DoEvents\n</code></pre>\n\n<p>but still don't work. I don't know what the problem is. Some Enable properties were working but some are not.</p>\n\n<pre><code>Private Sub cmdSave_Click()\n\nIf MsgBox(\"Are you sure to save record?\", vbYesNo, \"Save Record\") = vbYes Then\n\nDoEvents\n\n    imgPic.Enabled = False\n    txtLRN.Enabled = False\n    txtLN.Enabled = False\n    txtFN.Enabled = False\n    txtMN.Enabled = False\n    txtS.Enabled = False\n    txtA.Enabled = False\n    txtBD.Enabled = False\n    txtBP.Enabled = False\n    txtMT.Enabled = False\n    txtIP.Enabled = False\n    txtRG.Enabled = False\n    txtAH.Enabled = False\n    txtAB.Enabled = False\n    txtAM.Enabled = False\n    txtAP.Enabled = False\n    txtF.Enabled = False\n    txtM.Enabled = False\n    txtGN.Enabled = False\n    txtGR.Enabled = False\n    txtCN.Enabled = False\n    txtR.Enabled = False\n\nDoEvents\n    cmdSearch.Visible = True\n    cmdFirst.Visible = True\n    cmdPrev.Visible = True\n    cmdNext.Visible = True\n    cmdNext.Visible = True\n    cmdLast.Visible = True\n    cmdNew.Visible = True\n    cmdDelete.Visible = True\n    cmdEdit.Visible = True\n\n\nDoEvents\n    cmdSave.Visible = False\n    cmdCancel.Visible = False\n\nDoEvents\n\nEnd if\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 1, "creation_date": 1435751264, "post_id": 31160157, "comment_id": 50329352, "body": "Have you tried anything yourself yet?"}, {"owner": {"reputation": 33, "user_id": 5069263, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dfbac76aba8bbca05021fdf97ece0c5a?s=128&d=identicon&r=PG&f=1", "display_name": "B Bipin", "link": "https://stackoverflow.com/users/5069263/b-bipin"}, "reply_to_user": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1435752207, "post_id": 31160157, "comment_id": 50330042, "body": "Tried using below mentioned code but result for the ID with only one parameter was not accurate."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435752806, "post_id": 31160157, "comment_id": 50330483, "body": "if the IDs are sequential like that, starting at 0001, you can set up a string array of size 1 to max ID, iterate through your data row by row, building up a string for each entry which includes the status and all packages (suitably delimited) and then, once you load the array, iterate through it, writing the data back to the spreadsheet in the format you want."}, {"owner": {"reputation": 33, "user_id": 5069263, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dfbac76aba8bbca05021fdf97ece0c5a?s=128&d=identicon&r=PG&f=1", "display_name": "B Bipin", "link": "https://stackoverflow.com/users/5069263/b-bipin"}, "edited": false, "score": 0, "creation_date": 1435753470, "post_id": 31160157, "comment_id": 50330966, "body": "Sorry  John Coleman , I have changed actual data by simplified one, the id is 12 digit long alphanumeric code and my sheet contain records of nearly 400K rows."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1435754148, "post_id": 31160157, "comment_id": 50331451, "body": "Shame there is not <code>pivot</code> command and <code>unpivot</code> command in Excel <a href=\"http://blogs.msdn.com/b/spike/archive/2009/03/03/pivot-tables-in-sql-server-a-simple-sample.aspx\" rel=\"nofollow noreferrer\">as there is on MS SQL</a>."}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1435754301, "post_id": 31160157, "comment_id": 50331558, "body": "@Ralph Copy &gt; Pastespecial (Transpose). Plus all the functionality of <i>pivot</i> tables."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5069263, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dfbac76aba8bbca05021fdf97ece0c5a?s=128&d=identicon&r=PG&f=1", "display_name": "B Bipin", "link": "https://stackoverflow.com/users/5069263/b-bipin"}, "edited": false, "score": 0, "creation_date": 1435761766, "post_id": 31161427, "comment_id": 50337422, "body": "gipadm, Thanks a lot."}], "tags": [], "owner": {"reputation": 533, "user_id": 2838765, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9be8753cb746802259774e331236d5a1?s=128&d=identicon&r=PG&f=1", "display_name": "gipadm", "link": "https://stackoverflow.com/users/2838765/gipadm"}, "is_accepted": false, "score": 0, "last_activity_date": 1435755677, "last_edit_date": 1435755677, "creation_date": 1435753940, "answer_id": 31161427, "question_id": 31160157, "link": "https://stackoverflow.com/questions/31160157/excel-vba-arranging-vertically-entered-parameters-of-an-id-in-horizontal-fas/31161427#31161427", "title": "Excel - VBA - Arranging vertically entered parameters of an ID in Horizontal fashion", "body": "<p>This can be done with a simple loop</p>\n\n<pre><code>Sub Transpose()\n\nwriteRow = 1\n\nLastRow = Columns(1).Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\nFor i = 2 To LastRow\n\n    If Cells(i, 1).Value &lt;&gt; currentID Then\n        'New ID\n        writeRow = writeRow + 1\n        currentID = Cells(i, 1).Value\n        Cells(writeRow, 5).Value = currentID\n        Cells(writeRow, 6).Value = Cells(i, 2).Value\n        Cells(writeRow, 7).Value = Cells(i, 3).Value\n    Else\n        'Continue from old ID\n        Cells(writeRow, Rows(writeRow).Find(\"*\", searchorder:=xlByColumns, searchdirection:=xlPrevious).Column + 1).Value = Cells(i, 3).Value\n    End If\n\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I didn't read that you also need a reverse routine. Try these:</p>\n\n<pre><code>Sub Transpose()\n\nCells(2, 5).CurrentRegion.ClearContents\nwriteRow = 1\n\nFor i = 2 To Columns(1).Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\n\n    If Cells(i, 1).Value &lt;&gt; currentID Then\n        'New ID\n        writeRow = writeRow + 1\n        currentID = Cells(i, 1).Value\n        Cells(writeRow, 5).Value = currentID\n        Cells(writeRow, 6).Value = Cells(i, 2).Value\n        Cells(writeRow, 7).Value = Cells(i, 3).Value\n        writeCol = 8\n    Else\n        'Continue from old ID\n        Cells(writeRow, writeCol).Value = Cells(i, 3).Value\n        writeCol = writeCol + 1\n    End If\n\n\nNext i\n\nEnd Sub\n\nSub ReverseTranspose()\n\nCells(2, 1).CurrentRegion.ClearContents\nwriteRow = 1\n\nFor i = 2 To Columns(5).Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\n\n    For j = 7 To WorksheetFunction.Max(7, Rows(i).Find(\"*\", searchorder:=xlByColumns, searchdirection:=xlPrevious).Column)\n         writeRow = writeRow + 1\n         currentID = Cells(i, 5).Value\n         Cells(writeRow, 1).Value = currentID\n         Cells(writeRow, 2).Value = Cells(i, 6).Value\n         Cells(writeRow, 3).Value = Cells(i, j).Value\n     Next j\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": true, "score": 0, "last_activity_date": 1435754006, "creation_date": 1435754006, "answer_id": 31161456, "question_id": 31160157, "link": "https://stackoverflow.com/questions/31160157/excel-vba-arranging-vertically-entered-parameters-of-an-id-in-horizontal-fas/31161456#31161456", "title": "Excel - VBA - Arranging vertically entered parameters of an ID in Horizontal fashion", "body": "<p>I would use a simple formula:</p>\n\n<blockquote>\n  <p>=\"Package\"&amp;COUNTIF($A$1:$A2;A2)</p>\n</blockquote>\n\n<p>It creates your matching names and then you can use a Pivot to summarize. Of course you could set up loops through for each separate ID.<br>\nThe reverse is more tricky, I'd resort to something along the lines of </p>\n\n<pre><code>Sub ertdfgcvb()\nDim ws As Worksheet, wsex As Worksheet, k As Long, i As Long, j As Long, LastRow As Long\nSet ws = Sheets(\"tabular form\")\nSet ws = Sheets(\"dataset form\")\nk = 2\nLastRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nFor i = 2 To LastRow 'from the second to the last row\n    j = 3 'start at Package1\n    While Not IsEmpty(ws.Cells(i, j))\n        wsex.Cells(k, 1).Value2 = ws.Cells(i, 1).Value2 'copies the ID from the A column\n        wsex.Cells(k, 2).Value2 = ws.Cells(i, 2).Value2 'Copies status likewise\n        wsex.Cells(k, 3).Value2 = ws.Cells(i, j).Value2 'copies Package&lt;n&gt;\n        'wsex.Cells(k, 4).Value2 = \"Package\" &amp; j - 2 'copies \"Package&lt;n&gt;\"\n        k = k + 1 'increases counters\n        j = j + 1\n    Wend\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5069263, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dfbac76aba8bbca05021fdf97ece0c5a?s=128&d=identicon&r=PG&f=1", "display_name": "B Bipin", "link": "https://stackoverflow.com/users/5069263/b-bipin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 1, "accepted_answer_id": 31161456, "answer_count": 2, "score": 1, "last_activity_date": 1435755677, "creation_date": 1435750508, "last_edit_date": 1435752730, "question_id": 31160157, "link": "https://stackoverflow.com/questions/31160157/excel-vba-arranging-vertically-entered-parameters-of-an-id-in-horizontal-fas", "title": "Excel - VBA - Arranging vertically entered parameters of an ID in Horizontal fashion", "body": "<p>I\u2019m new to <code>VBA</code> and have been searching the solution from long time.\nI need the data to perform <code>Vlookup</code> with another set of data having common IDs\nI have data like given below.</p>\n\n<pre><code>ID          Status  Package\n0001        ACT     Gold\n0001        ACT     SSA\n0001        ACT     SP\n0002        ACT     Silver\n0003        DIS     SSA\n0003        DIS     SSB\n0004        ACT     PT\n0005        DIS     NP\n0006        DIS     &lt;Blank &gt;\n</code></pre>\n\n<p>And I need it in following structure</p>\n\n<pre><code>ID          Status  Package1    Package 2   Package 3\u2026.\n0001        ACT     Gold        SSA         SP\n0002        ACT     Silver\n0003        DIS     SSA         SSB\n0004        ACT     PT\n0005        DIS     NP\n0006        DIS     \n</code></pre>\n\n<p>Number of packages can vary from 0 to 15.</p>\n\n<p>Also how to do reverse operation? (secondary requirement) </p>\n\n<p>Tried this code (!) but result for values with 1 or no parameters was not accurate.</p>\n\n<pre><code>    Sub test()\nDim Dic As Object: Set Dic = CreateObject(\"Scripting.Dictionary\")\nDim CLa As Range, CLb As Range, x&amp;, Names$, ID$, Key\n' Sheet1 is a Source Sheet\n' Sheet3 is a Target Sheet\nx = Sheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row\nFor Each CLa In Sheets(\"Sheet1\").Range(\"A1:A\" &amp; x)\n    If Not Dic.exists(CStr(CLa.Value)) Then\n        ID = CLa.Value\n' Sheet1 is a Source Sheet\n' Sheet3 is a Target Sheet\n\n        For Each CLb In Sheets(\"Sheet1\").Range(\"A1:A\" &amp; x)\n            If CLb.Value = ID Then\n\n                If Names = \"\" Then\n                    Names = CLb.Offset(, 2).Value\n                Else\n                    Names = Names &amp; \",\" &amp; CLb.Offset(, 2).Value\n                End If\n\n            End If\n        Next CLb\n\n    Dic.Add ID, Names\n    End If\n    ID = Empty: Names = Empty\nNext CLa\n\nx = 1\nFor Each Key In Dic\n    Sheets(\"Sheet3\").Cells(x, 1).Value = Key\n    Sheets(\"Sheet3\").Range(Cells(x, 2), Cells(x, 4)) = Split(Dic(Key), \",\")\n    x = x + 1\nNext Key\n\nSheets(\"Sheet3\").Cells.Replace \"#N/A\", Replacement:=\"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-97"], "answers": [{"tags": [], "owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "is_accepted": true, "score": 2, "last_activity_date": 1435753761, "creation_date": 1435753761, "answer_id": 31161366, "question_id": 31160009, "link": "https://stackoverflow.com/questions/31160009/why-does-join-ing-a-split-with-limit-64-return-more-than-64-substrings/31161366#31161366", "title": "Why does Join()-ing a Split() with limit 64 return more than 64 substrings?", "body": "<p>The third parameter of the <a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.90).aspx\" rel=\"nofollow\"><code>Split()</code></a> function places a limit on the number of elements returned. It does not, however, mean that further elements are lost. They are all returned unsplit in the last element.</p>\n\n<p>As such, you are splitting your string into a maximum of 64 substrings. In this case, the 64th element is the unsplit value of what would be elements 64 to 113.</p>\n\n<p>When you run <code>Join()</code> on the resultant array, you will get the original string back.</p>\n\n<p>What you need to do is <code>Split()</code> the string and then discard the elements you do not want:</p>\n\n<pre><code>List = Split(x2BlackList, \";\")\n\nIf UBound(List) &gt; 63 Then\n    ReDim Preserve List(63)\nEnd If\n\nNewBlackList = Join(List, \";\")\n</code></pre>\n"}], "owner": {"reputation": 527, "user_id": 2190172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d93672682b355659df4e6410ceedcc93?s=128&d=identicon&r=PG", "display_name": "Marc Dingena", "link": "https://stackoverflow.com/users/2190172/marc-dingena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 31161366, "answer_count": 1, "score": 1, "last_activity_date": 1594644197, "creation_date": 1435750059, "last_edit_date": 1594644197, "question_id": 31160009, "link": "https://stackoverflow.com/questions/31160009/why-does-join-ing-a-split-with-limit-64-return-more-than-64-substrings", "title": "Why does Join()-ing a Split() with limit 64 return more than 64 substrings?", "body": "<p>I have to limit a string to a maximum of 64 substrings, which are divided by <code>;</code>. The input string contains 113 substrings:</p>\n\n<pre><code>x2BlackList = \"mcc=206,mnc=1,mncLength=2,enbId=180096;mcc=206,mnc=1,mncLength=2,enbId=80459;mcc=206,mnc=1,mncLength=2,enbId=84604;mcc=206,mnc=1,mncLength=2,enbId=180166;mcc=206,mnc=1,mncLength=2,enbId=80279;mcc=206,mnc=1,mncLength=2,enbId=80288;mcc=206,mnc=1,mncLength=2,enbId=80457;mcc=208,mnc=10,mncLength=2,enbId=4791;mcc=206,mnc=1,mncLength=2,enbId=80197;mcc=206,mnc=1,mncLength=2,enbId=80188;mcc=206,mnc=1,mncLength=2,enbId=80195;mcc=206,mnc=1,mncLength=2,enbId=80206;mcc=206,mnc=1,mncLength=2,enbId=181309;mcc=206,mnc=1,mncLength=2,enbId=181218;mcc=206,mnc=1,mncLength=2,enbId=180254;mcc=206,mnc=1,mncLength=2,enbId=80332;mcc=206,mnc=1,mncLength=2,enbId=180340;mcc=206,mnc=1,mncLength=2,enbId=83355;mcc=206,mnc=1,mncLength=2,enbId=180367;mcc=206,mnc=1,mncLength=2,enbId=181222;mcc=206,mnc=1,mncLength=2,enbId=83887;mcc=206,mnc=1,mncLength=2,enbId=181026;mcc=206,mnc=1,mncLength=2,enbId=180356;mcc=206,mnc=1,mncLength=2,enbId=181001;mcc=206,mnc=1,mncLength=2,enbId=84624;mcc=206,mnc=1,mncLength=2,enbId=80209;mcc=206,mnc=1,mncLength=2,enbId=80318;mcc=206,mnc=1,mncLength=2,enbId=80454;mcc=206,mnc=1,mncLength=2,enbId=80471;mcc=206,mnc=1,mncLength=2,enbId=80476;mcc=206,mnc=1,mncLength=2,enbId=80486;mcc=206,mnc=1,mncLength=2,enbId=80526;mcc=206,mnc=1,mncLength=2,enbId=80445;mcc=206,mnc=1,mncLength=2,enbId=80586;mcc=206,mnc=1,mncLength=2,enbId=80212;mcc=206,mnc=1,mncLength=2,enbId=80189;mcc=206,mnc=1,mncLength=2,enbId=80453;mcc=206,mnc=1,mncLength=2,enbId=80474;mcc=206,mnc=1,mncLength=2,enbId=80191;mcc=206,mnc=1,mncLength=2,enbId=181230;mcc=206,mnc=1,mncLength=2,enbId=181394;mcc=206,mnc=1,mncLength=2,enbId=181401;mcc=206,mnc=1,mncLength=2,enbId=83338;mcc=206,mnc=1,mncLength=2,enbId=83395;mcc=206,mnc=1,mncLength=2,enbId=83415;mcc=206,mnc=1,mncLength=2,enbId=180381;mcc=206,mnc=1,mncLength=2,enbId=80180;mcc=206,mnc=1,mncLength=2,enbId=80196;mcc=206,mnc=1,mncLength=2,enbId=80484;mcc=206,mnc=1,mncLength=2,enbId=80204;mcc=206,mnc=1,mncLength=2,enbId=80464;mcc=206,mnc=1,mncLength=2,enbId=80314;mcc=206,mnc=1,mncLength=2,enbId=84580;mcc=206,mnc=1,mncLength=2,enbId=80520;mcc=206,mnc=1,mncLength=2,enbId=83387;mcc=206,mnc=1,mncLength=2,enbId=83376;mcc=206,mnc=1,mncLength=2,enbId=83397;mcc=206,mnc=1,mncLength=2,enbId=83439;mcc=206,mnc=1,mncLength=2,enbId=80324;mcc=206,mnc=1,mncLength=2,enbId=180094;mcc=206,mnc=1,mncLength=2,enbId=80291;mcc=206,mnc=1,mncLength=2,enbId=80293;mcc=206,mnc=1,mncLength=2,enbId=80297;mcc=206,mnc=1,mncLength=2,enbId=80299;mcc=206,mnc=1,mncLength=2,enbId=80307;mcc=206,mnc=1,mncLength=2,enbId=80458;mcc=206,mnc=1,mncLength=2,enbId=80473;mcc=206,mnc=1,mncLength=2,enbId=80502;mcc=206,mnc=1,mncLength=2,enbId=80517;mcc=206,mnc=1,mncLength=2,enbId=80540;mcc=206,mnc=1,mncLength=2,enbId=80583;mcc=206,mnc=1,mncLength=2,enbId=83815;mcc=206,mnc=1,mncLength=2,enbId=83818;mcc=206,mnc=1,mncLength=2,enbId=83823;mcc=206,mnc=1,mncLength=2,enbId=83834;mcc=206,mnc=1,mncLength=2,enbId=84006;mcc=206,mnc=1,mncLength=2,enbId=84018;mcc=206,mnc=1,mncLength=2,enbId=84594;mcc=206,mnc=1,mncLength=2,enbId=84605;mcc=206,mnc=1,mncLength=2,enbId=84610;mcc=206,mnc=1,mncLength=2,enbId=180514;mcc=206,mnc=1,mncLength=2,enbId=180519;mcc=206,mnc=1,mncLength=2,enbId=180523;mcc=206,mnc=1,mncLength=2,enbId=180528;mcc=206,mnc=1,mncLength=2,enbId=180530;mcc=206,mnc=1,mncLength=2,enbId=180611;mcc=206,mnc=1,mncLength=2,enbId=180612;mcc=206,mnc=1,mncLength=2,enbId=180616;mcc=206,mnc=1,mncLength=2,enbId=180618;mcc=206,mnc=1,mncLength=2,enbId=180619;mcc=206,mnc=1,mncLength=2,enbId=180620;mcc=206,mnc=1,mncLength=2,enbId=180623;mcc=206,mnc=1,mncLength=2,enbId=180625;mcc=206,mnc=1,mncLength=2,enbId=180629;mcc=206,mnc=1,mncLength=2,enbId=180814;mcc=206,mnc=1,mncLength=2,enbId=181254;mcc=206,mnc=1,mncLength=2,enbId=181275;mcc=206,mnc=1,mncLength=2,enbId=181466;mcc=206,mnc=1,mncLength=2,enbId=181482;mcc=206,mnc=1,mncLength=2,enbId=181648;mcc=206,mnc=1,mncLength=2,enbId=181737;mcc=234,mnc=10,mncLength=2,enbId=504599;mcc=234,mnc=10,mncLength=2,enbId=504699;mcc=234,mnc=10,mncLength=2,enbId=505533;mcc=234,mnc=10,mncLength=2,enbId=505559;mcc=234,mnc=10,mncLength=2,enbId=505563;mcc=234,mnc=10,mncLength=2,enbId=505627;mcc=234,mnc=10,mncLength=2,enbId=505711;mcc=234,mnc=10,mncLength=2,enbId=505805;mcc=234,mnc=10,mncLength=2,enbId=506130;mcc=234,mnc=10,mncLength=2,enbId=506624;mcc=234,mnc=10,mncLength=2,enbId=506752;mcc=234,mnc=10,mncLength=2,enbId=506888\"\n</code></pre>\n\n<p>Using <code>Split</code> I can limit the number of substrings to 64:</p>\n\n<pre><code>Dim List() As String, _\n    Item As Variant, _\n    Counter As Long\nCounter = 0\nList = Split(x2BlackList, \";\", 64)\nFor Each Item In List\n    Counter = Counter + 1\nNext\nDebug.Print Counter\n</code></pre>\n\n<p>The debug window indicates 64 elements counted. Using <code>Join</code> I want to put these 64 elements into a string with <code>;</code> as separator:</p>\n\n<pre><code>NewBlackList = Join(List, \";\")\nDebug.Print NewBlackList\n</code></pre>\n\n<p>But <code>NewBlackList</code> contains all 113 substrings. I have tried the above code, and also the simplified version below (which I would prefer to use), but both do not limit the string to 64 substrings.</p>\n\n<pre><code>SetBlackList = Join(Split(x2BlackList, \";\", 64), \";\")\n</code></pre>\n\n<p><strong>Why does <code>Join()</code>ing a <code>Split(,,64)</code> return more than 64 substrings?</strong></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435756096, "post_id": 31159742, "comment_id": 50332906, "body": "Have you done what you want to do manually with the macro recorder turned on? You only have one instance of .AddChart - why should it be surprising that it only adds one chart?"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435772562, "post_id": 31159742, "comment_id": 50344120, "body": "Generally using <code>SetSourceData</code> limits you to however Excel wants to interpret your ranges.  It is better to build the <code>Series</code> and define the ranges explicitly.  <a href=\"http://stackoverflow.com/questions/29715656/excel-multiple-dynamic-graphs/29720112#29720112\">See this answer</a> for an example of how to create a chart.  It is possible to add a second series with another call to <code>SeriesCollection.NewSeries</code> or a second chart by simply calling the <code>Sub</code> a second time with different ranges."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435772621, "post_id": 31159742, "comment_id": 50344144, "body": "Your images are not accessible since you linked to your Gmail account.  Please <a href=\"https://stackoverflow.com/posts/31159742/edit\">edit</a> your post to include links that accessible to others.  I will edit them into the question as proper images."}], "owner": {"reputation": 97, "user_id": 4978108, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/663dc6868e6100b80bba674020008c91?s=128&d=identicon&r=PG&f=1", "display_name": "adventurer", "link": "https://stackoverflow.com/users/4978108/adventurer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1435751548, "creation_date": 1435749372, "last_edit_date": 1435751548, "question_id": 31159742, "link": "https://stackoverflow.com/questions/31159742/vba-code-for-plotting-two-separate-charts-for-alternate-columns", "title": "VBA code for plotting two separate charts for alternate columns", "body": "<p><a href=\"https://mail.google.com/mail/u/0/?ui=2&amp;ik=4975315e5e&amp;view=fimg&amp;th=14e49324450b94b8&amp;attid=0.1&amp;disp=inline&amp;realattid=f_ibkmqwye0&amp;safe=1&amp;attbid=ANGjdJ-YlHlj0DInSTwrvjoQ-xqHjMpnIGL0ia-T5S7-6cjqAxSBBE5p2fXMIz8SorKHukyT0xMrBcAYUUhxOaUcXeGsBht5Ao0RQ3JKFfjFXRDpn2P9zwHsE7pAY-M&amp;ats=1435749492411&amp;rm=14e49324450b94b8&amp;zw&amp;sz=w1342-h523\" rel=\"nofollow\">This</a> is the part of the large data set I have. I want to plot two separate charts for the 'Actual' and '% of total'. </p>\n\n<p>This is the code I currently have:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nDim ChartRange1 As Range\nDim ChartRange2 As Range\n\n`StrtRow = 1\n StartRow = 3\n EndRow = 6\n\nWith Sheets(\"Sheet1\")\n\nSet ChartRange1 = Range(Cells(StrtRow, \"B\"), Cells(EndRow, \"B\"))\nChartRange1Addr = ChartRange1.Address(External:=True)\n\n Set ChartRange2 = Range(Cells(StrtRow, \"C\"), Cells(EndRow, \"J\"))\nChartRange2Addr = ChartRange2.Address(External:=True)\nEnd With\n\nActiveSheet.Shapes.AddChart.Select\n\n'We set the source data for the chart (y,x)\n\n\nActiveChart.SetSourceData Source:=Range( _\nChartRange1Addr &amp; \",\" &amp; ChartRange2Addr)\n\n\n'We define the type of chart\n\nActiveChart.ChartType = xlColumnClustered\n\n' Before we can perform an action on the chart we need to activate it\n    ActiveSheet.ChartObjects(1).Activate\n'We perform the cut operation\n    ActiveSheet.ChartObjects(1).Cut\n'we select the Sheet2 where we wish to paste our chart\n    Sheets(\"Sheet2\").Select\n'We now paste the chart in the Sheet2 whic has become the active sheet after selection\n    ActiveSheet.Paste\n'we return to sheet1\n    Sheets(\"Sheet1\").Select\n' we select the cell F9 in sheet1\n    Range(\"F9\").Activate\n\nEnd Sub\n</code></pre>\n\n<p>It gives me the Actual and % plots in same chart. I have tried code for selecting alternate columns and plotting two charts, but it did not work. </p>\n\n<p><a href=\"https://mail.google.com/mail/u/0/?ui=2&amp;ik=4975315e5e&amp;view=fimg&amp;th=14e49354ed58ce41&amp;attid=0.1&amp;disp=inline&amp;realattid=f_ibkmvd2y1&amp;safe=1&amp;attbid=ANGjdJ9ZdaI9cI224Ca5A3o76SP8rLtkcO3jm09mXnO1ZDaKhMzVpqswi_vKFjIKPNTq9-eU_DQF6aqTCvV2VGK6w0q7KNS_NIi1WeiUVspCKB1qcf6I3FTkR1IBG8M&amp;ats=1435749492414&amp;rm=14e49354ed58ce41&amp;zw&amp;sz=w1342-h523\" rel=\"nofollow\">This</a> is the chart I got. Please suggest where I can amend my code to make two separate charts for alternate columns - one for 'Actual' and the other for '% of total' values.              </p>\n"}, {"tags": ["vba", "excel", "automation", "copy"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5069033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43677b84978d0ffff70ccc21c7545b25?s=128&d=identicon&r=PG&f=1", "display_name": "Ezikiel Hazegaiah", "link": "https://stackoverflow.com/users/5069033/ezikiel-hazegaiah"}, "edited": false, "score": 0, "creation_date": 1435925010, "post_id": 31159951, "comment_id": 50414607, "body": "Thank you Evan. This Looks really promising. Ive been trying to implement this Code but when using it, i get a runtime error, and dont know how to correct it. the debugger stops at this line: Range(&quot;A&quot; &amp; rCell.Row &amp; &quot;K&quot; &amp; rCell.Row).Copy. Can someone explain to me how to use it?"}, {"owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "reply_to_user": {"reputation": 9, "user_id": 5069033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43677b84978d0ffff70ccc21c7545b25?s=128&d=identicon&r=PG&f=1", "display_name": "Ezikiel Hazegaiah", "link": "https://stackoverflow.com/users/5069033/ezikiel-hazegaiah"}, "edited": false, "score": 0, "creation_date": 1436192313, "post_id": 31159951, "comment_id": 50493694, "body": "try adding <code>sheet.select</code> and <code>range.select</code> to the code, sheet ouside of the loop and range inside the loop before the copy method.  The copy method might be failing becasue a different sheet is active."}], "tags": [], "owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "is_accepted": false, "score": 0, "last_activity_date": 1435749874, "creation_date": 1435749874, "answer_id": 31159951, "question_id": 31159239, "link": "https://stackoverflow.com/questions/31159239/how-do-you-copy-rows-if-a-cell-is-empty/31159951#31159951", "title": "How do you copy rows if a cell is empty?", "body": "<p>If I am understanding correctly you want to copy each row where the cell in Column K is empty?</p>\n\n<pre><code>Dim rCell As Range, rng As Range, NextRow As Long\nSet rng = Workbook.Sheets(\"SheetName\").Range(\"K3:K22\")\n\n'loop through each K cell\nFor Each rCell In rng\n    If IsEmpty(rCell) Then\n        'copy that row\n        Range(\"A\" &amp; rCell.Row &amp; \"K\" &amp; rCell.Row).Copy\n        'if desired here can be code to check the date to see which sheet to insert into\n        NextRow = Workbook.Sheets(\"MonthSheet\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Row\n        Workbook.Sheets(\"MonthSheet\").Range(\"A\" &amp; NextRow &amp; \"K\" &amp; NextRow).Paste\n    End If\nNext rCell\n</code></pre>\n\n<p>This will check each cell in the K column to see if it is empty, if it is it will copy it to the next blank row in the Month Sheet</p>\n"}], "owner": {"reputation": 9, "user_id": 5069033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43677b84978d0ffff70ccc21c7545b25?s=128&d=identicon&r=PG&f=1", "display_name": "Ezikiel Hazegaiah", "link": "https://stackoverflow.com/users/5069033/ezikiel-hazegaiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1570, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435815085, "creation_date": 1435747949, "last_edit_date": 1435815085, "question_id": 31159239, "link": "https://stackoverflow.com/questions/31159239/how-do-you-copy-rows-if-a-cell-is-empty", "title": "How do you copy rows if a cell is empty?", "body": "<p>We are using an Excel file to keep track of the drug therapy.</p>\n\n<p>Once a Drug Therapy ends, I'll write \"yes\" in column K (probably change that to a date later on). I've prepared a sheet for every Month (named: 01 - 12) and I want it to automatically copy rows which have no entry in column K into the next spread sheet . The range is <code>3A:K22</code>. (Rows 1 &amp; 2 have Data that shouldn't be modified. I hope I have described it in enough detail for you to understand. If not I'd gladly clarify any misunderstanding.</p>\n"}, {"tags": ["string", "vba"], "comments": [{"owner": {"reputation": 1315, "user_id": 2294676, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4a9d6886d6cb3767d25f302ae880085?s=128&d=identicon&r=PG", "display_name": "Lydia Ralph", "link": "https://stackoverflow.com/users/2294676/lydia-ralph"}, "edited": false, "score": 0, "creation_date": 1435749986, "post_id": 31159220, "comment_id": 50328462, "body": "Try <a href=\"http://stackoverflow.com/a/9582919/2294676\">stackoverflow.com/a/9582919/2294676</a> - formula-based but could be useful"}], "answers": [{"tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 0, "last_activity_date": 1435748823, "creation_date": 1435748823, "answer_id": 31159560, "question_id": 31159220, "link": "https://stackoverflow.com/questions/31159220/vba-string-manipulation-empty-spaces/31159560#31159560", "title": "VBA - String Manipulation empty spaces", "body": "<p>You want to use </p>\n\n<pre><code>Trim(\"    Hello World\")\n</code></pre>\n\n<p>This will trim any blank spaces off the front and rear of the string.</p>\n"}, {"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1435749230, "last_edit_date": 1435749230, "creation_date": 1435748912, "answer_id": 31159588, "question_id": 31159220, "link": "https://stackoverflow.com/questions/31159220/vba-string-manipulation-empty-spaces/31159588#31159588", "title": "VBA - String Manipulation empty spaces", "body": "<p>Firstly identify the rogue character - probably a tab:</p>\n\n<pre><code>str = trim$(str)\n\n?\"\"\"\" &amp; str &amp; \"\"\"\"\n\"   Hello World!\"\n\n'//what is the char code of the first char?\n?ascw(left$(str, 1))\n 9 '// tab\n</code></pre>\n\n<p>Then implement a custom <code>LTrim</code>, E.g.</p>\n\n<pre><code>Function LTrimWs(str As String) As String\n    Dim i As Long\n    For i = 1 To Len(str)\n        Select Case Mid$(str, i, 1)\n            Case \" \", ChrW$(9)\n               Mid$(str, i, 1) = \" \"\n            Case Else\n               LTrimWs = LTrim$(str)\n               Exit For\n        End Select\n    Next\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 31159588, "answer_count": 2, "score": 1, "last_activity_date": 1435749230, "creation_date": 1435747890, "question_id": 31159220, "link": "https://stackoverflow.com/questions/31159220/vba-string-manipulation-empty-spaces", "title": "VBA - String Manipulation empty spaces", "body": "<p>I am using WinHttp.WinHttpRequest to retrieve information from a site. \nHowever the retrieved information comes with some empty spaces before the beginning, which can be removed with LeftTrim function. </p>\n\n<p>But even after the string is trimmed I still get some annoying things before the first letter. </p>\n\n<pre><code>Text before Ltrim\n\"     Hello World!\"\n\nText after Ltrim\n\"  Hello World!\"\n</code></pre>\n\n<p>Note: Using left to display the first char of the trimmed text returns \"\", but trying to use IF comparison to \"\" doesn't work so I can't get rid of these \"\". </p>\n\n<pre><code>If left(\"  Hello World!\",1) = \"\" then \n   ' code to remove \"\"\n</code></pre>\n\n<p>How do I remove this damn things, what is this?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "is_accepted": false, "score": 0, "last_activity_date": 1435746868, "last_edit_date": 1435746868, "creation_date": 1435746349, "answer_id": 31158742, "question_id": 31158625, "link": "https://stackoverflow.com/questions/31158625/return-something-when-value-is-at-least-found-once-in-column-b-for-item-in-colum/31158742#31158742", "title": "Return something when value is at least found once in column B for item in column A", "body": "<p>The setup which follows will output this:</p>\n\n<pre><code>Account no  Charge method  \nA1          IC1            Exempt\nA1          IC2            Exempt\nA1          Exempt         Exempt\nA2          IC1            \nA2          IC2            \nA3          IC1            Exempt\nA3          IC2            Exempt\nA3          IC3            Exempt\nA3          Exempt         Exempt\nA4          IC1            Exempt\nA4          IC2            Exempt\nA4          Exempt         Exempt\n</code></pre>\n\n<p>I have set the third column as \"Exempt\" if there exists a row with the corresponding Account No. in A, and \"Exempt\" in column B; and blank if not.</p>\n\n<p>If I have misunderstood the problem, please correct me.</p>\n\n<hr>\n\n<p>Create a Column C with the following formula:</p>\n\n<pre><code>=A1&amp;\" \"&amp;B1\n</code></pre>\n\n<p>Drag this down for the whole column as far as necessary.</p>\n\n<p>Hide Column C. Then create Column D with</p>\n\n<pre><code>=IF(COUNTIF(C:C,A1&amp; \" Exempt\")&gt;0,\"Exempt\",\"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 0, "last_activity_date": 1435747003, "creation_date": 1435747003, "answer_id": 31158933, "question_id": 31158625, "link": "https://stackoverflow.com/questions/31158625/return-something-when-value-is-at-least-found-once-in-column-b-for-item-in-colum/31158933#31158933", "title": "Return something when value is at least found once in column B for item in column A", "body": "<p>You could try this vba solution, it expects accounts/charge methods to be in columns A/B and it will populate into column D</p>\n\n<pre><code>Sub t()\n\n'change activesheet to sheets(\"NAME OF SHEET\") if needed\nWith ActiveSheet\n\n    'If list is not empty, clear it\n    If .Range(\"D2\").Value &lt;&gt; \"\" Then\n        .Range(\"D2:\" &amp; .Range(\"D1\").End(xlDown).Address).ClearContents\n    End If\n\n    For Each cell In .Range(\"A2:\" &amp; .Range(\"A2\").End(xlDown).Address)\n\n        'if exempt found\n        If cell.Offset(0, 1).Value = \"Exempt\" Then\n\n            'If list is empty, start list\n            If .Range(\"D2\").Value = \"\" Then\n                .Range(\"D2\").Value = cell.Value\n            Else\n                'is account already in list\n                Found = 0\n                For Each c In .Range(\"D1:\" &amp; .Range(\"D1\").End(xlDown).Address)\n                    If c.Value = cell.Value Then\n                        Found = 1\n                    End If\n                Next\n\n                'If not in list, add it\n                If Found = 0 Then .Range(\"D1\").End(xlDown).Offset(1, 0).Value = cell.Value\n            End If\n        End If\n    Next\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1435748022, "post_id": 31159156, "comment_id": 50327083, "body": "Thanks. One more question though: Does <code>($A$2:$A$13=A2)</code> return TRUE when the value of A2 is found in the range A2 to A13?"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1435748128, "post_id": 31159156, "comment_id": 50327166, "body": "Right. So in this case, it returns an array containing <code>{TRUE;TRUE;TRUE;FALSE;FALSE;FALSE;FALSE;FALSE;FALSE;FALSE;FA&zwnj;&#8203;LSE;FALSE}</code>. Try it out."}, {"owner": {"reputation": 23, "user_id": 5069079, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lu8Ipex_B1Y/AAAAAAAAAAI/AAAAAAAAA50/OuIbQXsDlD0/photo.jpg?sz=128", "display_name": "Dorota Bab\u015b", "link": "https://stackoverflow.com/users/5069079/dorota-bab%c5%9b"}, "edited": false, "score": 1, "creation_date": 1435835515, "post_id": 31159156, "comment_id": 50371336, "body": "Thanks a lot! It does work fine. I found also this formula and thought I could use it, but I&#39;m afraid something may be missing here. Can you tell if this would also work? =IF(COUNTIFS(A:A,A2,B:B,&quot;Exempt&quot;),&quot;Exempt&quot;,&quot;&quot;)"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 23, "user_id": 5069079, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lu8Ipex_B1Y/AAAAAAAAAAI/AAAAAAAAA50/OuIbQXsDlD0/photo.jpg?sz=128", "display_name": "Dorota Bab\u015b", "link": "https://stackoverflow.com/users/5069079/dorota-bab%c5%9b"}, "edited": false, "score": 0, "creation_date": 1435863076, "post_id": 31159156, "comment_id": 50389693, "body": "@DorotaBab\u015b: Nice, that also works. In fact, it might be better, because it doesn&#39;t require array formulas. You should post that as an answer."}], "tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": true, "score": 2, "last_activity_date": 1435748232, "last_edit_date": 1435748232, "creation_date": 1435747693, "answer_id": 31159156, "question_id": 31158625, "link": "https://stackoverflow.com/questions/31158625/return-something-when-value-is-at-least-found-once-in-column-b-for-item-in-colum/31159156#31159156", "title": "Return something when value is at least found once in column B for item in column A", "body": "<p>This simple formula works without any helper columns or VBA:</p>\n\n<pre><code>=IF(SUM(--($A$2:$A$13=A2)*($B$2:$B$13=\"Exempt\"))&gt;0,\"Exempt\",\"\")\n</code></pre>\n\n<p>entered as an array formula using <kbd>Ctrl</kbd> <kbd>Shift</kbd> <kbd>Enter</kbd>, and then copied down.</p>\n\n<p><img src=\"https://i.stack.imgur.com/ReiCT.png\" alt=\"enter image description here\"></p>\n\n<p>Notes:</p>\n\n<ul>\n<li><code>$A$2:$A$13=A2</code> returns an array containing <code>{TRUE;TRUE;TRUE;FALSE;FALSE;FALSE;FALSE;FALSE;FALSE;FALSE;FALSE;FALSE}</code>.</li>\n<li>Same idea for <code>$B$2:$B$13=\"Exempt\"</code>: it returns <code>{FALSE;FALSE;TRUE;FALSE;FALSE;FALSE;FALSE;FALSE;TRUE;FALSE;FALSE;TRUE}</code></li>\n<li><code>--</code> converts boolean TRUE/FALSE to 1/0.</li>\n<li>Multiplying these 1's and 0's using <code>*</code> is equivalent to a logical AND on the corresponding boolean values; the result is <code>{0;0;1;0;0;0;0;0;0;0;0;0}</code></li>\n<li>If the sum of that array is greater than zero, then you've got a match.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 5069079, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lu8Ipex_B1Y/AAAAAAAAAAI/AAAAAAAAA50/OuIbQXsDlD0/photo.jpg?sz=128", "display_name": "Dorota Bab\u015b", "link": "https://stackoverflow.com/users/5069079/dorota-bab%c5%9b"}, "is_accepted": false, "score": 1, "last_activity_date": 1436168657, "creation_date": 1436168657, "answer_id": 31240275, "question_id": 31158625, "link": "https://stackoverflow.com/questions/31158625/return-something-when-value-is-at-least-found-once-in-column-b-for-item-in-colum/31240275#31240275", "title": "Return something when value is at least found once in column B for item in column A", "body": "<p>We came to a conclusion that the most simple formula for the given example would be this one:\n=IF(COUNTIFS(A:A,A2,B:B,\"Exempt\"),\"Exempt\",\"\") </p>\n\n<p>Thank you all for your comments!</p>\n"}], "owner": {"reputation": 23, "user_id": 5069079, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lu8Ipex_B1Y/AAAAAAAAAAI/AAAAAAAAA50/OuIbQXsDlD0/photo.jpg?sz=128", "display_name": "Dorota Bab\u015b", "link": "https://stackoverflow.com/users/5069079/dorota-bab%c5%9b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 31159156, "answer_count": 4, "score": 1, "last_activity_date": 1485728053, "creation_date": 1435746017, "last_edit_date": 1485728053, "question_id": 31158625, "link": "https://stackoverflow.com/questions/31158625/return-something-when-value-is-at-least-found-once-in-column-b-for-item-in-colum", "title": "Return something when value is at least found once in column B for item in column A", "body": "<p>I'm looking for ab Excel formula solving the below:</p>\n\n<p>I have list of account numbers in column A and in column B a list of charge methods associated to each account. One account can have a few charge methods associated - for example:</p>\n\n<pre><code>Account no  Charge method\nA1  IC1\nA1  IC2\nA1  Exempt\nA2  IC1\nA2  IC2\nA3  IC1\nA3  IC2\nA3  IC3\nA3  Exempt\nA4  IC1\nA4  IC2\nA4  Exampt\n</code></pre>\n\n<p>I would like to specify which account have at least one charge method \"Exempt\". So for example: in column C value \"Exempt\" if if for A1 account \"Exempt\" is mentioned at least once in column B. I tried to use vlookup TRUE, but I'm not sure if it will be always accurate.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1435752689, "post_id": 31158270, "comment_id": 50330396, "body": "<code>Private Sub listBoxB1_Click()</code> or <code>Private Sub listBoxB1_Change()</code>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1435757258, "post_id": 31158270, "comment_id": 50333849, "body": "@Raystafarian That sort of thing won&#39;t work for controls that are created dynamically."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435757523, "post_id": 31158270, "comment_id": 50334064, "body": "@john I guess it depends on how &quot;dynamic&quot; they are.. If they are created on the fly, they could be in sequence, or specifically named, or whatever. Sure the events won&#39;t be created dynamically, but they should still work."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1435757836, "post_id": 31158270, "comment_id": 50334334, "body": "@Raystafarian Try it. If the control doesn&#39;t exist at design time then the event handler won&#39;t fire even if you define it as name_click() where name is the name you assign to the control when you add it."}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1435758048, "last_edit_date": 1495539837, "creation_date": 1435758048, "answer_id": 31163066, "question_id": 31158270, "link": "https://stackoverflow.com/questions/31158270/combobox-event-listener/31163066#31163066", "title": "Combobox event listener", "body": "<p>It really is somewhat involved. This question discusses it: <a href=\"https://stackoverflow.com/q/566770/4996248\">Assign on-click VBA function to a dynamically created button on Excel Userform</a> . The accepted answer contains a trick that I have used many, many times. Create all the controls you will ever need ahead of time (there is only a finite amount of real estate on a form so in practice this will be a reasonably small number) and make them visible (or hide them) dynamically as you need them by controlling the .visible property. It is even possible to have 1 control sit on top of another in the design view with only 1 visible at run time. The visible one at run time will receive the events. </p>\n"}], "owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 422, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435758048, "creation_date": 1435744923, "last_edit_date": 1495535207, "question_id": 31158270, "link": "https://stackoverflow.com/questions/31158270/combobox-event-listener", "title": "Combobox event listener", "body": "<p>I'm trying to use the solution given to this issue : <a href=\"https://stackoverflow.com/questions/21738405/programmatically-create-event-listener-in-vba\">Programmatically create event listener in VBA</a> in my particular case : </p>\n\n<p>I programmatically create comboboxes. What I would like to do is to programmatically create a single textbox with a precise label or several texboxes with as many labels next to the generated comboboxes depending on their values.</p>\n\n<p>Here is the code I use to programmatically create those comboboxes :</p>\n\n<p>Set listBoxB1 = Frame1.Controls.Add(\"Forms.ComboBox.1\")</p>\n\n<pre><code>With listBoxB1\n       .Name = \"list\" &amp; i\n       .Height = 15\n       .Width = 100\n       .Left = 70\n       .Top = 10 * i * 3\n       .AddItem \"NUM\"\n       .AddItem \"LIST\"\nEnd With\n</code></pre>\n\n<p>So I want that when the user choses the value LIST, a single textbox is displayed next to the combobox with a label and when he or she uses the value NUM, 6 textboxes are created next to the combobox and aligned with it horizontally.</p>\n\n<p>I actually want that the display changes automatically when the user changes the value of the combobox, it would be helpful if you can give some indications about that.</p>\n\n<p>Can you please tell me how I can adapt the solution in the link above to my case, because I'm very new to VBA and don't exactly know how to do that, I have tried to implement the code given but failed.</p>\n"}, {"tags": ["excel", "vba", "autofilter"], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 1, "last_activity_date": 1435762812, "last_edit_date": 1435762812, "creation_date": 1435750075, "answer_id": 31160017, "question_id": 31157764, "link": "https://stackoverflow.com/questions/31157764/adding-autofilter-criteria-one-by-one/31160017#31160017", "title": "Adding AutoFilter Criteria one by one", "body": "<p>There isn't, that I know of, a way of \"adding on\" criteria to a filter which has previously been applied.</p>\n\n<p>I have produced a work-around, which would work for what you are attempting to do. You will just have to add on scenarios to the select case statement, going up to the maximum number of filters which you will want to have.</p>\n\n<p>EDIT: what it does; copy the filtered column to a new worksheet, and remove duplicates on that column. You're then left with the values which have been used to filter the column. Assign the values to an array, and then apply the number of elements of the array as a filter on the column, whilst including the new value you wish to filter on.\nEDIT 2: added in a function to find the last row for when a table is already filtered (we want the last row, not the last visible row).</p>\n\n<pre><code>Option Explicit\nSub add_filter()\n    Dim wb As Workbook, ws As Worksheet, new_ws As Worksheet\n    Dim arrCriteria() As Variant, strCriteria As String\n    Dim num_elements As Integer\n    Dim lrow As Long, new_lrow As Long\n    Set wb = ThisWorkbook\n    Set ws = wb.Sheets(\"data\")\n\n    Application.ScreenUpdating = False\n    lrow = ws.Cells(Rows.Count, 1).End(xlUp).Row\n    ws.Range(\"A1:A\" &amp; lrow).Copy 'Copy column which you intend to add a filter to\n    Sheets.Add().Name = \"filter_data\"\n    Set new_ws = wb.Sheets(\"filter_data\")\n\n    With new_ws\n        .Range(\"A1\").PasteSpecial xlPasteValues\n        .Range(\"$A$1:$A$\" &amp; Cells(Rows.Count, 1).End(xlUp).Row).RemoveDuplicates _\n        Columns:=1, Header:=xlYes   'Shows what has been added to filter\n        new_lrow = Cells(Rows.Count, 1).End(xlUp).Row\n        If new_lrow = 2 Then\n            strCriteria = .Range(\"A2\").Value 'If only 1 element then assign to string\n        Else\n            arrCriteria = .Range(\"A2:A\" &amp; Cells(Rows.Count, 1).End(xlUp).Row) 'If more than 1 element make array\n        End If\n        Application.DisplayAlerts = False\n        .Delete\n        Application.DisplayAlerts = True\n    End With\n\n    If new_lrow = 2 Then\n        num_elements = 1\n    Else\n        num_elements = UBound(arrCriteria, 1) 'Establish number elements in array\n    End If\n\n    lrow = last_row\n    Select Case num_elements\n        Case 1\n            ws.Range(\"$A$1:$A$\" &amp; lrow).AutoFilter 1, _\n            Array(strCriteria, \"New Filter Value\"), Operator:=xlFilterValues\n        Case 2\n            ws.Range(\"$A$1:$A$\" &amp; lrow).AutoFilter 1, _\n            Array(arrCriteria(1, 1), arrCriteria(2, 1), _\n            \"New Filter Value\"), Operator:=xlFilterValues\n        Case 3\n            ws.Range(\"$A$1:$A$\" &amp; lrow).AutoFilter 1, _\n            Array(arrCriteria(1, 1), arrCriteria(2, 1), _\n            arrCriteria(3, 1), \"New Filter Value\"), Operator:=xlFilterValues\n    End Select\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Function:</p>\n\n<pre><code>Function last_row() As Long\n    Dim rCol As Range\n    Dim lRow As Long\n\n    Set rCol = Intersect(ActiveSheet.UsedRange, Columns(\"A\"))\n    lRow = rCol.Row + rCol.Rows.Count - 1\n    Do While Len(Range(\"A\" &amp; lRow).Value) = 0\n        lRow = lRow - 1\n    Loop\n    last_row = lRow\nEnd Function\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 51, "user_id": 5068930, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kqi1qGzTIc8/AAAAAAAAAAI/AAAAAAAAAGA/QBH0P-7qFn0/photo.jpg?sz=128", "display_name": "Matteo Ramin", "link": "https://stackoverflow.com/users/5068930/matteo-ramin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1435762812, "creation_date": 1435743562, "question_id": 31157764, "link": "https://stackoverflow.com/questions/31157764/adding-autofilter-criteria-one-by-one", "title": "Adding AutoFilter Criteria one by one", "body": "<p>I would like to add AutoFilter Criteria to my excel table in separate Subs.</p>\n\n<p>What I have at the moment looks a little something like this</p>\n\n<pre><code>.AutoFilter Field:=deviceTypeColumnId, Criteria1:=[dScenarioIndependent], Operator:=xlOr, _\n                                       Criteria2:=[dSmartphoneDeviceType]\n</code></pre>\n\n<p>What I would like to have is a method to first filter by Criteria1, and then, in another Sub, add Criteria2 to the existing AutoFilter. To my mind, it should look something like this:</p>\n\n<pre><code>Sub firstSub\n    .AutoFilter Field:=deviceTypeColumnId, Criteria1:=[dScenarioIndependent]\nend sub\nSub secondSub\n    .AutoFilter mode:=xlAddCriteria, Field:=deviceTypeColumnId, Criteria1:=[dSmartphoneDeviceType]        \n    'I know that mode doesn't exist, but is there anything like that?\nend sub\n</code></pre>\n\n<p>Do you know any way to achieve this?</p>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5068892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f6912dc3d4f532712b3fa3020161554?s=128&d=identicon&r=PG&f=1", "display_name": "alex arr", "link": "https://stackoverflow.com/users/5068892/alex-arr"}, "edited": false, "score": 0, "creation_date": 1435743588, "post_id": 31157659, "comment_id": 50324273, "body": "Thank you very much! Tried WorkSheet.Cells, but it gave a mistake &quot;Select Method or Range Class Failed&quot;, but activation of the worksheet made exactly what I needed! :) Have a great day!"}], "tags": [], "owner": {"reputation": 504, "user_id": 4090638, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/UyFjM.png?s=128&g=1", "display_name": "Gotrekk", "link": "https://stackoverflow.com/users/4090638/gotrekk"}, "is_accepted": true, "score": 0, "last_activity_date": 1435745574, "last_edit_date": 1435745574, "creation_date": 1435743271, "answer_id": 31157659, "question_id": 31157535, "link": "https://stackoverflow.com/questions/31157535/looping-through-all-active-worksheets/31157659#31157659", "title": "Looping through all active Worksheets", "body": "<p>when using Cells(Rows.Count, 7).End(xlUp).Select and everything else, they refer to the current sheet. So you either put in front of them Worksheet.Cells(Rows.Count, 7).End(xlUp).Select or you activate the sheet first with Worksheet.Activate</p>\n\n<p>or you can just do as follow:</p>\n\n<pre><code>Sub CopyTotalSalesPrice()\n    For Each Worksheet In ActiveWorkbook.Worksheets\n        With Worksheet\n            If .Name &lt;&gt; \"Summary\" Then\n                .Cells(Rows.Count, 7).End(xlUp).Copy Destination:=Worksheets(\"Summary\").Cells(Rows.Count, 6).End(xlUp).Offset(2, 0)\n                .Range(\"D4\").Copy Destination:=Worksheets(\"Summary\").Cells(Rows.Count, 4).End(xlUp).Offset(2, 0)\n            End If\n        End With\n    Next Worksheet\n    Worksheets(\"Summary\").Select\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5068892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f6912dc3d4f532712b3fa3020161554?s=128&d=identicon&r=PG&f=1", "display_name": "alex arr", "link": "https://stackoverflow.com/users/5068892/alex-arr"}, "edited": false, "score": 0, "creation_date": 1435744094, "post_id": 31157704, "comment_id": 50324577, "body": "Thank you for your response. As Gotrekk suggested this above, I decided to simply copy your code, but I still get &quot;Select Method or Range Class Failed&quot;. Do you have any idea why this problem might appear? Since both of you suggested this option, it is definitely something wrong on my side?!"}, {"owner": {"reputation": 504, "user_id": 4090638, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/UyFjM.png?s=128&g=1", "display_name": "Gotrekk", "link": "https://stackoverflow.com/users/4090638/gotrekk"}, "edited": false, "score": 0, "creation_date": 1435744298, "post_id": 31157704, "comment_id": 50324701, "body": "edit your question with the new code... we will have a look"}, {"owner": {"reputation": 13, "user_id": 5068892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f6912dc3d4f532712b3fa3020161554?s=128&d=identicon&r=PG&f=1", "display_name": "alex arr", "link": "https://stackoverflow.com/users/5068892/alex-arr"}, "edited": false, "score": 0, "creation_date": 1435744989, "post_id": 31157704, "comment_id": 50325156, "body": "changed it to Worksheet.Cells solution."}, {"owner": {"reputation": 504, "user_id": 4090638, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/UyFjM.png?s=128&g=1", "display_name": "Gotrekk", "link": "https://stackoverflow.com/users/4090638/gotrekk"}, "edited": false, "score": 0, "creation_date": 1435745205, "post_id": 31157704, "comment_id": 50325288, "body": "you still need to Worksheet.Activate or Worksheet.Select before the Worksheet.Cells(Worksheet.Rows.Count, 7).End(xlUp).Select"}, {"owner": {"reputation": 504, "user_id": 4090638, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/UyFjM.png?s=128&g=1", "display_name": "Gotrekk", "link": "https://stackoverflow.com/users/4090638/gotrekk"}, "edited": false, "score": 0, "creation_date": 1435745779, "post_id": 31157704, "comment_id": 50325625, "body": "i changed my answer with another option to do the same thing"}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1435745095, "last_edit_date": 1435745095, "creation_date": 1435743402, "answer_id": 31157704, "question_id": 31157535, "link": "https://stackoverflow.com/questions/31157535/looping-through-all-active-worksheets/31157704#31157704", "title": "Looping through all active Worksheets", "body": "<p>Try this:</p>\n\n<pre><code>Sub CopyTotalSalesPrice()\n\nFor Each Worksheet In ActiveWorkbook.Worksheets\n    If Worksheet.Name &lt;&gt; \"Summary\" Then\n      Worksheet.Select\n      Worksheet.Cells(Worksheet.Rows.Count, 7).End(xlUp).Select\n    End If\n    If Selection.Value &gt; \"0\" Then\n      Selection.Copy\n      Worksheets(\"Summary\").Cells(Worksheet.Rows.Count, 6).End(xlUp).Offset(2, 0).PasteSpecial (xlPasteValues)\n\n      Range(\"D4\").Select\n      Selection.Copy\n      Worksheets(\"Summary\").Cells(Worksheet.Rows.Count, 4).End(xlUp).Offset(2, 0).PasteSpecial (xlPasteValues)\n\n    End If\n\nNext Worksheet\n\nWorksheets(\"Summary\").Select\nEnd Sub\n</code></pre>\n\n<p>I replaced this <code>Cells(Rows.Count, 7).End(xlUp).Select</code> with <code>Worksheet.Cells(Worksheet.Rows.Count, 7).End(xlUp).Select</code></p>\n"}], "owner": {"reputation": 13, "user_id": 5068892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f6912dc3d4f532712b3fa3020161554?s=128&d=identicon&r=PG&f=1", "display_name": "alex arr", "link": "https://stackoverflow.com/users/5068892/alex-arr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 31157659, "answer_count": 2, "score": 1, "last_activity_date": 1435745574, "creation_date": 1435742910, "last_edit_date": 1435744622, "question_id": 31157535, "link": "https://stackoverflow.com/questions/31157535/looping-through-all-active-worksheets", "title": "Looping through all active Worksheets", "body": "<p>I have a really weak experience working with VBA, but now faced an issue where it is really required. </p>\n\n<p>I need to copy cell's value from multiple worksheets (besides \"Summary\") into one worksheet, but facing a problem. When running a macro, I get around 30 lines with the values I need, but all 30 values belong to the same worksheet. Seems like the loop is running only around 1 worksheet. Could you help me finding the mistake in the code?</p>\n\n<pre><code>Sub CopyTotalSalesPrice()\n\nFor Each Worksheet In ActiveWorkbook.Worksheets\nIf Worksheet.Name &lt;&gt; \"Summary\" Then\n\nWorksheet.Cells(Rows.Count, 7).End(xlUp).Select\nEnd If\n    If Selection.Value &gt; \"0\" Then\n       Selection.Copy\n       Worksheets(\"Summary\").Cells(Rows.Count, 6).End(xlUp).Offset(2, 0).PasteSpecial (xlPasteValues)\n\n       Range(\"D4\").Select\n       Selection.Copy\n       Worksheets(\"Summary\").Cells(Rows.Count, 4).End(xlUp).Offset(2, 0).PasteSpecial (xlPasteValues)\n\n    End If\n\nNext Worksheet\n\nWorksheets(\"Summary\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435746291, "post_id": 31157420, "comment_id": 50325958, "body": "Why are you repopulating an entire column of formulas inside your loop?"}, {"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435763387, "post_id": 31157420, "comment_id": 50338545, "body": "I need to repopulate the entire column using vlookup formula but I must first determine specific values before inserting the formula on the entire row."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435764163, "post_id": 31157420, "comment_id": 50339105, "body": "But you&#39;re putting the <b>same</b> formula into the <b>same</b> cells repeatedly. That doesn&#39;t make any sense to me."}, {"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435764598, "post_id": 31157420, "comment_id": 50339427, "body": "Yes, the formula is intended to the entire column but not for some cells which has a value &quot;611&quot; or &quot;Initial&quot; If the cell has a value of &quot;Initial&quot; then the formula won&#39;t be applied to it."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1435765013, "post_id": 31157420, "comment_id": 50339711, "body": "No, that&#39;s not what your code does. It puts the same formula into all the same cells each time. I think you should be using: <code>ws1.Range(&quot;Y&quot; &amp; i).Formula</code>"}, {"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435795715, "post_id": 31157420, "comment_id": 50354917, "body": "Ok I&#39;ll try that. But my code gives the correct data. But I would still try your idea. Thanks. :)"}, {"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435796395, "post_id": 31157420, "comment_id": 50355051, "body": "Thanks for your suggestion Rory, It also works. :)"}], "answers": [{"comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 1, "creation_date": 1435824065, "post_id": 31158559, "comment_id": 50363736, "body": "These are certainly good options for speeding up macros in general, but this doesn&#39;t specifically address the performance issue with this question."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 1, "creation_date": 1435824111, "post_id": 31158559, "comment_id": 50363758, "body": "It&#39;s also a good idea to capture the current value of <code>Application.Calculation</code> at the start of the code and restore it at the end."}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1435824499, "post_id": 31158559, "comment_id": 50363994, "body": "@Enigmativity I agree, but sometimes just stopping Excel from doing unnecessary things will be enough."}], "tags": [], "owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "is_accepted": false, "score": 0, "last_activity_date": 1435745835, "creation_date": 1435745835, "answer_id": 31158559, "question_id": 31157420, "link": "https://stackoverflow.com/questions/31157420/another-way-instead-of-do-until-loop-to-make-code-execute-faster/31158559#31158559", "title": "Another way instead of do-until loop to make code execute faster", "body": "<p>One way to speed things up is to tell Excel not to bother with updating the screen or calculating cells. Turn these off before the loop and turn them on after:</p>\n\n<pre><code>'***** Before loop\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\n'***** After loop\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 1, "creation_date": 1435787162, "post_id": 31158777, "comment_id": 50352213, "body": "Wouldn&#39;t it be better to use <code>MATCH</code> instead of <code>COUNTIF</code>? The latter will presumably need to &quot;look at&quot; all the cells in the range but I imagine the <code>MATCH</code> function quits once it has found a matching entry."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1435839076, "post_id": 31158777, "comment_id": 50373763, "body": "@ChipsLetten: interesting idea, worth to be validated with a large dataset."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1435746464, "creation_date": 1435746464, "answer_id": 31158777, "question_id": 31157420, "link": "https://stackoverflow.com/questions/31157420/another-way-instead-of-do-until-loop-to-make-code-execute-faster/31158777#31158777", "title": "Another way instead of do-until loop to make code execute faster", "body": "<p>Try using the references you already set. E.g: instead of   </p>\n\n<pre><code>Do Until Sheets(\"Source\").Cells(i, 1) = \"\"\nx = Left(Sheets(\"Source\").Cells(i, 6), 3)\ny = Left(Sheets(\"Source\").Cells(i, 23), 7)\n</code></pre>\n\n<p>use</p>\n\n<pre><code>Do Until Sheets(\"Source\").Cells(i, 1) = \"\"\n   x = Left(ws1.Cells(i, 6), 3)\n   y = Left(ws1.Cells(i, 23), 7)\n</code></pre>\n\n<p>I would also try to avoid <code>VLOOKUP</code>, which is very slow. If all you need is to check for the existence a a value in a range, <code>COUNTIF</code> is much faster.</p>\n"}, {"comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 2, "creation_date": 1435800607, "post_id": 31161254, "comment_id": 50355979, "body": "While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes."}, {"owner": {"reputation": 91, "user_id": 5055685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50865ffef0a83428b4f1816fe6ac2c26?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5055685/marco"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1435823843, "post_id": 31161254, "comment_id": 50363594, "body": "@Bond your are right. I now added some code example."}], "tags": [], "owner": {"reputation": 91, "user_id": 5055685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50865ffef0a83428b4f1816fe6ac2c26?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/5055685/marco"}, "is_accepted": true, "score": 2, "last_activity_date": 1435823764, "last_edit_date": 1525816098, "creation_date": 1435753510, "answer_id": 31161254, "question_id": 31157420, "link": "https://stackoverflow.com/questions/31157420/another-way-instead-of-do-until-loop-to-make-code-execute-faster/31161254#31161254", "title": "Another way instead of do-until loop to make code execute faster", "body": "<p>There are many possible way how to improve the performance of Excel's VBA code. At best you read some articles about that:</p>\n\n<ul>\n<li><a href=\"https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/\" rel=\"nofollow noreferrer\">Excel VBA performance coding best practices</a></li>\n<li><a href=\"http://www.cpearson.com/excel/optimize.htm\" rel=\"nofollow noreferrer\">Optimizing VBA</a></li>\n</ul>\n\n<hr>\n\n<p>Edit:\nAs suggested by <em>Bond</em> I here is what I do in my VBA code to improve the execution performance:</p>\n\n<pre><code>Option Explicit\n\nDim screenUpdating As Boolean\nDim calculation As XlCalculation\nDim enableEvents As Boolean\nDim displayPageBreaks As Boolean\n\n\n\n' Freezes Excel into its current state to improve\n' performance during executing macro code. Be sure\n' to call DoEvents occasionally during execution to\n' prevent completly freezing the Excel window.\n' Call this routine before all other code but after\n' setting up proper exception handling.\nPublic Sub freezeSystem()\n    'Save Excel configuration to reset later\n    screenUpdating = Application.screenUpdating\n    calculation = Application.calculation\n    enableEvents = Application.enableEvents\n    displayPageBreaks = ActiveSheet.displayPageBreaks\n\n    'Turn off some Excel functionality so your code runs faster\n    Application.screenUpdating = False\n    Application.calculation = xlCalculationManual\n    Application.enableEvents = False\n    ActiveSheet.displayPageBreaks = False 'Note this is a sheet-level setting, but only necessary for ActiveSheet if code do not change the ActiveSheet\nEnd Sub\n\n\n\n\n' Unfreezes Excel and resets it into the configuration it had\n' before the freezeSystem() was executed.\n' Call this routine at the end of the macro code and also during\n' the cleanup of exception handling.\nPublic Sub defreezeSystem()\n    ' Reset Excel configuration into previous state\n    Application.screenUpdating = screenUpdating\n    Application.calculation = calculation\n    Application.enableEvents = enableEvents\n    ActiveSheet.displayPageBreaks = displayPageBreaks 'Note this is a sheet-level setting, but only necessary for ActiveSheet if code do not change the ActiveSheet\n\n    ' Perform recalculation of all formulas\n    Application.CalculateFullRebuild\nEnd Sub\n\n\n\n\n' This routine is intended to update the Excel window\n' while executing macro code in controlled manner if\n' necessary. Be aware that calling this function too\n' often will drastically reduce the execution performance.\nPublic Sub updateSystem()\n    If Application.screenUpdating = False Then\n        Application.screenUpdating = True\n        Application.CalculateFullRebuild\n        Application.screenUpdating = False\n    Else\n        Application.CalculateFullRebuild\n    End If\nEnd Sub\n</code></pre>\n\n<p>Call <code>freezeSystem()</code> at the beginning or your code to improve the performance during execution. Call <code>defreezeSystem()</code>at the end of your code and while cleaning up during exception handling if necessary.</p>\n\n<p>I do it in this way:</p>\n\n<pre><code>Sub entryPoint()\n    On Error GoTo entryPointErrorHandler    ' set up exception handling\n    freezeSystem\n    [your regular code goes here]\n\nentryPointCleanUp:                          ' clean up from exception and normal operation\n    [your cleanup code goes here]\n    defreezeSystem\n    Exit Sub\n\nentryPointErrorHandler:                     ' exception handling\n    [your exception handling code goes here]\n    GoTo entryPointCleanUp                  ' jump to clean up code\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 856, "favorite_count": 1, "accepted_answer_id": 31161254, "answer_count": 3, "score": 2, "last_activity_date": 1435823764, "creation_date": 1435742662, "last_edit_date": 1435815129, "question_id": 31157420, "link": "https://stackoverflow.com/questions/31157420/another-way-instead-of-do-until-loop-to-make-code-execute-faster", "title": "Another way instead of do-until loop to make code execute faster", "body": "<p>I need help on how to make my code execute faster. I have a very large volume of data and my '<code>Do Until loop</code>' causes the slow execution. I wonder if there's a way to make my code run faster. I only used do until loop because I'm comfortable with it. Thanks</p>\n\n<pre><code>Dim WB1 As Workbook\nDim ws1 As Worksheet\nDim last As Long\nDim i As Integer\nDim x As String, y As String\n\nSet WB1 = ThisWorkbook\nSet ws1 = WB1.Worksheets(\"Source\")\n\nlast = ws1.Cells(Rows.Count, \"X\").End(xlUp).Row\n\ni = 2\nDo Until Sheets(\"Source\").Cells(i, 1) = \"\"\n    x = Left(Sheets(\"Source\").Cells(i, 6), 3)\n    y = Left(Sheets(\"Source\").Cells(i, 23), 7)\n    If x = \"611\" Or y = \"INITIAL\" Then\n\n        Sheets(\"Source\").Cells(i, 25) = \"INITIAL\"\n\n    Else\n\n        ws1.Range(\"Y2:Y\" &amp; last).Formula = \"=VLOOKUP(A:A,'Assignment Reference'!$C:$E,3,FALSE)\"\n\n    End If\n\n    i = i + 1\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel", "filter", "hidden"], "answers": [{"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 0, "last_activity_date": 1435815243, "last_edit_date": 1435815243, "creation_date": 1435753125, "answer_id": 31161107, "question_id": 31157268, "link": "https://stackoverflow.com/questions/31157268/vba-to-skip-hidden-cells-without-cicle/31161107#31161107", "title": "VBA to skip hidden cells without cicle", "body": "<p>Try this:</p>\n\n<pre><code>Private WithEvents App As Application\n\nPrivate Sub App_SheetselectionChange(ByVal Sh As Object, ByVal Target As Range)\n    Dim vStatus As Variant\n    Dim prod_vett As Variant\n    '----------------------------\n    Dim rng As Excel.Range\n    Dim area As Excel.Range\n    Dim data As Variant\n    Dim row As Long\n    Dim firstCol As Integer\n    Dim lastCol As Integer\n    '----------------------------\n\n    On Error GoTo err_gest_\n\n    Set rng = Target.SpecialCells(xlCellTypeVisible)\n\n    For Each area In rng.Areas\n        data = area\n        firstCol = LBound(data, 2)\n        lastCol = UBound(data, 2)\n\n        For row = LBound(data, 1) To UBound(data, 1)\n            prod_vett = prod_vett + data(row, firstCol) * data(row, lastCol)\n        Next row\n\n    Next area\n\n    vStatus = \"Prodotto vettoriale: \" &amp; prod_vett\n\nerr_gest_:\n      If Err.Number &lt;&gt; 0 Then vStatus = False\n      Application.StatusBar = vStatus\n\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    Application.StatusBar = False\n    Set App = Application\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 5068820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfca0edea2b0b0decf6fbdbda91b2c0f?s=128&d=identicon&r=PG&f=1", "display_name": "Gear83", "link": "https://stackoverflow.com/users/5068820/gear83"}, "is_accepted": false, "score": 0, "last_activity_date": 1435821005, "creation_date": 1435821005, "answer_id": 31177787, "question_id": 31157268, "link": "https://stackoverflow.com/questions/31157268/vba-to-skip-hidden-cells-without-cicle/31177787#31177787", "title": "VBA to skip hidden cells without cicle", "body": "<p>it seems that doesn't work.\nbut when i tried to go step by step i observed that it works but when arrive at \"\nEnd Sub\" line come back to <code>for each area in rng.Areas</code> and the Err.Number became &lt;> 0 and so the vStatus variable beacme false and the statu bar doesn't update. I resolved with this change:</p>\n\n<pre><code>Private Sub App_SheetselectionChange(ByVal Sh As Object, ByVal Target As Range)\n    Dim vStatus As Variant\n    Dim prod_vett As Variant\n    '----------------------------\n    Dim rng As Excel.Range\n    Dim area As Excel.Range\n    Dim data As Variant\n    Dim row As Long\n    Dim firstCol As Integer\n    Dim lastCol As Integer\n    '----------------------------\n\n    On Error GoTo err_gest_\n\n    Set rng = Target.SpecialCells(xlCellTypeVisible)\n\n    For Each area In rng.Areas\n        data = area\n        firstCol = LBound(data, 2)\n        lastCol = UBound(data, 2)\n\n            For row = LBound(data, 1) To UBound(data, 1)\n                prod_vett = prod_vett + data(row, firstCol) * data(row, lastCol)\n            Next row\n\n    Next area\n    If prod_vett &lt;&gt; 0 Then\n        vStatus = \"Prodotto vettoriale: \" &amp; prod_vett\n            Else: vStatus = False\n    End If\n    Application.StatusBar = vStatus\n    Exit Sub\n\nerr_gest_:\nvStatus = False\nApplication.StatusBar = vStatus\nEnd Sub\n</code></pre>\n\n<p>However i can't understand why at End Sub it doesn't exit from macro and start again...</p>\n"}], "owner": {"reputation": 13, "user_id": 5068820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfca0edea2b0b0decf6fbdbda91b2c0f?s=128&d=identicon&r=PG&f=1", "display_name": "Gear83", "link": "https://stackoverflow.com/users/5068820/gear83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1435821005, "creation_date": 1435742264, "last_edit_date": 1435815214, "question_id": 31157268, "link": "https://stackoverflow.com/questions/31157268/vba-to-skip-hidden-cells-without-cicle", "title": "VBA to skip hidden cells without cicle", "body": "<p>I've wrote a macro in an add-in that update the status-bar when you select a range:\nThis macro (included in \"<code>thisWorkbook</code>\" of the add-in with a <code>SheetSelectionChange)</code> write on status-bar the matrix sum product of the first and last column in selection.\nIt works very good but if there's a active filter I'd like it skip the hidden cells.\nthis is the code.</p>\n\n<pre><code>Private WithEvents App As Application\n\nPrivate Sub App_SheetselectionChange(ByVal Sh As Object, ByVal Target As Range)\n    Dim vStatus As Variant\n    Dim nCols As Long\n    Dim prod_vett As Variant\n    On Error GoTo err_gest_\n    With Target\n      nCols = .Columns.Count\n      If nCols &gt; 1 Then\n        prod_vett = Application.Evaluate(\"sum(\" &amp; .Columns(1).Address &amp; \"*\" &amp; .Columns(nCols).Address &amp; \")\")\n        vStatus = \"Prodotto vettoriale: \" &amp; prod_vett\n      End If\n    End With\n    err_gest_:\n      If Err.Number &lt;&gt; 0 Then vStatus = False\n      Application.StatusBar = vStatus\n    End Sub\n\nPrivate Sub Workbook_Open()\n    Application.StatusBar = False\n    Set App = Application   'Instantiate application level events\n\nEnd Sub\n</code></pre>\n\n<p>If I use a cicle there is a problem: if a select all cells in worksheet the macro is too much long to give me a result.\nI try to use </p>\n\n<pre><code>With Target.SpecialCells(xlCellTypeVisible) \n</code></pre>\n\n<p>But it doesn't work.\nHave you got other solution?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 4242750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0f78647b3093dbf3c60a6a77dcb082ee?s=128&d=identicon&r=PG&f=1", "display_name": "user4242750", "link": "https://stackoverflow.com/users/4242750/user4242750"}, "edited": false, "score": 0, "creation_date": 1435743642, "post_id": 31157573, "comment_id": 50324301, "body": "Thanks a lot @Quantum"}], "tags": [], "owner": {"reputation": 994, "user_id": 3512224, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e0819faf0bafba4b48b12c5f13bd103?s=128&d=identicon&r=PG&f=1", "display_name": "quantum285", "link": "https://stackoverflow.com/users/3512224/quantum285"}, "is_accepted": true, "score": 2, "last_activity_date": 1435749522, "last_edit_date": 1435749522, "creation_date": 1435743006, "answer_id": 31157573, "question_id": 31157249, "link": "https://stackoverflow.com/questions/31157249/row-number-reference-with-vba/31157573#31157573", "title": "Row Number reference with VBA", "body": "<p>If I understand you correctly then this should work:</p>\n\n<pre><code>Sub test()\n\n    Dim lastRow As Long, counter As Long\n    Dim cell As Range\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"NAME_OF_YOUR_WORKSHEET\")\n\n    lastRow = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n    counter = 1\n    For Each cell In ws.Range(\"B2:B\" &amp; lastRow)\n        cell.Value = counter\n        counter = counter + 1\n    Next cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1435749849, "creation_date": 1435749849, "answer_id": 31159942, "question_id": 31157249, "link": "https://stackoverflow.com/questions/31157249/row-number-reference-with-vba/31159942#31159942", "title": "Row Number reference with VBA", "body": "<p>No need for a loop:</p>\n\n<pre><code>Sub NumberRows()\n\nWith Sheets(\"Sheet Name Here\")\n    With .Range(\"B2:B\" &amp; .Cells(.Rows.Count, 1).End(xlUp).Row)\n        .Formula = \"=ROW()-1\"\n        .Value = .Value\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 4242750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0f78647b3093dbf3c60a6a77dcb082ee?s=128&d=identicon&r=PG&f=1", "display_name": "user4242750", "link": "https://stackoverflow.com/users/4242750/user4242750"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7424, "favorite_count": 0, "accepted_answer_id": 31157573, "answer_count": 2, "score": 2, "last_activity_date": 1435749849, "creation_date": 1435742185, "question_id": 31157249, "link": "https://stackoverflow.com/questions/31157249/row-number-reference-with-vba", "title": "Row Number reference with VBA", "body": "<p>I have searched a bit for a VBA code that will list me a row reference and am not finding results. Perhaps I am missing what the actual term for it is?</p>\n\n<p>I have a list of names in Column A, starting at A2. Then what I would like is a listing of 1,2,3,4,5 going down Column B, starting from B2, until the names stop. </p>\n\n<p>I can do this as a formula but need to have the values set there by a macro in this case.</p>\n\n<p>Can this be done?</p>\n"}, {"tags": ["vba", "hyperlink", "powerpoint", "ms-word"], "comments": [{"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1435741917, "post_id": 31156449, "comment_id": 50323059, "body": "You need to try to understand a little bit what your code does, because you have a few places where errors can occur and they are hidden by the <code>On Error Resume Next</code> command, which tells Word (or PowerPoint) to ignore any errors and keep going. Try stepping through your code line by line (using F8) to see where the problems are. Another tip: use <code>Option Explicit</code> at the top of your code module to catch any undeclared variables."}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1435745491, "post_id": 31156449, "comment_id": 50325461, "body": "Also, the <code>Replace</code>-line is overly complex, try changing it to: <code>oSh.LinkFormat.SourceFullName = sReplaceWith</code> if you want to change all links."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1435762064, "post_id": 31156449, "comment_id": 50337626, "body": "And to add to Olle&#39;s suggestions, are you certain that Word accepts Dim oSl as Slide and the other PowerPoint-specific Dim types?  It seems unlikely.  Try changing them to eg Dim oSl as PowerPoint.Slide and so on."}, {"owner": {"reputation": 1, "user_id": 5068680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qpn4ZJkmbG8/AAAAAAAAAAI/AAAAAAAABF4/I5KSJE89BZE/photo.jpg?sz=128", "display_name": "OCM", "link": "https://stackoverflow.com/users/5068680/ocm"}, "edited": false, "score": 0, "creation_date": 1435825276, "post_id": 31156449, "comment_id": 50364465, "body": "Thank you both for your input. It helped me find the problems. The problem was with declaration (it needed to be  <code>Dim oHl as PowerPoint.Hyperlink</code> ) . It did not recognized <b>oHl</b> As Hyperlink so it was just skipping the <i>For Each</i> , and because I had the <code>On Error Resume Next</code> it did not show me any error. But I still don&#39;t understand why the <code>oSl As Slide</code> and <code>For Each oSl In PPT.Slides</code> worked fine with the incomplete syntax... Regarding the &#39;Replace&#39; line , I use it because I need to change just the beginning part of some long link , not the whole link."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5068680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qpn4ZJkmbG8/AAAAAAAAAAI/AAAAAAAABF4/I5KSJE89BZE/photo.jpg?sz=128", "display_name": "OCM", "link": "https://stackoverflow.com/users/5068680/ocm"}, "is_accepted": false, "score": 0, "last_activity_date": 1436873123, "creation_date": 1436873123, "answer_id": 31405262, "question_id": 31156449, "link": "https://stackoverflow.com/questions/31156449/modify-hyperlinks-from-different-types-of-files-pptxdocxxlsx-with-vba/31405262#31405262", "title": "Modify hyperlinks from different types of files (pptx;docx;xlsx) with VBA", "body": "<p>I've made some progress. Now the script opens a filedialog window to select the main folder and will open  all word, power point , excel documents from that folder and all subfolders, replace parts of the hyperlinks and check if the new links are working in this documents , making an excel table with the broken links from all the files. </p>\n\n<p>Now there is a problem with power point presentations when I run it on a SharePoint folder (\"<strong><em>Power point could not open the file</em></strong>\"-at this line= <code>If PPT Is Nothing Then Set PPT = PPTapp.Presentations.Open(fileName:=FileLoc, ReadOnly:=msoFalse, WithWindow:=msoFalse)</code> ). All other file types are handled correctly on SharePoint location ,and if I run this on a local folder even the PowerPoint are opened with no problem. \nSo what I am doing wrong with power point files?</p>\n\n<p>Here is the complete code: </p>\n\n<pre><code>'Replace hyperlinks(in word/ppt/excel) in selected folder and all subfolders\nSub HyperReplace()\n\nThisWorkbook.Activate\nCells(1, 1).Select\n\n    With Application.FileDialog(msoFileDialogFolderPicker)\n         .InitialFileName = \"\\\\euro.blablabla.com@SSL\\DavWWWRoot\\BU\\PWS\\home\\ResourceManagement\\Competences\\Site Owners Documents\\test\\\"\n         .AllowMultiSelect = False\n         If .Show &lt;&gt; -1 Then MsgBox \"No folder selected! Exiting script.\": Exit Sub\n         folderpath = .SelectedItems(1)\n         If (Left$(folderpath, 5) = \"https\") Then\n         folderpath = Mid$(folderpath, 7, 32) &amp; \"@SSL/DavWWWRoot\" &amp; Mid$(folderpath, 39, Len(folderpath) - 32)\n         folderpath = Replace(folderpath, \"/\", \"\\\")\n         End If\n    End With\n\nCall GetFilesInFolder(CStr(folderpath), True)\nMsgBox \"operation end, please view\", vbInformation\nEnd Sub\n\nSub GetFilesInFolder(SourceFolderName As String, Subfolders As Boolean)\n\n'--- For Example:Folder Name= \"D:\\Folder Name\\\" and Flag as Yes or No\n\nDim FSO As Scripting.FileSystemObject\nDim SourceFolder As Scripting.Folder, SubFolder As Scripting.Folder\nDim FileItem As Scripting.File\nDim fileName As String\n\n\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set SourceFolder = FSO.GetFolder(SourceFolderName)\n\n    '--- This is for displaying, whereever you want can be configured\n\n\n    For Each FileItem In SourceFolder.Files\n     fileName = FileItem.Path\n             If (Right$(fileName, 4) = \"pptx\" Or Right$(fileName, 3) = \"ppt\") Then\n        pptxHyperLinkReplace (fileName)\n        ElseIf (Right$(fileName, 4) = \"docx\" Or Right$(fileName, 3) = \"doc\") Then\n        ReplaceWordHyperlinks (fileName)\n        ElseIf (Right$(fileName, 4) = \"xlsx\" Or Right$(fileName, 4) = \"xls\") Then\n        ExcelHyperLinkChange (fileName)\n        'Else: MsgBox (\"Noo ,\u00eei bai!\")\n        End If\n\n    Next FileItem\n\n    '--- This is the Function to go each and Every Folder and get the Files. This is a Nested-Function Calling.\n\n    If Subfolders = True Then\n        For Each SubFolder In SourceFolder.Subfolders\n        Call GetFilesInFolder(SubFolder.Path, True)\n        Next SubFolder\n    End If\n\n    Set FileItem = Nothing\n    Set SourceFolder = Nothing\n    Set FSO = Nothing\nEnd Sub\n`\n\nDeclare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\n\nSub MakeExcelBrokenLinksList(Filelocation As String, HLink As String, Optional ByVal NoBrokenLinks As Integer, Optional ByVal NoGoodLinks As Integer, Optional ByVal WLinks As Boolean = False)\n\nThisWorkbook.Activate\n\n            Cells(ActiveCell.Row + 1, 1).Select\n            ActiveCell.Value = Filelocation\n            ActiveCell.Offset(0, 1).Select\n            ActiveCell.Value = HLink\n\nIf WLinks = True Then\n            ActiveCell.EntireRow.Interior.ColorIndex = 8\n            Cells(ActiveCell.Row, 3).Select\n            ActiveCell.Value = NoGoodLinks\n            ActiveCell.Offset(0, 1).Select\n            ActiveCell.Value = NoBrokenLinks\n            Cells(ActiveCell.Row + 1, 1).Select\n            End If\nEnd Sub\n\n'For word\nSub ReplaceWordHyperlinks(FileLoc As String)\n    Dim WordApp As Word.Application\n    Dim Doc As Word.Document\n    Dim HL As Word.Hyperlink\n\n    Dim target As String\n    Dim repl As String\n    Dim DocBrokenLinks As Integer\n\n   ' target = InputBox(\"Find address\", \"Replace Hyperlink\")\n   target = \"http://europortal.blabalabla.com/pws\"\n    If Len(target) = 0 Then Exit Sub\n   ' repl = InputBox(\"Replace address\", \"Replace Hyperlink\")\n   repl = \"https://euro.sp.ema.blabalabla.com/BU/PWS/home\"\n    If Len(repl) = 0 Then Exit Sub\n\n    DocBrokenLinks = 0\n\n    If WordApp Is Nothing Then Set WordApp = New Word.Application\n    If Doc Is Nothing Then Set Doc = Documents.Open(fileName:=FileLoc, Visible:=False)\n    Doc.Activate\n\n\n    For Each HL In Doc.Hyperlinks\n\n     If (Len(HL.Address) &gt; 248) Then\n            Call MakeExcelBrokenLinksList(FileLoc, HL.Address)\n            HL.Address = Left(HL.Address, 248)\n         End If 'make sure that replaced link not exceeding max size of string\n\n        With HL\n            If InStr(LCase(.Address), LCase(target)) _\n            Or InStr(LCase(.TextToDisplay), LCase(target)) Then\n                .Address = Replace(.Address, target, repl)\n                .TextToDisplay = Replace(.TextToDisplay, target, repl)\n                .ScreenTip = Replace(.ScreenTip, target, repl)\n                .Range.Fields.Update\n            End If\n\n        End With\n\n\n        'Test if hyperlink is working\n      If IsURLGood(HL.Address) = False Then\n            Call MakeExcelBrokenLinksList(FileLoc, HL.Address)\n            DocBrokenLinks = DocBrokenLinks + 1\n      End If\n      Sleep (250)\n        'Application.Wait (Now + TimeValue(\"0:00:01\")) 'only on excel\n    Next 'hyperlink\n\n    Call MakeExcelBrokenLinksList(Doc.Name, \"TOTAL Hyperlinks: \", DocBrokenLinks, Doc.Hyperlinks.Count - DocBrokenLinks, True)\n\n    Doc.Save\n    'ActiveWindow.Close\n    Doc.Close\n    Set Doc = Nothing\n    WordApp.Quit\n    Set WordApp = Nothing\n\nEnd Sub\n\n'For power point\n\nSub pptxHyperLinkReplace(FileLoc As String)\n\n    Dim PPTapp As PowerPoint.Application\n    Dim PPT As PowerPoint.Presentation\n    Dim oSl As PowerPoint.Slide\n    Dim oHl As PowerPoint.Hyperlink\n    Dim oSh As PowerPoint.Shape\n    Dim sSearchFor As String\n    Dim sReplaceWith As String\n    Dim PptBrokenLinks As Integer\n    Dim PptLinks As Integer\n\n    sSearchFor = \"http://europortal.ema.blababal.com/pws\"\n    If sSearchFor = \"\" Then\n        Exit Sub\n    End If\n\n    sReplaceWith = \"https://euro.sp.ema.blababal.com/BU/PWS/home\"\n    If sReplaceWith = \"\" Then\n        Exit Sub\n    End If\n    PptBrokenLinks = 0\n\n    If PPTapp Is Nothing Then Set PPTapp = New PowerPoint.Application\n    If PPT Is Nothing Then Set PPT = PPTapp.Presentations.Open(fileName:=FileLoc, ReadOnly:=msoFalse, WithWindow:=msoFalse)\n\n    For Each oSl In PPT.Slides\n        For Each oHl In oSl.Hyperlinks\n\n         If (Len(oHl.Address) &gt; 248) Then\n            Call MakeExcelBrokenLinksList(FileLoc, oHl.Address)\n            oHl.Address = Left(oHl.Address, 248)\n         End If 'replaced link not exceeding max size of string\n\n            oHl.Address = Replace(oHl.Address, sSearchFor, sReplaceWith)\n            oHl.SubAddress = Replace(oHl.SubAddress, sSearchFor, sReplaceWith)\n\n         'Test if hyperlink is working\n            If IsURLGood(oHl.Address) = False Then\n            Call MakeExcelBrokenLinksList(FileLoc, HL.Address)\n            PptBrokenLinks = PptBrokenLinks + 1\n            End If\n            Sleep (250)\n\n        Next    ' hyperlink\n        PptLinks = PptLinks + oSl.Hyperlinks.Count\n\n        ' fix OLE links and movie/sound linkes too\n      '  For Each oSh In oSl.Shapes\n       '    If oSh.Type = msoLinkedOLEObject _\n         '   Or oSh.Type = msoMedia Then\n        '      oSh.LinkFormat.SourceFullName = Replace(oSh.LinkFormat.SourceFullName, sSearchFor, sReplaceWith)\n        '   End If\n      ' Next 'shape\n\n    Next    ' slide\n\n Call MakeExcelBrokenLinksList(PPT.Name, \"TOTAL Hyperlinks: \", PptBrokenLinks, PptLinks - PptBrokenLinks, True)\n\nPPT.Save\nPPT.Close\nSet PPT = Nothing\nPPTapp.Quit\nSet PPTapp = Nothing\n\nEnd Sub\n\n\n'For excel\n\nSub ExcelHyperLinkChange(FileLoc As String)\n    Dim XlSXapp As Excel.Application\n    Dim xlsxBook As Excel.Workbook\n    Dim xlsxSheet As Excel.Worksheet\n    Dim oHl As Excel.Hyperlink\n    Dim sSearchFor As String\n    Dim sReplaceWith As String\n    Dim ExcelBrokenLinks As Integer\n    Dim ExcelLinks As Integer\n\n    sSearchFor = \"http://europortal.ema.blababal.com/pws\"\n    If sSearchFor = \"\" Then\n        Exit Sub\n    End If\n\n    sReplaceWith = \"https://euro.sp.ema.blababal.com/BU/PWS/home\"\n    If sReplaceWith = \"\" Then\n        Exit Sub\n    End If\n\n    ExcelBrokenLinks = 0\n\n    If XlSXapp Is Nothing Then Set XlSXapp = New Excel.Application\n    If xlsxBook Is Nothing Then Set xlsxBook = XlSXapp.Workbooks.Open(fileName:=FileLoc, ReadOnly:=msoFalse)\n\n    For Each xlsxSheet In xlsxBook.Worksheets\n\n        For Each oHl In xlsxSheet.Hyperlinks\n            If (Len(oHl.Address) &gt; 248) Then\n            Call MakeExcelBrokenLinksList(FileLoc, oHl.Address)\n            oHl.Address = Left(oHl.Address, 248)\n            End If 'replaced link not exceeding max size of string\n\n            oHl.Address = Replace(oHl.Address, sSearchFor, sReplaceWith)\n            oHl.TextToDisplay = Replace(oHl.TextToDisplay, sSearchFor, sReplaceWith)\n\n        'Test if hyperlink is working\n            If IsURLGood(oHl.Address) = False Then\n            Call MakeExcelBrokenLinksList(FileLoc, oHl.Address)\n            ExcelBrokenLinks = ExcelBrokenLinks + 1\n            End If 'link is working\n            Sleep (250)\n\n        Next    ' hyperlink\n        ExcelLinks = ExcelLinks + xlsxSheet.Hyperlinks.Count\n\n    Next xlsxSheet   ' sheet\n\nCall MakeExcelBrokenLinksList(xlsxBook.Name, \"TOTAL Hyperlinks: \", ExcelBrokenLinks, ExcelLinks - ExcelBrokenLinks, True)\n\nxlsxBook.Save\nxlsxBook.Close\nSet xlsxBook = Nothing\nXlSXapp.Quit\nSet XlSXapp = Nothing\nEnd Sub\n\n\nPrivate Function IsURLGood(url As String) As Boolean\n    ' Test the URL to see if it is good\n    Dim request As New WinHttpRequest\n\n    On Error GoTo IsURLGoodError\n    If ((Len(url) &gt; 1) And (Left(url, 4) &lt;&gt; \"mail\")) Then\n    request.Open \"GET\", url\n    request.Send\n    If (request.Status = 200 Or request.Status = 401) Then\n      IsURLGood = True\n    Else\n      IsURLGood = False\n    End If\n    Else: IsURLGood = True\n    End If ' link is not empty\n    Exit Function\nIsURLGoodError:\n        IsURLGood = False\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5068680, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qpn4ZJkmbG8/AAAAAAAAAAI/AAAAAAAABF4/I5KSJE89BZE/photo.jpg?sz=128", "display_name": "OCM", "link": "https://stackoverflow.com/users/5068680/ocm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 543, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1436873123, "creation_date": 1435739919, "last_edit_date": 1435755887, "question_id": 31156449, "link": "https://stackoverflow.com/questions/31156449/modify-hyperlinks-from-different-types-of-files-pptxdocxxlsx-with-vba", "title": "Modify hyperlinks from different types of files (pptx;docx;xlsx) with VBA", "body": "<p>I need to modify some hyperlinks from three types of files (word, power point and excel) using VBA. I've found enough examples so I have an almost working script, except the sub that deals with pptx files:</p>\n\n<pre><code>Sub pptxHyperLinkReplace(FileLoc As String) 'For power point\n    Dim PPTapp As PowerPoint.Application\n    Dim oSl As Slide\n    Dim oHl As Hyperlink\n    Dim sSearchFor As String\n    Dim sReplaceWith As String\n    Dim oSh As Shape\n    sSearchFor = \"http://europortal.ema.com/pws\"\n    If sSearchFor = \"\" Then Exit Sub End If\n    sReplaceWith = \"https://euro.sp.ema.com/BU/PWS/home\"\n    If sReplaceWith = \"\" Then Exit Sub End If\n    On Error Resume Next\n    Set PPTapp = CreateObject(\"PowerPoint.Application\")\n    Set PPT = PPTapp.Presentations.Open(FileName:=FileLoc, _\n        ReadOnly:=msoFalse, WithWindow:=msoTrue)\n    PPT.Activate\n    For Each oSl In PPT.Slides\n        MsgBox (oSl.Hyperlinks.Count)\n        For Each oHl In oSl.Hyperlinks\n            oHl.Address = Replace(oHl.Address, sSearchFor, sReplaceWith)\n            oHl.SubAddress = Replace(oHl.SubAddress, sSearchFor, sReplaceWith)\n        Next    ' hyperlink\n        ' fix OLE links and movie/sound linkes too\n        For Each oSh In oSl.Shapes\n            If oSh.Type = msoLinkedOLEObject Or oSh.Type = msoMedia Then\n                oSh.LinkFormat.SourceFullName = Replace(oSh.LinkFormat.SourceFullName, _\n                sSearchFor, sReplaceWith)\n            End If\n        Next 'shape\n    Next    ' slide\n    PPT.Save\n    PPT.Close\n    'Set PPT = Nothing\n    PPTapp.Quit\n    Set PPTapp = Nothing\nEnd Sub\n</code></pre>\n\n<p>Everything works until this part: <code>For Each oHl In oSl.Hyperlinks</code>\nThe message box  <code>MsgBox (oSl.Hyperlinks.Count)</code> shows me the correct number of hyperlinks from each slide but it seems like oHl object remains empty, like the <em>For Each</em> is not working. I run this sub from a script in a word file (docm). If  I try the original script directly in the pptx file that I want to modify the hyperlinks it works with the exact same syntax.</p>\n\n<p>So what I am doing wrong?</p>\n"}, {"tags": ["excel", "data-extraction", "vba"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 5049860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d7ef4bdf9ca1bebc6fda6bdf9bcbe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/5049860/mario-garcia"}, "edited": false, "score": 0, "creation_date": 1435752339, "post_id": 31158830, "comment_id": 50330148, "body": "The short answer to your question is that this is an experimental Univeristy project. We&#39;re supposed to make a file impossible to be manually accessed, specially whatever VBA codes are in it. So I thought that aside from standard encryption and protection of the VBA code, making it Self-Destructible would be as good as it got. Also, would you happen to know how to make it read the &quot;txt&quot; file?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 151, "user_id": 5049860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d7ef4bdf9ca1bebc6fda6bdf9bcbe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/5049860/mario-garcia"}, "edited": false, "score": 0, "creation_date": 1435752534, "post_id": 31158830, "comment_id": 50330285, "body": "To read an external txt file you might want to look at the following solution here on SO: <a href=\"http://stackoverflow.com/questions/31140659/vba-excel-macro-to-update-list-via-external-file/31141373#31141373\" title=\"vba excel macro to update list via external file\">stackoverflow.com/questions/31140659/&hellip;</a>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 151, "user_id": 5049860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d7ef4bdf9ca1bebc6fda6bdf9bcbe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/5049860/mario-garcia"}, "edited": false, "score": 0, "creation_date": 1435752789, "post_id": 31158830, "comment_id": 50330473, "body": "Note that any security you choose is only as good as the software enforcing it. If you open the .xls file with Microsoft Excel, the all security mechanisms will be enforced as intended. But there are many other programs out there which do not do that. To access the VBA code simply open an .xls file using OpenOffice or LibreOffice or something similar (where no protection is enforced on VBA)."}, {"owner": {"reputation": 151, "user_id": 5049860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d7ef4bdf9ca1bebc6fda6bdf9bcbe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/5049860/mario-garcia"}, "edited": false, "score": 0, "creation_date": 1435752841, "post_id": 31158830, "comment_id": 50330503, "body": "Thanks, also, the &quot;Turn excel into .xslx&quot; idea was already implemented into the code. I&#39;ll try to see what I can find and I&#39;ll post the results."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 2, "last_activity_date": 1435746627, "last_edit_date": 1495542106, "creation_date": 1435746627, "answer_id": 31158830, "question_id": 31156268, "link": "https://stackoverflow.com/questions/31156268/extract-data-from-text-and-selfdestruct/31158830#31158830", "title": "Extract data from text and selfdestruct", "body": "<p>Having a self-destructing file is an interesting idea.  The short answer is that you cannot delete a running VBA macro. Therefore, no VBA macro can essentially self destruct. Yet, there are two options I can think of:</p>\n\n<p>(1) Remove everything but the running macro. The following code might be helpful to achieve that.\n<a href=\"http://www.erlandsendata.no/english/index.php?d=envbavbedeleteallmacros\" rel=\"nofollow noreferrer\">http://www.erlandsendata.no/english/index.php?d=envbavbedeleteallmacros</a></p>\n\n<p>(2) Close the file and ask Windows to delete the file afterwards for you using the task planner. The following post on SO might be able to help with that.\n<a href=\"https://stackoverflow.com/questions/24129613/using-excel-vba-macro-to-be-run-through-windows-schedule-task\">Using Excel vba Macro to be run through Windows Schedule Task</a></p>\n\n<p>Other tempting solutions might be to save the file as .xlsx or to create a new Excel file, copy the above code from option 1 into that file, call the newly created code, which essentially deletes the original file. </p>\n\n<p>But the real questions I'd ask myself would be: How did this person got the self-destructing file? Was it by email and the file is still in the email? Has the file been duplicated along the way? Are there hidden copies in some Temp-Folders (remember Excel Auto-Safe every xx minutes in case of computer crash to preserve your work)? Is the person enabling macros when opening the file (to allow self-destruction)? Can the person resore the file with the many free programs out there to recover files from a Windows machine (extremely easy as Windows does not delete the file or writes cryptical data on top to ensure it cannot be recovered, but merely \"marks\" that space on the HD where the file was as free to use for the next file to come)?</p>\n"}], "owner": {"reputation": 151, "user_id": 5049860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9d7ef4bdf9ca1bebc6fda6bdf9bcbe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Garcia", "link": "https://stackoverflow.com/users/5049860/mario-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 31158830, "answer_count": 1, "score": 1, "last_activity_date": 1435747386, "creation_date": 1435739402, "last_edit_date": 1531164843, "question_id": 31156268, "link": "https://stackoverflow.com/questions/31156268/extract-data-from-text-and-selfdestruct", "title": "Extract data from text and selfdestruct", "body": "<p>I'm currently working at a Uni project using Excel VBA and I'm trying to find a way to create an excel that will self destruct if it doesn't find the \"Key\". And in the event it's entirely impossible, then at least ensure there's none of the data or VBA code left.</p>\n\n<p>The idea is that, using</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim direct As String, name As String\n    name = ActiveWorkbook.Name\n    ChDir ThisWorkbook.Path\n    direct = ThisWorkbook.Path\n    Call Checker(direct, name) \nEnd Sub\n</code></pre>\n\n<p>Upon opening the excel, it will look for \"Key.txt\" which should be within the same folder as the excel and check if the one string of text inside the document matches with \"Code\" which is a \"Public Const\" inside the project.</p>\n\n<p>I've been trying to find a way to read the \"Key.txt\" without opening it, but haven't turned up anything.</p>\n\n<p>On the other hand, I've been testing out various ways of making the program delete the original excel file, varying levels of success. So a somewhat roundabout way I've been testing out is to have the excel SaveAs a \".xlsx\" and erase the original file before closing itself, but it doesn't work out as I've hoped for.</p>\n\n<p>This is the code I've used for the \"Self-Destruct\" method:</p>\n\n<pre><code>Option Explicit\nFunction Checker(MyPath As String, name As String)\n\n    On Error Resume Next\n    Application.DisplayAlerts = False\n    Dim myPath2 As String\n    Dim ws As Worksheet\n    Dim FSO As Object\n\n    myPath2 = MyPath\n\n    ActiveWorkbook.SaveAs Filename:=MyPath &amp; \"\\0_0.xlsx\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n    Sheets.Add After:=Sheets(Sheets.Count)\n    ActiveSheet.Name = \"1\"\n    For Each ws In Worksheets  'Deletes all other sheets\n        If ws.Name &lt;&gt; \"1\" Then ws.Delete\n    Next\n\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n    If Right(MyPath, 1) = \"\\\" Then MyPath = Left(MyPath, Len(MyPath) - 1)\n    If FSO.FolderExists(MyPath) = False Then MsgBox MyPath &amp; \" doesn't exist\"\n\n    FSO.deletefile MyPath &amp; \"\\\" &amp; name, True  'Deletes original file\n\n    ActiveWorkbook.Save\n    ActiveWorkbook.Close\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435738981, "post_id": 31156008, "comment_id": 50321102, "body": "Do you have a class called <code>CControlEvents</code> in your workbook? I suspect not..."}, {"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435739222, "post_id": 31156008, "comment_id": 50321273, "body": "I did a mistake in my post, please look at my last edit"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1435740450, "creation_date": 1435740450, "answer_id": 31156641, "question_id": 31156008, "link": "https://stackoverflow.com/questions/31156008/user-defined-type-not-defined-withevents-msforms-combobox/31156641#31156641", "title": "user-defined type not defined &quot;WithEvents MSForms.ComboBox&quot;", "body": "<p>You need to set a reference to the Microsoft Forms 2.0 object library. Inserting a userform (you can then delete it) is usually the quickest way.</p>\n"}], "owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1238, "favorite_count": 0, "accepted_answer_id": 31156641, "answer_count": 1, "score": 0, "last_activity_date": 1435740450, "creation_date": 1435738557, "last_edit_date": 1435739199, "question_id": 31156008, "link": "https://stackoverflow.com/questions/31156008/user-defined-type-not-defined-withevents-msforms-combobox", "title": "user-defined type not defined &quot;WithEvents MSForms.ComboBox&quot;", "body": "<p>I'm trying to declare a variable with this line : <code>\"Private WithEvents mclsCbx As MSForms.ComboBox\"</code> and I get this error : \n\"user-defined type not defined\". How can I solve this problem ?</p>\n"}, {"tags": ["vba", "excel", "random"], "comments": [{"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1435739302, "post_id": 31155622, "comment_id": 50321321, "body": "Please post an image of what you have and what you want to have"}, {"owner": {"reputation": 85, "user_id": 3514907, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/06a83d599c8f8fa5dc234a2a4e3a1888?s=128&d=identicon&r=PG&f=1", "display_name": "user3514907", "link": "https://stackoverflow.com/users/3514907/user3514907"}, "edited": false, "score": 0, "creation_date": 1435740290, "post_id": 31155622, "comment_id": 50321967, "body": "So far I have only tried using formulas but that repeats entries"}, {"owner": {"reputation": 994, "user_id": 3512224, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e0819faf0bafba4b48b12c5f13bd103?s=128&d=identicon&r=PG&f=1", "display_name": "quantum285", "link": "https://stackoverflow.com/users/3512224/quantum285"}, "edited": false, "score": 0, "creation_date": 1435743848, "post_id": 31155622, "comment_id": 50324407, "body": "As AnalystCave.com said, post pictures and clarify this question because we&#39;re not psychic."}, {"owner": {"reputation": 85, "user_id": 3514907, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/06a83d599c8f8fa5dc234a2a4e3a1888?s=128&d=identicon&r=PG&f=1", "display_name": "user3514907", "link": "https://stackoverflow.com/users/3514907/user3514907"}, "edited": false, "score": 0, "creation_date": 1435745450, "post_id": 31155622, "comment_id": 50325439, "body": "I have added photos as requested, there is a list of 160 names on sheet 1 and team leaders on sheet 2, I&#39;m looking for a macro to randomly assign the names from sheet one into the blank spaces on sheet 2."}], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "edited": false, "score": 0, "creation_date": 1435767710, "post_id": 31166715, "comment_id": 50341437, "body": "Does anyone know how to effectively paste code in stackExchage, so that indents are applied correctly? the first indent will always be avoided as it is treated as 4 spaces for code. Is there any &lt;code&gt;&lt;/code&gt; or something? And why do I have to add a sentance after numbered lists to get code format?"}, {"owner": {"reputation": 85, "user_id": 3514907, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/06a83d599c8f8fa5dc234a2a4e3a1888?s=128&d=identicon&r=PG&f=1", "display_name": "user3514907", "link": "https://stackoverflow.com/users/3514907/user3514907"}, "edited": false, "score": 0, "creation_date": 1435824687, "post_id": 31166715, "comment_id": 50364104, "body": "This works great, thank you very much for your help!"}, {"owner": {"reputation": 1506, "user_id": 10359765, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F-1Wf-K-dWQ/AAAAAAAAAAI/AAAAAAAAACA/ub8XVyLGxHM/photo.jpg?sz=128", "display_name": "MoltenMuffins", "link": "https://stackoverflow.com/users/10359765/moltenmuffins"}, "edited": false, "score": 0, "creation_date": 1541031743, "post_id": 31166715, "comment_id": 93084016, "body": "@gudal you can paste a chunk of code, select it and use <code>CTRL</code>+<code>K</code> in order to quickly insert a code block."}], "tags": [], "owner": {"reputation": 325, "user_id": 5008116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4daf0c71a9d2cd598e7025bb911b90c3?s=128&d=identicon&r=PG&f=1", "display_name": "gudal", "link": "https://stackoverflow.com/users/5008116/gudal"}, "is_accepted": true, "score": 2, "last_activity_date": 1435767551, "creation_date": 1435767551, "answer_id": 31166715, "question_id": 31155622, "link": "https://stackoverflow.com/questions/31155622/vba-to-randomly-assign-names-to-groups-without-repeating/31166715#31166715", "title": "VBA to Randomly assign names to groups without repeating", "body": "<p>Under the following assumptions:</p>\n\n<ol>\n<li>Person names are in Column A on sheet named \"Persons\", and column B here is free for anything</li>\n<li>Tables of teams are in sheet called \"Tables\", and \"Team Leader 1\" is in A1, \"Team Leader 2\" is in B1, etc, \"Team Leader 9\" is in A13, \"Team Leader 10\" is in B13, etc</li>\n<li>List of persons is continous list with no black spaces before the next person</li>\n<li>You make a command button and assign it to CreateTeams_BtnClick() from the following code:</li>\n</ol>\n\n<p>:) inserted smiley because code brackets go haywire when inserting after numbered list</p>\n\n<pre><code>Public Sub CreateTeams_BtnClick()\nCreateTeams\nEnd Sub\nPrivate Sub CreateTeams()\nDim teamsSheet, personsSheet As Worksheet\nSet teamsSheet = Worksheets(\"Teams\")\nSet personsSheet = Worksheets(\"Persons\")\n\n\npersonsSheet.Range(\"A:A\").Copy Destination:=personsSheet.Range(\"B:B\")\n\nDim numPersons As Integer\nnumPersons = personsSheet.Range(\"B:B\").End(xlDown).row\n\nDim startRow As Integer\nstartRow = 2\nDim startCol As Integer\nstartCol = 1\nDim personNumber As Integer\n\nFor i = 1 To 16\n    For j = 1 To 10\n        personNumber = Int((numPersons - 1 + 1) * Rnd() + 1)\n        teamsSheet.Cells(startRow, startCol).Value = personsSheet.Cells(personNumber, 2).Value\n        personsSheet.Cells(personNumber, 2).Delete Shift:=xlUp\n        numPersons = numPersons - 1\n        startRow = startRow + 1\n    Next j\n\n    If i &lt; 8 Then\n        startRow = 2\n        startCol = startCol + 1\n    ElseIf i = 8 Then\n        startRow = 14\n        startCol = 1\n    Else\n        startRow = 14\n        startCol = startCol + 1\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 3514907, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/06a83d599c8f8fa5dc234a2a4e3a1888?s=128&d=identicon&r=PG&f=1", "display_name": "user3514907", "link": "https://stackoverflow.com/users/3514907/user3514907"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2760, "favorite_count": 1, "accepted_answer_id": 31166715, "answer_count": 1, "score": -2, "last_activity_date": 1435767551, "creation_date": 1435737340, "last_edit_date": 1435745385, "question_id": 31155622, "link": "https://stackoverflow.com/questions/31155622/vba-to-randomly-assign-names-to-groups-without-repeating", "title": "VBA to Randomly assign names to groups without repeating", "body": "<p><img src=\"https://i.stack.imgur.com/mE4ge.jpg\" alt=\"Name List\"><img src=\"https://i.stack.imgur.com/NvNes.jpg\" alt=\"Leader List\">I am looking for a macro that will randomly assign names into a group. There are 16 groups and they each need 10 names randomly assigning to them. The list of names is on a different sheet and ideally I would just like to run a macro which will paste 10 random names from the list into each group without any repeats. Is this possible? I haven't had any luck finding a solution anywhere else.</p>\n"}, {"tags": ["vba", "excel", "loops"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 3800275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2748dd4b7e0bc2f8c18d13357e6f7cff?s=128&d=identicon&r=PG&f=1", "display_name": "Nadz", "link": "https://stackoverflow.com/users/3800275/nadz"}, "edited": false, "score": 0, "creation_date": 1435823188, "post_id": 31177538, "comment_id": 50363258, "body": "thank you very much this is working. I have another error now though. The part for ROW(1:1) should increase every time ROW(2,2) and so on. any idea how to fix this? I"}, {"owner": {"reputation": 103, "user_id": 3800275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2748dd4b7e0bc2f8c18d13357e6f7cff?s=128&d=identicon&r=PG&f=1", "display_name": "Nadz", "link": "https://stackoverflow.com/users/3800275/nadz"}, "edited": false, "score": 0, "creation_date": 1435823472, "post_id": 31177538, "comment_id": 50363400, "body": "I tried using this: For j = 1 To CountAll i = 2  CountXL = Cells(i, j).Value     R = 1     For i = 1 To CountXL     CustomerName = Cells(1, j).Value     &#39;MsgBox CustomerName     MsgBox R     Cells(i + 2, j).FormulaArray = &quot;=IFERROR(INDEX(Sheet2!$A:$B,SMALL(IF(Sheet2!$A:$A=&quot;&quot;&quot; &amp; CustomerName &amp; &quot;&quot;&quot;,ROW(Sheet2!$A:$A)),ROW(&quot; &amp; R &amp; &quot; : &quot; &amp; R &amp; &quot;))*1,2),0)&quot;     R = R + 1     Next i Next j"}, {"owner": {"reputation": 103, "user_id": 3800275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2748dd4b7e0bc2f8c18d13357e6f7cff?s=128&d=identicon&r=PG&f=1", "display_name": "Nadz", "link": "https://stackoverflow.com/users/3800275/nadz"}, "edited": false, "score": 0, "creation_date": 1435825990, "post_id": 31177538, "comment_id": 50364914, "body": "Thanks for the response; however i am getting a runtime error - object defined error 1004. Any idea?"}, {"owner": {"reputation": 115, "user_id": 4376511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86534c0e4dfe0ae1b2c7b876d3b20c53?s=128&d=identicon&r=PG&f=1", "display_name": "brz", "link": "https://stackoverflow.com/users/4376511/brz"}, "reply_to_user": {"reputation": 103, "user_id": 3800275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2748dd4b7e0bc2f8c18d13357e6f7cff?s=128&d=identicon&r=PG&f=1", "display_name": "Nadz", "link": "https://stackoverflow.com/users/3800275/nadz"}, "edited": false, "score": 0, "creation_date": 1435826185, "post_id": 31177538, "comment_id": 50365037, "body": "Where are you getting error? Which line? Post your full code in question, please."}], "tags": [], "owner": {"reputation": 115, "user_id": 4376511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86534c0e4dfe0ae1b2c7b876d3b20c53?s=128&d=identicon&r=PG&f=1", "display_name": "brz", "link": "https://stackoverflow.com/users/4376511/brz"}, "is_accepted": true, "score": 1, "last_activity_date": 1435820787, "last_edit_date": 1435820787, "creation_date": 1435820227, "answer_id": 31177538, "question_id": 31155097, "link": "https://stackoverflow.com/questions/31155097/referencing-a-string-inside-a-formula-array-in-excel-vba/31177538#31177538", "title": "Referencing a string inside a Formula Array in Excel VBA", "body": "<p>In your case, use below:</p>\n\n<pre><code>Cells(i + 2, j).FormulaArray = \"=IFERROR(INDEX(Sheet2!$A:$B,SMALL(IF(Sheet2!$A:$A=\"\"\" &amp; CustomerName &amp; \"\"\",ROW(Sheet2!$A:$A)),ROW(1:1))*1,2),0)\"\n</code></pre>\n\n<p>in general, if you need concat string use <code>\"formula_par21\"\"\" &amp; value &amp; \"\"\"formula_part2</code>, if it's number - without double quotes, like  <code>\"formula_par21\" &amp; value &amp; \"formula_part2</code></p>\n\n<p><strong>\"\" in VBA = \" in string variable</strong></p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 5035001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/793e84527ef5cffb23cd5a925bd807c4?s=128&d=identicon&r=PG&f=1", "display_name": "Faddi", "link": "https://stackoverflow.com/users/5035001/faddi"}, "is_accepted": false, "score": 1, "last_activity_date": 1435836250, "last_edit_date": 1435836250, "creation_date": 1435826133, "answer_id": 31179487, "question_id": 31155097, "link": "https://stackoverflow.com/questions/31155097/referencing-a-string-inside-a-formula-array-in-excel-vba/31179487#31179487", "title": "Referencing a string inside a Formula Array in Excel VBA", "body": "<pre><code>Cells(i + 2, j).FormulaArray = \"=IFERROR(INDEX(Sheet2!$A:$B,SMALL(IF(Sheet2!$A:$A=\"\"\"\"\" &amp; CustomerName &amp; \"\"\"\"\",ROW(Sheet2!$A:$A)),ROW(1:1))*1,2),0)\"\n</code></pre>\n\n<p>You gotta double the \"\" in the Formulas in VBA --> \"\" = \"\"\"\"</p>\n\n<p>Here is a simple example why you might get the errors:</p>\n\n<p>Excel Formula:</p>\n\n<pre><code>=If(A1&lt;&gt;\"\";A1;B1)\n</code></pre>\n\n<p>VBA Formula</p>\n\n<pre><code>\"=IF(A1&lt;&gt;\"\"\"\",A1,B1)\"\n</code></pre>\n\n<p>so i would recommend you to try this:</p>\n\n<pre><code>Cells(i + 2, j).FormulaArray = \"=IFERROR(INDEX(Sheet2!$A:$B,SMALL(IF(Sheet2!$A:$A=\"\"\"\"\" &amp; CustomerName &amp; \"\"\"\"\",ROW(Sheet2!$A:$A)),ROW(1:1))*1,2),0)\"\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 3800275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2748dd4b7e0bc2f8c18d13357e6f7cff?s=128&d=identicon&r=PG&f=1", "display_name": "Nadz", "link": "https://stackoverflow.com/users/3800275/nadz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "accepted_answer_id": 31177538, "answer_count": 2, "score": 0, "last_activity_date": 1435836250, "creation_date": 1435735747, "last_edit_date": 1435819812, "question_id": 31155097, "link": "https://stackoverflow.com/questions/31155097/referencing-a-string-inside-a-formula-array-in-excel-vba", "title": "Referencing a string inside a Formula Array in Excel VBA", "body": "<p>Need some help referencing a string in an Index formula array</p>\n\n<p>My code below:</p>\n\n<pre><code>Sub Loop_Test2()\n\nDim i As Long\nDim j As Long\nDim CountAll As Long\nDim CountXL As Long\nDim CustomerName As String\n\nActiveSheet.Range(\"A1\").Activate\n\nCountAll = ActiveSheet.Range(\"A35\")\n\nFor j = 1 To CountAll\ni = 2\n\nCountXL = Cells(i, j).Value\n\nFor i = 1 To CountXL\nCustomerName = Cells(1, j).Value\n'MsgBox CustomerName\nCells(i + 2, j).FormulaArray = \"=IFERROR(INDEX(Sheet2!$A:$B,SMALL(IF(Sheet2!$A:$A=CustomerName,ROW(Sheet2!$A:$A)),ROW(1:1))*1,2),0)\"\nNext i\n\nNext j\n\nEnd Sub\n</code></pre>\n\n<p>There is no error; however i need This part fixed so it references the value instead of the actual word inside the formula:\n<br>\nIF(Sheet2!$A:$A=CustomerName</p>\n"}, {"tags": ["vba", "powerpoint", "text-to-speech"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1435762212, "post_id": 31154652, "comment_id": 50337736, "body": "There&#39;s no direct access to this from PPT itself, but you can automate Excel&#39;s text to speech engine from within PowerPoint.  You can find examples via a web search on terms like &quot;excel text to speech vba&quot; (w/o the quote marks)"}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1435768923, "post_id": 31154652, "comment_id": 50342124, "body": "I&#39;ve done this in a prototype add-in with VBA in PowerPoint although it does use a reference to the Microsoft Speech Object Library. I managed to get it to read slide notes and even use a custom voice. I&#39;ll dig out some code and reply back later."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4424336, "user_type": "registered", "profile_image": "https://graph.facebook.com/925271900863524/picture?type=large", "display_name": "John Niezen", "link": "https://stackoverflow.com/users/4424336/john-niezen"}, "edited": false, "score": 0, "creation_date": 1435821766, "post_id": 31167309, "comment_id": 50362452, "body": "Thanks Jamie, I&#39;ll try it after my holiday that starts tomorrow.   &lt;br/&gt;Hope you do not think I&#39;ll forget!"}, {"owner": {"reputation": 11, "user_id": 4424336, "user_type": "registered", "profile_image": "https://graph.facebook.com/925271900863524/picture?type=large", "display_name": "John Niezen", "link": "https://stackoverflow.com/users/4424336/john-niezen"}, "edited": false, "score": 0, "creation_date": 1439895306, "post_id": 31167309, "comment_id": 52037587, "body": "Hi Jamie, should I provide a link to the SpeechLib.SpVoice somewhere? I am getting an error that the User defined type was not specified. Any clues? Thx John"}, {"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 0, "creation_date": 1504857474, "post_id": 31167309, "comment_id": 79185258, "body": "@JamieGarroch  could  you advice on the above problem, I am also facing the same issue"}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 1, "last_activity_date": 1435769486, "creation_date": 1435769486, "answer_id": 31167309, "question_id": 31154652, "link": "https://stackoverflow.com/questions/31154652/how-to-convert-powerpoint-note-text-to-speech-with-vba/31167309#31167309", "title": "how to convert powerpoint note text to speech with vba", "body": "<p>Right, as mentioned above, add a reference in your project to Microsoft Speech Object Library.</p>\n\n<p>Then this function will set you on the right path:</p>\n\n<pre><code>Function SpeakThis(myPhrase As String)\n  Dim oSpeaker As New SpeechLib.SpVoice\n\n  ' Set speech properties\n  oSpeaker.Volume = 100 ' percent\n  oSpeaker.Rate = 1 ' multiplier\n  oSpeaker.SynchronousSpeakTimeout = 1\n  oSpeaker.AlertBoundary = SVEWordBoundary\n\n  If Not myPhrase = \"\" Then oSpeaker.Speak myPhrase, SVSFDefault\nEnd Function\n</code></pre>\n\n<p>Then call this:</p>\n\n<pre><code>SpeakThis \"Hello, my name is Jamie and I love VBA!\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4424336, "user_type": "registered", "profile_image": "https://graph.facebook.com/925271900863524/picture?type=large", "display_name": "John Niezen", "link": "https://stackoverflow.com/users/4424336/john-niezen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 906, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593773648, "creation_date": 1435734416, "last_edit_date": 1593773648, "question_id": 31154652, "link": "https://stackoverflow.com/questions/31154652/how-to-convert-powerpoint-note-text-to-speech-with-vba", "title": "how to convert powerpoint note text to speech with vba", "body": "<p>I want to write a VBA macro that converts the note text to speech using the native windows speech capability.  <br/>\nAnyone done this before?  <br/>\nAny tips how to start and proceed?  <br/>\nIn the end I will need to provide different EU languages for conversion.  <br/>\nThanks John.</p>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 3756196, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/733407966/picture?type=large", "display_name": "dhruva_04", "link": "https://stackoverflow.com/users/3756196/dhruva-04"}, "is_accepted": true, "score": 3, "last_activity_date": 1435758806, "creation_date": 1435758806, "answer_id": 31163358, "question_id": 31154574, "link": "https://stackoverflow.com/questions/31154574/changing-background-row-color-according-to-task-levels-in-ms-project-vba/31163358#31163358", "title": "Changing background row color according to task levels in MS Project VBA", "body": "<p>I played around with the code a bit and found the answer :D</p>\n\n<pre><code>Sub ColorFormatOL()\nDim t As Task\nDim i As Integer\n\ni = 1\nFor Each t In ActiveProject.Tasks\n\n\n       SelectRow row:=i, rowrelative:=False\n\n       Select Case t.OutlineLevel\n           Case 1\n           Font32Ex CellColor:=&amp;HB37F15\n           Case 2\n           Font32Ex CellColor:=&amp;HD6982E\n           Case 3\n           Font32Ex CellColor:=&amp;HF6BE41\n           Case 4\n           Font32Ex CellColor:=&amp;HF7D577\n\n\n       End Select\n\ni = i + 1\nNext t\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 6078911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R8mbU.jpg?s=128&g=1", "display_name": "Hey Romey", "link": "https://stackoverflow.com/users/6078911/hey-romey"}, "is_accepted": false, "score": 0, "last_activity_date": 1458240510, "creation_date": 1458240510, "answer_id": 36069229, "question_id": 31154574, "link": "https://stackoverflow.com/questions/31154574/changing-background-row-color-according-to-task-levels-in-ms-project-vba/36069229#36069229", "title": "Changing background row color according to task levels in MS Project VBA", "body": "<p>Here's a macro I use:</p>\n\n<pre>\nPublic Sub FormatOutline_Blue()\nCall FormatOutlineLevels(9851951, 14396046, 15189684, 14084850, 15791610, 16777215, 16777215, 16777215, 16777215, 16777215)\n\nEnd Sub\n\nPublic Sub FormatOutline_Green()\nCall FormatOutlineLevels(4697456, 9293992, 11788485, 14084850, 15791610, 16777215, 16777215, 16777215, 16777215, 16777215)\nEnd Sub\n\nPublic Sub FormatOutline_Aqua()\nCall FormatOutlineLevels(13998939, 15057820, 15652797, 14084850, 15791610, 16777215, 16777215, 16777215, 16777215, 16777215)\n\nEnd Sub\n\nPrivate Sub FormatOutlineLevels(level1 As String, level2 As String, level3 As String, level4 As String, level5 As String, level6 As String, level7 As String, level8 As String, level9 As String, Optional font1 As String)\n'Format the outline levels. The macro filters to summary tasks, selects the entire sheet, shows outline level x, formats entire sheet.\n'Next, it shows one outline level up (x - 1), formats entire sheet.\n'Last, it removes formatting from inactive summary tasks.\n\n'Prepare\n    On Error GoTo ErrorHandler\n    SaveOriginalSettings\n    OutlineShowAllTasks\n    FilterApply Name:=\"Summary Tasks\"\n    SelectSheet\n\n'Format all rows, starting with this outline level\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel9\n        Font32Ex CellColor:=level9\n\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel8\n        Font32Ex CellColor:=level8\n\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel7\n        Font32Ex CellColor:=level7\n\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel6\n        Font32Ex CellColor:=level6\n\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel5\n        Font32Ex CellColor:=level5\n\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel4\n        Font32Ex CellColor:=level4\n\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel3\n        Font32Ex CellColor:=level3\n\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel2\n        Font32Ex CellColor:=level2\n\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel1\n        Font32Ex CellColor:=level1\n        If Len(font1) > 0 Then Font32Ex Color:=font1\n'Remove formatting from inactive summary tasks\n    ScreenUpdating = False\n    OutlineShowAllTasks\n    FilterEdit Name:=\"Inactive Summary Tasks\", TaskFilter:=True, Create:=True, OverwriteExisting:=True, FieldName:=\"Summary\", test:=\"equals\", Value:=\"yes\", ShowInMenu:=False, ShowSummaryTasks:=False\n    FilterEdit Name:=\"Inactive Summary Tasks\", TaskFilter:=True, FieldName:=\"\", NewFieldName:=\"Active\", test:=\"equals\", Value:=\"no\", Operation:=\"And\", ShowSummaryTasks:=False\n    FilterApply Name:=\"Inactive Summary Tasks\"\n    SelectSheet\n    EditClearFormats\n    ScreenUpdating = True\n\n'Clean up\n    FilterApply Name:=\"All Tasks\"\n    RestoreOriginalSettings\n    CascadeOutline\n\nExit Sub\nErrorHandler:\n    HandlingErrors\n\nEnd Sub\n\nPublic Sub CascadeOutline()\n\nOn Error Resume Next\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel9\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel8\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel7\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel6\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel5\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel4\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel3\n    OutlineShowTasks OutlineNumber:=pjTaskOutlineShowLevel2\n    SelectRow Row:=1, rowrelative:=False\nOn Error GoTo 0\n\nEnd Sub\n\nPrivate Sub HandlingErrors()\n    Select Case Err.Number\n        Case 91\n            MsgBox \"The first row you've selected is missing a task name.\", vbCritical\n        Case 424\n            MsgBox \"The row you've selected may be missing a task name.\", vbCritical\n        Case 1100\n            MsgBox \"This view and table combination doesn't have Outlines available. Try going to \" & _\n                        \"View >> Data Group: Outline. If Outline is grayed out, try clicking on the task name.\" & _\n                        vbNewLine & vbNewLine & \"This error usually happens when the timeline or details pane is selected.\", _\n                    vbCritical, \"Oops! Outline is Unavailable\"\n        Case 1101\n            MsgBox \"Try using this macro on the Task Sheet view.\" & vbNewLine & vbNewLine & _\n                \"Error#\" & Str(Err.Number) & \" - \" & Err.Description, vbCritical, \"Invalid View\"\n        Case Else\n            MsgBox \"Error#\" & Str(Err.Number) & \" - \" & Err.Description & vbNewLine _\n                    & \"Line: \" & Erl & vbNewLine _\n                    , vbCritical\n    End Select\nEnd Sub\n</pre>\n"}], "owner": {"reputation": 141, "user_id": 3756196, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/733407966/picture?type=large", "display_name": "dhruva_04", "link": "https://stackoverflow.com/users/3756196/dhruva-04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6061, "favorite_count": 0, "accepted_answer_id": 31163358, "answer_count": 2, "score": 1, "last_activity_date": 1593555042, "creation_date": 1435734141, "last_edit_date": 1593555042, "question_id": 31154574, "link": "https://stackoverflow.com/questions/31154574/changing-background-row-color-according-to-task-levels-in-ms-project-vba", "title": "Changing background row color according to task levels in MS Project VBA", "body": "<p>Hello I have been trying to figure out a code, so as to color different rows depending upon their task levels. I am new to VBA in MS Project. I have a code which I found online, but it only colors the text in the task column.</p>\n\n<pre><code>Sub ColorFormatOL()\nDim t As Task\nDim i As Integer\nSelectTaskColumn\n  i = 0\nFor Each t In ActiveSelection.Tasks\n   If Not t Is Nothing Then\n       i = i + 1\n   If t.Summary Then\n       SelectRow row:=i, Columrowrelative:=False\n       Select Case t.OutlineLevel\n           Case 1\n               FontEx Color:=pjRed\n           Case 2\n               FontEx Color:=pjGreen\n           Case 3\n               FontEx Color:=pjTeal\n        End Select\n    End If\n  End If\n Next t\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 0, "creation_date": 1435734373, "post_id": 31154523, "comment_id": 50318474, "body": "Is <code>orthForm</code> the exact name of the / a field in your table? It it is not, access will ask you to input a value for it, because it cannot resolve it as a part of the SQL-Statement. What exactly is access asking for? For <code>orthForm</code> or <code>Me.orthForm</code>?"}, {"owner": {"reputation": 47, "user_id": 1673039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d953234d69c3a65de748cefc1959c0b?s=128&d=identicon&r=PG", "display_name": "Mitch", "link": "https://stackoverflow.com/users/1673039/mitch"}, "reply_to_user": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 0, "creation_date": 1435734660, "post_id": 31154523, "comment_id": 50318647, "body": "It&#39;s the name of the textbox being slicked on (renamed to orthFormBox now though) in the report, and orthForm is the value it&#39;s showing (and thus the value when going back into the form)"}, {"owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 0, "creation_date": 1435734738, "post_id": 31154523, "comment_id": 50318695, "body": "It should read <code>DoCmd.OpenForm &quot;FwordFullQuery&quot;, , , &quot;theFieldInYourTable = &quot; &amp; (Me.theTextFieldInYourForm)</code> - did you make sure that is the case?"}, {"owner": {"reputation": 47, "user_id": 1673039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d953234d69c3a65de748cefc1959c0b?s=128&d=identicon&r=PG", "display_name": "Mitch", "link": "https://stackoverflow.com/users/1673039/mitch"}, "reply_to_user": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 0, "creation_date": 1435734897, "post_id": 31154523, "comment_id": 50318789, "body": "It&#39;s exactly like that, yes. Then when it&#39;s clicked on, a prompt pops up asking for a parameter, and the text in this box is the value OF the paramater I want to pass....."}], "answers": [{"comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 1, "creation_date": 1435738169, "post_id": 31154871, "comment_id": 50320593, "body": "With the proviso that orthForm must not contain any single quotes. BTW the brackets are completely unnecessary."}], "tags": [], "owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "is_accepted": true, "score": 2, "last_activity_date": 1435735615, "last_edit_date": 1435735615, "creation_date": 1435735087, "answer_id": 31154871, "question_id": 31154523, "link": "https://stackoverflow.com/questions/31154523/openform-with-the-condition-based-on-textbox-in-report/31154871#31154871", "title": "OpenForm with the condition based on textbox in report?", "body": "<p>You need to wrap the parameter you pass in <code>'</code>:</p>\n\n<pre><code>DoCmd.OpenForm \"FwordFullQuery\", , , \"orthForm = '\" &amp; (Me.orthForm) &amp; \"'\"\n</code></pre>\n\n<p>Otherwise your final statment would look something like</p>\n\n<pre><code>SELECT bla FROM table WHERE orthForm = myText\n</code></pre>\n\n<p>logically access will try to resolve <code>myText</code>  because it thinks it is a field name or parameter or something - which it isn't. Wrapping it in <code>'</code> will result in</p>\n\n<pre><code>SELECT bla FROM table WHERE orthForm = 'myText' \n</code></pre>\n\n<p>which access just can execute as a valid SQL statement.</p>\n"}], "owner": {"reputation": 47, "user_id": 1673039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d953234d69c3a65de748cefc1959c0b?s=128&d=identicon&r=PG", "display_name": "Mitch", "link": "https://stackoverflow.com/users/1673039/mitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1927, "favorite_count": 1, "accepted_answer_id": 31154871, "answer_count": 1, "score": 1, "last_activity_date": 1435736237, "creation_date": 1435733940, "last_edit_date": 1435736237, "question_id": 31154523, "link": "https://stackoverflow.com/questions/31154523/openform-with-the-condition-based-on-textbox-in-report", "title": "OpenForm with the condition based on textbox in report?", "body": "<p>In my report (in MS Access), I'm trying to have a form open and go to a specific record upon opening. I want to to the record where the orthForm in the query is equal to the orthForm textbox being clicked. I have:</p>\n\n<pre><code>DoCmd.OpenForm \"FwordFullQuery\", , , \"orthForm = \" &amp; (Me.orthForm)\n</code></pre>\n\n<p>But then it just asks for a parameter, which annoyingly is <strong>equal to the value</strong> I want to pass as the parameter! The parameter is named like the text written in my TextBox.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["mysql", "vb.net", "vba", "excel"], "comments": [{"owner": {"reputation": 4001, "user_id": 599765, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/836ed996b63a770fb92cbe40ea29586a?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Schild", "link": "https://stackoverflow.com/users/599765/andr%c3%a9-schild"}, "edited": false, "score": 0, "creation_date": 1435730788, "post_id": 31153613, "comment_id": 50316642, "body": "Is the mysql odbc driver installed?"}, {"owner": {"reputation": 3914, "user_id": 4323504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8Yn9o.jpg?s=128&g=1", "display_name": "Luthando Ntsekwa", "link": "https://stackoverflow.com/users/4323504/luthando-ntsekwa"}, "reply_to_user": {"reputation": 4001, "user_id": 599765, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/836ed996b63a770fb92cbe40ea29586a?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Schild", "link": "https://stackoverflow.com/users/599765/andr%c3%a9-schild"}, "edited": false, "score": 0, "creation_date": 1435731018, "post_id": 31153613, "comment_id": 50316740, "body": "@Andr&#233;Schild Yes i see <code>MySQL Connector&#47;ODBC 5.1</code> in my programs and features"}, {"owner": {"reputation": 4001, "user_id": 599765, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/836ed996b63a770fb92cbe40ea29586a?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Schild", "link": "https://stackoverflow.com/users/599765/andr%c3%a9-schild"}, "edited": false, "score": 0, "creation_date": 1435731967, "post_id": 31153613, "comment_id": 50317197, "body": "And it&#39;s the correct 32 or 64bit edition as needed by your VBA application? Does it work when you try to setup the datasource in the odbc manager?"}, {"owner": {"reputation": 3914, "user_id": 4323504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8Yn9o.jpg?s=128&g=1", "display_name": "Luthando Ntsekwa", "link": "https://stackoverflow.com/users/4323504/luthando-ntsekwa"}, "reply_to_user": {"reputation": 4001, "user_id": 599765, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/836ed996b63a770fb92cbe40ea29586a?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Schild", "link": "https://stackoverflow.com/users/599765/andr%c3%a9-schild"}, "edited": false, "score": 0, "creation_date": 1435732179, "post_id": 31153613, "comment_id": 50317326, "body": "problem solved, so i checked my programs and files and i noticed that i had 32bit mysql and 64bit MySQL connector, so i downloaded the 32bit myql connector to match 32bit mysql and it worked. @Andr&#233;Schild make your comment an answer and i will accept it. thanks"}], "answers": [{"tags": [], "owner": {"reputation": 4001, "user_id": 599765, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/836ed996b63a770fb92cbe40ea29586a?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Schild", "link": "https://stackoverflow.com/users/599765/andr%c3%a9-schild"}, "is_accepted": true, "score": 3, "last_activity_date": 1435734787, "creation_date": 1435734787, "answer_id": 31154775, "question_id": 31153613, "link": "https://stackoverflow.com/questions/31153613/vba-run-time-error-2147467259-80004005/31154775#31154775", "title": "VBA Run-time error &#39;-2147467259 (80004005)", "body": "<p>The ODBC drivers must match the 32 or 64Bit architekture of the VBA application.</p>\n\n<p>Otherwise VBA isn't able to use the odbc drivers.</p>\n"}], "owner": {"reputation": 3914, "user_id": 4323504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8Yn9o.jpg?s=128&g=1", "display_name": "Luthando Ntsekwa", "link": "https://stackoverflow.com/users/4323504/luthando-ntsekwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17491, "favorite_count": 0, "accepted_answer_id": 31154775, "answer_count": 1, "score": 1, "last_activity_date": 1435734787, "creation_date": 1435730529, "question_id": 31153613, "link": "https://stackoverflow.com/questions/31153613/vba-run-time-error-2147467259-80004005", "title": "VBA Run-time error &#39;-2147467259 (80004005)", "body": "<p>I am trying to connect to <code>mysql</code> using <code>Excel VBA</code>, I am using Excel 2013. I am new to VB, so i followed this example: <a href=\"http://www.heritage-tech.net/908/inserting-data-into-mysql-from-excel-using-vba/\" rel=\"nofollow noreferrer\">Inserting Data Into MySQL From Excel Using VBA</a>   </p>\n\n<p>Here is my connection code:  </p>\n\n<pre><code>Private Sub ConnectDB()\nSet oConn = New ADODB.Connection\noConn.Open \"DRIVER={MySQL ODBC 5.1.13 Driver};\" &amp; _\n    \"SERVER=123.456.0.188;\" &amp; _\n    \"DATABASE=MyDB;\" &amp; _\n    \"USER=MyUser;\" &amp; _\n    \"PASSWORD=MyPassword;\" &amp; _\n    \"Option=3\"\nEnd Sub  \n</code></pre>\n\n<p>When I try to execute this code, I get the following error:  </p>\n\n<pre><code>---------------------------\nMicrosoft Visual Basic for Applications\n---------------------------\nRun-time error '-2147467259 (80004005)':\n\nAutomation error\nUnspecified error  \n</code></pre>\n\n<p>Here are my references:  </p>\n\n<p><img src=\"https://i.stack.imgur.com/QeV4y.png\" alt=\"VBA References\">  </p>\n\n<p>I know this question may look like a duplicate but I have looked through most of questions similar to this one, they do not solve my issue.</p>\n"}, {"tags": ["excel", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 97, "user_id": 2999509, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/Iz6TF.jpg?s=128&g=1", "display_name": "user2999509", "link": "https://stackoverflow.com/users/2999509/user2999509"}, "edited": false, "score": 0, "creation_date": 1435729786, "post_id": 31153428, "comment_id": 50316219, "body": "Moving the workbook over to C drive seems to help but it keeps grabbing the first  file over and over again"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1435730069, "post_id": 31153428, "comment_id": 50316324, "body": "&quot;My excel code&quot; - which you don&#39;t seem to want to share ? It&#39;s difficult to make any suggestions without it."}, {"owner": {"reputation": 97, "user_id": 2999509, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/Iz6TF.jpg?s=128&g=1", "display_name": "user2999509", "link": "https://stackoverflow.com/users/2999509/user2999509"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1435730314, "post_id": 31153428, "comment_id": 50316418, "body": "Oh hey sry, forgot to include the link. Its relatively the same as the links one. And i meant it as the code im running, as opposed to my personally written code"}, {"owner": {"reputation": 1985, "user_id": 3160820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9E28.jpg?s=128&g=1", "display_name": "Trimax", "link": "https://stackoverflow.com/users/3160820/trimax"}, "edited": false, "score": 1, "creation_date": 1435735835, "post_id": 31153428, "comment_id": 50319364, "body": "Post your code please."}, {"owner": {"reputation": 97, "user_id": 2999509, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/Iz6TF.jpg?s=128&g=1", "display_name": "user2999509", "link": "https://stackoverflow.com/users/2999509/user2999509"}, "edited": false, "score": 0, "creation_date": 1435736068, "post_id": 31153428, "comment_id": 50319470, "body": "Hi trimax, really sorry, im not able to do so cos my code is 100s of lines long and not on a PC with  internet connection unfortunately."}, {"owner": {"reputation": 934, "user_id": 2946006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c79ab52aa469c475f27ae6b16d5b87b8?s=128&d=identicon&r=PG&f=1", "display_name": "DMM", "link": "https://stackoverflow.com/users/2946006/dmm"}, "edited": false, "score": 0, "creation_date": 1435739034, "post_id": 31153428, "comment_id": 50321144, "body": "So you&#39;ve got a problem with code some 100&#39;s of lines long, you can&#39;t or won&#39;t distill it down to the few lines that are causing you a problem and post these so that people who might actually try and help you can see the specifics of your problem and, by doing so, help you find a solution. Being &quot;relatively the same as the links one&quot; isn&#39;t actually the same code that is causing you the problem. Why bother posting in the first place, as you can&#39;t/won&#39;t provide appropriate details of your problem?"}, {"owner": {"reputation": 97, "user_id": 2999509, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/Iz6TF.jpg?s=128&g=1", "display_name": "user2999509", "link": "https://stackoverflow.com/users/2999509/user2999509"}, "edited": false, "score": 0, "creation_date": 1435739261, "post_id": 31153428, "comment_id": 50321298, "body": "I cant provide the code because  its on a PC without internet connection, and i was hoping  that people experiencing the same issue (Calling macros from networked drives from different PCs) would have a solution, especially seeing as though i have helped others without looking at their codes before, it could be a matter of just identifying the possible pitfalls in the situation"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435749603, "post_id": 31153428, "comment_id": 50328190, "body": "You&#39;re not specifying the correct path when you open the workbooks. Simple as that."}, {"owner": {"reputation": 97, "user_id": 2999509, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/Iz6TF.jpg?s=128&g=1", "display_name": "user2999509", "link": "https://stackoverflow.com/users/2999509/user2999509"}, "edited": false, "score": 0, "creation_date": 1435750555, "post_id": 31153428, "comment_id": 50328854, "body": "Unfortunately thats not the case cos shifting the location of the workbook, without reapecifying the path seems to solve the problem"}, {"owner": {"reputation": 97, "user_id": 2999509, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/Iz6TF.jpg?s=128&g=1", "display_name": "user2999509", "link": "https://stackoverflow.com/users/2999509/user2999509"}, "edited": false, "score": 0, "creation_date": 1436413763, "post_id": 31153428, "comment_id": 50604579, "body": "Solved the issue, must change drive that excel looks at using ChDrive"}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 2999509, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/Iz6TF.jpg?s=128&g=1", "display_name": "user2999509", "link": "https://stackoverflow.com/users/2999509/user2999509"}, "is_accepted": true, "score": 0, "last_activity_date": 1436413710, "creation_date": 1436413710, "answer_id": 31307783, "question_id": 31153428, "link": "https://stackoverflow.com/questions/31153428/excel-vba-not-opening-correct-workbooks/31307783#31307783", "title": "Excel Vba not opening correct workbooks?", "body": "<p>Guys the answer is simple. Because im using a networked drive, one should refer to the drive on which the workbook is stored. Adding one line to the top above ChDir solves this</p>\n\n<p>ChDrive (Left (ThisWorkbook.Path, 2))</p>\n\n<p>Im also glad to report that this question did not require me posting my code as well. </p>\n"}], "owner": {"reputation": 97, "user_id": 2999509, "user_type": "registered", "accept_rate": 21, "profile_image": "https://i.stack.imgur.com/Iz6TF.jpg?s=128&g=1", "display_name": "user2999509", "link": "https://stackoverflow.com/users/2999509/user2999509"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 31307783, "answer_count": 1, "score": -2, "last_activity_date": 1436413710, "creation_date": 1435729752, "last_edit_date": 1531161705, "question_id": 31153428, "link": "https://stackoverflow.com/questions/31153428/excel-vba-not-opening-correct-workbooks", "title": "Excel Vba not opening correct workbooks?", "body": "<p>My excel code was able to iterate through every workbook in a specified folder, although it does so in an eternal loop. (Which i stop using the keyboard  interrupt)</p>\n\n<p>Vba based off this: <a href=\"http://www.ozgrid.com/VBA/2007-filesearch-alternative.htm\" rel=\"nofollow\">http://www.ozgrid.com/VBA/2007-filesearch-alternative.htm</a></p>\n\n<p>Now, after switching PCs, the code has gone haywire. The vba is still the same but instead of opening workbooks in the specified folder, its opening workbooks in the folder one folder before it. </p>\n\n<p>E.g Vba is in S:\\Excel\\Test\nIt will open books in  S:\\Excel \nInstead of a specified location in C. Drive S is a networked drive</p>\n\n<p>Not only that, while it used to iterate through EVERY file, it now just keeps resetting and opening the first file again and again</p>\n\n<p>Using Excel 2007</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 2972046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8ed5d7141fdc9cc241112fdc58cad3?s=128&d=identicon&r=PG&f=1", "display_name": "user2972046", "link": "https://stackoverflow.com/users/2972046/user2972046"}, "edited": false, "score": 0, "creation_date": 1435730188, "post_id": 31153464, "comment_id": 50316367, "body": "omg thanks it works! Did not know that this will trigger an infinite loop. Thanks alot!"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "reply_to_user": {"reputation": 51, "user_id": 2972046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8ed5d7141fdc9cc241112fdc58cad3?s=128&d=identicon&r=PG&f=1", "display_name": "user2972046", "link": "https://stackoverflow.com/users/2972046/user2972046"}, "edited": false, "score": 0, "creation_date": 1435730843, "post_id": 31153464, "comment_id": 50316661, "body": "you&#39;re welcome... don&#39;t forget to use <code>accept answer</code> button"}], "tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": false, "score": 0, "last_activity_date": 1435729933, "creation_date": 1435729933, "answer_id": 31153464, "question_id": 31152643, "link": "https://stackoverflow.com/questions/31152643/excel-vba-add-lastmodified-user-and-lastupdated-date/31153464#31153464", "title": "Excel Vba - Add LastModified user and LastUpdated Date", "body": "<p>You need to switch off <code>events</code> when you wright back to excel sheet. Without that you get infinite loop (you writhe to excel which triggers event again >> which write to excel >> which trigger event again >> and so on...) . Your code after changes will look like below:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\napplication.EnableEvents = false\n    If Target.Row &gt; 1 Then\n        Cells(Target.Row, \"E\") = Date()\n        Cells(Target.Row, \"F\") = Environ(\"username\")\n    End if\napplication.EnableEvents = true\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 2972046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8ed5d7141fdc9cc241112fdc58cad3?s=128&d=identicon&r=PG&f=1", "display_name": "user2972046", "link": "https://stackoverflow.com/users/2972046/user2972046"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435729933, "creation_date": 1435725513, "last_edit_date": 1435725768, "question_id": 31152643, "link": "https://stackoverflow.com/questions/31152643/excel-vba-add-lastmodified-user-and-lastupdated-date", "title": "Excel Vba - Add LastModified user and LastUpdated Date", "body": "<p>I wish to record the lastUpdatedDate and LastModifiedUser of those who made any changes to the rows of record. I can't seems to get the 2 to work together and it always result in Excel freezing.</p>\n\n<p>Below is my code: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Row &gt; 1 Then\n    Cells(Target.Row, \"E\") = Date()\n    Cells(Target.Row, \"F\") = Environ(\"username\")\n\nEnd Sub\n</code></pre>\n\n<p>Anyone knows how to solve this issue? Thanks!</p>\n"}, {"tags": ["javascript", "angularjs", "excel", "internet-explorer", "vba"], "comments": [{"owner": {"reputation": 661, "user_id": 1512732, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c02caf3a39764b72cc521989f5597017?s=128&d=identicon&r=PG", "display_name": "Paul Nispel", "link": "https://stackoverflow.com/users/1512732/paul-nispel"}, "edited": false, "score": 0, "creation_date": 1435724267, "post_id": 31152411, "comment_id": 50314473, "body": "check out <code>$scope.$apply()</code> this should run after you&#39;ve updated the form values: <a href=\"http://jimhoskins.com/2012/12/17/angularjs-and-apply.html\" rel=\"nofollow noreferrer\">jimhoskins.com/2012/12/17/angularjs-and-apply.html</a>"}, {"owner": {"reputation": 21, "user_id": 5067903, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sz87-dmmqpQ/AAAAAAAAAAI/AAAAAAAAE7g/4wQX0nITlR4/photo.jpg?sz=128", "display_name": "Karim Khan", "link": "https://stackoverflow.com/users/5067903/karim-khan"}, "reply_to_user": {"reputation": 661, "user_id": 1512732, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c02caf3a39764b72cc521989f5597017?s=128&d=identicon&r=PG", "display_name": "Paul Nispel", "link": "https://stackoverflow.com/users/1512732/paul-nispel"}, "edited": false, "score": 0, "creation_date": 1436159428, "post_id": 31152411, "comment_id": 50474317, "body": "Thanks @Paul, I had actually read this article and tried to make this work for me, but I&#39;m missing something. Let&#39;s say I want to make the apply() function run from the console, and I have an &lt;input&gt; field in the form with ID = &quot;accountNameValue&quot;. I tried: <code>angular.element(document.querySelector(&#39;#accountNameValue&#39;))&zwnj;&#8203;.scope().apply();</code> in the console but got the error, <code>Uncaught TypeError: angular.element(...).scope(...).apply is not a function</code>."}, {"owner": {"reputation": 661, "user_id": 1512732, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c02caf3a39764b72cc521989f5597017?s=128&d=identicon&r=PG", "display_name": "Paul Nispel", "link": "https://stackoverflow.com/users/1512732/paul-nispel"}, "edited": false, "score": 0, "creation_date": 1436192340, "post_id": 31152411, "comment_id": 50493711, "body": "I&#39;m not sure if you typed it in wrong, but notice the <code>$</code> on <code>$apply()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5067903, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sz87-dmmqpQ/AAAAAAAAAAI/AAAAAAAAE7g/4wQX0nITlR4/photo.jpg?sz=128", "display_name": "Karim Khan", "link": "https://stackoverflow.com/users/5067903/karim-khan"}, "edited": false, "score": 0, "creation_date": 1456526421, "post_id": 35590746, "comment_id": 59006237, "body": "Thanks, I never solved this, just worked around it. I tried your suggestion but couldn&#39;t quite make it work, it may just be I need to spend more time with it--the problem is well in the past so I can&#39;t really afford to give it more attention."}], "tags": [], "owner": {"reputation": 23, "user_id": 3618398, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aef55c741ede310f7dce23527e382132?s=128&d=identicon&r=PG&f=1", "display_name": "Modudes", "link": "https://stackoverflow.com/users/3618398/modudes"}, "is_accepted": false, "score": 0, "last_activity_date": 1456272093, "creation_date": 1456272093, "answer_id": 35590746, "question_id": 31152411, "link": "https://stackoverflow.com/questions/31152411/how-can-i-force-an-angluarjs-form-to-realize-required-fields-have-been-filled-th/35590746#35590746", "title": "How can I force an AngluarJS form to realize required fields have been filled through DOM manipulation (no user input)?", "body": "<p>Have you solved this problem Karim or found any solution? I recently had a project of mine, with the same problem.\nTry to find the tag with ng-submit something like what I have 'ng-submit\"=submit($event)\"'. I referenced the form element and used .submit. In your case, try this:</p>\n\n<p>Set HTMLFormEl = HTML.getElementById(\"accountNameValue\")</p>\n\n<p>HTMLFormEl.Submit</p>\n\n<p>The 'submit' was the one that solved my problem. Let me know if this works for you.</p>\n\n<p><em>Not a VBA nor AngularJS expert but I noticed that AngularJS has nothing to do in treating the required fields as if they were still blank. Just need to find the correct event to trigger. Just my opinion.</em></p>\n"}, {"tags": [], "owner": {"reputation": 245, "user_id": 5129981, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cb1feaba2e10ef1f08e0b5653222a754?s=128&d=identicon&r=PG&f=1", "display_name": "Vahagn Sargsyan", "link": "https://stackoverflow.com/users/5129981/vahagn-sargsyan"}, "is_accepted": false, "score": 0, "last_activity_date": 1478381125, "creation_date": 1478381125, "answer_id": 40443371, "question_id": 31152411, "link": "https://stackoverflow.com/questions/31152411/how-can-i-force-an-angluarjs-form-to-realize-required-fields-have-been-filled-th/40443371#40443371", "title": "How can I force an AngluarJS form to realize required fields have been filled through DOM manipulation (no user input)?", "body": "<p>Don't know is my answer is actual or not, but i had the same problem, and i found a solution using Application.SendKeys. The function filling out the form looks like this</p>\n\n<pre><code>Function inputWrite(ByVal str As String, inputEl As Object, ByVal hwnd As LongLong) As Boolean\nTryAgain_inputWrite:\n    strSub = Left(str, Len(str) - 1)\n    strKey = Right(str, 1)\n\n    inputEl.Focus\n    inputEl.Value = strSub\n    setToFore hwnd\n    Application.SendKeys strKey\n\n    Application.Wait DateAdd(\"s\", 1, Now)\n\n    If (inputEl.Value = str) Then\n        inputWrite = True\n    Else\n        GoTo TryAgain_inputWrite\n    End If\nEnd Function\n</code></pre>\n\n<p>setToFore is just a function to always keep the Internet Explorer on top of other applications, so the send key won't miss.</p>\n"}], "owner": {"reputation": 21, "user_id": 5067903, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sz87-dmmqpQ/AAAAAAAAAAI/AAAAAAAAE7g/4wQX0nITlR4/photo.jpg?sz=128", "display_name": "Karim Khan", "link": "https://stackoverflow.com/users/5067903/karim-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 842, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1478381125, "creation_date": 1435723893, "last_edit_date": 1531161705, "question_id": 31152411, "link": "https://stackoverflow.com/questions/31152411/how-can-i-force-an-angluarjs-form-to-realize-required-fields-have-been-filled-th", "title": "How can I force an AngluarJS form to realize required fields have been filled through DOM manipulation (no user input)?", "body": "<p>I've written an Excel VBA macro to paste some data into an AngularJS form -- it opens an Internet Explorer (11) window, navigates to the page containing the form, and crawls the document tree looking for certain  elements by their ID, changing their values from blank to non-blank strings from the Excel sheet. However, when I submit the form, the form logic treats all the required fields as if they were still blank, drawing a red box around the supposed offending fields. (I can intervene at this point by clicking into each field, typing a random character at the end of the pasted data and immediately deleting it, and this triggers the logic that the required field is now filled.)</p>\n\n<p>I'm not a javascript programmer and didn't design the form (nor can I change it in any way). I can manipulate the DOM elements (focusing and blurring the fields, for example, though that doesn't seem to work), and I can probably run any command that could be entered into the console in the browser debugger. Would any AngularJS expert know a relatively simple way to force the form to check itself?</p>\n"}, {"tags": ["sql", "vb.net", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4861300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad5919f350214dd6ea97683a26f82ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe Allison", "link": "https://stackoverflow.com/users/4861300/chloe-allison"}, "edited": false, "score": 0, "creation_date": 1435741957, "post_id": 31156102, "comment_id": 50323094, "body": "I&#39;ve tried it but it shows this error &quot;Operator &#39;+&#39; is not defined for type &#39;String()&#39; and string &quot;EA&quot; &quot;. EA is a text value data in the column @LocEngineer"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 15, "user_id": 4861300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad5919f350214dd6ea97683a26f82ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe Allison", "link": "https://stackoverflow.com/users/4861300/chloe-allison"}, "edited": false, "score": 0, "creation_date": 1435742425, "post_id": 31156102, "comment_id": 50323452, "body": "Please post sample values for your Session and UOM. Is POTableCounter an int? Get rid of <code>&quot;&quot; &amp;</code>."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 15, "user_id": 4861300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad5919f350214dd6ea97683a26f82ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe Allison", "link": "https://stackoverflow.com/users/4861300/chloe-allison"}, "edited": false, "score": 0, "creation_date": 1435745666, "post_id": 31156102, "comment_id": 50325557, "body": "Ummm... Do the <code>insertCommands</code> have anything to do with the above code? What <b>values</b> do the Session variables hold? Also, according to <a href=\"http://stackoverflow.com/questions/4670247/concat-strings-by-and-in-vb-net\" title=\"concat strings by and in vb net\">stackoverflow.com/questions/4670247/&hellip;</a> please always use the <code>&amp;</code> operator to concatenate strings in VB.Net."}, {"owner": {"reputation": 15, "user_id": 4861300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad5919f350214dd6ea97683a26f82ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe Allison", "link": "https://stackoverflow.com/users/4861300/chloe-allison"}, "edited": false, "score": 0, "creation_date": 1435813784, "post_id": 31156102, "comment_id": 50358972, "body": "&quot;EA&quot; and &quot;LOT&quot; for most of them. They are text values @LocEngineer"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 15, "user_id": 4861300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad5919f350214dd6ea97683a26f82ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe Allison", "link": "https://stackoverflow.com/users/4861300/chloe-allison"}, "edited": false, "score": 0, "creation_date": 1435826792, "post_id": 31156102, "comment_id": 50365464, "body": "In that case try this: <code>oSheet.Range(&quot;F&quot; &amp; ExcelCounter).Value = Session(&quot;PO Qty&quot;).ToString() &amp; reader.Item(&quot;UOM&quot;).ToString() + (POTableCounter).ToString()</code>"}, {"owner": {"reputation": 15, "user_id": 4861300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad5919f350214dd6ea97683a26f82ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe Allison", "link": "https://stackoverflow.com/users/4861300/chloe-allison"}, "edited": false, "score": 0, "creation_date": 1435887389, "post_id": 31156102, "comment_id": 50398528, "body": "Seems like the cell in Excel displays &quot;System.String[]E&quot; instead of the values @LocEngineer"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 15, "user_id": 4861300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad5919f350214dd6ea97683a26f82ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe Allison", "link": "https://stackoverflow.com/users/4861300/chloe-allison"}, "edited": false, "score": 0, "creation_date": 1435914781, "post_id": 31156102, "comment_id": 50408525, "body": "Aha. Getting closer. What does this one yield: <code>oSheet.Range(&quot;F&quot; &amp; ExcelCounter).Value = Session(&quot;PO Qty&quot;).ToString() &amp; dreader.GetString(0) &amp; (POTableCounter).ToString()</code>"}, {"owner": {"reputation": 15, "user_id": 4861300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad5919f350214dd6ea97683a26f82ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe Allison", "link": "https://stackoverflow.com/users/4861300/chloe-allison"}, "edited": false, "score": 0, "creation_date": 1435916906, "post_id": 31156102, "comment_id": 50409813, "body": "<code>System.String[]EA0</code> but what does it mean~ @LocEngineer"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 15, "user_id": 4861300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad5919f350214dd6ea97683a26f82ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe Allison", "link": "https://stackoverflow.com/users/4861300/chloe-allison"}, "edited": false, "score": 0, "creation_date": 1435918258, "post_id": 31156102, "comment_id": 50410637, "body": "It means that there is your Session(&quot;PO Qty&quot;) is the culprit. Another amendment then: <code>oSheet.Range(&quot;F&quot; &amp; ExcelCounter).Value = CType(Session(&quot;PO Qty&quot;), String) &amp; dreader.GetString(0) &amp; (POTableCounter).ToString()</code>"}], "tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1435738870, "creation_date": 1435738870, "answer_id": 31156102, "question_id": 31152084, "link": "https://stackoverflow.com/questions/31152084/how-do-i-display-data-from-database-in-vba-excel/31156102#31156102", "title": "How do I display Data from Database in VBA Excel?", "body": "<p>Executing the reader alone will not do it. You also have to actually <strong>read</strong>.\nTry this:</p>\n\n<pre><code>Oledbconn.Open()\nreader = cmd.ExecuteReader()\n\nif (dreader.HasRows)\n{\n    dreader.Read();\n    oSheet.Range(\"F\" &amp; ExcelCounter).Value = \"\" &amp; Session(\"PO Qty\") + reader.Item(\"UOM\") + (POTableCounter)\n    oSheet.Range(\"F\" &amp; ExcelCounter).HorizontalAlignment = -4108\n}\n\nOledbconn.Close()\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4861300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad5919f350214dd6ea97683a26f82ad8?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe Allison", "link": "https://stackoverflow.com/users/4861300/chloe-allison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 456, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435738870, "creation_date": 1435721485, "last_edit_date": 1531164843, "question_id": 31152084, "link": "https://stackoverflow.com/questions/31152084/how-do-i-display-data-from-database-in-vba-excel", "title": "How do I display Data from Database in VBA Excel?", "body": "<p>I have a column in the database called \"UOM\" and I want to display it beside a value called \"Qty\" via opening an SQL query. But it showed an error saying \"No data exists for the row/column\". This is my codes. </p>\n\n<pre><code>Dim Oledbconn As New OleDbConnection(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source= C:/inetpub/wwwroot/ProjectIntegrated/Inven.mdb;Persist Security Info=True\")\n        Dim cmd As New OleDbCommand\n        Dim reader As OleDbDataReader\n\n        cmd.CommandText = \"Select UOM FROM Master WHERE IPN = '\" &amp; Session(\"PO IPN\")(SummaryCounter) &amp; \"'\"\n        cmd.CommandType = CommandType.Text\n        cmd.Connection = Oledbconn\n\n        Oledbconn.Open()\n        reader = cmd.ExecuteReader()\n\n        oSheet.Range(\"F\" &amp; ExcelCounter).Value = \"\" &amp; Session(\"PO Qty\") + reader.Item(\"UOM\") + (POTableCounter)\n        oSheet.Range(\"F\" &amp; ExcelCounter).HorizontalAlignment = -4108\n\n\n        Oledbconn.Close()\n</code></pre>\n"}, {"tags": ["excel", "powershell", "vba"], "answers": [{"tags": [], "owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "is_accepted": true, "score": 0, "last_activity_date": 1435751109, "creation_date": 1435751109, "answer_id": 31160368, "question_id": 31151940, "link": "https://stackoverflow.com/questions/31151940/insert-empty-element-of-array-into-excel-cells/31160368#31160368", "title": "Insert empty element of array into Excel cells", "body": "<p><code>Select-String</code> doesn't produce non-matches, so you don't get a result array with empty fields. You need something like this to preserve empty \"results\":</p>\n\n<pre class=\"lang-psh prettyprint-override\"><code>$arr = New-Object Collections.ArrayList\n$body | % { $arr += if ($_ -match $pattern) {$_} else {$null} }\n</code></pre>\n\n<p>Note that <code>$body</code> must be an array of lines for this to work.</p>\n"}], "owner": {"reputation": 3, "user_id": 3358493, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8c9a12a42144928703c31dcdfa91e37e?s=128&d=identicon&r=PG&f=1", "display_name": "user3358493", "link": "https://stackoverflow.com/users/3358493/user3358493"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 31160368, "answer_count": 1, "score": 0, "last_activity_date": 1435751109, "creation_date": 1435720297, "last_edit_date": 1531164843, "question_id": 31151940, "link": "https://stackoverflow.com/questions/31151940/insert-empty-element-of-array-into-excel-cells", "title": "Insert empty element of array into Excel cells", "body": "<p>I have this problem</p>\n\n\n\n<pre class=\"lang-psh prettyprint-override\"><code>$arr = @()\n$regex = \"blabla\"\n\n$arr = $body | Select-String $regex -AllMatches | %{$_.Matches} | %{$_Value}\n</code></pre>\n\n<p>The data extracted should be like this: </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Empty\nValue 1\nValue 2\nEmpty\nValue 3\n</code></pre>\n\n<p>When I copy it to Excel rows:</p>\n\n<pre class=\"lang-psh prettyprint-override\"><code>$row = $worksheet.usedrange.rows.count+1\n$usedrange = $worksheet.usedrange\n$usedrange.entirecolumn.autofit() | Out-Null\n\n$worksheet.cells.item($row,11) = $arr[$i]\n</code></pre>\n\n<p>the empty value been override by the first available array sequentially and become like this</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Value 1\nValue 2\nValue 3\nEmpty\nEmpty\n</code></pre>\n\n<p>How can I get like the original value that I've extracted before?</p>\n"}, {"tags": ["excel", "vba", "consolidation"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4139050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5556875864eba560b6ecfdf26c9b8f34?s=128&d=identicon&r=PG&f=1", "display_name": "Salvatore Fanale", "link": "https://stackoverflow.com/users/4139050/salvatore-fanale"}, "edited": false, "score": 0, "creation_date": 1435770984, "post_id": 31157738, "comment_id": 50343282, "body": "Thanks for the suggestion!  One question, your method selects the entire table, including the header.  Is there a selection method for a table that selects only the table data?  OR do I just need to manually find the limits of the table data and copy that?"}, {"owner": {"reputation": 208, "user_id": 3891582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51448975dcaa6ad63dc094840d703b56?s=128&d=identicon&r=PG&f=1", "display_name": "cherry_bueno", "link": "https://stackoverflow.com/users/3891582/cherry-bueno"}, "reply_to_user": {"reputation": 109, "user_id": 4139050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5556875864eba560b6ecfdf26c9b8f34?s=128&d=identicon&r=PG&f=1", "display_name": "Salvatore Fanale", "link": "https://stackoverflow.com/users/4139050/salvatore-fanale"}, "edited": false, "score": 0, "creation_date": 1435772207, "post_id": 31157738, "comment_id": 50343940, "body": "Yes, you would instead use: ActiveSheet.ListObjects(tbl.Name).DataBodyRange.Select"}, {"owner": {"reputation": 109, "user_id": 4139050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5556875864eba560b6ecfdf26c9b8f34?s=128&d=identicon&r=PG&f=1", "display_name": "Salvatore Fanale", "link": "https://stackoverflow.com/users/4139050/salvatore-fanale"}, "edited": false, "score": 0, "creation_date": 1435772784, "post_id": 31157738, "comment_id": 50344228, "body": "I also realized, the above code was entered on sheet1.  When I moved it to a module, the line range(tbl.name).select worked as I expected it would.  Thanks!"}], "tags": [], "owner": {"reputation": 208, "user_id": 3891582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51448975dcaa6ad63dc094840d703b56?s=128&d=identicon&r=PG&f=1", "display_name": "cherry_bueno", "link": "https://stackoverflow.com/users/3891582/cherry-bueno"}, "is_accepted": true, "score": 2, "last_activity_date": 1435743478, "creation_date": 1435743478, "answer_id": 31157738, "question_id": 31151029, "link": "https://stackoverflow.com/questions/31151029/consolidate-formatted-tables/31157738#31157738", "title": "Consolidate formatted tables?", "body": "<p>I would normally refer to a <code>ListObject</code> table in the following way:</p>\n\n<pre><code>Sub GatherTables()\n\nDim tbl As ListObject\nDim sht As Worksheet\n\nFor Each sht In ThisWorkbook.Worksheets\n    sht.Activate\n    If sht.Name = \"Summary\" Or sht.Name = \"Consolidated\" Then\n        'do nothing\n    Else\n        For Each tbl In sht.ListObjects\n            ActiveSheet.ListObjects(tbl.Name).Range.Select\n            Selection.Copy\n            'do something with it\n        Next tbl\n    End If\nNext sht\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 4139050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5556875864eba560b6ecfdf26c9b8f34?s=128&d=identicon&r=PG&f=1", "display_name": "Salvatore Fanale", "link": "https://stackoverflow.com/users/4139050/salvatore-fanale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 31157738, "answer_count": 1, "score": 0, "last_activity_date": 1435743478, "creation_date": 1435713098, "question_id": 31151029, "link": "https://stackoverflow.com/questions/31151029/consolidate-formatted-tables", "title": "Consolidate formatted tables?", "body": "<p>I am trying to consolidate multiple formatted tables across all sheets of a workbook into one main table.</p>\n\n<p>I have the following VBA to loop all the sheets and tables:</p>\n\n<pre><code>Sub GatherTables()\n\nDim tbl As ListObject\nDim sht As Worksheet\n\nFor Each sht In ThisWorkbook.Worksheets\n    sht.Activate\n    If sht.Name = \"Summary\" Or sht.Name = \"Consolidated\" Then\n        'do nothing\n    Else\n        For Each tbl In sht.ListObjects\n            Range(tbl.Name).Select\n            Selection.Copy\n            'do something with it\n        Next tbl\n    End If\nNext sht\n\nEnd Sub\n</code></pre>\n\n<p>When I run that code, at the line Range(tbl.Name).Select I get a runtime 1004 error.</p>\n\n<p>I thought that my issue was I couldn't select a range without first selecting the sheet, hence the line \"sht.Activate\".  Alas, no luck.  </p>\n\n<p>I then thought that maybe because tbl was a listobject, the type was wrong, so I tried using a temporary string variable and save the tbl.name to that first and use that in the range(tempvariable).select  Alas, no luck.</p>\n\n<p>I also tried just hard coding the name of the table: range(\"tablename\").select, but that didnt work either...</p>\n\n<p>I know its something simple but I am hung so can someone explain what I am missing?</p>\n"}, {"tags": ["arrays", "excel", "call", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1435711244, "creation_date": 1435711244, "answer_id": 31150810, "question_id": 31150598, "link": "https://stackoverflow.com/questions/31150598/passing-information-between-sub-in-vba/31150810#31150810", "title": "Passing information between sub in VBA", "body": "<p>The issue is that you've declared local variables in both procedures with the same <strong><em>name</em></strong> and are expecting them to be the same <strong><em>variable</em></strong>. For example, you use the variable <code>minVal</code> in <code>SampleStats</code>, but you never give it a value. The fact that you declared a separate variable with the same name in <code>ComputeStatistics</code> is irrelevant.  </p>\n\n<p>Combine your code into one procedure as it is one logical block anyway. Then you won't have to worry about passing values back and forth.</p>\n\n<p>Once you get that working if you still want to factor out the <code>ComputeStatistics</code> part, pass in all variables that you want to be updated (e.g. minVal, maxVal, rang, etc.) and don't declare them in the <code>ComputeStatistics</code> procedure.</p>\n"}], "owner": {"reputation": 7, "user_id": 4756717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206765628239871/picture?type=large", "display_name": "FCBHokie", "link": "https://stackoverflow.com/users/4756717/fcbhokie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 31150810, "answer_count": 1, "score": 0, "last_activity_date": 1435711244, "creation_date": 1435709657, "last_edit_date": 1531164843, "question_id": 31150598, "link": "https://stackoverflow.com/questions/31150598/passing-information-between-sub-in-vba", "title": "Passing information between sub in VBA", "body": "<p>I am trying to take an array from one sub to another so that it can be used for calculations. After the calculations are done I need to send them back to the the first sub. Here is my code and when I run it absolutely nothing happens. </p>\n\n<pre><code>Public Sub SampleStats()\nOption Explicit\n\nDim n As Integer        ' sample size\nDim x() As Double       ' array containing x values\nDim i As Integer        ' loop counter\nDim rang As Double\n\n' variables to hold output from computation subroutines\nDim minVal As Double        ' minimim value\nDim maxVal As Double        ' maximum value\nDim mean As Double          ' mean value\nDim var As Double           ' variance\nDim stdDev As Double        ' standard deviation\n\n' get sample size\nSheets(\"Q1_Stats\").Select\nRange(\"B8\").Select\nn = ActiveCell.Value\n\n' create an array\nReDim x(n - 1)            ' redimension x now that we know how many values we have\n\n' get x values\nRange(\"B11\").Select\nFor i = 0 To n - 1\n    x(i) = ActiveCell.Offset(i)\nNext i\n\n' Call subroutine to compute statistics\n ' *** put your call statemenAst below (with arguments)\nCall ComputeStatistics(x(), n)\n\n ' Call ComputeStatistics(ByVal ..., ByRef ..., ... )\n\n' now output results\nRange(\"F9\").Select\nActiveCell.Offset(0).Value = minVal\n\nRange(\"F10\").Select\nActiveCell.Offset(0).Value = maxVal\n\nRange(\"F11\").Select\nActiveCell.Offset(0).Value = rang\n\nRange(\"F12\").Select\nActiveCell.Offset(0).Value = mean\n\nRange(\"F13\").Select\nActiveCell.Offset(0).Value = var\n\nRange(\"F14\").Select\nActiveCell.Offset(0).Value = stdDev\n\nEnd Sub\n\nSub ComputeStatistics(x() As Double, n As Integer)\n\nDim rang As Double\nDim maxVal As Single\nDim i As Integer\nDim mean As Single\nDim minVal As Double\n\ni = 0\nmaxVal = x(0)\nFor i = 1 To UBound(x)\n    If maxVal &lt; x(i) Then\n         maxVal = x(i)\n    End If\nNext i\n\n'Computes mean average\ni = 0\nmean = x(0)\nFor i = 1 To UBound(x)\n    mean = mean + x(i)\nNext i\nmean = mean / n\n\n'Computes the lowest value\ni = 0\nminVal = x(0)\nFor i = 1 To UBound(x)\n    If minVal &gt; x(i) Then\n         minVal = x(i)\n    End If\nNext i\n\n'Calulates Range\nrang = maxVal - minVal\n\nend sub\n</code></pre>\n"}, {"tags": ["vba", "userform"], "answers": [{"tags": [], "owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "is_accepted": true, "score": 1, "last_activity_date": 1436544029, "creation_date": 1436544029, "answer_id": 31345329, "question_id": 31150451, "link": "https://stackoverflow.com/questions/31150451/vba-userform-is-not-responding-while-macro-is-running/31345329#31345329", "title": "VBA userform is &quot;Not Responding&quot; while macro is running", "body": "<p>It could be a number of things. If the issue is intermittent like you mention, then in all likelihood the program IS working, and Windows is just labeling it non-responsive because the program is working too hard to respond to the OS.</p>\n\n<p>The likely issue is probably one, or a combination, of the following:</p>\n\n<ul>\n<li>The amount of data being processed by <code>Insert_RawData</code></li>\n<li>The amount of data in the workbook(s) open when the macro is running</li>\n<li><code>Insert_RawData</code> is encountering an error due to a bad/unhandled value in one of the cells it works with (less likely)</li>\n</ul>\n\n<p>Some suggestions to try and narrow the source down:</p>\n\n<ul>\n<li>If there's a way to consistently run so that you get the \"Non-Responsive\" in the Excel window, insert a break point at the call  to <code>Insert_RawData</code> and watch it run to see if it's hitting an error\n\n<ul>\n<li>Alternatively, try to put some error checks into <code>Insert_RawData</code> and break points on the code handling the case that the error check fails</li>\n</ul></li>\n<li>Capture the amount of data processed (bytes, cells, whatever is easiest) during each run of the macro along with the run time &amp; see if there's a threshold your hitting (ex. &lt;= 1 GB runs fine, but >1GB and the application looks frozen)</li>\n</ul>\n\n<p>Unless you are hitting an error in <code>Insert_RawData</code> though, it's likely that the macro WILL complete, it just might take a really long time.</p>\n"}], "owner": {"reputation": 175, "user_id": 4772433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9472cd26845f7c8b43be8d0c1c00df42?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/4772433/mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 964, "favorite_count": 0, "accepted_answer_id": 31345329, "answer_count": 1, "score": 1, "last_activity_date": 1436544029, "creation_date": 1435708474, "question_id": 31150451, "link": "https://stackoverflow.com/questions/31150451/vba-userform-is-not-responding-while-macro-is-running", "title": "VBA userform is &quot;Not Responding&quot; while macro is running", "body": "<p>Why my userform shows \"Not Responding\" when I run the following code? I have been trying to resolve it, but it is not resolved yet. </p>\n\n<p>Actually it works sometimes. I think the problem has something to do with the screen updating. </p>\n\n<p><img src=\"https://i.stack.imgur.com/GlLpE.png\" alt=\"enter image description here\"></p>\n\n<pre><code>' The input button in Sheet1\nSub Rectangle1_Click()\n\n    'Remember time when macro starts\n    StartTime = Timer\n\n    ' To improve speed and performance\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n\n    ' Show the userform\n    UserForm1.Show vbModeless\n    UserForm1.Label1.Caption = \"Calculation in progress ... \" &amp; vbNewLine &amp; \"Please be patient\"\n    UserForm1.Label1.Font.Size = 12\n    UserForm1.Top = (Application.Height / 2) - (UserForm1.Height / 2)\n    UserForm1.Left = (Application.Width / 2) - (UserForm1.Width / 2)\n    UserForm1.CommandButton1.Visible = False\n    UserForm1.Repaint\n\n    Call Insert_RawData\n\n    'Determine how many seconds code took to run\n    SecondsElapsed = Round(Timer - StartTime, 2)\n    UserForm1.Label1.Caption = \"This code ran successfully in \" &amp; SecondsElapsed &amp; \" seconds\"\n    UserForm1.CommandButton1.Visible = True\n\n    ' Return back to the original settings\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationSemiautomatic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "tsql"], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 3005564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53941e4543e0c0daf2ec3b8e56361a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Chase", "link": "https://stackoverflow.com/users/3005564/chase"}, "edited": false, "score": 0, "creation_date": 1435725973, "post_id": 31149874, "comment_id": 50314988, "body": "Thanks for the input, Dasman, I&#39;ll take a look at the article you shared now."}], "tags": [], "owner": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "is_accepted": false, "score": 1, "last_activity_date": 1435704770, "creation_date": 1435704770, "answer_id": 31149874, "question_id": 31149521, "link": "https://stackoverflow.com/questions/31149521/which-is-better-practice-querying-server-via-vba-sql-command-text-or-vba-stored/31149874#31149874", "title": "Which is better practice? Querying Server via VBA/SQL Command Text or VBA/Stored Procedure?", "body": "<p>I personally prefer the second method due to its simplicity.</p>\n\n<p>The issue here is mainly defense against SQL Injection Attacks. In both solutions you are using String parameters. An user could enter \"= 1; Drop YourTable;\"</p>\n\n<p>Im not too privy with VBA but I know in Java has \"Prepared Statement\" command which takes care of this. You should do some research on this for VBA SQL.</p>\n\n<p>Here is a good article on it. <a href=\"http://bytes.com/topic/access/insights/864109-sql-injection-attack\" rel=\"nofollow\">http://bytes.com/topic/access/insights/864109-sql-injection-attack</a></p>\n"}], "owner": {"reputation": 449, "user_id": 3005564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53941e4543e0c0daf2ec3b8e56361a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Chase", "link": "https://stackoverflow.com/users/3005564/chase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1435848543, "creation_date": 1435702670, "last_edit_date": 1435848543, "question_id": 31149521, "link": "https://stackoverflow.com/questions/31149521/which-is-better-practice-querying-server-via-vba-sql-command-text-or-vba-stored", "title": "Which is better practice? Querying Server via VBA/SQL Command Text or VBA/Stored Procedure?", "body": "<p>We need to query data from SQL Server using an OLEDB connection from an Excel workbook. We have discovered that there are 2 ways to do this. In terms of security, maintenance, performance, daily use, end-user use, etc., do you think one has an overall advantage over the other?</p>\n\n<ol>\n<li><p>VBA script to string parameters to define the SQL command text via Connections in Excel:</p>\n\n<pre><code>Sub ParamPass()\n    Dim qPreText As String\n    Dim qPostText As String\n    Dim valueToFilter As String\n    Dim paramPosition As Integer\n    valueToFilter = \"TableName.ColumnName =\"\n\nWith\n    ActiveWorkbook.Connections(\"ConnectionName\").OLEDBConnection\n    qPreText = .CommandText\n    paramPosition = InStr(qPreText, valueToFilter) + Len(valueToFilter)-1\n    qPreText = Left(qPreText, paramPosition)\n    qPostText = .CommandText\n    qPostText = Right(qPostText, Len(qPostText) - paramPosition)\n    qPostText = Right(qPostText, Len(qPostText) - InStr(qPostText, \")\") + 1)\n    .CommandText = qPreText &amp; \" '\" &amp; Sheets(\"SheetName\").Range(\"CellReference\").Value &amp; \"'\" &amp; qPostText\nEnd With\n\nActiveWorkbook.Connections(\"ConnectionName\").Refresh\n\nEnd Sub\n</code></pre></li>\n<li><p>VBA script to call and pass parameters to a stored procedure in the database:</p>\n\n<pre><code>Sub ParamPass()\n    Dim MyValueToPass As String\n    MyValueToPass = Sheets(\"SheetName\").Range(\"CellReference\").Value\n\nWith\n    ActiveWorkbook.Connections(\"ConnectionName\").OLEDBConnection\n    .CommandText = \"exec dbo.StoredProcName '\" &amp; MyValueToPass &amp; \"'\"\n    ActiveWorkbook.Connections(\"ConnectionName\").Refresh\nEnd With\n\nEnd Sub\n</code></pre></li>\n</ol>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1435705778, "post_id": 31149415, "comment_id": 50310187, "body": "<code>Worksheets(&quot;1&quot;)</code> means a worksheet called &quot;1&quot; rather than the first worksheet in the book. Are the relevant worksheets in the source and target workbooks actually called &quot;1&quot;? If not, try <code>Worksheets(1)</code>"}, {"owner": {"reputation": 13, "user_id": 5067197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d6ac74f70b990856a741aac14cbdbf1?s=128&d=identicon&r=PG&f=1", "display_name": "Jenga", "link": "https://stackoverflow.com/users/5067197/jenga"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1435709087, "post_id": 31149415, "comment_id": 50311102, "body": "Yes, the worksheets are both called &quot;1&quot;"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1435710322, "post_id": 31149415, "comment_id": 50311426, "body": "&quot;<i>... however no values were transferred to the target workbook. ...</i>&quot;. That&#39;s because you are copying <i>from</i> <code>TgtWB</code> <i>to</i> <code>SrcWB</code>"}, {"owner": {"reputation": 13, "user_id": 5067197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d6ac74f70b990856a741aac14cbdbf1?s=128&d=identicon&r=PG&f=1", "display_name": "Jenga", "link": "https://stackoverflow.com/users/5067197/jenga"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1435757472, "post_id": 31149415, "comment_id": 50334016, "body": "@chris neilsen I tried <code>TrgWB.Worksheets(&quot;1&quot;).Range(&quot;A1:K35&quot;).Value = ScrWB.Sheets(&quot;1&quot;).Range(&quot;A1:K35&quot;).Value</code> and that worked perfectly"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5067197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d6ac74f70b990856a741aac14cbdbf1?s=128&d=identicon&r=PG&f=1", "display_name": "Jenga", "link": "https://stackoverflow.com/users/5067197/jenga"}, "edited": false, "score": 0, "creation_date": 1435756682, "post_id": 31156385, "comment_id": 50333409, "body": "I tried adding &quot;Option Explicit&quot; earlier in researching the answer.  It then throws &quot;Complier error: Variable not defined&quot; for FileToOpen. I tried to comment out the FileToOpen to get past it, but since its embedded in the SrcWB variable I wasn&#39;t able to figure out if any other complier errors were in the code."}, {"owner": {"reputation": 71, "user_id": 4978968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0390669cc328b1660a217d42cd0d5f65?s=128&d=identicon&r=PG&f=1", "display_name": "noas", "link": "https://stackoverflow.com/users/4978968/noas"}, "reply_to_user": {"reputation": 13, "user_id": 5067197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d6ac74f70b990856a741aac14cbdbf1?s=128&d=identicon&r=PG&f=1", "display_name": "Jenga", "link": "https://stackoverflow.com/users/5067197/jenga"}, "edited": false, "score": 0, "creation_date": 1435835252, "post_id": 31156385, "comment_id": 50371166, "body": "added additional info"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 13, "user_id": 5067197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d6ac74f70b990856a741aac14cbdbf1?s=128&d=identicon&r=PG&f=1", "display_name": "Jenga", "link": "https://stackoverflow.com/users/5067197/jenga"}, "edited": false, "score": 0, "creation_date": 1481081132, "post_id": 31156385, "comment_id": 69225760, "body": "@Jenga &quot;Compiler error: Variable not defined&quot; is exactly the point of <code>Option Explicit</code> - it forces you to declare ALL variables, so that the code won&#39;t compile if you make a typo somewhere."}], "tags": [], "owner": {"reputation": 71, "user_id": 4978968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0390669cc328b1660a217d42cd0d5f65?s=128&d=identicon&r=PG&f=1", "display_name": "noas", "link": "https://stackoverflow.com/users/4978968/noas"}, "is_accepted": true, "score": 0, "last_activity_date": 1435780295, "last_edit_date": 1435780295, "creation_date": 1435739741, "answer_id": 31156385, "question_id": 31149415, "link": "https://stackoverflow.com/questions/31149415/excel-vba-pastespecial-method-of-range-class-failed/31156385#31156385", "title": "Excel- VBA PasteSpecial Method of Range Class Failed", "body": "<p>Goto the top of your module and add \"Option Explicit\".</p>\n\n<pre><code>Option Explicit\n\nSub CopySch()\n\nDim sh As Worksheet\nDim TgtWB As Workbook\nDim SrcWB As Workbook\n...\n</code></pre>\n\n<p>It should solve your problem.</p>\n\n<p>EDIT:\nlets give another try with this code. i have tried the code it Works without error.</p>\n\n<pre><code>Option Explicit\nSub CopySch()\n\nDim sh As Worksheet\nDim TgtWB As Workbook\nDim SrcWB As Workbook\nDim FileToOpen As String\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nSet TgtWB = ThisWorkbook\n\nFileToOpen = Application.GetOpenFilename(FILEFILTER:=\"Excel Workbooks (*.xls*),*.xls*\", Title:=\"Please select a file\")\n\nIf FileToOpen = \"False\" Then\n    MsgBox \"No File Specified.\", vbExclamation, \"ERROR\"\n    Exit Sub\n\nElse\n    Set SrcWB = Workbooks.Open(FileToOpen, xlUpdateLinksNever, ReadOnly:=True)\n\n    SrcWB.Worksheets(\"1\").Range(\"A1:K35\").Copy\n    TgtWB.Sheets(\"1\").Range(\"A1:K35\").PasteSpecial (xlPasteValues)\n    TgtWB.Sheets(\"1\").Range(\"A1:K35\").PasteSpecial (xlPasteFormats)\n\nEnd If\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nSrcWB.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5067197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d6ac74f70b990856a741aac14cbdbf1?s=128&d=identicon&r=PG&f=1", "display_name": "Jenga", "link": "https://stackoverflow.com/users/5067197/jenga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2712, "favorite_count": 0, "accepted_answer_id": 31156385, "answer_count": 1, "score": 1, "last_activity_date": 1435780295, "creation_date": 1435702201, "question_id": 31149415, "link": "https://stackoverflow.com/questions/31149415/excel-vba-pastespecial-method-of-range-class-failed", "title": "Excel- VBA PasteSpecial Method of Range Class Failed", "body": "<p>Excel macro is intended to copy a range from one workbook to another using FileToOpen.  The same code worked earlier today in separate workbook. </p>\n\n<p>Error generated is Runtime 1004' PasteSpecial Method of class failed. Here's the section that fails: </p>\n\n<pre><code>    SrcWB.Worksheets(\"1\").Range(\"A1:K35\").Copy\n    TgtWB.Sheets(\"1\").Range(\"A1:K35\").PasteSpecial (xlPasteValues)\n    TgtWB.Sheets(\"1\").Range(\"A1:K35\").PasteSpecial (xlPasteFormats)\n</code></pre>\n\n<p>Error gets caught on both PasteSpecial Values and Formats.  I also tried to using: </p>\n\n<pre><code>   SrcWB.Worksheets(\"1\").Range(\"A1:K35\").Value = TgtWB.Sheets(\"1\").Range(\"A1:K35\")\n</code></pre>\n\n<p>Above method didn't create any errors, however no values were transferred to the target workbook.  </p>\n\n<p>I've chewed on this most of this afternoon and would appreciate any help! </p>\n\n<p>Here's the full code:</p>\n\n<pre><code>Sub CopySch()\n\nDim sh As Worksheet\nDim TgtWB As Workbook\nDim SrcWB As Workbook\n\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nSet TgtWB = ThisWorkbook\n\nFileToOpen = Application.GetOpenFilename(FILEFILTER:=\"Excel Workbooks (*.xls*),*.xls*\", Title:=\"Please select a file\")\n\nIf FileToOpen = False Then\n    MsgBox \"No File Specified.\", vbExclamation, \"ERROR\"\n    Exit Sub\n\nElse\n    Set SrcWB = Workbooks.Open(FileToOpen, xlUpdateLinksNever, ReadOnly:=True)\n\n\n    SrcWB.Worksheets(\"1\").Range(\"A1:K35\").Copy\n    TgtWB.Sheets(\"1\").Range(\"A1:K35\").PasteSpecial (xlPasteValues)\n    TgtWB.Sheets(\"1\").Range(\"A1:K35\").PasteSpecial (xlPasteFormats)\n\nEnd If\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nSrcWB.Close\n\nEnd Sub\n</code></pre>\n\n<p>\uf729</p>\n"}, {"tags": ["vba", "excel", "multidimensional-array"], "comments": [{"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1435705493, "post_id": 31149299, "comment_id": 50310088, "body": "Is your  code running now and populating Differences correctly? Cause it seems it would break at Dim col As Long, I believe this should be at the top and not in the For loop. If it is not working please explain which part it fails at"}, {"owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "reply_to_user": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1435705855, "post_id": 31149299, "comment_id": 50310215, "body": "@HolmesIV the code is running fine as long as I list all the columns in the array, i am trying to get to the final sheet as i have attached in the above. Currently i am just listing the amount of coloured cells per column"}], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1435729050, "post_id": 31150173, "comment_id": 50315958, "body": "I am struggling with using multi dimensional arrays as I am only new to vb and simple arrays! If you could provide any more help it would be appreciated!"}], "tags": [], "owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "is_accepted": false, "score": 0, "last_activity_date": 1435766907, "last_edit_date": 1435766907, "creation_date": 1435706695, "answer_id": 31150173, "question_id": 31149299, "link": "https://stackoverflow.com/questions/31149299/using-an-array-to-count-coloured-cells/31150173#31150173", "title": "Using an array to count coloured cells", "body": "<p>It seems it would be a lot easier to use a multi dimensional array, so you would have Array(4,7) so some sudo code might look like. I could do real code, but you seem to know what your doing. </p>\n\n<pre><code>Select Case mycell.row\n   Case 1 \n      Array(1,Col) = Array(1,Col) + 1\n   Case 2 \n      Array(1,Col) = Array(1,Col) + 1\n   Case 3\n      Array(2,Col) = Array(2,Col) + 1\nend select\n</code></pre>\n\n<p>The trick to a multi dimensional array is to think of it like a spread sheet, (2,2) = 3 rows, by 3 columns ... (3 because arrays start at 0)  The beauty of it is, if you do it this way when it comes to extract the data you simply put a double loop </p>\n\n<pre><code>For I =0 to Ubound(Array)\n     For II = 0 to Ubound(Array,2)\n          Cell(I,II).Value = Array(I,II)\n     next\nnext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "is_accepted": false, "score": 0, "last_activity_date": 1435758494, "creation_date": 1435758494, "answer_id": 31163223, "question_id": 31149299, "link": "https://stackoverflow.com/questions/31149299/using-an-array-to-count-coloured-cells/31163223#31163223", "title": "Using an array to count coloured cells", "body": "<p>For anyone looking for an answer to this, a rather long method. However, I applied a filter and then set the range to only the visible cells instead of the used range in the whole worksheet</p>\n"}], "owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1435766907, "creation_date": 1435701659, "last_edit_date": 1435748510, "question_id": 31149299, "link": "https://stackoverflow.com/questions/31149299/using-an-array-to-count-coloured-cells", "title": "Using an array to count coloured cells", "body": "<p>Currently I have a worksheet which has different colored cells in it like the one below:</p>\n\n<p>[currentsheet] <a href=\"http://imgur.com/na6nvNH\" rel=\"nofollow\">http://imgur.com/na6nvNH</a></p>\n\n<p>I am using an array to count the colored cells per column. Here is my a snippet of my code:</p>\n\n<pre><code>Dim difference(0 To 41) As Long\nFor Each mycell In ActiveWorkbook.Worksheets(\"Differences\").UsedRange\nDim col As Long\ncol = mycell.Column\n If ActiveWorkbook.Worksheets(\"Differences\").Cells(mycell.Row,mycell.Column).Interior.Color = vbRed Then\ndifference(col) = difference(col) + 1\nEnd If\nNext mycell\n\nSheets(\"Summary\").Cells(47, 3) = difference(0)\nSheets(\"Summary\").Cells(48, 3) = difference(1)\nSheets(\"Summary\").Cells(49, 3) = difference(2)\netc.\n</code></pre>\n\n<p>Which will list the amount of colored cells I have per column. I need help breaking this down so I can create a table which shows the number of colored cells per department. I have no idea on how to do this!</p>\n\n<p>To make it easier to view I am looking to create this:</p>\n\n<p>[FinalSheet] <a href=\"http://imgur.com/i6W60m7\" rel=\"nofollow\">http://imgur.com/i6W60m7</a></p>\n\n<p>I should add: the amount of rows within the sheet can vary, they can also vary per department</p>\n\n<p>Tried applying a column filter beginning with the first department and then counting the colored cells once the filter was applied, however since I am looking at every cell in the code above the result is still per column.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1435724688, "post_id": 31148521, "comment_id": 50314592, "body": "If you were doing this manually how would you locate the values to be copied?  Right now it&#39;s difficult to make any real suggestions."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1435731079, "post_id": 31148521, "comment_id": 50316770, "body": "If the location of the 2 items is inconsistent on the sheets, the code will need a consistent and reliable way to identify them (column header &amp; item name, or item ID, etc)"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1435748880, "post_id": 31148521, "comment_id": 50327700, "body": "<code>DataColumn = ws.Range(&quot;B1:F1&quot;).Find(What:=&quot;YourString&quot;, LookAt:=xlWhole).Column      wsSummary.Cells(InputRow,InputColumn) = ws.Cells(ExportRow, DataColumn)</code>"}], "owner": {"reputation": 1, "user_id": 5067110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19b1597b12a2e69c277decefd304a7f7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collier", "link": "https://stackoverflow.com/users/5067110/david-collier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435698441, "creation_date": 1435698441, "last_edit_date": 1531164843, "question_id": 31148521, "link": "https://stackoverflow.com/questions/31148521/vba-consolidation-for-worksheets-with-different-formatting", "title": "VBA Consolidation for worksheets with different formatting", "body": "<p>I need to write a VBA code that will consolidate 50 sheets in a separate excel workbook. What is causing me trouble is that the sheets have different formatting. I only need 2 items from each sheet but they can be located in different columns, and I want them copied to the same column on the new worksheet.</p>\n\n<p>So for example, the second item I want consolidated can be located between columns B and F. </p>\n\n<p>Any help is appreciated. </p>\n"}, {"tags": ["vba", "button", "textbox", "onclick"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1435700309, "post_id": 31148504, "comment_id": 50308152, "body": "Why don&#39;t you just use a spin button instead? <a href=\"http://stackoverflow.com/questions/11116808/numeric-up-down-control-in-vba\" title=\"numeric up down control in vba\">stackoverflow.com/questions/11116808/&hellip;</a>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1435700415, "post_id": 31148504, "comment_id": 50308200, "body": "Also, <code>Null</code> and <code>IsNotNull</code> don&#39;t exist in VBA, try <code>vbNullString</code> and the <code>&lt;&gt;</code> (not equal) operator."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5067100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78582ad935fbb45a1e4d10b87522bd82?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny", "link": "https://stackoverflow.com/users/5067100/jonny"}, "is_accepted": false, "score": 0, "last_activity_date": 1435704149, "creation_date": 1435704149, "answer_id": 31149783, "question_id": 31148504, "link": "https://stackoverflow.com/questions/31148504/update-text-box-with-each-click-of-a-button/31149783#31149783", "title": "Update text box with each click of a button", "body": "<p>Well, that makes a difference.  I looked at something somewhere that told me to use Null, IsNotNull.  I was able to get it working with the following which at the moment does not make sense to me I will have to figure out why it works this way.  I guess there is some background action happening that is letting me do math with stings</p>\n\n<p>Private Sub CommandButton1_Click()</p>\n\n<p>If (TextBox1.Value = vbNullString) Then</p>\n\n<p>TextBox1.Value = 1\nElse</p>\n\n<p>TextBox1.Value = TextBox1.Value + 1\nEnd If</p>\n\n<p>End Sub\n\u200b</p>\n"}], "owner": {"reputation": 11, "user_id": 5067100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78582ad935fbb45a1e4d10b87522bd82?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny", "link": "https://stackoverflow.com/users/5067100/jonny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2841, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1435704149, "creation_date": 1435698379, "last_edit_date": 1435700163, "question_id": 31148504, "link": "https://stackoverflow.com/questions/31148504/update-text-box-with-each-click-of-a-button", "title": "Update text box with each click of a button", "body": "<p>I am trying to set up a userform that will be used to take orders. e.g. each time you click the Cappuccino button it will increment the text box by one indicating that you are ordering 1, 2, 3 etc.</p>\n\n<p>As far as I can get it is to only populate the text box one time. Each additional click does not appear to do anything.  This is the Code I currently have for it. I tried declaring <code>num</code> as public. I thought that might be part of the problem but it did not seem to make a difference.  Could it be a type casting issue since it is a \"text\" box and I am trying to treat it as in integer?</p>\n\n<pre><code>Private Sub Capuccino_Click()\n\n   If (Cap_qty.Value = Null) Then\n    Dim num As Integer\n    num = 1\n    Cap_qty.Value = Cap_qty.Value + num\n    ElseIf (Cap_qty.Value = IsNotNull) Then\n        num = num + 1\n        Cap_qty.Value = num\n        'Cap_qty.Value = num + 1\n        'num = Cap_qty.Value\n\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 0, "creation_date": 1435698557, "post_id": 31148370, "comment_id": 50307361, "body": "On a side note, you should <a href=\"http://stackoverflow.com/q/10714251/4002530\">avoid using <code>select</code> commands</a>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1435699005, "post_id": 31148370, "comment_id": 50307580, "body": "&quot;(I know it&#39;s slow and a lot of it is irrelevant, but I just need to make it work)&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1435698722, "post_id": 31148501, "comment_id": 50307443, "body": "@S O after I move onto a different workbook, say RFQ_14447, won&#39;t I have to go in and manually change the code to reference the new workbook I&#39;m using?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1435698905, "post_id": 31148501, "comment_id": 50307528, "body": "Sorry, got it the wrong way around - thought that was the static one. Edited code above ^^^ does this answer your question?"}, {"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1435699182, "post_id": 31148501, "comment_id": 50307670, "body": "So this will prompt me to enter the name of the workbook into the message box?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1435700129, "post_id": 31148501, "comment_id": 50308080, "body": "No, that&#39;s just an example of how the <code>ThisWorkbook</code> object works. If you want to enter the name of a workbook use something like <code>workbookName$ = InputBox(&quot;name of workbook&quot;)</code>"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1435700066, "last_edit_date": 1435700066, "creation_date": 1435698359, "answer_id": 31148501, "question_id": 31148370, "link": "https://stackoverflow.com/questions/31148370/how-do-i-access-a-specific-workbook-that-i-have-open-without-using-its-name/31148501#31148501", "title": "How do I access a specific workbook that I have open, without using its name?", "body": "<p>Easiest way is to set references to each workbook at the start of your code:</p>\n\n<pre><code>Sub SO()\n\nDim thisWorkbook  As Excel.Workbook\nDim otherWorkbook As Excel.Workbook\n\nSet thisWorkbook = ActiveWorkbook\nSet otherWorkbook = Workbooks(\"Transfer Template.xlsm\")\n\n'// ... Rest of code here\n\nEnd Sub\n</code></pre>\n\n<p>Once this is done you can refer to that variable instead, for example:  </p>\n\n<pre><code>Debug.Print thisWorkbook.Sheets.Count  \n</code></pre>\n\n<p>or</p>\n\n<pre><code>otherWorkbook.Sheets(1).Range(\"A1\").Value = thisWorkbook.Sheets(2).Range(\"B1\").Value\n</code></pre>\n\n<p>Just crude examples but should give you the base of the logic...  </p>\n\n<hr>\n\n<p>Another thing worth noting is that if the code is being run from the workbook that you want to refer to, then simply using <code>ThisWorkbook</code> will suffice:</p>\n\n<pre><code>Sub Example()\n\nWorkbooks(\"Transfer Template.xlsm\").Activate\nMsgBox ActiveWorkbook.Name\nMsgBox ThisWorkbook.Name\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "is_accepted": false, "score": 0, "last_activity_date": 1435698620, "creation_date": 1435698620, "answer_id": 31148559, "question_id": 31148370, "link": "https://stackoverflow.com/questions/31148370/how-do-i-access-a-specific-workbook-that-i-have-open-without-using-its-name/31148559#31148559", "title": "How do I access a specific workbook that I have open, without using its name?", "body": "<p>If you don't know the workbook name but it is the only other one open at the same time (in the same instance of Excel), you can loop through them like this:</p>\n\n<pre><code>Sub TransferTemplate()\n    Dim wbTemplate As Workbook: Set wbTemplate = ActiveWorkbook\n    Dim wbDestination As Workbook\n\n    Dim wb As Workbook\n    For Each wb In Workbooks\n        If wb.Name &lt;&gt; wbTemplate.Name Then\n            Set wbDestination = wb\n        End If\n    Next wb\n\n    'Example copy\n    wbTemplate.Worksheets(1).Range(\"B1\").Value = wbDestination.Worksheets(1).Range(\"J51\").Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "accepted_answer_id": 31148501, "answer_count": 2, "score": 2, "last_activity_date": 1435700690, "creation_date": 1435697840, "last_edit_date": 1435700690, "question_id": 31148370, "link": "https://stackoverflow.com/questions/31148370/how-do-i-access-a-specific-workbook-that-i-have-open-without-using-its-name", "title": "How do I access a specific workbook that I have open, without using its name?", "body": "<p>I'm recording this macro that transfers data between a few different documents. One of the workbooks, \"Transfer Template\", stays constant. But the other will change. Here is the code that I am using. (I know it's slow and a lot of it is irrelevant, but I just need to make it work).</p>\n\n<p>What I'm assuming is that I have to replace 'Windows(\"RFQ_14446.xlsm\") with ActiveWorkbook or something similar.</p>\n\n<pre><code>Sub Initial_Transfer_Macro()\n'\n' Initial_Transfer_Macro Macro\n'\n\n'\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"J51\").Select\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B1\").Select\nActiveSheet.Paste\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"D27\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B2\").Select\nActiveSheet.Paste\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"D5\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B3\").Select\nActiveSheet.Paste\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"F2\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B4\").Select\nActiveSheet.Paste\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"D7\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B5\").Select\nActiveSheet.Paste\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"D18\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B6\").Select\nActiveSheet.Paste\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"K6\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B7\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"D12\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B8\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"D22\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B9\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"D11\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B10\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"K18\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B11\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"K3\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B12\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"I13\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B14\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"I26\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"C14\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"I27\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B17\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"I5\").Select\nApplication.CutCopyMode = False\nActiveCell.FormulaR1C1 = \"36\"\nRange(\"I5\").Select\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B20\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nWindows(\"RFQ_14446.xlsm\").Activate\nRange(\"I26\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"C20\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(\"A1\").Select\nCells.Replace What:=\" Rev. \", Replacement:=\"-\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nCells.Replace What:=\"RFQ \", Replacement:=\"\", LookAt:=xlPart, SearchOrder _\n    :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5062874, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ada89a1f42c9442ebe479b43e8eb6720?s=128&d=identicon&r=PG&f=1", "display_name": "Darrian Sheffield", "link": "https://stackoverflow.com/users/5062874/darrian-sheffield"}, "is_accepted": false, "score": 0, "last_activity_date": 1435697828, "last_edit_date": 1435697828, "creation_date": 1435697218, "answer_id": 31148207, "question_id": 31148125, "link": "https://stackoverflow.com/questions/31148125/excel-vba-compare-column-a-to-column-b/31148207#31148207", "title": "Excel VBA Compare column A to Column B", "body": "<p>I've been using this for that kind of function, found in a previous SO thread.  It's not a VBS answer, but might be an easier way to accomplish your goal.</p>\n\n<pre><code>=IF(ISNA(VLOOKUP(&lt;single column I value&gt;,&lt;entire column E range&gt;,1,FALSE)),FALSE, TRUE)\n</code></pre>\n\n<p>-or-</p>\n\n<pre><code>=IF(ISNA(VLOOKUP(&lt;single column I value&gt;,&lt;entire column E range&gt;,1,FALSE)),\"FALSE\", \"File found in row \"   &amp; MATCH(&lt;single column I value&gt;,&lt;entire column E range&gt;,0))\n</code></pre>\n\n<p>You could replace  and  with named ranged. That'd probably be the easiest.</p>\n\n<p>Just drag that formula all the way down the length of your I column in whatever column you want.</p>\n"}, {"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1435697950, "creation_date": 1435697950, "answer_id": 31148399, "question_id": 31148125, "link": "https://stackoverflow.com/questions/31148125/excel-vba-compare-column-a-to-column-b/31148399#31148399", "title": "Excel VBA Compare column A to Column B", "body": "<p><code>Search</code> is not a function in VBA. Unless you have a UDF with that name, the code will throw an error. </p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5067036, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RWuGUQZqTqA/AAAAAAAAAAI/AAAAAAAAACo/XnN6-2dX3YM/photo.jpg?sz=128", "display_name": "Preston McInelly", "link": "https://stackoverflow.com/users/5067036/preston-mcinelly"}, "edited": false, "score": 0, "creation_date": 1435839715, "post_id": 31148605, "comment_id": 50374278, "body": "Sweet! Thanks for the responses!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 11, "user_id": 5067036, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RWuGUQZqTqA/AAAAAAAAAAI/AAAAAAAAACo/XnN6-2dX3YM/photo.jpg?sz=128", "display_name": "Preston McInelly", "link": "https://stackoverflow.com/users/5067036/preston-mcinelly"}, "edited": false, "score": 0, "creation_date": 1435840126, "post_id": 31148605, "comment_id": 50374558, "body": "Did any of them work for you? If so don&#39;t forget to mark is as the answer"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1435698761, "creation_date": 1435698761, "answer_id": 31148605, "question_id": 31148125, "link": "https://stackoverflow.com/questions/31148125/excel-vba-compare-column-a-to-column-b/31148605#31148605", "title": "Excel VBA Compare column A to Column B", "body": "<p>Replace  </p>\n\n<pre><code>Is_Copy = IsNumber(Search(Cells(Row_A, 1), Cells(Row_B, 2), 1))\n</code></pre>\n\n<p>with something like  </p>\n\n<pre><code>Is_Copy = InStr(Cells(Row_A, 1), Cells(Row_b, 2)) &gt; 0\n</code></pre>\n\n<p><code>IsNumber</code> and <code>Search</code> are not VBA methods, they are worksheet functions.</p>\n"}, {"tags": [], "owner": {"reputation": 184, "user_id": 4847664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d668097907d35b74564ed0365cf1b1f3?s=128&d=identicon&r=PG&f=1", "display_name": "Annette", "link": "https://stackoverflow.com/users/4847664/annette"}, "is_accepted": false, "score": 0, "last_activity_date": 1435764150, "creation_date": 1435764150, "answer_id": 31165477, "question_id": 31148125, "link": "https://stackoverflow.com/questions/31148125/excel-vba-compare-column-a-to-column-b/31165477#31165477", "title": "Excel VBA Compare column A to Column B", "body": "<p>as pointed above search is not a vb method or function. the best way to compare in a excel will be using the VLOOKUP excel function which dont need to write any vba script also.</p>\n"}], "owner": {"reputation": 11, "user_id": 5067036, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RWuGUQZqTqA/AAAAAAAAAAI/AAAAAAAAACo/XnN6-2dX3YM/photo.jpg?sz=128", "display_name": "Preston McInelly", "link": "https://stackoverflow.com/users/5067036/preston-mcinelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1435764150, "creation_date": 1435696854, "last_edit_date": 1435701351, "question_id": 31148125, "link": "https://stackoverflow.com/questions/31148125/excel-vba-compare-column-a-to-column-b", "title": "Excel VBA Compare column A to Column B", "body": "<p>I'm trying to run this code here:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim Row_A As Integer, Row_B As Integer, Is_Copy As Boolean\n    Is_Copy = False\n\n    For Row_A = 1 To 850\n        For Row_B = 1 To 10840\n            Is_Copy = IsNumber(Search(Cells(Row_A, 1), Cells(Row_B, 2), 1))\n            If Is_Copy Then Cells(Row_B, 2).Interior.Color = RGB(255, 0, 0)\n            If Is_Copy Then Cells(Row_B, 3).Value = Is_Copy\n            If Is_Copy Then Cells(Row_B, 4).Value = Row_A\n            If Is_Copy Then Cells(Row_B, 5).Value = Row_B\n\n\n            Is_Copy = False\n        Next Row_B\n    Next Row_A\nEnd Sub\n</code></pre>\n\n<p>But i get a popup saying:</p>\n\n<blockquote>\n  <p>\"Compile error: Sub or Function not defined\"</p>\n</blockquote>\n\n<p>It then highlights Line 1 and the Search in Line 7.</p>\n\n<p>What do I need to do to fix this?</p>\n\n<p>The issue I am trying to fix:\nI have two UID lists normally I would just compare the two of them, but Column b has 3 extra chars on the end so im using search to check to see if Column b Contains Column A.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1435696708, "post_id": 31147953, "comment_id": 50306414, "body": "This line of code <code>Workbooks(&quot;C:\\user\\docs\\BOOK1.XLS&quot;).Close SaveChanges:=true</code> is the answer to your question, so I&#39;m not really sure what you&#39;re asking..."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1435698134, "post_id": 31147953, "comment_id": 50307144, "body": "What happened when you tried it? Did it work or not?"}, {"owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1435700942, "post_id": 31147953, "comment_id": 50308405, "body": "@FreeMan I&#39;m trying to use arrays in the vba e.g Workbooks(i).Close SaveChanges:=true this doesnt seem to work"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1435709998, "post_id": 31147953, "comment_id": 50311340, "body": "Try <code>Workbooks.Close SaveChanges:=True</code>"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1435724303, "post_id": 31147953, "comment_id": 50314484, "body": "How about showing the full code of what you&#39;ve written instead of 3 random lines. Include the definition of your array, where you populate it, what you&#39;re attempting to do to save the files, what error you&#39;re getting and what line it&#39;s occurring on. That may help with the diagnosis."}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 11, "last_activity_date": 1435730461, "creation_date": 1435730461, "answer_id": 31153591, "question_id": 31147953, "link": "https://stackoverflow.com/questions/31147953/excel-close-save-using-full-path-name/31153591#31153591", "title": "Excel - Close/Save using full path name", "body": "<p>The Workbook object can be used like in your first statement</p>\n\n<pre><code>Workbooks(\"BOOK1.XLS\").Close\n</code></pre>\n\n<p>because it uses the .Name property (without full path)</p>\n\n<p>The <code>Workbooks.Open</code> method on the other hand, takes as parameter the full path and file name:</p>\n\n<pre><code>Workbooks.Open \"C:\\user\\docs\\BOOK1.XLS\"\n</code></pre>\n\n<p>It can take the file name without a path as well, but it will search for it in the default folder</p>\n\n<p>.</p>\n\n<p>There are 2 options I use to solve similar problems, where all strings include full path and file name:</p>\n\n<ol>\n<li><p>set a reference to the workbook when you open it:</p>\n\n<p><code>Set wb = Workbooks.Open(\"C:\\user\\docs\\BOOK1.XLS\")</code></p>\n\n<ul>\n<li><p>then you can close it like this</p>\n\n<p><strong><code>wb.Close SaveChanges:=True</code></strong></p></li>\n</ul></li>\n<li><p>Extract the file name from the string containing both, path and file name:</p>\n\n<p><code>wbName = Mid(fullName, InStrRev(fullName, \"\\\") + 1)</code></p>\n\n<ul>\n<li><p>then you can close it as in your first line:</p>\n\n<p><strong><code>Workbooks(wbName).Close SaveChanges:=true</code></strong></p></li>\n</ul></li>\n</ol>\n"}], "owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23617, "favorite_count": 2, "accepted_answer_id": 31153591, "answer_count": 1, "score": 4, "last_activity_date": 1435730461, "creation_date": 1435696231, "question_id": 31147953, "link": "https://stackoverflow.com/questions/31147953/excel-close-save-using-full-path-name", "title": "Excel - Close/Save using full path name", "body": "<p>Is there a way of inserting the full pathname instead of the filename when closing and saving a workbook</p>\n\n<p>E.g below</p>\n\n<pre><code>Workbooks(\"BOOK1.XLS\").Close SaveChanges:=true\nWorkbooks(\"C:\\user\\docs\\BOOK1.XLS\").Close SaveChanges:=true\n</code></pre>\n\n<p>Reason why I ask is that I've already named all my full pathnames in strings </p>\n\n<pre><code>Workbooks(i).Close SaveChanges:=true\n</code></pre>\n\n<p>So for each i in array etc</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 0, "last_activity_date": 1435699016, "creation_date": 1435699016, "answer_id": 31148668, "question_id": 31147736, "link": "https://stackoverflow.com/questions/31147736/how-to-copy-rows-of-data-from-multiple-workbooks-based-on-an-variable-criteria/31148668#31148668", "title": "How to copy rows of data from multiple workbooks based on an variable criteria, then paste into a master workbook", "body": "<p>NOT tested. The For Loop is mostly what you're looking for.</p>\n\n<pre><code>Sub copyDataFromMultipleWorkbooksIntoMaster()\n\nDim FolderPath As String, Filepath As String, Filename As String\n\nFolderPath = \"C:\\Users\\25dbrown\\Desktop\\Prototypes\\\"\nFilepath = FolderPath &amp; \"*.xlsx*\"\nFilename = Dir(Filepath)\n\nDim week As Long\nDim tag As Long\nDim lastrow As Long\nDim sourcewb As Workbook\nDim ws2015 As Worksheet\n\nweek = InputBox(\"Which week?\")\nSet ws2015 = ThisWorkbook.Worksheets(\"2015\")\n\nDo While Filename &lt;&gt; \"\"\n\nerow = ws2015.Cells(Rows.Count, 1).End(xlUp).Row\n\nSet sourcewb = Workbooks.Open(FolderPath &amp; Filename)\nlastrow = sourcewb.ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row   'suggest changing activesheet to worksheet(\"name\")\n\n'loop through column T for the specified week\nFor i = 1 To lastrow\n    If sourcewb.ActiveSheet.Cells(i, 20).Value = week Then  'suggest changing activesheet to worksheet(\"name\")\n    'upon match store that row to a variable for copying\n    tag = i\n    Exit For\n    End If\nNext\n\nsourcewb.Worksheets(1).Rows(tag).Copy   'suggest changing worksheet to worksheet(\"name\")\nws2015.Cells(erow, 1).PasteSpecial\n\nsourcewb.close\n\nFilename = Dir\n\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5066880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143f2c189da9b996149474bcabaaaa58?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/5066880/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 824, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552384751, "creation_date": 1435695482, "last_edit_date": 1531164843, "question_id": 31147736, "link": "https://stackoverflow.com/questions/31147736/how-to-copy-rows-of-data-from-multiple-workbooks-based-on-an-variable-criteria", "title": "How to copy rows of data from multiple workbooks based on an variable criteria, then paste into a master workbook", "body": "<p>I am very new to VBA and after hours of searching I have found a code to copy all rows of data from multiple workbooks into a master workbook.  The data in the user workbooks is updated daily. However, I do not wish to delete the data from the user workbooks so when I run the macro for a second time to capture the new data, it copies all the rows again and therefore duplicates the data in the master workbook.  Column T of the workbooks contains the week number of the entry of the row of data.  I would like to use an input box to specify the week number to search for, then copy the entire row.  This way I can run the macro once a week but only update the master with the previous weeks data instead of the entire worksheet.  Here is the macro I currently have.  Please can anyone help to modify it?</p>\n\n<pre><code>    Sub copyDataFromMultipleWorkbooksIntoMaster()\n\n    Dim FolderPath As String, Filepath As String, Filename As String\n\n    FolderPath = \"C:\\Users\\25dbrown\\Desktop\\Prototypes\\\"\n\n    Filepath = FolderPath &amp; \"*.xlsx*\"\n\n    Filename = Dir(Filepath)\n\n    Dim lastrow As Long, lastcolumn As Long\n\n    Do While Filename &lt;&gt; \"\"\n     Workbooks.Open (FolderPath &amp; Filename)\n     lastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n     lastcolumn = ActiveSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n     Range(Cells(2, 1), Cells(lastrow, lastcolumn)).Copy\n     Application.DisplayAlerts = False\n     ActiveWorkbook.Close\n\n     erow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n     lastcolumn = ActiveSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n     ActiveSheet.Paste Destination:=Worksheets(\"2015\").Rang(Cells(erow,1),  Cells(erow, lastcolumn))                \n\n\n     Filename = Dir\n\n     Loop\n\n     End Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 4565343, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/7066f98b723f3d0319ed6c3644a5a72c?s=128&d=identicon&r=PG&f=1", "display_name": "parodytx", "link": "https://stackoverflow.com/users/4565343/parodytx"}, "edited": false, "score": 0, "creation_date": 1435695600, "post_id": 31147664, "comment_id": 50305839, "body": "Thank you for the explanation. As a newbie Outlook VBA coder I have no idea even how to begin what you suggest. Could you post some code that might do what I needed as I listed above? Thanks again."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 65, "user_id": 4565343, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/7066f98b723f3d0319ed6c3644a5a72c?s=128&d=identicon&r=PG&f=1", "display_name": "parodytx", "link": "https://stackoverflow.com/users/4565343/parodytx"}, "edited": false, "score": 0, "creation_date": 1435696631, "post_id": 31147664, "comment_id": 50306374, "body": "Take a look at the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736(v=office.14).aspx\" rel=\"nofollow noreferrer\">Getting Started with VBA in Outlook 2010</a> to begin."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1435695248, "last_edit_date": 1592644375, "creation_date": 1435695248, "answer_id": 31147664, "question_id": 31147338, "link": "https://stackoverflow.com/questions/31147338/how-to-select-a-tab-on-outlook-2010-ribbon/31147664#31147664", "title": "How to select a Tab on Outlook 2010 Ribbon", "body": "<p>Instead of trying to run commands and ribbon controls programmatically you can use the Outlook object model. The Store class provides the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff860628(v=office.15).aspx\" rel=\"nofollow noreferrer\">GetRules</a> method which returns a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869469.aspx\" rel=\"nofollow noreferrer\">Rules</a> collection object that contains the Rule objects defined for the current session. You can use the <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff868097.aspx\" rel=\"nofollow noreferrer\">Enabled</a> property of the Rule class which returns a boolean value that determines if the rule is to be applied. Here is what MSDN states:</p>\n<blockquote>\n<p>Setting the Enabled property of a rule does not guarantee that the rule will be enabled. The rule is enabled only after Rules.Save executes successfully.</p>\n<p>Using Rule.Enabled and Rules.Save applies the rule consistently and persists the rules beyond the current session. Enabling a rule (that has been saved successfully) ensures that the rule will be applied. If it is a local client rule, the rule will be applied when Outlook is running, and if the rule is a server-based rule, it will be applied regardless of whether Outlook is running. If you do not enable the rule, then the rule is defined, but it will not be applied. However, you can use Rule.Execute to apply a rule as an one-off operation regardless of whether the rule is enabled.</p>\n</blockquote>\n<p>You may consider handling the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869298(v=office.15).aspx\" rel=\"nofollow noreferrer\">Startup</a> event of the Application class which is fired when Outlook is starting, but after all add-in programs have been loaded.</p>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 4565343, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/7066f98b723f3d0319ed6c3644a5a72c?s=128&d=identicon&r=PG&f=1", "display_name": "parodytx", "link": "https://stackoverflow.com/users/4565343/parodytx"}, "is_accepted": false, "score": 0, "last_activity_date": 1436710961, "creation_date": 1436710961, "answer_id": 31368775, "question_id": 31147338, "link": "https://stackoverflow.com/questions/31147338/how-to-select-a-tab-on-outlook-2010-ribbon/31368775#31368775", "title": "How to select a Tab on Outlook 2010 Ribbon", "body": "<p>As best as I can determine, in Outlook, selecting and activating a tab on the Ribbon is not possible programmatically.</p>\n\n<p>My solution was to create a Userform that is activated in the Application_Start() routine. It gets focus on startup and acts as a reminder to do what I need to do.</p>\n\n<p>For knowledge sake, I would be happy to view any other potential solutions to the original issue.</p>\n"}], "owner": {"reputation": 65, "user_id": 4565343, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/7066f98b723f3d0319ed6c3644a5a72c?s=128&d=identicon&r=PG&f=1", "display_name": "parodytx", "link": "https://stackoverflow.com/users/4565343/parodytx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593248067, "creation_date": 1435694206, "last_edit_date": 1593248067, "question_id": 31147338, "link": "https://stackoverflow.com/questions/31147338/how-to-select-a-tab-on-outlook-2010-ribbon", "title": "How to select a Tab on Outlook 2010 Ribbon", "body": "<p>I have programmed a rule calling a VBA macro that automatically forwards all email to an offsite account. Sometimes the rule fails with an Outlook (not VBA) error message and the rule becomes inactive until I reactivate it (by going through all the choices and hitting apply) then all is fine again (until the next time.)</p>\n\n<p>I would like to have a macro that runs at Outlook Start-up that does one thing - select the Manage Rules &amp; Alerts drop-down menu item under the Rules tab on the Ribbon. It would then open and would assure me the rule is activated and working.</p>\n\n<p>Is this possible?</p>\n"}, {"tags": ["c", "vba", "excel", "recursion"], "comments": [{"owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "edited": false, "score": 1, "creation_date": 1435716932, "post_id": 31147332, "comment_id": 50312923, "body": "I see 3 issues.  The first is the use of the variable &quot;step&quot;.  Step is a VB keyword used in For-Next loops.  The second is the For-Next declaration; it should be something like <code>For i = 1 To n Step (2 * step)</code> (now you see a potential problem use a variable named &quot;step&quot;).  The third is the integer division in the array indexing; instead of (/2) use (\\2).  There may be other issues, but those are the ones that I saw."}, {"owner": {"reputation": 709, "user_id": 3287387, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/V8jnD.jpg?s=128&g=1", "display_name": "linuxfreebird", "link": "https://stackoverflow.com/users/3287387/linuxfreebird"}, "reply_to_user": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "edited": false, "score": 0, "creation_date": 1435747496, "post_id": 31147332, "comment_id": 50326756, "body": "@TnTinMn Wow, thanks. I did not concern these options. I will try to implement them."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 5505367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a7551d2aacb785440c83c07a85ffa2?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/5505367/stefan"}, "is_accepted": true, "score": 1, "last_activity_date": 1446165737, "last_edit_date": 1446165737, "creation_date": 1446164653, "answer_id": 33426983, "question_id": 31147332, "link": "https://stackoverflow.com/questions/31147332/implementing-rosseta-code-fft-into-vba-excel/33426983#33426983", "title": "Implementing Rosseta Code FFT into VBA Excel", "body": "<p>You have declared c1 as <code>Long</code>: </p>\n\n<pre><code> \"Dim c1(1 To 2) As Long\"\n</code></pre>\n\n<p>Change it to <code>Double</code> and it works:</p>\n\n<pre><code> \"Dim c1(1 To 2) As Double\"\n</code></pre>\n"}], "owner": {"reputation": 709, "user_id": 3287387, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/V8jnD.jpg?s=128&g=1", "display_name": "linuxfreebird", "link": "https://stackoverflow.com/users/3287387/linuxfreebird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 838, "favorite_count": 0, "accepted_answer_id": 33426983, "answer_count": 1, "score": 2, "last_activity_date": 1446165737, "creation_date": 1435694191, "question_id": 31147332, "link": "https://stackoverflow.com/questions/31147332/implementing-rosseta-code-fft-into-vba-excel", "title": "Implementing Rosseta Code FFT into VBA Excel", "body": "<p>I attempted to implement the <a href=\"http://rosettacode.org/wiki/FFT#C\" rel=\"nofollow\">FFT Rosetta Code</a> into VBA excel. I was unable to reconstruct the same output data exactly as written in the Rosetta Code. At first I thought it was type conversion mismatch, but scaling the input values by 1.1 scaled the output values by 1.1 as well. The only aspect of my code that I think could be in question is how I implemented the referenced arrays in code versus what Rosetta writes. I discovered Rosetta shifts the addresses of the arrays by writing out + step and buf + step in its odd recursion calls. I am unaware of a similar construction in VBA, so I simply passed an additional recursion parameter shift, which keeps track of the shifting of addresses as its passed into the next recursion call. </p>\n\n<p>What is wrong with my shift implementation or is it something else?</p>\n\n<p>Rosetta claims its FFT is memory in place, however they make an extra copy of the data and store it into out[]. I would appreciate an explanation of why this is so.</p>\n\n<h2>FFT Rosetta Code in C</h2>\n\n<pre><code>void _fft(cplx buf[], cplx out[], int n, int step)\n{\n    if (step &lt; n) {\n        _fft(out, buf, n, step * 2);\n        _fft(out + step, buf + step, n, step * 2);\n\n        for (int i = 0; i &lt; n; i += 2 * step) {\n            cplx t = cexp(-I * PI * i / n) * out[i + step];\n            buf[i / 2]     = out[i] + t;\n            buf[(i + n)/2] = out[i] - t;\n        }\n    }\n}\n\nvoid fft(cplx buf[], int n)\n{\n    cplx out[n];\n    for (int i = 0; i &lt; n; i++) out[i] = buf[i];\n\n    _fft(buf, out, n, 1);\n}\n</code></pre>\n\n<h2>My attempted FFT in VBA</h2>\n\n<pre><code>Private Sub rec_fft(ByRef buf, ByRef out, ByVal n, ByVal step, ByVal shift)\nIf step &lt; n Then\n    Dim ii As Long\n    Dim pi As Double\n    pi = 3.14159265358979 + 3.23846264338328E-15\n    Dim c1(1 To 2) As Long\n    Dim c2(1 To 2) As Double\n    Call rec_fft(out, buf, n, step * 2, shift)\n    Call rec_fft(out, buf, n, step * 2, shift + step)\n    For i = 1 To n / (2 * step)\n        ii = 2 * step * (i - 1)    \n        c1(1) = Cos(-1 * pi * CDbl(ii) / CDbl(n))\n        c1(2) = Sin(-1 * pi * CDbl(ii) / CDbl(n))\n        c2(1) = c1(1) * out(shift + 1 + ii + step, 1) - c1(2) * out(shift + 1 + ii + step, 2)\n        c2(2) = c1(1) * out(shift + 1 + ii + step, 2) + c1(2) * out(shift + 1 + ii + step, 1)\n        buf(shift + 1 + ii / 2, 1) = out(shift + 1 + ii, 1) + c2(1)\n        buf(shift + 1 + ii / 2, 2) = out(shift + 1 + ii, 2) + c2(2)\n        buf(shift + 1 + (ii + n) / 2, 1) = out(shift + 1 + ii, 1) - c2(1)\n        buf(shift + 1 + (ii + n) / 2, 2) = out(shift + 1 + ii, 2) - c2(2)\n    Next i\nEnd If\n\nEnd Sub\n\nPrivate Sub fft(ByRef buf, ByVal n)\n    Dim out() As Double\n    ReDim out(1 To n, 1 To 2)\n    For i = 1 To n\n        out(i, 1) = buf(i, 1)\n        out(i, 2) = buf(i, 2)\n    Next i\n    Call rec_fft(buf, out, n, 1, 0)\nEnd Sub\n</code></pre>\n\n<h2>Output Comparison</h2>\n\n<pre><code>Input Data: 1 1 1 1 0 0 0 0 \nRosetta FFT : 4 (1, -2.41421) 0 (1, -0.414214) 0 (1, 0.414214) 0 (1, 2.41421)\nMy FFt : 4 (1, -3) 0 (1, -1) 0 (1, 1) 0 (1, 3)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3809, "user_id": 3447515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cPyHf.png?s=128&g=1", "display_name": "Cohan", "link": "https://stackoverflow.com/users/3447515/cohan"}, "edited": false, "score": 0, "creation_date": 1435693846, "post_id": 31147169, "comment_id": 50304757, "body": "Are you looking to color the whole column or the row? It seems like if you are looping through rows, the column would not do much good."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 1, "creation_date": 1435693889, "post_id": 31147169, "comment_id": 50304790, "body": "The best way to learn VBA is to record a macro that kind of does what you want, and then adapt it to your actual needs. Learning this way WILL make you a VBA genius."}, {"owner": {"reputation": 3809, "user_id": 3447515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cPyHf.png?s=128&g=1", "display_name": "Cohan", "link": "https://stackoverflow.com/users/3447515/cohan"}, "edited": false, "score": 0, "creation_date": 1435694030, "post_id": 31147169, "comment_id": 50304871, "body": "Pi speaks the truth. That is how I&#39;ve suggested many people learn at first. Once you get the hang of it, you&#39;ll see/do stuff that you don&#39;t like how the record feature does it and continue to improve."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1435695170, "post_id": 31147169, "comment_id": 50305546, "body": "I concur, using Pi&#39;s method will teach you what settings you need and how to access them. It will also teach you horrible coding practices, so some time spent learning better coding practices will be well worth it. A good place to start your reading is <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">how to avoid using Select in Excel VBA macros</a>."}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 5042346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e05145b1008f86e36a29ba632d0b6e?s=128&d=identicon&r=PG", "display_name": "Pira", "link": "https://stackoverflow.com/users/5042346/pira"}, "is_accepted": false, "score": 0, "last_activity_date": 1435703057, "last_edit_date": 1435703057, "creation_date": 1435700203, "answer_id": 31148957, "question_id": 31147169, "link": "https://stackoverflow.com/questions/31147169/vba-find-and-replace-but-color-entire-column/31148957#31148957", "title": "VBA Find and Replace but color entire column", "body": "<p>I think this is what you are looking for:<br>\n<a href=\"https://msdn.microsoft.com/en-us/library/bb209118%28v=office.12%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/bb209118%28v=office.12%29.aspx</a></p>\n\n<p>Cant verify it at the moment... but I think it works like this:</p>\n\n<pre><code>Application.ReplaceFormat.Interior.Color = RGB(200, 150, 200)\n\nCells.Replace What:=FindStr, Replacement:=RepStr, SearchFormat:=False, ReplaceFormat:=True\n</code></pre>\n\n<p><strong>EDIT</strong><br>\nTo color the entire column, you have to search for the lightpurple colored cells and apply the color change for the entirecolumn of each found cell</p>\n\n<pre><code>Application.FindFormat.Interior.Color = RGB(200, 150, 200)\nCells.Find(SearchFormat:=True).EntireColumn.Interior.Color = RGB(200, 151, 200)\n'slightly changed colorcode to avoid endless loop, if you want to loop through all changed cells\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1435727524, "creation_date": 1435727524, "answer_id": 31152983, "question_id": 31147169, "link": "https://stackoverflow.com/questions/31147169/vba-find-and-replace-but-color-entire-column/31152983#31152983", "title": "VBA Find and Replace but color entire column", "body": "<p>To expand on the previous answer:</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub replace1()\n\n    Const ENTIRE_COLUMN As Byte = 0     'Change to 1 to color the entire columns\n\n    Dim i       As Integer\n    Dim ws      As Worksheet\n    Dim findStr As String\n    Dim repStr  As String\n    Dim lPurple As Long\n    Dim found   As Range\n    Dim first   As String\n\n    lPurple = RGB(244, 233, 255)\n\n    Application.ReplaceFormat.Interior.Color = lPurple\n\n    For Each ws In Workbooks(\"AA SERIES\").Worksheets\n        For i = 1 To 9\n            With Workbooks(\"PartNumbers\").Sheets(\"Sheet1\")\n                findStr = .Range(\"I\" &amp; i).Value\n                repStr = .Range(\"J\" &amp; i).Value\n\n                ws.UsedRange.Replace What:=findStr, _\n                                     Replacement:=repStr, _\n                                     ReplaceFormat:=True\n\n                If ENTIRE_COLUMN = 1 Then\n                    With ws.UsedRange\n                        Set found = .Find(What:=repStr, SearchOrder:=xlByRows)\n                        If Not found Is Nothing Then\n                            first = found.Address\n                            Do\n                                If found.Offset(1).Interior.Color &lt;&gt; lPurple Then\n                                    .Columns(found.Column).Interior.Color = lPurple\n                                End If\n                                Set found = .FindNext(found)\n                            Loop While Not found Is Nothing And found.Address &lt;&gt; first\n                        End If\n                    End With\n                End If\n\n            End With\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5062774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/102993c63be9732b083ae4fa837456a8?s=128&d=identicon&r=PG&f=1", "display_name": "Jamie", "link": "https://stackoverflow.com/users/5062774/jamie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "accepted_answer_id": 31152983, "answer_count": 2, "score": 0, "last_activity_date": 1435739284, "creation_date": 1435693653, "last_edit_date": 1435739284, "question_id": 31147169, "link": "https://stackoverflow.com/questions/31147169/vba-find-and-replace-but-color-entire-column", "title": "VBA Find and Replace but color entire column", "body": "<p>I'm fairly new to VBA (as in this is my first attempt with it) and am working on a macro to find and replace a large set of numbers with slightly modified numbers in a spreadsheet named \"AA SERIES\".  I'm storing these in a spreadsheet named \"PartNumbers\", with the existing ones in column I and the replacements in J.  The code shown below works fine for this: </p>\n\n<pre><code>Sub Macro1()  \nDim i As Integer  \nDim WS As Worksheet  \nDim FindStr As String  \nDim RepStr As String  \nFor i = 1 To 87\n\n   For Each WS In Workbooks(\"AA SERIES\").Worksheets  \n    FindStr = Workbooks(\"PartNumbers\").Sheets(\"Sheet1\").Range(\"I\" &amp; i).Value  \n    RepStr = Workbooks(\"PartNumbers\").Sheets(\"Sheet1\").Range(\"J\" &amp; i).Value  \n    Cells.Replace What:=FindStr, Replacement:=RepStr\n\n   Next  \nNext i\n\nEnd Sub\n</code></pre>\n\n<p>However, what I'd like it to do is also format the entire column a different color (ideally light purple) if the macro replaces a value in it.  The goal is that the next person to work with this sheet will be able to quickly scroll through and see where the changes are.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1435720225, "creation_date": 1435720225, "answer_id": 31151928, "question_id": 31147083, "link": "https://stackoverflow.com/questions/31147083/difference-between-two-year-extracting-codes/31151928#31151928", "title": "Difference between two year-extracting codes", "body": "<p>Try this modified extractYears()</p>\n\n<hr>\n\n<pre><code>Private Sub extractYears()\n\n    Dim arr As Variant, i As Long, j As Long, ur As Range, colW As Long, colV As Long\n\n    Set ur = cFinal.UsedRange                   '3rd sheet\n\n    If WorksheetFunction.CountA(ur) &gt; 0 Then\n\n        colW = colNum(\"W\")\n        colV = colNum(\"V\")\n\n        arr = ur                                'transfer sheet data to memory\n\n        For i = 2 To getMaxCell(ur).Row         'each \"row\"\n\n            If Len(arr(i, colW)) &gt; 0 Then       'if not empty\n                If Len(arr(i, colW)) &gt; 4 Then   'if it's full date (longer than 4 digits)\n                    arr(i, colW) = Format(arr(i, colW), \"yyyy\") 'extract the year part\n                End If\n            End If                              'if it contains 4 digit year leave it as is\n\n            If Len(arr(i, colV)) &gt; 0 Then       'the same logic applied for colV\n                If Len(arr(i, colV)) &gt; 4 Then\n                    arr(i, colV) = Format(arr(i, colV), \"yyyy\")\n                End If\n            End If\n        Next\n\n        ur = arr                                'transfer memory data back to sheet\n\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>It will work with dates like this:</p>\n\n<pre><code>08/03/2007  -&gt; 2007\n05/24/2006  -&gt; 2006\n2007        -&gt; 2007\n2012        -&gt; 2012\n</code></pre>\n\n<hr>\n\n<p>For both columns I applied an extra condition: <code>If Len(arr(i, colW)) &gt; 4 Then</code></p>\n\n<p>You can apply it to any other column that contains both: full dates, or years only (4 digits)</p>\n\n<p>Notes for your second method:</p>\n\n<ul>\n<li>try not to iterate over every cell in the column as it decreases performance considerable\n\n<ul>\n<li>copy the entire column with data (<code>.UsedRange.Column</code>) to a variant array and loop on that</li>\n<li>functions <code>IsDate(val)</code> and <code>IsEmpty(val)</code> work the same way</li>\n<li>function <code>Len(val) &gt; 0</code> is faster than <code>IsEmpty(val)</code></li>\n</ul></li>\n<li>if both columns end on the same row, you don't need to perform 2 loops for each column\n\n<ul>\n<li>get the last row for one of them and modify both columns at the same time</li>\n<li>(the same way as in the first function)</li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 13, "user_id": 5066852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1910d55929a3b88bbf09a0d4b80a56?s=128&d=identicon&r=PG&f=1", "display_name": "AccessExcelVBA", "link": "https://stackoverflow.com/users/5066852/accessexcelvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1435721305, "creation_date": 1435693346, "last_edit_date": 1435721305, "question_id": 31147083, "link": "https://stackoverflow.com/questions/31147083/difference-between-two-year-extracting-codes", "title": "Difference between two year-extracting codes", "body": "<p>I have two codes that I have written/got help from other people and just wondering if these two codes can be combined into single code that does a lot of work for me.. First code I have is</p>\n\n<hr>\n\n<pre><code>Private Sub extractYears()\n\n    Dim arr As Variant, i As Long, j As Long, ur As Range, colW As Long, colV As Long\n\n    Set ur = cFinal.UsedRange               '4th sheet\n    If WorksheetFunction.CountA(ur) &gt; 0 Then\n        colW = colNum(\"Q\")\n        colV = colNum(\"R\")\n        If 1 Then\n            arr = ur\n            For i = 2 To getMaxCell(ur).Row     'each \"row\"\n                If Len(arr(i, colW)) &gt; 0 Then arr(i, colW) = Format(arr(i, colW), \"yyyy\")\n                If Len(arr(i, colV)) &gt; 0 Then arr(i, colV) = Format(arr(i, colV), \"yyyy\")\n            Next\n            ur = arr\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>and the other one is </p>\n\n<hr>\n\n<pre><code>Dim i As Long\nFor i = 2 To lastRow\n   If IsDate(wsFinal.Cells(i, \"Q\").Value) And Not IsEmpty(wsFinal.Cells(i, \"Q\").Value) Then\n      With wsFinal\n         .Cells(i, \"Q\").Value = Year(wsFinal.Cells(i, \"Q\").Value)\n      End With\n   End If\nNext i\n\nDim j As Long\nFor j = 2 To lastRow\n   If IsDate(wsFinal.Cells(j, \"R\").Value) And Not IsEmpty(wsFinal.Cells(j, \"R\").Value) Then\n      With wsFinal\n         .Cells(j, \"R\").Value = Year(wsFinal.Cells(j, \"R\").Value)\n      End With\n    End If\nNext j\n</code></pre>\n\n<hr>\n\n<p>Whenever I get a data from external source, these two columns (Q) and (R) are the most problematic elements because the whole column sometimes only contain years(Not Date formatted), and sometimes dates formatted as date, and possibly both types of non-date formatted years and date formatted dates in the same column. </p>\n\n<p>Every time a data comes in I have to check the type of column Q and R and if they consists of only the years, then I would use the second set of code and extractYears when the column only has full date format. I am not sure why using either one for all types won't work. It would just spit out numbers that I believe, are the number of days that have passed since 1905. </p>\n\n<p>Can anyone suggest a solution to this problem I have?</p>\n"}]